index,text
20980,it has been observed and theoretically proved that large tsunami like waves can be caused by moving pressure disturbances along the shoreline since serious disasters due to meteorological tsunamis usually occurred in long and narrow harbors or bays this study focuses on the resonance response of a harbor to atmospheric disturbances moving along the shoreline the possibility and mechanism for severe oscillation occurring in the harbor have been investigated the results show that severe oscillations can occur after a disturbance passes over but not always in that case harbor resonance corresponding to one of harbor eigen frequencies has been excited it is found that the excitation of harbor resonance mainly depends on the translational speed and spatial scale of atmospheric disturbance large oscillation occurs only within a small range of the translational speed and spatial scale for a specific harbor which eigen frequencies are fixed it is greatly associated with the amplitude of edge waves induced by disturbances a criterion has been proposed to predict the appearance of notable edge waves with similar frequency to the harbor eigen frequencies which is a necessary condition for severe oscillation in the harbor keywords meteotsunami edge wave forced wave harbor resonance 1 introduction some of historical events proved that large tsunami like waves can be excited when an atmospheric disturbance moving approximately parallel to the shoreline sallenger et al 1995 has reported a wave about 6 m high struck daytona beach of florida in 1992 and they regarded the anomalously large wave as being strongly related to a moving squall line skimming along the eastern coast of florida it is also proved theoretically and numerically that pressure disturbances moving parallel to the coast can induce large scaled edge waves under the mechanism of greenspan resonance greenspan 1956 seo and liu 2014 niu 2020 the induced wave may further be amplified due to local topography and results in serious coastal disaster the tsunami like waves induced by meteorological disturbances are generally called as meteotsunamis monserrat et al 2006 it can be seen that most serious disasters due to meteotsunamis usually occurred in long and narrow harbors or bays such as the event in the nagasaki bay on march 31 1979 hibiya and kajiura 1982 and the event in ciutadella harbor on 15 june 2006 vilibić et al 2008 although in those events pressure disturbances were not travelling along the coast since water surface oscillation is more significant for the mooring stability in harbors and resonances are prone to happen in long narrow harbors this study takes an idealized long narrow harbor as the object and focuses on the response of the harbor to atmospheric disturbances moving along the shoreline it is well known that severe oscillation usually happens associating with the harbor resonance which essentially occurs when the frequency of the external force is close to one of the harbor s eigen frequencies rabinovich 2009 the occurrence of harbor resonance can significantly worsen berthing conditions and cause great damage to moored ships as well as adjacent structures sudden and extreme oscillations might also flood low lying coastal areas threatening the safety of local residents in the past decades a large number of studies have been carried out to find the amplification factors and resonance frequency for a specific harbor and great achievements have been made in the early time the amplification factors and resonance frequency for one dimensional harbors have been analytically and experimentally investigated miles and munk 1961 lee 1971 subsequently resonant modes of the harbor with more complex geometry have been analytically solved yu 1996 yu and togashi 1996 wang et al 2011 or numerically investigated losada et al 2008 woo and liu 2004 in most of those studies a steady periodic incident wave at the inlet is assumed these studies are helpful to optimize the design of harbor layouts reduction in harbor resonance can be achieved by constructing breakwaters or changing geometry denamiel et al 2018 keuthen and kraft 2016 lončar et al 2010 maa et al 2011 many resonant events were reported to have relationships with bad weather seismic tsunami and some other external forces and it is believed that the resonance happened when the external force provided enough energy for wave evolution however the process of wave evolution and its relationship with the external force have received less attention there are only a few works on the transient response of harbors bellotti 2007 has numerically studied the transient response of harbors to long sinusoidal waves within a finitely long time further more practical wave forms have been taken into consideration for example n waves are used to represent tsunamis gao et al 2017 on the aspect of wave spectra monserrat et al 1998 proposed a method to predict sea level spectra for given locations using the reconstructed open sea source spectra and the observed atmospheric pressure spectra based on the fact that waves of different origins are modified by local topography in a similar way although studies mentioned before have made great efforts to reveal the mechanism of harbor resonance there are still gaps between the external force and its induced harbor oscillation our study was motivated by the desire to figure out 1 whether a pressure disturbance moving along the coast can induce the harbor resonance and 2 under which conditions severe oscillations happen the study is based on theoretical analysis and numerical experiments using the widely used hydrodynamic model delft3d and a long narrow harbor is idealized as a slender rectangular with constant water depth which is located at a coast with a constant slope and straight shoreline in section 2 the simplified physical problem and the chosen method are stated in section 3 preliminary theoretical analysis is carried out for the problem in section 4 harbor oscillation due to an atmospheric pressure disturbance moving along shoreline is demonstrated numerically and the evolution of resonance phenomenon is discussed responses of the harbor to disturbances with different parameters are also analyzed and a criterion to predict the harbor resonance is further discussed for this type of trigger further the impacts of beach slope in the surrounding area on the harbor resonance are discussed in section 5 a conclusion is given 2 simplification of physical problem and research method this physical problem is actually quite complicated because most natural coastlines are meandering and always in dynamic equilibrium under the complex coastal dynamic factors meanwhile harbors are usually in different shapes due to local hydrology topography and geology conditions the forms of atmospheric disturbance are also highly diverse and unstable to get better understanding on the essential relation between harbor resonance and moving atmospheric disturbances the problem should be simplified reasonably and effectively the physical problem is simplified as an atmospheric pressure disturbance moving parallel to a straight shoreline with concave harbor basin as illustrated in fig 1 the origin of coordination is defined at the center of the harbor inlet with x axis pointing to offshore direction and y axis lying along the main shoreline the water depth d increases linearly with the distance from shore x i e d sx in which s is the beach slope the idealized rectangular harbor is located from y b to y b in width and from x l to x 0 with a constant water depth d 0 the width of the harbor 2b is assumed to be much smaller than its length l and the spatial scale of pressure disturbances so the water surface oscillation within the harbor can be treated as one dimensional a channel l with constant depth d 0 is a transition section between the harbor basin and deep water acting as a navigation waterway fast moving pressure disturbances associating with severe weather phenomena such as storms and squall lines are considered the simplified disturbances travelling along the shoreline are assumed as a sudden change in sea surface pressure moving with a constant speed u the synthetic atmospheric pressure is described by a gaussian function in both x and y directions with different spatial scales as shown in fig 2 the expression of the pressure disturbance is written as 1 p x y t δ p exp x 2 α r m 2 y u t r m 2 2 where p is the pressure deviation from the normal sea surface pressure and δp is the maximum deviation u is the translation speed and t is time r m is the spatial scale and α is the ratio of r m in x direction to that in y direction in this study α is set to be 3 to describe a long narrow atmospheric disturbance associated with squall lines cold front etc the physical problem is first analyzed using previous knowledge on harbor resonance and pressure disturbance induced nearshore waves and then further discussed using numerical experiments the open source software delft3d is adopted for numerical analysis in this study it is developed by the delft hydraulics research institute and is widely used in the research of hydrodynamic and environmental problems the core module delft3d flow is famous for its complete system with high computation efficiency and good stability song et al 2020 lesser et al 2004 in addition parameters involved such as the coriolis force viscosity and bottom friction are temporarily neglected in this study then we numerically simulated a series of scenarios to check whether a pressure disturbance can excite severe oscillations in the harbor 3 theoretical analysis according to the research of greenspan 1956 and niu 2020 notable edge waves can be excited when the atmospheric disturbance moving along shoreline if the frequency of edge waves is close to the eigen frequency of the harbor resonance may happen the dispersion relation of edge wave for a constant slope can be found in the review by johnson 2007 a classic dispersion relation was given by ursell 1952 based on potential flow which can be written as c sin 2 n 1 β g k n in which c is the wave speed g is the acceleration of gravity the slope s tan β and k n is the wave number of n th mode eckart 1951 obtained another form of the dispersion relation based on the linear shallow water equations which can be written as c 2 n 1 g s k n when the slope is gentle it is approximately equivalent to the one given by ursell 1952 which is adopted in this study for the edge waves induced by atmospheric disturbances under the greenspan resonance the wave speed equals to the translational speed i e u equals to c thus the frequency of edge waves f n can be written as 2 f n 2 n 1 g s 2 π u for example a typical atmospheric disturbance with the translation speed of 11 m s is moving on the beach slope of 1 100 the fundamental mode is the dominant mode as predicted by the theory the frequency of fundamental mode f 0 is approximately 0 0014 hz and the period t 0 is 11 74 min for a specific harbor its eigen frequency can be estimated using analytical solution or numerical simulation now the topography is refined by considering a long narrow harbor attached to the shoreline mentioned above the n th mode wave frequency of the resonant wave inside the semi closed harbor can be expressed as f n 2 n 1 c 4 l wilson 1972 sorensen and thompson 2002 in which l is the length of the long narrow harbor and c is the wave velocity in the harbor this estimation method is easy and convenient but is not suitable for complex harbors another way to obtain the resonant frequencies is to find the peaks in the curve of amplification factor varying with incident wave frequency for example wang et al 2011 studied the variation of water level amplification factor a with incident wave number k which is proportional to wave frequency f in shallow water conditions within a harbor of constant slope the calculation equation of the factor a can be expressed as 3 a cos k l 2 b k π sin k l ln γ k b 2 e 3 2 i b k sin k l 1 where γ is the exponential of euler s constant adopting their solution the amplification factor is calculated and it can be seen that significant harbor resonances take place at the extreme points of the amplification curve as graphed in fig 3 it should be noted that the harbor width 2b may also influence the amplification factor according to equation 3 wider harbors spread energy in both x and y directions and even generate new resonant modes which may result in smaller amplification factors in this study the geometry of harbor is fixed to mainly consider the variation of atmospheric disturbance for more complex harbor the amplification curve can be obtained through numerical simulations assuming there is a harbor with parameter l 1000m b 50m and d 0 5m the first three resonant frequencies of this narrow long harbor are f n 0 0016 hz 0 0049 hz and 0 0083 hz when a typical atmospheric disturbance with the translation speed of 11 m s is moving on the beach slope of 1 100 the frequency of the induced edge wave f 0 in the supposed case is very close to the first resonant frequency of the harbor f 0 so it is presumed that the harbor resonance will happen theoretically in the next section numerical experiments are conducted to figure out whether severe water response occurs as supposed 4 results and discussions 4 1 water surface response to the atmospheric disturbance the same situation is adopted in the numerical experiment as supposed in previous section the translation speed of the atmospheric disturbance is 11 m s and the spatial scale is set to be 3 km the beach slope is adopted as 1 100 since that meteotsunami events are usually associated with pressure jumps of 1 5 mb e g hibiya and kajiura 1982 sallenger et al 1995 the central pressure deviation δp here is set to be 1 mb the parameter η r δ p ρ g representing the water level rise under hydrostatic equilibrium is used for data dimensionless in the subsequent analysis the disturbance is set to pass through the coordinate origin at t 0 and the duration is 2 h from t 1 h 1 h a sufficiently large domain size is set to be 100l in x direction and 150l in y direction the grid size is set to be 100 m and the time step is 60 s results shows that when the atmospheric disturbance propagates along shoreline at a constant speed and passes over the harbor inlet the water surface inside harbor fluctuates gradually from stationary fig 4 a shows the water elevation distribution at t 0 and the process of edge wave growth at different times notable edge waves following with the pressure disturbance have been induced under the mechanism of greenspan resonance and the number of edge waves in the packet increases with time as shown in fig 4 b it can be seen that the amplitude η can be amplified nearly 5 times compared to η r in the present situation a reasonable inference can be derived from this conclusion when considering a relatively strong disturbance δp 5 mb the maximum amplitude outside the harbor is about 0 25 m which seems not so threatening the area framed in the red square in fig 4 a is zoomed in for observation of water surface response inside the harbor as shown in fig 5 the water surface within the harbor starts to oscillate from calmness when the pressure disturbance passes through as shown in fig 5 a as the first peak of edge wave passes through water surface inside the harbor rises up and the maximum at the inner end appears after the first peak leaves as shown in fig 5 b and c then water surface inside the harbor falls and the lowest elevation at the inner end appears for the first time after the first trough of edge wave leaves as shown in fig 5 d subsequently water surface oscillation lasts for a period of time and the absolute values of water elevation at the second peak and trough continuously grow as shown in fig 5 e and f it can be illustrated in fig 5 that water surface oscillation within the harbor is a typical fundamental mode i e helmholtz mode with an anti node at its inner end and a node near its entrance which coincides well with theoretical results in section 3 time series of water elevation at three representative locations marked in fig 5 a are compared to show the amplification by the harbor obs1 is the inner end of harbor obs2 is the entrance and obs3 is located close to the shoreline and departs from the harbor the variation of water elevation with time is shown in fig 6 it can be seen clearly that waves outside the harbor obs2 and obs3 are relatively small compared to that at the inner end obs1 the maximum water elevation at the inner end of harbor exceeds 30 times of η r showing much more intense response to the disturbance than the initial incident waves based on the linear assumption the strong scenario disturbance of 5 mb mentioned above may induce severe oscillations with amplitude of 1 5 m under these resonant mechanism fig 6 also shows that growth of the oscillation inside the harbor takes time it should be noted that the oscillation may not grow up when the duration of the disturbance is short but the harbor response time is not too long for some modes of resonance as discussed in bellotti 2007 a resonant mode with narrow width in the amplification diagram needs long time to reach the maximum oscillation and vice versa in the present case the wave amplitude quickly increases to a rather large value only after two wave periods 4 2 criterion to predict the risk of atmospheric disturbances as we can learn from section 3 and 4 a necessary condition for an atmospheric disturbance to induce harbor resonance is the induced waves outside the harbor has similar frequency to one of eigen frequencies of the harbor in addition the induced waves outside the harbor should not be too small which is greatly affected by the translational speed and spatial scale of disturbance as predicted by the theory greenspan 1956 niu 2020 the non dimensional parameter k 0 r m controls the wave outside the harbor here k 0 r m g s u 2 r m is the ratio of disturbance scale to the length of edge wave within the range 0 4 k 0 r m 3 5 the fundamental mode of edge wave would be notable according to niu 2020 in the reference case u 11 m s r m 3 km and s 1 100 mentioned in section 4 1 k 0 r m equals to 2 43 a set of cases with varying u and r m have been conducted and the maximum water elevation inside the harbor is picked out the translational speed u is varying from 2 to 20 m s and the spatial scale r m is varying from 0 5 to 10 km totally 285 cases are computed specifically u 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 m s r m 0 5 1 1 5 2 2 5 3 3 5 4 4 5 5 6 7 8 9 10 km other conditions keep the same as the case shown in the previous section fig 7 shows the maximum water elevation inside the harbor varying with u and r m the maximum η η r is about 43 when u 12 m s and r m 2 km if we consider 5 6 times of the amplitude of the edge wave as extremely dangerous resonant situations i e η η r exceeds 30 u ranges from 11 to 13 m s and k 0 r m from 0 6 to 2 6 which coincides with the previous conclusions well for the specific harbor it is confirmed that severe oscillation may happen when the frequency of predicted edge wave frequency by eq 2 similar to the eigen frequency of harbor i e u 11 m s in this case but it not always happens as demonstrated by the numerical experiments when k 0 r m is larger than 3 5 approximately as shown in fig 8 η η r increases first and then decreases as r m becomes larger which has a peak around r m 2 km it can be explained by the occurrence condition for notable edge waves as a comparison the analytical solution of greenspan 1956 on edge wave generated by a gaussian shaped atmospheric disturbance moving along coastline is also shown in fig 8 the dashed line shows the relative amplitude of fundamental mode of edge wave which computed using the formula given by greenspan 1956 4 η 0 x y t η r 2 π k 0 r m 2 erfc k 0 r m 2 exp k 0 x sin k 0 y u t where erfc k 0 r m 2 is the complementary error function it can be seen from the analytical solution that the occurrence of notable edge wave is confined within a certain range of k 0 r m detailed discussion can be found in the previous studies an et al 2012 niu 2020 niu 2020 pointed out that when k 0 r m is larger than π the edge wave predicted by greenspan s solution is diminishing leading to relatively mild water response inside the harbor when k 0 r m is smaller than 1 2 higher mode of edge wave may be dominant which frequency is 2n 1 times of the fundamental mode and will depart from the harbor eigen frequency overall there are two conditions should be satisfied at the same time to excite severe oscillation in the harbor 1 notable edge waves have been induced by the disturbance travelling along shoreline which can be judged by the parameter k 0 r m 2 the frequency of edge waves f n is similar to one of the harbor eigen frequencies f n for a specific harbor a group of critical translational speeds can be determined from the combination of f n and f n further for each critical translational speed a range of spatial scale can be estimated through the occurrence condition of notable edge waves suggested by niu 2020 generally when the main resonance frequency of a harbor is lower to excite the resonance mode asks for a disturbance with faster translational speed and relatively larger spatial scale 4 3 influence of beach slope previous work is carried out on the same topography and only changes of disturbance parameters are taken into consideration in this section the influence of topography is discussed because the influence of the harbor can be mainly reflected in its eigen frequencies only the beach slope of surrounding area is treated as variable the geometric parameters of the harbor remain the same so that the eigen frequencies of the harbor f n are fixed the beach slope s is adopted to be 0 005 0 01 and 0 02 in three different cases to make the cases comparable the parameters of pressure disturbance are chosen to keep that the fundamental mode of edge wave is excited with same frequency f 0 and k 0 r m the parameters are shown in table 1 over the steeper slope the disturbance with faster translational speed and larger scale can induce edge waves with similar amplitude as shown in fig 9 b fig 9 b shows the water elevation along the shoreline x 0 at t 0 while fig 9 a shows time series of water surface elevation at the inner end of the harbor in each case it can be clearly seen that the water response becomes much more intense as the beach slope becomes steeper as shown in fig 9 a even though the amplitude and the period of edge waves remains the same for s 0 02 the amplitude amplification can be about 50 times but it can only reach about 15 for s 0 005 the phenomenon can be attributed to the ratio of the harbor scale to the wavelength of the induced edge wave as shown in fig 9 b the wavelength of edge waves in the case of milder s is shorter than other cases relatively shorter edge waves can be more intensely affected by the local topography of the harbor in another view shorter edge wave decays more quickly in the seaward direction with same amplitude the shorter edge wave carries less energy which may further result in that less energy transfers into the harbor moreover the local topography at the entrance of the harbor i e the slope of the sidewall along the navigation waterway may slightly affect the evolution of water elevation at the entrance but the impact is limited and does not affect the major conclusion 5 conclusions this study focuses on the response of a harbor to atmospheric disturbances moving along the shoreline the possibility and mechanism for severe oscillations generated inside the harbor are investigated based on the previous analytical solution and numerical modeling two important conditions should be both satisfied to induce harbor resonance 1 notable edge waves have been induced by the pressure disturbance 2 the harbor has similar frequencies to edge waves moreover the duration of the disturbance also contributes to the transient process of the inner water response it shows that a few number of edge waves in the wave packet already can excite large oscillation in the harbor it is displayed that excitation of harbor resonance depends on the translational speed and spatial scale of the disturbance severe oscillations appear only when meeting suitable combinations of the translation speed and the spatial scale for a fixed harbor with certain frequencies f n for example dangerous harbor resonance appears when u is about 11 m s and k 0 r m expands from 0 6 to 2 6 for the idealized harbor adopted in this study the critical translational speed can be determined considering the frequency of edge waves is similar to one of the harbor eigen frequencies the critical range of spatial scale is determined by the occurrence condition for notable edge waves according to the parameter k 0 r m which can refer to niu 2020 in addition the beach slope also impacts the harbor response the critical disturbance for harbors with similar geometry is different when their surrounding areas have different slopes steeper slope asks faster translational speed and larger spatial scale which corresponds to edge waves with longer wavelength it shows that shorter incident edge wave cannot effectively transfer energy into harbors it should be pointed out that topography of natural coasts and harbor geometry are generally complex as well as atmospheric disturbances the situation assumed in the idealized cases is rare in practice but the possibility exists better understanding of the mechanism would be helpful to predict the harbor resonance and to develop early warning methods credit authorship contribution statement qiuyi sun methodology software validation visualization writing original draft xiaojing niu conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the support by the national natural science foundation of china under the grant no 51779125 and the support by state key laboratory of hydroscience and engineering under grant no 2018 ky 01 
20980,it has been observed and theoretically proved that large tsunami like waves can be caused by moving pressure disturbances along the shoreline since serious disasters due to meteorological tsunamis usually occurred in long and narrow harbors or bays this study focuses on the resonance response of a harbor to atmospheric disturbances moving along the shoreline the possibility and mechanism for severe oscillation occurring in the harbor have been investigated the results show that severe oscillations can occur after a disturbance passes over but not always in that case harbor resonance corresponding to one of harbor eigen frequencies has been excited it is found that the excitation of harbor resonance mainly depends on the translational speed and spatial scale of atmospheric disturbance large oscillation occurs only within a small range of the translational speed and spatial scale for a specific harbor which eigen frequencies are fixed it is greatly associated with the amplitude of edge waves induced by disturbances a criterion has been proposed to predict the appearance of notable edge waves with similar frequency to the harbor eigen frequencies which is a necessary condition for severe oscillation in the harbor keywords meteotsunami edge wave forced wave harbor resonance 1 introduction some of historical events proved that large tsunami like waves can be excited when an atmospheric disturbance moving approximately parallel to the shoreline sallenger et al 1995 has reported a wave about 6 m high struck daytona beach of florida in 1992 and they regarded the anomalously large wave as being strongly related to a moving squall line skimming along the eastern coast of florida it is also proved theoretically and numerically that pressure disturbances moving parallel to the coast can induce large scaled edge waves under the mechanism of greenspan resonance greenspan 1956 seo and liu 2014 niu 2020 the induced wave may further be amplified due to local topography and results in serious coastal disaster the tsunami like waves induced by meteorological disturbances are generally called as meteotsunamis monserrat et al 2006 it can be seen that most serious disasters due to meteotsunamis usually occurred in long and narrow harbors or bays such as the event in the nagasaki bay on march 31 1979 hibiya and kajiura 1982 and the event in ciutadella harbor on 15 june 2006 vilibić et al 2008 although in those events pressure disturbances were not travelling along the coast since water surface oscillation is more significant for the mooring stability in harbors and resonances are prone to happen in long narrow harbors this study takes an idealized long narrow harbor as the object and focuses on the response of the harbor to atmospheric disturbances moving along the shoreline it is well known that severe oscillation usually happens associating with the harbor resonance which essentially occurs when the frequency of the external force is close to one of the harbor s eigen frequencies rabinovich 2009 the occurrence of harbor resonance can significantly worsen berthing conditions and cause great damage to moored ships as well as adjacent structures sudden and extreme oscillations might also flood low lying coastal areas threatening the safety of local residents in the past decades a large number of studies have been carried out to find the amplification factors and resonance frequency for a specific harbor and great achievements have been made in the early time the amplification factors and resonance frequency for one dimensional harbors have been analytically and experimentally investigated miles and munk 1961 lee 1971 subsequently resonant modes of the harbor with more complex geometry have been analytically solved yu 1996 yu and togashi 1996 wang et al 2011 or numerically investigated losada et al 2008 woo and liu 2004 in most of those studies a steady periodic incident wave at the inlet is assumed these studies are helpful to optimize the design of harbor layouts reduction in harbor resonance can be achieved by constructing breakwaters or changing geometry denamiel et al 2018 keuthen and kraft 2016 lončar et al 2010 maa et al 2011 many resonant events were reported to have relationships with bad weather seismic tsunami and some other external forces and it is believed that the resonance happened when the external force provided enough energy for wave evolution however the process of wave evolution and its relationship with the external force have received less attention there are only a few works on the transient response of harbors bellotti 2007 has numerically studied the transient response of harbors to long sinusoidal waves within a finitely long time further more practical wave forms have been taken into consideration for example n waves are used to represent tsunamis gao et al 2017 on the aspect of wave spectra monserrat et al 1998 proposed a method to predict sea level spectra for given locations using the reconstructed open sea source spectra and the observed atmospheric pressure spectra based on the fact that waves of different origins are modified by local topography in a similar way although studies mentioned before have made great efforts to reveal the mechanism of harbor resonance there are still gaps between the external force and its induced harbor oscillation our study was motivated by the desire to figure out 1 whether a pressure disturbance moving along the coast can induce the harbor resonance and 2 under which conditions severe oscillations happen the study is based on theoretical analysis and numerical experiments using the widely used hydrodynamic model delft3d and a long narrow harbor is idealized as a slender rectangular with constant water depth which is located at a coast with a constant slope and straight shoreline in section 2 the simplified physical problem and the chosen method are stated in section 3 preliminary theoretical analysis is carried out for the problem in section 4 harbor oscillation due to an atmospheric pressure disturbance moving along shoreline is demonstrated numerically and the evolution of resonance phenomenon is discussed responses of the harbor to disturbances with different parameters are also analyzed and a criterion to predict the harbor resonance is further discussed for this type of trigger further the impacts of beach slope in the surrounding area on the harbor resonance are discussed in section 5 a conclusion is given 2 simplification of physical problem and research method this physical problem is actually quite complicated because most natural coastlines are meandering and always in dynamic equilibrium under the complex coastal dynamic factors meanwhile harbors are usually in different shapes due to local hydrology topography and geology conditions the forms of atmospheric disturbance are also highly diverse and unstable to get better understanding on the essential relation between harbor resonance and moving atmospheric disturbances the problem should be simplified reasonably and effectively the physical problem is simplified as an atmospheric pressure disturbance moving parallel to a straight shoreline with concave harbor basin as illustrated in fig 1 the origin of coordination is defined at the center of the harbor inlet with x axis pointing to offshore direction and y axis lying along the main shoreline the water depth d increases linearly with the distance from shore x i e d sx in which s is the beach slope the idealized rectangular harbor is located from y b to y b in width and from x l to x 0 with a constant water depth d 0 the width of the harbor 2b is assumed to be much smaller than its length l and the spatial scale of pressure disturbances so the water surface oscillation within the harbor can be treated as one dimensional a channel l with constant depth d 0 is a transition section between the harbor basin and deep water acting as a navigation waterway fast moving pressure disturbances associating with severe weather phenomena such as storms and squall lines are considered the simplified disturbances travelling along the shoreline are assumed as a sudden change in sea surface pressure moving with a constant speed u the synthetic atmospheric pressure is described by a gaussian function in both x and y directions with different spatial scales as shown in fig 2 the expression of the pressure disturbance is written as 1 p x y t δ p exp x 2 α r m 2 y u t r m 2 2 where p is the pressure deviation from the normal sea surface pressure and δp is the maximum deviation u is the translation speed and t is time r m is the spatial scale and α is the ratio of r m in x direction to that in y direction in this study α is set to be 3 to describe a long narrow atmospheric disturbance associated with squall lines cold front etc the physical problem is first analyzed using previous knowledge on harbor resonance and pressure disturbance induced nearshore waves and then further discussed using numerical experiments the open source software delft3d is adopted for numerical analysis in this study it is developed by the delft hydraulics research institute and is widely used in the research of hydrodynamic and environmental problems the core module delft3d flow is famous for its complete system with high computation efficiency and good stability song et al 2020 lesser et al 2004 in addition parameters involved such as the coriolis force viscosity and bottom friction are temporarily neglected in this study then we numerically simulated a series of scenarios to check whether a pressure disturbance can excite severe oscillations in the harbor 3 theoretical analysis according to the research of greenspan 1956 and niu 2020 notable edge waves can be excited when the atmospheric disturbance moving along shoreline if the frequency of edge waves is close to the eigen frequency of the harbor resonance may happen the dispersion relation of edge wave for a constant slope can be found in the review by johnson 2007 a classic dispersion relation was given by ursell 1952 based on potential flow which can be written as c sin 2 n 1 β g k n in which c is the wave speed g is the acceleration of gravity the slope s tan β and k n is the wave number of n th mode eckart 1951 obtained another form of the dispersion relation based on the linear shallow water equations which can be written as c 2 n 1 g s k n when the slope is gentle it is approximately equivalent to the one given by ursell 1952 which is adopted in this study for the edge waves induced by atmospheric disturbances under the greenspan resonance the wave speed equals to the translational speed i e u equals to c thus the frequency of edge waves f n can be written as 2 f n 2 n 1 g s 2 π u for example a typical atmospheric disturbance with the translation speed of 11 m s is moving on the beach slope of 1 100 the fundamental mode is the dominant mode as predicted by the theory the frequency of fundamental mode f 0 is approximately 0 0014 hz and the period t 0 is 11 74 min for a specific harbor its eigen frequency can be estimated using analytical solution or numerical simulation now the topography is refined by considering a long narrow harbor attached to the shoreline mentioned above the n th mode wave frequency of the resonant wave inside the semi closed harbor can be expressed as f n 2 n 1 c 4 l wilson 1972 sorensen and thompson 2002 in which l is the length of the long narrow harbor and c is the wave velocity in the harbor this estimation method is easy and convenient but is not suitable for complex harbors another way to obtain the resonant frequencies is to find the peaks in the curve of amplification factor varying with incident wave frequency for example wang et al 2011 studied the variation of water level amplification factor a with incident wave number k which is proportional to wave frequency f in shallow water conditions within a harbor of constant slope the calculation equation of the factor a can be expressed as 3 a cos k l 2 b k π sin k l ln γ k b 2 e 3 2 i b k sin k l 1 where γ is the exponential of euler s constant adopting their solution the amplification factor is calculated and it can be seen that significant harbor resonances take place at the extreme points of the amplification curve as graphed in fig 3 it should be noted that the harbor width 2b may also influence the amplification factor according to equation 3 wider harbors spread energy in both x and y directions and even generate new resonant modes which may result in smaller amplification factors in this study the geometry of harbor is fixed to mainly consider the variation of atmospheric disturbance for more complex harbor the amplification curve can be obtained through numerical simulations assuming there is a harbor with parameter l 1000m b 50m and d 0 5m the first three resonant frequencies of this narrow long harbor are f n 0 0016 hz 0 0049 hz and 0 0083 hz when a typical atmospheric disturbance with the translation speed of 11 m s is moving on the beach slope of 1 100 the frequency of the induced edge wave f 0 in the supposed case is very close to the first resonant frequency of the harbor f 0 so it is presumed that the harbor resonance will happen theoretically in the next section numerical experiments are conducted to figure out whether severe water response occurs as supposed 4 results and discussions 4 1 water surface response to the atmospheric disturbance the same situation is adopted in the numerical experiment as supposed in previous section the translation speed of the atmospheric disturbance is 11 m s and the spatial scale is set to be 3 km the beach slope is adopted as 1 100 since that meteotsunami events are usually associated with pressure jumps of 1 5 mb e g hibiya and kajiura 1982 sallenger et al 1995 the central pressure deviation δp here is set to be 1 mb the parameter η r δ p ρ g representing the water level rise under hydrostatic equilibrium is used for data dimensionless in the subsequent analysis the disturbance is set to pass through the coordinate origin at t 0 and the duration is 2 h from t 1 h 1 h a sufficiently large domain size is set to be 100l in x direction and 150l in y direction the grid size is set to be 100 m and the time step is 60 s results shows that when the atmospheric disturbance propagates along shoreline at a constant speed and passes over the harbor inlet the water surface inside harbor fluctuates gradually from stationary fig 4 a shows the water elevation distribution at t 0 and the process of edge wave growth at different times notable edge waves following with the pressure disturbance have been induced under the mechanism of greenspan resonance and the number of edge waves in the packet increases with time as shown in fig 4 b it can be seen that the amplitude η can be amplified nearly 5 times compared to η r in the present situation a reasonable inference can be derived from this conclusion when considering a relatively strong disturbance δp 5 mb the maximum amplitude outside the harbor is about 0 25 m which seems not so threatening the area framed in the red square in fig 4 a is zoomed in for observation of water surface response inside the harbor as shown in fig 5 the water surface within the harbor starts to oscillate from calmness when the pressure disturbance passes through as shown in fig 5 a as the first peak of edge wave passes through water surface inside the harbor rises up and the maximum at the inner end appears after the first peak leaves as shown in fig 5 b and c then water surface inside the harbor falls and the lowest elevation at the inner end appears for the first time after the first trough of edge wave leaves as shown in fig 5 d subsequently water surface oscillation lasts for a period of time and the absolute values of water elevation at the second peak and trough continuously grow as shown in fig 5 e and f it can be illustrated in fig 5 that water surface oscillation within the harbor is a typical fundamental mode i e helmholtz mode with an anti node at its inner end and a node near its entrance which coincides well with theoretical results in section 3 time series of water elevation at three representative locations marked in fig 5 a are compared to show the amplification by the harbor obs1 is the inner end of harbor obs2 is the entrance and obs3 is located close to the shoreline and departs from the harbor the variation of water elevation with time is shown in fig 6 it can be seen clearly that waves outside the harbor obs2 and obs3 are relatively small compared to that at the inner end obs1 the maximum water elevation at the inner end of harbor exceeds 30 times of η r showing much more intense response to the disturbance than the initial incident waves based on the linear assumption the strong scenario disturbance of 5 mb mentioned above may induce severe oscillations with amplitude of 1 5 m under these resonant mechanism fig 6 also shows that growth of the oscillation inside the harbor takes time it should be noted that the oscillation may not grow up when the duration of the disturbance is short but the harbor response time is not too long for some modes of resonance as discussed in bellotti 2007 a resonant mode with narrow width in the amplification diagram needs long time to reach the maximum oscillation and vice versa in the present case the wave amplitude quickly increases to a rather large value only after two wave periods 4 2 criterion to predict the risk of atmospheric disturbances as we can learn from section 3 and 4 a necessary condition for an atmospheric disturbance to induce harbor resonance is the induced waves outside the harbor has similar frequency to one of eigen frequencies of the harbor in addition the induced waves outside the harbor should not be too small which is greatly affected by the translational speed and spatial scale of disturbance as predicted by the theory greenspan 1956 niu 2020 the non dimensional parameter k 0 r m controls the wave outside the harbor here k 0 r m g s u 2 r m is the ratio of disturbance scale to the length of edge wave within the range 0 4 k 0 r m 3 5 the fundamental mode of edge wave would be notable according to niu 2020 in the reference case u 11 m s r m 3 km and s 1 100 mentioned in section 4 1 k 0 r m equals to 2 43 a set of cases with varying u and r m have been conducted and the maximum water elevation inside the harbor is picked out the translational speed u is varying from 2 to 20 m s and the spatial scale r m is varying from 0 5 to 10 km totally 285 cases are computed specifically u 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 m s r m 0 5 1 1 5 2 2 5 3 3 5 4 4 5 5 6 7 8 9 10 km other conditions keep the same as the case shown in the previous section fig 7 shows the maximum water elevation inside the harbor varying with u and r m the maximum η η r is about 43 when u 12 m s and r m 2 km if we consider 5 6 times of the amplitude of the edge wave as extremely dangerous resonant situations i e η η r exceeds 30 u ranges from 11 to 13 m s and k 0 r m from 0 6 to 2 6 which coincides with the previous conclusions well for the specific harbor it is confirmed that severe oscillation may happen when the frequency of predicted edge wave frequency by eq 2 similar to the eigen frequency of harbor i e u 11 m s in this case but it not always happens as demonstrated by the numerical experiments when k 0 r m is larger than 3 5 approximately as shown in fig 8 η η r increases first and then decreases as r m becomes larger which has a peak around r m 2 km it can be explained by the occurrence condition for notable edge waves as a comparison the analytical solution of greenspan 1956 on edge wave generated by a gaussian shaped atmospheric disturbance moving along coastline is also shown in fig 8 the dashed line shows the relative amplitude of fundamental mode of edge wave which computed using the formula given by greenspan 1956 4 η 0 x y t η r 2 π k 0 r m 2 erfc k 0 r m 2 exp k 0 x sin k 0 y u t where erfc k 0 r m 2 is the complementary error function it can be seen from the analytical solution that the occurrence of notable edge wave is confined within a certain range of k 0 r m detailed discussion can be found in the previous studies an et al 2012 niu 2020 niu 2020 pointed out that when k 0 r m is larger than π the edge wave predicted by greenspan s solution is diminishing leading to relatively mild water response inside the harbor when k 0 r m is smaller than 1 2 higher mode of edge wave may be dominant which frequency is 2n 1 times of the fundamental mode and will depart from the harbor eigen frequency overall there are two conditions should be satisfied at the same time to excite severe oscillation in the harbor 1 notable edge waves have been induced by the disturbance travelling along shoreline which can be judged by the parameter k 0 r m 2 the frequency of edge waves f n is similar to one of the harbor eigen frequencies f n for a specific harbor a group of critical translational speeds can be determined from the combination of f n and f n further for each critical translational speed a range of spatial scale can be estimated through the occurrence condition of notable edge waves suggested by niu 2020 generally when the main resonance frequency of a harbor is lower to excite the resonance mode asks for a disturbance with faster translational speed and relatively larger spatial scale 4 3 influence of beach slope previous work is carried out on the same topography and only changes of disturbance parameters are taken into consideration in this section the influence of topography is discussed because the influence of the harbor can be mainly reflected in its eigen frequencies only the beach slope of surrounding area is treated as variable the geometric parameters of the harbor remain the same so that the eigen frequencies of the harbor f n are fixed the beach slope s is adopted to be 0 005 0 01 and 0 02 in three different cases to make the cases comparable the parameters of pressure disturbance are chosen to keep that the fundamental mode of edge wave is excited with same frequency f 0 and k 0 r m the parameters are shown in table 1 over the steeper slope the disturbance with faster translational speed and larger scale can induce edge waves with similar amplitude as shown in fig 9 b fig 9 b shows the water elevation along the shoreline x 0 at t 0 while fig 9 a shows time series of water surface elevation at the inner end of the harbor in each case it can be clearly seen that the water response becomes much more intense as the beach slope becomes steeper as shown in fig 9 a even though the amplitude and the period of edge waves remains the same for s 0 02 the amplitude amplification can be about 50 times but it can only reach about 15 for s 0 005 the phenomenon can be attributed to the ratio of the harbor scale to the wavelength of the induced edge wave as shown in fig 9 b the wavelength of edge waves in the case of milder s is shorter than other cases relatively shorter edge waves can be more intensely affected by the local topography of the harbor in another view shorter edge wave decays more quickly in the seaward direction with same amplitude the shorter edge wave carries less energy which may further result in that less energy transfers into the harbor moreover the local topography at the entrance of the harbor i e the slope of the sidewall along the navigation waterway may slightly affect the evolution of water elevation at the entrance but the impact is limited and does not affect the major conclusion 5 conclusions this study focuses on the response of a harbor to atmospheric disturbances moving along the shoreline the possibility and mechanism for severe oscillations generated inside the harbor are investigated based on the previous analytical solution and numerical modeling two important conditions should be both satisfied to induce harbor resonance 1 notable edge waves have been induced by the pressure disturbance 2 the harbor has similar frequencies to edge waves moreover the duration of the disturbance also contributes to the transient process of the inner water response it shows that a few number of edge waves in the wave packet already can excite large oscillation in the harbor it is displayed that excitation of harbor resonance depends on the translational speed and spatial scale of the disturbance severe oscillations appear only when meeting suitable combinations of the translation speed and the spatial scale for a fixed harbor with certain frequencies f n for example dangerous harbor resonance appears when u is about 11 m s and k 0 r m expands from 0 6 to 2 6 for the idealized harbor adopted in this study the critical translational speed can be determined considering the frequency of edge waves is similar to one of the harbor eigen frequencies the critical range of spatial scale is determined by the occurrence condition for notable edge waves according to the parameter k 0 r m which can refer to niu 2020 in addition the beach slope also impacts the harbor response the critical disturbance for harbors with similar geometry is different when their surrounding areas have different slopes steeper slope asks faster translational speed and larger spatial scale which corresponds to edge waves with longer wavelength it shows that shorter incident edge wave cannot effectively transfer energy into harbors it should be pointed out that topography of natural coasts and harbor geometry are generally complex as well as atmospheric disturbances the situation assumed in the idealized cases is rare in practice but the possibility exists better understanding of the mechanism would be helpful to predict the harbor resonance and to develop early warning methods credit authorship contribution statement qiuyi sun methodology software validation visualization writing original draft xiaojing niu conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the support by the national natural science foundation of china under the grant no 51779125 and the support by state key laboratory of hydroscience and engineering under grant no 2018 ky 01 
20981,sandwich pipe with cement composite core is capable of submarine pipelines application in deepwater harsh environment due to its superior structural resistance and energy absorption capacity this work investigates the denting behavior of sandwich pipes under lateral quasi static loading applied by the wedge shaped denting tool in the presence of internal content pressure and external hydrostatic pressure the finite element models are established and validated against the available experimental results based on the finite element models numerical simulations are carried out to investigate the load indentation responses stress states and failure modes of sandwich pipes along the loading histories furthermore parametric studies are performed to examine the influence of internal and external pressure tip radius width and orientation of the wedge shaped denting tool on the load indentation response finally an analytical model for load indentation relationship prediction of thinner core sandwich pipes is developed the comparison of analytical solutions and finite element results demonstrates a good agreement keywords sandwich pipes lateral indentation internal and external pressure numerical simulation analytical model nomenclature α angle position α p coefficient of pressure on equivalent width α δ parameter effecting of lateral indentation on the equivalent width δ local indentation δ ratio of the local indentation ε c compressive strain of cement material ε t tensile strain of cement material ε c u ultimate compressive strain of cement material ε t 0 ultimate tensile strain of cement material ε c p l compressive equivalent plastic strain of cement material ε t p l tensile equivalent plastic strain of cement material ε s strain value at the yield stress of steel material ε z stretching strain rate θ 0 rotation of the pipe end section v poisson s ratio ξ half length of the indentation zone σ c compressive stress of cement material σ t tensile stress of cement material σ c o initial compressive yield stress of cement material σ c u ultimate compressive stress of cement material σ t 0 ultimate tensile stress of cement material σ o yield stress of steel material φ angle m 0 o plastic moment capacity of the outer pipe wall with a unit width n c e capped end force due to internal pressure force n 0 axial capacity of the pipe wall in unit width n 0 i axial capacity of the inner pipe wall in unit width n 0 o axial capacity of the outer pipe wall in unit width p pressure p c ring crushing force p c r critical buckling pressure of a uniformly pressurized ring p i internal content pressure p o external hydrostatic pressure q normalized pressure χ hollow ratio of sandwich pipe a c equivalent compressive area of cement composite b width of denting tool d c uniaxial damage variable for compression of cement material d c uniaxial damage variable for tension of cement material d external diameter of the pipe d i inside diameter of the inner pipe in the sandwich pipe system d o outside diameter of the outer pipe in the sandwich pipe system e young s modulus of steel material e hardening modulus of steel material e 0 initial elastic modulus of cement material e c rate of ring deformation energy e c d sum rate of ring deformation energy for inner tube and outer tube e l rate of longitudinal stretching energy e l d sum rate of longitudinal stretching energy for inner tube and outer tube e m energy absorbed by the cement composite f denting force f p c normalization force f c compression strength l length of the pipe l x y length of the compressive area along the cross section l y z equivalent width of compressive area in the longitudinal direction m 0 plastic moment capacity of the pipe wall with a unit width m 0 i plastic moment capacity of the r radius of the pipe r i radius of the inner pipe r o radius of the outer pipe r radius of the denting tool t c thickness of the cement composite core in sandwich pipe system t i thickness of the inner pipe in sandwich pipe system t o thickness of the outer pipe in sandwich pipe system u 0 end section velocity w e p r e s s rate of work done by external pressure w i p r e s s rate of work done by internal pressure w vertical displacement of the generator z coordinate in the longitudinal pipe direction 1 introduction increasing energy demand makes the exploitation of oil and gas resources extend to deep water the oil and gas extraction in deep water has driven the development of offshore oil and gas pipeline infrastructure which is the main component of offshore oil and gas field development and production system both onshore and offshore pipelines are prone to external mechanical damage caused by the third party activities offshore pipelines passing beneath offshore platforms are exposed to dropped objects such as drill collars and heavy process equipment brooker 2004 the third party activities became the second leading cause of offshore pipeline failure accidents recorded in china moreover in all accidents third party activities have led to most pollution incidents and production losses jiang et al 2011 the catastrophic consequences caused by external interference imply that the structural resistance of a pipeline against the lateral loads is of particular importance when it suffers from heavy objects impact sandwich pipe composite structures which are pipe in pipe systems consisting of outer pipe inner pipe and core layer have been developed to enhance the resistance of submarine pipeline structures in recent years netto et al 2002 yang et al 2020 wan et al 2020 the structural behavior of sandwich pipes under external loads has been widely studied including collapse local buckling propagation flexural and impact arjomandi and taheri 2011a 2011b evaluated numerically the influence of structural parameters and inter layer adhesion strength on the pressure capacity of sandwich pipes an et al 2014 performed experimental and numerical studies on the collapse behavior of sandwich pipes filled with cementitious composites another type of sandwich pipes using solid polypropylene as core material was investigated by xu et al 2016 the results show that the inter layer adhesion property has significant impact on the collapse capacity of sandwich pipes the further research on the buckling propagation of sandwich pipes with polypropylene core shows that core layer thickness and diameter thickness ratio of inner tube and outer tube have significant effect on the buckle propagation pressure of sandwich pipes gong et al 2019 recently wang and han 2019 conducted numerical analyses on the compressive and flexural behavior of sandwich pipe filled with light weight concrete core material under internal content pressure and external hydrostatic pressure and found that the pressures show strong effect on the structural response of sandwich pipes the above researches on sandwich pipes focus mainly on the pressure bearing capacity or flexural performance of sandwich pipes with the presence of pressures this study aims to explore the behavior of sandwich pipes subjected to lateral loads there are also literature reports on structural response studies related to sandwich pipes impact or crushing wang 2016 investigated the structural behavior of concrete filled sandwich pipe with ends supported conditions under low velocity impact strain and stress states of concrete and steel tubes in sandwich pipe system are observed and the effect of material and geometrical parameters on the impact resistance has been revealed the mid span drop weight impact tests imply that cement filled sandwich pipes demonstrate superior impact resistance smaller global deformation and local indentation in comparison with steel hollow pipes wang et al 2014 qian et al 2015 examined the lateral load local indentation response of free end cement composite filled sandwich pipes under transverse loads and proposed a two stage formulation for load indentation relationship prediction aghdamy et al 2016 2017 dealt with the structural response of concrete filled sandwich pipes subjected to mid span lateral impact followed with parametric studies on the effects of structural and load related parameters on the impact response of sandwich pipes fan et al 2013 explored the dynamic crushing response of aluminum foam core filled sandwich pipes in terms of deformation histories load deformation curves and energy absorption characteristics based on response surface methodology the section optimization design of sandwich pipes with aluminum foam core was conducted by baroutaji et al 2015 the results indicate that cross section configuration with a minimum diameter of the inner tube and a maximum core thickness can provide superior energy absorption capacity aforementioned researches on the impact response of sandwich pipes mainly focuses the pipes with ends supported whereas few studies have reported on the structural behavior of continuously supported sandwich pipe under local lateral loads in addition offshore pipelines are subjected to internal content pressure and external hydrostatic pressure however investigations on the influence of internal and external hydrostatic pressures on the local indentation response of sandwich pipes have not been found in the published literatures existing systematic studies on the steel hollow pipes have provided an important basis for understanding the denting behavior of sandwich pipes deruntz and hodge et al 2016 earlier explored the load deformation response of a thin walled tube between two parallel rigid plates subjected to lateral crushing loads through experimental and analytical methods denting experimental results of the ends simply supported tubes obtained by watson et al 1976 show that very little is gained in the load carrying capacity by increasing the length beyond 10 11d ong and lu 1996 derived a load deformation prediction empirical equation for laterally loaded steel tubes with free end conditions resting on the hard surface based on the test results wierzbicki and suh 1988 studied the denting behavior of pipe under a single transverse load combined axial and bending loads using a simplified three dimensional shell model consisting of a series of unconnected rings and a bundle of unconnected generators in the later researches their theoretical model was verified and widely used zeinoddini and harding 2000 karamanos and andreadakis 2006 arabzadeh and zeinoddini 2013 karamanos and andreadakis 2006 examined and found the presence of internal pressure can increase significantly the denting force of tubes closed formed load deformation expressions for pressurized pipes were proposed using the three dimensional analytical model and validated from the finite element results in their subsequent research another two dimensional heuristic model was developed and derived a three stage analytical expression for load versus indentation depth gresnigt et al 2007 the influence of external pressure on the denting behavior of pipes was also addressed karamanos and eleftheriadis 2004 besides the denting force and indentation depth relationship recommended for engineering application can be found in det norske veritas doucument dnv recommended practice det norske veritas 2010 sandwich pipe composite structures have been demonstrating superior structural resistance and energy absorption capacity optimal cross section configuration enables the sandwich pipes to provide safe submarine oil and gas pipeline solutions to better understand the structural behavior of cement composite filled sandwich pipes under vertical denting loading the current study investigates the quasi static lateral indentation response of sandwich pipes laying on rigid seabed with the presence of internal content pressure and external hydrostatic pressure the finite element model is established and validated against the available experimental results in the literature numerical simulations are performed to study the indentation response during the denting process in particular the influence of pressures denting tool size and orientation on the load indentation response has been examined furthermore this study intends to develop a simplified analytical model to predict the load indentation response of sandwich pipes considering the effect of internal and external pressures the analytical solutions are compared with the finite element results and good agreement is achieved 2 finite element model and verification 2 1 finite element model the present study investigates the indentation behavior of cement composite filled sandwich pipes under vertical lateral loads in the presence of internal content pressure and external hydrostatic pressure sandwich pipe specimens consist of inner steel pipe outer steel pipe and sandwiched cement composite the material of inner pipe and outer pipe was carbon steel ultra lightweight cement composite was selected as the core material the material properties of steel and cement composite were the same as reported by wang et al 2014 and qian et al 2015 as shown in table 1 since the loading type was quasi static the strain rate effects of materials were not considered in the finite element models finite element models of sandwich pipes were established and analyzed using fe package abaqus explicit fig 1 illustrates the finite element model of sandwich pipe used in numerical analysis and the shape of denting tool the width and tip radius of the denting tool are b and r respectively during an analysis the sandwich pipe rests on the seabed and a wedge shaped denting tool vertically dents it at the top of mid span location unless otherwise specified the denting tool orientation is perpendicular to the pipe axis in this study a 4 node doubly curve shell element with reduced integration s4r which is applicable for both thin and thick shell structures was used to simulate the inner and outer steel pipes the cement composite core layer was modeled by the eight node reduced integration solid element c3d8r with hourglass control fully fixed boundary conditions were applied at both end sections of the sandwich pipe the wedge shaped denting tool was modeled as rigid body and constrained to move vertically along the y axis rigid seabed was considered in this work the seabed was also modeled as a rigid body with all rotations and translations being fixed steel material used for inner and outer pipes was modeled by hooke s law of elasticity theory and the j2 flow theory of plasticity associated with von mises yielding criteria and isotropic hardening law as a result a bilinear hardening model was used to simulate the steel material properties the bilinear hardening model for the steel materials could be expressed as follow 1 σ e ε ε ε s σ o e ε ε s ε ε s where e was the young s modulus as shown in table 1 e was the hardening modulus σ o was the yield stress and ε s was strain value at the yield stress ε s 0 2 the values of hardening modulus for outer pipe and inner pipe were 2200 mpa and 2400 mpa respectively regarding cement composite core concrete damage plasticity cdp model was used to simulate the mechanical properties of cement composite which represents the inelastic behavior using the concepts of isotropic damaged elasticity in combination with isotropic tensile and compressive plasticity in cdp model the stress strain curves for uniaxial tension and compression were needed to define elastic plastic and damage behaviors as shown in fig 2 where e 0 was the initial undamaged elastic stiffness of the material σ t and σ c were tensile and compressive stresses respectively ε t and ε c were the corresponding tensile and compressive strains ε t p l and ε c p l refer to the tensile and compressive equivalent plastic strains respectively d t and d c were the uniaxial damage variables for tension and compression respectively σ c 0 was the initial compressive yield stress and σ c u was the ultimate compressive stress σ t 0 was the ultimate tensile stress the stress strain relations under uniaxial tension and compression loading were respectively 2a σ t 1 d t e 0 ε t ε t p l 2b σ c 1 d c e 0 ε c ε c p l the damage parameters d t and d c were calculated by the following expressions 3a d t 1 σ t e 0 1 ε t p l 1 b t 1 σ t e 0 1 3b d c 1 σ c e 0 1 ε c p l 1 b c 1 σ c e 0 1 where b t ε t p l ε t σ t e 0 1 and b c ε t p l ε c σ c e 0 1 represented the proportion of plastic strain in the inelastic strain under tension and compression respectively b t 0 1 and b c 0 7 for abaqus input in this work the uniaxial stress strain relation of tension can be expressed as follow 4 y 1 2 x 0 2 x 6 x 1 x α t x 1 1 7 x x 1 where y σ t σ t 0 x ε t ε t 0 σ t and ε t were the stress and strain of cement based composite respectively σ t 0 was the ultimate compressive stress ε t 0 was the strain corresponding to the ultimate stress ε t 0 0 0004 α t was the model parameters α t 10 the stress strain relations of tension and compression adopted in this work were presented as follow 5 y α a x 3 2 α a x 2 α a 2 x 3 x 1 x α d x 1 2 x x 1 where y σ c σ c u x ε c ε c u σ c and ε c were the stress and strain of cement based composite respectively σ c u was the ultimate compressive stress ε c u was the strain corresponding to the ultimate stress ε c u 0 0048 α a and α d were the model parameters α a 1 05 and α d 5 5 respectively besides plasticity constants were also defined in cdp model the dilation angle was taken as 30 the flow potential eccentricity as 0 1 the ratio of the compressive strength under biaxial loading to uniaxial compressive strength as 1 16 the ratio of the second stress invariant on the tensile meridian as 2 3 and the viscosity as 0 wang and han 2019 surface to surface based interaction with a contact pressure model in the normal direction and a coulomb friction model in the tangential direction was employed to model the contact between steel pipe and cement composite core and the contact between outer steel pipe with all the rigid bodies the steel surfaces of inner pipe and outer pipe were selected as the master surface as they are in contact with the cement composite core layer on the contrary the outer steel surface was defined as slave surface in its contact with the denting tool and seabed in coulomb model a penalty algorithm with friction coefficient 0 6 was used to simulate the contact of steel pipe surfaces with core layer wang and han 2019 a frictionless contact algorithm was used to simulated contact between the outer pipe with denting tool karamanos and andreadakis 2006 multiple analysis steps were established to apply the loads firstly the internal content pressure and external hydrostatic pressure were respectively applied to the inside surface of the inner pipe and outside surface of outer pipe then the pressures were kept constant and the indentation displacement controlled by a reference point was increased gradually 2 2 validation of finite element model the lateral denting experimental results of free end short sandwich pipes reported by qian et al 2015 were used to verify the finite element model in this paper two specimens were analyzed and compared with the available experimental results ccfpip 1 and ccfpip 2 have the same length of 700 mm the same outside diameter of outer pipe of 219 1 mm and the same inner pipe geometry with outside diameter of 139 7 mm and thickness of 5 mm the outer pipe wall thicknesses of ccfpip 1 and ccfpip 2 were 10 mm and 6 3 mm respectively steel pipe with thickness of 6 3 mm has a yield strength 395 mpa the other materials properties of steel pipe and cement composite core was the same with table 1 mesh size convergence analysis indicates that the results tend to convergence when three elements in radical direction for core layer 6 7 mm local element size about 1 16 of the outer pipe radius in the longitudinal direction for area near the loading position and the similar mesh size in the cross section were adopted the quasi static denting was simulated through defining the vertical motion of the denting tool within a certain time no mass scaling technology was used during the simulation to confirm the quasi static solution of the denting process the ratio of the total kinetic energy to the total internal energy and the influence of velocity on the structural response were analyzed as shown in fig 3 and fig 4 a respectively fig 3 demonstrates the total kinetic energy allke is less than 1 of the total internal energy allie during the entire loading process except the beginning phase fig 4 a illustrates the load indentation response is independent of the equivalent loading velocity so that the dynamic effects can be neglected the numerical results of load indentation responses and failure pattern of sandwich pipe specimens were compared with the experimental results in fig 4 overall the load indentation profile obtained from the numerical result was in good agreements with experimental curves the comparison of deformation shape was also very satisfactory where the same asymmetric local indentation deformation were observed this demonstrates that the above finite element models can be employed to predict accurately the denting behavior of sandwich pipes 3 analysis and discussion for the purpose of understanding the indentation response of subsea sandwich pipes with cement composite core the structural behavior of sandwich pipes subjected to vertical transverse loads in the presence of internal content pressure and external hydrostatic pressure was investigated as a comparison the structural behaviors of hollow steel pipes and non pressurized sandwich pipes were also analyzed a case study was carried out on a sandwich pipe lying on a rigid seabed with a water depth of 500 m means external hydrostatic pressure is equal to 5 mpa a conventional internal content pressure of 4 mpa was considered inside the pipelines the outer diameter of the sandwich pipe specimen d o was 219 mm the ratio of thickness to diameter for outer pipe and inner pipe were 0 046 and 0 036 respectively and the hollow ratio χ for sandwich pipe was equal to 0 7 where the hollow ratio was defined as χ d i d o 2 t o in this study fixed end conditions were employed which has been widely used in the previous researches on the denting behavior of steel hollow pipelines karamanos and andreadakis 2006 arabzadeh and zeinoddini 2013 the load indentation response deformation profiles and states of strain and stress were explored 3 1 load indentation responses before exploring the load versus lateral indentation response it is of importance to examine the influence of pipe length on the structural behavior the load indentation relationships for sandwich pipe specimens with different lengths were obtained from the numerical simulations fig 5 illustrates the normalized load indentation relationships where the denting force f is normalized by f p c σ 0 t 2 4 d t d refers to the outer diameter of outer pipe and t is the wall thickness of outer pipe the indentation δ is normalized by outer radius r of the sandwich pipe the graph shows that the load indentation responses demonstrate few variation with the pipe length exceeding six times of the outer diameter which implies that finite element models with length of 6 d can accurately capture the load indentation response characteristics of sandwich pipes with fixed end conditions to clarify the enhancement effect of sandwich configuration on the lateral loads the denting behavior of outer pipe in the sandwich pipe system was also analyzed fig 6 shows the load indentation profiles for single hollow outer steel pipe and sandwich pipes with two different hollow ratios the area below the load indentation curves indicates the amount of energy absorbed during the denting process both hollow steel pipe and sandwich pipes share a similar shape of load indentation profile at the initial small deformation stages the denting force grows approximately linear with the development of indentation this stage is defined as elastic phase after the elastic phase the denting force slowly rises with the increase of deformation this nonlinear behavior is due to the strain hardening of materials and the activation of membrane longitudinal stress of steel pipes in comparison with the single hollow steel pipe sandwich pipes clearly exhibit much higher indentation resistance due the composite action of sandwich configuration on the one hand the cement composite material itself has high compressive strength and can contribute to denting load resistance on the other hand during the denting process the cement composite is under confining stress state which implies that the outer pipe cement based composite and inner pipe work together to resist the lateral denting load in addition the confining effect of steel pipes causes the improvement of compressive strength plasticity and ductility the indentation resistance and energy absorption capacity of the sandwich pipe are enhanced significantly due to the composite effect sandwich pipe with hollow ratio χ 0 5 has a thicker core layer thickness than the one with hollow ratio χ 0 7 the response profiles show that the increase in thickness of cement composite core leads to significant improvement of the indentation resistance the most likely cause of the increase in the indentation resistance is that the thicker core layer has dissipated more energy as reflected in fig 7 a the plastic energy dissipated by the core layer with hollow ratio 0 5 is about 2 8 times of that absorbed by the core layer with hollow ratio 0 7 the larger equivalent plastic strain volume observed in the thicker core layer can also explain the above phenomenon in fig 7 b and c fig 7 d shows the plastic dissipation ratio of each component inner pipe core and outer pipe it can be found that the outer pipe absorbs the most energy compared with the cement core and the inner pipe in sandwich pipe system with different hollow ratios it can be explained by the greater wall thickness of the outer pipe on the contrary the inner pipe demonstrates the lowest energy dissipation ratio because of the protection of outer pipe and cement core material it is worth noting that the increase of core thickness can improve its energy dissipation capacity and provide better protection to the steel pipes in addition the stress response histories of steel pipes in sandwich pipes were examined the values of mises stress at the top horizontal and bottom positions of the mid span cross section loading position of the pipeline were extracted for analyzing fig 8 a presents the stress histories of inner pipe and outer pipe of the sandwich pipe with hollow ratio of 0 7 the stress curves follows a multi segment mode at the elastic phases the stresses grow approximately linearly as depicted by hooke s law after the stresses exceeding the yield limit the steel material exhibits obvious strain hardening characteristics which result in a gentle slope of stress history curves the graph reveals that the stress levels at top position 1 are higher evidently than horizontal position 2 and bottom position 3 for both the outer pipe and inner pipe of the sandwich pipe moreover position 1 and position 3 of inner pipe seem experienced slightly larger stress level than the corresponding position at outer pipe when the stresses develop to plastic stage the outer pipes of two sandwich pipes with different cement composite core thickness show close stress levels as depicted by fig 8 b it can be found that the increase in core thickness can greatly enhance the lateral indentation resistance but it seems to have little effect on the stress states of steel pipes in a sandwich pipe system 3 2 deformation histories the deformation of pipelines under lateral loads is a noteworthy feature figs 9 and 10 exhibit the deformation for two sandwich pipes with hollow ratio of 0 7 and 0 5 for both thinner and thicker sandwich pipes it can be found that three layers of the sandwich pipes indent simultaneously due to the large elastic modulus of the cement composite core an apparent asymmetrical deformation pattern about the horizontal plane was obtained during the loading processes as shown in fig 9 a the mid span section deformation pattern of sandwich pipe with thinner core χ 0 7 consists of one flat segment on the position of applied load and four arcs on both sides which is consistent with the four hinges plastic mechanism of ring proposed by wierzbicki and suh 1988 in the case of thicker core the above ring mechanism is still applicable in the case where the lateral deformation is less than 60 mm δ r 0 55 nevertheless two parallel flat segments occurred simultaneously at the loading position and the bottom support position in the condition of δ 70 mm and δ 87 mm as depicted by fig 9 b the graphs also revealed that most of energy is dissipated by the materials in the upper side according to the plastic deformation states the final global deformation shapes in fig 10 show that the plastic deformation only occurs near the mid span area of applied loads the sandwich pipe with thicker core led to a more localized indentation in the pipe longitudinal direction this can be confirmed by the longitudinal neutral profile of the deformed pipes in fig 11 a additionally the increase in thickness of core layer contributed to a flatter mid span cross section due to the reduction of the section bending rigidity as illustrated by fig 11 b 3 3 parametric studies so far this paper has focused on denting behavior of sandwich pipes under lateral vertical loads the following section will conduct parametric studies to examine the influence of internal content pressure and external hydrostatic pressure on pipe lateral denting resistance in terms of load indentation relationship and the effects of denting tool size and orientation with regard to the internal and external pressure the possible real design pressures were employed in the analyses rather than the percentage pressure levels of the full plastic pressure of the pipeline as depicted in literatures arabzadeh and zeinoddini 2013 gresnigt et al 2007 since the collapse pressure of sandwich pipes is generally much higher than the real operation pressures tip dimension axial width and axis orientation of the wedge shaped denting tool were taken into account in the parametric studies fig 12 a and b show respectively the influence of external pressure and internal pressure on the load indentation profiles for sandwich pipes with χ 0 7 it can be found that the increase of external pressure leads to apparent drop of denting force especially for the case of external pressure equals to 30 mpa and 40 mpa the significant variation of equilibrium paths suggest that external pressure causes additional cross sectional deformation decreases pipe stiffness and results in a substantial reduction of the lateral indentation resistance on the contrary the presence of internal pressure improve the lateral load carrying capacity due to the enhancement of internal pressure on the cross sectional ovalization resistance in the condition of sandwich pipes with χ 0 5 as shown in fig 12 c and d the external pressure results in insignificantly reduction of lateral carrying capacity but sandwich pipes remain the same equilibrium paths the internal pressure shows slightly enhancement effect on the lateral carrying capacity both the figures show that the effect of internal pressure is more significant than the external pressure by comparing the amplitude of pressures variation the enhancement of pipelines structural resistance caused by the increase of core thickness is a key factor in decrease of pressure effect it is worth emphasizing that external pressure shows destabilizing effects on thinner sandwich pipes which can be seen from the load indentation response of sandwich pipes with a hollow ratio of 0 7 falling in the typical submarine pipeline structure size range when the external pressure level is low the load indentation equilibrium path is a monotonically increasing function while relatively high external pressure such as 30 mpa and 40 mpa will result in a equilibrium path with an instability limit point as shown in fig 12 a it suggests that the high external pressure causes a significant decrease of the ultimate denting resistance and even results in a premature collapse of the dented sandwich pipe fig 13 depicted the indentation failure modes of sandwich pipes under different external pressure levels for 5 mpa external pressure sandwich pipe remains stable throughout and exhibits a more localized unilateral indentation deformation in terms of the longitudinal pipe direction in the case of 40 mpa pressure a final dog bone overall collapse mode can be obtained due to the local collapse propagation along the longitudinal pipe direction aroused by the relatively high external pressure the comparison shows that the higher pressure tends to aggravate the indentation of sandwich pipe under the same indenter displacement in fact after the indentation reaching a certain level the high external hydrostatic pressure will provoke a local collapse and further propagation along the pipeline which finally causes the overall collapse failure of the sandwich pipe to clarify the effects of the denting tool related parameters sandwich pipes with hollow ratio 0 7 were analyzed in the presence of 5 mpa external hydrostatic pressure and 4 mpa internal content pressure the influence of tip radius of the wedge shaped denting tool is presented in fig 14 a the numerical results show that the sandwich pipe is more prone to lateral collapse under the impact of sharper wedge shaped denting tool nonetheless the influence of tip size on lateral bearing capacity is not significant in the current range of parameters fig 14 b illustrates the denting response of sandwich pipes subjected to lateral loads stemming from wedge shaped denting tool with different width denting tool with b d o 0 3 has a evidently lower denting force response owing to the smaller denting tool width results in more localized lateral indentation it also can be found that the sandwich pipes show stable load resistance when the width of the denting tool exceeds a certain value b d o 0 9 wedge shaped denting tool orientation causes distinguish difference on both equilibrium paths and indentation shapes as shown in fig 14 c and d the results indicate that the lateral compressive stiffness of sandwich pipes shows obvious anisotropy and longitudinal direction of pipeline has largest initial cross sectional stiffness while the other two cases are close the load indentation profile shows a snap through characteristic after the elastic response phase which reveals that sandwich pipe shows greater membrane stress before indentation reaching approximately δ r 0 3 4 simplified analytical model qian et al 2015 have derived a two stage load indentation formulation for cement composite filled pipe in pipe structures based on the simplified rigidly plastic cylindrical shell model proposed by wierzbicki and suh 1988 in the current study the above model is appropriately extended to investigate the indentation load displacement response of internal and external pressurized pipe in pipe sandwich structure with fixed end condition subjected to transverse loads the derivation of load displacement starts from the steel hollow pipe and then extends to the sandwich pipe 4 1 analytical model for steel hollow pipes the local denting of pipes under lateral loads belongs to a three dimensional problem to address the issue of pipe denting a 3d shell model was proposed by wierzbicki and suh 1988 the model consists of a series of unconnected rings and a bundle of unconnected generators as shown in fig 15 a and b in which the circumferentially inextensible rings and the generators are loosely connected this assumption makes the rings and generators are compatible in lateral deformations but there is no shear transfer between them for pipes subjected to a transverse load plastic deformation generally occurs over a limited length region on both sides of the dent center see fig 16 based on the principle of virtual velocities the rate equilibrium equation of work energy is 6 f δ w p r e s s 2 n c e u 0 e c e l where f is the denting force δ is the velocity of denting w p r e s s is the rate of work done by internal and external pressure n c e is the capped end force due to internal pressure force u 0 is the end section velocity e c is the rate of ring deformation energy e l is the rate of longitudinal stretching energy of generator this equation is applicable for both fixed end and capped end conditions karamanos and andreadakis 2006 it is worth noting that the fixed end sectional boundary condition does not mean that the pipe ends are really fixed but just represent the idealized deformation conditions of the pipeline at a far distance from the region of the applied lateral load arabzadeh and zeinoddini 2013 for fixed end conditions θ 0 0 and u 0 0 eq 6 leads to the following expression 7 f δ w p r e s s e c e l 4 1 1 crushing behavior of rings the cross section deformation of a pipe under a wide wedge shaped indenter can be modeled by a rigid plastic model with four moving plastic hinges as illustrated in fig 16 b this four hinge plastic mechanism is in good agreement with experimental observation demonstrated by zeinodini and harding 2000 and karamanos and andreadakis 2006 the deformed shape consists of one flat segment on the top and four arcs since the rings are assumed to be inextensible the total length of deformed section is always equal to 2 π r the lateral displacement of arbitrary point on the shell is a function of angle α hoop coordinate and the axial coordinate z expressed as w α z the lateral displacement of the shell at the denting center α 0 z 0 is denoted by δ w 0 0 the ring deformation energy rate is 8 e c 2 0 ξ p c w c d z where p c is the ring crushing force for the plastic mechanism under consideration as recommended by wierzbicki and suh 1988 assuming a constant value for the ring crushing force p c equal to 9 p c 8 m 0 r and it is further assumed that the lateral deformation rate w c along the shell is linear so that 10 w c δ 1 z ξ where ξ is the half length as shown in fig 16 substituting eqs 9 and 10 into eq 8 yields an expression for the total crushing energy rate of the whole series of rings 11 e c 8 m 0 ξ δ r where m 0 is the plastic bending moment of the pipe wall with unit width equal to σ 0 t 2 4 4 1 2 stretching of the generators longitudinal stretching of the pipe needs to be considered treating the generators as rigid plastic beams the nonlinear axial strain is 12 ε 1 d u d z 1 2 d w d z 2 thus the total stretching strain rate ε z for a single generator from z 0 to z l is 13 ε z 0 ξ d u d z d w d z d w d z d z the rate of total stretching energy is 14 e l 4 σ 0 r t 0 π ε z d α the above integral is evaluated for the particular cased of capped end and fixed end conditions karamanos and andreadakis 2006 calculated the stretching energy rates for fixed end conditions in the case of fixed end conditions the stretching energy rate is obtained as follows 15 e l 4 n 0 r 0 π δ δ l 1 α π 2 d α 4 n 0 r π δ δ 3 ξ where n 0 σ 0 t is the axial capacity of the pipe wall in unit width 4 1 3 contributions of internal and external pressure effects of internal and external pressure on the denting behavior of pipe are included in the present study the external pressure does positive work whereas the internal pressure would provide denting resistance the virtual work done by pressure is equal to the production of pressure times the variation of change of enclosed cross section area consequently the work rate of pressure can be expressed as 16 w p r e s s p ξ ξ δ a d z 2 p 0 ξ δ a d z where p p i p o p i is the internal pressure p o is the external pressure based on the deformed geometry of cross section as shown in fig 16 the change of area enclosed by the cross section follows the below expression 17 δ a r π φ r 1 2 π φ r 2 2 2 r 1 w c r 2 r 1 r 2 sin φ where 18 w c 2 π 2 φ φ sin φ 2 φ π 1 cos φ 2 φ π 1 cos φ through a curve fitting procedure karamanos and andreadakis 2006 proposed expression for the change rate of ring cross section 19 δ a 0 237 δ 2 1 z ξ 4 1 r 1 7728 δ 1 z ξ 2 0 1172 r δ 1 z ξ substituting eq 19 to eq 16 the rate of work done by internal pressure becomes 20 w p r e s s 0 1172 0 8864 δ r 0 079 δ r 2 p ξ r δ p g ξ r δ where g is a function of x δ r 21 g x 0 1172 0 8864 x 0 079 x 2 4 1 4 calculation of denting length and force for fixed end conditions eqs 11 15 and 20 are replaced in eq 7 to obtain the energy rate balance equation 22 f δ p g r ξ δ 8 m 0 ξ δ r 4 n 0 r π δ δ 3 ξ for an arbitrary value of δ the denting force expression in terms of denting displacement and denting length is written as 23 f 8 m 0 ξ r 4 n 0 r π δ 3 ξ p g r ξ minimizing of f in eq 23 with respect to ξ f ξ 0 the denting half length ξ can be obtained as a function of denting displacement δ in dimensionless form 24 ξ r 4 π 3 x 2 t r q g x substitution of eq 24 into eq 23 results in a closed form solution for the denting force in terms of denting displacement in dimensionless form normalized by f p c σ 0 t 2 4 d t 25 f f i x 8 2 π r 3 t x 2 t r q g x herein q p p 0 represents the normalized pressure and p 0 2 σ 0 t d is the fully plastic pressure 4 2 simplified analytical solution for sandwich pipes for sandwich pipes eq 25 may not provide sufficient prediction accuracy for the full load displacement relationships by introducing equivalent wall thicknesses qian et al 2015 in this study a simplified assumption is made that the inner tube outer tube and sandwiched cement composite provide independently the indentation resistance this assumption leads to the balance equation of energy rate for sandwich pipes with fixed end condition 26 f δ w e p r e s s w i p r e s s e c d e l d e m where f refers to the denting force w e p r e s s is the rate of work done by the external pressure w i p r e s s is the rate of work done by the internal pressure e c d is the sum rate of ring deformation energy for inner tube and outer tube e l d is the sum rate of longitudinal stretching energy of generator for inner tube and outer tube e m is the energy absorbed by the cement composite according to eq 20 in the case of sandwich pipes the rate of work done by internal and external pressure respectively are obtained 27 w e p r e s s p o r o g x ξ δ 28 w i p r e s s p i r i g x 1 ξ δ where x 1 r o r i x the total crushing energy rate for inner tube and outer tube is equal to 29 e c d 8 m 0 o ξ δ r o 8 m 0 i ξ δ r i where m 0 o is the plastic moment of the pipe wall with unit width for outer tube equal to σ 0 t o 2 4 m 0 i is the plastic moment of the pipe wall with unit width for the inner tube equal to σ 0 t i 2 4 the longitudinal stretching energy for inner tube and outer tube is 30 e l d 4 n 0 o r o n 0 i r i π δ δ 3 ξ where n 0 o σ 0 t o and n 0 i σ 0 t i refers to the axial capacity of pipe wall in unit width for the inner tube and outer tube respectively it is difficult to calculate accurately the energy absorption of cement composite core by analytical method the present method utilizes an approximate area to withstand the lateral denting force for arbitrary δ the approximate compressive area follows 31 a c l x y l y z 2 t c ξ α p 2 t c α δ α p ξ where l x y 2 t c is the length of the compressive area along the cross section qian et al 2015 l y z α δ α p ξ is the equivalent width of compressive area in the longitudinal direction depending on the pressure effects and lateral indentation in which α p is a coefficient of pressure on equivalent width equals to α p 2 3 2 p c r p c r p o 4 5 p c r p c r p i and p c r is the critical buckling pressure of a uniformly pressurized ring p c r 3 e t 3 12 1 v 2 r 3 gresnigt et al 2004 α δ is a parameter characterizing the effect of lateral indentation on the equivalent width α δ 0 6 0 625 δ r 2 δ r considering the pressure effect the unit energy absorption capacity of cement composite is defined as 32 f m f c p o p i consequently the total energy absorbed by the cement composite is obtained 33 e m f m a c δ 2 f c p o p i t c α δ α p ξ δ eqs 27 30 and 33 are replaced in eq 26 to yield the following expression 34 f δ p o r o g x ξ δ p i r i g r o r i x ξ δ 8 m 0 o ξ δ r o 8 m 0 i ξ δ r i 4 n 0 o r o n 0 i r i π δ δ 3 ξ 2 f c p o p i t c α δ α p ξ δ for an arbitrary value of δ the denting force expression in terms of denting displacement and denting length can be present as 35 f 2 σ 0 t o 2 r o t i 2 r i ξ 4 σ 0 t o r o t i r i π δ 3 ξ 2 f c p o p i t c α δ α p ξ p i r i g r o r i x p o r o g x ξ at the minimum denting force f with f ξ 0 the denting length of sandwich pipes with fixed end conditions is expressed as 36 ξ 4 π 3 x σ 0 t o r o t i r i r o 2 σ 0 t o 2 r o t i 2 r i p i r i g r o r i x p o r o g x 2 f c p o p i t c α δ α p substituting eq 36 into eq 35 the load displacement relationship for sandwich pipes with fixed end conditions can be obtained 37 f 4 σ 0 π 3 x t o r o t i r i r o 2 t o 2 r o t i 2 r i h x where h x p i r i g r 0 r i x p o r o g x 2 f c p o p i α δ α p t c σ 0 the denting force can be normalized by f p c σ 0 t o 2 4 2 r o t o so that a non dimensional form of denting force in terms of denting displacement can be obtained 38 f s p 8 r i t o 2 π 3 x r o r i t i t o 2 t o r o 2 r o r i t i r i 2 h x where h x is dimensionless function of x δ r which is as follows 39 h x p i g r o r i x p o r o r i g x 2 f c p o p i α δ α p r o r i t o r i 1 σ 0 furthermore r i r o is a function of hollow ratio χ and is as follows 40 r i r o 1 t o r o χ it can be found from eqs 38 40 that the denting resistance of sandwich pipes depends on the denting displacement x the radius to thickness ratio of outer pipe r o t o the radius to thickness ratio of inner pipe r i t i the hollow ratio χ the ratio of wall thickness of inner pipe to outer pipe t i t o the internal and external pressure p i and p o and the compressive strength of cement based composite f c the equations imply that the denting resistance is an increasing function of the ratio of wall thickness of inner pipe to outer pipe t i t o the internal pressure p i and the compressive strength of cement based composite f c and a decreasing function of the radius to thickness ratio of outer pipe r o t o the radius to thickness ratio of inner pipe r i t i the hollow ratio χ and the external pressure p o these rules are helpful to guide pipeline design 4 3 validating the prediction of simplified analytical model for load indentation response of sandwich pipe with thinner core thickness are compared with the finite element results as shown fig 17 fig 17 a and b show respectively the load indentation response for different external pressure and internal pressure the comparison indicates that the analytical model shows good agreement with the finite element results especially for the condition of internal pressure variation in the case of external pressure change the analytical solutions would emerge slight divergence with the finite element results under relatively high external pressure levels the possible cause may be due to the fact that the high external pressure strengthens the nonlinear denting behavior of the sandwich pipe note that the present analytical model is only applicable for the load indentation predictions of thinner core thickness sandwich pipes χ 0 7 since the three dimensional shell model applied in this paper has been developed for the thin walled tubular members wierzbicki and suh 1988 karamanos and andreadakis 2006 for the sandwich pipes with thicker core χ 0 5 the increase in cement composite core thickness reduces the pressure effects and greatly improves the denting resistance of sandwich pipes which leads to the proposed simplified analytical model significantly underestimates the load indentation response of such thicker core sandwich pipes the different failure mode of thicker core sandwich pipes as shown in fig 9 also supports this fact 5 conclusion the lateral indentation response of cement composite filled sandwich pipes in the presence of internal and external pressures is investigated in the current study finite element models are developed to explore the load indentation responses deformation histories of sandwich pipes further parametric studies are carried out to examine the effects of internal content pressure external pressure and denting tool related parameters on the structural behaviors a load indentation relationship expression for thinner core sandwich pipes is obtained based on a simplified rigidly plastic cylindrical shell model the researches above result in the following conclusions 1 compared with the steel hollow pipe sandwich pipes show apparently stronger denting resistance and energy absorption capacity the presence of cement composite core significantly contribute to the denting resistance and energy absorption capacity and results in a more localized indentation deformation specifically the cement composite in the area above the inner pipe dissipates more energy 2 relatively large hollow ratio χ 0 7 produces a longer indentation length and a cross section deformation pattern consisting of one flat segment in the region of the applied load and four arcs on both sides which suggests the same deformation mechanism with the thin walled steel pipe the decrease of hollow ratio restricts the indentation length causing a more localized deformation and a flatter cross section deformation including two flat segment and two arcs can be obtained 3 parametric studies on internal external pressure and indenter parameters are conducted note that the internal and external pressure exhibit opposite effect on the denting resistance of sandwich pipes the external hydrostatic pressure causes a significant decrease of the ultimate denting resistance and a substantial reduction of energy absorption capacity of sandwich pipes moreover the excessive external pressure would provoke a local collapse and further propagation so that the whole sandwich pipe is destroyed 4 a simplified analytical model has been derived for predicting the load indentation relationship of sandwich pipes with a relatively large hollow ratio χ 0 7 which falls in the typical offshore pipeline structure size range the good agreement between the analytical solution and the finite element results demonstrates the applicability of the proposed analytical model it has also been found from the dimensionless analytical model that denting resistance force is an increasing function of t i t o and f c and a decreasing function of r o t o r i t i and χ which contributes to geometric parameters design of pipeline the study in this paper also has some limitations more parameters including material properties geometric configuration of pipeline cross section and seabed soil properties should be considered in further experimental and theoretical researches credit authorship contribution statement feng wan conceptualization methodology software feng guan conceptualization writing original draftwriting original draft yibo deng investigation data curation shaohu liu software validating yonghui liu writing review editing peng huang visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the author s disclosed receipt of the following financial support for the research authorship and or publication of this article this work was jointly supported by the national natural science foundation of china no 51604039 and the yangtze fund for youth teams of science and technology innovation no 2016cqt01 
20981,sandwich pipe with cement composite core is capable of submarine pipelines application in deepwater harsh environment due to its superior structural resistance and energy absorption capacity this work investigates the denting behavior of sandwich pipes under lateral quasi static loading applied by the wedge shaped denting tool in the presence of internal content pressure and external hydrostatic pressure the finite element models are established and validated against the available experimental results based on the finite element models numerical simulations are carried out to investigate the load indentation responses stress states and failure modes of sandwich pipes along the loading histories furthermore parametric studies are performed to examine the influence of internal and external pressure tip radius width and orientation of the wedge shaped denting tool on the load indentation response finally an analytical model for load indentation relationship prediction of thinner core sandwich pipes is developed the comparison of analytical solutions and finite element results demonstrates a good agreement keywords sandwich pipes lateral indentation internal and external pressure numerical simulation analytical model nomenclature α angle position α p coefficient of pressure on equivalent width α δ parameter effecting of lateral indentation on the equivalent width δ local indentation δ ratio of the local indentation ε c compressive strain of cement material ε t tensile strain of cement material ε c u ultimate compressive strain of cement material ε t 0 ultimate tensile strain of cement material ε c p l compressive equivalent plastic strain of cement material ε t p l tensile equivalent plastic strain of cement material ε s strain value at the yield stress of steel material ε z stretching strain rate θ 0 rotation of the pipe end section v poisson s ratio ξ half length of the indentation zone σ c compressive stress of cement material σ t tensile stress of cement material σ c o initial compressive yield stress of cement material σ c u ultimate compressive stress of cement material σ t 0 ultimate tensile stress of cement material σ o yield stress of steel material φ angle m 0 o plastic moment capacity of the outer pipe wall with a unit width n c e capped end force due to internal pressure force n 0 axial capacity of the pipe wall in unit width n 0 i axial capacity of the inner pipe wall in unit width n 0 o axial capacity of the outer pipe wall in unit width p pressure p c ring crushing force p c r critical buckling pressure of a uniformly pressurized ring p i internal content pressure p o external hydrostatic pressure q normalized pressure χ hollow ratio of sandwich pipe a c equivalent compressive area of cement composite b width of denting tool d c uniaxial damage variable for compression of cement material d c uniaxial damage variable for tension of cement material d external diameter of the pipe d i inside diameter of the inner pipe in the sandwich pipe system d o outside diameter of the outer pipe in the sandwich pipe system e young s modulus of steel material e hardening modulus of steel material e 0 initial elastic modulus of cement material e c rate of ring deformation energy e c d sum rate of ring deformation energy for inner tube and outer tube e l rate of longitudinal stretching energy e l d sum rate of longitudinal stretching energy for inner tube and outer tube e m energy absorbed by the cement composite f denting force f p c normalization force f c compression strength l length of the pipe l x y length of the compressive area along the cross section l y z equivalent width of compressive area in the longitudinal direction m 0 plastic moment capacity of the pipe wall with a unit width m 0 i plastic moment capacity of the r radius of the pipe r i radius of the inner pipe r o radius of the outer pipe r radius of the denting tool t c thickness of the cement composite core in sandwich pipe system t i thickness of the inner pipe in sandwich pipe system t o thickness of the outer pipe in sandwich pipe system u 0 end section velocity w e p r e s s rate of work done by external pressure w i p r e s s rate of work done by internal pressure w vertical displacement of the generator z coordinate in the longitudinal pipe direction 1 introduction increasing energy demand makes the exploitation of oil and gas resources extend to deep water the oil and gas extraction in deep water has driven the development of offshore oil and gas pipeline infrastructure which is the main component of offshore oil and gas field development and production system both onshore and offshore pipelines are prone to external mechanical damage caused by the third party activities offshore pipelines passing beneath offshore platforms are exposed to dropped objects such as drill collars and heavy process equipment brooker 2004 the third party activities became the second leading cause of offshore pipeline failure accidents recorded in china moreover in all accidents third party activities have led to most pollution incidents and production losses jiang et al 2011 the catastrophic consequences caused by external interference imply that the structural resistance of a pipeline against the lateral loads is of particular importance when it suffers from heavy objects impact sandwich pipe composite structures which are pipe in pipe systems consisting of outer pipe inner pipe and core layer have been developed to enhance the resistance of submarine pipeline structures in recent years netto et al 2002 yang et al 2020 wan et al 2020 the structural behavior of sandwich pipes under external loads has been widely studied including collapse local buckling propagation flexural and impact arjomandi and taheri 2011a 2011b evaluated numerically the influence of structural parameters and inter layer adhesion strength on the pressure capacity of sandwich pipes an et al 2014 performed experimental and numerical studies on the collapse behavior of sandwich pipes filled with cementitious composites another type of sandwich pipes using solid polypropylene as core material was investigated by xu et al 2016 the results show that the inter layer adhesion property has significant impact on the collapse capacity of sandwich pipes the further research on the buckling propagation of sandwich pipes with polypropylene core shows that core layer thickness and diameter thickness ratio of inner tube and outer tube have significant effect on the buckle propagation pressure of sandwich pipes gong et al 2019 recently wang and han 2019 conducted numerical analyses on the compressive and flexural behavior of sandwich pipe filled with light weight concrete core material under internal content pressure and external hydrostatic pressure and found that the pressures show strong effect on the structural response of sandwich pipes the above researches on sandwich pipes focus mainly on the pressure bearing capacity or flexural performance of sandwich pipes with the presence of pressures this study aims to explore the behavior of sandwich pipes subjected to lateral loads there are also literature reports on structural response studies related to sandwich pipes impact or crushing wang 2016 investigated the structural behavior of concrete filled sandwich pipe with ends supported conditions under low velocity impact strain and stress states of concrete and steel tubes in sandwich pipe system are observed and the effect of material and geometrical parameters on the impact resistance has been revealed the mid span drop weight impact tests imply that cement filled sandwich pipes demonstrate superior impact resistance smaller global deformation and local indentation in comparison with steel hollow pipes wang et al 2014 qian et al 2015 examined the lateral load local indentation response of free end cement composite filled sandwich pipes under transverse loads and proposed a two stage formulation for load indentation relationship prediction aghdamy et al 2016 2017 dealt with the structural response of concrete filled sandwich pipes subjected to mid span lateral impact followed with parametric studies on the effects of structural and load related parameters on the impact response of sandwich pipes fan et al 2013 explored the dynamic crushing response of aluminum foam core filled sandwich pipes in terms of deformation histories load deformation curves and energy absorption characteristics based on response surface methodology the section optimization design of sandwich pipes with aluminum foam core was conducted by baroutaji et al 2015 the results indicate that cross section configuration with a minimum diameter of the inner tube and a maximum core thickness can provide superior energy absorption capacity aforementioned researches on the impact response of sandwich pipes mainly focuses the pipes with ends supported whereas few studies have reported on the structural behavior of continuously supported sandwich pipe under local lateral loads in addition offshore pipelines are subjected to internal content pressure and external hydrostatic pressure however investigations on the influence of internal and external hydrostatic pressures on the local indentation response of sandwich pipes have not been found in the published literatures existing systematic studies on the steel hollow pipes have provided an important basis for understanding the denting behavior of sandwich pipes deruntz and hodge et al 2016 earlier explored the load deformation response of a thin walled tube between two parallel rigid plates subjected to lateral crushing loads through experimental and analytical methods denting experimental results of the ends simply supported tubes obtained by watson et al 1976 show that very little is gained in the load carrying capacity by increasing the length beyond 10 11d ong and lu 1996 derived a load deformation prediction empirical equation for laterally loaded steel tubes with free end conditions resting on the hard surface based on the test results wierzbicki and suh 1988 studied the denting behavior of pipe under a single transverse load combined axial and bending loads using a simplified three dimensional shell model consisting of a series of unconnected rings and a bundle of unconnected generators in the later researches their theoretical model was verified and widely used zeinoddini and harding 2000 karamanos and andreadakis 2006 arabzadeh and zeinoddini 2013 karamanos and andreadakis 2006 examined and found the presence of internal pressure can increase significantly the denting force of tubes closed formed load deformation expressions for pressurized pipes were proposed using the three dimensional analytical model and validated from the finite element results in their subsequent research another two dimensional heuristic model was developed and derived a three stage analytical expression for load versus indentation depth gresnigt et al 2007 the influence of external pressure on the denting behavior of pipes was also addressed karamanos and eleftheriadis 2004 besides the denting force and indentation depth relationship recommended for engineering application can be found in det norske veritas doucument dnv recommended practice det norske veritas 2010 sandwich pipe composite structures have been demonstrating superior structural resistance and energy absorption capacity optimal cross section configuration enables the sandwich pipes to provide safe submarine oil and gas pipeline solutions to better understand the structural behavior of cement composite filled sandwich pipes under vertical denting loading the current study investigates the quasi static lateral indentation response of sandwich pipes laying on rigid seabed with the presence of internal content pressure and external hydrostatic pressure the finite element model is established and validated against the available experimental results in the literature numerical simulations are performed to study the indentation response during the denting process in particular the influence of pressures denting tool size and orientation on the load indentation response has been examined furthermore this study intends to develop a simplified analytical model to predict the load indentation response of sandwich pipes considering the effect of internal and external pressures the analytical solutions are compared with the finite element results and good agreement is achieved 2 finite element model and verification 2 1 finite element model the present study investigates the indentation behavior of cement composite filled sandwich pipes under vertical lateral loads in the presence of internal content pressure and external hydrostatic pressure sandwich pipe specimens consist of inner steel pipe outer steel pipe and sandwiched cement composite the material of inner pipe and outer pipe was carbon steel ultra lightweight cement composite was selected as the core material the material properties of steel and cement composite were the same as reported by wang et al 2014 and qian et al 2015 as shown in table 1 since the loading type was quasi static the strain rate effects of materials were not considered in the finite element models finite element models of sandwich pipes were established and analyzed using fe package abaqus explicit fig 1 illustrates the finite element model of sandwich pipe used in numerical analysis and the shape of denting tool the width and tip radius of the denting tool are b and r respectively during an analysis the sandwich pipe rests on the seabed and a wedge shaped denting tool vertically dents it at the top of mid span location unless otherwise specified the denting tool orientation is perpendicular to the pipe axis in this study a 4 node doubly curve shell element with reduced integration s4r which is applicable for both thin and thick shell structures was used to simulate the inner and outer steel pipes the cement composite core layer was modeled by the eight node reduced integration solid element c3d8r with hourglass control fully fixed boundary conditions were applied at both end sections of the sandwich pipe the wedge shaped denting tool was modeled as rigid body and constrained to move vertically along the y axis rigid seabed was considered in this work the seabed was also modeled as a rigid body with all rotations and translations being fixed steel material used for inner and outer pipes was modeled by hooke s law of elasticity theory and the j2 flow theory of plasticity associated with von mises yielding criteria and isotropic hardening law as a result a bilinear hardening model was used to simulate the steel material properties the bilinear hardening model for the steel materials could be expressed as follow 1 σ e ε ε ε s σ o e ε ε s ε ε s where e was the young s modulus as shown in table 1 e was the hardening modulus σ o was the yield stress and ε s was strain value at the yield stress ε s 0 2 the values of hardening modulus for outer pipe and inner pipe were 2200 mpa and 2400 mpa respectively regarding cement composite core concrete damage plasticity cdp model was used to simulate the mechanical properties of cement composite which represents the inelastic behavior using the concepts of isotropic damaged elasticity in combination with isotropic tensile and compressive plasticity in cdp model the stress strain curves for uniaxial tension and compression were needed to define elastic plastic and damage behaviors as shown in fig 2 where e 0 was the initial undamaged elastic stiffness of the material σ t and σ c were tensile and compressive stresses respectively ε t and ε c were the corresponding tensile and compressive strains ε t p l and ε c p l refer to the tensile and compressive equivalent plastic strains respectively d t and d c were the uniaxial damage variables for tension and compression respectively σ c 0 was the initial compressive yield stress and σ c u was the ultimate compressive stress σ t 0 was the ultimate tensile stress the stress strain relations under uniaxial tension and compression loading were respectively 2a σ t 1 d t e 0 ε t ε t p l 2b σ c 1 d c e 0 ε c ε c p l the damage parameters d t and d c were calculated by the following expressions 3a d t 1 σ t e 0 1 ε t p l 1 b t 1 σ t e 0 1 3b d c 1 σ c e 0 1 ε c p l 1 b c 1 σ c e 0 1 where b t ε t p l ε t σ t e 0 1 and b c ε t p l ε c σ c e 0 1 represented the proportion of plastic strain in the inelastic strain under tension and compression respectively b t 0 1 and b c 0 7 for abaqus input in this work the uniaxial stress strain relation of tension can be expressed as follow 4 y 1 2 x 0 2 x 6 x 1 x α t x 1 1 7 x x 1 where y σ t σ t 0 x ε t ε t 0 σ t and ε t were the stress and strain of cement based composite respectively σ t 0 was the ultimate compressive stress ε t 0 was the strain corresponding to the ultimate stress ε t 0 0 0004 α t was the model parameters α t 10 the stress strain relations of tension and compression adopted in this work were presented as follow 5 y α a x 3 2 α a x 2 α a 2 x 3 x 1 x α d x 1 2 x x 1 where y σ c σ c u x ε c ε c u σ c and ε c were the stress and strain of cement based composite respectively σ c u was the ultimate compressive stress ε c u was the strain corresponding to the ultimate stress ε c u 0 0048 α a and α d were the model parameters α a 1 05 and α d 5 5 respectively besides plasticity constants were also defined in cdp model the dilation angle was taken as 30 the flow potential eccentricity as 0 1 the ratio of the compressive strength under biaxial loading to uniaxial compressive strength as 1 16 the ratio of the second stress invariant on the tensile meridian as 2 3 and the viscosity as 0 wang and han 2019 surface to surface based interaction with a contact pressure model in the normal direction and a coulomb friction model in the tangential direction was employed to model the contact between steel pipe and cement composite core and the contact between outer steel pipe with all the rigid bodies the steel surfaces of inner pipe and outer pipe were selected as the master surface as they are in contact with the cement composite core layer on the contrary the outer steel surface was defined as slave surface in its contact with the denting tool and seabed in coulomb model a penalty algorithm with friction coefficient 0 6 was used to simulate the contact of steel pipe surfaces with core layer wang and han 2019 a frictionless contact algorithm was used to simulated contact between the outer pipe with denting tool karamanos and andreadakis 2006 multiple analysis steps were established to apply the loads firstly the internal content pressure and external hydrostatic pressure were respectively applied to the inside surface of the inner pipe and outside surface of outer pipe then the pressures were kept constant and the indentation displacement controlled by a reference point was increased gradually 2 2 validation of finite element model the lateral denting experimental results of free end short sandwich pipes reported by qian et al 2015 were used to verify the finite element model in this paper two specimens were analyzed and compared with the available experimental results ccfpip 1 and ccfpip 2 have the same length of 700 mm the same outside diameter of outer pipe of 219 1 mm and the same inner pipe geometry with outside diameter of 139 7 mm and thickness of 5 mm the outer pipe wall thicknesses of ccfpip 1 and ccfpip 2 were 10 mm and 6 3 mm respectively steel pipe with thickness of 6 3 mm has a yield strength 395 mpa the other materials properties of steel pipe and cement composite core was the same with table 1 mesh size convergence analysis indicates that the results tend to convergence when three elements in radical direction for core layer 6 7 mm local element size about 1 16 of the outer pipe radius in the longitudinal direction for area near the loading position and the similar mesh size in the cross section were adopted the quasi static denting was simulated through defining the vertical motion of the denting tool within a certain time no mass scaling technology was used during the simulation to confirm the quasi static solution of the denting process the ratio of the total kinetic energy to the total internal energy and the influence of velocity on the structural response were analyzed as shown in fig 3 and fig 4 a respectively fig 3 demonstrates the total kinetic energy allke is less than 1 of the total internal energy allie during the entire loading process except the beginning phase fig 4 a illustrates the load indentation response is independent of the equivalent loading velocity so that the dynamic effects can be neglected the numerical results of load indentation responses and failure pattern of sandwich pipe specimens were compared with the experimental results in fig 4 overall the load indentation profile obtained from the numerical result was in good agreements with experimental curves the comparison of deformation shape was also very satisfactory where the same asymmetric local indentation deformation were observed this demonstrates that the above finite element models can be employed to predict accurately the denting behavior of sandwich pipes 3 analysis and discussion for the purpose of understanding the indentation response of subsea sandwich pipes with cement composite core the structural behavior of sandwich pipes subjected to vertical transverse loads in the presence of internal content pressure and external hydrostatic pressure was investigated as a comparison the structural behaviors of hollow steel pipes and non pressurized sandwich pipes were also analyzed a case study was carried out on a sandwich pipe lying on a rigid seabed with a water depth of 500 m means external hydrostatic pressure is equal to 5 mpa a conventional internal content pressure of 4 mpa was considered inside the pipelines the outer diameter of the sandwich pipe specimen d o was 219 mm the ratio of thickness to diameter for outer pipe and inner pipe were 0 046 and 0 036 respectively and the hollow ratio χ for sandwich pipe was equal to 0 7 where the hollow ratio was defined as χ d i d o 2 t o in this study fixed end conditions were employed which has been widely used in the previous researches on the denting behavior of steel hollow pipelines karamanos and andreadakis 2006 arabzadeh and zeinoddini 2013 the load indentation response deformation profiles and states of strain and stress were explored 3 1 load indentation responses before exploring the load versus lateral indentation response it is of importance to examine the influence of pipe length on the structural behavior the load indentation relationships for sandwich pipe specimens with different lengths were obtained from the numerical simulations fig 5 illustrates the normalized load indentation relationships where the denting force f is normalized by f p c σ 0 t 2 4 d t d refers to the outer diameter of outer pipe and t is the wall thickness of outer pipe the indentation δ is normalized by outer radius r of the sandwich pipe the graph shows that the load indentation responses demonstrate few variation with the pipe length exceeding six times of the outer diameter which implies that finite element models with length of 6 d can accurately capture the load indentation response characteristics of sandwich pipes with fixed end conditions to clarify the enhancement effect of sandwich configuration on the lateral loads the denting behavior of outer pipe in the sandwich pipe system was also analyzed fig 6 shows the load indentation profiles for single hollow outer steel pipe and sandwich pipes with two different hollow ratios the area below the load indentation curves indicates the amount of energy absorbed during the denting process both hollow steel pipe and sandwich pipes share a similar shape of load indentation profile at the initial small deformation stages the denting force grows approximately linear with the development of indentation this stage is defined as elastic phase after the elastic phase the denting force slowly rises with the increase of deformation this nonlinear behavior is due to the strain hardening of materials and the activation of membrane longitudinal stress of steel pipes in comparison with the single hollow steel pipe sandwich pipes clearly exhibit much higher indentation resistance due the composite action of sandwich configuration on the one hand the cement composite material itself has high compressive strength and can contribute to denting load resistance on the other hand during the denting process the cement composite is under confining stress state which implies that the outer pipe cement based composite and inner pipe work together to resist the lateral denting load in addition the confining effect of steel pipes causes the improvement of compressive strength plasticity and ductility the indentation resistance and energy absorption capacity of the sandwich pipe are enhanced significantly due to the composite effect sandwich pipe with hollow ratio χ 0 5 has a thicker core layer thickness than the one with hollow ratio χ 0 7 the response profiles show that the increase in thickness of cement composite core leads to significant improvement of the indentation resistance the most likely cause of the increase in the indentation resistance is that the thicker core layer has dissipated more energy as reflected in fig 7 a the plastic energy dissipated by the core layer with hollow ratio 0 5 is about 2 8 times of that absorbed by the core layer with hollow ratio 0 7 the larger equivalent plastic strain volume observed in the thicker core layer can also explain the above phenomenon in fig 7 b and c fig 7 d shows the plastic dissipation ratio of each component inner pipe core and outer pipe it can be found that the outer pipe absorbs the most energy compared with the cement core and the inner pipe in sandwich pipe system with different hollow ratios it can be explained by the greater wall thickness of the outer pipe on the contrary the inner pipe demonstrates the lowest energy dissipation ratio because of the protection of outer pipe and cement core material it is worth noting that the increase of core thickness can improve its energy dissipation capacity and provide better protection to the steel pipes in addition the stress response histories of steel pipes in sandwich pipes were examined the values of mises stress at the top horizontal and bottom positions of the mid span cross section loading position of the pipeline were extracted for analyzing fig 8 a presents the stress histories of inner pipe and outer pipe of the sandwich pipe with hollow ratio of 0 7 the stress curves follows a multi segment mode at the elastic phases the stresses grow approximately linearly as depicted by hooke s law after the stresses exceeding the yield limit the steel material exhibits obvious strain hardening characteristics which result in a gentle slope of stress history curves the graph reveals that the stress levels at top position 1 are higher evidently than horizontal position 2 and bottom position 3 for both the outer pipe and inner pipe of the sandwich pipe moreover position 1 and position 3 of inner pipe seem experienced slightly larger stress level than the corresponding position at outer pipe when the stresses develop to plastic stage the outer pipes of two sandwich pipes with different cement composite core thickness show close stress levels as depicted by fig 8 b it can be found that the increase in core thickness can greatly enhance the lateral indentation resistance but it seems to have little effect on the stress states of steel pipes in a sandwich pipe system 3 2 deformation histories the deformation of pipelines under lateral loads is a noteworthy feature figs 9 and 10 exhibit the deformation for two sandwich pipes with hollow ratio of 0 7 and 0 5 for both thinner and thicker sandwich pipes it can be found that three layers of the sandwich pipes indent simultaneously due to the large elastic modulus of the cement composite core an apparent asymmetrical deformation pattern about the horizontal plane was obtained during the loading processes as shown in fig 9 a the mid span section deformation pattern of sandwich pipe with thinner core χ 0 7 consists of one flat segment on the position of applied load and four arcs on both sides which is consistent with the four hinges plastic mechanism of ring proposed by wierzbicki and suh 1988 in the case of thicker core the above ring mechanism is still applicable in the case where the lateral deformation is less than 60 mm δ r 0 55 nevertheless two parallel flat segments occurred simultaneously at the loading position and the bottom support position in the condition of δ 70 mm and δ 87 mm as depicted by fig 9 b the graphs also revealed that most of energy is dissipated by the materials in the upper side according to the plastic deformation states the final global deformation shapes in fig 10 show that the plastic deformation only occurs near the mid span area of applied loads the sandwich pipe with thicker core led to a more localized indentation in the pipe longitudinal direction this can be confirmed by the longitudinal neutral profile of the deformed pipes in fig 11 a additionally the increase in thickness of core layer contributed to a flatter mid span cross section due to the reduction of the section bending rigidity as illustrated by fig 11 b 3 3 parametric studies so far this paper has focused on denting behavior of sandwich pipes under lateral vertical loads the following section will conduct parametric studies to examine the influence of internal content pressure and external hydrostatic pressure on pipe lateral denting resistance in terms of load indentation relationship and the effects of denting tool size and orientation with regard to the internal and external pressure the possible real design pressures were employed in the analyses rather than the percentage pressure levels of the full plastic pressure of the pipeline as depicted in literatures arabzadeh and zeinoddini 2013 gresnigt et al 2007 since the collapse pressure of sandwich pipes is generally much higher than the real operation pressures tip dimension axial width and axis orientation of the wedge shaped denting tool were taken into account in the parametric studies fig 12 a and b show respectively the influence of external pressure and internal pressure on the load indentation profiles for sandwich pipes with χ 0 7 it can be found that the increase of external pressure leads to apparent drop of denting force especially for the case of external pressure equals to 30 mpa and 40 mpa the significant variation of equilibrium paths suggest that external pressure causes additional cross sectional deformation decreases pipe stiffness and results in a substantial reduction of the lateral indentation resistance on the contrary the presence of internal pressure improve the lateral load carrying capacity due to the enhancement of internal pressure on the cross sectional ovalization resistance in the condition of sandwich pipes with χ 0 5 as shown in fig 12 c and d the external pressure results in insignificantly reduction of lateral carrying capacity but sandwich pipes remain the same equilibrium paths the internal pressure shows slightly enhancement effect on the lateral carrying capacity both the figures show that the effect of internal pressure is more significant than the external pressure by comparing the amplitude of pressures variation the enhancement of pipelines structural resistance caused by the increase of core thickness is a key factor in decrease of pressure effect it is worth emphasizing that external pressure shows destabilizing effects on thinner sandwich pipes which can be seen from the load indentation response of sandwich pipes with a hollow ratio of 0 7 falling in the typical submarine pipeline structure size range when the external pressure level is low the load indentation equilibrium path is a monotonically increasing function while relatively high external pressure such as 30 mpa and 40 mpa will result in a equilibrium path with an instability limit point as shown in fig 12 a it suggests that the high external pressure causes a significant decrease of the ultimate denting resistance and even results in a premature collapse of the dented sandwich pipe fig 13 depicted the indentation failure modes of sandwich pipes under different external pressure levels for 5 mpa external pressure sandwich pipe remains stable throughout and exhibits a more localized unilateral indentation deformation in terms of the longitudinal pipe direction in the case of 40 mpa pressure a final dog bone overall collapse mode can be obtained due to the local collapse propagation along the longitudinal pipe direction aroused by the relatively high external pressure the comparison shows that the higher pressure tends to aggravate the indentation of sandwich pipe under the same indenter displacement in fact after the indentation reaching a certain level the high external hydrostatic pressure will provoke a local collapse and further propagation along the pipeline which finally causes the overall collapse failure of the sandwich pipe to clarify the effects of the denting tool related parameters sandwich pipes with hollow ratio 0 7 were analyzed in the presence of 5 mpa external hydrostatic pressure and 4 mpa internal content pressure the influence of tip radius of the wedge shaped denting tool is presented in fig 14 a the numerical results show that the sandwich pipe is more prone to lateral collapse under the impact of sharper wedge shaped denting tool nonetheless the influence of tip size on lateral bearing capacity is not significant in the current range of parameters fig 14 b illustrates the denting response of sandwich pipes subjected to lateral loads stemming from wedge shaped denting tool with different width denting tool with b d o 0 3 has a evidently lower denting force response owing to the smaller denting tool width results in more localized lateral indentation it also can be found that the sandwich pipes show stable load resistance when the width of the denting tool exceeds a certain value b d o 0 9 wedge shaped denting tool orientation causes distinguish difference on both equilibrium paths and indentation shapes as shown in fig 14 c and d the results indicate that the lateral compressive stiffness of sandwich pipes shows obvious anisotropy and longitudinal direction of pipeline has largest initial cross sectional stiffness while the other two cases are close the load indentation profile shows a snap through characteristic after the elastic response phase which reveals that sandwich pipe shows greater membrane stress before indentation reaching approximately δ r 0 3 4 simplified analytical model qian et al 2015 have derived a two stage load indentation formulation for cement composite filled pipe in pipe structures based on the simplified rigidly plastic cylindrical shell model proposed by wierzbicki and suh 1988 in the current study the above model is appropriately extended to investigate the indentation load displacement response of internal and external pressurized pipe in pipe sandwich structure with fixed end condition subjected to transverse loads the derivation of load displacement starts from the steel hollow pipe and then extends to the sandwich pipe 4 1 analytical model for steel hollow pipes the local denting of pipes under lateral loads belongs to a three dimensional problem to address the issue of pipe denting a 3d shell model was proposed by wierzbicki and suh 1988 the model consists of a series of unconnected rings and a bundle of unconnected generators as shown in fig 15 a and b in which the circumferentially inextensible rings and the generators are loosely connected this assumption makes the rings and generators are compatible in lateral deformations but there is no shear transfer between them for pipes subjected to a transverse load plastic deformation generally occurs over a limited length region on both sides of the dent center see fig 16 based on the principle of virtual velocities the rate equilibrium equation of work energy is 6 f δ w p r e s s 2 n c e u 0 e c e l where f is the denting force δ is the velocity of denting w p r e s s is the rate of work done by internal and external pressure n c e is the capped end force due to internal pressure force u 0 is the end section velocity e c is the rate of ring deformation energy e l is the rate of longitudinal stretching energy of generator this equation is applicable for both fixed end and capped end conditions karamanos and andreadakis 2006 it is worth noting that the fixed end sectional boundary condition does not mean that the pipe ends are really fixed but just represent the idealized deformation conditions of the pipeline at a far distance from the region of the applied lateral load arabzadeh and zeinoddini 2013 for fixed end conditions θ 0 0 and u 0 0 eq 6 leads to the following expression 7 f δ w p r e s s e c e l 4 1 1 crushing behavior of rings the cross section deformation of a pipe under a wide wedge shaped indenter can be modeled by a rigid plastic model with four moving plastic hinges as illustrated in fig 16 b this four hinge plastic mechanism is in good agreement with experimental observation demonstrated by zeinodini and harding 2000 and karamanos and andreadakis 2006 the deformed shape consists of one flat segment on the top and four arcs since the rings are assumed to be inextensible the total length of deformed section is always equal to 2 π r the lateral displacement of arbitrary point on the shell is a function of angle α hoop coordinate and the axial coordinate z expressed as w α z the lateral displacement of the shell at the denting center α 0 z 0 is denoted by δ w 0 0 the ring deformation energy rate is 8 e c 2 0 ξ p c w c d z where p c is the ring crushing force for the plastic mechanism under consideration as recommended by wierzbicki and suh 1988 assuming a constant value for the ring crushing force p c equal to 9 p c 8 m 0 r and it is further assumed that the lateral deformation rate w c along the shell is linear so that 10 w c δ 1 z ξ where ξ is the half length as shown in fig 16 substituting eqs 9 and 10 into eq 8 yields an expression for the total crushing energy rate of the whole series of rings 11 e c 8 m 0 ξ δ r where m 0 is the plastic bending moment of the pipe wall with unit width equal to σ 0 t 2 4 4 1 2 stretching of the generators longitudinal stretching of the pipe needs to be considered treating the generators as rigid plastic beams the nonlinear axial strain is 12 ε 1 d u d z 1 2 d w d z 2 thus the total stretching strain rate ε z for a single generator from z 0 to z l is 13 ε z 0 ξ d u d z d w d z d w d z d z the rate of total stretching energy is 14 e l 4 σ 0 r t 0 π ε z d α the above integral is evaluated for the particular cased of capped end and fixed end conditions karamanos and andreadakis 2006 calculated the stretching energy rates for fixed end conditions in the case of fixed end conditions the stretching energy rate is obtained as follows 15 e l 4 n 0 r 0 π δ δ l 1 α π 2 d α 4 n 0 r π δ δ 3 ξ where n 0 σ 0 t is the axial capacity of the pipe wall in unit width 4 1 3 contributions of internal and external pressure effects of internal and external pressure on the denting behavior of pipe are included in the present study the external pressure does positive work whereas the internal pressure would provide denting resistance the virtual work done by pressure is equal to the production of pressure times the variation of change of enclosed cross section area consequently the work rate of pressure can be expressed as 16 w p r e s s p ξ ξ δ a d z 2 p 0 ξ δ a d z where p p i p o p i is the internal pressure p o is the external pressure based on the deformed geometry of cross section as shown in fig 16 the change of area enclosed by the cross section follows the below expression 17 δ a r π φ r 1 2 π φ r 2 2 2 r 1 w c r 2 r 1 r 2 sin φ where 18 w c 2 π 2 φ φ sin φ 2 φ π 1 cos φ 2 φ π 1 cos φ through a curve fitting procedure karamanos and andreadakis 2006 proposed expression for the change rate of ring cross section 19 δ a 0 237 δ 2 1 z ξ 4 1 r 1 7728 δ 1 z ξ 2 0 1172 r δ 1 z ξ substituting eq 19 to eq 16 the rate of work done by internal pressure becomes 20 w p r e s s 0 1172 0 8864 δ r 0 079 δ r 2 p ξ r δ p g ξ r δ where g is a function of x δ r 21 g x 0 1172 0 8864 x 0 079 x 2 4 1 4 calculation of denting length and force for fixed end conditions eqs 11 15 and 20 are replaced in eq 7 to obtain the energy rate balance equation 22 f δ p g r ξ δ 8 m 0 ξ δ r 4 n 0 r π δ δ 3 ξ for an arbitrary value of δ the denting force expression in terms of denting displacement and denting length is written as 23 f 8 m 0 ξ r 4 n 0 r π δ 3 ξ p g r ξ minimizing of f in eq 23 with respect to ξ f ξ 0 the denting half length ξ can be obtained as a function of denting displacement δ in dimensionless form 24 ξ r 4 π 3 x 2 t r q g x substitution of eq 24 into eq 23 results in a closed form solution for the denting force in terms of denting displacement in dimensionless form normalized by f p c σ 0 t 2 4 d t 25 f f i x 8 2 π r 3 t x 2 t r q g x herein q p p 0 represents the normalized pressure and p 0 2 σ 0 t d is the fully plastic pressure 4 2 simplified analytical solution for sandwich pipes for sandwich pipes eq 25 may not provide sufficient prediction accuracy for the full load displacement relationships by introducing equivalent wall thicknesses qian et al 2015 in this study a simplified assumption is made that the inner tube outer tube and sandwiched cement composite provide independently the indentation resistance this assumption leads to the balance equation of energy rate for sandwich pipes with fixed end condition 26 f δ w e p r e s s w i p r e s s e c d e l d e m where f refers to the denting force w e p r e s s is the rate of work done by the external pressure w i p r e s s is the rate of work done by the internal pressure e c d is the sum rate of ring deformation energy for inner tube and outer tube e l d is the sum rate of longitudinal stretching energy of generator for inner tube and outer tube e m is the energy absorbed by the cement composite according to eq 20 in the case of sandwich pipes the rate of work done by internal and external pressure respectively are obtained 27 w e p r e s s p o r o g x ξ δ 28 w i p r e s s p i r i g x 1 ξ δ where x 1 r o r i x the total crushing energy rate for inner tube and outer tube is equal to 29 e c d 8 m 0 o ξ δ r o 8 m 0 i ξ δ r i where m 0 o is the plastic moment of the pipe wall with unit width for outer tube equal to σ 0 t o 2 4 m 0 i is the plastic moment of the pipe wall with unit width for the inner tube equal to σ 0 t i 2 4 the longitudinal stretching energy for inner tube and outer tube is 30 e l d 4 n 0 o r o n 0 i r i π δ δ 3 ξ where n 0 o σ 0 t o and n 0 i σ 0 t i refers to the axial capacity of pipe wall in unit width for the inner tube and outer tube respectively it is difficult to calculate accurately the energy absorption of cement composite core by analytical method the present method utilizes an approximate area to withstand the lateral denting force for arbitrary δ the approximate compressive area follows 31 a c l x y l y z 2 t c ξ α p 2 t c α δ α p ξ where l x y 2 t c is the length of the compressive area along the cross section qian et al 2015 l y z α δ α p ξ is the equivalent width of compressive area in the longitudinal direction depending on the pressure effects and lateral indentation in which α p is a coefficient of pressure on equivalent width equals to α p 2 3 2 p c r p c r p o 4 5 p c r p c r p i and p c r is the critical buckling pressure of a uniformly pressurized ring p c r 3 e t 3 12 1 v 2 r 3 gresnigt et al 2004 α δ is a parameter characterizing the effect of lateral indentation on the equivalent width α δ 0 6 0 625 δ r 2 δ r considering the pressure effect the unit energy absorption capacity of cement composite is defined as 32 f m f c p o p i consequently the total energy absorbed by the cement composite is obtained 33 e m f m a c δ 2 f c p o p i t c α δ α p ξ δ eqs 27 30 and 33 are replaced in eq 26 to yield the following expression 34 f δ p o r o g x ξ δ p i r i g r o r i x ξ δ 8 m 0 o ξ δ r o 8 m 0 i ξ δ r i 4 n 0 o r o n 0 i r i π δ δ 3 ξ 2 f c p o p i t c α δ α p ξ δ for an arbitrary value of δ the denting force expression in terms of denting displacement and denting length can be present as 35 f 2 σ 0 t o 2 r o t i 2 r i ξ 4 σ 0 t o r o t i r i π δ 3 ξ 2 f c p o p i t c α δ α p ξ p i r i g r o r i x p o r o g x ξ at the minimum denting force f with f ξ 0 the denting length of sandwich pipes with fixed end conditions is expressed as 36 ξ 4 π 3 x σ 0 t o r o t i r i r o 2 σ 0 t o 2 r o t i 2 r i p i r i g r o r i x p o r o g x 2 f c p o p i t c α δ α p substituting eq 36 into eq 35 the load displacement relationship for sandwich pipes with fixed end conditions can be obtained 37 f 4 σ 0 π 3 x t o r o t i r i r o 2 t o 2 r o t i 2 r i h x where h x p i r i g r 0 r i x p o r o g x 2 f c p o p i α δ α p t c σ 0 the denting force can be normalized by f p c σ 0 t o 2 4 2 r o t o so that a non dimensional form of denting force in terms of denting displacement can be obtained 38 f s p 8 r i t o 2 π 3 x r o r i t i t o 2 t o r o 2 r o r i t i r i 2 h x where h x is dimensionless function of x δ r which is as follows 39 h x p i g r o r i x p o r o r i g x 2 f c p o p i α δ α p r o r i t o r i 1 σ 0 furthermore r i r o is a function of hollow ratio χ and is as follows 40 r i r o 1 t o r o χ it can be found from eqs 38 40 that the denting resistance of sandwich pipes depends on the denting displacement x the radius to thickness ratio of outer pipe r o t o the radius to thickness ratio of inner pipe r i t i the hollow ratio χ the ratio of wall thickness of inner pipe to outer pipe t i t o the internal and external pressure p i and p o and the compressive strength of cement based composite f c the equations imply that the denting resistance is an increasing function of the ratio of wall thickness of inner pipe to outer pipe t i t o the internal pressure p i and the compressive strength of cement based composite f c and a decreasing function of the radius to thickness ratio of outer pipe r o t o the radius to thickness ratio of inner pipe r i t i the hollow ratio χ and the external pressure p o these rules are helpful to guide pipeline design 4 3 validating the prediction of simplified analytical model for load indentation response of sandwich pipe with thinner core thickness are compared with the finite element results as shown fig 17 fig 17 a and b show respectively the load indentation response for different external pressure and internal pressure the comparison indicates that the analytical model shows good agreement with the finite element results especially for the condition of internal pressure variation in the case of external pressure change the analytical solutions would emerge slight divergence with the finite element results under relatively high external pressure levels the possible cause may be due to the fact that the high external pressure strengthens the nonlinear denting behavior of the sandwich pipe note that the present analytical model is only applicable for the load indentation predictions of thinner core thickness sandwich pipes χ 0 7 since the three dimensional shell model applied in this paper has been developed for the thin walled tubular members wierzbicki and suh 1988 karamanos and andreadakis 2006 for the sandwich pipes with thicker core χ 0 5 the increase in cement composite core thickness reduces the pressure effects and greatly improves the denting resistance of sandwich pipes which leads to the proposed simplified analytical model significantly underestimates the load indentation response of such thicker core sandwich pipes the different failure mode of thicker core sandwich pipes as shown in fig 9 also supports this fact 5 conclusion the lateral indentation response of cement composite filled sandwich pipes in the presence of internal and external pressures is investigated in the current study finite element models are developed to explore the load indentation responses deformation histories of sandwich pipes further parametric studies are carried out to examine the effects of internal content pressure external pressure and denting tool related parameters on the structural behaviors a load indentation relationship expression for thinner core sandwich pipes is obtained based on a simplified rigidly plastic cylindrical shell model the researches above result in the following conclusions 1 compared with the steel hollow pipe sandwich pipes show apparently stronger denting resistance and energy absorption capacity the presence of cement composite core significantly contribute to the denting resistance and energy absorption capacity and results in a more localized indentation deformation specifically the cement composite in the area above the inner pipe dissipates more energy 2 relatively large hollow ratio χ 0 7 produces a longer indentation length and a cross section deformation pattern consisting of one flat segment in the region of the applied load and four arcs on both sides which suggests the same deformation mechanism with the thin walled steel pipe the decrease of hollow ratio restricts the indentation length causing a more localized deformation and a flatter cross section deformation including two flat segment and two arcs can be obtained 3 parametric studies on internal external pressure and indenter parameters are conducted note that the internal and external pressure exhibit opposite effect on the denting resistance of sandwich pipes the external hydrostatic pressure causes a significant decrease of the ultimate denting resistance and a substantial reduction of energy absorption capacity of sandwich pipes moreover the excessive external pressure would provoke a local collapse and further propagation so that the whole sandwich pipe is destroyed 4 a simplified analytical model has been derived for predicting the load indentation relationship of sandwich pipes with a relatively large hollow ratio χ 0 7 which falls in the typical offshore pipeline structure size range the good agreement between the analytical solution and the finite element results demonstrates the applicability of the proposed analytical model it has also been found from the dimensionless analytical model that denting resistance force is an increasing function of t i t o and f c and a decreasing function of r o t o r i t i and χ which contributes to geometric parameters design of pipeline the study in this paper also has some limitations more parameters including material properties geometric configuration of pipeline cross section and seabed soil properties should be considered in further experimental and theoretical researches credit authorship contribution statement feng wan conceptualization methodology software feng guan conceptualization writing original draftwriting original draft yibo deng investigation data curation shaohu liu software validating yonghui liu writing review editing peng huang visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the author s disclosed receipt of the following financial support for the research authorship and or publication of this article this work was jointly supported by the national natural science foundation of china no 51604039 and the yangtze fund for youth teams of science and technology innovation no 2016cqt01 
20982,the method of combining incompressible hybrid reynolds average navier stokes large eddy simulation rans les with an acoustic perturbation equation was studied to accurately predict the flow and noise performances in nasa tandem cylinder experiments in this approach acoustic waves simultaneously propagate in the time domain with an unsteady turbulent flow the experiment was performed under the condition of a reynolds number of 1 66 105 based on the cylinder diameter which provided detailed surface pressure and flow field measurements the improved delayed detached eddy simulation iddes model established in this study was consistent with the experimental results except for the flow field behind the rear cylinder which was caused by an early separation relative to the experiment the acoustic results showed that the rear cylinder dominated the noise radiation which indicated that the pressure fluctuation caused by wake interference was greater than that caused by vortex shedding acoustic predictions were also obtained using an acoustic analogy approach based on the fh w method three kinds of integral surfaces ps open ps close and ips were made for the acoustic predictions using the ffowcs williams hawkings method this study also showed that wavenumber decomposition could be utilised to quantify the mechanisms related to turbulent convection and sound propagation an iddes hybrid model for predicting near field and far field noise was established which could be applied to practical engineering applications keywords iddes aeroacoustics ape permeable surface wavenumber decomposition 1 introduction the reynolds average navier stokes rans equation is generally used under the condition of a large reynolds number when appropriate turbulence models are adopted a complex geometry can be numerically simulated with a very small time cost and suitable results can be obtained however the rans method has limited accuracy for the flow separation at the tail of a bluff body especially when there is no fixed separation point the rans equation cannot effectively simulate the pressure fluctuation and vortex shedding process on the surface of an object caused by separation thus it cannot directly simulate aeroacoustics for cases where it is necessary to capture the details of the flow field with high precision the large eddy simulation les method needs to be used however les is a turbulence resolving simulation method that requires fine computational grids near the wall boundary and small time steps the combination of the les and rans methods which is often referred to as the rans les hybrid method performs reasonably well in terms of both efficiency and accuracy when simulating flows with massive separation at a large reynolds number shur et al 2008 for more detailed information on the existing hybrid rans les methods please refer to sagaut sagaut et al 2012 or froehlich and von terzi fröhlich and von terzi 2008 this type of hybrid model has been successfully applied to complex numerical simulations with large reynolds numbers and has achieved varying degrees of success fröhlich and von terzi 2008 chen et al 2019 frendi et al 2006 gopalan and jaiman 2015 weinmann et al 2014 since this hybrid model was proposed many studies gopalan and jaiman 2015 weinmann et al 2014 have evaluated its performance weinmann et al 2014 proposed a modified flow simulation methodology fsm approach the fsm was proposed for the kω sst two equation model fsm sst and for an explicit algebraic stress model fsm easm these two hybrid models were used to accurately simulate the flow and noise fields of tandem cylinders which was a benchmark experiment for nasa the fsm sst method performed better than the fsm easm using the nasa experiment data gopalan et al gopalan and jaiman 2015 used hybrid urans les models based on linear and non linear eddy viscosity formulations to model tandem circular cylinders with reynolds numbers of 1 66 105 for three different pacing l to diameter d ratios l d 1 4 3 0 and 3 7 the results showed that the nonlinear hybrid model was better for aerodynamic force coefficients and turbulent wake simulation unfortunately the noise predictions of the different hybrid models were not analysed in this study two cylinders in tandem are a common configuration when studying wake interaction which is of great significance for the generation of fluid induced vibration and noise in a variety of engineering applications on land or offshore multiple parallel or nearly parallel structures are often observed such as the risers of deep sea drilling systems landing gear of aircraft and bogies and pantographs of high speed trains the hydrodynamics of tandem cylinders under the action of cross flow has always been a research hotspot in the field of fluid mechanics and fluid structure interactions the wake of two tandem cylinders involves flow separation shear layer interference quasi periodic vortices vortex impingement fluid resonance and recirculation younis et al 2016 igarashi 1981 and zdravkovich 1987 categorised different flow regimes based on space ratio l l d where l is the distance from the centre of one cylinder to the centre of the other and d is the cylinder diameter the inter cylindrical distance and the reynolds number the free shear layer separated from the front cylinder passes over the rear cylinder in a small space which is called the extended body flow the free shear layers separated from the front cylinder reattach to the surface of the rear cylinder when the approximate space ratio is less than 3 8 forming the reattachment flow for space ratio l 3 8 the vortex shedding of the two cylinders develops independently and the shear layer separated by the front cylinder will not be reattached to the rear cylinder which is called the co shedding flow the shear layer attachment and co shedding flows may appear intermittently at a critical lc meaning that the flow is bistable an intermittent large fluctuation in pressure on the front cylinder was observed when the flow field was under bistable conditions obviously critical spacing lc is also related to the reynolds number for a detailed discussion of the classification and analysis please refer to the literature younis et al 2016 in view of the fact that the tandem cylinder is widely used in engineering and can reveal the fluid mechanics of the wake interaction it has been a benchmark model adopted by the nasa lockard 2011 to evaluate the ability of numerical simulation to predict the both near field unsteady flow and the acoustic radiation in this workshop the results of surface pressure fluctuation near field unsteady flow and far field radiated noise computed by the fh w method of fifteen submissions mainly based on the hybrid rans les methods are summarized and compared against the detailed experimental data at present most of the literature on aerodynamic noise is based on the ffowcs williams hawkings fw h equation and different integral surfaces permeable and impermeable surfaces lockard 2011 lockard et al 2007 2008 caraeni et al 2011 spalart et al 2011 tan et al 2018 west and caraeni 2015 zhu et al 2017 spalart et al 2011 used incompressible and compressible detached eddy simulations des to simulate the flow field of the four wheel rudimentary landing gear rlg and the solid surface pressure fluctuation the far field noise and corresponding psd spectra were presented at the same time the author made a detailed comparative analysis of the influence of solid surface and permeable integral surface for the predicting of the far field noise finding the unexpected difference between the solid surface and the permeable integral surface spalart et al 2019 again analysed the difference of noise prediction based on solid and permeable surface using the ffowcs williams hawking method they stated that the permeable integral surfaces gave more accurate results than the solid integral surfaces at a relatively low mach number high speed trains and airliners with a carefully designed gradual stretching grid in the wake region however there may not be a consensus on the use and location of the permeable integral surface or it is case dependent while we pay attention to the far field radiated noise we also want to get the near field distribution of the noise ewert et al ewert and schröder 2003 2004 derived a series of sound disturbance equations acoustic perturbation equations apes to simulate the flow induced sound field in time and space and obtain the near field sound pressure the superiority of the acoustic disturbance equation was clarified using problems involving the shear flow rotating eddy current and flow around a cylinder at present most of the literature focuses on the turbulent fluctuating pressure and far field noise without taking the near field sound pressure into account because both the turbulent fluctuating pressure and near field sound pressure are important it is necessary to try to obtain the near field sound pressure using the acoustic disturbance equation a direct compressible calculation of the aerodynamic noise can directly obtain the near field to far field pressure fluctuations but the mesh and time step requirements are relatively strict if the grid is not sufficiently detailed and the time step does not meet the courant friedrichs lewy requirements very unsatisfactory results may be obtained special treatment of the boundary is simultaneously required another issue with compressible direct noise calculations is the inclusion of both the hydrodynamic and acoustic contributions in the pressure field and the difficulty of distinguishing between them the final sound pressure must be obtained using wavenumber decomposition as the most basic geometry a cylinder is widely used in various engineering structures such as the pantographs and bogies of high speed trains and the pipelines and risers of offshore platforms for this reason several high fidelity incompressible iddes cfd simulations combined with the ape methods have been made in present article based on the previous detailed experiment and simulation database proper orthogonal decomposition pod and dynamic mode decomposition dmd are applied to identify mechanisms of noise generation at specific frequencies and expands some additional flow field analysis showing the ability of the combining of the incompressible hybrid rans les and ape to model and predict near field noise and far field radiated noise in high reynolds number meanwhile the comparison of solid integral surface and permeable surface and the position of the permeable integral surface are detailed analysed the original intention of this paper is to establish a calculation method of low speed aerodynamic noise using the combination of incompressible hybrid rans les and acoustic perturbation equation ape not only the near field sound pressure fluctuation can be obtained but also the far field radiated noise can be obtained according to the detailed experimental and simulation data the applicability of this method is verified this established method will be used to simulate complex geometric structures such as pantograph and bogie of high speed train under high reynolds number using appropriate grid and time step in the future research 2 numerical method 2 1 hybrid rans les model the combination of the les and rans methods performs reasonably well in terms of both efficiency and accuracy when simulating flows with massive separation at a high reynolds number this turbulence simulation strategy commonly known as the rans les hybrid method has recently been favoured in the study of unsteady and separated turbulent wake flows the original des model proposed by spalart et al 1997 is one of the most popular rans les hybrid models however inherent shortcomings have been identified in the original des these shortcomings include unwanted activities for the near wall damping terms in the les mode an incursion of the les mode inside the boundary layer a grey area and a log layer mismatch several of these shortcomings such as the log layer mismatch and grid induced separation have been addressed in the iddes which combines delayed detached eddy simulation ddes and wall modelled les wmles the time dependent iddes based on the sst k ω model used in this study was a hybrid rans les model cd adapco 2014 that combined the advantages of the ddes and wmles for more detailed information please refer to shur et al 2008 2 2 apes ewert et al ewert and schröder 2003 proposed the apes for the simulation of a flow induced sound field these equations describe aerodynamic noise source terms that are determined by unsteady simulations of compressible or incompressible problems when lighthill derived an acoustic analogy from the basic navier stokes equations an acoustic wave equation could also be derived from the apes cd adapco 2014 the model calculates the acoustic pressure history of the whole domain and takes into account the effects of convection and refraction on the noise radiation the complete system of apes in terms of the perturbation variables p u a is given as follows 1 p t c 2 ρ u a u p c 2 0 2 u a t u u a p ρ φ p here p is the perturbation pressure u a is the irrotational perturbation velocity ρ is the time averaged density u is the time averaged velocity c is the speed of sound and φ p is the noise source function using the relationship proposed by ewert and schroder ewert and schröder 2004 p ρ φ p p a p a is the acoustic pressure then u a and p a can be used as independent variables to obtain two equations finally by combining these two equations under the incompressible flow hypothesis an equation can be obtained according to the sound pressure and noise source of the incompressible flow 3 1 c 2 2 p a t 2 2 u c 2 p a t u c 2 u p a 2 p a τ p a t 1 c 2 2 p t 2 2 u c 2 p t u c 2 u p 2 3 fw h solver the near field sound sources are first obtained using the iddes simulation and the noise source calculated in the near field is used as the input of the fw h equation to calculate the far field noise radiation the fw h model uses a concept developed by casalino et al cd adapco 2014 referred to as the advanced time approach or source time dominant approach two types of surfaces impermeable and permeable fw h surfaces are used in the fe h model an impermeable fw h surface will produce sound levels only from monopole and dipole sources a permeable fw h surface acts as a filter for the internal interface boundaries and contains three types of noise monopole dipole and quadrupole in the region closed by the permeable integration fw h surface however the selection of the position of the permeable integral surface and whether the downstream surface is open will affect the result which will be discussed in detail later for more details on the implementation please refer to caraeni et al 2011 the fw h equation for pressure that is radiated into a medium at rest by a flow in a region or a set of surfaces is as follows 4 p x t p t x t p l x t p q x t the monopole term is shown as follows 5 p t x t 1 4 π t q r 1 m r r e t d s the dipole term is shown as follows 6 p l x t 1 4 π x i l i r 1 m r r e t d s the quadrupole term is shown as follows 7 p q x t 1 4 π x i x j t i j r 1 m r r e t d v 8 q ρ 0 u i n i 9 u i 1 ρ ρ 0 v i ρ u i ρ 0 10 l i p p 0 δ i j σ i j n i ρ u i u n v n 11 t i j ρ u i u j δ i j p p 0 c 0 2 ρ ρ 0 σ i j here u i represents the fluid velocity component in the i direction u n is the fluid velocity component normal to the surface v i represents the surface velocity component in the i direction v n is the surface velocity component normal to the surface σ i j is the viscous stress tensor ρ 0 is the far field density and t i j is the lighthill stress tensor the subscript ret indicates the retarded time which is the time of emission 2 4 modal decomposition method this study utilised two decomposition methods proper orthogonal decomposition pod and dmd to extract the flow structure from the flow field in this section a brief introduction is given about the proper orthogonal decomposition and dynamic mode decomposition the pod method has been extensively described in many studies lumley 1967 first used the pod algorithm to identify the flow field mode in turbulence he proposed a method to decompose the velocity as a spatial vector function the most energetic eigenfunction represents the dominant spatial mode of the flow for detailed information regarding the fundamentals and mathematical processes please refer to lumley 1967 and sirovich 1987 dmd modes may be non orthogonal but each of them possesses a single temporal frequency this lack of non orthogonality of dmd modes may be essential for capturing important dynamical effects in systems with non normal dynamical generators dmd has become a widely used technology in numerical simulations and experimental fluid mechanics schmid 2010 applied dmd for the analysis of a cavity flow and jet rowley et al 2009 also applied the dmd method to the analysis of jets in a cross flow seena et al seena and sung 2011 used dmd to study the self sustaining oscillation caused by leading edge unsteady boundary layer separation iungo et al v iungo et al 2015 applied dmd to the wake prediction of a wind turbine song et al 2013 used dmd to capture the near field and far field acoustics resulting from the instabilities observed in a shear flow for the detailed derivation of dmd and its relationship with the koopman operator please refer to the literature rowley et al 2009 kutz et al 2016 the sparsity promoting dmd spdmd method presented by jovanović et al 2014 was adopted in this study this algorithm uses convex optimisation to achieve an ideal trade off between the approximate quality in the sense of the least square value and the number of modes retained for approximate numerical or experimental snapshot sequences accordingly spdmd effectively removes the effect of the strong damping of modes from the amplitude and helps to select the dominant modes it is assumed that the velocity data are obtained in equal time steps to form the snapshot time sequence with time step δ t 12 x x 0 x 1 x m two data matrices are obtained from the snapshot time sequence 13 x 1 x 0 x 1 x m 1 c n m x 2 x 1 x 2 x m c n m suppose that the snapshot is generated through a discrete time linear time invariant system 14 x 2 a x 1 the normal dmd method offers an ideal representation of f d m d c r r matrix a c n n in the basis spanned by the pod modes u of x 1 15 a u f d m d u here pod mode u is obtained from an economy size singular value decomposition svd x 1 c n m 16 x 1 u σ v where u is equivalent to the mode of a pod containing the spatial correlations in the data σ is a r r diagonal matrix with non zero singular values on its main diagonal and v contains the temporal information in the data by minimising the difference between x 2 and a x 1 matrix f d m d can be obtained from the snapshots x 1 and x 2 17 m i n i m i z e x 1 u f σ v 2 18 x 1 u f σ v 2 t r a c e x 1 u f d m d σ v x 1 u f d m d σ v matrix f d m d c r r controls an optimal low dimensional dynamics system 19 ϕ t 1 f d m d ϕ t suppose that f d m d has linearly independent eigenvectors y 1 y r with corresponding eigenvalues μ 1 μ r thus the dmd mode is φ i u y i 20 φ i u y i 21 x t u ϕ t i 1 r φ i μ i t α i 21 x 0 x 1 x m 1 φ 1 φ 2 φ r α 1 α 2 α r 1 μ 1 μ 1 m 1 1 μ 2 μ 2 m 1 1 μ r μ r m 1 each α i is the amplitude of the corresponding dmd mode schmid 2010 according to jovanović et al 2014 the solution to the following optimisation problem would help to determine the vector of amplitudes α 1 α r 23 m i n i m i z e x 1 φ d i a g α v a n d f 2 using eq 17 and eq 21 eq 24 can be rewritten as follows 24 m i n i m i z e σ v y d i a g α v a n d f 2 then this norm minimisation problem results in the following convex optimisation problem jovanović et al 2014 25 m i n i m i z e j α α p α q α α q s where 26 p y y v a n d v a n d 27 q d i a g v a n d v σ y 28 s trace σ 2 furthermore the spdmd introduces an additional penalised parameter γ to seek the sparsity structure in the mode amplitude vector 29 m i n i m i z e j α γ i 1 r α i 30 m i n i m i z e j α subject to e t α 0 2 5 tandem cylinder problem definition the simulated tandem cylinder configuration consisted of two equal diameter d cylinders arranged along the flow direction the diameter of each cylinder is 0 05715 m and the distance between them l is 3 7 d angle θ is measured from the front stagnation point where the clockwise direction is positive lockard et al 2008 the numerical model and angle definition used in this study are shown in fig 1 the experiments were carried out in nasa s basic aerodynamic research tunnel bart and quiet flow facility qff as shown in fig 2 in the bart wind tunnel the aspect ratio of the cylinder was lz d 12 4 it provided steady and transient surface pressures and used piv technology to measure the flow structure of the flow field in the qff wind tunnel the aspect ratio of the cylinder was lz d 16 it provided not only steady and unsteady surface pressure data but also acoustic data from three fixed microphones ideally the calculation will use a span range that is the same as the experiments the span was 12 4d in the bart tunnel and 16d in the qff tunnel however previous calculations showed that some important flow features could be captured within a 3d span gopalan and jaiman 2015 weinmann et al 2014 therefore the numerical simulation in this study adopted a 3d span with periodic boundary conditions 2 6 computational domain and meshes the computational domain was a hexahedral box and the model was arranged inside this box as indicated in fig 3 fig 3 also shows the definition of the coordinate system x y z with the origin placed at the centre of the front cylinder relative to the origin the upstream and downstream boundaries were located at distances of 20d and 40d respectively the distance between the cylinder and the side boundary in the negative y direction was 20d in order to include the experimental measurement points a b c in the simulation domain the distance between the cylinder and the side boundary in the positive y direction was 50d thus the sound pressure values at the three measurement points could be directly obtained using the ape the upstream boundary of the cylinder was the velocity entrance and the velocity was 44 m s resulting in a reynolds number of 1 66 105 based on the incoming wind velocity and cylinder diameter periodic boundary conditions were used in the spanwise direction with the pressure outlet for the downstream boundary in this study to achieve a high precision target the domain was discretised using an unstructured trimmer grid in star ccm in les region the resolvable turbulence scale is highly dependent on the grid size thus the effect of grid resolution on the convergence of computational results need to be verified in the current study three sets of grids namely coarse medium and fine grids are generated to carry out the grid independence study for three grids the same prism layer that contained 40 extruding cells was attached to the surface of both cylindrical surfaces with a growth rate of 1 1 resulting in an approximate value of y 0 5 and a maximum value of y 1 5 and the cylindrical surface was discretised using 62572 cells for coarse grid 97264 cells for medium grid and 112344 cells for fine grid for the purpose of improved resolution of the separation and reattachment of the boundary layer and wake dynamics with vortices of different space and time sizes three local refinements around the cylinder were implemented for three grids the total number of meshes in coarse medium and fine grids is about 12 million 18 million and 23 million respectively the spatial distribution of coarse gird and fine grid around the cylinder is presented in fig 4 the ability for grids with different spatial resolution to resolve turbulence structures will be compared and assessed in section 3 2 1 when solving the ape it was necessary to set the sound source weighting region and sound source damping region when the sound source weight was 1 and the sound source damping was 0 the sound disturbance equation was calculated according to the sound source when the sound source weight was 0 and the sound source damping was 1 the sound disturbance equation was used to calculate the sound propagation in this region fig 5 shows the specific sound source weighted region and sound source damping region there was a transition interface between the source and propagation computing regions to avoid signal jump a spatial hanning window is recommended for the transition from a value of 0 1 the hanning function is expressed as follows 31 h r 0 5 1 cos π r t here r is the direction vector and t is the thickness which had a value of 0 2d in this study 2 7 numerical procedure the simulations presented in this paper were carried out using star ccm 13 02 based on an implicit unsteady segregated incompressible finite volume solver the temporal scheme was 2nd order with 10 inner iterations per time step under relaxation factors of 0 7 and 0 7 were used for the velocity and pressure respectively for the convective term the bounded central differencing bdc scheme was used for the discretisation which led to the following computation for the convective flux 32 m φ f m φ f o u f o r ξ 0 o r 1 ξ m σ φ c d 1 σ φ s o u f o r 0 ξ 1 where ξ is the normalised variable diagram nvd value which was computed based on local conditions φ f o u φ s o u and φ c d are cell face centre values obtained through first order upwind interpolation second order upwind interpolation and central differencing interpolation respectively φ is the transported scalar quantity and m is the mass flow rate across the face when computing the cell face centre value based on the bcd scheme the nvd value ξ is first computed to determine whether the current region is monotonous for regions of non monotonicity ξ 0 o r 1 ξ the bcd scheme automatically switches to first order upwind interpolation to ensure the boundedness thus the value of φ f o u will be directly used as presented in eq 33 for smooth local flow conditions 0 ξ 1 a hybrid scheme that blends the second order upwind and central differencing schemes is used via a user specified blending factor σ which is set to a low value of 0 02 west and caraeni 2015 prasad and morris 2019 overall the bounded central differencing scheme provides a good compromise between accuracy which is much better compared with the second order upwind scheme and robustness resulting from its warranted boundedness cd adapco 2014 for the purpose of saving computational resources and time the simulation was initialised with a steady rans solution sampling was initiated when no significant differences were found for the two consequent time sequences the averaging time for the physical quantities in all three grids was 192t the power spectral density adopted the pwelch method in matlab by averaging over 5000 samples with an overlap of 2500 samples using a hanning window on each sample series in numerical simulations the time step can be related to a non dimensional number the courant friedrichs lewy cfl number for each cell in the computational domain in the finite volume solver the convective cfl number can be defined as c f l u δ t δ l where u is the flow velocity at each cell centres δ t is the time step and δ l is the grid spacing although the implicit time integration which is unconditionally stable was used in this work the cfl number should be close to one to enhance the simulation accuracy however in most numerical simulations flow velocities varies throughout the whole computational domain which leads to different cfl numbers in every grid cell thus the strategy is to take the freestream velocity and finest cell spacing in the computational domain to determine the appropriate δt which makes the left hand side of the aforementioned equation equalling 1 by this the δt is respectively chosen as 0 0077t 0 0062t and 0 0057t where t is the non dimensional time equal to d u for coarse medium and fine grids which leads to the cfl numbers in most of the cells in all simulations under the value of 1 however this still requires high computing resources thus not suitable for engineering problems in order to check the effect of the cfl number on the precision of the numerical simulation and reduce the computational time for more complex engineering applications an additional simulation case with coarse grid applied with the discrete time step of 0 0154t is also performed for comparison 3 numerical results 3 1 lift and drag the drag coefficients c d f x 0 5 ρ u 0 2 a and lift coefficients c l f z 0 5 ρ u 0 2 a predicted from the coarse grid with two different time steps are listed in table 1 and table 2 respectively together with the primary vortex shedding frequencies and rms values of the fluctuating lift and drag coefficients at the same time these tables also contain relevant data from the studies of gopalan et al gopalan and jaiman 2015 and weinmann et al 2014 the shedding frequency of the primary vortex measured in the experiment was 178 hz corresponding to a strouhal number s t 0 231 in this study the numerical simulation of different time steps showed that s t 0 234 and the error was only 1 3 the drag coefficient of the front cylinder was a little lower than that in the experiment the error was 8 9 when δt 0 0077t and 12 2 when δt 0 0154t the drag coefficient of the rear cylinder was a little higher than that in the experiment the error was 4 7 when δt 0 0077t and 6 when δt 0 0154t according to the analysis of the lift results the simulation results in this study were closer to the experimental results compared to the results of gopalan et al gopalan and jaiman 2015 and weinmann et al 2014 the error for the front cylinder was 11 9 when δt 0 0077t and the error for the rear cylinder was 0 17 when δt 0 0154t it is worth noting that the s t value predicted by the iddes model weinmann et al 2014 was too high and the drag coefficient was very low which was due to the delayed separation the separation point of the mean flow at θ 102 in the experiment lockard et al 2008 the separation point on the front cylinder was 90 100 as shown in fig 6 the separation point of the iddes model in this study 100 was very close to the results of the experiment according to weinmann et al 2014 function f e was active inside the boundary layer front of the separation point and this function was intended to compensate for the excessive drop in turbulence viscosity near the switching location from rans to les however in the present simulations function f e was active inside the boundary layer and covered part of the front and rear of the separation point 3 2 mean flow field 3 2 1 surface pressure numerical results considering the variation of mean surface pressure coefficient c p and fluctuating surface pressure coefficient c p r m s on the front and rear cylinder predicted by grids with various spatial resolution is presented in fig 7 note that results of coarse grid presented in this figure are obtained from the δt 0 0077t case moreover the variation of c p and c p r m s along the cylinders predicted by coarse grid with different time steps are shown in fig 8 for the front cylinder the c p and c p r m s are in remarkable agreement with the experimental data and the base pressure is in good agreement with the qff and bart experiment which is consistent with the analysis in lockard et al lockard 2011 meanwhile the density of grids has no effect on the results for the rear cylinder the results difference of the three sets of grids is greater than that of the front cylinder indicating the strong interaction of wake dynamics however the absolute error is still small indicating that for the study of this paper continuing to refine the grid can not improve the simulation results thus in the following analysis only coarse grids with various time steps will be considered compared with the experimental results although the present simulations underestimate the peaks at about 90 and 270 similar to the previous study gopalan and jaiman 2015 weinmann et al 2014 they basically predict the measurement results of the bart facility where the rear cylinder is tripped the fluctuating surface pressure coefficient of the front cylinder is basically consistent with the experiment the peak value of the fluctuating surface pressure coefficient at the separation point is well predicted indicating that the position of the separation point is accurately captured 100 on the rear cylinder the primary peak at approximately 45 is associated with the front cylinder wake impingement and is well captured by the present simulation the second peak is around 110 for the experiment whereas the present simulation underpredicts the peak value at approbatory 108 on the whole it captures the trend very well and at the same time it is more consistent with the measurement results of the bart facility where the rear cylinder is tripped 3 2 2 surface pressure spectra fig 9 presents the front and rear cylinder surface pressure spectral results the bin width in the nasa experiment 3 125hz st 0 004 and the bin width used in our numerical simulation is 11 72hz st 0 015 because the time of extracting the pressure data in the numerical simulation is not as long as that in the experiment so the bin width in simulation is larger than that of experiment the psd of surface pressure was spanwise averaged over six points the psd values of three angles 90 135 180 on the front cylinder are presented for comparison with the qff and bart experiment results in general the shape and trend of the psd spectrum are similar although the amplitudes are slightly different especially for δt 0 0154t the attenuation of the high frequency part is mainly caused by the grid scale but the case studied in this paper has obvious vortex shedding main frequency and the grid scale used in this paper can at least cover to st 1 as is shown in fig 9 a the results for 90 and 135 are in better agreement with the experiments than 180 because 180 are in the separated area full of turbulence on various scales the results for 0 45 and 90 on the rear cylinder are shown in fig 9 d f although the bin width of spectral in our numerical simulation is relatively large leading to an unsmooth spectrum curve the variation and amplitude of the whole spectra are basically consistent with the two experimental data except that the amplitude of triple vortex shedding frequency at 90 is higher than that of the experimental data at the same time it can be seen that increasing the time step has a effect on the capture of the main vortex shedding frequency and the amplitude of the vortex shedding frequency although the effect is small 3 2 3 mean streamwise velocity and turbulent kinetic energy the mean streamwise velocity contours with mean velocity streamlines in the gap region between the cylinders and downstream of the rear cylinder areshown in fig 10 the numerical simulation of different time steps well simulated the size and shape of the recirculation zone in the gap region in the experiment the centre of the recirculation zone was approximately x d 1 25 and the centre of the numerical simulation was approximately 1 25 it can also be seen from the turbulent kinetic energy tke contours in fig 11 that the maximum value of the 2d tke was approximately x d 1 5 2 in this study the maximum value of the 2d tke was approximately x d 1 5 2 and the 3d tke cloud contours are also listed for comparison downstream of the rear cylinder because of the early separation on the real cylinder as mentioned in section 3 2 1 the size of the recirculation zone increased and the flow velocity decreased in order to better understand the flow field the mean streamwise velocity and 2d tke on the centreline y d 0 are shown in fig 12 and fig 13 respectively when δt 0 0077t the velocity distribution predicted by the iddes model in this study was in good agreement with the bart experiment when δt 0 0154t the velocity distribution was lower than the bart experiment value when x d was greater than 1 5 regarding the velocity distribution downstream of the rear cylinder the result of the iddes model was basically consistent with the bart test data where the rear cylinder was tripped when the boundary layer on the rear cylinder was not tripped the separation point was delayed the wake recirculation zone was small and the downstream velocity was relatively larger than that of the tripped condition 3 3 instantaneous flow field the instantaneous flow fields are visualised in fig 14 using the iso contours of the second invariant of velocity gradient tensor q coloured by the instantaneous streamwise velocity in addition the instantaneous spanwise vorticity w d u 0 is shown in fig 15 the instantaneous q diagram shows that the iddes model provided a relatively detailed resolved flow structure at the same time the roll up of the shedding vortex and the formation of the kelvin helmholtz instability can be seen the instantaneous spanwise vorticity of the piv result from the bart shows that both large scale and small scale flow structures exist the results of other models lockard 2011 are also shown in fig 15 for comparison some of the simulation results display very similar distributions to the bart experiment while others do not have resolved small scale features although the iddes model in this study did not solve the very detailed flow field structure because of the limitation on the number of grids the results were in good agreement with the experimental results 3 4 proper orthogonal decomposition and dynamic mode decomposition the database used in the dmd analysis consisted of 4000 snapshots n 3999 of the full three dimensional velocity fields the streamwise velocity and transverse velocity were used here and they were obtained with an interval of δ t 0 0385 d u 0 where d is the cylinder diameter and u 0 is the velocity the performance loss is defined as follows 34 ψ 100 x 1 φ d i a g α v a n d f x 1 f which is related to the number of retained dmd modes n z card α the retained dmd modes and performance loss of the optimal vector of amplitude α resulting from the sparsity promoting dmd algorithm are presented in fig 16 as a function of user specified parameter γ with an increase in γ a sparser solution could be obtained but at the cost of increasing the performance loss fig 17 shows the eigenvalues generated by the standard dmd algorithm circles and the subset n z selected by the spdmd algorithm crosses for n z 1 only the averaged flow was selected for n z 3 the mean flow and primary dominant frequency pair were consistent with the vortex shedding frequency of the cylinder s t was 0 234 while for n z 5 the lower frequency was identified s t was 0 195 which was related to the vortex shedding of the rear cylinder fig 18 shows the psds of the force on the front and rear cylinders a lower frequency s t 0 195 could be found in the psd of the rear cylinder lift force the corresponding amplitudes for the various truncations nz are displayed in fig 19 fig 20 illustrates the three leading modes of pod dmd and dmdsp the pod dmd and dmdsp modes were nearly identical because this tandem cylinder system was characterised by a specific frequency the first mode of the three methods represented the mean flow field the second mode of three methods represented the primary vortex shedding of the front cylinder and the third mode of the three methods represented the lower frequency of the rear cylinder see fig 21 3 5 acoustic results fig 22 shows the pressure level and acoustic pressure level contours where fig 22 a shows the qff experiment results for the sound pressure spl contour lockard et al 2007 and fig 22 b and c show the pressure spl contours for δt 0 0077t and δt 0 0154t respectively based on the pressure spl contours the rear cylinder is going to dominate the radiation because the pressure fluctuations on its surface are approximately 10 db higher than those on the front cylinder lockard et al 2007 similar to the pressure spl contour the acoustic pressure spl contours which are shown in fig 22 d and e are more illustrative from a noise perspective the acoustic pressure spl contours in fig 22 d and e show that the most intense near field acoustic pressure fluctuations are approximately 45 on the surface of the rear cylinder it can be seen that the time step used in this study had little effect on the calculation results therefore in order to save computing resources requirements concerning cfl conditions can be relaxed by double the discrete time step size the instantaneous acoustic pressure contour is presented in fig 23 the periodic radiation of sound pressure is shown in fig 23 after expanding the calculation domain to evaluate the noise spectra for the three experimental microphone locations a b c the ape solver and fw h equation solver were used to predict the acoustic spectra unsteady data were collected on the surfaces as shown in fig 24 five control surfaces were used to evaluate the fw h integral two permeable surfaces ps open and ps close and three impermeable surfaces ips1 ips2 and ips1 and ips2 combined first the noise predictions from the two permeable surfaces ps open and ps close are compared with the experimental data in fig 25 the results for ps close are in good agreement with the experiment results with the exception that the harmonics of point b are not captured correctly in contrast the results for ps open show a strong non physical growth at low frequencies which is similar to that observed for landing gears spalart et al 2011 and jets shur et al 2005 mendez et al 2009 second the noise predictions for the three impermeable surfaces ips1 ips2 and ips1 and ips2 combined and the ape results are compared with the experimental data in fig 26 the result for ips2 is nearly the same as that for ips1 and ips2 combined and much higher than that for ips1 which is consistent with the analysis in fig 22 the overall trend of the results from the ape is consistent with that of the experiment and the frequency of the primary vortex and its harmonics are well captured at the same time only the noise amplitude is slightly higher at a high s t number the noise spectrum from the ape is rapidly attenuated when s t 1 4 because of the grid size the mesh resolution must be based on the recommended points per wavelength ppw to maintain the accuracy of acoustic predictions ppw speed of sound frequency mesh size it is recommended that a value of approximately 30 be maintained for ppw throughout the zone of interest in this study the mesh size in the region of interest was 0 175d thus the resolved frequency was approximately 1100 hz s t 1 4 fig 27 shows four line probes in the wake centreline the lines y 0 and y d 4 extend within the separated and attached wake regions whereas y d 2 and y 3d 4 are outside the separated region in this study wavenumber decomposition was used to visualise the separate acoustical and convective energy content cfd calculations were used to provide the detailed spatial temporal fluid pressure and acoustic pressure information fig 28 shows the corresponding frequency wavenumber diagrams coloured by the pressure power spectral density psd the positive wavenumbers indicate convection in the flow direction and negative wavenumbers indicate that against the flow fig 28 a c e and g were computed based on the acoustic pressure fig 28 b d f and h were computed based on the fluid pressure the slope of the distinctive line in the wavenumber frequency plot was used to calculate the group velocity of the disturbances travelling along the domain fig 28 a c e and g show the front and rear acoustically propagating waves for the tandem cylinder case fig 28 b d f and h clearly show the upstream and downstream convecting waves indicating reversed and streamwise convecting flow characteristics in the wake centreline where the line averaged reversed convection speed is slower than the line averaged reattached streamwise convecting velocity as expected meanwhile the line averaged reattached streamwise convecting velocity is concentrated at 0 75 u 0 in the gap region 4 conclusions in general the agreement between the experimental findings and the computations was quite good although there was a slight error between the separation point of the rear cylinder and the surface pressure spectrum of the front cylinder the results fully proved the capability of the iddes turbulence model to simulate the wake interaction flow by comparing it with the full range of experimental data the pod dmd and dmdsp modes were nearly identical because this tandem cylinder system was characterised by a specific frequency the first mode of the three methods represented the mean flow field the second mode of the three methods represented the primary vortex shedding of the front cylinder s t was 0 234 and the third mode of the three methods represented the lower frequency of the rear cylinder s t was 0 195 which was consistent with the line averaged reattached streamwise convecting velocity in the gap region approximately 0 75 u 0 from the pressure spl contours the rear cylinder is going to dominate the radiation because the pressure fluctuations were approximately 10 db higher than those on the front cylinder the acoustic pressure spl contours showed that the most intense near field acoustic pressure fluctuations were around 45 on the surface of the rear cylinder first noise predictions from two permeable surfaces ps open and ps close were compared with the experimental data the results for ps close were in good agreement with the experiment with the exception that the harmonics of point b were not captured correctly in contrast the result for ps open exhibited a strong non physical growth at low frequencies which was similar to that observed for landing gears spalart et al 2011 and jets shur et al 2005 mendez et al 2009 second the noise predictions from three impermeable surfaces ips1 ips2 and combined ips1 and ips2 and the ape results were compared with the experimental data the result for ips2 was nearly the same as that for ips1 and ips2 combined and was much higher than that for ips2 the overall trend for the ape results showed consistency with the experiment and the frequency of the primary vortex and its harmonics were well captured at the same time only the noise amplitude was slightly higher at a high s t number credit authorship contribution statement guang chen investigation writing original draft writing review editing formal analysis xi feng liang supervision funding acquisition dan zhou data curation xiao bai li conceptualization methodology writing review editing fu sang lien formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge the experimental and computational resources provided by the high speed train research center of central south university china the author acknowledge the experimental data provided by david lockard from nasa langley research center this study was supported by the china scholarship council file no 201906370098 and the graduate student independent innovation project of central south university grant no 2020zzts117 
20982,the method of combining incompressible hybrid reynolds average navier stokes large eddy simulation rans les with an acoustic perturbation equation was studied to accurately predict the flow and noise performances in nasa tandem cylinder experiments in this approach acoustic waves simultaneously propagate in the time domain with an unsteady turbulent flow the experiment was performed under the condition of a reynolds number of 1 66 105 based on the cylinder diameter which provided detailed surface pressure and flow field measurements the improved delayed detached eddy simulation iddes model established in this study was consistent with the experimental results except for the flow field behind the rear cylinder which was caused by an early separation relative to the experiment the acoustic results showed that the rear cylinder dominated the noise radiation which indicated that the pressure fluctuation caused by wake interference was greater than that caused by vortex shedding acoustic predictions were also obtained using an acoustic analogy approach based on the fh w method three kinds of integral surfaces ps open ps close and ips were made for the acoustic predictions using the ffowcs williams hawkings method this study also showed that wavenumber decomposition could be utilised to quantify the mechanisms related to turbulent convection and sound propagation an iddes hybrid model for predicting near field and far field noise was established which could be applied to practical engineering applications keywords iddes aeroacoustics ape permeable surface wavenumber decomposition 1 introduction the reynolds average navier stokes rans equation is generally used under the condition of a large reynolds number when appropriate turbulence models are adopted a complex geometry can be numerically simulated with a very small time cost and suitable results can be obtained however the rans method has limited accuracy for the flow separation at the tail of a bluff body especially when there is no fixed separation point the rans equation cannot effectively simulate the pressure fluctuation and vortex shedding process on the surface of an object caused by separation thus it cannot directly simulate aeroacoustics for cases where it is necessary to capture the details of the flow field with high precision the large eddy simulation les method needs to be used however les is a turbulence resolving simulation method that requires fine computational grids near the wall boundary and small time steps the combination of the les and rans methods which is often referred to as the rans les hybrid method performs reasonably well in terms of both efficiency and accuracy when simulating flows with massive separation at a large reynolds number shur et al 2008 for more detailed information on the existing hybrid rans les methods please refer to sagaut sagaut et al 2012 or froehlich and von terzi fröhlich and von terzi 2008 this type of hybrid model has been successfully applied to complex numerical simulations with large reynolds numbers and has achieved varying degrees of success fröhlich and von terzi 2008 chen et al 2019 frendi et al 2006 gopalan and jaiman 2015 weinmann et al 2014 since this hybrid model was proposed many studies gopalan and jaiman 2015 weinmann et al 2014 have evaluated its performance weinmann et al 2014 proposed a modified flow simulation methodology fsm approach the fsm was proposed for the kω sst two equation model fsm sst and for an explicit algebraic stress model fsm easm these two hybrid models were used to accurately simulate the flow and noise fields of tandem cylinders which was a benchmark experiment for nasa the fsm sst method performed better than the fsm easm using the nasa experiment data gopalan et al gopalan and jaiman 2015 used hybrid urans les models based on linear and non linear eddy viscosity formulations to model tandem circular cylinders with reynolds numbers of 1 66 105 for three different pacing l to diameter d ratios l d 1 4 3 0 and 3 7 the results showed that the nonlinear hybrid model was better for aerodynamic force coefficients and turbulent wake simulation unfortunately the noise predictions of the different hybrid models were not analysed in this study two cylinders in tandem are a common configuration when studying wake interaction which is of great significance for the generation of fluid induced vibration and noise in a variety of engineering applications on land or offshore multiple parallel or nearly parallel structures are often observed such as the risers of deep sea drilling systems landing gear of aircraft and bogies and pantographs of high speed trains the hydrodynamics of tandem cylinders under the action of cross flow has always been a research hotspot in the field of fluid mechanics and fluid structure interactions the wake of two tandem cylinders involves flow separation shear layer interference quasi periodic vortices vortex impingement fluid resonance and recirculation younis et al 2016 igarashi 1981 and zdravkovich 1987 categorised different flow regimes based on space ratio l l d where l is the distance from the centre of one cylinder to the centre of the other and d is the cylinder diameter the inter cylindrical distance and the reynolds number the free shear layer separated from the front cylinder passes over the rear cylinder in a small space which is called the extended body flow the free shear layers separated from the front cylinder reattach to the surface of the rear cylinder when the approximate space ratio is less than 3 8 forming the reattachment flow for space ratio l 3 8 the vortex shedding of the two cylinders develops independently and the shear layer separated by the front cylinder will not be reattached to the rear cylinder which is called the co shedding flow the shear layer attachment and co shedding flows may appear intermittently at a critical lc meaning that the flow is bistable an intermittent large fluctuation in pressure on the front cylinder was observed when the flow field was under bistable conditions obviously critical spacing lc is also related to the reynolds number for a detailed discussion of the classification and analysis please refer to the literature younis et al 2016 in view of the fact that the tandem cylinder is widely used in engineering and can reveal the fluid mechanics of the wake interaction it has been a benchmark model adopted by the nasa lockard 2011 to evaluate the ability of numerical simulation to predict the both near field unsteady flow and the acoustic radiation in this workshop the results of surface pressure fluctuation near field unsteady flow and far field radiated noise computed by the fh w method of fifteen submissions mainly based on the hybrid rans les methods are summarized and compared against the detailed experimental data at present most of the literature on aerodynamic noise is based on the ffowcs williams hawkings fw h equation and different integral surfaces permeable and impermeable surfaces lockard 2011 lockard et al 2007 2008 caraeni et al 2011 spalart et al 2011 tan et al 2018 west and caraeni 2015 zhu et al 2017 spalart et al 2011 used incompressible and compressible detached eddy simulations des to simulate the flow field of the four wheel rudimentary landing gear rlg and the solid surface pressure fluctuation the far field noise and corresponding psd spectra were presented at the same time the author made a detailed comparative analysis of the influence of solid surface and permeable integral surface for the predicting of the far field noise finding the unexpected difference between the solid surface and the permeable integral surface spalart et al 2019 again analysed the difference of noise prediction based on solid and permeable surface using the ffowcs williams hawking method they stated that the permeable integral surfaces gave more accurate results than the solid integral surfaces at a relatively low mach number high speed trains and airliners with a carefully designed gradual stretching grid in the wake region however there may not be a consensus on the use and location of the permeable integral surface or it is case dependent while we pay attention to the far field radiated noise we also want to get the near field distribution of the noise ewert et al ewert and schröder 2003 2004 derived a series of sound disturbance equations acoustic perturbation equations apes to simulate the flow induced sound field in time and space and obtain the near field sound pressure the superiority of the acoustic disturbance equation was clarified using problems involving the shear flow rotating eddy current and flow around a cylinder at present most of the literature focuses on the turbulent fluctuating pressure and far field noise without taking the near field sound pressure into account because both the turbulent fluctuating pressure and near field sound pressure are important it is necessary to try to obtain the near field sound pressure using the acoustic disturbance equation a direct compressible calculation of the aerodynamic noise can directly obtain the near field to far field pressure fluctuations but the mesh and time step requirements are relatively strict if the grid is not sufficiently detailed and the time step does not meet the courant friedrichs lewy requirements very unsatisfactory results may be obtained special treatment of the boundary is simultaneously required another issue with compressible direct noise calculations is the inclusion of both the hydrodynamic and acoustic contributions in the pressure field and the difficulty of distinguishing between them the final sound pressure must be obtained using wavenumber decomposition as the most basic geometry a cylinder is widely used in various engineering structures such as the pantographs and bogies of high speed trains and the pipelines and risers of offshore platforms for this reason several high fidelity incompressible iddes cfd simulations combined with the ape methods have been made in present article based on the previous detailed experiment and simulation database proper orthogonal decomposition pod and dynamic mode decomposition dmd are applied to identify mechanisms of noise generation at specific frequencies and expands some additional flow field analysis showing the ability of the combining of the incompressible hybrid rans les and ape to model and predict near field noise and far field radiated noise in high reynolds number meanwhile the comparison of solid integral surface and permeable surface and the position of the permeable integral surface are detailed analysed the original intention of this paper is to establish a calculation method of low speed aerodynamic noise using the combination of incompressible hybrid rans les and acoustic perturbation equation ape not only the near field sound pressure fluctuation can be obtained but also the far field radiated noise can be obtained according to the detailed experimental and simulation data the applicability of this method is verified this established method will be used to simulate complex geometric structures such as pantograph and bogie of high speed train under high reynolds number using appropriate grid and time step in the future research 2 numerical method 2 1 hybrid rans les model the combination of the les and rans methods performs reasonably well in terms of both efficiency and accuracy when simulating flows with massive separation at a high reynolds number this turbulence simulation strategy commonly known as the rans les hybrid method has recently been favoured in the study of unsteady and separated turbulent wake flows the original des model proposed by spalart et al 1997 is one of the most popular rans les hybrid models however inherent shortcomings have been identified in the original des these shortcomings include unwanted activities for the near wall damping terms in the les mode an incursion of the les mode inside the boundary layer a grey area and a log layer mismatch several of these shortcomings such as the log layer mismatch and grid induced separation have been addressed in the iddes which combines delayed detached eddy simulation ddes and wall modelled les wmles the time dependent iddes based on the sst k ω model used in this study was a hybrid rans les model cd adapco 2014 that combined the advantages of the ddes and wmles for more detailed information please refer to shur et al 2008 2 2 apes ewert et al ewert and schröder 2003 proposed the apes for the simulation of a flow induced sound field these equations describe aerodynamic noise source terms that are determined by unsteady simulations of compressible or incompressible problems when lighthill derived an acoustic analogy from the basic navier stokes equations an acoustic wave equation could also be derived from the apes cd adapco 2014 the model calculates the acoustic pressure history of the whole domain and takes into account the effects of convection and refraction on the noise radiation the complete system of apes in terms of the perturbation variables p u a is given as follows 1 p t c 2 ρ u a u p c 2 0 2 u a t u u a p ρ φ p here p is the perturbation pressure u a is the irrotational perturbation velocity ρ is the time averaged density u is the time averaged velocity c is the speed of sound and φ p is the noise source function using the relationship proposed by ewert and schroder ewert and schröder 2004 p ρ φ p p a p a is the acoustic pressure then u a and p a can be used as independent variables to obtain two equations finally by combining these two equations under the incompressible flow hypothesis an equation can be obtained according to the sound pressure and noise source of the incompressible flow 3 1 c 2 2 p a t 2 2 u c 2 p a t u c 2 u p a 2 p a τ p a t 1 c 2 2 p t 2 2 u c 2 p t u c 2 u p 2 3 fw h solver the near field sound sources are first obtained using the iddes simulation and the noise source calculated in the near field is used as the input of the fw h equation to calculate the far field noise radiation the fw h model uses a concept developed by casalino et al cd adapco 2014 referred to as the advanced time approach or source time dominant approach two types of surfaces impermeable and permeable fw h surfaces are used in the fe h model an impermeable fw h surface will produce sound levels only from monopole and dipole sources a permeable fw h surface acts as a filter for the internal interface boundaries and contains three types of noise monopole dipole and quadrupole in the region closed by the permeable integration fw h surface however the selection of the position of the permeable integral surface and whether the downstream surface is open will affect the result which will be discussed in detail later for more details on the implementation please refer to caraeni et al 2011 the fw h equation for pressure that is radiated into a medium at rest by a flow in a region or a set of surfaces is as follows 4 p x t p t x t p l x t p q x t the monopole term is shown as follows 5 p t x t 1 4 π t q r 1 m r r e t d s the dipole term is shown as follows 6 p l x t 1 4 π x i l i r 1 m r r e t d s the quadrupole term is shown as follows 7 p q x t 1 4 π x i x j t i j r 1 m r r e t d v 8 q ρ 0 u i n i 9 u i 1 ρ ρ 0 v i ρ u i ρ 0 10 l i p p 0 δ i j σ i j n i ρ u i u n v n 11 t i j ρ u i u j δ i j p p 0 c 0 2 ρ ρ 0 σ i j here u i represents the fluid velocity component in the i direction u n is the fluid velocity component normal to the surface v i represents the surface velocity component in the i direction v n is the surface velocity component normal to the surface σ i j is the viscous stress tensor ρ 0 is the far field density and t i j is the lighthill stress tensor the subscript ret indicates the retarded time which is the time of emission 2 4 modal decomposition method this study utilised two decomposition methods proper orthogonal decomposition pod and dmd to extract the flow structure from the flow field in this section a brief introduction is given about the proper orthogonal decomposition and dynamic mode decomposition the pod method has been extensively described in many studies lumley 1967 first used the pod algorithm to identify the flow field mode in turbulence he proposed a method to decompose the velocity as a spatial vector function the most energetic eigenfunction represents the dominant spatial mode of the flow for detailed information regarding the fundamentals and mathematical processes please refer to lumley 1967 and sirovich 1987 dmd modes may be non orthogonal but each of them possesses a single temporal frequency this lack of non orthogonality of dmd modes may be essential for capturing important dynamical effects in systems with non normal dynamical generators dmd has become a widely used technology in numerical simulations and experimental fluid mechanics schmid 2010 applied dmd for the analysis of a cavity flow and jet rowley et al 2009 also applied the dmd method to the analysis of jets in a cross flow seena et al seena and sung 2011 used dmd to study the self sustaining oscillation caused by leading edge unsteady boundary layer separation iungo et al v iungo et al 2015 applied dmd to the wake prediction of a wind turbine song et al 2013 used dmd to capture the near field and far field acoustics resulting from the instabilities observed in a shear flow for the detailed derivation of dmd and its relationship with the koopman operator please refer to the literature rowley et al 2009 kutz et al 2016 the sparsity promoting dmd spdmd method presented by jovanović et al 2014 was adopted in this study this algorithm uses convex optimisation to achieve an ideal trade off between the approximate quality in the sense of the least square value and the number of modes retained for approximate numerical or experimental snapshot sequences accordingly spdmd effectively removes the effect of the strong damping of modes from the amplitude and helps to select the dominant modes it is assumed that the velocity data are obtained in equal time steps to form the snapshot time sequence with time step δ t 12 x x 0 x 1 x m two data matrices are obtained from the snapshot time sequence 13 x 1 x 0 x 1 x m 1 c n m x 2 x 1 x 2 x m c n m suppose that the snapshot is generated through a discrete time linear time invariant system 14 x 2 a x 1 the normal dmd method offers an ideal representation of f d m d c r r matrix a c n n in the basis spanned by the pod modes u of x 1 15 a u f d m d u here pod mode u is obtained from an economy size singular value decomposition svd x 1 c n m 16 x 1 u σ v where u is equivalent to the mode of a pod containing the spatial correlations in the data σ is a r r diagonal matrix with non zero singular values on its main diagonal and v contains the temporal information in the data by minimising the difference between x 2 and a x 1 matrix f d m d can be obtained from the snapshots x 1 and x 2 17 m i n i m i z e x 1 u f σ v 2 18 x 1 u f σ v 2 t r a c e x 1 u f d m d σ v x 1 u f d m d σ v matrix f d m d c r r controls an optimal low dimensional dynamics system 19 ϕ t 1 f d m d ϕ t suppose that f d m d has linearly independent eigenvectors y 1 y r with corresponding eigenvalues μ 1 μ r thus the dmd mode is φ i u y i 20 φ i u y i 21 x t u ϕ t i 1 r φ i μ i t α i 21 x 0 x 1 x m 1 φ 1 φ 2 φ r α 1 α 2 α r 1 μ 1 μ 1 m 1 1 μ 2 μ 2 m 1 1 μ r μ r m 1 each α i is the amplitude of the corresponding dmd mode schmid 2010 according to jovanović et al 2014 the solution to the following optimisation problem would help to determine the vector of amplitudes α 1 α r 23 m i n i m i z e x 1 φ d i a g α v a n d f 2 using eq 17 and eq 21 eq 24 can be rewritten as follows 24 m i n i m i z e σ v y d i a g α v a n d f 2 then this norm minimisation problem results in the following convex optimisation problem jovanović et al 2014 25 m i n i m i z e j α α p α q α α q s where 26 p y y v a n d v a n d 27 q d i a g v a n d v σ y 28 s trace σ 2 furthermore the spdmd introduces an additional penalised parameter γ to seek the sparsity structure in the mode amplitude vector 29 m i n i m i z e j α γ i 1 r α i 30 m i n i m i z e j α subject to e t α 0 2 5 tandem cylinder problem definition the simulated tandem cylinder configuration consisted of two equal diameter d cylinders arranged along the flow direction the diameter of each cylinder is 0 05715 m and the distance between them l is 3 7 d angle θ is measured from the front stagnation point where the clockwise direction is positive lockard et al 2008 the numerical model and angle definition used in this study are shown in fig 1 the experiments were carried out in nasa s basic aerodynamic research tunnel bart and quiet flow facility qff as shown in fig 2 in the bart wind tunnel the aspect ratio of the cylinder was lz d 12 4 it provided steady and transient surface pressures and used piv technology to measure the flow structure of the flow field in the qff wind tunnel the aspect ratio of the cylinder was lz d 16 it provided not only steady and unsteady surface pressure data but also acoustic data from three fixed microphones ideally the calculation will use a span range that is the same as the experiments the span was 12 4d in the bart tunnel and 16d in the qff tunnel however previous calculations showed that some important flow features could be captured within a 3d span gopalan and jaiman 2015 weinmann et al 2014 therefore the numerical simulation in this study adopted a 3d span with periodic boundary conditions 2 6 computational domain and meshes the computational domain was a hexahedral box and the model was arranged inside this box as indicated in fig 3 fig 3 also shows the definition of the coordinate system x y z with the origin placed at the centre of the front cylinder relative to the origin the upstream and downstream boundaries were located at distances of 20d and 40d respectively the distance between the cylinder and the side boundary in the negative y direction was 20d in order to include the experimental measurement points a b c in the simulation domain the distance between the cylinder and the side boundary in the positive y direction was 50d thus the sound pressure values at the three measurement points could be directly obtained using the ape the upstream boundary of the cylinder was the velocity entrance and the velocity was 44 m s resulting in a reynolds number of 1 66 105 based on the incoming wind velocity and cylinder diameter periodic boundary conditions were used in the spanwise direction with the pressure outlet for the downstream boundary in this study to achieve a high precision target the domain was discretised using an unstructured trimmer grid in star ccm in les region the resolvable turbulence scale is highly dependent on the grid size thus the effect of grid resolution on the convergence of computational results need to be verified in the current study three sets of grids namely coarse medium and fine grids are generated to carry out the grid independence study for three grids the same prism layer that contained 40 extruding cells was attached to the surface of both cylindrical surfaces with a growth rate of 1 1 resulting in an approximate value of y 0 5 and a maximum value of y 1 5 and the cylindrical surface was discretised using 62572 cells for coarse grid 97264 cells for medium grid and 112344 cells for fine grid for the purpose of improved resolution of the separation and reattachment of the boundary layer and wake dynamics with vortices of different space and time sizes three local refinements around the cylinder were implemented for three grids the total number of meshes in coarse medium and fine grids is about 12 million 18 million and 23 million respectively the spatial distribution of coarse gird and fine grid around the cylinder is presented in fig 4 the ability for grids with different spatial resolution to resolve turbulence structures will be compared and assessed in section 3 2 1 when solving the ape it was necessary to set the sound source weighting region and sound source damping region when the sound source weight was 1 and the sound source damping was 0 the sound disturbance equation was calculated according to the sound source when the sound source weight was 0 and the sound source damping was 1 the sound disturbance equation was used to calculate the sound propagation in this region fig 5 shows the specific sound source weighted region and sound source damping region there was a transition interface between the source and propagation computing regions to avoid signal jump a spatial hanning window is recommended for the transition from a value of 0 1 the hanning function is expressed as follows 31 h r 0 5 1 cos π r t here r is the direction vector and t is the thickness which had a value of 0 2d in this study 2 7 numerical procedure the simulations presented in this paper were carried out using star ccm 13 02 based on an implicit unsteady segregated incompressible finite volume solver the temporal scheme was 2nd order with 10 inner iterations per time step under relaxation factors of 0 7 and 0 7 were used for the velocity and pressure respectively for the convective term the bounded central differencing bdc scheme was used for the discretisation which led to the following computation for the convective flux 32 m φ f m φ f o u f o r ξ 0 o r 1 ξ m σ φ c d 1 σ φ s o u f o r 0 ξ 1 where ξ is the normalised variable diagram nvd value which was computed based on local conditions φ f o u φ s o u and φ c d are cell face centre values obtained through first order upwind interpolation second order upwind interpolation and central differencing interpolation respectively φ is the transported scalar quantity and m is the mass flow rate across the face when computing the cell face centre value based on the bcd scheme the nvd value ξ is first computed to determine whether the current region is monotonous for regions of non monotonicity ξ 0 o r 1 ξ the bcd scheme automatically switches to first order upwind interpolation to ensure the boundedness thus the value of φ f o u will be directly used as presented in eq 33 for smooth local flow conditions 0 ξ 1 a hybrid scheme that blends the second order upwind and central differencing schemes is used via a user specified blending factor σ which is set to a low value of 0 02 west and caraeni 2015 prasad and morris 2019 overall the bounded central differencing scheme provides a good compromise between accuracy which is much better compared with the second order upwind scheme and robustness resulting from its warranted boundedness cd adapco 2014 for the purpose of saving computational resources and time the simulation was initialised with a steady rans solution sampling was initiated when no significant differences were found for the two consequent time sequences the averaging time for the physical quantities in all three grids was 192t the power spectral density adopted the pwelch method in matlab by averaging over 5000 samples with an overlap of 2500 samples using a hanning window on each sample series in numerical simulations the time step can be related to a non dimensional number the courant friedrichs lewy cfl number for each cell in the computational domain in the finite volume solver the convective cfl number can be defined as c f l u δ t δ l where u is the flow velocity at each cell centres δ t is the time step and δ l is the grid spacing although the implicit time integration which is unconditionally stable was used in this work the cfl number should be close to one to enhance the simulation accuracy however in most numerical simulations flow velocities varies throughout the whole computational domain which leads to different cfl numbers in every grid cell thus the strategy is to take the freestream velocity and finest cell spacing in the computational domain to determine the appropriate δt which makes the left hand side of the aforementioned equation equalling 1 by this the δt is respectively chosen as 0 0077t 0 0062t and 0 0057t where t is the non dimensional time equal to d u for coarse medium and fine grids which leads to the cfl numbers in most of the cells in all simulations under the value of 1 however this still requires high computing resources thus not suitable for engineering problems in order to check the effect of the cfl number on the precision of the numerical simulation and reduce the computational time for more complex engineering applications an additional simulation case with coarse grid applied with the discrete time step of 0 0154t is also performed for comparison 3 numerical results 3 1 lift and drag the drag coefficients c d f x 0 5 ρ u 0 2 a and lift coefficients c l f z 0 5 ρ u 0 2 a predicted from the coarse grid with two different time steps are listed in table 1 and table 2 respectively together with the primary vortex shedding frequencies and rms values of the fluctuating lift and drag coefficients at the same time these tables also contain relevant data from the studies of gopalan et al gopalan and jaiman 2015 and weinmann et al 2014 the shedding frequency of the primary vortex measured in the experiment was 178 hz corresponding to a strouhal number s t 0 231 in this study the numerical simulation of different time steps showed that s t 0 234 and the error was only 1 3 the drag coefficient of the front cylinder was a little lower than that in the experiment the error was 8 9 when δt 0 0077t and 12 2 when δt 0 0154t the drag coefficient of the rear cylinder was a little higher than that in the experiment the error was 4 7 when δt 0 0077t and 6 when δt 0 0154t according to the analysis of the lift results the simulation results in this study were closer to the experimental results compared to the results of gopalan et al gopalan and jaiman 2015 and weinmann et al 2014 the error for the front cylinder was 11 9 when δt 0 0077t and the error for the rear cylinder was 0 17 when δt 0 0154t it is worth noting that the s t value predicted by the iddes model weinmann et al 2014 was too high and the drag coefficient was very low which was due to the delayed separation the separation point of the mean flow at θ 102 in the experiment lockard et al 2008 the separation point on the front cylinder was 90 100 as shown in fig 6 the separation point of the iddes model in this study 100 was very close to the results of the experiment according to weinmann et al 2014 function f e was active inside the boundary layer front of the separation point and this function was intended to compensate for the excessive drop in turbulence viscosity near the switching location from rans to les however in the present simulations function f e was active inside the boundary layer and covered part of the front and rear of the separation point 3 2 mean flow field 3 2 1 surface pressure numerical results considering the variation of mean surface pressure coefficient c p and fluctuating surface pressure coefficient c p r m s on the front and rear cylinder predicted by grids with various spatial resolution is presented in fig 7 note that results of coarse grid presented in this figure are obtained from the δt 0 0077t case moreover the variation of c p and c p r m s along the cylinders predicted by coarse grid with different time steps are shown in fig 8 for the front cylinder the c p and c p r m s are in remarkable agreement with the experimental data and the base pressure is in good agreement with the qff and bart experiment which is consistent with the analysis in lockard et al lockard 2011 meanwhile the density of grids has no effect on the results for the rear cylinder the results difference of the three sets of grids is greater than that of the front cylinder indicating the strong interaction of wake dynamics however the absolute error is still small indicating that for the study of this paper continuing to refine the grid can not improve the simulation results thus in the following analysis only coarse grids with various time steps will be considered compared with the experimental results although the present simulations underestimate the peaks at about 90 and 270 similar to the previous study gopalan and jaiman 2015 weinmann et al 2014 they basically predict the measurement results of the bart facility where the rear cylinder is tripped the fluctuating surface pressure coefficient of the front cylinder is basically consistent with the experiment the peak value of the fluctuating surface pressure coefficient at the separation point is well predicted indicating that the position of the separation point is accurately captured 100 on the rear cylinder the primary peak at approximately 45 is associated with the front cylinder wake impingement and is well captured by the present simulation the second peak is around 110 for the experiment whereas the present simulation underpredicts the peak value at approbatory 108 on the whole it captures the trend very well and at the same time it is more consistent with the measurement results of the bart facility where the rear cylinder is tripped 3 2 2 surface pressure spectra fig 9 presents the front and rear cylinder surface pressure spectral results the bin width in the nasa experiment 3 125hz st 0 004 and the bin width used in our numerical simulation is 11 72hz st 0 015 because the time of extracting the pressure data in the numerical simulation is not as long as that in the experiment so the bin width in simulation is larger than that of experiment the psd of surface pressure was spanwise averaged over six points the psd values of three angles 90 135 180 on the front cylinder are presented for comparison with the qff and bart experiment results in general the shape and trend of the psd spectrum are similar although the amplitudes are slightly different especially for δt 0 0154t the attenuation of the high frequency part is mainly caused by the grid scale but the case studied in this paper has obvious vortex shedding main frequency and the grid scale used in this paper can at least cover to st 1 as is shown in fig 9 a the results for 90 and 135 are in better agreement with the experiments than 180 because 180 are in the separated area full of turbulence on various scales the results for 0 45 and 90 on the rear cylinder are shown in fig 9 d f although the bin width of spectral in our numerical simulation is relatively large leading to an unsmooth spectrum curve the variation and amplitude of the whole spectra are basically consistent with the two experimental data except that the amplitude of triple vortex shedding frequency at 90 is higher than that of the experimental data at the same time it can be seen that increasing the time step has a effect on the capture of the main vortex shedding frequency and the amplitude of the vortex shedding frequency although the effect is small 3 2 3 mean streamwise velocity and turbulent kinetic energy the mean streamwise velocity contours with mean velocity streamlines in the gap region between the cylinders and downstream of the rear cylinder areshown in fig 10 the numerical simulation of different time steps well simulated the size and shape of the recirculation zone in the gap region in the experiment the centre of the recirculation zone was approximately x d 1 25 and the centre of the numerical simulation was approximately 1 25 it can also be seen from the turbulent kinetic energy tke contours in fig 11 that the maximum value of the 2d tke was approximately x d 1 5 2 in this study the maximum value of the 2d tke was approximately x d 1 5 2 and the 3d tke cloud contours are also listed for comparison downstream of the rear cylinder because of the early separation on the real cylinder as mentioned in section 3 2 1 the size of the recirculation zone increased and the flow velocity decreased in order to better understand the flow field the mean streamwise velocity and 2d tke on the centreline y d 0 are shown in fig 12 and fig 13 respectively when δt 0 0077t the velocity distribution predicted by the iddes model in this study was in good agreement with the bart experiment when δt 0 0154t the velocity distribution was lower than the bart experiment value when x d was greater than 1 5 regarding the velocity distribution downstream of the rear cylinder the result of the iddes model was basically consistent with the bart test data where the rear cylinder was tripped when the boundary layer on the rear cylinder was not tripped the separation point was delayed the wake recirculation zone was small and the downstream velocity was relatively larger than that of the tripped condition 3 3 instantaneous flow field the instantaneous flow fields are visualised in fig 14 using the iso contours of the second invariant of velocity gradient tensor q coloured by the instantaneous streamwise velocity in addition the instantaneous spanwise vorticity w d u 0 is shown in fig 15 the instantaneous q diagram shows that the iddes model provided a relatively detailed resolved flow structure at the same time the roll up of the shedding vortex and the formation of the kelvin helmholtz instability can be seen the instantaneous spanwise vorticity of the piv result from the bart shows that both large scale and small scale flow structures exist the results of other models lockard 2011 are also shown in fig 15 for comparison some of the simulation results display very similar distributions to the bart experiment while others do not have resolved small scale features although the iddes model in this study did not solve the very detailed flow field structure because of the limitation on the number of grids the results were in good agreement with the experimental results 3 4 proper orthogonal decomposition and dynamic mode decomposition the database used in the dmd analysis consisted of 4000 snapshots n 3999 of the full three dimensional velocity fields the streamwise velocity and transverse velocity were used here and they were obtained with an interval of δ t 0 0385 d u 0 where d is the cylinder diameter and u 0 is the velocity the performance loss is defined as follows 34 ψ 100 x 1 φ d i a g α v a n d f x 1 f which is related to the number of retained dmd modes n z card α the retained dmd modes and performance loss of the optimal vector of amplitude α resulting from the sparsity promoting dmd algorithm are presented in fig 16 as a function of user specified parameter γ with an increase in γ a sparser solution could be obtained but at the cost of increasing the performance loss fig 17 shows the eigenvalues generated by the standard dmd algorithm circles and the subset n z selected by the spdmd algorithm crosses for n z 1 only the averaged flow was selected for n z 3 the mean flow and primary dominant frequency pair were consistent with the vortex shedding frequency of the cylinder s t was 0 234 while for n z 5 the lower frequency was identified s t was 0 195 which was related to the vortex shedding of the rear cylinder fig 18 shows the psds of the force on the front and rear cylinders a lower frequency s t 0 195 could be found in the psd of the rear cylinder lift force the corresponding amplitudes for the various truncations nz are displayed in fig 19 fig 20 illustrates the three leading modes of pod dmd and dmdsp the pod dmd and dmdsp modes were nearly identical because this tandem cylinder system was characterised by a specific frequency the first mode of the three methods represented the mean flow field the second mode of three methods represented the primary vortex shedding of the front cylinder and the third mode of the three methods represented the lower frequency of the rear cylinder see fig 21 3 5 acoustic results fig 22 shows the pressure level and acoustic pressure level contours where fig 22 a shows the qff experiment results for the sound pressure spl contour lockard et al 2007 and fig 22 b and c show the pressure spl contours for δt 0 0077t and δt 0 0154t respectively based on the pressure spl contours the rear cylinder is going to dominate the radiation because the pressure fluctuations on its surface are approximately 10 db higher than those on the front cylinder lockard et al 2007 similar to the pressure spl contour the acoustic pressure spl contours which are shown in fig 22 d and e are more illustrative from a noise perspective the acoustic pressure spl contours in fig 22 d and e show that the most intense near field acoustic pressure fluctuations are approximately 45 on the surface of the rear cylinder it can be seen that the time step used in this study had little effect on the calculation results therefore in order to save computing resources requirements concerning cfl conditions can be relaxed by double the discrete time step size the instantaneous acoustic pressure contour is presented in fig 23 the periodic radiation of sound pressure is shown in fig 23 after expanding the calculation domain to evaluate the noise spectra for the three experimental microphone locations a b c the ape solver and fw h equation solver were used to predict the acoustic spectra unsteady data were collected on the surfaces as shown in fig 24 five control surfaces were used to evaluate the fw h integral two permeable surfaces ps open and ps close and three impermeable surfaces ips1 ips2 and ips1 and ips2 combined first the noise predictions from the two permeable surfaces ps open and ps close are compared with the experimental data in fig 25 the results for ps close are in good agreement with the experiment results with the exception that the harmonics of point b are not captured correctly in contrast the results for ps open show a strong non physical growth at low frequencies which is similar to that observed for landing gears spalart et al 2011 and jets shur et al 2005 mendez et al 2009 second the noise predictions for the three impermeable surfaces ips1 ips2 and ips1 and ips2 combined and the ape results are compared with the experimental data in fig 26 the result for ips2 is nearly the same as that for ips1 and ips2 combined and much higher than that for ips1 which is consistent with the analysis in fig 22 the overall trend of the results from the ape is consistent with that of the experiment and the frequency of the primary vortex and its harmonics are well captured at the same time only the noise amplitude is slightly higher at a high s t number the noise spectrum from the ape is rapidly attenuated when s t 1 4 because of the grid size the mesh resolution must be based on the recommended points per wavelength ppw to maintain the accuracy of acoustic predictions ppw speed of sound frequency mesh size it is recommended that a value of approximately 30 be maintained for ppw throughout the zone of interest in this study the mesh size in the region of interest was 0 175d thus the resolved frequency was approximately 1100 hz s t 1 4 fig 27 shows four line probes in the wake centreline the lines y 0 and y d 4 extend within the separated and attached wake regions whereas y d 2 and y 3d 4 are outside the separated region in this study wavenumber decomposition was used to visualise the separate acoustical and convective energy content cfd calculations were used to provide the detailed spatial temporal fluid pressure and acoustic pressure information fig 28 shows the corresponding frequency wavenumber diagrams coloured by the pressure power spectral density psd the positive wavenumbers indicate convection in the flow direction and negative wavenumbers indicate that against the flow fig 28 a c e and g were computed based on the acoustic pressure fig 28 b d f and h were computed based on the fluid pressure the slope of the distinctive line in the wavenumber frequency plot was used to calculate the group velocity of the disturbances travelling along the domain fig 28 a c e and g show the front and rear acoustically propagating waves for the tandem cylinder case fig 28 b d f and h clearly show the upstream and downstream convecting waves indicating reversed and streamwise convecting flow characteristics in the wake centreline where the line averaged reversed convection speed is slower than the line averaged reattached streamwise convecting velocity as expected meanwhile the line averaged reattached streamwise convecting velocity is concentrated at 0 75 u 0 in the gap region 4 conclusions in general the agreement between the experimental findings and the computations was quite good although there was a slight error between the separation point of the rear cylinder and the surface pressure spectrum of the front cylinder the results fully proved the capability of the iddes turbulence model to simulate the wake interaction flow by comparing it with the full range of experimental data the pod dmd and dmdsp modes were nearly identical because this tandem cylinder system was characterised by a specific frequency the first mode of the three methods represented the mean flow field the second mode of the three methods represented the primary vortex shedding of the front cylinder s t was 0 234 and the third mode of the three methods represented the lower frequency of the rear cylinder s t was 0 195 which was consistent with the line averaged reattached streamwise convecting velocity in the gap region approximately 0 75 u 0 from the pressure spl contours the rear cylinder is going to dominate the radiation because the pressure fluctuations were approximately 10 db higher than those on the front cylinder the acoustic pressure spl contours showed that the most intense near field acoustic pressure fluctuations were around 45 on the surface of the rear cylinder first noise predictions from two permeable surfaces ps open and ps close were compared with the experimental data the results for ps close were in good agreement with the experiment with the exception that the harmonics of point b were not captured correctly in contrast the result for ps open exhibited a strong non physical growth at low frequencies which was similar to that observed for landing gears spalart et al 2011 and jets shur et al 2005 mendez et al 2009 second the noise predictions from three impermeable surfaces ips1 ips2 and combined ips1 and ips2 and the ape results were compared with the experimental data the result for ips2 was nearly the same as that for ips1 and ips2 combined and was much higher than that for ips2 the overall trend for the ape results showed consistency with the experiment and the frequency of the primary vortex and its harmonics were well captured at the same time only the noise amplitude was slightly higher at a high s t number credit authorship contribution statement guang chen investigation writing original draft writing review editing formal analysis xi feng liang supervision funding acquisition dan zhou data curation xiao bai li conceptualization methodology writing review editing fu sang lien formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge the experimental and computational resources provided by the high speed train research center of central south university china the author acknowledge the experimental data provided by david lockard from nasa langley research center this study was supported by the china scholarship council file no 201906370098 and the graduate student independent innovation project of central south university grant no 2020zzts117 
20983,a truncated mooring and riser system is the foundation of hybrid model testing of deepwater floating platforms existing truncation design methods are mainly based on multi objective optimization algorithms which make them complicated and time consuming this paper presents an empirical truncation design method which can instantaneously determine the properties of truncated mooring systems and risers using data driven models generated based on supervised learning with an artificial neural network features of the input parameters are constructed specifically for the truncation design and filtered according to their rank of importance to improve the performance of the data driven models moreover the relationship between the truncated properties and overall parameters such as the truncated depth is investigated to propose methods for expanding the application range of the data driven models the accuracies of the data driven models are evaluated statistically using test samples in comparison with the accuracies of the optimization algorithm finally the significant features determining the truncated properties are discussed to reveal the regulations of the truncation design the proposed empirical method can serve as a more efficient tool for the applications of hybrid model testing and the reveal of key features is helpful for understanding the truncation process keywords hybrid model test truncation design machine learning feature importance 1 introduction model test is a reliable approach for investigating the response of a floating production platform under certain environmental conditions however regarding the expanding exploitation of oil and gas in the deep seas the great water depth and large scale of the moorings of floating systems make it difficult to perform model tests owing to the limited size of testing facilities to realize model tests for deepwater floating platforms with mooring systems hybrid model testing is proposed in this method an equivalent truncated mooring and riser system is designed to simulate the full depth system in model tests in addition numerical reconstruction and extrapolation are performed to predict the responses of the full depth system based on the experimental data an equivalent truncated system is the foundation of hybrid model testing thus an efficient truncation design method is essential for ensuring the quality of hybrid model testing active and passive equivalent models are two commonly used truncated models buchner et al 1999 the active equivalent system can completely simulate full depth systems below the truncated depth however complex mechanical facilities and control algorithms are required vilsen et al 2019 sauder et al 2018 developed an active truncation method for slender marine structures where the upper part of the mooring and riser system is physically modelled and the lower part is numerically simulated moreover a sensitivity analysis of the control system connecting the two substructures is performed the feasibility of the method was proved through hybrid model testing for a taut polyester mooring line by contrast the passive equivalent system has fixed anchors and thus a much simpler mechanism however numerical reconstruction and extrapolation are needed ormberg et al 1999 hansen et al 2004 to predict the responses of the full depth system the feasibility of passive truncated models has been proved in many studies stansberg et al 2000 kendon et al 2008 zhang et al 2009 the truncation design of passive equivalent systems is a multi objective optimization problem in which the equivalence of static and dynamic characteristics between the truncated and full depth system is quantified into several objective functions the equivalence of the static characteristics is achieved by adjusting the length wet weight and axial stiffness the equivalence of the dynamic characteristics is achieved by adjusting the diameter and dry mass the numerous objective functions and variables introduce difficulties to the optimization problem therefore researchers have proposed several methods for solving the multi objective optimization problem automatically and efficiently to achieve the equivalence waals and radboud 2004 proposed an optimization strategy that generates a truncated model from a full depth model by adjusting the properties according to factors that indicate deviations from the stiffness curve between the models the truncated models were designed for catenary and taut systems and the numerical simulations proved their equivalence wang et al 2010 applied an equation of the truncation factor to the truncation design of a taut mooring system for a spar platform and proved that the equation is robust and reliable moreover fan et al 2014 proposed an optimized design program that considers both static and dynamic characteristics based on a genetic algorithm they applied the program to the truncation design of catenary semi taut and taut mooring systems and proved its feasibility zhang et al 2014 applied a baton pattern simulated annealing algorithm to perform truncation design of a turret mooring fpso the numerical results confirmed the feasibility of this algorithm furthermore su et al 2007 used a non dominated sorting genetic algorithm to design the truncated model of a cell truss spar the experimental and numerical results showed that the truncated model can properly model the characteristics of the full depth model molins et al 2015 developed an optimization algorithm for the design of truncated mooring systems by using different weights of lines and applied the algorithm to the hybrid model testing of a floating offshore wind turbine the experimental results agreed well with the numerical simulations ferreira et al 2016 proposed a calibration method for truncation design in which the design variables are iterated to fit the truncated system to the full depth system and the dynamic effects are considered by performing coupled analysis under several wave conditions kang et al 2017 investigated similarity criteria and proposed an iterative method for the equivalent design of oil offloading lines in addition wei et al 2017 proposed a four level screening method to perform truncation design for asymmetric mooring and riser systems which have too many objectives to result in the curse of dimensionality in the multi objective optimization problems in the algorithm the objectives representing static and dynamic equivalence are classified into four levels which enables a successive step by step optimization wei et al 2018 proposed an empirical truncation design method based on supervised learning with the linear regression model thus empirical models for the truncation design for mooring systems with four mooring lines at a fixed truncated depth can be generated in general existing methods for truncation design for passive systems are mainly based on optimization algorithms such as the genetic algorithm and non dominated sorting genetic algorithm nsga those algorithms are essentially enumerative algorithms although the multi objective optimization algorithm can generate proper solutions for truncation design numerous individuals and iterations are needed to acquire the ultimate solutions which can be quite complicated and time consuming in addition coding of the multi objective optimization algorithm is complex and code of mooring analysis should also be integrated the method is not suitable for researchers who need to perform deepwater model test but are not specialized in hybrid model testing therefore this paper extends the work of wei et al 2017 wei et al 2018 the aim is to generate data driven models for taut or semi taut mooring systems and catenary risers at optional truncated depth by using supervised learning based on an artificial neural network ann new features of the input parameters are constructed specifically for truncation design and filtered according to their rank of importance to improve the performance of the data driven models the accuracy of the data driven models is evaluated statistically with test samples in comparison with the accuracy of traditional multi objective optimization algorithm in addition the method for expanding the application range of the data driven model is proposed and the significant features determining the truncated properties are discussed which leads to a better understanding of truncation design using the data driven model one can finish truncation design using a simple python script 2 truncation strategies for mooring and riser system to determine the truncated properties efficiently the mooring line and riser should be truncated according to certain strategies such strategies help reduce the complexity of the truncation design and avoid the curse of dimensionality in the multi objective optimization problem of the truncation design 2 1 configurations of investigated mooring systems and risers the truncation of different types of mooring and riser systems should follow different truncation strategies and thus requires different data driven truncation models nevertheless the processes of generating these data driven models are similar in this study taut or semi taut mooring systems whose mooring line consists of three segments and free hanging catenary risers with uniform properties which are commonly used in offshore structures are considered as instances the three segment taut or semi taut mooring lines have no lay down part and are composed of a fairlead chain middle segment and anchor chain as shown in fig 1 a the middle segment is made of composite materials such as polyester to have light weight mooring lines such mooring lines are widely used in deepwater mooring systems owing to their relatively simple configurations low weights and low costs the majority of symmetrical mooring systems in use adopt the type that consists of three or four groups which stretch out in different directions as shown in fig 1 b and each consists of several mooring lines with the angle between neighbouring mooring lines in the range of 5 to 10 such mooring systems are commonly used in floating offshore structures such as fpso spar and semi submersible platforms concerning the properties related to the truncation design as shown in fig 1 a the length wet weight and axial stiffness of the full depth mooring line are l l 1 l 2 l 3 w w 1 w 2 w 3 and e e 1 e 2 e 3 respectively the initial top pre tension and pre angle are r t and a t the horizontal and vertical component of r t are r h and r v the initial tension and declination angle at the anchor point are r d and a d respectively the horizontal and vertical distances between the fairlead and anchor point are d h and d v the corresponding truncated properties are represented by the lowercase as l 1 l 2 l 3 w 1 w 2 w 3 e 1 e 2 e 3 r t a t r h r v r d a d d h and d v respectively the free hanging catenary riser is a common equipment connecting a subsea pipeline to a deepwater floating oil production platform in general it has a small top pre angle a t and long lay down part l d as shown in fig 2 a the layout of the risers is mainly determined by the subsea facilities and is thus normally asymmetric as depicted in fig 2 b the symbols of the properties related to the truncation design are similar to those of the mooring line except that the length wet weight and axial stiffness l w and e respectively are assumed as uniform properties for the riser in addition the length of the hanging part is denoted as l t 2 2 truncation strategies in the truncation design the following aspects should be modelled with the truncated model to achieve static equivalence 1 the floating platform and layout of the mooring and riser system 2 the total horizontal restoring force and vertical force of the system 3 the total moment of the system in the directions of pitch roll and yaw 4 the static tension characteristics for each mooring line and riser as a result the truncation design can be mathematically represented with a multi objective optimization problem 1 m i n f v 1 v 2 v n φ 1 φ 2 φ m v i ω i where v i is the design variable that needs to be calculated ω i the feasible range of the ith design variable and φ i the objective function representing the deviation of the static characteristics between the truncated and full depth systems wei et al 2017 the objective functions are evaluated at several locations in the offset range for instance the objective function for the restoring force is defined as 1 k i 1 k f 1 i f 1 i f 1 i 2 where k is the number of chosen locations in the offset range and f 1 i and f 1 i are the restoring forces of the truncated and full depth systems at the ith location respectively the truncation strategy for the three segment taut or semi taut mooring system is as follows 1 the properties of the fairlead and anchor chains and positions of the fairleads are maintained 2 the length wet weight and axial stiffness of the middle segment are adjusted to achieve static equivalence 3 the pre tension r t is equal to that of the full depth mooring line r t and the span d h is determined based on the static analysis of equilibrium position the feasibility of the presented truncation strategy was proved in wei et al 2017 thus the multi objective optimization equation for a three segment taut or semi taut mooring system can be revised as follows 2 m i n f l 2 w 2 e 2 φ 1 φ 2 φ m l 2 w 2 e 2 ω for a free hanging catenary riser with uniform properties the following truncation strategy is adopted to achieve static equivalence 1 a two segment truncated riser is used to model the static characteristics of the single segment full depth riser the lengths wet weights and axial stiffnesses of the upper and lower segments are represented as l l l l u w w l w u and e e l e u respectively the axial stiffness e u and wet weight w u of the upper segment and the wet weight w l of the lower segment are adjusted to achieve static equivalence 2 the pre tension r t is equal to that of the full depth riser r t during the adjustment the length of the lower segment l l is chosen empirically ensuring that the upper segment will never touch the bottom in the experiment the length of the upper segment l u and the span d h are calculated based on the static analysis of equilibrium position here the truncated riser is separated into two segments because it is impossible for one segment truncated riser with uniform properties to model the variation in the top tension induced by the platform motion and simultaneously maintain the pre tension the variation in the top tension is mainly determined by the weight of the lifted length of the riser when the platform moves after the truncation the same platform motion leads to a longer lifted length and thus a small truncated wet weight is required to equivalently model the variation in the top tension however owing to the decreased length after the truncation a greater wet weight is required to maintain the pre tension which will lead to an inequivalent variation in the top tension therefore a two segment truncated riser is adopted the multi objective optimization equation for the truncation design of a catenary riser can be revised as follows 3 m i n f w u w l e u φ 1 φ 2 φ m w u w l e u ω 3 methodology of truncation design based on data driven models 3 1 general method in this study the method for generating truncation models is mainly based on the supervised learning method samuel 2000 russell et al 1995 where a model mapping from full depth to truncated properties is trained with accomplished truncation tasks by constructing representative features and training with sufficient historical data the model is expected to realize the truncation design within seconds with a sufficiently high accuracy and no need for complex programming in general the process can be summarized as follows 1 gather samples gather a training set and test set that comprise historical truncation tasks accomplished by a traditional multi objective optimization algorithm 2 determine the structure of the model analyze the truncation task to choose the appropriate learning model and construct key features for the truncation design as the inputs of the learning model 3 train and test train the learning model with the samples in the training set and test the accuracy of the model with the samples in the test set 4 improve the performance of the model evaluate and rank the importance of each feature according to the test results filter out the useless features and re train the learning model to acquire the ultimate data driven models for the truncation design in step 1 the full depth properties of the mooring systems are randomly generated with constraints as presented below to guarantee that their properties represent those of a real mooring chain wire rope and polyester on the market l 1 3 50 300 unit m w 1 2 3 10 6000 unit n m e 1 2 3 3 e 7 3 e 9 unit n r t 5 e 5 8 e 6 unit n a t π 9 π 3 unit rad d v 800 1800 unit m similarly for the catenary riser l 1000 3000 unit m w 200 2000 unit n m e 1 e 9 9 e 9 unit n r t 5 e 5 5 e 6 unit n a t π 36 π 9 unit rad d v 800 1800 unit m after the properties of the full depth system have been determined the corresponding properties of the truncated systems are calculated by solving eqs 2 and 3 using the four level screening method wei et al 2017 which is a multi objective optimization algorithm based on nsga ii because no single solution exists that simultaneously optimizes each objective the solution which has the minimal average of the objective functions 1 m i 1 m φ i is chosen as the truncated result sufficient samples covering a wide range of properties and configurations are required to generate precise data driven models more training samples will lead to better accuracy of the data driven model as the increase of training samples the training error and test error will decrease gradually and finally converge to stable values the number of samples is chosen to ensure the convergence the chosen representative truncated depths vary from 400 to 650 m more than 2000 full depth mooring systems are truncated for each layout of the mooring system and each truncated depth for the catenary riser 3000 full depth risers are truncated for each truncated depth the features of the full depth mooring properties and properties of the truncated systems are assembled into samples as inputs and outputs respectively 70 of the samples are selected randomly as the training set and the remaining 30 are used as the test set steps 2 4 are the procedures in which the learning model is established trained and improved the details of the process will be described in the next sections in general an ann zurada 1992 is chosen as the learning model and a number of critical features of the mooring or riser properties are constructed as inputs after the training the importance of each feature is calculated and redundant features that have a limited contribution to the accuracy of the learning model are eliminated subsequently the model is re trained to acquire the data driven models for the truncation design 3 2 establishment and training of learning model different types of mooring systems or risers have different strategies for the truncation design therefore an individual model for one specific type of mooring system or riser rather than a universal but less precise model should be generated our aim is to approximate the underlying relationship between the truncated properties outputs and full depth properties inputs it is a regression problem because the truncated properties are continuous values therefore an ann which is effective in solving regression problem is used to approximate such underlying relationship an ann is an information processing model which is inspired by the way in which biological nervous systems work an ann is composed of a number of highly interconnected neurons working together to solve complicated problems typically the structure of an ann is simplified into layers and the neurons in one layer are only connected to the neurons in the neighbouring layers for an ann with l hidden layers let l 1 l denote the index of the hidden layers s l the number of units in the layer l x l the vector of inputs in layer l x l 1 the vector of outputs from layer l w l the weights in layer l which is an s l s l 1 matrix and b l the biases in layer l which is an s l 1 vector the feed forward operation of the neural network is illustrated in fig 3 and can be mathematically presented as follows 4 x i l 1 f j 1 s l w i j l 1 x j l b i l 1 where f is the activation function which is chosen as the rectifier function f z m a x 0 z for neurons going from the input to the hidden layers and between the hidden layers and as the identity function f z z for neurons going from the hidden to the output layer the parameters of the neural network w l and b l l 1 l are trained by minimizing the loss function using a back propagation algorithm hecht nielsen 1992 the applied loss function is a quadratic cost function 5 j 1 2 m i 1 m y i y i 2 where y i is the truncated property calculated by the traditional multi objective optimization algorithm y i the value of y i predicted by the ann and m the number of samples in the training set the ann used for the truncation design consists of an input layer formed by the full depth features two hidden layers with 512 neurons and 128 neurons respectively and an output layer formed by the truncated properties as shown in fig 3 a the network should include sufficient input features that may influence the truncated properties the features in the input layer denoted as x 1 x 1 1 x 2 1 x s 1 1 t are constructed based on the properties and static characteristics of the mooring system or catenary risers for instance trigonometric equations such as c o s a t and s i n a t can be used which represent the characteristics of the pre angle and e i l i which represents the spring stiffness of the lines in addition the parameters of the length axial stiffness wet weight angle tension and position such as l i l j e i e j w i w j i j a t a b r t r d and d h d v are considered because the orders of magnitude of the properties differ from each other which results in a broad range of values of the raw features the loss function can be easily governed by features with high magnitude and the learning algorithm may fail to prevent this feature scaling is performed before executing the learning algorithm all features are constrained in the range of 0 1 with the min max normalization aksoy and haralick 2001 6 x i 1 x i 1 x i m i n 1 x i m a x 1 x i m i n 1 where x i 1 is the nondimensionalized x i 1 x i m i n 1 and x i m a x 1 are the minimum and maximum of the feature x i 1 respectively in addition for simplicity the output y i is normalized with 7 y i y i y i m a x where y i m a x is the maximum of the output y i in the set the learning models for predicting the truncated properties of the mooring system and catenary riser are coded based on tensorflow wu et al 1609 by using the training and test sets in section 3 1 the data driven models for the truncated properties l 2 w 2 and e 2 for the mooring system and w u w l e u for the catenary riser are trained however because the features are estimated there are a number of irrelevant features that may lead to overfitting and unnecessary computational cost those irrelevant features should be filtered out according to their importance 3 3 estimation of feature importance to evaluate the importance of each feature the method of breiman 2001 is proposed in the method the value of a certain feature is substituted with randomly generated noise and the variation in the test loss after the replacement is calculated as the feature importance the test loss is defined in eq 5 except that the samples originate from a test set the detailed process for calculating the importance of the features is as follows 1 replace the feature with randomly generated noise from the same distribution as the original feature and re train the learning model to determine the increase in the test loss 2 repeat step 1 a number of times for the same feature and calculate the average increase in the test loss to eliminate the luck factor when generating noise 3 apply the average increase in the test loss as the importance of the feature repeat steps 1 and 2 for each feature and rank the features according to their importance the calculated importance actually represents the contribution of the feature to the accuracy of the learning model thus features with less importance have a limited effect as noise while those with greater importance have a more significant effect on the accuracy of the learning model the importance helps distinguish the features that may decide the output and thus reveals the regulation of the truncation design by following the previously presented steps 50 of the most important features are maintained and the learning models described in section 3 2 are re trained to form the ultimate data driven models for the truncation design of the mooring system and catenary riser 4 methods for expanding application range of data driven models in the previously presented method information like the layout of the mooring system and truncated depth is not included in the features because massive additional training samples are required to generate the data driven models that can properly consider those features instead methods for expanding the data driven models to different truncated depths and different layouts of the mooring system are proposed 4 1 data driven models for different truncated depths to expand the data driven models to the optional truncated depth the relationship between the truncated properties and truncated depth is investigated with numerous historical truncation tasks truncation designs of 2000 full depth mooring systems and 3000 catenary risers are performed at several representative truncated depths varying from 400 to 650 m at intervals of 50 m for each truncation task the relationship between the truncated properties and truncated depths is investigated with the pearson correlation coefficient pcc which is a measure of linear correlation between two variables 8 r y d t 1 n i 1 n y i y σ y d t i d t σ d t where d t is the vector of truncated depths d t 1 d t 2 d t k y the vector of corresponding truncated properties l 2 w 2 and e 2 for mooring system and w u w l and e u for the catenary riser at different truncated depths and y and σ y represent the average and standard deviation of y respectively the pcc is between 1 and 1 where 1 implies that y and d t are positively linearly correlated 0 represents no linear correlation and 1 implies that y and d t are negatively linearly correlated subsequently the pccs for each task are calculated and the statistical analysis is performed the estimated probability distribution of the pcc is shown in fig 4 for the three segment taut mooring system the pccs between the truncated depth and each truncated property are mainly near 1 for l 2 and e 2 and 1 for w 2 that is the axial stiffness wet weight and length of the truncated mooring system have an approximately linear relationship with the truncated depth for the truncated properties of the catenary riser fig 4 b the wet weight of the upper segment w u is linearly correlated with the truncated depth and the wet weight of the lower segment w l shows a linear correlation which is less evident than that of w u by contrast the axial stiffness of the upper segment e u has a poor linear correlation with the truncated depth nevertheless it is acceptable because e u has little influence on the static characteristics of the truncated catenary riser which will be described in section 5 by using these linear relationships the data driven models can be expanded to an optional truncated depth first data driven models for a set of discrete truncated depths d t 1 d t 2 d t k must be generated the corresponding truncated properties generated by the data driven models are y 1 y 2 y k then the truncated property y s for the arbitrary truncated depth d t s can be approximated using the least squares method 9 y s k i 1 k d t i y i i 1 k y i i 1 k d t i k i 1 k d t i 2 i 1 k d t i 2 d t s i 1 k d t i 2 i 1 k y i i 1 k d t i i 1 k d t i y i k i 1 k d t i 2 i 1 k d t i 2 4 2 data driven models for different layout of mooring system the majority of deepwater mooring systems have a number of groups each consists of several mooring lines as shown in fig 1 b the layout of a mooring system is denoted as m n where m is the number of groups and n the number of mooring lines in each group the number of groups is mainly determined by the structure of the platform for instance semi submersible platforms with four columns mainly adopt mooring systems with the layout 4 n and floating offshore wind turbines with three columns mainly adopt mooring systems with the layout 3 n first the relationship between the truncated properties and the number of mooring lines in one group n is investigated to simplify the data driven models for different n by taking the 4 n mooring system as an example two sets of full depth mooring systems are generated one has the layout 4 3 while the other has the layout 4 1 each 4 3 mooring system has a corresponding 4 1 mooring system with equal properties of the mooring lines the truncation design is performed for both sets of full depth systems and their dimensionless truncated properties l 2 e 2 and w 2 are compared as shown in fig 5 the x axis represents the truncated properties of the 4 3 mooring system and the y axis represents those of the corresponding 4 1 mooring system evidently the truncated properties exhibit a linear distribution in the vicinity of the line y x that is the truncated properties for layouts with different n agree well and can be replaced with each other in addition the relationship between the truncated properties and the number of groups m is investigated using a similar approach two sets of mooring systems with the layouts 4 3 and 3 3 are generated each 4 3 mooring system has a corresponding 3 3 mooring system with the same properties of the mooring lines both sets are truncated using the multi objective optimization algorithm and the truncation results of mooring systems with identical line properties are compared in fig 6 in comparison with the results in fig 5 those in fig 6 are more dispersed which implies that the correlations of the data driven models for different m are quite weak according to the previously presented relationship the truncated properties of mooring systems with n 1 can be approximated with the data driven models for a mooring system with n 1 however this approach cannot be applied for mooring systems with different m the accuracy of the method will be proved in section 5 5 results and discussion 5 1 equivalence evaluation of data driven models the data driven models for the 4 1 mooring system are evaluated in a statistical analysis the quantile quantile plots of the predicted and target values for a dimensionless truncated length axial stiffness and wet weight are shown in fig 7 a 7 c each point represents a sample of a truncation task its x coordinate is calculated with the data driven model and the y coordinate is calculated with the multi objective optimization algorithm both training and test samples are displayed the results show that both training and test samples converge near y x the convergence of the training samples indicates that the structure of the learning model is sufficiently complicated to fit the training data the convergence of the test samples is more significant because it demonstrates that the model can properly predict the truncated properties when given a new truncation task that does not appear in the training set further investigations are performed to evaluate the general performance of the data driven models while focusing on the equivalence of the static characteristics including the horizontal restoring force f 1 vertical load f 3 and restoring moment f 5 for all samples in the test set the static characteristics of the truncated systems generated by the data driven models and optimization algorithm are calculated respectively subsequently the mean relative errors of f 1 f 3 and f 5 with respect to the full depth systems are calculated using δ i 1 k j 1 k f i j f i j f i j where f i j is f i i 1 3 5 at the jth location in the offset range and f i j is the corresponding full depth value moreover the cumulative probability deisenroth et al 2020 of δ i are calculated to evaluate the equivalence of the static characteristics the cumulative probability of δ i is denoted as p δ i a and can be approximated with the proportion of the samples with δ i a in the test set fig 8 a 8 c show the cumulative probabilities of the mean relative errors of f 1 f 3 and f 5 respectively a tolerance of 5 is chosen as the acceptable error of the truncation design the results show that 44 2 of the truncated systems calculated using the data driven models can maintain the mean relative errors of f 1 below 5 the proportion of the truncated systems with δ 3 below 5 is 80 0 and the proportion with δ 5 below 5 is 47 0 the results demonstrate a much higher efficiency than the method proposed in wei et al 2018 where linear regression was adopted as the learning model and only 25 of the samples exhibited a δ 1 below 5 comparison with the results of the optimization algorithm the cumulative probabilities of the data driven models at the chosen tolerance exhibit a reduction in δ 1 δ 3 and δ 5 by 18 2 4 7 and 18 6 in δ 1 δ 3 and δ 5 respectively the results reveal that the data driven models exhibit a similar equivalence as the optimization method for determining a truncated system with equivalent vertical load f 3 however their ability to find a system with equivalent restoring force and moment is weaker than that of the optimization method nevertheless the data driven models can complete the truncation task much faster than the optimization algorithm the optimization algorithm requires more than 30 min to complete a truncation task whereas the data driven model can complete the same truncation task in less than 1 s with the significant advantage in speed the duration of preparatory work for hybrid model test can be shortened also we can quickly judge whether the scale of the wave basin and the scaled ratio is suitable for the truncated system in addition similar approaches are used to evaluate the data driven models for catenary risers the quantile quantile plots for the wet weight and axial stiffness of the upper segment and wet weight of the lower segment of the predicted and target truncated properties are shown in fig 9 a 9 c in addition the cumulative probabilities of the mean relative errors are shown in fig 10 a 10 c the static characteristics considered in the cumulative probabilities include the horizontal vertical and axial loads of the top tension they are denoted as t 1 t 2 and t 3 respectively as shown in fig 9 a 9 c the predicted values of the wet weight calculated with the data driven models agree well with the target value calculated with the optimization algorithm particularly for the wet weight of the upper segment w u however the samples of the axial stiffness fig 9 b are highly dispersive such dispersion doesn t imply that the data driven models are infeasible according to fig 10 a 10 c approximately 99 of the truncated catenary risers designed with the data driven models can maintain the mean relative errors of t 2 and t 3 below 5 in addition the cumulative probabilities of the data driven models are extremely close to those of the optimization methods thus the data driven models are an efficient substitute for the optimization method in the truncation design of catenary risers although the axial stiffness cannot be properly predicted the data driven models still provide accurate results this is mainly because the axial stiffness is not a key feature in the truncation design of catenary risers which is also proved in the importance analysis of each feature in section 5 3 the static characteristics of catenary risers with different axial stiffness are almost the same therefore multi objective optimization algorithm cannot acquire the optimal axial stiffness since adjustment of axial stiffness has no improvement to the equivalence between full depth and truncated systems as a result axial stiffness cannot be predicted properly by the data driven model who is trained by the samples acquired by multi objective optimization algorithm 5 2 feasibility of methods for expanding application range of data driven models the feasibility of the methods that approximate data driven models for different truncated depths and layouts of mooring systems is investigated to provide an example for the method that approximates the data driven models at an optional truncated depth data driven models for a truncated depth of 588 m are generated by using the six sets of data driven models for truncated depths from 400 m to 650 m at intervals of 50 m the cumulative probabilities of the mean relative errors of horizontal restoring forces f 1 for mooring systems and axial tensions t 3 for catenary risers are calculated the cumulative probabilities at the truncated depths of 575 588 and 600 m are shown in fig 11 as examples where the data driven models for truncated depths of 575 and 588 m are generated using eq 9 according to the results the cumulative probabilities for these three models are similar and the approximated models exhibit a sufficiently high accuracy that is the data driven models generated with the approximation method can be used to properly design an equivalent truncated mooring system and catenary riser at an optional truncated depth in addition the good performance of the approximation method further proves the linear relationship between the truncated properties and truncated depths according to the relationship described in section 4 2 the data driven models for the mooring system with a layout of 4 1 lines can be used for a mooring system with 4 3 lines to further prove this the cumulative probabilities of the mean relative error of f 1 are calculated for a test set of 4 3 mooring systems and its corresponding 4 1 mooring systems as shown in fig 12 the cumulative probabilities of these two test sets are similar and more than 43 4 of the truncated mooring systems calculated with the data driven models can maintain the mean relative errors of f 1 below 5 hence the data driven models for the 4 1 mooring systems are applicable to both layouts of mooring systems therefore using data driven models for m 1 systems to approximate the truncated properties of m n systems is feasible and there is no need to generate extra data driven models and training samples for m n systems in addition the truncation design is performed using optimization algorithm for the test set of 4 3 mooring systems and the cumulative probability of δ 1 is calculated as also shown in fig 12 similar to that in fig 8 a the data driven models exhibit lesser accuracy than the optimization algorithm 5 3 significant features in truncation design the importance of each feature is calculated with the method described in section 3 3 to reveal the significant features larger average increase in the test loss leads to more significant importance and higher order of significance data driven models of 4 1 mooring systems and catenary risers are discussed the key features in order of significance are shown in figs 13 and 14 for the mooring system fig 13 most dimensionless features have a positive variation in the test error which implies that those features improve the accuracy of the data driven models for the truncated length the key features are mainly composed of the length l i wet weight w i vertical spacing d v pre angle a t and pre tension r t of the full depth mooring line such as l i c o s a t and r t l i w i for the truncated axial stiffness the feature l i e i which is the reciprocal of the resultant spring stiffness of the entire mooring line has a much greater variation in the test error than the other features thus the axial stiffness of the truncated mooring line highly depends on the spring stiffness of the full depth mooring line in addition the spring stiffness of the middle segment e 2 l 2 and features composed of the pre angle a t and angle at anchor a d e g c o s a d and a t have an important role regarding the truncated axial stiffness for the truncated wet weight the key features are mainly composed of the pre tension r t wet weight w i length l i and axial stiffness e i of the full depth mooring line such as r t l i e i which is used to approximate the elongation of the full depth mooring line and the dimensionless wet weight w 2 of the middle segment according to the results in fig 9 b for the catenary riser the axial stiffness of the truncated riser has little influence on the static equivalence between the full depth and truncated systems thus only the features of the data driven models for the wet weight w u and w l are analyzed as shown in fig 14 a the wet weight of the upper segment w u is mainly determined by the features such as the dimensionless pre tension r t wet weight w of the full depth riser and total weight of the hanging off part w l t this corresponds to the truncation strategy of the catenary riser in section 2 2 in which the wet weight of the upper segment is adjusted to maintain the pre tension after truncation for the lower segment fig 14 b the wet weight is mainly determined by the dimensionless axial stiffness e and spring stiffness e l of the full depth riser in addition the features composed of the pre angle a t pre tension r t wet weight w and hanging off length l t of the full depth riser also help determine the wet weight of the lower segment of the truncated riser 6 conclusions the proposed method based on ann can properly generate data driven models for three segment taut or semi taut mooring systems and catenary risers the constructed features improve the performance of the learning model in addition quantile quantile plots and cumulative probabilities are used to evaluate the accuracies of the data driven models the convergence of the test samples in the quantile quantile plots and the cumulative probabilities proves that the data driven models exhibit sufficient accuracies in the truncation design for the taut or semi taut mooring systems 44 2 of the test samples exhibit a mean relative error of the restoring force below the tolerance of 5 although the proportion is below that of the optimization algorithm the data driven models have a distinctly shorter computation time in addition for the catenary risers the cumulative probabilities of the data driven models are extremely close to those of the optimization methods the data driven models are an efficient substitute for the optimization method in the truncation design of catenary risers the axial stiffness wet weight and length of the truncated mooring system and the wet weight of the truncated catenary riser exhibit an approximately linear relationship with the truncated depth by using this relationship the data driven models for the optional truncated depth can be effectively approximated with a high accuracy in addition it is demonstrated that the data driven models for mooring systems with different numbers of lines in one group agree well and can be substituted with each other finally the importance of each feature is calculated and the key features influencing the truncated properties are revealed for a mooring system the key features for the truncated length are mainly composed of the length wet weight vertical spacing pre angle and pre tension of the full depth mooring line the truncated axial stiffness highly depends on the spring stiffness of the full depth mooring line the key features for the truncated wet weight mainly comprise the pre tension wet weight length and axial stiffness for catenary risers the wet weight of the upper segment of the truncated riser is mainly determined by the pre tension wet weight and total weight of the hanging off part of the full depth riser in addition the wet weight of the lower segment is mainly determined by the axial stiffness and spring stiffness credit authorship contribution statement handi wei conceptualization methodology writing original draft software longfei xiao conceptualization methodology writing original draft writing review editing mingyue liu data curation software validation yufeng kou visualization investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge the support of the science foundation for the youth scholars of shanghai jiao tong university no af0100097 major project of shanghai zhangjiang national self dependent innovation demonstration area grant no zj2019 zd 002 national natural science foundation of china grant no 52031006 and shanghai sailing program grant no 20yf1419800 
20983,a truncated mooring and riser system is the foundation of hybrid model testing of deepwater floating platforms existing truncation design methods are mainly based on multi objective optimization algorithms which make them complicated and time consuming this paper presents an empirical truncation design method which can instantaneously determine the properties of truncated mooring systems and risers using data driven models generated based on supervised learning with an artificial neural network features of the input parameters are constructed specifically for the truncation design and filtered according to their rank of importance to improve the performance of the data driven models moreover the relationship between the truncated properties and overall parameters such as the truncated depth is investigated to propose methods for expanding the application range of the data driven models the accuracies of the data driven models are evaluated statistically using test samples in comparison with the accuracies of the optimization algorithm finally the significant features determining the truncated properties are discussed to reveal the regulations of the truncation design the proposed empirical method can serve as a more efficient tool for the applications of hybrid model testing and the reveal of key features is helpful for understanding the truncation process keywords hybrid model test truncation design machine learning feature importance 1 introduction model test is a reliable approach for investigating the response of a floating production platform under certain environmental conditions however regarding the expanding exploitation of oil and gas in the deep seas the great water depth and large scale of the moorings of floating systems make it difficult to perform model tests owing to the limited size of testing facilities to realize model tests for deepwater floating platforms with mooring systems hybrid model testing is proposed in this method an equivalent truncated mooring and riser system is designed to simulate the full depth system in model tests in addition numerical reconstruction and extrapolation are performed to predict the responses of the full depth system based on the experimental data an equivalent truncated system is the foundation of hybrid model testing thus an efficient truncation design method is essential for ensuring the quality of hybrid model testing active and passive equivalent models are two commonly used truncated models buchner et al 1999 the active equivalent system can completely simulate full depth systems below the truncated depth however complex mechanical facilities and control algorithms are required vilsen et al 2019 sauder et al 2018 developed an active truncation method for slender marine structures where the upper part of the mooring and riser system is physically modelled and the lower part is numerically simulated moreover a sensitivity analysis of the control system connecting the two substructures is performed the feasibility of the method was proved through hybrid model testing for a taut polyester mooring line by contrast the passive equivalent system has fixed anchors and thus a much simpler mechanism however numerical reconstruction and extrapolation are needed ormberg et al 1999 hansen et al 2004 to predict the responses of the full depth system the feasibility of passive truncated models has been proved in many studies stansberg et al 2000 kendon et al 2008 zhang et al 2009 the truncation design of passive equivalent systems is a multi objective optimization problem in which the equivalence of static and dynamic characteristics between the truncated and full depth system is quantified into several objective functions the equivalence of the static characteristics is achieved by adjusting the length wet weight and axial stiffness the equivalence of the dynamic characteristics is achieved by adjusting the diameter and dry mass the numerous objective functions and variables introduce difficulties to the optimization problem therefore researchers have proposed several methods for solving the multi objective optimization problem automatically and efficiently to achieve the equivalence waals and radboud 2004 proposed an optimization strategy that generates a truncated model from a full depth model by adjusting the properties according to factors that indicate deviations from the stiffness curve between the models the truncated models were designed for catenary and taut systems and the numerical simulations proved their equivalence wang et al 2010 applied an equation of the truncation factor to the truncation design of a taut mooring system for a spar platform and proved that the equation is robust and reliable moreover fan et al 2014 proposed an optimized design program that considers both static and dynamic characteristics based on a genetic algorithm they applied the program to the truncation design of catenary semi taut and taut mooring systems and proved its feasibility zhang et al 2014 applied a baton pattern simulated annealing algorithm to perform truncation design of a turret mooring fpso the numerical results confirmed the feasibility of this algorithm furthermore su et al 2007 used a non dominated sorting genetic algorithm to design the truncated model of a cell truss spar the experimental and numerical results showed that the truncated model can properly model the characteristics of the full depth model molins et al 2015 developed an optimization algorithm for the design of truncated mooring systems by using different weights of lines and applied the algorithm to the hybrid model testing of a floating offshore wind turbine the experimental results agreed well with the numerical simulations ferreira et al 2016 proposed a calibration method for truncation design in which the design variables are iterated to fit the truncated system to the full depth system and the dynamic effects are considered by performing coupled analysis under several wave conditions kang et al 2017 investigated similarity criteria and proposed an iterative method for the equivalent design of oil offloading lines in addition wei et al 2017 proposed a four level screening method to perform truncation design for asymmetric mooring and riser systems which have too many objectives to result in the curse of dimensionality in the multi objective optimization problems in the algorithm the objectives representing static and dynamic equivalence are classified into four levels which enables a successive step by step optimization wei et al 2018 proposed an empirical truncation design method based on supervised learning with the linear regression model thus empirical models for the truncation design for mooring systems with four mooring lines at a fixed truncated depth can be generated in general existing methods for truncation design for passive systems are mainly based on optimization algorithms such as the genetic algorithm and non dominated sorting genetic algorithm nsga those algorithms are essentially enumerative algorithms although the multi objective optimization algorithm can generate proper solutions for truncation design numerous individuals and iterations are needed to acquire the ultimate solutions which can be quite complicated and time consuming in addition coding of the multi objective optimization algorithm is complex and code of mooring analysis should also be integrated the method is not suitable for researchers who need to perform deepwater model test but are not specialized in hybrid model testing therefore this paper extends the work of wei et al 2017 wei et al 2018 the aim is to generate data driven models for taut or semi taut mooring systems and catenary risers at optional truncated depth by using supervised learning based on an artificial neural network ann new features of the input parameters are constructed specifically for truncation design and filtered according to their rank of importance to improve the performance of the data driven models the accuracy of the data driven models is evaluated statistically with test samples in comparison with the accuracy of traditional multi objective optimization algorithm in addition the method for expanding the application range of the data driven model is proposed and the significant features determining the truncated properties are discussed which leads to a better understanding of truncation design using the data driven model one can finish truncation design using a simple python script 2 truncation strategies for mooring and riser system to determine the truncated properties efficiently the mooring line and riser should be truncated according to certain strategies such strategies help reduce the complexity of the truncation design and avoid the curse of dimensionality in the multi objective optimization problem of the truncation design 2 1 configurations of investigated mooring systems and risers the truncation of different types of mooring and riser systems should follow different truncation strategies and thus requires different data driven truncation models nevertheless the processes of generating these data driven models are similar in this study taut or semi taut mooring systems whose mooring line consists of three segments and free hanging catenary risers with uniform properties which are commonly used in offshore structures are considered as instances the three segment taut or semi taut mooring lines have no lay down part and are composed of a fairlead chain middle segment and anchor chain as shown in fig 1 a the middle segment is made of composite materials such as polyester to have light weight mooring lines such mooring lines are widely used in deepwater mooring systems owing to their relatively simple configurations low weights and low costs the majority of symmetrical mooring systems in use adopt the type that consists of three or four groups which stretch out in different directions as shown in fig 1 b and each consists of several mooring lines with the angle between neighbouring mooring lines in the range of 5 to 10 such mooring systems are commonly used in floating offshore structures such as fpso spar and semi submersible platforms concerning the properties related to the truncation design as shown in fig 1 a the length wet weight and axial stiffness of the full depth mooring line are l l 1 l 2 l 3 w w 1 w 2 w 3 and e e 1 e 2 e 3 respectively the initial top pre tension and pre angle are r t and a t the horizontal and vertical component of r t are r h and r v the initial tension and declination angle at the anchor point are r d and a d respectively the horizontal and vertical distances between the fairlead and anchor point are d h and d v the corresponding truncated properties are represented by the lowercase as l 1 l 2 l 3 w 1 w 2 w 3 e 1 e 2 e 3 r t a t r h r v r d a d d h and d v respectively the free hanging catenary riser is a common equipment connecting a subsea pipeline to a deepwater floating oil production platform in general it has a small top pre angle a t and long lay down part l d as shown in fig 2 a the layout of the risers is mainly determined by the subsea facilities and is thus normally asymmetric as depicted in fig 2 b the symbols of the properties related to the truncation design are similar to those of the mooring line except that the length wet weight and axial stiffness l w and e respectively are assumed as uniform properties for the riser in addition the length of the hanging part is denoted as l t 2 2 truncation strategies in the truncation design the following aspects should be modelled with the truncated model to achieve static equivalence 1 the floating platform and layout of the mooring and riser system 2 the total horizontal restoring force and vertical force of the system 3 the total moment of the system in the directions of pitch roll and yaw 4 the static tension characteristics for each mooring line and riser as a result the truncation design can be mathematically represented with a multi objective optimization problem 1 m i n f v 1 v 2 v n φ 1 φ 2 φ m v i ω i where v i is the design variable that needs to be calculated ω i the feasible range of the ith design variable and φ i the objective function representing the deviation of the static characteristics between the truncated and full depth systems wei et al 2017 the objective functions are evaluated at several locations in the offset range for instance the objective function for the restoring force is defined as 1 k i 1 k f 1 i f 1 i f 1 i 2 where k is the number of chosen locations in the offset range and f 1 i and f 1 i are the restoring forces of the truncated and full depth systems at the ith location respectively the truncation strategy for the three segment taut or semi taut mooring system is as follows 1 the properties of the fairlead and anchor chains and positions of the fairleads are maintained 2 the length wet weight and axial stiffness of the middle segment are adjusted to achieve static equivalence 3 the pre tension r t is equal to that of the full depth mooring line r t and the span d h is determined based on the static analysis of equilibrium position the feasibility of the presented truncation strategy was proved in wei et al 2017 thus the multi objective optimization equation for a three segment taut or semi taut mooring system can be revised as follows 2 m i n f l 2 w 2 e 2 φ 1 φ 2 φ m l 2 w 2 e 2 ω for a free hanging catenary riser with uniform properties the following truncation strategy is adopted to achieve static equivalence 1 a two segment truncated riser is used to model the static characteristics of the single segment full depth riser the lengths wet weights and axial stiffnesses of the upper and lower segments are represented as l l l l u w w l w u and e e l e u respectively the axial stiffness e u and wet weight w u of the upper segment and the wet weight w l of the lower segment are adjusted to achieve static equivalence 2 the pre tension r t is equal to that of the full depth riser r t during the adjustment the length of the lower segment l l is chosen empirically ensuring that the upper segment will never touch the bottom in the experiment the length of the upper segment l u and the span d h are calculated based on the static analysis of equilibrium position here the truncated riser is separated into two segments because it is impossible for one segment truncated riser with uniform properties to model the variation in the top tension induced by the platform motion and simultaneously maintain the pre tension the variation in the top tension is mainly determined by the weight of the lifted length of the riser when the platform moves after the truncation the same platform motion leads to a longer lifted length and thus a small truncated wet weight is required to equivalently model the variation in the top tension however owing to the decreased length after the truncation a greater wet weight is required to maintain the pre tension which will lead to an inequivalent variation in the top tension therefore a two segment truncated riser is adopted the multi objective optimization equation for the truncation design of a catenary riser can be revised as follows 3 m i n f w u w l e u φ 1 φ 2 φ m w u w l e u ω 3 methodology of truncation design based on data driven models 3 1 general method in this study the method for generating truncation models is mainly based on the supervised learning method samuel 2000 russell et al 1995 where a model mapping from full depth to truncated properties is trained with accomplished truncation tasks by constructing representative features and training with sufficient historical data the model is expected to realize the truncation design within seconds with a sufficiently high accuracy and no need for complex programming in general the process can be summarized as follows 1 gather samples gather a training set and test set that comprise historical truncation tasks accomplished by a traditional multi objective optimization algorithm 2 determine the structure of the model analyze the truncation task to choose the appropriate learning model and construct key features for the truncation design as the inputs of the learning model 3 train and test train the learning model with the samples in the training set and test the accuracy of the model with the samples in the test set 4 improve the performance of the model evaluate and rank the importance of each feature according to the test results filter out the useless features and re train the learning model to acquire the ultimate data driven models for the truncation design in step 1 the full depth properties of the mooring systems are randomly generated with constraints as presented below to guarantee that their properties represent those of a real mooring chain wire rope and polyester on the market l 1 3 50 300 unit m w 1 2 3 10 6000 unit n m e 1 2 3 3 e 7 3 e 9 unit n r t 5 e 5 8 e 6 unit n a t π 9 π 3 unit rad d v 800 1800 unit m similarly for the catenary riser l 1000 3000 unit m w 200 2000 unit n m e 1 e 9 9 e 9 unit n r t 5 e 5 5 e 6 unit n a t π 36 π 9 unit rad d v 800 1800 unit m after the properties of the full depth system have been determined the corresponding properties of the truncated systems are calculated by solving eqs 2 and 3 using the four level screening method wei et al 2017 which is a multi objective optimization algorithm based on nsga ii because no single solution exists that simultaneously optimizes each objective the solution which has the minimal average of the objective functions 1 m i 1 m φ i is chosen as the truncated result sufficient samples covering a wide range of properties and configurations are required to generate precise data driven models more training samples will lead to better accuracy of the data driven model as the increase of training samples the training error and test error will decrease gradually and finally converge to stable values the number of samples is chosen to ensure the convergence the chosen representative truncated depths vary from 400 to 650 m more than 2000 full depth mooring systems are truncated for each layout of the mooring system and each truncated depth for the catenary riser 3000 full depth risers are truncated for each truncated depth the features of the full depth mooring properties and properties of the truncated systems are assembled into samples as inputs and outputs respectively 70 of the samples are selected randomly as the training set and the remaining 30 are used as the test set steps 2 4 are the procedures in which the learning model is established trained and improved the details of the process will be described in the next sections in general an ann zurada 1992 is chosen as the learning model and a number of critical features of the mooring or riser properties are constructed as inputs after the training the importance of each feature is calculated and redundant features that have a limited contribution to the accuracy of the learning model are eliminated subsequently the model is re trained to acquire the data driven models for the truncation design 3 2 establishment and training of learning model different types of mooring systems or risers have different strategies for the truncation design therefore an individual model for one specific type of mooring system or riser rather than a universal but less precise model should be generated our aim is to approximate the underlying relationship between the truncated properties outputs and full depth properties inputs it is a regression problem because the truncated properties are continuous values therefore an ann which is effective in solving regression problem is used to approximate such underlying relationship an ann is an information processing model which is inspired by the way in which biological nervous systems work an ann is composed of a number of highly interconnected neurons working together to solve complicated problems typically the structure of an ann is simplified into layers and the neurons in one layer are only connected to the neurons in the neighbouring layers for an ann with l hidden layers let l 1 l denote the index of the hidden layers s l the number of units in the layer l x l the vector of inputs in layer l x l 1 the vector of outputs from layer l w l the weights in layer l which is an s l s l 1 matrix and b l the biases in layer l which is an s l 1 vector the feed forward operation of the neural network is illustrated in fig 3 and can be mathematically presented as follows 4 x i l 1 f j 1 s l w i j l 1 x j l b i l 1 where f is the activation function which is chosen as the rectifier function f z m a x 0 z for neurons going from the input to the hidden layers and between the hidden layers and as the identity function f z z for neurons going from the hidden to the output layer the parameters of the neural network w l and b l l 1 l are trained by minimizing the loss function using a back propagation algorithm hecht nielsen 1992 the applied loss function is a quadratic cost function 5 j 1 2 m i 1 m y i y i 2 where y i is the truncated property calculated by the traditional multi objective optimization algorithm y i the value of y i predicted by the ann and m the number of samples in the training set the ann used for the truncation design consists of an input layer formed by the full depth features two hidden layers with 512 neurons and 128 neurons respectively and an output layer formed by the truncated properties as shown in fig 3 a the network should include sufficient input features that may influence the truncated properties the features in the input layer denoted as x 1 x 1 1 x 2 1 x s 1 1 t are constructed based on the properties and static characteristics of the mooring system or catenary risers for instance trigonometric equations such as c o s a t and s i n a t can be used which represent the characteristics of the pre angle and e i l i which represents the spring stiffness of the lines in addition the parameters of the length axial stiffness wet weight angle tension and position such as l i l j e i e j w i w j i j a t a b r t r d and d h d v are considered because the orders of magnitude of the properties differ from each other which results in a broad range of values of the raw features the loss function can be easily governed by features with high magnitude and the learning algorithm may fail to prevent this feature scaling is performed before executing the learning algorithm all features are constrained in the range of 0 1 with the min max normalization aksoy and haralick 2001 6 x i 1 x i 1 x i m i n 1 x i m a x 1 x i m i n 1 where x i 1 is the nondimensionalized x i 1 x i m i n 1 and x i m a x 1 are the minimum and maximum of the feature x i 1 respectively in addition for simplicity the output y i is normalized with 7 y i y i y i m a x where y i m a x is the maximum of the output y i in the set the learning models for predicting the truncated properties of the mooring system and catenary riser are coded based on tensorflow wu et al 1609 by using the training and test sets in section 3 1 the data driven models for the truncated properties l 2 w 2 and e 2 for the mooring system and w u w l e u for the catenary riser are trained however because the features are estimated there are a number of irrelevant features that may lead to overfitting and unnecessary computational cost those irrelevant features should be filtered out according to their importance 3 3 estimation of feature importance to evaluate the importance of each feature the method of breiman 2001 is proposed in the method the value of a certain feature is substituted with randomly generated noise and the variation in the test loss after the replacement is calculated as the feature importance the test loss is defined in eq 5 except that the samples originate from a test set the detailed process for calculating the importance of the features is as follows 1 replace the feature with randomly generated noise from the same distribution as the original feature and re train the learning model to determine the increase in the test loss 2 repeat step 1 a number of times for the same feature and calculate the average increase in the test loss to eliminate the luck factor when generating noise 3 apply the average increase in the test loss as the importance of the feature repeat steps 1 and 2 for each feature and rank the features according to their importance the calculated importance actually represents the contribution of the feature to the accuracy of the learning model thus features with less importance have a limited effect as noise while those with greater importance have a more significant effect on the accuracy of the learning model the importance helps distinguish the features that may decide the output and thus reveals the regulation of the truncation design by following the previously presented steps 50 of the most important features are maintained and the learning models described in section 3 2 are re trained to form the ultimate data driven models for the truncation design of the mooring system and catenary riser 4 methods for expanding application range of data driven models in the previously presented method information like the layout of the mooring system and truncated depth is not included in the features because massive additional training samples are required to generate the data driven models that can properly consider those features instead methods for expanding the data driven models to different truncated depths and different layouts of the mooring system are proposed 4 1 data driven models for different truncated depths to expand the data driven models to the optional truncated depth the relationship between the truncated properties and truncated depth is investigated with numerous historical truncation tasks truncation designs of 2000 full depth mooring systems and 3000 catenary risers are performed at several representative truncated depths varying from 400 to 650 m at intervals of 50 m for each truncation task the relationship between the truncated properties and truncated depths is investigated with the pearson correlation coefficient pcc which is a measure of linear correlation between two variables 8 r y d t 1 n i 1 n y i y σ y d t i d t σ d t where d t is the vector of truncated depths d t 1 d t 2 d t k y the vector of corresponding truncated properties l 2 w 2 and e 2 for mooring system and w u w l and e u for the catenary riser at different truncated depths and y and σ y represent the average and standard deviation of y respectively the pcc is between 1 and 1 where 1 implies that y and d t are positively linearly correlated 0 represents no linear correlation and 1 implies that y and d t are negatively linearly correlated subsequently the pccs for each task are calculated and the statistical analysis is performed the estimated probability distribution of the pcc is shown in fig 4 for the three segment taut mooring system the pccs between the truncated depth and each truncated property are mainly near 1 for l 2 and e 2 and 1 for w 2 that is the axial stiffness wet weight and length of the truncated mooring system have an approximately linear relationship with the truncated depth for the truncated properties of the catenary riser fig 4 b the wet weight of the upper segment w u is linearly correlated with the truncated depth and the wet weight of the lower segment w l shows a linear correlation which is less evident than that of w u by contrast the axial stiffness of the upper segment e u has a poor linear correlation with the truncated depth nevertheless it is acceptable because e u has little influence on the static characteristics of the truncated catenary riser which will be described in section 5 by using these linear relationships the data driven models can be expanded to an optional truncated depth first data driven models for a set of discrete truncated depths d t 1 d t 2 d t k must be generated the corresponding truncated properties generated by the data driven models are y 1 y 2 y k then the truncated property y s for the arbitrary truncated depth d t s can be approximated using the least squares method 9 y s k i 1 k d t i y i i 1 k y i i 1 k d t i k i 1 k d t i 2 i 1 k d t i 2 d t s i 1 k d t i 2 i 1 k y i i 1 k d t i i 1 k d t i y i k i 1 k d t i 2 i 1 k d t i 2 4 2 data driven models for different layout of mooring system the majority of deepwater mooring systems have a number of groups each consists of several mooring lines as shown in fig 1 b the layout of a mooring system is denoted as m n where m is the number of groups and n the number of mooring lines in each group the number of groups is mainly determined by the structure of the platform for instance semi submersible platforms with four columns mainly adopt mooring systems with the layout 4 n and floating offshore wind turbines with three columns mainly adopt mooring systems with the layout 3 n first the relationship between the truncated properties and the number of mooring lines in one group n is investigated to simplify the data driven models for different n by taking the 4 n mooring system as an example two sets of full depth mooring systems are generated one has the layout 4 3 while the other has the layout 4 1 each 4 3 mooring system has a corresponding 4 1 mooring system with equal properties of the mooring lines the truncation design is performed for both sets of full depth systems and their dimensionless truncated properties l 2 e 2 and w 2 are compared as shown in fig 5 the x axis represents the truncated properties of the 4 3 mooring system and the y axis represents those of the corresponding 4 1 mooring system evidently the truncated properties exhibit a linear distribution in the vicinity of the line y x that is the truncated properties for layouts with different n agree well and can be replaced with each other in addition the relationship between the truncated properties and the number of groups m is investigated using a similar approach two sets of mooring systems with the layouts 4 3 and 3 3 are generated each 4 3 mooring system has a corresponding 3 3 mooring system with the same properties of the mooring lines both sets are truncated using the multi objective optimization algorithm and the truncation results of mooring systems with identical line properties are compared in fig 6 in comparison with the results in fig 5 those in fig 6 are more dispersed which implies that the correlations of the data driven models for different m are quite weak according to the previously presented relationship the truncated properties of mooring systems with n 1 can be approximated with the data driven models for a mooring system with n 1 however this approach cannot be applied for mooring systems with different m the accuracy of the method will be proved in section 5 5 results and discussion 5 1 equivalence evaluation of data driven models the data driven models for the 4 1 mooring system are evaluated in a statistical analysis the quantile quantile plots of the predicted and target values for a dimensionless truncated length axial stiffness and wet weight are shown in fig 7 a 7 c each point represents a sample of a truncation task its x coordinate is calculated with the data driven model and the y coordinate is calculated with the multi objective optimization algorithm both training and test samples are displayed the results show that both training and test samples converge near y x the convergence of the training samples indicates that the structure of the learning model is sufficiently complicated to fit the training data the convergence of the test samples is more significant because it demonstrates that the model can properly predict the truncated properties when given a new truncation task that does not appear in the training set further investigations are performed to evaluate the general performance of the data driven models while focusing on the equivalence of the static characteristics including the horizontal restoring force f 1 vertical load f 3 and restoring moment f 5 for all samples in the test set the static characteristics of the truncated systems generated by the data driven models and optimization algorithm are calculated respectively subsequently the mean relative errors of f 1 f 3 and f 5 with respect to the full depth systems are calculated using δ i 1 k j 1 k f i j f i j f i j where f i j is f i i 1 3 5 at the jth location in the offset range and f i j is the corresponding full depth value moreover the cumulative probability deisenroth et al 2020 of δ i are calculated to evaluate the equivalence of the static characteristics the cumulative probability of δ i is denoted as p δ i a and can be approximated with the proportion of the samples with δ i a in the test set fig 8 a 8 c show the cumulative probabilities of the mean relative errors of f 1 f 3 and f 5 respectively a tolerance of 5 is chosen as the acceptable error of the truncation design the results show that 44 2 of the truncated systems calculated using the data driven models can maintain the mean relative errors of f 1 below 5 the proportion of the truncated systems with δ 3 below 5 is 80 0 and the proportion with δ 5 below 5 is 47 0 the results demonstrate a much higher efficiency than the method proposed in wei et al 2018 where linear regression was adopted as the learning model and only 25 of the samples exhibited a δ 1 below 5 comparison with the results of the optimization algorithm the cumulative probabilities of the data driven models at the chosen tolerance exhibit a reduction in δ 1 δ 3 and δ 5 by 18 2 4 7 and 18 6 in δ 1 δ 3 and δ 5 respectively the results reveal that the data driven models exhibit a similar equivalence as the optimization method for determining a truncated system with equivalent vertical load f 3 however their ability to find a system with equivalent restoring force and moment is weaker than that of the optimization method nevertheless the data driven models can complete the truncation task much faster than the optimization algorithm the optimization algorithm requires more than 30 min to complete a truncation task whereas the data driven model can complete the same truncation task in less than 1 s with the significant advantage in speed the duration of preparatory work for hybrid model test can be shortened also we can quickly judge whether the scale of the wave basin and the scaled ratio is suitable for the truncated system in addition similar approaches are used to evaluate the data driven models for catenary risers the quantile quantile plots for the wet weight and axial stiffness of the upper segment and wet weight of the lower segment of the predicted and target truncated properties are shown in fig 9 a 9 c in addition the cumulative probabilities of the mean relative errors are shown in fig 10 a 10 c the static characteristics considered in the cumulative probabilities include the horizontal vertical and axial loads of the top tension they are denoted as t 1 t 2 and t 3 respectively as shown in fig 9 a 9 c the predicted values of the wet weight calculated with the data driven models agree well with the target value calculated with the optimization algorithm particularly for the wet weight of the upper segment w u however the samples of the axial stiffness fig 9 b are highly dispersive such dispersion doesn t imply that the data driven models are infeasible according to fig 10 a 10 c approximately 99 of the truncated catenary risers designed with the data driven models can maintain the mean relative errors of t 2 and t 3 below 5 in addition the cumulative probabilities of the data driven models are extremely close to those of the optimization methods thus the data driven models are an efficient substitute for the optimization method in the truncation design of catenary risers although the axial stiffness cannot be properly predicted the data driven models still provide accurate results this is mainly because the axial stiffness is not a key feature in the truncation design of catenary risers which is also proved in the importance analysis of each feature in section 5 3 the static characteristics of catenary risers with different axial stiffness are almost the same therefore multi objective optimization algorithm cannot acquire the optimal axial stiffness since adjustment of axial stiffness has no improvement to the equivalence between full depth and truncated systems as a result axial stiffness cannot be predicted properly by the data driven model who is trained by the samples acquired by multi objective optimization algorithm 5 2 feasibility of methods for expanding application range of data driven models the feasibility of the methods that approximate data driven models for different truncated depths and layouts of mooring systems is investigated to provide an example for the method that approximates the data driven models at an optional truncated depth data driven models for a truncated depth of 588 m are generated by using the six sets of data driven models for truncated depths from 400 m to 650 m at intervals of 50 m the cumulative probabilities of the mean relative errors of horizontal restoring forces f 1 for mooring systems and axial tensions t 3 for catenary risers are calculated the cumulative probabilities at the truncated depths of 575 588 and 600 m are shown in fig 11 as examples where the data driven models for truncated depths of 575 and 588 m are generated using eq 9 according to the results the cumulative probabilities for these three models are similar and the approximated models exhibit a sufficiently high accuracy that is the data driven models generated with the approximation method can be used to properly design an equivalent truncated mooring system and catenary riser at an optional truncated depth in addition the good performance of the approximation method further proves the linear relationship between the truncated properties and truncated depths according to the relationship described in section 4 2 the data driven models for the mooring system with a layout of 4 1 lines can be used for a mooring system with 4 3 lines to further prove this the cumulative probabilities of the mean relative error of f 1 are calculated for a test set of 4 3 mooring systems and its corresponding 4 1 mooring systems as shown in fig 12 the cumulative probabilities of these two test sets are similar and more than 43 4 of the truncated mooring systems calculated with the data driven models can maintain the mean relative errors of f 1 below 5 hence the data driven models for the 4 1 mooring systems are applicable to both layouts of mooring systems therefore using data driven models for m 1 systems to approximate the truncated properties of m n systems is feasible and there is no need to generate extra data driven models and training samples for m n systems in addition the truncation design is performed using optimization algorithm for the test set of 4 3 mooring systems and the cumulative probability of δ 1 is calculated as also shown in fig 12 similar to that in fig 8 a the data driven models exhibit lesser accuracy than the optimization algorithm 5 3 significant features in truncation design the importance of each feature is calculated with the method described in section 3 3 to reveal the significant features larger average increase in the test loss leads to more significant importance and higher order of significance data driven models of 4 1 mooring systems and catenary risers are discussed the key features in order of significance are shown in figs 13 and 14 for the mooring system fig 13 most dimensionless features have a positive variation in the test error which implies that those features improve the accuracy of the data driven models for the truncated length the key features are mainly composed of the length l i wet weight w i vertical spacing d v pre angle a t and pre tension r t of the full depth mooring line such as l i c o s a t and r t l i w i for the truncated axial stiffness the feature l i e i which is the reciprocal of the resultant spring stiffness of the entire mooring line has a much greater variation in the test error than the other features thus the axial stiffness of the truncated mooring line highly depends on the spring stiffness of the full depth mooring line in addition the spring stiffness of the middle segment e 2 l 2 and features composed of the pre angle a t and angle at anchor a d e g c o s a d and a t have an important role regarding the truncated axial stiffness for the truncated wet weight the key features are mainly composed of the pre tension r t wet weight w i length l i and axial stiffness e i of the full depth mooring line such as r t l i e i which is used to approximate the elongation of the full depth mooring line and the dimensionless wet weight w 2 of the middle segment according to the results in fig 9 b for the catenary riser the axial stiffness of the truncated riser has little influence on the static equivalence between the full depth and truncated systems thus only the features of the data driven models for the wet weight w u and w l are analyzed as shown in fig 14 a the wet weight of the upper segment w u is mainly determined by the features such as the dimensionless pre tension r t wet weight w of the full depth riser and total weight of the hanging off part w l t this corresponds to the truncation strategy of the catenary riser in section 2 2 in which the wet weight of the upper segment is adjusted to maintain the pre tension after truncation for the lower segment fig 14 b the wet weight is mainly determined by the dimensionless axial stiffness e and spring stiffness e l of the full depth riser in addition the features composed of the pre angle a t pre tension r t wet weight w and hanging off length l t of the full depth riser also help determine the wet weight of the lower segment of the truncated riser 6 conclusions the proposed method based on ann can properly generate data driven models for three segment taut or semi taut mooring systems and catenary risers the constructed features improve the performance of the learning model in addition quantile quantile plots and cumulative probabilities are used to evaluate the accuracies of the data driven models the convergence of the test samples in the quantile quantile plots and the cumulative probabilities proves that the data driven models exhibit sufficient accuracies in the truncation design for the taut or semi taut mooring systems 44 2 of the test samples exhibit a mean relative error of the restoring force below the tolerance of 5 although the proportion is below that of the optimization algorithm the data driven models have a distinctly shorter computation time in addition for the catenary risers the cumulative probabilities of the data driven models are extremely close to those of the optimization methods the data driven models are an efficient substitute for the optimization method in the truncation design of catenary risers the axial stiffness wet weight and length of the truncated mooring system and the wet weight of the truncated catenary riser exhibit an approximately linear relationship with the truncated depth by using this relationship the data driven models for the optional truncated depth can be effectively approximated with a high accuracy in addition it is demonstrated that the data driven models for mooring systems with different numbers of lines in one group agree well and can be substituted with each other finally the importance of each feature is calculated and the key features influencing the truncated properties are revealed for a mooring system the key features for the truncated length are mainly composed of the length wet weight vertical spacing pre angle and pre tension of the full depth mooring line the truncated axial stiffness highly depends on the spring stiffness of the full depth mooring line the key features for the truncated wet weight mainly comprise the pre tension wet weight length and axial stiffness for catenary risers the wet weight of the upper segment of the truncated riser is mainly determined by the pre tension wet weight and total weight of the hanging off part of the full depth riser in addition the wet weight of the lower segment is mainly determined by the axial stiffness and spring stiffness credit authorship contribution statement handi wei conceptualization methodology writing original draft software longfei xiao conceptualization methodology writing original draft writing review editing mingyue liu data curation software validation yufeng kou visualization investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge the support of the science foundation for the youth scholars of shanghai jiao tong university no af0100097 major project of shanghai zhangjiang national self dependent innovation demonstration area grant no zj2019 zd 002 national natural science foundation of china grant no 52031006 and shanghai sailing program grant no 20yf1419800 
20984,as being increasingly used for underwater explorations autonomous underwater vehicles auvs are diversified in their structures and outlines to match up with various mission requirements which brings challenges to the design of customized submerged docking stations aiming at providing a generalized solution this paper proposes an omnidirectional and positioning tolerant planar type auv docking and charging platform which has no constraints on auv structures in order to solve the planar type docking issues an integrated visual navigation and docking algorithm is developed for the miniaturized prototype auv the adopted monocular simultaneous localization and mapping slam program takes charge of the wide range underwater locationing and handles practical problems such as scale drift and tracking failure a combined control strategy of horizontal dynamic positioning and vertical visual servo docking is developed for the terminal docking process the strategy is robust against constant water flow disturbance and performs stable docking using a roll motion adjustment the visual navigation and docking performances and other system functions are successfully validated in simulation water pool experiment and sea trial keywords autonomous underwater vehicle auv planar docking platform underwater visual slam visual servo wireless power transfer 1 introduction underwater docking systems enable unmanned charging and data collection for auvs and have been actively studied since the last century stokey et al 1997 yazdani et al 2020 conventional auv docking systems are usually custom designed to match up with specific auv outlines and structures kawasaki et al 2004 kimball et al 2018 myint et al 2018 sarda and dhanak 2017 sato et al 2017 since torpedo shaped auvs are very popular due to their excellent hydrodynamic characteristics most of the docking systems are tailored for such kind of auvs allen et al 2006 mcewen et al 2008 park et al 2009 stokey et al 2001 teo et al 2012 yang et al 2016 these docking stations utilize cone shaped entrances to provide the auvs with positioning tolerance and collision guidance as marine science and technology develops there is an increasing need for auvs to execute complex underwater tasks for example close range and high resolution coral reef observation and underwater videotaping bonin font et al 2015 in such cases where auv flexibility and accurate motion control have higher priorities the conventional torpedo shape is no longer preferred on contrary shapes and structures of auvs are diversified to obtain certain abilities such as moving agility yu et al 2016 and underwater hovering kim and eustice 2013 for these types of auvs however docking system designs become more challenging there are several kinds of docking stations for non torpedo auvs in the literature kawasaki et al 2004 kimball et al 2018 myint et al 2018 each of them is designed for a specific type of auv although these docking systems dealt well with data collection and energy supply issues they have some drawbacks in common 1 each docking station has a personalized structure to match up with a unique auv outline and can hardly be used for other auvs 2 the docking stations have strict requirements for accurate underwater positioning and hardly allowing any misalignment especially for the power transfer devices sato et al 2017 which brings difficulties in the docking process and may even cause docking failures sometimes aiming at solving these problems an omnidirectional and positioning tolerant planar type auv docking and charging system is developed in this paper fig 1 including both system hardware and a monocular vision based navigation and docking method the docking station has a concise and widely applicable planar docking surface which almost has no constraints on auv structures thus is particularly suitable for auvs with complex shapes and structures used for shallow water and close range observations also this kind of station setup provides enough misalignment tolerance and maximum convenience for the docking mission although acoustic devices are widely used for underwater communication and positioning paull et al 2014 they can hardly be adopted in miniaturized and low cost auvs due to their weight and budget limitations moreover the terminal docking process of an auv usually relies more on accurate visual guidance rather than acoustic devices for example a typical terminal guidance approach for a cone shaped docking station is to install one or several lights on the cone entrance and an auv with a forward camera recognizes and goes towards the lights until it gets into the station park et al 2009 yang et al 2016 for these reasons this paper extends the usage of the monocular camera of our prototype auv not only for the terminal docking process but also for the navigation and localization in larger areas visual simultaneous localization and mapping slam is qualified to serve for the tracking and navigation tasks of auvs burguera et al 2015 mahon et al 2008 application of visual slam in the harsh underwater environment is challenging due to the water turbidity illumination variation and feature sparseness cho and kim 2018 proposed a hybrid model based and model free image enhancement algorithm to tackle the turbid underwater environment the model based method has higher image quality while the model based one is more time saving aiming at performing hull inspection kim and eustice 2013 presented an underwater slam algorithm for feature poor areas using visual saliency with tracking performance enhanced by a saliency based keyframe culling and loop closing strategy lee et al 2014 introduced a single cluster probability hypothesis density filter method for visual slam to effectively aid the underwater tracking of auvs in order to solve the planar type docking issues for the system an integrated slam based navigation and visual servo docking algorithm is developed in this paper which to the best of our knowledge has rarely been discussed in the literature the algorithm solves both the long range navigation and terminal docking problems the slam framework constructs a real scale map of underwater terrain using sensor fusion and deals with tracking failure by a multi map management strategy when the auv catches sight of the charging platform the docking task is taken in charge by a visual servo algorithm to achieve better docking accuracy and robustness the terminal docking control strategy combines horizontal dynamic positioning and vertical visual servo docking control which is robust against constant water flow disturbance and performs stable docking using a roll motion adjustment this paper is organized as follows section 2 briefly describes the hardware construction of the entire system including both the planar docking station and the prototype auv section 3 introduces the underwater slam framework implemented to the auv section 4 introduces the dynamic positioning and visual servo docking control strategy section 5 provides the simulation and experiment of the system including both the visual navigation and docking experiment and the charging function validation section 6 concludes the paper and gives an outlook for future work 2 system construction 2 1 positioning tolerant and omnidirectional planar type docking platform in order to provide enough docking convenience and positioning tolerance a concise planar docking and charging board is utilized in the platform as shown in fig 1 all the circuit components are sealed inside a pressure chamber under the charging board the circuit components are connected to the charging board and the power source on land through watertight cables a docking pattern is painted on the platform surface which can be recognized by the auv camera for docking a ferrite shielding layer is arranged beneath the charging plane to minimize the flux leakage ferrite bars are also placed on the coil centers to serve as neat and elegant electromagnetic holding structures when the auv stays on the platform surface its electromagnet holds on to these ferrite plates for fixation preventing the auv from being carried away by water flow the charging plane contains 9 rounded corner square coil units arranged in a 3 3 array and provides an about 0 6 m 0 6 m effective charging area for the auv the coil units are divided into 3 groups driven by 3 parallel lcc compensating networks as shown in fig 2 all the circuit components are strictly calculated taking the mutual inductance of the coils into consideration detailed discussions about the wpt performance of the charging platform can be found in our previous work wang and yang 2020 yang et al 2019 and a brief introduction of the system properties is presented here choosing the compensating capacitors are chosen according to 1 c i 1 l i 2 c i 2 l i m i l i 2 c i 2 1 ω 2 l i 2 c s 1 ω 2 l s i 1 2 3 2 l 12 l 22 l 32 c 12 c 22 c 32 where m i i 1 2 3 denotes the total mutual inductance between the ith branch and the other two branches given that the wire resistance of the compensating inductances are very small taking the approximation of r i 2 0 the output voltage on the equivalent load then becomes 3 u s u i n r l l 12 r l r s i m i s i 1 2 3 the overall wpt efficiency becomes 4 η ω 2 i m i s 2 ω 2 i m i s 2 r l i r i 1 i 1 2 3 where i m i s i 1 2 3 denotes the summation of all the mutual inductances between the secondary coil and all the primary coil branches in the layout design of the coil array the magnetic field generated by the primary coil array is carefully optimized in both its intensity and uniformity therefore i m i s almost remains constant when the secondary coil is placed on arbitrary positions within the charging area and with arbitrary heading directions and the output voltage and overall efficiency are stabilized regardless of the docking misalignment as shown equation 3 and equation 4 moreover given that r l r s the output voltage remains constant when the load varies consequently the auv has an equal charging performance regardless of its docking position and heading direction on the platform it can also be observed from equation 4 that the wire resistance of the power emitting coil is one of the major factors that decreasing the power transfer efficiency long wires are needed to form the large coils and long cables are necessary for connecting the primary coils with the driven circuits which cause an inevitable drop in the overall charging efficiency 2 2 the prototype home i mini auv the prototype home i mini auv is specifically designed for close range and up to 100 m of water depth observations fig 1 it is approximately 500 mm in length 300 mm in width and 250 mm in height except for the antenna and has a total weight of about 15 kg which is rather tiny and lightweight compared to most commercial auv products the structure of the auv is illustrated in fig 3 since that taking submarine videos and photos has a high demand for maneuverability it is equipped with 4 thrusters to provide a 4 dofs motion including surge yaw heave and roll in most cases the auv is passively stable in roll and pitch the roll motion is adjusted only in the docking descending process within a limited range which will be fully discussed in section 4 the functional diagram of the home i mini auv is illustrated in fig 4 although acoustic devices are widely used for submarine positioning they are usually heavy and expensive and thus is currently abandoned in this miniaturized prototype auv it relies on a visual algorithm for underwater locationing the auv has two cameras the downward looking camera is the major visual sensor collecting images for the slam navigation and visual servo docking while the forward looking camera is just used for observations recording videos and photos and is also reserved for expended functions such as obstacle avoidance the real time slam program is taken in charge by an independent visual processer of the auv due to its high computational burden all the other functions are operated on a microcontroller unit mcu including communicating with the operator collecting all the sensor data running the navigation and controlling program supervising the battery charging process etc high speed communication is established between the mcu and the visual processor the visual slam performance is also improved by fusing the data of an inertial measurement unit imu and a depth sensor notice that all the auv components are highly modular especially the power receiving coil mounted on the bottom this modular power receiver is not only customized for the prototype home i auv but is also suitable for many other auvs with arbitrary structures and outlines and so is the versatile planar charging platform owing to such features and advantages the proposed auv docking system is believed to have a promising application in the submarine observation domain 3 monocular slam for auv underwater locationing visual slam is a budget saving solution which offers accurate position and motion measurements thus is very suitable for close range underwater navigation of miniaturized auvs slam systems can be categorized by their image process approaches as being direct feature based or a hybrid of both the direct methods which make use of the pixel information directly are usually sensitive to illumination change thus are not suitable for the underwater environment where the light condition is complicated and changeable the feature based methods however are much more robust against illumination changes but may be unstable in feature poor areas slam systems can also be categorized as filter based or keyframe based approaches where the keyframe based approaches are commonly regarded as being better behaved especially in the time efficiency strasdat et al 2012 younes et al 2017 for the above reasons an integrated multi thread key frame based monocular slam program is built for the home i auv as shown in fig 5 based on the framework of the outstanding open source orb slam project mur artal et al 2015 mur artal and tardos 2017a the program built in this paper takes full advantage of the imu depth sensor and other external information to provide real scale underwater positioning and mapping and at the same time solving practical problems such as tracking failure the visual servo for the auv docking process is integrated into the program as an independent thread and executed by a task switching technique the basic logical frame of the tracking local mapping and loop closing threads are similar to those of the orb slam and this paper only focuses on the major adjustment and improvement made for the practical underwater navigation usage 3 1 sensor fusion and real scale acquisition in order to provide a true scale initialization an off line measurement of the water depth is conducted at the place where the auv mission starts the implemented slam program detects features and textures of seafloor topography and extracts orb features from the images to construct frames since most of the underwater scenarios are highly planar the program uses homography h between the first two frames for the automatic initialization the initial depth measurement of the starting scene is then added to the initial map for rescaling after the slam program finishes an unscaled initialization it obtains a set of unscaled map points p w j x w j y w j z w j and an initial auv pose t 2 with regard to the starting pose t 1 using the auv depth z 2 measured by the depth sensor and the initial scene depth d ˆ known in prior the map points can be rescaled as 5 p w j s r p w j where s r is the scale factor given by 6 s r d ˆ z 2 1 j j z w j z 2 the normalized translation vector t 21 in the camera pose matrix t 21 is also rescaled using the same factor 7 t 21 t 2 t 1 1 r 21 s r t 21 0 1 a pure visual keyframe based slam approach is able to reach a higher accuracy than a visual inertial solution because fusion with other low sensors with lower resolutions may cause a decrease in accuracy mur artal and tardos 2017b however the slam approach for a practical auv navigation system must be aligned with the geodetic coordinates with the aid of an imu moreover taking full advantage of the imu data significantly improves the system stability and robustness which are the top priorities in practical application therefore taking into account the computational limitation of the visual processor a loosely coupled visual inertial solution is applied in this system both imu and depth sensor data into the initialization 8 f p w j t i argmin j e p r o j 2 ρ d d ˆ z w j 2 ρ r r i r i w i m u 2 9 e p r o j 2 e p 2 j t 2 p w j t λ 2 1 e p 2 j t 2 p w j where λ2 is the covariance matrix of the reprojection error ρ d and ρ r are weight coefficients of the depth and imu measurement error respectively after the system is initialized it performs an imu guided motion tracking the inter frame motion is first estimated using imu data instead of using a constant speed model the reason for doing so is that objective functions of optimization based slam are always highly non convex the optimal solutions rely highly on the initial values and a good initial estimation usually led to a more reliable optimization result the inter frame motion estimation is denoted by 10 t i 1 i ω ˆ i 0 v ˆ i 1 r i w i m u r i 1 w i m u 1 0 r i w i m u u d y n 1 where u dyn denotes the surge velocity estimated from the auv dynamics r i w i m u denotes the auv pose and r i 1 w i m u is the pose of the last frame the estimated angular velocity is expressed using the corresponding rotation matrix given an initial motion estimation the slam approach optimizes the inter frame motion using bundle adjustment ba minimizing the reprojection error together with other residuals an integrated objective function is given below 11 f p i t i argmin j e p r o j i e i m u i e z i e u i 12 e p r o j i e p i j t i p w j t λ i 1 e p i j t i p w j 13 e i m u i ρ r r i r i w i m u 2 14 e z i ρ z t z i z i 2 15 e u i ρ u t i u d y n 2 where e proj is the reprojection error term e imu is the imu measurement residual term e z is the depth measurement error term and e u is the speed error term the corresponding information matrices or weight coefficients indicate the reliability of the error terms and can vary as the auv motion state changes for example during constant speed navigation the speed estimation is reliable and the imu data is less important but when a sharp turn occurs the imu measurement is much more helpful and reliable than other sensor data the information matrices and weight coefficients are adjusted online by interactive communication between the visual processor and the mcu controlling core the map is updated and new map points are created using triangulation after the inter frame motions are optimized 3 2 multi map management for tracking failure unlike scenes on the ground the underwater environment is usually turbid and feature poor which is troublesome for slam applications in some extreme featureless or turbid areas for instance no matter how the camera images are enhanced no valid features are able to be extracted for such cases tracking failure is inevitable tracking failure cannot be well solved by a pure visual slam approach without the help of other sensor data waiting for re localization is a common and simple method adopted in many laboratorial slam programs but can seriously damage an on going mission in practice multi map management strategy has been proposed in the literature for both improving tracking accuracy and dealing with tracking failure hu et al 2019 but such a strategy is bulky and does not takes full use of other sensors hence is not suitable for the practical auv navigation system in this paper a lightweight multi map management strategy is applied to the slam system only for solving the practical tracking failure problem as illustrated in fig 6 in fig 6 m n and m n 1 are two adjacent sub maps f k n denotes the kth frame which belongs to the n th sub map when tracking is lost the system performs an immediate re initialization to build a new sub map and simultaneously starts a temporary model based dead reckoning and stops until the re initialization finishes the dead reckoning combines the imu data auv dynamic model and thruster model to perform motion estimations between the sub maps to reduce the dead reckoning error during the tracking failure period the auv keeps a stable pose and speed which are controlled by the mcu motion estimations between the sub maps are treated as optimization constraints during the loop closing the estimated displacements in every sampling interval are calculated by 16 δ x u ˆ cos ψ i u w δ t δ y u ˆ sin ψ i v w δ t where u ˆ denotes the estimated surge speed ψ i is the yaw angle measured from the imu u w and v w are the current speed component in the x and y direction respectively and δt is the sampling time the translational vector within the whole tracking failure period is 17 t k k 1 k k 1 u ˆ cos ψ i u w δ t k k 1 u ˆ sin ψ i v w δ t z k 1 z k t furthermore the head to tail constraint between every two adjacent sub maps is derived as 18 t k 1 n 1 t k n k 1 n 1 t k n r k 1 n 1 r k n 1 t k k 1 0 1 t k n where the rotation constraint is measured by the imu and the translational constraint is given in 17 when the auv comes back to a scene that has been visited before it searches for the best matched reference frame in the map calculates a similarity transformation t sim3 between the reference frame f r and current frame f c and then conducts a loop closing when the auv performs a global optimization in loop closing the constraints between sub maps must be included in the objective function as 19 f p t argmin i j e p r o j i e i m u i e z i e u i m e m a p argmin i j e p r o j i e i m u i e z i e u i m ρ m t m 1 m t ˆ m 1 m 2 where the objective function in 19 is synthesized by combining 11 and 18 by solving equation 19 the accumulated error is propagated to all the key frames in the map with the same principle loop closing can also be done when the auv finds a landmark with a known location such as the charging platform 4 visual servo docking control a stable and feasible docking strategy is vital for an auv docking system it should take both the auv motion capacity and docking station structure into consideration considering the special structure of the proposed system a combined two step homing and docking strategy is proposed a horizontal dynamic positioning step and a vertical visual servo docking step as illustrated in fig 7 the auv firstly navigates at a constant depth and dynamically stops on top of the platform at point p t and secondly descends towards the platform center p c by visual servo until it touches the platform surface constant water current disturbance is considered during the whole docking process the corresponding control diagram is shown in fig 8 4 1 kinematic controller the controller design is firstly derived at the kinematic level the horizontal dynamic positioning process adopts the traditional line of sight los strategy choosing the target waypoint right above the docking platform center referring to the method proposed by aguiar and pascoal 2007 the error between the current auv position p x y and the target position p t x t y t can be defined by 20 e x x t 2 y y t 2 β arctan y t y x t x ψ where e is the distance error and β is the yaw angle error assuming a constant water current disturbance characterized by intensity v w and direction ψ w the kinematic equations of the auv motion can then be written as 21 e u r cos β v r sin β v w cos ψ β ψ w β 1 e u r sin β v r cos β v w sin ψ β ψ w r e 0 ψ r where u r and v r are the auv surge and sway velocity w r t the water current choosing the kinematic controller as 22 u r k u e v w cos ψ ψ w r k r β k u sin β 1 e v r cos β 1 e v w sin ψ ψ w cos β e 0 it can be verified that using the control law in 22 the positioning error e and β converges to zero as t moreover the auv keeps itself aligned against the water flow at the positioning point aguiar and pascoal 2007 which is a necessary preparation for the next docking step although visual slam introduced in section 3 offers good position and velocity measurement for the auv during long range navigation and horizontal dynamic positioning the vertical descending and docking process needs a faster and more accurate visual measurement for optimal docking performance therefore a more accurate and straight forward visual servo method is utilized which takes the image information as a direct feedback as illustrated in fig 9 also since the auv is not likely to conduct a dynamic positioning exactly above the docking platform center p c in practice the horizontal positioning error must be corrected during the vertical docking process photos of the docking platform pattern are taken at different distances offline to form up a reference frame set f r and then stored in the auv visual processor for a certain reference frame f r the platform center p c in its camera coordinates is p r x r y r z r once a new frame f is caught the auv searches for the best match in the reference image set when the best matched reference image f r is found the relationship between p r and the platform center p c in the auv camera coordinate p x y z satisfies 23 p h p r where h is the homography matrix considering the corresponding kinematic relationship the homography between current and reference image is given by benhimane and malis 2006 24 h r tn r t 1 z r where r and t are the rotation matrix and translational vector from f to f r respectively n r is the unit normal vector of the reference plane that points downward an objective function can then be defined according to the auv kinematic model 25 e e v e ω t i r p r 2 α sin γ s n r t where the rotation matrix r is denoted by a rotation angle γ along an axis α s n r denotes the conversion from n r to its antisymmetric matrix from the perspective of computer vision the objective function can also be written as 26 e e v e ω i h p r s 1 h h t it can be proved using that the expression in 25 and 26 are isomorphic that is only when ω 0 and t 0 e 0 time derivative of the objective function is 27 e e v e ω i s e v p r s n r s n r s t 2 ω v ω where 28 ω i sin γ 2 s α α t sin 2 γ 2 2 ι s 2 α a common visual servo aims to let the objective function asymptotically converges to zero however since the charging platform is omnidirectional it naturally gives no constraint on the heading direction of the auv moreover as mentioned above the yaw angle of the auv is kept aligned against the water flow in the dynamic positioning process for stability concerns during the docking process the heading angle of the auv is kept unchanged so that the water flow can be easily canceled just by its surge velocity therefore only the translation component of e is considered here expanding 27 yields 29 e v e u e v e w u r u w e w z r q e v y r r v r v w e w z r p e u x r r w e v y r p e u x r q ideally the auv is expected to dock on the center of the charging board which is therefore chosen as the landing target and gives x r y r 0 the auv has a constant yaw and pitch angle which gives q 0 r 0 v w 0 equation 29 can then be simplified as 30 e v e u e v e w u r u w v r e w z r p w e v p a roll motion adjustment strategy is utilized for lateral misalignment compensation and the control law is 31 u r k e u e u u w p v r e w z r k e v e v w w d 0 where k eu 0 k ev 0 equation 30 then becomes 32 e v e u e v e w k e u e u k e v e w z r e v w d e v p equation 32 verifies that by applying the control law in equation 31 the deviation of platform center in the camera view asymptotically converges to zero however e w is should not converge in the vertical direction because the auv is expected to keep an approximately constant velocity to descend towards the docking surface 4 2 dynamic controller in this section the outer loop kinematic controller is extended to the inner loop dynamic controller taking the results of the outer loop as virtual inputs considering the kinematic virtual inputs of the docking process let α u α p and α w be the virtual control law introducing the control errors 33 z u u r α u z p p α p z w w α w the controller design utilizes the 6 dof auv dynamic model proposed by fossen 2011 34 m v r c v r v r d v r v r g η τ where m m rb m a which are rigid body mass and added mass terms respectively c is coriolis centripetal term d is viscous damping term g is restoring force v r is velocity related to water current and τ is external force given that the auv is highly symmetric along x and z axes and has stable pitch and yaw angle during the docking process the simplified 4 dof model is 35 m u u r d u u r τ u m v v r m z g p m w w p d v v r 0 m w w m v v r p d w w m z g p 2 τ w m p p m v w v r w d p p m z g p w m z g g sin φ τ p where m u m x u m v m y v m w m z w m p i x k p m v w m v m w b g z z g a hybrid pid controller with model based feedback linearization is then utilized in the inner loop 36 τ u d ˆ u u r k v p u z u k v d u z u k v i u z u τ w m ˆ v v r p d ˆ w w m z g p 2 k v p w z w k v d w z w k v i w z w τ p m ˆ u v u r v r d ˆ p p m z g p w m z g g sin φ k v p p z p k v d p z p k v i p z p where ˆ denotes the estimated value of the parameters the system is approximately linearized into a 2nd order system through feedback linearization and the model uncertainties are then handled by the pid control laws notice that some of the integral or differential gains can be zero in some cases during the dynamic positioning process the auv performs a horizontal motion which results in a simplified 3 dof model 37 m u u r m v v r r d u u r τ u m v v r m u u r r d v v r 0 m r v r m u v u r v r d r v r τ r where m r i z n r m u v m u m v similarly choosing the corresponding control law as 38 τ u m ˆ v v r r d ˆ u u r k p u z u k d u z u k i u z u τ r m ˆ u v u r v r d ˆ r r k p r z r k d r z r k i r z r it can be observed that by bringing 36 into 35 and also 38 into 37 each of the resulted error dynamics consists of a 2nd order linear system if the modelling parameters are accurate however it is impractical to acquire the accurate model parameters for a real system there are several methods in the literature to deal with model uncertainties for example using an adaptive law to adjust the model parameter estimations but for the complex auv dynamics the corresponding adaptive laws become immensely complicated and have a high demand for the measurement of the auv state variables which is impractical for the proposed system as an alternative the neat and straight forward pid controller is considered most suitable for dealing with the model uncertainties of the auv dynamics 5 simulation and experiment 5 1 simulation feasibility of the dynamic positioning and visual servo docking control strategies are first verified by simulation the results are shown in fig 10 the corresponding parameters are listed in table 1 simulation of the horizontal dynamic positioning process is conducted on two constant water current disturbance conditions with v w 0 2 m s ψ w π 4 and v w 0 2 m s ψ w 3π 4 respectively and a calm water condition the auv parameter estimations are chosen to have 30 deviations from their true values the outer loop kinematic gains are k u 0 2 and k r 1 and the inner loop dynamic gains are k pu 50 k iu 5 k pr 40 k ir 4 k du 0 and k du 0 saturation functions are added to guarantee feasible control outputs initial and target positions are chosen at 5 0 and 0 0 respectively and the initial auv yaw angle is ψ 0 π 4 fig 10 a and b indicates that the auv successfully performs dynamic positioning at the target with moving trajectories depend on the water current the auv propelling forces and torques are all within feasible ranges as shown in fig 10 d and e notice that in fig 10 c the auv finally aligns itself against the water flow at the target point regardless of the water flow direction this is an important preparation for the next step because the auv is able to keep a constant yaw angle and cancel the influence of the water current just using its surge motion u r during the docking process which is beneficial to the docking stability given that the water current is canceled simulation of the docking process is conducted excluding the current disturbance in order to reveal the relationship between the visual servo objective function and the true position a vessel parallel vp coordinate is utilized fossen 2011 with a coordinate transformation of η p r t ψ η the origin o p is fixed on the auv dynamic positioning plane and right above the platform center choosing the platform center in vp coordinate at p c 0 0 2 assuming an initial position error of x p 0 6 and y p 0 4 in the vp coordinate the controller gains are k eu 0 7 and k ev 0 6 for the outer loop and k pu 50 k iu 5 k pw 50 k iw 5 k pp 15 and k ip 1 for the inner loop it can be observed from fig 11 that the visual servo objective function e u and e v exponentially converge to zero and the ew uniformly increases during the descending and docking process due to geometric relationships e u and x p are coincident e w and z p are almost coincident however e v converges much faster than y p because the lateral visual error can be easily eliminated by adjusting roll angle but the real lateral position error is gradually eliminated during the docking process 5 2 experiment both a water pool experiment and a sea trial are conducted on the proposed auv docking system a detailed experiment on the wireless charging platform is fully discussed in our previous work yang et al 2019 and thus is not repeated in this paper the navigation and docking function was tested in a 3 m 5 m water pool the water pool is large enough compared to the auv size and has dirt and textures on the bottom which is suitable for evaluating the visual navigation and docking performance of the auv the pool is not deep enough to put inside the whole docking station thus for better evaluation of the docking performance a 0 5 m 0 5 m pattern board was utilized as a docking target as shown in fig 12 the auv visual slam navigation and visual servo docking performances are first tested in the water pool the auv firstly follows a determined path to perform a water surface navigation during which the classic line of sight los strategy is applied when it reaches the docking target it performs a visual servo docking to land on the pattern board the trajectory of the whole docking task is shown in fig 13 a the 3d positions of the auv are plotted in fig 13 b and the euler angles are plotted in fig 13 c the auv keeps a stable pose and moves smoothly during the navigation indicating a robust slam based navigation strategy and a stable control strategy hopping of the yaw angle in the middle of fig 13 c comes from the jumping of data representation but does not exist in the actual yaw angle surge and heave velocities are plotted in fig 13 d the auv slows down when approaching each turning point for accurate path following it finally performs a horizontal dynamic positioning above the docking pattern and then moves downward until it touches the bottom the docking pattern in the auv camera view is shown in fig 14 which gradually moves to the center of the camera view during the dynamic positioning step a sea trial on the proposed auv docking system was conducted near a pontoon in meishan bay ningbo china as fig 15 however due to the high turbidity of water in the sea trial the visual slam works at tracking failure state all the time and the underwater location is merely accomplished by the model based dead reckoning part in the slam program as stated in section 3 therefore in order to avoid large accumulative positioning errors the navigation distance of the auv in the sea trial was limited to less than 10 m away from the docking station the docking station was placed on the seafloor 2 m below sea level two docking tasks are successfully performed during which the auv runs from two different directions towards the docking station and the recorded trajectories are plotted in fig 16 in each task the auv runs a reference path less than half a meter below sea level and when it is about to reach the station it further descends to about 0 8 m depth at which the docking pattern is visible it then runs towards the target point until the docking pattern appears in its camera view the descending process starts when the auv successfully recognizes the pattern and finishes when the auv touches the platform surface the auv finally stays on the platform surface with its electromagnet attached to the ferrite bars the descending and docking process in each task lasts a few seconds which is recorded by both an external monitoring camera fig 17 and the auv downward looking camera fig 18 in the camera view the platform pattern slowly moves towards the view center and then becomes larger as the auv approaches the charging board the snapshots taken by the external camera indicate that the auv keeps a stable pose and heading direction and only slightly adjusts its roll angle during the descending and docking process in fig 17 d and h the small heading angle change at the end of each docking process is caused by a collision between the auv and the charging board finally a charging experiment is conducted after the auv being successfully docking the charging process lasts about 25 min and is monitored real time by the auv as plotted in fig 19 the auv performs a constant current charging process during the charging experiment as shown in fig 19 a the current is set at 2 8 a and hardly changes during the period the charging voltage gradually rises approaching the cut off voltage which is set at 24 3 v as shown in fig 19 b the charging system keeps an overall efficiency of about 50 when the output power varies from 62 w to 67 w in general although the overall efficiency is lower than some wpt systems in the literature it is satisfying for the proposed highly positioning tolerant underwater wpt setup several reasons decrease the efficiency first in order to achieve enough positioning tolerance the system has a primary coil array which is 10 times larger than the secondary coil therefore power loss on the long coil wires is significant second being a practical system used in real subsea scenario the wpt platform utilizes a long submarine cable to connect to the onshore devices and a water tight cable connected between the charging board and circuit chamber both of which cause much power loss besides the open docking and charging surface produces much eddy current loss in seawater other power loss includes the loss on the circuit components the metal structures of the auv etc still optimization of the wpt system is ongoing to further improve the efficiency and other charging performances 6 conclusion an integrated planar type auv docking and charging system is proposed in this paper including both the system construction and the navigation and docking method the proposed auv docking system has advantages of structural conciseness convenient usage large positioning tolerance and broad adaptability compared to conventional auv docking systems the system functions have been extensively tested in both water pool experiment and sea trial the main drawback of the current version of the prototype system is the absence of acoustic sensors so that the auv is not able to perform long range navigation in highly turbid water or extremely feature poor seafloor areas when the visual navigation is invalid for this reason future work will focus on applying acoustic sensors such as the ultra short baseline usbl position system on the auv docking system to enhance the robustness of its long range navigation and docking performance with the combination of visual and acoustic navigation algorithms authors believe that the docking system will have a remarkable improvement and will be qualified for practical underwater observation missions in the future credit authorship contribution statement tianlei wang conceptualization methodology software data curation investigation visualization writing original draft writing review editing qichao zhao validation methodology software canjun yang resources funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported in part by the marine s t fund of shandong province under grant 2018sdkj0211 in part by the fund of platform for technical innovation ningbo research institute of zhejiang university nri zju 2019001 in part by the fundamental research funds for zhejiang provincial colleges universities no 2019xzzx003 07 and in part by the key research and development project of zhejiang province no 2020c03012 
20984,as being increasingly used for underwater explorations autonomous underwater vehicles auvs are diversified in their structures and outlines to match up with various mission requirements which brings challenges to the design of customized submerged docking stations aiming at providing a generalized solution this paper proposes an omnidirectional and positioning tolerant planar type auv docking and charging platform which has no constraints on auv structures in order to solve the planar type docking issues an integrated visual navigation and docking algorithm is developed for the miniaturized prototype auv the adopted monocular simultaneous localization and mapping slam program takes charge of the wide range underwater locationing and handles practical problems such as scale drift and tracking failure a combined control strategy of horizontal dynamic positioning and vertical visual servo docking is developed for the terminal docking process the strategy is robust against constant water flow disturbance and performs stable docking using a roll motion adjustment the visual navigation and docking performances and other system functions are successfully validated in simulation water pool experiment and sea trial keywords autonomous underwater vehicle auv planar docking platform underwater visual slam visual servo wireless power transfer 1 introduction underwater docking systems enable unmanned charging and data collection for auvs and have been actively studied since the last century stokey et al 1997 yazdani et al 2020 conventional auv docking systems are usually custom designed to match up with specific auv outlines and structures kawasaki et al 2004 kimball et al 2018 myint et al 2018 sarda and dhanak 2017 sato et al 2017 since torpedo shaped auvs are very popular due to their excellent hydrodynamic characteristics most of the docking systems are tailored for such kind of auvs allen et al 2006 mcewen et al 2008 park et al 2009 stokey et al 2001 teo et al 2012 yang et al 2016 these docking stations utilize cone shaped entrances to provide the auvs with positioning tolerance and collision guidance as marine science and technology develops there is an increasing need for auvs to execute complex underwater tasks for example close range and high resolution coral reef observation and underwater videotaping bonin font et al 2015 in such cases where auv flexibility and accurate motion control have higher priorities the conventional torpedo shape is no longer preferred on contrary shapes and structures of auvs are diversified to obtain certain abilities such as moving agility yu et al 2016 and underwater hovering kim and eustice 2013 for these types of auvs however docking system designs become more challenging there are several kinds of docking stations for non torpedo auvs in the literature kawasaki et al 2004 kimball et al 2018 myint et al 2018 each of them is designed for a specific type of auv although these docking systems dealt well with data collection and energy supply issues they have some drawbacks in common 1 each docking station has a personalized structure to match up with a unique auv outline and can hardly be used for other auvs 2 the docking stations have strict requirements for accurate underwater positioning and hardly allowing any misalignment especially for the power transfer devices sato et al 2017 which brings difficulties in the docking process and may even cause docking failures sometimes aiming at solving these problems an omnidirectional and positioning tolerant planar type auv docking and charging system is developed in this paper fig 1 including both system hardware and a monocular vision based navigation and docking method the docking station has a concise and widely applicable planar docking surface which almost has no constraints on auv structures thus is particularly suitable for auvs with complex shapes and structures used for shallow water and close range observations also this kind of station setup provides enough misalignment tolerance and maximum convenience for the docking mission although acoustic devices are widely used for underwater communication and positioning paull et al 2014 they can hardly be adopted in miniaturized and low cost auvs due to their weight and budget limitations moreover the terminal docking process of an auv usually relies more on accurate visual guidance rather than acoustic devices for example a typical terminal guidance approach for a cone shaped docking station is to install one or several lights on the cone entrance and an auv with a forward camera recognizes and goes towards the lights until it gets into the station park et al 2009 yang et al 2016 for these reasons this paper extends the usage of the monocular camera of our prototype auv not only for the terminal docking process but also for the navigation and localization in larger areas visual simultaneous localization and mapping slam is qualified to serve for the tracking and navigation tasks of auvs burguera et al 2015 mahon et al 2008 application of visual slam in the harsh underwater environment is challenging due to the water turbidity illumination variation and feature sparseness cho and kim 2018 proposed a hybrid model based and model free image enhancement algorithm to tackle the turbid underwater environment the model based method has higher image quality while the model based one is more time saving aiming at performing hull inspection kim and eustice 2013 presented an underwater slam algorithm for feature poor areas using visual saliency with tracking performance enhanced by a saliency based keyframe culling and loop closing strategy lee et al 2014 introduced a single cluster probability hypothesis density filter method for visual slam to effectively aid the underwater tracking of auvs in order to solve the planar type docking issues for the system an integrated slam based navigation and visual servo docking algorithm is developed in this paper which to the best of our knowledge has rarely been discussed in the literature the algorithm solves both the long range navigation and terminal docking problems the slam framework constructs a real scale map of underwater terrain using sensor fusion and deals with tracking failure by a multi map management strategy when the auv catches sight of the charging platform the docking task is taken in charge by a visual servo algorithm to achieve better docking accuracy and robustness the terminal docking control strategy combines horizontal dynamic positioning and vertical visual servo docking control which is robust against constant water flow disturbance and performs stable docking using a roll motion adjustment this paper is organized as follows section 2 briefly describes the hardware construction of the entire system including both the planar docking station and the prototype auv section 3 introduces the underwater slam framework implemented to the auv section 4 introduces the dynamic positioning and visual servo docking control strategy section 5 provides the simulation and experiment of the system including both the visual navigation and docking experiment and the charging function validation section 6 concludes the paper and gives an outlook for future work 2 system construction 2 1 positioning tolerant and omnidirectional planar type docking platform in order to provide enough docking convenience and positioning tolerance a concise planar docking and charging board is utilized in the platform as shown in fig 1 all the circuit components are sealed inside a pressure chamber under the charging board the circuit components are connected to the charging board and the power source on land through watertight cables a docking pattern is painted on the platform surface which can be recognized by the auv camera for docking a ferrite shielding layer is arranged beneath the charging plane to minimize the flux leakage ferrite bars are also placed on the coil centers to serve as neat and elegant electromagnetic holding structures when the auv stays on the platform surface its electromagnet holds on to these ferrite plates for fixation preventing the auv from being carried away by water flow the charging plane contains 9 rounded corner square coil units arranged in a 3 3 array and provides an about 0 6 m 0 6 m effective charging area for the auv the coil units are divided into 3 groups driven by 3 parallel lcc compensating networks as shown in fig 2 all the circuit components are strictly calculated taking the mutual inductance of the coils into consideration detailed discussions about the wpt performance of the charging platform can be found in our previous work wang and yang 2020 yang et al 2019 and a brief introduction of the system properties is presented here choosing the compensating capacitors are chosen according to 1 c i 1 l i 2 c i 2 l i m i l i 2 c i 2 1 ω 2 l i 2 c s 1 ω 2 l s i 1 2 3 2 l 12 l 22 l 32 c 12 c 22 c 32 where m i i 1 2 3 denotes the total mutual inductance between the ith branch and the other two branches given that the wire resistance of the compensating inductances are very small taking the approximation of r i 2 0 the output voltage on the equivalent load then becomes 3 u s u i n r l l 12 r l r s i m i s i 1 2 3 the overall wpt efficiency becomes 4 η ω 2 i m i s 2 ω 2 i m i s 2 r l i r i 1 i 1 2 3 where i m i s i 1 2 3 denotes the summation of all the mutual inductances between the secondary coil and all the primary coil branches in the layout design of the coil array the magnetic field generated by the primary coil array is carefully optimized in both its intensity and uniformity therefore i m i s almost remains constant when the secondary coil is placed on arbitrary positions within the charging area and with arbitrary heading directions and the output voltage and overall efficiency are stabilized regardless of the docking misalignment as shown equation 3 and equation 4 moreover given that r l r s the output voltage remains constant when the load varies consequently the auv has an equal charging performance regardless of its docking position and heading direction on the platform it can also be observed from equation 4 that the wire resistance of the power emitting coil is one of the major factors that decreasing the power transfer efficiency long wires are needed to form the large coils and long cables are necessary for connecting the primary coils with the driven circuits which cause an inevitable drop in the overall charging efficiency 2 2 the prototype home i mini auv the prototype home i mini auv is specifically designed for close range and up to 100 m of water depth observations fig 1 it is approximately 500 mm in length 300 mm in width and 250 mm in height except for the antenna and has a total weight of about 15 kg which is rather tiny and lightweight compared to most commercial auv products the structure of the auv is illustrated in fig 3 since that taking submarine videos and photos has a high demand for maneuverability it is equipped with 4 thrusters to provide a 4 dofs motion including surge yaw heave and roll in most cases the auv is passively stable in roll and pitch the roll motion is adjusted only in the docking descending process within a limited range which will be fully discussed in section 4 the functional diagram of the home i mini auv is illustrated in fig 4 although acoustic devices are widely used for submarine positioning they are usually heavy and expensive and thus is currently abandoned in this miniaturized prototype auv it relies on a visual algorithm for underwater locationing the auv has two cameras the downward looking camera is the major visual sensor collecting images for the slam navigation and visual servo docking while the forward looking camera is just used for observations recording videos and photos and is also reserved for expended functions such as obstacle avoidance the real time slam program is taken in charge by an independent visual processer of the auv due to its high computational burden all the other functions are operated on a microcontroller unit mcu including communicating with the operator collecting all the sensor data running the navigation and controlling program supervising the battery charging process etc high speed communication is established between the mcu and the visual processor the visual slam performance is also improved by fusing the data of an inertial measurement unit imu and a depth sensor notice that all the auv components are highly modular especially the power receiving coil mounted on the bottom this modular power receiver is not only customized for the prototype home i auv but is also suitable for many other auvs with arbitrary structures and outlines and so is the versatile planar charging platform owing to such features and advantages the proposed auv docking system is believed to have a promising application in the submarine observation domain 3 monocular slam for auv underwater locationing visual slam is a budget saving solution which offers accurate position and motion measurements thus is very suitable for close range underwater navigation of miniaturized auvs slam systems can be categorized by their image process approaches as being direct feature based or a hybrid of both the direct methods which make use of the pixel information directly are usually sensitive to illumination change thus are not suitable for the underwater environment where the light condition is complicated and changeable the feature based methods however are much more robust against illumination changes but may be unstable in feature poor areas slam systems can also be categorized as filter based or keyframe based approaches where the keyframe based approaches are commonly regarded as being better behaved especially in the time efficiency strasdat et al 2012 younes et al 2017 for the above reasons an integrated multi thread key frame based monocular slam program is built for the home i auv as shown in fig 5 based on the framework of the outstanding open source orb slam project mur artal et al 2015 mur artal and tardos 2017a the program built in this paper takes full advantage of the imu depth sensor and other external information to provide real scale underwater positioning and mapping and at the same time solving practical problems such as tracking failure the visual servo for the auv docking process is integrated into the program as an independent thread and executed by a task switching technique the basic logical frame of the tracking local mapping and loop closing threads are similar to those of the orb slam and this paper only focuses on the major adjustment and improvement made for the practical underwater navigation usage 3 1 sensor fusion and real scale acquisition in order to provide a true scale initialization an off line measurement of the water depth is conducted at the place where the auv mission starts the implemented slam program detects features and textures of seafloor topography and extracts orb features from the images to construct frames since most of the underwater scenarios are highly planar the program uses homography h between the first two frames for the automatic initialization the initial depth measurement of the starting scene is then added to the initial map for rescaling after the slam program finishes an unscaled initialization it obtains a set of unscaled map points p w j x w j y w j z w j and an initial auv pose t 2 with regard to the starting pose t 1 using the auv depth z 2 measured by the depth sensor and the initial scene depth d ˆ known in prior the map points can be rescaled as 5 p w j s r p w j where s r is the scale factor given by 6 s r d ˆ z 2 1 j j z w j z 2 the normalized translation vector t 21 in the camera pose matrix t 21 is also rescaled using the same factor 7 t 21 t 2 t 1 1 r 21 s r t 21 0 1 a pure visual keyframe based slam approach is able to reach a higher accuracy than a visual inertial solution because fusion with other low sensors with lower resolutions may cause a decrease in accuracy mur artal and tardos 2017b however the slam approach for a practical auv navigation system must be aligned with the geodetic coordinates with the aid of an imu moreover taking full advantage of the imu data significantly improves the system stability and robustness which are the top priorities in practical application therefore taking into account the computational limitation of the visual processor a loosely coupled visual inertial solution is applied in this system both imu and depth sensor data into the initialization 8 f p w j t i argmin j e p r o j 2 ρ d d ˆ z w j 2 ρ r r i r i w i m u 2 9 e p r o j 2 e p 2 j t 2 p w j t λ 2 1 e p 2 j t 2 p w j where λ2 is the covariance matrix of the reprojection error ρ d and ρ r are weight coefficients of the depth and imu measurement error respectively after the system is initialized it performs an imu guided motion tracking the inter frame motion is first estimated using imu data instead of using a constant speed model the reason for doing so is that objective functions of optimization based slam are always highly non convex the optimal solutions rely highly on the initial values and a good initial estimation usually led to a more reliable optimization result the inter frame motion estimation is denoted by 10 t i 1 i ω ˆ i 0 v ˆ i 1 r i w i m u r i 1 w i m u 1 0 r i w i m u u d y n 1 where u dyn denotes the surge velocity estimated from the auv dynamics r i w i m u denotes the auv pose and r i 1 w i m u is the pose of the last frame the estimated angular velocity is expressed using the corresponding rotation matrix given an initial motion estimation the slam approach optimizes the inter frame motion using bundle adjustment ba minimizing the reprojection error together with other residuals an integrated objective function is given below 11 f p i t i argmin j e p r o j i e i m u i e z i e u i 12 e p r o j i e p i j t i p w j t λ i 1 e p i j t i p w j 13 e i m u i ρ r r i r i w i m u 2 14 e z i ρ z t z i z i 2 15 e u i ρ u t i u d y n 2 where e proj is the reprojection error term e imu is the imu measurement residual term e z is the depth measurement error term and e u is the speed error term the corresponding information matrices or weight coefficients indicate the reliability of the error terms and can vary as the auv motion state changes for example during constant speed navigation the speed estimation is reliable and the imu data is less important but when a sharp turn occurs the imu measurement is much more helpful and reliable than other sensor data the information matrices and weight coefficients are adjusted online by interactive communication between the visual processor and the mcu controlling core the map is updated and new map points are created using triangulation after the inter frame motions are optimized 3 2 multi map management for tracking failure unlike scenes on the ground the underwater environment is usually turbid and feature poor which is troublesome for slam applications in some extreme featureless or turbid areas for instance no matter how the camera images are enhanced no valid features are able to be extracted for such cases tracking failure is inevitable tracking failure cannot be well solved by a pure visual slam approach without the help of other sensor data waiting for re localization is a common and simple method adopted in many laboratorial slam programs but can seriously damage an on going mission in practice multi map management strategy has been proposed in the literature for both improving tracking accuracy and dealing with tracking failure hu et al 2019 but such a strategy is bulky and does not takes full use of other sensors hence is not suitable for the practical auv navigation system in this paper a lightweight multi map management strategy is applied to the slam system only for solving the practical tracking failure problem as illustrated in fig 6 in fig 6 m n and m n 1 are two adjacent sub maps f k n denotes the kth frame which belongs to the n th sub map when tracking is lost the system performs an immediate re initialization to build a new sub map and simultaneously starts a temporary model based dead reckoning and stops until the re initialization finishes the dead reckoning combines the imu data auv dynamic model and thruster model to perform motion estimations between the sub maps to reduce the dead reckoning error during the tracking failure period the auv keeps a stable pose and speed which are controlled by the mcu motion estimations between the sub maps are treated as optimization constraints during the loop closing the estimated displacements in every sampling interval are calculated by 16 δ x u ˆ cos ψ i u w δ t δ y u ˆ sin ψ i v w δ t where u ˆ denotes the estimated surge speed ψ i is the yaw angle measured from the imu u w and v w are the current speed component in the x and y direction respectively and δt is the sampling time the translational vector within the whole tracking failure period is 17 t k k 1 k k 1 u ˆ cos ψ i u w δ t k k 1 u ˆ sin ψ i v w δ t z k 1 z k t furthermore the head to tail constraint between every two adjacent sub maps is derived as 18 t k 1 n 1 t k n k 1 n 1 t k n r k 1 n 1 r k n 1 t k k 1 0 1 t k n where the rotation constraint is measured by the imu and the translational constraint is given in 17 when the auv comes back to a scene that has been visited before it searches for the best matched reference frame in the map calculates a similarity transformation t sim3 between the reference frame f r and current frame f c and then conducts a loop closing when the auv performs a global optimization in loop closing the constraints between sub maps must be included in the objective function as 19 f p t argmin i j e p r o j i e i m u i e z i e u i m e m a p argmin i j e p r o j i e i m u i e z i e u i m ρ m t m 1 m t ˆ m 1 m 2 where the objective function in 19 is synthesized by combining 11 and 18 by solving equation 19 the accumulated error is propagated to all the key frames in the map with the same principle loop closing can also be done when the auv finds a landmark with a known location such as the charging platform 4 visual servo docking control a stable and feasible docking strategy is vital for an auv docking system it should take both the auv motion capacity and docking station structure into consideration considering the special structure of the proposed system a combined two step homing and docking strategy is proposed a horizontal dynamic positioning step and a vertical visual servo docking step as illustrated in fig 7 the auv firstly navigates at a constant depth and dynamically stops on top of the platform at point p t and secondly descends towards the platform center p c by visual servo until it touches the platform surface constant water current disturbance is considered during the whole docking process the corresponding control diagram is shown in fig 8 4 1 kinematic controller the controller design is firstly derived at the kinematic level the horizontal dynamic positioning process adopts the traditional line of sight los strategy choosing the target waypoint right above the docking platform center referring to the method proposed by aguiar and pascoal 2007 the error between the current auv position p x y and the target position p t x t y t can be defined by 20 e x x t 2 y y t 2 β arctan y t y x t x ψ where e is the distance error and β is the yaw angle error assuming a constant water current disturbance characterized by intensity v w and direction ψ w the kinematic equations of the auv motion can then be written as 21 e u r cos β v r sin β v w cos ψ β ψ w β 1 e u r sin β v r cos β v w sin ψ β ψ w r e 0 ψ r where u r and v r are the auv surge and sway velocity w r t the water current choosing the kinematic controller as 22 u r k u e v w cos ψ ψ w r k r β k u sin β 1 e v r cos β 1 e v w sin ψ ψ w cos β e 0 it can be verified that using the control law in 22 the positioning error e and β converges to zero as t moreover the auv keeps itself aligned against the water flow at the positioning point aguiar and pascoal 2007 which is a necessary preparation for the next docking step although visual slam introduced in section 3 offers good position and velocity measurement for the auv during long range navigation and horizontal dynamic positioning the vertical descending and docking process needs a faster and more accurate visual measurement for optimal docking performance therefore a more accurate and straight forward visual servo method is utilized which takes the image information as a direct feedback as illustrated in fig 9 also since the auv is not likely to conduct a dynamic positioning exactly above the docking platform center p c in practice the horizontal positioning error must be corrected during the vertical docking process photos of the docking platform pattern are taken at different distances offline to form up a reference frame set f r and then stored in the auv visual processor for a certain reference frame f r the platform center p c in its camera coordinates is p r x r y r z r once a new frame f is caught the auv searches for the best match in the reference image set when the best matched reference image f r is found the relationship between p r and the platform center p c in the auv camera coordinate p x y z satisfies 23 p h p r where h is the homography matrix considering the corresponding kinematic relationship the homography between current and reference image is given by benhimane and malis 2006 24 h r tn r t 1 z r where r and t are the rotation matrix and translational vector from f to f r respectively n r is the unit normal vector of the reference plane that points downward an objective function can then be defined according to the auv kinematic model 25 e e v e ω t i r p r 2 α sin γ s n r t where the rotation matrix r is denoted by a rotation angle γ along an axis α s n r denotes the conversion from n r to its antisymmetric matrix from the perspective of computer vision the objective function can also be written as 26 e e v e ω i h p r s 1 h h t it can be proved using that the expression in 25 and 26 are isomorphic that is only when ω 0 and t 0 e 0 time derivative of the objective function is 27 e e v e ω i s e v p r s n r s n r s t 2 ω v ω where 28 ω i sin γ 2 s α α t sin 2 γ 2 2 ι s 2 α a common visual servo aims to let the objective function asymptotically converges to zero however since the charging platform is omnidirectional it naturally gives no constraint on the heading direction of the auv moreover as mentioned above the yaw angle of the auv is kept aligned against the water flow in the dynamic positioning process for stability concerns during the docking process the heading angle of the auv is kept unchanged so that the water flow can be easily canceled just by its surge velocity therefore only the translation component of e is considered here expanding 27 yields 29 e v e u e v e w u r u w e w z r q e v y r r v r v w e w z r p e u x r r w e v y r p e u x r q ideally the auv is expected to dock on the center of the charging board which is therefore chosen as the landing target and gives x r y r 0 the auv has a constant yaw and pitch angle which gives q 0 r 0 v w 0 equation 29 can then be simplified as 30 e v e u e v e w u r u w v r e w z r p w e v p a roll motion adjustment strategy is utilized for lateral misalignment compensation and the control law is 31 u r k e u e u u w p v r e w z r k e v e v w w d 0 where k eu 0 k ev 0 equation 30 then becomes 32 e v e u e v e w k e u e u k e v e w z r e v w d e v p equation 32 verifies that by applying the control law in equation 31 the deviation of platform center in the camera view asymptotically converges to zero however e w is should not converge in the vertical direction because the auv is expected to keep an approximately constant velocity to descend towards the docking surface 4 2 dynamic controller in this section the outer loop kinematic controller is extended to the inner loop dynamic controller taking the results of the outer loop as virtual inputs considering the kinematic virtual inputs of the docking process let α u α p and α w be the virtual control law introducing the control errors 33 z u u r α u z p p α p z w w α w the controller design utilizes the 6 dof auv dynamic model proposed by fossen 2011 34 m v r c v r v r d v r v r g η τ where m m rb m a which are rigid body mass and added mass terms respectively c is coriolis centripetal term d is viscous damping term g is restoring force v r is velocity related to water current and τ is external force given that the auv is highly symmetric along x and z axes and has stable pitch and yaw angle during the docking process the simplified 4 dof model is 35 m u u r d u u r τ u m v v r m z g p m w w p d v v r 0 m w w m v v r p d w w m z g p 2 τ w m p p m v w v r w d p p m z g p w m z g g sin φ τ p where m u m x u m v m y v m w m z w m p i x k p m v w m v m w b g z z g a hybrid pid controller with model based feedback linearization is then utilized in the inner loop 36 τ u d ˆ u u r k v p u z u k v d u z u k v i u z u τ w m ˆ v v r p d ˆ w w m z g p 2 k v p w z w k v d w z w k v i w z w τ p m ˆ u v u r v r d ˆ p p m z g p w m z g g sin φ k v p p z p k v d p z p k v i p z p where ˆ denotes the estimated value of the parameters the system is approximately linearized into a 2nd order system through feedback linearization and the model uncertainties are then handled by the pid control laws notice that some of the integral or differential gains can be zero in some cases during the dynamic positioning process the auv performs a horizontal motion which results in a simplified 3 dof model 37 m u u r m v v r r d u u r τ u m v v r m u u r r d v v r 0 m r v r m u v u r v r d r v r τ r where m r i z n r m u v m u m v similarly choosing the corresponding control law as 38 τ u m ˆ v v r r d ˆ u u r k p u z u k d u z u k i u z u τ r m ˆ u v u r v r d ˆ r r k p r z r k d r z r k i r z r it can be observed that by bringing 36 into 35 and also 38 into 37 each of the resulted error dynamics consists of a 2nd order linear system if the modelling parameters are accurate however it is impractical to acquire the accurate model parameters for a real system there are several methods in the literature to deal with model uncertainties for example using an adaptive law to adjust the model parameter estimations but for the complex auv dynamics the corresponding adaptive laws become immensely complicated and have a high demand for the measurement of the auv state variables which is impractical for the proposed system as an alternative the neat and straight forward pid controller is considered most suitable for dealing with the model uncertainties of the auv dynamics 5 simulation and experiment 5 1 simulation feasibility of the dynamic positioning and visual servo docking control strategies are first verified by simulation the results are shown in fig 10 the corresponding parameters are listed in table 1 simulation of the horizontal dynamic positioning process is conducted on two constant water current disturbance conditions with v w 0 2 m s ψ w π 4 and v w 0 2 m s ψ w 3π 4 respectively and a calm water condition the auv parameter estimations are chosen to have 30 deviations from their true values the outer loop kinematic gains are k u 0 2 and k r 1 and the inner loop dynamic gains are k pu 50 k iu 5 k pr 40 k ir 4 k du 0 and k du 0 saturation functions are added to guarantee feasible control outputs initial and target positions are chosen at 5 0 and 0 0 respectively and the initial auv yaw angle is ψ 0 π 4 fig 10 a and b indicates that the auv successfully performs dynamic positioning at the target with moving trajectories depend on the water current the auv propelling forces and torques are all within feasible ranges as shown in fig 10 d and e notice that in fig 10 c the auv finally aligns itself against the water flow at the target point regardless of the water flow direction this is an important preparation for the next step because the auv is able to keep a constant yaw angle and cancel the influence of the water current just using its surge motion u r during the docking process which is beneficial to the docking stability given that the water current is canceled simulation of the docking process is conducted excluding the current disturbance in order to reveal the relationship between the visual servo objective function and the true position a vessel parallel vp coordinate is utilized fossen 2011 with a coordinate transformation of η p r t ψ η the origin o p is fixed on the auv dynamic positioning plane and right above the platform center choosing the platform center in vp coordinate at p c 0 0 2 assuming an initial position error of x p 0 6 and y p 0 4 in the vp coordinate the controller gains are k eu 0 7 and k ev 0 6 for the outer loop and k pu 50 k iu 5 k pw 50 k iw 5 k pp 15 and k ip 1 for the inner loop it can be observed from fig 11 that the visual servo objective function e u and e v exponentially converge to zero and the ew uniformly increases during the descending and docking process due to geometric relationships e u and x p are coincident e w and z p are almost coincident however e v converges much faster than y p because the lateral visual error can be easily eliminated by adjusting roll angle but the real lateral position error is gradually eliminated during the docking process 5 2 experiment both a water pool experiment and a sea trial are conducted on the proposed auv docking system a detailed experiment on the wireless charging platform is fully discussed in our previous work yang et al 2019 and thus is not repeated in this paper the navigation and docking function was tested in a 3 m 5 m water pool the water pool is large enough compared to the auv size and has dirt and textures on the bottom which is suitable for evaluating the visual navigation and docking performance of the auv the pool is not deep enough to put inside the whole docking station thus for better evaluation of the docking performance a 0 5 m 0 5 m pattern board was utilized as a docking target as shown in fig 12 the auv visual slam navigation and visual servo docking performances are first tested in the water pool the auv firstly follows a determined path to perform a water surface navigation during which the classic line of sight los strategy is applied when it reaches the docking target it performs a visual servo docking to land on the pattern board the trajectory of the whole docking task is shown in fig 13 a the 3d positions of the auv are plotted in fig 13 b and the euler angles are plotted in fig 13 c the auv keeps a stable pose and moves smoothly during the navigation indicating a robust slam based navigation strategy and a stable control strategy hopping of the yaw angle in the middle of fig 13 c comes from the jumping of data representation but does not exist in the actual yaw angle surge and heave velocities are plotted in fig 13 d the auv slows down when approaching each turning point for accurate path following it finally performs a horizontal dynamic positioning above the docking pattern and then moves downward until it touches the bottom the docking pattern in the auv camera view is shown in fig 14 which gradually moves to the center of the camera view during the dynamic positioning step a sea trial on the proposed auv docking system was conducted near a pontoon in meishan bay ningbo china as fig 15 however due to the high turbidity of water in the sea trial the visual slam works at tracking failure state all the time and the underwater location is merely accomplished by the model based dead reckoning part in the slam program as stated in section 3 therefore in order to avoid large accumulative positioning errors the navigation distance of the auv in the sea trial was limited to less than 10 m away from the docking station the docking station was placed on the seafloor 2 m below sea level two docking tasks are successfully performed during which the auv runs from two different directions towards the docking station and the recorded trajectories are plotted in fig 16 in each task the auv runs a reference path less than half a meter below sea level and when it is about to reach the station it further descends to about 0 8 m depth at which the docking pattern is visible it then runs towards the target point until the docking pattern appears in its camera view the descending process starts when the auv successfully recognizes the pattern and finishes when the auv touches the platform surface the auv finally stays on the platform surface with its electromagnet attached to the ferrite bars the descending and docking process in each task lasts a few seconds which is recorded by both an external monitoring camera fig 17 and the auv downward looking camera fig 18 in the camera view the platform pattern slowly moves towards the view center and then becomes larger as the auv approaches the charging board the snapshots taken by the external camera indicate that the auv keeps a stable pose and heading direction and only slightly adjusts its roll angle during the descending and docking process in fig 17 d and h the small heading angle change at the end of each docking process is caused by a collision between the auv and the charging board finally a charging experiment is conducted after the auv being successfully docking the charging process lasts about 25 min and is monitored real time by the auv as plotted in fig 19 the auv performs a constant current charging process during the charging experiment as shown in fig 19 a the current is set at 2 8 a and hardly changes during the period the charging voltage gradually rises approaching the cut off voltage which is set at 24 3 v as shown in fig 19 b the charging system keeps an overall efficiency of about 50 when the output power varies from 62 w to 67 w in general although the overall efficiency is lower than some wpt systems in the literature it is satisfying for the proposed highly positioning tolerant underwater wpt setup several reasons decrease the efficiency first in order to achieve enough positioning tolerance the system has a primary coil array which is 10 times larger than the secondary coil therefore power loss on the long coil wires is significant second being a practical system used in real subsea scenario the wpt platform utilizes a long submarine cable to connect to the onshore devices and a water tight cable connected between the charging board and circuit chamber both of which cause much power loss besides the open docking and charging surface produces much eddy current loss in seawater other power loss includes the loss on the circuit components the metal structures of the auv etc still optimization of the wpt system is ongoing to further improve the efficiency and other charging performances 6 conclusion an integrated planar type auv docking and charging system is proposed in this paper including both the system construction and the navigation and docking method the proposed auv docking system has advantages of structural conciseness convenient usage large positioning tolerance and broad adaptability compared to conventional auv docking systems the system functions have been extensively tested in both water pool experiment and sea trial the main drawback of the current version of the prototype system is the absence of acoustic sensors so that the auv is not able to perform long range navigation in highly turbid water or extremely feature poor seafloor areas when the visual navigation is invalid for this reason future work will focus on applying acoustic sensors such as the ultra short baseline usbl position system on the auv docking system to enhance the robustness of its long range navigation and docking performance with the combination of visual and acoustic navigation algorithms authors believe that the docking system will have a remarkable improvement and will be qualified for practical underwater observation missions in the future credit authorship contribution statement tianlei wang conceptualization methodology software data curation investigation visualization writing original draft writing review editing qichao zhao validation methodology software canjun yang resources funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported in part by the marine s t fund of shandong province under grant 2018sdkj0211 in part by the fund of platform for technical innovation ningbo research institute of zhejiang university nri zju 2019001 in part by the fundamental research funds for zhejiang provincial colleges universities no 2019xzzx003 07 and in part by the key research and development project of zhejiang province no 2020c03012 
