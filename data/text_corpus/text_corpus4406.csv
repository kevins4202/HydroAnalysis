index,text
22030,the fiv flow induced vibration responses of an elastically mounted square cylinder near a free surface are numerically investigated using 2 dimensional rans equations in conjunction with sst k ω turbulence model in this work the effect of submergence depth on the fiv response and energy conversion is studied the flow field behavior for flow velocities between 0 2 m s and 2 5 m s 1 61 104 reynolds number 2 02 105 is examined by comparing with experimental data the numerical model is verified fiv consists of viv vortex induced vibration at low flow velocities and galloping at high flow velocities the fiv responses wave profile and energy conversion performance are discussed in detail the main conclusions are 1 decreasing the submergence depth ratio suppresses the fiv amplitude resulting in an obvious decrease in energy conversion 2 at very low submergence depth ratios the wave and breaking wave phenomenon are significant meanwhile the vibration is unstable when the square cylinder is closely approaching the deformed free surface 3 decreasing the submergence depth ratio also delays the onset of galloping 4 the maximum amplitude and power appear at the end of the galloping region 5 the maximum fiv energy conversion efficiency is obtained in the viv region keywords fiv flow induced vibration square cylinder energy conversion efficiency submergence depth ratio free surface viv vortex induced vibration 1 introduction in transverse flow an elastically mounted cylinder on springs is always excited by fiv in particular viv and galloping are two of the most common forms of fiv usually viv is inherently a nonlinear vibration broad range self limiting response bernitsas 2016 ding et al 2015 when flow past a cylinder generates a vortex street in the wake these vortices change the pressure distribution along the surface of the cylinder when the vortices are not formed symmetrically around the cylinder different lift forces develop on each side of the body thus leading to motion transverse to the flow blevins blevins and williamson et al williamson and govardhan 2004 also concluded viv is a broad range phenomenon the lock in phenomenon is observed when the frequency of vortex shedding is close to the natural frequency of the vibrating cylinder bearman 2011 reported a comprehensive review about viv of circular cylinders xu wan hai et al chen et al 2015 ma et al 2020 xu et al 2013 study the viv responses of a free spanning pipeline and two side by side elastically supported circular cylinders compared with viv galloping appears at higher flow velocities galloping is generally considered as an unlimited fiv response with the increasing flow velocity until structural failure it should be noted that galloping will not occur on smooth circular cylinders in previous studies non circular cross sectional cylinders result not symmetric flow around the cylinder and therefore respond in galloping cui et al 2015 ding et al 2015 zhao et al 2019 fiv is usually interpreted as a destructive response in recent years the fiv phenomena such as viv and galloping have been utilized to harvest hydrokinetic energy in particular bernitsas et al 2008 and raghavan et al raghavan 2007 introduced a vivace vortex induced vibration aquatic clean energy converter the converter converts hydrokinetic energy to the mechanical energy of vibrating cylinders which drive generators to produce electricity at first the converter just utilized the viv phenomenon bernitsas et al 2009 lee 2010 lee and bernitsas 2011 raghavan et al 2009 then galloping was introduced into the energy converter due to the adoption of ptc passive turbulence control cylinders and non circular cross sectional cylinders ding et al 2013 kim et al 2013 raghavan et al 2009 zhang et al 2018a 2018b the studies on the hydrokinetic energy converter have been systematically completed by bernitsas et al bernitsas 2016 bernitsas et al 2008 and sun et al 2018a 2018b based on experiments and by ding et al 2016 2017 and zhang et al 2017 2018a 2018b based on cfd numerical simulations it was reported the energy conversion system has a great performance in a wide range of flow velocities and without upper limit which is significantly better than traditional ocean energy conversion devices e g turbines need 5 7knots 2 6 3 6 m s in ocean currents to remain financially viable zhang et al 2018b chang 2010 in earlier studies the fiv responses were mainly studied in deep water without considering the effect of submergence depth to the authors knowledge very few studies investigated the effect of submergence depth on viv or galloping raghavan et al raghavan 2007 reported the effect of the bottom and free surface boundary on viv sareen et al 2018 carried out experiments on the viv responses of a sphere close to a free surface carberry et al 2004 and zhu et al 2000 studied the forced oscillation of cylinders in the vicinity of a free surface and found the mode of vortex shedding changes with the submergence depth however the fiv responses of square cylinders near a free surface are not investigated until now unlike the situation of vibrating cylinders near a free surface there are a lot of earlier works on the flow past a fixed cylinder close to a free surface bouscasse et al 2017 reichl et al 2005 carberry 2002 tritton 2012 more specifically reichl et al 2005 simulated the flow past a fixed cylinder near the free surface based on fluent and found that the shedding model depends on the submergence depth carberry 2002 found the free surface deformation above a fixed cylinder in water is not obvious when the reynolds number is less than 2100 sheridan et al tritton 2012 reported a jet flow is always observed between the free surface and fixed cylinders at higher reynolds numbers re 6000 according to the authors judgment the jet flow indicates the coanda effect around a bluff body sheridan et al 1997 although the above mentioned studies mainly focused on the fixed cylinder near a free surface these results provide inspiration for this study meanwhile the background about the present study also comes from the towing tank tests for the viv responses of circular cylinders in our laboratory as shown in fig 1 it was found that the effect of free surface significantly alters the characteristics of viv especially when the submergence depth ratio is less than 3 33 the cylinder interacts with the free surface and induces significant free surface deformation however the experiments are mainly focused on viv and circular cylinders rather than non circular cross sectional cylinders although significant free surface deformation was observed the free surface profile can t be recorded in the experiments according to the literature review numerical methods have been widely adopted in the analysis of the fiv responses in similar studies ding et al 2015 guan and jaiman 2017 kinaci et al 2016 reichl et al 2005 zhu and yao 2015 finally the numerical method will been applied to investigate the effect of submergence depth or free surface on fiv since it excels in analyzing the flow structure and free surface deformation in the present study 2 dimensional numerical simulations are performed to study the fiv responses of a square cylinder near a free surface this study focuses on the interaction between the vibrating cylinder and free surface this paper is organized as follows the fiv energy conversion system and design parameters are introduced in section 2 then the mathematical equations are briefly documented in section 3 next the numerical method is verified by previous experimental data in section 4 the results are discussed in sections 5 finally the main conclusions are presented based on the analysis of the flow characteristics and the fiv responses 2 geometry configuration the new fiv energy conversion system with a single square cylinder is built based on previous studies bernitsas 2016 bernitsas et al 2008 as depicted in fig 2 the rigid square cylinder is perpendicular to ocean river currents the shed vortices act on the cylinder resulting in vigorous fiv responses the rigid cylinder is fastened to a gear belt system which drives a generator to produce electric energy since the transverse displacement of bluff bodies in fiv is much larger than the streamwise displacement the cylinder is limited to one degree of freedom meanwhile one degree of freedom of the energy conversion system can greatly reduce the complexity of transmission structure and the structural damping one degree of freedom system has been widely used in similar energy conversion systems bernitsas 2016 bernitsas et al 2008 2009 ding et al 2015 raghavan 2007 raghavan et al 2009 therefore only the transverse motion is investigated in this paper although the cylinder is fully submerged it is essential to assess the influence of the deformed free surface h denotes the submergence depth k is the spring stiffness c t o t a l represents the total damping from the generator effective damping and transmission mechanisms structural dissipated damping therefore c t o t a l corresponds to the total converted power p fiv including the effective power and the dissipated power in earlier works the fiv responses of circular cylinders without considering the effect of free surface have been widely investigated in this work depending on the studies reported by bernitsas et al bernitsas 2016 sun et al 2016 and park et al 2013 a similar sized fiv energy conversion system with a single square cylinder is built the notations and parameters of the fiv system are presented in table 1 and table 2 in these studies when the damping ratio ξ t o t a l is set as 0 1 0 2 both the fiv amplitude and the energy conversion performance are relatively high as a result the damping ratio ξ t o t a l is set as 0 1 in this work therefore the system damping coefficient c t o t a l is about 30 other mian parameters are listed in table 2 the effect of submergence depth h is of interest in other design parameters when the cylinder is near the free surface five different submergence depths i e h 0 1m h 1 11 h 0 2m h 2 22 h 0 3m h 3 33 h 0 5m h 5 56 and h m h are selected as variables h is the submergence ratio it is noteworthy that means the square cylinder is elastically mounted in single phase flow without considering the effects of the free surface in this case the effect of submergence depth and influence of free surface can be ignored 3 mathematical model 3 1 governing equations and turbulence model in this work 2 dimensional rans reynolds averaged navier stokes equations equations in conjunction with sst shear stress transport k ω turbulence model are utilized to simulate the flow past a cylinder close to a free surface the continuity equation and momentum equation are given here 1 u i x i 0 2 u i t u j u i x j ρ p x i x j 2 v s i j u i u j therein s i j is the mean strain rate tensor and defined as 3 s i j 1 2 u i x j u j x i for the 2 dimensional simulations i and j is two values 1 and 2 in the governing equations therefore in the cartesian coordinates we have x i x and x j y u i u j is the reynolds stress tensor and computed by 4 u i u j v t u i x j u j x i 2 3 k δ i j where u i is the fluid velocity in x i direction ρ is the fluid density p is the pressure v is the kinematic viscosity of the fluid v t is the turbulent viscosity and k is the turbulent energy in order to adapt to the adverse pressure gradient flow in the near wall region of the cylinder in a wide flow velocity range the sst k ω turbulence model is selected the sst k ω model has been successfully employed to simulate the fiv responses of cylinders in early studies cui et al 2015 zhao and cheng 2012 the sst k ω model includes the turbulence intensity equation and turbulent frequency equation 5 ρ k t ρ k u μ μ z σ k k p k b k ρ k ω 6 ρ ω t ρ ω u μ μ z σ ω ω a ω k p k b ω ρ k ω 2 where p k is kinetic energy σ k and σ ω are turbulent prandtl numbers μ z ρ k ω represents eddy viscosity more details about the turbulence model are reported in earlier work by menter 1994 3 2 equations of motion and energy conversion according to the mass spring damper system see fig 2 the motion of the cylinder can be obtained by solving the second order linear differential equation the differential equation of motion 7 m y c t o t a l y k y f fluid y t where m is the total vibrating mass of the system y is the displacement f fluid y t is the total hydrodynamic force in y direction in the present work based on the fluent and embedded udf user defined functions code the total hydrodynamic force f fluid y t can be obtained directly the total fiv converted power p fiv is 8 p fiv 1 t o s c 0 t o s c f fluid y y d t considering eq 7 p fiv can be written as 9 p fiv 1 t o s c 0 t o s c m y c t o t a l y k y y d t based on the earlier works bernitsas 2016 bernitsas et al 2008 the fiv amplitude is generally regarded as a sinusoidal form in one cycle so the motion is defined as 10 y t a s i n ω o s c t where ω o s c 2 π f 2 π t osc it should be noted that eq 10 is used for dropping the m y and k y terms not used for replacing the equation of motion eq 7 for the m y terms 11 1 t o s c 0 t o s c m y y d t 1 t o s c 0 t o s c m a ω o s c s 2 i n ω o s c t a ω o s c cos ω o s c t d t 1 2 t o s c m a 2 ω o s c s 2 i n 2 ω o s c t 0 t o s c we have s i n 2 ω o s c t 0 t o s c s i n 2 ω o s c t 0 2 π ω o s c s i n 2 2 π s i n 2 0 0 so the m y term is equal to 0 aside from the detailed derivation in section 3 2 analyzing from a macro perspective the total momentum of the cylinder will not change after one cycle so the m y term is zero similarly for the k y terms 12 1 t o s c 0 t o s c k y y d t 1 t o s c 0 t o s c k a s i n ω o s c t a ω o s c cos ω o s c t d t 1 2 t o s c k a 2 s i n 2 ω o s c t 0 t o s c 0 similarly analyzing from a macro perspective elastic potential energy is potential energy stored as a result of deformation of an elastic object such as the stretching of a spring it is equal to the work done to stretch the spring which depends upon the spring constant k as well as the distance stretched y however after one cycle of vibration the stretching of a spring y is zero thus the k y term can also be ignored in one cycle finally after dropping the m y term and k y term eq 9 can be further simplified as 13 p fiv 1 t o s c 0 t o s c c t o t a l y 2 d t eq 13 is a simplified equation after dropping the m y and k y terms similar derivation process has been widely used for the fiv energy conversion systems bernitsas 2016 ding et al 2015 raghavan 2007 the displacement y and the flow velocity y or written as u of the vibrating cylinder can be numerically obtained based on the udf user defined functions code embedded in fluent which will be discussed in the next section from bernoulli s equation the fluid power p fluid can be defined as 14 p fluid 1 2 ρ u 3 l d 2 a to calculate the fiv energy conversion efficiency η fiv betz limit which represents the theoretical maximum efficiency that can be extracted from the flow field should be included the value of betz limit is 16 27 59 26 sun et al 2016 betz 1966 therefore the energy conversion efficiency can be written as 15 η fiv p fiv p fluid 16 27 100 4 numerical method 4 1 numerical scheme in the present work numerical simulations of fluid flow around the cylinder are performed based on cfd software fluent 19 1 accompanied with the embedded user defined function udf code fluent solves the rans equations and continuum mechanics problems using the finite volume discretization method the udf code is written with c language to solve the differential equation of motion eq 7 based on newmark β method newmark β method has been widely used in numerical evaluation of the dynamic response of structures and solids such as in finite element analysis to model dynamic systems newmark 1959 deü and matignon 2010 based on the newmark β method the motion displacement y velocity y and acceleration y can be defined respectively as 16 y t δ t y t y δ t 1 2 β y t β y t δ t δ t 2 17 y t δ t γ β δ t 2 y t δ t y t 1 γ β y t 1 γ β y t δ t 18 y t δ t 1 β δ t 2 y t δ t y t 1 β δ t y t 1 2 β 1 y t where t or t δ t is the time level γ and β are weighting constants in ref newmark 1959 deü and matignon 2010 the recommended values of γ and β are 0 5 and 0 25 the recommended values give the constant average acceleration method which is also a second order accurate and unconditionally stable method considering eq 7 at time t δ t we have 19 m y t δ t c t o t a l y t δ t k y t δ t f fluid y t t δ t considering eqs 16 18 eq 19 yields 20 k y t δ t f where 21a k k 1 β δ t 2 m γ β δ t c t o t a l 21b f f fluid y t t δ t 1 β δ t 2 y t 1 β δ t y t 1 2 β 1 y t m γ β δ t 2 y t 1 γ β y t 1 1 2 β y t c t o t a l by solving the eqs 17 18 and 20 the displacement of the cylinder can be obtained the approach has also been employed in earlier works zhang et al 2018a 2018b so details are not discussed here 4 2 computational domain and grid generation in fig 3 the computational domain is established in order to avoid the blockage effect and wall effect the length and height of the domain are set as 50d and 30d in the flow and cross flow direction the cylinder is placed 15d from the inlet boundary located midway between two lateral boundaries the domain is divided into four sub domains including central domain upper slipway lower slipway and external flow field a steady two phase flow is applied on the inlet boundary changing from 0 2 m s to 2 5 m s 1 61 104 r e 2 02 105 to simulate water and air the two phase flow is a typical open channel flow problem in this work fluent 19 1 is used to model the open channel flow based on the vof volume of fluid method the vof scheme solves two or more immiscible fluids by calculating a set of momentum equations and tracking the volume fraction of each of the fluids http www afs enea it pr reichl et al 2005 verified the same numerical method by comparing their results with the experimental data tritton 2012 the pressure on the outlet boundary is set as zero the surface of the cylinder is imposed as a no slip boundary internal interfaces are overlapped with other interfaces in the adjacent domains where the fluid can pass freely quadrilateral grids are adopted due to less memory occupying and higher accuracy fig 3 b shows the computational grid in the central domain the resolution of gird is the highest the edges of the square cylinder are divided into 400 elements and the size is about 9 10 4m considering the large velocity gradient the boundary layer grid is utilized in the near wall region of the cylinder the number of layers is 10 and the growth rate is 1 2 meanwhile depending on the requirements of the k ω sst turbulence model the dimensionless wall distance y value of the first layer of the grid should be approximately equal to 1 therefore the height of the first prism layer is about 3 10 5m in the external flow field upper slipway and lower slipway the resolution of the grid is relatively low to improve the calculation efficiency the moving boundaries and the central domain will move together with the cylinder moving boundaries are set based on the dynamic mesh update method layering method in fluent the elements adjacent to the moving boundary will be added or deleted using the layering method 4 3 model validation the time step dependence study is conducted to evaluate the impact of time step on fiv the parameters of the fiv system have been listed in table 2 four different time steps i e 0 01s step 0 007s step 0 005s step and 0 003s step are selected the amplitude time curves are drawn in fig 4 the test flow velocity is 2 0 m s re 1 61 105 in this case it is a typical galloping the results for time step dependency validation are listed in table 3 for the selected time steps based on the recommended values 0 5 and 1 0 of the courant number in fluent the influence of cfl condition is not significant and can be ignored since the selected time steps are small enough the results show that when the time step decreases to 0 005s step the fiv responses remain relatively stable similarly the grid dependence study is also performed for four different grid densities with approximately 50 000 75 000 100 000 and 150 000 elements fig 5 shows the amplitude time curves at the flow velocity u 2 0 m s table 4 shows the comparison of the results after reaching 100 000 elements further increasing grid density doesn t have a significant impact on the numerical results therefore considering the simulation efficiency the following simulations are based on 100 000 elements and 0 005s step in similar studies zhang et al 2018a reichl et al 2005 zhao and cheng 2012 the numerical method with the k ω sst turbulence model has been successfully used to simulate the fiv responses of the square cylinder to further validate the cfd method the cfd result is compared with the experimental results reported by zhao et al 2010 and nemes et al 2012 fig 6 shows the comparison between the cfd results and the experimental results it is noteworthy that the non dimensional velocity reduced velocity u is defined as u u f n w a t e r h the natural frequency f n w a t e r is calculated by f n w a t e r 1 2 π k m c a d d ρ v disp the non dimensional amplitude amplitude ratio is a a d the non dimensional frequency frequency ratio is f f f n w a t e r s t represents the strouhal number for the square cylinder the strouhal number is about 0 13 in the selected range of reynolds number based on ref okajima 1982 f st s t u d is the estimated frequency of a stationary square cylinder in water based on strouhal number therefore f s t is defined as f s t f s t f n w a t e r in general as the flow velocity increases viv appears first then galloping appears at higher flow velocities the difference between the numerical result and the experimental results is mainly located in the viv region 4 u 8 as shown in fig 6 there are two main reasons leading to the difference or the limitation of the numerical method the first reason the study is conducted by using the 2 dimensional assumption this simulates ideal 3 dimensional fluid without lateral flow the viv region the strongest resonance region in fiv means the vortex shedding frequency coincides with the natural frequency of the system which is different from galloping however the ideal 3 dimensional fluid is very sensitive which differs from the real environment accordingly the viv region is different from the experiment result similar conclusions were also drawn in other literature e g ref bernitsas 2016 page1213 fig 47 56a the second reason is in the reference experiment the parameters of the viv system are given in non dimensional or normalized format such as the mass ratio m the damping ratio ξ and the reduced velocity u etc thus we have to deduce the actual parameters based on the non dimensional parameters which may lead to the difference the above two aspects are the limitation of the 2d numerical method in addition to this difference all other branches are in good agreement therefore the numerical method is considered convergent and acceptable in most cases 5 results and analysis a series of simulations are performed to investigate the fiv responses of a square cylinder over a wide flow velocity range from 0 2 m s to 2 5 m s 1 61 104 reynolds number 2 02 105 at different submergence depth ratios of 1 11 2 22 3 33 5 56 and the design parameters of the fiv system are listed in table 2 the most representative cases under different conditions are discussed in the following sections 5 1 fiv responses and vortex patterns 5 1 1 low submergence 5 1 1 1 case 1 at low flow velocity u 0 4 m s re 3 22 104 and low submergence depth ratio h 1 11 the amplitude response lift force and corresponding frequency are shown in fig 7 by the way since the present study focuses on the fiv cylinder under fully submerged conditions reynolds number rather than froude number are treated as the variable value the average amplitude is only 0 017m a 0 19 and the frequency is 0 5127hz the lift force is always regarded as a consequence of the shedding vortices on both sides of the cylinder in fig 7 b the lift force is in agreement with the amplitude in other words the lift force synchronizes with the vibration which means the fiv response achieves synchronization between the vibration and shedding vortices this is a prominent feature of viv to better explain the dynamic fiv response the vortex shedding mode and streamlines are presented in fig 8 the wake of the cylinder is relatively stable due to very low amplitude where a regular von kármán vortex street can be identified in one cycle of vibration two alternating vortices are shed from both sides of the square cylinder and the vortex shedding mode is captured as the typical 2s 2 single vortex pattern of viv a similar observation for a single cylinder in viv is also reported by ding et al 2015 in general two kinds of vortices such as the vortices shed from the cylinder and the vortices generated from the deformed free surface coexist in the flow and mix with each other for this case of h 1 1 the effect of free surface on the cylinder is not significant but appreciable free surface deformation is still observed the deformed free surface is caused by pressure fluctuations between the free surface and the cylinder the deformed free surface produces a string of small vortices which belong to the second kind of vortices more specifically small depression on the free surface results in the wave making phenomenon the air bubbles are caused by the breaking waves on the free surface a jet flow of the mixture of vortices air bubbles and water is attracted from the free surface and projected into the wake 5 1 1 2 case 2 as the flow velocity increases to u 1 2 m s re 9 66 104 the vibration becomes more powerful and the vortex shedding frequency keeps increasing the fiv amplitude is about 0 038m a 0 42 and the frequency of vibration is 0 78125hz as shown in fig 9 the fiv response is located in the viv galloping transition region zhang et al 2018a it is obvious that the fiv amplitude and lift force become desynchronized due to very close proximity to the free surface the vortices become unstable therefore the unstable vortices and lift have a negative impact on the fiv response resulting in an increase in the randomness of vibration and a definite decline in the amplitude at the intermediate flow velocity u 1 2 m s the free surface is drastically altered by the vibrating cylinder as shown in fig 10 the von kármán vortex street also becomes abnormal the free surface deformation is more evident reflected in breaking waves and a jet flow which is similar to the coanda effect the coanda effect is the tendency of a fluid jet to stay attached to a convex surface tritton 2012 the jet flow separates with the free surface and mixes with the wake compared with the case at low flow velocity see fig 8 the distance between the cylinder and jet flow is much longer the free surface deformation in turn strongly changes the shedding of vortices from the square cylinder these two kinds of vortices mix together resulting in a decrease in the intensity of vorticity since the direction of rotation of the vortices generated from the free surface doesn t synchronize with the vortices shed from the cylinder finally the interaction causes the suppression of the fiv amplitude in other words the deformed free surface and mixed vortices reduce the lift force acting on the cylinder 5 1 1 3 case 3 at high flow velocity u 2 2 m s re 1 78 105 and low submergence ratio h 1 11 the fiv response belongs to galloping the most distinctive feature of galloping that the lift force alternates more than one time per cycle of vibration as shown in fig 11 the fiv amplitude reaches up to 0 217m a 2 54 and the frequency of vibration is 0 53711hz in fig 11 c besides the main frequency f 1 0 53711hz the secondary frequency f 2 3 71265hz is also observed the main frequency f 1 is the frequency of galloping see corresponding fig 11 d the secondary frequency f 2 represents the vortex shedding frequency reflected in the lift force in order to give more accurate explanations about the coupling between the lift force and galloping local enlarged drawing of the fiv responses in fig 11 b is presented in fig 12 as mentioned earlier for galloping the lift force alternates n times in one cycle of vibration the interesting observation is that the relationship among n the frequency of galloping f 1 and the vortex shedding frequency f 2 is summed up as 22 n round f 2 f 1 the round function rounds a number to the nearest integer to the best of the authors knowledge the empirical formula eq 22 is a previously unreported finding for example in this case n round 3 71265 0 53711 7 this means the lift force alternates 7 times per cycle of vibration see fig 12 at the high flow velocity u 2 2 m s the vortex shedding modes in the upward journey and at the extreme position are presented in fig 13 as the cylinder approaches the free surface the wake structures behind the cylinder show different states the large scale free surface deformation leads to a lot of vortices regarding the case of galloping in the vicinity of the free surface the vortex shedding mode is more complicated due to the coexistence of the free surface deformation and galloping in the upward journey fig 13 a the shedding vortices are still relatively independent the skewing of the vortices is the result of the large scale fiv amplitude the interesting finding is that the large scale galloping can be maintained in such close proximity to the free surface approaching to the free surface does not significantly reduce the amplitude since galloping is robust to external influences when the square cylinder reaches the highest position see fig 13 b the wake becomes significantly unstable the deformed free surface would also strongly impact the flow structure the free surface shows an unstable distortion reflected in large breaking waves in some instances the vortices shed from the free surface mix with the vortices shed from the cylinder as shown in fig 13 b in a word the unstable vortices and deformed free surface will suppress the amplitude of the cylinder at very low submergence depths 5 1 2 deep submergence 5 1 2 1 case 4 in this section the analysis focuses on the cases at the deep submergence ratio h 5 56 at the low flow velocity u 0 5 m s re 4 025 104 the lift force and amplitude response are presented the amplitude is 0 034m a 0 38 and the frequency of vibration is 0 39063hz as shown in fig 14 the flow structure and free surface profile depend both on the submergence depth ratio and flow velocity the vortex shedding mode and streamlines are presented in fig 15 the fiv response belongs to viv the von kármán vortex sheet street is normal the free surface is flat and close to a straight line in other words the impact of the cylinder on the free surface can be ignored in this case the deep submergence prevents the shedding vortices from being disturbed by the free surface 5 1 2 2 case 5 in the case of high flow velocity u 2 2 m s re 1 78 105 at the deep submergence ratio h 5 56 the fiv response is a typical galloping response as shown in fig 16 the galloping frequency is 0 48828hz the galloping amplitude is 0 25m a 2 8 which is significantly higher than the galloping amplitude a 0 217m a 2 54 of the case at the lower submergence ratio h 1 11 at the same flow velocity a local enlarged drawing of fig 16 b for clearly observation is presented in fig 17 for galloping the lift force alternates n times in one cycle of vibration the frequency of galloping f 1 main frequency is 0 48808hz the vortex shedding frequency f 2 secondary frequency is 3 41026hz according to our empirical formula eq 22 n round 3 41026 0 48808 7 therefore the lift force alternates 7 times per cycle of vibration as marked in fig 17 which means 7 pairs of vortices appear in one cycle of vibration as shown in fig 18 in fig 19 the vortex shedding mode and streamlines are presented at the high flow velocity u 2 2 m s re 1 78 105 when the cylinder is in large scale galloping the amplitude is strong enough to alter the free surface the breaking waves don t appear since the deep submergence reduces the interaction between the cylinder and the free surface but the free surface deformation is still observed at the high flow velocity in summary the flow structures around the square cylinder in fiv for the above 5 cases are compared in table 5 based on the previous study bouscasse et al 2017 three kinds of labelings such as vortex shedding mode free surface deformation and interaction between wake and free surface are utilized to define the flow structure in a word the deformation degree of the free surface becomes prominent as the flow velocity increases or as the submergence depth ratio decreases 5 2 free surface deformation in general two modes in the wake are observed for different submergence depth ratios the first state a jet of the mixture of air and water is induced by the deformed free surface and interacts with the shedding vortices from the cylinder which is a metastable mode the second state the shedding vortices remain relatively stable and form a normal von kármán vortex street which is a stable mode in order to provide quantitative measurements and analyses the front highest point a on the convex wave peak and the rear lowest point b on the concave wave trough are identified as shown in fig 20 def f and def r represent the maximum deformation degree of point a and point b with reference to the initial free surface level respectively to the authors knowledge there were no reports and literature of the relevant studies on 3d free surface deformation in fiv therefore from the point of view of statistics we present figs 20 and 21 the values of def f and def r are obtained by averaging the maximum deformation degree of point a and point b in 10 cycles of vibration in fig 21 the strong dependence of deformation degree on the flow velocity and submergence depth is proven in general it can be concluded that the deformation degree def f and def r gradually increases as the flow velocity increases or as the submergence depth decreases however when the flow velocity exceeds about 2 0 m s re 1 61 105 the deformation degree tends to a stable value especially for the case at the submergence depth h 1 11 def f tends to 0 14m def f def f d 1 56 and def r tends to 0 134m def r def r d 1 49 the reason is the free surface deformation will be limited by the force of gravity 5 3 amplitude and frequency responses 5 3 1 amplitude responses when the flow velocity increases from 0 2 m s to 2 5 m s the vibration belongs to viv first followed by the viv galloping transition region and fully developed galloping the curves of fiv amplitude are plotted versus flow velocity and reynolds number in fig 22 a the major observations are summarized below 1 in the viv galloping transition region two kinds of fivs coexist resulting in a decrease in amplitude this phenomenon can be attributed to the desynchronization of frequency 2 the interesting observation is that for the cases of low submergence depth ratios h 1 11m and 2 22m a significant decrease in amplitude is observed in the range of flow velocity of 1 2m s 1 7 m s which is defined as the unstable vibration region there are two reasons for this phenomenon firstly the vibration is in close proximity to the free surface and thereby will be limited by the deformed free surface in other words this is attributed to the instability of the vortex shedding process near the free surface secondly the fiv response is in the transition region it becomes difficult to maintain the high amplitude fiv response in the transition region when the flow velocity becomes higher u 1 7 m s for the case of h 1 11 u 2 0 m s for the case of h 2 22 the fiv response belongs to the fully developed galloping which is an unlimited and powerful response in this case the negative influences from the deformed free surface can be ignored thus the amplitude rises again when the flow velocity reaches the highest value 2 5 m s the maximum amplitudes of 0 273m a 3 03d and 0 281m a 3 12d are achieved for the cases of h 1 11 and h 2 22 respectively 3 in general increasing submergence depth ratio has a positive impact on fiv when the submergence depth ratio reaches up to 5 56m the fiv amplitude curve intersects with the amplitude curve of the case of h at multiple points which means the effect of submergence depth can be ignored when the submergence depth ratio reaches up to 5 56 4 regarding the cases of higher submergence depth ratios it is demonstrated that the amplitude curves increase linearly in the galloping region and tend to close to each other which means the effect of submergence depth is not significant for galloping at high submergence depth ratios when the flow velocity u 2 5 m s all the amplitudes are close to 0 31m a 3 45d another observation is that decreasing submergence depth ratio will delay the onset of galloping which can be clearly observed for the cases of h h 5 56 and h 3 33 5 3 2 frequency responses the curves of frequency for 5 different submergence depth ratios are presented in fig 22 b the following observations can be made 1 firstly it is noteworthy that the fiv frequency at a very low submergence depth ratio of 1 11 is different from others when the flow velocity is less than 0 9 m s the frequency is significantly higher than all other cases the reason for this is that the cylinder almost floats on the free surface meanwhile the corresponding amplitude is significantly lower than other cylinders as shown in fig 22 a since the fiv amplitude of the case of h 1 11 is very small and like a stationary cylinder the fiv frequency of the case of h 1 11 is very close to the estimated vortex shedding frequency f st 2 with the exception of the case of h 1 11 the frequency shows a similar increasing trend with the increasing flow velocity in the viv region 3 in the viv galloping transition region since viv and galloping interfere with each other the frequency of vibration gradually tends to the natural frequency of the system the decrease in frequency indicates the transition between viv and galloping 4 in the fully developed galloping region the vibration remains a high amplitude and low frequency characteristic the frequency keeps relatively stable near the natural frequency 5 4 fiv energy conversion as shown in fig 23 the converted power of the cylinder is plotted versus flow velocity at different submergence depth ratios the observations are presented as follows 1 in general the power p fiv increases with the flow velocity in the viv region then in the transition region since the vibration frequency significantly decreases the power increases slowly or even drops especially for the cases of h 1 11 h 2 22 and h 3 33 2 in the galloping region the maximum power is observed at the highest flow velocity since galloping is not self limiting therefore the maximum powers are obtained at the highest flow velocity p 15 4w 16 8w 17 7w 18 3w and 17 9w at h 1 11 h 2 22 h 3 33 h 5 56 and h respectively 3 in summary it is deducible that the converted power increases as the submergence depth ratio increases since the effect of free surface gradually becomes weak the power curves of the cases of h 5 56 and h are close to each other which means when the submergence depth ratio h increases to 5 56 the effect of submergence depth is not essential for the cases of h 1 11 and h 2 22 as mentioned earlier the fiv amplitude is also significantly lower than the others see fig 22 hence the corresponding converted power is lower than all other cases especially in the range of 0 9 m s u 1 9 m s these submergence depths are not suitable for energy harvesting in practical applications the efficiency of the fiv energy conversion system at different submergence depth ratios is presented in fig 24 at first the energy conversion efficiency η fiv increases with the flow velocity the maximum efficiency is achieved at about u 1 2 m s re 9 66 104 in the viv region there are two drops in the efficiency curves especially for the cases of h 3 33m h 5 56m and h the first drop is identified in the viv galloping transition region the second drop is observed in the fully developed galloping region similar studies bernitsas 2016 sun et al 2018a also found this phenomenon finally the efficiency maintains a decreasing trend generally as the submergence depth ratio h increases from 1 11 to 5 56 the energy conversion efficiency shows an increasing trend regarding the cases of h 1 11 and h 2 22 the free surface deformation has a distinctly negative influence on the energy conversion efficiency due to close proximity to the free surface when the submergence depth h reaches to 5 56 the maximum energy conversion efficiency is achieved at flow velocity u 1 1 m s the efficiency curve of the case of h 5 56 is very close to the case of h in the galloping region which suggests the effect of submergence depth is no longer significant although the efficiency of the fiv system with a single square cylinder is relatively low this study provides an important reference for the engineering applications proving the critical value of the submergence depth for the fiv energy conversion system in particular in order to reduce the negative influence from the free surface the submergence depth ratio h should be greater than 5 56 6 conclusions in this study the effect of submergence depth on fiv energy conversion of a square cylinder is extensively studied in a wide flow velocity range 0 2 m s u 2 5 m s 1 61 104 reynolds number 2 02 105 numerical simulations were carried out based on fluent and embedded udf code which has been verified by comparing with the experimental data the fiv response vortex patterns and energy conversion are analyzed the following conclusions can be drawn 1 the deformation degree of the free surface gradually increases as the flow velocity increases or as the submergence depth decreases when the flow velocity exceeds about 2 0 m s re 1 61 105 the maximum deformation degree tends to a stable value due to the constraint of gravity 2 according to the fiv amplitude curves 3 regions of the fiv responses are clearly observed including the viv region viv galloping transition region and fully developed galloping region the strongest fiv response appears in the galloping region in particular the maximum amplitude ratio of the case of h 5 56 reaches up to 3 5d at the highest flow velocity 2 5 m s 3 in the viv region the frequency increases with the increasing flow velocity generally the drop in frequency suggests the transition from viv to galloping then the fiv frequency keeps decreasing and tends to the natural frequency of the system in the fully developed galloping region 4 in the galloping region the lift force alternates n times in one cycle of vibration which is another feature of galloping n is subject to n round f 2 f 1 where f 1 represents the frequency of galloping f 2 represents the actual vortex shedding frequency 5 both the converted power and efficiency increases with the flow velocity until the viv galloping transition region in this region a decrease in power and efficiency appears due to the desynchronization of frequency then the converted power keeps an increasing trend in the galloping region the maximum converted power reaches up to 18 3w with u 2 5 m s in the case of h 5 56 however the efficiency gradually decreases it is noteworthy that the maximum efficiency is obtained in the viv region not in the galloping region 6 in general large submergence depth ratios have a positive influence on fiv energy conversion at low submergence depth ratios the vibration of the cylinder is unstable and suppressed resulting in a significant decrease in fiv energy conversion as the submergence depth increases the fiv amplitude power and efficiency show an increasing trend it also should be noted that the fiv response of the case of h 5 56 is found to be very close to the case of h in other words the effect of submergence depth can be ignored when the submergence depth ratio h reaches up to 5 56 in summary this research focuses on the fiv response of a square cylinder near a free surface although the energy conversion efficiency of the square cylinder is relatively low the fiv response of the square cylinder is more controllable and stable five different submergence depths were discussed in detail contributing toward determining the minimum submergence depth for the fiv energy conversion system for future studies the other parameters of the fiv energy conversion system should be further optimized while choosing an appropriate submergence depth and avoiding the negative influence from the free surface author contributions section 1 baoshou zhang cfd simulations writing original draft preparation 2 baowei song experimental design 3 boyang li programming udf code 4 lin su visualization pictures and tables 5 wenjun ding data curation writing reviewing declaration of competing interest we declare that we have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is supported by the national science foundation of china grant no 61572404 and the scholarship from china scholarship council csc grant no 201706290076 
22030,the fiv flow induced vibration responses of an elastically mounted square cylinder near a free surface are numerically investigated using 2 dimensional rans equations in conjunction with sst k ω turbulence model in this work the effect of submergence depth on the fiv response and energy conversion is studied the flow field behavior for flow velocities between 0 2 m s and 2 5 m s 1 61 104 reynolds number 2 02 105 is examined by comparing with experimental data the numerical model is verified fiv consists of viv vortex induced vibration at low flow velocities and galloping at high flow velocities the fiv responses wave profile and energy conversion performance are discussed in detail the main conclusions are 1 decreasing the submergence depth ratio suppresses the fiv amplitude resulting in an obvious decrease in energy conversion 2 at very low submergence depth ratios the wave and breaking wave phenomenon are significant meanwhile the vibration is unstable when the square cylinder is closely approaching the deformed free surface 3 decreasing the submergence depth ratio also delays the onset of galloping 4 the maximum amplitude and power appear at the end of the galloping region 5 the maximum fiv energy conversion efficiency is obtained in the viv region keywords fiv flow induced vibration square cylinder energy conversion efficiency submergence depth ratio free surface viv vortex induced vibration 1 introduction in transverse flow an elastically mounted cylinder on springs is always excited by fiv in particular viv and galloping are two of the most common forms of fiv usually viv is inherently a nonlinear vibration broad range self limiting response bernitsas 2016 ding et al 2015 when flow past a cylinder generates a vortex street in the wake these vortices change the pressure distribution along the surface of the cylinder when the vortices are not formed symmetrically around the cylinder different lift forces develop on each side of the body thus leading to motion transverse to the flow blevins blevins and williamson et al williamson and govardhan 2004 also concluded viv is a broad range phenomenon the lock in phenomenon is observed when the frequency of vortex shedding is close to the natural frequency of the vibrating cylinder bearman 2011 reported a comprehensive review about viv of circular cylinders xu wan hai et al chen et al 2015 ma et al 2020 xu et al 2013 study the viv responses of a free spanning pipeline and two side by side elastically supported circular cylinders compared with viv galloping appears at higher flow velocities galloping is generally considered as an unlimited fiv response with the increasing flow velocity until structural failure it should be noted that galloping will not occur on smooth circular cylinders in previous studies non circular cross sectional cylinders result not symmetric flow around the cylinder and therefore respond in galloping cui et al 2015 ding et al 2015 zhao et al 2019 fiv is usually interpreted as a destructive response in recent years the fiv phenomena such as viv and galloping have been utilized to harvest hydrokinetic energy in particular bernitsas et al 2008 and raghavan et al raghavan 2007 introduced a vivace vortex induced vibration aquatic clean energy converter the converter converts hydrokinetic energy to the mechanical energy of vibrating cylinders which drive generators to produce electricity at first the converter just utilized the viv phenomenon bernitsas et al 2009 lee 2010 lee and bernitsas 2011 raghavan et al 2009 then galloping was introduced into the energy converter due to the adoption of ptc passive turbulence control cylinders and non circular cross sectional cylinders ding et al 2013 kim et al 2013 raghavan et al 2009 zhang et al 2018a 2018b the studies on the hydrokinetic energy converter have been systematically completed by bernitsas et al bernitsas 2016 bernitsas et al 2008 and sun et al 2018a 2018b based on experiments and by ding et al 2016 2017 and zhang et al 2017 2018a 2018b based on cfd numerical simulations it was reported the energy conversion system has a great performance in a wide range of flow velocities and without upper limit which is significantly better than traditional ocean energy conversion devices e g turbines need 5 7knots 2 6 3 6 m s in ocean currents to remain financially viable zhang et al 2018b chang 2010 in earlier studies the fiv responses were mainly studied in deep water without considering the effect of submergence depth to the authors knowledge very few studies investigated the effect of submergence depth on viv or galloping raghavan et al raghavan 2007 reported the effect of the bottom and free surface boundary on viv sareen et al 2018 carried out experiments on the viv responses of a sphere close to a free surface carberry et al 2004 and zhu et al 2000 studied the forced oscillation of cylinders in the vicinity of a free surface and found the mode of vortex shedding changes with the submergence depth however the fiv responses of square cylinders near a free surface are not investigated until now unlike the situation of vibrating cylinders near a free surface there are a lot of earlier works on the flow past a fixed cylinder close to a free surface bouscasse et al 2017 reichl et al 2005 carberry 2002 tritton 2012 more specifically reichl et al 2005 simulated the flow past a fixed cylinder near the free surface based on fluent and found that the shedding model depends on the submergence depth carberry 2002 found the free surface deformation above a fixed cylinder in water is not obvious when the reynolds number is less than 2100 sheridan et al tritton 2012 reported a jet flow is always observed between the free surface and fixed cylinders at higher reynolds numbers re 6000 according to the authors judgment the jet flow indicates the coanda effect around a bluff body sheridan et al 1997 although the above mentioned studies mainly focused on the fixed cylinder near a free surface these results provide inspiration for this study meanwhile the background about the present study also comes from the towing tank tests for the viv responses of circular cylinders in our laboratory as shown in fig 1 it was found that the effect of free surface significantly alters the characteristics of viv especially when the submergence depth ratio is less than 3 33 the cylinder interacts with the free surface and induces significant free surface deformation however the experiments are mainly focused on viv and circular cylinders rather than non circular cross sectional cylinders although significant free surface deformation was observed the free surface profile can t be recorded in the experiments according to the literature review numerical methods have been widely adopted in the analysis of the fiv responses in similar studies ding et al 2015 guan and jaiman 2017 kinaci et al 2016 reichl et al 2005 zhu and yao 2015 finally the numerical method will been applied to investigate the effect of submergence depth or free surface on fiv since it excels in analyzing the flow structure and free surface deformation in the present study 2 dimensional numerical simulations are performed to study the fiv responses of a square cylinder near a free surface this study focuses on the interaction between the vibrating cylinder and free surface this paper is organized as follows the fiv energy conversion system and design parameters are introduced in section 2 then the mathematical equations are briefly documented in section 3 next the numerical method is verified by previous experimental data in section 4 the results are discussed in sections 5 finally the main conclusions are presented based on the analysis of the flow characteristics and the fiv responses 2 geometry configuration the new fiv energy conversion system with a single square cylinder is built based on previous studies bernitsas 2016 bernitsas et al 2008 as depicted in fig 2 the rigid square cylinder is perpendicular to ocean river currents the shed vortices act on the cylinder resulting in vigorous fiv responses the rigid cylinder is fastened to a gear belt system which drives a generator to produce electric energy since the transverse displacement of bluff bodies in fiv is much larger than the streamwise displacement the cylinder is limited to one degree of freedom meanwhile one degree of freedom of the energy conversion system can greatly reduce the complexity of transmission structure and the structural damping one degree of freedom system has been widely used in similar energy conversion systems bernitsas 2016 bernitsas et al 2008 2009 ding et al 2015 raghavan 2007 raghavan et al 2009 therefore only the transverse motion is investigated in this paper although the cylinder is fully submerged it is essential to assess the influence of the deformed free surface h denotes the submergence depth k is the spring stiffness c t o t a l represents the total damping from the generator effective damping and transmission mechanisms structural dissipated damping therefore c t o t a l corresponds to the total converted power p fiv including the effective power and the dissipated power in earlier works the fiv responses of circular cylinders without considering the effect of free surface have been widely investigated in this work depending on the studies reported by bernitsas et al bernitsas 2016 sun et al 2016 and park et al 2013 a similar sized fiv energy conversion system with a single square cylinder is built the notations and parameters of the fiv system are presented in table 1 and table 2 in these studies when the damping ratio ξ t o t a l is set as 0 1 0 2 both the fiv amplitude and the energy conversion performance are relatively high as a result the damping ratio ξ t o t a l is set as 0 1 in this work therefore the system damping coefficient c t o t a l is about 30 other mian parameters are listed in table 2 the effect of submergence depth h is of interest in other design parameters when the cylinder is near the free surface five different submergence depths i e h 0 1m h 1 11 h 0 2m h 2 22 h 0 3m h 3 33 h 0 5m h 5 56 and h m h are selected as variables h is the submergence ratio it is noteworthy that means the square cylinder is elastically mounted in single phase flow without considering the effects of the free surface in this case the effect of submergence depth and influence of free surface can be ignored 3 mathematical model 3 1 governing equations and turbulence model in this work 2 dimensional rans reynolds averaged navier stokes equations equations in conjunction with sst shear stress transport k ω turbulence model are utilized to simulate the flow past a cylinder close to a free surface the continuity equation and momentum equation are given here 1 u i x i 0 2 u i t u j u i x j ρ p x i x j 2 v s i j u i u j therein s i j is the mean strain rate tensor and defined as 3 s i j 1 2 u i x j u j x i for the 2 dimensional simulations i and j is two values 1 and 2 in the governing equations therefore in the cartesian coordinates we have x i x and x j y u i u j is the reynolds stress tensor and computed by 4 u i u j v t u i x j u j x i 2 3 k δ i j where u i is the fluid velocity in x i direction ρ is the fluid density p is the pressure v is the kinematic viscosity of the fluid v t is the turbulent viscosity and k is the turbulent energy in order to adapt to the adverse pressure gradient flow in the near wall region of the cylinder in a wide flow velocity range the sst k ω turbulence model is selected the sst k ω model has been successfully employed to simulate the fiv responses of cylinders in early studies cui et al 2015 zhao and cheng 2012 the sst k ω model includes the turbulence intensity equation and turbulent frequency equation 5 ρ k t ρ k u μ μ z σ k k p k b k ρ k ω 6 ρ ω t ρ ω u μ μ z σ ω ω a ω k p k b ω ρ k ω 2 where p k is kinetic energy σ k and σ ω are turbulent prandtl numbers μ z ρ k ω represents eddy viscosity more details about the turbulence model are reported in earlier work by menter 1994 3 2 equations of motion and energy conversion according to the mass spring damper system see fig 2 the motion of the cylinder can be obtained by solving the second order linear differential equation the differential equation of motion 7 m y c t o t a l y k y f fluid y t where m is the total vibrating mass of the system y is the displacement f fluid y t is the total hydrodynamic force in y direction in the present work based on the fluent and embedded udf user defined functions code the total hydrodynamic force f fluid y t can be obtained directly the total fiv converted power p fiv is 8 p fiv 1 t o s c 0 t o s c f fluid y y d t considering eq 7 p fiv can be written as 9 p fiv 1 t o s c 0 t o s c m y c t o t a l y k y y d t based on the earlier works bernitsas 2016 bernitsas et al 2008 the fiv amplitude is generally regarded as a sinusoidal form in one cycle so the motion is defined as 10 y t a s i n ω o s c t where ω o s c 2 π f 2 π t osc it should be noted that eq 10 is used for dropping the m y and k y terms not used for replacing the equation of motion eq 7 for the m y terms 11 1 t o s c 0 t o s c m y y d t 1 t o s c 0 t o s c m a ω o s c s 2 i n ω o s c t a ω o s c cos ω o s c t d t 1 2 t o s c m a 2 ω o s c s 2 i n 2 ω o s c t 0 t o s c we have s i n 2 ω o s c t 0 t o s c s i n 2 ω o s c t 0 2 π ω o s c s i n 2 2 π s i n 2 0 0 so the m y term is equal to 0 aside from the detailed derivation in section 3 2 analyzing from a macro perspective the total momentum of the cylinder will not change after one cycle so the m y term is zero similarly for the k y terms 12 1 t o s c 0 t o s c k y y d t 1 t o s c 0 t o s c k a s i n ω o s c t a ω o s c cos ω o s c t d t 1 2 t o s c k a 2 s i n 2 ω o s c t 0 t o s c 0 similarly analyzing from a macro perspective elastic potential energy is potential energy stored as a result of deformation of an elastic object such as the stretching of a spring it is equal to the work done to stretch the spring which depends upon the spring constant k as well as the distance stretched y however after one cycle of vibration the stretching of a spring y is zero thus the k y term can also be ignored in one cycle finally after dropping the m y term and k y term eq 9 can be further simplified as 13 p fiv 1 t o s c 0 t o s c c t o t a l y 2 d t eq 13 is a simplified equation after dropping the m y and k y terms similar derivation process has been widely used for the fiv energy conversion systems bernitsas 2016 ding et al 2015 raghavan 2007 the displacement y and the flow velocity y or written as u of the vibrating cylinder can be numerically obtained based on the udf user defined functions code embedded in fluent which will be discussed in the next section from bernoulli s equation the fluid power p fluid can be defined as 14 p fluid 1 2 ρ u 3 l d 2 a to calculate the fiv energy conversion efficiency η fiv betz limit which represents the theoretical maximum efficiency that can be extracted from the flow field should be included the value of betz limit is 16 27 59 26 sun et al 2016 betz 1966 therefore the energy conversion efficiency can be written as 15 η fiv p fiv p fluid 16 27 100 4 numerical method 4 1 numerical scheme in the present work numerical simulations of fluid flow around the cylinder are performed based on cfd software fluent 19 1 accompanied with the embedded user defined function udf code fluent solves the rans equations and continuum mechanics problems using the finite volume discretization method the udf code is written with c language to solve the differential equation of motion eq 7 based on newmark β method newmark β method has been widely used in numerical evaluation of the dynamic response of structures and solids such as in finite element analysis to model dynamic systems newmark 1959 deü and matignon 2010 based on the newmark β method the motion displacement y velocity y and acceleration y can be defined respectively as 16 y t δ t y t y δ t 1 2 β y t β y t δ t δ t 2 17 y t δ t γ β δ t 2 y t δ t y t 1 γ β y t 1 γ β y t δ t 18 y t δ t 1 β δ t 2 y t δ t y t 1 β δ t y t 1 2 β 1 y t where t or t δ t is the time level γ and β are weighting constants in ref newmark 1959 deü and matignon 2010 the recommended values of γ and β are 0 5 and 0 25 the recommended values give the constant average acceleration method which is also a second order accurate and unconditionally stable method considering eq 7 at time t δ t we have 19 m y t δ t c t o t a l y t δ t k y t δ t f fluid y t t δ t considering eqs 16 18 eq 19 yields 20 k y t δ t f where 21a k k 1 β δ t 2 m γ β δ t c t o t a l 21b f f fluid y t t δ t 1 β δ t 2 y t 1 β δ t y t 1 2 β 1 y t m γ β δ t 2 y t 1 γ β y t 1 1 2 β y t c t o t a l by solving the eqs 17 18 and 20 the displacement of the cylinder can be obtained the approach has also been employed in earlier works zhang et al 2018a 2018b so details are not discussed here 4 2 computational domain and grid generation in fig 3 the computational domain is established in order to avoid the blockage effect and wall effect the length and height of the domain are set as 50d and 30d in the flow and cross flow direction the cylinder is placed 15d from the inlet boundary located midway between two lateral boundaries the domain is divided into four sub domains including central domain upper slipway lower slipway and external flow field a steady two phase flow is applied on the inlet boundary changing from 0 2 m s to 2 5 m s 1 61 104 r e 2 02 105 to simulate water and air the two phase flow is a typical open channel flow problem in this work fluent 19 1 is used to model the open channel flow based on the vof volume of fluid method the vof scheme solves two or more immiscible fluids by calculating a set of momentum equations and tracking the volume fraction of each of the fluids http www afs enea it pr reichl et al 2005 verified the same numerical method by comparing their results with the experimental data tritton 2012 the pressure on the outlet boundary is set as zero the surface of the cylinder is imposed as a no slip boundary internal interfaces are overlapped with other interfaces in the adjacent domains where the fluid can pass freely quadrilateral grids are adopted due to less memory occupying and higher accuracy fig 3 b shows the computational grid in the central domain the resolution of gird is the highest the edges of the square cylinder are divided into 400 elements and the size is about 9 10 4m considering the large velocity gradient the boundary layer grid is utilized in the near wall region of the cylinder the number of layers is 10 and the growth rate is 1 2 meanwhile depending on the requirements of the k ω sst turbulence model the dimensionless wall distance y value of the first layer of the grid should be approximately equal to 1 therefore the height of the first prism layer is about 3 10 5m in the external flow field upper slipway and lower slipway the resolution of the grid is relatively low to improve the calculation efficiency the moving boundaries and the central domain will move together with the cylinder moving boundaries are set based on the dynamic mesh update method layering method in fluent the elements adjacent to the moving boundary will be added or deleted using the layering method 4 3 model validation the time step dependence study is conducted to evaluate the impact of time step on fiv the parameters of the fiv system have been listed in table 2 four different time steps i e 0 01s step 0 007s step 0 005s step and 0 003s step are selected the amplitude time curves are drawn in fig 4 the test flow velocity is 2 0 m s re 1 61 105 in this case it is a typical galloping the results for time step dependency validation are listed in table 3 for the selected time steps based on the recommended values 0 5 and 1 0 of the courant number in fluent the influence of cfl condition is not significant and can be ignored since the selected time steps are small enough the results show that when the time step decreases to 0 005s step the fiv responses remain relatively stable similarly the grid dependence study is also performed for four different grid densities with approximately 50 000 75 000 100 000 and 150 000 elements fig 5 shows the amplitude time curves at the flow velocity u 2 0 m s table 4 shows the comparison of the results after reaching 100 000 elements further increasing grid density doesn t have a significant impact on the numerical results therefore considering the simulation efficiency the following simulations are based on 100 000 elements and 0 005s step in similar studies zhang et al 2018a reichl et al 2005 zhao and cheng 2012 the numerical method with the k ω sst turbulence model has been successfully used to simulate the fiv responses of the square cylinder to further validate the cfd method the cfd result is compared with the experimental results reported by zhao et al 2010 and nemes et al 2012 fig 6 shows the comparison between the cfd results and the experimental results it is noteworthy that the non dimensional velocity reduced velocity u is defined as u u f n w a t e r h the natural frequency f n w a t e r is calculated by f n w a t e r 1 2 π k m c a d d ρ v disp the non dimensional amplitude amplitude ratio is a a d the non dimensional frequency frequency ratio is f f f n w a t e r s t represents the strouhal number for the square cylinder the strouhal number is about 0 13 in the selected range of reynolds number based on ref okajima 1982 f st s t u d is the estimated frequency of a stationary square cylinder in water based on strouhal number therefore f s t is defined as f s t f s t f n w a t e r in general as the flow velocity increases viv appears first then galloping appears at higher flow velocities the difference between the numerical result and the experimental results is mainly located in the viv region 4 u 8 as shown in fig 6 there are two main reasons leading to the difference or the limitation of the numerical method the first reason the study is conducted by using the 2 dimensional assumption this simulates ideal 3 dimensional fluid without lateral flow the viv region the strongest resonance region in fiv means the vortex shedding frequency coincides with the natural frequency of the system which is different from galloping however the ideal 3 dimensional fluid is very sensitive which differs from the real environment accordingly the viv region is different from the experiment result similar conclusions were also drawn in other literature e g ref bernitsas 2016 page1213 fig 47 56a the second reason is in the reference experiment the parameters of the viv system are given in non dimensional or normalized format such as the mass ratio m the damping ratio ξ and the reduced velocity u etc thus we have to deduce the actual parameters based on the non dimensional parameters which may lead to the difference the above two aspects are the limitation of the 2d numerical method in addition to this difference all other branches are in good agreement therefore the numerical method is considered convergent and acceptable in most cases 5 results and analysis a series of simulations are performed to investigate the fiv responses of a square cylinder over a wide flow velocity range from 0 2 m s to 2 5 m s 1 61 104 reynolds number 2 02 105 at different submergence depth ratios of 1 11 2 22 3 33 5 56 and the design parameters of the fiv system are listed in table 2 the most representative cases under different conditions are discussed in the following sections 5 1 fiv responses and vortex patterns 5 1 1 low submergence 5 1 1 1 case 1 at low flow velocity u 0 4 m s re 3 22 104 and low submergence depth ratio h 1 11 the amplitude response lift force and corresponding frequency are shown in fig 7 by the way since the present study focuses on the fiv cylinder under fully submerged conditions reynolds number rather than froude number are treated as the variable value the average amplitude is only 0 017m a 0 19 and the frequency is 0 5127hz the lift force is always regarded as a consequence of the shedding vortices on both sides of the cylinder in fig 7 b the lift force is in agreement with the amplitude in other words the lift force synchronizes with the vibration which means the fiv response achieves synchronization between the vibration and shedding vortices this is a prominent feature of viv to better explain the dynamic fiv response the vortex shedding mode and streamlines are presented in fig 8 the wake of the cylinder is relatively stable due to very low amplitude where a regular von kármán vortex street can be identified in one cycle of vibration two alternating vortices are shed from both sides of the square cylinder and the vortex shedding mode is captured as the typical 2s 2 single vortex pattern of viv a similar observation for a single cylinder in viv is also reported by ding et al 2015 in general two kinds of vortices such as the vortices shed from the cylinder and the vortices generated from the deformed free surface coexist in the flow and mix with each other for this case of h 1 1 the effect of free surface on the cylinder is not significant but appreciable free surface deformation is still observed the deformed free surface is caused by pressure fluctuations between the free surface and the cylinder the deformed free surface produces a string of small vortices which belong to the second kind of vortices more specifically small depression on the free surface results in the wave making phenomenon the air bubbles are caused by the breaking waves on the free surface a jet flow of the mixture of vortices air bubbles and water is attracted from the free surface and projected into the wake 5 1 1 2 case 2 as the flow velocity increases to u 1 2 m s re 9 66 104 the vibration becomes more powerful and the vortex shedding frequency keeps increasing the fiv amplitude is about 0 038m a 0 42 and the frequency of vibration is 0 78125hz as shown in fig 9 the fiv response is located in the viv galloping transition region zhang et al 2018a it is obvious that the fiv amplitude and lift force become desynchronized due to very close proximity to the free surface the vortices become unstable therefore the unstable vortices and lift have a negative impact on the fiv response resulting in an increase in the randomness of vibration and a definite decline in the amplitude at the intermediate flow velocity u 1 2 m s the free surface is drastically altered by the vibrating cylinder as shown in fig 10 the von kármán vortex street also becomes abnormal the free surface deformation is more evident reflected in breaking waves and a jet flow which is similar to the coanda effect the coanda effect is the tendency of a fluid jet to stay attached to a convex surface tritton 2012 the jet flow separates with the free surface and mixes with the wake compared with the case at low flow velocity see fig 8 the distance between the cylinder and jet flow is much longer the free surface deformation in turn strongly changes the shedding of vortices from the square cylinder these two kinds of vortices mix together resulting in a decrease in the intensity of vorticity since the direction of rotation of the vortices generated from the free surface doesn t synchronize with the vortices shed from the cylinder finally the interaction causes the suppression of the fiv amplitude in other words the deformed free surface and mixed vortices reduce the lift force acting on the cylinder 5 1 1 3 case 3 at high flow velocity u 2 2 m s re 1 78 105 and low submergence ratio h 1 11 the fiv response belongs to galloping the most distinctive feature of galloping that the lift force alternates more than one time per cycle of vibration as shown in fig 11 the fiv amplitude reaches up to 0 217m a 2 54 and the frequency of vibration is 0 53711hz in fig 11 c besides the main frequency f 1 0 53711hz the secondary frequency f 2 3 71265hz is also observed the main frequency f 1 is the frequency of galloping see corresponding fig 11 d the secondary frequency f 2 represents the vortex shedding frequency reflected in the lift force in order to give more accurate explanations about the coupling between the lift force and galloping local enlarged drawing of the fiv responses in fig 11 b is presented in fig 12 as mentioned earlier for galloping the lift force alternates n times in one cycle of vibration the interesting observation is that the relationship among n the frequency of galloping f 1 and the vortex shedding frequency f 2 is summed up as 22 n round f 2 f 1 the round function rounds a number to the nearest integer to the best of the authors knowledge the empirical formula eq 22 is a previously unreported finding for example in this case n round 3 71265 0 53711 7 this means the lift force alternates 7 times per cycle of vibration see fig 12 at the high flow velocity u 2 2 m s the vortex shedding modes in the upward journey and at the extreme position are presented in fig 13 as the cylinder approaches the free surface the wake structures behind the cylinder show different states the large scale free surface deformation leads to a lot of vortices regarding the case of galloping in the vicinity of the free surface the vortex shedding mode is more complicated due to the coexistence of the free surface deformation and galloping in the upward journey fig 13 a the shedding vortices are still relatively independent the skewing of the vortices is the result of the large scale fiv amplitude the interesting finding is that the large scale galloping can be maintained in such close proximity to the free surface approaching to the free surface does not significantly reduce the amplitude since galloping is robust to external influences when the square cylinder reaches the highest position see fig 13 b the wake becomes significantly unstable the deformed free surface would also strongly impact the flow structure the free surface shows an unstable distortion reflected in large breaking waves in some instances the vortices shed from the free surface mix with the vortices shed from the cylinder as shown in fig 13 b in a word the unstable vortices and deformed free surface will suppress the amplitude of the cylinder at very low submergence depths 5 1 2 deep submergence 5 1 2 1 case 4 in this section the analysis focuses on the cases at the deep submergence ratio h 5 56 at the low flow velocity u 0 5 m s re 4 025 104 the lift force and amplitude response are presented the amplitude is 0 034m a 0 38 and the frequency of vibration is 0 39063hz as shown in fig 14 the flow structure and free surface profile depend both on the submergence depth ratio and flow velocity the vortex shedding mode and streamlines are presented in fig 15 the fiv response belongs to viv the von kármán vortex sheet street is normal the free surface is flat and close to a straight line in other words the impact of the cylinder on the free surface can be ignored in this case the deep submergence prevents the shedding vortices from being disturbed by the free surface 5 1 2 2 case 5 in the case of high flow velocity u 2 2 m s re 1 78 105 at the deep submergence ratio h 5 56 the fiv response is a typical galloping response as shown in fig 16 the galloping frequency is 0 48828hz the galloping amplitude is 0 25m a 2 8 which is significantly higher than the galloping amplitude a 0 217m a 2 54 of the case at the lower submergence ratio h 1 11 at the same flow velocity a local enlarged drawing of fig 16 b for clearly observation is presented in fig 17 for galloping the lift force alternates n times in one cycle of vibration the frequency of galloping f 1 main frequency is 0 48808hz the vortex shedding frequency f 2 secondary frequency is 3 41026hz according to our empirical formula eq 22 n round 3 41026 0 48808 7 therefore the lift force alternates 7 times per cycle of vibration as marked in fig 17 which means 7 pairs of vortices appear in one cycle of vibration as shown in fig 18 in fig 19 the vortex shedding mode and streamlines are presented at the high flow velocity u 2 2 m s re 1 78 105 when the cylinder is in large scale galloping the amplitude is strong enough to alter the free surface the breaking waves don t appear since the deep submergence reduces the interaction between the cylinder and the free surface but the free surface deformation is still observed at the high flow velocity in summary the flow structures around the square cylinder in fiv for the above 5 cases are compared in table 5 based on the previous study bouscasse et al 2017 three kinds of labelings such as vortex shedding mode free surface deformation and interaction between wake and free surface are utilized to define the flow structure in a word the deformation degree of the free surface becomes prominent as the flow velocity increases or as the submergence depth ratio decreases 5 2 free surface deformation in general two modes in the wake are observed for different submergence depth ratios the first state a jet of the mixture of air and water is induced by the deformed free surface and interacts with the shedding vortices from the cylinder which is a metastable mode the second state the shedding vortices remain relatively stable and form a normal von kármán vortex street which is a stable mode in order to provide quantitative measurements and analyses the front highest point a on the convex wave peak and the rear lowest point b on the concave wave trough are identified as shown in fig 20 def f and def r represent the maximum deformation degree of point a and point b with reference to the initial free surface level respectively to the authors knowledge there were no reports and literature of the relevant studies on 3d free surface deformation in fiv therefore from the point of view of statistics we present figs 20 and 21 the values of def f and def r are obtained by averaging the maximum deformation degree of point a and point b in 10 cycles of vibration in fig 21 the strong dependence of deformation degree on the flow velocity and submergence depth is proven in general it can be concluded that the deformation degree def f and def r gradually increases as the flow velocity increases or as the submergence depth decreases however when the flow velocity exceeds about 2 0 m s re 1 61 105 the deformation degree tends to a stable value especially for the case at the submergence depth h 1 11 def f tends to 0 14m def f def f d 1 56 and def r tends to 0 134m def r def r d 1 49 the reason is the free surface deformation will be limited by the force of gravity 5 3 amplitude and frequency responses 5 3 1 amplitude responses when the flow velocity increases from 0 2 m s to 2 5 m s the vibration belongs to viv first followed by the viv galloping transition region and fully developed galloping the curves of fiv amplitude are plotted versus flow velocity and reynolds number in fig 22 a the major observations are summarized below 1 in the viv galloping transition region two kinds of fivs coexist resulting in a decrease in amplitude this phenomenon can be attributed to the desynchronization of frequency 2 the interesting observation is that for the cases of low submergence depth ratios h 1 11m and 2 22m a significant decrease in amplitude is observed in the range of flow velocity of 1 2m s 1 7 m s which is defined as the unstable vibration region there are two reasons for this phenomenon firstly the vibration is in close proximity to the free surface and thereby will be limited by the deformed free surface in other words this is attributed to the instability of the vortex shedding process near the free surface secondly the fiv response is in the transition region it becomes difficult to maintain the high amplitude fiv response in the transition region when the flow velocity becomes higher u 1 7 m s for the case of h 1 11 u 2 0 m s for the case of h 2 22 the fiv response belongs to the fully developed galloping which is an unlimited and powerful response in this case the negative influences from the deformed free surface can be ignored thus the amplitude rises again when the flow velocity reaches the highest value 2 5 m s the maximum amplitudes of 0 273m a 3 03d and 0 281m a 3 12d are achieved for the cases of h 1 11 and h 2 22 respectively 3 in general increasing submergence depth ratio has a positive impact on fiv when the submergence depth ratio reaches up to 5 56m the fiv amplitude curve intersects with the amplitude curve of the case of h at multiple points which means the effect of submergence depth can be ignored when the submergence depth ratio reaches up to 5 56 4 regarding the cases of higher submergence depth ratios it is demonstrated that the amplitude curves increase linearly in the galloping region and tend to close to each other which means the effect of submergence depth is not significant for galloping at high submergence depth ratios when the flow velocity u 2 5 m s all the amplitudes are close to 0 31m a 3 45d another observation is that decreasing submergence depth ratio will delay the onset of galloping which can be clearly observed for the cases of h h 5 56 and h 3 33 5 3 2 frequency responses the curves of frequency for 5 different submergence depth ratios are presented in fig 22 b the following observations can be made 1 firstly it is noteworthy that the fiv frequency at a very low submergence depth ratio of 1 11 is different from others when the flow velocity is less than 0 9 m s the frequency is significantly higher than all other cases the reason for this is that the cylinder almost floats on the free surface meanwhile the corresponding amplitude is significantly lower than other cylinders as shown in fig 22 a since the fiv amplitude of the case of h 1 11 is very small and like a stationary cylinder the fiv frequency of the case of h 1 11 is very close to the estimated vortex shedding frequency f st 2 with the exception of the case of h 1 11 the frequency shows a similar increasing trend with the increasing flow velocity in the viv region 3 in the viv galloping transition region since viv and galloping interfere with each other the frequency of vibration gradually tends to the natural frequency of the system the decrease in frequency indicates the transition between viv and galloping 4 in the fully developed galloping region the vibration remains a high amplitude and low frequency characteristic the frequency keeps relatively stable near the natural frequency 5 4 fiv energy conversion as shown in fig 23 the converted power of the cylinder is plotted versus flow velocity at different submergence depth ratios the observations are presented as follows 1 in general the power p fiv increases with the flow velocity in the viv region then in the transition region since the vibration frequency significantly decreases the power increases slowly or even drops especially for the cases of h 1 11 h 2 22 and h 3 33 2 in the galloping region the maximum power is observed at the highest flow velocity since galloping is not self limiting therefore the maximum powers are obtained at the highest flow velocity p 15 4w 16 8w 17 7w 18 3w and 17 9w at h 1 11 h 2 22 h 3 33 h 5 56 and h respectively 3 in summary it is deducible that the converted power increases as the submergence depth ratio increases since the effect of free surface gradually becomes weak the power curves of the cases of h 5 56 and h are close to each other which means when the submergence depth ratio h increases to 5 56 the effect of submergence depth is not essential for the cases of h 1 11 and h 2 22 as mentioned earlier the fiv amplitude is also significantly lower than the others see fig 22 hence the corresponding converted power is lower than all other cases especially in the range of 0 9 m s u 1 9 m s these submergence depths are not suitable for energy harvesting in practical applications the efficiency of the fiv energy conversion system at different submergence depth ratios is presented in fig 24 at first the energy conversion efficiency η fiv increases with the flow velocity the maximum efficiency is achieved at about u 1 2 m s re 9 66 104 in the viv region there are two drops in the efficiency curves especially for the cases of h 3 33m h 5 56m and h the first drop is identified in the viv galloping transition region the second drop is observed in the fully developed galloping region similar studies bernitsas 2016 sun et al 2018a also found this phenomenon finally the efficiency maintains a decreasing trend generally as the submergence depth ratio h increases from 1 11 to 5 56 the energy conversion efficiency shows an increasing trend regarding the cases of h 1 11 and h 2 22 the free surface deformation has a distinctly negative influence on the energy conversion efficiency due to close proximity to the free surface when the submergence depth h reaches to 5 56 the maximum energy conversion efficiency is achieved at flow velocity u 1 1 m s the efficiency curve of the case of h 5 56 is very close to the case of h in the galloping region which suggests the effect of submergence depth is no longer significant although the efficiency of the fiv system with a single square cylinder is relatively low this study provides an important reference for the engineering applications proving the critical value of the submergence depth for the fiv energy conversion system in particular in order to reduce the negative influence from the free surface the submergence depth ratio h should be greater than 5 56 6 conclusions in this study the effect of submergence depth on fiv energy conversion of a square cylinder is extensively studied in a wide flow velocity range 0 2 m s u 2 5 m s 1 61 104 reynolds number 2 02 105 numerical simulations were carried out based on fluent and embedded udf code which has been verified by comparing with the experimental data the fiv response vortex patterns and energy conversion are analyzed the following conclusions can be drawn 1 the deformation degree of the free surface gradually increases as the flow velocity increases or as the submergence depth decreases when the flow velocity exceeds about 2 0 m s re 1 61 105 the maximum deformation degree tends to a stable value due to the constraint of gravity 2 according to the fiv amplitude curves 3 regions of the fiv responses are clearly observed including the viv region viv galloping transition region and fully developed galloping region the strongest fiv response appears in the galloping region in particular the maximum amplitude ratio of the case of h 5 56 reaches up to 3 5d at the highest flow velocity 2 5 m s 3 in the viv region the frequency increases with the increasing flow velocity generally the drop in frequency suggests the transition from viv to galloping then the fiv frequency keeps decreasing and tends to the natural frequency of the system in the fully developed galloping region 4 in the galloping region the lift force alternates n times in one cycle of vibration which is another feature of galloping n is subject to n round f 2 f 1 where f 1 represents the frequency of galloping f 2 represents the actual vortex shedding frequency 5 both the converted power and efficiency increases with the flow velocity until the viv galloping transition region in this region a decrease in power and efficiency appears due to the desynchronization of frequency then the converted power keeps an increasing trend in the galloping region the maximum converted power reaches up to 18 3w with u 2 5 m s in the case of h 5 56 however the efficiency gradually decreases it is noteworthy that the maximum efficiency is obtained in the viv region not in the galloping region 6 in general large submergence depth ratios have a positive influence on fiv energy conversion at low submergence depth ratios the vibration of the cylinder is unstable and suppressed resulting in a significant decrease in fiv energy conversion as the submergence depth increases the fiv amplitude power and efficiency show an increasing trend it also should be noted that the fiv response of the case of h 5 56 is found to be very close to the case of h in other words the effect of submergence depth can be ignored when the submergence depth ratio h reaches up to 5 56 in summary this research focuses on the fiv response of a square cylinder near a free surface although the energy conversion efficiency of the square cylinder is relatively low the fiv response of the square cylinder is more controllable and stable five different submergence depths were discussed in detail contributing toward determining the minimum submergence depth for the fiv energy conversion system for future studies the other parameters of the fiv energy conversion system should be further optimized while choosing an appropriate submergence depth and avoiding the negative influence from the free surface author contributions section 1 baoshou zhang cfd simulations writing original draft preparation 2 baowei song experimental design 3 boyang li programming udf code 4 lin su visualization pictures and tables 5 wenjun ding data curation writing reviewing declaration of competing interest we declare that we have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is supported by the national science foundation of china grant no 61572404 and the scholarship from china scholarship council csc grant no 201706290076 
22031,despite the increasing focus on the seismic safety of reef engineering sites the current studies on this topic are still based on the hypotheses of uniform seismic excitations or the vertical incidence of seismic waves in this study a two dimensional seismic analysis model for the reef seawater system under obliquely incident p and sv waves is developed which considers the fluid soil interaction and the wave radiation effects of the fluid and the solid domain the oblique input of the seismic wave into the reef seawater model is accomplished through the boundary substructure method a series of parametric studies are conducted the ground motion fields on the reef sites are discussed and the effects of several fundamental factors on the seismic response are comprehensively studied the results show that under most circumstances the least favorable load case for the reef site seismic response is the vertical incidence of seismic waves however for the horizontal ground motion of the reef site under the p wave the least favorable incident angle is approximately 30 in addition the largest horizontal seismic response usually appears near the downstream side of the reef flat and the peak velocity and acceleration ratios can reach up to 4 in this area keywords reef seawater obliquely incident seismic wave seismic ground motion seismic wave input artificial boundary 1 introduction reef engineering as represented by the artificial island construction in the south china sea has been developing rapidly in recent years because the ground motion field of the reef island is the basis for the seismic design of the artificial island and its upper constructions the seismic response analysis of reef engineering sites is currently a focused research area in earthquake engineering and ocean engineering generally the reef structure can be geologically divided into two parts the shallow coral sand layer and the deep reef rock layer on that basis the studies on reef islands can be classified into two categories according to their research objectives i geological and geotechnical research on the coral sand which mainly focuses on the nonlinear behavior of the calcareous soils and ii seismological research on the reef rocky structure which focuses on the local topographic effect and considers the dynamic interactions between reef seabed and reef seawater in the first category the localized coral sand site is selected as the research object and its mechanical characteristics are comprehensively investigated through field observations laboratory tests and numerical simulations these characteristics include the topography and landform of the reef island meng et al 2014 shan et al 2000 the material properties of the coral soils sun and lu 1999 wang et al 2011 zhu et al 2016 2014 the seismic amplification effect of the coral sand layer chen et al 2019 hu et al 2017 2018 and the stability of the shallow reef strata guo et al 2017 tang et al 2018 this kind of research is important for further understanding the dynamic behavior of the coral sand layer however since the interaction between the reef and the seawater as well as the effect of the deep reef topography are usually ignored in the abovementioned studies the seismic wave propagation process in the reef seabed seawater system cannot be considered in addition the seismic excitations on different locations of the sand layer are assumed to be uniform which may be insufficient in describing the actual ground motions in fact the seismic ground motions of the reef engineering site which is essentially a specific raised local site are significantly influenced by its topography and the wave radiation effect of the unbounded foundation and present strong spatial variations this opinion has been verified by a considerable number of seismic analyses of similar hill like or slope platform local topographies but on land sites ashford et al 1997 liu et al 2010 poursartip et al 2017 sanchez sesma 1987 zhang et al 2018 however unlike the traditional land engineering sites the coupling effect of the seawater plays an important role in the seismic analysis of reef engineering sites the seismic analysis model for the reef seawater system previously developed by our research team liu et al 2019b takes these factors into consideration a near field model intercepted from the open reef seawater system is selected as the research object the coupling effect of the reef and the seawater is simulated by the fluid solid interaction algorithm bao and liu 2017 the viscous elastic boundary liu et al 2006 for the solid domain and the fluid artificial boundary liu et al 2017 are applied on the cutoff boundaries to absorb the outgoing scattered waves and the boundary substructure method bsm liu et al 2019c is adopted to input the seismic waves into the calculation domain through this seismic analysis model the overall wave propagation processes in the reef seawater system can be simulated however the previous works liu et al 2019b only focused on the vertical incidence of sv waves and studied the basic seismic response rules of the reef seawater system in such conditions because of the increasing wave velocities with the depth of geological structures the propagation direction of the seismic waves always has a tendency to bend upward sigaki et al 2000 therefore the vertical incidence of seismic waves is reasonable when the seismic source is far from the reef island however when a shallow focused earthquake occurs near the reef island which may aggravate the earthquake disaster on the reef flat the seismic waves rarely propagate along the vertical direction but are obliquely incident at a certain angle from the view of the physical mechanism the oblique incidence of the seismic wave is the main factor causing the traveling wave effect this effect together with the influences of the coupled seawater and deep reef topography causes strong nonuniform motions on the reef site and significantly threatens the seismic safety of the artificial islands and upper constructions similar phenomena but on land sites have been observed in the 1976 guatemala earthquake the researchers observed that the landslides were concentrated on one side of a ridge but not the other harp et al 1981 and in the 1989 loma prieta earthquake some ridges experienced severe failure while nearby cliffs were less affected ashford and sitar 1997 therefore to advance the understanding of the ground motion field distribution on the reef site and ensure the rationality of the seismic wave input in reef engineering it is necessary to investigate the seismic response of the reef seawater system under the obliquely incident seismic waves in such studies however an important issue that needs to be carefully settled is the seismic wave input in both the fluid and the solid domains which is a relatively new research topic in seismic engineering aimed at obtaining the seismic response of the reef engineering site under the obliquely incident waves an analysis model of the layered reef seawater system is developed with our previous work as a basis liu et al 2019b the theoretical solutions of the corresponding free wave field under the obliquely incident p and sv waves are derived those free wave motions are further converted into the equivalent input seismic loads through the bsm and thus the oblique input of the seismic waves into the reef seawater system can be accomplished based on the presented numerical methods and computational model a series of parametric studies are conducted the ground motion fields on the reef sites are discussed and the effects of several fundamental factors on the seismic response of the reef seawater system including the type and the frequency of the incident wave the incident angle the width of the reef flat and the coupling effect of the seawater are comprehensively studied 2 numerical methods and calculation model the main numerical approaches applied in the seismic analysis model of the reef seawater system is shown in fig 1 a near field model including the reef the seabed and the seawater is intercepted from the semi infinite domain in which the coupling effect of the reef and seawater is considered the artificial boundaries also known as the absorbing boundaries for the fluid and the solid medium is applied on the cutoff boundaries to absorb the scattered waves generated from the calculation region the accuracy and effectiveness of this seismic analysis model has been verified and the case of vertically incident sv waves has been studied previously in this study this seismic analysis model is adopted and modified to accomplish the oblique input of p and sv waves in the following we briefly introduce the techniques related to the numerical modelling of the reef seawater interaction system details on oblique incidence of p and sv waves in the reef seawater model will be introduced in the subsequent section the fluid artificial boundary shown in fig 1 is applied to simulate the wave radiation effect of the infinite seawater layer liu et al 2017 this artificial boundary is decoupled in space and consists of a damper and a lumped mass connected in series under the two dimensional condition the coefficients of the fluid artificial boundary are as follows 1 m 2 ρ f r f σ i a i c ρ f c f σ i a i where m and c are the mass and damping coefficients respectively ρ f denotes the fluid density r f stands for the distance from the source of the scattered wave to the location of the boundary node c f represents the velocity of sound in the fluid medium and i a i is the represented area of the boundary node in the finite element model the consistent viscous spring artificial boundary element for solid medium liu et al 2006 is adopted to absorb the waves scattered from the reef and the seabed which is essentially a layer of finite elements with specified material properties 2 g α t h g r s e α n h g r s 1 γ 1 2 γ 1 γ γ α 2 2 α 1 α 2 0 α 2 η ρ s r s 2 g c s α t c p α n where g e γ and η are the shear modulus young s modulus poisson s ratio and elemental material damping coefficient respectively of the equivalent artificial boundary elements h is the thickness of the artificial boundary element layer r s is the distance from the source of scattered wave to the artificial boundary α n and α t are the coefficients of the viscous spring artificial boundary whose recommended values are 1 and 0 5 respectively liu et al 2006 α α n α t g and ρ s are the shear modulus and mass density respectively of the solid medium and c s and c p are the velocities of sv and p waves respectively in the solid domain the finite element models of the coupled reef seawater system are established based on the general finite element software ansys the seawater is simulated by the displacement formatted fluid80 elements the reef seabed and solid artificial boundary are modeled by solid45 elements and the combin40 spring damping mass elements is adopted to establish the fluid artificial boundaries additionally by coupling the normal degree of freedoms of the coincident nodes in the interface the fluid soil interaction can be simulated in this study we adopted the three layered reef seawater model proposed in liu et al 2019b as shown in fig 2 where l is the width of the reef flat l f is the minimum width of the near field seawater domain h s is the thickness of the near field seabed domain along the vertical direction y axis h and θ represent the thickness and the slope gradient of each reef layer respectively and the subscripts 1 2 and 3 denote the layer 1 layer 2 and layer 3 of the reef model respectively the topographic and material characteristics of the reef layers are determined according to the literatures meng et al 2014 shan et al 2000 sun and lu 1999 these parameters together with the dimensions of the near field reef seawater model and the mesh size information in the finite element model which will be introduced in the following section are shown in table 1 as for the seawater the mass density ρ f and velocity of sound c f are 1025 kg m 3 and 1450 m s 1 respectively it is important to emphasize that the coral sand layers on the reefs in the south china sea are relatively shallow compared to the entire reef model meng et al 2014 considering that the main focus of this study is the wave propagation in the reef seawater system and the distribution of the ground motion field on the reef rock site the influence of the overlying sand layer on the ground motion field of the reef rock site is neglected in this study furthermore as mentioned above specialized research on the seismic response of the coral sand layer has been conducted but the seismic excitations are assumed to be uniform chen et al 2019 hu et al 2018 2017 the results on the ground motion field of the reef rock site in this study can be further applied as the seismic excitations of the coral sand layers in this way the spatial distribution of the seismic wave can be considered and the seismic analysis of the coral sand layer can be more practical and reasonable 3 seismic wave input method the seismic analysis of the near field reef seawater model is an external source problem which means that the excitation sources are outside the calculation domain for such problems challenges appear when inputting the seismic waves into the near field model without affecting the absorption of the scattered waves by the artificial boundaries current methods bao et al 2019 bielak et al 2003 liu et al 2019a generally divide the wave field in the calculation model into two parts according to the principle of wave superposition the free wave field motions of the free field model which is a background geological model without the local topographies and the scattered waves caused by the interactions between the incident waves and the local topographies then the free wave field motions can be converted into the equivalent seismic loads through different numerical algorithms and the earthquake energy can be input into the calculation domain by applying the equivalent seismic loads on the boundary nodes while the scattered waves caused by the wave topography interaction are absorbed by the artificial boundaries 3 1 boundary substructure method in this study the bsm is adopted to input the p and sv waves with arbitrary incident angles into the reef seawater model according to bsm the nodes of the reef seawater model and the corresponding free field model which is a half space model with an overlying seawater layer see fig 3 a can be classified into three types the boundary nodes denote as b the nodes adjacent to the boundary nodes denote as n and the internal nodes denote as i then the equivalent input seismic loads on the boundary nodes f b can be solved as following liu et al 2019c 3 f b m bn u n 0 m bb u b 0 c bn u n 0 c bb u b 0 k bn u n 0 k bb u b 0 where m c and k represent the mass damping and stiffness matrices of the finite element model of reef seawater system respectively u 0 u 0 and u 0 are the vectors of the displacement velocity and acceleration of the free wave field motions and the subscripts b and n denote the abovementioned nodal classification it has been demonstrated that eq 3 can be equivalent to the motion equation of the substructure of artificial boundaries which is form by the artificial boundaries and a layer of elements between nodes b and n as shown in fig 3b liu et al 2019c therefore the incident seismic waves can be transformed into the equivalent input seismic loads through the dynamic analysis of the substructure of artificial boundaries under the imposed free wave field motions different from the previous study of vertical incidence of sv waves where the free wave field motions vanish in the fluid domain and the calculation of the equivalent seismic loads does not involve the seawater layer in the case of oblique incidences of the p and sv waves there are complex wave transmissions and reflections at the fluid soil coupling interface and the free wave field exists in the entire calculation domain therefore it is necessary to consider the seismic wave input in the seawater layer which involves two main issues needing to be settled calculating the free wave field corresponding to the reef seawater model under the oblique incidence of seismic waves and converting the free wave field motions into the equivalent input seismic loads on both the fluid and solid artificial boundaries the detailed derivation of the corresponding free wave field under the obliquely incident p and sv waves will be presented in the subsequent subsection here we assume that the free wave field motions are already known and then use them to calculate the equivalent input seismic loads through the bsm the implementation processes of the bsm are provided as follows 1 establish the boundary substructure model corresponding to the reef seawater system as shown in fig 3b this procedure can be accomplished by two means i establishing the finite element model of the reef seawater system and then deleting all elements except the artificial boundary elements and one layer of fluid and solid elements adjacent to the artificial boundaries and ii directly establishing the boundary substructure shown in fig 3b it is important to note that in means ii the element sizes the node positions and the material properties need to be completely identical with those of the reef seawater model but it will not bother in means i since the substructures are directly intercepted from the original reef seawater model 2 impose the free wave field motions on each node of the boundary substructure model and conduct a dynamic analysis of the substructure the equivalent input seismic loads can be obtained which are exactly the reaction forces on the artificial boundary nodes notably under the oblique incidence of the seismic waves the free wave field motions and the equivalent input seismic loads vary on different nodes therefore the data management in this procedure requires extra caution and developing a subprogram for data processing is recommended 3 apply the equivalent input seismic loads obtained from the previous step on the corresponding artificial boundary nodes of the reef seawater model as shown in fig 3c then the seismic response of the reef site can be obtained through the dynamic simulation in addition it is important to emphasize that the seismic wave input method for the ocean engineering site provide in this study is applicable not only to the reef seawater system but also to the seismic analysis of other ocean engineering such as breakwaters zhao et al 2019 2020 deep water piers wang et al 2019 and offshore platforms park et al 2011 where the interaction between the seabed the structure and the seawater need to be considered 3 2 free wave field analysis 3 2 1 nomenclature u displacement a amplitude of the displacement potential function t time ω circular frequency σ τ normal stress and shear stress h thickness of the fluid layer p hydrodynamic pressure i imaginary unit λ μ lame constant subscripts 1 and 2 solid medium and fluid medium ρ density subscripts x and y horizontal direction and vertical direction cp cs velocities of p and sv waves superscripts p and s p wave and sv wave θ angle between the wave propagation direction and the normal direction of the interface superscripts i r and t incident wave reflected wave and transmitted wave ϕ ψ displacement potential functions of p and sv waves in this section the free wave field motions of the free field model under the oblique incidence of p and sv waves are derived on that basis through the bsm introduced in the previous section the obliquely incident seismic waves can be input into the reef seawater model the corresponding free field model of the reef seawater system is a half space model with an overlying seawater layer as shown in fig 4 in the solid domain of the free field model the relationship between the stress and the displacement is given by hooke s law 4 σ 1 x λ u 1 x x u 1 y y 2 μ u 1 x x σ 1 y λ u 1 x x u 1 y y 2 μ u 1 y y τ 1 x y τ 1 y x μ u 1 x y u 1 y x in the nonviscous and compressible fluid domain the motion equations and the formula of hydrodynamic pressure can be expressed as follows 5 2 u 2 x t 2 c 2 p 2 2 u 2 x x 2 2 u 2 y x y 2 u 2 y t 2 c 2 p 2 2 u 2 x x y 2 u 2 y y 2 p 2 ρ 2 c 2 p 2 u 2 x x u 2 y y to calculate the free wave field motions the following four boundary conditions should be met in the free field model 1 continuity of the normal displacement at the interface 6 u 1 y u 2 y y 0 2 equilibrium of the normal stress at the interface 7 σ 1 y p 2 0 y 0 3 zero tangential stress at the interface 8 τ 1 x y 0 y 0 4 zero hydrodynamic pressure at the free surface of fluid 9 p 2 0 y h based on the above control equations and boundary conditions the analytical solutions of the free wave field motions under the obliquely incident p and sv waves can be derived separately in the following 3 2 2 obliquely incident p wave the wave structure of the free field under the oblique incidence of a p wave is shown in fig 4a the components of the wave field can be separated into five parts the incident p wave u 1 ip the downgoing p and sv waves in the solid domain generated from the interface u 1 rp and u 1 rs the upgoing p waves in the fluid domain generated from the interface u 2 tp and the downgoing p waves in the fluid domain generated from the free surface u 2 rp according to this wave field separation the displacements of the free field model under the obliquely incident p wave can be expressed as follows 10 u 1 x u 1 x ip u 1 x rp u 1 x rs u 1 y u 1 y ip u 1 y rp u 1 y rs u 2 x u 2 x tp u 2 x rp u 2 y u 2 y tp u 2 y rp then we introduce the displacement potential functions ϕ and ψ of p and sv waves respectively frasier 2002 namely u x p φ x u y p φ y u x s ψ y u y s ψ x the steady state solutions of the potential functions corresponding to each free wave field component can be obtained through the method of separation of variables 11 φ 1 ip a 1 ip exp i ω sin θ 1 ip c 1 p x cos θ 1 ip c 1 p y t φ 1 rp a 1 rp exp i ω sin θ 1 rp c 1 p x cos θ 1 rp c 1 p y t ψ 1 rs a 1 rs exp i ω sin θ 1 rs c 1 s x cos θ 1 rs c 1 s y t φ 2 tp a 2 tp exp i ω sin θ 2 tp c 2 p x cos θ 2 tp c 2 p y t φ 2 rp a 2 rp exp i ω sin θ 2 rp c 2 p x cos θ 2 rp c 2 p y t according to snell s law the following equation can be obtained 12 sin θ 1 ip c 1 p sin θ 1 rp c 1 p sin θ 1 rs c 1 s sin θ 2 tp c 2 p sin θ 2 rp c 2 p given the incident angle of the input seismic p wave θ 1 ip the angle between the propagation direction of each wave component and the normal direction of the interface can be obtained through eq 12 additionally when the time history of the incident p wave u ip t is known here u ip t is supposed as the incident wave at the origin of the coordinate namely x y 0 the corresponding fourier amplitude spectrum u ip ω can be gained through the fourier transform and then the amplitude of the displacement potential function of the incident p wave a 1 ip can be obtained through eq 11 13 a 1 ip u ip ω c 1 p i ω by substituting eqs 4 5 and 11 into eqs 6 9 the following equations can be obtained 14 cos θ 1 ip c 1 p a 1 ip cos θ 1 rp c 1 p a 1 rp sin θ 1 rs c 1 s a 1 rs cos θ 2 tp c 2 p a 2 t p cos θ 2 rp c 2 p a 2 rp 15 λ 2 μ cos 2 θ 1 ip c 1 p 2 a 1 ip a 1 rp 2 μ cos θ 1 rs sin θ 1 is c 1 s 2 a 1 rs ρ 2 a 2 tp a 2 rp 16 2 cos θ 1 ip sin θ 1 ip c 1 p 2 a 1 ip a 1 rp cos 2 θ 1 rs sin 2 θ 1 is c 1 s 2 a 1 rs 0 17 exp i ω cos θ 2 tp h c 2 p a 2 tp exp i ω cos θ 2 tp h c 2 p a 2 rp 0 combining eqs 14 17 and solving the equations gives the following 18 a 1 rp a 1 ip 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip a 1 rs a 1 ip 2 1 d 2 λ μ μ cos 2 θ 1 ip sin 2 θ 1 ip cos θ 2 tp 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip c 1 s 2 c 1 p 2 a 2 tp a 1 ip 2 d 2 λ μ μ cos 2 θ 1 ip cos θ 1 ip 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip c 2 p c 1 p a 2 rp a 1 ip 2 λ μ μ cos 2 θ 1 ip cos θ 1 ip 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip c 2 p c 1 p where d exp i ω cos θ 2 tp h c 2 p by substituting eqs 11 and 18 into eq 10 the steady state solution of the free wave field can be obtained which can be further converted into the solution in the frequency domain by eliminating the time factor exp iωt then the transient solution in the time domain can be gained through fourier inverse transform 3 2 3 obliquely incident sv wave under the obliquely incident sv wave the wave structure of the free field model is shown in fig 4b and it can be separated into the incident sv wave u 1 is the downgoing sv and p waves in the solid domain generated from the interface u 1 rs and u 1 rp the upgoing p waves in the fluid domain generated from the interface u 2 tp and the downgoing p waves in the fluid domain generated from the free surface u 2 rp according to this wave field separation the displacement of the free field model can be expressed as follows 19 u 1 x u 1 x is u 1 x rs u 1 x rp u 1 y u 1 y is u 1 y rs u 1 y rp u 2 x u 2 x tp u 2 x rp u 2 y u 2 y tp u 2 y rp similar to the case of the incident p wave the steady state potential function of each wave component can be obtained through the method of the separation of variables where the formulas of φ 1 rp ψ 1 rs φ 2 tp and φ 2 rp are all identical to eq 11 and the steady state solution of the incident sv wave can be expressed as follows 20 ψ 1 is a 1 is exp i ω sin θ 1 is c 1 s x cos θ 1 is c 1 s y t similarly snell s law should be met under the obliquely incident sv wave 21 sin θ 1 is c 1 s sin θ 1 rs c 1 s sin θ 1 rp c 1 p sin θ 2 tp c 2 p sin θ 2 rp c 2 p given the incident angle of the input seismic sv wave θ 1 is the angle between the propagation direction of each wave component and the normal direction of the interface can be obtained through eq 21 additionally following the similar procedure of the p wave case the amplitude of the displacement potential function of the incident sv wave a 1 is can be gained as follows 22 a 1 is u is ω c 1 s i ω where u is ω is the fourier amplitude spectrum of the incident sv wave by substituting eqs 4 5 11 and 20 into eqs 6 9 the following equations can be obtained 23 sin θ 1 is c 1 s a 1 is sin θ 1 rs c 1 s a 1 rs cos θ 1 rp c 1 p a 1 rp cos θ 2 tp c 2 p a 2 tp cos θ 2 rp c 2 p a 2 rp 24 λ 2 μ cos 2 θ 1 rp c 1 p 2 a 1 rp 2 μ cos θ 1 is sin θ 1 is a 1 is cos θ 1 rs sin θ 1 rs a 1 rs c 1 s 2 ρ 2 a 2 tp a 2 rp 25 2 cos θ 1 rp sin θ 1 rp c 1 p 2 a 1 rp cos 2 θ 1 is sin 2 θ 1 is c 1 s 2 a 1 is cos 2 θ 1 rs sin 2 θ 1 rs c 1 s 2 a 1 rs 0 26 exp i ω cos θ 2 tp h c 2 p a 2 tp exp i ω cos θ 2 tp h c 2 p a 2 rp 0 combining eqs 23 26 and solving the equations give the following 27 a 1 rs a 1 is 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp a 1 rp a 1 is 1 d 2 μ sin 4 θ 1 is cos θ 2 tp 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp c 1 p 2 c 1 s 2 a 2 tp a 1 is 2 d 2 μ sin 2 θ 1 is cos θ 1 rp 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp c 1 p c 2 p c 1 s 2 a 2 rp a 1 is 2 μ sin 2 θ 1 is cos θ 1 rp 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp c 1 p c 2 p c 1 s 2 by substituting eqs 11 20 and 27 into eq 19 the steady state solution of the free wave field under the obliquely incident sv wave can be obtained then the transient solution in the time domain can be gained through a fourier inversion 3 3 incident seismic waves a pulse wave with a pulse duration of 0 2 s and the three time histories of actual seismic accelerations recorded in the chichi earthquake the imperial valley earthquake and the loma prieta earthquake are selected as the amplitudes of the incident seismic waves the time history and fourier amplitude spectra of the incident waves are shown in fig 5 these seismic waves are input into the reef seawater model in the form of p and sv waves at different incident angles through the bsm 3 4 verification in the previous research liu et al 2019b we have validated the accuracy and effectiveness of the key numerical techniques involved in the seismic analysis model of the reef seawater system including the fluid artificial boundary and the integrated reef seawater finite element model besides the precision of the dynamic finite element method fem can be guaranteed when the mesh size δ meet the following condition jeremi et al 2009 28 δ c s 10 f c u t where c s is the velocity of sv wave in the media and f cut is the cutoff frequency the cutoff frequency are designated as 20 hz in this study which contains the main frequency components of the selected seismic waves shown in fig 5 then the maximum mesh sizes of different parts in the finite element model can be determined according to eq 28 as shown in table 1 considering that one of the most significant development in this study is that we modified the seismic wave input method to accomplish the oblique incidence of p and sv waves whose accuracy however remains to be verified as mentioned above the process of seismic wave input through bsm is independent from the interaction between the incident waves and the local topographies it is only related to the background free field model to verify the accuracy of the modified seismic wave input method without the influence of the wave topography interaction in this section the obliquely incident seismic wave is input into the free field model through bsm and the results of the internal computational domain are compared to the corresponding theoretical solutions obtained through eqs 10 11 and 18 a two dimensional calculation model shown in fig 6 is established it is a near field half space model with an overlying water layer the length of the model is 1400 m and the thicknesses of the water layer and the seabed are both 600 m points a and b are the midpoints of the free surface of water layer and the interface of seawater and seabed respectively the material properties of the seabed are as follows mass density ρ 2700 kg m 3 velocity of sv wave v s 1800 m s 1 and velocity of p wave v p 4500 m s 1 the material properties of the seawater are identical with those of the reef seawater model established in section 2 the pulse p wave shown in fig 5 is input into the model with the incident angle of 45 the displacements on points a and b calculated through the bsm is shown in fig 7 it can be seen that the numerical results provide nice agreement with the theoretical solutions fig 8 shows the snapshots of the displacement wave field in the numerical model where the wave fronts of the incident reflected and transmitted waves can be clearly observed consequently the effectiveness and accuracy of the modified seismic wave input method in the coupled seabed seawater site can be validated furthermore this method can precisely input the obliquely incident seismic waves into the reef seawater model since the process of the seismic wave input is independent from the local reef topographies according to the above verification together with the previous validated reef seawater fem model the effectiveness of the entire seismic analysis model of the reef seawater system under the obliquely incident seismic waves can be verified 4 seismic analysis of the reef seawater system under the obliquely incident p wave based on the free wave field derived in the previous section and the seismic analysis model of the reef seawater system in this section we will investigate the seismic response of the reef seawater system under the obliquely incident p waves the seismic waves shown in fig 5 are input into the calculation model in form of the p waves through bsm with the incident angles of 0 15 30 45 60 and 75 the distributions of the ground motion fields on the reef flat are analyzed and the effects of some fundamental factors including the incident angle the frequency of the incident wave the width of the reef flat and the coupling effect of the seawater on the seismic response of the reef site are investigated 4 1 wave propagation the displacement waveforms on the reef flat 400 m x 400 m and the nearby reef slopes 800 m x 400 m and 400 m x 800 m under the pulse p wave incident at 0 30 and 60 are shown in fig 9 where the horizontal axis is time and the vertical axis is the x coordinates of different locations with the midpoint of the reef flat as the origin because the seismic waves propagate through the multilayered reef structure their propagation processes are affected by the reef topography and the dynamic coupling effect of the seawater the simulated waveforms including the incident waves the reflected waves from the free surface the transmitted and reflected waves from the interfaces and the surface waves appear successively resulting in the longer durations of the ground motions and the complicated waveforms on the reef flat when the seismic p wave is vertically incident the ground motions on the reef flat are mainly controlled by the first arriving p wave the peak vertical displacements as well as their arrival times are relatively coincident with each other along the reef flat however due to the layered structure of the reef and the slope topography the seismic waves propagate back and forth in the top low velocity layer resulting in the complex subsequent waveforms on the slope areas however the waveforms are mainly composed of the incident waves and the primary reflected waves which propagate upward and downward along the slopes respectively when the pulse p wave is obliquely incident however there are significant nonuniform motions on the reef flat due to the time lag effect of the wave propagation the peak vertical displacements are still controlled by the first arriving p wave but with the increasing in the incident angle the peak vertical displacements tend to decrease while in the horizontal direction the largest seismic response appears at the incident angle of 30 and the peak horizontal displacement near the edge of the reef flat is larger than that in the central area fig 10 shows the snapshots of the reef seawater system under the pulse p wave incident at 0 30 and 60 it can be seen that when the incident p waves propagate through the reef topography and the fluid solid interfaces various reflected and scattered waves are generated and their wave fronts overlap with each other resulting in the complicated wave field in the reef seawater system when the pulse p wave is vertically incident the wave field is symmetrically distributed on account of the geometric symmetry of the reef seawater model when the incident waves arrive at the slope areas the reflected p and sv waves are generated due to the nonzero angle between the wave incident direction and the normal direction of the slope afterwards with the further superposition of the scattered waves generated by different interfaces a cylindrical scattered wave is generated beneath the reef and diffuses downward to the seabed for the cases of obliquely incident p waves the seismic waves are input from the bottom left of the model and propagate from the upstream side to the downstream side of the reef the symmetry of the wave field disappears and the time lag effect is significant in the early stage of the seismic response the wave field in the reef and the seabed is mainly composed of the incident p waves and the reflected p and sv waves and their wave fronts are clearly visible as time passes complex scattered waves are generated due to the effects of the topography and the coupled seawater those scattered waves propagate outward and are eventually absorbed by the artificial boundaries notably due to the difference in the wave velocities between the seawater and the seabed the seismic waves are reflected back and forth in the seawater layer and their amplitudes decay slowly 4 2 effect of incident angle it is well known that the elastic homogeneous half space is one of the most simple and common used model in the site seismic analysis under the vertically incident seismic waves the amplitude of earthquake response on the surface of a homogeneous half space is exactly twice the incident waves and this characteristic is unaffected by the material conditions to evaluate the seismic amplification effect of the reef sites we defined the peak displacement velocity and acceleration ratios ru rv and ra with the seismic response of the elastic homogeneous half space as a basis 29 r u x x max u x x t max u 0 t r u y x max u y x t max u 0 t r v x x max v x x t max v 0 t r v y x max v y x t max v 0 t r a x x max a x x t max a 0 t r a y x max a y x t max a 0 t where u v and a are the displacement velocity and acceleration the variables x is the horizontal coordinate of different locations on the reef flat t is the time the subscripts x and y denote the horizontal and vertical directions respectively and the subscript 0 denotes the vertical seismic response on the surface of a homogeneous half space under the same seismic p wave incident vertically because that the artificial island and other upper constructions are basically located on the reef flat of the reef island the seismic response of the reef flat is the key area of concern in this study in the following we focus on the earthquake amplification effect of the reef flat l 2 x l 2 and discuss the influences of different factors figs 11 and 12 show the spatial distributions of ru rv and ra on the reef flat under the seismic p waves incident at different angles with the normalized parameter x l as the horizontal coordinate in the horizontal direction ru x rv x and ra x increase first and then decrease with the increase in the incident angle the least favorable incident angles for ru x and rv x are between 45 60 and 30 60 respectively and the maximum ra x usually appears at the incident angle of 30 for the spatial distribution of the ground motion field when the seismic p waves are obliquely incident the ru x and rv x on the reef flat generally increase from the upstream left hand side to the downstream right hand side while the horizontal ra decreases first and then increases along the reef flat in addition as the incident angle increases the spatial distributions of the ru x rv x and ra x become smoother in the vertical direction ru y rv y and ra y significantly decrease with the increasing of the incident angle which means that the vertical incidence is the least favorable case for a vertical seismic response under the p wave in addition ru y rv y and ra y are generally larger than 1 when the seismic waves incident at a small angle and this phenomenon is more pronounced for the pulse wave and the loma prieta wave from the wave propagation perspective on account of the layered reef structure and the slope topography the seismic waves are reflected repeatedly in the top low velocity layer and their amplitudes get amplified resulting in the larger seismic responses compared to those of the homogeneous half space model in terms of the spatial distribution regularities ru y and rv y distribute smoothly along the reef flat for ra y when the seismic p wave is incident at a small angle ra y rapidly decreases first and then slowly increases along the reef flat with the increase in the incident angle the distribution of ra y tends to be flatter 4 3 effect of frequency the peak ground acceleration pga is the key parameter for the site seismic evaluation and the structural seismic design in the following we analyze the seismic amplification effect of the reef flat with respect to the acceleration response to investigate the effect of the frequency component on the seismic response of the reef seawater system we define the acceleration fourier spectrum ratio ha as follows similarly the site seismic response of the homogeneous half space model is taken as a basis 30 h a x x f f x x f f 0 f h a y x f f y x f f 0 f where f is the frequency f x x f and f y x f are the fourier amplitudes of the horizontal and vertical accelerations on the reef flat respectively f 0 f is the fourier amplitude of the acceleration response on the surface of the homogeneous half space under the same seismic p wave incident vertically which is also equal to twice the fourier amplitude of the incident wave in addition it is important to emphasize that the acceleration fourier spectrum ratio ha measures the amplification effect of the reef model on each frequency component it is independent with the incident waves and is only determined by the dynamic characteristics of the reef seawater model the spatial distributions of ha x and ha y under the seismic p waves incident at different angles are plotted in three dimensional images shown in figs 13 and 14 with the normalized parameter x l and the frequency f as the horizontal coordinates in the horizontal direction the components of ha x are mainly distributed in the frequency band below 8 hz see fig 13 indicating that if the main frequency components of the incident waves are within this frequency band the seismic response on the reef flat gets larger meanwhile with the increase of the incident angle ha x increases first and then decreases it get largest when θ 1 ip 30 and the maximum value can reach up to 2 5 appear in the area near the middle and the downstream side of the reef flat while in the vertical direction as shown in fig 14 ha y tends to decrease first and then increase slowly with the increase of the frequency the spatial distribution of ha y however is relatively smooth this phenomenon is consistent with the distribution regularities of the peak acceleration ratio ra y in fig 12 when f 1 hz ha y is relatively large especially when the incident angles are relatively small indicating that the amplification effect is significant in this frequency band meanwhile according to the fourier amplitude spectra of the incident seismic waves shown in fig 5 the low frequency components the pulse wave and the loma prieta wave are relatively greater than those of the chichi wave and the imperial valley wave therefore the amplification effect on the vertical seismic response under the pulse wave and the loma prieta wave is more pronounced than those of the other two waves as observed in fig 12 in order to further explore the relationship between the nature frequencies of the reef model and the seismic response in the time domain and the frequency domain we conduct a modal analysis of the reef seawater system because the reef seawater system is a continuum model there are infinite number of natural frequencies theoretically we only present the natural frequencies below 10 hz and the corresponding modes of the reef structure as shown in table 2 it can be seen from table 2 that the first two modes are the global modes corresponding to the horizontal and vertical deformations respectively while the other modes are almost all partial modes of the reef layer 1 and 2 the distribution of partial modes corresponding to the horizontal motions of the reef flat concentrates in the frequency band between 1 and 8 hz which is consistent with the distribution of the horizontal acceleration fourier spectrum ratio ha x shown in fig 13 with the increase of the natural frequency the number of partial modes corresponding to the vertical motions tends to increase indicating that the high frequency loads are more likely to excite the vertical motions of the reef flat similar regularity can also be found in the distribution of the vertical acceleration fourier spectrum ratio ha y shown in fig 14 in addition from the perspective of modal analysis under the incidences of the pulse wave and the loma prieta wave whose low frequency components are larger than those of the chichi wave and the imperial valley wave the vertical global mode with frequency of 0 51 hz are more easily excited leading to larger vertical seismic response in time domain as shown in fig 12 4 4 effect of the reef flat s width it is well known that most of the offshore reefs in the south china sea are of elongated and elliptical shapes on account of the influences of ocean currents zhan et al 1995 thus the widths of the two dimensional models vary in different interception locations to obtain a more comprehensive understanding of the seismic response over the entire reef site it is necessary to investigate the influence of the width of reef flat l on the site seismic response here all the parameters in table 1 remain constant except that the widths of reef flat l are changed to 500 m and 1000 m respectively the seismic p waves are obliquely input in each case and the spatial distributions of ra on the reef flat are calculated and plotted in figs 15 and 16 notably because of the similarity in the influence regularities under the three actual seismic records we only present the representative results under the incidence of the chichi wave and the pulse wave here for brevity when the seismic p waves are incident at different angles the influence of the reef flat s width l on the vertical seismic response is limited while in the horizontal direction the site seismic response increases with the decrease in the reef flat s width l when θ 1 ip 15 and when θ 1 ip 30 this trend keeps near the upstream side but appears in opposite direction near the downstream side additionally in most cases the horizontal ra near the upstream side is smaller than that near the downstream side however when the width of reef flat l is relatively small l 500 m and the seismic p wave is incident at a large angle θ 1 ip 60 the contrary phenomenon appears and the horizontal seismic response near the upstream side tends to be larger 4 5 effect of seawater next we investigate the impact of the coupled seawater on the seismic response of the reef site by deleting all the fluid elements and the fluid artificial boundaries from the reef seawater model the corresponding sloping platform model without the consideration of seawater can be established the spatial distributions of ra calculated by the models with and without the consideration of seawater under the seismic p waves incident at different angles are compared in figs 17 and 18 in table 3 we compare the average peak acceleration ratios along the reef flat calculated by the reef seawater model r a and the sloping platform mode r a s p and then calculate the average and the maximum relative deviations of the peak acceleration ratios between these two models δ and δ max where the relative deviation δ is defined as follows 31 δ r a s p r a r a in the horizontal direction when the incident angle is less than 60 the acceleration response of the reef site is smaller than that of the corresponding sloping platform model and the average deviation δ increases significantly with the decrease in the incident angle specifically under the vertical incident p waves the average deviation δ is about 50 and the maximum deviation δ max can reach up to 70 when the seismic wave is incident at a large angle θ 1 ip 60 the relative deviations become relatively small and the site seismic response of the reef seawater model tends to be larger than that of the sloping platform model in the vertical direction from an overall perspective the spatial distributions of ra calculated by the reef seawater system are smoother and larger than those calculated by the sloping platform model especially around the edge of the reef flat and the relative deviation between these two models increase with the incident angle when the seismic p wave is incident at 75 the average relative deviation δ is approximately 10 and the maximum relative deviation δ max can reach up to 20 in local areas such as the middle of the reef site however the seismic response of the sloping platform site can be larger than that of the reef site 5 seismic analysis of the reef seawater system under the obliquely incident sv wave in this section we study the seismic response of the reef seawater system under incident sv waves it is important to note that there is a limiting angle θ lim is for the vertically layered site seismic analysis under the incident sv wave when the incident angle θ 1 is is larger than the limiting angle θ lim is the wave field no longer satisfies the plane wave hypothesis and snell s law is not applicable the value of the limiting angle can be obtained through eq 21 with θ 1 rp 1 under the parameters adopted in this study its value is 26 1 the seismic sv waves shown in fig 5 are incident into the reef seawater system at 0 5 10 15 20 and 25 similarly the distributions of the ground motion fields are discussed and the impacts of several fundamental factors on the seismic response are investigated 5 1 wave propagation fig 19 shows the displacement waveforms on the reef flat 400 m x 400 m and the nearby reef slopes 800 m x 400 m and 400 m x 800 m under the pulse sv waves incident at 0 10 and 20 a comparison of figs 9 and 19 shows that the waveforms on the reef flat under the incident sv wave are more complex than those under the incident p wave the incident sv waves interact with the reef topography and the layered reef structure resulting in the obvious scattered waves and surface waves propagating along the reef flat consequently the subsequent waves decay slower and the durations of the ground motions get much longer by contrast the waveforms on the slope areas are relatively simple and primarily consist of the incident sv waves and the reflected waves with very small amplitudes indicating that the seismic energy is concentrated in the top low velocity layer of the reef which is consistent with the phenomena of the large amplitude and long duration of the seismic response on the reef flat in addition when the seismic waves are obliquely incident there are obvious nonuniform motions on the reef flat and the amplitude of the seismic response tends to increase from the upstream side to the downstream side the snapshots of the reef seawater system under the pulse sv wave incident at 0 10 and 20 are shown in fig 20 similar to the case of the incident pulse p wave see fig 10 complicated reflected and scattered waves are generated when the waves propagate through the reef topography and the fluid solid interfaces however under the incident of the sv wave the relative incident angle the angle between the wave propagation direction and the normal direction of the slope can more easily exceed the limiting angle θ lim is generating the propagation of the surface waves along the slopes and further amplifying the seismic response on the reef site in addition new wave sources are generated at the junctions of the reef and seabed which produce cylindrical scattered waves propagating into the water domain as time goes by the outgoing scattered waves in the solid and fluid domains are all effectively absorbed by the corresponding artificial boundaries 5 2 effect of incident angle similar to the cases of incident p waves we measure the site seismic response under the incident sv wave with respect to the peak displacement velocity and acceleration ratios ru rv and ra defined by eq 28 but here the subscript 0 denotes the horizontal seismic response of the homogeneous half space model under the vertically incident sv wave the spatial distributions of ru rv and ra are plotted in figs 21 and 22 in the horizontal direction ru x rv x and ra x all tend to decrease with the increase in the incident angle however when the incident angle is relatively small θ 1 is 15 in the middle area and the area near the downstream side the rv x and ra x are greater than those under the vertical incident sv wave for the spatial distribution when the seismic sv waves are obliquely incident the ru x increases along the reef flat from the upstream side to the downstream side the rv x and ra x slightly increase first then decrease finally increasing rapidly near the downstream side in addition the spatial distribution of the seismic response present different regularities under the different seismic waves in general under the incident pulse wave the ground motion changes violently near the edge of the reef flat and the maximum seismic response tends to appear in this region while in the middle area the peak seismic response is relatively small and is distributed smoothly by contrast under the actual seismic records the spatial distributions of the site motions are more complex in addition to the edge of the reef flat the maximum seismic response also tends to occur in the middle area and with the increase in the incident angle the position of this maximum seismic response moves towards the downstream side notably the ru x rv x and ra x on almost all of the reef flat are greater than 1 and rv x and ra x can even reach up to 4 near the midpoint and the edge of the reef flat indicating that the seismic response of the reef site is significantly amplified compared to that of the homogeneous half space model in the vertical direction however the spatial distributions of ru y rv y and ra y are all relatively flat basically between 0 5 and 1 with the increase of the incident angle the ru y and rv y tend to increase while the ra y tends to decrease 5 3 effect of frequency figs 23 and 24 shows the spatial distributions of the horizontal and vertical acceleration fourier spectrum ratio ha under the seismic sv waves incident at different angles the ha x is mainly distributed in the frequency bands below 8 hz which is consistent with the distribution of the natural frequencies corresponding to the horizontal modes see table 2 the maximum ha x appears near the edge of the reef flat and its value can reach up to 7 5 under the small incident angles the ha x decreases pronouncedly when f 8 hz indicating that the horizontal site seismic response is less sensitive to the high frequency components of the incident sv waves in addition the ha x decreases with the increase in the incident angle and this trend is especially evident in the area near the upstream side of the reef flat when 4 hz f 8 hz in the vertical direction the ha y is mainly distributed in the frequency bands between 2 hz and 12 hz and its maximum value is less than 2 5 which usually occurs between the midpoint and the edge of the reef flat as the incident angle increases the ha y tends to decrease from the perspective of modal analysis when the seismic waves shown in fig 5 whose main frequency components are below 10 hz incident at small angles the horizontal global mode with frequency of 0 42 hz as well as the horizontal partial modes distributed between 1 and 8 hz such as the modes with the natural frequencies of 1 59 hz 2 06 hz 6 19 hz 6 62 hz 6 69 hz 6 70 hz 7 10 hz 7 43 hz and 7 66 hz see table 2 are more likely to be excited resulting in significant amplification on the horizontal seismic response on the reef flat as shown in fig 21 5 4 effect of the reef flat s width next the influence of the reef flat s width l on the seismic response of the reef site under the incident sv waves is investigated similarly the width of reef flat l is changed to 500 m and 1000 m respectively with all the other parameters in table 1 constant the seismic sv waves are obliquely input into the reef seawater model and the spatial distributions of ra on the reef flat are calculated and plotted in figs 25 and 26 in the cases of the vertical and oblique incidence of sv waves the width of reef flat l shows different influence rules on the site seismic response for the vertical incidence as the reef flat s width l decreases ra near the edge of the reef flat remains basically unchanged but in the middle area the seismic response is significantly amplified however when the seismic sv waves are obliquely incident the horizontal acceleration response near the upstream side of the reef flat tends to decrease with the decrease of l and this tendency shows in the opposite direction near the downstream side according to the analysis in the preceding part the surface waves and the scattered waves are generated due to the effect of the reef topography and their amplitudes are attenuated with the increase of the propagation distance when the seismic waves are vertically incident the surface and the scattered waves from the both sides reach the middle area at the same time and overlay with each other as the width of reef flat l decreases the attenuation effect of those waves is reduced and their superposition effect is strengthened thus the site seismic response is amplified however when the seismic waves are obliquely incident the arrival times of the waves generated by the slopes on both sides are different due to the time lag effect therefore the superposition effect is limited and the influence of the reef flat s width on the site seismic response is relatively weak 5 5 effect of seawater the effect of the coupled seawater on the site seismic response under the incident sv waves is studied in this subsection the comparison of ra calculated by the reef seawater model and the corresponding sloping platform model is shown in figs 27 and 28 similarly we compare the average ra along the reef flat and calculate the average and the maximum relative deviations δ and δ max between those two different models as shown in table 4 in the horizontal direction when the incident angle is relatively small θ 1 is 10 the acceleration response of the reef site is smaller than that of the corresponding sloping platform model especially in the region near the midpoint and the corner point the average relative deviation δ increases with the decrease in the incident angle when the incident angle is greater than 10 however although the overall site seismic response of the reef seawater model tends to be smaller than that of the sloping platform model in local areas near the upstream side the seismic amplification effect of the reef site is more significant in the vertical direction the seismic response of the reef site is smaller than that of the sloping platform model and the average relative deviations δ are distributed between 20 and 50 the above comparative analyses in the cases of p and sv waves indicate that when the seismic wave is incident at an arbitrary angle the coupling effect of the seawater shows important influence on the seismic response of the reef site this influence is closely related to the type of the incident wave the incident angle and shows different regularities on different locations on the reef flat therefore it is difficult to directly obtain the seismic response of the reef site from the ground motion field of the corresponding sloping platform site for important reef engineering sites it is necessary to conduct a coupled reef seawater dynamic analysis which reflects the practical mechanical characteristics of the system 6 summary and conclusions a theoretical solution of the free wave field corresponding to the reef seawater system under the obliquely incident p and sv waves is derived in this study on that basis the two dimensional seismic analysis model of the reef seawater system proposed in our previous work is further developed to accomplish the oblique input of the seismic wave into the reef seawater model a series of parametric studies are conducted the ground motion fields on the reef sites are discussed and the effects of several fundamental factors on the seismic response of the reef seawater system are comprehensively studied based on the results the following conclusions can be obtained 1 under the obliquely incident seismic wave the wave field presents a strong traveling wave effect resulting in the significant nonuniform motions on the reef flat on account of the layered reef structure the earthquake energy is concentrated in the top low velocity layer which amplifies the seismic ground motion on the reef flat in addition under the incidence of sv waves the relative incident angle can more easily exceed the limiting angle generating the propagation of surface waves along the reef slopes and further amplifying the seismic response of the reef site 2 the incident angle of the seismic wave significantly affects the seismic response of the reef site in the case of an incident p wave the least favorable incident angle for the horizontal site seismic response is 30 and in the vertical direction it is 0 for sv waves the least favorable load case for both the horizontal and vertical site seismic responses is the vertical incidence of the seismic waves in addition the largest horizontal seismic response usually appears near the downstream side of the reef flat under the p and sv waves 3 the horizontal ha under the incident p wave and the horizontal and vertical ha under the incident sv wave are mainly distributed in the frequency band below 12 hz while the vertical ha under the incident p wave increases with the frequency in the range of 0 16 hz furthermore the spatial distribution characteristics of ha in the frequency domain and those of ra in the time domain provide a nice agreement with each other 4 under the vertical incidence of seismic waves with the decrease in the reef flat s width the superposition effect of the scattered waves generated from the both slope sides are strengthened thus the seismic response in the middle area of the reef site gets amplified however in the case of an oblique wave incidence the arrival times of the scattered waves on the middle area of the reef flat are different due to the time lag effect therefore the superposition effect is limited and the influence of the reef flat s width on the site seismic response is relatively weak 5 when the seismic wave is incident at an arbitrary angle the coupling effect of the seawater shows important influence on the seismic response of the reef site and this influence is closely related to the type of the incident wave the incident angle and shows different regularities on different locations of the reef flat for important reef engineering sites it is necessary to conduct a coupled reef seawater dynamic analysis that reflects the practical mechanical characteristics of the system credit author statement xin bao methodology software formal analysis writing original draft jingbo liu conceptualization project administration shutao li validation fei wang formal analysis piguang wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by national natural science foundation of china 51878384 the financial support is highly appreciated 
22031,despite the increasing focus on the seismic safety of reef engineering sites the current studies on this topic are still based on the hypotheses of uniform seismic excitations or the vertical incidence of seismic waves in this study a two dimensional seismic analysis model for the reef seawater system under obliquely incident p and sv waves is developed which considers the fluid soil interaction and the wave radiation effects of the fluid and the solid domain the oblique input of the seismic wave into the reef seawater model is accomplished through the boundary substructure method a series of parametric studies are conducted the ground motion fields on the reef sites are discussed and the effects of several fundamental factors on the seismic response are comprehensively studied the results show that under most circumstances the least favorable load case for the reef site seismic response is the vertical incidence of seismic waves however for the horizontal ground motion of the reef site under the p wave the least favorable incident angle is approximately 30 in addition the largest horizontal seismic response usually appears near the downstream side of the reef flat and the peak velocity and acceleration ratios can reach up to 4 in this area keywords reef seawater obliquely incident seismic wave seismic ground motion seismic wave input artificial boundary 1 introduction reef engineering as represented by the artificial island construction in the south china sea has been developing rapidly in recent years because the ground motion field of the reef island is the basis for the seismic design of the artificial island and its upper constructions the seismic response analysis of reef engineering sites is currently a focused research area in earthquake engineering and ocean engineering generally the reef structure can be geologically divided into two parts the shallow coral sand layer and the deep reef rock layer on that basis the studies on reef islands can be classified into two categories according to their research objectives i geological and geotechnical research on the coral sand which mainly focuses on the nonlinear behavior of the calcareous soils and ii seismological research on the reef rocky structure which focuses on the local topographic effect and considers the dynamic interactions between reef seabed and reef seawater in the first category the localized coral sand site is selected as the research object and its mechanical characteristics are comprehensively investigated through field observations laboratory tests and numerical simulations these characteristics include the topography and landform of the reef island meng et al 2014 shan et al 2000 the material properties of the coral soils sun and lu 1999 wang et al 2011 zhu et al 2016 2014 the seismic amplification effect of the coral sand layer chen et al 2019 hu et al 2017 2018 and the stability of the shallow reef strata guo et al 2017 tang et al 2018 this kind of research is important for further understanding the dynamic behavior of the coral sand layer however since the interaction between the reef and the seawater as well as the effect of the deep reef topography are usually ignored in the abovementioned studies the seismic wave propagation process in the reef seabed seawater system cannot be considered in addition the seismic excitations on different locations of the sand layer are assumed to be uniform which may be insufficient in describing the actual ground motions in fact the seismic ground motions of the reef engineering site which is essentially a specific raised local site are significantly influenced by its topography and the wave radiation effect of the unbounded foundation and present strong spatial variations this opinion has been verified by a considerable number of seismic analyses of similar hill like or slope platform local topographies but on land sites ashford et al 1997 liu et al 2010 poursartip et al 2017 sanchez sesma 1987 zhang et al 2018 however unlike the traditional land engineering sites the coupling effect of the seawater plays an important role in the seismic analysis of reef engineering sites the seismic analysis model for the reef seawater system previously developed by our research team liu et al 2019b takes these factors into consideration a near field model intercepted from the open reef seawater system is selected as the research object the coupling effect of the reef and the seawater is simulated by the fluid solid interaction algorithm bao and liu 2017 the viscous elastic boundary liu et al 2006 for the solid domain and the fluid artificial boundary liu et al 2017 are applied on the cutoff boundaries to absorb the outgoing scattered waves and the boundary substructure method bsm liu et al 2019c is adopted to input the seismic waves into the calculation domain through this seismic analysis model the overall wave propagation processes in the reef seawater system can be simulated however the previous works liu et al 2019b only focused on the vertical incidence of sv waves and studied the basic seismic response rules of the reef seawater system in such conditions because of the increasing wave velocities with the depth of geological structures the propagation direction of the seismic waves always has a tendency to bend upward sigaki et al 2000 therefore the vertical incidence of seismic waves is reasonable when the seismic source is far from the reef island however when a shallow focused earthquake occurs near the reef island which may aggravate the earthquake disaster on the reef flat the seismic waves rarely propagate along the vertical direction but are obliquely incident at a certain angle from the view of the physical mechanism the oblique incidence of the seismic wave is the main factor causing the traveling wave effect this effect together with the influences of the coupled seawater and deep reef topography causes strong nonuniform motions on the reef site and significantly threatens the seismic safety of the artificial islands and upper constructions similar phenomena but on land sites have been observed in the 1976 guatemala earthquake the researchers observed that the landslides were concentrated on one side of a ridge but not the other harp et al 1981 and in the 1989 loma prieta earthquake some ridges experienced severe failure while nearby cliffs were less affected ashford and sitar 1997 therefore to advance the understanding of the ground motion field distribution on the reef site and ensure the rationality of the seismic wave input in reef engineering it is necessary to investigate the seismic response of the reef seawater system under the obliquely incident seismic waves in such studies however an important issue that needs to be carefully settled is the seismic wave input in both the fluid and the solid domains which is a relatively new research topic in seismic engineering aimed at obtaining the seismic response of the reef engineering site under the obliquely incident waves an analysis model of the layered reef seawater system is developed with our previous work as a basis liu et al 2019b the theoretical solutions of the corresponding free wave field under the obliquely incident p and sv waves are derived those free wave motions are further converted into the equivalent input seismic loads through the bsm and thus the oblique input of the seismic waves into the reef seawater system can be accomplished based on the presented numerical methods and computational model a series of parametric studies are conducted the ground motion fields on the reef sites are discussed and the effects of several fundamental factors on the seismic response of the reef seawater system including the type and the frequency of the incident wave the incident angle the width of the reef flat and the coupling effect of the seawater are comprehensively studied 2 numerical methods and calculation model the main numerical approaches applied in the seismic analysis model of the reef seawater system is shown in fig 1 a near field model including the reef the seabed and the seawater is intercepted from the semi infinite domain in which the coupling effect of the reef and seawater is considered the artificial boundaries also known as the absorbing boundaries for the fluid and the solid medium is applied on the cutoff boundaries to absorb the scattered waves generated from the calculation region the accuracy and effectiveness of this seismic analysis model has been verified and the case of vertically incident sv waves has been studied previously in this study this seismic analysis model is adopted and modified to accomplish the oblique input of p and sv waves in the following we briefly introduce the techniques related to the numerical modelling of the reef seawater interaction system details on oblique incidence of p and sv waves in the reef seawater model will be introduced in the subsequent section the fluid artificial boundary shown in fig 1 is applied to simulate the wave radiation effect of the infinite seawater layer liu et al 2017 this artificial boundary is decoupled in space and consists of a damper and a lumped mass connected in series under the two dimensional condition the coefficients of the fluid artificial boundary are as follows 1 m 2 ρ f r f σ i a i c ρ f c f σ i a i where m and c are the mass and damping coefficients respectively ρ f denotes the fluid density r f stands for the distance from the source of the scattered wave to the location of the boundary node c f represents the velocity of sound in the fluid medium and i a i is the represented area of the boundary node in the finite element model the consistent viscous spring artificial boundary element for solid medium liu et al 2006 is adopted to absorb the waves scattered from the reef and the seabed which is essentially a layer of finite elements with specified material properties 2 g α t h g r s e α n h g r s 1 γ 1 2 γ 1 γ γ α 2 2 α 1 α 2 0 α 2 η ρ s r s 2 g c s α t c p α n where g e γ and η are the shear modulus young s modulus poisson s ratio and elemental material damping coefficient respectively of the equivalent artificial boundary elements h is the thickness of the artificial boundary element layer r s is the distance from the source of scattered wave to the artificial boundary α n and α t are the coefficients of the viscous spring artificial boundary whose recommended values are 1 and 0 5 respectively liu et al 2006 α α n α t g and ρ s are the shear modulus and mass density respectively of the solid medium and c s and c p are the velocities of sv and p waves respectively in the solid domain the finite element models of the coupled reef seawater system are established based on the general finite element software ansys the seawater is simulated by the displacement formatted fluid80 elements the reef seabed and solid artificial boundary are modeled by solid45 elements and the combin40 spring damping mass elements is adopted to establish the fluid artificial boundaries additionally by coupling the normal degree of freedoms of the coincident nodes in the interface the fluid soil interaction can be simulated in this study we adopted the three layered reef seawater model proposed in liu et al 2019b as shown in fig 2 where l is the width of the reef flat l f is the minimum width of the near field seawater domain h s is the thickness of the near field seabed domain along the vertical direction y axis h and θ represent the thickness and the slope gradient of each reef layer respectively and the subscripts 1 2 and 3 denote the layer 1 layer 2 and layer 3 of the reef model respectively the topographic and material characteristics of the reef layers are determined according to the literatures meng et al 2014 shan et al 2000 sun and lu 1999 these parameters together with the dimensions of the near field reef seawater model and the mesh size information in the finite element model which will be introduced in the following section are shown in table 1 as for the seawater the mass density ρ f and velocity of sound c f are 1025 kg m 3 and 1450 m s 1 respectively it is important to emphasize that the coral sand layers on the reefs in the south china sea are relatively shallow compared to the entire reef model meng et al 2014 considering that the main focus of this study is the wave propagation in the reef seawater system and the distribution of the ground motion field on the reef rock site the influence of the overlying sand layer on the ground motion field of the reef rock site is neglected in this study furthermore as mentioned above specialized research on the seismic response of the coral sand layer has been conducted but the seismic excitations are assumed to be uniform chen et al 2019 hu et al 2018 2017 the results on the ground motion field of the reef rock site in this study can be further applied as the seismic excitations of the coral sand layers in this way the spatial distribution of the seismic wave can be considered and the seismic analysis of the coral sand layer can be more practical and reasonable 3 seismic wave input method the seismic analysis of the near field reef seawater model is an external source problem which means that the excitation sources are outside the calculation domain for such problems challenges appear when inputting the seismic waves into the near field model without affecting the absorption of the scattered waves by the artificial boundaries current methods bao et al 2019 bielak et al 2003 liu et al 2019a generally divide the wave field in the calculation model into two parts according to the principle of wave superposition the free wave field motions of the free field model which is a background geological model without the local topographies and the scattered waves caused by the interactions between the incident waves and the local topographies then the free wave field motions can be converted into the equivalent seismic loads through different numerical algorithms and the earthquake energy can be input into the calculation domain by applying the equivalent seismic loads on the boundary nodes while the scattered waves caused by the wave topography interaction are absorbed by the artificial boundaries 3 1 boundary substructure method in this study the bsm is adopted to input the p and sv waves with arbitrary incident angles into the reef seawater model according to bsm the nodes of the reef seawater model and the corresponding free field model which is a half space model with an overlying seawater layer see fig 3 a can be classified into three types the boundary nodes denote as b the nodes adjacent to the boundary nodes denote as n and the internal nodes denote as i then the equivalent input seismic loads on the boundary nodes f b can be solved as following liu et al 2019c 3 f b m bn u n 0 m bb u b 0 c bn u n 0 c bb u b 0 k bn u n 0 k bb u b 0 where m c and k represent the mass damping and stiffness matrices of the finite element model of reef seawater system respectively u 0 u 0 and u 0 are the vectors of the displacement velocity and acceleration of the free wave field motions and the subscripts b and n denote the abovementioned nodal classification it has been demonstrated that eq 3 can be equivalent to the motion equation of the substructure of artificial boundaries which is form by the artificial boundaries and a layer of elements between nodes b and n as shown in fig 3b liu et al 2019c therefore the incident seismic waves can be transformed into the equivalent input seismic loads through the dynamic analysis of the substructure of artificial boundaries under the imposed free wave field motions different from the previous study of vertical incidence of sv waves where the free wave field motions vanish in the fluid domain and the calculation of the equivalent seismic loads does not involve the seawater layer in the case of oblique incidences of the p and sv waves there are complex wave transmissions and reflections at the fluid soil coupling interface and the free wave field exists in the entire calculation domain therefore it is necessary to consider the seismic wave input in the seawater layer which involves two main issues needing to be settled calculating the free wave field corresponding to the reef seawater model under the oblique incidence of seismic waves and converting the free wave field motions into the equivalent input seismic loads on both the fluid and solid artificial boundaries the detailed derivation of the corresponding free wave field under the obliquely incident p and sv waves will be presented in the subsequent subsection here we assume that the free wave field motions are already known and then use them to calculate the equivalent input seismic loads through the bsm the implementation processes of the bsm are provided as follows 1 establish the boundary substructure model corresponding to the reef seawater system as shown in fig 3b this procedure can be accomplished by two means i establishing the finite element model of the reef seawater system and then deleting all elements except the artificial boundary elements and one layer of fluid and solid elements adjacent to the artificial boundaries and ii directly establishing the boundary substructure shown in fig 3b it is important to note that in means ii the element sizes the node positions and the material properties need to be completely identical with those of the reef seawater model but it will not bother in means i since the substructures are directly intercepted from the original reef seawater model 2 impose the free wave field motions on each node of the boundary substructure model and conduct a dynamic analysis of the substructure the equivalent input seismic loads can be obtained which are exactly the reaction forces on the artificial boundary nodes notably under the oblique incidence of the seismic waves the free wave field motions and the equivalent input seismic loads vary on different nodes therefore the data management in this procedure requires extra caution and developing a subprogram for data processing is recommended 3 apply the equivalent input seismic loads obtained from the previous step on the corresponding artificial boundary nodes of the reef seawater model as shown in fig 3c then the seismic response of the reef site can be obtained through the dynamic simulation in addition it is important to emphasize that the seismic wave input method for the ocean engineering site provide in this study is applicable not only to the reef seawater system but also to the seismic analysis of other ocean engineering such as breakwaters zhao et al 2019 2020 deep water piers wang et al 2019 and offshore platforms park et al 2011 where the interaction between the seabed the structure and the seawater need to be considered 3 2 free wave field analysis 3 2 1 nomenclature u displacement a amplitude of the displacement potential function t time ω circular frequency σ τ normal stress and shear stress h thickness of the fluid layer p hydrodynamic pressure i imaginary unit λ μ lame constant subscripts 1 and 2 solid medium and fluid medium ρ density subscripts x and y horizontal direction and vertical direction cp cs velocities of p and sv waves superscripts p and s p wave and sv wave θ angle between the wave propagation direction and the normal direction of the interface superscripts i r and t incident wave reflected wave and transmitted wave ϕ ψ displacement potential functions of p and sv waves in this section the free wave field motions of the free field model under the oblique incidence of p and sv waves are derived on that basis through the bsm introduced in the previous section the obliquely incident seismic waves can be input into the reef seawater model the corresponding free field model of the reef seawater system is a half space model with an overlying seawater layer as shown in fig 4 in the solid domain of the free field model the relationship between the stress and the displacement is given by hooke s law 4 σ 1 x λ u 1 x x u 1 y y 2 μ u 1 x x σ 1 y λ u 1 x x u 1 y y 2 μ u 1 y y τ 1 x y τ 1 y x μ u 1 x y u 1 y x in the nonviscous and compressible fluid domain the motion equations and the formula of hydrodynamic pressure can be expressed as follows 5 2 u 2 x t 2 c 2 p 2 2 u 2 x x 2 2 u 2 y x y 2 u 2 y t 2 c 2 p 2 2 u 2 x x y 2 u 2 y y 2 p 2 ρ 2 c 2 p 2 u 2 x x u 2 y y to calculate the free wave field motions the following four boundary conditions should be met in the free field model 1 continuity of the normal displacement at the interface 6 u 1 y u 2 y y 0 2 equilibrium of the normal stress at the interface 7 σ 1 y p 2 0 y 0 3 zero tangential stress at the interface 8 τ 1 x y 0 y 0 4 zero hydrodynamic pressure at the free surface of fluid 9 p 2 0 y h based on the above control equations and boundary conditions the analytical solutions of the free wave field motions under the obliquely incident p and sv waves can be derived separately in the following 3 2 2 obliquely incident p wave the wave structure of the free field under the oblique incidence of a p wave is shown in fig 4a the components of the wave field can be separated into five parts the incident p wave u 1 ip the downgoing p and sv waves in the solid domain generated from the interface u 1 rp and u 1 rs the upgoing p waves in the fluid domain generated from the interface u 2 tp and the downgoing p waves in the fluid domain generated from the free surface u 2 rp according to this wave field separation the displacements of the free field model under the obliquely incident p wave can be expressed as follows 10 u 1 x u 1 x ip u 1 x rp u 1 x rs u 1 y u 1 y ip u 1 y rp u 1 y rs u 2 x u 2 x tp u 2 x rp u 2 y u 2 y tp u 2 y rp then we introduce the displacement potential functions ϕ and ψ of p and sv waves respectively frasier 2002 namely u x p φ x u y p φ y u x s ψ y u y s ψ x the steady state solutions of the potential functions corresponding to each free wave field component can be obtained through the method of separation of variables 11 φ 1 ip a 1 ip exp i ω sin θ 1 ip c 1 p x cos θ 1 ip c 1 p y t φ 1 rp a 1 rp exp i ω sin θ 1 rp c 1 p x cos θ 1 rp c 1 p y t ψ 1 rs a 1 rs exp i ω sin θ 1 rs c 1 s x cos θ 1 rs c 1 s y t φ 2 tp a 2 tp exp i ω sin θ 2 tp c 2 p x cos θ 2 tp c 2 p y t φ 2 rp a 2 rp exp i ω sin θ 2 rp c 2 p x cos θ 2 rp c 2 p y t according to snell s law the following equation can be obtained 12 sin θ 1 ip c 1 p sin θ 1 rp c 1 p sin θ 1 rs c 1 s sin θ 2 tp c 2 p sin θ 2 rp c 2 p given the incident angle of the input seismic p wave θ 1 ip the angle between the propagation direction of each wave component and the normal direction of the interface can be obtained through eq 12 additionally when the time history of the incident p wave u ip t is known here u ip t is supposed as the incident wave at the origin of the coordinate namely x y 0 the corresponding fourier amplitude spectrum u ip ω can be gained through the fourier transform and then the amplitude of the displacement potential function of the incident p wave a 1 ip can be obtained through eq 11 13 a 1 ip u ip ω c 1 p i ω by substituting eqs 4 5 and 11 into eqs 6 9 the following equations can be obtained 14 cos θ 1 ip c 1 p a 1 ip cos θ 1 rp c 1 p a 1 rp sin θ 1 rs c 1 s a 1 rs cos θ 2 tp c 2 p a 2 t p cos θ 2 rp c 2 p a 2 rp 15 λ 2 μ cos 2 θ 1 ip c 1 p 2 a 1 ip a 1 rp 2 μ cos θ 1 rs sin θ 1 is c 1 s 2 a 1 rs ρ 2 a 2 tp a 2 rp 16 2 cos θ 1 ip sin θ 1 ip c 1 p 2 a 1 ip a 1 rp cos 2 θ 1 rs sin 2 θ 1 is c 1 s 2 a 1 rs 0 17 exp i ω cos θ 2 tp h c 2 p a 2 tp exp i ω cos θ 2 tp h c 2 p a 2 rp 0 combining eqs 14 17 and solving the equations gives the following 18 a 1 rp a 1 ip 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip a 1 rs a 1 ip 2 1 d 2 λ μ μ cos 2 θ 1 ip sin 2 θ 1 ip cos θ 2 tp 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip c 1 s 2 c 1 p 2 a 2 tp a 1 ip 2 d 2 λ μ μ cos 2 θ 1 ip cos θ 1 ip 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip c 2 p c 1 p a 2 rp a 1 ip 2 λ μ μ cos 2 θ 1 ip cos θ 1 ip 1 d 2 λ μ cos 2 θ 1 rs μ cos 2 θ 1 ip θ 1 rs cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 ip c 2 p c 1 p where d exp i ω cos θ 2 tp h c 2 p by substituting eqs 11 and 18 into eq 10 the steady state solution of the free wave field can be obtained which can be further converted into the solution in the frequency domain by eliminating the time factor exp iωt then the transient solution in the time domain can be gained through fourier inverse transform 3 2 3 obliquely incident sv wave under the obliquely incident sv wave the wave structure of the free field model is shown in fig 4b and it can be separated into the incident sv wave u 1 is the downgoing sv and p waves in the solid domain generated from the interface u 1 rs and u 1 rp the upgoing p waves in the fluid domain generated from the interface u 2 tp and the downgoing p waves in the fluid domain generated from the free surface u 2 rp according to this wave field separation the displacement of the free field model can be expressed as follows 19 u 1 x u 1 x is u 1 x rs u 1 x rp u 1 y u 1 y is u 1 y rs u 1 y rp u 2 x u 2 x tp u 2 x rp u 2 y u 2 y tp u 2 y rp similar to the case of the incident p wave the steady state potential function of each wave component can be obtained through the method of the separation of variables where the formulas of φ 1 rp ψ 1 rs φ 2 tp and φ 2 rp are all identical to eq 11 and the steady state solution of the incident sv wave can be expressed as follows 20 ψ 1 is a 1 is exp i ω sin θ 1 is c 1 s x cos θ 1 is c 1 s y t similarly snell s law should be met under the obliquely incident sv wave 21 sin θ 1 is c 1 s sin θ 1 rs c 1 s sin θ 1 rp c 1 p sin θ 2 tp c 2 p sin θ 2 rp c 2 p given the incident angle of the input seismic sv wave θ 1 is the angle between the propagation direction of each wave component and the normal direction of the interface can be obtained through eq 21 additionally following the similar procedure of the p wave case the amplitude of the displacement potential function of the incident sv wave a 1 is can be gained as follows 22 a 1 is u is ω c 1 s i ω where u is ω is the fourier amplitude spectrum of the incident sv wave by substituting eqs 4 5 11 and 20 into eqs 6 9 the following equations can be obtained 23 sin θ 1 is c 1 s a 1 is sin θ 1 rs c 1 s a 1 rs cos θ 1 rp c 1 p a 1 rp cos θ 2 tp c 2 p a 2 tp cos θ 2 rp c 2 p a 2 rp 24 λ 2 μ cos 2 θ 1 rp c 1 p 2 a 1 rp 2 μ cos θ 1 is sin θ 1 is a 1 is cos θ 1 rs sin θ 1 rs a 1 rs c 1 s 2 ρ 2 a 2 tp a 2 rp 25 2 cos θ 1 rp sin θ 1 rp c 1 p 2 a 1 rp cos 2 θ 1 is sin 2 θ 1 is c 1 s 2 a 1 is cos 2 θ 1 rs sin 2 θ 1 rs c 1 s 2 a 1 rs 0 26 exp i ω cos θ 2 tp h c 2 p a 2 tp exp i ω cos θ 2 tp h c 2 p a 2 rp 0 combining eqs 23 26 and solving the equations give the following 27 a 1 rs a 1 is 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp a 1 rp a 1 is 1 d 2 μ sin 4 θ 1 is cos θ 2 tp 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp c 1 p 2 c 1 s 2 a 2 tp a 1 is 2 d 2 μ sin 2 θ 1 is cos θ 1 rp 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp c 1 p c 2 p c 1 s 2 a 2 rp a 1 is 2 μ sin 2 θ 1 is cos θ 1 rp 1 d 2 λ μ cos 2 θ 1 is μ cos 2 θ 1 rp θ 1 is cos θ 2 tp d 2 1 ρ 2 c 1 p c 2 p cos θ 1 rp c 1 p c 2 p c 1 s 2 by substituting eqs 11 20 and 27 into eq 19 the steady state solution of the free wave field under the obliquely incident sv wave can be obtained then the transient solution in the time domain can be gained through a fourier inversion 3 3 incident seismic waves a pulse wave with a pulse duration of 0 2 s and the three time histories of actual seismic accelerations recorded in the chichi earthquake the imperial valley earthquake and the loma prieta earthquake are selected as the amplitudes of the incident seismic waves the time history and fourier amplitude spectra of the incident waves are shown in fig 5 these seismic waves are input into the reef seawater model in the form of p and sv waves at different incident angles through the bsm 3 4 verification in the previous research liu et al 2019b we have validated the accuracy and effectiveness of the key numerical techniques involved in the seismic analysis model of the reef seawater system including the fluid artificial boundary and the integrated reef seawater finite element model besides the precision of the dynamic finite element method fem can be guaranteed when the mesh size δ meet the following condition jeremi et al 2009 28 δ c s 10 f c u t where c s is the velocity of sv wave in the media and f cut is the cutoff frequency the cutoff frequency are designated as 20 hz in this study which contains the main frequency components of the selected seismic waves shown in fig 5 then the maximum mesh sizes of different parts in the finite element model can be determined according to eq 28 as shown in table 1 considering that one of the most significant development in this study is that we modified the seismic wave input method to accomplish the oblique incidence of p and sv waves whose accuracy however remains to be verified as mentioned above the process of seismic wave input through bsm is independent from the interaction between the incident waves and the local topographies it is only related to the background free field model to verify the accuracy of the modified seismic wave input method without the influence of the wave topography interaction in this section the obliquely incident seismic wave is input into the free field model through bsm and the results of the internal computational domain are compared to the corresponding theoretical solutions obtained through eqs 10 11 and 18 a two dimensional calculation model shown in fig 6 is established it is a near field half space model with an overlying water layer the length of the model is 1400 m and the thicknesses of the water layer and the seabed are both 600 m points a and b are the midpoints of the free surface of water layer and the interface of seawater and seabed respectively the material properties of the seabed are as follows mass density ρ 2700 kg m 3 velocity of sv wave v s 1800 m s 1 and velocity of p wave v p 4500 m s 1 the material properties of the seawater are identical with those of the reef seawater model established in section 2 the pulse p wave shown in fig 5 is input into the model with the incident angle of 45 the displacements on points a and b calculated through the bsm is shown in fig 7 it can be seen that the numerical results provide nice agreement with the theoretical solutions fig 8 shows the snapshots of the displacement wave field in the numerical model where the wave fronts of the incident reflected and transmitted waves can be clearly observed consequently the effectiveness and accuracy of the modified seismic wave input method in the coupled seabed seawater site can be validated furthermore this method can precisely input the obliquely incident seismic waves into the reef seawater model since the process of the seismic wave input is independent from the local reef topographies according to the above verification together with the previous validated reef seawater fem model the effectiveness of the entire seismic analysis model of the reef seawater system under the obliquely incident seismic waves can be verified 4 seismic analysis of the reef seawater system under the obliquely incident p wave based on the free wave field derived in the previous section and the seismic analysis model of the reef seawater system in this section we will investigate the seismic response of the reef seawater system under the obliquely incident p waves the seismic waves shown in fig 5 are input into the calculation model in form of the p waves through bsm with the incident angles of 0 15 30 45 60 and 75 the distributions of the ground motion fields on the reef flat are analyzed and the effects of some fundamental factors including the incident angle the frequency of the incident wave the width of the reef flat and the coupling effect of the seawater on the seismic response of the reef site are investigated 4 1 wave propagation the displacement waveforms on the reef flat 400 m x 400 m and the nearby reef slopes 800 m x 400 m and 400 m x 800 m under the pulse p wave incident at 0 30 and 60 are shown in fig 9 where the horizontal axis is time and the vertical axis is the x coordinates of different locations with the midpoint of the reef flat as the origin because the seismic waves propagate through the multilayered reef structure their propagation processes are affected by the reef topography and the dynamic coupling effect of the seawater the simulated waveforms including the incident waves the reflected waves from the free surface the transmitted and reflected waves from the interfaces and the surface waves appear successively resulting in the longer durations of the ground motions and the complicated waveforms on the reef flat when the seismic p wave is vertically incident the ground motions on the reef flat are mainly controlled by the first arriving p wave the peak vertical displacements as well as their arrival times are relatively coincident with each other along the reef flat however due to the layered structure of the reef and the slope topography the seismic waves propagate back and forth in the top low velocity layer resulting in the complex subsequent waveforms on the slope areas however the waveforms are mainly composed of the incident waves and the primary reflected waves which propagate upward and downward along the slopes respectively when the pulse p wave is obliquely incident however there are significant nonuniform motions on the reef flat due to the time lag effect of the wave propagation the peak vertical displacements are still controlled by the first arriving p wave but with the increasing in the incident angle the peak vertical displacements tend to decrease while in the horizontal direction the largest seismic response appears at the incident angle of 30 and the peak horizontal displacement near the edge of the reef flat is larger than that in the central area fig 10 shows the snapshots of the reef seawater system under the pulse p wave incident at 0 30 and 60 it can be seen that when the incident p waves propagate through the reef topography and the fluid solid interfaces various reflected and scattered waves are generated and their wave fronts overlap with each other resulting in the complicated wave field in the reef seawater system when the pulse p wave is vertically incident the wave field is symmetrically distributed on account of the geometric symmetry of the reef seawater model when the incident waves arrive at the slope areas the reflected p and sv waves are generated due to the nonzero angle between the wave incident direction and the normal direction of the slope afterwards with the further superposition of the scattered waves generated by different interfaces a cylindrical scattered wave is generated beneath the reef and diffuses downward to the seabed for the cases of obliquely incident p waves the seismic waves are input from the bottom left of the model and propagate from the upstream side to the downstream side of the reef the symmetry of the wave field disappears and the time lag effect is significant in the early stage of the seismic response the wave field in the reef and the seabed is mainly composed of the incident p waves and the reflected p and sv waves and their wave fronts are clearly visible as time passes complex scattered waves are generated due to the effects of the topography and the coupled seawater those scattered waves propagate outward and are eventually absorbed by the artificial boundaries notably due to the difference in the wave velocities between the seawater and the seabed the seismic waves are reflected back and forth in the seawater layer and their amplitudes decay slowly 4 2 effect of incident angle it is well known that the elastic homogeneous half space is one of the most simple and common used model in the site seismic analysis under the vertically incident seismic waves the amplitude of earthquake response on the surface of a homogeneous half space is exactly twice the incident waves and this characteristic is unaffected by the material conditions to evaluate the seismic amplification effect of the reef sites we defined the peak displacement velocity and acceleration ratios ru rv and ra with the seismic response of the elastic homogeneous half space as a basis 29 r u x x max u x x t max u 0 t r u y x max u y x t max u 0 t r v x x max v x x t max v 0 t r v y x max v y x t max v 0 t r a x x max a x x t max a 0 t r a y x max a y x t max a 0 t where u v and a are the displacement velocity and acceleration the variables x is the horizontal coordinate of different locations on the reef flat t is the time the subscripts x and y denote the horizontal and vertical directions respectively and the subscript 0 denotes the vertical seismic response on the surface of a homogeneous half space under the same seismic p wave incident vertically because that the artificial island and other upper constructions are basically located on the reef flat of the reef island the seismic response of the reef flat is the key area of concern in this study in the following we focus on the earthquake amplification effect of the reef flat l 2 x l 2 and discuss the influences of different factors figs 11 and 12 show the spatial distributions of ru rv and ra on the reef flat under the seismic p waves incident at different angles with the normalized parameter x l as the horizontal coordinate in the horizontal direction ru x rv x and ra x increase first and then decrease with the increase in the incident angle the least favorable incident angles for ru x and rv x are between 45 60 and 30 60 respectively and the maximum ra x usually appears at the incident angle of 30 for the spatial distribution of the ground motion field when the seismic p waves are obliquely incident the ru x and rv x on the reef flat generally increase from the upstream left hand side to the downstream right hand side while the horizontal ra decreases first and then increases along the reef flat in addition as the incident angle increases the spatial distributions of the ru x rv x and ra x become smoother in the vertical direction ru y rv y and ra y significantly decrease with the increasing of the incident angle which means that the vertical incidence is the least favorable case for a vertical seismic response under the p wave in addition ru y rv y and ra y are generally larger than 1 when the seismic waves incident at a small angle and this phenomenon is more pronounced for the pulse wave and the loma prieta wave from the wave propagation perspective on account of the layered reef structure and the slope topography the seismic waves are reflected repeatedly in the top low velocity layer and their amplitudes get amplified resulting in the larger seismic responses compared to those of the homogeneous half space model in terms of the spatial distribution regularities ru y and rv y distribute smoothly along the reef flat for ra y when the seismic p wave is incident at a small angle ra y rapidly decreases first and then slowly increases along the reef flat with the increase in the incident angle the distribution of ra y tends to be flatter 4 3 effect of frequency the peak ground acceleration pga is the key parameter for the site seismic evaluation and the structural seismic design in the following we analyze the seismic amplification effect of the reef flat with respect to the acceleration response to investigate the effect of the frequency component on the seismic response of the reef seawater system we define the acceleration fourier spectrum ratio ha as follows similarly the site seismic response of the homogeneous half space model is taken as a basis 30 h a x x f f x x f f 0 f h a y x f f y x f f 0 f where f is the frequency f x x f and f y x f are the fourier amplitudes of the horizontal and vertical accelerations on the reef flat respectively f 0 f is the fourier amplitude of the acceleration response on the surface of the homogeneous half space under the same seismic p wave incident vertically which is also equal to twice the fourier amplitude of the incident wave in addition it is important to emphasize that the acceleration fourier spectrum ratio ha measures the amplification effect of the reef model on each frequency component it is independent with the incident waves and is only determined by the dynamic characteristics of the reef seawater model the spatial distributions of ha x and ha y under the seismic p waves incident at different angles are plotted in three dimensional images shown in figs 13 and 14 with the normalized parameter x l and the frequency f as the horizontal coordinates in the horizontal direction the components of ha x are mainly distributed in the frequency band below 8 hz see fig 13 indicating that if the main frequency components of the incident waves are within this frequency band the seismic response on the reef flat gets larger meanwhile with the increase of the incident angle ha x increases first and then decreases it get largest when θ 1 ip 30 and the maximum value can reach up to 2 5 appear in the area near the middle and the downstream side of the reef flat while in the vertical direction as shown in fig 14 ha y tends to decrease first and then increase slowly with the increase of the frequency the spatial distribution of ha y however is relatively smooth this phenomenon is consistent with the distribution regularities of the peak acceleration ratio ra y in fig 12 when f 1 hz ha y is relatively large especially when the incident angles are relatively small indicating that the amplification effect is significant in this frequency band meanwhile according to the fourier amplitude spectra of the incident seismic waves shown in fig 5 the low frequency components the pulse wave and the loma prieta wave are relatively greater than those of the chichi wave and the imperial valley wave therefore the amplification effect on the vertical seismic response under the pulse wave and the loma prieta wave is more pronounced than those of the other two waves as observed in fig 12 in order to further explore the relationship between the nature frequencies of the reef model and the seismic response in the time domain and the frequency domain we conduct a modal analysis of the reef seawater system because the reef seawater system is a continuum model there are infinite number of natural frequencies theoretically we only present the natural frequencies below 10 hz and the corresponding modes of the reef structure as shown in table 2 it can be seen from table 2 that the first two modes are the global modes corresponding to the horizontal and vertical deformations respectively while the other modes are almost all partial modes of the reef layer 1 and 2 the distribution of partial modes corresponding to the horizontal motions of the reef flat concentrates in the frequency band between 1 and 8 hz which is consistent with the distribution of the horizontal acceleration fourier spectrum ratio ha x shown in fig 13 with the increase of the natural frequency the number of partial modes corresponding to the vertical motions tends to increase indicating that the high frequency loads are more likely to excite the vertical motions of the reef flat similar regularity can also be found in the distribution of the vertical acceleration fourier spectrum ratio ha y shown in fig 14 in addition from the perspective of modal analysis under the incidences of the pulse wave and the loma prieta wave whose low frequency components are larger than those of the chichi wave and the imperial valley wave the vertical global mode with frequency of 0 51 hz are more easily excited leading to larger vertical seismic response in time domain as shown in fig 12 4 4 effect of the reef flat s width it is well known that most of the offshore reefs in the south china sea are of elongated and elliptical shapes on account of the influences of ocean currents zhan et al 1995 thus the widths of the two dimensional models vary in different interception locations to obtain a more comprehensive understanding of the seismic response over the entire reef site it is necessary to investigate the influence of the width of reef flat l on the site seismic response here all the parameters in table 1 remain constant except that the widths of reef flat l are changed to 500 m and 1000 m respectively the seismic p waves are obliquely input in each case and the spatial distributions of ra on the reef flat are calculated and plotted in figs 15 and 16 notably because of the similarity in the influence regularities under the three actual seismic records we only present the representative results under the incidence of the chichi wave and the pulse wave here for brevity when the seismic p waves are incident at different angles the influence of the reef flat s width l on the vertical seismic response is limited while in the horizontal direction the site seismic response increases with the decrease in the reef flat s width l when θ 1 ip 15 and when θ 1 ip 30 this trend keeps near the upstream side but appears in opposite direction near the downstream side additionally in most cases the horizontal ra near the upstream side is smaller than that near the downstream side however when the width of reef flat l is relatively small l 500 m and the seismic p wave is incident at a large angle θ 1 ip 60 the contrary phenomenon appears and the horizontal seismic response near the upstream side tends to be larger 4 5 effect of seawater next we investigate the impact of the coupled seawater on the seismic response of the reef site by deleting all the fluid elements and the fluid artificial boundaries from the reef seawater model the corresponding sloping platform model without the consideration of seawater can be established the spatial distributions of ra calculated by the models with and without the consideration of seawater under the seismic p waves incident at different angles are compared in figs 17 and 18 in table 3 we compare the average peak acceleration ratios along the reef flat calculated by the reef seawater model r a and the sloping platform mode r a s p and then calculate the average and the maximum relative deviations of the peak acceleration ratios between these two models δ and δ max where the relative deviation δ is defined as follows 31 δ r a s p r a r a in the horizontal direction when the incident angle is less than 60 the acceleration response of the reef site is smaller than that of the corresponding sloping platform model and the average deviation δ increases significantly with the decrease in the incident angle specifically under the vertical incident p waves the average deviation δ is about 50 and the maximum deviation δ max can reach up to 70 when the seismic wave is incident at a large angle θ 1 ip 60 the relative deviations become relatively small and the site seismic response of the reef seawater model tends to be larger than that of the sloping platform model in the vertical direction from an overall perspective the spatial distributions of ra calculated by the reef seawater system are smoother and larger than those calculated by the sloping platform model especially around the edge of the reef flat and the relative deviation between these two models increase with the incident angle when the seismic p wave is incident at 75 the average relative deviation δ is approximately 10 and the maximum relative deviation δ max can reach up to 20 in local areas such as the middle of the reef site however the seismic response of the sloping platform site can be larger than that of the reef site 5 seismic analysis of the reef seawater system under the obliquely incident sv wave in this section we study the seismic response of the reef seawater system under incident sv waves it is important to note that there is a limiting angle θ lim is for the vertically layered site seismic analysis under the incident sv wave when the incident angle θ 1 is is larger than the limiting angle θ lim is the wave field no longer satisfies the plane wave hypothesis and snell s law is not applicable the value of the limiting angle can be obtained through eq 21 with θ 1 rp 1 under the parameters adopted in this study its value is 26 1 the seismic sv waves shown in fig 5 are incident into the reef seawater system at 0 5 10 15 20 and 25 similarly the distributions of the ground motion fields are discussed and the impacts of several fundamental factors on the seismic response are investigated 5 1 wave propagation fig 19 shows the displacement waveforms on the reef flat 400 m x 400 m and the nearby reef slopes 800 m x 400 m and 400 m x 800 m under the pulse sv waves incident at 0 10 and 20 a comparison of figs 9 and 19 shows that the waveforms on the reef flat under the incident sv wave are more complex than those under the incident p wave the incident sv waves interact with the reef topography and the layered reef structure resulting in the obvious scattered waves and surface waves propagating along the reef flat consequently the subsequent waves decay slower and the durations of the ground motions get much longer by contrast the waveforms on the slope areas are relatively simple and primarily consist of the incident sv waves and the reflected waves with very small amplitudes indicating that the seismic energy is concentrated in the top low velocity layer of the reef which is consistent with the phenomena of the large amplitude and long duration of the seismic response on the reef flat in addition when the seismic waves are obliquely incident there are obvious nonuniform motions on the reef flat and the amplitude of the seismic response tends to increase from the upstream side to the downstream side the snapshots of the reef seawater system under the pulse sv wave incident at 0 10 and 20 are shown in fig 20 similar to the case of the incident pulse p wave see fig 10 complicated reflected and scattered waves are generated when the waves propagate through the reef topography and the fluid solid interfaces however under the incident of the sv wave the relative incident angle the angle between the wave propagation direction and the normal direction of the slope can more easily exceed the limiting angle θ lim is generating the propagation of the surface waves along the slopes and further amplifying the seismic response on the reef site in addition new wave sources are generated at the junctions of the reef and seabed which produce cylindrical scattered waves propagating into the water domain as time goes by the outgoing scattered waves in the solid and fluid domains are all effectively absorbed by the corresponding artificial boundaries 5 2 effect of incident angle similar to the cases of incident p waves we measure the site seismic response under the incident sv wave with respect to the peak displacement velocity and acceleration ratios ru rv and ra defined by eq 28 but here the subscript 0 denotes the horizontal seismic response of the homogeneous half space model under the vertically incident sv wave the spatial distributions of ru rv and ra are plotted in figs 21 and 22 in the horizontal direction ru x rv x and ra x all tend to decrease with the increase in the incident angle however when the incident angle is relatively small θ 1 is 15 in the middle area and the area near the downstream side the rv x and ra x are greater than those under the vertical incident sv wave for the spatial distribution when the seismic sv waves are obliquely incident the ru x increases along the reef flat from the upstream side to the downstream side the rv x and ra x slightly increase first then decrease finally increasing rapidly near the downstream side in addition the spatial distribution of the seismic response present different regularities under the different seismic waves in general under the incident pulse wave the ground motion changes violently near the edge of the reef flat and the maximum seismic response tends to appear in this region while in the middle area the peak seismic response is relatively small and is distributed smoothly by contrast under the actual seismic records the spatial distributions of the site motions are more complex in addition to the edge of the reef flat the maximum seismic response also tends to occur in the middle area and with the increase in the incident angle the position of this maximum seismic response moves towards the downstream side notably the ru x rv x and ra x on almost all of the reef flat are greater than 1 and rv x and ra x can even reach up to 4 near the midpoint and the edge of the reef flat indicating that the seismic response of the reef site is significantly amplified compared to that of the homogeneous half space model in the vertical direction however the spatial distributions of ru y rv y and ra y are all relatively flat basically between 0 5 and 1 with the increase of the incident angle the ru y and rv y tend to increase while the ra y tends to decrease 5 3 effect of frequency figs 23 and 24 shows the spatial distributions of the horizontal and vertical acceleration fourier spectrum ratio ha under the seismic sv waves incident at different angles the ha x is mainly distributed in the frequency bands below 8 hz which is consistent with the distribution of the natural frequencies corresponding to the horizontal modes see table 2 the maximum ha x appears near the edge of the reef flat and its value can reach up to 7 5 under the small incident angles the ha x decreases pronouncedly when f 8 hz indicating that the horizontal site seismic response is less sensitive to the high frequency components of the incident sv waves in addition the ha x decreases with the increase in the incident angle and this trend is especially evident in the area near the upstream side of the reef flat when 4 hz f 8 hz in the vertical direction the ha y is mainly distributed in the frequency bands between 2 hz and 12 hz and its maximum value is less than 2 5 which usually occurs between the midpoint and the edge of the reef flat as the incident angle increases the ha y tends to decrease from the perspective of modal analysis when the seismic waves shown in fig 5 whose main frequency components are below 10 hz incident at small angles the horizontal global mode with frequency of 0 42 hz as well as the horizontal partial modes distributed between 1 and 8 hz such as the modes with the natural frequencies of 1 59 hz 2 06 hz 6 19 hz 6 62 hz 6 69 hz 6 70 hz 7 10 hz 7 43 hz and 7 66 hz see table 2 are more likely to be excited resulting in significant amplification on the horizontal seismic response on the reef flat as shown in fig 21 5 4 effect of the reef flat s width next the influence of the reef flat s width l on the seismic response of the reef site under the incident sv waves is investigated similarly the width of reef flat l is changed to 500 m and 1000 m respectively with all the other parameters in table 1 constant the seismic sv waves are obliquely input into the reef seawater model and the spatial distributions of ra on the reef flat are calculated and plotted in figs 25 and 26 in the cases of the vertical and oblique incidence of sv waves the width of reef flat l shows different influence rules on the site seismic response for the vertical incidence as the reef flat s width l decreases ra near the edge of the reef flat remains basically unchanged but in the middle area the seismic response is significantly amplified however when the seismic sv waves are obliquely incident the horizontal acceleration response near the upstream side of the reef flat tends to decrease with the decrease of l and this tendency shows in the opposite direction near the downstream side according to the analysis in the preceding part the surface waves and the scattered waves are generated due to the effect of the reef topography and their amplitudes are attenuated with the increase of the propagation distance when the seismic waves are vertically incident the surface and the scattered waves from the both sides reach the middle area at the same time and overlay with each other as the width of reef flat l decreases the attenuation effect of those waves is reduced and their superposition effect is strengthened thus the site seismic response is amplified however when the seismic waves are obliquely incident the arrival times of the waves generated by the slopes on both sides are different due to the time lag effect therefore the superposition effect is limited and the influence of the reef flat s width on the site seismic response is relatively weak 5 5 effect of seawater the effect of the coupled seawater on the site seismic response under the incident sv waves is studied in this subsection the comparison of ra calculated by the reef seawater model and the corresponding sloping platform model is shown in figs 27 and 28 similarly we compare the average ra along the reef flat and calculate the average and the maximum relative deviations δ and δ max between those two different models as shown in table 4 in the horizontal direction when the incident angle is relatively small θ 1 is 10 the acceleration response of the reef site is smaller than that of the corresponding sloping platform model especially in the region near the midpoint and the corner point the average relative deviation δ increases with the decrease in the incident angle when the incident angle is greater than 10 however although the overall site seismic response of the reef seawater model tends to be smaller than that of the sloping platform model in local areas near the upstream side the seismic amplification effect of the reef site is more significant in the vertical direction the seismic response of the reef site is smaller than that of the sloping platform model and the average relative deviations δ are distributed between 20 and 50 the above comparative analyses in the cases of p and sv waves indicate that when the seismic wave is incident at an arbitrary angle the coupling effect of the seawater shows important influence on the seismic response of the reef site this influence is closely related to the type of the incident wave the incident angle and shows different regularities on different locations on the reef flat therefore it is difficult to directly obtain the seismic response of the reef site from the ground motion field of the corresponding sloping platform site for important reef engineering sites it is necessary to conduct a coupled reef seawater dynamic analysis which reflects the practical mechanical characteristics of the system 6 summary and conclusions a theoretical solution of the free wave field corresponding to the reef seawater system under the obliquely incident p and sv waves is derived in this study on that basis the two dimensional seismic analysis model of the reef seawater system proposed in our previous work is further developed to accomplish the oblique input of the seismic wave into the reef seawater model a series of parametric studies are conducted the ground motion fields on the reef sites are discussed and the effects of several fundamental factors on the seismic response of the reef seawater system are comprehensively studied based on the results the following conclusions can be obtained 1 under the obliquely incident seismic wave the wave field presents a strong traveling wave effect resulting in the significant nonuniform motions on the reef flat on account of the layered reef structure the earthquake energy is concentrated in the top low velocity layer which amplifies the seismic ground motion on the reef flat in addition under the incidence of sv waves the relative incident angle can more easily exceed the limiting angle generating the propagation of surface waves along the reef slopes and further amplifying the seismic response of the reef site 2 the incident angle of the seismic wave significantly affects the seismic response of the reef site in the case of an incident p wave the least favorable incident angle for the horizontal site seismic response is 30 and in the vertical direction it is 0 for sv waves the least favorable load case for both the horizontal and vertical site seismic responses is the vertical incidence of the seismic waves in addition the largest horizontal seismic response usually appears near the downstream side of the reef flat under the p and sv waves 3 the horizontal ha under the incident p wave and the horizontal and vertical ha under the incident sv wave are mainly distributed in the frequency band below 12 hz while the vertical ha under the incident p wave increases with the frequency in the range of 0 16 hz furthermore the spatial distribution characteristics of ha in the frequency domain and those of ra in the time domain provide a nice agreement with each other 4 under the vertical incidence of seismic waves with the decrease in the reef flat s width the superposition effect of the scattered waves generated from the both slope sides are strengthened thus the seismic response in the middle area of the reef site gets amplified however in the case of an oblique wave incidence the arrival times of the scattered waves on the middle area of the reef flat are different due to the time lag effect therefore the superposition effect is limited and the influence of the reef flat s width on the site seismic response is relatively weak 5 when the seismic wave is incident at an arbitrary angle the coupling effect of the seawater shows important influence on the seismic response of the reef site and this influence is closely related to the type of the incident wave the incident angle and shows different regularities on different locations of the reef flat for important reef engineering sites it is necessary to conduct a coupled reef seawater dynamic analysis that reflects the practical mechanical characteristics of the system credit author statement xin bao methodology software formal analysis writing original draft jingbo liu conceptualization project administration shutao li validation fei wang formal analysis piguang wang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by national natural science foundation of china 51878384 the financial support is highly appreciated 
22032,this paper deals with the shape control of a passive tether that links underwater vehicles the pair of robots is composed of a leader that explores the environment and a follower that is in charge of regulating the tether shape by moving appropriately both robots are equipped with standard low cost sensors cameras depth sensor and inertial measurement unit imu this work introduces an innovative visual servoing control scheme based on a parameterized catenary model of the tether assuming that it is negatively buoyant the tether is detected in the image through color segmentation and its 3 d shape parameters are estimated through a nonlinear optimization procedure thanks to an adapted gauss newton algorithm simulations and experimental results show that the relative positioning of the robots can be achieved through simultaneous tether shape visual servoing in both leader and follower s cameras even in situations of tether partial visibility and strong disturbances which proves the approach to be reliable keywords underwater robotics visual servoing control sensory based robot control 1 introduction underwater remotely operated vehicles rovs are suited to explore complex and unstructured environments where robotic tasks cannot be carried out in complete autonomy therefore requiring continuous human intervention the surface vessel where the human operator is located is connected to the robot via an underwater tether that ensures data exchange power supply and provides mechanical support however tethers can have negative impacts onto the rov when they transmit disturbances caused by the swell and surface currents it generates drag force and can get entangled with drifting or fixed objects for large working rovs standard tether management solutions based on tether management systems tms abel 1994 and heave compensators hc yang et al 2008 huster et al 2009 have proven to be efficient in exploration missions in deep open waters where the robot has enough space to maneuver and the risks of tether entanglement are reduced fig 1 the tms is a system of winches controlled by a human operator and attached to the rov housing cage abel 1994 it aims to regulate the amount of unwound tether cable leaving the housing cage allowing the robot to move in the working area the operation of a tms is a complex task and it is considered by many operators as similar as operating a secondary rov christ and wernli sr 2013 heave compensators are passive huster et al 2009 or active yang et al 2008 systems of winches employed to compensate the heave motion of the surface vessel it aims to regulate the slackness of the cable linking the surface vessel to the underwater cage where the tms is located fig 1 this portion of cable is often named umbilical another way to reduce the disturbance forces of the tether cable on the rov is to actuate the surface vessel so that it tracks the rov in its horizontal displacements in triantafyllou and grosenbaugh 1991 hydrophones and submerged pingers were used to position an intermediate passive vehicle with the aim of absorbing disturbances and maintaining the tether slack near the rov in prabhakar and buckham 2005 this approach is evolved and a decoupled controller is proposed for the positioning of a tether point near the rov however these approaches require the use of additional external sensors hydrophones and pingers to achieve the dynamic positioning when it comes to exploring confined and cluttered spaces such as underwater coastal zones caves and wrecks the management of the tether is still a challenge the exploration of shallow waters and narrow spaces is preferably carried out by small tethered underwater robots also called mini rovs pacunski et al 2008 contrary to the large rovs mentioned above these small robots are less powerful and they are more easily disturbed by the efforts produced by the cable in khatib et al 2016 an upper intermediate robot was used as a power relay station between the surface vessel and a bottom robot that was dedicated to archeological tasks to reduce risks of entanglements the intermediate robot was teleoperated or switched to autonomous mode relying on a vision based tracking algorithm of the bottom robot regardless of the umbilical shape this paper introduces the concept of a queue of tethered mini vehicles where each pair of consecutive mini vehicles is connected by a cable fig 2 here the presence of the cable is considered an advantage and it is used as a feature by the robots to control their positioning to obtain a given tether shape the mini vehicles play the role of actuators that can change the shape of all the inter connecting cables which is useful to avoid tether entanglement and allow the exploration of cluttered and confined spaces the main objective is to make the robots able to position themselves inside the queue thanks to an original visual servoing of the tether which has not yet been investigated to the authors knowledge this study focuses in particular on the shape regulation of a sagging tether linking two successive robots inside the queue the leader and its immediate follower the leader must be able to freely explore its surroundings while the follower is expected to manage the tether shape through its own motion so as not to hinder the leader s movements by maintaining the cable in a desired shape neither too tight nor too loose to avoid entanglements the tether is modeled by a catenary and the robots are equipped with low cost standard sensors frontal rear cameras depth sensor and an inertial measurement unit imu which are the only sensors to be used the article is structured as follows section 2 presents prior work on cable and deformable objects modeling and a background of visual servoing section 3 introduces the model of a pair of robots linked by a tether and section 4 presents the algorithm used to detect and estimate the tether 3 d shape in section 5 the catenary based interaction matrices are developed which lead to the design of the tether shape regulation control laws presented in section 6 simulation and experimental results are provided in sections 7 and 8 respectively section 9 discusses the results and section 10 gives concluding remarks and perspectives 2 related work 2 1 cables and deformable objects modeling numerical models can be used to represent the tether shape in underwater applications in buckham et al 2004 the 3 d motion of slack and low tension cables was modeled thanks to the finite element method rao 2017 other finite element formulations can be applied to high tension cables quan et al 2015 in eidsvik and schjølberg 2016 finite element models were also used to solve the euler bernoulli beam equation and model the interaction forces between tether cable and rov the shortcoming of these approaches is that they depend on the knowledge of the relative position between ship and rov which implies the use of external acoustic positioning systems considering a passive and uninstrumented tether a parameterized model of the cable can be used if the cable departure angles or attachment points relative position is known the most complete cable model in the air relies on the irvine equation irvine 1981 which is a complex model but has been shown to be very realistic merlet 2018b tether and deformable objects handling is a challenge also found in some fields of application other than the underwater environment in order to achieve real time control parametric models have been used since they have the great advantage of speeding up the computational time of the control loop spline curves were used to model a flexible hose that is transported by a team of terrestrial robots echegoyen et al 2010 a camera observing the global scene was used to return to the vehicles velocity controllers the robots positions and the spline curvature that represented the hose 1 d deformation parabolic curves were used to model the cable profile for cable driven parallel robots where the cable length was regulated through a set of cameras that estimated the relative position between the robotic platform and the control winches dallej et al 2012 the catenary model was used in estevez et al 2015 and estevez and graña 2015 where flexible cables were transported by aerial robots and their relative height was regulated in order to evenly distribute the load between the robots in talke et al 2018 the same model helped to determine the flying space with minimum tension and maximum heave robustness of an aerial robot linked to an autonomous surface vessel rajan et al 2016 implemented entanglement detection thanks to the catenary curve of a tether linking several mobile terrestrial robots exploring cluttered environments in laranjeira et al 2017 the authors used the same model to regulate the shape of a cable linking two terrestrial planar robots this model is improved in this work to depict the shape of a sagging tether between two successive vehicles in the queue since the catenary parametrization compactness is a real advantage for real time vision based control 2 2 visual servoing the use of visual information to control the pose or shape of an object through the movements of a robot is part of the visual servoing framework of study chaumette and hutchinson 2006 2007 first developments on visual servoing addressed the use of image features composed of a set of image point coordinates which have to reach a particular value in the image in order to achieve the specified task feddema et al 1991 allen et al 1993 hashimoto 1993 papanikolopoulos et al 1993 this approach was then generalized to more complex geometrical visual primitives such as lines spheres and cylinders chaumette 1994 this work was concerned with known and simple objects assuming they can be expressed with simple geometrical features points straight lines ellipses etc the group of objects that these methods can be applied to is thus limited models of objects with more complex shape e g polyhedral models marchand et al 1999 or cad computer aided design models comport et al 2004 can be used to perform positioning tasks these model based approaches evolved and were also applied to more complex articulated objects nickels and hutchinson 2001 comport et al 2007 positioning tasks through 2 d visual servoing with respect to planar and motionless objects of unknown shape was achieved in collewet and chaumette 2002 using visual points and in chaumette 2004 using image moments algebraic curves were applied to shape alignment tasks of unknown planar objects in yazicioglu et al 2009 in underwater applications visual servoing has been used in a wide range of situations such as visual navigation gracias et al 2003 autonomous docking park et al 2009 myint et al 2015 yahya and arshad 2016 station keeping marks et al 1994 rives and borrelly 1997 van der zwaan et al 2002 prats et al 2012 arm control marchand et al 2002 xu et al 2019 liang et al 2019 or cable and pipeline inspection rives and borrelly 1997 krupinski et al 2015 allibert et al 2019 hua et al 2014 in most works marks et al 1994 rives and borrelly 1997 lots et al 2001 van der zwaan et al 2002 it is assumed that the robot is stabilized in pitch and roll and that the other degrees of freedom are speed controlled taking only the system kinematics into account recent works deal with the full dynamics of the robot to design more complex control laws allibert et al 2019 hua et al 2014 xu et al 2019 liang et al 2019 gao et al 2019 the features used in underwater visual servoing are similar to those developed for terrestrial robots 2d geometrical features can be extracted in the images such as image points rives and borrelly 1997 gracias et al 2003 prats et al 2012 plücker representation of lines krupinski et al 2015 allibert et al 2019 or higher level features can be estimated such as homography lots et al 2001 van der zwaan et al 2002 hua et al 2014 or even 3d pose marchand et al 2002 yahya and arshad 2016 the visual servo control methods presented above were applied to the control of the robot s pose with respect to rigid or articulated objects that were not attached to the robot and could move independently in the space therefore such approaches seem not to be adapted to tether handling where the cable itself is used as a visual feature since the tether is attached to the robot and its 3 d shape changes with the robot motion this type of visual servoed task aims to achieve a desired shape of the object taking into account its deformation during the handling process contrary to research studies on visual servoing of rigid objects there does not exist much research work on visual servoing on deformable objects the visual deformation control of compliant elastic objects by robot manipulators was addressed in navarro alarcon et al 2013b a where geometric visual features such as points angles and curvatures were used to automatically deform soft objects towards a desired target shape since the proposed method was used to handle objects of unknown shape in a model free approach the deformation jacobian matrix is unknown it is numerically computed through the broyden update rule chaumette and hutchinson 2007 at the control algorithm initialization and at each loop iteration besides the fact that the proposed method is only adapted to elastic deformation other limitations were highlighted the online estimation method presented requires slow motion of the robot manipulators low pass filtering of the observation points and small control gains in order to provide smooth deformation trajectories an improved version of this controller was proposed in navarro alarcon et al 2014 where an energy motived analytical solution for the estimation of the deformation jacobian was presented which contrasts with the previous purely numerical algorithm an innovative representation of object s contours was introduced in navarro alarcon and liu 2018 where a vector of fourier coefficients was used to define the deformation task instead of using feature points to reach a desired angle or curvature in the image the deformation properties of the object were online approximated by a linear deformation model computed from multiple data points collected along the local trajectory however similarly to other model free approaches this method is unable to determine whether a final target shape is physically reachable or not before the task is performed it must be also noticed that since the estimator computes a linearized model that is valid only locally a single approximation cannot in general be used to model the whole properties of the object finally the proposed method can only control 2 d image projections of the observed shapes an application to linear deformation on flexible cables was also reported in zhu et al 2018 deformation control through visual servoing has also been demonstrated to accomplish successfully clothes manipulation tasks in jia et al 2018 a gaussian process regression was used to model and learn the deformation parameters of the object the relation between the robotic end effector s movement and the feature points was mapped through a deformation function which outputs the control velocities in hu et al 2018 the autonomous clothes manipulation problem was addressed in a slightly different manner the relation between visual features and robot s end effector was mapped through a feedback dictionary that was precomputed with task specific training data recently an extensive survey on deformable object sensing and robotic manipulation was reported in sanchez et al 2018 where the reviewed approaches are classified with respect to the geometry and physical properties of the object based on these criteria the work presented here can be classified as deformation control of linear and incompressible objects the focus of this paper is the control of the 3 d shape of a tether linking two underwater robots of similar motion capabilities by using the cable itself as a visual feature robots do not have to be in the camera s field of view neither the attachment points nor the entire tether cable have necessarily to be visible the cable geometric model is known leading to a known parameterized deformation model which differs from previous works on visual servoing of deformable objects navarro alarcon et al 2013a 2014 2016 zhu et al 2018 jia et al 2018 hu et al 2018 where the relation between the robot motion and visual features is numerically estimated online or previously computed through offline training the main contributions of this paper include 1 an image based estimation of the tether parametric catenary shape through an original image fitting procedure 2 the design of a new tether shape controller thanks to a specific model based visual servoing control scheme 3 a theoretical study of singularities and stability analysis of the proposed control scheme 3 system modeling 3 1 assumptions and notations an illustration of the first pair of the robots queue is presented in fig 3 where both cameras film the tether extremities the robots and cameras are named r i and c i respectively where i is the robot index inside the queue the implementation of the vision based tether shape regulation assumes the following i the roll and pitch motion of the robots are regulated at low level to keep the vehicle horizontal ii the position of cameras and tether attachment points are fixed and known with respect to the robots the camera optical axis k c i is aligned with the robot longitudinal axis i r i the frontal camera optical axis points forwards and the rear camera optical axis backwards the camera vertical axis j c i points downwards and is aligned with the robot vertical axis k r i such that j c i k r i iii the difference of height between the tether attachment points can be measured by pressure sensors embedded on the robots iv the tether cable linking both robots can be modeled by a catenary it is negatively buoyant which is frequently the case of tethers and umbilicals that transfer power they are employed in maintenance survey archeological missions khatib et al 2016 or in areas with snagging hazards near the surface of the water such as under ice teleoperations bowen et al 2012 katlein et al 2017 the cable is perfectly inextensible and flexible with constant linear density and cross sectional area the tether plane remains vertical and the cable lowest point is always situated between both attachment points the cable is not instrumented unlike expensive solutions such as smart tethers frank et al 2013 or optical fiber solutions childers et al 2010 that impose constraints on the curvature v the tether has a constant known length and uniform color we note f r i p r i i r i j r i k r i the coordinate frame linked to robot r i p r i is the center of the robot i r i j r i k r i are respectively the robot s longitudinal lateral and vertical axes the coordinate frame f 0 p 0 i 0 j 0 k 0 is attached to the tether lowest point the axis k 0 is vertical and i 0 is horizontal inside the vertical plane where the tether is included the axis j 0 is horizontal and orthogonal to i 0 the tether attachment point coordinate frames are noted f i p i i i j i k i with i 1 2 the frame axes are defined as follows i i j r i k w j r i k w k i k w j i k i i i this means that k i is vertical i i is the intersection of the sagittal plane of the robot r i with the horizontal plane and j i is horizontal and orthogonal to i i the oriented angle from i i to i 0 is named α i the 3 d shape of the tether cable can be defined with respect to frame f 1 or f 2 by three shape parameters the vertical height from the follower or leader side h 1 0 z 1 or h 2 0 z 2 the height offset between the attachment points δ h 1 1 z 2 2 z 1 the orientation angle w r t the longitudinal axis of the robot α 1 arccos i 0 i 1 i 0 i 1 or α 2 arccos i 0 i 2 i 0 i 2 actually f 1 and f 2 are defined to be symmetric and the cable height and half span presented in fig 3 with respect to f 2 can also be defined with respect to f 1 fig 4 presents the symmetry of the cable shape parameters according to f 1 or f 2 the mathematical notation employed throughout this paper is detailed in appendix a 2 3 2 catenary equation the catenary cable equation in the coordinate frame f 0 is johnston et al 2009 1 z 1 c cosh c x 1 where 2 c 2 l 2 2 h δ h 2 2 h δ h 2 l h h δ h l 2 δ h 2 is the catenary constant which is invariant whatever the point p i selected as starting attachment point of the cable c h 1 δ h 1 c h 2 δ h 2 l is the cable length catenary parameter constraints parameters are constrained as follows to make eq 2 valid 3 h 0 4 h δ h 0 5 2 h δ h l where the term below the square root must be positive as well as the denominator inequalities 3 and 4 state that the catenary lowest point is between the attachment points assumption iv if δ h is positive fig 5 a the cable should be long enough to cumulate twice the vertical length h and the height offset δ h the limit case h 0 is when the attachment point p 2 is the lowest point of the catenary if δ h is negative fig 5 b h should be greater than the height offset so that the catenary lowest point still remains between the attachment points the limit case h δ h 0 is when the attachment point p 1 is the lowest point of the catenary the inequality 5 ensures that parameter c remains positive which means that the catenary is not degenerated the degenerated case l 2 h δ h occurs when both attachment points and the lowest point are on the same vertical 3 3 catenary equation in the camera frame the catenary equation can be expressed in frame f 2 as follows 6 2 x cot α 2 y a 2 z 1 c cosh c 2 y sin α 2 d 2 1 h 2 b where 7 d 2 1 c cosh 1 c h 2 1 is obtained evaluating eq 1 at p 2 from assumptions i and ii we can rewrite eq 6 in the follower robot camera frame as 8 c y 1 c cosh c c x c x 2 sin α 2 d 2 1 h 2 c y 2 a c z cot α 2 c x c x 2 c z 2 b in order to simplify writing we used the superscript c instead of c 2 to indicate the follower robot camera frame this notation is used in the sequel to develop the equation of the catenary projection in the image plane the same development could be made for the leader robot camera in frame f c 1 3 4 catenary projection on the image plane in computer vision the most used geometric camera model is the pinhole model which considers that the reflection and diffraction effects can be neglected during light propagation in the camera s lens system and only light refraction is considered ma et al 2012 the model also assumes that the light enters in the camera through a minimal aperture so that all rays are undeflected from the emitting source towards the optical center moreover the intensity measured at a pixel is identical to the amount of energy radiated at the corresponding point in space i e a lambertian surface ma et al 2012 under these conditions the image formation process can be reduced to an ideal perspective projection which is a good geometric approximation of a well focused system a generic point c p a c x a c y a c z a 1 t defined in f c by a vector in homogeneous metric coordinates is projected on the image plane as a point with coordinates p a x a y a 1 t as follows ma et al 2012 9 p a 1 c z a f 0 0 0 0 f 0 0 0 0 1 0 c p a where c z a 0 if the focal length is known it can be normalized to 1 and the eq 9 becomes 10 p a 1 c z a a c p a where a 1 0 0 0 0 1 0 0 0 0 1 0 is called the standard or canonical projection matrix from eqs 8 and 10 we obtain the equation of the catenary projection in the image plane 11 y x 1 c z x cosh c ζ x c d 2 1 c h 2 c y 2 where 12 ζ x c x 2 x c z 2 sin α 2 x cos α 2 13 c z x cot α 2 c x 2 c z 2 1 x cot α 2 x and y are the coordinates of the point belonging to the catenary projection in the image c p 2 c x 2 c y 2 c z 2 1 are the coordinates of attachment point p 2 in the camera frame 4 tether shape estimation 4 1 tether detection the tether shape can be estimated from the camera feedback through the detection of tether points in the image followed by an image fitting procedure matching the catenary model to the tether points laranjeira et al 2019 the tether is detected in the image through color segmentation in the hsv space morphological transformations are also applied to reduce detection noise and fill in the holes in the tether detection zone the detected tether is then shrunk into a thin curve line thanks to a skeletonization procedure the advantage of using color detection in each image instead of a model tracking algorithm is a greater robustness when the tether is partially out of the field of view yet this simple detection needs the object color to be specific in the scene 4 2 shape parameters estimation through curve fitting the catenary 3 d shape is estimated through a nonlinear least square fitting procedure based on the gauss newton algorithm the catenary projection model eq 11 is fitted to the tether detected points in the image since the height offset between the attachment points is directly measured through depth sensors assumption iii there are only two parameters to estimate the vertical height h and the orientation angle α thanks to the symmetry of frames f 1 and f 2 these parameters can be estimated with respect to both leader and follower robots let us remove the subscripts for the remaining of this subsection and define two new normalized parameters 14a a h h m a x with a 0 1 14b b sin α with b 0 1 with h m a x being the maximum acceptable tether height the range of the a parameter is explicit as 0 h h m a x the tether is completely taut when a 0 and it reaches h m a x when a 1 as we consider the same range for the b parameter the orientation angle is considered to be always positive α 0 when α 0 we will use the mirror image in order to comply with these boundaries when b 0 the tether belongs to the plane π p 2 i 2 k 2 and when b 1 it belongs to the plane π p 2 j 2 k 2 these parameters form a feature vector s defined as 15 s a b rewriting eq 11 with these new parameters yields 16 y s x 1 c z cosh c ζ c d 1 c a h m a x c y i where ζ c x i x c z i b x 1 b 2 c z 1 b 2 c x i b c z i b 1 b 2 x and c p i c x i c y i c z i t is the vector containing the coordinates of the tether attachment point i 1 2 in the camera frame f c we used the modified gauss newton reported in laranjeira et al 2019 to estimate the tether shape parameters the cost function is γ s 1 m j 1 m r j 2 s where r j s y j y s x j m n is the total number of detected points x j y j are the metric coordinates of the j th detected point of the tether in the image and y s x j is the tether model given by eq 11 the algorithm is iterated though the following equation 17 s k 1 s k λ j r r s k where k 1 n is the iteration index with n n λ r r s k is a column vector that stacks the residuals r j s k and j r is the moore penrose pseudo inverse of the jacobian matrix given by 18 j r 1 m d r d s whose m th row has the following form j r m 1 m y x m s a y x m s b the expressions of these partial derivatives are given in appendix a 3 the algorithm stops either when the precision threshold ϵ is reached i e γ s k 1 γ s k 0 and γ s k 1 γ s k ϵ or when the cost function increases i e γ s k 1 γ s k 0 or when the maximum number of iterations is reached four new functions were added to the gauss newton in the aim of improving the fitting procedure they are enumerated here below 1 removal of unbounded residuals which limits the residuals computation to a tether feasible depth with respect to the image plane in order to avoid numerical issues on jacobian computation 2 2 d points subsampling to yield a more uniform distribution of points along the tether and speeds up the gauss newton jacobian matrix computation 3 procedure of m estimators huber 1981 pressigout 2006 applied to enhance the tether shape estimation robustness to detection noise 4 bounded iteration procedure s 0 1 0 1 thanks to an adaptive regulation of the iteration gain λ in eq 17 the start point of the fitting procedure s 0 is obtained by calculating an initial catenary that passes through the tether lowest point 4 3 gauss newton jacobian singularities let us study the singularities of the jacobian matrix defined in eq 18 and detailed in appendix a 3 first with respect to the a parameter the cases where the jacobian could be singular are excluded as defined in the conditions of existence of the catenary presented in section 3 2 such cases do not occur since we choose the values of h m a x δ h and the range of the a parameter that avoid it secondly focusing on the partial derivative with respect to the b parameter we find the following singularities 19 1 b 2 0 20 1 b 2 c x 2 b c z 2 0 21 1 b 2 x i b 0 eq 19 represents the case where b sin α 1 thus α 90 and the tether plane is perpendicular to the robot longitudinal plane as shown in fig 6 a considering the experimental setup the cases where α 90 or α 90 will be avoided since the tether is less visible limited camera field of view and it risks of getting entangled with the robot eq 20 represents the case where the catenary plane is aligned with the segment linking the camera center p c to the tether attachment point p 2 as shown in fig 6 b the catenary shape is therefore degenerated into a straight line in the image indeed we have tan α b 1 b 2 c x 2 c z 2 if c x 2 0 this situation occurs when the catenary plane is also aligned with the robot longitudinal axis and thus b 0 fig 6 c eq 21 is a generalization of eq 20 for all points of the tether in the image all points have the same abscissa and thus the catenary projection is degenerated into a vertical line in the image the occurrence of the singularities corresponding to eqs 20 and 21 can be detected by examining the standard deviation of the detected points abscissa as the tether becomes vertically tightened in the image in such cases instead of launching the fitting procedure the previously estimated values of the tether parameters can be maintained other strategies could be adopted which are discussed in section 9 5 catenary interaction matrix the tether shape control proposed here is derived from a catenary based interaction matrix which links the tether shape parameters variations with the robots ego centered velocities namely r i v r i ν r i ω t with i 1 2 the kinematic relationship is established in two steps first the catenary features derivatives are expressed as a function of the attachment points relative velocity namely 2 p 1 or 1 p 2 then the values of 2 p 1 or 1 p 2 are expressed as a function of the robots velocities the resulting kinematic formula are used to determine the catenary based interaction matrix that is at the heart of the tether shape control law 5 1 link between tether shape parameters and attachment points derivatives the feature vector introduced in eq 15 contains two normalized tether shape parameters related to h and α let us introduce a new feature related to δ h from the follower robot s point of view we have 22 d 2 δ h 2 δ h m a x 2 δ h m a x this new feature is also normalized if 2 z 1 0 d 2 0 5 1 else d 2 0 0 5 this means that δ h 2 δ h m a x δ h m a x with δ h m a x being the maximum acceptable height offset between the attachment points we redefine the feature vector as 23 s 2 a 2 b 2 d 2 t similarly from the leader robot side we can define 24 s 1 a 1 b 1 d 1 t where a i h i h m a x b i sin α i and d i δ h i δ h m a x 2 δ h m a x in order to find the relationship between the feature vector time derivative and the coordinates of the attachment points time derivative we conduct the calculation from the follower side using s 2 a 2 b 2 d 2 t and 2 p 1 2 x 1 2 y 1 2 z 1 t the expression regarding the leader robot side will be obtained symmetrically geometrically fig 3 we get 25 2 p 1 2 x 1 2 y 1 2 z 1 2 d 2 δ d 2 1 b 2 2 2 d 2 δ d 2 b 2 2 d 2 δ h m a x δ h m a x f 2 the values of a 2 and b 2 are obtained from the vision system and d 2 from the depth sensors the value of d 2 is obtained thanks to eq 7 that states that p 2 belongs to the catenary similarly we obtain 26 d 2 δ d 2 1 c cosh 1 c h 2 δ h 2 1 which states that p 1 belongs to the catenary differentiating eq 25 leads to 27 2 p 1 2 d 2 δ d 2 1 b 2 2 2 d 2 δ d 2 b 2 1 b 2 2 b 2 2 d 2 δ d 2 b 2 2 d 2 δ d 2 b 2 2 d 2 δ h m a x f 2 the next step is to compute the time variation of the shape features a 2 b 2 abd d 2 as a function of the time variation of the tether attachment point coordinates 2 x 1 2 y 1 and 2 z 1 d 2 is obtained directly from eq 22 28 d 2 δ h 2 2 δ h m a x 2 z 1 2 δ h m a x eq 27 leads to 29 2 d 2 δ d 2 1 b 2 2 2 x 1 b 2 2 y 1 and 30 b 2 1 b 2 2 2 d 2 δ d 2 b 2 2 x 1 1 b 2 2 2 y 1 from eq 14a we get 31 a 2 h 2 h m a x the differentiation of eqs 7 and 26 yields 32 d 2 p 2 h 2 q 2 δ h 2 33 d 2 δ d 2 u 2 h 2 v 2 δ h 2 with p 2 c l d 2 c h 2 c sinh c d 2 u 2 c l δ d 2 c h 2 c sinh c d 2 δ d 2 q 2 l d 2 c δ h 2 c sinh c d 2 v 2 c l δ d 2 c δ h 2 c sinh c d 2 δ d 2 l δ d 2 h 2 δ h 2 d 2 δ d 2 sinh c d 2 δ d 2 l d 2 h 2 d 2 sinh c d 2 the expression of the partial derivatives c h 2 and c δ h 2 are given in appendix a 4 summing eqs 32 and 33 yields 34 2 d 2 δ d 2 u 2 p 2 h 2 v 2 q 2 δ h 2 and combining eqs 28 29 31 and 34 leads to 35 a 2 1 b 2 2 2 x 1 b 2 2 y 1 v 2 q 2 2 z 1 u 2 p 2 h m a x finally eqs 35 30 and 28 can be combined in matrix form 36 s 2 m 2 2 p 1 symmetrically 37 s 1 m 1 1 p 2 with m i 1 b i 2 u i p i h m a x b i u i p i h m a x v i q i u i p i h m a x b i 1 b i 2 2 d i δ d i 1 b i 2 2 d i δ d i 0 0 0 1 2 δ h m a x 5 2 link between tether attachment points derivatives and robots velocities the relation between the leader attachment point time derivative and both robots velocities is expressed as see appendix a 5 for kinematics developments 38 2 p 1 t r 2 2 r 2 v r 2 v r 1 r 1 v where t r 2 2 i 3 3 r 2 p 1 r 2 v r 1 r 2 r r 1 r 2 p r 1 r 2 r r 1 0 r 2 r r 1 and x is the skew matrix defined from vector x from the leader robot side we have 39 1 p 2 t r 2 1 r 2 v r 2 v r 1 r 1 v with t r 2 1 t r 1 1 r 1 v r 2 t r 1 1 i 3 3 r 1 p 2 the vectors r 2 p r 1 r 2 p 1 and r 1 p 2 can be calculated from the catenary features remember eq 25 and assumption ii as well as the rotation matrix r 2 r r 1 r 2 r r 1 cos α 2 α 1 sin α 2 α 1 0 sin α 2 α 1 cos α 2 α 1 0 0 0 1 6 dof interaction matrix replacing eq 38 in 36 leads to 40 s 2 l r 2 2 r 2 v r 2 v r 1 r 1 v with l r 2 2 m 2 t r 2 2 the matrix l r 2 2 is the interaction matrix that links the velocity of both robots with the time derivative of the feature vector s 2 for the leader robot features we have 41 s 1 l r 2 1 r 2 v r 2 v r 1 r 1 v with l r 2 1 m 1 t r 2 1 4 dof interaction matrix we remove the visual servoing control of roll and pitch rotations letting a low level control scheme regulate them as a matter of fact the calculation of the pseudo inverse of the complete interaction matrix involves a minimization of the norm of r 2 v and of the norm of s 2 l r 2 2 r 2 v which can generate values for ω x and ω y that may disturb the low level control used for the stabilization of the vehicle therefore instead of considering all the degrees of freedom of the robot the following trimmed interaction matrix is used excluding robot s roll and pitch control s 2 l r 2 2 3 4 r 2 v 3 4 with l r 2 2 3 4 m 2 1 0 0 r 2 y 1 0 1 0 r 2 x 1 0 0 1 0 r 2 v 3 4 r 2 ν x r 2 ν y r 2 ν z r 2 ω z t the matrix l r 2 2 3 4 is given in its developed form in eq 42 in a similar way we can calculate the matrices l r 2 1 3 4 l r 1 2 3 4 and l r 1 1 3 4 removing the roll and pitch degrees of freedom from matrices t r 2 1 t r 1 2 and t r 1 1 42 l r 2 2 3 4 1 b 2 2 u 2 p 2 h m a x b 2 u 2 p 2 h m a x v 2 q 2 u 2 p 2 h m a x r 2 y 1 1 b 2 2 r 2 x 1 b 2 u 2 p 2 h m a x b 2 1 b 2 2 2 d 2 δ d 2 1 b 2 2 2 d 2 δ d 2 0 r 2 y 1 b 2 1 b 2 2 r 2 x 1 1 b 2 2 2 d 2 δ d 2 0 0 1 2 δ h m a x 0 singularities of the interaction matrix the rank of matrix l r 2 2 3 4 ranges between 2 and 3 since there are at least two independent columns including the third one the fourth column is a linear combination of the first and second columns therefore the rank is reduced to 2 when the first and second columns are linked which occurs when the determinant of the submatrix l r 2 2 3 4 1 2 1 2 is zero 1 b 2 2 u 2 p 2 h m a x 2 d 2 δ d 2 0 which corresponds to 43 1 b 2 0 the eq 43 represents the cases where b sin α 1 thus α 90 and the tether plane is perpendicular to the robot longitudinal plane in such cases the first column of the interaction matrix is zero this produces a loss of control of the longitudinal velocity these cases will be avoided since the tether is less visible limited camera field of view and it risks of becoming entangled with the robot analyzing the matrix l r 2 2 3 4 we note that it can be singular due to infinite values if 44 2 d 2 δ d 2 0 45 u 2 p 2 0 eq 44 corresponds to a tether whose span is zero attachments points on the same vertical which is not possible eq 45 corresponds to a singularity that never occurs because u 2 p 2 0 and keeps a negative sign if u 2 p 2 were to become zero according to eq 34 it would mean that the span between the tether attachment points could be changed whatever the tether height which is impossible another explanation can be given by considering a fixed δ h 2 in eq 34 as 2 d 2 δ d 2 u 2 p 2 h 2 if the catenary span is extended 2 d 2 δ d 2 increases and the height h 2 decreases which means that 2 d 2 δ d 2 is positive and h 2 is negative therefore u 2 p 2 0 conversely if the catenary span is reduced 2 d 2 δ d 2 decreases and the height h 2 increases which means that 2 d 2 δ d 2 is negative and h 2 is positive also leading to u 2 p 2 0 6 tether shape control laws the tether shape defined by s 1 or s 2 is regulated through an appropriate movement of the follower robot which is commanded by a velocity control law the roll and pitch motions are not controlled from the visual servo control hence 3 by 4 interaction matrices are used to simplify writing we note from now on l r 2 2 l r 2 2 3 4 l r 1 2 l r 1 2 3 4 l r 2 1 l r 2 1 3 4 l r 1 1 l r 1 1 3 4 r 2 v r 2 v 3 4 and r 1 v r 1 v 3 4 6 1 using the follower camera the error vector e 2 between the current and the desired feature vector s 2 is defined as 46 e 2 s 2 s 2 the error vector time derivative is therefore 47 e 2 s 2 from eqs 40 and 47 we have 48 l r 2 2 r 2 v r 2 v r 1 r 1 v e 2 setting e 2 λ e 2 for exponential convergence with λ r the follower command velocity can be calculated as follows chaumette and hutchinson 2006 49 r 2 v λ l r 2 2 e 2 r 2 v r 1 r 1 v where l r 2 2 is the moore penrose pseudo inverse of l r 2 2 if the leader robot is motionless or its velocity commands are ignored or considered as disturbances eq 49 becomes 50 r 2 v λ l r 2 2 e 2 6 2 using both leader and follower cameras the system we want to control has 4 degrees of freedom dof as presented in figs 3 and 4 1 the tether plane orientation with respect to the leader robot α 1 2 the tether plane orientation with respect to the follower robot α 2 3 the height offset between the attachment points δ h 1 δ h 2 4 the horizontal distance between the attachment points 2 d 1 δ d 1 2 d 2 δ d 2 which is actually a function of the tether height as defined in eqs 7 and 26 the control schemes introduced in the previous subsection do not allow to control all the dof of the system since the angle α 1 is not regulated therefore the relative pose between leader and follower robots is not fully constrained as shown in fig 7 using only the follower robot s camera it is possible to control three tether features h 2 α 2 and δ h 2 through the interaction matrix given in eq 42 the rank of this matrix is 3 which does not constrain all the degrees of freedom of the system in order to constrain the relative pose between the robots we use the leader camera to obtain additional information and regulate the angle α 1 see box i one way of controlling all the 4 dof of the tether robots system is to use the following feature vector 52 s f s 2 b 1 where s 2 and b 1 are respectively given in eqs 23 and 24 therefore a new interaction matrix can be defined for the regulation of s f by the follower robot motion as follows 53 s f l r 2 2 l r 2 1 2 r 2 v l r 2 f r 2 v where the interaction matrix l r 2 f is composed of the matrix l r 2 2 and the second line of the matrix l r 2 1 the matrix l r 2 f is given in its developed form in eq 51 where s 21 sin α 2 α 1 and c 21 cos α 2 α 1 the follower robot control law is calculated through 54 r 2 v λ l r 2 f e f r 2 v r 1 r 1 v where e f s f s f and s f is the desired feature vector for a motionless leader robot it comes 55 r 2 v λ l r 2 f e f 6 3 stability analysis this section is devoted to the stability analysis of the tether control system in the presence of estimation errors in the feature vector the task under study is the regulation of the feature vector s 2 if we take into account estimation errors in the control then the tracking error e 2 follows a first order differential equation as 56 e 2 λ l r 2 2 l r 2 2 e 2 where l r 2 2 is the moore penrose pseudo inverse of the estimation of the interaction matrix l r 2 2 that is used for the command of the system the evolution of e 2 is globally asymptotically stable when the following condition is ensured chaumette and hutchinson 2006 57 l r 2 2 l r 2 2 0 in the case of a perfect estimation of the shape parameters all three eigenvalues are equal to 1 and e 2 λ e 2 in the case of estimation errors it is hard to check whether condition 57 is satisfied or not because the interaction matrix l r 2 2 varies with the real time estimation of the features and it is not possible to decouple the interaction matrix however local asymptotic stability can be analyzed by linearizing eq 56 near the desired feature state as 58 e 2 λ l r 2 2 l r 2 2 e 2 where l r 2 2 is the interaction matrix relative to desired feature vector s 2 and l r 2 2 is the pseudo inverse of the interaction matrix that incorporates estimation errors on the feature vector at the desired parameters let us check the local convergence of our system by evaluating the interaction matrix l r 2 2 at s 2 0 5 0 5 0 5 t and adding approximation errors in the computation of its pseudo inverse through the a 2 and b 2 parameters the third parameter is fixed at d 2 0 5 which corresponds to δ h 2 0 m fig 8 presents the variations of the two conjugated eigenvalues of l r 2 2 l r 2 2 other than 1 the third eigenvalue is always 1 since the third row of l r 2 2 has only one non zero constant all the real parts of the eigenvalues must be positive to ensure the local asymptotic stability of the system this is the case for the selected desired state even for large estimation errors of up to 40 the same analysis was conducted for other desired states and produced similar results it should be noticed that the eigenvalues remain real quantities when estimation errors are added to the b parameter only which corresponds to the vertical line at a 0 5 in the graphs however the eigenvalues quickly become complex quantities with non zero imaginary part when estimation errors are added to the a parameter which may lead to an oscillatory but stable response of the system the greater the estimation error the greater the rate of the oscillation the oscillatory influence of estimation errors of the a parameter could be explained by the fact that they modify the shape of the catenary whereas estimation errors on the b parameter has no influence on the catenary shape since it only represents the orientation angle between the tether plane and the robot longitudinal axis 7 simulation results this section presents the simulation results for the control laws given in eqs 49 50 and 54 simulations are carried out on gazebo koenig and howard 2004 using the uuv unmanned underwater vehicle package manhães et al 2016 this simulation environment comprises all aspects of tether shape estimation from detection to fitting the ground truth for the tether features is calculated as follows the height h results from the search for the cable lowest link and the z coordinates of the tether attachment points the orientation angle α is calculated thanks to the 3 d pose of the robots the value of δ h is directly obtained from the difference of height between the first and last link of the tether the simulation ground truth is useful to demonstrate the accuracy of the procedures of tether shape estimation and control in ideal conditions the simulation scenario is composed of two bluerov1 connected by a sagging orange tether fig 9 the robots are equipped with simulated pressure sensors frontal and rear cameras hydrodynamics was only considered for the robots motion thanks to the fossen equations fossen 2011 and water viscous forces exerted on the tether cable were neglected the robot s hydrodynamic parameters used in the simulations are available in aili and ekelund 2016 the simulated tether is composed of 150 links of 0 01 m length connected by spherical ball joints it is 0 003 m thick has a total length of 1 50 m and a total mass of 0 150 kg the maximal height is set at h m a x 0 70 m the maximum attachment point height offset is set at δ h m a x 0 50 m the control loop runs at 30 hz three simulations are carried out 1 the leader robot remains motionless and the follower robot uses its onboard camera to bring the tether towards its desired shape the control law given in eq 50 is applied 2 the leader robot remains motionless and the follower robot uses both cameras to bring the tether towards its desired shape the control law given in eq 54 is applied 3 the follower robot uses its onboard camera to maintain the tether at its desired shape while the leader robot executes a predefined path the control laws given in eqs 49 and 50 are applied extension 1 gives complementary information about these simulations 7 1 using only the follower camera leader robot motionless in this simulation the follower robot must bring the tether towards its desired shape as given in table 1 and depicted in fig 10 the control gain is set to λ 1 0 at the starting point the leader robot is outside the camera field of view and the tether is only partially visible in the image the objective is to bring the tether into the camera field of view in order to ensure an accurate estimation of its shape in addition the tether is to be maintained not too slack in order to prevent it from getting entangled with obstacles the robot s commands and the tether shape evolution from visual feedback estimation and simulation ground truth are depicted in fig 11 in the beginning of the simulation 0 80 iterations the tether shape estimation is not accurate mainly with respect to the parameter α 2 indeed as presented in fig 10 a the tether is almost a straight line in the image initially and the catenary curve fitting procedure cannot yield an accurate estimation of its shape despite this the control loop brings the tether towards its desired shape in the image fig 10 d and the tether features h 2 α 2 and δ h 2 converge towards their desired values all robot s commands decay after the 80th iteration the time the tether lowest point takes to come back into the camera field of view the robot commanded velocities are nearly zero after the 240th iteration since the tether reaches its desired shape 7 2 using both leader and follower cameras leader robot motionless the initial and desired tether shape are given in table 2 and the corresponding onboard images are depicted in fig 12 at the beginning the tether is partially visible in both leader and follower cameras the tether shape evolution and the follower robots commands are depicted in fig 13 the control gain is λ 0 5 similarly to the results obtained using only the follower camera at the beginning of the simulation 0 60 iterations the curve fitting algorithm could not yield an accurate estimation of the tether shape as it is almost a straight line in the images at the starting point fig 12 e the estimation and ground truth curves meet after the 60th iteration when the tether is completely visible in both images we notice a greater oscillation of the estimated values of α 2 when compared to the results obtained in section 7 1 this is caused by a greater lateral motion of the follower robot when only the follower s camera is used to regulate the tether shape the tether orientation is mainly regulated by a rotation ω z of the follower robot and the lateral motion ν y is almost zero fig 11 it can be seen that the regulation of the feature b 1 requires significant lateral movements of the follower robot whereas the regulation of the feature b 2 mainly induces rotational motion this is the expected behavior from the definitions of the two angles α 1 and α 2 the lateral velocity ν y causes a swinging motion of the tether which is responsible for the oscillations on α 1 and α 2 these oscillations do not appear on the ground truth curve because the calculation is based only on the tether attachment points that do not oscillate despite the initial inaccuracies on shape estimation and the swinging motion of the cable the control loop brings the tether towards its desired shape in the image figs 12 d the robot commanded velocities are nearly zero after the 300th iteration as the tether reaches its desired shape 7 3 using only the follower camera while the leader robot executes a path the leader path consists of a constant speed straight forward displacement combined with lateral and vertical motions the leader robot executed velocities are depicted in fig 14 all the way through the follower robot must maintain the tether desired shape given in table 3 two control laws are tested first the leader velocity commands are ignored eq 50 and the leader motion can be seen as an additional perturbation to the tether shape regulation task second the leader velocity commands are included in the follower robot control law eq 49 the control gain is set to λ 2 0 fig 15 presents the tether shape evolution and follower robot velocity commands at the beginning 0 80 iterations we observe a greater control effort to bring the tether from its initial to its desired height h 0 0 43 m and h 0 35 m respectively during the lateral motion of the leader 100 750 iterations the controller achieves to maintain the tether near its desired shape a gap between current and desired tether shape is expected since the leader motion is not considered in the follower commands which are always lagged when the leader executes vertical displacements 900 1500 iterations we observe a slight disturbance on the regulation of the tether height as δ h and h are linked by the catenary parameter c eq 2 assuming that both robots can communicate through the connecting tether we can include the leader robot velocity in the follower command as presented in eq 50 fig 16 presents the simulation results at the beginning 0 80 iterations the follower robot brings the tether towards its desired shape which is maintained for the rest of the simulation some little perturbations are observed in the change of direction of the robot leader around the 400th 900th and 1200th iteration the oscillations of the forward velocity command ν x can be reduced through the use of a lower control gain since the leader motion is included in the follower commands we note that the follower robot executes a forward ν x and lateral ν y velocities during a large part of the simulation starting from 400th iteration until the end this occurs because the follower robot must keep its desired orientation α 2 with respect to the tether while following the leader robot by regulating h 2 leader and follower robots do not have the same heading the comparison of figs 15 and 16 shows that there is only a slight difference between the graphs of tether shape evolution around 0 05 m and 5 the control law that includes the leader robot velocity allows to remove most of the residual tracking error on the features the follower robot achieves to manage the tether shape even when the leader movements are not taken into account in the control law in the next section dedicated to real experiments the leader robot will be kept fixed and larger disturbances will be applied to the follower robot in order to evaluate the control law robustness 8 experimental results two experiments were carried out in the experimental pool depicted in fig 17 the pool has 9 7 m of total length width of 3 0 m and depth of 1 0 m in the first experiment section 8 1 the follower robot uses only its onboard camera to maintain the tether at its desired shape in the second experiment section 8 2 both leader and follower cameras are used in order to constrain all the dof of the system the experimental platforms for the leader and follower robots are respectively the 5 dof bluerov2 and the 6 dof bluerov1 models of mini rovs bluerobotics 2019 the models are depicted in fig 18 and a comparison of their features is presented in table 4 the tether prototype used in the experiments is made of a leaded curtain yarn wrapped in an orange fabric fig 19 it is 1 50 m long 0 01 m thick and weighs 0 050 kg it was built to mimic a negatively buoyant perfectly flexible and inextensible underwater tether it can be attached to the robots or to a fixed point on the side wall of the pool thanks to a suction cup unlike the simulations the control laws used here include an integral term in addition to the proportional this was necessary in order to compensate the cable weight and the thrusters deadband the control laws given in eqs 50 and 55 are thus rewritten as 59 r 2 v λ p l r 2 2 e 2 λ i l r 2 2 k 0 k m a x 40 e 2 60 r 2 v λ p l r 2 f e f λ i l r 2 f k 0 k m a x 40 e f where λ p λ i are vectors containing positive gains and k is the integration time eqs 59 and 60 are used in sections 8 1 and 8 2 respectively 8 1 using only the follower camera in this experiment the follower robot must maintain the tether at the desired shape given in table 5 the robot is then disturbed through the application of external forces fig 20 two disturbances are carried out a pull and a rotation motion as shown in fig 21 a sequence of the robot onboard images during the disturbances is depicted in fig 22 extension 2 appendix a 1 gives complementary information about this experiment the control gains are λ p 0 5 0 5 0 5 0 2 t λ i 0 005 0 005 0 005 0 001 t and the integration time is k 40 iterations the curves of tether shape evolution and robot velocity commands for both perturbations are presented in figs 23 and 24 in the first perturbation fig 23 the robot is pulled and sunk as a result the tether becomes almost a vertical line in the camera view fig 22 b the height h and the height offset between attachment points δ h increase reaching values of 0 40 m and 0 30 m respectively the robot moves backwards and upwards in order to meet the desired shape parameters within 50 iterations in the second perturbation fig 24 the robot is rotated so that the tether changes side in the image moving from the left side to the right side figs 22 a and 22 c as a result the tether orientation angle becomes negative and the robot executes a combination of rotational lateral and backwards movements in order to bring the tether back to its desired shape between the 60th and 75th iterations the tether is barely visible in the image which leads to an erroneously estimation of a taut tether h 0 10 m by the curve fitting algorithm another situation of tether hard shape estimation occurs during the crossing of α 0 when the catenary shape degenerates into a vertical line in the image 8 2 using both leader and follower cameras in this experiment both leader and follower cameras are used to regulate all the 4 dof of the tether robots system the desired tether shape parameters are shown in table 6 the leader robot is kept fixed stopped and the follower is displaced through the application of an external force fig 25 as the robots relative pose is fully constrained the follower robot must return to the initial position corresponding to the tether desired shape in both images a top view of the experimental scene in presented in fig 26 and complementary information about this experiment is available in extension 3 appendix a 1 the control gains are λ p 0 3 0 3 0 3 0 15 t λ i 0 003 0 0 0 005 0 0 t and the integration time is k 60 iterations the curves of tether shape evolution and the follower robot velocity commands during the disturbance are presented in fig 27 at the beginning the follower robot is at its desired position and the tether shape parameters are regulated at their desired values around the 60th iteration the follower robot is displaced both orientation angles become positive and the tether changes side in both images some overshoots in the commands are observed around the 150 th and the 440 th iteration due to noisy tether shape estimation during the crossing of the singularity α i 0 the follower robot executes a main lateral motion ν y along with some rotations ω z in order to bring the tether back to their desired shape in both images 9 discussion tether detection and shape estimation the proposed procedure of tether detection and shape estimation has been demonstrated to be robust to image noise and yielded accurate results in the experiments carried out in the experimental pool the catenary projection equation may also be used to implement a model tracker marchand and chaumette 2005 the detection will then be more robust to color absorption in real scene and the local detection and shape fitting included may help to remove outliers however these algorithms need to be adapted to our images especially when only a small portion of the tether is visible regarding curve fitting the orthogonal distance between detected points and estimated curve could be also computed however this increases the complexity and thus computing time of the fitting procedure since another minimization problem must be included in the estimation loop to find the orthogonal distance other optimization algorithms could be investigated for example the feature vector boundaries could be managed through a barrier function like in interior point methods in addition inequality constraints could be added to the problem tether shape control the proposed tether shape control scheme was proved to properly manage the tether shape even in conditions of coarse tether shape estimation such as cable partial visibility the controller achieves to bring the tether towards its desired position in the image the controller has also proved to be robust to external perturbations such as unexpected movements of the leader robot in simulation and the application of external forces in experimentation the relative pose between leader and follower robots can be constrained if the tether shape is regulated simultaneously in both images which has been achieved in simulation and real experiments the use of the tether as a visual feature frees robots from being constantly present in each other s field of view the tether can be used as a means of robot s relative position estimation when they cannot see each other as long as a portion of the tether is in the field of view of their cameras a low level velocity controller based on dvl doppler velocity log feedback could be implemented in order to further improve the tether handling capability of our proposed control scheme when the tether converges to its desired position the zero speed commands are sent to the thrusters null velocity commands execution must be ensured by the low level velocity controller in order to maintain the robot stopped at its desired position and avoid any drift the implementation of such low level controller would lead to the reduction of the slight oscillations of the robot around its desired position singularity α i 0 the fitting procedure used here cannot yield an accurate and stable tether shape estimation when the attachment point and the camera optical center are aligned as a result the tether becomes a vertical line in the image with our robots this situation occurs when α i 0 this singularity can be avoided through the addition of another camera that films the tether from another point of view hence this degenerated case will never occur simultaneously in both images and the fusion of such complementary visual information would lead to an accurate tether shape estimation in a wider workspace in this work the previously estimated features are maintained during the crossing of the singularity α i 0 this yields flat estimation curves around this singularity instead of unstable values if the fitting procedure were launched another technique is to predict the features evolution through numerical schemes euler or runge kutta within a limited horizon of time folio and cadenat 2007 another solution would be to change the controlled features instead of using the catenary shape parameters other visual features could be used during the crossing of the singularity it is one of our perspectives to investigate the use of pure image based features such as image points and line segments or the use of the catenary lowest point in the image the complete catenary based controller could be used most of the time while another more simple features could be used only for crossing the singularity influence of tether attachment point position the tether attachment point position in the camera frame has a non negligible influence on the fitting since it defines the departing point of the tether in the image in this work we assumed that this position is a known constant this assumption could be relaxed if a procedure of calibration was implemented where the attachment point position could be estimated from the positions of the tether detected points on the top of the image modeling the cable model studied is the catenary which is adapted for sagging cable modeling such as negatively buoyant tethers the features issued from the catenary model the height and orientation parameters have the great advantage of giving a physical and intelligible notion of the cable 3 d shape the catenary model presented here can be further improved the tether plane may no more be assumed to remain vertical and the robots roll and pitch angles could be included in the equation of the catenary projection in the image plane assumptions i and iv in order to catch the tether swing motion other sensors such as 3 d accelerometers can be added to the tether ends and provide additional information about its shape merlet 2018a the cable plane vertical orientation and its departure angles could be estimated from the accelerometers inclination with respect to the gravitational field this additional data can be used together with the visual feedback in order to produce a more robust shape estimation namely in complex scenes where tether detection may be less accurate the physical interaction between tether robots and surrounding water can be studied in an hydrodynamic modeling of the system taking into account the tether weight and drag would be helpful to achieve a more precise cable handling other features could also be investigated such as parabolas splines and fourier coefficients although their parameters reflect a less physical notion of the cable shape 10 conclusions this paper has introduced a new catenary based visual servoing control scheme for tether shape regulation this controller was validated in simulations and experiments in a pool where a pair of small underwater robots a leader and a follower were connected by a tether the controller enabled the follower robot to regulate the tether shape using only the robots sensory feedback as the tether was not equipped with any additional sensor the tether was detected in the cameras through color segmentation and its 3 d shape parameters were estimated in real time thanks to a curve fitting procedure based on the gauss newton algorithm the 3 d shape was then regulated through visual servoing based on the catenary model of the cable for the best of our knowledge it is the first time that the shape regulation of a linear deformable object is achieved by means of visual servoing through a pure analytical modeling of the object shape the proposed control law was tested in a number of simulations demonstrating its reliability in situations of cable partial visibility and leader unexpected motion the controller was also demonstrated to remain stable even in cases of large up to 40 tether shape estimation errors the robustness of the control scheme was checked through the application of disturbing external forces moreover the obtained results showed that the relative pose between robots can be constrained through tether shape regulation in both leader and follower images future work will address the navigation of a whole queue of robots assuming that the control scheme introduced in this paper manages the shape of a tether linking a pair of robots the high level controller must manage the relative position between the robots depending on the situation at hand if small cavities are to be crossed the robots must be mostly aligned otherwise when exploring open sites it would be better to have the robots more laterally spaced in order to have a wider perception of the environment finally a hierarchical control scheme can be used so that priority can be given to the tether orientation or height depending on the situation credit authorship contribution statement matheus laranjeira conceptualization investigation formal analysis methodology software validation claire dune conceptualization investigation formal analysis methodology software validation vincent hugel conceptualization investigation formal analysis methodology software validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was achieved thanks to specific funding from the france sud region and the french subseatech company located in marseille south east of france http www subsea tech com the authors would also like to thank the french engineering school seatech and the mio lab for allowing the use of the experimental pool appendix a 1 index to multimedia extensions see table 7 here below a 2 notation f a an euclidean reference frame f a p a i a j a k a consists of an origin p a and an orthonormal basis i a j a k a b p a a vector containing the cartesian coordinates of a 3 d point b p a b x a b y a b z a t represents the coordinates of p a in frame f b b p a the total derivative of b p a with respect to frame f b and expressed in frame f b b p a a vector containing the homogeneous coordinates of a 3 d point b p a b p a 1 t b r a a 3 d rotation matrix from frame f a to frame f b b v a the velocity screw vector b v a b ν a b ω a t of point p a expressed in the coordinate frame f b b ν a and b ω a are respectively the linear and angular components of the velocity vector a 3 gauss newton jacobian derivatives the gauss newton jacobian j r was defined in eq 18 it is rewritten here as a reminder j r 1 m d r d s whose m th row is j r m 1 m y x m s a y x m s b the derivative of the catenary projection equation see eq 16 with respect to parameters a h h m a x and b sin α is y x m s a 1 c z 1 c a cosh c ζ c d 1 sinh c ζ c d c a 1 a 2 a 3 h m a x y x m s b 1 c z b cosh c ζ c d 1 c h y c i 1 c z ζ b sinh c ζ c d where ζ c x i x c z i b x 1 b 2 c z 1 b 2 c x i b c z i b 1 b 2 x a 1 ζ c a a 2 d c a and a 3 c d a we also have d a 1 c a acosh c h 1 c a h c h m a x c c h 2 2 c h 1 z c b x c i z c i x m 1 b 2 1 b 2 x c i b z c i 2 ζ b x c i z c i x m 1 b 2 b x m 1 b 2 b 1 b 2 x m 2 c a c h d h d a 1 c a 1 c h d h d a and d h d a h m a x the partial derivatives c h and 1 c h are given in appendix a 4 a 4 partial derivatives of c let us rewrite eq 2 as c 2 c n c d 2 2 h δ h 2 l h h δ h l 2 δ h 2 l 2 2 h δ h 2 the partial derivatives of c with respect to h and δ h are c h 2 c n h c d c d h c n c d 2 1 c h c d h c n c n h c d 2 c n 2 c n h 2 l 2 h δ h h h δ h l 2 δ h 2 c d h 4 2 h δ h c δ h 2 c n δ h c d c d δ h c n c d 2 c n δ h 1 l h l 2 2 h δ h δ h 2 l 2 δ h 2 3 2 h h δ h c d δ h 2 2 h δ h a 5 calculation of attachment points derivatives let us define the vector from p 2 to p 1 noted p 2 p 1 the time derivative with respect to frame f 2 is developed to introduce the robots velocities in the following way 61 d p 2 p 1 d t f 2 d p 2 p 1 d t f w ω 2 p 2 p 1 where ω 2 is the angular velocity of f 2 with respect to f w from the chasles relation we obtain d p 2 p 1 d t f 2 d p 2 p r 2 d t f w d p r 2 p w d t f w d p w p r 1 d t f w d p r 1 p 1 d t f w ω 2 p 2 p 1 noting d p w p r 1 d t f w ν r 1 and d p r 2 p w d t f w ν r 2 we have d p 2 p 1 d t f 2 d p 2 p r 2 d t f w ν r 2 ν r 1 d p r 1 p 1 d t f w ω 2 p 2 p 1 expressing the derivatives d p 2 p r 2 d t f w and d p r 1 p 1 d t f w in the robot s frames we have d p 2 p 1 d t f 2 d p 2 p r 2 d t f r 2 ω r 2 p 2 p r 2 ν r 2 ν r 1 d p r 1 p 1 d t f r 1 ω r 1 p r 1 p 1 ω 2 p 2 p 1 knowing that d p 2 p r 2 d t f r 2 0 and d p r 1 p 1 d t f r 1 0 see assumption ii we finally obtain 62 d p 2 p 1 d t f 2 ν r 1 ω r 1 p r 1 p 1 ν r 2 ω r 2 p r 2 p 2 ω 2 p 2 p 1 if the robot remains horizontal see assumption i f 2 and f r 2 have the same orientation and ω 2 ω r 2 therefore 63 d p 2 p 1 d t f 2 ν r 1 ω r 1 p r 1 p 1 ν r 2 ω r 2 p r 2 p 2 p 2 p 1 let us note 2 p 1 the velocity of p 1 with respect to frame f 2 expressed in f 2 2 p 1 2 d p 2 p 1 d t f 2 we also note r i v r i r i ν r i r i ω r i t the velocity vector defined at p r i center of the robot r i and expressed in frame f r i in order to simplify the writing we note for now on this ego centered velocity as r i v r i ν r i ω t we can rewrite eq 63 in matrix form 64 2 p 1 t r 2 2 r 2 v r 2 v r 1 r 1 v where t r 2 2 i 3 3 r 2 p 1 r 2 v r 1 r 2 r r 1 r 2 p r 1 r 2 r r 1 0 r 2 r r 1 and x is the skew matrix defined from vector x appendix b supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2020 107018 appendix b supplementary data the following is the supplementary material related to this article video s1 simulation results on tether shape control video s2 experimental results using only the follower camera video s3 experimental results using both leader and follower cameras 
22032,this paper deals with the shape control of a passive tether that links underwater vehicles the pair of robots is composed of a leader that explores the environment and a follower that is in charge of regulating the tether shape by moving appropriately both robots are equipped with standard low cost sensors cameras depth sensor and inertial measurement unit imu this work introduces an innovative visual servoing control scheme based on a parameterized catenary model of the tether assuming that it is negatively buoyant the tether is detected in the image through color segmentation and its 3 d shape parameters are estimated through a nonlinear optimization procedure thanks to an adapted gauss newton algorithm simulations and experimental results show that the relative positioning of the robots can be achieved through simultaneous tether shape visual servoing in both leader and follower s cameras even in situations of tether partial visibility and strong disturbances which proves the approach to be reliable keywords underwater robotics visual servoing control sensory based robot control 1 introduction underwater remotely operated vehicles rovs are suited to explore complex and unstructured environments where robotic tasks cannot be carried out in complete autonomy therefore requiring continuous human intervention the surface vessel where the human operator is located is connected to the robot via an underwater tether that ensures data exchange power supply and provides mechanical support however tethers can have negative impacts onto the rov when they transmit disturbances caused by the swell and surface currents it generates drag force and can get entangled with drifting or fixed objects for large working rovs standard tether management solutions based on tether management systems tms abel 1994 and heave compensators hc yang et al 2008 huster et al 2009 have proven to be efficient in exploration missions in deep open waters where the robot has enough space to maneuver and the risks of tether entanglement are reduced fig 1 the tms is a system of winches controlled by a human operator and attached to the rov housing cage abel 1994 it aims to regulate the amount of unwound tether cable leaving the housing cage allowing the robot to move in the working area the operation of a tms is a complex task and it is considered by many operators as similar as operating a secondary rov christ and wernli sr 2013 heave compensators are passive huster et al 2009 or active yang et al 2008 systems of winches employed to compensate the heave motion of the surface vessel it aims to regulate the slackness of the cable linking the surface vessel to the underwater cage where the tms is located fig 1 this portion of cable is often named umbilical another way to reduce the disturbance forces of the tether cable on the rov is to actuate the surface vessel so that it tracks the rov in its horizontal displacements in triantafyllou and grosenbaugh 1991 hydrophones and submerged pingers were used to position an intermediate passive vehicle with the aim of absorbing disturbances and maintaining the tether slack near the rov in prabhakar and buckham 2005 this approach is evolved and a decoupled controller is proposed for the positioning of a tether point near the rov however these approaches require the use of additional external sensors hydrophones and pingers to achieve the dynamic positioning when it comes to exploring confined and cluttered spaces such as underwater coastal zones caves and wrecks the management of the tether is still a challenge the exploration of shallow waters and narrow spaces is preferably carried out by small tethered underwater robots also called mini rovs pacunski et al 2008 contrary to the large rovs mentioned above these small robots are less powerful and they are more easily disturbed by the efforts produced by the cable in khatib et al 2016 an upper intermediate robot was used as a power relay station between the surface vessel and a bottom robot that was dedicated to archeological tasks to reduce risks of entanglements the intermediate robot was teleoperated or switched to autonomous mode relying on a vision based tracking algorithm of the bottom robot regardless of the umbilical shape this paper introduces the concept of a queue of tethered mini vehicles where each pair of consecutive mini vehicles is connected by a cable fig 2 here the presence of the cable is considered an advantage and it is used as a feature by the robots to control their positioning to obtain a given tether shape the mini vehicles play the role of actuators that can change the shape of all the inter connecting cables which is useful to avoid tether entanglement and allow the exploration of cluttered and confined spaces the main objective is to make the robots able to position themselves inside the queue thanks to an original visual servoing of the tether which has not yet been investigated to the authors knowledge this study focuses in particular on the shape regulation of a sagging tether linking two successive robots inside the queue the leader and its immediate follower the leader must be able to freely explore its surroundings while the follower is expected to manage the tether shape through its own motion so as not to hinder the leader s movements by maintaining the cable in a desired shape neither too tight nor too loose to avoid entanglements the tether is modeled by a catenary and the robots are equipped with low cost standard sensors frontal rear cameras depth sensor and an inertial measurement unit imu which are the only sensors to be used the article is structured as follows section 2 presents prior work on cable and deformable objects modeling and a background of visual servoing section 3 introduces the model of a pair of robots linked by a tether and section 4 presents the algorithm used to detect and estimate the tether 3 d shape in section 5 the catenary based interaction matrices are developed which lead to the design of the tether shape regulation control laws presented in section 6 simulation and experimental results are provided in sections 7 and 8 respectively section 9 discusses the results and section 10 gives concluding remarks and perspectives 2 related work 2 1 cables and deformable objects modeling numerical models can be used to represent the tether shape in underwater applications in buckham et al 2004 the 3 d motion of slack and low tension cables was modeled thanks to the finite element method rao 2017 other finite element formulations can be applied to high tension cables quan et al 2015 in eidsvik and schjølberg 2016 finite element models were also used to solve the euler bernoulli beam equation and model the interaction forces between tether cable and rov the shortcoming of these approaches is that they depend on the knowledge of the relative position between ship and rov which implies the use of external acoustic positioning systems considering a passive and uninstrumented tether a parameterized model of the cable can be used if the cable departure angles or attachment points relative position is known the most complete cable model in the air relies on the irvine equation irvine 1981 which is a complex model but has been shown to be very realistic merlet 2018b tether and deformable objects handling is a challenge also found in some fields of application other than the underwater environment in order to achieve real time control parametric models have been used since they have the great advantage of speeding up the computational time of the control loop spline curves were used to model a flexible hose that is transported by a team of terrestrial robots echegoyen et al 2010 a camera observing the global scene was used to return to the vehicles velocity controllers the robots positions and the spline curvature that represented the hose 1 d deformation parabolic curves were used to model the cable profile for cable driven parallel robots where the cable length was regulated through a set of cameras that estimated the relative position between the robotic platform and the control winches dallej et al 2012 the catenary model was used in estevez et al 2015 and estevez and graña 2015 where flexible cables were transported by aerial robots and their relative height was regulated in order to evenly distribute the load between the robots in talke et al 2018 the same model helped to determine the flying space with minimum tension and maximum heave robustness of an aerial robot linked to an autonomous surface vessel rajan et al 2016 implemented entanglement detection thanks to the catenary curve of a tether linking several mobile terrestrial robots exploring cluttered environments in laranjeira et al 2017 the authors used the same model to regulate the shape of a cable linking two terrestrial planar robots this model is improved in this work to depict the shape of a sagging tether between two successive vehicles in the queue since the catenary parametrization compactness is a real advantage for real time vision based control 2 2 visual servoing the use of visual information to control the pose or shape of an object through the movements of a robot is part of the visual servoing framework of study chaumette and hutchinson 2006 2007 first developments on visual servoing addressed the use of image features composed of a set of image point coordinates which have to reach a particular value in the image in order to achieve the specified task feddema et al 1991 allen et al 1993 hashimoto 1993 papanikolopoulos et al 1993 this approach was then generalized to more complex geometrical visual primitives such as lines spheres and cylinders chaumette 1994 this work was concerned with known and simple objects assuming they can be expressed with simple geometrical features points straight lines ellipses etc the group of objects that these methods can be applied to is thus limited models of objects with more complex shape e g polyhedral models marchand et al 1999 or cad computer aided design models comport et al 2004 can be used to perform positioning tasks these model based approaches evolved and were also applied to more complex articulated objects nickels and hutchinson 2001 comport et al 2007 positioning tasks through 2 d visual servoing with respect to planar and motionless objects of unknown shape was achieved in collewet and chaumette 2002 using visual points and in chaumette 2004 using image moments algebraic curves were applied to shape alignment tasks of unknown planar objects in yazicioglu et al 2009 in underwater applications visual servoing has been used in a wide range of situations such as visual navigation gracias et al 2003 autonomous docking park et al 2009 myint et al 2015 yahya and arshad 2016 station keeping marks et al 1994 rives and borrelly 1997 van der zwaan et al 2002 prats et al 2012 arm control marchand et al 2002 xu et al 2019 liang et al 2019 or cable and pipeline inspection rives and borrelly 1997 krupinski et al 2015 allibert et al 2019 hua et al 2014 in most works marks et al 1994 rives and borrelly 1997 lots et al 2001 van der zwaan et al 2002 it is assumed that the robot is stabilized in pitch and roll and that the other degrees of freedom are speed controlled taking only the system kinematics into account recent works deal with the full dynamics of the robot to design more complex control laws allibert et al 2019 hua et al 2014 xu et al 2019 liang et al 2019 gao et al 2019 the features used in underwater visual servoing are similar to those developed for terrestrial robots 2d geometrical features can be extracted in the images such as image points rives and borrelly 1997 gracias et al 2003 prats et al 2012 plücker representation of lines krupinski et al 2015 allibert et al 2019 or higher level features can be estimated such as homography lots et al 2001 van der zwaan et al 2002 hua et al 2014 or even 3d pose marchand et al 2002 yahya and arshad 2016 the visual servo control methods presented above were applied to the control of the robot s pose with respect to rigid or articulated objects that were not attached to the robot and could move independently in the space therefore such approaches seem not to be adapted to tether handling where the cable itself is used as a visual feature since the tether is attached to the robot and its 3 d shape changes with the robot motion this type of visual servoed task aims to achieve a desired shape of the object taking into account its deformation during the handling process contrary to research studies on visual servoing of rigid objects there does not exist much research work on visual servoing on deformable objects the visual deformation control of compliant elastic objects by robot manipulators was addressed in navarro alarcon et al 2013b a where geometric visual features such as points angles and curvatures were used to automatically deform soft objects towards a desired target shape since the proposed method was used to handle objects of unknown shape in a model free approach the deformation jacobian matrix is unknown it is numerically computed through the broyden update rule chaumette and hutchinson 2007 at the control algorithm initialization and at each loop iteration besides the fact that the proposed method is only adapted to elastic deformation other limitations were highlighted the online estimation method presented requires slow motion of the robot manipulators low pass filtering of the observation points and small control gains in order to provide smooth deformation trajectories an improved version of this controller was proposed in navarro alarcon et al 2014 where an energy motived analytical solution for the estimation of the deformation jacobian was presented which contrasts with the previous purely numerical algorithm an innovative representation of object s contours was introduced in navarro alarcon and liu 2018 where a vector of fourier coefficients was used to define the deformation task instead of using feature points to reach a desired angle or curvature in the image the deformation properties of the object were online approximated by a linear deformation model computed from multiple data points collected along the local trajectory however similarly to other model free approaches this method is unable to determine whether a final target shape is physically reachable or not before the task is performed it must be also noticed that since the estimator computes a linearized model that is valid only locally a single approximation cannot in general be used to model the whole properties of the object finally the proposed method can only control 2 d image projections of the observed shapes an application to linear deformation on flexible cables was also reported in zhu et al 2018 deformation control through visual servoing has also been demonstrated to accomplish successfully clothes manipulation tasks in jia et al 2018 a gaussian process regression was used to model and learn the deformation parameters of the object the relation between the robotic end effector s movement and the feature points was mapped through a deformation function which outputs the control velocities in hu et al 2018 the autonomous clothes manipulation problem was addressed in a slightly different manner the relation between visual features and robot s end effector was mapped through a feedback dictionary that was precomputed with task specific training data recently an extensive survey on deformable object sensing and robotic manipulation was reported in sanchez et al 2018 where the reviewed approaches are classified with respect to the geometry and physical properties of the object based on these criteria the work presented here can be classified as deformation control of linear and incompressible objects the focus of this paper is the control of the 3 d shape of a tether linking two underwater robots of similar motion capabilities by using the cable itself as a visual feature robots do not have to be in the camera s field of view neither the attachment points nor the entire tether cable have necessarily to be visible the cable geometric model is known leading to a known parameterized deformation model which differs from previous works on visual servoing of deformable objects navarro alarcon et al 2013a 2014 2016 zhu et al 2018 jia et al 2018 hu et al 2018 where the relation between the robot motion and visual features is numerically estimated online or previously computed through offline training the main contributions of this paper include 1 an image based estimation of the tether parametric catenary shape through an original image fitting procedure 2 the design of a new tether shape controller thanks to a specific model based visual servoing control scheme 3 a theoretical study of singularities and stability analysis of the proposed control scheme 3 system modeling 3 1 assumptions and notations an illustration of the first pair of the robots queue is presented in fig 3 where both cameras film the tether extremities the robots and cameras are named r i and c i respectively where i is the robot index inside the queue the implementation of the vision based tether shape regulation assumes the following i the roll and pitch motion of the robots are regulated at low level to keep the vehicle horizontal ii the position of cameras and tether attachment points are fixed and known with respect to the robots the camera optical axis k c i is aligned with the robot longitudinal axis i r i the frontal camera optical axis points forwards and the rear camera optical axis backwards the camera vertical axis j c i points downwards and is aligned with the robot vertical axis k r i such that j c i k r i iii the difference of height between the tether attachment points can be measured by pressure sensors embedded on the robots iv the tether cable linking both robots can be modeled by a catenary it is negatively buoyant which is frequently the case of tethers and umbilicals that transfer power they are employed in maintenance survey archeological missions khatib et al 2016 or in areas with snagging hazards near the surface of the water such as under ice teleoperations bowen et al 2012 katlein et al 2017 the cable is perfectly inextensible and flexible with constant linear density and cross sectional area the tether plane remains vertical and the cable lowest point is always situated between both attachment points the cable is not instrumented unlike expensive solutions such as smart tethers frank et al 2013 or optical fiber solutions childers et al 2010 that impose constraints on the curvature v the tether has a constant known length and uniform color we note f r i p r i i r i j r i k r i the coordinate frame linked to robot r i p r i is the center of the robot i r i j r i k r i are respectively the robot s longitudinal lateral and vertical axes the coordinate frame f 0 p 0 i 0 j 0 k 0 is attached to the tether lowest point the axis k 0 is vertical and i 0 is horizontal inside the vertical plane where the tether is included the axis j 0 is horizontal and orthogonal to i 0 the tether attachment point coordinate frames are noted f i p i i i j i k i with i 1 2 the frame axes are defined as follows i i j r i k w j r i k w k i k w j i k i i i this means that k i is vertical i i is the intersection of the sagittal plane of the robot r i with the horizontal plane and j i is horizontal and orthogonal to i i the oriented angle from i i to i 0 is named α i the 3 d shape of the tether cable can be defined with respect to frame f 1 or f 2 by three shape parameters the vertical height from the follower or leader side h 1 0 z 1 or h 2 0 z 2 the height offset between the attachment points δ h 1 1 z 2 2 z 1 the orientation angle w r t the longitudinal axis of the robot α 1 arccos i 0 i 1 i 0 i 1 or α 2 arccos i 0 i 2 i 0 i 2 actually f 1 and f 2 are defined to be symmetric and the cable height and half span presented in fig 3 with respect to f 2 can also be defined with respect to f 1 fig 4 presents the symmetry of the cable shape parameters according to f 1 or f 2 the mathematical notation employed throughout this paper is detailed in appendix a 2 3 2 catenary equation the catenary cable equation in the coordinate frame f 0 is johnston et al 2009 1 z 1 c cosh c x 1 where 2 c 2 l 2 2 h δ h 2 2 h δ h 2 l h h δ h l 2 δ h 2 is the catenary constant which is invariant whatever the point p i selected as starting attachment point of the cable c h 1 δ h 1 c h 2 δ h 2 l is the cable length catenary parameter constraints parameters are constrained as follows to make eq 2 valid 3 h 0 4 h δ h 0 5 2 h δ h l where the term below the square root must be positive as well as the denominator inequalities 3 and 4 state that the catenary lowest point is between the attachment points assumption iv if δ h is positive fig 5 a the cable should be long enough to cumulate twice the vertical length h and the height offset δ h the limit case h 0 is when the attachment point p 2 is the lowest point of the catenary if δ h is negative fig 5 b h should be greater than the height offset so that the catenary lowest point still remains between the attachment points the limit case h δ h 0 is when the attachment point p 1 is the lowest point of the catenary the inequality 5 ensures that parameter c remains positive which means that the catenary is not degenerated the degenerated case l 2 h δ h occurs when both attachment points and the lowest point are on the same vertical 3 3 catenary equation in the camera frame the catenary equation can be expressed in frame f 2 as follows 6 2 x cot α 2 y a 2 z 1 c cosh c 2 y sin α 2 d 2 1 h 2 b where 7 d 2 1 c cosh 1 c h 2 1 is obtained evaluating eq 1 at p 2 from assumptions i and ii we can rewrite eq 6 in the follower robot camera frame as 8 c y 1 c cosh c c x c x 2 sin α 2 d 2 1 h 2 c y 2 a c z cot α 2 c x c x 2 c z 2 b in order to simplify writing we used the superscript c instead of c 2 to indicate the follower robot camera frame this notation is used in the sequel to develop the equation of the catenary projection in the image plane the same development could be made for the leader robot camera in frame f c 1 3 4 catenary projection on the image plane in computer vision the most used geometric camera model is the pinhole model which considers that the reflection and diffraction effects can be neglected during light propagation in the camera s lens system and only light refraction is considered ma et al 2012 the model also assumes that the light enters in the camera through a minimal aperture so that all rays are undeflected from the emitting source towards the optical center moreover the intensity measured at a pixel is identical to the amount of energy radiated at the corresponding point in space i e a lambertian surface ma et al 2012 under these conditions the image formation process can be reduced to an ideal perspective projection which is a good geometric approximation of a well focused system a generic point c p a c x a c y a c z a 1 t defined in f c by a vector in homogeneous metric coordinates is projected on the image plane as a point with coordinates p a x a y a 1 t as follows ma et al 2012 9 p a 1 c z a f 0 0 0 0 f 0 0 0 0 1 0 c p a where c z a 0 if the focal length is known it can be normalized to 1 and the eq 9 becomes 10 p a 1 c z a a c p a where a 1 0 0 0 0 1 0 0 0 0 1 0 is called the standard or canonical projection matrix from eqs 8 and 10 we obtain the equation of the catenary projection in the image plane 11 y x 1 c z x cosh c ζ x c d 2 1 c h 2 c y 2 where 12 ζ x c x 2 x c z 2 sin α 2 x cos α 2 13 c z x cot α 2 c x 2 c z 2 1 x cot α 2 x and y are the coordinates of the point belonging to the catenary projection in the image c p 2 c x 2 c y 2 c z 2 1 are the coordinates of attachment point p 2 in the camera frame 4 tether shape estimation 4 1 tether detection the tether shape can be estimated from the camera feedback through the detection of tether points in the image followed by an image fitting procedure matching the catenary model to the tether points laranjeira et al 2019 the tether is detected in the image through color segmentation in the hsv space morphological transformations are also applied to reduce detection noise and fill in the holes in the tether detection zone the detected tether is then shrunk into a thin curve line thanks to a skeletonization procedure the advantage of using color detection in each image instead of a model tracking algorithm is a greater robustness when the tether is partially out of the field of view yet this simple detection needs the object color to be specific in the scene 4 2 shape parameters estimation through curve fitting the catenary 3 d shape is estimated through a nonlinear least square fitting procedure based on the gauss newton algorithm the catenary projection model eq 11 is fitted to the tether detected points in the image since the height offset between the attachment points is directly measured through depth sensors assumption iii there are only two parameters to estimate the vertical height h and the orientation angle α thanks to the symmetry of frames f 1 and f 2 these parameters can be estimated with respect to both leader and follower robots let us remove the subscripts for the remaining of this subsection and define two new normalized parameters 14a a h h m a x with a 0 1 14b b sin α with b 0 1 with h m a x being the maximum acceptable tether height the range of the a parameter is explicit as 0 h h m a x the tether is completely taut when a 0 and it reaches h m a x when a 1 as we consider the same range for the b parameter the orientation angle is considered to be always positive α 0 when α 0 we will use the mirror image in order to comply with these boundaries when b 0 the tether belongs to the plane π p 2 i 2 k 2 and when b 1 it belongs to the plane π p 2 j 2 k 2 these parameters form a feature vector s defined as 15 s a b rewriting eq 11 with these new parameters yields 16 y s x 1 c z cosh c ζ c d 1 c a h m a x c y i where ζ c x i x c z i b x 1 b 2 c z 1 b 2 c x i b c z i b 1 b 2 x and c p i c x i c y i c z i t is the vector containing the coordinates of the tether attachment point i 1 2 in the camera frame f c we used the modified gauss newton reported in laranjeira et al 2019 to estimate the tether shape parameters the cost function is γ s 1 m j 1 m r j 2 s where r j s y j y s x j m n is the total number of detected points x j y j are the metric coordinates of the j th detected point of the tether in the image and y s x j is the tether model given by eq 11 the algorithm is iterated though the following equation 17 s k 1 s k λ j r r s k where k 1 n is the iteration index with n n λ r r s k is a column vector that stacks the residuals r j s k and j r is the moore penrose pseudo inverse of the jacobian matrix given by 18 j r 1 m d r d s whose m th row has the following form j r m 1 m y x m s a y x m s b the expressions of these partial derivatives are given in appendix a 3 the algorithm stops either when the precision threshold ϵ is reached i e γ s k 1 γ s k 0 and γ s k 1 γ s k ϵ or when the cost function increases i e γ s k 1 γ s k 0 or when the maximum number of iterations is reached four new functions were added to the gauss newton in the aim of improving the fitting procedure they are enumerated here below 1 removal of unbounded residuals which limits the residuals computation to a tether feasible depth with respect to the image plane in order to avoid numerical issues on jacobian computation 2 2 d points subsampling to yield a more uniform distribution of points along the tether and speeds up the gauss newton jacobian matrix computation 3 procedure of m estimators huber 1981 pressigout 2006 applied to enhance the tether shape estimation robustness to detection noise 4 bounded iteration procedure s 0 1 0 1 thanks to an adaptive regulation of the iteration gain λ in eq 17 the start point of the fitting procedure s 0 is obtained by calculating an initial catenary that passes through the tether lowest point 4 3 gauss newton jacobian singularities let us study the singularities of the jacobian matrix defined in eq 18 and detailed in appendix a 3 first with respect to the a parameter the cases where the jacobian could be singular are excluded as defined in the conditions of existence of the catenary presented in section 3 2 such cases do not occur since we choose the values of h m a x δ h and the range of the a parameter that avoid it secondly focusing on the partial derivative with respect to the b parameter we find the following singularities 19 1 b 2 0 20 1 b 2 c x 2 b c z 2 0 21 1 b 2 x i b 0 eq 19 represents the case where b sin α 1 thus α 90 and the tether plane is perpendicular to the robot longitudinal plane as shown in fig 6 a considering the experimental setup the cases where α 90 or α 90 will be avoided since the tether is less visible limited camera field of view and it risks of getting entangled with the robot eq 20 represents the case where the catenary plane is aligned with the segment linking the camera center p c to the tether attachment point p 2 as shown in fig 6 b the catenary shape is therefore degenerated into a straight line in the image indeed we have tan α b 1 b 2 c x 2 c z 2 if c x 2 0 this situation occurs when the catenary plane is also aligned with the robot longitudinal axis and thus b 0 fig 6 c eq 21 is a generalization of eq 20 for all points of the tether in the image all points have the same abscissa and thus the catenary projection is degenerated into a vertical line in the image the occurrence of the singularities corresponding to eqs 20 and 21 can be detected by examining the standard deviation of the detected points abscissa as the tether becomes vertically tightened in the image in such cases instead of launching the fitting procedure the previously estimated values of the tether parameters can be maintained other strategies could be adopted which are discussed in section 9 5 catenary interaction matrix the tether shape control proposed here is derived from a catenary based interaction matrix which links the tether shape parameters variations with the robots ego centered velocities namely r i v r i ν r i ω t with i 1 2 the kinematic relationship is established in two steps first the catenary features derivatives are expressed as a function of the attachment points relative velocity namely 2 p 1 or 1 p 2 then the values of 2 p 1 or 1 p 2 are expressed as a function of the robots velocities the resulting kinematic formula are used to determine the catenary based interaction matrix that is at the heart of the tether shape control law 5 1 link between tether shape parameters and attachment points derivatives the feature vector introduced in eq 15 contains two normalized tether shape parameters related to h and α let us introduce a new feature related to δ h from the follower robot s point of view we have 22 d 2 δ h 2 δ h m a x 2 δ h m a x this new feature is also normalized if 2 z 1 0 d 2 0 5 1 else d 2 0 0 5 this means that δ h 2 δ h m a x δ h m a x with δ h m a x being the maximum acceptable height offset between the attachment points we redefine the feature vector as 23 s 2 a 2 b 2 d 2 t similarly from the leader robot side we can define 24 s 1 a 1 b 1 d 1 t where a i h i h m a x b i sin α i and d i δ h i δ h m a x 2 δ h m a x in order to find the relationship between the feature vector time derivative and the coordinates of the attachment points time derivative we conduct the calculation from the follower side using s 2 a 2 b 2 d 2 t and 2 p 1 2 x 1 2 y 1 2 z 1 t the expression regarding the leader robot side will be obtained symmetrically geometrically fig 3 we get 25 2 p 1 2 x 1 2 y 1 2 z 1 2 d 2 δ d 2 1 b 2 2 2 d 2 δ d 2 b 2 2 d 2 δ h m a x δ h m a x f 2 the values of a 2 and b 2 are obtained from the vision system and d 2 from the depth sensors the value of d 2 is obtained thanks to eq 7 that states that p 2 belongs to the catenary similarly we obtain 26 d 2 δ d 2 1 c cosh 1 c h 2 δ h 2 1 which states that p 1 belongs to the catenary differentiating eq 25 leads to 27 2 p 1 2 d 2 δ d 2 1 b 2 2 2 d 2 δ d 2 b 2 1 b 2 2 b 2 2 d 2 δ d 2 b 2 2 d 2 δ d 2 b 2 2 d 2 δ h m a x f 2 the next step is to compute the time variation of the shape features a 2 b 2 abd d 2 as a function of the time variation of the tether attachment point coordinates 2 x 1 2 y 1 and 2 z 1 d 2 is obtained directly from eq 22 28 d 2 δ h 2 2 δ h m a x 2 z 1 2 δ h m a x eq 27 leads to 29 2 d 2 δ d 2 1 b 2 2 2 x 1 b 2 2 y 1 and 30 b 2 1 b 2 2 2 d 2 δ d 2 b 2 2 x 1 1 b 2 2 2 y 1 from eq 14a we get 31 a 2 h 2 h m a x the differentiation of eqs 7 and 26 yields 32 d 2 p 2 h 2 q 2 δ h 2 33 d 2 δ d 2 u 2 h 2 v 2 δ h 2 with p 2 c l d 2 c h 2 c sinh c d 2 u 2 c l δ d 2 c h 2 c sinh c d 2 δ d 2 q 2 l d 2 c δ h 2 c sinh c d 2 v 2 c l δ d 2 c δ h 2 c sinh c d 2 δ d 2 l δ d 2 h 2 δ h 2 d 2 δ d 2 sinh c d 2 δ d 2 l d 2 h 2 d 2 sinh c d 2 the expression of the partial derivatives c h 2 and c δ h 2 are given in appendix a 4 summing eqs 32 and 33 yields 34 2 d 2 δ d 2 u 2 p 2 h 2 v 2 q 2 δ h 2 and combining eqs 28 29 31 and 34 leads to 35 a 2 1 b 2 2 2 x 1 b 2 2 y 1 v 2 q 2 2 z 1 u 2 p 2 h m a x finally eqs 35 30 and 28 can be combined in matrix form 36 s 2 m 2 2 p 1 symmetrically 37 s 1 m 1 1 p 2 with m i 1 b i 2 u i p i h m a x b i u i p i h m a x v i q i u i p i h m a x b i 1 b i 2 2 d i δ d i 1 b i 2 2 d i δ d i 0 0 0 1 2 δ h m a x 5 2 link between tether attachment points derivatives and robots velocities the relation between the leader attachment point time derivative and both robots velocities is expressed as see appendix a 5 for kinematics developments 38 2 p 1 t r 2 2 r 2 v r 2 v r 1 r 1 v where t r 2 2 i 3 3 r 2 p 1 r 2 v r 1 r 2 r r 1 r 2 p r 1 r 2 r r 1 0 r 2 r r 1 and x is the skew matrix defined from vector x from the leader robot side we have 39 1 p 2 t r 2 1 r 2 v r 2 v r 1 r 1 v with t r 2 1 t r 1 1 r 1 v r 2 t r 1 1 i 3 3 r 1 p 2 the vectors r 2 p r 1 r 2 p 1 and r 1 p 2 can be calculated from the catenary features remember eq 25 and assumption ii as well as the rotation matrix r 2 r r 1 r 2 r r 1 cos α 2 α 1 sin α 2 α 1 0 sin α 2 α 1 cos α 2 α 1 0 0 0 1 6 dof interaction matrix replacing eq 38 in 36 leads to 40 s 2 l r 2 2 r 2 v r 2 v r 1 r 1 v with l r 2 2 m 2 t r 2 2 the matrix l r 2 2 is the interaction matrix that links the velocity of both robots with the time derivative of the feature vector s 2 for the leader robot features we have 41 s 1 l r 2 1 r 2 v r 2 v r 1 r 1 v with l r 2 1 m 1 t r 2 1 4 dof interaction matrix we remove the visual servoing control of roll and pitch rotations letting a low level control scheme regulate them as a matter of fact the calculation of the pseudo inverse of the complete interaction matrix involves a minimization of the norm of r 2 v and of the norm of s 2 l r 2 2 r 2 v which can generate values for ω x and ω y that may disturb the low level control used for the stabilization of the vehicle therefore instead of considering all the degrees of freedom of the robot the following trimmed interaction matrix is used excluding robot s roll and pitch control s 2 l r 2 2 3 4 r 2 v 3 4 with l r 2 2 3 4 m 2 1 0 0 r 2 y 1 0 1 0 r 2 x 1 0 0 1 0 r 2 v 3 4 r 2 ν x r 2 ν y r 2 ν z r 2 ω z t the matrix l r 2 2 3 4 is given in its developed form in eq 42 in a similar way we can calculate the matrices l r 2 1 3 4 l r 1 2 3 4 and l r 1 1 3 4 removing the roll and pitch degrees of freedom from matrices t r 2 1 t r 1 2 and t r 1 1 42 l r 2 2 3 4 1 b 2 2 u 2 p 2 h m a x b 2 u 2 p 2 h m a x v 2 q 2 u 2 p 2 h m a x r 2 y 1 1 b 2 2 r 2 x 1 b 2 u 2 p 2 h m a x b 2 1 b 2 2 2 d 2 δ d 2 1 b 2 2 2 d 2 δ d 2 0 r 2 y 1 b 2 1 b 2 2 r 2 x 1 1 b 2 2 2 d 2 δ d 2 0 0 1 2 δ h m a x 0 singularities of the interaction matrix the rank of matrix l r 2 2 3 4 ranges between 2 and 3 since there are at least two independent columns including the third one the fourth column is a linear combination of the first and second columns therefore the rank is reduced to 2 when the first and second columns are linked which occurs when the determinant of the submatrix l r 2 2 3 4 1 2 1 2 is zero 1 b 2 2 u 2 p 2 h m a x 2 d 2 δ d 2 0 which corresponds to 43 1 b 2 0 the eq 43 represents the cases where b sin α 1 thus α 90 and the tether plane is perpendicular to the robot longitudinal plane in such cases the first column of the interaction matrix is zero this produces a loss of control of the longitudinal velocity these cases will be avoided since the tether is less visible limited camera field of view and it risks of becoming entangled with the robot analyzing the matrix l r 2 2 3 4 we note that it can be singular due to infinite values if 44 2 d 2 δ d 2 0 45 u 2 p 2 0 eq 44 corresponds to a tether whose span is zero attachments points on the same vertical which is not possible eq 45 corresponds to a singularity that never occurs because u 2 p 2 0 and keeps a negative sign if u 2 p 2 were to become zero according to eq 34 it would mean that the span between the tether attachment points could be changed whatever the tether height which is impossible another explanation can be given by considering a fixed δ h 2 in eq 34 as 2 d 2 δ d 2 u 2 p 2 h 2 if the catenary span is extended 2 d 2 δ d 2 increases and the height h 2 decreases which means that 2 d 2 δ d 2 is positive and h 2 is negative therefore u 2 p 2 0 conversely if the catenary span is reduced 2 d 2 δ d 2 decreases and the height h 2 increases which means that 2 d 2 δ d 2 is negative and h 2 is positive also leading to u 2 p 2 0 6 tether shape control laws the tether shape defined by s 1 or s 2 is regulated through an appropriate movement of the follower robot which is commanded by a velocity control law the roll and pitch motions are not controlled from the visual servo control hence 3 by 4 interaction matrices are used to simplify writing we note from now on l r 2 2 l r 2 2 3 4 l r 1 2 l r 1 2 3 4 l r 2 1 l r 2 1 3 4 l r 1 1 l r 1 1 3 4 r 2 v r 2 v 3 4 and r 1 v r 1 v 3 4 6 1 using the follower camera the error vector e 2 between the current and the desired feature vector s 2 is defined as 46 e 2 s 2 s 2 the error vector time derivative is therefore 47 e 2 s 2 from eqs 40 and 47 we have 48 l r 2 2 r 2 v r 2 v r 1 r 1 v e 2 setting e 2 λ e 2 for exponential convergence with λ r the follower command velocity can be calculated as follows chaumette and hutchinson 2006 49 r 2 v λ l r 2 2 e 2 r 2 v r 1 r 1 v where l r 2 2 is the moore penrose pseudo inverse of l r 2 2 if the leader robot is motionless or its velocity commands are ignored or considered as disturbances eq 49 becomes 50 r 2 v λ l r 2 2 e 2 6 2 using both leader and follower cameras the system we want to control has 4 degrees of freedom dof as presented in figs 3 and 4 1 the tether plane orientation with respect to the leader robot α 1 2 the tether plane orientation with respect to the follower robot α 2 3 the height offset between the attachment points δ h 1 δ h 2 4 the horizontal distance between the attachment points 2 d 1 δ d 1 2 d 2 δ d 2 which is actually a function of the tether height as defined in eqs 7 and 26 the control schemes introduced in the previous subsection do not allow to control all the dof of the system since the angle α 1 is not regulated therefore the relative pose between leader and follower robots is not fully constrained as shown in fig 7 using only the follower robot s camera it is possible to control three tether features h 2 α 2 and δ h 2 through the interaction matrix given in eq 42 the rank of this matrix is 3 which does not constrain all the degrees of freedom of the system in order to constrain the relative pose between the robots we use the leader camera to obtain additional information and regulate the angle α 1 see box i one way of controlling all the 4 dof of the tether robots system is to use the following feature vector 52 s f s 2 b 1 where s 2 and b 1 are respectively given in eqs 23 and 24 therefore a new interaction matrix can be defined for the regulation of s f by the follower robot motion as follows 53 s f l r 2 2 l r 2 1 2 r 2 v l r 2 f r 2 v where the interaction matrix l r 2 f is composed of the matrix l r 2 2 and the second line of the matrix l r 2 1 the matrix l r 2 f is given in its developed form in eq 51 where s 21 sin α 2 α 1 and c 21 cos α 2 α 1 the follower robot control law is calculated through 54 r 2 v λ l r 2 f e f r 2 v r 1 r 1 v where e f s f s f and s f is the desired feature vector for a motionless leader robot it comes 55 r 2 v λ l r 2 f e f 6 3 stability analysis this section is devoted to the stability analysis of the tether control system in the presence of estimation errors in the feature vector the task under study is the regulation of the feature vector s 2 if we take into account estimation errors in the control then the tracking error e 2 follows a first order differential equation as 56 e 2 λ l r 2 2 l r 2 2 e 2 where l r 2 2 is the moore penrose pseudo inverse of the estimation of the interaction matrix l r 2 2 that is used for the command of the system the evolution of e 2 is globally asymptotically stable when the following condition is ensured chaumette and hutchinson 2006 57 l r 2 2 l r 2 2 0 in the case of a perfect estimation of the shape parameters all three eigenvalues are equal to 1 and e 2 λ e 2 in the case of estimation errors it is hard to check whether condition 57 is satisfied or not because the interaction matrix l r 2 2 varies with the real time estimation of the features and it is not possible to decouple the interaction matrix however local asymptotic stability can be analyzed by linearizing eq 56 near the desired feature state as 58 e 2 λ l r 2 2 l r 2 2 e 2 where l r 2 2 is the interaction matrix relative to desired feature vector s 2 and l r 2 2 is the pseudo inverse of the interaction matrix that incorporates estimation errors on the feature vector at the desired parameters let us check the local convergence of our system by evaluating the interaction matrix l r 2 2 at s 2 0 5 0 5 0 5 t and adding approximation errors in the computation of its pseudo inverse through the a 2 and b 2 parameters the third parameter is fixed at d 2 0 5 which corresponds to δ h 2 0 m fig 8 presents the variations of the two conjugated eigenvalues of l r 2 2 l r 2 2 other than 1 the third eigenvalue is always 1 since the third row of l r 2 2 has only one non zero constant all the real parts of the eigenvalues must be positive to ensure the local asymptotic stability of the system this is the case for the selected desired state even for large estimation errors of up to 40 the same analysis was conducted for other desired states and produced similar results it should be noticed that the eigenvalues remain real quantities when estimation errors are added to the b parameter only which corresponds to the vertical line at a 0 5 in the graphs however the eigenvalues quickly become complex quantities with non zero imaginary part when estimation errors are added to the a parameter which may lead to an oscillatory but stable response of the system the greater the estimation error the greater the rate of the oscillation the oscillatory influence of estimation errors of the a parameter could be explained by the fact that they modify the shape of the catenary whereas estimation errors on the b parameter has no influence on the catenary shape since it only represents the orientation angle between the tether plane and the robot longitudinal axis 7 simulation results this section presents the simulation results for the control laws given in eqs 49 50 and 54 simulations are carried out on gazebo koenig and howard 2004 using the uuv unmanned underwater vehicle package manhães et al 2016 this simulation environment comprises all aspects of tether shape estimation from detection to fitting the ground truth for the tether features is calculated as follows the height h results from the search for the cable lowest link and the z coordinates of the tether attachment points the orientation angle α is calculated thanks to the 3 d pose of the robots the value of δ h is directly obtained from the difference of height between the first and last link of the tether the simulation ground truth is useful to demonstrate the accuracy of the procedures of tether shape estimation and control in ideal conditions the simulation scenario is composed of two bluerov1 connected by a sagging orange tether fig 9 the robots are equipped with simulated pressure sensors frontal and rear cameras hydrodynamics was only considered for the robots motion thanks to the fossen equations fossen 2011 and water viscous forces exerted on the tether cable were neglected the robot s hydrodynamic parameters used in the simulations are available in aili and ekelund 2016 the simulated tether is composed of 150 links of 0 01 m length connected by spherical ball joints it is 0 003 m thick has a total length of 1 50 m and a total mass of 0 150 kg the maximal height is set at h m a x 0 70 m the maximum attachment point height offset is set at δ h m a x 0 50 m the control loop runs at 30 hz three simulations are carried out 1 the leader robot remains motionless and the follower robot uses its onboard camera to bring the tether towards its desired shape the control law given in eq 50 is applied 2 the leader robot remains motionless and the follower robot uses both cameras to bring the tether towards its desired shape the control law given in eq 54 is applied 3 the follower robot uses its onboard camera to maintain the tether at its desired shape while the leader robot executes a predefined path the control laws given in eqs 49 and 50 are applied extension 1 gives complementary information about these simulations 7 1 using only the follower camera leader robot motionless in this simulation the follower robot must bring the tether towards its desired shape as given in table 1 and depicted in fig 10 the control gain is set to λ 1 0 at the starting point the leader robot is outside the camera field of view and the tether is only partially visible in the image the objective is to bring the tether into the camera field of view in order to ensure an accurate estimation of its shape in addition the tether is to be maintained not too slack in order to prevent it from getting entangled with obstacles the robot s commands and the tether shape evolution from visual feedback estimation and simulation ground truth are depicted in fig 11 in the beginning of the simulation 0 80 iterations the tether shape estimation is not accurate mainly with respect to the parameter α 2 indeed as presented in fig 10 a the tether is almost a straight line in the image initially and the catenary curve fitting procedure cannot yield an accurate estimation of its shape despite this the control loop brings the tether towards its desired shape in the image fig 10 d and the tether features h 2 α 2 and δ h 2 converge towards their desired values all robot s commands decay after the 80th iteration the time the tether lowest point takes to come back into the camera field of view the robot commanded velocities are nearly zero after the 240th iteration since the tether reaches its desired shape 7 2 using both leader and follower cameras leader robot motionless the initial and desired tether shape are given in table 2 and the corresponding onboard images are depicted in fig 12 at the beginning the tether is partially visible in both leader and follower cameras the tether shape evolution and the follower robots commands are depicted in fig 13 the control gain is λ 0 5 similarly to the results obtained using only the follower camera at the beginning of the simulation 0 60 iterations the curve fitting algorithm could not yield an accurate estimation of the tether shape as it is almost a straight line in the images at the starting point fig 12 e the estimation and ground truth curves meet after the 60th iteration when the tether is completely visible in both images we notice a greater oscillation of the estimated values of α 2 when compared to the results obtained in section 7 1 this is caused by a greater lateral motion of the follower robot when only the follower s camera is used to regulate the tether shape the tether orientation is mainly regulated by a rotation ω z of the follower robot and the lateral motion ν y is almost zero fig 11 it can be seen that the regulation of the feature b 1 requires significant lateral movements of the follower robot whereas the regulation of the feature b 2 mainly induces rotational motion this is the expected behavior from the definitions of the two angles α 1 and α 2 the lateral velocity ν y causes a swinging motion of the tether which is responsible for the oscillations on α 1 and α 2 these oscillations do not appear on the ground truth curve because the calculation is based only on the tether attachment points that do not oscillate despite the initial inaccuracies on shape estimation and the swinging motion of the cable the control loop brings the tether towards its desired shape in the image figs 12 d the robot commanded velocities are nearly zero after the 300th iteration as the tether reaches its desired shape 7 3 using only the follower camera while the leader robot executes a path the leader path consists of a constant speed straight forward displacement combined with lateral and vertical motions the leader robot executed velocities are depicted in fig 14 all the way through the follower robot must maintain the tether desired shape given in table 3 two control laws are tested first the leader velocity commands are ignored eq 50 and the leader motion can be seen as an additional perturbation to the tether shape regulation task second the leader velocity commands are included in the follower robot control law eq 49 the control gain is set to λ 2 0 fig 15 presents the tether shape evolution and follower robot velocity commands at the beginning 0 80 iterations we observe a greater control effort to bring the tether from its initial to its desired height h 0 0 43 m and h 0 35 m respectively during the lateral motion of the leader 100 750 iterations the controller achieves to maintain the tether near its desired shape a gap between current and desired tether shape is expected since the leader motion is not considered in the follower commands which are always lagged when the leader executes vertical displacements 900 1500 iterations we observe a slight disturbance on the regulation of the tether height as δ h and h are linked by the catenary parameter c eq 2 assuming that both robots can communicate through the connecting tether we can include the leader robot velocity in the follower command as presented in eq 50 fig 16 presents the simulation results at the beginning 0 80 iterations the follower robot brings the tether towards its desired shape which is maintained for the rest of the simulation some little perturbations are observed in the change of direction of the robot leader around the 400th 900th and 1200th iteration the oscillations of the forward velocity command ν x can be reduced through the use of a lower control gain since the leader motion is included in the follower commands we note that the follower robot executes a forward ν x and lateral ν y velocities during a large part of the simulation starting from 400th iteration until the end this occurs because the follower robot must keep its desired orientation α 2 with respect to the tether while following the leader robot by regulating h 2 leader and follower robots do not have the same heading the comparison of figs 15 and 16 shows that there is only a slight difference between the graphs of tether shape evolution around 0 05 m and 5 the control law that includes the leader robot velocity allows to remove most of the residual tracking error on the features the follower robot achieves to manage the tether shape even when the leader movements are not taken into account in the control law in the next section dedicated to real experiments the leader robot will be kept fixed and larger disturbances will be applied to the follower robot in order to evaluate the control law robustness 8 experimental results two experiments were carried out in the experimental pool depicted in fig 17 the pool has 9 7 m of total length width of 3 0 m and depth of 1 0 m in the first experiment section 8 1 the follower robot uses only its onboard camera to maintain the tether at its desired shape in the second experiment section 8 2 both leader and follower cameras are used in order to constrain all the dof of the system the experimental platforms for the leader and follower robots are respectively the 5 dof bluerov2 and the 6 dof bluerov1 models of mini rovs bluerobotics 2019 the models are depicted in fig 18 and a comparison of their features is presented in table 4 the tether prototype used in the experiments is made of a leaded curtain yarn wrapped in an orange fabric fig 19 it is 1 50 m long 0 01 m thick and weighs 0 050 kg it was built to mimic a negatively buoyant perfectly flexible and inextensible underwater tether it can be attached to the robots or to a fixed point on the side wall of the pool thanks to a suction cup unlike the simulations the control laws used here include an integral term in addition to the proportional this was necessary in order to compensate the cable weight and the thrusters deadband the control laws given in eqs 50 and 55 are thus rewritten as 59 r 2 v λ p l r 2 2 e 2 λ i l r 2 2 k 0 k m a x 40 e 2 60 r 2 v λ p l r 2 f e f λ i l r 2 f k 0 k m a x 40 e f where λ p λ i are vectors containing positive gains and k is the integration time eqs 59 and 60 are used in sections 8 1 and 8 2 respectively 8 1 using only the follower camera in this experiment the follower robot must maintain the tether at the desired shape given in table 5 the robot is then disturbed through the application of external forces fig 20 two disturbances are carried out a pull and a rotation motion as shown in fig 21 a sequence of the robot onboard images during the disturbances is depicted in fig 22 extension 2 appendix a 1 gives complementary information about this experiment the control gains are λ p 0 5 0 5 0 5 0 2 t λ i 0 005 0 005 0 005 0 001 t and the integration time is k 40 iterations the curves of tether shape evolution and robot velocity commands for both perturbations are presented in figs 23 and 24 in the first perturbation fig 23 the robot is pulled and sunk as a result the tether becomes almost a vertical line in the camera view fig 22 b the height h and the height offset between attachment points δ h increase reaching values of 0 40 m and 0 30 m respectively the robot moves backwards and upwards in order to meet the desired shape parameters within 50 iterations in the second perturbation fig 24 the robot is rotated so that the tether changes side in the image moving from the left side to the right side figs 22 a and 22 c as a result the tether orientation angle becomes negative and the robot executes a combination of rotational lateral and backwards movements in order to bring the tether back to its desired shape between the 60th and 75th iterations the tether is barely visible in the image which leads to an erroneously estimation of a taut tether h 0 10 m by the curve fitting algorithm another situation of tether hard shape estimation occurs during the crossing of α 0 when the catenary shape degenerates into a vertical line in the image 8 2 using both leader and follower cameras in this experiment both leader and follower cameras are used to regulate all the 4 dof of the tether robots system the desired tether shape parameters are shown in table 6 the leader robot is kept fixed stopped and the follower is displaced through the application of an external force fig 25 as the robots relative pose is fully constrained the follower robot must return to the initial position corresponding to the tether desired shape in both images a top view of the experimental scene in presented in fig 26 and complementary information about this experiment is available in extension 3 appendix a 1 the control gains are λ p 0 3 0 3 0 3 0 15 t λ i 0 003 0 0 0 005 0 0 t and the integration time is k 60 iterations the curves of tether shape evolution and the follower robot velocity commands during the disturbance are presented in fig 27 at the beginning the follower robot is at its desired position and the tether shape parameters are regulated at their desired values around the 60th iteration the follower robot is displaced both orientation angles become positive and the tether changes side in both images some overshoots in the commands are observed around the 150 th and the 440 th iteration due to noisy tether shape estimation during the crossing of the singularity α i 0 the follower robot executes a main lateral motion ν y along with some rotations ω z in order to bring the tether back to their desired shape in both images 9 discussion tether detection and shape estimation the proposed procedure of tether detection and shape estimation has been demonstrated to be robust to image noise and yielded accurate results in the experiments carried out in the experimental pool the catenary projection equation may also be used to implement a model tracker marchand and chaumette 2005 the detection will then be more robust to color absorption in real scene and the local detection and shape fitting included may help to remove outliers however these algorithms need to be adapted to our images especially when only a small portion of the tether is visible regarding curve fitting the orthogonal distance between detected points and estimated curve could be also computed however this increases the complexity and thus computing time of the fitting procedure since another minimization problem must be included in the estimation loop to find the orthogonal distance other optimization algorithms could be investigated for example the feature vector boundaries could be managed through a barrier function like in interior point methods in addition inequality constraints could be added to the problem tether shape control the proposed tether shape control scheme was proved to properly manage the tether shape even in conditions of coarse tether shape estimation such as cable partial visibility the controller achieves to bring the tether towards its desired position in the image the controller has also proved to be robust to external perturbations such as unexpected movements of the leader robot in simulation and the application of external forces in experimentation the relative pose between leader and follower robots can be constrained if the tether shape is regulated simultaneously in both images which has been achieved in simulation and real experiments the use of the tether as a visual feature frees robots from being constantly present in each other s field of view the tether can be used as a means of robot s relative position estimation when they cannot see each other as long as a portion of the tether is in the field of view of their cameras a low level velocity controller based on dvl doppler velocity log feedback could be implemented in order to further improve the tether handling capability of our proposed control scheme when the tether converges to its desired position the zero speed commands are sent to the thrusters null velocity commands execution must be ensured by the low level velocity controller in order to maintain the robot stopped at its desired position and avoid any drift the implementation of such low level controller would lead to the reduction of the slight oscillations of the robot around its desired position singularity α i 0 the fitting procedure used here cannot yield an accurate and stable tether shape estimation when the attachment point and the camera optical center are aligned as a result the tether becomes a vertical line in the image with our robots this situation occurs when α i 0 this singularity can be avoided through the addition of another camera that films the tether from another point of view hence this degenerated case will never occur simultaneously in both images and the fusion of such complementary visual information would lead to an accurate tether shape estimation in a wider workspace in this work the previously estimated features are maintained during the crossing of the singularity α i 0 this yields flat estimation curves around this singularity instead of unstable values if the fitting procedure were launched another technique is to predict the features evolution through numerical schemes euler or runge kutta within a limited horizon of time folio and cadenat 2007 another solution would be to change the controlled features instead of using the catenary shape parameters other visual features could be used during the crossing of the singularity it is one of our perspectives to investigate the use of pure image based features such as image points and line segments or the use of the catenary lowest point in the image the complete catenary based controller could be used most of the time while another more simple features could be used only for crossing the singularity influence of tether attachment point position the tether attachment point position in the camera frame has a non negligible influence on the fitting since it defines the departing point of the tether in the image in this work we assumed that this position is a known constant this assumption could be relaxed if a procedure of calibration was implemented where the attachment point position could be estimated from the positions of the tether detected points on the top of the image modeling the cable model studied is the catenary which is adapted for sagging cable modeling such as negatively buoyant tethers the features issued from the catenary model the height and orientation parameters have the great advantage of giving a physical and intelligible notion of the cable 3 d shape the catenary model presented here can be further improved the tether plane may no more be assumed to remain vertical and the robots roll and pitch angles could be included in the equation of the catenary projection in the image plane assumptions i and iv in order to catch the tether swing motion other sensors such as 3 d accelerometers can be added to the tether ends and provide additional information about its shape merlet 2018a the cable plane vertical orientation and its departure angles could be estimated from the accelerometers inclination with respect to the gravitational field this additional data can be used together with the visual feedback in order to produce a more robust shape estimation namely in complex scenes where tether detection may be less accurate the physical interaction between tether robots and surrounding water can be studied in an hydrodynamic modeling of the system taking into account the tether weight and drag would be helpful to achieve a more precise cable handling other features could also be investigated such as parabolas splines and fourier coefficients although their parameters reflect a less physical notion of the cable shape 10 conclusions this paper has introduced a new catenary based visual servoing control scheme for tether shape regulation this controller was validated in simulations and experiments in a pool where a pair of small underwater robots a leader and a follower were connected by a tether the controller enabled the follower robot to regulate the tether shape using only the robots sensory feedback as the tether was not equipped with any additional sensor the tether was detected in the cameras through color segmentation and its 3 d shape parameters were estimated in real time thanks to a curve fitting procedure based on the gauss newton algorithm the 3 d shape was then regulated through visual servoing based on the catenary model of the cable for the best of our knowledge it is the first time that the shape regulation of a linear deformable object is achieved by means of visual servoing through a pure analytical modeling of the object shape the proposed control law was tested in a number of simulations demonstrating its reliability in situations of cable partial visibility and leader unexpected motion the controller was also demonstrated to remain stable even in cases of large up to 40 tether shape estimation errors the robustness of the control scheme was checked through the application of disturbing external forces moreover the obtained results showed that the relative pose between robots can be constrained through tether shape regulation in both leader and follower images future work will address the navigation of a whole queue of robots assuming that the control scheme introduced in this paper manages the shape of a tether linking a pair of robots the high level controller must manage the relative position between the robots depending on the situation at hand if small cavities are to be crossed the robots must be mostly aligned otherwise when exploring open sites it would be better to have the robots more laterally spaced in order to have a wider perception of the environment finally a hierarchical control scheme can be used so that priority can be given to the tether orientation or height depending on the situation credit authorship contribution statement matheus laranjeira conceptualization investigation formal analysis methodology software validation claire dune conceptualization investigation formal analysis methodology software validation vincent hugel conceptualization investigation formal analysis methodology software validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was achieved thanks to specific funding from the france sud region and the french subseatech company located in marseille south east of france http www subsea tech com the authors would also like to thank the french engineering school seatech and the mio lab for allowing the use of the experimental pool appendix a 1 index to multimedia extensions see table 7 here below a 2 notation f a an euclidean reference frame f a p a i a j a k a consists of an origin p a and an orthonormal basis i a j a k a b p a a vector containing the cartesian coordinates of a 3 d point b p a b x a b y a b z a t represents the coordinates of p a in frame f b b p a the total derivative of b p a with respect to frame f b and expressed in frame f b b p a a vector containing the homogeneous coordinates of a 3 d point b p a b p a 1 t b r a a 3 d rotation matrix from frame f a to frame f b b v a the velocity screw vector b v a b ν a b ω a t of point p a expressed in the coordinate frame f b b ν a and b ω a are respectively the linear and angular components of the velocity vector a 3 gauss newton jacobian derivatives the gauss newton jacobian j r was defined in eq 18 it is rewritten here as a reminder j r 1 m d r d s whose m th row is j r m 1 m y x m s a y x m s b the derivative of the catenary projection equation see eq 16 with respect to parameters a h h m a x and b sin α is y x m s a 1 c z 1 c a cosh c ζ c d 1 sinh c ζ c d c a 1 a 2 a 3 h m a x y x m s b 1 c z b cosh c ζ c d 1 c h y c i 1 c z ζ b sinh c ζ c d where ζ c x i x c z i b x 1 b 2 c z 1 b 2 c x i b c z i b 1 b 2 x a 1 ζ c a a 2 d c a and a 3 c d a we also have d a 1 c a acosh c h 1 c a h c h m a x c c h 2 2 c h 1 z c b x c i z c i x m 1 b 2 1 b 2 x c i b z c i 2 ζ b x c i z c i x m 1 b 2 b x m 1 b 2 b 1 b 2 x m 2 c a c h d h d a 1 c a 1 c h d h d a and d h d a h m a x the partial derivatives c h and 1 c h are given in appendix a 4 a 4 partial derivatives of c let us rewrite eq 2 as c 2 c n c d 2 2 h δ h 2 l h h δ h l 2 δ h 2 l 2 2 h δ h 2 the partial derivatives of c with respect to h and δ h are c h 2 c n h c d c d h c n c d 2 1 c h c d h c n c n h c d 2 c n 2 c n h 2 l 2 h δ h h h δ h l 2 δ h 2 c d h 4 2 h δ h c δ h 2 c n δ h c d c d δ h c n c d 2 c n δ h 1 l h l 2 2 h δ h δ h 2 l 2 δ h 2 3 2 h h δ h c d δ h 2 2 h δ h a 5 calculation of attachment points derivatives let us define the vector from p 2 to p 1 noted p 2 p 1 the time derivative with respect to frame f 2 is developed to introduce the robots velocities in the following way 61 d p 2 p 1 d t f 2 d p 2 p 1 d t f w ω 2 p 2 p 1 where ω 2 is the angular velocity of f 2 with respect to f w from the chasles relation we obtain d p 2 p 1 d t f 2 d p 2 p r 2 d t f w d p r 2 p w d t f w d p w p r 1 d t f w d p r 1 p 1 d t f w ω 2 p 2 p 1 noting d p w p r 1 d t f w ν r 1 and d p r 2 p w d t f w ν r 2 we have d p 2 p 1 d t f 2 d p 2 p r 2 d t f w ν r 2 ν r 1 d p r 1 p 1 d t f w ω 2 p 2 p 1 expressing the derivatives d p 2 p r 2 d t f w and d p r 1 p 1 d t f w in the robot s frames we have d p 2 p 1 d t f 2 d p 2 p r 2 d t f r 2 ω r 2 p 2 p r 2 ν r 2 ν r 1 d p r 1 p 1 d t f r 1 ω r 1 p r 1 p 1 ω 2 p 2 p 1 knowing that d p 2 p r 2 d t f r 2 0 and d p r 1 p 1 d t f r 1 0 see assumption ii we finally obtain 62 d p 2 p 1 d t f 2 ν r 1 ω r 1 p r 1 p 1 ν r 2 ω r 2 p r 2 p 2 ω 2 p 2 p 1 if the robot remains horizontal see assumption i f 2 and f r 2 have the same orientation and ω 2 ω r 2 therefore 63 d p 2 p 1 d t f 2 ν r 1 ω r 1 p r 1 p 1 ν r 2 ω r 2 p r 2 p 2 p 2 p 1 let us note 2 p 1 the velocity of p 1 with respect to frame f 2 expressed in f 2 2 p 1 2 d p 2 p 1 d t f 2 we also note r i v r i r i ν r i r i ω r i t the velocity vector defined at p r i center of the robot r i and expressed in frame f r i in order to simplify the writing we note for now on this ego centered velocity as r i v r i ν r i ω t we can rewrite eq 63 in matrix form 64 2 p 1 t r 2 2 r 2 v r 2 v r 1 r 1 v where t r 2 2 i 3 3 r 2 p 1 r 2 v r 1 r 2 r r 1 r 2 p r 1 r 2 r r 1 0 r 2 r r 1 and x is the skew matrix defined from vector x appendix b supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j oceaneng 2020 107018 appendix b supplementary data the following is the supplementary material related to this article video s1 simulation results on tether shape control video s2 experimental results using only the follower camera video s3 experimental results using both leader and follower cameras 
22033,for the prediction of ship resistance in the preliminary stages of the design process naval architects often use methods that are less complex and expensive than cfd simulations and experiments the linear wave making theory can be used to quickly evaluate wave resistance although the theory gives poor estimates for conventional hull forms due to neglecting viscosity this paper introduces improvements to the original theory by including boundary layer effects through the tangency correction that can handle flow separation the improvements that account for viscous and nonlinear effects are implemented within michell s thin ship theory to extend its applicability to non slender hulls which is validated by numerical simulations of five profoundly different hull forms the wigley hull series 60 delft 372 a yacht hull and the kriso containership hull the modified theory yielded more accurate resistance curves compared to the original theory and holtrop mennen s method and gave new insight into ship wave making keywords wave making ship resistance wave resistance boundary layer far field waves 1 introduction the problems of predicting wave patterns and wave resistance of ships are one of the most important subjects in ship theory wave making resistance at large reynolds numbers is determined by the potential component in the far field without the rotational component the paper published by michell 1898 marks the beginning of the theory of wave resistance of floating bodies which was overlooked for years until havelock and wigley discovered it and continued to work on it gotman 2002 utilising the potential flow theory michell derived the linear wave theory by representing the ship hull by sources distributed along the centreplane with strengths proportional to the longitudinal slope of the hull assuming the slope is small therefore it is often referred to as the thin ship theory the theory is also applicable on submerged bodies near free surface tuck et al 2001 multi hulls yu et al 2015 shallow waters gourlay 2008 etc computational fluid dynamics cfd nowadays provides more precise tools for ship resistance prediction bašić et al 2017b in spite of their limitations potential flow based tools are compelling for early stages of the design process due to their simplicity low cost and small amount of engineer s time consumption chen et al 2018 wave making simulated by the higher order rankine boundary element method bem can yield adequate results he 2013 and therefore can be used for seakeeping analyses in the framework of linear potential theory he and kashiwagi 2014 on the other hand it may be argued that the thin ship theory does not yield sufficiently accurate results especially not for conventional ship forms that have low length breadth ratio i e l b 8 gotman 2002 wigley havelock tuck 1974 and other researchers argued that the humps and hollows on a resistance curve obtained by the potential flow theory supervene due to neglecting the viscosity they argued that the boundary layer bl and the wake affect the wave system which should smooth out the humps and hollows besides neglecting of the viscous effects most of the remainder of the discrepancies accounts for neglecting of the nonlinear terms that do not affect the wave pattern amplitude but modify the phase of the far field wave to avoid directly solving these issues within the theory viscous inviscid domain decomposition became a popular approach viscous effects are taken into account through the navier stokes equations in the neighbourhood of the hull and in the wake and the inviscid assumption far from the hull allows a description by the potential flow sahoo et al 2007 raven 2010 gotman 2002 gives a good review of published papers in which the wave resistance is obtained by linear theories variously incorporating the viscosity effects on both wave generation and wave propagation to name a few milgram 1969 was one of the first to prove that the fluid viscosity affects the resistance of a thin ship obtained by modifying the beam of the wigley hull based on the assumed separation of the streamlines wang 1985 made a modification for viscous flow to thin and slender ship theories by adding the bl displacement thickness to the actual ship hull geometry the displacement thickness was calculated by solving the integral bl ibl equations on a double body model of the hull ikehata and tahara 1987 combined the rankine source method with the ibl method to investigate the influence of the bl and wake on the free surface flow around a ship model shahshahan and landweber 1986 1990 calculated the wave resistance of the wigley hull using the thin ship theory and found that including the viscosity effects modifies the theoretical resistance in the right direction tuck 1974 added a modification to the free surface condition to account for wave dissipation due to viscosity and concluded that a ship is a less efficient generator of waves in the presence of surface viscosity and that the skin friction effect on the wave resistance should also be investigated moreno et al 1975 thus conducted experiments on smooth and rough ship model to investigate the skin friction effect on the resistance and found a reduction of the wave making when the bl and wake are thickened doctors 2003 and doctors and zilman 2004 included the surface tension and eddy viscosity damping factor in the computation of the wave pattern around a catamaran and concluded that the inclusion of the surface tension desirably reduces the amplitude of waves at lower froude numbers but without determining appropriate damping values for general ship forms generally a potential flow solver may incorporate the effects of bl by physically shifting boundaries outward in their normal direction using the calculated displacement thickness by blowing specified velocity from geometry to displace the surface streamlines or by tangency correction introduced by bašić et al 2017a similar to wang 1985 and milgram 1969 peng et al 2014 excluded a part of the stern region from the computational domain while modifying the boundary conditions in this case the bl displacement thickness was incorporated by physically shifting the geometry but without extending the applicability to arbitrary ship forms furthermore iteratively solving the problem using the ibl theory drela 2013 with shifting or blowing techniques the convergence cannot be reached due to stern effects since the methods are not suitable for the calculation of wake with vortices e g see tanaka 1988 in addition stern surface areas with normals pointing back should be immensely shifted away from the initial positions or should blow infinite velocity to represent the wake imposing the displacement thickness using the displacing or blowing techniques implicitly modifies the tangency of the flow near the body while the tangency correction technique makes the same modifications to flow without changes in geometry and boundary conditions consequently the tangency correction technique does not suffer from the listed problems it directly incorporates the bl displacement thickness along streamlines on the surface and works with separated flows with wide wakes bašić et al 2017a this study deals with a possibility of enhancing the linear wave making theory by introducing approximate but physically correct enhancements the linear wave making theory is examined and enhancements are introduced based on the following 1 the bl and wake significantly affect the wave making the humps and hollows in the wave resistance curve are a consequence of the interaction of the inviscid bow and stern wave systems 2 any potential flow solver can yield more accurate pressure field by incorporating the bl displacement thickness information 3 from the listed coupling techniques the tangency correction technique has a direct physical connection and intrinsically handles separated flows 4 using the tangency correction the bl displacement thickness may be incorporated in the linear wave making theory without adding complexity to obtain more accurate wave resistance results the above points are explained throughout the paper and the resulting method is validated by calculating the resistance of five various hull forms and comparing the results to known experimental values the remainder of the paper is structured as follows section 2 describes the linear theory and corresponding numerical procedure for predicting wave resistance of ships section 3 analyses how to improve the theory by including viscous and phase shifting effects the validation of the extended theory is given in section 4 finally section 5 lists the drawn conclusions 2 wave making theory 2 1 far field wave resistance wave making is determined by the potential component in the far field zhu et al 2017 showed that hogner s modification of michell s theory may benefit prediction of wave making for high froude numbers since the area where the wave resistance begins to increase is of interest to the naval architect the problem of wave making is examined through somewhat simpler foundations of michell s thin ship theory the problem of wave making is nonlinear due to the quadratic nature of the dynamic free surface condition while the free surface elevation ζ x y is not known a priori michell 1898 approached the problem by linearisation of the boundary conditions which are imposed only on the centreplane y 0 and still waterline z 0 he used his fourier integral theorem to obtain the velocity potential and pressure on the centreplane i e on the projection of the hull havelock later replaced the fourier integral theorem with a distribution of sources and sinks on the centreplane the thin and slender ship approximations satisfy the laplace equation the radiation condition and the kelvin michell linearised free surface boundary condition a steadily moving body near the free surface produces free waves with a steady surface wave pattern free wave elevation far away from the ship equals to the sum of amplitudes of waves that travel at various angles of propagation θ relative to the vessel direction the hull and flow around the hull are assumed symmetrical about the centreplane so that only the starboard is considered θ π 2 π 2 in ship fixed reference system the wave elevation is defined as 1 ζ x y ℜ π 2 π 2 a θ exp i k θ x cos θ y sin θ d θ where a θ is the complex amplitude function of the free wave for an angle of propagation and k is the wave number that is defined as 2 k k 0 λ 2 where k 0 is the basic wave number k 0 g u 2 u is the ship speed and λ is the secant of wave propagation angle λ sec θ because the total energy in the far field wave pattern arises from the moving ship it is directly related to the wave pattern resistance r w p the value of the wave pattern resistance force is given for infinite water depth by the following expression 3 r w p π 2 ρ u 2 π 2 π 2 a θ 2 cos 3 θ d θ where ρ is the fluid density therefore the wave resistance depends quadratically on the wave amplitude with a cubic weighting factor related to the wave propagation angle the complex amplitude function a θ depends on the hull shape angle of propagation of waves and the ship speed u it can be computed numerically e g by the thin ship theory cfd amini afshar and bingham 2018 or it can be obtained by experimental measurements degiuli et al 2003 the complex amplitude function in infinite depth is generally defined as 4 a θ 2 π i k θ 2 p θ i q θ for water of infinite depth and a thin body whose geometry is described with a half breadth function y x z michell s theory indicates 5 p θ i q θ s x y x z exp k z i x k 0 λ d x d z where sources are described with the longitudinal slope of the geometry x y x z y x z x besides the wave pattern component wave making resistance includes nonlinear components which are primarily arising from wave breaking at the bow and stern miyata et al 2014 2 2 numerical solution if the ship hull geometry is described with a half breadth function y x z then each station of the hull can be described with a curve y x z from its lowest point of the section z m i n 0 to its uppermost point z m a x 0 rather than evaluating michell s triple integral eq 3 integration by parts is used to separate the integral which solves the problem with the following steps 1 the lowest level integral obtains the contribution of a ship section for a wave propagation angle along the draught 6 f x λ z m i n z m a x x y x z exp z k λ d z 2 the higher level integral gathers contributions of ship sections for a wave propagation angle along the ship from bow to stern 7 p λ i q λ 0 l f x λ exp i x k 0 λ d x in order to avoid dealing with complex number numerics p λ and q λ from eq 7 are described separately by two complementary integrals that replace exp i by cos and sin components those oscillatory integrals are then computed by filon s integration formula tuck et al 2001 3 finally the following integral gathers the amplitudes of the free wave spectrum for all possible wave propagation angles 8 r w p 4 π ρ u 2 k 2 0 p 2 λ q 2 λ 1 t 2 d t where the substitution λ 1 t 2 is introduced to avoid integration difficulties due to the integral singularity of eq 3 noblesse et al 2008 in conclusion the wave resistance of a ship hull is obtained by evaluation of three separate integrals described by eqs 6 8 a single threaded evaluation of the wave resistance numerical procedure takes on average 50 ms on a modern 3 6 ghz processor using 250 transverse sections that describe the frame section by an array of 50 points distributed along the vertical axis this 250 50 grid was shown to offer adequate precision when evaluating eqs 6 8 for various hull forms tested in section 4 3 theory modifications the linearised wave making resistance theory is usually valid for ships with large l b ratio for conventional ship forms which have the l b ratio from 6 to 8 the thin ship theory gives poor estimate of the wave making resistance the modifications of the thin ship theory described below expand the limitations of the theory so that it can be applied to common hull forms 3 1 boundary layer bašić et al 2017a introduced a bl correction for potential flows by letting the flow follow the outer bl frontier and the mean wake direction after the separation occurs they showed that the tangency correction technique may be applicable not only to streamlined forms but to bluff bodies as well the treatment called the tangency correction is implemented through virtual rotation of surface normals and correspondingly tangents as shown in fig 1 it was found that the correction angle δ β has a direct connection to the bl displacement thickness δ 9 s δ δ s tan δ β s where s is the direction of the streamline path the distribution of bl displacement thickness along the streamline δ s obtained by rotating normals δ β s is responsible for reproducing viscous pressure fields the question that remains is how to assume or calculate the distributions of δ β and δ for general ship hull forms δ should be calculated by marching downstream the streamlines from the stagnation point which are not known a priori the problem can be solved by obtaining streamlines on the double body and then solving the ibl equations along the streamlines von kerczek 1973 with empirical closure relations drela 2013 to avoid the cumbersome three dimensional calculation of a double body problem in this study δ is approximately predicted by marching downstream the waterlines actual streamlines are three dimensional and therefore this cannot be reliable for areas where streamlines abruptly change their depth which is usually near the baseline on the other hand the tangency correction applied on the bottom of the hull does not affect the wave pattern significantly since the influence of depth changes exponentially which is visible in eq 6 based on the above assumptions it can be concluded that if actual streamlines near the free surface roughly follow the waterlines of the hull then the inclusion of the waterline tangency correction should yield more realistic wave patterns than the original thin ship theory in this study the distribution of δ is calculated by solving the ibl equations along hull waterlines waterline using xfoil software drela 1989 the tangency correction angle is calculated according to eq 9 as 10 δ β arctan x δ where x δ is the longitudinal rate of change of the displacement thickness following the introduced assumptions eq 6 is evaluated for modified slopes not the original hull geometry the definition of the tangency correction defines the modified slope or the tangency of flow as 11 x y b l tan arctan x y δ β eq 11 modifies surface tangents inside eq 6 to include the bl displacement effect by rotating the surface normal around the vertical axis depicted in fig 1 due to approximating streamlines confined in their waterplane besides the thin ship theory the correction is applicable to other variants of linear wave making theory e g noblesse et al 2013 and zhu et al 2018 3 2 phase shifting difference of the pressure and velocity between the thin ship and real geometry results in difference of the phase and amplitude of the generated wave pattern besides the bl correction explained in the former section that modifies the generated wave amplitude a correction of the phase of the wave pattern around the thin ship is needed tsubogo 2014 even if the dynamic pressure on the hull near free surface is similar between the thin and real ship the difference in the phase will arise nonetheless the higher order influence is known to be the major reason for the phase shift of the regular waves han et al 2003 total wave phase advances considerably compared to the first order wave while the amplitude of the total wave height does not differ too much from that of the first order wave the second order effect is strong near the bow and shoulder of the hull miyata et al 2014 therefore the hull shape forward from the fore shoulder fs is the main factor for the phase shift since the influence of wave making decays exponentially with depth the shape of the waterline may be taken as the main variable in the spirit of simplicity of michell s theory approximate resolution for the problem is to modify the basic wave number within numerical calculations k 0 k ˆ 0 based on the waterline shape forward from the fore shoulder it was empirically found that there is a strong linear dependence between the change in the basic wave number and the fore waterline arc to projection length ratio the following expression enhances the phase due to nonlinear effects for most common ship hulls 12 k ˆ 0 k 0 1 3 7 s f s l f s 1 where k ˆ 0 is the modified basic wave number s f s is the length of the waterline curve measured from the forward perpendicular fp to the fs and l f s is the longitudinal distance measured from the fp to the fs 3 3 oscillations the resulting wave resistance curve is known to oscillate mostly at low froude numbers ananthakrishnan 1999 showed that the wave dampening by viscosity is stronger on short waves although tuck et al 2001 concluded that there is little dependence of the viscosity on the free surface elevation unless the viscosity is increased over several orders of magnitude to be even larger than the oceanographically relevant eddy viscosity without a physical connection confirmed any kind of damping in mathematical sense contributes the stabilisation of the resistance curve for low froude numbers in this work waves with very small wavelength compared to the length of ship are simply discarded from the numerical evaluation of the complex amplitude function eq 7 4 numerical experiments this section presents the validation of the introduced enhancements for the thin ship theory numerical simulations predicted the total resistance of both slender and full hull types shown in fig 2 and the results are compared to experimental data the hulls have different block coefficients and l b ratios from 3 6 to 12 5 the transoms were kept dry to remove their dependency on the wave making the total resistance force r t comprises of the wave and viscous resistance 13 r t r w r f 1 k where r w is the wave resistance obtained by the numerical procedure explained in section 2 2 r f is the frictional resistance obtained by the ittc 1957 frictional correlation line and 1 k is the form factor obtained from the experimental measurements in addition to eq 13 the total resistance coefficient c t is also used as a relevant measure 14 c t r t 1 2 ρ u 2 s w where s w is the at rest wetted surface area of the hull 4 1 wigley hull due to its simple geometry the parabolic wigley hull is often used as a benchmark for methods that handle free surface andrun et al 2018 the mathematical representation of the wigley hull is defined by 15 y x z b 2 1 2 x l 2 1 z t 2 where b is the breadth l is the length and t is the draught of the hull main dimensions of the wigley hull considered in this study are taken as l 4 0 m b 0 40 m and t 0 25 m which correspond to those of the model made by ship research institute kajitani et al 1983 fig 3 compares the total resistance curves of the original and modified thin ship theory to the experimental measurements both resistance curves in graphs include the same amount of viscous resistance force r f 1 k the form factor 1 k 1 095 reported by kajitani et al 1983 was used in the numerical simulations the hollows of the numerical curve follow the measurements indicating that there is no need for shifting of the phase since s f s l f s 1 the curve obtained by the original theory has exaggerated humps due to the stern being too strong of a wave generator fig 4 shows a distribution of the boundary layer displacement thickness at depth of 0 2 t predicted by xfoil which is compared to the experimental data of shahshahan and landweber 1986 the value of δ reaches 10 of the hull beam more importantly slope of the curve defines the tangency correction eq 10 it is noticeable that the wave pattern and viscous pressure resistance strongly depends on the ship after body where the value of δ rises abruptly and induces flow separation the adverse pressure at stern leads to the rapid increase of the bl thickness and viscous stresses which is even the case for the slender wigley hull normals of aft regions in slender hull are only slightly rotated backwards but still the bl displacement thickness is significant and δ β corrections must be incorporated this is an important understanding which verifies the need for including the bl effects even for slender forms with ratio l b 10 consequently results of the modified theory in fig 3 oscillate to smaller extent and are in better agreement with the experimental measurements than the original theory 4 2 series 60 with c b 0 6 series 60 is a general cargo hull form without a bulb having u shaped sections it is often used as a cfd validation test in combination to the wigley hull a model defined with l p p 3 0 m b 0 40 m t 0 163 m and c b 0 6 in fixed model condition is simulated and compared to the experimental data of toda et al 1992 the form factor 1 k 1 135 calculated by prohaska s method is used for obtaining the viscous resistance the comparison of the total resistance force and coefficient obtained numerically and experimentally is shown in fig 5 the original theory produces a local peak in the resistance curve which is unrealistically high and starts prematurely the local maximum is reached at f n 0 28 while the experiment shows it should be reached around f n 0 30 inviscid flow around the stern generates waves that are excessively superposed to waves generated by the fore compared to the original theory curve the local peak and hollow of the modified curve only slightly oscillates around the experimental points as in the case of the wigley hull the ship resistance curves benefit from the introduced modifications 4 3 delft 372 broglia et al 2014 conducted an experimental investigation on models of delft 372 monohull and catamarans the model has typical lines of a high speed displacement hull shown in fig 2 and principal dimensions of l p p 3 0 m b 0 24 m t 0 15 m and c b 0 403 the experiments were conducted on a free model while the simulations were done for a fixed model in the displacement regime this simplifies the validation without introducing additional effects of the immersed transom during the semi displacement regime it is worth noting that the relatively high ratio l b 12 5 characterises the hull as slender and prohaska s method yields low form factor 1 k 1 05 nevertheless the original thin ship theory over predicts the wave resistance of the hull for all simulated froude numbers while the inclusion of the bl displacement thickness through the tangency correction suppresses the stern wave system and therefore yields lower wave making resistance the measurements by broglia et al 2014 show that for f n 0 5 both trim and sinkage change significantly consequently numerically obtained resistance curve for the fixed model start to deviate from the measured values on a dynamic model the resistance at high speed displacement froude numbers is under predicted without taking the trim and sinkage into account the validation of the modified theory for semi displacement regimes is left for future work 4 4 wide light yacht sailing yacht research foundation syrf published the tank test data from their wide light yacht project for the hydrodynamics of a high performance yacht claughton 2015 a comprehensive set of data is collected for the canoe body with and without appendages in upright heeled and yawed conditions the canoe has a displacement of 197 kg the waterline length l w l 4 60 m and the maximum beam of b 1 28 m the hull ratio l b 3 6 is far from usual limits that characterise the ship as slender compared to the delft 372 model the upright canoe model had experienced significant sinkage even at lower froude numbers therefore this numerical experiment applies the change in sinkage for each simulated froude number which is obtained from the experimental data by claughton 2015 the trim is ignored as it slowly changes with the canoe speed the wave resistance of the upright canoe body is computed using the introduced method and the used value of the form factor 1 k 1 18 was obtained by prohaska s method the results are compared against the measured data in fig 7 very good agreement between the measured and computed data is obtained 4 5 kriso containership besides a hull with a very small l b ratio that was reported in the previous section a difficult test for the introduced corrections is to predict the resistance of a full hull form kriso containership kcs has a typical containership form with a bulbous bow the model is defined with l p p 7 279 m b 1 019 m t 0 342 m and c b 0 651 which is the largest of the tested models as shown in fig 2 it has a conventional value of l b 7 1 and an extremely high value of the midship section coefficient c m 0 985 fig 8 shows the resistance curves of the kcs model obtained by the modified theory which is compared to the experimental data from chen et al 2016 and holtrop mennen s method the value of the form factor 1 k 1 165 was calculated from the experimental data using the method of prohaska which was used in the simulation very good agreement is found between the modified thin ship theory and the experiment the simulation properly predicts rising of the wave resistance with the speed unlike the holtrop mennen s method that approximates the wave resistance rise and misses its gradient from f n 0 25 to f n 0 3 the original theory frantically over predicts the wave resistance fig 9 shows the wave making pressure distribution obtained as described by noblesse et al 2008 which renders the difference of the original and modified thin ship theories the hull lines rendered in fig 2 show that the stern region has steep geometry changes within the relatively small stern length changes in geometry induce adverse pressure gradients that cause sudden development of the bl displacement thickness and probable flow separation with vortices duy et al 2017 the previous numerical experiments had validated that the inclusion of bl displacement thickness indeed damps far field waves but the kcs experiment shows that the tangency correction can damp far field waves irrelevant of the adverse pressure gradient strength this indicates that the modified method can be potentially applied to full ship forms with realistic l b ratios and c b values 4 6 discussion as it is noted in literature the bl and wake affect the wave making of a steadily moving vessel the resistance curves shown in figs 3 8 which are obtained using the unmodified theory have humps and hollows that are a consequence of the interaction of the inviscid bow and stern wave systems since the tangency correction has proven to correctly model the rapid increase of the bl displacement thickness for bluff bodies the technique was applied to ship hulls with streamlined forms in order to avoid difficulties of implementing an ibl solver a simple empirical approximation for δ β along a general streamline was introduced with the intent to validate the possibility of improving the wave making prediction although the approximation has corrected the total resistance of the five introduced hull forms the more general method using the ibl should be implemented for general forms figs 3 8 show that the approximate modifications enhance sources of far field waves irrelevant of the adverse pressure gradient strength and validate that the inclusion of the bl displacement thickness improves the interaction of the bow and stern wave systems generally if the trim and sinkage are not taken into account for high speed vessels then numerical methods frequently under predict the resistance in these cases the original thin ship theory may purely accidentally yield accurate results since the theory regularly over predicts the wave resistance at higher froude numbers naval architects should avoid relying on absolute results of the uncorrected original linear theories 5 conclusions commercially viable ships sail in the displacement regime with speeds merely smaller where the wave making resistance begins to increase toward its global maximum therefore this area is of interest to the naval architect michell s integral has been analysed for over 120 years in order to understand why it yields errors to the order of magnitude within the area of interest especially for hulls that experience strong adverse pressure gradients the aim of this study was to give new insight into why the errors and oscillations in the resistance curve occur and to offer a simple approximate solution to the problem the following conclusions are drawn the inviscid wave making theory generally over predicts the wave resistance due to the stern being too strong of a wave generator as the inviscid potential flow theory restores too high pressure at the stern unrealistic stern generated waves are hence superposed to those generated by the ship fore part inclusion of the displacement thickness of the boundary layer yields realistic pressure gradients along the wetted surface consequently including it in a potential flow wave making method such as the thin ship method generates more accurate far field waves the numerical experiments conducted on five hull forms have validated that the tangency correction properly includes the displacement thickness that damps far field waves and therefore makes resistance prediction more accurate it was found that the resistance curve of a thin ship starts to grow prematurely compared to experimental measurements the phase shift can be made by virtually scaling the wave number based on the waterline shape up to the fore shoulder implementing the enhancements within the thin ship method obtains more accurate results compared to the original thin ship theory and holtrop mennen s method the trend of the total resistance curve is properly estimated for the tested hull forms meaning that the thin ship theory may be applied for arbitrary monohulls further numerical experiments are necessary in order to examine the validity of the present approaches for multihulls and hulls with immersed transom sterns credit authorship contribution statement josip bašić conceptualization methodology software branko blagojević supervision writing review editing martina andrun validation formal analysis investigation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors wish to thank leo v lazauskas for useful and interesting discussions on the subject 
22033,for the prediction of ship resistance in the preliminary stages of the design process naval architects often use methods that are less complex and expensive than cfd simulations and experiments the linear wave making theory can be used to quickly evaluate wave resistance although the theory gives poor estimates for conventional hull forms due to neglecting viscosity this paper introduces improvements to the original theory by including boundary layer effects through the tangency correction that can handle flow separation the improvements that account for viscous and nonlinear effects are implemented within michell s thin ship theory to extend its applicability to non slender hulls which is validated by numerical simulations of five profoundly different hull forms the wigley hull series 60 delft 372 a yacht hull and the kriso containership hull the modified theory yielded more accurate resistance curves compared to the original theory and holtrop mennen s method and gave new insight into ship wave making keywords wave making ship resistance wave resistance boundary layer far field waves 1 introduction the problems of predicting wave patterns and wave resistance of ships are one of the most important subjects in ship theory wave making resistance at large reynolds numbers is determined by the potential component in the far field without the rotational component the paper published by michell 1898 marks the beginning of the theory of wave resistance of floating bodies which was overlooked for years until havelock and wigley discovered it and continued to work on it gotman 2002 utilising the potential flow theory michell derived the linear wave theory by representing the ship hull by sources distributed along the centreplane with strengths proportional to the longitudinal slope of the hull assuming the slope is small therefore it is often referred to as the thin ship theory the theory is also applicable on submerged bodies near free surface tuck et al 2001 multi hulls yu et al 2015 shallow waters gourlay 2008 etc computational fluid dynamics cfd nowadays provides more precise tools for ship resistance prediction bašić et al 2017b in spite of their limitations potential flow based tools are compelling for early stages of the design process due to their simplicity low cost and small amount of engineer s time consumption chen et al 2018 wave making simulated by the higher order rankine boundary element method bem can yield adequate results he 2013 and therefore can be used for seakeeping analyses in the framework of linear potential theory he and kashiwagi 2014 on the other hand it may be argued that the thin ship theory does not yield sufficiently accurate results especially not for conventional ship forms that have low length breadth ratio i e l b 8 gotman 2002 wigley havelock tuck 1974 and other researchers argued that the humps and hollows on a resistance curve obtained by the potential flow theory supervene due to neglecting the viscosity they argued that the boundary layer bl and the wake affect the wave system which should smooth out the humps and hollows besides neglecting of the viscous effects most of the remainder of the discrepancies accounts for neglecting of the nonlinear terms that do not affect the wave pattern amplitude but modify the phase of the far field wave to avoid directly solving these issues within the theory viscous inviscid domain decomposition became a popular approach viscous effects are taken into account through the navier stokes equations in the neighbourhood of the hull and in the wake and the inviscid assumption far from the hull allows a description by the potential flow sahoo et al 2007 raven 2010 gotman 2002 gives a good review of published papers in which the wave resistance is obtained by linear theories variously incorporating the viscosity effects on both wave generation and wave propagation to name a few milgram 1969 was one of the first to prove that the fluid viscosity affects the resistance of a thin ship obtained by modifying the beam of the wigley hull based on the assumed separation of the streamlines wang 1985 made a modification for viscous flow to thin and slender ship theories by adding the bl displacement thickness to the actual ship hull geometry the displacement thickness was calculated by solving the integral bl ibl equations on a double body model of the hull ikehata and tahara 1987 combined the rankine source method with the ibl method to investigate the influence of the bl and wake on the free surface flow around a ship model shahshahan and landweber 1986 1990 calculated the wave resistance of the wigley hull using the thin ship theory and found that including the viscosity effects modifies the theoretical resistance in the right direction tuck 1974 added a modification to the free surface condition to account for wave dissipation due to viscosity and concluded that a ship is a less efficient generator of waves in the presence of surface viscosity and that the skin friction effect on the wave resistance should also be investigated moreno et al 1975 thus conducted experiments on smooth and rough ship model to investigate the skin friction effect on the resistance and found a reduction of the wave making when the bl and wake are thickened doctors 2003 and doctors and zilman 2004 included the surface tension and eddy viscosity damping factor in the computation of the wave pattern around a catamaran and concluded that the inclusion of the surface tension desirably reduces the amplitude of waves at lower froude numbers but without determining appropriate damping values for general ship forms generally a potential flow solver may incorporate the effects of bl by physically shifting boundaries outward in their normal direction using the calculated displacement thickness by blowing specified velocity from geometry to displace the surface streamlines or by tangency correction introduced by bašić et al 2017a similar to wang 1985 and milgram 1969 peng et al 2014 excluded a part of the stern region from the computational domain while modifying the boundary conditions in this case the bl displacement thickness was incorporated by physically shifting the geometry but without extending the applicability to arbitrary ship forms furthermore iteratively solving the problem using the ibl theory drela 2013 with shifting or blowing techniques the convergence cannot be reached due to stern effects since the methods are not suitable for the calculation of wake with vortices e g see tanaka 1988 in addition stern surface areas with normals pointing back should be immensely shifted away from the initial positions or should blow infinite velocity to represent the wake imposing the displacement thickness using the displacing or blowing techniques implicitly modifies the tangency of the flow near the body while the tangency correction technique makes the same modifications to flow without changes in geometry and boundary conditions consequently the tangency correction technique does not suffer from the listed problems it directly incorporates the bl displacement thickness along streamlines on the surface and works with separated flows with wide wakes bašić et al 2017a this study deals with a possibility of enhancing the linear wave making theory by introducing approximate but physically correct enhancements the linear wave making theory is examined and enhancements are introduced based on the following 1 the bl and wake significantly affect the wave making the humps and hollows in the wave resistance curve are a consequence of the interaction of the inviscid bow and stern wave systems 2 any potential flow solver can yield more accurate pressure field by incorporating the bl displacement thickness information 3 from the listed coupling techniques the tangency correction technique has a direct physical connection and intrinsically handles separated flows 4 using the tangency correction the bl displacement thickness may be incorporated in the linear wave making theory without adding complexity to obtain more accurate wave resistance results the above points are explained throughout the paper and the resulting method is validated by calculating the resistance of five various hull forms and comparing the results to known experimental values the remainder of the paper is structured as follows section 2 describes the linear theory and corresponding numerical procedure for predicting wave resistance of ships section 3 analyses how to improve the theory by including viscous and phase shifting effects the validation of the extended theory is given in section 4 finally section 5 lists the drawn conclusions 2 wave making theory 2 1 far field wave resistance wave making is determined by the potential component in the far field zhu et al 2017 showed that hogner s modification of michell s theory may benefit prediction of wave making for high froude numbers since the area where the wave resistance begins to increase is of interest to the naval architect the problem of wave making is examined through somewhat simpler foundations of michell s thin ship theory the problem of wave making is nonlinear due to the quadratic nature of the dynamic free surface condition while the free surface elevation ζ x y is not known a priori michell 1898 approached the problem by linearisation of the boundary conditions which are imposed only on the centreplane y 0 and still waterline z 0 he used his fourier integral theorem to obtain the velocity potential and pressure on the centreplane i e on the projection of the hull havelock later replaced the fourier integral theorem with a distribution of sources and sinks on the centreplane the thin and slender ship approximations satisfy the laplace equation the radiation condition and the kelvin michell linearised free surface boundary condition a steadily moving body near the free surface produces free waves with a steady surface wave pattern free wave elevation far away from the ship equals to the sum of amplitudes of waves that travel at various angles of propagation θ relative to the vessel direction the hull and flow around the hull are assumed symmetrical about the centreplane so that only the starboard is considered θ π 2 π 2 in ship fixed reference system the wave elevation is defined as 1 ζ x y ℜ π 2 π 2 a θ exp i k θ x cos θ y sin θ d θ where a θ is the complex amplitude function of the free wave for an angle of propagation and k is the wave number that is defined as 2 k k 0 λ 2 where k 0 is the basic wave number k 0 g u 2 u is the ship speed and λ is the secant of wave propagation angle λ sec θ because the total energy in the far field wave pattern arises from the moving ship it is directly related to the wave pattern resistance r w p the value of the wave pattern resistance force is given for infinite water depth by the following expression 3 r w p π 2 ρ u 2 π 2 π 2 a θ 2 cos 3 θ d θ where ρ is the fluid density therefore the wave resistance depends quadratically on the wave amplitude with a cubic weighting factor related to the wave propagation angle the complex amplitude function a θ depends on the hull shape angle of propagation of waves and the ship speed u it can be computed numerically e g by the thin ship theory cfd amini afshar and bingham 2018 or it can be obtained by experimental measurements degiuli et al 2003 the complex amplitude function in infinite depth is generally defined as 4 a θ 2 π i k θ 2 p θ i q θ for water of infinite depth and a thin body whose geometry is described with a half breadth function y x z michell s theory indicates 5 p θ i q θ s x y x z exp k z i x k 0 λ d x d z where sources are described with the longitudinal slope of the geometry x y x z y x z x besides the wave pattern component wave making resistance includes nonlinear components which are primarily arising from wave breaking at the bow and stern miyata et al 2014 2 2 numerical solution if the ship hull geometry is described with a half breadth function y x z then each station of the hull can be described with a curve y x z from its lowest point of the section z m i n 0 to its uppermost point z m a x 0 rather than evaluating michell s triple integral eq 3 integration by parts is used to separate the integral which solves the problem with the following steps 1 the lowest level integral obtains the contribution of a ship section for a wave propagation angle along the draught 6 f x λ z m i n z m a x x y x z exp z k λ d z 2 the higher level integral gathers contributions of ship sections for a wave propagation angle along the ship from bow to stern 7 p λ i q λ 0 l f x λ exp i x k 0 λ d x in order to avoid dealing with complex number numerics p λ and q λ from eq 7 are described separately by two complementary integrals that replace exp i by cos and sin components those oscillatory integrals are then computed by filon s integration formula tuck et al 2001 3 finally the following integral gathers the amplitudes of the free wave spectrum for all possible wave propagation angles 8 r w p 4 π ρ u 2 k 2 0 p 2 λ q 2 λ 1 t 2 d t where the substitution λ 1 t 2 is introduced to avoid integration difficulties due to the integral singularity of eq 3 noblesse et al 2008 in conclusion the wave resistance of a ship hull is obtained by evaluation of three separate integrals described by eqs 6 8 a single threaded evaluation of the wave resistance numerical procedure takes on average 50 ms on a modern 3 6 ghz processor using 250 transverse sections that describe the frame section by an array of 50 points distributed along the vertical axis this 250 50 grid was shown to offer adequate precision when evaluating eqs 6 8 for various hull forms tested in section 4 3 theory modifications the linearised wave making resistance theory is usually valid for ships with large l b ratio for conventional ship forms which have the l b ratio from 6 to 8 the thin ship theory gives poor estimate of the wave making resistance the modifications of the thin ship theory described below expand the limitations of the theory so that it can be applied to common hull forms 3 1 boundary layer bašić et al 2017a introduced a bl correction for potential flows by letting the flow follow the outer bl frontier and the mean wake direction after the separation occurs they showed that the tangency correction technique may be applicable not only to streamlined forms but to bluff bodies as well the treatment called the tangency correction is implemented through virtual rotation of surface normals and correspondingly tangents as shown in fig 1 it was found that the correction angle δ β has a direct connection to the bl displacement thickness δ 9 s δ δ s tan δ β s where s is the direction of the streamline path the distribution of bl displacement thickness along the streamline δ s obtained by rotating normals δ β s is responsible for reproducing viscous pressure fields the question that remains is how to assume or calculate the distributions of δ β and δ for general ship hull forms δ should be calculated by marching downstream the streamlines from the stagnation point which are not known a priori the problem can be solved by obtaining streamlines on the double body and then solving the ibl equations along the streamlines von kerczek 1973 with empirical closure relations drela 2013 to avoid the cumbersome three dimensional calculation of a double body problem in this study δ is approximately predicted by marching downstream the waterlines actual streamlines are three dimensional and therefore this cannot be reliable for areas where streamlines abruptly change their depth which is usually near the baseline on the other hand the tangency correction applied on the bottom of the hull does not affect the wave pattern significantly since the influence of depth changes exponentially which is visible in eq 6 based on the above assumptions it can be concluded that if actual streamlines near the free surface roughly follow the waterlines of the hull then the inclusion of the waterline tangency correction should yield more realistic wave patterns than the original thin ship theory in this study the distribution of δ is calculated by solving the ibl equations along hull waterlines waterline using xfoil software drela 1989 the tangency correction angle is calculated according to eq 9 as 10 δ β arctan x δ where x δ is the longitudinal rate of change of the displacement thickness following the introduced assumptions eq 6 is evaluated for modified slopes not the original hull geometry the definition of the tangency correction defines the modified slope or the tangency of flow as 11 x y b l tan arctan x y δ β eq 11 modifies surface tangents inside eq 6 to include the bl displacement effect by rotating the surface normal around the vertical axis depicted in fig 1 due to approximating streamlines confined in their waterplane besides the thin ship theory the correction is applicable to other variants of linear wave making theory e g noblesse et al 2013 and zhu et al 2018 3 2 phase shifting difference of the pressure and velocity between the thin ship and real geometry results in difference of the phase and amplitude of the generated wave pattern besides the bl correction explained in the former section that modifies the generated wave amplitude a correction of the phase of the wave pattern around the thin ship is needed tsubogo 2014 even if the dynamic pressure on the hull near free surface is similar between the thin and real ship the difference in the phase will arise nonetheless the higher order influence is known to be the major reason for the phase shift of the regular waves han et al 2003 total wave phase advances considerably compared to the first order wave while the amplitude of the total wave height does not differ too much from that of the first order wave the second order effect is strong near the bow and shoulder of the hull miyata et al 2014 therefore the hull shape forward from the fore shoulder fs is the main factor for the phase shift since the influence of wave making decays exponentially with depth the shape of the waterline may be taken as the main variable in the spirit of simplicity of michell s theory approximate resolution for the problem is to modify the basic wave number within numerical calculations k 0 k ˆ 0 based on the waterline shape forward from the fore shoulder it was empirically found that there is a strong linear dependence between the change in the basic wave number and the fore waterline arc to projection length ratio the following expression enhances the phase due to nonlinear effects for most common ship hulls 12 k ˆ 0 k 0 1 3 7 s f s l f s 1 where k ˆ 0 is the modified basic wave number s f s is the length of the waterline curve measured from the forward perpendicular fp to the fs and l f s is the longitudinal distance measured from the fp to the fs 3 3 oscillations the resulting wave resistance curve is known to oscillate mostly at low froude numbers ananthakrishnan 1999 showed that the wave dampening by viscosity is stronger on short waves although tuck et al 2001 concluded that there is little dependence of the viscosity on the free surface elevation unless the viscosity is increased over several orders of magnitude to be even larger than the oceanographically relevant eddy viscosity without a physical connection confirmed any kind of damping in mathematical sense contributes the stabilisation of the resistance curve for low froude numbers in this work waves with very small wavelength compared to the length of ship are simply discarded from the numerical evaluation of the complex amplitude function eq 7 4 numerical experiments this section presents the validation of the introduced enhancements for the thin ship theory numerical simulations predicted the total resistance of both slender and full hull types shown in fig 2 and the results are compared to experimental data the hulls have different block coefficients and l b ratios from 3 6 to 12 5 the transoms were kept dry to remove their dependency on the wave making the total resistance force r t comprises of the wave and viscous resistance 13 r t r w r f 1 k where r w is the wave resistance obtained by the numerical procedure explained in section 2 2 r f is the frictional resistance obtained by the ittc 1957 frictional correlation line and 1 k is the form factor obtained from the experimental measurements in addition to eq 13 the total resistance coefficient c t is also used as a relevant measure 14 c t r t 1 2 ρ u 2 s w where s w is the at rest wetted surface area of the hull 4 1 wigley hull due to its simple geometry the parabolic wigley hull is often used as a benchmark for methods that handle free surface andrun et al 2018 the mathematical representation of the wigley hull is defined by 15 y x z b 2 1 2 x l 2 1 z t 2 where b is the breadth l is the length and t is the draught of the hull main dimensions of the wigley hull considered in this study are taken as l 4 0 m b 0 40 m and t 0 25 m which correspond to those of the model made by ship research institute kajitani et al 1983 fig 3 compares the total resistance curves of the original and modified thin ship theory to the experimental measurements both resistance curves in graphs include the same amount of viscous resistance force r f 1 k the form factor 1 k 1 095 reported by kajitani et al 1983 was used in the numerical simulations the hollows of the numerical curve follow the measurements indicating that there is no need for shifting of the phase since s f s l f s 1 the curve obtained by the original theory has exaggerated humps due to the stern being too strong of a wave generator fig 4 shows a distribution of the boundary layer displacement thickness at depth of 0 2 t predicted by xfoil which is compared to the experimental data of shahshahan and landweber 1986 the value of δ reaches 10 of the hull beam more importantly slope of the curve defines the tangency correction eq 10 it is noticeable that the wave pattern and viscous pressure resistance strongly depends on the ship after body where the value of δ rises abruptly and induces flow separation the adverse pressure at stern leads to the rapid increase of the bl thickness and viscous stresses which is even the case for the slender wigley hull normals of aft regions in slender hull are only slightly rotated backwards but still the bl displacement thickness is significant and δ β corrections must be incorporated this is an important understanding which verifies the need for including the bl effects even for slender forms with ratio l b 10 consequently results of the modified theory in fig 3 oscillate to smaller extent and are in better agreement with the experimental measurements than the original theory 4 2 series 60 with c b 0 6 series 60 is a general cargo hull form without a bulb having u shaped sections it is often used as a cfd validation test in combination to the wigley hull a model defined with l p p 3 0 m b 0 40 m t 0 163 m and c b 0 6 in fixed model condition is simulated and compared to the experimental data of toda et al 1992 the form factor 1 k 1 135 calculated by prohaska s method is used for obtaining the viscous resistance the comparison of the total resistance force and coefficient obtained numerically and experimentally is shown in fig 5 the original theory produces a local peak in the resistance curve which is unrealistically high and starts prematurely the local maximum is reached at f n 0 28 while the experiment shows it should be reached around f n 0 30 inviscid flow around the stern generates waves that are excessively superposed to waves generated by the fore compared to the original theory curve the local peak and hollow of the modified curve only slightly oscillates around the experimental points as in the case of the wigley hull the ship resistance curves benefit from the introduced modifications 4 3 delft 372 broglia et al 2014 conducted an experimental investigation on models of delft 372 monohull and catamarans the model has typical lines of a high speed displacement hull shown in fig 2 and principal dimensions of l p p 3 0 m b 0 24 m t 0 15 m and c b 0 403 the experiments were conducted on a free model while the simulations were done for a fixed model in the displacement regime this simplifies the validation without introducing additional effects of the immersed transom during the semi displacement regime it is worth noting that the relatively high ratio l b 12 5 characterises the hull as slender and prohaska s method yields low form factor 1 k 1 05 nevertheless the original thin ship theory over predicts the wave resistance of the hull for all simulated froude numbers while the inclusion of the bl displacement thickness through the tangency correction suppresses the stern wave system and therefore yields lower wave making resistance the measurements by broglia et al 2014 show that for f n 0 5 both trim and sinkage change significantly consequently numerically obtained resistance curve for the fixed model start to deviate from the measured values on a dynamic model the resistance at high speed displacement froude numbers is under predicted without taking the trim and sinkage into account the validation of the modified theory for semi displacement regimes is left for future work 4 4 wide light yacht sailing yacht research foundation syrf published the tank test data from their wide light yacht project for the hydrodynamics of a high performance yacht claughton 2015 a comprehensive set of data is collected for the canoe body with and without appendages in upright heeled and yawed conditions the canoe has a displacement of 197 kg the waterline length l w l 4 60 m and the maximum beam of b 1 28 m the hull ratio l b 3 6 is far from usual limits that characterise the ship as slender compared to the delft 372 model the upright canoe model had experienced significant sinkage even at lower froude numbers therefore this numerical experiment applies the change in sinkage for each simulated froude number which is obtained from the experimental data by claughton 2015 the trim is ignored as it slowly changes with the canoe speed the wave resistance of the upright canoe body is computed using the introduced method and the used value of the form factor 1 k 1 18 was obtained by prohaska s method the results are compared against the measured data in fig 7 very good agreement between the measured and computed data is obtained 4 5 kriso containership besides a hull with a very small l b ratio that was reported in the previous section a difficult test for the introduced corrections is to predict the resistance of a full hull form kriso containership kcs has a typical containership form with a bulbous bow the model is defined with l p p 7 279 m b 1 019 m t 0 342 m and c b 0 651 which is the largest of the tested models as shown in fig 2 it has a conventional value of l b 7 1 and an extremely high value of the midship section coefficient c m 0 985 fig 8 shows the resistance curves of the kcs model obtained by the modified theory which is compared to the experimental data from chen et al 2016 and holtrop mennen s method the value of the form factor 1 k 1 165 was calculated from the experimental data using the method of prohaska which was used in the simulation very good agreement is found between the modified thin ship theory and the experiment the simulation properly predicts rising of the wave resistance with the speed unlike the holtrop mennen s method that approximates the wave resistance rise and misses its gradient from f n 0 25 to f n 0 3 the original theory frantically over predicts the wave resistance fig 9 shows the wave making pressure distribution obtained as described by noblesse et al 2008 which renders the difference of the original and modified thin ship theories the hull lines rendered in fig 2 show that the stern region has steep geometry changes within the relatively small stern length changes in geometry induce adverse pressure gradients that cause sudden development of the bl displacement thickness and probable flow separation with vortices duy et al 2017 the previous numerical experiments had validated that the inclusion of bl displacement thickness indeed damps far field waves but the kcs experiment shows that the tangency correction can damp far field waves irrelevant of the adverse pressure gradient strength this indicates that the modified method can be potentially applied to full ship forms with realistic l b ratios and c b values 4 6 discussion as it is noted in literature the bl and wake affect the wave making of a steadily moving vessel the resistance curves shown in figs 3 8 which are obtained using the unmodified theory have humps and hollows that are a consequence of the interaction of the inviscid bow and stern wave systems since the tangency correction has proven to correctly model the rapid increase of the bl displacement thickness for bluff bodies the technique was applied to ship hulls with streamlined forms in order to avoid difficulties of implementing an ibl solver a simple empirical approximation for δ β along a general streamline was introduced with the intent to validate the possibility of improving the wave making prediction although the approximation has corrected the total resistance of the five introduced hull forms the more general method using the ibl should be implemented for general forms figs 3 8 show that the approximate modifications enhance sources of far field waves irrelevant of the adverse pressure gradient strength and validate that the inclusion of the bl displacement thickness improves the interaction of the bow and stern wave systems generally if the trim and sinkage are not taken into account for high speed vessels then numerical methods frequently under predict the resistance in these cases the original thin ship theory may purely accidentally yield accurate results since the theory regularly over predicts the wave resistance at higher froude numbers naval architects should avoid relying on absolute results of the uncorrected original linear theories 5 conclusions commercially viable ships sail in the displacement regime with speeds merely smaller where the wave making resistance begins to increase toward its global maximum therefore this area is of interest to the naval architect michell s integral has been analysed for over 120 years in order to understand why it yields errors to the order of magnitude within the area of interest especially for hulls that experience strong adverse pressure gradients the aim of this study was to give new insight into why the errors and oscillations in the resistance curve occur and to offer a simple approximate solution to the problem the following conclusions are drawn the inviscid wave making theory generally over predicts the wave resistance due to the stern being too strong of a wave generator as the inviscid potential flow theory restores too high pressure at the stern unrealistic stern generated waves are hence superposed to those generated by the ship fore part inclusion of the displacement thickness of the boundary layer yields realistic pressure gradients along the wetted surface consequently including it in a potential flow wave making method such as the thin ship method generates more accurate far field waves the numerical experiments conducted on five hull forms have validated that the tangency correction properly includes the displacement thickness that damps far field waves and therefore makes resistance prediction more accurate it was found that the resistance curve of a thin ship starts to grow prematurely compared to experimental measurements the phase shift can be made by virtually scaling the wave number based on the waterline shape up to the fore shoulder implementing the enhancements within the thin ship method obtains more accurate results compared to the original thin ship theory and holtrop mennen s method the trend of the total resistance curve is properly estimated for the tested hull forms meaning that the thin ship theory may be applied for arbitrary monohulls further numerical experiments are necessary in order to examine the validity of the present approaches for multihulls and hulls with immersed transom sterns credit authorship contribution statement josip bašić conceptualization methodology software branko blagojević supervision writing review editing martina andrun validation formal analysis investigation visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors wish to thank leo v lazauskas for useful and interesting discussions on the subject 
22034,the aim of this study is to present numerical procedures for hydrodynamic analysis of a heaving buoy type wec connected to a fixed jacket structure that is currently being actively studied in order to accurately assess the effect of the float on the fixed structure the augmented formulation procedure used in multibody dynamics was used to calculate the reaction force due to the float motion acting on the hinge point of the structure the hydrodynamic coefficients and wave excitation forces acting on the floats were calculated using the three dimensional frequency domain solver wamit the wave radiation forces produced by the movement of floats were calculated using the cummins equation in the time domain compared to the classical method of formula derivation technique the augmented formulation which is an automated formulation process has an advantage that it can be easily calculated even if the degree of freedom is increased thus it can be easily extended to analyze hydrodynamic performance of various multibody ocean structures to conduct the time integration the implicit runge kutta 4th order method was applied to the classical method a two loop numerical integration with the newmark beta explicit method was used in the augmented formulation method the responses of the float and reaction force acting on the hinge point were evaluated using the two numerical procedures finally the calculation results of two floats for a multi buoy hpa wec platform were analyzed to emphasize the importance of reaction force analysis keywords wave energy converter point absorber augmented formulation dynamic response reaction force 1 introduction recently research on the development of renewable energy is being carried out actively all over the world among the renewable energy sources ocean wave energy is characterized by the highest energy density and little energy loss clément et al 2002 drew et al 2009 in addition its amount of power generation is increasing gradually eu oea 2010 therefore wave power could be considered a promising marine renewable energy resource the wave energy converter wec transforms the ocean waves to electricity many different concepts for wecs have been proposed and several reviews are available clément et al 2002 drew et al 2009 falcão 2010 babarit et al 2012 according to the working principle wec technologies can be classified into three types oscillating water column oscillating body system and overtopping converter falcão 2010 wavestar is one of the oscillating multi body heaving point absorber hpa system type wecs kramer et al 2011 this type of system is composed of multiple floats connected to the main structure by structural arms and hinges babarit et al 2012 moreover the main structure is supported by bottom fixed steel piles or lifted by jack up legs fig 1 presents the wavestar prototype installed at roshage pier near hanstholm at the western coast of denmark kramer et al 2011 the figure shows the wavestar in normal operation mode in this case each float moves up and down according to the external forces and produces electricity by the hydraulic power take off pto system connected to the float for a multi buoy system the hydrodynamic interactions among the floats as well as between a float and the platform should be considered if the excitation loads acting on each structure affect the other structures karimirad 2014 in this case the structural safety of the structural arms and bottom fixed piles must be satisfied in the case of a hinged body wec system the movement of each float is constrained by the structural arm and it performs rotational motion several studies have reported the rotational motion of a float in the time domain zurkinden et al 2014 carried out both an experimental study and numerical analysis for a single float wavestar wec they showed that the linear assumptions about external moments can well implement physical model kim et al 2016 investigated the hydrodynamic responses and power takeoff of a hemispherical float wec wang et al 2018 developed a point absorber wec using a flexible multibody dynamics model they analyzed the arm s stress distribution and floater arm tip displacement and velocity kim et al 2019 conducted an experimental study for the motion characteristics of a floating wec they studied the effects of the connection methods and locations on the structure s motion in this rotational motion meanwhile the tension in the arm acts on the float as a constraint force and affects the center of rotation hinge point of platform the studies mentioned above do not consider the constraint forces and their effects these forces act as additional external forces on the platform and will affect the responses of the platform in order to evaluate the stability of the platform it is essential to determine the constraint forces the aim of this study is to present numerical procedures for hydrodynamic analysis of a heaving buoy type wec connected to a fixed jacket structure that is currently being actively studied the first is the classical method using newton s second law and the other is the augmented formulation which is one of the multibody dynamics formulation in order to accurately assess the effect of the float on the fixed structure the augmented formulation procedure was used to calculate the reaction force due to the float motion acting on the hinge point of the structure this attempt is a new procedure that is rarely found in existing papers to the best of the authors knowledge compared to the classical method of formula derivation technique the augmented formulation which is an automated formulation process has an advantage that it can be easily calculated even if the degree of freedom is increased thus it can be easily extended to analyze hydrodynamic performance of various multibody ocean structures each numerical model for a float was modeled as a hemispherical shape and connected to the hinge point by a massless rigid arm the frequency dependent hydrodynamic characteristics and wave excitation forces acting on the floats were calculated using the three dimensional frequency domain boundary element method bem based solver wamit lee 1995 the movement of floats was described using cummins equation in the time domain cummins 1962 ogilvie 1964 the equation of motion of the float was solved using both the classical method and augmented formulation the implicit runge kutta 4th order method and two loop numerical integration procedures with the newmark beta explicit method were applied to produce the time series of responses of the floats for each method newmark 1959 shabana and hussein 2009 zhang and zhang 2016 the responses of the float and reaction force acting on the hinge point were evaluated using the two numerical procedures finally the calculation results of two floats for multi buoy hpa type wec platform were analyzed to emphasize the importance of reaction force analysis 2 mathematical formulation 2 1 external forces acting on the floats when external forces act on an object connected to a hinged arm the movement of the object is constrained by the arm at this time the constraint force acts on the object in the direction of the rotation center so that the object follows a curved path in other words the object performs rotational motion about the hinge point the force acting in a direction parallel to the center of rotation does not affect the rotation of the object this force however acts as an additional moment to the hinge point and does not occur when the angle of the force is perpendicular to the axis of rotation in addition the constraint force also acts on the hinge point therefore the reaction force acting on the hinge point due to the constraint force should be considered to ensure the stability of the structure fig 2 presents a float connected to a hinge point by an arm in a two and three dimensional coordinate system in the figure θ is the angle between the arm and horizontal line l is the length of the arm r x l cos θ and r z l sin θ denote the horizontal and vertical distance between the hinge point and the float respectively the shape of the float is a hemisphere the hinge point can only rotate on one axis and the rotation on the other axis is constrained to simplify the problem it was assumed that the arm is rigid and massless in addition it was assumed that the displacement of the hinge point is much smaller than the motion of the float in this case the motion of the float can be expressed as a simple pendulum motion the external forces acting on the float are decomposed into horizontal and vertical components in this study linear external forces were used in the numerical analysis especially the magnitude of nonlinear viscous drag force is about 5 of the magnitude of wave excitation force zurkinden et al 2014 thus the viscous drag force was not considered in this study the external forces can be written as follows 1 q f x f z f f k x f d i f f x f r a d x f p t o x f f k z f d i f f z f r a d z f p t o z f w e i g h t f b u o y a n t where q is the external force vector acting on the float and f f k is the undisturbed incident wave force froude krylov force f d i f f and f r a d are the forces due to diffracted and radiated waves respectively f p t o is the damping force caused by the pto system f w e i g h t and f b u o y a n t are the self weight and buoyant force of the float respectively when designing a hpa type wec the nonlinear froude krylov force should be considered penalba et al 2017 this force can be obtained by integrating the hydrodynamic pressure on a float on the other hand this process is very difficult because it requires consideration of the instantaneous float position and submerged part every time step in this study for simplicity the linear first order froude krylov and diffraction forces were applied to the floats eqs 2 and 3 the frequency dependent froude krylov and diffraction forces as well as the added mass and damping coefficients were evaluated using a hydrodynamic solver wamit lee 1995 2 f f k k ρ w g h 2 f f k w a m i t k cos ψ f k k ω t 3 f d i f f k ρ w g h 2 f d i f f w a m i t k cos ψ d i f f k ω t where ρ w is the density of sea water and h is the wave height f f k w a m i t and f d i f f w a m i t are the magnitude of the froude krylov and diffraction forces calculated using wamit respectively ψ f k and ψ d i f f are the phase angles of the froude krylov and diffraction forces respectively these phase angles vary depending on the float location ω denotes the incident wave frequency subscript k denotes the direction of the variables the float moves both horizontally and vertically because the movement of the float is constrained by the arm therefore the wave radiation forces generated by motion in two directions should be considered the wave radiation force can be expressed using the cummins equation and the force consists of the acceleration proportional term and the velocity proportional term the latter term can be expressed as a convolution integral using the retardation function impulse response function or memory function and the velocity of a float cummins 1962 ogilvie 1964 the wave radiation forces in the k direction can be expressed as 4 f r a d k m a k k u k 0 t k k k τ u k t τ d τ where m a k k is the added mass with infinite frequency u k is the displacement of the float and k k k t is the retardation function which can be written as 5 k k k t 2 π 0 b k k ω cos ω t d ω where b k k ω is the radiation damping coefficient calculated by wamit three methods can be used to compute the convolution integral in cummins equation direct integration state space method and prony method armesto et al 2015 in this study the direct integration method was applied the pto system is connected to the wec to extract the wave energy among the many types of pto damping forces a linear pto damping moment as shown in eq 6 was applied to the external moment in this study the horizontal and vertical pto damping forces can be calculated easily using the trigonometric function 6 m p t o b p t o θ where b p t o is the damping coefficient of the pto system the self weight of the float can be considered as a constant external force in still water the buoyancy also acts as a constant external force on the submerged volume on the other hand the buoyancy changes with time if there is a wave in this study a linear buoyant force was applied to the floats this means that the submerged volume changes linearly depending on the submerged shape of the float the draft of the floats was satisfied by ballasting water this means that the self weight and buoyant force in still water cancel each other out when a float is in a sea water the self weight and linear buoyant force can be expressed as 7 f w e i g h t f b u o y a n t m g ρ w g v s a w u z t ρ w g a w u z t where m is the mass of the float v s is submerged volume of the float in still water a w is the water plane area of the float u z t is the vertical displacement of the float from the water surface 2 2 equation of motion for the floats in this study two numerical procedures were presented to solve the motion of the float and calculate the reaction force acting on the hinge point the first method is a classical method using newton s second law for motion this method derives the equation of motion considering the forces acting on the structure chao et al 2018 obtained the equation of motion for a two body articulated wave energy device with a complex geometric shape using newton s second law in this procedure however additional equations using dynamic equilibrium are required to determine the constraint force this method has the disadvantage that it is very difficult to derive an equation if the structure is slightly more complicated the second method is to use an augmented formulation this method is difficult to build on the initial process but it is possible to automate the analysis process also this method can evaluate both the motion of the float and constraint force simultaneously to do this it requires relatively more computer memory and calculation time than the classical method however increasing the number of floats is not a probelm because the absolute amount of computer memory required is small if only calculation time is considered the classical method is a bit more advantageous however as mentioned earlier considering the entire analysis process the classical method is very inefficient because new equations must be derived in each case therefore the augmented formulation method has the advantage of greatly reducing the preparation time for analysis the results calculated by both procedures were showed and verified with the reference in chapter 3 these procedures should give almost the same results because both processes are interpreting the same physical phenomena table 1 lists the typical characteristics of the two methods the detailed procedures for calculating the response and reaction force using two methods are described in the following sections 2 2 1 classical method according to newton s second law for rotation the sum of the moments acting on the hinge point is equal to the moment of inertia of the float multiplied by the angular acceleration 8 i θ m y m f k m d i f f m r a d m p t o m w e i g h t m b u o y a n t where i is the moment of inertia of the float m y is the moment acting on the float in the inverse y axis the inverse y axis direction means the same axis with the axis of rotation as shown in fig 2 several studies have calculated the moments for the center of rotation directly and substituted into eq 8 zurkinden et al 2014 flavià et al 2017 the translational forces were used to calculate the moments as the following equation 9 i θ m y r q j i k j r x r z 0 f x f z 0 j j r x f z r z f x j r x f z r z f x the relationship between the rotation angle and the translational displacement of the float can be derived as the following equations 10 u x l cos θ x h u x l θ sin θ u x l θ 2 cos θ l θ sin θ u z l sin θ z h u z l θ cos θ u z l θ 2 sin θ l θ cos θ where x h z h denote the location of the hinge point the equation of motion of the float can be obtained by substituting eqs 2 6 and 10 into eq 9 and rearranging both sides 11 i m a z z r x 2 m a x x r z 2 θ b p t o θ ρ w g a w r z z h r x l 0 t k z z τ cos θ t τ θ t τ d τ r x 0 t k x x τ sin θ t τ θ t τ d τ r z r x f f k z f d i f f z r z f f k x f d i f f x r x r z m a z z m a x x θ 2 the motion of the float is constrained by the arm with a hinge joint the external forces acting on the float are transmitted to the hinge point through the arm and the forces due to the movement of the float also act on the hinge point the constraint force acting on the float can be calculated using dynamic equilibrium the arm was assumed to be a massless rigid arm and the problem can be considered to be a simple pendulum problem fig 3 presents the dynamic equilibrium of a simple pendulum problem in fig 3 an object is connected to the hinge point with a massless rigid arm and rotates about the hinge point the applied forces acting on the system left side of fig 3 and the inertia forces right side of fig 3 should be equal the inertia forces can be divided into two components depending on the direction of body rotation normal and tangential components in particular the normal directional component is the centripetal force that makes a body follow a curved path these forces can be calculated using the angular velocity and acceleration as follows 12 f n m l θ 2 13 f t m l θ for the applied forces the notation q in fig 3 represents the external forces acting on the float as shown in eq 1 the notation r in fig 3 denotes the tension in the arm and it can be decomposed into horizontal and vertical forces r x and r z respectively these forces are from the hinge point acting on the arm according to newton s third law the forces acting on the hinge point by the arm are equal in magnitude and opposite to the direction of the tension in the arm in summary the reaction forces acting on the hinge point can be obtained as follows 14 f h x r x q x m l θ 2 cos θ θ sin θ 15 f h z r z q z m l θ 2 sin θ θ cos θ the rotation angle and angular velocity can be combined into a state vector to obtain the numerical solution as follows 16 f t θ t θ t the first time derivative of the above equation is a state space equation of the system using this equation the second order differential equation can be replaced by the first order differential equation in this study runge kutta 4th order method was applied for numerical time integration of this equation the state space equation can be expressed using the following equation 17 f t θ t θ t θ t b t d t θ t 2 e t b p t o θ t g t j t where b t r x f f k z f d i f f z r z f f k x f d i f f x d t r x r z m a z z m a x x e t l 0 t k z z τ cos θ t τ θ t τ d τ r x 0 t k x x τ sin θ t τ θ t τ d τ r z g t ρ w g a w r z z h r x j t i m a z z r x 2 m a x x r z 2 the classical method as explained so far has the drawback that the translational motion should be converted to rotational motion in order to calculate the rotation angle of the float in addition the dynamic equilibrium of the system should be considered to calculate the reaction forces acting on the hinge point in the case of a complex system the equation of motion would be much more difficult to describe 2 2 2 augmented formulation as mentioned in the previous section it is difficult to calculate the constraint forces directly when applying newton s second law the augmented formulation which is one of a multibody dynamics formulation can be used to overcome this problem using the augmented formulation the rotational motion of the float and the reaction forces acting on the hinge point can be calculated at the same time the constrained system is described using the following differential and algebraic equations 18 m u c u t λ q 19 c u t 0 where m is the mass matrix of the float c u t is the constraint equations of the system at the displacement level c u is the partial differential matrix of constraint equations λ is the lagrange multiplier vector the first and second derivatives of eq 19 define the constraint equations at the velocity and acceleration levels as follows 20 c u u c t 21 c u u q c c u u u u 2 c u t u c t t where c t is the partial derivative of the constraint equation with respect to the time q c is the vector related to the second time derivative of the constraint equation eqs 18 and 21 can be combined to form the following augmented formulation shabana 2013 22 m c u t c u 0 u λ q q c the above equations can be solved numerically to obtain the accelerations and lagrange multipliers vectors in the numerical process the solutions of eq 22 should always be satisfied with eqs 19 and 20 satisfying eqs 19 20 and 22 means that the response vectors of the float satisfy the constraint equations of the system at the displacement velocity and acceleration levels to solve these equations in the time domain two loop numerical integration procedures were proposed shabana and hussein 2009 zhang and zhang 2016 the outer loop of the two loop procedure is the iterative process of the explicit or implicit integration schemes and the inner loop is the newton raphson iterative method for solving eq 19 in this study the newmark beta explicit method was employed for the outer loop of the two loop procedure in planar motion an unconstrained object has three degrees of freedom two translational motions and a single rotational motion in the case of the hinge joint two translational motions are constrained by one arm therefore the object has one degree of freedom which is the rotational motion θ about the rotation axis in other words the motion of the float can be described using only the angle of rotation and the translational displacements x f z f are dependent on this angle in this case the rotation angle can be defined as an independent coordinate u i and the translational displacements can be defined as dependent coordinates u d the conditions for the hinge joint are that the point where the two objects are connected remains constant throughout the entire motion fig 4 presents two bodies the fixed wall and a float with an arm which are connected by a hinge joint the constraint equation for the hinge joint can be expressed as follows 23 c u t r o f r o h r h f 0 where r i j denotes the position vector from point i to point j the point o is the origin of the system coordinate and can be set to 0 0 for simplicity the r vectors can be expressed as follows 24 r o h x h z h 25 r o f x f z f 26 r h f a r f where a is the transformation matrix from the arm float coordinate system to the global coordinate system the vector r f is the position vector of the float in arm float coordinate system as follows 27 a cos θ sin θ sin θ cos θ 28 r f l 0 t substituting eqs 24 28 into eq 23 the constraint equations can be expressed as 29 c u t x f x h l cos θ z f z h l sin θ 0 the constraint jacobian matrix can be expressed as 30 c u t 1 0 0 1 l sin θ l cos θ the constraint forces acting on the float can be calculated by multiplying eq 30 by the lagrange multiplier vector the constraint forces acting on the hinge point can be obtained by changing the point of action from the float to the hinge point the translational constraint forces are the same but the moment should be changed according to the following equation 31 f h c u t λ 0 0 r h f q t t augmented formulation as explained thus far has the disadvantage that a second derivative with respect to the time of the constraint equation is required on the other hand this method has the advantages that it is easy to program and the constraint forces are calculated automatically at every time step 3 numerical results and discussion 3 1 validation of calculation methods prior to the validation the results of two procedures were compared to check whether they provided the same results fig 5 presents a hemispherical float constrained to a hinge point in the two dimensional coordinate system flavià et al 2017 the float could only rotate about the axis of rotation inverse y axis as shown in fig 2 the diameter of the float was 6 m and the water depth was 20 m the direction of the incident wave was the x axis the hydrodynamic coefficients and wave exciting forces acting on the float were calculated using wamit in the frequency domain the time domain motions of the float were described using the cummins equation the damping coefficient of the pto system b p t o of 3 52 106 n m s was applied for analysis fig 6 shows the time history of the rotation angle of the float according to the calculation method for the simulation a wave height of 2 m and wave frequency of 1 0 rad s were applied the ramp function was applied for the first 30 s to prevent sudden changes regardless of the calculation method the rotation angle was similar over the entire time range this means that the angular velocity and angular acceleration of the float are the same in both methods and the reaction forces acting on the hinge point will also be the same fig 7 shows the time history of the horizontal and vertical reaction forces acting on the hinge point as expected the results were similar in both calculation methods to verify the validity of both methods the response amplitude operator rao for the rotational motion of the float were compared with the reference flavià et al 2017 fig 8 compares the pitch rao of the float the maximum error between the calculation results and the reference was approximately 3 over the entire frequency range the trend and magnitude of the pitch rao agreed well with the reference values therefore the validity of the calculation methods used in this study was verified in addition to the above results fig 9 compares the spectrum of the horizontal and vertical reaction force magnitudes between the calculation methods the peak frequency of the reaction force spectra was the same with the peak frequency of the pitch rao this means that the reaction force acting on the hinge point increased with increasing rotational motion of the float in figs 8 and 9 the results of both methods were similar over the given frequency range this means that both procedures well analyzed the responses of the float and its effects in terms of set up efficiency for numerical analysis the classical method is very inefficient because it requires the formula derivation process every time the analysis target changes therefore building the numerical process using the augmented formulation is more efficient in terms of efficiency and applicability 3 2 dynamic results of multi buoy wec the reaction forces acting on the hinge points are influenced not only by the environmental conditions but also by the arrangement of the floats this is because the motion of the floats varies according to both the interaction between the floats and the direction of the action of the forces acting on the floats in this section the calculation results of two floats for a multi buoy hpa type wec platform were analyzed to emphasize the importance of reaction force analysis fig 10 describes a wec with two hemispherical floats the two legs of the wec were assumed to be slender elements and to be fixed thus the influence of the legs did not significantly affect the calculation results the direction of the incident wave was applied only to the x axis for analysis in two dimensional conditions floats 1 and 2 were constrained to hinge point 1 at an obtuse angle and hinge point 2 at an acute angle to the horizontal axis respectively the floats had the same structural properties but the locations and directions of the external forces were different this caused the magnitude and phase differences of the horizontal and vertical external forces between the floats the diameter of each float of 6 m and the water depth of 20 m were applied the direction of the incident wave was the x axis the damping coefficient of the pto system b p t o of 3 52 106 n m s was applied for analysis in the previous section the results were similar regardless of the calculation method therefore in this section the motion of the float and the reaction force acting on the hinge point were calculated simultaneously using the augmented formulation fig 11 compares the pitch raos between floats 1 and 2 two floats have different peak frequencies the peak frequency of float 2 was approximately 1 14 rad s and the response difference to float 1 at this frequency was approximately 25 1 the tendency of the pitch rao of float 2 was slightly different from the results of the single float case due to the interaction between float 1 and 2 the magnitude of the pitch rao of float 2 was greater than that on float 1 at frequencies higher than the peak frequency of float 1 this means that when the wec is in operation a larger wave power can be obtained when the angle between the arm and wave propagating direction is an acute angle on the other hand the rotational motion of each float can be calculated using eq 8 because the structural properties of floats 1 and 2 were identical the only value that affects the motion was the moment acting on the center of rotation fig 12 presents the inverse y axis moment acting on each hinge point for one wave period in this figure the results when a wave frequency of 1 14 rad s were shown to analyze the responses when the pitch rao of float 2 was the largest the moments were slightly nonlinear during a period and the magnitude of the range of moment at hinge point 2 was 15 2 greater than that of hinge point 1 because the angular acceleration of the float is directly proportional to the moment as shown in eq 8 it can be predicted that the angular accelerations will have the same tendency as the moments fig 13 presents the rotation angle and angular acceleration of the floats during a single wave period the angular acceleration showed slight nonlinearity similar to the tendency of the moment as expected in addition the magnitude of the range of angular acceleration at hinge point 2 was 15 5 greater than that of hinge point 1 which is similar to the ratio of the moment the magnitude ratios of the moment and the angular acceleration were different from the ratio of the pitch rao of the float this is because the angular acceleration has a little nonlinearity and the result of the time integration also has some nonlinearity fig 14 compares the spectrum of horizontal and vertical reaction force magnitudes between hinge points 1 and 2 in contrast to the trend of pitch rao the reaction forces acting on hinge point 1 were much greater than those acting on hinge point 2 this means that although the movement of the float is relatively small the force acting on the hinge point can be large in addition the magnitudes of the vertical reaction force were greater than the horizontal reaction force in both floats this is because the linear buoyancy was included in the vertical external force these horizontal and vertical reaction forces should be considered as external forces acting on the hinge point when analyzing the behavior of the wec platform the above results showed that even if the structural properties of the floats were the same the responses can be affected not only by the direction of forces but also their arrangements especially the tendency and magnitude of the reaction forces acting on the hinge points would not be easily predictable without performing the reaction force analysis in other words both the motion of the float and the reaction force acting on the hinge point must be evaluated to satisfy the structural stability of the hpa type wec platform 4 conclusions this paper presented two numerical procedures to evaluate both the dynamic responses of the float and the reaction forces acting on the hinge point for hpa type wec platform one is the classical method using newton s second law for rotation and the other is the augmented formulation which is one of multibody dynamics formulation the characteristics of the two procedures were explained in detail two procedures give almost the same results because both methods deal with the same physical phenomena an important part of the proposed procedures is the calculation of the reaction forces acting on the hinge points of the wec platform from this perspective the calculation process was explained and the results were compared in the case of the hpa type wec platform multiple floats were connected to the main structure by structural arms and hinges each numerical model for a float was modeled as a hemispherical shape and connected to the hinge point by a massless rigid arm the frequency dependent hydrodynamic characteristics and wave excitation forces acting on the floats were calculated using the three dimensional frequency domain bem solver the movement of floats was described using cummins equation in the time domain the validity of the calculation methods was verified by comparing the pitch rao of a single float with the reference paper the calculation results using both methods agreed very well with each other over the given range of frequency this means that both procedures well analyzed the responses of the float and its effects however in terms of efficiency of numerical analysis preparation stage the classical method is very inefficient because it requires much more complicated process according to the model of the platform changes therefore building the numerical process using the augmented formulation is more efficient in terms of efficiency and applicability in the case of the two floats the results of each float were different due to the direction of force and the position of the floats especially the tendency and magnitude of the reaction forces would not be easily predictable without conducting the reaction force analysis this means that it is essential to confirm the effects of float motion on the main structure when performing stability analysis of the hpa type wec platform these effects can be considered when applying the methods presented in this study in the future the structural analysis of the hpa type wec platform will be carried out considering the various environmental conditions such as oblique waves and the flexible arm which is composed by beam elements author contribution section mr heo and prof koo developed the numerical procedures and carried out all numerical calculations and wrote the manuscript declaration of competing interest the authors declare that there is no conflict of interests regarding the publication of this paper acknowledgements this work was supported by inha university research grant 
22034,the aim of this study is to present numerical procedures for hydrodynamic analysis of a heaving buoy type wec connected to a fixed jacket structure that is currently being actively studied in order to accurately assess the effect of the float on the fixed structure the augmented formulation procedure used in multibody dynamics was used to calculate the reaction force due to the float motion acting on the hinge point of the structure the hydrodynamic coefficients and wave excitation forces acting on the floats were calculated using the three dimensional frequency domain solver wamit the wave radiation forces produced by the movement of floats were calculated using the cummins equation in the time domain compared to the classical method of formula derivation technique the augmented formulation which is an automated formulation process has an advantage that it can be easily calculated even if the degree of freedom is increased thus it can be easily extended to analyze hydrodynamic performance of various multibody ocean structures to conduct the time integration the implicit runge kutta 4th order method was applied to the classical method a two loop numerical integration with the newmark beta explicit method was used in the augmented formulation method the responses of the float and reaction force acting on the hinge point were evaluated using the two numerical procedures finally the calculation results of two floats for a multi buoy hpa wec platform were analyzed to emphasize the importance of reaction force analysis keywords wave energy converter point absorber augmented formulation dynamic response reaction force 1 introduction recently research on the development of renewable energy is being carried out actively all over the world among the renewable energy sources ocean wave energy is characterized by the highest energy density and little energy loss clément et al 2002 drew et al 2009 in addition its amount of power generation is increasing gradually eu oea 2010 therefore wave power could be considered a promising marine renewable energy resource the wave energy converter wec transforms the ocean waves to electricity many different concepts for wecs have been proposed and several reviews are available clément et al 2002 drew et al 2009 falcão 2010 babarit et al 2012 according to the working principle wec technologies can be classified into three types oscillating water column oscillating body system and overtopping converter falcão 2010 wavestar is one of the oscillating multi body heaving point absorber hpa system type wecs kramer et al 2011 this type of system is composed of multiple floats connected to the main structure by structural arms and hinges babarit et al 2012 moreover the main structure is supported by bottom fixed steel piles or lifted by jack up legs fig 1 presents the wavestar prototype installed at roshage pier near hanstholm at the western coast of denmark kramer et al 2011 the figure shows the wavestar in normal operation mode in this case each float moves up and down according to the external forces and produces electricity by the hydraulic power take off pto system connected to the float for a multi buoy system the hydrodynamic interactions among the floats as well as between a float and the platform should be considered if the excitation loads acting on each structure affect the other structures karimirad 2014 in this case the structural safety of the structural arms and bottom fixed piles must be satisfied in the case of a hinged body wec system the movement of each float is constrained by the structural arm and it performs rotational motion several studies have reported the rotational motion of a float in the time domain zurkinden et al 2014 carried out both an experimental study and numerical analysis for a single float wavestar wec they showed that the linear assumptions about external moments can well implement physical model kim et al 2016 investigated the hydrodynamic responses and power takeoff of a hemispherical float wec wang et al 2018 developed a point absorber wec using a flexible multibody dynamics model they analyzed the arm s stress distribution and floater arm tip displacement and velocity kim et al 2019 conducted an experimental study for the motion characteristics of a floating wec they studied the effects of the connection methods and locations on the structure s motion in this rotational motion meanwhile the tension in the arm acts on the float as a constraint force and affects the center of rotation hinge point of platform the studies mentioned above do not consider the constraint forces and their effects these forces act as additional external forces on the platform and will affect the responses of the platform in order to evaluate the stability of the platform it is essential to determine the constraint forces the aim of this study is to present numerical procedures for hydrodynamic analysis of a heaving buoy type wec connected to a fixed jacket structure that is currently being actively studied the first is the classical method using newton s second law and the other is the augmented formulation which is one of the multibody dynamics formulation in order to accurately assess the effect of the float on the fixed structure the augmented formulation procedure was used to calculate the reaction force due to the float motion acting on the hinge point of the structure this attempt is a new procedure that is rarely found in existing papers to the best of the authors knowledge compared to the classical method of formula derivation technique the augmented formulation which is an automated formulation process has an advantage that it can be easily calculated even if the degree of freedom is increased thus it can be easily extended to analyze hydrodynamic performance of various multibody ocean structures each numerical model for a float was modeled as a hemispherical shape and connected to the hinge point by a massless rigid arm the frequency dependent hydrodynamic characteristics and wave excitation forces acting on the floats were calculated using the three dimensional frequency domain boundary element method bem based solver wamit lee 1995 the movement of floats was described using cummins equation in the time domain cummins 1962 ogilvie 1964 the equation of motion of the float was solved using both the classical method and augmented formulation the implicit runge kutta 4th order method and two loop numerical integration procedures with the newmark beta explicit method were applied to produce the time series of responses of the floats for each method newmark 1959 shabana and hussein 2009 zhang and zhang 2016 the responses of the float and reaction force acting on the hinge point were evaluated using the two numerical procedures finally the calculation results of two floats for multi buoy hpa type wec platform were analyzed to emphasize the importance of reaction force analysis 2 mathematical formulation 2 1 external forces acting on the floats when external forces act on an object connected to a hinged arm the movement of the object is constrained by the arm at this time the constraint force acts on the object in the direction of the rotation center so that the object follows a curved path in other words the object performs rotational motion about the hinge point the force acting in a direction parallel to the center of rotation does not affect the rotation of the object this force however acts as an additional moment to the hinge point and does not occur when the angle of the force is perpendicular to the axis of rotation in addition the constraint force also acts on the hinge point therefore the reaction force acting on the hinge point due to the constraint force should be considered to ensure the stability of the structure fig 2 presents a float connected to a hinge point by an arm in a two and three dimensional coordinate system in the figure θ is the angle between the arm and horizontal line l is the length of the arm r x l cos θ and r z l sin θ denote the horizontal and vertical distance between the hinge point and the float respectively the shape of the float is a hemisphere the hinge point can only rotate on one axis and the rotation on the other axis is constrained to simplify the problem it was assumed that the arm is rigid and massless in addition it was assumed that the displacement of the hinge point is much smaller than the motion of the float in this case the motion of the float can be expressed as a simple pendulum motion the external forces acting on the float are decomposed into horizontal and vertical components in this study linear external forces were used in the numerical analysis especially the magnitude of nonlinear viscous drag force is about 5 of the magnitude of wave excitation force zurkinden et al 2014 thus the viscous drag force was not considered in this study the external forces can be written as follows 1 q f x f z f f k x f d i f f x f r a d x f p t o x f f k z f d i f f z f r a d z f p t o z f w e i g h t f b u o y a n t where q is the external force vector acting on the float and f f k is the undisturbed incident wave force froude krylov force f d i f f and f r a d are the forces due to diffracted and radiated waves respectively f p t o is the damping force caused by the pto system f w e i g h t and f b u o y a n t are the self weight and buoyant force of the float respectively when designing a hpa type wec the nonlinear froude krylov force should be considered penalba et al 2017 this force can be obtained by integrating the hydrodynamic pressure on a float on the other hand this process is very difficult because it requires consideration of the instantaneous float position and submerged part every time step in this study for simplicity the linear first order froude krylov and diffraction forces were applied to the floats eqs 2 and 3 the frequency dependent froude krylov and diffraction forces as well as the added mass and damping coefficients were evaluated using a hydrodynamic solver wamit lee 1995 2 f f k k ρ w g h 2 f f k w a m i t k cos ψ f k k ω t 3 f d i f f k ρ w g h 2 f d i f f w a m i t k cos ψ d i f f k ω t where ρ w is the density of sea water and h is the wave height f f k w a m i t and f d i f f w a m i t are the magnitude of the froude krylov and diffraction forces calculated using wamit respectively ψ f k and ψ d i f f are the phase angles of the froude krylov and diffraction forces respectively these phase angles vary depending on the float location ω denotes the incident wave frequency subscript k denotes the direction of the variables the float moves both horizontally and vertically because the movement of the float is constrained by the arm therefore the wave radiation forces generated by motion in two directions should be considered the wave radiation force can be expressed using the cummins equation and the force consists of the acceleration proportional term and the velocity proportional term the latter term can be expressed as a convolution integral using the retardation function impulse response function or memory function and the velocity of a float cummins 1962 ogilvie 1964 the wave radiation forces in the k direction can be expressed as 4 f r a d k m a k k u k 0 t k k k τ u k t τ d τ where m a k k is the added mass with infinite frequency u k is the displacement of the float and k k k t is the retardation function which can be written as 5 k k k t 2 π 0 b k k ω cos ω t d ω where b k k ω is the radiation damping coefficient calculated by wamit three methods can be used to compute the convolution integral in cummins equation direct integration state space method and prony method armesto et al 2015 in this study the direct integration method was applied the pto system is connected to the wec to extract the wave energy among the many types of pto damping forces a linear pto damping moment as shown in eq 6 was applied to the external moment in this study the horizontal and vertical pto damping forces can be calculated easily using the trigonometric function 6 m p t o b p t o θ where b p t o is the damping coefficient of the pto system the self weight of the float can be considered as a constant external force in still water the buoyancy also acts as a constant external force on the submerged volume on the other hand the buoyancy changes with time if there is a wave in this study a linear buoyant force was applied to the floats this means that the submerged volume changes linearly depending on the submerged shape of the float the draft of the floats was satisfied by ballasting water this means that the self weight and buoyant force in still water cancel each other out when a float is in a sea water the self weight and linear buoyant force can be expressed as 7 f w e i g h t f b u o y a n t m g ρ w g v s a w u z t ρ w g a w u z t where m is the mass of the float v s is submerged volume of the float in still water a w is the water plane area of the float u z t is the vertical displacement of the float from the water surface 2 2 equation of motion for the floats in this study two numerical procedures were presented to solve the motion of the float and calculate the reaction force acting on the hinge point the first method is a classical method using newton s second law for motion this method derives the equation of motion considering the forces acting on the structure chao et al 2018 obtained the equation of motion for a two body articulated wave energy device with a complex geometric shape using newton s second law in this procedure however additional equations using dynamic equilibrium are required to determine the constraint force this method has the disadvantage that it is very difficult to derive an equation if the structure is slightly more complicated the second method is to use an augmented formulation this method is difficult to build on the initial process but it is possible to automate the analysis process also this method can evaluate both the motion of the float and constraint force simultaneously to do this it requires relatively more computer memory and calculation time than the classical method however increasing the number of floats is not a probelm because the absolute amount of computer memory required is small if only calculation time is considered the classical method is a bit more advantageous however as mentioned earlier considering the entire analysis process the classical method is very inefficient because new equations must be derived in each case therefore the augmented formulation method has the advantage of greatly reducing the preparation time for analysis the results calculated by both procedures were showed and verified with the reference in chapter 3 these procedures should give almost the same results because both processes are interpreting the same physical phenomena table 1 lists the typical characteristics of the two methods the detailed procedures for calculating the response and reaction force using two methods are described in the following sections 2 2 1 classical method according to newton s second law for rotation the sum of the moments acting on the hinge point is equal to the moment of inertia of the float multiplied by the angular acceleration 8 i θ m y m f k m d i f f m r a d m p t o m w e i g h t m b u o y a n t where i is the moment of inertia of the float m y is the moment acting on the float in the inverse y axis the inverse y axis direction means the same axis with the axis of rotation as shown in fig 2 several studies have calculated the moments for the center of rotation directly and substituted into eq 8 zurkinden et al 2014 flavià et al 2017 the translational forces were used to calculate the moments as the following equation 9 i θ m y r q j i k j r x r z 0 f x f z 0 j j r x f z r z f x j r x f z r z f x the relationship between the rotation angle and the translational displacement of the float can be derived as the following equations 10 u x l cos θ x h u x l θ sin θ u x l θ 2 cos θ l θ sin θ u z l sin θ z h u z l θ cos θ u z l θ 2 sin θ l θ cos θ where x h z h denote the location of the hinge point the equation of motion of the float can be obtained by substituting eqs 2 6 and 10 into eq 9 and rearranging both sides 11 i m a z z r x 2 m a x x r z 2 θ b p t o θ ρ w g a w r z z h r x l 0 t k z z τ cos θ t τ θ t τ d τ r x 0 t k x x τ sin θ t τ θ t τ d τ r z r x f f k z f d i f f z r z f f k x f d i f f x r x r z m a z z m a x x θ 2 the motion of the float is constrained by the arm with a hinge joint the external forces acting on the float are transmitted to the hinge point through the arm and the forces due to the movement of the float also act on the hinge point the constraint force acting on the float can be calculated using dynamic equilibrium the arm was assumed to be a massless rigid arm and the problem can be considered to be a simple pendulum problem fig 3 presents the dynamic equilibrium of a simple pendulum problem in fig 3 an object is connected to the hinge point with a massless rigid arm and rotates about the hinge point the applied forces acting on the system left side of fig 3 and the inertia forces right side of fig 3 should be equal the inertia forces can be divided into two components depending on the direction of body rotation normal and tangential components in particular the normal directional component is the centripetal force that makes a body follow a curved path these forces can be calculated using the angular velocity and acceleration as follows 12 f n m l θ 2 13 f t m l θ for the applied forces the notation q in fig 3 represents the external forces acting on the float as shown in eq 1 the notation r in fig 3 denotes the tension in the arm and it can be decomposed into horizontal and vertical forces r x and r z respectively these forces are from the hinge point acting on the arm according to newton s third law the forces acting on the hinge point by the arm are equal in magnitude and opposite to the direction of the tension in the arm in summary the reaction forces acting on the hinge point can be obtained as follows 14 f h x r x q x m l θ 2 cos θ θ sin θ 15 f h z r z q z m l θ 2 sin θ θ cos θ the rotation angle and angular velocity can be combined into a state vector to obtain the numerical solution as follows 16 f t θ t θ t the first time derivative of the above equation is a state space equation of the system using this equation the second order differential equation can be replaced by the first order differential equation in this study runge kutta 4th order method was applied for numerical time integration of this equation the state space equation can be expressed using the following equation 17 f t θ t θ t θ t b t d t θ t 2 e t b p t o θ t g t j t where b t r x f f k z f d i f f z r z f f k x f d i f f x d t r x r z m a z z m a x x e t l 0 t k z z τ cos θ t τ θ t τ d τ r x 0 t k x x τ sin θ t τ θ t τ d τ r z g t ρ w g a w r z z h r x j t i m a z z r x 2 m a x x r z 2 the classical method as explained so far has the drawback that the translational motion should be converted to rotational motion in order to calculate the rotation angle of the float in addition the dynamic equilibrium of the system should be considered to calculate the reaction forces acting on the hinge point in the case of a complex system the equation of motion would be much more difficult to describe 2 2 2 augmented formulation as mentioned in the previous section it is difficult to calculate the constraint forces directly when applying newton s second law the augmented formulation which is one of a multibody dynamics formulation can be used to overcome this problem using the augmented formulation the rotational motion of the float and the reaction forces acting on the hinge point can be calculated at the same time the constrained system is described using the following differential and algebraic equations 18 m u c u t λ q 19 c u t 0 where m is the mass matrix of the float c u t is the constraint equations of the system at the displacement level c u is the partial differential matrix of constraint equations λ is the lagrange multiplier vector the first and second derivatives of eq 19 define the constraint equations at the velocity and acceleration levels as follows 20 c u u c t 21 c u u q c c u u u u 2 c u t u c t t where c t is the partial derivative of the constraint equation with respect to the time q c is the vector related to the second time derivative of the constraint equation eqs 18 and 21 can be combined to form the following augmented formulation shabana 2013 22 m c u t c u 0 u λ q q c the above equations can be solved numerically to obtain the accelerations and lagrange multipliers vectors in the numerical process the solutions of eq 22 should always be satisfied with eqs 19 and 20 satisfying eqs 19 20 and 22 means that the response vectors of the float satisfy the constraint equations of the system at the displacement velocity and acceleration levels to solve these equations in the time domain two loop numerical integration procedures were proposed shabana and hussein 2009 zhang and zhang 2016 the outer loop of the two loop procedure is the iterative process of the explicit or implicit integration schemes and the inner loop is the newton raphson iterative method for solving eq 19 in this study the newmark beta explicit method was employed for the outer loop of the two loop procedure in planar motion an unconstrained object has three degrees of freedom two translational motions and a single rotational motion in the case of the hinge joint two translational motions are constrained by one arm therefore the object has one degree of freedom which is the rotational motion θ about the rotation axis in other words the motion of the float can be described using only the angle of rotation and the translational displacements x f z f are dependent on this angle in this case the rotation angle can be defined as an independent coordinate u i and the translational displacements can be defined as dependent coordinates u d the conditions for the hinge joint are that the point where the two objects are connected remains constant throughout the entire motion fig 4 presents two bodies the fixed wall and a float with an arm which are connected by a hinge joint the constraint equation for the hinge joint can be expressed as follows 23 c u t r o f r o h r h f 0 where r i j denotes the position vector from point i to point j the point o is the origin of the system coordinate and can be set to 0 0 for simplicity the r vectors can be expressed as follows 24 r o h x h z h 25 r o f x f z f 26 r h f a r f where a is the transformation matrix from the arm float coordinate system to the global coordinate system the vector r f is the position vector of the float in arm float coordinate system as follows 27 a cos θ sin θ sin θ cos θ 28 r f l 0 t substituting eqs 24 28 into eq 23 the constraint equations can be expressed as 29 c u t x f x h l cos θ z f z h l sin θ 0 the constraint jacobian matrix can be expressed as 30 c u t 1 0 0 1 l sin θ l cos θ the constraint forces acting on the float can be calculated by multiplying eq 30 by the lagrange multiplier vector the constraint forces acting on the hinge point can be obtained by changing the point of action from the float to the hinge point the translational constraint forces are the same but the moment should be changed according to the following equation 31 f h c u t λ 0 0 r h f q t t augmented formulation as explained thus far has the disadvantage that a second derivative with respect to the time of the constraint equation is required on the other hand this method has the advantages that it is easy to program and the constraint forces are calculated automatically at every time step 3 numerical results and discussion 3 1 validation of calculation methods prior to the validation the results of two procedures were compared to check whether they provided the same results fig 5 presents a hemispherical float constrained to a hinge point in the two dimensional coordinate system flavià et al 2017 the float could only rotate about the axis of rotation inverse y axis as shown in fig 2 the diameter of the float was 6 m and the water depth was 20 m the direction of the incident wave was the x axis the hydrodynamic coefficients and wave exciting forces acting on the float were calculated using wamit in the frequency domain the time domain motions of the float were described using the cummins equation the damping coefficient of the pto system b p t o of 3 52 106 n m s was applied for analysis fig 6 shows the time history of the rotation angle of the float according to the calculation method for the simulation a wave height of 2 m and wave frequency of 1 0 rad s were applied the ramp function was applied for the first 30 s to prevent sudden changes regardless of the calculation method the rotation angle was similar over the entire time range this means that the angular velocity and angular acceleration of the float are the same in both methods and the reaction forces acting on the hinge point will also be the same fig 7 shows the time history of the horizontal and vertical reaction forces acting on the hinge point as expected the results were similar in both calculation methods to verify the validity of both methods the response amplitude operator rao for the rotational motion of the float were compared with the reference flavià et al 2017 fig 8 compares the pitch rao of the float the maximum error between the calculation results and the reference was approximately 3 over the entire frequency range the trend and magnitude of the pitch rao agreed well with the reference values therefore the validity of the calculation methods used in this study was verified in addition to the above results fig 9 compares the spectrum of the horizontal and vertical reaction force magnitudes between the calculation methods the peak frequency of the reaction force spectra was the same with the peak frequency of the pitch rao this means that the reaction force acting on the hinge point increased with increasing rotational motion of the float in figs 8 and 9 the results of both methods were similar over the given frequency range this means that both procedures well analyzed the responses of the float and its effects in terms of set up efficiency for numerical analysis the classical method is very inefficient because it requires the formula derivation process every time the analysis target changes therefore building the numerical process using the augmented formulation is more efficient in terms of efficiency and applicability 3 2 dynamic results of multi buoy wec the reaction forces acting on the hinge points are influenced not only by the environmental conditions but also by the arrangement of the floats this is because the motion of the floats varies according to both the interaction between the floats and the direction of the action of the forces acting on the floats in this section the calculation results of two floats for a multi buoy hpa type wec platform were analyzed to emphasize the importance of reaction force analysis fig 10 describes a wec with two hemispherical floats the two legs of the wec were assumed to be slender elements and to be fixed thus the influence of the legs did not significantly affect the calculation results the direction of the incident wave was applied only to the x axis for analysis in two dimensional conditions floats 1 and 2 were constrained to hinge point 1 at an obtuse angle and hinge point 2 at an acute angle to the horizontal axis respectively the floats had the same structural properties but the locations and directions of the external forces were different this caused the magnitude and phase differences of the horizontal and vertical external forces between the floats the diameter of each float of 6 m and the water depth of 20 m were applied the direction of the incident wave was the x axis the damping coefficient of the pto system b p t o of 3 52 106 n m s was applied for analysis in the previous section the results were similar regardless of the calculation method therefore in this section the motion of the float and the reaction force acting on the hinge point were calculated simultaneously using the augmented formulation fig 11 compares the pitch raos between floats 1 and 2 two floats have different peak frequencies the peak frequency of float 2 was approximately 1 14 rad s and the response difference to float 1 at this frequency was approximately 25 1 the tendency of the pitch rao of float 2 was slightly different from the results of the single float case due to the interaction between float 1 and 2 the magnitude of the pitch rao of float 2 was greater than that on float 1 at frequencies higher than the peak frequency of float 1 this means that when the wec is in operation a larger wave power can be obtained when the angle between the arm and wave propagating direction is an acute angle on the other hand the rotational motion of each float can be calculated using eq 8 because the structural properties of floats 1 and 2 were identical the only value that affects the motion was the moment acting on the center of rotation fig 12 presents the inverse y axis moment acting on each hinge point for one wave period in this figure the results when a wave frequency of 1 14 rad s were shown to analyze the responses when the pitch rao of float 2 was the largest the moments were slightly nonlinear during a period and the magnitude of the range of moment at hinge point 2 was 15 2 greater than that of hinge point 1 because the angular acceleration of the float is directly proportional to the moment as shown in eq 8 it can be predicted that the angular accelerations will have the same tendency as the moments fig 13 presents the rotation angle and angular acceleration of the floats during a single wave period the angular acceleration showed slight nonlinearity similar to the tendency of the moment as expected in addition the magnitude of the range of angular acceleration at hinge point 2 was 15 5 greater than that of hinge point 1 which is similar to the ratio of the moment the magnitude ratios of the moment and the angular acceleration were different from the ratio of the pitch rao of the float this is because the angular acceleration has a little nonlinearity and the result of the time integration also has some nonlinearity fig 14 compares the spectrum of horizontal and vertical reaction force magnitudes between hinge points 1 and 2 in contrast to the trend of pitch rao the reaction forces acting on hinge point 1 were much greater than those acting on hinge point 2 this means that although the movement of the float is relatively small the force acting on the hinge point can be large in addition the magnitudes of the vertical reaction force were greater than the horizontal reaction force in both floats this is because the linear buoyancy was included in the vertical external force these horizontal and vertical reaction forces should be considered as external forces acting on the hinge point when analyzing the behavior of the wec platform the above results showed that even if the structural properties of the floats were the same the responses can be affected not only by the direction of forces but also their arrangements especially the tendency and magnitude of the reaction forces acting on the hinge points would not be easily predictable without performing the reaction force analysis in other words both the motion of the float and the reaction force acting on the hinge point must be evaluated to satisfy the structural stability of the hpa type wec platform 4 conclusions this paper presented two numerical procedures to evaluate both the dynamic responses of the float and the reaction forces acting on the hinge point for hpa type wec platform one is the classical method using newton s second law for rotation and the other is the augmented formulation which is one of multibody dynamics formulation the characteristics of the two procedures were explained in detail two procedures give almost the same results because both methods deal with the same physical phenomena an important part of the proposed procedures is the calculation of the reaction forces acting on the hinge points of the wec platform from this perspective the calculation process was explained and the results were compared in the case of the hpa type wec platform multiple floats were connected to the main structure by structural arms and hinges each numerical model for a float was modeled as a hemispherical shape and connected to the hinge point by a massless rigid arm the frequency dependent hydrodynamic characteristics and wave excitation forces acting on the floats were calculated using the three dimensional frequency domain bem solver the movement of floats was described using cummins equation in the time domain the validity of the calculation methods was verified by comparing the pitch rao of a single float with the reference paper the calculation results using both methods agreed very well with each other over the given range of frequency this means that both procedures well analyzed the responses of the float and its effects however in terms of efficiency of numerical analysis preparation stage the classical method is very inefficient because it requires much more complicated process according to the model of the platform changes therefore building the numerical process using the augmented formulation is more efficient in terms of efficiency and applicability in the case of the two floats the results of each float were different due to the direction of force and the position of the floats especially the tendency and magnitude of the reaction forces would not be easily predictable without conducting the reaction force analysis this means that it is essential to confirm the effects of float motion on the main structure when performing stability analysis of the hpa type wec platform these effects can be considered when applying the methods presented in this study in the future the structural analysis of the hpa type wec platform will be carried out considering the various environmental conditions such as oblique waves and the flexible arm which is composed by beam elements author contribution section mr heo and prof koo developed the numerical procedures and carried out all numerical calculations and wrote the manuscript declaration of competing interest the authors declare that there is no conflict of interests regarding the publication of this paper acknowledgements this work was supported by inha university research grant 
