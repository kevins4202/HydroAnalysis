index,text
21255,the purpose of this paper is to give a new explanation for the wave dissipating mechanism of a heaving plate breakwater from the perspective of vortex kinematics a high order finite difference method the constrained interpolation profile cip based model is used to numerically investigate the wave dissipating performance of a submerged heaving plate breakwater in which the tangent of hyperbola for interface capturing slope weighting thinc sw is adopted for the free surface interface capturing and an immersed boundary method ibm is employed to treat the motion of the heaving plate two dimensional simulations of wave plate interactions are conducted and the results are assessed via comparing with numerical and experimental results available in previous literature the results of plate hydrodynamics and vortex kinematics around a heaving plate are presented in terms of the reflection transmission and dissipation coefficients wave amplitude spectrums vorticity field evolutions trailing vortices trajectories and averaged velocity fields the results of a fixed plate are also presented for comparison it is found that the heaving motion of plate changes the direction of the downstream jet flow and trailing vortex shedding trajectories which strongly enhances the wave dissipating performance of a heaving plate the effects of the relative plate width b l b is the width of the plate and l is wave length on the wave dissipating performance of a heaving plate is also considered results show that a heaving plate breakwater is better for the block of medium and short waves keywords heaving plate wave dissipating vortex kinematics immersed boundary method submerged breakwater 1 introduction breakwaters are marine structures used to resist the destructive nature of waves in the port area and are essential for port protection although traditional gravity breakwater has a good ability to reduce waves it consumes plenty of materials in deep water the cost is high and the construction is difficult what is more it is not conducive to water exchange he et al 2019a floating breakwaters and permeable breakwaters can promote the water exchange inside and outside the breakwater and have less impact on the ecological environment he et al 2013 2017 but their wave dissipating performances are relatively poor among them the submerged plate breakwaters are typical permeable breakwaters recently a submerged heaving plate breakwater with good wave dissipating performance was proposed liu et al 2017 while its vortex kinematics and wave dissipation mechanism are still unclear the submerged plate breakwaters have been widely studied since heins 1950 first obtained the theoretical expression of the reflection and transmission coefficients of a semi infinite submerged horizontal plate under a finite water depth greene and heins 1953 extended the study to the case where the water depth was infinite siew and hurley 1977 used the matched asymptotic expansions to analyze the scattering of long waves by a submerged horizontal plate based on potential flow theory and gave an extension to the case of oblique incidence based on the long wave assumption patarapanich 1984b explored the maximum and zero reflection from submerged horizontal plates when the relative plate width and submergence change the results showed that for a particular submergence the reflection coefficient varies periodically with the relative plate width the eigenfunction expansion method was applied by liu and iskandarani 1991 to study the scattering of short wave groups by a submerged horizontal plate and the analytical solutions were obtained based on the linear long wave theory lo and liu 2014 derived the analytical solutions of solitary waves incident on a submerged horizontal plate numerical simulation and physical experimental studies of the wave plate interactions are slightly later than its theoretical analysis focusing on long wave problems hattori 1977 used patching method to study the hydraulic performances of a submerged plate as breakwater based on the finite element method patarapanich 1984a studied the forces and moment on a submerged plate caused by wave scattering covering a wide range of relative depth ratio and submergence depth ratio later patarapanich and cheong 1989 experimentally studied the reflection and transmission characteristics of regular and random waves from a horizontal thin plate and deduced the optimum conditions for the submerged horizontal plate the experiments performed by brossard et al 2009 showed that a submerged plate is more efficient breakwater than a step and the mechanisms responsible for the energy transfer downstream these obstacles were studied based on a desingularized boundary integral equation method dbiem and lab experiments liu et al 2009 studied the nonlinear scattering of non breaking waves by a submerged horizontal plate it was pointed out that wave energy dissipation was related primarily to the fundamental waves hayatdavoodi et al 2017 studied the solitary and conical wave scattering by a submerged horizontal plate by means of the shallow water level i green naghdi equations vortex shedding near the horizontal plate is an important cause of wave energy dissipation poupardin et al 2012 experimentally studied the velocity and vorticity fields around a submerged plate under a regular wave field by means of particle image velocimetry piv measurements and the vortex shedding was shown to be asymmetric as a continuation pinon et al 2017 numerically studied the kinematics around a submerged plate under regular wave based on the two dimensional lagrangian vortex method over all the submerged horizontal plate breakwater can reduce the wave energy transmitted to its lee side but the wave dissipating performance is limited in order to improve the wave dissipating performance of the submerged horizontal plate breakwater its composition and forms are constantly changing among them multi plates and porous plates were common practice cheong and patarapanich 1992 yu and chwang 1994 liu et al 2012 gu et al 2017 he et al 2018a which were proven to be effective methods however a movable submerged horizontal plate has seldom been considered recently a new submerged horizontal heaving plate was firstly proposed as a breakwater by liu et al 2017 unlike traditional fixed submerged plate the breakwater is connected to the seabed through a spring therefore it will have periodic response to the incident wave and the shallow water deformation and vortex shedding near a heaving plate are much stronger than those near a fixed one based on the dbiem method it was found that under certain wave condition and spring stiffness the fundamental frequency transmission coefficient could be reduced to almost zero by a heaving plate which has great potential as a breakwater compared with a fixed plate of the same configuration the wave damping efficiency is improved by more than 90 liu et al 2017 and compared with the multi plates porous plates and some other floating or permeable breakwaters with complex structure the performance of heaving plate is still satisfactory considering its low cost and simple structure the great wave dissipating performance was attributed to the neutralization of the radiated wave and transmitted wave in liu s work a linear damping was added to estimate the viscous effect however complex nonlinear problems such as shallow water effects vortex shedding and wave breaking as well as the energy dissipation cannot be accurately predicted focusing on the effect of plate submergence he et al 2018b numerically studied the wave heaving plate interactions based on a sph method with a laminar solver proving that the heaving plate has much better wave dissipating performance than a fixed plate while little attention was paid to the vortex structure and vortex evolution near the heaving plate therefore the changes of velocity and vorticity field near the plate as well as the impact on the wave dissipating performance and the redistribution of wave energy in different wave frequencies still need further study the aim of present work is to give a new explanation for the wave dissipation mechanism of a heaving plate breakwater from the perspective of vortex kinematics based on the viscous flow theory a high order finite difference method is adopted to solve the navier stokes equations in a cartesian grid system the constrained interpolation profile cip based model is applied to study the wave plate interactions a more accurate volume of fluid vof type scheme the tangent of hyperbola for interface capturing slope weighting thinc sw method is applied for free surface capturing an immersed boundary method ibm is employed to treat the motion of the plate considerable attention is paid to the reflection and transmission coefficients wave amplitude spectrums velocity and vorticity fields distribution and vortex shedding trajectories of a heaving plate compared with a fixed plate the wave dissipation mechanism of a heaving plate breakwater is demonstrated the effects of relative plate width b l on the wave dissipating performance of a heaving plate is also considered the rest of this paper is organized as follows section 2 briefly describes the cip based model model validation analysis of plate hydrodynamics vortex kinematics and effects of relative plate width are presented in section 3 finally some conclusions are given in section 4 2 mathematical formulation 2 1 governing equations the computations presented in this paper are performed by means of a constrained interpolation profile cip based model hu and kashiwagi 2004 zhao and hu 2012 the 2d diagram of the numerical wave tank is shown in fig 1 static water depth h 0 3 m a momentum source internal wave maker is adopted in this model to generate waves which can avoid the re reflection waves from the structure li et al 2018 and there are wave damping zones with the width of 8 m on both sides of the wave tank a horizontal plate with a mass m 10 kg and a unit length is placed below the water surface i 0 1 m with a width b 0 6 m and a thickness d the plate can move vertically constrained to the seabed by a spring with a stiffness of k four wave gauges g1 g4 are placed around the plate to monitor the water wave profiles the distance between g1 and g2 is 0 3 l which meets the requirements of goda and suzuki 1976 s method for separating the incident and reflected waves the wave gauge g2 is located at 1 5 l from the leading edge of the plate to avoid the influence of evanescent waves another two wave gauges g3 and g4 are with the same separation and located at 1 5 l from the trailing edge of the plate this model is built based on the incompressible and unsteady assumptions of the viscous flow theory the turbulence model is not considered here two dimensional mass conservation and navier stokes equations are used as the governing equations expressed as 1 u 0 2 u t u u 1 ρ p μ ρ 2 u f where t stands for the time u is the velocity vector ρ is the fluid density μ is the laminar dynamic viscosity p is the pressure and f is the body force this model is established under the cartesian coordinate system the free surface is captured by a volume of fluid vof type method and the multiphase flow theory is introduced to treat the gas solid and liquid phases in the grid this process is governed by 3 ϕ i t u ϕ i 0 where ϕ i i 1 2 3 is the volume function of the three phases i 1 2 3 indicate water air and solid respectively in a grid meeting ϕ 1 ϕ 2 ϕ 3 1 after ϕ i is calculated the physical property λ a single grid can be solved by the following equation 4 λ m 1 3 ϕ m λ m 2 2 motion of the plate this model uses the immersed boundary method ibm to treat fluid structure interaction problem mittal and iaccarino 2005 this method adds a virtual force source term l to the discrete n s equation to simulate the interaction between the structure and the fluid and the expression is as follows 5 u t u u 1 ρ p μ ρ 2 u f l the rigid assumed heaving plate is designed to oscillate vertically through guide rails after subjected to wave forces the plate and the seabed are connected by a spring with a stiffness coefficient of k to control its heaving response and optimize its wave dissipating performance according to newton s second law the governing equation of the plate motion is 6 m d 2 z c d t 2 l i z k z c z c 0 where m is the mass of the plate z c is the z direction coordinate of the mass center l i z is the total vertical fluid force acting on the plate k is the stiffness coefficient of the spring and z c 0 is the z direction coordinate of plate s mass center at its equilibrium state in still water the total fluid force acting on the plate is calculated as follows 7 l i l i p l i v a p δ i k n k d a a 2 μ s i k n k d a where l i p is the fluid pressure l i v is the friction force a is the surface of the plate and n k is the unit normal vector of the k th part of the surface due to the small plate thickness the friction force is relatively small and ignored in this model after obtaining the force of the total fluid force acting on the plate the vertical acceleration of the plate can be calculated and then the corresponding vertical velocity and displacement can be obtained finally the distribution of the horizontal plate volume fraction ϕ 3 at the new time step is updated after obtaining the velocity of the plate a volume fraction weighting treatment for velocity interpolation in a boundary cell is described as follows 8 u ϕ 3 u b 1 ϕ 3 u where u represents the unknown velocity which can be interpolated by volume function u is the flow velocity and u b is the local velocity of the solid body 2 3 numerical implementations this model is established on a structured orthogonal mesh and a fractional step method is applied to solve navier stokes equations the implementation of the numerical model is shown as follows and the first step is to calculate the advection term as eq 9 shows 9 u t u u 0 a cip method is employed to solve the advection term yabe et al 2001 the basic principle of cip method is an interpolation in a grid by a cubic polynomial with the value and differential on the grid node 10 u x x u δ t where x is the unknown coefficient function x is the cubic polynomial to approximate the spatial profile of u in an upwind cell the superscript denotes the intermediate time level after the advection step the second step is to solve the diffusion term by a central difference scheme 11 u u δ t μ ρ 2 u f where u is the solution of this diffusion term in the end the pressure term is solved by the projection method 12 1 ρ p n 1 1 δ t u 13 u n 1 u δ t ρ p n 1 where the superscript n 1 denotes the new time the red black successive over relaxation approach sor is applied to solve the above poisson equation saad 2003 after the total flow field updated the free surface is captured by a volume of fluid vof type method the tangent of hyperbola for interface capturing with slope weighting scheme thinc sw scheme xiao et al 2011 the motion of the plate is treated by an immersed boundary method ibm proposed by peskin 1972 more details about the flow solver can be found in zhao et al 2014 2 4 parameter definition the response of the plate to waves can be described by the oscillation amplitude of the plate a p n n 1 2 3 for each harmonic frequency which can be obtained by applying the fourier analysis to the periodic vertical displacement of the plate η p then a p n are made dimensionless by the incident wave amplitude a which is a p n a in this paper the goda two point method goda and suzuki 1976 is employed to separate the incident and reflected waves in front of the plate the reflection coefficient c r is defined by eq 14 14 c r a r a where a r and a are the amplitude of reflected and incident wave respectively the reflections of higher order waves are weak and not investigated in present study fourier analysis is applied to periodic signals recorded at wave gages g3 and g4 to obtain the amplitude of each order transmitted wave a t n where n being a positive integer stands for the number of order the a t n are the average of fourier analysis results of g3 and g4 then corresponding wave transmission coefficients are defined by eq 15 15 c t n a t n a n 1 2 from wave energy flux the transmission coefficient c t is defined by eq 16 16 c t p t p i 1 n p t n p i 1 n e t n c g n e i c g 1 n 1 2 ρ g a t n 2 c g n 1 2 ρ g a 2 c g 1 n c t n 2 c g n c g where p t p i and p t n are the energy fluxes of the transmitted incident and n th order transmitted wave respectively c g and c g n are the group velocities of incident and n th order transmitted waves respectively in the present work up to 5 th order transmitted wave components are concerned in order to evaluate the magnitude of wave energy dissipation the wave dissipation coefficient c d is introduced and can be obtained from the following energy flux conservation 17 p i p r p t p d where p i p r and p t are the energy fluxes of the incident reflected and transmitted wave respectively p d is the energy flux dissipation then define the dissipation coefficient c d p d p i which can be obtained by eq 18 18 c d 1 c r 2 c t 2 3 numerical results 3 1 plate hydrodynamics wave heaving plate interactions are carried out firstly to show the convergence of the grids the computational conditions mainly refer to the settings of liu et al 2017 the water depth h is 0 3 m plate mass m is 10 kg width b is 0 6 m thickness d is 0 01 m submergence i is 0 10 m and the spring dimensionless stiffness k is 3 685 dimensionless stiffness k k ρ g b 2 the incident regular wave height h is 0 04 m and the period t is 1 0 s the total simulation time is 25 t and the last 8 t were chosen for data analysis three non uniform grids are used in the simulation and the sizes of different grids can be seen in table 1 fig 2 shows the time history of vertical velocity and displacement of the plate for three different grids it can be seen that the results obtained using the fine and medium grid sizes are very close while there is a slight phase shift for the coarse grid and the time history of wave elevation at g1 for different grids is shown in fig 3 also the computed results of fine and medium grids are similar therefore the cell size of the medium grid is enough to achieve convenience and the medium grid will be used for the following computations fig 4 shows the variations of various hydrodynamic coefficients with dimensionless stiffness k and compared with the potential flow theory based dbiem results liu et al 2017 and the viscous flow theory based sph results he et al 2018b fig 4 a and b show the comparisons on the reflection coefficient c r and the 1 st order transmission coefficient c t 1 respectively present predicted results show a good agreement with sph results and keep the same trend with dbiem results three numerical models yield extreme points of c r and c t 1 at a similar dimensionless stiffness k meanwhile it can be seen that present model results are smaller than the dbiem results at the peaks because the viscous energy dissipation is not considered in the potential flow theory the comparisons of 2 nd order free wave coefficient c f 2 and 2 nd order lock wave coefficient c l 2 are shown in fig 4 c grue 1992 s method is employed to separate the higher order free and locked waves the 2 nd order free and locked wave coefficients are defined by c f 2 a f 2 a and c l 2 a l 2 a respectively where a f 2 and a l 2 are the amplitude of the 2 nd order free and locked waves respectively it is suggested to see grue 1992 for details of the method it can be seen that three models obtain the same trends but there are slight differences in absolute values according to brossard et al 2009 wave nonlinearity contributes to the generation of higher harmonic waves the heaving motion of the plate is also one of the sources of the higher harmonics therefore the differences in the c f 2 and c l 2 between three models may be related to the complex nonlinear phenomena such as wave breaking vortex shedding and the wave shoaling due to the plate s motion etc fig 4 d displays the 1 st order and 2 nd order dimensionless amplitudes of the plate a p n n 1 2 the present results agree very well with sph results while have small differences with dbiem results it can be considered that the resonance of plate and wave occurs when a p 1 a reaches a peak the predicted and the sph results of the resonance k are found to be smaller than that of the dbiem results also because of the effects of fluid viscosity over all the accuracy of present model in simulating the wave heaving plate interactions is confirmed fig 5 shows the variations of some hydrodynamic coefficients with dimensionless stiffness k the variations of reflection coefficient c r transmission coefficient c t and dissipation coefficient c d with dimensionless stiffness k are given in fig 5 a it can be seen that c r and c t show opposite trends which means the reflection of incident wave is an important way to block waves of the heaving plate when k is between 2 5 4 c r is above 0 69 and c t is below 0 22 when providing a wide range of the spring stiffness for the design choice it greatly reduces the energy of the transmitted wave on the lee side of the plate when k is too large or small c t is greatly increased compared with a medium stiffness so the elastic support of the system cannot be too strong or too weak for the dissipation coefficient c d it is similar to the trend of c r and opposite to the trend of the c t c d is found to have two peaks in the k between 2 5 4 and between 10 12 which respectively correspond to the minimum c t also near the maximum a p 1 a see fig 4 d and the maximum a p 2 a this implies that the heaving response of the plate to the incident wave can bring a great deal of energy dissipation fig 5 b shows the variations of transmission coefficient c t 1 st order transmission coefficient c t 1 and 2 nd order transmission coefficient c t 2 with the dimensionless stiffness k it can be seen that the trend of three coefficients is similar but the variation range is different so it can show the transmitted wave energy distribution in different frequencies there are two main sources of higher order wave components in the transmitted waves the heaving response of the plate and the nonlinear effect in the shallow water region above the plate liu et al 2017 it can be seen that when k is small most energy is distributed in the fundamental transmitted waves and the energy of the 2 nd order transmitted wave is low when k gradually increases to 2 5 4 c t 1 decreases rapidly and c t 2 gradually increases at k 3 685 c t 1 is reduced to 0 042 which greatly reduces the energy of the fundamental transmitted waves c t 2 does not reduce to close to 0 because of the heaving motion of the plate therefore part of the reduced fundamental transmitted wave is neutralized by the radiated wave generated by the plate motion and the other part is transferred to higher order waves through the plate motion when k is around 11 which is also the dimensionless stiffness corresponding to the maximum of a p 2 a see fig 4 d it can be seen that c t c t 1 and c t 2 all have sudden changes c t 2 increases c t and c t 1 decrease it can be explained that the 2 nd order oscillation of the plate generates plenty of 2 nd order waves meanwhile causing large energy transfer from the fundamental waves to 2 nd order waves when k is relatively large both c t 1 and c t 2 are large indicating that the dissipating performance of the plate is poor when the elastic support is too strong the fundamental transmitted waves cannot be significantly reduced neither can the plate suppress the generation of 2 nd order waves in order to better analyze the hydrodynamic characteristics of a heaving plate the dimensionless stiffness k 3 685 of the best wave dissipating performance is chosen for further analysis a fixed plate of the same physical parameters is also chosen for comparison the wave conditions are the same as previous convergence analysis fig 6 shows the snapshots of surface elevation for a heaving plate and a fixed plate it is obvious that compared with a fixed plate a heaving plate significantly reduced the transmitted wave height and suppress the generation of higher order waves table 2 shows the comparisons of various hydrodynamic coefficients of a heaving plate and a fixed plate compared with a fixed plate a heaving plate can reduce c t by more than 0 44 and increase c r by 0 28 meanwhile increase the energy dissipation notice that c t 1 is reduced from 0 5014 to near 0 and c t 2 is also reduced from 0 5724 to 0 3222 fig 7 shows the wave amplitude spectrums of g3 for a heaving plate and a fixed plate which is calculated by using fast fourier transform fft in matlab it can be seen that for a heaving plate the transmitted wave energy is mainly distributed in the 2 nd order waves and the energy in the fundamental waves is very small however for a fixed plate the transmitted wave energy distributed in the 1 st and 2 nd order waves is similar this implies that there is a large energy transfer from the fundamental waves to the higher order waves in the wave heaving plate interactions through the heaving motion of the plate also part of the fundamental wave energy may be neutralized by the radiated wave induced by the 1 st order oscillating of the plate 3 2 vortex kinematics in this section the trailing vortices center trajectories of a heaving plate is computed first to check the convergence of the grids the vorticity field is calculated from the curl of local velocity field i e ω u a clockwise resp anticlockwise circulation corresponds to a negative resp positive value of vorticity the computational conditions and grids are the same as section 3 1 and table 1 fig 8 shows the trailing vortices center trajectories of the plate for different grids in this paper the vortex center positions are determined by the q criterion proposed by hunt et al 1988 which is a popular vortex identification method in engineering it can be seen that the computed vortex shedding trajectories are closer for fine and medium grids but for coarse grid the trajectory has some position deviation fig 9 presents the time history of the maximum negative vorticity of the downstream negative vortices over two wave periods for different grids during the initial stage of the vortex generation the maximum magnitude of the vorticity strongly increases from t t 0 to t t 0 2 and at this stage the results calculated by coarse grid are much smaller than those of other two grids which is caused by the lack of resolution in the coarse grid when the size of the vortex is small then after t t 0 2 the maximum magnitude of the vorticity gradually decreases as the negative vortices shed away from the plate and the computed results are also closer for fine and medium grids overall both the computed location and magnitude of the vortices have converged the medium grid of δ x δ y 0 001 m is enough to resolve the vortex kinematics problem of the heaving plate vortex kinematics around a fixed plate under water waves were experimentally investigated in poupardin et al 2012 by particle image velocimetry piv technique the experiment is chosen to check the model s accuracy in simulating the vortex kinematics near the horizontal plate in the experiment water depth h was 0 2 m plate width b was 0 25 m thickness d was 0 003 m and submergence i was 0 07 m the incident regular wave height h was 0 02 m and the wave period t was 1 0 s fig 10 presents the comparisons of average velocity fields between piv measurements and numerical results it is evident that the numerical results exhibit features of the complicated flow structures and agree quite closely with the experimental observations the vortices upstream and downstream the plate is well captured by present model in the lee side the strong vertical jet plunging toward the flume bottom indicated by letter c and the jet impact location letter d are accurately reproduced and there are two important steady recirculation cells upstream and downstream of the plate letters b and a respectively in the experimental observations for the recirculation cell b there is a slight position deviation between numerical and experimental results and for the recirculation cell a its range in numerical results is slightly larger than that in experimental results which leads to the stagnation point s position letter e is not exactly the same these differences can be explained that the vortices may be destroyed through 3d instabilities in the experiments which cannot be considered in present 2d numerical configuration pinon et al 2017 fig 11 shows the comparisons of the numerical and experimental results on the vortices trajectories it can be easily observed that the predicted trajectories agree well with experimental results and the vortex kinematics around the plate was well reproduced numerically analysis of the velocity and vorticity fields will be presented then fig 12 shows the vorticity field evolution as a function of time for 8 different phases within a wave period t for a heaving plate and a fixed plate under h 0 04 m t 1 0 s b 0 6 m and i 0 10 m obviously the vorticity field distribution of the two structures and their interactions with shallow water are different for the heaving plate as shown in fig 12 left at t 0 t the heaving plate is at the highest position the wave crest has just reached the leading edge of the plate and the shallow water deformation continues to occur as the wave propagates from t 0 t to t 2 8 t the plate moves downward to the equilibrium position and the wave crest propagates to the middle of the plate the water depth above the plate is shallower than a fixed one at this time therefore the waveform shows high non linearity due to the stronger shallow water deformation when the wave crest propagates to the rear end of the plate at t 4 8 t it collides with the upward shedding vortices wave breaking and water gas mixing occur resulting in a complex turbulent field from t 4 8 t to t 7 8 t the plate continues to move upward from the lowest position the wave crest passes through the complex vortex area then propagates to the downstream side of the plate with a significantly reduced wave height during the whole period two to three pairs of vortices with opposite signs at the upstream and downstream sides of the heaving plate can be identified depending on the given phase the difference is that the vortex intensity and impact range at the downstream side is much larger than that at the upstream side a complex vortex region appears above the rear end of the plate after the negative vortex is generated it gradually sheds to the upper downstream side and decomposes while the positive vortex breaks due to the collision with the incident wave and the mutual induction with negative vortex then advects toward the upstream side and decomposes slowly this collision favors the development of higher order waves and the energy transfer from fundamental waves to higher order waves meanwhile a large amount of energy is dissipated with the gradual decomposition of the vortex brossard and chagdali 2001 he et al 2019b note that the vorticity field distribution and general form are similar to fig 6 of he et al 2018b however some details of vortex evolution process are different owing to the different resolution δ x δ y 0 001 m in present simulation δ p 0 005 m in he et al 2018b especially when the size of the vortex is small for a fixed plate as shown in fig 12 right the vortex evolution is similar to fig 6 of pinon et al 2017 two to three pairs of vortices with equal intensity can be identified on both the upstream and downstream sides of the plate the vortex at the upstream side advects upwards to the upstream side while the trailing vortex at the downstream side sheds downwards to the downstream side the trailing vortex pairs regularly hit the seabed and then separate from each other one eventually goes downstream and the other goes upstream therefore the complex vortex region above the rear end of the plate does not appear compared with a fixed plate the heaving motion of the plate inhibits the development of upstream side vortices while promotes the development of the trailing vortices at the same time it changes the direction of the trailing vortex shedding trajectories which blocks the propagation of incident wave and greatly improves the wave dissipating performance of a heaving plate fig 13 shows the comparison of the trailing vortices trajectories of the heaving plate and fixed plate obviously the trailing vortex shedding direction of a heaving plate is upward to the downstream side while that of a fixed plate is downward to the downstream side the difference of vortex shedding trajectories makes the different distribution of the velocity field and significantly affects the wave dissipating performance of a submerged plate fig 14 depicts the averaged velocity fields over 100 instantaneous velocity fields representing 5 wave periods t for a heaving plate and a fixed plate for the heaving plate two recirculation cells can be identified at the downstream side of the plate which generate strong velocities the recirculation cells are directly associated with a strong vertical jet plunging toward the free surface which is caused by the heaving motion of the plate and they correspond to the vortex region above the rear end of the plate in fig 12 left for the fixed plate two recirculation cells persist at upstream and downstream of the plate a jet flow can also be observed downstream the plate the difference is that the direction of the jet flow is toward the flume bottom therefore the recirculation cells is also below the fixed plate the downward vortices create a shear flow at this bottom location of the wave flume which leads to the generation of vorticity it can be found that the heaving motion of the plate changes the direction of the downstream jet flow and makes the recirculation cells move from below the plate to above the plate so that the surface wave cannot propagate through the plate smoothly overall by comparing the vorticity field evolution processes trailing vortex shedding trajectories and average velocity fields of a heaving plate and a fixed plate it can be found that the heaving motion of the plate changes the direction of the downstream jet flow and trailing vortex shedding trajectories forming a complex vortex region and recirculation cell above the rear end of the plate since most of the wave energy is distributed on the surface of water compared with the downward vortex shedding trajectory of a fixed plate and the recirculation cell below the plate a heaving plate promotes the development of the trailing vortex and brings stronger wave vortex interactions in shallow water this blocks the propagation of surface wave energy and at the same time brings a large amount of energy dissipation and energy transfer from fundamental mode to higher order waves which significantly improves the wave dissipating performance of a heaving plate 3 3 effects of relative plate width this section considers the effects of relative plate width b l on the wave dissipating performance of a heaving plate and gives explanations from the perspective of the vortex kinematics viscous flow calculations covering relatively wide ranges of incident wave period are made and the details of physical parameters are listed in table 3 fig 15 shows the variations of reflection coefficient c r transmission coefficient c t dissipation coefficient c d 1 st order transmission coefficient c t 1 and 2 nd order transmission coefficient c t 2 with the relative plate width b l from fig 15 a it can be seen that when b l is less than 0 4 c r increases with b l and c t decreases with b l and the trend reverses when b l is larger than 0 4 c d does not change much with b l the largest c r and the smallest c t correspond to the same b l 0 4 also it can be seen that for a long wave b l 0 18 c t is larger than 0 6 c r 0 3 which means the wave dissipating performance for long waves is significantly worse than medium waves b l 0 4 for a short wave b l 0 70 the corresponding c t 0 37 which is larger than that of a medium wave but much less than that of a long wave meanwhile the c r is larger than 0 6 showing that a heaving plate has a good reflection for incident short waves as shown in fig 15 b c t and c t 1 shows reverse trends with c t 2 it implies that for medium waves the heaving plate can transfer plenty of fundamental waves to higher order waves but for long waves and short waves the energy transfer is much less this can be partly explained by the difference of wave nonlinearity for one thing the relative plate width b l affects the relative phase of the radiated and transmitted waves which in turn affects the amplitude of the transmitted wave after superposition for another changes of wave steepness bring different levels of shallow water deformation resulting in the complex flow field and vorticity field changes the evolution of the vorticity fields of a long wave and a short wave will be analyzed then and the difference in wave dissipating performance will be explained accordingly fig 16 shows the vorticity field evolution as a function of time for 4 different phases within a wave period t for a long wave configuration b l 0 18 and a short wave configuration b l 0 70 at t 0 t the heaving plates are at the highest position for both configurations from fig 16 left it can be seen that for the long wave heaving plate interaction two to three pairs of vortices at the upstream and downstream sides of the plate can be identified compared with a medium wave fig 12 left both the vortices at the upstream and downstream sides shed downwards to the flume bottom which is similar to the phenomenon of a fixed plate therefore there is no complex vortex region above the plate which cannot bring strong wave vortex interactions and cannot block the propagation of surface wave energy so the wave dissipating performance is poor for the short wave heaving plate interaction as shown in fig 16 right although the trailing vortex shedding direction is still toward the free surface both the positive and negative vortices shed smoothly to the downstream of the plate there will be no positive vortex breaking and strong mutual induction between positive and negative vortices like fig 12 left therefore the interactions between the incident wave and vortex are weak and the energy dissipation is relatively small this explains why the wave dissipating performance of a heaving plate on the short wave is worse than the medium wave but much better than the long wave over all the heaving plate breakwater is better for the block of medium and short waves but poor for long waves 4 concluding remarks in this paper a cip based model is used to numerically investigate the wave dissipating performance of a submerged heaving plate breakwater the model validation is performed by comparisons with previous numerical and experimental results in the literature the computed reflection coefficient fundamental transmission coefficient and higher order free and lock wave coefficients are compared with dbiem and sph results and the computed vortices trajectories of a fixed plate are compared with experimental results the comparisons indicate that the employed model is capable of predicting the wave heaving plate interactions and the vortex kinematics around the heaving plate with an acceptable accuracy the conclusions are summarized as follows 1 the plate hydrodynamics are investigated by comparing the surface elevations reflection and transmission coefficients and wave amplitude spectrums of a heaving plate and a fixed plate results show that a heaving plate can significantly reduce the fundamental wave transmission and enhance wave reflection the wave amplitude spectrum results indicate that there is a huge energy transfer from fundamental mode to higher order waves through the heaving motion of the plate 2 vortex kinematics around the plate are simulated numerically comparisons of the vorticity field evolution processes trailing vortex shedding trajectories and average velocity fields of a heaving plate and a fixed plate are presented it is concluded that the change of downstream jet flow and trailing vortex shedding direction strongly contributes to the wave dissipating performance of a heaving plate breakwater this change forms a complex vortex region and recirculation cell above the rear end of the plate which blocks the propagation of surface wave energy and brings a great deal of energy dissipation therefore the heaving plate has much better wave dissipating performance than a fixed plate which shows great potential as a breakwater 3 the effects of relative plate width b l on the wave dissipating performance of a heaving plate are investigated it is found that the heaving plate breakwater is better for the block of medium and short waves but poor for long waves a too long wave cannot change the vortex shedding direction therefore cannot form the complex vortex region above the plate and block the surface wave propagation a too short wave case shows no vortex breaking which weakens the wave vortex interactions in terms of the considered cases in this paper a relative plate width b l 0 40 is proven to be the optimum choice as pointed out in chang et al 2005 zarruk et al 2015 and pinon et al 2017 due to the three dimensional nature of the vortices and turbulent flow those three dimensional vortex characteristics and deformations cannot be precisely predicted in present two dimensional simulations therefore in the future laboratory experiment and three dimensional numerical study on the wave dissipating performance of a submerged heaving plate breakwater are planned to be carried out credit authorship contribution statement ding fu conceptualization methodology software writing original draft xizeng zhao supervision su wang model validation dongming yan writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was partially supported by the national natural science foundation of china grant nos 51979245 51679212 and tang scholar the authors greatly appreciate the reviewers whose constructive comments greatly improve the quality and scientific rigor of this work 
21255,the purpose of this paper is to give a new explanation for the wave dissipating mechanism of a heaving plate breakwater from the perspective of vortex kinematics a high order finite difference method the constrained interpolation profile cip based model is used to numerically investigate the wave dissipating performance of a submerged heaving plate breakwater in which the tangent of hyperbola for interface capturing slope weighting thinc sw is adopted for the free surface interface capturing and an immersed boundary method ibm is employed to treat the motion of the heaving plate two dimensional simulations of wave plate interactions are conducted and the results are assessed via comparing with numerical and experimental results available in previous literature the results of plate hydrodynamics and vortex kinematics around a heaving plate are presented in terms of the reflection transmission and dissipation coefficients wave amplitude spectrums vorticity field evolutions trailing vortices trajectories and averaged velocity fields the results of a fixed plate are also presented for comparison it is found that the heaving motion of plate changes the direction of the downstream jet flow and trailing vortex shedding trajectories which strongly enhances the wave dissipating performance of a heaving plate the effects of the relative plate width b l b is the width of the plate and l is wave length on the wave dissipating performance of a heaving plate is also considered results show that a heaving plate breakwater is better for the block of medium and short waves keywords heaving plate wave dissipating vortex kinematics immersed boundary method submerged breakwater 1 introduction breakwaters are marine structures used to resist the destructive nature of waves in the port area and are essential for port protection although traditional gravity breakwater has a good ability to reduce waves it consumes plenty of materials in deep water the cost is high and the construction is difficult what is more it is not conducive to water exchange he et al 2019a floating breakwaters and permeable breakwaters can promote the water exchange inside and outside the breakwater and have less impact on the ecological environment he et al 2013 2017 but their wave dissipating performances are relatively poor among them the submerged plate breakwaters are typical permeable breakwaters recently a submerged heaving plate breakwater with good wave dissipating performance was proposed liu et al 2017 while its vortex kinematics and wave dissipation mechanism are still unclear the submerged plate breakwaters have been widely studied since heins 1950 first obtained the theoretical expression of the reflection and transmission coefficients of a semi infinite submerged horizontal plate under a finite water depth greene and heins 1953 extended the study to the case where the water depth was infinite siew and hurley 1977 used the matched asymptotic expansions to analyze the scattering of long waves by a submerged horizontal plate based on potential flow theory and gave an extension to the case of oblique incidence based on the long wave assumption patarapanich 1984b explored the maximum and zero reflection from submerged horizontal plates when the relative plate width and submergence change the results showed that for a particular submergence the reflection coefficient varies periodically with the relative plate width the eigenfunction expansion method was applied by liu and iskandarani 1991 to study the scattering of short wave groups by a submerged horizontal plate and the analytical solutions were obtained based on the linear long wave theory lo and liu 2014 derived the analytical solutions of solitary waves incident on a submerged horizontal plate numerical simulation and physical experimental studies of the wave plate interactions are slightly later than its theoretical analysis focusing on long wave problems hattori 1977 used patching method to study the hydraulic performances of a submerged plate as breakwater based on the finite element method patarapanich 1984a studied the forces and moment on a submerged plate caused by wave scattering covering a wide range of relative depth ratio and submergence depth ratio later patarapanich and cheong 1989 experimentally studied the reflection and transmission characteristics of regular and random waves from a horizontal thin plate and deduced the optimum conditions for the submerged horizontal plate the experiments performed by brossard et al 2009 showed that a submerged plate is more efficient breakwater than a step and the mechanisms responsible for the energy transfer downstream these obstacles were studied based on a desingularized boundary integral equation method dbiem and lab experiments liu et al 2009 studied the nonlinear scattering of non breaking waves by a submerged horizontal plate it was pointed out that wave energy dissipation was related primarily to the fundamental waves hayatdavoodi et al 2017 studied the solitary and conical wave scattering by a submerged horizontal plate by means of the shallow water level i green naghdi equations vortex shedding near the horizontal plate is an important cause of wave energy dissipation poupardin et al 2012 experimentally studied the velocity and vorticity fields around a submerged plate under a regular wave field by means of particle image velocimetry piv measurements and the vortex shedding was shown to be asymmetric as a continuation pinon et al 2017 numerically studied the kinematics around a submerged plate under regular wave based on the two dimensional lagrangian vortex method over all the submerged horizontal plate breakwater can reduce the wave energy transmitted to its lee side but the wave dissipating performance is limited in order to improve the wave dissipating performance of the submerged horizontal plate breakwater its composition and forms are constantly changing among them multi plates and porous plates were common practice cheong and patarapanich 1992 yu and chwang 1994 liu et al 2012 gu et al 2017 he et al 2018a which were proven to be effective methods however a movable submerged horizontal plate has seldom been considered recently a new submerged horizontal heaving plate was firstly proposed as a breakwater by liu et al 2017 unlike traditional fixed submerged plate the breakwater is connected to the seabed through a spring therefore it will have periodic response to the incident wave and the shallow water deformation and vortex shedding near a heaving plate are much stronger than those near a fixed one based on the dbiem method it was found that under certain wave condition and spring stiffness the fundamental frequency transmission coefficient could be reduced to almost zero by a heaving plate which has great potential as a breakwater compared with a fixed plate of the same configuration the wave damping efficiency is improved by more than 90 liu et al 2017 and compared with the multi plates porous plates and some other floating or permeable breakwaters with complex structure the performance of heaving plate is still satisfactory considering its low cost and simple structure the great wave dissipating performance was attributed to the neutralization of the radiated wave and transmitted wave in liu s work a linear damping was added to estimate the viscous effect however complex nonlinear problems such as shallow water effects vortex shedding and wave breaking as well as the energy dissipation cannot be accurately predicted focusing on the effect of plate submergence he et al 2018b numerically studied the wave heaving plate interactions based on a sph method with a laminar solver proving that the heaving plate has much better wave dissipating performance than a fixed plate while little attention was paid to the vortex structure and vortex evolution near the heaving plate therefore the changes of velocity and vorticity field near the plate as well as the impact on the wave dissipating performance and the redistribution of wave energy in different wave frequencies still need further study the aim of present work is to give a new explanation for the wave dissipation mechanism of a heaving plate breakwater from the perspective of vortex kinematics based on the viscous flow theory a high order finite difference method is adopted to solve the navier stokes equations in a cartesian grid system the constrained interpolation profile cip based model is applied to study the wave plate interactions a more accurate volume of fluid vof type scheme the tangent of hyperbola for interface capturing slope weighting thinc sw method is applied for free surface capturing an immersed boundary method ibm is employed to treat the motion of the plate considerable attention is paid to the reflection and transmission coefficients wave amplitude spectrums velocity and vorticity fields distribution and vortex shedding trajectories of a heaving plate compared with a fixed plate the wave dissipation mechanism of a heaving plate breakwater is demonstrated the effects of relative plate width b l on the wave dissipating performance of a heaving plate is also considered the rest of this paper is organized as follows section 2 briefly describes the cip based model model validation analysis of plate hydrodynamics vortex kinematics and effects of relative plate width are presented in section 3 finally some conclusions are given in section 4 2 mathematical formulation 2 1 governing equations the computations presented in this paper are performed by means of a constrained interpolation profile cip based model hu and kashiwagi 2004 zhao and hu 2012 the 2d diagram of the numerical wave tank is shown in fig 1 static water depth h 0 3 m a momentum source internal wave maker is adopted in this model to generate waves which can avoid the re reflection waves from the structure li et al 2018 and there are wave damping zones with the width of 8 m on both sides of the wave tank a horizontal plate with a mass m 10 kg and a unit length is placed below the water surface i 0 1 m with a width b 0 6 m and a thickness d the plate can move vertically constrained to the seabed by a spring with a stiffness of k four wave gauges g1 g4 are placed around the plate to monitor the water wave profiles the distance between g1 and g2 is 0 3 l which meets the requirements of goda and suzuki 1976 s method for separating the incident and reflected waves the wave gauge g2 is located at 1 5 l from the leading edge of the plate to avoid the influence of evanescent waves another two wave gauges g3 and g4 are with the same separation and located at 1 5 l from the trailing edge of the plate this model is built based on the incompressible and unsteady assumptions of the viscous flow theory the turbulence model is not considered here two dimensional mass conservation and navier stokes equations are used as the governing equations expressed as 1 u 0 2 u t u u 1 ρ p μ ρ 2 u f where t stands for the time u is the velocity vector ρ is the fluid density μ is the laminar dynamic viscosity p is the pressure and f is the body force this model is established under the cartesian coordinate system the free surface is captured by a volume of fluid vof type method and the multiphase flow theory is introduced to treat the gas solid and liquid phases in the grid this process is governed by 3 ϕ i t u ϕ i 0 where ϕ i i 1 2 3 is the volume function of the three phases i 1 2 3 indicate water air and solid respectively in a grid meeting ϕ 1 ϕ 2 ϕ 3 1 after ϕ i is calculated the physical property λ a single grid can be solved by the following equation 4 λ m 1 3 ϕ m λ m 2 2 motion of the plate this model uses the immersed boundary method ibm to treat fluid structure interaction problem mittal and iaccarino 2005 this method adds a virtual force source term l to the discrete n s equation to simulate the interaction between the structure and the fluid and the expression is as follows 5 u t u u 1 ρ p μ ρ 2 u f l the rigid assumed heaving plate is designed to oscillate vertically through guide rails after subjected to wave forces the plate and the seabed are connected by a spring with a stiffness coefficient of k to control its heaving response and optimize its wave dissipating performance according to newton s second law the governing equation of the plate motion is 6 m d 2 z c d t 2 l i z k z c z c 0 where m is the mass of the plate z c is the z direction coordinate of the mass center l i z is the total vertical fluid force acting on the plate k is the stiffness coefficient of the spring and z c 0 is the z direction coordinate of plate s mass center at its equilibrium state in still water the total fluid force acting on the plate is calculated as follows 7 l i l i p l i v a p δ i k n k d a a 2 μ s i k n k d a where l i p is the fluid pressure l i v is the friction force a is the surface of the plate and n k is the unit normal vector of the k th part of the surface due to the small plate thickness the friction force is relatively small and ignored in this model after obtaining the force of the total fluid force acting on the plate the vertical acceleration of the plate can be calculated and then the corresponding vertical velocity and displacement can be obtained finally the distribution of the horizontal plate volume fraction ϕ 3 at the new time step is updated after obtaining the velocity of the plate a volume fraction weighting treatment for velocity interpolation in a boundary cell is described as follows 8 u ϕ 3 u b 1 ϕ 3 u where u represents the unknown velocity which can be interpolated by volume function u is the flow velocity and u b is the local velocity of the solid body 2 3 numerical implementations this model is established on a structured orthogonal mesh and a fractional step method is applied to solve navier stokes equations the implementation of the numerical model is shown as follows and the first step is to calculate the advection term as eq 9 shows 9 u t u u 0 a cip method is employed to solve the advection term yabe et al 2001 the basic principle of cip method is an interpolation in a grid by a cubic polynomial with the value and differential on the grid node 10 u x x u δ t where x is the unknown coefficient function x is the cubic polynomial to approximate the spatial profile of u in an upwind cell the superscript denotes the intermediate time level after the advection step the second step is to solve the diffusion term by a central difference scheme 11 u u δ t μ ρ 2 u f where u is the solution of this diffusion term in the end the pressure term is solved by the projection method 12 1 ρ p n 1 1 δ t u 13 u n 1 u δ t ρ p n 1 where the superscript n 1 denotes the new time the red black successive over relaxation approach sor is applied to solve the above poisson equation saad 2003 after the total flow field updated the free surface is captured by a volume of fluid vof type method the tangent of hyperbola for interface capturing with slope weighting scheme thinc sw scheme xiao et al 2011 the motion of the plate is treated by an immersed boundary method ibm proposed by peskin 1972 more details about the flow solver can be found in zhao et al 2014 2 4 parameter definition the response of the plate to waves can be described by the oscillation amplitude of the plate a p n n 1 2 3 for each harmonic frequency which can be obtained by applying the fourier analysis to the periodic vertical displacement of the plate η p then a p n are made dimensionless by the incident wave amplitude a which is a p n a in this paper the goda two point method goda and suzuki 1976 is employed to separate the incident and reflected waves in front of the plate the reflection coefficient c r is defined by eq 14 14 c r a r a where a r and a are the amplitude of reflected and incident wave respectively the reflections of higher order waves are weak and not investigated in present study fourier analysis is applied to periodic signals recorded at wave gages g3 and g4 to obtain the amplitude of each order transmitted wave a t n where n being a positive integer stands for the number of order the a t n are the average of fourier analysis results of g3 and g4 then corresponding wave transmission coefficients are defined by eq 15 15 c t n a t n a n 1 2 from wave energy flux the transmission coefficient c t is defined by eq 16 16 c t p t p i 1 n p t n p i 1 n e t n c g n e i c g 1 n 1 2 ρ g a t n 2 c g n 1 2 ρ g a 2 c g 1 n c t n 2 c g n c g where p t p i and p t n are the energy fluxes of the transmitted incident and n th order transmitted wave respectively c g and c g n are the group velocities of incident and n th order transmitted waves respectively in the present work up to 5 th order transmitted wave components are concerned in order to evaluate the magnitude of wave energy dissipation the wave dissipation coefficient c d is introduced and can be obtained from the following energy flux conservation 17 p i p r p t p d where p i p r and p t are the energy fluxes of the incident reflected and transmitted wave respectively p d is the energy flux dissipation then define the dissipation coefficient c d p d p i which can be obtained by eq 18 18 c d 1 c r 2 c t 2 3 numerical results 3 1 plate hydrodynamics wave heaving plate interactions are carried out firstly to show the convergence of the grids the computational conditions mainly refer to the settings of liu et al 2017 the water depth h is 0 3 m plate mass m is 10 kg width b is 0 6 m thickness d is 0 01 m submergence i is 0 10 m and the spring dimensionless stiffness k is 3 685 dimensionless stiffness k k ρ g b 2 the incident regular wave height h is 0 04 m and the period t is 1 0 s the total simulation time is 25 t and the last 8 t were chosen for data analysis three non uniform grids are used in the simulation and the sizes of different grids can be seen in table 1 fig 2 shows the time history of vertical velocity and displacement of the plate for three different grids it can be seen that the results obtained using the fine and medium grid sizes are very close while there is a slight phase shift for the coarse grid and the time history of wave elevation at g1 for different grids is shown in fig 3 also the computed results of fine and medium grids are similar therefore the cell size of the medium grid is enough to achieve convenience and the medium grid will be used for the following computations fig 4 shows the variations of various hydrodynamic coefficients with dimensionless stiffness k and compared with the potential flow theory based dbiem results liu et al 2017 and the viscous flow theory based sph results he et al 2018b fig 4 a and b show the comparisons on the reflection coefficient c r and the 1 st order transmission coefficient c t 1 respectively present predicted results show a good agreement with sph results and keep the same trend with dbiem results three numerical models yield extreme points of c r and c t 1 at a similar dimensionless stiffness k meanwhile it can be seen that present model results are smaller than the dbiem results at the peaks because the viscous energy dissipation is not considered in the potential flow theory the comparisons of 2 nd order free wave coefficient c f 2 and 2 nd order lock wave coefficient c l 2 are shown in fig 4 c grue 1992 s method is employed to separate the higher order free and locked waves the 2 nd order free and locked wave coefficients are defined by c f 2 a f 2 a and c l 2 a l 2 a respectively where a f 2 and a l 2 are the amplitude of the 2 nd order free and locked waves respectively it is suggested to see grue 1992 for details of the method it can be seen that three models obtain the same trends but there are slight differences in absolute values according to brossard et al 2009 wave nonlinearity contributes to the generation of higher harmonic waves the heaving motion of the plate is also one of the sources of the higher harmonics therefore the differences in the c f 2 and c l 2 between three models may be related to the complex nonlinear phenomena such as wave breaking vortex shedding and the wave shoaling due to the plate s motion etc fig 4 d displays the 1 st order and 2 nd order dimensionless amplitudes of the plate a p n n 1 2 the present results agree very well with sph results while have small differences with dbiem results it can be considered that the resonance of plate and wave occurs when a p 1 a reaches a peak the predicted and the sph results of the resonance k are found to be smaller than that of the dbiem results also because of the effects of fluid viscosity over all the accuracy of present model in simulating the wave heaving plate interactions is confirmed fig 5 shows the variations of some hydrodynamic coefficients with dimensionless stiffness k the variations of reflection coefficient c r transmission coefficient c t and dissipation coefficient c d with dimensionless stiffness k are given in fig 5 a it can be seen that c r and c t show opposite trends which means the reflection of incident wave is an important way to block waves of the heaving plate when k is between 2 5 4 c r is above 0 69 and c t is below 0 22 when providing a wide range of the spring stiffness for the design choice it greatly reduces the energy of the transmitted wave on the lee side of the plate when k is too large or small c t is greatly increased compared with a medium stiffness so the elastic support of the system cannot be too strong or too weak for the dissipation coefficient c d it is similar to the trend of c r and opposite to the trend of the c t c d is found to have two peaks in the k between 2 5 4 and between 10 12 which respectively correspond to the minimum c t also near the maximum a p 1 a see fig 4 d and the maximum a p 2 a this implies that the heaving response of the plate to the incident wave can bring a great deal of energy dissipation fig 5 b shows the variations of transmission coefficient c t 1 st order transmission coefficient c t 1 and 2 nd order transmission coefficient c t 2 with the dimensionless stiffness k it can be seen that the trend of three coefficients is similar but the variation range is different so it can show the transmitted wave energy distribution in different frequencies there are two main sources of higher order wave components in the transmitted waves the heaving response of the plate and the nonlinear effect in the shallow water region above the plate liu et al 2017 it can be seen that when k is small most energy is distributed in the fundamental transmitted waves and the energy of the 2 nd order transmitted wave is low when k gradually increases to 2 5 4 c t 1 decreases rapidly and c t 2 gradually increases at k 3 685 c t 1 is reduced to 0 042 which greatly reduces the energy of the fundamental transmitted waves c t 2 does not reduce to close to 0 because of the heaving motion of the plate therefore part of the reduced fundamental transmitted wave is neutralized by the radiated wave generated by the plate motion and the other part is transferred to higher order waves through the plate motion when k is around 11 which is also the dimensionless stiffness corresponding to the maximum of a p 2 a see fig 4 d it can be seen that c t c t 1 and c t 2 all have sudden changes c t 2 increases c t and c t 1 decrease it can be explained that the 2 nd order oscillation of the plate generates plenty of 2 nd order waves meanwhile causing large energy transfer from the fundamental waves to 2 nd order waves when k is relatively large both c t 1 and c t 2 are large indicating that the dissipating performance of the plate is poor when the elastic support is too strong the fundamental transmitted waves cannot be significantly reduced neither can the plate suppress the generation of 2 nd order waves in order to better analyze the hydrodynamic characteristics of a heaving plate the dimensionless stiffness k 3 685 of the best wave dissipating performance is chosen for further analysis a fixed plate of the same physical parameters is also chosen for comparison the wave conditions are the same as previous convergence analysis fig 6 shows the snapshots of surface elevation for a heaving plate and a fixed plate it is obvious that compared with a fixed plate a heaving plate significantly reduced the transmitted wave height and suppress the generation of higher order waves table 2 shows the comparisons of various hydrodynamic coefficients of a heaving plate and a fixed plate compared with a fixed plate a heaving plate can reduce c t by more than 0 44 and increase c r by 0 28 meanwhile increase the energy dissipation notice that c t 1 is reduced from 0 5014 to near 0 and c t 2 is also reduced from 0 5724 to 0 3222 fig 7 shows the wave amplitude spectrums of g3 for a heaving plate and a fixed plate which is calculated by using fast fourier transform fft in matlab it can be seen that for a heaving plate the transmitted wave energy is mainly distributed in the 2 nd order waves and the energy in the fundamental waves is very small however for a fixed plate the transmitted wave energy distributed in the 1 st and 2 nd order waves is similar this implies that there is a large energy transfer from the fundamental waves to the higher order waves in the wave heaving plate interactions through the heaving motion of the plate also part of the fundamental wave energy may be neutralized by the radiated wave induced by the 1 st order oscillating of the plate 3 2 vortex kinematics in this section the trailing vortices center trajectories of a heaving plate is computed first to check the convergence of the grids the vorticity field is calculated from the curl of local velocity field i e ω u a clockwise resp anticlockwise circulation corresponds to a negative resp positive value of vorticity the computational conditions and grids are the same as section 3 1 and table 1 fig 8 shows the trailing vortices center trajectories of the plate for different grids in this paper the vortex center positions are determined by the q criterion proposed by hunt et al 1988 which is a popular vortex identification method in engineering it can be seen that the computed vortex shedding trajectories are closer for fine and medium grids but for coarse grid the trajectory has some position deviation fig 9 presents the time history of the maximum negative vorticity of the downstream negative vortices over two wave periods for different grids during the initial stage of the vortex generation the maximum magnitude of the vorticity strongly increases from t t 0 to t t 0 2 and at this stage the results calculated by coarse grid are much smaller than those of other two grids which is caused by the lack of resolution in the coarse grid when the size of the vortex is small then after t t 0 2 the maximum magnitude of the vorticity gradually decreases as the negative vortices shed away from the plate and the computed results are also closer for fine and medium grids overall both the computed location and magnitude of the vortices have converged the medium grid of δ x δ y 0 001 m is enough to resolve the vortex kinematics problem of the heaving plate vortex kinematics around a fixed plate under water waves were experimentally investigated in poupardin et al 2012 by particle image velocimetry piv technique the experiment is chosen to check the model s accuracy in simulating the vortex kinematics near the horizontal plate in the experiment water depth h was 0 2 m plate width b was 0 25 m thickness d was 0 003 m and submergence i was 0 07 m the incident regular wave height h was 0 02 m and the wave period t was 1 0 s fig 10 presents the comparisons of average velocity fields between piv measurements and numerical results it is evident that the numerical results exhibit features of the complicated flow structures and agree quite closely with the experimental observations the vortices upstream and downstream the plate is well captured by present model in the lee side the strong vertical jet plunging toward the flume bottom indicated by letter c and the jet impact location letter d are accurately reproduced and there are two important steady recirculation cells upstream and downstream of the plate letters b and a respectively in the experimental observations for the recirculation cell b there is a slight position deviation between numerical and experimental results and for the recirculation cell a its range in numerical results is slightly larger than that in experimental results which leads to the stagnation point s position letter e is not exactly the same these differences can be explained that the vortices may be destroyed through 3d instabilities in the experiments which cannot be considered in present 2d numerical configuration pinon et al 2017 fig 11 shows the comparisons of the numerical and experimental results on the vortices trajectories it can be easily observed that the predicted trajectories agree well with experimental results and the vortex kinematics around the plate was well reproduced numerically analysis of the velocity and vorticity fields will be presented then fig 12 shows the vorticity field evolution as a function of time for 8 different phases within a wave period t for a heaving plate and a fixed plate under h 0 04 m t 1 0 s b 0 6 m and i 0 10 m obviously the vorticity field distribution of the two structures and their interactions with shallow water are different for the heaving plate as shown in fig 12 left at t 0 t the heaving plate is at the highest position the wave crest has just reached the leading edge of the plate and the shallow water deformation continues to occur as the wave propagates from t 0 t to t 2 8 t the plate moves downward to the equilibrium position and the wave crest propagates to the middle of the plate the water depth above the plate is shallower than a fixed one at this time therefore the waveform shows high non linearity due to the stronger shallow water deformation when the wave crest propagates to the rear end of the plate at t 4 8 t it collides with the upward shedding vortices wave breaking and water gas mixing occur resulting in a complex turbulent field from t 4 8 t to t 7 8 t the plate continues to move upward from the lowest position the wave crest passes through the complex vortex area then propagates to the downstream side of the plate with a significantly reduced wave height during the whole period two to three pairs of vortices with opposite signs at the upstream and downstream sides of the heaving plate can be identified depending on the given phase the difference is that the vortex intensity and impact range at the downstream side is much larger than that at the upstream side a complex vortex region appears above the rear end of the plate after the negative vortex is generated it gradually sheds to the upper downstream side and decomposes while the positive vortex breaks due to the collision with the incident wave and the mutual induction with negative vortex then advects toward the upstream side and decomposes slowly this collision favors the development of higher order waves and the energy transfer from fundamental waves to higher order waves meanwhile a large amount of energy is dissipated with the gradual decomposition of the vortex brossard and chagdali 2001 he et al 2019b note that the vorticity field distribution and general form are similar to fig 6 of he et al 2018b however some details of vortex evolution process are different owing to the different resolution δ x δ y 0 001 m in present simulation δ p 0 005 m in he et al 2018b especially when the size of the vortex is small for a fixed plate as shown in fig 12 right the vortex evolution is similar to fig 6 of pinon et al 2017 two to three pairs of vortices with equal intensity can be identified on both the upstream and downstream sides of the plate the vortex at the upstream side advects upwards to the upstream side while the trailing vortex at the downstream side sheds downwards to the downstream side the trailing vortex pairs regularly hit the seabed and then separate from each other one eventually goes downstream and the other goes upstream therefore the complex vortex region above the rear end of the plate does not appear compared with a fixed plate the heaving motion of the plate inhibits the development of upstream side vortices while promotes the development of the trailing vortices at the same time it changes the direction of the trailing vortex shedding trajectories which blocks the propagation of incident wave and greatly improves the wave dissipating performance of a heaving plate fig 13 shows the comparison of the trailing vortices trajectories of the heaving plate and fixed plate obviously the trailing vortex shedding direction of a heaving plate is upward to the downstream side while that of a fixed plate is downward to the downstream side the difference of vortex shedding trajectories makes the different distribution of the velocity field and significantly affects the wave dissipating performance of a submerged plate fig 14 depicts the averaged velocity fields over 100 instantaneous velocity fields representing 5 wave periods t for a heaving plate and a fixed plate for the heaving plate two recirculation cells can be identified at the downstream side of the plate which generate strong velocities the recirculation cells are directly associated with a strong vertical jet plunging toward the free surface which is caused by the heaving motion of the plate and they correspond to the vortex region above the rear end of the plate in fig 12 left for the fixed plate two recirculation cells persist at upstream and downstream of the plate a jet flow can also be observed downstream the plate the difference is that the direction of the jet flow is toward the flume bottom therefore the recirculation cells is also below the fixed plate the downward vortices create a shear flow at this bottom location of the wave flume which leads to the generation of vorticity it can be found that the heaving motion of the plate changes the direction of the downstream jet flow and makes the recirculation cells move from below the plate to above the plate so that the surface wave cannot propagate through the plate smoothly overall by comparing the vorticity field evolution processes trailing vortex shedding trajectories and average velocity fields of a heaving plate and a fixed plate it can be found that the heaving motion of the plate changes the direction of the downstream jet flow and trailing vortex shedding trajectories forming a complex vortex region and recirculation cell above the rear end of the plate since most of the wave energy is distributed on the surface of water compared with the downward vortex shedding trajectory of a fixed plate and the recirculation cell below the plate a heaving plate promotes the development of the trailing vortex and brings stronger wave vortex interactions in shallow water this blocks the propagation of surface wave energy and at the same time brings a large amount of energy dissipation and energy transfer from fundamental mode to higher order waves which significantly improves the wave dissipating performance of a heaving plate 3 3 effects of relative plate width this section considers the effects of relative plate width b l on the wave dissipating performance of a heaving plate and gives explanations from the perspective of the vortex kinematics viscous flow calculations covering relatively wide ranges of incident wave period are made and the details of physical parameters are listed in table 3 fig 15 shows the variations of reflection coefficient c r transmission coefficient c t dissipation coefficient c d 1 st order transmission coefficient c t 1 and 2 nd order transmission coefficient c t 2 with the relative plate width b l from fig 15 a it can be seen that when b l is less than 0 4 c r increases with b l and c t decreases with b l and the trend reverses when b l is larger than 0 4 c d does not change much with b l the largest c r and the smallest c t correspond to the same b l 0 4 also it can be seen that for a long wave b l 0 18 c t is larger than 0 6 c r 0 3 which means the wave dissipating performance for long waves is significantly worse than medium waves b l 0 4 for a short wave b l 0 70 the corresponding c t 0 37 which is larger than that of a medium wave but much less than that of a long wave meanwhile the c r is larger than 0 6 showing that a heaving plate has a good reflection for incident short waves as shown in fig 15 b c t and c t 1 shows reverse trends with c t 2 it implies that for medium waves the heaving plate can transfer plenty of fundamental waves to higher order waves but for long waves and short waves the energy transfer is much less this can be partly explained by the difference of wave nonlinearity for one thing the relative plate width b l affects the relative phase of the radiated and transmitted waves which in turn affects the amplitude of the transmitted wave after superposition for another changes of wave steepness bring different levels of shallow water deformation resulting in the complex flow field and vorticity field changes the evolution of the vorticity fields of a long wave and a short wave will be analyzed then and the difference in wave dissipating performance will be explained accordingly fig 16 shows the vorticity field evolution as a function of time for 4 different phases within a wave period t for a long wave configuration b l 0 18 and a short wave configuration b l 0 70 at t 0 t the heaving plates are at the highest position for both configurations from fig 16 left it can be seen that for the long wave heaving plate interaction two to three pairs of vortices at the upstream and downstream sides of the plate can be identified compared with a medium wave fig 12 left both the vortices at the upstream and downstream sides shed downwards to the flume bottom which is similar to the phenomenon of a fixed plate therefore there is no complex vortex region above the plate which cannot bring strong wave vortex interactions and cannot block the propagation of surface wave energy so the wave dissipating performance is poor for the short wave heaving plate interaction as shown in fig 16 right although the trailing vortex shedding direction is still toward the free surface both the positive and negative vortices shed smoothly to the downstream of the plate there will be no positive vortex breaking and strong mutual induction between positive and negative vortices like fig 12 left therefore the interactions between the incident wave and vortex are weak and the energy dissipation is relatively small this explains why the wave dissipating performance of a heaving plate on the short wave is worse than the medium wave but much better than the long wave over all the heaving plate breakwater is better for the block of medium and short waves but poor for long waves 4 concluding remarks in this paper a cip based model is used to numerically investigate the wave dissipating performance of a submerged heaving plate breakwater the model validation is performed by comparisons with previous numerical and experimental results in the literature the computed reflection coefficient fundamental transmission coefficient and higher order free and lock wave coefficients are compared with dbiem and sph results and the computed vortices trajectories of a fixed plate are compared with experimental results the comparisons indicate that the employed model is capable of predicting the wave heaving plate interactions and the vortex kinematics around the heaving plate with an acceptable accuracy the conclusions are summarized as follows 1 the plate hydrodynamics are investigated by comparing the surface elevations reflection and transmission coefficients and wave amplitude spectrums of a heaving plate and a fixed plate results show that a heaving plate can significantly reduce the fundamental wave transmission and enhance wave reflection the wave amplitude spectrum results indicate that there is a huge energy transfer from fundamental mode to higher order waves through the heaving motion of the plate 2 vortex kinematics around the plate are simulated numerically comparisons of the vorticity field evolution processes trailing vortex shedding trajectories and average velocity fields of a heaving plate and a fixed plate are presented it is concluded that the change of downstream jet flow and trailing vortex shedding direction strongly contributes to the wave dissipating performance of a heaving plate breakwater this change forms a complex vortex region and recirculation cell above the rear end of the plate which blocks the propagation of surface wave energy and brings a great deal of energy dissipation therefore the heaving plate has much better wave dissipating performance than a fixed plate which shows great potential as a breakwater 3 the effects of relative plate width b l on the wave dissipating performance of a heaving plate are investigated it is found that the heaving plate breakwater is better for the block of medium and short waves but poor for long waves a too long wave cannot change the vortex shedding direction therefore cannot form the complex vortex region above the plate and block the surface wave propagation a too short wave case shows no vortex breaking which weakens the wave vortex interactions in terms of the considered cases in this paper a relative plate width b l 0 40 is proven to be the optimum choice as pointed out in chang et al 2005 zarruk et al 2015 and pinon et al 2017 due to the three dimensional nature of the vortices and turbulent flow those three dimensional vortex characteristics and deformations cannot be precisely predicted in present two dimensional simulations therefore in the future laboratory experiment and three dimensional numerical study on the wave dissipating performance of a submerged heaving plate breakwater are planned to be carried out credit authorship contribution statement ding fu conceptualization methodology software writing original draft xizeng zhao supervision su wang model validation dongming yan writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was partially supported by the national natural science foundation of china grant nos 51979245 51679212 and tang scholar the authors greatly appreciate the reviewers whose constructive comments greatly improve the quality and scientific rigor of this work 
21256,when a charge explodes in shallow water the combined effects of free surface and seabed on shockwave propagation and bubble motion are significant in this paper an underwater explosion between a deformable seabed and a free surface is numerically investigated an axisymmetric numerical model is established using the eulerian finite element method efem and the volume of fluid vof method is used in dealing with the interface the truncated computational domain boundary adopts the non reflecting boundary condition the seabed is regarded as a heavier fluid and density ratio between the seabed and water is used to describe seabed feature in this paper the present model is validated by comparing with the experiment and shows great results then the underwater explosion with different initial conditions are simulated it is found that deformable seabed has a great impact on bubble when the bubble is near the deformable seabed and the bubble period and pressure peak of shockwave have a positive relation with the density ratio and initial charge depth in addition the annular jet might appear and penetrate the upper surface of the bubble in certain condition leading to the bubble split during the contraction phase keywords underwater explosion bubble shockwave deformable seabed free surface 1 introduction underwater explosion releases huge energy in an extremely short time and it will generate high pressure shockwave and pulsating bubble in earlier researches the empirical formulas are generally used to calculate the far field shockwave pressure geers and hunter 2002 cole 1948 however these empirical formulas are not suitable for predicting the near field shockwave pressure because the disturbance of the fluid cannot be ignored ming et al 2016 efem has been used to investigate the near field pressure in underwater explosion and achieves great results in recent years liu et al 2018a 2018b for the bubbles they have a wide range of applications in various fields wang et al 2018a for example in the medical science field the bubbles could be used for ultrasonic lithotripsy chen et al 2011 liu et al 2012 wang et al 2018b in the military field the shock wave and oscillating bubble generated by underwater explosion seriously threatened the safety of warships klaseboer et al 2005a vahaji et al 2018 zhang et al 2011 in the ocean engineering field the airgun bubbles were used to explore the resource in the seabed graaf et al 2014a graaf et al 2014b zhang et al 2020 the motion features of bubble are highly different under various boundary conditions which have been widely studied for decades for example the solid wall repels the bubble in the expansion stage and attracts the bubble in the contraction stage yang et al 2013 tian et al 2020 zhang et al 2015a and totally inverse motion of the bubble is exhibited when it is near the free surface li et al 2019a koukouvinis et al 2016 he et al 2020 moreover klaseboer et al klaseboer and khoo 2004 have investigated a pulsating bubble close to a fluid fluid interface and stated the direction of liquid jet was dominated by the initial distance from the bubble to the interface the bubble dynamics near the other boundary conditions have been also fully investigated such as the bubble near the floating body tian et al 2019 the bubble near the ice cui et al 2018 the bubble between the free surface and rigid wall huang et al 2020 zhang et al 2013a cui et al 2016 the interaction between a sphere and a bubble li et al 2018a zhang et al 2018 or even the interaction between two bubbles li et al 2019b zhang et al 2016 however there is little attention being paid to studying the underwater explosion between a free surface and a deformable seabed the warship structures can be damaged by the underwater explosion load when a charge explodes in shallow water it is necessary to consider the composite effect of a free surface and soft seabed foundation on the propagation of shockwave load and the bubble motion for example a typical mine with 1000 kg tnt equivalent weight explodes underwater generating a bubble 25 m in diameter for offshore waters where the depth is less than or about 25 m the effect of the free surface and soft seabed foundation on bubble dynamics will be significant therefore the influence of shallow water is an indispensable part of the study on underwater explosion in the offshore area the bubble in the process of expansion will push the movement of soft seabed foundation leading to the formation of pits the phenomenon of a pit formation on the soft seabed due to the pulsation of the underwater explosion bubble is widely used to deal with the soft mud in port construction in the process of bubble contraction due to the influence of the buoyancy and seabed attraction the bubble will be suck into the seabed during its evolution which results in upward motion tearing into two bubbles and other motion forms in the whole bubble evolution process the strong nonlinear phenomena are shown in the previous studies of bubble dynamics near the seabed the seabed is usually regarded as the rigid wall and the effect of seabed deformation on bubble motion is not considered wang et al 2015 lind and phillips 2012 wang et al 2016 for example zhang et al 2013a conducted experiments that a bubble oscillating between the free surface and the solid wall from these experiments it is found that two bubbles were divided from the bubble under the effect of jet when the distance from the rigid wall was proper two ordinal liquid jets were also observed in the bubble contraction phase with certain distances from the free surface but in fact the seabed is nearly covered by several meters of soft mud in the real circumstance and it can deform as the underwater explosion bubble moves different from the rigid seabed the deformable seabed can absorb the bubble motion due to its soft feature compared with the tremendous pressure produced by the shock wave and bubble pulsation the compressive and shearing strength and viscosity of the silt can be ignored reasonably li 1990 therefore the seabed is regarded as a dense fluid that is insoluble with water in the process of research when the soft seabed foundation is considered the laws of the shockwave propagation and bubble motions are affected thus changing the load of underwater explosion in the flow field for bubble dynamics there have been some numerical methods to investigate it in these years e g the boundary element method bem has been applied widely since it can reduce the dimension of the problem by one li et al 2018b 2019c 2020 zhang and ni 2013 but the bem cannot be used to describe the shockwave propagation and it requires complex human intervention to simulate a torn bubble in recent years the meshless methods based on lagrangian framework such as smoothed particle hydrodynamics sph zhang et al 2013b 2015b cao et al 2019 method moving particle semi implicit mps seiichi et al 2015 khayyer and gotoh 2011 ataie ashtiani and farhadi 2006 method and the mesh methods based on eulerian framework such as finite difference method fdm dawoodian et al 2015 sankaranarayanan et al 2003 reyes et al 2019 finite volume method fvm li et al 2018c miller et al 2013 zhang et al 2020 and discontinuous galerkin dg qiu et al 2007 wu et al 2019 cockburn and shu 1998 method have been the frontier hot issues in computational fluid dynamics however the above methods have not been widely employed in continuously simulating the shockwave and bubble the present paper simulates the shockwave propagation and the bubble pulsation between a deformable seabed and a free surface with the efem this simulation can show the underwater explosion process completely and the more details of bubble motion liu et al 2018a 2019 tian et al 2020 the residual paper is arranged as below in section 2 the eulerian finite element formulas with operator split method are described briefly and the present model is validated by comparing with the bubble radius and displacement calculated from the geers hunter model in section 3 several cases with the diverse initial conditions are simulated and analyzed severally finally some significant conclusions are drawn from the present research in section 4 2 theoretical and numerical model the underwater explosion between a deformable seabed and a free surface is mainly concerned in this paper the initial charge shape is assumed to be spherical and the fluid boundaries are set as non reflecting boundary which is proposed by liu et al 2018a and it has been proved to be valid by many works liu et al 2018a 2018b tian et al 2020 an axisymmetric model is used in simulating the underwater explosion process including the shockwave propagating and the bubble pulsating the whole computational domain is divided into air water and seabed and the bubble is located in the water hence a cylindrical coordinate is built and the origin o is placed on the rotary axis the r and z axis represent respectively the radial and the axial coordinates the r represents the bubble radius the h indicates the initial depth of the charge beneath the free surface and the d denotes the initial standoff distance to the seabed the density of the air water seabed and the explosion products are represented by ρ a ρ w ρ s and ρ b as shown in fig 1 additionally taking a ρ s ρ w as the density ratio between the seabed and water 2 1 eulerian finite element formulas it is valid with the high reynolds number to neglect the fluid viscosity around the underwater explosion bubble blake and gibson 1987 wang and khoo 2004 zhang and liu 2015 due to the transient process of the underwater explosion within a few milliseconds the crucial dimensionless parameter pe p e 2 r m 2 t d t where r m is the maximum bubble radius t is the bubble period and d t is the thermal diffusivity is larger than 1 li et al 2018b han et al 2018 thus the effect of thermal conduction is neglected and the fluid can be regarded as adiabatic in this present work the flow physics is governed by a series of compressible eulerian equations liu et al 2018b including continuity equation 1 ρ t ρ v 0 the momentum conservation equation 2 ρ v t ρ v v ρ f p and conservation equation of energy 3 ρ e t ρ e v p v where ρ denotes the fluid density v represents the material velocity vector f denotes the unit mass force vector p is the pressure of the fluid is the dyadic product of the two vectors and e represents the internal energy per mass as a matter of fact it is too cumbersome to solve precisely the momentum conservation equation directly with traditional explicit finite element method owing to the advection term which is the second term on the left side of eq 2 a simple and convenient way is applied to coping with this problem which is to adopt the operator split technique to divide eq 2 into two phases at each time increment in the first step which is called the lagrangian phase the advection term is separated and the equation therefore can be solved using explicit fem it should be noted that the non uniform meshes ought to move along with the material flow and the transport is not supposed to pass through the common edges of adjacent elements then the convection term is calculated and the transformative meshes are moved back to its initial position simultaneously the value of variables at every element are computed and transported in this step which refers to eulerian phase from the lagrangian perspective the momentum equation can be written as 4 ρ d v d t ρ f p the explicit finite element method is used to solve eq 4 benson 1992a ψ is chosen as the weight function and multiplied on both sides of the equation whose weak form based on the gauss green formula can be derived as 5 ω ρ d v d t ψ d ω ω ρ f ψ d ω ω p ψ d ω ω p n ˆ ψ d l where ω and ω denote respectively the integration domain and the boundary of ω n ˆ denotes the unit normal vector pointing outward of ω the shape function ψ of the element is carried out to replace the arbitrary weight function ψ hence the semi discretized form of eq 5 can be rewritten as 6 ω ρ v ω ψ θ ψ ω d ω ω ρ ψ θ f d ω ω p ψ θ d ω ω p n ˆ ψ θ d l where the subscripts θ and ω separately represent the value of variables at nodes θ and ω of an element the v ω is the fluid acceleration vector at node and the superscript dot indicates the derivative with time eq 6 is solved to calculate the acceleration with the lumped mass matrix based on the second order central difference method the variables including the velocity and displacement at node is obtained then eq 1 and eq 3 without the advection term are solved to obtain the density and the internal energy of every cell benson 1992a they read 7 d ρ d t ρ v 0 8 d ρ e d t p ρ e v 0 in order to close the equation system the equation of state is adopted for calculating the fluid pressure in this paper the jones wilkens lee jwl equation lee et al 1968 and the tammann equation ivings et al 1998 chen and collins 1971 is respectively employed for the internal gas products of the charge and other fluids which refer to the air the water and the seabed the chemical reaction process of the underwater explosion is not considered thus the jwl equation is appropriate for describing the gas explosion products and it has been widely used in simulating the underwater explosion liu et al 2018a 2018b tian et al 2020 the jwl equation and the tammann equation can be expressed as follow 9 p jwl a 1 ω a 1 r 1 e r 1 a 1 b 1 ω a 1 r 2 e r 2 a 1 ω a 1 ρ 0 e 10 p tammann η ρ e p w ρ e where a b r 1 r 2 and ω are the material constants by collating a large number of experiment which just depend on the type of material a 1 ρ b ρ 0 represents the density ratio between the explosion products ρ b and the explosive ρ 0 η denotes the ratio of the specific heat ρ denotes the density of the fluid outside the bubble and p w represents the reference pressure the material constants and coefficients applied to this paper are presented in table 1 and table 2 the dilatational wave speed in the explosive gaseous products and other fluids can separately be written as liu et al 2018a 11 c 1 2 p jwl a e r 1 a 1 b e r 2 a 1 1 ω ρ 0 a 1 a r 1 e r 1 a 1 b r 2 e r 2 a 1 ρ 0 a 1 2 and 12 c 2 2 η ρ p tammann p w each time increment of a single step should be limited by the following equation to meet the courant number condition and l e refers to the minimal length of an element 13 d t c l e after the variables e g the value of acceleration velocity and displacement at each node of element have been updated in last phase the eulerian step will consider the convection quantities between adjacent elements by reason of the relative movement between the deformed element in lagrangian form and the fixed spatially element specifically the advected volume with the volume of fluid vof benson 1992a hirt and nichols 1981 is computed then the variables at nodes and at the center of elements are convected by the half index shift his benson 1992a 1992b and the monotone upwind schemes conservation laws muscl leer 1977 respectively at the end of the eulerian phase the new pressure will obtain from the convected material density and internal energy the flow diagram of executing the calculation is briefly shown in fig 2 2 2 model validation by comparing with experimental results after the present numerical model has been constructed it is demonstrated by comparing with the experiment implemented by zhang et al 2015c in this experiment the bubble was produced by the underwater discharge of a 6600 μf capacitor charged to 200 v the vacuum pump channeled with the water tank could enlarge the maximum bubble radius by reducing the pressure the height of the cylindrical steel tank was 1200 mm and its inner diameter was 800 mm the ambient pressure at the bubble center was 3240pa and the maximum radius of the bubble is 62 6 mm the pulsating process of the bubble was recorded as a set of photographs with a high speed camera the bubble motion would be affected by both gravity and free surface in this experiment through taking a 1 the numerical simulation is carried out where the initial bubble radius is 10 02 mm and the initial pressure of the bubble is 360800pa fig 3 shows the comparison between the numerical simulation and the experiment zhang et al 2015c the contour map denotes the density field and the black lines represent the interface of the bubble and the free surface it is clear that the interface between the experiment and the numerical simulation fits well the bubble expands rapidly and its shape is almost spherical after the electrode is discharged at t 3 33 ms it reaches the maximum radius when t 33 33 ms and the bubble pushes the free surface upward then the bubble starts contracting with a broad liquid jet appearing the upper surface of the bubble is slightly flat due to the repulsion of the free surface at t 78 66 ms the bubble center contracts faster than other parts due to the existence of the liquid jet and it shows a toroidal shape as shown in the final frame 2 3 non dimensionalization and convergence examination for purpose of making the results of research works more representative and universal all variables in the following numerical simulations are non dimensionalized by taking a set of characteristic quantities klaseboer et al 2005b liu et al 2016 scilicet the maximum bubble radius r m in an infinite liquid is taken as the length characteristic quantity it is calculated klaseboer et al 2005b with the empirical formula 14 r m 3 38 w h 10 1 3 where w is the charge weight and h is the initial depth of the charge the hydrostatic pressure at the bubble center p and the water density ρ w are taken as the characteristic quantities of the pressure and density respectively p is calculated as 15 p p a t m ρ w g h where the p atm is the atmospheric pressure based on the above basic reference scales the other variables can also be non dimensionalized by calculating as shown in table 3 the convergence of the numerical model is examined by taking the different mesh sizes and time steps as shown in fig 4 the mesh sizes in the computational domain are set as 0 005 r m 0 005 r m 0 01 r m 0 01 r m 0 02 r m 0 02 r m 0 03 r m 0 03 r m and 0 04 r m 0 04 r m respectively it can be clearly seen from the left frame in fig 4 that the bubble period convergences with the decrease of mesh size it should be noted that the improvement in accuracy is not significant when the mesh size changes form 0 01 r m 0 01 r m to 0 005 r m 0 005 r m however the numerical simulation using the mesh size 0 005 r m 0 005 r m takes approximately twenty times longer than that using the mesh size 0 01 r m 0 01 r m the time steps are taken as 0 1 l e c 0 2 l e c 0 4 l e c 0 6 l e c and 0 8 l e c in the numerical simulations in the right frame it is found that the bubble period also convergences roughly as the time increment decreases in order to accelerate the calculation and ensure the accuracy of the simulation the larger mesh size and time step are appropriate for the numerical model taking the case in section 3 1 as an example the size of the total rectangle computational domain is 8 r m 7 r m and the external computational domain boundary adopts the non reflecting boundary condition to avoid the inveracious pressure reflection liu et al 2018a in order to reduce computation time as well as ensure accuracy non uniform meshes are applied to the present model that is the size of the meshes near the bubble are 0 01 r m 0 01 r m and the others away from the bubble are 0 02 r m 0 02 r m the element number in this computational domain is approximately 260000 and it will take about 5 h to complete the entire simulation of underwater explosion with intel i7 9700 cpu and 16 gb ram 3 results and discussions 3 1 essential features of bubble dynamics in shallow water in this section the general characteristics of the explosion induced bubble dynamics between a deformable seabed and a free surface is elaborated the tnt charge weight is 3 88 10 4 for this case then taking the ratio of the density between the seabed and water a 2 0 for meeting the requirement of the shallow water the water depth is taken as 2 the depth of the charge h 1 7 and the distance from the seabed d 0 3 fig 5 shows the specific results of the simulation it is found that at t 0 006 the propagation velocity of the shockwave in the seabed is slower than in the water owing to the density difference between the seabed and the water meanwhile the pressure of the shockwave in seabed is greater than in the water the main reason is that the shockwave travels a shorter distance in the high density fluid and loses less energy when the shockwave propagates to the free surface the rarefaction wave appears as shown at t 0 016 it also can be seen at t 0 416 and t 0 993 that the lower part of the bubble expands slower than the top part because the bubble expansion needs to overcome the greater resistance for the high density fluid as the bubble volume continues to increase the free surface swells slightly and shows the mound shape subsequently the top bubble surface contracts faster than the lower surface and the shovel shaped bubble appears owing to the bjerknes force blake and gibson 1987 thus it can be found that the effect of the high density fluid on the bubble is similar to that of the solid wall on account of the inconsistent contraction velocities in different parts of the bubble the bubble necking and the fluid crimp occurs as shown at t 1 541 and t 1 766 in the late stage of the bubble collapse an annular jet induced by the bubble necking with a velocity of 64 appears which is pushed by the high pressure region with a pressure of 78 and produces a split bubble at t 1 851 the high speed jet completely penetrates the bubble then a toroidal bubble appears at t 1 886 at the lower end of the bubble near the rotary axis the ring hump arises owing to the downward fluid when the bubbles have reached its minimum volume they begin to rebound and the largest toroidal bubble pushes away the high density fluid at t 1 948 the water spike is not observed obviously during the whole evolution process because the initial bubble depth is 1 7 times the maximum bubble radius under the attraction of the high density fluid most of the bubbles sink into it as shown at t 2 021 3 2 single effect of free surface and deformable seabed before further exploring the effect of composite boundary on bubble the bubble near the single boundary needs to investigate firstly fig 6 shows the underwater explosion near the free surface compared with the case in section 3 1 the shock wave propagates outward as a complete spherical wave at t 0 008 and the bubble shape remained spherical during the bubble expansion but when it is in the collapse phase at t 1 646 a non spherical bubble is observed and the lower part of the bubble contracts faster than the upper part on account of the gravity an obvious liquid jet with a velocity of 7 is seen clearly owing to the difference of the pressure the direction of the liquid jet and the migration of bubble are upward which is highly different from that in relevant studies li et al 2019a pearson et al 2004 this phenomena can be explained by the blake criterion blake and gibson 1987 the buoyancy effect takes the advantage than the bjerknes effect when the parameter h 2 ρ w g r m p 0 442 the parameter in this case is 0 745 in additional a bubble pulsating pressure wave spreads out as shown at t 1 699 then there are many tiny split bubbles near the rotary axis and they merge to form a larger bubble during the bubble rebound phase at t 1 717 fig 7 shows the underwater explosion bubble near the deformable seabed without the free surface it can be found that the bubble evolution in its expansion is similar with the case in section 3 1 but when it comes to the bubble contraction phase there are much difference in these two cases at t 2 016 the high pressure region pushes the thin liquid jet to penetrate the bubble with the velocity of 21 the jet formation is dominated by the bjerknes force of deformable seabed thus the jet points to the seabed different from the case in section 3 1 there is no bubble split and annular impact occur in this case the liquid jet impacts on the high density fluid and the ring hump occurs owing to the flowing fluid when t 2 053 the bubble is divided into two parts and the lower part is evolved from the ring hump at t 2 190 comparing figs 6 and 7 it is found that the liquid jets induced by the free surface and the deformable seabed are in opposite directions as shown in fig 5 when the underwater explosion is between a free surface and a deformable seabed the direction of high speed jet is downward and the bubble evolutions are similar with fig 6 these phenomena indicate that the deformable seabed has dramatic effect on the bubble when the bubble is near the deformable seabed the bubble radius and vertical displacement for the above cases in this subsection are shown in fig 8 it can be seen from the left frame that the bubble near the deformable seabed has the longer period when it is compared with the case that is only with the free surface in the right frame the bubble moves upward when there is only a free surface in the case which is contrary to that of the bubble near the deformable seabed for the former case the buoyancy dominates the direction of the bubble displacement which is similar with the phenomenon in an infinite liquid liu et al 2018a however the suction of the deformable seabed on the bubble causes it to migrate downward for the latter case when the bubble reaches the minimum radius the moving speed is also maximized according to the momentum conservation law the mass of the bubble especially the additional mass of the fluid around the bubble decrease apace resulting in the rapid contraction of the bubble for the two cases 3 3 bubble dynamics with different density ratios in this subsection the influence of the different density ratios on the underwater explosion is considered carefully the numerical simulation of the bubble between the deformable seabed and the free surface with a 2 5 are shown in fig 9 compared with the previous case where the a 2 0 the following figures can show a fact that the density ratio influences little the bubble morphological changes and the water seabed interface during the bubble expansion period however when the bubble begins to collapse there still are some important differences as follow firstly the fluid crimp is more dramatic and wraps the bubble protruding surface when the annular impact appears at t 1 880 the velocity of the annular jet is 61 while the pressure in the high pressure zone is 79 then the split bubble on the rotary axis can be seen at t 1 907 but its height is significantly lower than that of the previous one in section 3 1 the larger bubble is divided into two parts at t 2 012 and the lower part is derived from the ring hump in the bubble rebound phase the small split bubbles distribute along the surface of the high density fluid at t 2 112 while they are on the rotary axis in the case where a 2 0 fig 10 shows some interesting phenomena with the high density ratio a 4 0 during the bubble contraction stage the annular jet and the split bubble on the rotary axis are not observed under this condition the high pressure zone promotes the generation of the thin liquid jet with the velocity of 48 at t 1 957 then the whole toroidal bubble moves down to the deeper position and is divided into three parts eventually therefore it can be reasonably inferred that the liquid jet velocity and the amount of the split bubbles decrease with the density ratio a increasing the main reason is that the liquid jet needs to consume more energy when it passes through the higher density fluid and the toroidal bubble is easier to split in the low density fluid the bubble radius the bubble center displacement and the shockwave pressure at 0 2 with different density ratio a are also compared in this subsection fig 11 shows that the bubble radius curves almost coincide in its expansion but separate during the bubble contraction furthermore the pulsating period of the bubble gradually grows as the density ratio a increases it can manifest that the different density ratios influence little the minimum bubble radius in the first period the second frame in fig 11 shows the bubble center displacement for the overall trend the displacement curves rise up first during the bubble expansion phase when t 1 and then fall down when the bubble contracts which can indicate the high density fluid has a strong suction force on the bubble from the enlarged block diagram it is found that there is an oscillation when the bubble reaches the minimum volume it is explained that the small bubble is pulled down quickly by the downward fluid and then rises up due to the bubble rebound however for the case where a 2 0 there are split bubbles generated by the annular jet and they partially offsets the overall downward displacement of the bubble fig 12 shows the shockwave pressure history curves with the different density ratios it can be found that all the pressure curves have went through two stages the first pressure peaks generated by the underwater explosion increase practically linearly and the propagation speed of the shockwaves reduce with the a increasing between t 0 01 and t 0 02 the main reason is that the shockwave loses less energy and the dilatational wave speed decreases in the higher density fluid according to eq 12 the tnt detonation not only spreads shockwave outwards but also transmits the rarefaction waves to the center of the charge after the rarefaction waves meet a shock wave is formed to propagate outward therefore a small undulation occurs in the pressure curve when the pressure drops for the second ones after t 0 04 when the shockwave reaches the free surface the rarefaction wave is immediately reflected and propagates to the water in the form of a spherical wave owing to the absence of the cavitation model in this numerical simulation the pressure is negative the pressure of the shock wave is rapidly attenuated in the whole process due to the dissipation of energy compared with the first pressure peak the second one is only approximately 6 of it and the difference of the second pressure peaks is not obvious 3 4 bubble dynamics with different initial depths of charge in addition to the density ratios mentioned above the initial depth also influences dramatically the bubble dynamics the bubble evolution with h 0 7 is shown in fig 13 obviously the top bubble surface expands faster owing to the free surface which shows an egg shape bubble at t 0 329 then the bubble is penetrated downward by the liquid jet with the velocity of 5 and the water spike comes to appear when the bubble sets out to collapse at t 1 191 this phenomenon that the downward jet and the water spike occur almost simultaneously have been investigated and analyzed by blake et al 1987 and chahine 1977 the reason is that the fluid is drawn to the area between the free surface and the upper bubble surface and it forms the retention point leading to the formation of a high pressure region this high pressure region pushes the jet to penetrate the bubble and makes the water air interface rise the ring hump can also be seen in this case and it will evolve into a split bubble as shown at t 1 428 and t 1 469 in addition the annular impact is not observed indicating that this phenomenon cannot occur when h is small then the center spike and the water skirt appear at t 1 878 these phenomena can be also found in the previous works li et al 2019a the evolution of the bubble located at the interface separating the water and the seabed is shown in fig 14 since the bubble is initially at the water seabed interface it has a stronger interaction between the bubble and the interface than the previous cases the pressure inside the bubble is small with the shockwave releasing in the bubble expansion phase thus the pressure gradient can be regards as being perpendicular to the bubble seabed interface liu et al 2019 thus the deformable seabed is sucked up and the fluid crimp occurs at t 0 363 compared with fig 5 the seabed rolls outward and it separates part of the bubble at t 1 163 leading to the formation of the split bubbles during the bubble expansion then the high pressure zone appears because of the excessive contraction of the bubble surface pushing the annular jet to penetrate the bubble with the velocity of 60 the annular jet in this case is strong enough to penetrate the bubble generating the split bubble at t 1 961 with the different initial depths of the bubble the bubble radius and vertical displacement are investigated as shown in fig 15 it is seen from the left figure that the period of bubble will be longer with h increasing this law concluded form these cases is consistent with the works of zhang et al 2017 they found that the period of bubble would be longer with the initial depth of bubble increasing the right frame shows that the buoyancy influences little the bubble displacement and the bubble is dominated by the bjerknes effect to move downwards in all the cases which are similar to the bubble near the solid wall subsequently it can be found that the bubble when h 2 0 has the shortest downward displacement the reason is that it is hindered by the more high density fluid and the bubble when h 0 7 has the longest downward displacement because the free surface repel the bubble in its contraction stage and there are no high density fluid to block the bubble movement fig 16 shows the shockwave pressure with the different initial depths of charge apparently since the shockwave dissipates more energy when it travels the farther distance the first pressure peaks decline with h decreasing the second pressure peaks reflected by the free surface grow as h decreases it can be found that the pressure peak is mainly determined by the propagation distance of the shock wave when other parameters are consistent 4 conclusions in this paper an underwater explosion between a deformable seabed and a free surface is simulated based on the efem and several cases with the different initial conditions are investigated numerically this approach shows the tremendous advantage in describing the nonlinear interactions between bubble and deformable seabed the non spherical bubble features in its expansion stage are obvious when the bubble is near the seabed because the lower part of the bubble needs to push away the heavier fluid during the contraction phase the liquid jet induced by the seabed is downward owing to the bjerknes effect which is similar to the phenomenon when the bubble is near the rigid boundary through investigating the single effect of deformable seabed and free surface on bubble it is found that the deformable seabed has a dramatic effect on bubble when the bubble is near the deformable seabed subsequently the period of the bubble and the shockwave pressure peak grow as the density ratio increases when the density ratio is small more tiny bubbles appear near the symmetric axis while there are only several slightly larger bubbles when the density ratio is larger as the initial charge depth increases the bubble period is longer and the interactions between the bubble and the seabed is stronger such as the bubble split and the seabed deformation in addition the annular jet induced by the bubble necking occurs only with an appropriate initial charge depth or density ratio during the bubble contraction these conclusions have some significances in engineering filed for example the deformable seabed influences dramatically bubble in the shallow water and if the bubble is near the seabed the damage to structures cannot be maximized besides the underwater explosion is also used to deal with the seabed mud and the desilting process is shown briefly in this paper credit authorship contribution statement liu yi xu programming writing original draft data processing shi ping wang conceptualization investigation formal analysis review yun long liu programming methodology review a man zhang supervision funding acquisition review declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this paper is supported by the national key r d program of china grant no 2018yfc0308900 the national natural science foundation of china no 51879052 11672082 and the national natural science foundation of heilongjiang province no yq2019e012 
21256,when a charge explodes in shallow water the combined effects of free surface and seabed on shockwave propagation and bubble motion are significant in this paper an underwater explosion between a deformable seabed and a free surface is numerically investigated an axisymmetric numerical model is established using the eulerian finite element method efem and the volume of fluid vof method is used in dealing with the interface the truncated computational domain boundary adopts the non reflecting boundary condition the seabed is regarded as a heavier fluid and density ratio between the seabed and water is used to describe seabed feature in this paper the present model is validated by comparing with the experiment and shows great results then the underwater explosion with different initial conditions are simulated it is found that deformable seabed has a great impact on bubble when the bubble is near the deformable seabed and the bubble period and pressure peak of shockwave have a positive relation with the density ratio and initial charge depth in addition the annular jet might appear and penetrate the upper surface of the bubble in certain condition leading to the bubble split during the contraction phase keywords underwater explosion bubble shockwave deformable seabed free surface 1 introduction underwater explosion releases huge energy in an extremely short time and it will generate high pressure shockwave and pulsating bubble in earlier researches the empirical formulas are generally used to calculate the far field shockwave pressure geers and hunter 2002 cole 1948 however these empirical formulas are not suitable for predicting the near field shockwave pressure because the disturbance of the fluid cannot be ignored ming et al 2016 efem has been used to investigate the near field pressure in underwater explosion and achieves great results in recent years liu et al 2018a 2018b for the bubbles they have a wide range of applications in various fields wang et al 2018a for example in the medical science field the bubbles could be used for ultrasonic lithotripsy chen et al 2011 liu et al 2012 wang et al 2018b in the military field the shock wave and oscillating bubble generated by underwater explosion seriously threatened the safety of warships klaseboer et al 2005a vahaji et al 2018 zhang et al 2011 in the ocean engineering field the airgun bubbles were used to explore the resource in the seabed graaf et al 2014a graaf et al 2014b zhang et al 2020 the motion features of bubble are highly different under various boundary conditions which have been widely studied for decades for example the solid wall repels the bubble in the expansion stage and attracts the bubble in the contraction stage yang et al 2013 tian et al 2020 zhang et al 2015a and totally inverse motion of the bubble is exhibited when it is near the free surface li et al 2019a koukouvinis et al 2016 he et al 2020 moreover klaseboer et al klaseboer and khoo 2004 have investigated a pulsating bubble close to a fluid fluid interface and stated the direction of liquid jet was dominated by the initial distance from the bubble to the interface the bubble dynamics near the other boundary conditions have been also fully investigated such as the bubble near the floating body tian et al 2019 the bubble near the ice cui et al 2018 the bubble between the free surface and rigid wall huang et al 2020 zhang et al 2013a cui et al 2016 the interaction between a sphere and a bubble li et al 2018a zhang et al 2018 or even the interaction between two bubbles li et al 2019b zhang et al 2016 however there is little attention being paid to studying the underwater explosion between a free surface and a deformable seabed the warship structures can be damaged by the underwater explosion load when a charge explodes in shallow water it is necessary to consider the composite effect of a free surface and soft seabed foundation on the propagation of shockwave load and the bubble motion for example a typical mine with 1000 kg tnt equivalent weight explodes underwater generating a bubble 25 m in diameter for offshore waters where the depth is less than or about 25 m the effect of the free surface and soft seabed foundation on bubble dynamics will be significant therefore the influence of shallow water is an indispensable part of the study on underwater explosion in the offshore area the bubble in the process of expansion will push the movement of soft seabed foundation leading to the formation of pits the phenomenon of a pit formation on the soft seabed due to the pulsation of the underwater explosion bubble is widely used to deal with the soft mud in port construction in the process of bubble contraction due to the influence of the buoyancy and seabed attraction the bubble will be suck into the seabed during its evolution which results in upward motion tearing into two bubbles and other motion forms in the whole bubble evolution process the strong nonlinear phenomena are shown in the previous studies of bubble dynamics near the seabed the seabed is usually regarded as the rigid wall and the effect of seabed deformation on bubble motion is not considered wang et al 2015 lind and phillips 2012 wang et al 2016 for example zhang et al 2013a conducted experiments that a bubble oscillating between the free surface and the solid wall from these experiments it is found that two bubbles were divided from the bubble under the effect of jet when the distance from the rigid wall was proper two ordinal liquid jets were also observed in the bubble contraction phase with certain distances from the free surface but in fact the seabed is nearly covered by several meters of soft mud in the real circumstance and it can deform as the underwater explosion bubble moves different from the rigid seabed the deformable seabed can absorb the bubble motion due to its soft feature compared with the tremendous pressure produced by the shock wave and bubble pulsation the compressive and shearing strength and viscosity of the silt can be ignored reasonably li 1990 therefore the seabed is regarded as a dense fluid that is insoluble with water in the process of research when the soft seabed foundation is considered the laws of the shockwave propagation and bubble motions are affected thus changing the load of underwater explosion in the flow field for bubble dynamics there have been some numerical methods to investigate it in these years e g the boundary element method bem has been applied widely since it can reduce the dimension of the problem by one li et al 2018b 2019c 2020 zhang and ni 2013 but the bem cannot be used to describe the shockwave propagation and it requires complex human intervention to simulate a torn bubble in recent years the meshless methods based on lagrangian framework such as smoothed particle hydrodynamics sph zhang et al 2013b 2015b cao et al 2019 method moving particle semi implicit mps seiichi et al 2015 khayyer and gotoh 2011 ataie ashtiani and farhadi 2006 method and the mesh methods based on eulerian framework such as finite difference method fdm dawoodian et al 2015 sankaranarayanan et al 2003 reyes et al 2019 finite volume method fvm li et al 2018c miller et al 2013 zhang et al 2020 and discontinuous galerkin dg qiu et al 2007 wu et al 2019 cockburn and shu 1998 method have been the frontier hot issues in computational fluid dynamics however the above methods have not been widely employed in continuously simulating the shockwave and bubble the present paper simulates the shockwave propagation and the bubble pulsation between a deformable seabed and a free surface with the efem this simulation can show the underwater explosion process completely and the more details of bubble motion liu et al 2018a 2019 tian et al 2020 the residual paper is arranged as below in section 2 the eulerian finite element formulas with operator split method are described briefly and the present model is validated by comparing with the bubble radius and displacement calculated from the geers hunter model in section 3 several cases with the diverse initial conditions are simulated and analyzed severally finally some significant conclusions are drawn from the present research in section 4 2 theoretical and numerical model the underwater explosion between a deformable seabed and a free surface is mainly concerned in this paper the initial charge shape is assumed to be spherical and the fluid boundaries are set as non reflecting boundary which is proposed by liu et al 2018a and it has been proved to be valid by many works liu et al 2018a 2018b tian et al 2020 an axisymmetric model is used in simulating the underwater explosion process including the shockwave propagating and the bubble pulsating the whole computational domain is divided into air water and seabed and the bubble is located in the water hence a cylindrical coordinate is built and the origin o is placed on the rotary axis the r and z axis represent respectively the radial and the axial coordinates the r represents the bubble radius the h indicates the initial depth of the charge beneath the free surface and the d denotes the initial standoff distance to the seabed the density of the air water seabed and the explosion products are represented by ρ a ρ w ρ s and ρ b as shown in fig 1 additionally taking a ρ s ρ w as the density ratio between the seabed and water 2 1 eulerian finite element formulas it is valid with the high reynolds number to neglect the fluid viscosity around the underwater explosion bubble blake and gibson 1987 wang and khoo 2004 zhang and liu 2015 due to the transient process of the underwater explosion within a few milliseconds the crucial dimensionless parameter pe p e 2 r m 2 t d t where r m is the maximum bubble radius t is the bubble period and d t is the thermal diffusivity is larger than 1 li et al 2018b han et al 2018 thus the effect of thermal conduction is neglected and the fluid can be regarded as adiabatic in this present work the flow physics is governed by a series of compressible eulerian equations liu et al 2018b including continuity equation 1 ρ t ρ v 0 the momentum conservation equation 2 ρ v t ρ v v ρ f p and conservation equation of energy 3 ρ e t ρ e v p v where ρ denotes the fluid density v represents the material velocity vector f denotes the unit mass force vector p is the pressure of the fluid is the dyadic product of the two vectors and e represents the internal energy per mass as a matter of fact it is too cumbersome to solve precisely the momentum conservation equation directly with traditional explicit finite element method owing to the advection term which is the second term on the left side of eq 2 a simple and convenient way is applied to coping with this problem which is to adopt the operator split technique to divide eq 2 into two phases at each time increment in the first step which is called the lagrangian phase the advection term is separated and the equation therefore can be solved using explicit fem it should be noted that the non uniform meshes ought to move along with the material flow and the transport is not supposed to pass through the common edges of adjacent elements then the convection term is calculated and the transformative meshes are moved back to its initial position simultaneously the value of variables at every element are computed and transported in this step which refers to eulerian phase from the lagrangian perspective the momentum equation can be written as 4 ρ d v d t ρ f p the explicit finite element method is used to solve eq 4 benson 1992a ψ is chosen as the weight function and multiplied on both sides of the equation whose weak form based on the gauss green formula can be derived as 5 ω ρ d v d t ψ d ω ω ρ f ψ d ω ω p ψ d ω ω p n ˆ ψ d l where ω and ω denote respectively the integration domain and the boundary of ω n ˆ denotes the unit normal vector pointing outward of ω the shape function ψ of the element is carried out to replace the arbitrary weight function ψ hence the semi discretized form of eq 5 can be rewritten as 6 ω ρ v ω ψ θ ψ ω d ω ω ρ ψ θ f d ω ω p ψ θ d ω ω p n ˆ ψ θ d l where the subscripts θ and ω separately represent the value of variables at nodes θ and ω of an element the v ω is the fluid acceleration vector at node and the superscript dot indicates the derivative with time eq 6 is solved to calculate the acceleration with the lumped mass matrix based on the second order central difference method the variables including the velocity and displacement at node is obtained then eq 1 and eq 3 without the advection term are solved to obtain the density and the internal energy of every cell benson 1992a they read 7 d ρ d t ρ v 0 8 d ρ e d t p ρ e v 0 in order to close the equation system the equation of state is adopted for calculating the fluid pressure in this paper the jones wilkens lee jwl equation lee et al 1968 and the tammann equation ivings et al 1998 chen and collins 1971 is respectively employed for the internal gas products of the charge and other fluids which refer to the air the water and the seabed the chemical reaction process of the underwater explosion is not considered thus the jwl equation is appropriate for describing the gas explosion products and it has been widely used in simulating the underwater explosion liu et al 2018a 2018b tian et al 2020 the jwl equation and the tammann equation can be expressed as follow 9 p jwl a 1 ω a 1 r 1 e r 1 a 1 b 1 ω a 1 r 2 e r 2 a 1 ω a 1 ρ 0 e 10 p tammann η ρ e p w ρ e where a b r 1 r 2 and ω are the material constants by collating a large number of experiment which just depend on the type of material a 1 ρ b ρ 0 represents the density ratio between the explosion products ρ b and the explosive ρ 0 η denotes the ratio of the specific heat ρ denotes the density of the fluid outside the bubble and p w represents the reference pressure the material constants and coefficients applied to this paper are presented in table 1 and table 2 the dilatational wave speed in the explosive gaseous products and other fluids can separately be written as liu et al 2018a 11 c 1 2 p jwl a e r 1 a 1 b e r 2 a 1 1 ω ρ 0 a 1 a r 1 e r 1 a 1 b r 2 e r 2 a 1 ρ 0 a 1 2 and 12 c 2 2 η ρ p tammann p w each time increment of a single step should be limited by the following equation to meet the courant number condition and l e refers to the minimal length of an element 13 d t c l e after the variables e g the value of acceleration velocity and displacement at each node of element have been updated in last phase the eulerian step will consider the convection quantities between adjacent elements by reason of the relative movement between the deformed element in lagrangian form and the fixed spatially element specifically the advected volume with the volume of fluid vof benson 1992a hirt and nichols 1981 is computed then the variables at nodes and at the center of elements are convected by the half index shift his benson 1992a 1992b and the monotone upwind schemes conservation laws muscl leer 1977 respectively at the end of the eulerian phase the new pressure will obtain from the convected material density and internal energy the flow diagram of executing the calculation is briefly shown in fig 2 2 2 model validation by comparing with experimental results after the present numerical model has been constructed it is demonstrated by comparing with the experiment implemented by zhang et al 2015c in this experiment the bubble was produced by the underwater discharge of a 6600 μf capacitor charged to 200 v the vacuum pump channeled with the water tank could enlarge the maximum bubble radius by reducing the pressure the height of the cylindrical steel tank was 1200 mm and its inner diameter was 800 mm the ambient pressure at the bubble center was 3240pa and the maximum radius of the bubble is 62 6 mm the pulsating process of the bubble was recorded as a set of photographs with a high speed camera the bubble motion would be affected by both gravity and free surface in this experiment through taking a 1 the numerical simulation is carried out where the initial bubble radius is 10 02 mm and the initial pressure of the bubble is 360800pa fig 3 shows the comparison between the numerical simulation and the experiment zhang et al 2015c the contour map denotes the density field and the black lines represent the interface of the bubble and the free surface it is clear that the interface between the experiment and the numerical simulation fits well the bubble expands rapidly and its shape is almost spherical after the electrode is discharged at t 3 33 ms it reaches the maximum radius when t 33 33 ms and the bubble pushes the free surface upward then the bubble starts contracting with a broad liquid jet appearing the upper surface of the bubble is slightly flat due to the repulsion of the free surface at t 78 66 ms the bubble center contracts faster than other parts due to the existence of the liquid jet and it shows a toroidal shape as shown in the final frame 2 3 non dimensionalization and convergence examination for purpose of making the results of research works more representative and universal all variables in the following numerical simulations are non dimensionalized by taking a set of characteristic quantities klaseboer et al 2005b liu et al 2016 scilicet the maximum bubble radius r m in an infinite liquid is taken as the length characteristic quantity it is calculated klaseboer et al 2005b with the empirical formula 14 r m 3 38 w h 10 1 3 where w is the charge weight and h is the initial depth of the charge the hydrostatic pressure at the bubble center p and the water density ρ w are taken as the characteristic quantities of the pressure and density respectively p is calculated as 15 p p a t m ρ w g h where the p atm is the atmospheric pressure based on the above basic reference scales the other variables can also be non dimensionalized by calculating as shown in table 3 the convergence of the numerical model is examined by taking the different mesh sizes and time steps as shown in fig 4 the mesh sizes in the computational domain are set as 0 005 r m 0 005 r m 0 01 r m 0 01 r m 0 02 r m 0 02 r m 0 03 r m 0 03 r m and 0 04 r m 0 04 r m respectively it can be clearly seen from the left frame in fig 4 that the bubble period convergences with the decrease of mesh size it should be noted that the improvement in accuracy is not significant when the mesh size changes form 0 01 r m 0 01 r m to 0 005 r m 0 005 r m however the numerical simulation using the mesh size 0 005 r m 0 005 r m takes approximately twenty times longer than that using the mesh size 0 01 r m 0 01 r m the time steps are taken as 0 1 l e c 0 2 l e c 0 4 l e c 0 6 l e c and 0 8 l e c in the numerical simulations in the right frame it is found that the bubble period also convergences roughly as the time increment decreases in order to accelerate the calculation and ensure the accuracy of the simulation the larger mesh size and time step are appropriate for the numerical model taking the case in section 3 1 as an example the size of the total rectangle computational domain is 8 r m 7 r m and the external computational domain boundary adopts the non reflecting boundary condition to avoid the inveracious pressure reflection liu et al 2018a in order to reduce computation time as well as ensure accuracy non uniform meshes are applied to the present model that is the size of the meshes near the bubble are 0 01 r m 0 01 r m and the others away from the bubble are 0 02 r m 0 02 r m the element number in this computational domain is approximately 260000 and it will take about 5 h to complete the entire simulation of underwater explosion with intel i7 9700 cpu and 16 gb ram 3 results and discussions 3 1 essential features of bubble dynamics in shallow water in this section the general characteristics of the explosion induced bubble dynamics between a deformable seabed and a free surface is elaborated the tnt charge weight is 3 88 10 4 for this case then taking the ratio of the density between the seabed and water a 2 0 for meeting the requirement of the shallow water the water depth is taken as 2 the depth of the charge h 1 7 and the distance from the seabed d 0 3 fig 5 shows the specific results of the simulation it is found that at t 0 006 the propagation velocity of the shockwave in the seabed is slower than in the water owing to the density difference between the seabed and the water meanwhile the pressure of the shockwave in seabed is greater than in the water the main reason is that the shockwave travels a shorter distance in the high density fluid and loses less energy when the shockwave propagates to the free surface the rarefaction wave appears as shown at t 0 016 it also can be seen at t 0 416 and t 0 993 that the lower part of the bubble expands slower than the top part because the bubble expansion needs to overcome the greater resistance for the high density fluid as the bubble volume continues to increase the free surface swells slightly and shows the mound shape subsequently the top bubble surface contracts faster than the lower surface and the shovel shaped bubble appears owing to the bjerknes force blake and gibson 1987 thus it can be found that the effect of the high density fluid on the bubble is similar to that of the solid wall on account of the inconsistent contraction velocities in different parts of the bubble the bubble necking and the fluid crimp occurs as shown at t 1 541 and t 1 766 in the late stage of the bubble collapse an annular jet induced by the bubble necking with a velocity of 64 appears which is pushed by the high pressure region with a pressure of 78 and produces a split bubble at t 1 851 the high speed jet completely penetrates the bubble then a toroidal bubble appears at t 1 886 at the lower end of the bubble near the rotary axis the ring hump arises owing to the downward fluid when the bubbles have reached its minimum volume they begin to rebound and the largest toroidal bubble pushes away the high density fluid at t 1 948 the water spike is not observed obviously during the whole evolution process because the initial bubble depth is 1 7 times the maximum bubble radius under the attraction of the high density fluid most of the bubbles sink into it as shown at t 2 021 3 2 single effect of free surface and deformable seabed before further exploring the effect of composite boundary on bubble the bubble near the single boundary needs to investigate firstly fig 6 shows the underwater explosion near the free surface compared with the case in section 3 1 the shock wave propagates outward as a complete spherical wave at t 0 008 and the bubble shape remained spherical during the bubble expansion but when it is in the collapse phase at t 1 646 a non spherical bubble is observed and the lower part of the bubble contracts faster than the upper part on account of the gravity an obvious liquid jet with a velocity of 7 is seen clearly owing to the difference of the pressure the direction of the liquid jet and the migration of bubble are upward which is highly different from that in relevant studies li et al 2019a pearson et al 2004 this phenomena can be explained by the blake criterion blake and gibson 1987 the buoyancy effect takes the advantage than the bjerknes effect when the parameter h 2 ρ w g r m p 0 442 the parameter in this case is 0 745 in additional a bubble pulsating pressure wave spreads out as shown at t 1 699 then there are many tiny split bubbles near the rotary axis and they merge to form a larger bubble during the bubble rebound phase at t 1 717 fig 7 shows the underwater explosion bubble near the deformable seabed without the free surface it can be found that the bubble evolution in its expansion is similar with the case in section 3 1 but when it comes to the bubble contraction phase there are much difference in these two cases at t 2 016 the high pressure region pushes the thin liquid jet to penetrate the bubble with the velocity of 21 the jet formation is dominated by the bjerknes force of deformable seabed thus the jet points to the seabed different from the case in section 3 1 there is no bubble split and annular impact occur in this case the liquid jet impacts on the high density fluid and the ring hump occurs owing to the flowing fluid when t 2 053 the bubble is divided into two parts and the lower part is evolved from the ring hump at t 2 190 comparing figs 6 and 7 it is found that the liquid jets induced by the free surface and the deformable seabed are in opposite directions as shown in fig 5 when the underwater explosion is between a free surface and a deformable seabed the direction of high speed jet is downward and the bubble evolutions are similar with fig 6 these phenomena indicate that the deformable seabed has dramatic effect on the bubble when the bubble is near the deformable seabed the bubble radius and vertical displacement for the above cases in this subsection are shown in fig 8 it can be seen from the left frame that the bubble near the deformable seabed has the longer period when it is compared with the case that is only with the free surface in the right frame the bubble moves upward when there is only a free surface in the case which is contrary to that of the bubble near the deformable seabed for the former case the buoyancy dominates the direction of the bubble displacement which is similar with the phenomenon in an infinite liquid liu et al 2018a however the suction of the deformable seabed on the bubble causes it to migrate downward for the latter case when the bubble reaches the minimum radius the moving speed is also maximized according to the momentum conservation law the mass of the bubble especially the additional mass of the fluid around the bubble decrease apace resulting in the rapid contraction of the bubble for the two cases 3 3 bubble dynamics with different density ratios in this subsection the influence of the different density ratios on the underwater explosion is considered carefully the numerical simulation of the bubble between the deformable seabed and the free surface with a 2 5 are shown in fig 9 compared with the previous case where the a 2 0 the following figures can show a fact that the density ratio influences little the bubble morphological changes and the water seabed interface during the bubble expansion period however when the bubble begins to collapse there still are some important differences as follow firstly the fluid crimp is more dramatic and wraps the bubble protruding surface when the annular impact appears at t 1 880 the velocity of the annular jet is 61 while the pressure in the high pressure zone is 79 then the split bubble on the rotary axis can be seen at t 1 907 but its height is significantly lower than that of the previous one in section 3 1 the larger bubble is divided into two parts at t 2 012 and the lower part is derived from the ring hump in the bubble rebound phase the small split bubbles distribute along the surface of the high density fluid at t 2 112 while they are on the rotary axis in the case where a 2 0 fig 10 shows some interesting phenomena with the high density ratio a 4 0 during the bubble contraction stage the annular jet and the split bubble on the rotary axis are not observed under this condition the high pressure zone promotes the generation of the thin liquid jet with the velocity of 48 at t 1 957 then the whole toroidal bubble moves down to the deeper position and is divided into three parts eventually therefore it can be reasonably inferred that the liquid jet velocity and the amount of the split bubbles decrease with the density ratio a increasing the main reason is that the liquid jet needs to consume more energy when it passes through the higher density fluid and the toroidal bubble is easier to split in the low density fluid the bubble radius the bubble center displacement and the shockwave pressure at 0 2 with different density ratio a are also compared in this subsection fig 11 shows that the bubble radius curves almost coincide in its expansion but separate during the bubble contraction furthermore the pulsating period of the bubble gradually grows as the density ratio a increases it can manifest that the different density ratios influence little the minimum bubble radius in the first period the second frame in fig 11 shows the bubble center displacement for the overall trend the displacement curves rise up first during the bubble expansion phase when t 1 and then fall down when the bubble contracts which can indicate the high density fluid has a strong suction force on the bubble from the enlarged block diagram it is found that there is an oscillation when the bubble reaches the minimum volume it is explained that the small bubble is pulled down quickly by the downward fluid and then rises up due to the bubble rebound however for the case where a 2 0 there are split bubbles generated by the annular jet and they partially offsets the overall downward displacement of the bubble fig 12 shows the shockwave pressure history curves with the different density ratios it can be found that all the pressure curves have went through two stages the first pressure peaks generated by the underwater explosion increase practically linearly and the propagation speed of the shockwaves reduce with the a increasing between t 0 01 and t 0 02 the main reason is that the shockwave loses less energy and the dilatational wave speed decreases in the higher density fluid according to eq 12 the tnt detonation not only spreads shockwave outwards but also transmits the rarefaction waves to the center of the charge after the rarefaction waves meet a shock wave is formed to propagate outward therefore a small undulation occurs in the pressure curve when the pressure drops for the second ones after t 0 04 when the shockwave reaches the free surface the rarefaction wave is immediately reflected and propagates to the water in the form of a spherical wave owing to the absence of the cavitation model in this numerical simulation the pressure is negative the pressure of the shock wave is rapidly attenuated in the whole process due to the dissipation of energy compared with the first pressure peak the second one is only approximately 6 of it and the difference of the second pressure peaks is not obvious 3 4 bubble dynamics with different initial depths of charge in addition to the density ratios mentioned above the initial depth also influences dramatically the bubble dynamics the bubble evolution with h 0 7 is shown in fig 13 obviously the top bubble surface expands faster owing to the free surface which shows an egg shape bubble at t 0 329 then the bubble is penetrated downward by the liquid jet with the velocity of 5 and the water spike comes to appear when the bubble sets out to collapse at t 1 191 this phenomenon that the downward jet and the water spike occur almost simultaneously have been investigated and analyzed by blake et al 1987 and chahine 1977 the reason is that the fluid is drawn to the area between the free surface and the upper bubble surface and it forms the retention point leading to the formation of a high pressure region this high pressure region pushes the jet to penetrate the bubble and makes the water air interface rise the ring hump can also be seen in this case and it will evolve into a split bubble as shown at t 1 428 and t 1 469 in addition the annular impact is not observed indicating that this phenomenon cannot occur when h is small then the center spike and the water skirt appear at t 1 878 these phenomena can be also found in the previous works li et al 2019a the evolution of the bubble located at the interface separating the water and the seabed is shown in fig 14 since the bubble is initially at the water seabed interface it has a stronger interaction between the bubble and the interface than the previous cases the pressure inside the bubble is small with the shockwave releasing in the bubble expansion phase thus the pressure gradient can be regards as being perpendicular to the bubble seabed interface liu et al 2019 thus the deformable seabed is sucked up and the fluid crimp occurs at t 0 363 compared with fig 5 the seabed rolls outward and it separates part of the bubble at t 1 163 leading to the formation of the split bubbles during the bubble expansion then the high pressure zone appears because of the excessive contraction of the bubble surface pushing the annular jet to penetrate the bubble with the velocity of 60 the annular jet in this case is strong enough to penetrate the bubble generating the split bubble at t 1 961 with the different initial depths of the bubble the bubble radius and vertical displacement are investigated as shown in fig 15 it is seen from the left figure that the period of bubble will be longer with h increasing this law concluded form these cases is consistent with the works of zhang et al 2017 they found that the period of bubble would be longer with the initial depth of bubble increasing the right frame shows that the buoyancy influences little the bubble displacement and the bubble is dominated by the bjerknes effect to move downwards in all the cases which are similar to the bubble near the solid wall subsequently it can be found that the bubble when h 2 0 has the shortest downward displacement the reason is that it is hindered by the more high density fluid and the bubble when h 0 7 has the longest downward displacement because the free surface repel the bubble in its contraction stage and there are no high density fluid to block the bubble movement fig 16 shows the shockwave pressure with the different initial depths of charge apparently since the shockwave dissipates more energy when it travels the farther distance the first pressure peaks decline with h decreasing the second pressure peaks reflected by the free surface grow as h decreases it can be found that the pressure peak is mainly determined by the propagation distance of the shock wave when other parameters are consistent 4 conclusions in this paper an underwater explosion between a deformable seabed and a free surface is simulated based on the efem and several cases with the different initial conditions are investigated numerically this approach shows the tremendous advantage in describing the nonlinear interactions between bubble and deformable seabed the non spherical bubble features in its expansion stage are obvious when the bubble is near the seabed because the lower part of the bubble needs to push away the heavier fluid during the contraction phase the liquid jet induced by the seabed is downward owing to the bjerknes effect which is similar to the phenomenon when the bubble is near the rigid boundary through investigating the single effect of deformable seabed and free surface on bubble it is found that the deformable seabed has a dramatic effect on bubble when the bubble is near the deformable seabed subsequently the period of the bubble and the shockwave pressure peak grow as the density ratio increases when the density ratio is small more tiny bubbles appear near the symmetric axis while there are only several slightly larger bubbles when the density ratio is larger as the initial charge depth increases the bubble period is longer and the interactions between the bubble and the seabed is stronger such as the bubble split and the seabed deformation in addition the annular jet induced by the bubble necking occurs only with an appropriate initial charge depth or density ratio during the bubble contraction these conclusions have some significances in engineering filed for example the deformable seabed influences dramatically bubble in the shallow water and if the bubble is near the seabed the damage to structures cannot be maximized besides the underwater explosion is also used to deal with the seabed mud and the desilting process is shown briefly in this paper credit authorship contribution statement liu yi xu programming writing original draft data processing shi ping wang conceptualization investigation formal analysis review yun long liu programming methodology review a man zhang supervision funding acquisition review declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this paper is supported by the national key r d program of china grant no 2018yfc0308900 the national natural science foundation of china no 51879052 11672082 and the national natural science foundation of heilongjiang province no yq2019e012 
21257,abstract the discrepancy between the theoretical and experimental results is defined as one of the main reasons for updating the analytical models of the structures based on experimental data sets although various updating methods have been proposed in the literature the capability of the approaches on controlled systems is yet to be investigated in this paper a numerical model updating method is proposed considering both parametric and structural uncertainties on a passive controlled complex structural system the method is applied on a three dimensional offshore jacket platform model including an attached tuned liquid column gas damper tlcgd damping system the effect of the damper parameters on updating the numerical model is investigated for the first time using a laser doppler vibrometer ldv as a non contact measuring system the maximum decrement is occurred using a sine function which seems to be because of the sinusoidal nature of the experimental data according to the results the discrepancy between the numerical and experimental data can be decreased by 75 percent utilizing non contact measurements and discrepancy functions the results also indicate that by calibrating the gas pressure and the total liquid column length of the tlcgd damping system as the most important parameters of the damper the discrepancy is decreased almost 66 percent the proposed method of updating the fe model for the controlled systems is beneficial for the old sophisticated controlled practical systems that increasing their life time span is essential keywords numerical model updating non contact measurements laser doppler vibrometer ldv passive structural control tlcgd gas damper 1 introduction finite element fe model updating is defined as a process of calibrating the numerical model of a structural system to reduce the discrepancy between numerical and experimental data basically the difference between numerical and experimental measurements which is caused by uncertainties must be reduced to achieve more accurate and reliable numerical models that simulate the actual behavior of real structural systems hokmabady et al 2019c the updated model is utilized to gain reliable predictions of structural dynamic behavior under real environmental loads a general goal of model updating can also be defined as making a better conformity between the dynamic response of the numerical model and the real structure to gain a practical model numerical model updating can be classified into i direct methods essentially non iterative and ii iterative methods hosseinlou and mojtahedi 2016 which provides more uncertain parameters such as weight coefficient of the objective functions that are required to be updated through the optimization friswell and mottershead 1995 although model updating is used in different fields such as structural health monitoring damage detection and so forth jaishi and ren 2005 hosseinlou and mojtahedi 2016 bakir et al 2007 abbasi et al 2015 brownjohn and xia 2000 the approaches are mostly employed to specify unknown characteristics of a system well known as uncertainties girardi et al 2020 however presence of uncertainties in modeling might lead to even wrong estimations hokmabady et al 2019c uncertainties related to the fe or any computer model can be categorized into three distinct groups 1 inaccuracy in the way mathematical equations are solved known as numerical uncertainty 2 imprecision in model parameters definition known as parameter uncertainty and 3 inexactness and incompleteness in engineering principles modeling known as structural uncertainty hokmabady et al 2019c kennedy and o hagan 2001 and 2002 calibrating the input parameters of a model without considering structural uncertainty might gain mathematically correct results but physically incorrect solutions kennedy and o hagan 2001 and 2002 however the success of model updating procedure depends on experimental test execution the importance of experimental data acquisition is considerably high not only due to its impact on the accuracy of updated numerical model but also because of possible real system implementation in this study to reduce the disagreement between the numerical and experimental data among all numerical parametric and structural uncertainties the second and the third ones are considered in fact for the proposed case study of this research verification of the governing equations has been performed a priori across the domain of interest and the code and solution verification activities numerical uncertainty are beyond the scope of this paper on the other hand employing a non practical experimental method might not lead to a real in situ system behavior based on experience the conventional testing and sampling methods using transducer has limitations when applied in real practice such as maintenance costs adding inertia of the sensors to the lightweight structures the mass loading and also causing the structural dynamics distortion zanarini et al 2018 although variety of model updating approaches have been proposed to be investigated on different structural systems the capability of updating methods on structural controlled systems is yet to be investigated in structural controlled systems vibration absorber devices are used which their design and configuration have always been the theoretical or the experimental research subjects in the engineering fields due to their high capability in improving reliability and structural performance among these devices tuned liquid column dampers tlcd which consists of a rigid u shaped tube with an orifice in the middle which is filled with a liquid mostly water covering a wide range of external loading excitations can be achieved by using a hybrid tlcd employing magneto rheological fluids as smart materials ni et al 2004 wang et al 2005 katebi and mohammadyzadeh 2015 considering a semi active tlcd utilizing a novel mr tlcgd system hokmabady et al 2019a b employing a developed rolling ball and gas springs hokmabady et al 2019a b or gas springs distinctly hochrainer and fotiu 2018 the effects of an air spring gas spring are reflected by a tuned liquid column damper tlcgd within the trapped air at the end of vertical columns to tune the damper frequency as of the most important weak point of tlcds capabilities of tlcgd systems are investigated on various studies in the literature hochrainer et al 2006 mousavi et al 2012 2013 hochrainer and fotiu 2018 hokmabady et al 2019a b performance of tlcgd vibrational devices are studied experimentally in limited researches hochrainer et al 2006 and its efficiency on offshore structures is not yet studied empirically using any contact or non contact devices generally the conventional transducers for instance contact accelerometer not only covers a narrow range of measurement area but also requires in touch places for physical contact maintenance and inspections to overcome these limitations a laser doppler vibrometer ldv as a non contact measuring system can be used to achieve more reliable and efficient results siringoringo et al 2006 the ldv system measures surface velocity based on interferometry of the laser and provides the velocity of the primary structure the application of ldv as a velocity transducer covers various advantages over the traditional ones such as high sensitivity and non contacting capabilities which can improve the efficiency and quality of modal or any vibrational testing siringoringo et al 2006 the scanning ability of ldv provides high spatial resolution of measurement which can only be achieved by employing a massive number of transducers in the conventional measurement randel et al 1993 used a ldv to measure the horizontal velocity under the largest wave of an irregular sea generated in a laboratory nassif et al 2005 compared the results of dynamic load tests on a bridge using ldv system with two types of contact sensors they concluded that the ldv measurements were fit with the results of contact sensors and could be used as an alternative system zanarini et al 2019 challenged different optical technologies for the same model updating procedure to investigate the effect of the measuring system typology on the uncertainty of the references for the updating li et al 2019 investigated the flow characteristics of a horizontal axis wind turbine hawt rotor surface during rotation with wind tunnel experiments they measured the effect of ldv system on the power coefficient of hawt zhao et al 2018 proposed a method of gaining the vibration time domain signal of a beam using laser doppler principle and random excitation they demonstrated that the method was expected to be used as an online assessment instrument for beam defects in service state and pang et al 2020 presented the potential application of non destructive non contact remote strain sensing technique based on laser speckle imaging system to investigate the deformation around fastener holes in this study a numerical model updating approach is proposed considering parametric and structural uncertainties on a controlled complex structural system the method is applied on a three dimensional offshore jacket platform model including an attached tlcgd damping system for the first time in offshore structural field the experiment is performed using a shake table test and non contact ldv device and utilizing a scaled hydro elastic physical model the proposed updating approach is carried out based on sixteen updating scenarios in which the parametric uncertainty reduction is performed by calibrating different structural parameters the structural uncertainty is also reduced by employing model form error parameters as mathematical functions based on the results the discrepancy between the numerical and experimental data can be decreased significantly using non contact data the results also indicate that calibration of the damping matrix has a vital role in updating the numerical model of the uncontrolled system also the gas pressure and the total liquid column length of the tlcgd system have key roles in updating the passive controlled system the developed methodology is recommended to be applied on the numerical model updating process of passive controlled structural systems based on the results employing a non contact technology such as ldv system is also highly recommended in practical cases due to its high sensitivity capabilities and no direct contact requirements 2 theoretical background 2 1 uncertainty analysis uncertainties are induced by various factors in experimental and numerical modeling in all engineering fields and their identification is of great importance to have an accurate numerical model uncertainty must be mathematically understood in both the experimental data and the behavior prediction a mathematical relation can be defined between the input parameters and output responses as follows 1 y s i m m x θ where x θ are the input parameters of the numerical model y s i m is the output response of the numerical modeling x indicates a subset of the model input parameters that define the domain of applicability hokmabady et al 2019c the variable θ is the calibration variable and has considerable impact on the output responses there is also a mathematical relation between the response of the actual prototype and the experimental data as follows 2 y o b s x i ξ x i ε x i i 1 n where ξ x i ε x i and n are the response of the real physical system the experimental error and number of experimental tests respectively the numerical modeling and the experimental test can be defined in an equation considering model form error ψ x i kennedy and o hagan 2001 3 y o b s x i y s i m x i θ ψ x i ε x i i 1 n on the other hand the true response of the actual prototype is possible theoretically employing a summation of computer modeling model form error and the experimental error imprecision in definition of model parameters parametric uncertainty requires calibration of the uncertain parameters of the model inside an iterative procedure in this study the calibration parameters of the jacket are specified as members modulus of elasticity e shear modulus g and mass density md and the calibration parameters of the damper are defined as fluid density ρ cross section of the liquid column a d total liquid column length l t gas pressure p 0 and head loss coefficient δ d also to consider the damping matrix as a part of calibration parameters two non physical coefficients β and γ are specified inexactness in numerical modeling structural uncertainty is resolved by defining a model form error known as discrepancy model in the calculation process the main purpose of the model form error is to reduce the disagreement between the numerical and experimental data by substituting the discrepancy model in eq 3 the following formulation is obtained 4 y o b s x i y s i m x i θ δ x i α ε x i i 1 n where δ and α represent the discrepancy model and the non physical coefficients of the discrepancy model respectively the discrepancy model can possibly be specified as any continuous and differentiable function in this manuscript four mathematical functions are defined for the discrepancy models to find the most efficient function in reducing the difference between the experimental and numerical model 5 δ 1 x α α 0 e x α 1 α 2 6 δ 2 x α α 0 sin α 1 x α 2 α 4 cos α 5 x α 6 7 δ 3 x α α 0 x 4 α 1 x 3 α 2 x 2 α 3 x α 4 8 δ 4 x α α 0 e α 0 sin α 1 x α 2 α 4 cos α 5 x α 6 the mathematical model form error functions are defined as continuous and differentiable functions any forms of continuous and differentiable functions their combinations or other polynomial forms such as legendre or bessel polynomials and trigonometric functions such as sine or cosine functions can be specified kennedy and o hagan 2001 the functions of the study are chosen based on three concepts i basics of the experimental force which is considered as white noise δ 2 ii previously mentioned fundamental which is possibility of selecting any continuous and differentiable functions δ 1 and δ 3 iii a combination form of the first and the second concepts however the coefficients of the functions should also be trained according to the available experimental data set to have an accurate optimization and model updating process the numerical model members are divided into ten distinct groups as presented in fig 1 more details about the members division are listed in table 1 to treat both structural and parametric uncertainties simultaneously specifying an objective function and an optimization algorithm is required in this regard an objective function as sum of squared errors sse is defined as follows 9 f α θ i 1 n y o b s x i y s i m x i θ δ x i α 2 i 1 n where f α θ is the objective function with inputs of α and θ the objective function includes parameter uncertainty and structural uncertainty model form error into the training process at the same time to minimize the objective function employing an optimization algorithm is vital for this purpose in this study particle swarm optimization pso algorithm is utilized pso is a population based method that inspired from the behavior information exchange of the birds in a swarm eberhart and kennedy 1995 the optimization procedure is defined as a controlled loop between matlab and frame3dd the details of which are discussed in the following section 2 2 fe modeling and parameters definition the numerical modeling of the jacket platform equipped with a tlcgd damping system is performed using the mass and stiffness matrices in accordance with the matrix equation of the motion as follows hokmabady et al 2019 10 m u c u k u f ρ a b d v ρ a d l t u 11 ρ a l t d v 1 2 ρ a d δ d v v 2 ρ a d g v 2 k d v ρ a d b u where m and k are mass stiffness matrices gained using the frame3dd software which is free open source software for static and dynamic structural analysis of 2d and 3d frames and trusses with elastic and geometric stiffness henri and gavin 2010 the matrices are obtained as two 228 228 matrices the jacket is also defined with 38 nodes and total 109 members within the frame3dd input file parameters u f δ d l t a d and ρ are displacement vector of the jacket platform the force vector the displacement vector of damper liquid the head loss coefficient the total length of damper liquid column the cross section of damper liquid column and the liquid density respectively the gas spring stiffness k d is nonlinear and for small liquid displacement the linearized air spring stiffness can be given as γ a d 2 p 0 v 0 in which γ 1 4 p 0 and v 0 are the index of polytropic the initial pressure and volume of the gas spring in each vertical columns of the system respectively chatterjee and chakraborty 2014 more details about designing the damping system can be find in mousavi et al 2012 chatterjee and chakraborty 2014 hochrainer and fotiu 2018 and hokmabady et al 2019a b the term c is defined as the damping matrix the coefficient of which are considered as one of calibration parameters in this study the matrix is specified as combination of mass and stiffness matrices based on rayleigh s technique the coefficients of the damping matrix are defined with the same size of the mass and stiffness matrices including 12 12 submatrices with 144 elements in this study the objective function is minimized through the optimization process employing the newmark beta nb method chopra 1995 more details about the process of the numerical model updating are presented in table 2 the initial value of unknown calibration parameters including upper and lower bound values for both the jacket and the damper are listed in tables 3 and 4 respectively the same units of frame3dd input file are considered for the values of table 3 the final objective function considering all calibration parameters can be rewritten based on eq 9 as follows 12 f i 1 n u o b s t i u s i m t i e 1 e 10 g 1 g 10 m d 1 m d 10 β 1 β 144 γ 1 γ 144 ρ a d l t p 0 δ d δ t i α 0 α 1 α 2 α 3 α 4 α 5 α 6 2 i 1 n 3 experimental procedures and equipment the experimental test is implemented in modal analysis laboratory of university of tabriz using a scaled hydro elastic model of an offshore jacket platform the specifications of the scaled model which is built based on the real prototype technical drawings are listed in table 5 to model the experimental tlcgd system a numerical model is designed for the actual prototype structure according to the mass ratio of one and appropriate scale factors are applied to achieve the final empirical model see fig 2 to pump the air inside the damper two inflation valves are placed at both ends of the vertical columns the specification of the designed model is listed in table 6 the tlcgd system is prepared based on initial design values of a passive system which is chosen according to the first natural frequency of the jacket the test is carried out employing a shake table and ldv sensing components ldv is well established as a fast efficient and cost effective means of measuring and analyzing the structure s vibration which works without surface contact more details of the apparatuses and the experimental model are presented in fig 3 and table 7 to perform the experimental test the physical model is fixed on the shake table in x direction of the jacket for velocity measurement see fig 4 the optical unit of the ldv is placed and adjusted on a tripod in a way that the measuring beam is centered in the middle of the jacket deck as shown in fig 3c the analogue velocity output calibration can be checked employing an appropriate accelerometer in association with a charge amplifier or a standard hand held calibrator in this research a calibration exciter type 4294 made by brüel kjær engineering company is utilized see fig 3d since the loading effect of an accelerometer can change the dynamic response of a vibrating structure the best procedure is to compare the accelerometer output with the optical unit velocity output obtained with the measuring beam centered on the top surface of the accelerometer the calibration procedure is performed based on the optical unit user manual a random vibration signal is applied on the scaled model in a frequency range of 1 50 hz with duration of 20 s the test is repeated 3 times to avoid any unintentional errors the experimental measurement is used to both validate and update the numerical data more details of which are presented in the following section 4 results and discussion in this manuscript the numerical fe model of a passive controlled offshore jacket type platform is updated using ldv based experimental data for this purpose shake table equipment and ldv components are employed for measuring the physical model velocity the velocity time history of the experimental and numerical models is presented in full time span and limited time span for more clarification in fig 5 to validate the numerical results based on the experimental data rmse index is employed the rmse value is gained as 0 52 for the whole time span of the velocity time history data which involves almost 10000 data points based on considerable number of data points the obtained value of rmse can be specified as an acceptable value to validate the numerical results however due to the presence of the significant discrepancy between the results the fe model cannot be used as an accurate fe model in both contact and non contact tests for further investigation which indicates the necessity of model updating to compare the numerical and experimental model results the numerical fe model is simulated using the same experimental force captured by an accelerometer placed on the base level of the scaled jacket model in this study numerical model updating is performed by defining sixteen different scenarios as listed in table 8 the first three scenarios are specified as model updating with considering the jacket calibration parameters in scenarios four to seven all discrepancy functions are specified along with the jacket calibration parameters in scenarios eight to twelve both jacket and damper calibration parameters are defined without presence of discrepancy functions in scenarios number thirteen to sixteen the model form error functions are also considered to evaluate the performance of employing both parametric and structural uncertainties simultaneously in updating a sophisticated structural controlled system the optimization process is repeated by 50 runs each with swarm size of 30 through 150 iterations for each scenario to optimize the objective function eq 12 a controlled loop between matlab and frame3dd is defined aside from ensuring the calibration parameters convergence to their true values it must be certified that the trained discrepancy model indicates a true representation of model incompleteness to assess the calibration procedure the velocity time history is just presented for a limited time span 1 4 s in all scenarios the velocity time history of the first three defined scenarios are illustrated in fig 6 although in the first scenario the fe model is poorly updated in comparison to the base numerical model in the second and the third scenarios the numerical model is better fit to the experimental data to assess the efficiency of the methodology a data fitness index well known as the mean squared error mse is used to compare the full velocity time history of the first three scenarios with the experiment see table 9 obviously the discrepancy between the experimental and numerical data is reduced almost 0 3 percent as the first scenario is specified however by employing the second and the third scenarios the discrepancy is decreased almost 6 3 and 27 3 percent respectively in fact the highest fitness among the first three scenarios which include only the jacket calibration parameters occurred as the damping matrix coefficients are updated indeed the highest reduction of the discrepancy in the third scenario indicates not only the importance of the damping coefficients updating but also the necessity of updating the damping coefficients matrix instead of a portion which is highly recommended in model updating scenarios the results of the mse index for the fourth to seventh scenarios are listed in table 10 according to table 11 the discrepancy between the results is reduced almost 61 64 55 and 57 percent for the fourth to seventh scenarios which indicate the efficiency of the second discrepancy function sinus based function however this might be because of the sine nature of the velocity time history the agreement is not only on the whole performance but also is on some peak points which shows the capability of the employed function the results of the mse index for the mentioned scenarios are listed in table 11 as it is expected by ignoring the model form error functions in updating scenarios the discrepancy is increased almost significantly however as the damper calibration parameters are included the discrepancy is reduced again the highest decrement 66 percent is occurred as the most important parameters of the damper gas pressure and the total liquid column length are taken into account in the tenth scenario also more decrement is observed in the eleventh and twelfth scenarios 74 and 75 percent the reduction is not as significant as the efficiency of the tenth scenario the results of the mse index for the mentioned scenarios are listed in table 12 as stated in table 12 adding model form error is highly effective in reducing the discrepancy between the numerical and the experimental results of a passive controlled system the value of mse is decreased by almost 70 percent as the first discrepancy function is taken into account the decrement in mse is about 83 70 and 85 percent for the second third and the fourth functions respectively obviously the highest decrement among scenarios thirteen to fourteen is occurred as the second and the fourth model form eror functions are taken into account in fact this might be due to the sine nature of these functions which is so similar to the nature of the experimental force although it is possible to select any kind of mathematical function for the discrepancy function the results indicate the importance of choosing a mathematical function with the same nature of the experimental data for both uncontrolled and controlled systems the performance of the whole scenarios is presented in fig 7 based on fig 7 by considering the only jacket calibration parameters in scenarios one to three the discrepancy between the analytical and the experimental results is decreased almost 27 percent however the decrement is significantly higher as the discrepancy function is specified by the jacket calibration parameters simultaneously in the fourth to seventh scenarios with the highest reduction in fifth one as the jacket calibration parameters and only one of the damper calibration parameters are defined without any discrepancy functions the difference between the results is increased by almost 30 percent in the eighth scenario by adding more calibration parameters of the damper in the ninth to twelfth scenarios the discrepancy between the results are decreased gradually the highest reduction is obtained as the most important parameters of the damper l t p 0 are included although adding discrepancy functions results in more decrement the significant reductions are gained using the second δ 2 and the fourth δ 4 functions the performance of the discrepancy mathematical functions which is defined in scenarios fourth to seventh the effectiveness of the damper calibration parameters which is assessed through scenarios eighth to twelfth and the performance of the discrepancy functions along with the jacket and the damper calibration parameters presented in scenarios thirteenth to sixteenth are illustrated in figs 8 10 in appendix 1 for more information respectively 5 conclusions in this manuscript a numerical model updating method is introduced for uncertainty analysis of a controlled complex structural system in this method updating a three dimensional offshore jacket platform model including an attached passive tuned liquid column gas damper system is considered for the first time the experiment is implemented using a shake table test a non contact ldv device and a scaled hydro elastic physical model of three dimensional fixed offshore jacket platform the proposed updating approach is carried out using sixteen updating scenarios in which the parametric uncertainty reduction is handled by calibrating different jacket and damper parameters for this purpose the jacket platform members are separated into ten and the damper parameters are categorized into five groups each optimized distinctly using pso algorithm the structural uncertainty is also reduced by employing a model form error parameter using four various mathematical functions the damping matrix is also updated by employing the updated mass and stiffness matrices and optimizing two damping coefficient matrices the results and limitation of the study can be summarized as follows the numerical model of the investigated offshore platform is updated successfully using non contact measurements and similar to the uncontrolled system the results imply that calibration of the damping matrix plays a key role in updating the numerical model of the controlled system the maximum fitness among the first three scenarios occurred as the damping matrix coefficients are updated which indicates not only the importance of updating the damping coefficients but also the essentialness of considering the coefficients as a matrix instead of a scaler parameter according to the results within the eighth to twelfth scenarios the highest decrement is occurred as the most important parameters of the damper gas pressure and the total liquid column length are taken into account basically as the second and the fourth functions are used for the discrepancy reduction the maximum decrement occurs that might be because of the sine nature of the functions which is so similar to the nature of the experimental outcomes although it is possible to select any kind of mathematical functions for the model form error choosing a function with the same nature of the experiment records are significantly recommended for both uncontrolled and controlled systems based on the results employing a non contact sensing technology such as ldv system is strongly recommended in practical cases due to its great sensitivity capabilities and no direct contact requirements the developed methodology is recommended to be applied for the numerical model updating process of the controlled structural systems based on an accurate fe model the introduced method is not only extremely efficient but also beneficial for the old controlled realistic complex systems that increasing their life time span is vital the authors have attempted to prepare the method based on a schedule that can establish an effective technique with less sensitivity to various uncertainties and intended to introduce the suggested method with emphasizing the problem of uncertainties and subsequently to find the solutions for conquer the parts of the practical problems as much as possible obviously during the jacket s real operational conditions in view of the aspects arising from marine environmental conditions there would be numerous sources of uncertainties and difficulties that can influence the accuracy of the methods which employ the dynamical concepts for offshore structural updating therefore the sketch of the present method would be experience the effects of the predicted or unforeseen uncertainties which may be significant and have not considered certainly it was difficult and almost impossible to investigate all the various aspects only in this study other practical problems have been remaining unsolved and they must be considered as the topics of the futures researches and the method must be improved by treating of them during the furthering studies credit authorship contribution statement hamid hokmabady conceptualization investigation software validation data curation formal analysis methodology visualization writing original draft writing review editing alireza mojtahedi supervision conceptualization resources funding acquisition project administration declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests this research is supported by a research grant of the university of tabriz number 2749 acknowledgement this research is supported by a research grant of the university of tabriz number 2749 appendix 1 the performance of scenarios four to sixteen in updating the time history response of the system are presented in figs 8 10 respectively 
21257,abstract the discrepancy between the theoretical and experimental results is defined as one of the main reasons for updating the analytical models of the structures based on experimental data sets although various updating methods have been proposed in the literature the capability of the approaches on controlled systems is yet to be investigated in this paper a numerical model updating method is proposed considering both parametric and structural uncertainties on a passive controlled complex structural system the method is applied on a three dimensional offshore jacket platform model including an attached tuned liquid column gas damper tlcgd damping system the effect of the damper parameters on updating the numerical model is investigated for the first time using a laser doppler vibrometer ldv as a non contact measuring system the maximum decrement is occurred using a sine function which seems to be because of the sinusoidal nature of the experimental data according to the results the discrepancy between the numerical and experimental data can be decreased by 75 percent utilizing non contact measurements and discrepancy functions the results also indicate that by calibrating the gas pressure and the total liquid column length of the tlcgd damping system as the most important parameters of the damper the discrepancy is decreased almost 66 percent the proposed method of updating the fe model for the controlled systems is beneficial for the old sophisticated controlled practical systems that increasing their life time span is essential keywords numerical model updating non contact measurements laser doppler vibrometer ldv passive structural control tlcgd gas damper 1 introduction finite element fe model updating is defined as a process of calibrating the numerical model of a structural system to reduce the discrepancy between numerical and experimental data basically the difference between numerical and experimental measurements which is caused by uncertainties must be reduced to achieve more accurate and reliable numerical models that simulate the actual behavior of real structural systems hokmabady et al 2019c the updated model is utilized to gain reliable predictions of structural dynamic behavior under real environmental loads a general goal of model updating can also be defined as making a better conformity between the dynamic response of the numerical model and the real structure to gain a practical model numerical model updating can be classified into i direct methods essentially non iterative and ii iterative methods hosseinlou and mojtahedi 2016 which provides more uncertain parameters such as weight coefficient of the objective functions that are required to be updated through the optimization friswell and mottershead 1995 although model updating is used in different fields such as structural health monitoring damage detection and so forth jaishi and ren 2005 hosseinlou and mojtahedi 2016 bakir et al 2007 abbasi et al 2015 brownjohn and xia 2000 the approaches are mostly employed to specify unknown characteristics of a system well known as uncertainties girardi et al 2020 however presence of uncertainties in modeling might lead to even wrong estimations hokmabady et al 2019c uncertainties related to the fe or any computer model can be categorized into three distinct groups 1 inaccuracy in the way mathematical equations are solved known as numerical uncertainty 2 imprecision in model parameters definition known as parameter uncertainty and 3 inexactness and incompleteness in engineering principles modeling known as structural uncertainty hokmabady et al 2019c kennedy and o hagan 2001 and 2002 calibrating the input parameters of a model without considering structural uncertainty might gain mathematically correct results but physically incorrect solutions kennedy and o hagan 2001 and 2002 however the success of model updating procedure depends on experimental test execution the importance of experimental data acquisition is considerably high not only due to its impact on the accuracy of updated numerical model but also because of possible real system implementation in this study to reduce the disagreement between the numerical and experimental data among all numerical parametric and structural uncertainties the second and the third ones are considered in fact for the proposed case study of this research verification of the governing equations has been performed a priori across the domain of interest and the code and solution verification activities numerical uncertainty are beyond the scope of this paper on the other hand employing a non practical experimental method might not lead to a real in situ system behavior based on experience the conventional testing and sampling methods using transducer has limitations when applied in real practice such as maintenance costs adding inertia of the sensors to the lightweight structures the mass loading and also causing the structural dynamics distortion zanarini et al 2018 although variety of model updating approaches have been proposed to be investigated on different structural systems the capability of updating methods on structural controlled systems is yet to be investigated in structural controlled systems vibration absorber devices are used which their design and configuration have always been the theoretical or the experimental research subjects in the engineering fields due to their high capability in improving reliability and structural performance among these devices tuned liquid column dampers tlcd which consists of a rigid u shaped tube with an orifice in the middle which is filled with a liquid mostly water covering a wide range of external loading excitations can be achieved by using a hybrid tlcd employing magneto rheological fluids as smart materials ni et al 2004 wang et al 2005 katebi and mohammadyzadeh 2015 considering a semi active tlcd utilizing a novel mr tlcgd system hokmabady et al 2019a b employing a developed rolling ball and gas springs hokmabady et al 2019a b or gas springs distinctly hochrainer and fotiu 2018 the effects of an air spring gas spring are reflected by a tuned liquid column damper tlcgd within the trapped air at the end of vertical columns to tune the damper frequency as of the most important weak point of tlcds capabilities of tlcgd systems are investigated on various studies in the literature hochrainer et al 2006 mousavi et al 2012 2013 hochrainer and fotiu 2018 hokmabady et al 2019a b performance of tlcgd vibrational devices are studied experimentally in limited researches hochrainer et al 2006 and its efficiency on offshore structures is not yet studied empirically using any contact or non contact devices generally the conventional transducers for instance contact accelerometer not only covers a narrow range of measurement area but also requires in touch places for physical contact maintenance and inspections to overcome these limitations a laser doppler vibrometer ldv as a non contact measuring system can be used to achieve more reliable and efficient results siringoringo et al 2006 the ldv system measures surface velocity based on interferometry of the laser and provides the velocity of the primary structure the application of ldv as a velocity transducer covers various advantages over the traditional ones such as high sensitivity and non contacting capabilities which can improve the efficiency and quality of modal or any vibrational testing siringoringo et al 2006 the scanning ability of ldv provides high spatial resolution of measurement which can only be achieved by employing a massive number of transducers in the conventional measurement randel et al 1993 used a ldv to measure the horizontal velocity under the largest wave of an irregular sea generated in a laboratory nassif et al 2005 compared the results of dynamic load tests on a bridge using ldv system with two types of contact sensors they concluded that the ldv measurements were fit with the results of contact sensors and could be used as an alternative system zanarini et al 2019 challenged different optical technologies for the same model updating procedure to investigate the effect of the measuring system typology on the uncertainty of the references for the updating li et al 2019 investigated the flow characteristics of a horizontal axis wind turbine hawt rotor surface during rotation with wind tunnel experiments they measured the effect of ldv system on the power coefficient of hawt zhao et al 2018 proposed a method of gaining the vibration time domain signal of a beam using laser doppler principle and random excitation they demonstrated that the method was expected to be used as an online assessment instrument for beam defects in service state and pang et al 2020 presented the potential application of non destructive non contact remote strain sensing technique based on laser speckle imaging system to investigate the deformation around fastener holes in this study a numerical model updating approach is proposed considering parametric and structural uncertainties on a controlled complex structural system the method is applied on a three dimensional offshore jacket platform model including an attached tlcgd damping system for the first time in offshore structural field the experiment is performed using a shake table test and non contact ldv device and utilizing a scaled hydro elastic physical model the proposed updating approach is carried out based on sixteen updating scenarios in which the parametric uncertainty reduction is performed by calibrating different structural parameters the structural uncertainty is also reduced by employing model form error parameters as mathematical functions based on the results the discrepancy between the numerical and experimental data can be decreased significantly using non contact data the results also indicate that calibration of the damping matrix has a vital role in updating the numerical model of the uncontrolled system also the gas pressure and the total liquid column length of the tlcgd system have key roles in updating the passive controlled system the developed methodology is recommended to be applied on the numerical model updating process of passive controlled structural systems based on the results employing a non contact technology such as ldv system is also highly recommended in practical cases due to its high sensitivity capabilities and no direct contact requirements 2 theoretical background 2 1 uncertainty analysis uncertainties are induced by various factors in experimental and numerical modeling in all engineering fields and their identification is of great importance to have an accurate numerical model uncertainty must be mathematically understood in both the experimental data and the behavior prediction a mathematical relation can be defined between the input parameters and output responses as follows 1 y s i m m x θ where x θ are the input parameters of the numerical model y s i m is the output response of the numerical modeling x indicates a subset of the model input parameters that define the domain of applicability hokmabady et al 2019c the variable θ is the calibration variable and has considerable impact on the output responses there is also a mathematical relation between the response of the actual prototype and the experimental data as follows 2 y o b s x i ξ x i ε x i i 1 n where ξ x i ε x i and n are the response of the real physical system the experimental error and number of experimental tests respectively the numerical modeling and the experimental test can be defined in an equation considering model form error ψ x i kennedy and o hagan 2001 3 y o b s x i y s i m x i θ ψ x i ε x i i 1 n on the other hand the true response of the actual prototype is possible theoretically employing a summation of computer modeling model form error and the experimental error imprecision in definition of model parameters parametric uncertainty requires calibration of the uncertain parameters of the model inside an iterative procedure in this study the calibration parameters of the jacket are specified as members modulus of elasticity e shear modulus g and mass density md and the calibration parameters of the damper are defined as fluid density ρ cross section of the liquid column a d total liquid column length l t gas pressure p 0 and head loss coefficient δ d also to consider the damping matrix as a part of calibration parameters two non physical coefficients β and γ are specified inexactness in numerical modeling structural uncertainty is resolved by defining a model form error known as discrepancy model in the calculation process the main purpose of the model form error is to reduce the disagreement between the numerical and experimental data by substituting the discrepancy model in eq 3 the following formulation is obtained 4 y o b s x i y s i m x i θ δ x i α ε x i i 1 n where δ and α represent the discrepancy model and the non physical coefficients of the discrepancy model respectively the discrepancy model can possibly be specified as any continuous and differentiable function in this manuscript four mathematical functions are defined for the discrepancy models to find the most efficient function in reducing the difference between the experimental and numerical model 5 δ 1 x α α 0 e x α 1 α 2 6 δ 2 x α α 0 sin α 1 x α 2 α 4 cos α 5 x α 6 7 δ 3 x α α 0 x 4 α 1 x 3 α 2 x 2 α 3 x α 4 8 δ 4 x α α 0 e α 0 sin α 1 x α 2 α 4 cos α 5 x α 6 the mathematical model form error functions are defined as continuous and differentiable functions any forms of continuous and differentiable functions their combinations or other polynomial forms such as legendre or bessel polynomials and trigonometric functions such as sine or cosine functions can be specified kennedy and o hagan 2001 the functions of the study are chosen based on three concepts i basics of the experimental force which is considered as white noise δ 2 ii previously mentioned fundamental which is possibility of selecting any continuous and differentiable functions δ 1 and δ 3 iii a combination form of the first and the second concepts however the coefficients of the functions should also be trained according to the available experimental data set to have an accurate optimization and model updating process the numerical model members are divided into ten distinct groups as presented in fig 1 more details about the members division are listed in table 1 to treat both structural and parametric uncertainties simultaneously specifying an objective function and an optimization algorithm is required in this regard an objective function as sum of squared errors sse is defined as follows 9 f α θ i 1 n y o b s x i y s i m x i θ δ x i α 2 i 1 n where f α θ is the objective function with inputs of α and θ the objective function includes parameter uncertainty and structural uncertainty model form error into the training process at the same time to minimize the objective function employing an optimization algorithm is vital for this purpose in this study particle swarm optimization pso algorithm is utilized pso is a population based method that inspired from the behavior information exchange of the birds in a swarm eberhart and kennedy 1995 the optimization procedure is defined as a controlled loop between matlab and frame3dd the details of which are discussed in the following section 2 2 fe modeling and parameters definition the numerical modeling of the jacket platform equipped with a tlcgd damping system is performed using the mass and stiffness matrices in accordance with the matrix equation of the motion as follows hokmabady et al 2019 10 m u c u k u f ρ a b d v ρ a d l t u 11 ρ a l t d v 1 2 ρ a d δ d v v 2 ρ a d g v 2 k d v ρ a d b u where m and k are mass stiffness matrices gained using the frame3dd software which is free open source software for static and dynamic structural analysis of 2d and 3d frames and trusses with elastic and geometric stiffness henri and gavin 2010 the matrices are obtained as two 228 228 matrices the jacket is also defined with 38 nodes and total 109 members within the frame3dd input file parameters u f δ d l t a d and ρ are displacement vector of the jacket platform the force vector the displacement vector of damper liquid the head loss coefficient the total length of damper liquid column the cross section of damper liquid column and the liquid density respectively the gas spring stiffness k d is nonlinear and for small liquid displacement the linearized air spring stiffness can be given as γ a d 2 p 0 v 0 in which γ 1 4 p 0 and v 0 are the index of polytropic the initial pressure and volume of the gas spring in each vertical columns of the system respectively chatterjee and chakraborty 2014 more details about designing the damping system can be find in mousavi et al 2012 chatterjee and chakraborty 2014 hochrainer and fotiu 2018 and hokmabady et al 2019a b the term c is defined as the damping matrix the coefficient of which are considered as one of calibration parameters in this study the matrix is specified as combination of mass and stiffness matrices based on rayleigh s technique the coefficients of the damping matrix are defined with the same size of the mass and stiffness matrices including 12 12 submatrices with 144 elements in this study the objective function is minimized through the optimization process employing the newmark beta nb method chopra 1995 more details about the process of the numerical model updating are presented in table 2 the initial value of unknown calibration parameters including upper and lower bound values for both the jacket and the damper are listed in tables 3 and 4 respectively the same units of frame3dd input file are considered for the values of table 3 the final objective function considering all calibration parameters can be rewritten based on eq 9 as follows 12 f i 1 n u o b s t i u s i m t i e 1 e 10 g 1 g 10 m d 1 m d 10 β 1 β 144 γ 1 γ 144 ρ a d l t p 0 δ d δ t i α 0 α 1 α 2 α 3 α 4 α 5 α 6 2 i 1 n 3 experimental procedures and equipment the experimental test is implemented in modal analysis laboratory of university of tabriz using a scaled hydro elastic model of an offshore jacket platform the specifications of the scaled model which is built based on the real prototype technical drawings are listed in table 5 to model the experimental tlcgd system a numerical model is designed for the actual prototype structure according to the mass ratio of one and appropriate scale factors are applied to achieve the final empirical model see fig 2 to pump the air inside the damper two inflation valves are placed at both ends of the vertical columns the specification of the designed model is listed in table 6 the tlcgd system is prepared based on initial design values of a passive system which is chosen according to the first natural frequency of the jacket the test is carried out employing a shake table and ldv sensing components ldv is well established as a fast efficient and cost effective means of measuring and analyzing the structure s vibration which works without surface contact more details of the apparatuses and the experimental model are presented in fig 3 and table 7 to perform the experimental test the physical model is fixed on the shake table in x direction of the jacket for velocity measurement see fig 4 the optical unit of the ldv is placed and adjusted on a tripod in a way that the measuring beam is centered in the middle of the jacket deck as shown in fig 3c the analogue velocity output calibration can be checked employing an appropriate accelerometer in association with a charge amplifier or a standard hand held calibrator in this research a calibration exciter type 4294 made by brüel kjær engineering company is utilized see fig 3d since the loading effect of an accelerometer can change the dynamic response of a vibrating structure the best procedure is to compare the accelerometer output with the optical unit velocity output obtained with the measuring beam centered on the top surface of the accelerometer the calibration procedure is performed based on the optical unit user manual a random vibration signal is applied on the scaled model in a frequency range of 1 50 hz with duration of 20 s the test is repeated 3 times to avoid any unintentional errors the experimental measurement is used to both validate and update the numerical data more details of which are presented in the following section 4 results and discussion in this manuscript the numerical fe model of a passive controlled offshore jacket type platform is updated using ldv based experimental data for this purpose shake table equipment and ldv components are employed for measuring the physical model velocity the velocity time history of the experimental and numerical models is presented in full time span and limited time span for more clarification in fig 5 to validate the numerical results based on the experimental data rmse index is employed the rmse value is gained as 0 52 for the whole time span of the velocity time history data which involves almost 10000 data points based on considerable number of data points the obtained value of rmse can be specified as an acceptable value to validate the numerical results however due to the presence of the significant discrepancy between the results the fe model cannot be used as an accurate fe model in both contact and non contact tests for further investigation which indicates the necessity of model updating to compare the numerical and experimental model results the numerical fe model is simulated using the same experimental force captured by an accelerometer placed on the base level of the scaled jacket model in this study numerical model updating is performed by defining sixteen different scenarios as listed in table 8 the first three scenarios are specified as model updating with considering the jacket calibration parameters in scenarios four to seven all discrepancy functions are specified along with the jacket calibration parameters in scenarios eight to twelve both jacket and damper calibration parameters are defined without presence of discrepancy functions in scenarios number thirteen to sixteen the model form error functions are also considered to evaluate the performance of employing both parametric and structural uncertainties simultaneously in updating a sophisticated structural controlled system the optimization process is repeated by 50 runs each with swarm size of 30 through 150 iterations for each scenario to optimize the objective function eq 12 a controlled loop between matlab and frame3dd is defined aside from ensuring the calibration parameters convergence to their true values it must be certified that the trained discrepancy model indicates a true representation of model incompleteness to assess the calibration procedure the velocity time history is just presented for a limited time span 1 4 s in all scenarios the velocity time history of the first three defined scenarios are illustrated in fig 6 although in the first scenario the fe model is poorly updated in comparison to the base numerical model in the second and the third scenarios the numerical model is better fit to the experimental data to assess the efficiency of the methodology a data fitness index well known as the mean squared error mse is used to compare the full velocity time history of the first three scenarios with the experiment see table 9 obviously the discrepancy between the experimental and numerical data is reduced almost 0 3 percent as the first scenario is specified however by employing the second and the third scenarios the discrepancy is decreased almost 6 3 and 27 3 percent respectively in fact the highest fitness among the first three scenarios which include only the jacket calibration parameters occurred as the damping matrix coefficients are updated indeed the highest reduction of the discrepancy in the third scenario indicates not only the importance of the damping coefficients updating but also the necessity of updating the damping coefficients matrix instead of a portion which is highly recommended in model updating scenarios the results of the mse index for the fourth to seventh scenarios are listed in table 10 according to table 11 the discrepancy between the results is reduced almost 61 64 55 and 57 percent for the fourth to seventh scenarios which indicate the efficiency of the second discrepancy function sinus based function however this might be because of the sine nature of the velocity time history the agreement is not only on the whole performance but also is on some peak points which shows the capability of the employed function the results of the mse index for the mentioned scenarios are listed in table 11 as it is expected by ignoring the model form error functions in updating scenarios the discrepancy is increased almost significantly however as the damper calibration parameters are included the discrepancy is reduced again the highest decrement 66 percent is occurred as the most important parameters of the damper gas pressure and the total liquid column length are taken into account in the tenth scenario also more decrement is observed in the eleventh and twelfth scenarios 74 and 75 percent the reduction is not as significant as the efficiency of the tenth scenario the results of the mse index for the mentioned scenarios are listed in table 12 as stated in table 12 adding model form error is highly effective in reducing the discrepancy between the numerical and the experimental results of a passive controlled system the value of mse is decreased by almost 70 percent as the first discrepancy function is taken into account the decrement in mse is about 83 70 and 85 percent for the second third and the fourth functions respectively obviously the highest decrement among scenarios thirteen to fourteen is occurred as the second and the fourth model form eror functions are taken into account in fact this might be due to the sine nature of these functions which is so similar to the nature of the experimental force although it is possible to select any kind of mathematical function for the discrepancy function the results indicate the importance of choosing a mathematical function with the same nature of the experimental data for both uncontrolled and controlled systems the performance of the whole scenarios is presented in fig 7 based on fig 7 by considering the only jacket calibration parameters in scenarios one to three the discrepancy between the analytical and the experimental results is decreased almost 27 percent however the decrement is significantly higher as the discrepancy function is specified by the jacket calibration parameters simultaneously in the fourth to seventh scenarios with the highest reduction in fifth one as the jacket calibration parameters and only one of the damper calibration parameters are defined without any discrepancy functions the difference between the results is increased by almost 30 percent in the eighth scenario by adding more calibration parameters of the damper in the ninth to twelfth scenarios the discrepancy between the results are decreased gradually the highest reduction is obtained as the most important parameters of the damper l t p 0 are included although adding discrepancy functions results in more decrement the significant reductions are gained using the second δ 2 and the fourth δ 4 functions the performance of the discrepancy mathematical functions which is defined in scenarios fourth to seventh the effectiveness of the damper calibration parameters which is assessed through scenarios eighth to twelfth and the performance of the discrepancy functions along with the jacket and the damper calibration parameters presented in scenarios thirteenth to sixteenth are illustrated in figs 8 10 in appendix 1 for more information respectively 5 conclusions in this manuscript a numerical model updating method is introduced for uncertainty analysis of a controlled complex structural system in this method updating a three dimensional offshore jacket platform model including an attached passive tuned liquid column gas damper system is considered for the first time the experiment is implemented using a shake table test a non contact ldv device and a scaled hydro elastic physical model of three dimensional fixed offshore jacket platform the proposed updating approach is carried out using sixteen updating scenarios in which the parametric uncertainty reduction is handled by calibrating different jacket and damper parameters for this purpose the jacket platform members are separated into ten and the damper parameters are categorized into five groups each optimized distinctly using pso algorithm the structural uncertainty is also reduced by employing a model form error parameter using four various mathematical functions the damping matrix is also updated by employing the updated mass and stiffness matrices and optimizing two damping coefficient matrices the results and limitation of the study can be summarized as follows the numerical model of the investigated offshore platform is updated successfully using non contact measurements and similar to the uncontrolled system the results imply that calibration of the damping matrix plays a key role in updating the numerical model of the controlled system the maximum fitness among the first three scenarios occurred as the damping matrix coefficients are updated which indicates not only the importance of updating the damping coefficients but also the essentialness of considering the coefficients as a matrix instead of a scaler parameter according to the results within the eighth to twelfth scenarios the highest decrement is occurred as the most important parameters of the damper gas pressure and the total liquid column length are taken into account basically as the second and the fourth functions are used for the discrepancy reduction the maximum decrement occurs that might be because of the sine nature of the functions which is so similar to the nature of the experimental outcomes although it is possible to select any kind of mathematical functions for the model form error choosing a function with the same nature of the experiment records are significantly recommended for both uncontrolled and controlled systems based on the results employing a non contact sensing technology such as ldv system is strongly recommended in practical cases due to its great sensitivity capabilities and no direct contact requirements the developed methodology is recommended to be applied for the numerical model updating process of the controlled structural systems based on an accurate fe model the introduced method is not only extremely efficient but also beneficial for the old controlled realistic complex systems that increasing their life time span is vital the authors have attempted to prepare the method based on a schedule that can establish an effective technique with less sensitivity to various uncertainties and intended to introduce the suggested method with emphasizing the problem of uncertainties and subsequently to find the solutions for conquer the parts of the practical problems as much as possible obviously during the jacket s real operational conditions in view of the aspects arising from marine environmental conditions there would be numerous sources of uncertainties and difficulties that can influence the accuracy of the methods which employ the dynamical concepts for offshore structural updating therefore the sketch of the present method would be experience the effects of the predicted or unforeseen uncertainties which may be significant and have not considered certainly it was difficult and almost impossible to investigate all the various aspects only in this study other practical problems have been remaining unsolved and they must be considered as the topics of the futures researches and the method must be improved by treating of them during the furthering studies credit authorship contribution statement hamid hokmabady conceptualization investigation software validation data curation formal analysis methodology visualization writing original draft writing review editing alireza mojtahedi supervision conceptualization resources funding acquisition project administration declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests this research is supported by a research grant of the university of tabriz number 2749 acknowledgement this research is supported by a research grant of the university of tabriz number 2749 appendix 1 the performance of scenarios four to sixteen in updating the time history response of the system are presented in figs 8 10 respectively 
21258,this paper introduces a new design for the control of the unconstrained attitude of an underwater mobile robot dedicated to exploration of karstic environment the approach followed in this study considers a quaternion formalism and proposes a dynamic control design that copes with the classic two steps lyapunov and backstepping design that remains within the quaternion formalism hence the control expression considers quaternion expressions without as classically done in literature requiring the decomposition of the quaternion into vectors and angle which heavies the control expression and may introduce singularities this control is then experimented on the cube robot showing the performance of the method graphical abstract image 1 keywords attitude control quaternion karstic robotic exploration 1 introduction 1 1 applicative context this study takes part in the research initiative rek robots for karst exploration dedicated to the development of robotic systems to explore karstic environments karst generally denotes networks of underground natural conduits resulting from the dissolution of soluble rocks limestone dolomite and gypsum that drain groundwater on a large scale cf fig 1 a karst aquifers already supply drinking water to millions of people worldwide and are still considered as a potential gigantic reservoir of renewable fresh water if a deeper investigation would provide a precise characterisation location geomorphology and dynamics this is a key step towards an active groundwater management enabling deep drilling seasonal management and also allowing reliable prediction of dramatic sudden floods which may occur in karstic regions this is a major and urgent issue for public authorities involved in prospection protection and management of the groundwater resource and hydrogeologic risk prevention assessing the geometry of flow paths network in karst which drives the dynamics of groundwater and transport processes is an ambitious scientific objective that requires in situ information which may be difficult to acquire cave divers are heroic but face obvious physiological limitations the use of an autonomous robotic solution in this context will induce a significant breakthrough in its capacity to go further and deeper in the karst maze and acquire objective and dense information on this environment this objective raises many scientific challenges among them the one addressed in this paper is related to the control of the system s attitude the chaotic nature of karstic environment implies an unconstrained system manoeuvrability since the system has to be compact and able navigate in any direction including vertical cf fig 1 b 1 2 control structure in the following we adopt the ngc a navigation guidance control actuation system fig 2 structure where the design process is fourfold design a navigation system to provide a reliable estimation of system and target states denoted η ˆ in fig 2 which is not under the scope of this study in this paper we assume that an inertial measurement unit imu provides the necessary measurements to estimate the current value of the attitude state the current orientation quaternion and the body frame rotational velocities design a guidance strategy to the objective this step does not explicitly consider system dynamics apart actuation properties nonholonomy underactuation indeed the guidance strategy has to produce an achievable reference denoted w c in fig 2 to be tracked by the control system the third step consists in the explicit consideration of system s dynamic model with a backstepping approach krstic et al 1995 in order to insure the tracking of the guidance reference it outputs a desired effort expressed in the body frame denoted f b d in fig 2 at this stage the effect of the uncertainties of model parameters on the convergence guarantee can be explicitly tackled this question will not be treated in this paper the last step considers the system s actuators in order to produce previous actuation demand denoted c m in fig 2 the actuators structural configuration affords the system with different under iso over actuation property which has to be explicitly considered during the guidance design the over actuation property case of our demonstrator induces interesting redundancy management and robustness property ropars et al 2018 1 3 control of the unconstrained attitude recent applications in the field of underwater robotics require an unconstrained attainability of the attitude from hull inspection vaganay et al 2006 to localised environmental observation or karstic flooded galleries well exploration stone 2007 this of course implies that the system is equipped with enough actuators to afford the system with a full maneuverability and also to choose a formalism to describe the attitude the 3 rotations without restriction nor singularity three main formalisms are used to address the question of attitude control of unconstrained 6 degrees of freedom dof systems as uav asc auv or rov euler angles i e roll pitch and yaw provides a meaningful interpretation of system s attitude largely used in naval engineering but this formalism suffers from nonlinearities and inconvenient singularities for control design process for small variation of pitch and roll angles around zero it is possible to design attitude control using euler angles zheping et al 2019 or rodrigues angles jolla 1999 dai 2006 these approaches assume a decoupling between horizontal and vertical plane which is valid for a large number of applications where the mobile robot is asked to perform slow and near horizontal trajectories three dimension rotation matrices of s o 3 can also be used for control design wang et al 2019 and requires the manipulation of three dimension skew symmetric matrice of the lie algebra s o 3 this formalism is singular free quaternion formalism is singular free and allows for describing any 3d attitude of a rigid body as a 1 4 vector with a unity norm constraint attitude control using quaternion has been initially addressed for satellite control liu and yang 2019 egeland and godhavn 1994 and minh duc hua et al 2013 these systems requiring an unconstrained attainability of the 3d orientation space application to underwater systems has been more recently addressed in lekkas and fossen 2016 rodriguez et al 2020 and xiangke and changbin 2010 it has to be noted that any of these formalisms are subject to the unwinding phenomenon bhat and bernstein 2000 that prevents to design a globally uniform asymptotic convergent continuous control for stabilizing the rotational motion of a rigid body the effects of this unwinding phenomenon will be shown with the control proposed in this paper in the sequel an interesting point that differentiates the previous solutions using quaternion formalism is the way which error function is computed indeed the control design requires the expression of an error function from which convergence to zero will be provided by the control two options are reported in the literature attitude quaternion are normalized 4d vectors and error function can be expressed as the difference between two vectors current and desired quaternions rodriguez et al 2020 this approach allows for a direct application of lyapunov based design the problem is that this vector difference is no more a normalized quaternion and results after derivation in a control expression which do not cope with the quaternion formalism note that a final arbitrary normalisation of the vectorial error function allows to avoid a drifting effect of this approximation in the control computation but prevents the building of a rigorous proof of convergence the quaternion difference denoted q e in 2 remains on the unitary sphere as done in fresk and nikolakopoulos 2013 guerrero castellanos et al 2011 jorgensen and gravdahl 2011 and kim and woolsey 2007 i e is still a rotation quaternion this choice as the function error generally implies a decomposition of the quaternion into meaningful elements as an angle α e around a unitary 3d vector n e the control is then expressed using these error variables and convergence is proven in dapeng et al 2007 for a station keeping control objective and illustrated for tracking these approaches result in complicate control expression which does not remain within the quaternion formalism we are interested here in applying the classic lyapunov based dynamic control design within the quaternion formalism without requiring α n decomposition the work of kristiansen et al 2009 reports a similar approach applied to satellite control but is applied to stabilisation constant reference in the sequel we propose a formally proven tracking solution resulting in a compact and simple control expression coping with a classic backstepping process for dynamics extension this solution is then applied to the dynamic model of an underwater system auv cube and a solution for actuators allocation is proposed concluding the control design process then this solution is experimented on one of the lirmm s auv the cube robot cf fig 4 please note that this paper focuses on attitude control only position or longitudinal velocity control is of course also required but do not present any difficulty since the system is omni directional in fact the relevant question about position control is more related to the sensors question how to obtain an accurate position or longitudinal velocity estimation in this confined karstic environment this question is presently studied and is not addressed in this paper 1 4 paper contribution the contribution of this work is threefold design a dynamic control law in the quaternion space with classic lyapunov based and backstepping design whose expression is compact and remains in quaternion formalism the interest is that this design techniques will allow for extending solutions for classic control problems path following path tracking robust control obstacle avoidance to the quaternion formalism expose the complete attitude control chain from control design to the computation of actuators input for a new underwater redundant vehicle the cube auv note that as detailed in section 6 1 the dynamic model of the cube system has not been identified yet hence we will consider the trivial and false dynamic model of equation 28 also note that the control in translation is not exposed in this paper since it does not present any originality address these question under the scope of a new ambitious applicative context karstic exploration with robots 1 5 paper organisation after some preliminaries and the definition of the notation used in the sequel section 2 the paper is organised as follows section 3 proposes the design of a kinematic guidance law which respects the quaternion formalism and the system actuation capabilities fully actuated in our case section 4 considers the system dynamics in order to design a control expression that tracks the previously designed guidance reference section 5 is related to the consideration of the actuation system in order to compute actuation inputs finally section 6 proposes some simulation and experimental results to show the performances of the solution proposed 2 preliminaries and notation in the sequel we will use the following quaternion definition a quaternion q denotes the attitude of a body frame b w r t a reference frame i as a rotation of angle α around a normalized vector n whose coordinates are expressed w r t i as illustrated at fig 3 fig 3 also denotes the body frame velocities classically written v u v w t and w p q r t for linear and rotational velocities expressed in the body frame b where x t denotes the transpose of vector x γ γ u γ v γ w t denotes the resulting torques w r t b provided by the actuation system euler angles φ θ ψ are illustrative and will not be used in the sequel quaternion q is expressed as the 4 1 dimension vector 1 q cos α 2 sin α 2 n t t the current error between q and q d is expressed as 2 q e q q d where q designs the conjugate of q and is the quaternion product two other important relations link the quaternion derivative with the associated angular velocities expressed in the reference frame w 2 q q where w is the imaginary quaternion expression of vector w p q r t designing the angular velocities expressed in the body frame w 0 w t t we introduce the matrix q v that expresses the relation between a 3 1 vector x to its associated imaginary 4 1 quaternion x such that x q v x 0 x t t and x q v t x where 3 q v 0 0 0 1 0 0 0 1 0 0 0 1 we also introduce the following matrix q q 4 q q 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 where if x x 1 x 2 x 3 x 4 t is any quaternion then q q x 0 x 2 x 3 x 4 t note that if y 0 y 2 y 3 y 4 t is any imaginary quaternion then y q q y also note that q v q v t q q and q v t q v i 3 where i 3 stands for the 3 3 identity matrix another necessary expression initially introduced in markley 2003 expresses the velocity of the error quaternion as 5 q e 1 2 w q e q e w d finally in the sequel as 1 q 1 0 0 0 t denotes the identity quaternion 0 q 0 0 0 0 t denotes the null quaternion 3 guidance design the design of the kinematic guidance reference is a control objective that drives the current orientation of a frame b denoted with the quaternion q to a desired attitude q d while tracking the evolution of the reference q d at this stage the considered system can be expressed as the derivation relation of a normalized quaternion q as 6 q 1 2 q w where according to the general expression x f x u q denotes the state vector and w the input the kinematic guidance reference will be the result of the following control problem guidance problem consider system 6 and find an expression for w that asymptotically and uniformly drives q to q d rewriting 5 gives us a candidate for the structure of w as 7 w q e w d q e w e where w d 2 q d q d and as justified in the sequel w e k q ˆ e consider now the following lyapunov function candidate originally introduced by mahony et al 2008 on so 3 8 v 1 2 1 q q e t 1 q q e direct derivation yields 9 v q e t 1 q q e q e t 1 q q e t q e 0 where q e t q e 0 since vectors q e and q e are perpendicular hence considering the kinematic differential equation of the error quaternion q e 1 2 w e q e the simple choice 10 w e k 0 sin α e 2 n e t t k q q q e k q ˆ e yields 11 v k 2 q ˆ e q e t 1 q k 2 sin 2 α e 0 for any arbitrary positive gain k and where α e is the rotation angle of q e around vector n e as generally expressed at equation 1 note that control expression 10 can be directly computed using q e without explicitly computing α e and n e in 10 q ˆ e q q q e is simply q e where its first component has been nullified we are now ready to state our second proposition proposition 1 consider the system 6 and references q d and q d the following control expression 12 w q e w d q e k q ˆ e where q e denotes the quaternion error cf equation 2 and where q ˆ e is q e where first component has been nullified uniformly and asymptotically drives q to q d and tracks q d hence solving the guidance problem proofof proposition 1 consider the lyapunov function candidate expressed in 8 the choice of the control expression 12 yields to the tracking error expression 10 considering 7 and equivalently implies that v 0 as expressed in equation 11 note that v is easily computable and is bounded hence we can now invoke the barbalat s lemma as done in lapierre and soetanto 2007 to prove the asymptotic and uniform convergence of v to 0 hence proving the asymptotic and uniform convergence of α e to 0 as well for q e to 1 q since q e is normalized moreover considering now the control expression 12 it is clear that since q ˆ e asymptotically and uniformly vanishes to 0 q then w asymptotically tracks w d not that as stated in bhat and bernstein 2000 the globality of the convergence cannot be achieved since the system s trajectories evolve on a vector bundle over s o 3 which is compact irrespective to r 3 which is the state space when translations are considered and where the globality of the convergence is proven with the argument that v a kinematic velocity control w p q r t is extracted from w as w q v w 4 control design the previous guidance design process resulted in the expression of a desired velocity profile which if tracked by a physical system will ensures a global uniform and asymptotic convergence of system s attitude to its target the sequel exposes a backstepping design to consider system s dynamic model in order to provide the expression for the desired forces and torques expressed in the body frame that the actuation system has to produce in order to follow its reference consider now a physical system asked to track a desired orientation reference in terms of q d and q d with rotational dynamic model 13 γ j w f w v η where j is the invertible inertia matrix f w v η includes damping cross velocity terms and potential effects weight and buoyancy and where w p q r t and v u v w t denote the velocities angular and linear resp of b w r t i expressed in b and γ γ u γ v γ w t denotes the 3 torques expressed in b resulting from actuation hence the control problem is expressed as control problem consider system 13 and find an expression for γ that asymptotically and uniformly drives q to q d and q to q d consider the following lyapunov function candidate 14 v 2 k 1 2 1 q q e t 1 q q e 1 2 w c w t w c w where k 1 is a positive gain and as classically done in backstepping procedure the reference w c is chosen as the previous kinematic solution 15 w c q e w d q e k 2 q ˆ e where k 2 is an arbitrary positive gain direct derivation of 14 yields 16 v 2 k 1 q e 1 w c w t w c w where q e 1 denotes the first component of q e consider now the expression of system s dynamics expressed at equation 13 in 16 17 v 2 k 1 q e 1 w c q v j 1 γ f w v η t w c w hence the choice 18 γ j w r f w v η where 19 w r q v t w c k 2 w c w k 3 q ˆ e implies 20 v 2 k 1 q e 1 k 2 w c w t w c w k 3 q ˆ e t w c w since w w c q ˆ e are imaginary quaternions considering 15 yields 21 v 2 k 1 q e 1 k 2 w c w t w c w k 3 k 2 q ˆ e t q ˆ e k 3 q ˆ e t q e w d q e w since w is an imaginary quaternion then w w consider now the following expression for 5 22 q e w d q e w 2 q e q e tedious but direct computation shows that q ˆ e t q e q e α e 2 sin α e 2 q e 1 hence without loss of generality let for k 3 k 1 2 23 v 2 k 2 w c w t w c w k 3 q ˆ e t q ˆ e which is strictly negative if any component of q ˆ e is non null hence q ˆ e asymptotically and uniformly converges to 0 q inducing similar convergence of q e to 1 q since q e is normalized proposition 2 consider system 13 and references q d q d and q d then control expression 18 uniformly and asymptotically drives q to q d q to q d and tracks q d hence solving the control problem the proof is similar to previous one and is omitted 5 actuation system the role of the actuation system is to provide a reliable physical realisation of 18 resulting from actuators effects if the system has more actuators than degrees of freedom case of our cube system equipped with 8 thrusters as shown at fig 4 b it is considered to have a redundant actuation system and redundancy management can be done during the control allocation process note that this study is dedicated to the control of the attitude of the robot which involves 3 degrees of freedom without consideration for the other longitudinal degrees of freedom hence our problem involves 8 thrusters to control 3 degrees of freedom resulting is a highly redundant actuation system this question has been tackled in ropars et al 2018 where the advantages of a redundant actuation system have been stated and experimented the theoretical statement of this question is illustrated in the sequel but not exploited here two relations are characterizing the actuation model the configuration matrix c and the dispatcher d 5 1 configuration matrix the configuration matrix c expresses the body frame resulting action of actuators as classically done for underwater robots we neglect the thrusters torque generated around the axis of the propeller hence given the location of origin and direction the force f i w r t b cf fig 4 generated by each actuators i by vector d i and its orientation w r t b with quaternion q i the resulting action of n actuators is written as 24 γ i 1 n d i f i 0 0 t where denotes the vectorial product hence 24 can be written in a compact form with 25 γ c f m where f m f 1 f 2 f n t denote the individual action of the n actuators and c is a 3 n configuration matrix expressing the resulting action of n actuators in the body frame b 5 2 the dispatcher previous relation needs to be inverted in order to compute the actuator inputs according to the control demand γ d of equation 18 here one can exploit redundancy as done in ropars et al 2018 where it is shown that a satisfying candidate for the inversion of 25 is 26 f m c m m d γ d r m where c c t c c t 1 is the moore penrose pseudo inverse m m k e r c and r m is an arbitrarily chosen n 3 1 vector d c m m is called dispatcher matrix m m plays the role of a projector of r m in the null space of c making its contribution to the actuators input independent from the main task the use of the control 26 in system 25 implies γ γ d the actuation redundancy management is performed with a judicious choice of r m in order to minimise complementary criteria i g energy robustness to failure reactivity 6 simulations and experimentations this section proposes to illustrate the performances of the solution proposed on the cube system depicted at fig 4 a the chosen reference is identical to 30 6 1 system description consider now the system on which previous control solution will be implemented i e the fully actuated underwater system cube cf fig 4 cube is an auv with a cubic shape of 0 52 cm length equipped with 8 thrusters oriented as shown at fig 4 b a dropix embedded card carries an imu and runs the controller its actuation configuration results in the following c configuration matrix of equation 25 where actuation torque has been neglected 27 c 0 27 0 0 27 0 27 0 27 0 27 0 0 27 0 0 27 0 27 0 0 0 27 0 27 0 27 0 27 0 27 0 0 27 0 27 0 0 27 0 the dynamic model of the lab prototype cube system has not been identified this identification requires intensive experimental tests that are presently performed on the experimental robot ulysse fig 1 b hence for the cube system we use in the control computation the following trivial rotational dynamic model 28 j 1 0 0 0 1 0 0 0 1 f w v η 0 3 6 2 reference design we compute the reference as a stationary initial desired attitude q d 0 for the 10 first seconds 29 q d 0 q d 1 q d 2 q d 1 cos α 1 2 sin α 1 2 0 0 α 1 arctan 1 2 q d 2 cos α 2 2 0 sin α 2 2 0 α 2 π 4 this reference will drive the cube to vertically align two opposite corners 1 and 7 as shown at fig 5 a then after 10 s a trajectory is given to the reference as 30 q d q d 0 q d t q d t cos α t 2 sin α t 2 3 sin α t 2 3 sin α t 2 3 q d q d 0 q d t q d t α t 2 sin α t 2 cos α t 2 3 cos α t 2 3 cos α t 2 3 q d q d 0 q d t q d t α t 2 sin α t 2 cos α t 2 3 cos α t 2 3 cos α t 2 3 α t 2 4 q d t α t t 0 if t 10 0 t α t τ d τ if not α t t 0 if t 10 0 5 rad s if not α t t 0 this reference produces a rotation of α t 0 5 r a d s around vector n d t 1 3 1 1 1 t which is vertically aligned since previous transformation q d 0 the evolution of the components of q d is shown at fig 5 b 6 3 experimentations hence the application of control 26 with reference 30 and a minimal energy pseudo inverse dispatcher d c provides the results of fig 6 a and b fig 6 a indicates the evolution of actuators activity during test fig 6 b shows the convergence of the actual system s attitude q to the reference q d analysing these experimental results we can extract 2 undesired phenomena the control signal presents vibration of frequency of 0 5hz which is similar to the desired rotational velocity α t this is most likely due to an unbalance phenomenon due to the incomplete model a non negligible delay is present in the tracking of the reference this can be explained with the approximated model we chose for control computation equation 28 in order to confirm the implication of the misestimation of the dynamic model parameters on the tracking error we perform a simulation where the control is unchanged while the dynamic model of the simulated system considers a damping effect with the form f s i m w v η 2 i 3 p p q q r r t where i 3 stands for the 3 3 identity matrix it is clear that this tracking error can be a consequence of dynamic parameters misestimation other sources of imprecision can be identified a misplacement of the thrusters and or the imu a difference between individual thruster s characteristic this underline the necessity for a precise dynamic model or the design of an efficient robust control scheme this warrants further research 7 unwinding phenomenon this section enlights the effect of the unwinding phenomenon on the proposed control solution let s define the desired attitude as a quaternion expressing a rotation of angle α d t around the z axis of the universal frame 31 q d cos α d 2 0 0 sin α d 2 q d α d 2 sin α d 2 0 0 cos α d 2 q d α d 2 sin α d 2 0 0 cos α d 2 α 2 2 q d let s consider two different domains of definition for α d 32 a α d 0 2 π b α d π π fig 7 shows a simulated system s response to a constant reference where α d 0 9 2 π while the initial attitude is q 0 1 q when α d is defined according to the domain a fig 7 a and c the system rotates clockwise through large angle while the counterclockwise rotation is obviously better this counterclockwise is achieved when the domain of definition b is considered fig 7 b and d we then perform another simulation where α d a t sin k t t π where a t 0 1 and k t 1 results are shown at fig 8 figure fig 8 a and c shows the system s behaviour when domain of definition a is considered for α d clearly convergence is achieved nevertheless when domain of definition b is chosen the system does not achieve convergence this unwinding phenomenon is due to a topological obstruction to the problem of attitude control as stated in bhat and bernstein 2000 some works have addressed this question proposing an anti unwinding attitude error function as a component of a potential function avoiding problematic pointing situation hu et al 2019 or discontinuous controllers tiwari et al 2017 based on the development proposed in this paper we will tackle this question in redefining the trajectory tracking objective to a path following problem with the objective to improve the system response to this unwinding phenomenon this warrants further research 8 conclusion in this paper we propose a new compact expression for the control of the attitude of an auv based on the quaternion formalism without requiring the classic α n decomposition the approach proposed allows for applying backstepping technique within classic lyapunov design to explicitly consider system dynamics in the control expression and remains in the quaternion formalism i e does not require any arbitrary normalisation the convergence of the proposed control law is formally proven and experimentations on the auv cube illustrates the performances of the approach the unavoidable unwinding phenomenon has been illustrated with the solution proposed the interest of this control design is that it provides a framework that can cope with a large class of control problems as path following adaptive robust control obstacle avoidance the extension of the method proposed here to these problems on s o 3 is the subject of our present research indeed the applicative context karst exploration with robots requires robotics systems with a manageable reactivity and precise control of their movement with an unconstrained attainability of attitude the next step will be to include translational control strategy where difficulties occurs at the sensors level in such a confined hazardous and turbid environment this promises a lot of exiting scientific challenges which warrants further research credit authorship contribution statement lionel lapierre conceptualization methodology investigation writing original draft rene zapata conceptualization methodology data curation writing review editing pascal lepinay software validation benoit ropars software validation resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this project was supported by the labex numev anr 10 labx 0020 within the i site muse anr 16 idex 0006 and the region occitanie french feder funds the authors would also like to express their gratefull thanks to vincent deconchy for his enthusiastic and helpful comments 
21258,this paper introduces a new design for the control of the unconstrained attitude of an underwater mobile robot dedicated to exploration of karstic environment the approach followed in this study considers a quaternion formalism and proposes a dynamic control design that copes with the classic two steps lyapunov and backstepping design that remains within the quaternion formalism hence the control expression considers quaternion expressions without as classically done in literature requiring the decomposition of the quaternion into vectors and angle which heavies the control expression and may introduce singularities this control is then experimented on the cube robot showing the performance of the method graphical abstract image 1 keywords attitude control quaternion karstic robotic exploration 1 introduction 1 1 applicative context this study takes part in the research initiative rek robots for karst exploration dedicated to the development of robotic systems to explore karstic environments karst generally denotes networks of underground natural conduits resulting from the dissolution of soluble rocks limestone dolomite and gypsum that drain groundwater on a large scale cf fig 1 a karst aquifers already supply drinking water to millions of people worldwide and are still considered as a potential gigantic reservoir of renewable fresh water if a deeper investigation would provide a precise characterisation location geomorphology and dynamics this is a key step towards an active groundwater management enabling deep drilling seasonal management and also allowing reliable prediction of dramatic sudden floods which may occur in karstic regions this is a major and urgent issue for public authorities involved in prospection protection and management of the groundwater resource and hydrogeologic risk prevention assessing the geometry of flow paths network in karst which drives the dynamics of groundwater and transport processes is an ambitious scientific objective that requires in situ information which may be difficult to acquire cave divers are heroic but face obvious physiological limitations the use of an autonomous robotic solution in this context will induce a significant breakthrough in its capacity to go further and deeper in the karst maze and acquire objective and dense information on this environment this objective raises many scientific challenges among them the one addressed in this paper is related to the control of the system s attitude the chaotic nature of karstic environment implies an unconstrained system manoeuvrability since the system has to be compact and able navigate in any direction including vertical cf fig 1 b 1 2 control structure in the following we adopt the ngc a navigation guidance control actuation system fig 2 structure where the design process is fourfold design a navigation system to provide a reliable estimation of system and target states denoted η ˆ in fig 2 which is not under the scope of this study in this paper we assume that an inertial measurement unit imu provides the necessary measurements to estimate the current value of the attitude state the current orientation quaternion and the body frame rotational velocities design a guidance strategy to the objective this step does not explicitly consider system dynamics apart actuation properties nonholonomy underactuation indeed the guidance strategy has to produce an achievable reference denoted w c in fig 2 to be tracked by the control system the third step consists in the explicit consideration of system s dynamic model with a backstepping approach krstic et al 1995 in order to insure the tracking of the guidance reference it outputs a desired effort expressed in the body frame denoted f b d in fig 2 at this stage the effect of the uncertainties of model parameters on the convergence guarantee can be explicitly tackled this question will not be treated in this paper the last step considers the system s actuators in order to produce previous actuation demand denoted c m in fig 2 the actuators structural configuration affords the system with different under iso over actuation property which has to be explicitly considered during the guidance design the over actuation property case of our demonstrator induces interesting redundancy management and robustness property ropars et al 2018 1 3 control of the unconstrained attitude recent applications in the field of underwater robotics require an unconstrained attainability of the attitude from hull inspection vaganay et al 2006 to localised environmental observation or karstic flooded galleries well exploration stone 2007 this of course implies that the system is equipped with enough actuators to afford the system with a full maneuverability and also to choose a formalism to describe the attitude the 3 rotations without restriction nor singularity three main formalisms are used to address the question of attitude control of unconstrained 6 degrees of freedom dof systems as uav asc auv or rov euler angles i e roll pitch and yaw provides a meaningful interpretation of system s attitude largely used in naval engineering but this formalism suffers from nonlinearities and inconvenient singularities for control design process for small variation of pitch and roll angles around zero it is possible to design attitude control using euler angles zheping et al 2019 or rodrigues angles jolla 1999 dai 2006 these approaches assume a decoupling between horizontal and vertical plane which is valid for a large number of applications where the mobile robot is asked to perform slow and near horizontal trajectories three dimension rotation matrices of s o 3 can also be used for control design wang et al 2019 and requires the manipulation of three dimension skew symmetric matrice of the lie algebra s o 3 this formalism is singular free quaternion formalism is singular free and allows for describing any 3d attitude of a rigid body as a 1 4 vector with a unity norm constraint attitude control using quaternion has been initially addressed for satellite control liu and yang 2019 egeland and godhavn 1994 and minh duc hua et al 2013 these systems requiring an unconstrained attainability of the 3d orientation space application to underwater systems has been more recently addressed in lekkas and fossen 2016 rodriguez et al 2020 and xiangke and changbin 2010 it has to be noted that any of these formalisms are subject to the unwinding phenomenon bhat and bernstein 2000 that prevents to design a globally uniform asymptotic convergent continuous control for stabilizing the rotational motion of a rigid body the effects of this unwinding phenomenon will be shown with the control proposed in this paper in the sequel an interesting point that differentiates the previous solutions using quaternion formalism is the way which error function is computed indeed the control design requires the expression of an error function from which convergence to zero will be provided by the control two options are reported in the literature attitude quaternion are normalized 4d vectors and error function can be expressed as the difference between two vectors current and desired quaternions rodriguez et al 2020 this approach allows for a direct application of lyapunov based design the problem is that this vector difference is no more a normalized quaternion and results after derivation in a control expression which do not cope with the quaternion formalism note that a final arbitrary normalisation of the vectorial error function allows to avoid a drifting effect of this approximation in the control computation but prevents the building of a rigorous proof of convergence the quaternion difference denoted q e in 2 remains on the unitary sphere as done in fresk and nikolakopoulos 2013 guerrero castellanos et al 2011 jorgensen and gravdahl 2011 and kim and woolsey 2007 i e is still a rotation quaternion this choice as the function error generally implies a decomposition of the quaternion into meaningful elements as an angle α e around a unitary 3d vector n e the control is then expressed using these error variables and convergence is proven in dapeng et al 2007 for a station keeping control objective and illustrated for tracking these approaches result in complicate control expression which does not remain within the quaternion formalism we are interested here in applying the classic lyapunov based dynamic control design within the quaternion formalism without requiring α n decomposition the work of kristiansen et al 2009 reports a similar approach applied to satellite control but is applied to stabilisation constant reference in the sequel we propose a formally proven tracking solution resulting in a compact and simple control expression coping with a classic backstepping process for dynamics extension this solution is then applied to the dynamic model of an underwater system auv cube and a solution for actuators allocation is proposed concluding the control design process then this solution is experimented on one of the lirmm s auv the cube robot cf fig 4 please note that this paper focuses on attitude control only position or longitudinal velocity control is of course also required but do not present any difficulty since the system is omni directional in fact the relevant question about position control is more related to the sensors question how to obtain an accurate position or longitudinal velocity estimation in this confined karstic environment this question is presently studied and is not addressed in this paper 1 4 paper contribution the contribution of this work is threefold design a dynamic control law in the quaternion space with classic lyapunov based and backstepping design whose expression is compact and remains in quaternion formalism the interest is that this design techniques will allow for extending solutions for classic control problems path following path tracking robust control obstacle avoidance to the quaternion formalism expose the complete attitude control chain from control design to the computation of actuators input for a new underwater redundant vehicle the cube auv note that as detailed in section 6 1 the dynamic model of the cube system has not been identified yet hence we will consider the trivial and false dynamic model of equation 28 also note that the control in translation is not exposed in this paper since it does not present any originality address these question under the scope of a new ambitious applicative context karstic exploration with robots 1 5 paper organisation after some preliminaries and the definition of the notation used in the sequel section 2 the paper is organised as follows section 3 proposes the design of a kinematic guidance law which respects the quaternion formalism and the system actuation capabilities fully actuated in our case section 4 considers the system dynamics in order to design a control expression that tracks the previously designed guidance reference section 5 is related to the consideration of the actuation system in order to compute actuation inputs finally section 6 proposes some simulation and experimental results to show the performances of the solution proposed 2 preliminaries and notation in the sequel we will use the following quaternion definition a quaternion q denotes the attitude of a body frame b w r t a reference frame i as a rotation of angle α around a normalized vector n whose coordinates are expressed w r t i as illustrated at fig 3 fig 3 also denotes the body frame velocities classically written v u v w t and w p q r t for linear and rotational velocities expressed in the body frame b where x t denotes the transpose of vector x γ γ u γ v γ w t denotes the resulting torques w r t b provided by the actuation system euler angles φ θ ψ are illustrative and will not be used in the sequel quaternion q is expressed as the 4 1 dimension vector 1 q cos α 2 sin α 2 n t t the current error between q and q d is expressed as 2 q e q q d where q designs the conjugate of q and is the quaternion product two other important relations link the quaternion derivative with the associated angular velocities expressed in the reference frame w 2 q q where w is the imaginary quaternion expression of vector w p q r t designing the angular velocities expressed in the body frame w 0 w t t we introduce the matrix q v that expresses the relation between a 3 1 vector x to its associated imaginary 4 1 quaternion x such that x q v x 0 x t t and x q v t x where 3 q v 0 0 0 1 0 0 0 1 0 0 0 1 we also introduce the following matrix q q 4 q q 0 0 0 0 0 1 0 0 0 0 1 0 0 0 0 1 where if x x 1 x 2 x 3 x 4 t is any quaternion then q q x 0 x 2 x 3 x 4 t note that if y 0 y 2 y 3 y 4 t is any imaginary quaternion then y q q y also note that q v q v t q q and q v t q v i 3 where i 3 stands for the 3 3 identity matrix another necessary expression initially introduced in markley 2003 expresses the velocity of the error quaternion as 5 q e 1 2 w q e q e w d finally in the sequel as 1 q 1 0 0 0 t denotes the identity quaternion 0 q 0 0 0 0 t denotes the null quaternion 3 guidance design the design of the kinematic guidance reference is a control objective that drives the current orientation of a frame b denoted with the quaternion q to a desired attitude q d while tracking the evolution of the reference q d at this stage the considered system can be expressed as the derivation relation of a normalized quaternion q as 6 q 1 2 q w where according to the general expression x f x u q denotes the state vector and w the input the kinematic guidance reference will be the result of the following control problem guidance problem consider system 6 and find an expression for w that asymptotically and uniformly drives q to q d rewriting 5 gives us a candidate for the structure of w as 7 w q e w d q e w e where w d 2 q d q d and as justified in the sequel w e k q ˆ e consider now the following lyapunov function candidate originally introduced by mahony et al 2008 on so 3 8 v 1 2 1 q q e t 1 q q e direct derivation yields 9 v q e t 1 q q e q e t 1 q q e t q e 0 where q e t q e 0 since vectors q e and q e are perpendicular hence considering the kinematic differential equation of the error quaternion q e 1 2 w e q e the simple choice 10 w e k 0 sin α e 2 n e t t k q q q e k q ˆ e yields 11 v k 2 q ˆ e q e t 1 q k 2 sin 2 α e 0 for any arbitrary positive gain k and where α e is the rotation angle of q e around vector n e as generally expressed at equation 1 note that control expression 10 can be directly computed using q e without explicitly computing α e and n e in 10 q ˆ e q q q e is simply q e where its first component has been nullified we are now ready to state our second proposition proposition 1 consider the system 6 and references q d and q d the following control expression 12 w q e w d q e k q ˆ e where q e denotes the quaternion error cf equation 2 and where q ˆ e is q e where first component has been nullified uniformly and asymptotically drives q to q d and tracks q d hence solving the guidance problem proofof proposition 1 consider the lyapunov function candidate expressed in 8 the choice of the control expression 12 yields to the tracking error expression 10 considering 7 and equivalently implies that v 0 as expressed in equation 11 note that v is easily computable and is bounded hence we can now invoke the barbalat s lemma as done in lapierre and soetanto 2007 to prove the asymptotic and uniform convergence of v to 0 hence proving the asymptotic and uniform convergence of α e to 0 as well for q e to 1 q since q e is normalized moreover considering now the control expression 12 it is clear that since q ˆ e asymptotically and uniformly vanishes to 0 q then w asymptotically tracks w d not that as stated in bhat and bernstein 2000 the globality of the convergence cannot be achieved since the system s trajectories evolve on a vector bundle over s o 3 which is compact irrespective to r 3 which is the state space when translations are considered and where the globality of the convergence is proven with the argument that v a kinematic velocity control w p q r t is extracted from w as w q v w 4 control design the previous guidance design process resulted in the expression of a desired velocity profile which if tracked by a physical system will ensures a global uniform and asymptotic convergence of system s attitude to its target the sequel exposes a backstepping design to consider system s dynamic model in order to provide the expression for the desired forces and torques expressed in the body frame that the actuation system has to produce in order to follow its reference consider now a physical system asked to track a desired orientation reference in terms of q d and q d with rotational dynamic model 13 γ j w f w v η where j is the invertible inertia matrix f w v η includes damping cross velocity terms and potential effects weight and buoyancy and where w p q r t and v u v w t denote the velocities angular and linear resp of b w r t i expressed in b and γ γ u γ v γ w t denotes the 3 torques expressed in b resulting from actuation hence the control problem is expressed as control problem consider system 13 and find an expression for γ that asymptotically and uniformly drives q to q d and q to q d consider the following lyapunov function candidate 14 v 2 k 1 2 1 q q e t 1 q q e 1 2 w c w t w c w where k 1 is a positive gain and as classically done in backstepping procedure the reference w c is chosen as the previous kinematic solution 15 w c q e w d q e k 2 q ˆ e where k 2 is an arbitrary positive gain direct derivation of 14 yields 16 v 2 k 1 q e 1 w c w t w c w where q e 1 denotes the first component of q e consider now the expression of system s dynamics expressed at equation 13 in 16 17 v 2 k 1 q e 1 w c q v j 1 γ f w v η t w c w hence the choice 18 γ j w r f w v η where 19 w r q v t w c k 2 w c w k 3 q ˆ e implies 20 v 2 k 1 q e 1 k 2 w c w t w c w k 3 q ˆ e t w c w since w w c q ˆ e are imaginary quaternions considering 15 yields 21 v 2 k 1 q e 1 k 2 w c w t w c w k 3 k 2 q ˆ e t q ˆ e k 3 q ˆ e t q e w d q e w since w is an imaginary quaternion then w w consider now the following expression for 5 22 q e w d q e w 2 q e q e tedious but direct computation shows that q ˆ e t q e q e α e 2 sin α e 2 q e 1 hence without loss of generality let for k 3 k 1 2 23 v 2 k 2 w c w t w c w k 3 q ˆ e t q ˆ e which is strictly negative if any component of q ˆ e is non null hence q ˆ e asymptotically and uniformly converges to 0 q inducing similar convergence of q e to 1 q since q e is normalized proposition 2 consider system 13 and references q d q d and q d then control expression 18 uniformly and asymptotically drives q to q d q to q d and tracks q d hence solving the control problem the proof is similar to previous one and is omitted 5 actuation system the role of the actuation system is to provide a reliable physical realisation of 18 resulting from actuators effects if the system has more actuators than degrees of freedom case of our cube system equipped with 8 thrusters as shown at fig 4 b it is considered to have a redundant actuation system and redundancy management can be done during the control allocation process note that this study is dedicated to the control of the attitude of the robot which involves 3 degrees of freedom without consideration for the other longitudinal degrees of freedom hence our problem involves 8 thrusters to control 3 degrees of freedom resulting is a highly redundant actuation system this question has been tackled in ropars et al 2018 where the advantages of a redundant actuation system have been stated and experimented the theoretical statement of this question is illustrated in the sequel but not exploited here two relations are characterizing the actuation model the configuration matrix c and the dispatcher d 5 1 configuration matrix the configuration matrix c expresses the body frame resulting action of actuators as classically done for underwater robots we neglect the thrusters torque generated around the axis of the propeller hence given the location of origin and direction the force f i w r t b cf fig 4 generated by each actuators i by vector d i and its orientation w r t b with quaternion q i the resulting action of n actuators is written as 24 γ i 1 n d i f i 0 0 t where denotes the vectorial product hence 24 can be written in a compact form with 25 γ c f m where f m f 1 f 2 f n t denote the individual action of the n actuators and c is a 3 n configuration matrix expressing the resulting action of n actuators in the body frame b 5 2 the dispatcher previous relation needs to be inverted in order to compute the actuator inputs according to the control demand γ d of equation 18 here one can exploit redundancy as done in ropars et al 2018 where it is shown that a satisfying candidate for the inversion of 25 is 26 f m c m m d γ d r m where c c t c c t 1 is the moore penrose pseudo inverse m m k e r c and r m is an arbitrarily chosen n 3 1 vector d c m m is called dispatcher matrix m m plays the role of a projector of r m in the null space of c making its contribution to the actuators input independent from the main task the use of the control 26 in system 25 implies γ γ d the actuation redundancy management is performed with a judicious choice of r m in order to minimise complementary criteria i g energy robustness to failure reactivity 6 simulations and experimentations this section proposes to illustrate the performances of the solution proposed on the cube system depicted at fig 4 a the chosen reference is identical to 30 6 1 system description consider now the system on which previous control solution will be implemented i e the fully actuated underwater system cube cf fig 4 cube is an auv with a cubic shape of 0 52 cm length equipped with 8 thrusters oriented as shown at fig 4 b a dropix embedded card carries an imu and runs the controller its actuation configuration results in the following c configuration matrix of equation 25 where actuation torque has been neglected 27 c 0 27 0 0 27 0 27 0 27 0 27 0 0 27 0 0 27 0 27 0 0 0 27 0 27 0 27 0 27 0 27 0 0 27 0 27 0 0 27 0 the dynamic model of the lab prototype cube system has not been identified this identification requires intensive experimental tests that are presently performed on the experimental robot ulysse fig 1 b hence for the cube system we use in the control computation the following trivial rotational dynamic model 28 j 1 0 0 0 1 0 0 0 1 f w v η 0 3 6 2 reference design we compute the reference as a stationary initial desired attitude q d 0 for the 10 first seconds 29 q d 0 q d 1 q d 2 q d 1 cos α 1 2 sin α 1 2 0 0 α 1 arctan 1 2 q d 2 cos α 2 2 0 sin α 2 2 0 α 2 π 4 this reference will drive the cube to vertically align two opposite corners 1 and 7 as shown at fig 5 a then after 10 s a trajectory is given to the reference as 30 q d q d 0 q d t q d t cos α t 2 sin α t 2 3 sin α t 2 3 sin α t 2 3 q d q d 0 q d t q d t α t 2 sin α t 2 cos α t 2 3 cos α t 2 3 cos α t 2 3 q d q d 0 q d t q d t α t 2 sin α t 2 cos α t 2 3 cos α t 2 3 cos α t 2 3 α t 2 4 q d t α t t 0 if t 10 0 t α t τ d τ if not α t t 0 if t 10 0 5 rad s if not α t t 0 this reference produces a rotation of α t 0 5 r a d s around vector n d t 1 3 1 1 1 t which is vertically aligned since previous transformation q d 0 the evolution of the components of q d is shown at fig 5 b 6 3 experimentations hence the application of control 26 with reference 30 and a minimal energy pseudo inverse dispatcher d c provides the results of fig 6 a and b fig 6 a indicates the evolution of actuators activity during test fig 6 b shows the convergence of the actual system s attitude q to the reference q d analysing these experimental results we can extract 2 undesired phenomena the control signal presents vibration of frequency of 0 5hz which is similar to the desired rotational velocity α t this is most likely due to an unbalance phenomenon due to the incomplete model a non negligible delay is present in the tracking of the reference this can be explained with the approximated model we chose for control computation equation 28 in order to confirm the implication of the misestimation of the dynamic model parameters on the tracking error we perform a simulation where the control is unchanged while the dynamic model of the simulated system considers a damping effect with the form f s i m w v η 2 i 3 p p q q r r t where i 3 stands for the 3 3 identity matrix it is clear that this tracking error can be a consequence of dynamic parameters misestimation other sources of imprecision can be identified a misplacement of the thrusters and or the imu a difference between individual thruster s characteristic this underline the necessity for a precise dynamic model or the design of an efficient robust control scheme this warrants further research 7 unwinding phenomenon this section enlights the effect of the unwinding phenomenon on the proposed control solution let s define the desired attitude as a quaternion expressing a rotation of angle α d t around the z axis of the universal frame 31 q d cos α d 2 0 0 sin α d 2 q d α d 2 sin α d 2 0 0 cos α d 2 q d α d 2 sin α d 2 0 0 cos α d 2 α 2 2 q d let s consider two different domains of definition for α d 32 a α d 0 2 π b α d π π fig 7 shows a simulated system s response to a constant reference where α d 0 9 2 π while the initial attitude is q 0 1 q when α d is defined according to the domain a fig 7 a and c the system rotates clockwise through large angle while the counterclockwise rotation is obviously better this counterclockwise is achieved when the domain of definition b is considered fig 7 b and d we then perform another simulation where α d a t sin k t t π where a t 0 1 and k t 1 results are shown at fig 8 figure fig 8 a and c shows the system s behaviour when domain of definition a is considered for α d clearly convergence is achieved nevertheless when domain of definition b is chosen the system does not achieve convergence this unwinding phenomenon is due to a topological obstruction to the problem of attitude control as stated in bhat and bernstein 2000 some works have addressed this question proposing an anti unwinding attitude error function as a component of a potential function avoiding problematic pointing situation hu et al 2019 or discontinuous controllers tiwari et al 2017 based on the development proposed in this paper we will tackle this question in redefining the trajectory tracking objective to a path following problem with the objective to improve the system response to this unwinding phenomenon this warrants further research 8 conclusion in this paper we propose a new compact expression for the control of the attitude of an auv based on the quaternion formalism without requiring the classic α n decomposition the approach proposed allows for applying backstepping technique within classic lyapunov design to explicitly consider system dynamics in the control expression and remains in the quaternion formalism i e does not require any arbitrary normalisation the convergence of the proposed control law is formally proven and experimentations on the auv cube illustrates the performances of the approach the unavoidable unwinding phenomenon has been illustrated with the solution proposed the interest of this control design is that it provides a framework that can cope with a large class of control problems as path following adaptive robust control obstacle avoidance the extension of the method proposed here to these problems on s o 3 is the subject of our present research indeed the applicative context karst exploration with robots requires robotics systems with a manageable reactivity and precise control of their movement with an unconstrained attainability of attitude the next step will be to include translational control strategy where difficulties occurs at the sensors level in such a confined hazardous and turbid environment this promises a lot of exiting scientific challenges which warrants further research credit authorship contribution statement lionel lapierre conceptualization methodology investigation writing original draft rene zapata conceptualization methodology data curation writing review editing pascal lepinay software validation benoit ropars software validation resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this project was supported by the labex numev anr 10 labx 0020 within the i site muse anr 16 idex 0006 and the region occitanie french feder funds the authors would also like to express their gratefull thanks to vincent deconchy for his enthusiastic and helpful comments 
21259,hybrid aerial underwater vehicle is a novelty able to fly and swim which is extensively suitable for missions like water sampling observing semi submerged structure and underwater exploration etc motivated by the efficiency of fixed wing unmanned aerial vehicles uavs and underwater gliders in their own specific environments and the maneuverability of rotary wing uavs this paper presents an improved design of a multimodal hauv capable of level and vertical flight hovering and underwater glide specially to balance flight payload and weight under water an innovative configuration is proposed which includes a newly developed lightweight pneumatic buoyancy system and excludes the linear actuator commonly used for pitch control of gliders moreover motor arms can fold for better hydrodynamics all these tradeoffs demand an adequate match between the fuselage aerodynamics and propulsion property and special management of buoyancy and weight to guarantee predicted performances therefore key design principles are proposed and elaborated based on the principles a prototype named nezha iii was fabricated and tested the prototype s performance characterization in the regions of underwater flight and water air transition are presented the results demonstrate the desired performance of the prototype under different modes and notably prove its outstanding capability of diving to 50 m depth keywords unmanned aerial underwater vehicle unmanned aerial aquatic vehicle flying submarine unmanned aerial vehicle underwater glider 1 introduction conventionally missions scenarios in the ocean that supported by surface vessels incur huge expenditure in terms of the cost of time labor and other resources besides oceanographic phenomenon is highly variable and sometime unpredictable the in situ observations would fail if the vessels cannot reach the spot in time the advent of unmanned vehicles has benefited the underwater technique and changed the way the ocean is observed they provides a view of the interior ocean with higher spatial and temporal resolution davis et al 2002 based on the great development of unmanned vehicles there are increasing interests in coordinating multiple unmanned vehicles for carrying out complex missions efficiently under advanced control techniques peng et al 2020 recently researchers are even attempting the joint use of different unmanned vehicles including unmanned aerial vehicles uavs unmanned surface vehicles usvs as well as unmanned underwater vehicles uuvs for ocean monitoring researchers achieved progress in building and operating a distributed heterogeneous autonomous sensor network that combined uavs usvs and uuvs in coastal environments valdivia y alvarado et al 2011 taher et al 2016 a multi robot system was established to carry out multi domain monitoring of coral reefs shkurti et al 2012 a new project that builds a collaborative team of heterogeneous robots for obtaining a multi domain awareness on a floating structure like ship and iceberg is recently reported ross et al 2019 the heterogeneous multi robot teams benefit the ocean monitoring by providing rich data collected from air surface and underwater environments but it is not easy and inexpensive to integrating different vehicles into one system harmoniously and thus it is a great challenge to organize and control such system well lately the field of hybrid aerial underwater vehicle hauvs that enable operations in both air and water is newly emerging thanks to the hauv s capabilities of locomotion in different medium scientists can minimize the complexity of multi domain monitoring missions since data can be collected from different environment by only one platform other applications hauvs can be extensively used for includes but not limited to intelligence gathering surveillance and reconnaissance inspection search and rescue multi domain locomotion imposes a considerable challenge to the vehicle design the existing approaches to hauvs popularly consider endowing two main subsets of uavs i e fixed wing and rotary wing uavs with underwater functionality as their aerial counterpart fixed wing hauvs are outstanding for flight endurance range and cruise speed an early instance of fixed hauvs was test sub which was initially launched from a mothership aircraft and glided to the surface and dived young 2014 however it could not take off from the surface lately a single aerial rotor fixed wing hauv eagleray was tested and characterized through flight underwater cruise and repeated water air transition tests it had been experimentally proved to be fully functional in distinct medium weisler et al 2017 later a similar fixed wing hauv except for an aft water rotor being added for underwater maneuver was fabricated and it completed a full cycle of multi domain mission stewart et al 2018 to optimize the water transition profile with better hydrodynamics for the fixed wing hauvs new aquatic micro aerial vehicle aquamav designed with morphing wings was developed but the take off propulsion used a one time only use water jet thruster which denies repeated water air transition siddall et al 2018 2017 siddall and kovač 2017 in the last five years the effort in rotary wing hauvs has presented distinctive prospect in well controlled multi domain observations the first known rotary wing hauvs was proposed conceptually and modeled in 2014 drews et al 2014 recently the same team presented their first but still in production prototype with four upper aerial rotors and four lower underwater rotors da rosa et al 2018 to cross different medium seamlessly and repeatedly an hauv naviator2 was evolved from a multirotor it had four dual aerial propellers propulsions to drive the vehicle underwater and in the air maia et al 2015 2017 moreover a design that combined a ballast system with a quadrotor based flying system resulted in a different hauv loon copter whose buoyancy and attitude in the water were controlled by pumping in or out the ambient fluid alzu bi et al 2018 these rotary wing hauvs have been experimentally proved with superiority in terms of smooth controllable and repeated cross domain transitions like their aerial counterparts rotary wing hauvs are suitable for high resolution observations where high maneuverability and hovering ability are required however all these advantages are at the cost of the fixed wing hauv s endurance range and speed note that the basic structures of most present designs for hauv are closely related to that of typical uavs although these vehicles are capable of well flight and water air transition their abilities to move underwater are still limited in terms of working depth and underwater endurance which weakens their utility in the ocean among the existing uuv technology underwater gliders ugs have been proved to be the most efficient platform and already been widely used for long range deep and long term missions edwards et al 2017 inspired by the features of ugs and given the respective downsides of existing hauvs the concept of novel multimodal hauv that coordinates flight endurance speed maneuverability as well as underwater efficient locomotion and endurance for a single platform was firstly proposed in our previous work lu et al 2018 this multimodal hauv basically integrated the functionalities of ugs and tail sitter uavs a combined form of fixed wing and rotary wing uavs indicating the combined ability of underwater glide as well as vertical and level flight later a proof of concept prototype nezha was designed and experimentally tested lu et al 2019 proving the feasibility of the multimodal hauv concept in nezha s design a pneumatic buoyancy system was employed for underwater gliding nevertheless nezha was embarrassed by its limited underwater operation first it could dived no more than 5 m second precise control on gliding performance was denied third it had no turning ability underwater fourth its hydrodynamics was undesirable due to the rotor arms fifth it had a small payload capacity in this paper a brand new design of a multimodal hauv is presented then a proof of concept prototype named nezha iii was fabricated and its performance was also experimentally tested and characterized this design addresses the shortages of the current systems and improve the hauv s capability of conducting underwater missions at increased depth over longer periods as well as higher levels of autonomy this upgrade presents three innovative achievements 1 use a lightweight super high pressure pneumatic buoyance control system as a substitute for conventional buoyancy system of ugs this system is testified to enable dives to the depth of 50 m for our prototype which to our best knowledge makes the vehicle be the first one of its kind that can make such deep dive 2 make a trade off design that abandoned the translational mechanism but keep the rotational one for tuning glide of the inner movable mass commonly used in ugs to further balance the flight payload and the underwater weight due to the inability of longitudinally regulating the mass distribution for the vehicle the buoyancy pitch coupling of the vehicle is studied in depth and took full advantage of as an innovative strategy for pitch control of planar glide 3 design folding rotor arms for better hydrodynamics underwater and theoretically and practically address the consequent overturn caused by rise of the center of gravity cg during the unfolding process when the vehicle prepares to take off from the surface rest of the paper is organized as follows in section 2 the concept of the proposed multimodal hauv and the nominal maneuvers are defined while key design principles of the vehicle are elaborated in section 3 then section 4 details the fabrication of the prototype in terms of five subsystems the performance characterization of the prototype in different operation regimes are presented in section 5 finally section 6 comes to the conclusion 2 operation overview the concept of the proposed hauv temps to obtain a higher level of integration of fixed wing and rotary wing uavs as well as ugs enabling larger flight payload and deeper and longer operation under water a conceptual design is presented in fig 1 in a full cycle of operation fig 2 the vehicle is expected to perform level and vertical flight hovering surface drifting underwater glide as well as water air transition for different mission requirements to achieve that the propulsion system and other actuators of uavs and ugs are adapted accordingly for the vehicle s different operation modes 2 1 level flight being capable of level flight the vehicle can travel a far distance rapidly and efficiently in oceanic mission scenarios inspired by the mechanism of tail sitter uavs the vehicle can switch to level flight without extra tilting mechanism thus saving weight and simplifying the vehicle design zhang et al 2017 fig 3 a demonstrates the switching maneuver from vertical to level flight the rotors motor propeller combinations in different sides of the wings spin in different rates to produce a moment to pitch the vehicle forward along with the increasing speed consequently the induced lift of the fixed wings increases enough to counteract the gravity while the force against the drag is dominated by the thrust after that the thrust the lift the gravity and the drag will finally reach a new equilibrium which settles the vehicle into a stable level flight the air drag is normally much smaller than the vehicle s gravity therefore the power of rotors in a level flight is lower compared with that in a vertical flight in our previous work lu et al 2019 flight simulations were carried out to qualitatively evaluate the decrease of power consumption happened when the vehicle changed to level flight this fact of the proposed vehicle will be verified and characterized quantitatively in section 5 2 2 vertical flight and hovering the proposed vehicle also features the capabilities of vertical flight and hovering as rotary wing uavs to change from level to vertical flight the thrust of rotors on different sides of the wings differs to create a pitch moment that brings the vehicle back to vertical as shown in fig 3 b as the angle of attack aoa of the wings increases and the horizontal component of the thrust decreases the vehicle gradually slows down due to the drag after finishing the transition the vehicle flies vertically in the air and the thrust mainly acts against the gravity ensuring a new equilibrium state of vertical flight in a vertical flight the vehicle not only has sufficient thrust that allows for heavier takeoff weight but also benefits from good maneuverability like the rotary wing uavs the vertical flight maneuver highly consumes energy however some special scenarios do require a precise control and excellent maneuverability for an hauv for example a detailed monitoring in a confined environments or a close up view of feature of interest like offshore oil platform can be only satisfied by a slow flight other applications such as ocean photography and water sampling ore et al 2015 need the platform to execute a zero velocity loitering in air therefore integrating the abilities of vertical flight and hovering makes the vehicle versatile for extended applications besides the considerations above vertical flying maneuver is beneficial for the takeoff and landing on the water s surface which will be discussed in later subsections 2 3 surface drifting the vehicle can naturally drift at the sea surface in an upright position for an hauv it is useful to make itself function as a free drifting surface buoy that has been utilized for many scientific activities herbers and janssen 2016 gonzalez haro et al 2016 in addition floating on surface guarantees a good wireless communication for continuous data transfer and may support a solar charger for the vehicle in the future surface drifting requires no extra mechanism on the present system to realize fig 4 demonstrates the vehicle stabilized at the water s surface with its arms folded the pneumatic variable buoyancy system has a bladder namely the actuator responsible for stable flotation and gliding locomotion underwater mounted outside on the top to float at the surface the bladder is inflated to such a volume that the vehicle becomes positively buoyant meanwhile the rotor arms fold down to lower the cg under the center of buoyancy cb so that the vehicle could stay at a stable upright floating position 2 4 underwater glide one of the novelties of the proposed vehicle is merging the functionalities of ugs and uavs this is the first attempt to adapt the mechanism of ugs in a flyable platform and thus a try to extend the underwater endurance for hauvs the only driving force pushing a ug forward is the horizontal component of lift induced by the gliding motion due to the inequality between gravity and buoyancy without any propulsion gliding motion is quite energy efficient for the proposed vehicle a glide strategy is thus implemented solely via the pneumatic buoyancy system because the linear movable mass is abandoned for weight reduction for turning direction underwater an inner movable mass that can rotate 36 0 around the central axis is added to the vehicle rotating the movable mass will roll the vehicle to turn when the movable mass is located at the most bottom side the cg moves far off the central axis to the bottom so that the vehicle acquires enough bottom heaviness for stable gliding leonard and graver 2001 also note that six arms fold and all rotors keep idle for better hydrodynamics in a glide fig 5 demonstrates different managements of buoyancy with respects to the gravity in downward and upward glides regulating buoyancy and the cb position relative to the cg can control the gliding performance in a downward glide the vehicle becomes negative buoyant and descends as a result of the deflation of the bladder meanwhile the cb gradually shifts behind the cg as the bladder shrinks which results in a trim by the head in an upward glide the bladder is inflated with the compressed air stored inside an inner cylinder in advance the expanding bladder increases buoyancy and changes the cb position to the front of the cg then the vehicle is trimmed by the stern and ascends in both descent and ascent cases the lift of the wings enables a horizontal forward displacement of the vehicle eventually the vehicle moves forward by repeating alternating descent and ascent i e a sawtooth trajectory unlike ugs a significant characteristic of the proposed vehicle is the exclusion of the longitudinal regulation of movable mass for the purpose of maximum reduction of flight payload without losing the underwater gliding ability due to this tradeoff design the pitch motion of the vehicle is coupled with the change of buoyancy making the vehicle highly underactuated and thus harder to control when moving underwater in the next section the design principle helping address this problem is elaborated 2 5 water air transition smooth cross domain transition is the key to bridging underwater locomotion and flying vertical takeoff and landing vtol is chosen as the water air transition strategy for the following reasons first vtol permits heavier takeoff weight for small or medium hauvs their payload capacities are very limited however heavier waterproof structures and devices are almost inevitable in designing an hauv for deeper operation applying vtol is thus most likely to make successful takeoff for a heavy vehicle second wings are designed to be floodable to avoid the great extra buoyancy due to their large volume vtol maneuver helps reduce the negative effect of the water entrained in the floodable wings when exiting water and relieve the impact when entering water as the model of passively draining water indicates stewart et al 2019 the faster the egress speed is the greater the hydrodynamic force imposed on the vehicle is in another concern ingress speed and attitude must be controlled otherwise the vehicle may suffer from severe water impact or even crash in the air to water ingress young 2014 that situation might get harsher for larger and heavier platform so implementing vtol maneuver is good for the vehicle slowly crossing the water s surface under well control third vtol is naturally a part of the maneuver of vertical flight thus no extra design is needed fig 6 shows the procedures of water air transitions from underwater gliding to flying the vehicle firstly inflates the bladder to surface then the inner movable mass rotates to a specific position where the cg lies below the cb along with the central axis resulting in the body in an upright position as seen in the figure the cg will rise over the cb as the arms rise up without proper buoyancy management the couple of gravitational and buoyant forces will produce an overturning moment instead of a restoring moment thus the bladder needs to be further expanded to guarantee metacentric stability before the arms unfold this design concern is fully discussed in the following section to achieve a successful landing same procedure but in reverse order is taken the arms are folded right after the vehicle lands on the surface safely and all rotors are shut down then the movable mass is shifted to the position where the most bottom heaviness and gliding stability are met after that the vehicle is ready for underwater glide 3 design considerations the variable used in this paper are defined in table 1 as in fig 7 two reference frames i e the inertial frame and the body fixed frame are used the inertial frame is defined as conventional north east down frame while the body fixed frame is defined in front right down orientation with the origin coincident with the centroid of the fixed fuselage excludes bladder normally the lateral positions of the mass of fluid displaced by the bladder m b and the nonuniformly distributed mass m w i e y b and y w are designed to be zero for the symmetry of the rolling behavior and the passive stability of yaw motion under water in flight the propulsion system six motor propeller combinations supports different flying maneuvers as for underwater locomotion and the surface floatation the vehicle s behavior is controlled via the pneumatic buoyancy system and the rotatable mass 3 1 concern about planar glide as aforementioned the presented vehicle is more underactuated than ugs when moving underwater because it has only one actuator the bladder once the bladder s volume changes the pitch attitude and the buoyancy will vary synchronously forbidding separate controls of pitch attitude and buoyancy to obtain the intended performance of the glide in vertical plane proper weight and buoyancy managements are crucial for the design and achieved by exploiting the nature of pitch buoyancy coupling the linearized model of proposed system in a steady planar glide is obtained below as similar to that of the ug system graver 2005 1 δ q 1 j 2 m g g x g sin θ 0 z g cos θ 0 m b 0 g x b sin θ 0 z b cos θ 0 δ θ 1 j 2 m u 0 x p m w 0 z p m w u 0 x w m w w 0 z w δ q 1 j 2 m 3 m 1 w 0 k m 0 k m α 0 2 u 0 k m w 0 δ u 1 j 2 m 3 m 1 u 0 k m 0 k m α 0 2 w 0 k m u 0 δ w 1 j 2 g x b cos θ 0 z b sin θ 0 δ m b z p j 2 δ p p 1 x p j 2 δ p p 3 z w j 2 δ p w 1 x w j 2 δ p w 3 2 δ u 1 m 1 δ m b 0 m g g cos θ 0 δ θ 1 m 1 m m w m 3 w 0 δ q 1 m 1 k l 0 k l α 0 2 u 0 k l w 0 sin α 0 k l 0 k l α 0 cos α 0 w 0 k d 0 k d α 0 2 2 u 0 2 k d α 0 w 0 cos α 0 k d 0 k d α 0 2 sin α 0 w 0 δ u 1 m 1 k l 0 k l α 0 2 w 0 k l u 0 sin α 0 k l 0 k l α 0 cos α 0 u 0 k d 0 k d α 0 2 2 w 0 2 k d α 0 u 0 cos α 0 k d 0 k d α 0 2 sin α 0 u 0 δ w 1 m 1 g sin θ 0 δ m b 1 m 1 δ p p 1 1 m 1 δ p w 1 3 δ w 1 m 3 δ m b 0 m g g sin θ 0 δ θ 1 m 3 m m w m 1 u 0 δ q 1 m 3 k l 0 k l α 0 2 u 0 k l w 0 cos α 0 k l 0 k l α 0 sin α 0 w 0 k d 0 k d α 0 2 2 u 0 2 k d α 0 w 0 sin α 0 k d 0 k d α 0 2 cos α 0 w 0 δ u 1 m 3 k l 0 k l α 0 2 w 0 k l u 0 cos α 0 k l 0 k l α 0 sin α 0 u 0 k d 0 k d α 0 2 2 w 0 2 k d α 0 u 0 sin α 0 k d 0 k d α 0 2 cos α 0 u 0 δ w 1 m 3 g cos θ 0 δ m b 1 m 3 δ p p 3 1 m 3 δ p w 3 where k s are the constant coefficients relative to drag d lift l and viscous moment m d l due to wing and body shown in fig 8 and the variables denoted with subscript 0 are the corresponding value at planar gliding equilibria while the variables with a former δ represent the small perturbation from their respective equilibrium value substituting δ θ δ q δ u δ w 0 and δ p w i δ p p i 0 i 1 3 into eqs 1 2 and 3 the influence of the bladder on the vehicle s dynamic can be independently observed as follows 4 δ q 1 j 2 g x b cos θ 0 z b sin θ 0 δ m b 5 δ u 1 m 1 g sin θ 0 δ m b 6 δ w 1 m 3 g cos θ 0 δ m b where θ 0 π 2 π 2 because the bladder is mounted at the head of the vehicle and symmetric around e 1 axis it has x b 0 and z b 0 accordingly a small increase of m b i e δ m b 0 results in an increase of pitch in vertical plane due to δ q 0 conversely reducing buoyancy of the bladder i e δ m b 0 leads to decrease in pitch angle due to δ q 0 the following theorem will be used to analyze the change of glide velocity caused by the variation of m b theorem 1 y δ x x 2 x 2 is a real valued continuous function for δ x with δ x r and a real constant x if x 0 y 0 when δ x 2 x 0 and y 0 when δ x 2 x 0 if x 0 y 0 when δ x 0 2 x and y 0 when δ x 0 2 x proof the given function is equal to y δ x 2 x δ x which has two different roots for a given non zero constant x i e δ x 0 or δ x 2 x it is easy to tell the sign of y for different δ x denote v t the updated velocity of vehicle after a non zero δ m b is applied in an arbitrarily small time interval δ t 0 it has v t u t 2 w t 2 with the updated components of velocity u t and w t given as u t u 0 δ u w t w 0 δ w δ u 0 δ t δ u d t δ w 0 δ t δ w d t note that δ u and δ w are the consequence of changing m b with small magnitude in a steady upward glide θ 0 0 note that vehicle has a negative aoa leonard and graver 2001 which gives u 0 0 w 0 0 a positive δ m b yields a positive δ u and a negative δ w therefore δ u and δ w share the same sign as u 0 and w 0 respectively and then the below relationships hold u t u 0 δ u u 0 δ u u 0 w t w 0 δ w w 0 δ w w 0 therefore it has v t u t 2 w t 2 u 0 2 w 0 2 v 0 which says an increase of velocity contrarily a negative δ u and a positive δ w happen if δ m b is negative then one can infer a decrease in velocity v t v 0 with theorem 1 in a steady downward glide θ 0 0 the vehicle has positive velocity components in e 1 and e 3 direction due to a positive aoa i e u 0 0 and w 0 0 increasing the bladder s buoyancy δ m b 0 produces negative δ u and δ w recalling theorem 1 it is clear that v t v 0 however if δ m b is negative there are positive variations in both velocity components δ u 0 and δ w 0 following the studies in the upward glide it can be readily proved that v t v 0 in conclusion the bladder mounted at the forward end of the fuselage affects the gliding performance in such a way inflation deflation of the bladder will continuously trim the vehicle by the stern head and increase upward downward gliding trend therefore design parameters of the gravity and buoyancy that needed for the desired gliding performance are discussed based partially on a extreme downward glide equilibria and a extreme upward glide equilibria the model of a vehicle in a steady planar glide holds the following relationships graver 2005 7 α 1 2 k l k d tan ξ 1 1 4 k d k l 2 cot ξ k d 0 cot ξ k l 0 with ξ π 2 tan 1 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d tan 1 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d π 2 and 8 m g m b 1 g sin ξ k d 0 k d α 2 cos ξ k l 0 k l α v 2 9 m g g x g cos θ z g sin θ m b g x b cos θ z b sin θ m 3 m 1 u w k m 0 k m α v 2 with θ ξ α u v cos α and w v sin α first of all consider the case that the bladder shrinks completely m b 0 which implies the maximum descending rate and nose down pitch angle given a desired glide speed v d d o w n and a glide path angle ξ d d o w n in this condition the total mass of the vehicle and the buoyancy of the fuselage should be designed as below deriving from eqs 7 and 8 10 m g δ 1 g sin ξ d d o w n k d 0 k d α d d o w n 2 cos ξ d d o w n k l 0 k l α d d o w n v d d o w n 2 note that 11 m b r b m b r b then the cg position can be selected by eq 9 as 12 x g cos θ d d o w n z g sin θ d d o w n 1 m g g m 3 m 1 u d d o w n w d d o w n k m 0 k m α d d o w n v d d o w n 2 then take the bladder with its maximum volume for gliding into consideration and denote m b m a x the mass of fluid displaced by the bladder the vehicle must glide upward with maximum speed and extreme nose up pitch attitude under such condition however it should be clarified that the maximum volume of the bladder corresponding to m b m a x is not the same as the extreme volume that the bladder should never expand over to prevent burst this will be further discussed in section 3 3 denote v d u p and ξ d u p the desired glide speed and glide path angle respectively in this extreme upward gliding condition the required m b m a x can then be calculated with eq 8 as 13 m b m a x m g δ 1 g sin ξ d u p k d 0 k d α d u p 2 cos ξ d u p k l 0 k l α d u p v d u p 2 also the appropriate installation position of the bladder is obtained from eq 9 as 14 x b cos θ d u p z b sin θ d u p 1 m b m a x g m g g x g cos θ d u p z g sin θ d u p m 3 m 1 u d u p w d u p k m 0 k m α d u p m a x v d u p 2 recall that z b 0 x b can be determined via eq 14 3 2 concern about mode transition vertical floating at the surface is a necessary position for the vehicle right after landing or just before takeoff also it is a crucial period in the transition between swimming and flying as for typical ugs they cannot do a vertical floating due to their design with the limitation of mass distribution therefore a rotating mechanism that rotates the movable mass 360 freely is newly developed for the proposed vehicle to realize the motion switch between a normal gliding and a vertical floating fig 9 shows the rotatable mass positions in different operation stages for the gliding operation the mass position β should be limited in 90 90 as in fig 9 a the mass is fixed in the most bottom place i e β 0 when the vehicle glides steadily in vertical plane in this situation the vehicle has enough restoring moment against heeling caused by lateral disturbance in terms of rolling to the left or right for the vehicle the mass moves to the position where β 0 90 or β 90 0 as shown in fig 9 b to adjust itself to upright orientation after surfacing the vehicle will shift the rotatable mass to the most upper side i e β 180 as depicted in fig 9 c by doing so the cg reconverges to the longitudinal axis and locates below the cb as shown in fig 10 a successful transition between gliding and vertical floating makes demands on the mass distribution of the vehicle and the displaced fluid as discussed below for the vehicle vertically floating at the surface it naturally has m b m b δ m g on one hand the fact that the cg lies below the cb yields that 15 x b x b m b m b x g which is equal to 16 x b x g m g m g δ on the other hand the requirement that z g comes to zero when β 180 yields 17 m s z s m z p β 18 0 m s m 0 substituting z p r p cos β into eq 17 gives 18 r p m w m z w where r p is the offset distance of the rotatable mass from the e 1 axis 3 3 concern about metacentric stability when floating at the surface the vehicle is exposed to harsh environment conditions like ocean wind waves surface currents etc before takeoff or right after landing the rotor arms are unfolded the unfolded arms however will rise the cg significantly which adversely affects the floating stability an effective way to retain the restoring ability is making sure that the new rising cg is still below the cb by properly managing the weight of foldable components another way referring to metacentric stability can still prevent the vehicle from overturn even if the cg rises over the cb as the rising distance of the rotors in the unfolding process is too much to arranged the cg still below the cb the later scheme was embraced in our final design fig 11 illustrates the principle of metacentric stability when the cg is above the cb in the figure point m represents the metacenter at which the vertical line through the cb intersects the longitudinal body axis the torque couple of the downward gravitational force and the upward buoyant force will act to bring the tilting body back to vertical as long as point m lies above the cg the torque couple also known as restoring torque is 19 τ r b g z where an estimation of righting lever g z the distance between cg and point z can be obtained with the metacentric height g m the distance between the cg and point m as 20 g z g m sin η the relationship only holds at small angles of heel η therefore good metacentric stability benefits from large g m note that point m is only treated as a fixed point at small heeling angles otherwise m is no longer fixed and have to be recalculated at different submerged body ways of increasing metacentric height include heightening point m or lowering the cg the former scheme requires the submerged portion of the bladder can shift to the tilting side as much as possible for a given η and the more this shift distance is for the same η the greater the restoring torque τ r will be which thus enhances the metacentric stability however there is a critical heeling angle η c where the metacentric stability vanishes any inclination greater than η c will lead to a torque created by the gravity and buoyancy in the same direction of the heel and force the vehicle to capsize rather than righting it back 3 4 concern about level flight in longitudinal plane transition to level flight is a process where the increasing lift of wings gradually takes over the decreasing thrust to counteract the gravity however in a steady level flight the thrust overcomes not only the drag force but also partially the gravity therefore the match between the vehicle s aerodynamics and the propulsion property decides the performance of a steady level flight note that control surfaces widely used in fixed wing uavs were not adopted in our design since the propulsion system can generate control moments in all directions which also contribute to payload reduction of the vehicle given a desired aoa α d and a desired forward speed v d the equilibrium of level flight can be represented in inertial frame coordinates as below according to fig 12 21 t cos α d d α d v d 0 g t sin α d l α d v d 0 τ m d l α d v d m g g x g cos α d 0 where t and τ are the control thrust and control pitching moment of six rotors therefore 22 g d α d v d l α d v d d α d v d tan α 23 t d α d v d cos α 24 τ m d l α d v d m g g x g cos α d eqs 22 23 24 imply that the efficiency for a level flight of the proposed hauv is determined by the lift drag ratio and drag property matching with the vehicle s weight since the wings and the vehicle s shape dominate the aerodynamics eq 22 provides an essential relationship between wing design overall configuration and weight management eqs 23 and 24 show the needed control input to maintain a desired level flight which assists in selection of motor propeller combination or a rough evaluation for flight efficiency eqs 10 12 13 14 16 18 22 23 24 and the guideline in section 3 3 are the critical principles for a proper design of the proposed vehicle 4 prototype vehicle as a realization of the improved concept of the multimodal hauv compared with its first prototype nezha iii was designed and fabricated nezha iii is not intended to be an optimized design but rather a proof of concept demonstration that can achieve the desired functionality 4 1 vehicle configuration nezha iii is completed with great use of off the shelf components as much as possible for being cost efficient and easy maintenance figs 13 and 14 show its exterior and interior details nezha iii mainly comprises a hexacopter propulsion system a pair of fixed wings folding mechanisms an outside bladder a supporting frame and a tubular main hull protecting the pneumatic buoyancy system rotatable mass avionics and batteries stored inside nezha iii has a gross weight of 18 kg wingspan of 1650 mm diagonal wheelbase of 965 mm and primary body length of 577 mm excluding the antenna the sealed chamber of the tubular fuselage is formed with a 160 mm outer diameter 5 mm wall thickness acrylic cylinder two acrylic bulkheads and two aluminum sealing flanges sealing flange has double o ring seals on its side and one o ring seal on its end surface to make the enclosure fully waterproof the inside dry compartment provides a protected zone for the apparatus including pneumatic buoyancy system rotatable mass distribution system batteries and electronic instrument there are 7 cable penetrators and 2 connectors mounted at the upper bulkhead they are designed for the wires and pneumatic tubes pass through besides a pressure sensor for depth measurement and a venting device are installed on the bulkhead a pair of off the shelf wings for uavs is implemented to provide lift for flight and underwater glide the wings are made of balsa wood with the unilateral wingspan of 730 mm and the mean chord length of 291 mm because of the great amount of displacement and the low density of the wings several holes with a diameter of 10 mm were drilled through the leading edge and trailing edge of the wings to permit free flooding and draining there is a rectangular carbon fiber tube in each wing for enhanced strength the wings are symmetrically placed on both sides of the fuselage with two 3d printed resin connectors three stainless steel adjustable hose clamps pass through the connectors and fasten them on the main hull together with the wings the wings can be shifted along the hull in vertical direction to trim the cb and the cg together the hexacopter configuration is a trade off design between carrying capacity and weight of propulsion system six 360 mm carbon fiber tubes and two customized 2 5 mm carbon fiber plates compose the supporting frame structure of the propulsion system in addition a 3d printed nylon circular connector is used to attach the frame to the main hull by a hose clamp position of the frame is also adjustable in vertical direction but is intentionally set close to the top for the emergence of the propellers from the water when the vehicle stands on the ground its high center of gravity adversely affects the stability situation might get worse when the vehicle needs to tilt to resist cross wind during landing therefore four extended customized triangular carbon fiber plates fixed around the main hull serve as four orthogonal landing support frame the barometer is not waterproof so that it is placed inside the main hull in this case the vehicle s hull needs to not only be fully sealed under water but also be breathable in air for the barometer functioning normally therefore a vent piston driven by a micro gear motor with screw shaft is designed and fabricated in house with a 6 v direct current dc power supply the piston can fully open or seal in 10 s according to the control command as the design principles in section 3 suggest the external rubber bladder is placed at the top and is circularly symmetric about the longitudinal body axis according to section 3 3 the bladder should has a large enough radius for good metacentric stability in our prototype an annular bladder is used instead of a spherical one given a certain bladder s volume an annular shape can spread that volume over an area with a larger radius while a round shape occupies that volume in the middle inevitably deviation of the mass and buoyancy properties of the fabricated vehicle from the designed ones is introduced into the system due to the machining error estimation errors etc so the prototype has been trimmed by adding ballast e g stainless steel 4 2 high pressure pneumatic buoyancy engine the buoyancy engine consists of the air supply a carbon fiber cylinder the pressure regulator a pressure reducing valve two actuators two solenoid valves for inflation and deflation respectively the rubber bladder and the safety devices a check valve preventing backflow of ambient water and a safety valve preventing bladder failure fig 15 shows the systematic diagram of the buoyancy system the cylinder can store 0 22 l compressed air under the pressure of 30 mpa at most our prototype is designed for shallow operation and every fraction of weight counts for the flight performance a tradeoff selection of equipment is achieved with the lightweight valves and tubes that can operate under the pressure up to 2 mpa therefore the air pressure is lowered from 30 mpa to 2 mpa by the pressure reducing valve before the air flows to the rest components the solenoid valves are separately controlled via different relays unlike proportional solenoid valves the solenoid valves utilized in the system are either on or off which means the flow speed cannot be continuously adjusted online to control the buoyancy effectively the time windows of opening valves are the only control effort in practice a proportional differential pd controller is developed to adjust the duration of valve opening since the valves open and close alternately the output of the controller is actually the working frequency of the valves in our early design a pressure sensor was employed to obtain an accurate estimation of the bladder volume the sensor was not able to place inside the bladder due to its size instead it was mounted outside the bladder measuring the air pressure through a branch of inflation air tube however the test results showed an unacceptable deviation between the measurements and the actual value of pressure in the bladder during inflation or deflation this is because the gas compressibility and the friction loss the loss of pressure cannot be ignored in a fast pipe flow resulting in an obvious deviation between the pressure of the measuring point and the pressure inside the bladder thus the method that used the information of the bladder s pressure to control a glide was abandoned in the present form the control scheme is completed without the need of pressure data the discussion in section 3 1 hints a one to one correspondence between buoyancy gliding attitude and glide speed since the buoyancy and the glide speed are difficult to estimate the attitude data can be easily and accurately measured by the attitude sensor and fed back to the pd controller to realize the close loop control of glide motion the test results demonstrate the feasibility of the proposed control scheme note that the number of gliding cycles varies with the operating depth and additional exhaust inevitably happens when the controller operates besides operating depth has an influence on the working rate of buoyancy engine this affects the consumption of the compressed air during the buoyancy adjustment advanced control scheme that can adaptively manage the change of inflation and deflation dynamics due to the variation of depth is potentially helpful with that problem however it is beyond the scope of this work therefore the evaluation and the optimization of the gliding endurance is not included in this work 4 3 rotating mechanism for movable mass as shown in fig 14 the rotation mechanism is comprised of the rotational actuators a micro gear motor and a worm drive the offset mass two lipo batteries weighing 1 724 kg and the 360 degree hall angle sensor the selected worm gear with a gear ratio of 40 1 not only is self locking without power but amplifies the output torque of the gear motor making it possible to apply a micro gear motor with weight of 10 g an output torque up to 2 kg cm and nominal voltage of 9 v to know the rotational mass position the angle sensor measures the rotation of a shaft that revolves in sync with the mass through a 1 1 nylon spur gear pair the rotating mechanism moves at a constant revolution speed of 7 s until the it reaches the prescribed position but it is limited to only one full rotation to avoid the twisting damage of the wires fig 16 displays a cross section view of the rotatable mass illustrating the measurement of the rotation angle β note that the zero angle in practical situation represents the leftmost position of the rotatable mass instead of the bottommost as depicted in fig 9 this adjustment avoids the measurements near critical values 0 and 360 this is necessary because a jump from 0 to 360 or the opposite will likely happen in the presence of disturbance when the sensor reading gets close to 0 or 360 the reading jump may lead to an overshooting rotation over 360 if the revolution continues in its previous direction causing excessive distortion of wire and damaging the wire the batteries are cuboid as shown in fig 16 so that they are arranged into a v shape to get an adequate eccentric distance of the mass i e r p 2 2 cm then a steady planar glide can be performed when the vehicle is most bottom heavy at β 9 0 and a vertical attitude can be achieved when the cg is vertically in line with the cb along the longitudinal body axis at β 27 0 4 4 folding mechanism for foldable arms nezha iii equips with 6 folding mechanisms in all everyone of which is responsible for an arm fig 17 shows the 3d rendered structure of the folding mechanism in two different extremity the actuator of the mechanism is a 6 v gear motor sealed by double o rings in a cuboid aluminum alloys shell epoxy resin seal is used for wire penetration in the bottom of the shell a brass thread rod is used in combination with a stainless steel barrel nut to translate turning motion of the motor into linear motion of the nut then the nut leads a lever arm to rotate 90 around a hinge by detecting the locked rotor current of motor it is easy and confident to know the arms are fully folded or unfolded and thus shut down the motor immediately the mechanism is self locking without power when the barrel nut sits at both ends of the thread rod fig 18 demonstrates the folding and unfolding process of the rotor arms six arms are designed to move synchronously to prevent that the cg offsets so far from the longitudinal axis that the couple of gravity and buoyancy turns the vehicle upside down when it floats at the water s surface as shown in the figure it takes respectively about 11 s and 13 s for the mechanism to fully lower and open the arms 4 5 propulsion six rotors propel the vehicle in flight a rotor is a combination of a waterproof 400 kv bldc motor with weight of 280 g and a foldable carbon fiber propeller with a 46 7 cm 18 4 in diameter a 16 8 cm 6 6 in pitch due to the gravity the blades of the propeller can be folded freely during the arms folding to avoid hard interference with the wings again the blades can fully extend when the motors spin fast two 4 in 1 55 a electronic speed controllers escs are used to control motor speed the first three motors occupy the three channel of an esc while the rests occupy the other esc thus every esc has one redundant channel for backup the motors are exposed in water to waterproof it the motor coils are coated with waterproof paint and original stainless steel bearings are replaced by ceramic ones the system weight benefits from the utilization of 4 in 1 escs at the price of drastic heating for a good heat dissipation condition escs are mounted outside the hull meanwhile they are sealed by epoxy resin with good thermal conductivity also the esc s aluminum cooling shield is deliberately left to be directly exposed in air when waterproofing the esc fig 19 shows the results of static thrust tests for a single motor propeller combination in air in the tests the rotor can generate maximum thrust of 5 1 kg at 6920 rpm rotation speed at full throttle the vehicle weight occupies 60 percent of the maximum 30 6 kg takeoff weight leaving the propulsion with enough thrust margin for disturbance rejection in flight 4 6 avionics and power systems the avionics of nezha iii are classified into 3 main subsystems power system flight system and underwater control system in terms of different functions most of avionics are shielded inside the acrylic main hull apart from those instruments submerged in ambient water as previously stated the global positioning system gps and radio telemetry antennas are waterproofed using epoxy resin seal and are mounted on the external top as well with their cables passing through waterproof cable penetrators to the inside fig 20 is the electrical system diagram for nezha iii a desire controller that can enable both level and vertical flight is still in developing in the preliminary stage of the development for nezha iii the success of the water air transition is the most crucial and essential concern therefore for the current system the flight controller is established with a commercial multirotor autopilot which can ensure stable vertical flight and vtol maneuver with easy integration and good compatibility for the present design however it should be pointed out that the autopilot limits flight attitude up to 45 which precludes practical level flight in the field tests on the other hand a micro control unit mcu that responsible for underwater operation has been developed and completed with full basic functions i e regulating the pitch and buoyancy states rotating the movable mass folding or unfolding the arms collecting data and communicating with the operator etc with these two controllers nezha iii can react to the ground control station to move in both air and water the flight remote control link is established via an onboard small 2 4 ghz sbus receiver the autopilot is powered by a power management unit pmu a global navigation satellite system gnss and compass compact module collects the vehicle s position and orientation information and feeds them back to the autopilot once the autopilot receives the pilot s command from the remote controller rc it will act on two escs accordingly to control rotations of each motor note that there is a one way data link where a pulse width modulation pwm signal is sent from the autopilot to the mcu the pwm signal is manually tuned within 1000 2000 via a channel of rc to reboot the system for emergency the mcu will reset itself if the signal is greater than 1700 this is practically useful when the underwater operation program crashes unexpectedly real time remote control is denied under water therefore nezha iii is preprogrammed to execute certain actions including planar glide turning glide switch between glide and vertical float folding or unfolding arms there is a bidirectional 433 mhz wireless link between pc ground station and the vehicle so control signals from the ground station can be sent to the vehicle while data onboard can be transmitted back to the station as well once the command is received the mcu will react correspondingly to adjust buoyancy the mcu directly turns on or off the relays to control the solenoid valves to activate the vent piston or move the rotatable mass the mcu controls a dual h bridge dc motor driver with rated current of 1 5 a for each channel to drive the actuating motors the same three motor drivers are instructed by the mcu and share the same control signal for the synchronization of six folding arms note that there is a relay in the power supply line of the autopilot this relay is directly controlled by the mcu when receiving an reset command for autopilot from the pc ground station the mcu will trigger a transient power outage for the autopilot via the relay following by powering the autopilot again to reboot it sensors for different measurements are crucial for both flight and underwater maneuvers the autopilot kit has a self contained set of sensors for a stable flight however sharing the flight data stored in the autopilot with the mcu is still one of our undergoing work therefore an extra set of sensors is employed for motion control underwater depth is measured by an ultra small pressure sensor with a verified resolution and accuracy of 1 cm attitude and heading information underwater is provided by an attitude and heading reference system ahrs note that the ahrs orientation is adjusted in such a way that its x y and z axes respectively point to the right the head and the bottom the adjustment avoids the singularity of 90 pitch angle simply and effectively when the vehicle is upright accessible position information of the vehicle at the surface or in flight is enabled by another gps module as to the fulfillment of controlling the vent piston and the folding arms there are four channels of current sensor data signaling the mcu to judge whether the actuators reach their extremity positions moreover the angle sensor is needed for the rotatable mass as discussed in section 4 3 the measurements of rotation angle of the rotatable mass and operating current of the folding mechanisms are collected via a 16 bit analog to digital adc module that can be accessed via i2c communication the mcu is able to access to those collected data as well as depth measurement with its i2c interface via an i2c multiplexer four 6000 mah 6s lipo 22 2 v batteries and six different buck converters constitute the electric power distribution system as stated in section 4 3 two batteries are placed on the rotating mechanism to serve as offset mass the other two batteries are fixed in a specified location to meet the overall arrangement designed in section 3 the batteries directly power the pmu the two escs and the two solenoids with nominal voltage of 24 v to isolate the control system from high power actuators two independent buck converters stepping down the high voltage of the batteries to 9 v are used respectively to power the mcu and the actuators for vent piston and rotatable mass meanwhile three buck converters with peak output current of 3 a feed 6 v voltage to the motor drivers of the folding mechanisms regarding the else devices operating under low power including sensors a 5 v buck converter powers them all 5 vehicle performance characterization nezha iii was tested to verify the feasibility of the proposed vehicle and its multi domain locomotion performance was characterized in three operating regimes i e underwater glide flight and transition between water and air 5 1 underwater glide the underwater gliding performance was field tested in a lake with average depth of 30 m and maximum depth over 100 m the vehicle states were measured with sampling time of 0 18 s the ahrs system has poor accuracy for velocities along three axis for the assessment of the motion speed the vertical speed of the vehicle was obtained through dividing the difference between two consecutive depth measurements by the sample interval however this calculated velocity was subject to the sensor uncertainty the random error up to 0 01 m introduced by the depth measurement mentioned in section 4 6 was magnified by 5 5 times in the velocity calculation causing an unpleasant high frequency measurement noise with amplitude of 0 056 m s therefore a first order filter below was implemented for a better estimation of the vertical speed v ˆ k 1 0 5 v k 0 5 v ˆ k where v k is the k th calculated vertical velocity v ˆ k is the k th filtered velocity fig 21 demonstrates the filter performance through two cycles of dive the upper subfigure shows that the filtered velocity is more precise than the calculated one the deviation between the measured depth and the estimated depth reconstructed with filtered velocity is demonstrated in the lower subfigure where it is obvious that the higher the speed is the bigger the error of the estimation is note that the velocity information is mainly used in the assessment of the gliding motion rather than completing the gliding control loop in this work the vehicle has the feature of pitch buoyancy coupling adjusting the buoyancy will accordingly change the attitude and affect the gliding velocity since the ahrs system can measure the attitude accurately the gliding motion controller is thus designed to actuate the buoyancy engine to track the desired pitch attitude instead of the buoyancy or velocity 5 1 1 free planar glide the couple relation of the linear and pitch motions of the prototype was firstly studied through the experiment of a free gliding to 40 m depth fig 22 the free glide was defined as a four stage sequence of operation the first stage from 0 s to 21 4 s started with the bladder deflation at the surface and continued until the vehicle dived over 1 m below the surface the second stage from 21 4 s to 155 3 s was a free downward glide with no inflation or deflation control from 1 m to 40 m in this stage the bladder was passively compressed by the ambient pressure and therefore its displaced volume varied with depth the third stage from 155 3 s to 315 s lasted from the moment the vehicle descended over 40 m until it rose back to 40 m again during this time the inflation valve kept opened to inflate the bladder without extra control the last stage from 315 s to 377 s consisted of a free upward glide from 40 m to surface with no inflation or deflation control during the period of the glide the rotatable mass was fixed at β 9 0 to reject rolling disturbance and thus maintain ϕ 0 the rolling stability in the upward and downward glides is proved to be relatively good in the presence of current in the free downward glide the bladder kept shrinking as the depth increased resulting in an increasing nose down attitude and glide speed in the free upward glide the nose up attitude and glide speed also showed increasing tendency due to the continuous expansion of the bladder as a result of the decreasing ambient pressure as shown in the figure the second stage lasted about 2 2 min while the fourth stage took about 1 min the average rising velocity is about twice faster than the average diving velocity the diving velocity reached 0 64 m s at about 7 1 pitch angle while the rising velocity accelerated to 0 94 m s at near 90 pitch angle a significant feature that the increasing downward velocity gradually came to equilibrium is captured from 140 s to 155 3 s this equilibrium is reached after the bladder cannot be squeezed any more i e m b 0 and m b 0 therefore as for the dive of the prototype with the bladder completely compressed the maximum velocity is approximately 0 64 m s along with the max pitch of 7 1 at the beginning of the third stage a dissonance between the variations of pitch angle and downward velocity are observed the pitch angle increased rapidly over 0 in 21 1 s and over 40 in 56 9 s after the inflation started at 155 3 s this was an aggressive nose up maneuver however the vehicle still descended in the meantime and finally touched the lake bottom at 51 m depth before it started rising at 270 s consequently a large aoa was encountered by the vehicle deteriorating the hydrodynamic performance the problem is mainly caused by the great downward inertia of the body at the maximum descending rate and the slow buoyancy regulation in deep water as for the latter fact it is found out that the prototype has a large trim by the stern with about 40 at neutral buoyancy besides the great ambient pressure will slow down the inflation therefore the vehicle was still negative buoyant but decelerated during pitch angle changing from 7 1 to 40 this behavior is repeatedly observed in the transition from a downward to an upward glide of the following gliding experiments the braking problem is common for ug due to the lack of direct control force from the propeller a practical solution is to adjust the vehicle s buoyancy in advance of reaching the target depth but this control strategy is not included in this work since our preliminary goal is to identify the system s basic functionalities it should also be pointed out that the sharp deceleration from 155 3 s to 200 s in the figure is not the true velocity response because the pressure sensor was mounted at the head the rapid pitch motion due to the inflation diminished the difference between two sequent depth measurements even if the vehicle was still descending making the calculated velocity experience a sharp decrease but the velocity of cg was still faster than the calculated one in the fourth stage the vehicle had a free and accelerating rise without any control during the period the decreasing ambient pressure made the bladder continuously expand without active inflation thus the buoyancy unceasingly increased and the cb kept shifting forward which resulted in an upward acceleration and an increasing pitch motion 5 1 2 controlled planar glide controlled planar glide was further studied by applying a well tuned pd controller for pitch motion figs 23 and 24 respectively show the photograph and the results of a representative controlled planar gliding with a 2 0 pitch angle in descent and 45 pitch angle in ascent during the tests the rotatable mass was fixed at the position of β 9 0 to prevent the vehicle from rolling the vehicle started the controlled inflation for the bladder to float up right after it dived over 8 m and activated the controlled deflation to descend once it rose to 2 m disturbance on pitch dynamics was normally experienced by the vehicle when it surfaced and partially emerged from water the results prove the effectiveness of the utilized pd algorithm for pitch attitude tracking note that the pd controller is tuned well only for operations in shallow water as the operation depth gets deeper the inflation and deflation characteristics of the buoyancy engine change due to the increased ambient pressure therefore the parameters tuned well for the shallow zone will worse the performance of pd controller working in deeper depth a control scheme that can tackle the varying properties of the actuators of the system is a challenge and still under developing these tests primarily studied the motion characteristics of the prototype including the relationship between the vertical velocity and the pitch angle in a steady glide these features are independent of the operation depth or the performance of actuators a group of controlled planar gliding tests were conducted with different desired pitch angles θ d from 4 5 to 45 each test composed of at least five cycles of glide with the same desired pitch angle to obtain an average result table 2 shows the statistics of the vertical velocity and the pitch angle in steady glides recall that the aforementioned glide paths with pitch angle from 0 to 40 indicate the unstable transition stage from descent to ascent with large aoa and poor hydrodynamics therefore there is no analysis for these glide paths 5 1 3 turning glide since the prototype with no control surface roll yaw coupling is the only approach to turning glide to study the rolling behavior of the prototype first tests were carried out by fixing the rotatable mass in a variety of positions β in controlled glides with 2 0 downward pitch angle and 45 upward pitch angle the roll response to different rotatable mass positions are listed in tables 3 and 4 it is found out that the vehicle has a symmetrical rolling behavior as a function of the rotatable mass position from 10 to 170 but the symmetry of rolling behavior is deteriorated when gliding upward obviously in the upward glides the vehicle rolled to the left by 18 4 when the rotatable mass was in the leftmost position β 10 while it rolled to the right by only 12 6 when the rotatable mass was in the rightmost position β 170 this is mainly attributed to the non uniform expansion of the bladder due to the manufacturing issue the inflated off the shelf bladder has its right and up sides bigger than the left and the bottom therefore the cb will offset toward the right and up from the center when the vehicle floats up by inflating the bladder which makes a roll to the left greater than a roll to the right based on the rolling characteristic turning maneuver was then tested and demonstrated by fixing rotatable mass in a position where β 1 5 in a controlled glide with 20 downward pitch angle and 45 upward pitch angle the results are recorded in fig 25 in the downward glide the vehicle had an average roll of 16 8 to the left and thus yawed to the left with the rate of 2 8 s in the upward glide the vehicle maintains an average roll of 13 6 to the left but performs a yaw motion in a reverse direction to the right with the rate of 0 5 s the opposite change of yawing direction after the transition between a downward path and an upward path is normal for ugs which is primarily determined by the position of wings graver 2005 nevertheless the turning rate of the descent and the ascent are quantitatively different a leading cause is the top bottom asymmetry of the used airfoil which is originally designed for aircraft this airfoil can provide good hydrodynamic force at a positive aoa in a downward glide but has poor hydrodynamics at a negative aoa in an upward glide therefore the steering ability got worse in the upward glide with a steeper pitch angle of 45 besides that the offset of the cb position caused by the asymmetrical inflation of the bladder made the heel angle to the left in descent greater than that in ascent therefore the vehicle had a slower turning behavior when floating up 5 2 steady float at the surface in practice the prototype vertically rests on the water s surface with the arms either folded or unfolded after the rotatable mass shifts to the position of β 27 0 folding the arms will lower the cg position below the cb which always produces a restoring moment to right the tilting body on the contrary the cg is higher than the cb when the arms are unfolded as discussed in section 3 3 the bladder should maintain its maximum volume to provide the vehicle with sufficient metacentric stability to float steadily at the surface fig 26 demonstrates two cases with different bladder inflation sizes where the bladder had an average 290 mm outer diameter and 160 mm inner diameter for the first case and had its maximum dimension with an average 420 mm outer diameter and 250 mm inner diameter for the second case note that the prototype in both cases were positive buoyant in the first case fig 26 a the vehicle with its arms unfolded was initially placed in an upright position at the surface but rapidly overturned in the second case fig 26 b the vehicle was successfully stabilized at the surface thanks to the enough metacentric stability provided by the bladder to evaluate the metacentric stability the vehicle was forced to heel toward different directions to find the critical heel angle at which the vehicle can no longer right itself through a serials of tests a 28 minimum angle of vanishing stability was identified this fact evidences a certain degree of seakeeping quality for the vehicle 5 3 level flight because of the experiment site constraints and the attitude adjustment limitation of the utilized flight controller level flight has yet to be practically performed and tested for the prototype to characterize the level flight performance computational fluid dynamics cfd technique was applied for the present study consider the vehicle in steady horizontal flight with different aoas and velocities the aerodynamics of the prototype are shown in figs 27 and 28 as a function of aoa and velocity as known from fig 28 lift to drag l d ratio is not determined by the cruise velocity but the aoa the peak l d ratio 3 92 happens at 7 aoa recall that eqs 22 23 and 24 always hold in a steady level flight by using eq 22 and extrapolating from the data sets in figs 27 and 28 the forward velocities of steady level flight with different aoa are calculated fig 29 the results show that the vehicle will fly faster in a level flight with a more horizontal attitude which indicates a smaller aoa and the fastest speed of about 66 4 m s can be reached by the vehicle at a zero aoa though the flight slows down as the aoa increases the speed hardly changes when the aoa exceeds 10 based on the aerodynamic data and the above velocity information the requisite control forces of steady level flight can be determined through eqs 22 23 and 24 which are shown in fig 30 the greatest control efforts i e 142 38 n 14 53 kg maximum thrust and 7 09 n m maximum pitch torque of the propulsion are needed for a completely horizontal flight α 0 the most efficient level flight happens at 6 aoa and 31 5 m s with 44 95 n 4 59 kg minimum thrust and 1 47 n m pitch torque given the vehicle s weight of 18 kg and the propulsion characteristics in fig 19 it can be inferred that the propulsion power will reduce up to 79 9 percent when the vehicle transitions from vertical to level flight 5 4 vertical flight to test the stability and the maneuverability of the prototype in vertical flight trials including hovering and flying a rectangle path were carried out under manual control note that the prototype automatically stabilize its attitude and position under the control of autopilot but it can only fly a trajectory according to the pilot s command sent via rc fig 31 shows the prototype maintaining a steady hover in the air as other researches have studied the wings impose an adverse effect on the tail sitter uav subject to crosswind in our experiment the prototype indeed suffered from slight wind pushing the vehicle away but the vehicle succeeded in stabilizing itself fig 32 displays the actual rectangle trajectory that the prototype flied under the pilot s control note that the breeze was encountered frequently by the vehicle while it flied above the lake surface the practical operation proves the flight stability and maneuverability of the vehicle and evidences the capability of carrying out tasks in confined space 5 5 water air transition the transition consists of two stages the first one is the transition between underwater glide and vertical float at the surface the second one is the water exit or water entry process fig 33 demonstrate the transition maneuver of the prototype between a glide and a vertical float before takeoff it requires the maximum bladder volume and the rotatable mass position of β 27 0 for the vehicle prior to raising the arms these maneuvers set the vehicle in an upright position and prevent overturn if the vehicle capsizes refolding the arms can bring the body back to vertical orientation again if the vehicle tempts to glide after landing the arms will be folded at first after that the rotatable mass shifts to the position of β 9 0 to incline the body forward and obtain enough bottom heaviness then the vehicle can start gliding by deflating the bladder figs 34 and 35 respectively show the time stamped photograph sequence of water entry and exit of the prototype in the tests the surface condition was not quite good the vehicle encountered random wave and wind disturbance despite the unfavorable surface condition the takeoff and landing maneuvers were repeatedly successful the prototype was able to reject some disturbance and go through the water s surface smoothly the results strongly prove the benefits of a well metacentric stability design and a vtol water air transition profile to the proposed hauv in addition good maneuverability of the vertical flight allows for any transition velocity within the speed range of the vehicle however the exit and entry velocities should be optimized with the concerns of energy saving and structural integrity in the presence of water impact in the air to water ingress the fast speed indicates a low power of the propulsion to the extremity powering off all the rotors gives the vehicle a free fall into water but the faster the entering speed is the heavier the impact force exerted on the fuselage is this increases the risk of structural fracture moreover lowering the propulsion power may weaken the ability of disturbance rejection therefore the optimal entering velocity trajectory should be selected with a careful and comprehensive consideration in the water to air egress it takes time for the floodable wings to passively drain out the entrained water the drain time is dominated by the motion of the wings the interior structure and the open of the wings stewart et al 2019 if the vehicle leaves water fast the adverse effect of the hydrodynamic damping and the entrained water becomes significant making the vehicle weigh heavier temporarily the power consumption of the propulsion will consequently increase though a slow water exit process helps to mitigate the problem it prolongs the duration of the exit and thus expends more energy therefore the takeoff velocity should be optimized by considering the aspects of the water resistance the draining dynamics of the entrained water and the energy consumption 6 conclusion an improved concept of the multimodal hauv has been presented in this paper it is designed to be versatile for performing level and vertical flight hovering surface drifting and underwater glide which aims at extending application scenarios and operation endurance as many as possible compared to the current systems four following improvements have been made first a high pressure pneumatic buoyancy system is designed for longer and deeper operation underwater second a rotating mechanism is added for turning glide and switching operation modes in the water third hexacopter configuration is implemented for greater payload capacity fourth folding arm structure is fulfilled for better hydrodynamics of glide to ensure the viability of the proposed concept the paper presents design principles related to the planar gliding performance the realization of mode switch between glide and vertical float the metacentric stability at the surface and the level flight performance these principles are key to the proper management of the buoyancy and the weight of the vehicle with the basis of the above design considerations a proof of concept prototype named nezha iii has been fabricated and tested due to the site specific constraints and the attitude limitation of the commercial flight controller level flight have yet to be practically performed numerical method was implemented instead to evaluate level flight performance the simulation results confirm a better efficiency of the level flight than the vertical flight in the vertical flight the good maneuverability and stability of the prototype were demonstrated even though there existed disturbance caused by the winds the motion performance underwater was assessed by a series of gliding tests the free glide experiment confirmed the buoyancy engine could operate at 50 m depth and the results also confirm the predicted pitch buoyancy coupling of the proposed vehicle in addition pitch is much more sensitive to the buoyancy change than the velocity then controlled planar glides were achieved by applying a pd controller for pitch attitude tracking in the controlled glide experiments the quantitative relationship between the pitch angle and the steady vertical velocity of glides have been obtained after that rolling behavior and the consequent roll yaw coupling performance were evaluated through turning tests finally the ability of repeated water air transition was successfully proved even in the presence of wave and wind disturbances there are still lots of works to be done to improve the present design more elaborate analysis of the aero hydrodynamics of the vehicle especially for the airfoil are needed to optimize the design a comprehensive controller that can effectively deal with the variation of the buoyancy engine s performance versus depth is underway development of a flight controller compatible with level and vertical flight is also crucial moreover the optimization of the velocity profile of the water air transition plays a significant role in real applications credit authorship contribution statement di lu conceptualization methodology formal analysis investigation writing original draft visualization chengke xiong formal analysis investigation data curation visualization hexiong zhou investigation formal analysis chenxin lyu investigation data curation rui hu investigation data curation caoyang yu methodology software zheng zeng conceptualization supervision project administration lian lian supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported in part by the national natural science foundation of china under grant 41706108 in part by the shanghai sailing program china under grant 17yf1409600 and in part by the open project of pilot national laboratory for marine science and technology qingdao china under grant qnlm 2016orp0104 
21259,hybrid aerial underwater vehicle is a novelty able to fly and swim which is extensively suitable for missions like water sampling observing semi submerged structure and underwater exploration etc motivated by the efficiency of fixed wing unmanned aerial vehicles uavs and underwater gliders in their own specific environments and the maneuverability of rotary wing uavs this paper presents an improved design of a multimodal hauv capable of level and vertical flight hovering and underwater glide specially to balance flight payload and weight under water an innovative configuration is proposed which includes a newly developed lightweight pneumatic buoyancy system and excludes the linear actuator commonly used for pitch control of gliders moreover motor arms can fold for better hydrodynamics all these tradeoffs demand an adequate match between the fuselage aerodynamics and propulsion property and special management of buoyancy and weight to guarantee predicted performances therefore key design principles are proposed and elaborated based on the principles a prototype named nezha iii was fabricated and tested the prototype s performance characterization in the regions of underwater flight and water air transition are presented the results demonstrate the desired performance of the prototype under different modes and notably prove its outstanding capability of diving to 50 m depth keywords unmanned aerial underwater vehicle unmanned aerial aquatic vehicle flying submarine unmanned aerial vehicle underwater glider 1 introduction conventionally missions scenarios in the ocean that supported by surface vessels incur huge expenditure in terms of the cost of time labor and other resources besides oceanographic phenomenon is highly variable and sometime unpredictable the in situ observations would fail if the vessels cannot reach the spot in time the advent of unmanned vehicles has benefited the underwater technique and changed the way the ocean is observed they provides a view of the interior ocean with higher spatial and temporal resolution davis et al 2002 based on the great development of unmanned vehicles there are increasing interests in coordinating multiple unmanned vehicles for carrying out complex missions efficiently under advanced control techniques peng et al 2020 recently researchers are even attempting the joint use of different unmanned vehicles including unmanned aerial vehicles uavs unmanned surface vehicles usvs as well as unmanned underwater vehicles uuvs for ocean monitoring researchers achieved progress in building and operating a distributed heterogeneous autonomous sensor network that combined uavs usvs and uuvs in coastal environments valdivia y alvarado et al 2011 taher et al 2016 a multi robot system was established to carry out multi domain monitoring of coral reefs shkurti et al 2012 a new project that builds a collaborative team of heterogeneous robots for obtaining a multi domain awareness on a floating structure like ship and iceberg is recently reported ross et al 2019 the heterogeneous multi robot teams benefit the ocean monitoring by providing rich data collected from air surface and underwater environments but it is not easy and inexpensive to integrating different vehicles into one system harmoniously and thus it is a great challenge to organize and control such system well lately the field of hybrid aerial underwater vehicle hauvs that enable operations in both air and water is newly emerging thanks to the hauv s capabilities of locomotion in different medium scientists can minimize the complexity of multi domain monitoring missions since data can be collected from different environment by only one platform other applications hauvs can be extensively used for includes but not limited to intelligence gathering surveillance and reconnaissance inspection search and rescue multi domain locomotion imposes a considerable challenge to the vehicle design the existing approaches to hauvs popularly consider endowing two main subsets of uavs i e fixed wing and rotary wing uavs with underwater functionality as their aerial counterpart fixed wing hauvs are outstanding for flight endurance range and cruise speed an early instance of fixed hauvs was test sub which was initially launched from a mothership aircraft and glided to the surface and dived young 2014 however it could not take off from the surface lately a single aerial rotor fixed wing hauv eagleray was tested and characterized through flight underwater cruise and repeated water air transition tests it had been experimentally proved to be fully functional in distinct medium weisler et al 2017 later a similar fixed wing hauv except for an aft water rotor being added for underwater maneuver was fabricated and it completed a full cycle of multi domain mission stewart et al 2018 to optimize the water transition profile with better hydrodynamics for the fixed wing hauvs new aquatic micro aerial vehicle aquamav designed with morphing wings was developed but the take off propulsion used a one time only use water jet thruster which denies repeated water air transition siddall et al 2018 2017 siddall and kovač 2017 in the last five years the effort in rotary wing hauvs has presented distinctive prospect in well controlled multi domain observations the first known rotary wing hauvs was proposed conceptually and modeled in 2014 drews et al 2014 recently the same team presented their first but still in production prototype with four upper aerial rotors and four lower underwater rotors da rosa et al 2018 to cross different medium seamlessly and repeatedly an hauv naviator2 was evolved from a multirotor it had four dual aerial propellers propulsions to drive the vehicle underwater and in the air maia et al 2015 2017 moreover a design that combined a ballast system with a quadrotor based flying system resulted in a different hauv loon copter whose buoyancy and attitude in the water were controlled by pumping in or out the ambient fluid alzu bi et al 2018 these rotary wing hauvs have been experimentally proved with superiority in terms of smooth controllable and repeated cross domain transitions like their aerial counterparts rotary wing hauvs are suitable for high resolution observations where high maneuverability and hovering ability are required however all these advantages are at the cost of the fixed wing hauv s endurance range and speed note that the basic structures of most present designs for hauv are closely related to that of typical uavs although these vehicles are capable of well flight and water air transition their abilities to move underwater are still limited in terms of working depth and underwater endurance which weakens their utility in the ocean among the existing uuv technology underwater gliders ugs have been proved to be the most efficient platform and already been widely used for long range deep and long term missions edwards et al 2017 inspired by the features of ugs and given the respective downsides of existing hauvs the concept of novel multimodal hauv that coordinates flight endurance speed maneuverability as well as underwater efficient locomotion and endurance for a single platform was firstly proposed in our previous work lu et al 2018 this multimodal hauv basically integrated the functionalities of ugs and tail sitter uavs a combined form of fixed wing and rotary wing uavs indicating the combined ability of underwater glide as well as vertical and level flight later a proof of concept prototype nezha was designed and experimentally tested lu et al 2019 proving the feasibility of the multimodal hauv concept in nezha s design a pneumatic buoyancy system was employed for underwater gliding nevertheless nezha was embarrassed by its limited underwater operation first it could dived no more than 5 m second precise control on gliding performance was denied third it had no turning ability underwater fourth its hydrodynamics was undesirable due to the rotor arms fifth it had a small payload capacity in this paper a brand new design of a multimodal hauv is presented then a proof of concept prototype named nezha iii was fabricated and its performance was also experimentally tested and characterized this design addresses the shortages of the current systems and improve the hauv s capability of conducting underwater missions at increased depth over longer periods as well as higher levels of autonomy this upgrade presents three innovative achievements 1 use a lightweight super high pressure pneumatic buoyance control system as a substitute for conventional buoyancy system of ugs this system is testified to enable dives to the depth of 50 m for our prototype which to our best knowledge makes the vehicle be the first one of its kind that can make such deep dive 2 make a trade off design that abandoned the translational mechanism but keep the rotational one for tuning glide of the inner movable mass commonly used in ugs to further balance the flight payload and the underwater weight due to the inability of longitudinally regulating the mass distribution for the vehicle the buoyancy pitch coupling of the vehicle is studied in depth and took full advantage of as an innovative strategy for pitch control of planar glide 3 design folding rotor arms for better hydrodynamics underwater and theoretically and practically address the consequent overturn caused by rise of the center of gravity cg during the unfolding process when the vehicle prepares to take off from the surface rest of the paper is organized as follows in section 2 the concept of the proposed multimodal hauv and the nominal maneuvers are defined while key design principles of the vehicle are elaborated in section 3 then section 4 details the fabrication of the prototype in terms of five subsystems the performance characterization of the prototype in different operation regimes are presented in section 5 finally section 6 comes to the conclusion 2 operation overview the concept of the proposed hauv temps to obtain a higher level of integration of fixed wing and rotary wing uavs as well as ugs enabling larger flight payload and deeper and longer operation under water a conceptual design is presented in fig 1 in a full cycle of operation fig 2 the vehicle is expected to perform level and vertical flight hovering surface drifting underwater glide as well as water air transition for different mission requirements to achieve that the propulsion system and other actuators of uavs and ugs are adapted accordingly for the vehicle s different operation modes 2 1 level flight being capable of level flight the vehicle can travel a far distance rapidly and efficiently in oceanic mission scenarios inspired by the mechanism of tail sitter uavs the vehicle can switch to level flight without extra tilting mechanism thus saving weight and simplifying the vehicle design zhang et al 2017 fig 3 a demonstrates the switching maneuver from vertical to level flight the rotors motor propeller combinations in different sides of the wings spin in different rates to produce a moment to pitch the vehicle forward along with the increasing speed consequently the induced lift of the fixed wings increases enough to counteract the gravity while the force against the drag is dominated by the thrust after that the thrust the lift the gravity and the drag will finally reach a new equilibrium which settles the vehicle into a stable level flight the air drag is normally much smaller than the vehicle s gravity therefore the power of rotors in a level flight is lower compared with that in a vertical flight in our previous work lu et al 2019 flight simulations were carried out to qualitatively evaluate the decrease of power consumption happened when the vehicle changed to level flight this fact of the proposed vehicle will be verified and characterized quantitatively in section 5 2 2 vertical flight and hovering the proposed vehicle also features the capabilities of vertical flight and hovering as rotary wing uavs to change from level to vertical flight the thrust of rotors on different sides of the wings differs to create a pitch moment that brings the vehicle back to vertical as shown in fig 3 b as the angle of attack aoa of the wings increases and the horizontal component of the thrust decreases the vehicle gradually slows down due to the drag after finishing the transition the vehicle flies vertically in the air and the thrust mainly acts against the gravity ensuring a new equilibrium state of vertical flight in a vertical flight the vehicle not only has sufficient thrust that allows for heavier takeoff weight but also benefits from good maneuverability like the rotary wing uavs the vertical flight maneuver highly consumes energy however some special scenarios do require a precise control and excellent maneuverability for an hauv for example a detailed monitoring in a confined environments or a close up view of feature of interest like offshore oil platform can be only satisfied by a slow flight other applications such as ocean photography and water sampling ore et al 2015 need the platform to execute a zero velocity loitering in air therefore integrating the abilities of vertical flight and hovering makes the vehicle versatile for extended applications besides the considerations above vertical flying maneuver is beneficial for the takeoff and landing on the water s surface which will be discussed in later subsections 2 3 surface drifting the vehicle can naturally drift at the sea surface in an upright position for an hauv it is useful to make itself function as a free drifting surface buoy that has been utilized for many scientific activities herbers and janssen 2016 gonzalez haro et al 2016 in addition floating on surface guarantees a good wireless communication for continuous data transfer and may support a solar charger for the vehicle in the future surface drifting requires no extra mechanism on the present system to realize fig 4 demonstrates the vehicle stabilized at the water s surface with its arms folded the pneumatic variable buoyancy system has a bladder namely the actuator responsible for stable flotation and gliding locomotion underwater mounted outside on the top to float at the surface the bladder is inflated to such a volume that the vehicle becomes positively buoyant meanwhile the rotor arms fold down to lower the cg under the center of buoyancy cb so that the vehicle could stay at a stable upright floating position 2 4 underwater glide one of the novelties of the proposed vehicle is merging the functionalities of ugs and uavs this is the first attempt to adapt the mechanism of ugs in a flyable platform and thus a try to extend the underwater endurance for hauvs the only driving force pushing a ug forward is the horizontal component of lift induced by the gliding motion due to the inequality between gravity and buoyancy without any propulsion gliding motion is quite energy efficient for the proposed vehicle a glide strategy is thus implemented solely via the pneumatic buoyancy system because the linear movable mass is abandoned for weight reduction for turning direction underwater an inner movable mass that can rotate 36 0 around the central axis is added to the vehicle rotating the movable mass will roll the vehicle to turn when the movable mass is located at the most bottom side the cg moves far off the central axis to the bottom so that the vehicle acquires enough bottom heaviness for stable gliding leonard and graver 2001 also note that six arms fold and all rotors keep idle for better hydrodynamics in a glide fig 5 demonstrates different managements of buoyancy with respects to the gravity in downward and upward glides regulating buoyancy and the cb position relative to the cg can control the gliding performance in a downward glide the vehicle becomes negative buoyant and descends as a result of the deflation of the bladder meanwhile the cb gradually shifts behind the cg as the bladder shrinks which results in a trim by the head in an upward glide the bladder is inflated with the compressed air stored inside an inner cylinder in advance the expanding bladder increases buoyancy and changes the cb position to the front of the cg then the vehicle is trimmed by the stern and ascends in both descent and ascent cases the lift of the wings enables a horizontal forward displacement of the vehicle eventually the vehicle moves forward by repeating alternating descent and ascent i e a sawtooth trajectory unlike ugs a significant characteristic of the proposed vehicle is the exclusion of the longitudinal regulation of movable mass for the purpose of maximum reduction of flight payload without losing the underwater gliding ability due to this tradeoff design the pitch motion of the vehicle is coupled with the change of buoyancy making the vehicle highly underactuated and thus harder to control when moving underwater in the next section the design principle helping address this problem is elaborated 2 5 water air transition smooth cross domain transition is the key to bridging underwater locomotion and flying vertical takeoff and landing vtol is chosen as the water air transition strategy for the following reasons first vtol permits heavier takeoff weight for small or medium hauvs their payload capacities are very limited however heavier waterproof structures and devices are almost inevitable in designing an hauv for deeper operation applying vtol is thus most likely to make successful takeoff for a heavy vehicle second wings are designed to be floodable to avoid the great extra buoyancy due to their large volume vtol maneuver helps reduce the negative effect of the water entrained in the floodable wings when exiting water and relieve the impact when entering water as the model of passively draining water indicates stewart et al 2019 the faster the egress speed is the greater the hydrodynamic force imposed on the vehicle is in another concern ingress speed and attitude must be controlled otherwise the vehicle may suffer from severe water impact or even crash in the air to water ingress young 2014 that situation might get harsher for larger and heavier platform so implementing vtol maneuver is good for the vehicle slowly crossing the water s surface under well control third vtol is naturally a part of the maneuver of vertical flight thus no extra design is needed fig 6 shows the procedures of water air transitions from underwater gliding to flying the vehicle firstly inflates the bladder to surface then the inner movable mass rotates to a specific position where the cg lies below the cb along with the central axis resulting in the body in an upright position as seen in the figure the cg will rise over the cb as the arms rise up without proper buoyancy management the couple of gravitational and buoyant forces will produce an overturning moment instead of a restoring moment thus the bladder needs to be further expanded to guarantee metacentric stability before the arms unfold this design concern is fully discussed in the following section to achieve a successful landing same procedure but in reverse order is taken the arms are folded right after the vehicle lands on the surface safely and all rotors are shut down then the movable mass is shifted to the position where the most bottom heaviness and gliding stability are met after that the vehicle is ready for underwater glide 3 design considerations the variable used in this paper are defined in table 1 as in fig 7 two reference frames i e the inertial frame and the body fixed frame are used the inertial frame is defined as conventional north east down frame while the body fixed frame is defined in front right down orientation with the origin coincident with the centroid of the fixed fuselage excludes bladder normally the lateral positions of the mass of fluid displaced by the bladder m b and the nonuniformly distributed mass m w i e y b and y w are designed to be zero for the symmetry of the rolling behavior and the passive stability of yaw motion under water in flight the propulsion system six motor propeller combinations supports different flying maneuvers as for underwater locomotion and the surface floatation the vehicle s behavior is controlled via the pneumatic buoyancy system and the rotatable mass 3 1 concern about planar glide as aforementioned the presented vehicle is more underactuated than ugs when moving underwater because it has only one actuator the bladder once the bladder s volume changes the pitch attitude and the buoyancy will vary synchronously forbidding separate controls of pitch attitude and buoyancy to obtain the intended performance of the glide in vertical plane proper weight and buoyancy managements are crucial for the design and achieved by exploiting the nature of pitch buoyancy coupling the linearized model of proposed system in a steady planar glide is obtained below as similar to that of the ug system graver 2005 1 δ q 1 j 2 m g g x g sin θ 0 z g cos θ 0 m b 0 g x b sin θ 0 z b cos θ 0 δ θ 1 j 2 m u 0 x p m w 0 z p m w u 0 x w m w w 0 z w δ q 1 j 2 m 3 m 1 w 0 k m 0 k m α 0 2 u 0 k m w 0 δ u 1 j 2 m 3 m 1 u 0 k m 0 k m α 0 2 w 0 k m u 0 δ w 1 j 2 g x b cos θ 0 z b sin θ 0 δ m b z p j 2 δ p p 1 x p j 2 δ p p 3 z w j 2 δ p w 1 x w j 2 δ p w 3 2 δ u 1 m 1 δ m b 0 m g g cos θ 0 δ θ 1 m 1 m m w m 3 w 0 δ q 1 m 1 k l 0 k l α 0 2 u 0 k l w 0 sin α 0 k l 0 k l α 0 cos α 0 w 0 k d 0 k d α 0 2 2 u 0 2 k d α 0 w 0 cos α 0 k d 0 k d α 0 2 sin α 0 w 0 δ u 1 m 1 k l 0 k l α 0 2 w 0 k l u 0 sin α 0 k l 0 k l α 0 cos α 0 u 0 k d 0 k d α 0 2 2 w 0 2 k d α 0 u 0 cos α 0 k d 0 k d α 0 2 sin α 0 u 0 δ w 1 m 1 g sin θ 0 δ m b 1 m 1 δ p p 1 1 m 1 δ p w 1 3 δ w 1 m 3 δ m b 0 m g g sin θ 0 δ θ 1 m 3 m m w m 1 u 0 δ q 1 m 3 k l 0 k l α 0 2 u 0 k l w 0 cos α 0 k l 0 k l α 0 sin α 0 w 0 k d 0 k d α 0 2 2 u 0 2 k d α 0 w 0 sin α 0 k d 0 k d α 0 2 cos α 0 w 0 δ u 1 m 3 k l 0 k l α 0 2 w 0 k l u 0 cos α 0 k l 0 k l α 0 sin α 0 u 0 k d 0 k d α 0 2 2 w 0 2 k d α 0 u 0 sin α 0 k d 0 k d α 0 2 cos α 0 u 0 δ w 1 m 3 g cos θ 0 δ m b 1 m 3 δ p p 3 1 m 3 δ p w 3 where k s are the constant coefficients relative to drag d lift l and viscous moment m d l due to wing and body shown in fig 8 and the variables denoted with subscript 0 are the corresponding value at planar gliding equilibria while the variables with a former δ represent the small perturbation from their respective equilibrium value substituting δ θ δ q δ u δ w 0 and δ p w i δ p p i 0 i 1 3 into eqs 1 2 and 3 the influence of the bladder on the vehicle s dynamic can be independently observed as follows 4 δ q 1 j 2 g x b cos θ 0 z b sin θ 0 δ m b 5 δ u 1 m 1 g sin θ 0 δ m b 6 δ w 1 m 3 g cos θ 0 δ m b where θ 0 π 2 π 2 because the bladder is mounted at the head of the vehicle and symmetric around e 1 axis it has x b 0 and z b 0 accordingly a small increase of m b i e δ m b 0 results in an increase of pitch in vertical plane due to δ q 0 conversely reducing buoyancy of the bladder i e δ m b 0 leads to decrease in pitch angle due to δ q 0 the following theorem will be used to analyze the change of glide velocity caused by the variation of m b theorem 1 y δ x x 2 x 2 is a real valued continuous function for δ x with δ x r and a real constant x if x 0 y 0 when δ x 2 x 0 and y 0 when δ x 2 x 0 if x 0 y 0 when δ x 0 2 x and y 0 when δ x 0 2 x proof the given function is equal to y δ x 2 x δ x which has two different roots for a given non zero constant x i e δ x 0 or δ x 2 x it is easy to tell the sign of y for different δ x denote v t the updated velocity of vehicle after a non zero δ m b is applied in an arbitrarily small time interval δ t 0 it has v t u t 2 w t 2 with the updated components of velocity u t and w t given as u t u 0 δ u w t w 0 δ w δ u 0 δ t δ u d t δ w 0 δ t δ w d t note that δ u and δ w are the consequence of changing m b with small magnitude in a steady upward glide θ 0 0 note that vehicle has a negative aoa leonard and graver 2001 which gives u 0 0 w 0 0 a positive δ m b yields a positive δ u and a negative δ w therefore δ u and δ w share the same sign as u 0 and w 0 respectively and then the below relationships hold u t u 0 δ u u 0 δ u u 0 w t w 0 δ w w 0 δ w w 0 therefore it has v t u t 2 w t 2 u 0 2 w 0 2 v 0 which says an increase of velocity contrarily a negative δ u and a positive δ w happen if δ m b is negative then one can infer a decrease in velocity v t v 0 with theorem 1 in a steady downward glide θ 0 0 the vehicle has positive velocity components in e 1 and e 3 direction due to a positive aoa i e u 0 0 and w 0 0 increasing the bladder s buoyancy δ m b 0 produces negative δ u and δ w recalling theorem 1 it is clear that v t v 0 however if δ m b is negative there are positive variations in both velocity components δ u 0 and δ w 0 following the studies in the upward glide it can be readily proved that v t v 0 in conclusion the bladder mounted at the forward end of the fuselage affects the gliding performance in such a way inflation deflation of the bladder will continuously trim the vehicle by the stern head and increase upward downward gliding trend therefore design parameters of the gravity and buoyancy that needed for the desired gliding performance are discussed based partially on a extreme downward glide equilibria and a extreme upward glide equilibria the model of a vehicle in a steady planar glide holds the following relationships graver 2005 7 α 1 2 k l k d tan ξ 1 1 4 k d k l 2 cot ξ k d 0 cot ξ k l 0 with ξ π 2 tan 1 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d tan 1 2 k d k l k l 0 k l k l 0 k l 2 k d 0 k d π 2 and 8 m g m b 1 g sin ξ k d 0 k d α 2 cos ξ k l 0 k l α v 2 9 m g g x g cos θ z g sin θ m b g x b cos θ z b sin θ m 3 m 1 u w k m 0 k m α v 2 with θ ξ α u v cos α and w v sin α first of all consider the case that the bladder shrinks completely m b 0 which implies the maximum descending rate and nose down pitch angle given a desired glide speed v d d o w n and a glide path angle ξ d d o w n in this condition the total mass of the vehicle and the buoyancy of the fuselage should be designed as below deriving from eqs 7 and 8 10 m g δ 1 g sin ξ d d o w n k d 0 k d α d d o w n 2 cos ξ d d o w n k l 0 k l α d d o w n v d d o w n 2 note that 11 m b r b m b r b then the cg position can be selected by eq 9 as 12 x g cos θ d d o w n z g sin θ d d o w n 1 m g g m 3 m 1 u d d o w n w d d o w n k m 0 k m α d d o w n v d d o w n 2 then take the bladder with its maximum volume for gliding into consideration and denote m b m a x the mass of fluid displaced by the bladder the vehicle must glide upward with maximum speed and extreme nose up pitch attitude under such condition however it should be clarified that the maximum volume of the bladder corresponding to m b m a x is not the same as the extreme volume that the bladder should never expand over to prevent burst this will be further discussed in section 3 3 denote v d u p and ξ d u p the desired glide speed and glide path angle respectively in this extreme upward gliding condition the required m b m a x can then be calculated with eq 8 as 13 m b m a x m g δ 1 g sin ξ d u p k d 0 k d α d u p 2 cos ξ d u p k l 0 k l α d u p v d u p 2 also the appropriate installation position of the bladder is obtained from eq 9 as 14 x b cos θ d u p z b sin θ d u p 1 m b m a x g m g g x g cos θ d u p z g sin θ d u p m 3 m 1 u d u p w d u p k m 0 k m α d u p m a x v d u p 2 recall that z b 0 x b can be determined via eq 14 3 2 concern about mode transition vertical floating at the surface is a necessary position for the vehicle right after landing or just before takeoff also it is a crucial period in the transition between swimming and flying as for typical ugs they cannot do a vertical floating due to their design with the limitation of mass distribution therefore a rotating mechanism that rotates the movable mass 360 freely is newly developed for the proposed vehicle to realize the motion switch between a normal gliding and a vertical floating fig 9 shows the rotatable mass positions in different operation stages for the gliding operation the mass position β should be limited in 90 90 as in fig 9 a the mass is fixed in the most bottom place i e β 0 when the vehicle glides steadily in vertical plane in this situation the vehicle has enough restoring moment against heeling caused by lateral disturbance in terms of rolling to the left or right for the vehicle the mass moves to the position where β 0 90 or β 90 0 as shown in fig 9 b to adjust itself to upright orientation after surfacing the vehicle will shift the rotatable mass to the most upper side i e β 180 as depicted in fig 9 c by doing so the cg reconverges to the longitudinal axis and locates below the cb as shown in fig 10 a successful transition between gliding and vertical floating makes demands on the mass distribution of the vehicle and the displaced fluid as discussed below for the vehicle vertically floating at the surface it naturally has m b m b δ m g on one hand the fact that the cg lies below the cb yields that 15 x b x b m b m b x g which is equal to 16 x b x g m g m g δ on the other hand the requirement that z g comes to zero when β 180 yields 17 m s z s m z p β 18 0 m s m 0 substituting z p r p cos β into eq 17 gives 18 r p m w m z w where r p is the offset distance of the rotatable mass from the e 1 axis 3 3 concern about metacentric stability when floating at the surface the vehicle is exposed to harsh environment conditions like ocean wind waves surface currents etc before takeoff or right after landing the rotor arms are unfolded the unfolded arms however will rise the cg significantly which adversely affects the floating stability an effective way to retain the restoring ability is making sure that the new rising cg is still below the cb by properly managing the weight of foldable components another way referring to metacentric stability can still prevent the vehicle from overturn even if the cg rises over the cb as the rising distance of the rotors in the unfolding process is too much to arranged the cg still below the cb the later scheme was embraced in our final design fig 11 illustrates the principle of metacentric stability when the cg is above the cb in the figure point m represents the metacenter at which the vertical line through the cb intersects the longitudinal body axis the torque couple of the downward gravitational force and the upward buoyant force will act to bring the tilting body back to vertical as long as point m lies above the cg the torque couple also known as restoring torque is 19 τ r b g z where an estimation of righting lever g z the distance between cg and point z can be obtained with the metacentric height g m the distance between the cg and point m as 20 g z g m sin η the relationship only holds at small angles of heel η therefore good metacentric stability benefits from large g m note that point m is only treated as a fixed point at small heeling angles otherwise m is no longer fixed and have to be recalculated at different submerged body ways of increasing metacentric height include heightening point m or lowering the cg the former scheme requires the submerged portion of the bladder can shift to the tilting side as much as possible for a given η and the more this shift distance is for the same η the greater the restoring torque τ r will be which thus enhances the metacentric stability however there is a critical heeling angle η c where the metacentric stability vanishes any inclination greater than η c will lead to a torque created by the gravity and buoyancy in the same direction of the heel and force the vehicle to capsize rather than righting it back 3 4 concern about level flight in longitudinal plane transition to level flight is a process where the increasing lift of wings gradually takes over the decreasing thrust to counteract the gravity however in a steady level flight the thrust overcomes not only the drag force but also partially the gravity therefore the match between the vehicle s aerodynamics and the propulsion property decides the performance of a steady level flight note that control surfaces widely used in fixed wing uavs were not adopted in our design since the propulsion system can generate control moments in all directions which also contribute to payload reduction of the vehicle given a desired aoa α d and a desired forward speed v d the equilibrium of level flight can be represented in inertial frame coordinates as below according to fig 12 21 t cos α d d α d v d 0 g t sin α d l α d v d 0 τ m d l α d v d m g g x g cos α d 0 where t and τ are the control thrust and control pitching moment of six rotors therefore 22 g d α d v d l α d v d d α d v d tan α 23 t d α d v d cos α 24 τ m d l α d v d m g g x g cos α d eqs 22 23 24 imply that the efficiency for a level flight of the proposed hauv is determined by the lift drag ratio and drag property matching with the vehicle s weight since the wings and the vehicle s shape dominate the aerodynamics eq 22 provides an essential relationship between wing design overall configuration and weight management eqs 23 and 24 show the needed control input to maintain a desired level flight which assists in selection of motor propeller combination or a rough evaluation for flight efficiency eqs 10 12 13 14 16 18 22 23 24 and the guideline in section 3 3 are the critical principles for a proper design of the proposed vehicle 4 prototype vehicle as a realization of the improved concept of the multimodal hauv compared with its first prototype nezha iii was designed and fabricated nezha iii is not intended to be an optimized design but rather a proof of concept demonstration that can achieve the desired functionality 4 1 vehicle configuration nezha iii is completed with great use of off the shelf components as much as possible for being cost efficient and easy maintenance figs 13 and 14 show its exterior and interior details nezha iii mainly comprises a hexacopter propulsion system a pair of fixed wings folding mechanisms an outside bladder a supporting frame and a tubular main hull protecting the pneumatic buoyancy system rotatable mass avionics and batteries stored inside nezha iii has a gross weight of 18 kg wingspan of 1650 mm diagonal wheelbase of 965 mm and primary body length of 577 mm excluding the antenna the sealed chamber of the tubular fuselage is formed with a 160 mm outer diameter 5 mm wall thickness acrylic cylinder two acrylic bulkheads and two aluminum sealing flanges sealing flange has double o ring seals on its side and one o ring seal on its end surface to make the enclosure fully waterproof the inside dry compartment provides a protected zone for the apparatus including pneumatic buoyancy system rotatable mass distribution system batteries and electronic instrument there are 7 cable penetrators and 2 connectors mounted at the upper bulkhead they are designed for the wires and pneumatic tubes pass through besides a pressure sensor for depth measurement and a venting device are installed on the bulkhead a pair of off the shelf wings for uavs is implemented to provide lift for flight and underwater glide the wings are made of balsa wood with the unilateral wingspan of 730 mm and the mean chord length of 291 mm because of the great amount of displacement and the low density of the wings several holes with a diameter of 10 mm were drilled through the leading edge and trailing edge of the wings to permit free flooding and draining there is a rectangular carbon fiber tube in each wing for enhanced strength the wings are symmetrically placed on both sides of the fuselage with two 3d printed resin connectors three stainless steel adjustable hose clamps pass through the connectors and fasten them on the main hull together with the wings the wings can be shifted along the hull in vertical direction to trim the cb and the cg together the hexacopter configuration is a trade off design between carrying capacity and weight of propulsion system six 360 mm carbon fiber tubes and two customized 2 5 mm carbon fiber plates compose the supporting frame structure of the propulsion system in addition a 3d printed nylon circular connector is used to attach the frame to the main hull by a hose clamp position of the frame is also adjustable in vertical direction but is intentionally set close to the top for the emergence of the propellers from the water when the vehicle stands on the ground its high center of gravity adversely affects the stability situation might get worse when the vehicle needs to tilt to resist cross wind during landing therefore four extended customized triangular carbon fiber plates fixed around the main hull serve as four orthogonal landing support frame the barometer is not waterproof so that it is placed inside the main hull in this case the vehicle s hull needs to not only be fully sealed under water but also be breathable in air for the barometer functioning normally therefore a vent piston driven by a micro gear motor with screw shaft is designed and fabricated in house with a 6 v direct current dc power supply the piston can fully open or seal in 10 s according to the control command as the design principles in section 3 suggest the external rubber bladder is placed at the top and is circularly symmetric about the longitudinal body axis according to section 3 3 the bladder should has a large enough radius for good metacentric stability in our prototype an annular bladder is used instead of a spherical one given a certain bladder s volume an annular shape can spread that volume over an area with a larger radius while a round shape occupies that volume in the middle inevitably deviation of the mass and buoyancy properties of the fabricated vehicle from the designed ones is introduced into the system due to the machining error estimation errors etc so the prototype has been trimmed by adding ballast e g stainless steel 4 2 high pressure pneumatic buoyancy engine the buoyancy engine consists of the air supply a carbon fiber cylinder the pressure regulator a pressure reducing valve two actuators two solenoid valves for inflation and deflation respectively the rubber bladder and the safety devices a check valve preventing backflow of ambient water and a safety valve preventing bladder failure fig 15 shows the systematic diagram of the buoyancy system the cylinder can store 0 22 l compressed air under the pressure of 30 mpa at most our prototype is designed for shallow operation and every fraction of weight counts for the flight performance a tradeoff selection of equipment is achieved with the lightweight valves and tubes that can operate under the pressure up to 2 mpa therefore the air pressure is lowered from 30 mpa to 2 mpa by the pressure reducing valve before the air flows to the rest components the solenoid valves are separately controlled via different relays unlike proportional solenoid valves the solenoid valves utilized in the system are either on or off which means the flow speed cannot be continuously adjusted online to control the buoyancy effectively the time windows of opening valves are the only control effort in practice a proportional differential pd controller is developed to adjust the duration of valve opening since the valves open and close alternately the output of the controller is actually the working frequency of the valves in our early design a pressure sensor was employed to obtain an accurate estimation of the bladder volume the sensor was not able to place inside the bladder due to its size instead it was mounted outside the bladder measuring the air pressure through a branch of inflation air tube however the test results showed an unacceptable deviation between the measurements and the actual value of pressure in the bladder during inflation or deflation this is because the gas compressibility and the friction loss the loss of pressure cannot be ignored in a fast pipe flow resulting in an obvious deviation between the pressure of the measuring point and the pressure inside the bladder thus the method that used the information of the bladder s pressure to control a glide was abandoned in the present form the control scheme is completed without the need of pressure data the discussion in section 3 1 hints a one to one correspondence between buoyancy gliding attitude and glide speed since the buoyancy and the glide speed are difficult to estimate the attitude data can be easily and accurately measured by the attitude sensor and fed back to the pd controller to realize the close loop control of glide motion the test results demonstrate the feasibility of the proposed control scheme note that the number of gliding cycles varies with the operating depth and additional exhaust inevitably happens when the controller operates besides operating depth has an influence on the working rate of buoyancy engine this affects the consumption of the compressed air during the buoyancy adjustment advanced control scheme that can adaptively manage the change of inflation and deflation dynamics due to the variation of depth is potentially helpful with that problem however it is beyond the scope of this work therefore the evaluation and the optimization of the gliding endurance is not included in this work 4 3 rotating mechanism for movable mass as shown in fig 14 the rotation mechanism is comprised of the rotational actuators a micro gear motor and a worm drive the offset mass two lipo batteries weighing 1 724 kg and the 360 degree hall angle sensor the selected worm gear with a gear ratio of 40 1 not only is self locking without power but amplifies the output torque of the gear motor making it possible to apply a micro gear motor with weight of 10 g an output torque up to 2 kg cm and nominal voltage of 9 v to know the rotational mass position the angle sensor measures the rotation of a shaft that revolves in sync with the mass through a 1 1 nylon spur gear pair the rotating mechanism moves at a constant revolution speed of 7 s until the it reaches the prescribed position but it is limited to only one full rotation to avoid the twisting damage of the wires fig 16 displays a cross section view of the rotatable mass illustrating the measurement of the rotation angle β note that the zero angle in practical situation represents the leftmost position of the rotatable mass instead of the bottommost as depicted in fig 9 this adjustment avoids the measurements near critical values 0 and 360 this is necessary because a jump from 0 to 360 or the opposite will likely happen in the presence of disturbance when the sensor reading gets close to 0 or 360 the reading jump may lead to an overshooting rotation over 360 if the revolution continues in its previous direction causing excessive distortion of wire and damaging the wire the batteries are cuboid as shown in fig 16 so that they are arranged into a v shape to get an adequate eccentric distance of the mass i e r p 2 2 cm then a steady planar glide can be performed when the vehicle is most bottom heavy at β 9 0 and a vertical attitude can be achieved when the cg is vertically in line with the cb along the longitudinal body axis at β 27 0 4 4 folding mechanism for foldable arms nezha iii equips with 6 folding mechanisms in all everyone of which is responsible for an arm fig 17 shows the 3d rendered structure of the folding mechanism in two different extremity the actuator of the mechanism is a 6 v gear motor sealed by double o rings in a cuboid aluminum alloys shell epoxy resin seal is used for wire penetration in the bottom of the shell a brass thread rod is used in combination with a stainless steel barrel nut to translate turning motion of the motor into linear motion of the nut then the nut leads a lever arm to rotate 90 around a hinge by detecting the locked rotor current of motor it is easy and confident to know the arms are fully folded or unfolded and thus shut down the motor immediately the mechanism is self locking without power when the barrel nut sits at both ends of the thread rod fig 18 demonstrates the folding and unfolding process of the rotor arms six arms are designed to move synchronously to prevent that the cg offsets so far from the longitudinal axis that the couple of gravity and buoyancy turns the vehicle upside down when it floats at the water s surface as shown in the figure it takes respectively about 11 s and 13 s for the mechanism to fully lower and open the arms 4 5 propulsion six rotors propel the vehicle in flight a rotor is a combination of a waterproof 400 kv bldc motor with weight of 280 g and a foldable carbon fiber propeller with a 46 7 cm 18 4 in diameter a 16 8 cm 6 6 in pitch due to the gravity the blades of the propeller can be folded freely during the arms folding to avoid hard interference with the wings again the blades can fully extend when the motors spin fast two 4 in 1 55 a electronic speed controllers escs are used to control motor speed the first three motors occupy the three channel of an esc while the rests occupy the other esc thus every esc has one redundant channel for backup the motors are exposed in water to waterproof it the motor coils are coated with waterproof paint and original stainless steel bearings are replaced by ceramic ones the system weight benefits from the utilization of 4 in 1 escs at the price of drastic heating for a good heat dissipation condition escs are mounted outside the hull meanwhile they are sealed by epoxy resin with good thermal conductivity also the esc s aluminum cooling shield is deliberately left to be directly exposed in air when waterproofing the esc fig 19 shows the results of static thrust tests for a single motor propeller combination in air in the tests the rotor can generate maximum thrust of 5 1 kg at 6920 rpm rotation speed at full throttle the vehicle weight occupies 60 percent of the maximum 30 6 kg takeoff weight leaving the propulsion with enough thrust margin for disturbance rejection in flight 4 6 avionics and power systems the avionics of nezha iii are classified into 3 main subsystems power system flight system and underwater control system in terms of different functions most of avionics are shielded inside the acrylic main hull apart from those instruments submerged in ambient water as previously stated the global positioning system gps and radio telemetry antennas are waterproofed using epoxy resin seal and are mounted on the external top as well with their cables passing through waterproof cable penetrators to the inside fig 20 is the electrical system diagram for nezha iii a desire controller that can enable both level and vertical flight is still in developing in the preliminary stage of the development for nezha iii the success of the water air transition is the most crucial and essential concern therefore for the current system the flight controller is established with a commercial multirotor autopilot which can ensure stable vertical flight and vtol maneuver with easy integration and good compatibility for the present design however it should be pointed out that the autopilot limits flight attitude up to 45 which precludes practical level flight in the field tests on the other hand a micro control unit mcu that responsible for underwater operation has been developed and completed with full basic functions i e regulating the pitch and buoyancy states rotating the movable mass folding or unfolding the arms collecting data and communicating with the operator etc with these two controllers nezha iii can react to the ground control station to move in both air and water the flight remote control link is established via an onboard small 2 4 ghz sbus receiver the autopilot is powered by a power management unit pmu a global navigation satellite system gnss and compass compact module collects the vehicle s position and orientation information and feeds them back to the autopilot once the autopilot receives the pilot s command from the remote controller rc it will act on two escs accordingly to control rotations of each motor note that there is a one way data link where a pulse width modulation pwm signal is sent from the autopilot to the mcu the pwm signal is manually tuned within 1000 2000 via a channel of rc to reboot the system for emergency the mcu will reset itself if the signal is greater than 1700 this is practically useful when the underwater operation program crashes unexpectedly real time remote control is denied under water therefore nezha iii is preprogrammed to execute certain actions including planar glide turning glide switch between glide and vertical float folding or unfolding arms there is a bidirectional 433 mhz wireless link between pc ground station and the vehicle so control signals from the ground station can be sent to the vehicle while data onboard can be transmitted back to the station as well once the command is received the mcu will react correspondingly to adjust buoyancy the mcu directly turns on or off the relays to control the solenoid valves to activate the vent piston or move the rotatable mass the mcu controls a dual h bridge dc motor driver with rated current of 1 5 a for each channel to drive the actuating motors the same three motor drivers are instructed by the mcu and share the same control signal for the synchronization of six folding arms note that there is a relay in the power supply line of the autopilot this relay is directly controlled by the mcu when receiving an reset command for autopilot from the pc ground station the mcu will trigger a transient power outage for the autopilot via the relay following by powering the autopilot again to reboot it sensors for different measurements are crucial for both flight and underwater maneuvers the autopilot kit has a self contained set of sensors for a stable flight however sharing the flight data stored in the autopilot with the mcu is still one of our undergoing work therefore an extra set of sensors is employed for motion control underwater depth is measured by an ultra small pressure sensor with a verified resolution and accuracy of 1 cm attitude and heading information underwater is provided by an attitude and heading reference system ahrs note that the ahrs orientation is adjusted in such a way that its x y and z axes respectively point to the right the head and the bottom the adjustment avoids the singularity of 90 pitch angle simply and effectively when the vehicle is upright accessible position information of the vehicle at the surface or in flight is enabled by another gps module as to the fulfillment of controlling the vent piston and the folding arms there are four channels of current sensor data signaling the mcu to judge whether the actuators reach their extremity positions moreover the angle sensor is needed for the rotatable mass as discussed in section 4 3 the measurements of rotation angle of the rotatable mass and operating current of the folding mechanisms are collected via a 16 bit analog to digital adc module that can be accessed via i2c communication the mcu is able to access to those collected data as well as depth measurement with its i2c interface via an i2c multiplexer four 6000 mah 6s lipo 22 2 v batteries and six different buck converters constitute the electric power distribution system as stated in section 4 3 two batteries are placed on the rotating mechanism to serve as offset mass the other two batteries are fixed in a specified location to meet the overall arrangement designed in section 3 the batteries directly power the pmu the two escs and the two solenoids with nominal voltage of 24 v to isolate the control system from high power actuators two independent buck converters stepping down the high voltage of the batteries to 9 v are used respectively to power the mcu and the actuators for vent piston and rotatable mass meanwhile three buck converters with peak output current of 3 a feed 6 v voltage to the motor drivers of the folding mechanisms regarding the else devices operating under low power including sensors a 5 v buck converter powers them all 5 vehicle performance characterization nezha iii was tested to verify the feasibility of the proposed vehicle and its multi domain locomotion performance was characterized in three operating regimes i e underwater glide flight and transition between water and air 5 1 underwater glide the underwater gliding performance was field tested in a lake with average depth of 30 m and maximum depth over 100 m the vehicle states were measured with sampling time of 0 18 s the ahrs system has poor accuracy for velocities along three axis for the assessment of the motion speed the vertical speed of the vehicle was obtained through dividing the difference between two consecutive depth measurements by the sample interval however this calculated velocity was subject to the sensor uncertainty the random error up to 0 01 m introduced by the depth measurement mentioned in section 4 6 was magnified by 5 5 times in the velocity calculation causing an unpleasant high frequency measurement noise with amplitude of 0 056 m s therefore a first order filter below was implemented for a better estimation of the vertical speed v ˆ k 1 0 5 v k 0 5 v ˆ k where v k is the k th calculated vertical velocity v ˆ k is the k th filtered velocity fig 21 demonstrates the filter performance through two cycles of dive the upper subfigure shows that the filtered velocity is more precise than the calculated one the deviation between the measured depth and the estimated depth reconstructed with filtered velocity is demonstrated in the lower subfigure where it is obvious that the higher the speed is the bigger the error of the estimation is note that the velocity information is mainly used in the assessment of the gliding motion rather than completing the gliding control loop in this work the vehicle has the feature of pitch buoyancy coupling adjusting the buoyancy will accordingly change the attitude and affect the gliding velocity since the ahrs system can measure the attitude accurately the gliding motion controller is thus designed to actuate the buoyancy engine to track the desired pitch attitude instead of the buoyancy or velocity 5 1 1 free planar glide the couple relation of the linear and pitch motions of the prototype was firstly studied through the experiment of a free gliding to 40 m depth fig 22 the free glide was defined as a four stage sequence of operation the first stage from 0 s to 21 4 s started with the bladder deflation at the surface and continued until the vehicle dived over 1 m below the surface the second stage from 21 4 s to 155 3 s was a free downward glide with no inflation or deflation control from 1 m to 40 m in this stage the bladder was passively compressed by the ambient pressure and therefore its displaced volume varied with depth the third stage from 155 3 s to 315 s lasted from the moment the vehicle descended over 40 m until it rose back to 40 m again during this time the inflation valve kept opened to inflate the bladder without extra control the last stage from 315 s to 377 s consisted of a free upward glide from 40 m to surface with no inflation or deflation control during the period of the glide the rotatable mass was fixed at β 9 0 to reject rolling disturbance and thus maintain ϕ 0 the rolling stability in the upward and downward glides is proved to be relatively good in the presence of current in the free downward glide the bladder kept shrinking as the depth increased resulting in an increasing nose down attitude and glide speed in the free upward glide the nose up attitude and glide speed also showed increasing tendency due to the continuous expansion of the bladder as a result of the decreasing ambient pressure as shown in the figure the second stage lasted about 2 2 min while the fourth stage took about 1 min the average rising velocity is about twice faster than the average diving velocity the diving velocity reached 0 64 m s at about 7 1 pitch angle while the rising velocity accelerated to 0 94 m s at near 90 pitch angle a significant feature that the increasing downward velocity gradually came to equilibrium is captured from 140 s to 155 3 s this equilibrium is reached after the bladder cannot be squeezed any more i e m b 0 and m b 0 therefore as for the dive of the prototype with the bladder completely compressed the maximum velocity is approximately 0 64 m s along with the max pitch of 7 1 at the beginning of the third stage a dissonance between the variations of pitch angle and downward velocity are observed the pitch angle increased rapidly over 0 in 21 1 s and over 40 in 56 9 s after the inflation started at 155 3 s this was an aggressive nose up maneuver however the vehicle still descended in the meantime and finally touched the lake bottom at 51 m depth before it started rising at 270 s consequently a large aoa was encountered by the vehicle deteriorating the hydrodynamic performance the problem is mainly caused by the great downward inertia of the body at the maximum descending rate and the slow buoyancy regulation in deep water as for the latter fact it is found out that the prototype has a large trim by the stern with about 40 at neutral buoyancy besides the great ambient pressure will slow down the inflation therefore the vehicle was still negative buoyant but decelerated during pitch angle changing from 7 1 to 40 this behavior is repeatedly observed in the transition from a downward to an upward glide of the following gliding experiments the braking problem is common for ug due to the lack of direct control force from the propeller a practical solution is to adjust the vehicle s buoyancy in advance of reaching the target depth but this control strategy is not included in this work since our preliminary goal is to identify the system s basic functionalities it should also be pointed out that the sharp deceleration from 155 3 s to 200 s in the figure is not the true velocity response because the pressure sensor was mounted at the head the rapid pitch motion due to the inflation diminished the difference between two sequent depth measurements even if the vehicle was still descending making the calculated velocity experience a sharp decrease but the velocity of cg was still faster than the calculated one in the fourth stage the vehicle had a free and accelerating rise without any control during the period the decreasing ambient pressure made the bladder continuously expand without active inflation thus the buoyancy unceasingly increased and the cb kept shifting forward which resulted in an upward acceleration and an increasing pitch motion 5 1 2 controlled planar glide controlled planar glide was further studied by applying a well tuned pd controller for pitch motion figs 23 and 24 respectively show the photograph and the results of a representative controlled planar gliding with a 2 0 pitch angle in descent and 45 pitch angle in ascent during the tests the rotatable mass was fixed at the position of β 9 0 to prevent the vehicle from rolling the vehicle started the controlled inflation for the bladder to float up right after it dived over 8 m and activated the controlled deflation to descend once it rose to 2 m disturbance on pitch dynamics was normally experienced by the vehicle when it surfaced and partially emerged from water the results prove the effectiveness of the utilized pd algorithm for pitch attitude tracking note that the pd controller is tuned well only for operations in shallow water as the operation depth gets deeper the inflation and deflation characteristics of the buoyancy engine change due to the increased ambient pressure therefore the parameters tuned well for the shallow zone will worse the performance of pd controller working in deeper depth a control scheme that can tackle the varying properties of the actuators of the system is a challenge and still under developing these tests primarily studied the motion characteristics of the prototype including the relationship between the vertical velocity and the pitch angle in a steady glide these features are independent of the operation depth or the performance of actuators a group of controlled planar gliding tests were conducted with different desired pitch angles θ d from 4 5 to 45 each test composed of at least five cycles of glide with the same desired pitch angle to obtain an average result table 2 shows the statistics of the vertical velocity and the pitch angle in steady glides recall that the aforementioned glide paths with pitch angle from 0 to 40 indicate the unstable transition stage from descent to ascent with large aoa and poor hydrodynamics therefore there is no analysis for these glide paths 5 1 3 turning glide since the prototype with no control surface roll yaw coupling is the only approach to turning glide to study the rolling behavior of the prototype first tests were carried out by fixing the rotatable mass in a variety of positions β in controlled glides with 2 0 downward pitch angle and 45 upward pitch angle the roll response to different rotatable mass positions are listed in tables 3 and 4 it is found out that the vehicle has a symmetrical rolling behavior as a function of the rotatable mass position from 10 to 170 but the symmetry of rolling behavior is deteriorated when gliding upward obviously in the upward glides the vehicle rolled to the left by 18 4 when the rotatable mass was in the leftmost position β 10 while it rolled to the right by only 12 6 when the rotatable mass was in the rightmost position β 170 this is mainly attributed to the non uniform expansion of the bladder due to the manufacturing issue the inflated off the shelf bladder has its right and up sides bigger than the left and the bottom therefore the cb will offset toward the right and up from the center when the vehicle floats up by inflating the bladder which makes a roll to the left greater than a roll to the right based on the rolling characteristic turning maneuver was then tested and demonstrated by fixing rotatable mass in a position where β 1 5 in a controlled glide with 20 downward pitch angle and 45 upward pitch angle the results are recorded in fig 25 in the downward glide the vehicle had an average roll of 16 8 to the left and thus yawed to the left with the rate of 2 8 s in the upward glide the vehicle maintains an average roll of 13 6 to the left but performs a yaw motion in a reverse direction to the right with the rate of 0 5 s the opposite change of yawing direction after the transition between a downward path and an upward path is normal for ugs which is primarily determined by the position of wings graver 2005 nevertheless the turning rate of the descent and the ascent are quantitatively different a leading cause is the top bottom asymmetry of the used airfoil which is originally designed for aircraft this airfoil can provide good hydrodynamic force at a positive aoa in a downward glide but has poor hydrodynamics at a negative aoa in an upward glide therefore the steering ability got worse in the upward glide with a steeper pitch angle of 45 besides that the offset of the cb position caused by the asymmetrical inflation of the bladder made the heel angle to the left in descent greater than that in ascent therefore the vehicle had a slower turning behavior when floating up 5 2 steady float at the surface in practice the prototype vertically rests on the water s surface with the arms either folded or unfolded after the rotatable mass shifts to the position of β 27 0 folding the arms will lower the cg position below the cb which always produces a restoring moment to right the tilting body on the contrary the cg is higher than the cb when the arms are unfolded as discussed in section 3 3 the bladder should maintain its maximum volume to provide the vehicle with sufficient metacentric stability to float steadily at the surface fig 26 demonstrates two cases with different bladder inflation sizes where the bladder had an average 290 mm outer diameter and 160 mm inner diameter for the first case and had its maximum dimension with an average 420 mm outer diameter and 250 mm inner diameter for the second case note that the prototype in both cases were positive buoyant in the first case fig 26 a the vehicle with its arms unfolded was initially placed in an upright position at the surface but rapidly overturned in the second case fig 26 b the vehicle was successfully stabilized at the surface thanks to the enough metacentric stability provided by the bladder to evaluate the metacentric stability the vehicle was forced to heel toward different directions to find the critical heel angle at which the vehicle can no longer right itself through a serials of tests a 28 minimum angle of vanishing stability was identified this fact evidences a certain degree of seakeeping quality for the vehicle 5 3 level flight because of the experiment site constraints and the attitude adjustment limitation of the utilized flight controller level flight has yet to be practically performed and tested for the prototype to characterize the level flight performance computational fluid dynamics cfd technique was applied for the present study consider the vehicle in steady horizontal flight with different aoas and velocities the aerodynamics of the prototype are shown in figs 27 and 28 as a function of aoa and velocity as known from fig 28 lift to drag l d ratio is not determined by the cruise velocity but the aoa the peak l d ratio 3 92 happens at 7 aoa recall that eqs 22 23 and 24 always hold in a steady level flight by using eq 22 and extrapolating from the data sets in figs 27 and 28 the forward velocities of steady level flight with different aoa are calculated fig 29 the results show that the vehicle will fly faster in a level flight with a more horizontal attitude which indicates a smaller aoa and the fastest speed of about 66 4 m s can be reached by the vehicle at a zero aoa though the flight slows down as the aoa increases the speed hardly changes when the aoa exceeds 10 based on the aerodynamic data and the above velocity information the requisite control forces of steady level flight can be determined through eqs 22 23 and 24 which are shown in fig 30 the greatest control efforts i e 142 38 n 14 53 kg maximum thrust and 7 09 n m maximum pitch torque of the propulsion are needed for a completely horizontal flight α 0 the most efficient level flight happens at 6 aoa and 31 5 m s with 44 95 n 4 59 kg minimum thrust and 1 47 n m pitch torque given the vehicle s weight of 18 kg and the propulsion characteristics in fig 19 it can be inferred that the propulsion power will reduce up to 79 9 percent when the vehicle transitions from vertical to level flight 5 4 vertical flight to test the stability and the maneuverability of the prototype in vertical flight trials including hovering and flying a rectangle path were carried out under manual control note that the prototype automatically stabilize its attitude and position under the control of autopilot but it can only fly a trajectory according to the pilot s command sent via rc fig 31 shows the prototype maintaining a steady hover in the air as other researches have studied the wings impose an adverse effect on the tail sitter uav subject to crosswind in our experiment the prototype indeed suffered from slight wind pushing the vehicle away but the vehicle succeeded in stabilizing itself fig 32 displays the actual rectangle trajectory that the prototype flied under the pilot s control note that the breeze was encountered frequently by the vehicle while it flied above the lake surface the practical operation proves the flight stability and maneuverability of the vehicle and evidences the capability of carrying out tasks in confined space 5 5 water air transition the transition consists of two stages the first one is the transition between underwater glide and vertical float at the surface the second one is the water exit or water entry process fig 33 demonstrate the transition maneuver of the prototype between a glide and a vertical float before takeoff it requires the maximum bladder volume and the rotatable mass position of β 27 0 for the vehicle prior to raising the arms these maneuvers set the vehicle in an upright position and prevent overturn if the vehicle capsizes refolding the arms can bring the body back to vertical orientation again if the vehicle tempts to glide after landing the arms will be folded at first after that the rotatable mass shifts to the position of β 9 0 to incline the body forward and obtain enough bottom heaviness then the vehicle can start gliding by deflating the bladder figs 34 and 35 respectively show the time stamped photograph sequence of water entry and exit of the prototype in the tests the surface condition was not quite good the vehicle encountered random wave and wind disturbance despite the unfavorable surface condition the takeoff and landing maneuvers were repeatedly successful the prototype was able to reject some disturbance and go through the water s surface smoothly the results strongly prove the benefits of a well metacentric stability design and a vtol water air transition profile to the proposed hauv in addition good maneuverability of the vertical flight allows for any transition velocity within the speed range of the vehicle however the exit and entry velocities should be optimized with the concerns of energy saving and structural integrity in the presence of water impact in the air to water ingress the fast speed indicates a low power of the propulsion to the extremity powering off all the rotors gives the vehicle a free fall into water but the faster the entering speed is the heavier the impact force exerted on the fuselage is this increases the risk of structural fracture moreover lowering the propulsion power may weaken the ability of disturbance rejection therefore the optimal entering velocity trajectory should be selected with a careful and comprehensive consideration in the water to air egress it takes time for the floodable wings to passively drain out the entrained water the drain time is dominated by the motion of the wings the interior structure and the open of the wings stewart et al 2019 if the vehicle leaves water fast the adverse effect of the hydrodynamic damping and the entrained water becomes significant making the vehicle weigh heavier temporarily the power consumption of the propulsion will consequently increase though a slow water exit process helps to mitigate the problem it prolongs the duration of the exit and thus expends more energy therefore the takeoff velocity should be optimized by considering the aspects of the water resistance the draining dynamics of the entrained water and the energy consumption 6 conclusion an improved concept of the multimodal hauv has been presented in this paper it is designed to be versatile for performing level and vertical flight hovering surface drifting and underwater glide which aims at extending application scenarios and operation endurance as many as possible compared to the current systems four following improvements have been made first a high pressure pneumatic buoyancy system is designed for longer and deeper operation underwater second a rotating mechanism is added for turning glide and switching operation modes in the water third hexacopter configuration is implemented for greater payload capacity fourth folding arm structure is fulfilled for better hydrodynamics of glide to ensure the viability of the proposed concept the paper presents design principles related to the planar gliding performance the realization of mode switch between glide and vertical float the metacentric stability at the surface and the level flight performance these principles are key to the proper management of the buoyancy and the weight of the vehicle with the basis of the above design considerations a proof of concept prototype named nezha iii has been fabricated and tested due to the site specific constraints and the attitude limitation of the commercial flight controller level flight have yet to be practically performed numerical method was implemented instead to evaluate level flight performance the simulation results confirm a better efficiency of the level flight than the vertical flight in the vertical flight the good maneuverability and stability of the prototype were demonstrated even though there existed disturbance caused by the winds the motion performance underwater was assessed by a series of gliding tests the free glide experiment confirmed the buoyancy engine could operate at 50 m depth and the results also confirm the predicted pitch buoyancy coupling of the proposed vehicle in addition pitch is much more sensitive to the buoyancy change than the velocity then controlled planar glides were achieved by applying a pd controller for pitch attitude tracking in the controlled glide experiments the quantitative relationship between the pitch angle and the steady vertical velocity of glides have been obtained after that rolling behavior and the consequent roll yaw coupling performance were evaluated through turning tests finally the ability of repeated water air transition was successfully proved even in the presence of wave and wind disturbances there are still lots of works to be done to improve the present design more elaborate analysis of the aero hydrodynamics of the vehicle especially for the airfoil are needed to optimize the design a comprehensive controller that can effectively deal with the variation of the buoyancy engine s performance versus depth is underway development of a flight controller compatible with level and vertical flight is also crucial moreover the optimization of the velocity profile of the water air transition plays a significant role in real applications credit authorship contribution statement di lu conceptualization methodology formal analysis investigation writing original draft visualization chengke xiong formal analysis investigation data curation visualization hexiong zhou investigation formal analysis chenxin lyu investigation data curation rui hu investigation data curation caoyang yu methodology software zheng zeng conceptualization supervision project administration lian lian supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work was supported in part by the national natural science foundation of china under grant 41706108 in part by the shanghai sailing program china under grant 17yf1409600 and in part by the open project of pilot national laboratory for marine science and technology qingdao china under grant qnlm 2016orp0104 
