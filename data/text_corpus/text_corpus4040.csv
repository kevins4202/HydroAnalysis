index,text
20200,in the present study the nonlinear bubble plate interaction is investigated via boundary integral bi simulations with a particular focus on the effect of fluid structure interaction fsi a series of experiments of electric discharge cavitation bubbles are also conducted to gain more physical insights good agreement between bi simulations and high speed recordings is obtained the effects of two geometrical parameters including the normalized stand off distance γ and the plate bubble size ratio θ both scaled by the maximum bubble radius are investigated systematically we find four types of distinct bubble collapse patterns namely contacting jet that impacts the plate directly non contacting jet that impacts a layer of liquid collision of two axial jets and no evident jet a detailed phase diagram for the bubble collapse pattern is given in a large parameter space through the comparison of bubble dynamics near a movable and a fixed plate the fsi effect is found to induce a significant increase in the jet impact velocity and the corresponding impact pressure we also give a criterion condition for neglecting the fsi effect finally we find two scaling laws for the plate motion with respect to γ which can be explained using a semi analytical model keywords fluid structure interaction bubble dynamics cavitation bubble boundary integral simulation 1 introduction the interaction of pulsating bubbles and a nearby structure is of great importance in underwater explosion li et al 2019b klaseboer et al 2005a brett and krelle 2018 geological resources exploration li et al 2020 de graaf et al 2014 cavitation erosion zhang et al 2016 philipp and lauterborn 1998 xu et al 2021 cheng et al 2020 ultrasonic cleaning chahine et al 2016 gonzalez avila et al 2011 and medical surgery chen et al 2011 ohl et al 2006 etc the pulsating bubbles perturbed by the presence of adjacent structures could induce asymmetric flows leading to the structural motion which in turn affects the aspherical bubble evolution previous experimental studies indicate that individual bubbles collapsing in the neighborhood of solid boundaries undergo typically physical processes for instance axial jet formation hu et al 2021 lechner et al 2019 ni et al 2015 and emission of shock waves lindau and lauterborn 2003 the shock waves emitted upon jet impact and during rebounding are commonly considered candidates for cavitation erosion due to their high pressure amplitude of considerable and particular interest is the jet formation during the late collapse phase philipp and lauterborn 1998 found that the jet speed reaches 150 m s with a small bubble wall distance recently lechner et al 2019 reported a much faster and sharper jet of 1000 m s when a bubble collapses in extreme neighborhood of a rigid wall such a high speed jet impingement might generate deleterious effects on the nearby structure and is widely recognized as another factor that takes responsibility for the erosion of solid materials the early works mainly concentrate on the interaction between bubbles and rigidly infinite walls however the structures in the vicinity to bubbles are observed to experience significant motion under the bubble impulse wu et al 2017 borkent et al 2008 hence the structural motion should be carefully considered to model the real bubble dynamical behaviors taking the transient bubble structure interaction into consideration li et al 2016 2018a and cui et al 2018 demonstrated that the movement of the structure dramatically increases the jet velocity of spark produced bubbles jets with higher speed maximum velocity of 450 m s are found when the floating ice plate becomes thinner in the experiment cui et al 2018 furthermore the shooting of a small particle by attached cavitation bubbles is observed experimentally borkent et al 2008 gonzalez avila et al 2011 poulain et al 2015 and numerically li et al 2018b similar to the jet mechanism the collision of particles with materials probably causes more serious wear of surfaces in silt laden flow borkent et al 2008 for large scale structures the underwater explosion bubble dynamics near submerged bodies are investigated by klaseboer et al 2005b and li et al 2013 wang et al 2018 and zong et al 2015 studied the interaction between rigidly fixed freely movable floating structures and underwater explosion bubbles their studies revealed the shortening of bubble period modification of re entrant jet formation and the reduction of pressure load on the structures due to the fluid structure interaction fsi besides more intricate bubble dynamical behaviors are expected to occur such as counter jet formation neck phenomenon and bubble splitting some researchers further extended their researches into the bubble dynamics near deformable structures lokar et al 2021 wu et al 2021 what is the criterion condition for neglecting the effect of fsi on the bubble dynamics to the best knowledge of the authors there is no clear answer for this important question this is our first concern additionally the structural response during the bubble structure interaction has been little explored this is the second concern of the present study particularly we find the scaling laws for the maximum velocity and displacement of the structure in the present study we adopt a thin circular plate for simplicity to investigate the bubble structure interaction the high voltage underwater discharge technique is employed to produce single bubbles while the high speed imaging is exploited to record the bubble evolution and the plate dynamics the boundary integral bi simulations are further used to provide more information in this fsi system the rigid body motion of the plate is incorporated in the present bi model using auxiliary functions we investigate the dynamical behaviors of the bubbles at various distances from the plate with special attention on the situation of a bubble in contact with the plate some new features are observed experimentally and reproduced by our bi model in addition the criterion condition for neglecting the fsi effect is obtained finally we present two scaling laws for the maximum velocity and displacement of the plate which have not been reported before this paper is structured as follows the numerical model is briefly elaborated in section 2 in section 3 we give a basic introduction to the experimental set up some results are presented in section 4 regarding the bubble dynamics at various stand off distances we focus on the collapse patterns and the pressure loads on the structure in section 5 the effect of size ratio θ is further investigated conclusions are drawn in section 6 2 numerical model a schematic diagram of the considered problem is shown in fig 1 the circular plate is characterized by three quantities i e radius r plate thickness t plate and density ρ plate the bubble initially assumes spherical with its radius and inner pressure denoted by r 0 and p 0 respectively the relative position of the plate and the bubble is determined by the distance d from the bubble center to the proximal plate surface the initial distance at bubble inception is d ini a cylindrical coordinate system o r α z is used in our model the origin o is located at the initial bubble center and z axis points rightwards 2 1 basic formulation for bi simulations since the reynolds number defined as r e v mean r m ν where v mean is the mean velocity of the bubble wall r m is the maximum bubble radius and ν is the kinematic viscosity of liquid of the considered problem is in the order of o 1 0 5 the viscosity plays a minor role in the bubble dynamics the compressibility of liquid can also be ignored for cavitation bubbles during most of the first period best and kucera 1992 based on the above mentions the fluid is assumed to be inviscid incompressible and flow irrotational in the current model therefore the velocity potential ϕ can be introduced and satisfies laplace s equation 1 2 ϕ 0 the above equation is equivalent to the following integral representation which is more generally used in numerical models 2 θ p ϕ p s ϕ q n 1 p q ϕ q n 1 p q d s q where θ is the solid angle p is the field point q is the integral point on surface s which comprises the bubble surface s b and the plate surface s plate n is the outward normal at the domain boundary we introduce a dimensionless system for the convenience of discussion a set of characteristic quantities including the maximum bubble radius r m the density of liquid ρ and the pressure difference δ p p p v are chosen to normalize length density and pressure where p is the ambient pressure at the level of z 0 at infinity and p v denotes the saturated vapor pressure consequently time is scaled by r m ρ δ p 1 2 velocity by δ p ρ 1 2 velocity potential by r m δ p ρ 1 2 here two important parameters including dimensionless stand off distance from the initial bubble center to the proximal plate surface γ and size ratio of the plate and the bubble θ are defined as follows 3 γ d ini r m 4 θ r plate r m note that all below physical quantities with subscript are in dimensionless form in this article the kinematic and dynamic boundary conditions on s b are given by 5 d r d t ϕ 6 d ϕ d t 1 1 2 ϕ 2 p b where r represents the position vector of the bubble surface the buoyancy is omitted owing to its negligible effect on the dynamical behaviors of both the small scale bubble and the plate p b is the pressure of the non condensable gaseous contents inside the bubble zhang et al 2001 it reads 7 p b p 0 v 0 v κ where p 0 is the initial bubble internal pressure κ is the specific heats ratio which equals 1 4 in this paper v 0 and v are the bubble volume at inception and at the current time instant respectively surface tension is neglected because it hardly plays a role in centimeter sized cavitation bubble dynamics the impermeable condition imposed on s plate reads 8 ϕ n u n where u is the velocity of the plate n is the unit normal vector at the boundary we restrict the variation of ϕ at every step by an adaptive time stepping scheme zhang et al 2001 to maintain the numerical stability 9 δ t c max d ϕ d t where c is a constant 2 2 auxiliary function for fsi modeling in this study we focus on the role of fsi in pulsating bubble dynamics thus the fsi effect should be carefully considered in the simulation due to the symmetry of the problem the motion of the structure is along the z axis one dimensional motion the hydrodynamic loading f hydro can be obtained by the integration of the pressure over the plate surface li et al 2018a 2019a written as 10 f hydro s plate ϕ t 1 2 ϕ 2 p n d s the ϕ t term seems solvable by differentiating nodal velocity potential with respect to time duncan et al 1996 kalumuck et al 1995 however it is evident that this finite difference method has insufficient accuracy in modeling the movable objects because it indicates the substantial derivative instead of the partial derivative we employ another more accurate method namely auxiliary function method li et al 2016 to deal with ϕ t this term is divided into three parts as follows 11 ϕ t ψ η u ϕ where ψ and η are two auxiliary functions that can be readily solved the neumann condition wu 1998 li et al 2016 of ϕ t on s plate can be written as 12 n ϕ t a n u ϕ n where a is the acceleration of the plate in this work a r a α 0 due to the axisymmetrical configuration another auxiliary function ς is introduced to decouple the dependence of a and ψ it reads 13 ς ψ a the dirichlet boundary condition li et al 2016 of ς on s b is given by 14 ς 0 the neumann boundary condition li et al 2018a of ς on s plate is expressed as 15 ς n n z on substitution eqs 11 13 and 14 into bernoulli s equation the boundary condition li et al 2016 of η imposed on s b is obtained 16 η u ϕ 1 p 0 v 0 v κ 1 2 ϕ 2 substituting eqs 11 13 and 15 into eq 12 leads to the boundary condition li et al 2018b of η imposed on s plate as follows 17 η n 0 all boundary conditions of ς and η hitherto are known they can be obtained in a similar manner of solving ϕ eq 10 can be rewritten as 18 f hydro s plate η u ϕ 1 2 ϕ 2 p n d s s plate a ς n d s substituting eq 18 into newton s second law of motion results in 19 m s plate ς n z d s a s plate η u ϕ 1 2 ϕ 2 p n z d s where m is the dimensionless mass of the plate here we give the calculation procedure of the fluid structure coupling system as follows 1 data preparation and initialization 2 begin the time stepping 3 solve the bi equation and calculate the velocity ϕ on the boundaries of the flow domain 4 calculate the auxiliary function ς using its dirichlet boundary condition eq 14 and neumann boundary condition eq 15 5 calculate the auxiliary function η using its dirichlet boundary condition eq 16 and neumann boundary condition eq 17 6 use eq 19 to calculate the structural acceleration a 7 update the position vector r of the bubble using the kinematic boundary condition eq 5 8 update the velocity potential ϕ of the bubble using the dynamic boundary condition eq 6 9 update the structural velocity u position vector r and the internal pressure inside the bubble p b 10 increment time and return to step 3 if time does not reach the setting time 2 3 vortex ring model in the traditional bi simulations severe numerical difficulties would be encountered when jet transverses the opposite bubble surface the flow solution becomes non unique because there exists a potential discontinuity around the jet impact region wang et al 1996a li et al 2020 we use a vortex ring model li et al 2020 to cope with this problem and gain more features of toroidal bubbles a brief introduction to this model is presented and the reader is referred to wang et al 1996a zhang and liu 2015 for more details the circulation of the vortex ring equals the potential jump at the impact point the total potential ϕ consists of two components the vortex ring induced potential ϕ v and the single valued remnant potential ϕ r expressed as 20 ϕ ϕ v ϕ r also the total velocity consists of the vortex ring induced velocity v v that is calculated by a semi analytical approach zhang and liu 2015 and the remnant velocity v r that is obtained from bi simulations 2 4 bubble plate contact model when the bubble is initiated very close to the structure it would be in contact with the structural surface the produced jet may intensely impinge onto the structure upon collapse if the liquid film between the bubble and the structure is compressed to of comparable size to local mesh numerical instabilities appear in the simulation following ni et al 2015 a bubble plate contact model is exploited to handle this problem supposing δ l is the minimal element length of the bubble the bubble surface and the plate surface are joined once the film thickness is less than δ l what is more the joined region is under the control of a critical distance l critical the formed gas liquid solid intersection line is treated specially more details on the intersection treatment are referenced to ni et al 2015 for the attached bubble the external force f acting on the plate can be rewritten as 21 f f hydro f gas s wet η u ϕ 1 2 ϕ 2 a ς n z d s a dry p b p e z where f gas is the gas produced force that acts on the plate s dry surface with its area denoted by a dry s wet is the wet surface of the plate e z is the unit vector in z direction upon jet impacting on the plate surface directly this model would be utilized again to simulate the toroidal bubbles in contact with the plate the bubble nodes around the jet tip and with a distance from the plate of less than l critical would be stretched onto the plate surface generating another gas liquid solid interaction line 3 experimental set up as shown in fig 2 the high voltage underwater discharge dc 650v technique is utilized to generate an electric spark that evaporates the tap water to nucleate a single cavity the bubble is produced on the symmetrically axial line at a distance d ini from the circular plate s proximal surface a high speed camera phantom v12 1 is placed in front of a transparent water tank 50 cm 50 cm 50 cm to record the bubble and plate dynamics with a framing rate up to 20000 fps we adopt a convenient method to adjustably position the plate by establishing a pendulum system using two thin nylon strings about 200mm length with one end tied to the plate another end fasten at a supporting platform the tension of the strings on the whole balances the vertical gravity and buoyancy of the plate besides the vertical displacement of the plate during the bubble periods is much less than the length of the strings therefore it is omitted in our experimental and numerical investigations the bubble inception is approximately located at the center of the cubic tank so the tank walls effect on the bubble dynamics is negligible two copper electrodes with a radius of 0 1 mm are so thin that their influences on the bubbles are trivial the discharging of the capacitors contained in the high voltage discharge device and the capturing of the camera are triggered synchronously all experiments are diffusely illuminated from back and side by two 300 w led lights the circular plate used in the experiments is made of 5052 aluminum alloy and has dimensions of 20 mm 4 mm radius and thickness with its density being 2 66 g cm 3 the radius of the generated bubbles is 15 2 0 6 mm which is obtained from more than 10 experiments 4 results in this section four selected scenarios of bubble dynamics from experiments and simulations are presented by varying the stand off distance the mechanisms of distinct bubble collapse patterns are analyzed the pressure histories at the center of the near side plate surface are given to shed light on the damage potential of the bubble 4 1 no jet a typical sequence of experimental images and simulated bubble profiles is shown in fig 3 in the experiment d ini 34 4 mm and r m 15 8 mm according to the experimental configurations the parameters in the computation are r 0 0 1297 p 0 200 γ 2 18 θ 1 27 note that an arbitrary selection of p 0 scarcely influences the bubble collapse pattern klaseboer et al 2005a blake et al 1986 hence we set p 0 200 to match the experimental periods of bubbles in this paper the computed outlines bubble in red dashed line plate in gray dashed line are superimposed on the experimental observations to verify the model in this and following sequences of bubble dynamics corresponding times in experiments in italic and computations in regular are marked at the left bottom and right bottom of each frame respectively the bubble maintains its sphericity during most time of the first oscillation in this case no jet can be found in both the experiment and the simulation in this context we name this collapse pattern as no jet due to the quasi spherical collapse of the bubble furthermore the plate undergoes a very weak response during the bubble pulsating periods to further validate the code the radius histories of the bubbles obtained from the simulation and the experiment are presented in fig 4 despite the discrepancy in the early expansion that the numerical bubble owns a larger radius than the experimental one superior agreements are achieved during the first bubble period this deviation can be interpreted by that the computation neglects the complex bubble inception procedure by inserting a high pressure bubble into the liquid instantaneously at the rebounding stage the maximum bubble radius decreases because of the emission of acoustic waves lindau and lauterborn 2003 supponen et al 2017 which is beyond the scope of this article 4 2 jet collision fig 5 a portrays a comparison of experimental images and simulated dynamics when the bubble is produced closer to the plate the experimental configurations are r m 15 0 mm and d ini 20 0 mm while in the simulation γ 1 33 and θ 1 33 the bubble expands violently with its right interface slightly flattened by the plate frames 1 3 during the early and middle stages of collapse the right bubble wall is retarded by the plate hence it obtains higher curvature than other parts frames 4 6 whereas the small collapsing bubble does not allow the visualization of the bubble interior frame 7 the detailed bubble collapse pattern can be inferred from the simulation result then the bubble collapses to its minimum volume and re expands accompanied by prominent migration towards the plate frames 8 10 the energy dissipation in the process of shock waves emission supponen et al 2017 cui et al 2020 lindau and lauterborn 2003 leads to the discrepancy between the simulation and the experiment the first row in panel b depicts the dimensionless pressure and velocity fields of frames 4 6 and 7 in panel a the second row for the moments of the jet strike t 1 924 of reaching the minimum bubble volume t 1 928 and during the bubble rebounding phase t 1 969 the right bubble wall obtains higher curvature at the contraction stage than other bubble parts frames 1 2 as pointed by lauterborn 1982 the more curved bubble wall is easier to develop a jet thereby the thrill right bubble wall rapidly becomes flat simultaneously a high pressure region is formed on the left side of the bubble frame 3 afterwards a slower moving counter jet directed away from the plate develops while the high pressure drives a sharper and faster jet towards the plate finally they collide with each other frame 4 leading to the formation of a toroidal bubble a similar jet collision phenomenon is also found in a collapsing buoyant bubble below a free surface wang et al 1996b or above a solid wall blake et al 1986 1997 brujan et al 2001a b proposed a universal explanation that there exists a second pressure gradient opposite to the bjerknes attraction when investigating the dynamics of cavitation bubbles near an elastic wall we notice this study regarding the bubble movable structure interaction in some extends resembles the fore mentioned investigations the movable rigid structure provides a special boundary condition between a fully fixed wall and a freely elastic material which results in the occurrence of two opposite pressure gradients when γ is relatively large both the two pressure gradients have considerable effects on the bubble collapse pattern and the formation of liquid jets therefore two axial jets in opposite direction are produced in this case after jet impact a extremely high pressure region is formed around the impact region a protrusion is also observed at the moment of reaching its minimum bubble volume frame 5 subsequently the high pressure region around the right apex of the toroidal bubble translates towards the plate frame 6 this bubble collapse pattern is reasonably named jet collision because of the hit of two jets fig 6 shows the jet tip velocity v jet counter jet tip velocity v counter as functions of time in panel a and the pressure histories at the center of the proximal plate surface in panel b near the movable and fixed structures the corresponding parameters in the two cases are the same except for the mobility of structures as can be seen the maximum jet velocity in the movable case 31 6 is much higher than that in the fixed case 20 3 a counter jet could be generated in this movable case and its maximum velocity reaches 5 2 whereas no evident counter jet is observed in the fixed case the maximum velocity of the rightmost of the bubble also defined as v counter is 1 5 in the fixed case we estimate the momentum ω of the jets to determine their intensities using a similar approach of pearson et al 2004 at the moment of jet impact ω z 0 033 for the jet directed towards the plate ω z 0 0002 for the counter jet in the movable case while in the fixed case ω z 0 120 although the jet in the movable case owns a larger velocity its momentum is lower therefore the motion of the structure might diminish the jet impact in analogous to the finding of kalumuck et al 1995 the pressure magnitude in the movable case 26 26 is found to be much lower than that in the fixed case 103 5 during the first bubble cycle it can be explained by that the jet obtains lower momentum and the relative distance from the bubble to the plate is larger if considering the fsi then the pressure decreases rapidly due to the rebound and rises again because of the translation of the high pressure region frames 4 6 in fig 5 b the convergence concerning the mesh size is studied the tested node number of the bubble denoted by n is set as 80 110 140 and 170 respectively the bubble profiles before jet penetration are shown in fig 7 for the sake of presentation we rotate the bubble profiles by 90 degrees counterclockwise here as can be seen consistent results are acquired when n is not less than 140 therefore n 170 is chosen for all simulations in this paper 4 3 non contacting jet fig 8 shows the bubble evolution when the bubble is initiated closer to the plate in the experiment r m 15 1 mm and d ini 14 6 mm accordingly in the simulation γ 0 97 and θ 1 32 convincing agreement between the simulation and the experiment is obtained in panel a the right portion of the bubble becomes obviously flat during the expanding phase frames 1 4 at the collapse stage it obtains a lower collapsing velocity than other parts of the bubble due to the obstruction of the plate to the flow zeng et al 2020 blake et al 1993 frames 5 8 as a result a bubble elongated in the direction perpendicular to the nearest plate surface is attained in the subsequent collapse stage frame 7 near the end of the first bubble cycle a high speed jet develops at the left bubble wall and transverses the opposite bubble wall frame 8 the proximal bubble surface retains low curvature during the contraction stage which is different from the last case hereafter the jet penetrates the liquid layer between the plate and the structure then impacts upon the plate typical phenomena such as rough bubble surface and cavitation are observed in the rebounding phase frames 9 10 we classify this bubble collapse pattern into non contacting jet because the jet has to transverse the liquid layer first and then impacts the plate the first two frames in panel b give the dimensionless pressure and velocity fields of frames 6 and 7 in panel a the last four frames correspond to the moments of the jet impact t 1 935 just after the jet impact t 1 937 of the apparition of the protrusion t 1 942 and of the annular jet impact t 1 947 as shown in frames 1 2 the inflow near the right portion of the bubble is indeed slower than that near other portions of the bubble a high pressure region appears on the left side of the bubble and contributes to the jet strike frame 3 during the late collapse phase after the jet impact significantly high pressure is induced around the impact region frame 4 in addition to the formation of the protrusion an annular indentation occurs and further evolves into a jet resulting in the disintegration of the bubble frames 5 6 the dramatic migrations of the bubble centroid and the high pressure region towards the plate are also observed simultaneously frames 2 6 we perform another simulation where a fixed plate is employed for investigating the effect of the fsi the maximum jet velocity in the movable case 33 5 is much higher than that in the fixed case 20 2 as shown in fig 9 a panel b displays the time histories of the displacement of the bubble centroid the plate centroid and the variation of the relative distance between them during the expanding stage the bubble centroids in the two cases migrate away from the plate on the contrary the bubble migrates towards the structure in the subsequent collapse stage however the bubble in the movable case moves much faster than that in the fixed case at the very late stage of collapse during most of the first bubble cycle except near the formation of the jet the relative distance in the movable case is larger than that in the fixed case similar to the last case the bubble in the movable case is farther from the plate at the moment of the jet impact denoted by the diamonds however we observe an exceedingly high peak pressure of 378 4 in the movable case whereas in the fixed case the amplitude of the pressure is 152 1 not shown here comparing the results in this section and section 4 2 we find that the fsi may increase or decrease the pressure load on the plate depending on the stand off distance 4 4 contacting jet fig 10 compares selected frames of an experimental run with a simulation when the bubble is initiated very close to the plate the experimental configurations are d ini 5 8 mm and r m 15 2 mm whereby in the simulation the initial parameters are γ 0 38 and θ 1 32 the bubble is nucleated axisymmetrically on the left side of the plate frame 1 and grows violently in rapid succession frame 2 during the expanding phase the right interface of the bubble rapidly approaches the proximal plate surface frames 1 6 the bubble evidently takes on a flattened shape at the right side due to the retardation effect of the solid surface blake and gibson 1987 brujan et al 2018 concurrently the plate is pushed away from the bubble afterwards an annular neck near the intersection emerges during the early and middle collapsing stages frames 6 8 resulting in a mushroom shape bubble frame 8 at the distal side of the bubble that contracts faster than other parts of the bubble a rightward jet is produced and then impacts onto the plate directly frame 9 leading to the generation of an attached bubble torus in both this and the above case the wall induced bjerknes attraction is stronger than the second pressure gradient induced by the motion of the plate as the bubble plate distance decreases therefore only one jet directed towards the wall is generated the plate is found to be drawn back by the bubble during the collapse phase at t 1 984 the second bubble cycle begins frame 10 severe multiple cavitations occur at the early rebounding stage frames 11 12 during the re collapse phase a new feature that the detachment of the bubble from the plate is found which is attributed to the fast impact of the radial flow near the intersection frames 13 14 afterwards the bubble and the plate move away from each other frame 15 panel b depicts the dimensionless pressure and velocity fields the former four frames correspond to frames 2 5 8 and 9 in panel a while the latter two correspond to the moments after the jet impact t 1 975 and before the radial jet piercing t 1 991 as can be seen in frame 1 an outward flow is induced by the expanding bubble however the plate apparently hinders the rightward flow resulting in the flattening of the right bubble wall as the bubble approaches the plate the thickness of the liquid layer between them becomes less than the critical distance l critical which allows us to initiate the bubble plate contact model then the bubble over expands and reaches its maximum bubble volume frame 2 in the early collapse stage a neck near the intersection line is generated frame 3 additionally a high pressure region occurs near the left bubble wall at the very late stage of collapse the high pressure drives an intense jet directed towards the plate frame 4 it finally impinges onto the plate frame 5 causing the transformation from the singly connected bubble to the doubly connected form the jet impact generates a high pressure region near the plate s center which redirects the jetting flow perpendicular to the plate surface into a radial flow in the subsequent collapse stage the radial flow pierces the bubble along the plate surface frame 6 particularly we find the bubble shapes frames 4 6 during the very late collapse stage resemble that in the simulations of tong et al 1999 in the investigation on splashing effect a sharp corner shape is formed at the side surface of the bubble frame 4 it then collapses violently and moves around the interior bubble surface frames 5 6 which may suggest the side flow could be conveyed to impact the plate we name this bubble collapse pattern as contacting jet our simulation well reproduces the key features of the bubble plate interaction including the bubble growth collapse necking phenomenon jet formation and the structural motion fig 11 presents the sensitivity study about the critical distance l critical to verify the bubble plate contact model in panel a the bubble profiles before the jet impact are almost consistent with each other when l critical is not more than 2 2 δ l in panel b the comparison of the structural displacement between three simulations and the experiment is given the results of three simulations correlate with each other well furthermore good agreement between the computations and the experiment is obtained in panel b we find that the plate is pushed rightwards in the expanding stage and pulled leftwards in the collapsing phase to elucidate the influence of the structural movement on the damage potential we compare the jet tip velocity histories and pressure histories at the center of the near side plate surface near the movable and fixed plates in fig 12 the configurations are the same as in fig 10 as shown in panel a the maximum jet velocity in the movable case 16 7 is almost 1 77 times that in the fixed case 9 45 just after the jet impact the pressure in the movable case sharply increases to the first peak pressure 264 5 which is about three times that in the fixed case 86 7 thereafter the highest peak pressure 304 8 is reached due to the continuing compression of the bubble and the impact of a sideways jet a marginal rise of the pressure then occurs owing to the piercing of the redirected jetting flow there are also two pressure peaks between the jet induced pressure peak and the highest pressure peak in the fixed case one is due to the impact of the side flow as previously mentioned and the other is due to the piercing of the radial jetting flow along the plate we find that in the movable case the duration of the collapsing pressure 0 021 is shorter than that in the fixed case 0 058 but it gains higher impulse as shown in panel b to summarize the motion of the plate gives rise to higher damage potential of the bubble 5 discussion the bubble plate interaction is influenced not only by the stand off distance but also by the inherent properties of the structure namely the dimensionless radius thickness and density of the plate taking all these factors into consideration makes this study extremely complicated in section 4 the effect of the stand off distance on the bubbles is investigated moreover it is very important to explore the criterion condition under which the influence of the plate s movement on the bubbles can be ignored therefore we further systematically investigate the influence of θ and make some preliminary discussions on the thickness of the plate t plate finally we return to discussing the influence of γ on the responses of the plate 5 1 influence of θ on bubble dynamics the time evolution of the simulated collapsing bubbles near plates is illustrated in fig 13 with θ being 0 5 1 34 3 and the collapse is denoted by the outer to inner curves the gray rectangle located at the right side of each panel represents the initial position of the plate when θ 0 5 the curvature induced counter jet rushes through the bubble and then collides with the sharper jet due to the second bjerknes force blake et al 1986 at the late stage of collapse as shown in panel a as θ increases to 1 34 the elongated bubble and the jet directed towards the boundary are also observed while the curvature effect seemingly is unable to initiate a count jet as shown in panel b if θ 3 panel c the collapsing bubble shape partly resembles a bubble near a rigidly infinite wall panel d the right bubble wall becomes flatter as θ increases besides it is found that the smaller the θ is the smaller bubble volume at the moment of jet impact would be attained we use the maximum jet velocity to quantitatively characterize the influence of θ and t plate on the bubble dynamics due to its representation of surface damage fig 14 shows the maximum jet velocity as a function of θ with different plate thicknesses t plate 0 27 0 5 and 1 respectively the blue represents the results in movable cases while the red in fixed cases γ is set as 1 in all simulations besides the relative deviation in green of the jet velocity between the movable and fixed cases is given by v max mo v max fi v max fi the subscripts mo and fi mean the structure is movable and fixed respectively as shown in fig 14 the maximum jet velocity decreases as θ increases or t plate increases the jet velocity tends to converge to the result of a bubble collapsing near an infinite wall 8 26 denoted by the black dashed line as θ varies from 0 5 to 26 it is easily inferred that the deviation is due to the fsi effect therefore it may be regarded as an indicator of whether the fsi should be considered as θ increases the relative deviation increases first when θ 2 5 then decreases when θ 2 5 when θ 24 the relative deviation is 4 6 for t plate 0 27 4 4 for t plate 0 5 and 4 2 for t plate 1 so the fsi might be insignificant if θ 24 t plate 0 27 however when θ is relatively small the variation of θ changes the bubble collapse pattern see figs 13 15 the collapse patterns are also completely different for the movable and fixed cases in consequence the relative deviation no longer serves as an indicator it is also noticed that when θ is small the fsi is still prominent because the absolute deviation v max mo v max fi is large the high speed jet v max fi 55 when θ 0 5 leads to small relative deviations 5 2 classification of collapse pattern after performing hundreds of simulations a phase diagram for the simulated bubble collapse patterns is obtained in the γ θ space γ 0 2 2 2 θ 0 5 2 2 the thickness of the plate t plate is the same as in fig 5 note that the simulations are ceased before jet impact or reaching t 3 as shown in fig 15 the collapse patterns can be divided into four types namely contacting jet in red circle non contacting jet in green square jet collision in blue pentagram and no jet in gray triangle the adjacent regimes are separated by dashed lines in addition to the finding that the apparition of the contacting jet is mainly found when γ 0 6 we notice that if θ 0 6 the contacting jet also occurs when γ 0 7 furthermore the bubbles nucleated far from a small plate exhibit perfect sphericity and are unable to produce a jet as shown by the gray triangles at the right bottom of the phase diagram when γ 0 6 the non contacting jet forms the transition between the non contacting jet regime and the jet collision regime increases from γ 0 9 to γ 1 5 moreover the transition between the jet collision regime and the no jet regime also increases from γ 1 5 to γ 2 2 the reason is that with the enlargement of the plate radius the obstruction effect on the inward flow is strengthened so it is essential to increase the stand off distance to release this effect to produce a counter jet or no jet 5 3 scaling law for the structural response the time histories of the structural velocity for different γ are presented in fig 16 the plates are accelerated away by the expanding bubbles and then reach their maximum velocities denoted by crosses almost at the same time t 0 2 the plates then are decelerated in the late expansion stage from t 0 96 onwards the plate moves inversely towards the bubble near the end of the first cycle the structural velocity decreases to zero a significant decrease in the maximum structural velocity u max can be seen when γ increases from 1 1 to 6 to reveal the dependence of the structural responses on the dimensionless distance γ dozens of simulations are performed in a relatively large parameter space 0 2 γ 100 θ 1 33 panels a b in fig 17 show the relationship between the maximum velocity u max of the plate and the stand off distance γ panels c d present the maximum displacement of the plate d max as a function of γ as shown in the natural scaled panel a we find that u max is approximate to linearly decrease as γ increases from 0 2 to 1 1 consistent with the findings in bubble sphere interactions li et al 2018a herein an analogous trend of d max to u max in the range of γ 0 2 1 1 is shown in the natural scaled panel c obvious nonlinear relations can be observed when γ 1 1 as shown in panels a c as shown in the logarithm scaled panels b d we further discover following approximate power law relations 22 u max γ 2 23 d max γ 2 when γ is relatively large a semi analytical model is developed to explain the power laws we assume the bubble oscillates spherically when d ini is sufficiently large thus the continuity equation rayleigh 1917 describing the bubble induced flow can be expressed as 24 u r t r b t r 2 r b t where u r t denotes the radial velocity of fluid at distance r from the nucleation point at time t r b t denotes the instantaneous bubble radius a force balance model wu et al 2017 poulain et al 2015 gonzalez avila et al 2011 borkent et al 2008 can be used to model the motion of the plate 25 1 c m m d sgn u 1 2 c d ρ π r plate 2 u d t 2 ρ π r plate 2 t plate d u d t d t where c m and c d are the added mass coefficient and the drag coefficient respectively taken as two constants hence the structural velocity can be evaluated by integrating this motion equation with respect to time in eq 25 d is supposed to equal d ini due to the maximum displacement δ d d ini 1 2 γ 2 6 so the evaluated velocity of the plate at time t is given by 26 d c 1 d ini 4 0 t r b 4 r b 2 d t c 2 d ini 2 0 t 2 r b 2 r b r b r b 2 d t where c 1 c d ρ 2 1 c m ρ plate t plate c 2 ρ 1 c m ρ plate are two constants for a specific structure as shown in fig 16 the plate attains its maximum velocity around t 0 2 its maximum displacement during the expanding stage is reached around t 0 96 if γ 2 6 based on the assumption of the spherical oscillation of bubbles the integrals in eq 26 can be reckoned as constants when t t u 0 2 r m ρ δ p 1 2 or t t d 0 96 r m ρ δ p 1 2 the drag force term can be neglected because it is in the order of 1 d ini 4 while the inertia term is in the order of 1 d ini 2 furthermore the d u d t term in eq 25 is demonstrated to play a key role in the acceleration of structures in previous studies wu et al 2017 borkent et al 2008 the drag force due to viscous effect also should be omitted to match this numerical model based on potential flow method therefore we analytically obtain the power law relation using dimensionless form as eq 22 by integrating eq 25 with respect to time from 0 to t d twice and neglecting the drag force term we further obtain eq 23 comparing the analytical results with the computed results we find as γ increases the u max and d max indeed gradually depend on the inverse second power of γ see fig 17 6 summary and conclusions the transient interaction between a pulsating bubble and a movable plate is systematically investigated in this paper via bi simulations and spark produced cavitation bubble experiments firstly the numerical model was verified by comparison with experiments and mesh convergence tests then we analyzed the underlying mechanisms of four bubble collapse patterns at various dimensionless stand off distances γ the pressures on the structure were given to study the damage potential of the bubble subsequently we studied the influence of the size ratio θ and the dimensionless plate thickness t plate finally we investigated the dependence of the structural responses on γ the main findings are 1 four types of bubble collapse patterns are identified in a large parameter space 0 2 γ 2 2 0 5 θ 2 2 namely i contacting jet which impinges directly onto the plate ii non contacting jet which pierces through the liquid layer then impacts upon the plate iii jet collision between the counter jet directed away from the plate and the jet directed towards the plate and iv no evident jet a majority of the contacting jets occur when γ 0 6 see fig 15 for a phase diagram characterizing the collapse patterns in the γ θ space 2 the fsi effect is found to induce a significant increase in the jet impact velocity generally the peak pressure on the structure increases correspondingly in some rare cases the pressure deceases because the thickness of the liquid layer between the structure and the bubble increases which weakens the impact pressure of a high speed liquid jet 3 as θ increases from 0 5 to 26 the maximum jet velocity of the bubble in the vicinity to a plate decreases and gradually converges to the result of a bubble near an infinite wall when θ 24 and t plate 0 27 the relative deviation between the movable and fixed case is lower than 4 6 which may provide a criterion condition for neglecting the fsi effect 4 during the bubble expansion phase two scaling laws for the maximum structural velocity u max and displacement d max are found with respect to the normalized stand off distance γ for a strong fsi effect 0 2 γ 1 1 u max γ and d max γ for a weak fsi effect when γ is relatively large u max γ 2 and d max γ 2 credit authorship contribution statement zhen yu hu methodology investigation writing original draft visualization validation formal analysis shuai li conceptualization supervision software writing review editing shi ping wang funding acquisition data curation a man zhang resources supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we acknowledge dr shi min li for helpful assistance to our experiments this work is supported by the heilongjiang postdoctoral fund lbh q20016 the fundamental research funds for the central universities 3072020cfj0105 the industrial technology development program jcky2018604c010 and the natural science foundation of china 51925904 52088102 
20200,in the present study the nonlinear bubble plate interaction is investigated via boundary integral bi simulations with a particular focus on the effect of fluid structure interaction fsi a series of experiments of electric discharge cavitation bubbles are also conducted to gain more physical insights good agreement between bi simulations and high speed recordings is obtained the effects of two geometrical parameters including the normalized stand off distance γ and the plate bubble size ratio θ both scaled by the maximum bubble radius are investigated systematically we find four types of distinct bubble collapse patterns namely contacting jet that impacts the plate directly non contacting jet that impacts a layer of liquid collision of two axial jets and no evident jet a detailed phase diagram for the bubble collapse pattern is given in a large parameter space through the comparison of bubble dynamics near a movable and a fixed plate the fsi effect is found to induce a significant increase in the jet impact velocity and the corresponding impact pressure we also give a criterion condition for neglecting the fsi effect finally we find two scaling laws for the plate motion with respect to γ which can be explained using a semi analytical model keywords fluid structure interaction bubble dynamics cavitation bubble boundary integral simulation 1 introduction the interaction of pulsating bubbles and a nearby structure is of great importance in underwater explosion li et al 2019b klaseboer et al 2005a brett and krelle 2018 geological resources exploration li et al 2020 de graaf et al 2014 cavitation erosion zhang et al 2016 philipp and lauterborn 1998 xu et al 2021 cheng et al 2020 ultrasonic cleaning chahine et al 2016 gonzalez avila et al 2011 and medical surgery chen et al 2011 ohl et al 2006 etc the pulsating bubbles perturbed by the presence of adjacent structures could induce asymmetric flows leading to the structural motion which in turn affects the aspherical bubble evolution previous experimental studies indicate that individual bubbles collapsing in the neighborhood of solid boundaries undergo typically physical processes for instance axial jet formation hu et al 2021 lechner et al 2019 ni et al 2015 and emission of shock waves lindau and lauterborn 2003 the shock waves emitted upon jet impact and during rebounding are commonly considered candidates for cavitation erosion due to their high pressure amplitude of considerable and particular interest is the jet formation during the late collapse phase philipp and lauterborn 1998 found that the jet speed reaches 150 m s with a small bubble wall distance recently lechner et al 2019 reported a much faster and sharper jet of 1000 m s when a bubble collapses in extreme neighborhood of a rigid wall such a high speed jet impingement might generate deleterious effects on the nearby structure and is widely recognized as another factor that takes responsibility for the erosion of solid materials the early works mainly concentrate on the interaction between bubbles and rigidly infinite walls however the structures in the vicinity to bubbles are observed to experience significant motion under the bubble impulse wu et al 2017 borkent et al 2008 hence the structural motion should be carefully considered to model the real bubble dynamical behaviors taking the transient bubble structure interaction into consideration li et al 2016 2018a and cui et al 2018 demonstrated that the movement of the structure dramatically increases the jet velocity of spark produced bubbles jets with higher speed maximum velocity of 450 m s are found when the floating ice plate becomes thinner in the experiment cui et al 2018 furthermore the shooting of a small particle by attached cavitation bubbles is observed experimentally borkent et al 2008 gonzalez avila et al 2011 poulain et al 2015 and numerically li et al 2018b similar to the jet mechanism the collision of particles with materials probably causes more serious wear of surfaces in silt laden flow borkent et al 2008 for large scale structures the underwater explosion bubble dynamics near submerged bodies are investigated by klaseboer et al 2005b and li et al 2013 wang et al 2018 and zong et al 2015 studied the interaction between rigidly fixed freely movable floating structures and underwater explosion bubbles their studies revealed the shortening of bubble period modification of re entrant jet formation and the reduction of pressure load on the structures due to the fluid structure interaction fsi besides more intricate bubble dynamical behaviors are expected to occur such as counter jet formation neck phenomenon and bubble splitting some researchers further extended their researches into the bubble dynamics near deformable structures lokar et al 2021 wu et al 2021 what is the criterion condition for neglecting the effect of fsi on the bubble dynamics to the best knowledge of the authors there is no clear answer for this important question this is our first concern additionally the structural response during the bubble structure interaction has been little explored this is the second concern of the present study particularly we find the scaling laws for the maximum velocity and displacement of the structure in the present study we adopt a thin circular plate for simplicity to investigate the bubble structure interaction the high voltage underwater discharge technique is employed to produce single bubbles while the high speed imaging is exploited to record the bubble evolution and the plate dynamics the boundary integral bi simulations are further used to provide more information in this fsi system the rigid body motion of the plate is incorporated in the present bi model using auxiliary functions we investigate the dynamical behaviors of the bubbles at various distances from the plate with special attention on the situation of a bubble in contact with the plate some new features are observed experimentally and reproduced by our bi model in addition the criterion condition for neglecting the fsi effect is obtained finally we present two scaling laws for the maximum velocity and displacement of the plate which have not been reported before this paper is structured as follows the numerical model is briefly elaborated in section 2 in section 3 we give a basic introduction to the experimental set up some results are presented in section 4 regarding the bubble dynamics at various stand off distances we focus on the collapse patterns and the pressure loads on the structure in section 5 the effect of size ratio θ is further investigated conclusions are drawn in section 6 2 numerical model a schematic diagram of the considered problem is shown in fig 1 the circular plate is characterized by three quantities i e radius r plate thickness t plate and density ρ plate the bubble initially assumes spherical with its radius and inner pressure denoted by r 0 and p 0 respectively the relative position of the plate and the bubble is determined by the distance d from the bubble center to the proximal plate surface the initial distance at bubble inception is d ini a cylindrical coordinate system o r α z is used in our model the origin o is located at the initial bubble center and z axis points rightwards 2 1 basic formulation for bi simulations since the reynolds number defined as r e v mean r m ν where v mean is the mean velocity of the bubble wall r m is the maximum bubble radius and ν is the kinematic viscosity of liquid of the considered problem is in the order of o 1 0 5 the viscosity plays a minor role in the bubble dynamics the compressibility of liquid can also be ignored for cavitation bubbles during most of the first period best and kucera 1992 based on the above mentions the fluid is assumed to be inviscid incompressible and flow irrotational in the current model therefore the velocity potential ϕ can be introduced and satisfies laplace s equation 1 2 ϕ 0 the above equation is equivalent to the following integral representation which is more generally used in numerical models 2 θ p ϕ p s ϕ q n 1 p q ϕ q n 1 p q d s q where θ is the solid angle p is the field point q is the integral point on surface s which comprises the bubble surface s b and the plate surface s plate n is the outward normal at the domain boundary we introduce a dimensionless system for the convenience of discussion a set of characteristic quantities including the maximum bubble radius r m the density of liquid ρ and the pressure difference δ p p p v are chosen to normalize length density and pressure where p is the ambient pressure at the level of z 0 at infinity and p v denotes the saturated vapor pressure consequently time is scaled by r m ρ δ p 1 2 velocity by δ p ρ 1 2 velocity potential by r m δ p ρ 1 2 here two important parameters including dimensionless stand off distance from the initial bubble center to the proximal plate surface γ and size ratio of the plate and the bubble θ are defined as follows 3 γ d ini r m 4 θ r plate r m note that all below physical quantities with subscript are in dimensionless form in this article the kinematic and dynamic boundary conditions on s b are given by 5 d r d t ϕ 6 d ϕ d t 1 1 2 ϕ 2 p b where r represents the position vector of the bubble surface the buoyancy is omitted owing to its negligible effect on the dynamical behaviors of both the small scale bubble and the plate p b is the pressure of the non condensable gaseous contents inside the bubble zhang et al 2001 it reads 7 p b p 0 v 0 v κ where p 0 is the initial bubble internal pressure κ is the specific heats ratio which equals 1 4 in this paper v 0 and v are the bubble volume at inception and at the current time instant respectively surface tension is neglected because it hardly plays a role in centimeter sized cavitation bubble dynamics the impermeable condition imposed on s plate reads 8 ϕ n u n where u is the velocity of the plate n is the unit normal vector at the boundary we restrict the variation of ϕ at every step by an adaptive time stepping scheme zhang et al 2001 to maintain the numerical stability 9 δ t c max d ϕ d t where c is a constant 2 2 auxiliary function for fsi modeling in this study we focus on the role of fsi in pulsating bubble dynamics thus the fsi effect should be carefully considered in the simulation due to the symmetry of the problem the motion of the structure is along the z axis one dimensional motion the hydrodynamic loading f hydro can be obtained by the integration of the pressure over the plate surface li et al 2018a 2019a written as 10 f hydro s plate ϕ t 1 2 ϕ 2 p n d s the ϕ t term seems solvable by differentiating nodal velocity potential with respect to time duncan et al 1996 kalumuck et al 1995 however it is evident that this finite difference method has insufficient accuracy in modeling the movable objects because it indicates the substantial derivative instead of the partial derivative we employ another more accurate method namely auxiliary function method li et al 2016 to deal with ϕ t this term is divided into three parts as follows 11 ϕ t ψ η u ϕ where ψ and η are two auxiliary functions that can be readily solved the neumann condition wu 1998 li et al 2016 of ϕ t on s plate can be written as 12 n ϕ t a n u ϕ n where a is the acceleration of the plate in this work a r a α 0 due to the axisymmetrical configuration another auxiliary function ς is introduced to decouple the dependence of a and ψ it reads 13 ς ψ a the dirichlet boundary condition li et al 2016 of ς on s b is given by 14 ς 0 the neumann boundary condition li et al 2018a of ς on s plate is expressed as 15 ς n n z on substitution eqs 11 13 and 14 into bernoulli s equation the boundary condition li et al 2016 of η imposed on s b is obtained 16 η u ϕ 1 p 0 v 0 v κ 1 2 ϕ 2 substituting eqs 11 13 and 15 into eq 12 leads to the boundary condition li et al 2018b of η imposed on s plate as follows 17 η n 0 all boundary conditions of ς and η hitherto are known they can be obtained in a similar manner of solving ϕ eq 10 can be rewritten as 18 f hydro s plate η u ϕ 1 2 ϕ 2 p n d s s plate a ς n d s substituting eq 18 into newton s second law of motion results in 19 m s plate ς n z d s a s plate η u ϕ 1 2 ϕ 2 p n z d s where m is the dimensionless mass of the plate here we give the calculation procedure of the fluid structure coupling system as follows 1 data preparation and initialization 2 begin the time stepping 3 solve the bi equation and calculate the velocity ϕ on the boundaries of the flow domain 4 calculate the auxiliary function ς using its dirichlet boundary condition eq 14 and neumann boundary condition eq 15 5 calculate the auxiliary function η using its dirichlet boundary condition eq 16 and neumann boundary condition eq 17 6 use eq 19 to calculate the structural acceleration a 7 update the position vector r of the bubble using the kinematic boundary condition eq 5 8 update the velocity potential ϕ of the bubble using the dynamic boundary condition eq 6 9 update the structural velocity u position vector r and the internal pressure inside the bubble p b 10 increment time and return to step 3 if time does not reach the setting time 2 3 vortex ring model in the traditional bi simulations severe numerical difficulties would be encountered when jet transverses the opposite bubble surface the flow solution becomes non unique because there exists a potential discontinuity around the jet impact region wang et al 1996a li et al 2020 we use a vortex ring model li et al 2020 to cope with this problem and gain more features of toroidal bubbles a brief introduction to this model is presented and the reader is referred to wang et al 1996a zhang and liu 2015 for more details the circulation of the vortex ring equals the potential jump at the impact point the total potential ϕ consists of two components the vortex ring induced potential ϕ v and the single valued remnant potential ϕ r expressed as 20 ϕ ϕ v ϕ r also the total velocity consists of the vortex ring induced velocity v v that is calculated by a semi analytical approach zhang and liu 2015 and the remnant velocity v r that is obtained from bi simulations 2 4 bubble plate contact model when the bubble is initiated very close to the structure it would be in contact with the structural surface the produced jet may intensely impinge onto the structure upon collapse if the liquid film between the bubble and the structure is compressed to of comparable size to local mesh numerical instabilities appear in the simulation following ni et al 2015 a bubble plate contact model is exploited to handle this problem supposing δ l is the minimal element length of the bubble the bubble surface and the plate surface are joined once the film thickness is less than δ l what is more the joined region is under the control of a critical distance l critical the formed gas liquid solid intersection line is treated specially more details on the intersection treatment are referenced to ni et al 2015 for the attached bubble the external force f acting on the plate can be rewritten as 21 f f hydro f gas s wet η u ϕ 1 2 ϕ 2 a ς n z d s a dry p b p e z where f gas is the gas produced force that acts on the plate s dry surface with its area denoted by a dry s wet is the wet surface of the plate e z is the unit vector in z direction upon jet impacting on the plate surface directly this model would be utilized again to simulate the toroidal bubbles in contact with the plate the bubble nodes around the jet tip and with a distance from the plate of less than l critical would be stretched onto the plate surface generating another gas liquid solid interaction line 3 experimental set up as shown in fig 2 the high voltage underwater discharge dc 650v technique is utilized to generate an electric spark that evaporates the tap water to nucleate a single cavity the bubble is produced on the symmetrically axial line at a distance d ini from the circular plate s proximal surface a high speed camera phantom v12 1 is placed in front of a transparent water tank 50 cm 50 cm 50 cm to record the bubble and plate dynamics with a framing rate up to 20000 fps we adopt a convenient method to adjustably position the plate by establishing a pendulum system using two thin nylon strings about 200mm length with one end tied to the plate another end fasten at a supporting platform the tension of the strings on the whole balances the vertical gravity and buoyancy of the plate besides the vertical displacement of the plate during the bubble periods is much less than the length of the strings therefore it is omitted in our experimental and numerical investigations the bubble inception is approximately located at the center of the cubic tank so the tank walls effect on the bubble dynamics is negligible two copper electrodes with a radius of 0 1 mm are so thin that their influences on the bubbles are trivial the discharging of the capacitors contained in the high voltage discharge device and the capturing of the camera are triggered synchronously all experiments are diffusely illuminated from back and side by two 300 w led lights the circular plate used in the experiments is made of 5052 aluminum alloy and has dimensions of 20 mm 4 mm radius and thickness with its density being 2 66 g cm 3 the radius of the generated bubbles is 15 2 0 6 mm which is obtained from more than 10 experiments 4 results in this section four selected scenarios of bubble dynamics from experiments and simulations are presented by varying the stand off distance the mechanisms of distinct bubble collapse patterns are analyzed the pressure histories at the center of the near side plate surface are given to shed light on the damage potential of the bubble 4 1 no jet a typical sequence of experimental images and simulated bubble profiles is shown in fig 3 in the experiment d ini 34 4 mm and r m 15 8 mm according to the experimental configurations the parameters in the computation are r 0 0 1297 p 0 200 γ 2 18 θ 1 27 note that an arbitrary selection of p 0 scarcely influences the bubble collapse pattern klaseboer et al 2005a blake et al 1986 hence we set p 0 200 to match the experimental periods of bubbles in this paper the computed outlines bubble in red dashed line plate in gray dashed line are superimposed on the experimental observations to verify the model in this and following sequences of bubble dynamics corresponding times in experiments in italic and computations in regular are marked at the left bottom and right bottom of each frame respectively the bubble maintains its sphericity during most time of the first oscillation in this case no jet can be found in both the experiment and the simulation in this context we name this collapse pattern as no jet due to the quasi spherical collapse of the bubble furthermore the plate undergoes a very weak response during the bubble pulsating periods to further validate the code the radius histories of the bubbles obtained from the simulation and the experiment are presented in fig 4 despite the discrepancy in the early expansion that the numerical bubble owns a larger radius than the experimental one superior agreements are achieved during the first bubble period this deviation can be interpreted by that the computation neglects the complex bubble inception procedure by inserting a high pressure bubble into the liquid instantaneously at the rebounding stage the maximum bubble radius decreases because of the emission of acoustic waves lindau and lauterborn 2003 supponen et al 2017 which is beyond the scope of this article 4 2 jet collision fig 5 a portrays a comparison of experimental images and simulated dynamics when the bubble is produced closer to the plate the experimental configurations are r m 15 0 mm and d ini 20 0 mm while in the simulation γ 1 33 and θ 1 33 the bubble expands violently with its right interface slightly flattened by the plate frames 1 3 during the early and middle stages of collapse the right bubble wall is retarded by the plate hence it obtains higher curvature than other parts frames 4 6 whereas the small collapsing bubble does not allow the visualization of the bubble interior frame 7 the detailed bubble collapse pattern can be inferred from the simulation result then the bubble collapses to its minimum volume and re expands accompanied by prominent migration towards the plate frames 8 10 the energy dissipation in the process of shock waves emission supponen et al 2017 cui et al 2020 lindau and lauterborn 2003 leads to the discrepancy between the simulation and the experiment the first row in panel b depicts the dimensionless pressure and velocity fields of frames 4 6 and 7 in panel a the second row for the moments of the jet strike t 1 924 of reaching the minimum bubble volume t 1 928 and during the bubble rebounding phase t 1 969 the right bubble wall obtains higher curvature at the contraction stage than other bubble parts frames 1 2 as pointed by lauterborn 1982 the more curved bubble wall is easier to develop a jet thereby the thrill right bubble wall rapidly becomes flat simultaneously a high pressure region is formed on the left side of the bubble frame 3 afterwards a slower moving counter jet directed away from the plate develops while the high pressure drives a sharper and faster jet towards the plate finally they collide with each other frame 4 leading to the formation of a toroidal bubble a similar jet collision phenomenon is also found in a collapsing buoyant bubble below a free surface wang et al 1996b or above a solid wall blake et al 1986 1997 brujan et al 2001a b proposed a universal explanation that there exists a second pressure gradient opposite to the bjerknes attraction when investigating the dynamics of cavitation bubbles near an elastic wall we notice this study regarding the bubble movable structure interaction in some extends resembles the fore mentioned investigations the movable rigid structure provides a special boundary condition between a fully fixed wall and a freely elastic material which results in the occurrence of two opposite pressure gradients when γ is relatively large both the two pressure gradients have considerable effects on the bubble collapse pattern and the formation of liquid jets therefore two axial jets in opposite direction are produced in this case after jet impact a extremely high pressure region is formed around the impact region a protrusion is also observed at the moment of reaching its minimum bubble volume frame 5 subsequently the high pressure region around the right apex of the toroidal bubble translates towards the plate frame 6 this bubble collapse pattern is reasonably named jet collision because of the hit of two jets fig 6 shows the jet tip velocity v jet counter jet tip velocity v counter as functions of time in panel a and the pressure histories at the center of the proximal plate surface in panel b near the movable and fixed structures the corresponding parameters in the two cases are the same except for the mobility of structures as can be seen the maximum jet velocity in the movable case 31 6 is much higher than that in the fixed case 20 3 a counter jet could be generated in this movable case and its maximum velocity reaches 5 2 whereas no evident counter jet is observed in the fixed case the maximum velocity of the rightmost of the bubble also defined as v counter is 1 5 in the fixed case we estimate the momentum ω of the jets to determine their intensities using a similar approach of pearson et al 2004 at the moment of jet impact ω z 0 033 for the jet directed towards the plate ω z 0 0002 for the counter jet in the movable case while in the fixed case ω z 0 120 although the jet in the movable case owns a larger velocity its momentum is lower therefore the motion of the structure might diminish the jet impact in analogous to the finding of kalumuck et al 1995 the pressure magnitude in the movable case 26 26 is found to be much lower than that in the fixed case 103 5 during the first bubble cycle it can be explained by that the jet obtains lower momentum and the relative distance from the bubble to the plate is larger if considering the fsi then the pressure decreases rapidly due to the rebound and rises again because of the translation of the high pressure region frames 4 6 in fig 5 b the convergence concerning the mesh size is studied the tested node number of the bubble denoted by n is set as 80 110 140 and 170 respectively the bubble profiles before jet penetration are shown in fig 7 for the sake of presentation we rotate the bubble profiles by 90 degrees counterclockwise here as can be seen consistent results are acquired when n is not less than 140 therefore n 170 is chosen for all simulations in this paper 4 3 non contacting jet fig 8 shows the bubble evolution when the bubble is initiated closer to the plate in the experiment r m 15 1 mm and d ini 14 6 mm accordingly in the simulation γ 0 97 and θ 1 32 convincing agreement between the simulation and the experiment is obtained in panel a the right portion of the bubble becomes obviously flat during the expanding phase frames 1 4 at the collapse stage it obtains a lower collapsing velocity than other parts of the bubble due to the obstruction of the plate to the flow zeng et al 2020 blake et al 1993 frames 5 8 as a result a bubble elongated in the direction perpendicular to the nearest plate surface is attained in the subsequent collapse stage frame 7 near the end of the first bubble cycle a high speed jet develops at the left bubble wall and transverses the opposite bubble wall frame 8 the proximal bubble surface retains low curvature during the contraction stage which is different from the last case hereafter the jet penetrates the liquid layer between the plate and the structure then impacts upon the plate typical phenomena such as rough bubble surface and cavitation are observed in the rebounding phase frames 9 10 we classify this bubble collapse pattern into non contacting jet because the jet has to transverse the liquid layer first and then impacts the plate the first two frames in panel b give the dimensionless pressure and velocity fields of frames 6 and 7 in panel a the last four frames correspond to the moments of the jet impact t 1 935 just after the jet impact t 1 937 of the apparition of the protrusion t 1 942 and of the annular jet impact t 1 947 as shown in frames 1 2 the inflow near the right portion of the bubble is indeed slower than that near other portions of the bubble a high pressure region appears on the left side of the bubble and contributes to the jet strike frame 3 during the late collapse phase after the jet impact significantly high pressure is induced around the impact region frame 4 in addition to the formation of the protrusion an annular indentation occurs and further evolves into a jet resulting in the disintegration of the bubble frames 5 6 the dramatic migrations of the bubble centroid and the high pressure region towards the plate are also observed simultaneously frames 2 6 we perform another simulation where a fixed plate is employed for investigating the effect of the fsi the maximum jet velocity in the movable case 33 5 is much higher than that in the fixed case 20 2 as shown in fig 9 a panel b displays the time histories of the displacement of the bubble centroid the plate centroid and the variation of the relative distance between them during the expanding stage the bubble centroids in the two cases migrate away from the plate on the contrary the bubble migrates towards the structure in the subsequent collapse stage however the bubble in the movable case moves much faster than that in the fixed case at the very late stage of collapse during most of the first bubble cycle except near the formation of the jet the relative distance in the movable case is larger than that in the fixed case similar to the last case the bubble in the movable case is farther from the plate at the moment of the jet impact denoted by the diamonds however we observe an exceedingly high peak pressure of 378 4 in the movable case whereas in the fixed case the amplitude of the pressure is 152 1 not shown here comparing the results in this section and section 4 2 we find that the fsi may increase or decrease the pressure load on the plate depending on the stand off distance 4 4 contacting jet fig 10 compares selected frames of an experimental run with a simulation when the bubble is initiated very close to the plate the experimental configurations are d ini 5 8 mm and r m 15 2 mm whereby in the simulation the initial parameters are γ 0 38 and θ 1 32 the bubble is nucleated axisymmetrically on the left side of the plate frame 1 and grows violently in rapid succession frame 2 during the expanding phase the right interface of the bubble rapidly approaches the proximal plate surface frames 1 6 the bubble evidently takes on a flattened shape at the right side due to the retardation effect of the solid surface blake and gibson 1987 brujan et al 2018 concurrently the plate is pushed away from the bubble afterwards an annular neck near the intersection emerges during the early and middle collapsing stages frames 6 8 resulting in a mushroom shape bubble frame 8 at the distal side of the bubble that contracts faster than other parts of the bubble a rightward jet is produced and then impacts onto the plate directly frame 9 leading to the generation of an attached bubble torus in both this and the above case the wall induced bjerknes attraction is stronger than the second pressure gradient induced by the motion of the plate as the bubble plate distance decreases therefore only one jet directed towards the wall is generated the plate is found to be drawn back by the bubble during the collapse phase at t 1 984 the second bubble cycle begins frame 10 severe multiple cavitations occur at the early rebounding stage frames 11 12 during the re collapse phase a new feature that the detachment of the bubble from the plate is found which is attributed to the fast impact of the radial flow near the intersection frames 13 14 afterwards the bubble and the plate move away from each other frame 15 panel b depicts the dimensionless pressure and velocity fields the former four frames correspond to frames 2 5 8 and 9 in panel a while the latter two correspond to the moments after the jet impact t 1 975 and before the radial jet piercing t 1 991 as can be seen in frame 1 an outward flow is induced by the expanding bubble however the plate apparently hinders the rightward flow resulting in the flattening of the right bubble wall as the bubble approaches the plate the thickness of the liquid layer between them becomes less than the critical distance l critical which allows us to initiate the bubble plate contact model then the bubble over expands and reaches its maximum bubble volume frame 2 in the early collapse stage a neck near the intersection line is generated frame 3 additionally a high pressure region occurs near the left bubble wall at the very late stage of collapse the high pressure drives an intense jet directed towards the plate frame 4 it finally impinges onto the plate frame 5 causing the transformation from the singly connected bubble to the doubly connected form the jet impact generates a high pressure region near the plate s center which redirects the jetting flow perpendicular to the plate surface into a radial flow in the subsequent collapse stage the radial flow pierces the bubble along the plate surface frame 6 particularly we find the bubble shapes frames 4 6 during the very late collapse stage resemble that in the simulations of tong et al 1999 in the investigation on splashing effect a sharp corner shape is formed at the side surface of the bubble frame 4 it then collapses violently and moves around the interior bubble surface frames 5 6 which may suggest the side flow could be conveyed to impact the plate we name this bubble collapse pattern as contacting jet our simulation well reproduces the key features of the bubble plate interaction including the bubble growth collapse necking phenomenon jet formation and the structural motion fig 11 presents the sensitivity study about the critical distance l critical to verify the bubble plate contact model in panel a the bubble profiles before the jet impact are almost consistent with each other when l critical is not more than 2 2 δ l in panel b the comparison of the structural displacement between three simulations and the experiment is given the results of three simulations correlate with each other well furthermore good agreement between the computations and the experiment is obtained in panel b we find that the plate is pushed rightwards in the expanding stage and pulled leftwards in the collapsing phase to elucidate the influence of the structural movement on the damage potential we compare the jet tip velocity histories and pressure histories at the center of the near side plate surface near the movable and fixed plates in fig 12 the configurations are the same as in fig 10 as shown in panel a the maximum jet velocity in the movable case 16 7 is almost 1 77 times that in the fixed case 9 45 just after the jet impact the pressure in the movable case sharply increases to the first peak pressure 264 5 which is about three times that in the fixed case 86 7 thereafter the highest peak pressure 304 8 is reached due to the continuing compression of the bubble and the impact of a sideways jet a marginal rise of the pressure then occurs owing to the piercing of the redirected jetting flow there are also two pressure peaks between the jet induced pressure peak and the highest pressure peak in the fixed case one is due to the impact of the side flow as previously mentioned and the other is due to the piercing of the radial jetting flow along the plate we find that in the movable case the duration of the collapsing pressure 0 021 is shorter than that in the fixed case 0 058 but it gains higher impulse as shown in panel b to summarize the motion of the plate gives rise to higher damage potential of the bubble 5 discussion the bubble plate interaction is influenced not only by the stand off distance but also by the inherent properties of the structure namely the dimensionless radius thickness and density of the plate taking all these factors into consideration makes this study extremely complicated in section 4 the effect of the stand off distance on the bubbles is investigated moreover it is very important to explore the criterion condition under which the influence of the plate s movement on the bubbles can be ignored therefore we further systematically investigate the influence of θ and make some preliminary discussions on the thickness of the plate t plate finally we return to discussing the influence of γ on the responses of the plate 5 1 influence of θ on bubble dynamics the time evolution of the simulated collapsing bubbles near plates is illustrated in fig 13 with θ being 0 5 1 34 3 and the collapse is denoted by the outer to inner curves the gray rectangle located at the right side of each panel represents the initial position of the plate when θ 0 5 the curvature induced counter jet rushes through the bubble and then collides with the sharper jet due to the second bjerknes force blake et al 1986 at the late stage of collapse as shown in panel a as θ increases to 1 34 the elongated bubble and the jet directed towards the boundary are also observed while the curvature effect seemingly is unable to initiate a count jet as shown in panel b if θ 3 panel c the collapsing bubble shape partly resembles a bubble near a rigidly infinite wall panel d the right bubble wall becomes flatter as θ increases besides it is found that the smaller the θ is the smaller bubble volume at the moment of jet impact would be attained we use the maximum jet velocity to quantitatively characterize the influence of θ and t plate on the bubble dynamics due to its representation of surface damage fig 14 shows the maximum jet velocity as a function of θ with different plate thicknesses t plate 0 27 0 5 and 1 respectively the blue represents the results in movable cases while the red in fixed cases γ is set as 1 in all simulations besides the relative deviation in green of the jet velocity between the movable and fixed cases is given by v max mo v max fi v max fi the subscripts mo and fi mean the structure is movable and fixed respectively as shown in fig 14 the maximum jet velocity decreases as θ increases or t plate increases the jet velocity tends to converge to the result of a bubble collapsing near an infinite wall 8 26 denoted by the black dashed line as θ varies from 0 5 to 26 it is easily inferred that the deviation is due to the fsi effect therefore it may be regarded as an indicator of whether the fsi should be considered as θ increases the relative deviation increases first when θ 2 5 then decreases when θ 2 5 when θ 24 the relative deviation is 4 6 for t plate 0 27 4 4 for t plate 0 5 and 4 2 for t plate 1 so the fsi might be insignificant if θ 24 t plate 0 27 however when θ is relatively small the variation of θ changes the bubble collapse pattern see figs 13 15 the collapse patterns are also completely different for the movable and fixed cases in consequence the relative deviation no longer serves as an indicator it is also noticed that when θ is small the fsi is still prominent because the absolute deviation v max mo v max fi is large the high speed jet v max fi 55 when θ 0 5 leads to small relative deviations 5 2 classification of collapse pattern after performing hundreds of simulations a phase diagram for the simulated bubble collapse patterns is obtained in the γ θ space γ 0 2 2 2 θ 0 5 2 2 the thickness of the plate t plate is the same as in fig 5 note that the simulations are ceased before jet impact or reaching t 3 as shown in fig 15 the collapse patterns can be divided into four types namely contacting jet in red circle non contacting jet in green square jet collision in blue pentagram and no jet in gray triangle the adjacent regimes are separated by dashed lines in addition to the finding that the apparition of the contacting jet is mainly found when γ 0 6 we notice that if θ 0 6 the contacting jet also occurs when γ 0 7 furthermore the bubbles nucleated far from a small plate exhibit perfect sphericity and are unable to produce a jet as shown by the gray triangles at the right bottom of the phase diagram when γ 0 6 the non contacting jet forms the transition between the non contacting jet regime and the jet collision regime increases from γ 0 9 to γ 1 5 moreover the transition between the jet collision regime and the no jet regime also increases from γ 1 5 to γ 2 2 the reason is that with the enlargement of the plate radius the obstruction effect on the inward flow is strengthened so it is essential to increase the stand off distance to release this effect to produce a counter jet or no jet 5 3 scaling law for the structural response the time histories of the structural velocity for different γ are presented in fig 16 the plates are accelerated away by the expanding bubbles and then reach their maximum velocities denoted by crosses almost at the same time t 0 2 the plates then are decelerated in the late expansion stage from t 0 96 onwards the plate moves inversely towards the bubble near the end of the first cycle the structural velocity decreases to zero a significant decrease in the maximum structural velocity u max can be seen when γ increases from 1 1 to 6 to reveal the dependence of the structural responses on the dimensionless distance γ dozens of simulations are performed in a relatively large parameter space 0 2 γ 100 θ 1 33 panels a b in fig 17 show the relationship between the maximum velocity u max of the plate and the stand off distance γ panels c d present the maximum displacement of the plate d max as a function of γ as shown in the natural scaled panel a we find that u max is approximate to linearly decrease as γ increases from 0 2 to 1 1 consistent with the findings in bubble sphere interactions li et al 2018a herein an analogous trend of d max to u max in the range of γ 0 2 1 1 is shown in the natural scaled panel c obvious nonlinear relations can be observed when γ 1 1 as shown in panels a c as shown in the logarithm scaled panels b d we further discover following approximate power law relations 22 u max γ 2 23 d max γ 2 when γ is relatively large a semi analytical model is developed to explain the power laws we assume the bubble oscillates spherically when d ini is sufficiently large thus the continuity equation rayleigh 1917 describing the bubble induced flow can be expressed as 24 u r t r b t r 2 r b t where u r t denotes the radial velocity of fluid at distance r from the nucleation point at time t r b t denotes the instantaneous bubble radius a force balance model wu et al 2017 poulain et al 2015 gonzalez avila et al 2011 borkent et al 2008 can be used to model the motion of the plate 25 1 c m m d sgn u 1 2 c d ρ π r plate 2 u d t 2 ρ π r plate 2 t plate d u d t d t where c m and c d are the added mass coefficient and the drag coefficient respectively taken as two constants hence the structural velocity can be evaluated by integrating this motion equation with respect to time in eq 25 d is supposed to equal d ini due to the maximum displacement δ d d ini 1 2 γ 2 6 so the evaluated velocity of the plate at time t is given by 26 d c 1 d ini 4 0 t r b 4 r b 2 d t c 2 d ini 2 0 t 2 r b 2 r b r b r b 2 d t where c 1 c d ρ 2 1 c m ρ plate t plate c 2 ρ 1 c m ρ plate are two constants for a specific structure as shown in fig 16 the plate attains its maximum velocity around t 0 2 its maximum displacement during the expanding stage is reached around t 0 96 if γ 2 6 based on the assumption of the spherical oscillation of bubbles the integrals in eq 26 can be reckoned as constants when t t u 0 2 r m ρ δ p 1 2 or t t d 0 96 r m ρ δ p 1 2 the drag force term can be neglected because it is in the order of 1 d ini 4 while the inertia term is in the order of 1 d ini 2 furthermore the d u d t term in eq 25 is demonstrated to play a key role in the acceleration of structures in previous studies wu et al 2017 borkent et al 2008 the drag force due to viscous effect also should be omitted to match this numerical model based on potential flow method therefore we analytically obtain the power law relation using dimensionless form as eq 22 by integrating eq 25 with respect to time from 0 to t d twice and neglecting the drag force term we further obtain eq 23 comparing the analytical results with the computed results we find as γ increases the u max and d max indeed gradually depend on the inverse second power of γ see fig 17 6 summary and conclusions the transient interaction between a pulsating bubble and a movable plate is systematically investigated in this paper via bi simulations and spark produced cavitation bubble experiments firstly the numerical model was verified by comparison with experiments and mesh convergence tests then we analyzed the underlying mechanisms of four bubble collapse patterns at various dimensionless stand off distances γ the pressures on the structure were given to study the damage potential of the bubble subsequently we studied the influence of the size ratio θ and the dimensionless plate thickness t plate finally we investigated the dependence of the structural responses on γ the main findings are 1 four types of bubble collapse patterns are identified in a large parameter space 0 2 γ 2 2 0 5 θ 2 2 namely i contacting jet which impinges directly onto the plate ii non contacting jet which pierces through the liquid layer then impacts upon the plate iii jet collision between the counter jet directed away from the plate and the jet directed towards the plate and iv no evident jet a majority of the contacting jets occur when γ 0 6 see fig 15 for a phase diagram characterizing the collapse patterns in the γ θ space 2 the fsi effect is found to induce a significant increase in the jet impact velocity generally the peak pressure on the structure increases correspondingly in some rare cases the pressure deceases because the thickness of the liquid layer between the structure and the bubble increases which weakens the impact pressure of a high speed liquid jet 3 as θ increases from 0 5 to 26 the maximum jet velocity of the bubble in the vicinity to a plate decreases and gradually converges to the result of a bubble near an infinite wall when θ 24 and t plate 0 27 the relative deviation between the movable and fixed case is lower than 4 6 which may provide a criterion condition for neglecting the fsi effect 4 during the bubble expansion phase two scaling laws for the maximum structural velocity u max and displacement d max are found with respect to the normalized stand off distance γ for a strong fsi effect 0 2 γ 1 1 u max γ and d max γ for a weak fsi effect when γ is relatively large u max γ 2 and d max γ 2 credit authorship contribution statement zhen yu hu methodology investigation writing original draft visualization validation formal analysis shuai li conceptualization supervision software writing review editing shi ping wang funding acquisition data curation a man zhang resources supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we acknowledge dr shi min li for helpful assistance to our experiments this work is supported by the heilongjiang postdoctoral fund lbh q20016 the fundamental research funds for the central universities 3072020cfj0105 the industrial technology development program jcky2018604c010 and the natural science foundation of china 51925904 52088102 
20201,this paper investigates the formation containment fc control problem of networked underactuated autonomous underwater vehicles auvs in three dimensional space the multi auv system under consideration has directed topology heterogeneous uncertain dynamics and system constraints to achieve the leaders formation and followers containment a two layer control framework is adopted to decouple the fc problem into two subproblems reference trajectory generation and trajectory tracking in the upper layer a distributed estimator is designed for each auv to generate a reference trajectory in accordance with the fc objective subsequently a model free trajectory tracking strategy is developed in the lower layer where adaptive neural networks combined with an auxiliary compensator are involved not only to approximate the heterogeneous system dynamics but also to preserve the velocity and input constraints simultaneously input to state stability is employed to analyze the asymptotic stability of the closed loop system finally comparative simulations are carried out to illustrate the effectiveness and robustness of the proposed two layer control protocol keywords autonomous underwater vehicle formation containment control uncertainty system constraints 1 introduction autonomous underwater vehicles auvs have a broad application prospect in ocean engineering areas such as maritime surveillance military reconnaissance marine archaeology and pipeline inspection zhang et al 2015 jawhar et al 2018 as the task complexity and reliability requirement increase it is more reasonable to employ a group of auvs working collaboratively rather than using a single auv to complete the task individually yuan et al 2017 besides greater efficiency and robustness against robot malfunction can be achieved via cooperation therefore coordination control of marine vehicles has received increasing attention as the earliest study of multi auv coordination formation control has been extensively investigated in the past several decades among the numerous formation control methods the leader following strategy is mostly employed due to its ease of implementation ranging from two dimensional 2d plane liang et al 2020 wang et al 2020b millán et al 2013 wei et al 2019 yuan et al 2017 to three dimensional 3d space shojaei 2016 wang et al 2020a yang et al 2019 under the leader following framework one auv is selected as the leader to track some trajectories and the remaining auvs are required to maintain a target geometric pattern with respect to the leader in the case that there exist multiple leaders another interesting issue namely containment control arises in which the followers are expected to move within the convex hull spanned by the leaders distributed containment control algorithms were developed in peng et al 2015 and qin et al 2019 for fully actuated auvs in 2d plane and 3d space respectively more recently a new coordination control scenario namely formation containment fc has been put forward wherein leaders formation and followers containment are required to proceed simultaneously dong et al 2018 the technical challenges of fc control originate from the following aspects 1 in contrast to the single task coordination cases formation or containment fc is much more complex since both the leaders and followers should be simultaneously controlled to achieve distinct objectives 2 fc cannot be simply decoupled into leaders formation problem and followers containment problem because the movement of leaders will influence that of followers fc problem has been studied in various multi agent systems including linear systems dong et al 2015 wang et al 2018 han et al 2016 nonlinear euler lagrange systems li et al 2018 xu et al 2019 chen et al 2019 silva et al 2020 unmanned aerial vehicles dong et al 2018 and autonomous surface vessels liu et al 2019 yu et al 2019 to the best of the authors knowledge the attention concerning fc control of auvs is hitherto rare therefore how to develop a practical fc protocol for auvs moving in 3d space is the primary motivation of this research due to weight and cost considerations most auvs employ an underactuated architecture which brings great difficulties in motion control of auvs for instance auvs moving in 3d space suffer from external disturbances in sway and heave directions which results in nonzero sideslip angle and attack angle however underactuated auvs do not have direct control inputs in sway and heave directions it is therefore challenging to maintain the tracking performance under nonzero sideslip angle and attack angle some attractive methods to address such issue for auvs in 2d plane are summarized in liu et al 2016 and rout et al 2020 but how to alleviate the influence of sideslip angle and attack angle in 3d space is still unsolved on the other hand auvs are required to operate in a dynamically changing and unpredictable environment the hydrodynamic parameters and external disturbances such as waves and ocean currents can vary dramatically note that these perturbations are hard to measure or predict accurately as a result the dynamics of auvs are typically heterogeneous and unknown which renders the model based methods impractical some advanced model free methods have been developed as reviewed in shi et al 2017 benefiting from its prominent approximation ability in handling system uncertainties neural network nn based control has been wildly utilized in the coordination control of multi auv systems peng et al 2015 cui et al 2010 park 2015 yuan et al 2017 cui et al 2017 liang et al 2019a nevertheless the system constraints are not fully taken into account in the above neuro adaptive methods in practice the velocities of auvs are expected to remain within some compact sets in consideration of energy safety and performance the control inputs are bounded due to the physical constraints on thrusters and rudders violating the system constraints will degrade the controller performance even destabilize the closed loop system peng et al 2018b existing methods to address the constraints include anti windup compensator xia et al 2019 reference governor rg peng and wang 2017 model predictive control mpc wei et al 2019 and barrier function he et al 2016 yet the velocity constraints are not considered in these researches more recently rg peng et al 2018a b and mpc zhang et al 2019 methods have been extended to address the velocity and input constraints comprehensively it is worth noting that the mpc method in zhang et al 2019 relies on the accurate model of auvs for motion prediction which is unavailable in practice moreover mpc and rg are optimization based techniques the efficiency of which depends on whether the formulated regulation problem can be solved in real time hence how to achieve a trade off between constraint satisfaction and computational burden is also a currently unsolved challenge motivated by the above considerations this paper intends to address the three dimensional fc problem of underactuated auvs subject to heterogeneous uncertain dynamics and system constraints specifically a two layer control strategy is proposed to decompose the fc problem into two subproblems reference trajectory generation and trajectory tracking the main contribution of this paper is fourfold as follows 1 most existing coordination control of multi auv systems focus on single task problems e g formation or containment which are inappropriate to simultaneously cope with dual task fc problem additionally fc control methods presented in dong et al 2015 wang et al 2018 han et al 2016 li et al 2018 xu et al 2019 chen et al 2019 silva et al 2020 dong et al 2018 liu et al 2019 and yu et al 2019 are not applicable to our case due to the inherent characteristics of underactuated auvs in 3d space 2 in the upper layer a distributed estimator is novelly designed for leaders and followers to generate the reference trajectory satisfying the fc objective the designed estimator extends the time invariant formation in liu et al 2019 and the bidirectional interactions are not required as li et al 2018 therefore the proposed estimator is more general and practical 3 in the lower layer a model free trajectory tracking strategy is developed based on novelly constructed tracking error dynamics in contrast to miao et al 2017 zhang et al 2020 and qi 2015 the nonlinearity induced by attack angle and sideslip angle is involved in position tracking errors rather than orientation errors and is further compensated by the improved 3d guidance law 4 the heterogeneous dynamics and system constraints are addressed by adaptive nns incorporating an auxiliary compensator compared with xia et al 2019 wei et al 2019 peng and wang 2017 he et al 2016 shojaei 2016 and wang et al 2020a where only input constraints are considered velocity constraints can be additionally handled instead of using rg peng et al 2018a b and mpc zhang et al 2019 our method has no dependence on accurate model and real time optimization the remainder of this paper is organized as follows section 2 formulates the fc problem for underactuated auvs in 3d space then we present the two layer protocol in two sections the distributed estimator design section 3 and the model free trajectory tracking control design section 4 section 5 synthesizes the closed loop stability under the proposed method comparative simulation results are presented in section 6 followed by the conclusion notation r n and r n m denote euclidean space with dimension n and the set of n m real matrices 0 n m is the zero matrix with size n m and denote the l 1 norm and l 2 norm respectively λ min p denotes the smallest eigenvalue of the matrix p r a b α β r z α r y β is the rotation matrix from frame a to frame b with r z α cos α sin α 0 sin α cos α 0 0 0 1 and r y β cos β 0 sin β 0 1 0 sin β 0 cos β 2 preliminaries and problem formulation 2 1 mathematical model of underactuated auvs in the rest of this paper we use the subscript i to indicate the variables associated with the i th auv the motion of an auv in 3d space is typically described by a six degrees of freedom 6 dof model in this paper we particularly consider the torpedo shaped auvs which are wildly used in practice and the roll motion of which can be passively stabilized by a metacentric height between centers of gravity and buoyancy yu et al 2017 as a result we neglect the rolling dynamics and therefore centralize on the 5 dof mathematical model of auvs three reference frames are used to describe the model of a 5 dof auv as shown in fig 1 where i b i and w i are the inertial frame body fixed frame and resultant speed frame assume that the origins of frame b i and w i coincide with the center of mass m i of the auv the kinematics of 5 dof auvs can be described as yu et al 2017 miao et al 2017 zhang et al 2020 liang et al 2019b 1 x i u i cos θ i cos ψ i v i sin ψ i w i sin θ i cos ψ i y i u i cos θ i sin ψ i v i cos ψ i w i sin θ i sin ψ i z i u i sin θ i w i cos θ i θ i q i ψ i r i cos θ i where x i y i z i denote coordinates of m i in the frame i θ i and ψ i are the pitch and yaw angles respectively u i v i w i q i and r i denote the surge sway heave pitch and yaw velocities which are expressed in the frame b i define the total speed of auv as u i u i 2 v i 2 w i 2 let ν w i u i 0 0 t and ν b i u i v i w i t following coordinate transformation can be made from frame b i to frame w i 2 ν w i r b i w i β i α i ν b i where α i arctan w i u i and β i arctan v i u i 2 w i 2 are attack angle and sideslip angle due to the port starboard and bottom top symmetries of torpedo shaped auvs more details are given in fossen 2011 do and pan 2009 the dynamics of 5 dof auvs can be simplified as yu et al 2017 miao et al 2017 zhang et al 2020 liang et al 2019b 3 m u i u i f u i τ u i τ e u i m v i v i f v i τ e v i m w i w i f w i τ e w i m q i q i f q i τ q i τ e q i m r i r i f r i τ r i τ e r i where m i 1 ϖ m i m i is the actual inertia coefficient m i is the nominal inertia obtained through towing experiments or computational fluid dynamics simulations ϖ m i is the perturbation rate with respect to the nominal values f i represents the unknown nonlinear hydrodynamics with a simplified form given in appendix τ u i τ q i and τ r i are input force and torques generated by propeller and rudders τ e i stands for the unknown external disturbances remark 1 this 5 dof dynamic model is commonly discussed in motion control of auvs moving in 3d space including path following yu et al 2017 zhang et al 2020 and miao et al 2017 trajectory tracking liang et al 2019b wang et al 2019 and formation control wang et al 2020a shojaei 2016 note that this simplified model did ignore certain nonlinear hydrodynamic damping terms under the assumption of symmetric structure however these ignored hydrodynamics can be considered part of f i which is unknown and will be further compensated by our proposed nn based dynamic controller assumption 1 miao et al 2017 peng and wang 2017 zhang et al 2020 the parameter perturbations ϖ m i and ϖ d i defined in appendix hydrodynamics f i and external disturbance τ e i in eq 3 are assumed to be bounded remark 2 in practice the model parameters m i and d i are perturbed dramatically by the environmental conditions thus we introduce ϖ m i and ϖ d i to consider such inherent property besides the perturbations hydrodynamics and external disturbances are unknown and time varying but limited from the energy perspective peng and wang 2017 therefore assumption 1 is reasonable and practical consider the practical system constraints on auvs we suppose that 4 ρ min ρ i ρ max τ ρ min τ ρ i τ ρ max ρ u q r where ρ min ρ max τ ρ min τ ρ max are known constants although v i and w i are also bounded we cannot guarantee the satisfaction of constraints in the underactuated sway and heave directions as such we mainly consider the controllable surge pitch and yaw directions 2 2 graph theory a directed graph g can be denoted by g v e where v 1 n is a node set and e i j i v j v is the edge set a directed edge i j means that i th vehicle can receive information from j th vehicle an adjacency matrix a a i j r n n is defined as a i j 1 if i j e and a i j 0 otherwise note that a i i 0 for all vertices the laplacian matrix l l i j r n n is defined as l i j a i j if i j otherwise l i i j 1 j i n a i j a directed path from vertex i 0 to vertex i k is a sequence of directed edge with the form of i l i l 1 where i l v l 0 1 k 1 a directed graph contains a spanning tree if there exists at least one vertex having a directed path to all the other vertices 2 3 three dimensional fc control problem formulation assume that the multi auv system consists of n leaders labeled as 1 2 n and m followers labeled as n 1 n 2 n m denote the position vector of i th vehicle as p i x i y i z i t r 3 moreover we define a virtual leader labeled as 0 serving as the virtual center of the target formation to be achieved by the leaders in this research the motion of the virtual leader is not considered and it can be predefined or remotely controlled the position vector of the virtual leader is denoted by p 0 x 0 y 0 z 0 t r 3 assumption 2 li et al 2018 xu et al 2019 the acceleration of the virtual leader is bounded i e there exists a positive constant δ 0 such that p 0 δ 0 remark 3 assumption 2 is made because the information of the virtual leader will be utilized to generate the reference trajectories for the leaders which requires that the trajectory of the virtual leader is smooth in addition underactuated auvs have low maneuverability character thus assumption 2 is desirable from a practical perspective on the basis of graph theory the laplacian matrix of multi auv system can be partitioned as 5 l 0 0 1 n 0 1 m l l 1 l l 2 0 n m 0 m 1 l f 1 l f 2 where l l 1 a 10 a 20 a n 0 t r n represents the interactions from virtual leader to leaders a i 0 1 i 1 n if i th leader knows the reference information l l 2 r n n describes the interactions among leaders l f 1 r m n represents the directed interactions from leaders to followers and l f 2 r m m characterizes the interactions among followers assumption 3 li et al 2018 xu et al 2019 dong et al 2018 the interaction topology among the leaders has a spanning tree with the virtual leader being the root for each follower there exists at least one leader that has a directed path to it lemma 1 if assumption 3 is satisfied then i the eigenvalues of l l 2 have positive real parts ii the eigenvalues of l f 2 have positive real parts and each row of l f 2 1 l f 1 has a sum equal to 1 remark 4 assumption 3 is a basic requirement for the fc control problem if assumption 3 is not satisfied the isolated auvs cannot receive any information from the virtual leader directly or indirectly and no coordination objective can be achieved for lemma 1 the conclusion i is demonstrated su and huang 2011 and the conclusion ii is demonstrated in meng et al 2010 definition 1 leaders in the multi auv system are said to achieve time varying formation if there exists a relative position vector d i t r 3 such that 6 lim t p i t p 0 t d i t 0 i 1 n definition 2 followers in the multi auv system are said to achieve containment if there exist nonnegative constants γ i j satisfying j 1 n γ i j 1 such that 7 lim t p i t j 1 n γ i j p j t 0 i n 1 n m definition 3 the multi auv system is said to achieve fc if there exist a relative position vector d i t r 3 and nonnegative constants γ i j satisfying j 1 n γ i j 1 such that the objectives 6 and 7 are achieved by leaders and followers respectively subsequently we define the target position p d i r 3 for leaders and followers as 8 p d i t p 0 t d i t i 1 2 n j 1 n γ i j p j t i n 1 n m to solve the fc control problem we propose a two layer control strategy as depicted in fig 2 using such a scheme the fc control problem is straightforwardly decoupled into the following two subproblems problem 1 reference trajectory generation consider a multi auv system consisting of n leaders and m followers suppose that assumption 1 3 are satisfied for each auv i 1 n m let p ˆ d i r 3 be the estimated desired position design a distributed estimation law for p ˆ d i such that p ˆ d i t p d i t exponentially as t problem 2 trajectory tracking consider a multi auv system consisting of n leaders and m followers suppose that assumption 1 3 are satisfied for each auv i 1 n m design a control law for τ u i τ q i and τ r i such that p i t p ˆ d i asymptotically as t 3 reference trajectory generation in this section distributed estimators are respectively developed for leaders and followers to address problem 1 3 1 distributed estimator for leaders we propose the following distributed estimator for the leaders 9 p ˆ d i ν ˆ d i j 0 n a i j p ˆ d i p ˆ d j d i d j ν ˆ d i ξ ˆ d i d i ξ ˆ d i j 0 n a i j ξ ˆ d i ξ ˆ d j σ 1 sgn j 0 n a i j ξ ˆ d i ξ ˆ d j i 1 n where p ˆ d i x ˆ d i y ˆ d i z ˆ d i t r 3 and ν ˆ d i x ˆ d i y ˆ d i z ˆ d i t r 3 are the estimations of desired position p d i and desired velocity p d i respectively σ 1 is a positive constant to be determined sgn is the signum function and p ˆ d 0 p 0 ξ ˆ d 0 p 0 d 0 0 the proposed distributed estimator is implemented as follows for the i th auv it can receive ξ ˆ d j and p ˆ d j from the neighboring auv denoted by j particularly if the virtual leader is the neighbor of i th vehicle then a i 0 1 and information of virtual leader ξ ˆ d 0 and p ˆ d 0 will be available theorem 1 let σ 1 δ 0 if assumptions 1 3 hold under distributed estimator 9 p ˆ d i t and ν ˆ d i t converge to p d i t and p d i t exponentially proof define the estimation errors as p d i p ˆ d i p d i ν d i ν ˆ d i p d i ξ ˆ d i p 0 then we rewrite these estimation errors in a compact form as p d l p d 1 t p d 2 t p d n t t and ν d l ν d 1 t ν d 2 t ν d n t t under the distributed estimator 9 the estimation error dynamics are given by 10 p d l ν d l h l p d l ν d l h l ν d l σ 1 sgn h l ν d l 1 n i 3 p 0 where h l l l 2 i 3 and 1 n 1 1 1 r n firstly we show ν d l t 0 exponentially as t consider the following lyapunov function 11 v 1 1 2 ν d l t h l t ν d l differentiating v 1 along the dynamics of ν d l in eq 10 yields 12 v 1 ν d l t h l t h l ν d l σ 1 sgn h l ν d l 1 n i 3 p 0 ν d l t h l t h l ν d l σ 1 h l ν d l ν d l t h l t 1 n i 3 p 0 ν d l t h l t h l ν d l σ 1 δ l h l ν l λ min h l t h l ν d l 2 where the second equality is due to ν d l t h l t sgn h l ν d l h l ν d l note that λ min h l t h l 0 since all eigenvalues of h l have positive real parts under lemma 1 thus eq 12 yields that ν d l converges to zero exponentially secondly we show p d l is bounded as t consider the following lyapunov function 13 v 2 1 2 p d l t h l t p d l the derivative of v 2 is given by 14 v 2 p d l t h l t ν d l h l p d l p l t h l t h l p l p l t h l t ν d l λ min h l t h l p l 2 λ max h l p l ν d l λ min h l t h l 2 p l 2 λ max 2 h l 2 λ min h l t h l ν d l 2 since ν d l converges to zero exponentially if p l λ max h l λ min h l t h l ν d l v 2 0 therefore p d l is guaranteed to be bounded thirdly for the overall system we consider the lyapunov function 15 v 3 v 2 λ max 2 h l λ min 2 h l t h l v 1 the derivative of v 3 is given by 16 v 3 λ min h l t h l 2 p d l 2 λ max 2 h l 2 λ min h l t h l ν d l 2 λ max 2 h l λ min h l t h l ν d l 2 λ min h l t h l 2 p d l 2 λ max 2 h l 2 λ min h l t h l ν d l 2 λ min h l t h l 2 λ max h l v 3 where the last equality follows from v 1 λ max h l ν d l 2 and v 2 λ max h l p d l 2 therefore we can conclude that p d l t converges to zero exponentially remark 5 in the distributed observer 9 we employ a first order sliding mode estimator for ξ ˆ d i in addition to the exponential convergence as shown in theorem 1 the sliding mode estimator additionally guarantees a finite time convergence as demonstrated in cao et al 2010 via a similar proof of theorem 3 1 in cao et al 2010 we can conclude that ξ ˆ d i p 0 t t l where t l max i ξ ˆ d i 0 p 0 0 σ 1 δ 0 remark 6 it should be noted that ξ ˆ d i is discontinuous since sgn is adopted however the finite time convergence implies that 17 t 1 t 2 ξ ˆ d i τ d τ t 1 t 2 p 0 τ d τ t 2 t 1 t l in other words for t t l ξ ˆ d i t can be rewritten as ξ ˆ d i t p 0 t f t where f t is a switching signal function satisfying t 1 t 2 f τ d τ 0 for t 2 t 1 t l and the frequency of f t is infinitely large note that the integrator can be considered as a low pass filter thus the switching signal f t can be filtered out with the integrator therefore we can use ξ ˆ d i t to replace p 0 t in integration based applications for t t l in our estimator we use ξ ˆ d i to construct estimation law for ν ˆ d i and p ˆ d i thus the non continuity will not be involved in ν ˆ d i and p ˆ d i 3 2 distributed estimator for followers from assumption 1 the hydrodynamics f i and external disturbance τ e i are assumed to be bounded in addition the control inputs are also bounded due to physical constraints on propeller and rudders therefore it is reasonable to assume the accelerations of auvs are bounded that is 18 p i δ l i 1 2 n where δ l is a positive constant we design the following distributed estimator for the followers 19 p ˆ d i ν ˆ d i j 1 n m a i j p ˆ d i p ˆ d j ν ˆ d i j 1 n m a i j ν ˆ d i ν ˆ d j σ 2 sgn j 1 n m a i j ν ˆ d i ν ˆ d j i n 1 n m where p ˆ d i r 3 and ν ˆ d i r 3 are the estimations of p d i and p d i respectively σ 2 is a positive constant to be determined we define p ˆ d i p i and ν ˆ d i p i i 1 n let p l p 1 t p n t t and p f p n 1 t p n m t t let p d f p d n 1 t p d n m t t l f 2 1 l f 1 i 3 p l be a weighted average of leaders position from lemma 1 and definition 2 p d f is always within the convex hull spanned by the leaders therefore the containment objective is achieved for followers if p f p d f we rewrite the estimation results in a compact form as 20 p ˆ d f p ˆ d n 1 t p ˆ d n 2 t p ˆ d n m t t ν ˆ d f ν ˆ d n 1 t ν ˆ d n 2 t ν ˆ d n m t t then we have following theorem for the distributed estimator 19 theorem 2 let σ 2 δ l if assumptions 1 3 hold under distributed estimator 19 p ˆ d f t and ν ˆ d f t converge to p d f t and p d f t exponentially proof for convenience we rewrite the distributed observer 19 in a compact form as 21 p ˆ d f ν ˆ d f ψ f ν ˆ d f λ f σ 2 sgn λ f where ψ f and λ f take the following form 22 ψ f l f 1 i 3 p l l f 2 i 3 p ˆ d f λ f l f 1 i 3 p l l f 2 i 3 ν ˆ d f therefore the exponential convergence of p ˆ d f t p d f and ν ˆ d f t p d f t is equivalent to ψ f t 0 and λ f t 0 as t let h f l f 2 1 i 3 we consider the following lyapunov functions 23 v 4 1 2 λ f t h f λ f v 5 1 2 ψ f t h f ψ f taking the derivatives of v 4 and v 5 with respect to eq 21 we obtain 24 v 4 λ f 2 v 5 ψ f 2 λ max h f ψ f λ f using a similar procedure as given in eqs 14 16 we can conclude that λ f and ψ f both converges to zero exponentially remark 7 similar to the analysis in remark 5 the sliding mode estimator for ν ˆ d i also guarantees a finite time convergence i e ν ˆ d i p d i t t f where t f max i ν ˆ d i 0 p d i 0 σ 2 δ l the non continuity in ν ˆ d i t can be also filtered out by the integrator it is seen that with the help of the proposed distributed estimators 9 and 19 the estimated reference trajectory exponentially converges to the desired trajectory satisfying fc objective in the next section local trajectory tracking controller will be designed to achieve p i p ˆ d i 4 model free trajectory tracking strategy in this section model free trajectory tracking control of auvs under heterogeneous uncertain dynamics and system constraints is tackled to address this challenging issue we first construct the trajectory tracking error dynamics based on equivalent coordination transformation in which the negative effect of nonzero attack angle and sideslip angle is considered comprehensively subsequently a kinematic control law is designed based on improved line of sight los guidance law which effectively compensates the nonlinearity induced by nonzero attack angle and sideslip angle finally adaptive nns are employed at the dynamic level to approximate the heterogeneous uncertain dynamics and input truncation the velocity constraints are ensured by introducing an auxiliary compensator 4 1 trajectory tracking error dynamics for i th auv we assign it with a virtual target denoted by p i as shown in fig 3 denote the inertial position and speed vector of p i by p ˆ d i and ν ˆ d i associated with p i the corresponding trajectory frame f i can be built the x axis of which coincides with the speed vector ν ˆ d i denote the rotation matrix from frame f i to frame i by r f i i χ d i υ d i wherein two rotation angles are defined as yu et al 2017 25 χ d i atan 2 y ˆ d i t x ˆ d i t υ d i arctan z ˆ d i t x ˆ d i 2 t y ˆ d i 2 t define the trajectory tracking error e p i between i th auv and target point p i in frame f i as 26 e p i e x i e y i e z i t r i f i p i p ˆ d i where r i f i r f i i χ d i υ d i t is the rotation matrix from frame i to frame f i the derivative of e p i is given by breivik and fossen 2005 27 e p i s i f i e p i r i f i p i ν d i where ν d i u i d 0 0 t is the resultant speed vector of p i with u i d ν ˆ d i s i f i r 3 3 is defined as 28 s i f i 0 χ d i cos υ d i υ d i χ d i cos υ d i 0 χ d i sin υ d i υ d i χ d i sin υ d i 0 introducing kinematic model 1 and velocity transformation 2 into eq 27 yields 29 e p i s i f i e p i r i f i r b i i ψ i θ i ν b i ν d i s i f i e p i r b i f i ψ e i θ e i ν w i ν d i f p i where ψ e i and θ e i are rotation angles from frame b i to frame f i f p i f x i f y i f z i t r i f i r b i i ν b i ν w i is the nonlinearity induced by the nonzero sideslip and attack angles moreover eq 29 can be expanded as 30 e x i e y i χ d i cos υ d i e z i υ d i u i cos ψ e i cos θ e i u i d f x i e y i e x i χ d i cos υ d i e z i χ d i sin υ d i u i sin ψ e i cos θ e i f y i e z i e x i υ d i e y i χ d i sin υ d i u i sin θ e i f z i remark 8 the nonlinearity f p i is equal to zero if and only if ν b i ν w i i e α i 0 and β i 0 due to coordinate transformation 2 however because auvs are exposed to disturbances in sway and heave directions α i and β i will be nonzero and time varying from error dynamics 30 we can note that auvs will exhibit large tracking error under the impact of f p i therefore it is of great importance to compensate such nonlinearity to achieve a satisfied tracking performance remark 9 some existing researches such as miao et al 2017 qi 2015 and zhang et al 2020 construct the error dynamics as 31 e x i e y i χ d i cos υ d i e z i υ d i u i cos χ e i cos υ e i u i d e y i e x i χ d i cos υ d i e z i χ d i sin υ d i u i sin χ e i cos υ e i e z i e x i υ d i e y i χ d i sin υ d i u i sin θ e i f z i where χ e i and υ e i are defined as rotation angles from frame w i to frame f i if so α i and β i will be involved in χ e i and υ e i as shown in following coordinate transformation 32 r w i f i χ e i υ e i r b i f i ψ e i θ e i r w i b i where r w i b i r b i w i β i α i t therefore eq 30 differs from eq 31 in expressing the effect of α i and β i in the position errors rather than the orientation errors benefiting from this it is easier to understand the effect of nonzero attack angle and sideslip angle on tracking performance in the next subsection an improved guidance law will be designed to alleviate such nonlinearity 4 2 kinematic controller design due to the underactuated configuration of auvs the tracking errors in sway and heave directions cannot be directly eliminated in the field of marine vehicle los guidance is popularly utilized to convert the tracking errors in the underactuated directions into the controllable orientation errors to compensate for the nonlinearity f p i following improved los guidance law is developed 33 ψ e i d ta n 1 e y i δ y i δ y θ e i d tan 1 e z i δ z i δ z where δ y and δ z are called look ahead distances satisfying δ z δ y 2 e y i δ y i 2 δ y i and δ z i are auxiliary terms to compensate f y i and f z i satisfying the following equation 34 u i δ y i δ i δ y f y i u i δ z i δ i δ y f z i where δ i δ y 2 e y i δ y i 2 e z i δ z i 2 δ y by expanding eq 34 following two feasible solutions positive roots can be derived 35 δ y i γ y i υ i 1 γ y i 2 γ z i 2 δ z i γ z i υ i 1 γ y i 2 γ z i 2 where υ i e y i γ y i e z i γ z i δ y 2 1 γ y i 2 γ z i 2 e y i 2 e z i 2 e y i γ z i e z i γ y i 2 γ y i f y i u i and γ z i f z i u i recalling the fact that the rotation r b i i from frame b i to frame i is equivalent to the consecutive rotations from frame b i to frame f i and then to frame i we have 36 r f i i χ d i υ d i r b i f i ψ e i d θ e i d r b i i ψ d i θ d i expanding eq 36 yields the desired pitch angle θ d i and the desired yaw angle ψ d i as 37 θ d i arcsin sin υ d i cos θ e i d cos ψ e i d cos υ d i sin θ e i d ψ d i atan2 ψ d i y ψ d i x with 38 ψ d i y sin χ d i cos υ d i cos ψ e i d cos θ e i d cos χ d i sin ψ e i d cos θ e i d sin χ d i sin υ d i sin θ e i d ψ d i x cos χ d i cos υ d i cos ψ e i d cos θ e i d sin χ d i sin ψ e i d cos θ e i d cos χ d i sin υ d i sin θ e i d to steer θ i and ψ i to the desired angles θ d i and ψ d i we design the following kinematic controller 39 u d i k x e x i u i d f x i cos α i cos β i δ i q d i k θ θ i θ d i θ d i r d i k ψ ψ i ψ d i ψ d i cos θ i where k x k θ and k ψ are positive constants to be determined remark 10 some efforts to compensate nonzero sideslip angle in 2d plane are summarized in liu et al 2016 and rout et al 2020 in this research we therefore extend these results to a general and practical 3d space and the influence of attack angle and sideslip angle are alleviated comprehensively 4 3 dynamic controller design in this subsection a model free dynamic controller will be designed to track the velocity commands generated by kinematic controller 39 note that these command signals may violate the velocity constraints due to large tracking errors and large control gains to tackle such issue we incorporate an adaptive compensator into our dynamic controller and the adaptive nns are utilized to approximate the heterogeneous uncertain dynamics and control input truncation due to the similarity in the controller design procedure for τ u i τ q i and τ r i only the surge control input τ u i is discussed in detail define the difference between saturated velocity command and unsaturated command as 40 δ u i s a t u d i ϕ u i u u u d i ϕ u i where function b s a t a a max a min is defined as b a if a min a a max else b a max if a a max or else b a min if a a min u and u are chosen such that u u max and u u min ϕ u i is the compensation term to address the velocity constraint similarly the control input truncation is defined as 41 δ τ u i τ u i τ u i s s a t τ u i s τ u τ u τ u i s where τ u i s is the unsaturated input to be designed τ u and τ u are selected to satisfy that τ u τ u max and τ u τ u min define e u i u i u d i ϕ u i as the regulated velocity tracking error recalling eqs 3 and 41 the derivative of e u i is derived as 42 e u i u i u d i ϕ u i f u i τ u i s δ τ u i τ e u i m u i u d i ϕ u i τ u i s m u i d u i u d i ϕ u i where d u i f u i τ u i τ e u i m u i τ u i s m u i is the lumped uncertainty induced by parameter perturbations heterogeneous hydrodynamics external disturbances and input truncation lemma 2 lu et al 2018 for any unknown continuous function f z with input vector z r m defined on a compact set ω z there exists an ideal constant weight vector w r q such that 43 f z w t h z ɛ where q 1 is the node number ɛ is the bounded estimation error h z h 1 z h q z t r q is the gaussian function taking the following form 44 h s z exp z c s 2 b s 2 s 1 2 q where c s r m and b s r are the center of receptive field and the width of gaussian function consequently the lumped uncertainty d u i can be approximated via adaptive nns namely d u i w i t h z i ɛ i where w i and h z i denote the ideal weight vector and activation function the input vector is defined as z i 1 u i v i w i q i r i τ u i s m u i t ɛ i is the bounded estimation errors lemma 2 implies that there exists a positive constant e i such that ɛ i e i we propose the following unsaturated dynamic controller 45 τ u i s m u i k u e u i u d i ϕ u i w ˆ i t h e ˆ i sgn e u i where w ˆ i and e ˆ i are the estimations of w i and e i respectively updated as 46 w ˆ i η 1 1 e u i h e ˆ i η 2 1 e u i where η 1 0 and η 2 0 are positive constants to be determined an auxiliary adaptive law is developed for ϕ u i as 47 ϕ u i η 3 σ 3 δ u i 2 2 ϕ u i 2 ϕ u i σ 3 δ u i ϕ u i μ u η 3 ϕ u i ϕ u i μ u where η 3 0 and σ 3 0 are positive constants to be determined μ u 0 is a small constant theorem 3 let 2 η 3 σ 3 under dynamic controller 45 incorporating adaptive nns 46 and adaptive compensator 47 e u i and ϕ u i are guaranteed to converge to zero asymptotically proof consider the following lyapunov function 48 v 6 1 2 e u i 2 1 2 η 1 w i t w i 1 2 η 2 e i 2 1 2 ϕ u i 2 where w i w ˆ i w i and e i e ˆ i e i substituting eq 45 into eq 42 one can obtain that 49 e u i k u e u i w i t h e ˆ i sgn e u i ɛ i if ϕ u i μ u i e u d i violates the constraint using eqs 46 47 and 49 the derivative of v 6 can be then calculated as 50 v 6 k u e u i 2 w i t e u i h η 1 w ˆ i e i e u i η 2 e ˆ i η 3 ϕ u i 2 σ 3 2 δ u i 2 σ 3 ϕ u i δ u i e i e u i e u i ɛ i k u e u i 2 2 η 3 σ 3 ϕ u i 2 2 where the last inequality uses the fact that σ 3 ϕ u i δ u i σ 3 ϕ u i 2 2 σ 3 δ u i 2 2 and e u i ɛ i e i e u i by choosing parameters such that 2 η 3 σ 3 we can obtain that 51 v 6 k min e u i 2 2 ϕ u i 2 2 where k min min 2 k u 2 η 3 σ 3 note that eq 51 only guarantees that v 6 is not increasing but cannot converge to zero asymptotically in the meanwhile eq 51 indicates that e u i w i e i and ϕ u i are all bounded furthermore e ˆ i e i e i shows that e ˆ i is also bounded to derive the convergence for e u i and ϕ u i we consider lyapunov function v 7 k min e u i 2 2 ϕ u i 2 2 firstly lim t 0 t v 7 s d s exists and is finite because 52 lim t 0 t v 7 s d s lim t 0 t v 6 s d s v 6 0 lim t v 6 t secondly v 7 is uniformly continuous because 53 v 7 t k min k u e u i 2 2 η 3 σ 3 ϕ u i 2 2 e u i w i t h e ˆ i sgn e u i ɛ i recalling barbalat lemma see lemma 4 2 in slotine et al 1991 if the differential function f t has a finite limit as t and f t is uniformly continuous then f t 0 as t let f t 0 t v 7 s d s we have demonstrated that f t has a finite limit from eq 52 and f t is uniformly continuous from eq 53 which implies f t v 7 t 0 as t therefore we conclude that e u i t and ϕ u i t converge to zero asymptotically if ϕ u i μ u i e u d i is within the constraint the stability analysis can be similarly proved the detailed proof is omitted define the velocity tracking error as s u i u i u d i note that u i u d i e u i ϕ u i thus theorem 3 also implies that lim t s u i t lim t e u i t ϕ u i t 0 5 closed loop stability analysis in this section the stability analysis of the closed loop system will be established on the basis of input to state stability the main result is given in following theorem theorem 4 consider a group of auvs consisting of n leader and m follower the kinematics and dynamics of auvs are described as 1 3 if assumptions 1 3 are satisfied then the leaders formation and followers containment can be achieved by using the proposed two layer framework which consists of distributed estimators 9 19 improved los based kinematic controller 39 and adaptive nn based dynamic controller 45 proof we define the tracking error as e p i t p i t p d i t and it can be expanded as 54 e p i t p i t p ˆ d i t p ˆ d i t p d i t r f i i e p i t p ˆ d i t p d i t where p ˆ d i t p d i t is proved to converge to zero exponentially in theorems 1 and 2 it rest to demonstrate that e p i t 0 as t to this end the proof is illustrated in the following three steps step 1 define the angular velocity tracking errors as s r i t r i t r d i t and s q i t q i t q d i t using a similar proof given in theorem 3 we obtain lim t s r i t 0 and lim t s q i t 0 step 2 define angle tracking errors as e θ i θ i θ d i and e ψ i ψ i ψ d i then we will show lim t e θ i t 0 and lim t e ψ i t 0 differentiating e θ i and e ψ i along the kinematic model 1 yields 55 e θ i k θ e θ i s q i e ψ i k ψ e ψ i s r i cos θ i in which s q i and s r i can be considered as the inputs to the following unforced system 56 e θ i k θ e θ i e ψ i k ψ e ψ i consider the lyapunov candidate function v 8 1 2 e θ i 2 1 2 e ψ i 2 its derivative is given by 57 v 8 k θ e θ i 2 k ψ e ψ i 2 e θ i s q i e ψ i s r i cos θ i when e θ i is large the third term in eq 57 is o e θ i while the first term is o e θ i 2 this argument also applies to e ψ i therefore e θ i and e ψ i are ultimately bounded therefore the closed loop system 55 is input to state stable iss with respect to inputs s q i and s r i for the following three reasons see theorem 3 1 in sontag 2008 a the unforced system 56 has a globally asymptotically stable equilibrium at the origin b the closed loop system 55 satisfies boundedness property i e e θ i and e ψ i are bounded c the right hand of 55 is globally lipschitz because s q i and s r i converge to zero asymptotically in step 1 thus the origin of the closed loop system 55 is also globally asymptotically stable see lemma 4 6 in khalil 2015 step 3 now we consider the convergence of e p i we rewrite the error dynamics 31 as 58 e p i s i f i e p i u d i cos ψ e i d cos θ e i d u i sin ψ e i d cos θ e i d u i sin θ e i d ν d i f p i g p i where u d i u d i cos α i cos β i and g p i r b i f i ψ e i θ e i ν w i r b i f i ψ e i d θ e i d ν w i u d i cos ψ e i d cos θ e i d with u d i u i u d i 0 0 t using eq 36 g p i can be expanded as 59 g p i r i f i r b i i ψ i θ i ν w i r i f i r b i i ψ d i θ d i ν w i u d i cos ψ e i d cos θ e i d u i r i f i cos ψ i cos θ i cos ψ d i cos θ d i sin ψ i cos θ i sin ψ d i cos θ d i sin θ i sin θ d i u i u d i 0 0 cos ψ e i d cos θ e i d cos α i cos β i from theorem 3 and step 2 g p i can be verified to converge to zero asymptotically moreover g p i can be considered as the input to the following unforced system 60 e p i s i f i e p i u d i cos ψ e i d cos θ e i d u i sin ψ e i d cos θ e i d u i sin θ e i d ν d i f p i consider the lyapunov candidate function v 9 1 2 e p i 2 its derivative is given by 61 v 9 e x i u d i cos ψ e i d cos θ e i d u i d f x i e y i u i sin ψ e i d cos θ e i d f y i e z i u i sin θ e i d f z i e p i t g p i introducing los guidance law 33 and kinematic controller 39 into eq 61 one has 62 v 9 k x e x i 2 u i δ i δ y e y i 2 u i δ i δ y e z i 2 e p i t g p i e p i a min e p i g p i where a min min k x u i δ i δ y therefore it can be deduced from eq 62 that v 9 0 if a min e p i g p i which implies the boundedness of e p i similarly the closed loop system 58 is iss with respect to inputs g q i for the following three reasons a the unforced system 60 is asymptotically stable this can be observed from eq 62 by assuming g p i 0 b the closed loop system 58 satisfies boundedness property i e e p i is bounded c the right hand of 58 is globally lipschitz on the other hand because g p i converges to zero asymptotically we conclude that e p i 0 asymptotically as t 6 simulation results in this section numerical simulations are carried out to validate the feasibility and performance of the proposed protocol we consider a group of 12 underactuated auvs with six leaders and six followers the interactions among vehicles are shown in fig 4 the nominal hydrodynamic coefficients and inertial parameters of auv are the same as those in zhang et al 2020 the system constraints are set as u max u min 4 m s q max r max q min r min 0 6 rad s τ u max τ u min 1200 n and τ q max τ r max τ q min τ r min 600 n m for illustration we compare our proposed two layer control scheme i e method 1 firstly to another model free approach under undirected network i e method 2 which employs the distributed estimator designed in li et al 2018 to generate target trajectory subsequently method 2 uses the tracking strategy proposed in peng et al 2018a wherein the system uncertainties and constraints are handled by extended state observer and rg respectively secondly we compare to a model based method where our proposed distributed estimators are applied for trajectory generation and an unsaturated model based trajectory tracking controller developed in miao et al 2017 is used the differences between three methods are summarized in table 1 the controller parameters for method 1 are given in table 2 parameters for adaptive nns are set as follows the node number q 16 center c s is randomly placed in 1 1 4 4 4 4 4 4 0 6 0 6 0 6 0 6 5 5 and the width b s is chosen as 10 for fair comparison the controller parameters of method 2 are consistent with method 1 except for those of distributed estimators given in li et al 2018 and those of rg given in peng et al 2018a the parameters of method 3 are same as method 1 to evaluate the robustness of proposed scheme against heterogeneous uncertain dynamics the auvs are subject to different levels of parameter perturbations ϖ m i and ϖ d i and external disturbances τ e i τ e u i τ e v i τ e w i τ e q i τ e r i t as shown in table 3 where τ e i τ e u i τ e v i τ e w i τ e q i τ e r i t denotes a standard environmental disturbance generated by 63 τ e u i 0 2 u i u i 0 3 sin 0 2 t τ e v i 0 2 v i v i 0 05 sin 0 2 t τ e w i 0 2 w i w i 0 05 sin 0 2 t τ e q i 0 3 q i q i 0 2 sin 0 3 t τ e r i 0 3 r i r i 0 2 sin 0 3 t the motion of the virtual leader is governed as x 0 t 0 5 t y 0 t 250 sin π t 500 and z 0 t 0 3 t the initial positions of auvs and the time varying formation to be achieved are given in table 4 where the time varying function g t e t 250 10 the simulation results are shown in figs 5 8 we firstly show the effectiveness of the proposed distributed estimator to evaluate the estimation performance numerically we define the estimation error as e d i p ˆ d i p d i as shown in fig 5 the desired position p d i can be quickly and precisely estimated by proposed estimator despite the time varying formation to be achieved therefore reference trajectory generation problem is addressed by the proposed distributed estimators in fig 6 we depict the trajectories of auvs and tracking errors e p i using the three methods although all three methods achieve the fc objective method 1 and method 3 have much smaller steady tracking errors this is mainly because an improved los guidance law is utilized in method 1 and method 3 by contrast conventional los guidance cannot accommodate the nonlinearity induced by nonzero attack angle and sideslip angle this result also shows the negative influence of nonzero attack angle and sideslip angle on tracking performance of auvs in 3d space compared with model based control in method 3 our method is a model free approach which has no prior knowledge on the accurate model of the auv figs 7 and 8 show the profiles of velocity and control input in the surge direction i e surge velocity u i and control input τ u i under three methods it can be noticed that method 1 and method 2 both guarantee a constraint satisfaction while u i and τ u i under method 3 saturate directly at the beginning due to the large tracking errors in method 2 the system constraints are handled by rg which is a numerical optimization based approach and needs to search for an optimal control input in each control period which results in relatively high computational complexity by contrast our method has no such requirement from the above comparative analysis we can conclude that our proposed method outperforms method 2 in terms of less tracking errors and reduced computational complexity compared with method 3 our method has no reliance on accurate model of auvs and is able to achieve the fc objective with guaranteed constraint satisfaction therefore the proposed two layer approach is proved to be practical and effective for performing fc control mission of underactuated auvs in 3d space 7 conclusion this paper addresses the three dimensional fc problem for multiple underactuated auvs exposed to heterogeneous uncertain dynamics and system constraints a novel two layer control scheme has been developed which consists of an upper layer distributed estimators to generate the reference trajectory satisfying fc objectives and a lower layer model free trajectory tracking strategy to achieve local tracking control and robustness against unknown hydrodynamics and system constraints the theoretical analysis and comparative simulation results illustrate the stability and effectiveness of the proposed method in the future research it is of great importance to further consider more realistic underwater circumstances such as switching topologies time delays and collision avoidance credit authorship contribution statement yuwei zhang conceptualization methodology simulation writing original draft xingjian wang investigation funding acquisition writing review editing shaoping wang conceptualization supervision funding acquisition writing review editing xinyu tian visualization validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work is supported by the national science and technology major project grant no 2017 v 0010 0060 the national natural science foundation of china grants no 51620105010 and 51675019 the national basic research program of china grant no jcky2018601c107 and china scholarship council no 201906020030 appendix nonlinear hydrodynamics in dynamics model 3 in dynamic model 3 the nonlinear hydrodynamics of auv is given as zhang et al 2020 a 1 f u i m v i v i r i m w i w i q i d u i u i f v i m u i u i r i d v i v i f w i m u i u i q i d w i w i f q i m w i m u i u i w i d q i q i g i h i sin θ i f r i m u i m v i u i v i d r i r i where d i 1 ϖ d i d i is the actual hydrodynamic damping coefficient d i is the unknown nominal hydrodynamic damping coefficient ϖ d i is the parameter perturbation with respect to the nominal values g i is submerged weight and h i is the distance between the center of gravity and the center of buoyancy in frame b i 
20201,this paper investigates the formation containment fc control problem of networked underactuated autonomous underwater vehicles auvs in three dimensional space the multi auv system under consideration has directed topology heterogeneous uncertain dynamics and system constraints to achieve the leaders formation and followers containment a two layer control framework is adopted to decouple the fc problem into two subproblems reference trajectory generation and trajectory tracking in the upper layer a distributed estimator is designed for each auv to generate a reference trajectory in accordance with the fc objective subsequently a model free trajectory tracking strategy is developed in the lower layer where adaptive neural networks combined with an auxiliary compensator are involved not only to approximate the heterogeneous system dynamics but also to preserve the velocity and input constraints simultaneously input to state stability is employed to analyze the asymptotic stability of the closed loop system finally comparative simulations are carried out to illustrate the effectiveness and robustness of the proposed two layer control protocol keywords autonomous underwater vehicle formation containment control uncertainty system constraints 1 introduction autonomous underwater vehicles auvs have a broad application prospect in ocean engineering areas such as maritime surveillance military reconnaissance marine archaeology and pipeline inspection zhang et al 2015 jawhar et al 2018 as the task complexity and reliability requirement increase it is more reasonable to employ a group of auvs working collaboratively rather than using a single auv to complete the task individually yuan et al 2017 besides greater efficiency and robustness against robot malfunction can be achieved via cooperation therefore coordination control of marine vehicles has received increasing attention as the earliest study of multi auv coordination formation control has been extensively investigated in the past several decades among the numerous formation control methods the leader following strategy is mostly employed due to its ease of implementation ranging from two dimensional 2d plane liang et al 2020 wang et al 2020b millán et al 2013 wei et al 2019 yuan et al 2017 to three dimensional 3d space shojaei 2016 wang et al 2020a yang et al 2019 under the leader following framework one auv is selected as the leader to track some trajectories and the remaining auvs are required to maintain a target geometric pattern with respect to the leader in the case that there exist multiple leaders another interesting issue namely containment control arises in which the followers are expected to move within the convex hull spanned by the leaders distributed containment control algorithms were developed in peng et al 2015 and qin et al 2019 for fully actuated auvs in 2d plane and 3d space respectively more recently a new coordination control scenario namely formation containment fc has been put forward wherein leaders formation and followers containment are required to proceed simultaneously dong et al 2018 the technical challenges of fc control originate from the following aspects 1 in contrast to the single task coordination cases formation or containment fc is much more complex since both the leaders and followers should be simultaneously controlled to achieve distinct objectives 2 fc cannot be simply decoupled into leaders formation problem and followers containment problem because the movement of leaders will influence that of followers fc problem has been studied in various multi agent systems including linear systems dong et al 2015 wang et al 2018 han et al 2016 nonlinear euler lagrange systems li et al 2018 xu et al 2019 chen et al 2019 silva et al 2020 unmanned aerial vehicles dong et al 2018 and autonomous surface vessels liu et al 2019 yu et al 2019 to the best of the authors knowledge the attention concerning fc control of auvs is hitherto rare therefore how to develop a practical fc protocol for auvs moving in 3d space is the primary motivation of this research due to weight and cost considerations most auvs employ an underactuated architecture which brings great difficulties in motion control of auvs for instance auvs moving in 3d space suffer from external disturbances in sway and heave directions which results in nonzero sideslip angle and attack angle however underactuated auvs do not have direct control inputs in sway and heave directions it is therefore challenging to maintain the tracking performance under nonzero sideslip angle and attack angle some attractive methods to address such issue for auvs in 2d plane are summarized in liu et al 2016 and rout et al 2020 but how to alleviate the influence of sideslip angle and attack angle in 3d space is still unsolved on the other hand auvs are required to operate in a dynamically changing and unpredictable environment the hydrodynamic parameters and external disturbances such as waves and ocean currents can vary dramatically note that these perturbations are hard to measure or predict accurately as a result the dynamics of auvs are typically heterogeneous and unknown which renders the model based methods impractical some advanced model free methods have been developed as reviewed in shi et al 2017 benefiting from its prominent approximation ability in handling system uncertainties neural network nn based control has been wildly utilized in the coordination control of multi auv systems peng et al 2015 cui et al 2010 park 2015 yuan et al 2017 cui et al 2017 liang et al 2019a nevertheless the system constraints are not fully taken into account in the above neuro adaptive methods in practice the velocities of auvs are expected to remain within some compact sets in consideration of energy safety and performance the control inputs are bounded due to the physical constraints on thrusters and rudders violating the system constraints will degrade the controller performance even destabilize the closed loop system peng et al 2018b existing methods to address the constraints include anti windup compensator xia et al 2019 reference governor rg peng and wang 2017 model predictive control mpc wei et al 2019 and barrier function he et al 2016 yet the velocity constraints are not considered in these researches more recently rg peng et al 2018a b and mpc zhang et al 2019 methods have been extended to address the velocity and input constraints comprehensively it is worth noting that the mpc method in zhang et al 2019 relies on the accurate model of auvs for motion prediction which is unavailable in practice moreover mpc and rg are optimization based techniques the efficiency of which depends on whether the formulated regulation problem can be solved in real time hence how to achieve a trade off between constraint satisfaction and computational burden is also a currently unsolved challenge motivated by the above considerations this paper intends to address the three dimensional fc problem of underactuated auvs subject to heterogeneous uncertain dynamics and system constraints specifically a two layer control strategy is proposed to decompose the fc problem into two subproblems reference trajectory generation and trajectory tracking the main contribution of this paper is fourfold as follows 1 most existing coordination control of multi auv systems focus on single task problems e g formation or containment which are inappropriate to simultaneously cope with dual task fc problem additionally fc control methods presented in dong et al 2015 wang et al 2018 han et al 2016 li et al 2018 xu et al 2019 chen et al 2019 silva et al 2020 dong et al 2018 liu et al 2019 and yu et al 2019 are not applicable to our case due to the inherent characteristics of underactuated auvs in 3d space 2 in the upper layer a distributed estimator is novelly designed for leaders and followers to generate the reference trajectory satisfying the fc objective the designed estimator extends the time invariant formation in liu et al 2019 and the bidirectional interactions are not required as li et al 2018 therefore the proposed estimator is more general and practical 3 in the lower layer a model free trajectory tracking strategy is developed based on novelly constructed tracking error dynamics in contrast to miao et al 2017 zhang et al 2020 and qi 2015 the nonlinearity induced by attack angle and sideslip angle is involved in position tracking errors rather than orientation errors and is further compensated by the improved 3d guidance law 4 the heterogeneous dynamics and system constraints are addressed by adaptive nns incorporating an auxiliary compensator compared with xia et al 2019 wei et al 2019 peng and wang 2017 he et al 2016 shojaei 2016 and wang et al 2020a where only input constraints are considered velocity constraints can be additionally handled instead of using rg peng et al 2018a b and mpc zhang et al 2019 our method has no dependence on accurate model and real time optimization the remainder of this paper is organized as follows section 2 formulates the fc problem for underactuated auvs in 3d space then we present the two layer protocol in two sections the distributed estimator design section 3 and the model free trajectory tracking control design section 4 section 5 synthesizes the closed loop stability under the proposed method comparative simulation results are presented in section 6 followed by the conclusion notation r n and r n m denote euclidean space with dimension n and the set of n m real matrices 0 n m is the zero matrix with size n m and denote the l 1 norm and l 2 norm respectively λ min p denotes the smallest eigenvalue of the matrix p r a b α β r z α r y β is the rotation matrix from frame a to frame b with r z α cos α sin α 0 sin α cos α 0 0 0 1 and r y β cos β 0 sin β 0 1 0 sin β 0 cos β 2 preliminaries and problem formulation 2 1 mathematical model of underactuated auvs in the rest of this paper we use the subscript i to indicate the variables associated with the i th auv the motion of an auv in 3d space is typically described by a six degrees of freedom 6 dof model in this paper we particularly consider the torpedo shaped auvs which are wildly used in practice and the roll motion of which can be passively stabilized by a metacentric height between centers of gravity and buoyancy yu et al 2017 as a result we neglect the rolling dynamics and therefore centralize on the 5 dof mathematical model of auvs three reference frames are used to describe the model of a 5 dof auv as shown in fig 1 where i b i and w i are the inertial frame body fixed frame and resultant speed frame assume that the origins of frame b i and w i coincide with the center of mass m i of the auv the kinematics of 5 dof auvs can be described as yu et al 2017 miao et al 2017 zhang et al 2020 liang et al 2019b 1 x i u i cos θ i cos ψ i v i sin ψ i w i sin θ i cos ψ i y i u i cos θ i sin ψ i v i cos ψ i w i sin θ i sin ψ i z i u i sin θ i w i cos θ i θ i q i ψ i r i cos θ i where x i y i z i denote coordinates of m i in the frame i θ i and ψ i are the pitch and yaw angles respectively u i v i w i q i and r i denote the surge sway heave pitch and yaw velocities which are expressed in the frame b i define the total speed of auv as u i u i 2 v i 2 w i 2 let ν w i u i 0 0 t and ν b i u i v i w i t following coordinate transformation can be made from frame b i to frame w i 2 ν w i r b i w i β i α i ν b i where α i arctan w i u i and β i arctan v i u i 2 w i 2 are attack angle and sideslip angle due to the port starboard and bottom top symmetries of torpedo shaped auvs more details are given in fossen 2011 do and pan 2009 the dynamics of 5 dof auvs can be simplified as yu et al 2017 miao et al 2017 zhang et al 2020 liang et al 2019b 3 m u i u i f u i τ u i τ e u i m v i v i f v i τ e v i m w i w i f w i τ e w i m q i q i f q i τ q i τ e q i m r i r i f r i τ r i τ e r i where m i 1 ϖ m i m i is the actual inertia coefficient m i is the nominal inertia obtained through towing experiments or computational fluid dynamics simulations ϖ m i is the perturbation rate with respect to the nominal values f i represents the unknown nonlinear hydrodynamics with a simplified form given in appendix τ u i τ q i and τ r i are input force and torques generated by propeller and rudders τ e i stands for the unknown external disturbances remark 1 this 5 dof dynamic model is commonly discussed in motion control of auvs moving in 3d space including path following yu et al 2017 zhang et al 2020 and miao et al 2017 trajectory tracking liang et al 2019b wang et al 2019 and formation control wang et al 2020a shojaei 2016 note that this simplified model did ignore certain nonlinear hydrodynamic damping terms under the assumption of symmetric structure however these ignored hydrodynamics can be considered part of f i which is unknown and will be further compensated by our proposed nn based dynamic controller assumption 1 miao et al 2017 peng and wang 2017 zhang et al 2020 the parameter perturbations ϖ m i and ϖ d i defined in appendix hydrodynamics f i and external disturbance τ e i in eq 3 are assumed to be bounded remark 2 in practice the model parameters m i and d i are perturbed dramatically by the environmental conditions thus we introduce ϖ m i and ϖ d i to consider such inherent property besides the perturbations hydrodynamics and external disturbances are unknown and time varying but limited from the energy perspective peng and wang 2017 therefore assumption 1 is reasonable and practical consider the practical system constraints on auvs we suppose that 4 ρ min ρ i ρ max τ ρ min τ ρ i τ ρ max ρ u q r where ρ min ρ max τ ρ min τ ρ max are known constants although v i and w i are also bounded we cannot guarantee the satisfaction of constraints in the underactuated sway and heave directions as such we mainly consider the controllable surge pitch and yaw directions 2 2 graph theory a directed graph g can be denoted by g v e where v 1 n is a node set and e i j i v j v is the edge set a directed edge i j means that i th vehicle can receive information from j th vehicle an adjacency matrix a a i j r n n is defined as a i j 1 if i j e and a i j 0 otherwise note that a i i 0 for all vertices the laplacian matrix l l i j r n n is defined as l i j a i j if i j otherwise l i i j 1 j i n a i j a directed path from vertex i 0 to vertex i k is a sequence of directed edge with the form of i l i l 1 where i l v l 0 1 k 1 a directed graph contains a spanning tree if there exists at least one vertex having a directed path to all the other vertices 2 3 three dimensional fc control problem formulation assume that the multi auv system consists of n leaders labeled as 1 2 n and m followers labeled as n 1 n 2 n m denote the position vector of i th vehicle as p i x i y i z i t r 3 moreover we define a virtual leader labeled as 0 serving as the virtual center of the target formation to be achieved by the leaders in this research the motion of the virtual leader is not considered and it can be predefined or remotely controlled the position vector of the virtual leader is denoted by p 0 x 0 y 0 z 0 t r 3 assumption 2 li et al 2018 xu et al 2019 the acceleration of the virtual leader is bounded i e there exists a positive constant δ 0 such that p 0 δ 0 remark 3 assumption 2 is made because the information of the virtual leader will be utilized to generate the reference trajectories for the leaders which requires that the trajectory of the virtual leader is smooth in addition underactuated auvs have low maneuverability character thus assumption 2 is desirable from a practical perspective on the basis of graph theory the laplacian matrix of multi auv system can be partitioned as 5 l 0 0 1 n 0 1 m l l 1 l l 2 0 n m 0 m 1 l f 1 l f 2 where l l 1 a 10 a 20 a n 0 t r n represents the interactions from virtual leader to leaders a i 0 1 i 1 n if i th leader knows the reference information l l 2 r n n describes the interactions among leaders l f 1 r m n represents the directed interactions from leaders to followers and l f 2 r m m characterizes the interactions among followers assumption 3 li et al 2018 xu et al 2019 dong et al 2018 the interaction topology among the leaders has a spanning tree with the virtual leader being the root for each follower there exists at least one leader that has a directed path to it lemma 1 if assumption 3 is satisfied then i the eigenvalues of l l 2 have positive real parts ii the eigenvalues of l f 2 have positive real parts and each row of l f 2 1 l f 1 has a sum equal to 1 remark 4 assumption 3 is a basic requirement for the fc control problem if assumption 3 is not satisfied the isolated auvs cannot receive any information from the virtual leader directly or indirectly and no coordination objective can be achieved for lemma 1 the conclusion i is demonstrated su and huang 2011 and the conclusion ii is demonstrated in meng et al 2010 definition 1 leaders in the multi auv system are said to achieve time varying formation if there exists a relative position vector d i t r 3 such that 6 lim t p i t p 0 t d i t 0 i 1 n definition 2 followers in the multi auv system are said to achieve containment if there exist nonnegative constants γ i j satisfying j 1 n γ i j 1 such that 7 lim t p i t j 1 n γ i j p j t 0 i n 1 n m definition 3 the multi auv system is said to achieve fc if there exist a relative position vector d i t r 3 and nonnegative constants γ i j satisfying j 1 n γ i j 1 such that the objectives 6 and 7 are achieved by leaders and followers respectively subsequently we define the target position p d i r 3 for leaders and followers as 8 p d i t p 0 t d i t i 1 2 n j 1 n γ i j p j t i n 1 n m to solve the fc control problem we propose a two layer control strategy as depicted in fig 2 using such a scheme the fc control problem is straightforwardly decoupled into the following two subproblems problem 1 reference trajectory generation consider a multi auv system consisting of n leaders and m followers suppose that assumption 1 3 are satisfied for each auv i 1 n m let p ˆ d i r 3 be the estimated desired position design a distributed estimation law for p ˆ d i such that p ˆ d i t p d i t exponentially as t problem 2 trajectory tracking consider a multi auv system consisting of n leaders and m followers suppose that assumption 1 3 are satisfied for each auv i 1 n m design a control law for τ u i τ q i and τ r i such that p i t p ˆ d i asymptotically as t 3 reference trajectory generation in this section distributed estimators are respectively developed for leaders and followers to address problem 1 3 1 distributed estimator for leaders we propose the following distributed estimator for the leaders 9 p ˆ d i ν ˆ d i j 0 n a i j p ˆ d i p ˆ d j d i d j ν ˆ d i ξ ˆ d i d i ξ ˆ d i j 0 n a i j ξ ˆ d i ξ ˆ d j σ 1 sgn j 0 n a i j ξ ˆ d i ξ ˆ d j i 1 n where p ˆ d i x ˆ d i y ˆ d i z ˆ d i t r 3 and ν ˆ d i x ˆ d i y ˆ d i z ˆ d i t r 3 are the estimations of desired position p d i and desired velocity p d i respectively σ 1 is a positive constant to be determined sgn is the signum function and p ˆ d 0 p 0 ξ ˆ d 0 p 0 d 0 0 the proposed distributed estimator is implemented as follows for the i th auv it can receive ξ ˆ d j and p ˆ d j from the neighboring auv denoted by j particularly if the virtual leader is the neighbor of i th vehicle then a i 0 1 and information of virtual leader ξ ˆ d 0 and p ˆ d 0 will be available theorem 1 let σ 1 δ 0 if assumptions 1 3 hold under distributed estimator 9 p ˆ d i t and ν ˆ d i t converge to p d i t and p d i t exponentially proof define the estimation errors as p d i p ˆ d i p d i ν d i ν ˆ d i p d i ξ ˆ d i p 0 then we rewrite these estimation errors in a compact form as p d l p d 1 t p d 2 t p d n t t and ν d l ν d 1 t ν d 2 t ν d n t t under the distributed estimator 9 the estimation error dynamics are given by 10 p d l ν d l h l p d l ν d l h l ν d l σ 1 sgn h l ν d l 1 n i 3 p 0 where h l l l 2 i 3 and 1 n 1 1 1 r n firstly we show ν d l t 0 exponentially as t consider the following lyapunov function 11 v 1 1 2 ν d l t h l t ν d l differentiating v 1 along the dynamics of ν d l in eq 10 yields 12 v 1 ν d l t h l t h l ν d l σ 1 sgn h l ν d l 1 n i 3 p 0 ν d l t h l t h l ν d l σ 1 h l ν d l ν d l t h l t 1 n i 3 p 0 ν d l t h l t h l ν d l σ 1 δ l h l ν l λ min h l t h l ν d l 2 where the second equality is due to ν d l t h l t sgn h l ν d l h l ν d l note that λ min h l t h l 0 since all eigenvalues of h l have positive real parts under lemma 1 thus eq 12 yields that ν d l converges to zero exponentially secondly we show p d l is bounded as t consider the following lyapunov function 13 v 2 1 2 p d l t h l t p d l the derivative of v 2 is given by 14 v 2 p d l t h l t ν d l h l p d l p l t h l t h l p l p l t h l t ν d l λ min h l t h l p l 2 λ max h l p l ν d l λ min h l t h l 2 p l 2 λ max 2 h l 2 λ min h l t h l ν d l 2 since ν d l converges to zero exponentially if p l λ max h l λ min h l t h l ν d l v 2 0 therefore p d l is guaranteed to be bounded thirdly for the overall system we consider the lyapunov function 15 v 3 v 2 λ max 2 h l λ min 2 h l t h l v 1 the derivative of v 3 is given by 16 v 3 λ min h l t h l 2 p d l 2 λ max 2 h l 2 λ min h l t h l ν d l 2 λ max 2 h l λ min h l t h l ν d l 2 λ min h l t h l 2 p d l 2 λ max 2 h l 2 λ min h l t h l ν d l 2 λ min h l t h l 2 λ max h l v 3 where the last equality follows from v 1 λ max h l ν d l 2 and v 2 λ max h l p d l 2 therefore we can conclude that p d l t converges to zero exponentially remark 5 in the distributed observer 9 we employ a first order sliding mode estimator for ξ ˆ d i in addition to the exponential convergence as shown in theorem 1 the sliding mode estimator additionally guarantees a finite time convergence as demonstrated in cao et al 2010 via a similar proof of theorem 3 1 in cao et al 2010 we can conclude that ξ ˆ d i p 0 t t l where t l max i ξ ˆ d i 0 p 0 0 σ 1 δ 0 remark 6 it should be noted that ξ ˆ d i is discontinuous since sgn is adopted however the finite time convergence implies that 17 t 1 t 2 ξ ˆ d i τ d τ t 1 t 2 p 0 τ d τ t 2 t 1 t l in other words for t t l ξ ˆ d i t can be rewritten as ξ ˆ d i t p 0 t f t where f t is a switching signal function satisfying t 1 t 2 f τ d τ 0 for t 2 t 1 t l and the frequency of f t is infinitely large note that the integrator can be considered as a low pass filter thus the switching signal f t can be filtered out with the integrator therefore we can use ξ ˆ d i t to replace p 0 t in integration based applications for t t l in our estimator we use ξ ˆ d i to construct estimation law for ν ˆ d i and p ˆ d i thus the non continuity will not be involved in ν ˆ d i and p ˆ d i 3 2 distributed estimator for followers from assumption 1 the hydrodynamics f i and external disturbance τ e i are assumed to be bounded in addition the control inputs are also bounded due to physical constraints on propeller and rudders therefore it is reasonable to assume the accelerations of auvs are bounded that is 18 p i δ l i 1 2 n where δ l is a positive constant we design the following distributed estimator for the followers 19 p ˆ d i ν ˆ d i j 1 n m a i j p ˆ d i p ˆ d j ν ˆ d i j 1 n m a i j ν ˆ d i ν ˆ d j σ 2 sgn j 1 n m a i j ν ˆ d i ν ˆ d j i n 1 n m where p ˆ d i r 3 and ν ˆ d i r 3 are the estimations of p d i and p d i respectively σ 2 is a positive constant to be determined we define p ˆ d i p i and ν ˆ d i p i i 1 n let p l p 1 t p n t t and p f p n 1 t p n m t t let p d f p d n 1 t p d n m t t l f 2 1 l f 1 i 3 p l be a weighted average of leaders position from lemma 1 and definition 2 p d f is always within the convex hull spanned by the leaders therefore the containment objective is achieved for followers if p f p d f we rewrite the estimation results in a compact form as 20 p ˆ d f p ˆ d n 1 t p ˆ d n 2 t p ˆ d n m t t ν ˆ d f ν ˆ d n 1 t ν ˆ d n 2 t ν ˆ d n m t t then we have following theorem for the distributed estimator 19 theorem 2 let σ 2 δ l if assumptions 1 3 hold under distributed estimator 19 p ˆ d f t and ν ˆ d f t converge to p d f t and p d f t exponentially proof for convenience we rewrite the distributed observer 19 in a compact form as 21 p ˆ d f ν ˆ d f ψ f ν ˆ d f λ f σ 2 sgn λ f where ψ f and λ f take the following form 22 ψ f l f 1 i 3 p l l f 2 i 3 p ˆ d f λ f l f 1 i 3 p l l f 2 i 3 ν ˆ d f therefore the exponential convergence of p ˆ d f t p d f and ν ˆ d f t p d f t is equivalent to ψ f t 0 and λ f t 0 as t let h f l f 2 1 i 3 we consider the following lyapunov functions 23 v 4 1 2 λ f t h f λ f v 5 1 2 ψ f t h f ψ f taking the derivatives of v 4 and v 5 with respect to eq 21 we obtain 24 v 4 λ f 2 v 5 ψ f 2 λ max h f ψ f λ f using a similar procedure as given in eqs 14 16 we can conclude that λ f and ψ f both converges to zero exponentially remark 7 similar to the analysis in remark 5 the sliding mode estimator for ν ˆ d i also guarantees a finite time convergence i e ν ˆ d i p d i t t f where t f max i ν ˆ d i 0 p d i 0 σ 2 δ l the non continuity in ν ˆ d i t can be also filtered out by the integrator it is seen that with the help of the proposed distributed estimators 9 and 19 the estimated reference trajectory exponentially converges to the desired trajectory satisfying fc objective in the next section local trajectory tracking controller will be designed to achieve p i p ˆ d i 4 model free trajectory tracking strategy in this section model free trajectory tracking control of auvs under heterogeneous uncertain dynamics and system constraints is tackled to address this challenging issue we first construct the trajectory tracking error dynamics based on equivalent coordination transformation in which the negative effect of nonzero attack angle and sideslip angle is considered comprehensively subsequently a kinematic control law is designed based on improved line of sight los guidance law which effectively compensates the nonlinearity induced by nonzero attack angle and sideslip angle finally adaptive nns are employed at the dynamic level to approximate the heterogeneous uncertain dynamics and input truncation the velocity constraints are ensured by introducing an auxiliary compensator 4 1 trajectory tracking error dynamics for i th auv we assign it with a virtual target denoted by p i as shown in fig 3 denote the inertial position and speed vector of p i by p ˆ d i and ν ˆ d i associated with p i the corresponding trajectory frame f i can be built the x axis of which coincides with the speed vector ν ˆ d i denote the rotation matrix from frame f i to frame i by r f i i χ d i υ d i wherein two rotation angles are defined as yu et al 2017 25 χ d i atan 2 y ˆ d i t x ˆ d i t υ d i arctan z ˆ d i t x ˆ d i 2 t y ˆ d i 2 t define the trajectory tracking error e p i between i th auv and target point p i in frame f i as 26 e p i e x i e y i e z i t r i f i p i p ˆ d i where r i f i r f i i χ d i υ d i t is the rotation matrix from frame i to frame f i the derivative of e p i is given by breivik and fossen 2005 27 e p i s i f i e p i r i f i p i ν d i where ν d i u i d 0 0 t is the resultant speed vector of p i with u i d ν ˆ d i s i f i r 3 3 is defined as 28 s i f i 0 χ d i cos υ d i υ d i χ d i cos υ d i 0 χ d i sin υ d i υ d i χ d i sin υ d i 0 introducing kinematic model 1 and velocity transformation 2 into eq 27 yields 29 e p i s i f i e p i r i f i r b i i ψ i θ i ν b i ν d i s i f i e p i r b i f i ψ e i θ e i ν w i ν d i f p i where ψ e i and θ e i are rotation angles from frame b i to frame f i f p i f x i f y i f z i t r i f i r b i i ν b i ν w i is the nonlinearity induced by the nonzero sideslip and attack angles moreover eq 29 can be expanded as 30 e x i e y i χ d i cos υ d i e z i υ d i u i cos ψ e i cos θ e i u i d f x i e y i e x i χ d i cos υ d i e z i χ d i sin υ d i u i sin ψ e i cos θ e i f y i e z i e x i υ d i e y i χ d i sin υ d i u i sin θ e i f z i remark 8 the nonlinearity f p i is equal to zero if and only if ν b i ν w i i e α i 0 and β i 0 due to coordinate transformation 2 however because auvs are exposed to disturbances in sway and heave directions α i and β i will be nonzero and time varying from error dynamics 30 we can note that auvs will exhibit large tracking error under the impact of f p i therefore it is of great importance to compensate such nonlinearity to achieve a satisfied tracking performance remark 9 some existing researches such as miao et al 2017 qi 2015 and zhang et al 2020 construct the error dynamics as 31 e x i e y i χ d i cos υ d i e z i υ d i u i cos χ e i cos υ e i u i d e y i e x i χ d i cos υ d i e z i χ d i sin υ d i u i sin χ e i cos υ e i e z i e x i υ d i e y i χ d i sin υ d i u i sin θ e i f z i where χ e i and υ e i are defined as rotation angles from frame w i to frame f i if so α i and β i will be involved in χ e i and υ e i as shown in following coordinate transformation 32 r w i f i χ e i υ e i r b i f i ψ e i θ e i r w i b i where r w i b i r b i w i β i α i t therefore eq 30 differs from eq 31 in expressing the effect of α i and β i in the position errors rather than the orientation errors benefiting from this it is easier to understand the effect of nonzero attack angle and sideslip angle on tracking performance in the next subsection an improved guidance law will be designed to alleviate such nonlinearity 4 2 kinematic controller design due to the underactuated configuration of auvs the tracking errors in sway and heave directions cannot be directly eliminated in the field of marine vehicle los guidance is popularly utilized to convert the tracking errors in the underactuated directions into the controllable orientation errors to compensate for the nonlinearity f p i following improved los guidance law is developed 33 ψ e i d ta n 1 e y i δ y i δ y θ e i d tan 1 e z i δ z i δ z where δ y and δ z are called look ahead distances satisfying δ z δ y 2 e y i δ y i 2 δ y i and δ z i are auxiliary terms to compensate f y i and f z i satisfying the following equation 34 u i δ y i δ i δ y f y i u i δ z i δ i δ y f z i where δ i δ y 2 e y i δ y i 2 e z i δ z i 2 δ y by expanding eq 34 following two feasible solutions positive roots can be derived 35 δ y i γ y i υ i 1 γ y i 2 γ z i 2 δ z i γ z i υ i 1 γ y i 2 γ z i 2 where υ i e y i γ y i e z i γ z i δ y 2 1 γ y i 2 γ z i 2 e y i 2 e z i 2 e y i γ z i e z i γ y i 2 γ y i f y i u i and γ z i f z i u i recalling the fact that the rotation r b i i from frame b i to frame i is equivalent to the consecutive rotations from frame b i to frame f i and then to frame i we have 36 r f i i χ d i υ d i r b i f i ψ e i d θ e i d r b i i ψ d i θ d i expanding eq 36 yields the desired pitch angle θ d i and the desired yaw angle ψ d i as 37 θ d i arcsin sin υ d i cos θ e i d cos ψ e i d cos υ d i sin θ e i d ψ d i atan2 ψ d i y ψ d i x with 38 ψ d i y sin χ d i cos υ d i cos ψ e i d cos θ e i d cos χ d i sin ψ e i d cos θ e i d sin χ d i sin υ d i sin θ e i d ψ d i x cos χ d i cos υ d i cos ψ e i d cos θ e i d sin χ d i sin ψ e i d cos θ e i d cos χ d i sin υ d i sin θ e i d to steer θ i and ψ i to the desired angles θ d i and ψ d i we design the following kinematic controller 39 u d i k x e x i u i d f x i cos α i cos β i δ i q d i k θ θ i θ d i θ d i r d i k ψ ψ i ψ d i ψ d i cos θ i where k x k θ and k ψ are positive constants to be determined remark 10 some efforts to compensate nonzero sideslip angle in 2d plane are summarized in liu et al 2016 and rout et al 2020 in this research we therefore extend these results to a general and practical 3d space and the influence of attack angle and sideslip angle are alleviated comprehensively 4 3 dynamic controller design in this subsection a model free dynamic controller will be designed to track the velocity commands generated by kinematic controller 39 note that these command signals may violate the velocity constraints due to large tracking errors and large control gains to tackle such issue we incorporate an adaptive compensator into our dynamic controller and the adaptive nns are utilized to approximate the heterogeneous uncertain dynamics and control input truncation due to the similarity in the controller design procedure for τ u i τ q i and τ r i only the surge control input τ u i is discussed in detail define the difference between saturated velocity command and unsaturated command as 40 δ u i s a t u d i ϕ u i u u u d i ϕ u i where function b s a t a a max a min is defined as b a if a min a a max else b a max if a a max or else b a min if a a min u and u are chosen such that u u max and u u min ϕ u i is the compensation term to address the velocity constraint similarly the control input truncation is defined as 41 δ τ u i τ u i τ u i s s a t τ u i s τ u τ u τ u i s where τ u i s is the unsaturated input to be designed τ u and τ u are selected to satisfy that τ u τ u max and τ u τ u min define e u i u i u d i ϕ u i as the regulated velocity tracking error recalling eqs 3 and 41 the derivative of e u i is derived as 42 e u i u i u d i ϕ u i f u i τ u i s δ τ u i τ e u i m u i u d i ϕ u i τ u i s m u i d u i u d i ϕ u i where d u i f u i τ u i τ e u i m u i τ u i s m u i is the lumped uncertainty induced by parameter perturbations heterogeneous hydrodynamics external disturbances and input truncation lemma 2 lu et al 2018 for any unknown continuous function f z with input vector z r m defined on a compact set ω z there exists an ideal constant weight vector w r q such that 43 f z w t h z ɛ where q 1 is the node number ɛ is the bounded estimation error h z h 1 z h q z t r q is the gaussian function taking the following form 44 h s z exp z c s 2 b s 2 s 1 2 q where c s r m and b s r are the center of receptive field and the width of gaussian function consequently the lumped uncertainty d u i can be approximated via adaptive nns namely d u i w i t h z i ɛ i where w i and h z i denote the ideal weight vector and activation function the input vector is defined as z i 1 u i v i w i q i r i τ u i s m u i t ɛ i is the bounded estimation errors lemma 2 implies that there exists a positive constant e i such that ɛ i e i we propose the following unsaturated dynamic controller 45 τ u i s m u i k u e u i u d i ϕ u i w ˆ i t h e ˆ i sgn e u i where w ˆ i and e ˆ i are the estimations of w i and e i respectively updated as 46 w ˆ i η 1 1 e u i h e ˆ i η 2 1 e u i where η 1 0 and η 2 0 are positive constants to be determined an auxiliary adaptive law is developed for ϕ u i as 47 ϕ u i η 3 σ 3 δ u i 2 2 ϕ u i 2 ϕ u i σ 3 δ u i ϕ u i μ u η 3 ϕ u i ϕ u i μ u where η 3 0 and σ 3 0 are positive constants to be determined μ u 0 is a small constant theorem 3 let 2 η 3 σ 3 under dynamic controller 45 incorporating adaptive nns 46 and adaptive compensator 47 e u i and ϕ u i are guaranteed to converge to zero asymptotically proof consider the following lyapunov function 48 v 6 1 2 e u i 2 1 2 η 1 w i t w i 1 2 η 2 e i 2 1 2 ϕ u i 2 where w i w ˆ i w i and e i e ˆ i e i substituting eq 45 into eq 42 one can obtain that 49 e u i k u e u i w i t h e ˆ i sgn e u i ɛ i if ϕ u i μ u i e u d i violates the constraint using eqs 46 47 and 49 the derivative of v 6 can be then calculated as 50 v 6 k u e u i 2 w i t e u i h η 1 w ˆ i e i e u i η 2 e ˆ i η 3 ϕ u i 2 σ 3 2 δ u i 2 σ 3 ϕ u i δ u i e i e u i e u i ɛ i k u e u i 2 2 η 3 σ 3 ϕ u i 2 2 where the last inequality uses the fact that σ 3 ϕ u i δ u i σ 3 ϕ u i 2 2 σ 3 δ u i 2 2 and e u i ɛ i e i e u i by choosing parameters such that 2 η 3 σ 3 we can obtain that 51 v 6 k min e u i 2 2 ϕ u i 2 2 where k min min 2 k u 2 η 3 σ 3 note that eq 51 only guarantees that v 6 is not increasing but cannot converge to zero asymptotically in the meanwhile eq 51 indicates that e u i w i e i and ϕ u i are all bounded furthermore e ˆ i e i e i shows that e ˆ i is also bounded to derive the convergence for e u i and ϕ u i we consider lyapunov function v 7 k min e u i 2 2 ϕ u i 2 2 firstly lim t 0 t v 7 s d s exists and is finite because 52 lim t 0 t v 7 s d s lim t 0 t v 6 s d s v 6 0 lim t v 6 t secondly v 7 is uniformly continuous because 53 v 7 t k min k u e u i 2 2 η 3 σ 3 ϕ u i 2 2 e u i w i t h e ˆ i sgn e u i ɛ i recalling barbalat lemma see lemma 4 2 in slotine et al 1991 if the differential function f t has a finite limit as t and f t is uniformly continuous then f t 0 as t let f t 0 t v 7 s d s we have demonstrated that f t has a finite limit from eq 52 and f t is uniformly continuous from eq 53 which implies f t v 7 t 0 as t therefore we conclude that e u i t and ϕ u i t converge to zero asymptotically if ϕ u i μ u i e u d i is within the constraint the stability analysis can be similarly proved the detailed proof is omitted define the velocity tracking error as s u i u i u d i note that u i u d i e u i ϕ u i thus theorem 3 also implies that lim t s u i t lim t e u i t ϕ u i t 0 5 closed loop stability analysis in this section the stability analysis of the closed loop system will be established on the basis of input to state stability the main result is given in following theorem theorem 4 consider a group of auvs consisting of n leader and m follower the kinematics and dynamics of auvs are described as 1 3 if assumptions 1 3 are satisfied then the leaders formation and followers containment can be achieved by using the proposed two layer framework which consists of distributed estimators 9 19 improved los based kinematic controller 39 and adaptive nn based dynamic controller 45 proof we define the tracking error as e p i t p i t p d i t and it can be expanded as 54 e p i t p i t p ˆ d i t p ˆ d i t p d i t r f i i e p i t p ˆ d i t p d i t where p ˆ d i t p d i t is proved to converge to zero exponentially in theorems 1 and 2 it rest to demonstrate that e p i t 0 as t to this end the proof is illustrated in the following three steps step 1 define the angular velocity tracking errors as s r i t r i t r d i t and s q i t q i t q d i t using a similar proof given in theorem 3 we obtain lim t s r i t 0 and lim t s q i t 0 step 2 define angle tracking errors as e θ i θ i θ d i and e ψ i ψ i ψ d i then we will show lim t e θ i t 0 and lim t e ψ i t 0 differentiating e θ i and e ψ i along the kinematic model 1 yields 55 e θ i k θ e θ i s q i e ψ i k ψ e ψ i s r i cos θ i in which s q i and s r i can be considered as the inputs to the following unforced system 56 e θ i k θ e θ i e ψ i k ψ e ψ i consider the lyapunov candidate function v 8 1 2 e θ i 2 1 2 e ψ i 2 its derivative is given by 57 v 8 k θ e θ i 2 k ψ e ψ i 2 e θ i s q i e ψ i s r i cos θ i when e θ i is large the third term in eq 57 is o e θ i while the first term is o e θ i 2 this argument also applies to e ψ i therefore e θ i and e ψ i are ultimately bounded therefore the closed loop system 55 is input to state stable iss with respect to inputs s q i and s r i for the following three reasons see theorem 3 1 in sontag 2008 a the unforced system 56 has a globally asymptotically stable equilibrium at the origin b the closed loop system 55 satisfies boundedness property i e e θ i and e ψ i are bounded c the right hand of 55 is globally lipschitz because s q i and s r i converge to zero asymptotically in step 1 thus the origin of the closed loop system 55 is also globally asymptotically stable see lemma 4 6 in khalil 2015 step 3 now we consider the convergence of e p i we rewrite the error dynamics 31 as 58 e p i s i f i e p i u d i cos ψ e i d cos θ e i d u i sin ψ e i d cos θ e i d u i sin θ e i d ν d i f p i g p i where u d i u d i cos α i cos β i and g p i r b i f i ψ e i θ e i ν w i r b i f i ψ e i d θ e i d ν w i u d i cos ψ e i d cos θ e i d with u d i u i u d i 0 0 t using eq 36 g p i can be expanded as 59 g p i r i f i r b i i ψ i θ i ν w i r i f i r b i i ψ d i θ d i ν w i u d i cos ψ e i d cos θ e i d u i r i f i cos ψ i cos θ i cos ψ d i cos θ d i sin ψ i cos θ i sin ψ d i cos θ d i sin θ i sin θ d i u i u d i 0 0 cos ψ e i d cos θ e i d cos α i cos β i from theorem 3 and step 2 g p i can be verified to converge to zero asymptotically moreover g p i can be considered as the input to the following unforced system 60 e p i s i f i e p i u d i cos ψ e i d cos θ e i d u i sin ψ e i d cos θ e i d u i sin θ e i d ν d i f p i consider the lyapunov candidate function v 9 1 2 e p i 2 its derivative is given by 61 v 9 e x i u d i cos ψ e i d cos θ e i d u i d f x i e y i u i sin ψ e i d cos θ e i d f y i e z i u i sin θ e i d f z i e p i t g p i introducing los guidance law 33 and kinematic controller 39 into eq 61 one has 62 v 9 k x e x i 2 u i δ i δ y e y i 2 u i δ i δ y e z i 2 e p i t g p i e p i a min e p i g p i where a min min k x u i δ i δ y therefore it can be deduced from eq 62 that v 9 0 if a min e p i g p i which implies the boundedness of e p i similarly the closed loop system 58 is iss with respect to inputs g q i for the following three reasons a the unforced system 60 is asymptotically stable this can be observed from eq 62 by assuming g p i 0 b the closed loop system 58 satisfies boundedness property i e e p i is bounded c the right hand of 58 is globally lipschitz on the other hand because g p i converges to zero asymptotically we conclude that e p i 0 asymptotically as t 6 simulation results in this section numerical simulations are carried out to validate the feasibility and performance of the proposed protocol we consider a group of 12 underactuated auvs with six leaders and six followers the interactions among vehicles are shown in fig 4 the nominal hydrodynamic coefficients and inertial parameters of auv are the same as those in zhang et al 2020 the system constraints are set as u max u min 4 m s q max r max q min r min 0 6 rad s τ u max τ u min 1200 n and τ q max τ r max τ q min τ r min 600 n m for illustration we compare our proposed two layer control scheme i e method 1 firstly to another model free approach under undirected network i e method 2 which employs the distributed estimator designed in li et al 2018 to generate target trajectory subsequently method 2 uses the tracking strategy proposed in peng et al 2018a wherein the system uncertainties and constraints are handled by extended state observer and rg respectively secondly we compare to a model based method where our proposed distributed estimators are applied for trajectory generation and an unsaturated model based trajectory tracking controller developed in miao et al 2017 is used the differences between three methods are summarized in table 1 the controller parameters for method 1 are given in table 2 parameters for adaptive nns are set as follows the node number q 16 center c s is randomly placed in 1 1 4 4 4 4 4 4 0 6 0 6 0 6 0 6 5 5 and the width b s is chosen as 10 for fair comparison the controller parameters of method 2 are consistent with method 1 except for those of distributed estimators given in li et al 2018 and those of rg given in peng et al 2018a the parameters of method 3 are same as method 1 to evaluate the robustness of proposed scheme against heterogeneous uncertain dynamics the auvs are subject to different levels of parameter perturbations ϖ m i and ϖ d i and external disturbances τ e i τ e u i τ e v i τ e w i τ e q i τ e r i t as shown in table 3 where τ e i τ e u i τ e v i τ e w i τ e q i τ e r i t denotes a standard environmental disturbance generated by 63 τ e u i 0 2 u i u i 0 3 sin 0 2 t τ e v i 0 2 v i v i 0 05 sin 0 2 t τ e w i 0 2 w i w i 0 05 sin 0 2 t τ e q i 0 3 q i q i 0 2 sin 0 3 t τ e r i 0 3 r i r i 0 2 sin 0 3 t the motion of the virtual leader is governed as x 0 t 0 5 t y 0 t 250 sin π t 500 and z 0 t 0 3 t the initial positions of auvs and the time varying formation to be achieved are given in table 4 where the time varying function g t e t 250 10 the simulation results are shown in figs 5 8 we firstly show the effectiveness of the proposed distributed estimator to evaluate the estimation performance numerically we define the estimation error as e d i p ˆ d i p d i as shown in fig 5 the desired position p d i can be quickly and precisely estimated by proposed estimator despite the time varying formation to be achieved therefore reference trajectory generation problem is addressed by the proposed distributed estimators in fig 6 we depict the trajectories of auvs and tracking errors e p i using the three methods although all three methods achieve the fc objective method 1 and method 3 have much smaller steady tracking errors this is mainly because an improved los guidance law is utilized in method 1 and method 3 by contrast conventional los guidance cannot accommodate the nonlinearity induced by nonzero attack angle and sideslip angle this result also shows the negative influence of nonzero attack angle and sideslip angle on tracking performance of auvs in 3d space compared with model based control in method 3 our method is a model free approach which has no prior knowledge on the accurate model of the auv figs 7 and 8 show the profiles of velocity and control input in the surge direction i e surge velocity u i and control input τ u i under three methods it can be noticed that method 1 and method 2 both guarantee a constraint satisfaction while u i and τ u i under method 3 saturate directly at the beginning due to the large tracking errors in method 2 the system constraints are handled by rg which is a numerical optimization based approach and needs to search for an optimal control input in each control period which results in relatively high computational complexity by contrast our method has no such requirement from the above comparative analysis we can conclude that our proposed method outperforms method 2 in terms of less tracking errors and reduced computational complexity compared with method 3 our method has no reliance on accurate model of auvs and is able to achieve the fc objective with guaranteed constraint satisfaction therefore the proposed two layer approach is proved to be practical and effective for performing fc control mission of underactuated auvs in 3d space 7 conclusion this paper addresses the three dimensional fc problem for multiple underactuated auvs exposed to heterogeneous uncertain dynamics and system constraints a novel two layer control scheme has been developed which consists of an upper layer distributed estimators to generate the reference trajectory satisfying fc objectives and a lower layer model free trajectory tracking strategy to achieve local tracking control and robustness against unknown hydrodynamics and system constraints the theoretical analysis and comparative simulation results illustrate the stability and effectiveness of the proposed method in the future research it is of great importance to further consider more realistic underwater circumstances such as switching topologies time delays and collision avoidance credit authorship contribution statement yuwei zhang conceptualization methodology simulation writing original draft xingjian wang investigation funding acquisition writing review editing shaoping wang conceptualization supervision funding acquisition writing review editing xinyu tian visualization validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment this work is supported by the national science and technology major project grant no 2017 v 0010 0060 the national natural science foundation of china grants no 51620105010 and 51675019 the national basic research program of china grant no jcky2018601c107 and china scholarship council no 201906020030 appendix nonlinear hydrodynamics in dynamics model 3 in dynamic model 3 the nonlinear hydrodynamics of auv is given as zhang et al 2020 a 1 f u i m v i v i r i m w i w i q i d u i u i f v i m u i u i r i d v i v i f w i m u i u i q i d w i w i f q i m w i m u i u i w i d q i q i g i h i sin θ i f r i m u i m v i u i v i d r i r i where d i 1 ϖ d i d i is the actual hydrodynamic damping coefficient d i is the unknown nominal hydrodynamic damping coefficient ϖ d i is the parameter perturbation with respect to the nominal values g i is submerged weight and h i is the distance between the center of gravity and the center of buoyancy in frame b i 
20202,this paper numerically investigates the ultimate strength behavior of the laser welded web core sandwich plates under in plane compression both geometric nonlinearity and material nonlinearity are taken into consideration besides the global deflection of the sandwich plate the local deflections of the face plates are also introduced in the ultimate strength analyses to study the influence of the local buckling on the ultimate strength the influence of the magnitudes of the initial deflections on the ultimate strength of the web core sandwich plates is studied four boundary conditions are considered and the result shows that the boundary conditions on the unloaded edges i e the simply supported or clamped boundary conditions have little effect on the ultimate strength of the sandwich plate the ultimate strength of the sandwich plates shows a reduction when the laser weld rotation stiffness is accounted for and transverse shear stiffness has a large effect on the ultimate strength the contact between the web plates and face plates in the joints increases the ultimate strength of the sandwich plates and the smaller root gap results in the higher ultimate strength keywords web core sandwich plate ultimate strength global buckling local buckling rotation stiffness 1 introduction steel sandwich plates are orthotropic structures which consist of a series of cores and are enclosed by two face plates these plates are fabricated based on laser welding manufacturing technology which makes it possible to join metal sheets into structures with small welding deformation because of the low energy input during welding processes sandwich plates are characterized by light weight higher stiffness to weight and strength to weight ratios roland and metschkow 1997 and therefore have unique advantages in strength fatigue vibration and impact resistance marsico et al 1993 with the development of laser welding technology which enables the efficient production of these plates steel sandwich plates have been put into wide application in aerospace marine and road traffic engineering fields such applications make these plates subjected to the in plane compressive loads especially when used in a ship or a bridge deck therefore stability including buckling and even ultimate collapse becomes a design issue this study concentrates on the lase welded web core sandwich plates which have two face plates separated by the web plates as shown in fig 1 this configuration is the simplest but most widely used sandwich plates a few studies in the load carrying behavior of the web core sandwich plates have been reported before among which more investigations are inclined to the buckling without considering the material nonlinearity effects as for the studies of the buckling of the web core sandwich plates kolsters and zenkert 2006a b examined the elastic buckling parallel and normal to the webs and collapse of laser welded sandwich panels filled with the foam core and come to the conclusion that the buckling stress in compression parallel and normal to the webs typically reaches the proportional limit of the face plate and web material well before elastic buckling occurs jelovica and romanoff 2013 investigated the buckling and post buckling strength of the geometrically imperfect web core sandwich plates using two approaches i e the equivalent single layer theory approach and a three dimensional shell model of a sandwich plate the influence of imperfection magnitude stiffness coefficient local buckling and boundary conditions on the post buckling was studied however only the first eigenmode was used as the geometric imperfection and the material nonlinearity effect was not considered thus the ultimate limit state was not reached in the fe analyses jelovica et al 2012 studied the influence of weld rotation stiffness on the global bifurcation buckling strength of laser welded web core sandwich plates the results showed a maximum of 24 decrease in buckling strength and it was important to take the deforming weld into account in buckling analysis furthermore jelovica et al 2014 conducted a study to investigate the influence of general corrosion on buckling strength of laser welded web core sandwich plates and a rapid decrease in the buckling strength was found for corrosion affecting the outer sides of the sandwich plate however the relevant studies of the ultimate strength of the laser welded web core sandwich plates are rarely reported especially when comparing with that of stiffened panels on the contrary the studies of the ultimate strength of stiffened panels are more systematic and comprehensive in which some effective methods have been developed which can be roughly divided into the following categories caldwell method caldwell 1965 nonlinear finite element method fujikubo et al 2005a liu et al 2018 xu and soares 2012 2013a idealized structural unit method isum paik and pedersen 1996 paik and thayamballi 2003a smith method gordo and soares 1993 and model test method gordo and soares 2009 xu and soares 2013b c with regards to the studies of the ultimate strength of the laser welded sandwich plates kozak 2006 conducted a series of experiments and numerical modeling to investigate the ultimate strength of the laser welded steel sandwich beams and derived that the failure modes depended on the plates cross sections kolsters and zenkert 2010 extended the buckling model into the elasto plastic regime to determine the ultimate strength of the sandwich plates experiments were also conducted to verify the results jelovica et al 2013 carried out ultimate strength experiments in three point bending for beams with different corrosion exposure times and found that the experimental ultimate strength was in good agreement with finite element simulations it can be concluded that the studies of the ultimate strength of the sandwich plates under the in plane compression are limited especially for the sandwich plates between strong supporters i e transverse frames and longitudinal girders when applied in real hull structures additionally the appropriate initial deflections have not been specified in previous studies which is deemed to be significant for the ultimate strength analyses furthermore the actual laser weld rotation stiffness and its statistical variation must be considered in the ultimate strength analyses of the sandwich plates for some investigations have shown that the connection between the face and core plates has significant influence on the load carrying behavior of sandwich plates haj ali et al 2009 jelovica et al 2012 rahman and abubakr 2004 saffirna et al 2021 yan and jelovica 2021 to fill in this research gap and get a better understanding of the load bearing characteristics more effort should be put into the study of the ultimate strength of laser welded web core sandwich plates under in plane compression either theoretically numerically or experimentally the present study aims to numerically investigate the ultimate strength behavior of the laser welded web core sandwich plates under in plane compression plates are loaded in the direction parallel to the web plates a series of nonlinear finite element analyses are carried out with both geometric nonlinearity and material nonlinearity being taken into consideration except for the global deflection of the sandwich plate the local deflections of the face plates are introduced in the ultimate strength analyses to study the influence of the local buckling on the ultimate strength the influence of magnitudes of the initial deflections on the ultimate strength of the web core sandwich plates is investigated besides four boundary condition cases are compared to discuss the influence of boundary conditions on the ultimate strength of the laser welded web core sandwich plates furthermore the influence of laser weld including the magnitude of the rotation stiffness and the contact of the web plates and the face plates on the ultimate strength of the sandwich plates is investigated 2 finite element modeling 2 1 geometry and material as shown in fig 1 t t and t b are thicknesses of the top and bottom face plates in this study the thickness of the top face plate is equal to that of the bottom face plate thus the thickness of face plates is collectively referred as t f h c is the height of the sandwich plate core while s denotes the spacing of the web plates the notation used to identify the plates is the following t f h c s t w is the thickness of the web plate in this paper four different cross sections are considered and the thickness of the web plates is 4 mm for all plates case a 2 5 40 120 is the standard sandwich configuration in engineering applications case b 4 40 120 is the sandwich plate with thick face plates case c 4 20 120 is the sandwich plate with thick face plates and small core height while case d 1 40 120 is the sandwich plate with thin face plates length a and width b of the sandwich plates are 2 76 m thus the aspect ratio a b is equal to unity laser weld rotation stiffness k θ is defined as the ratio between the moment at the weld and the rotation angle of the web and face plate see fig 1 given as 1 k θ m θ the shear stiffness in the transverse direction is directly affected by the laser weld rotation stiffness k θ and is given as romanoff et al 2007 2 d q y 12 d w s 2 k q d w d t 6 d s 12 d w k θ s 2 d s where the bending stiffness of the face and web plates is 3 d i e i t i 3 12 i t b w and k q is given as 4 k q 1 12 d t s 1 k θ t 1 k θ b 6 d t d w d s 1 12 d t d w d s d t d b the shear stiffness in the longitudinal direction is 5 d q x k 11 2 g t t t g b t b t w s g w h c where 6 k 11 1 a i τ i q q x s 2 t i d s i i t c b high tensile strength steel is used in this paper the strain hardening effect is not taken into account even though some researchers such as paik and thayamballi 2003b have pointed out that the strain hardening effect will make the ultimate strength of the stiffened plates larger than those without considering it however an elastic perfectly plastic steel material model is considered sufficient and adequate for pessimistic assessment in this regard the behavior of the material adopted in the present study is assumed to follow the elastic perfectly plastic manner without considering the strain hardening effect the schematic of the stress strain behavior is illustrated in fig 2 and the detailed material properties are listed in table 1 2 2 boundary and loading conditions in the studies of the buckling and the ultimate strength of the stiffened plates simplified boundary conditions such as the simply supported or clamped boundary conditions are adopted according to the most current practical design criteria from classification societies in general the stiffened plates are supported by strong supporters such as longitudinal girders and transverse frames along the edges which provides a finite amount of rotational restraint stiffness therefore the actual ultimate strength of the stiffened plates is between those under the simply supported boundary condition and the clamped boundary condition for simplicity in the present study the simply supported boundary condition and the clamped boundary condition are adopted while the symmetric boundary condition is not used for the reason it neglects the asymmetric factors due to the existence of the actual out of plane dimension a different approach is required to simply support or clamp the web core sandwich plates than that of the stiffened plates therefore the deflection restraint for the simply supported boundary condition is set only on the nodes at the geometrical mid plane this allows the rotation of the plate around the mid plane edge furthermore the vertical nodes along the edge are displaced equally in the edge direction to prevent the rotation of the in plane axis orthogonal to the edge for example all the nodes at a certain web plate have the same displacement in the y direction v see fig 3 a to clamp the sandwich plate edge vertical nodes at the edge have the same displacement both in the x and y direction u and v see fig 3 b in this study four types of boundary conditions are considered ss ss all edges simply supported cc cc all edges clamped ss cc the loaded edges simply supported and the unloaded edges clamped cc ss the loaded edges clamped and the unloaded edges simply supported see fig 3 thus four boundary condition cases are compared to investigate the influence of boundary conditions on the ultimate strength of laser welded web core sandwich plates the loading condition adopted in this paper is the in plane displacement load acted on the nodes at the geometrical mid plane of the loading edges by which end shortening can be measured directly the force load is obtained by summing up the reaction forces of nodes at the loading edges 2 3 initial imperfections compared to the traditional welding techniques such as flame cutting and fusion welding the energy density of laser welding is highly concentrated and the heat affected zone is relatively limited thus the imperfections including welding residual stress and deformation are relatively smaller than those of traditional welding nevertheless the imperfections can be still generated in plated structures during fabrication processes it is generally recognized that the initial imperfections tend to decrease the rigidity and ultimate strength of structures such as stiffened plates and should be accounted for in the ultimate strength assessment paik and seo 2009 the collapse behavior of plated structure subjected to compression depends on the shape of its initial deflection the influence of the initial imperfections on the ultimate strength behavior of welded steel plates has been studied by a lot of investigators such as yao et al 1998 and paik et al 2004 for simplicity and the reason of less importance compared to the welding deformation the welding induced residual stresses are not taken into account in the present study kozak 2006 precisely measured the initial deflections of each sandwich model prior to loading in his experimental study of sandwich plates under in plane load however the realistic measurement data of initial deflection is generally not available in the design or theoretical investigation and thus the initial deflections are considered as the superposition of the fourier components in the ultimate strength assessment of stiffened plates fujikubo et al 2005b xu et al 2017 jelovica and romanoff 2013 introduced the first eigenmode as the shape of the initial imperfection it is a global deflection with a single half wave in both longitudinal and transverse directions however the local deflections of the face plates are not considered which is not reasonable therefore in the present study two types of initial deflections including the local deflections of the face plates and the global deflection of the sandwich plate are considered see fig 4 the local deflections of the face plates include the symmetric local deflections and the asymmetric local deflections about the geometrical mid plane as shown in fig 5 it is commonly recognized that such regular initial deflections generally do not exist in realistic structures but are the idealization of initial deflections in the ultimate strength assessment as done in the fe analyses of the ultimate strength of the stiffened plates the initial deflections are given as follows 1 local deflections of the face plates symmetric local deflections of the face plates 7 w l o c s y m m e t r i c a 0 sin m π x a sin π y s for top face plate a 0 sin m π x a sin π y s for bottom face plate asymmetric local deflections of the face plates 8 w l o c a s y m m e t r i c a 0 sin m π x a sin π y s for top face plate a 0 sin m π x a sin π y s for bottom face plate 2 global deflection of the sandwich plate 9 w g l o b 0 sin m π x a sin π y b in this paper the amplitudes of the local deflections of the top and bottom face plates are assumed to be equal as a 0 while b 0 is the amplitude of the global deflection of the sandwich plate m is the buckling half wave number in the longitudinal direction of the local face plates and m is the buckling half wave number in the longitudinal direction of whole sandwich plates they are determined as the minimum integer that satisfies the following equations paik and thayamballi 2003b 10 a s m m 1 11 a b m m 1 in the ultimate strength analyses of stiffened plates with traditional welding procedure a 0 is categorized into three levels as follows smith et al 1988 12 a 0 0 025 β 2 t f slight degree 0 1 β 2 t f moderate degree 0 3 β 2 t f severe degree where a 0 is usually taken as the moderate degree i e a 0 0 1β 2 t f and b 0 0 0015a xu et al 2018 β is the slenderness ratio of the plate and defined by the following equation 13 β s t f σ y e considering that initial deflections of laser welding is smaller than that of conventional welding and recorded deformation amplitudes are not specified in literature in the present work various magnitudes of a 0 and b 0 are adopted to determine the effect of the amplitudes of initial deflections on the ultimate strength of sandwich plates see table 2 fig 6 shows the comparison of normalized load end shortening curves of case a sandwich plate with symmetric and antisymmetric local deflections of the face plates it can be observed that the two normalized load end shortening curves of case a sandwich plate with symmetric and antisymmetric local deflections of the face plates are very close and there is little difference in ultimate strength therefore it can be considered that the symmetry or antisymmetry of the local deflections of the face plates have little effect on the ultimate strength of the sandwich plates thus in the present study only the symmetric local deflections of the face plates are taken into account in the ultimate strength analyses of laser welded web core sandwich plates 2 4 adopted elements and convergence study in the present study the collapse behavior and ultimate strength of sandwich plates are assessed using the finite element code abaqus in which both geometric and material nonlinearities are taken into account s4r shell elements are used to model the face plates and web plates of the sandwich plate the s4r element type is a four node doubly curved general purpose shell that offers reduced integration to control hourglass instability per element node has six degrees of freedom the welds are modeled with spring elements connector elements conn3d2 which connect the face and web plates at their apparent intersection the element allows an explicit definition of the rotation stiffness i e moment angle relationship it is required that the mesh size of the fe model should be fine enough to accurately simulate the collapse behavior of the sandwich plates on the other hand finer mesh causes more computational efforts in this regard a balance between accuracy and computational time must be made in this paper the sizes of elements for the face plates and web plates are varied for convergence study three types of mesh configurations have been considered table 3 shows these three types of mesh sizes for the case of the simply supported case a sandwich plate with a 0 0 025β 2 t f and b 0 0 001a nonlinear fe analyses were carried out on a computer with an intel r xeon r gold 6139m cpu with 2 3 ghz and 128 gb ram in this section the weld is not considered which indicates that the rotation stiffness of the weld is infinite in the fe calculations fig 7 gives the normalized load end shortening curves for the convergence study it can be seen from table 3 and fig 7 that finer mesh leads to smaller ultimate strength but the difference is relatively small accordingly the middle mesh case has been selected for the meshing standards of the fe models in this paper 3 results and discussions 3 1 influence of magnitudes of initial deflections in this section case a 2 5 40 120 is used to study the influence of magnitudes of initial deflections on the ultimate strength of sandwich plates fig 8 a shows the difference between normalized load end shortening curves of the simply supported sandwich plate with and without considering material nonlinearity the magnitude of global deflection of the sandwich plate b 0 is 0 001a i e 2 8 mm while the local deflections of the face plates are not considered in this work the buckling strength is determined through linear buckling analysis in the commercial fe software abaqus in fig 8 a the two curves almost overlap before the buckling strength is reached indicating that the material nonlinearity has not taken effect during this period as reported by jelovica and romanoff 2013 when material nonlinearity is not taken into account the curve keeps rising with a slope smaller than that in the buckling regime local buckling leads to an additional reduction of sandwich plate stiffness in the post buckling range which is not significant in this case when local buckling occurs at point 1 in the post buckling regime see fig 8 b however when material nonlinearity is accounted for the curve rises to a maximum value i e the ultimate strength of the sandwich plate after which it begins to fall it suggests that the sandwich plate still has a certain load bearing margin after reaching the buckling strength local buckling does not occur until point 2 in the post collapse regime see fig 8 c therefore the sandwich plate collapses as a global buckling mode while local buckling has little effect on the ultimate strength of the sandwich plate in this case fig 9 a presents the normalized load end shortening curve of the simply supported case a sandwich plate by introducing local deflections of the face plates with a 0 0 27 mm and b 0 2 8 mm and fig 9 b g plot its stress distributions and deformations during the loading process it can be seen that before point 2 such as point 1 the sandwich plate deforms as the global deflection of the sandwich plate as fig 9 b while local buckling is not observed on the face plates at point 2 local buckling occurs near the unloading edges on the concave side see fig 9 c after that at point 3 the middle part on the concave side of the sandwich plate also buckles locally see fig 9 d further loading makes the compressive stress increases and the face plates buckle on the convex side of the unloaded edges at point 4 see fig 9 e the ultimate strength of the sandwich plate is reached at point 5 where the magnitude of local buckles grows see fig 9 f g in this case local buckling affects the ultimate strength of the sandwich plate and the collapse mode of the sandwich plate is a global mode with local buckling decreasing its ultimate capacity fig 10 presents normalized load end shortening curves with varying the magnitudes of local deflections of the face plates for the simply supported case a sandwich plate it is observed from fig 10 that the stiffness of the pre collapse regime is decreased as the magnitudes of local deflections of the face plates increase larger local deflections of the face plates will affect the normalized load end shortening curves earlier which indicates that local buckling occurs earlier and affects the ultimate strength of the sandwich plate with greater magnitudes of local deflections of the face plates therefore the ultimate strength of the sandwich plate is decreased as the local buckling reduces the stiffness of the sandwich plate to be specific the reductions are around 2 between a 0 0 and a 0 0 27 mm 4 between a 0 0 and a 0 0 54 mm and 10 between a 0 0 and a 0 1 1 mm in the post collapse range due to the local buckling the curve with larger magnitudes of local deflections of the face plates drops more gently than that with a smaller amplitude of local deflections it is worth noting that b 0 is from 0 0005a to 0 002a in fig 10 a d respectively which ranges from the small magnitude value to the large magnitude value of global imperfection for laser welding therefore the observations above are valid for all of the global imperfection magnitude values fig 11 shows the normalized load end shortening curves with varying the amplitude of global deflection of the simply supported case a sandwich plate it can be seen from fig 11 that for the sandwich plates with the same magnitudes of local deflections of the face plates the ultimate strength of the sandwich plate is decreased with the increase of the amplitude of global deflection of the sandwich plate the reductions being around 1 5 between b 0 1 4 mm and b 0 2 8 mm 3 between b 0 1 4 mm and b 0 4 2 mm and 4 5 between b 0 1 4 mm and b 0 5 6 mm however in the post collapse range the unloading curves almost overlap to explain it the deformation configuration of the sandwich plate is divided into two parts the deformations caused by the global buckling and the local buckling in the present study the case a sandwich plate first buckles globally and then buckles locally in this sense the case a sandwich plates with the same local imperfections and different global imperfections first buckle globally to the same degree of global deformation before local buckling occurs afterwards in the post collapse regime the case a sandwich plates tend to have the same deformation configurations and as a result have the same load carrying characteristics reciprocally a 0 is from 0 to 0 1β 2 t f in fig 11 a d respectively which ranges from the small magnitude value to the large magnitude value of local imperfection for laser welding therefore the observations above are valid for all of the local imperfection magnitude values through the above analyses the ultimate strength decreases by about 7 5 for each 1 mm increase of the magnitude of local deflections of the face plates while the ultimate strength is reduced by around 1 for each 1 mm increase of the magnitude of global deflection of the sandwich plate thus it can be concluded that the local imperfections have a larger influence than the global imperfection on the ultimate strength of the web core sandwich plates in engineering applications it will be a more effective way to increase the ultimate strength of the web core sandwich plates by reducing the magnitude of local imperfections 3 2 influence of boundary conditions fig 12 plots the normalized load end shortening curve of the clamped case a sandwich plate by introducing local deflections of the face plates with a 0 0 27 mm and b 0 2 8 mm and stress distributions and deformation in the loading process it can be seen from fig 12 that the sandwich plate deforms as the global buckling shape in the initial loading phase but the deformation is relatively restricted by the clamped boundary condition in contrast to fig 9 at point 1 local buckling occurs at the loaded edges on the convex side and central part on the concave side of the sandwich plate see fig 12 b c then the unloaded edges on both sides of the sandwich plate also buckle locally at point 2 the sandwich plate reaches the ultimate state where the structure fails rapidly and loses its load carrying capacity see fig 12 d e fig 13 shows the normalized load end shortening curves for the case a sandwich plate with different boundary conditions comparing to the curve with ss ss boundary condition it is evident that the sandwich plate with cc cc boundary condition has higher ultimate strength and the stiffness in the pre collapse regime is also higher than that with ss ss boundary condition however the boundary condition at the unloaded edges has little effect on the ultimate strength of the sandwich plate it can be seen from fig 13 that the difference between normalized load end shortening curves of ss ss and ss cc boundary conditions is negligible and the same is true for cc cc and cc ss boundary conditions it indicates that more rigorous boundary conditions on the loaded edges can significantly improve the ultimate capacity of the sandwich plate while the boundary conditions on the unloaded edges whether simply supported or clamped boundary conditions have little effect on the ultimate strength of the sandwich plate to explain this phenomenon the loading condition that the sandwich plates are compressed in the direction perpendicular to the web plates is considered for comparison in this section fig 14 gives normalized load end shortening curves for the case a sandwich plate with a 0 0 025β 2 t f and b 0 0 001a in different loading directions it can be seen from fig 14 a that the ultimate strength of the sandwich plates loaded in the direction parallel to the web plates is much higher than that of the sandwich plates loaded in the direction perpendicular to the web plates it is due to the orthotropic nature of the sandwich plates in addition the difference between the boundary conditions ss ss and cc cc is about 7 when the sandwich plates are loaded in the direction perpendicular to the web plates much lower than 40 when the sandwich plates are loaded in the direction parallel to the web plates which suggests that the ultimate strength of sandwich plates is not sensitive to the boundary conditions on the edges parallel to the web plates due to the orthotropy of the sandwich plates this is further confirmed by comparing ss ss to ss cc and cc ss to cc cc in fig 14 b which shows that there is no significant difference in the ultimate strength of the sandwich plates between the simply supported and clamped boundary conditions on the edges parallel to the web plates besides when comparing ss ss to cc ss and ss cc to cc cc in fig 14 b it can be observed that the sandwich plates with clamped boundary condition on the edges perpendicular to the web plates have slightly higher ultimate strength than that with simply supported boundary condition but the difference is not very significant 3 3 influence of t joint stiffness in this section the four different cross sections i e cases a d are used to study the influence of t joint stiffness on the ultimate strength of sandwich plates the properties of the cross sections are given in table 4 the influence of weld rotation stiffness on the transverse shear stiffness of the plates is presented in fig 15 romanoff et al 2007 conducted an experimental study to measure the stiffness of laser welded t joints in web core sandwich plates and present the effect of weld thickness t weld and root gap h rg see fig 16 a he found that the joint stiffness was normally distributed with the average equal to k θ 107 kn m m and a standard deviation of 21 kn m m the joint stiffness decreased when the weld thickness decreased in order to study the influence of amplitude of joint stiffness the average plus or minus two standard deviations are considered i e 65 kn m m and 149 kn m m respectively as having been done by jelovica et al 2012 and jelovica et al 2016 in addition the infinite rotation stiffness i e the thickness of weld being equal to the thickness of web plate is also analyzed to provide a comparison basis for the cases with finite rotation stiffness fig 17 presents the normalized load end shortening curves for the simply supported sandwich plates with different rotation stiffness and table 5 summarizes the ultimate strength of simply supported sandwich plates with different rotation stiffness fig 18 shows the influence of the weld rotation stiffness on the normalized ultimate strength it can be seen from fig 17 and table 5 that the ultimate strength of the sandwich plates shows a reduction when the weld t joint rotation stiffness is accounted for and the smaller rotation stiffness yields the smaller ultimate strength of sandwich plates to be specific the reduction in the ultimate strength of sandwich plates is related to the transverse shear stiffness d qy see figs 15 and 18 for the sandwich plates with transverse shear stiffness d qy being not decreased markedly when the t joint rotation stiffness is accounted for such as case d there is almost no obvious decrease in the ultimate strength however for the sandwich plates with transverse shear stiffness d qy being decreased significantly when the t joint rotation stiffness is accounted for such as cases b and c the ultimate strength of the sandwich plates decreases to a larger extent the most severe reduction 10 was observed for case b when the rotation stiffness k θ 65 kn m m is taken into account in comparison to the infinite rotation stiffness furthermore the rotation stiffness increased when the contact between the corner of the web plates and face plates occurred see fig 16 b therefore the rotation stiffness presents nonlinear characteristics the root gap h rg between the plates is significant in determining when this contact occurs and two root gaps are considered in the present study 2 μm and 10 μm jelovica et al 2014 used fem simulations to obtain the nonlinear rotation stiffness of the t joint due to the contact between the web plates and the face plates the results are presented in fig 19 hence the force displacement relation is transferred to the moment angle relation and it is used to define the behavior of the connector element fig 20 presents the normalized load end shortening curves for the simply supported sandwich plates with different root gaps table 6 summarizes the ultimate strength of the simply supported sandwich plates with different root gaps it can be observed from fig 20 and table 6 that except case d the contact in the joint slightly increases the ultimate strength of the sandwich plates by comparing to that of the sandwich plate with rotation stiffness k θ 107 kn m m and the smaller root gap results in the higher ultimate strength however this effect is not significant in all these four cases which indicates that the influence of nonlinearity of rotation stiffness can be neglected in the ultimate strength analyses of the sandwich plates 3 4 numerical verification few experiments on the ultimate strength of laser welded web core sandwich plates subjected to the in plane compression have been reported in kozak s work kozak 2006 laboratory full scale test and numerical modeling results of sandwich panels under in plane load were presented for comparison it was assumed that the numerical modeling of sandwich structures should be done carefully to reflect their particular properties thus solid elements were used to model the sandwich plates furthermore the real width of the laser weld as well as the gap between the web plates and face plates was modeled as a result only 1 4 of the structure was modeled for computational efficiency in this section shell elements are used to model the whole sandwich plate and spring elements are used to model the t joint properties to perform numerical verification with kozak s work kozak 2006 the magnitude of local deflections of face plates a 0 is 0 05β 2 t f while the magnitude of global deflection of sandwich plate b 0 is 0 001a in kozak s work kozak 2006 s 80 mm and h 60 mm the thicknesses of the face plate and web plate are 3 mm and 4 mm the length and width of the sandwich plate are 3000 mm and 500 mm therefore a 0 0 122 mm and b 0 3 mm fig 21 shows the numerical verification with the results from kozak s work kozak 2006 average rotation stiffness 107 kn m m and 2 μm root gap between face plates and web plates are considered it can be seen from fig 21 that the numerical results in the present study are close to the result calculated with solid elements except that the curve in the post collapse regime is slightly different there is only 0 9 difference in the ultimate strength and 7 difference in the end shortening in the ultimate limit state besides the curves of numerical results with k θ 107 kn m m and 2 μm root gap are almost overlapping which indicates that with or without considering the root gap between the face plates and web plates has little difference in this case fig 22 presents the comparison of stress distribution and deformed shape between kozak s work kozak 2006 and the present study with k θ 107 kn m m it can be seen from fig 22 that the stress distribution and deformed shape are very similar as a whole however compared to the modeling technique with solid elements modeling with shell elements and spring elements has the advantage of improving computing efficiency therefore it is reasonable and effective to model the laser welded web core sandwich plates with combined shell elements and spring elements in this paper 4 conclusions the main objective of this paper is to numerically study the ultimate strength characteristics of laser welded web core sandwich plates under in plane compression for this purpose four different cross sections are chosen in the present study and the thickness of the web plate is 4 mm for all sandwich plates after a series of nonlinear finite element analyses are performed with both geometric nonlinearity and material nonlinearity being taken into account the influence of initial deflections boundary conditions and the laser weld rotation stiffness on the ultimate strength behavior of laser welded web core sandwich plates have been investigated based on the results obtained from the present investigation the following conclusions can be drawn 1 when the local deflections of the face plates of case a sandwich plate are not considered in the ultimate strength analyses the sandwich plate collapses as a global buckling mode and local buckling has little effect on the ultimate strength of the sandwich plate in this case however when the local deflections of the face plates of case a sandwich plate are introduced in the ultimate strength analyses local buckling first occurring near the unloading edges on the concave side then the middle part on the concave side and at last on the convex side of the unloaded edges affects the ultimate strength of the sandwich plate and the collapse mode of the sandwich plate is a global mode with local buckling decreasing its ultimate capacity therefore it is necessary to introduce the local deflections of the face plates as well as the global deflections of the whole sandwich plates in the study of the ultimate strength especially when the influence of local buckling on the ultimate strength is needed to be considered 2 the stiffness of the pre collapse regime is decreased as the magnitudes of local deflections of the face plates increase larger local deflections of the face plates will affect the normalized load end shortening curves earlier local buckling occurs earlier and reduces the ultimate strength of the sandwich plate with greater magnitudes of local deflections of the face plates for the sandwich plates with the same magnitudes of the local deflections of the face plates the ultimate strength of the sandwich plate is decreased with the increase of the amplitude of the global deflection of the sandwich plate in the post collapse range the unloading curves almost overlap which shows that the global deformation of sandwich plates with different amplitudes of global deflection tends to be the same after the ultimate strength is reached 3 comparing to the curve with ss ss boundary condition it is evident that the sandwich plate with cc cc boundary condition has higher ultimate strength and the stiffness in the pre collapse regime is also higher than that with ss ss boundary condition however the boundary condition at the unloaded edges i e the simply supported or clamped boundary conditions has little effect on the ultimate strength of the sandwich plate 4 the ultimate strength of the sandwich plates shows a reduction when the weld t joint rotation stiffness is considered and the smaller rotation stiffness yields the smaller ultimate strength of sandwich plates the contact in the joint increases the ultimate strength of the sandwich plates and the smaller root gap results in the higher ultimate strength however this effect is not significant in all these four cases which indicates that the influence of nonlinearity of rotation stiffness can be neglected in the ultimate strength analyses of the sandwich plates credit authorship contribution statement qiang zhong methodology validation formal analysis data curation writing review editing deyu wang software supervision conceptualization resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this paper is co funded by nsfc no 51979163 no 51809167 and no 51809168 and the chinese government key research project kship ii project 201335 
20202,this paper numerically investigates the ultimate strength behavior of the laser welded web core sandwich plates under in plane compression both geometric nonlinearity and material nonlinearity are taken into consideration besides the global deflection of the sandwich plate the local deflections of the face plates are also introduced in the ultimate strength analyses to study the influence of the local buckling on the ultimate strength the influence of the magnitudes of the initial deflections on the ultimate strength of the web core sandwich plates is studied four boundary conditions are considered and the result shows that the boundary conditions on the unloaded edges i e the simply supported or clamped boundary conditions have little effect on the ultimate strength of the sandwich plate the ultimate strength of the sandwich plates shows a reduction when the laser weld rotation stiffness is accounted for and transverse shear stiffness has a large effect on the ultimate strength the contact between the web plates and face plates in the joints increases the ultimate strength of the sandwich plates and the smaller root gap results in the higher ultimate strength keywords web core sandwich plate ultimate strength global buckling local buckling rotation stiffness 1 introduction steel sandwich plates are orthotropic structures which consist of a series of cores and are enclosed by two face plates these plates are fabricated based on laser welding manufacturing technology which makes it possible to join metal sheets into structures with small welding deformation because of the low energy input during welding processes sandwich plates are characterized by light weight higher stiffness to weight and strength to weight ratios roland and metschkow 1997 and therefore have unique advantages in strength fatigue vibration and impact resistance marsico et al 1993 with the development of laser welding technology which enables the efficient production of these plates steel sandwich plates have been put into wide application in aerospace marine and road traffic engineering fields such applications make these plates subjected to the in plane compressive loads especially when used in a ship or a bridge deck therefore stability including buckling and even ultimate collapse becomes a design issue this study concentrates on the lase welded web core sandwich plates which have two face plates separated by the web plates as shown in fig 1 this configuration is the simplest but most widely used sandwich plates a few studies in the load carrying behavior of the web core sandwich plates have been reported before among which more investigations are inclined to the buckling without considering the material nonlinearity effects as for the studies of the buckling of the web core sandwich plates kolsters and zenkert 2006a b examined the elastic buckling parallel and normal to the webs and collapse of laser welded sandwich panels filled with the foam core and come to the conclusion that the buckling stress in compression parallel and normal to the webs typically reaches the proportional limit of the face plate and web material well before elastic buckling occurs jelovica and romanoff 2013 investigated the buckling and post buckling strength of the geometrically imperfect web core sandwich plates using two approaches i e the equivalent single layer theory approach and a three dimensional shell model of a sandwich plate the influence of imperfection magnitude stiffness coefficient local buckling and boundary conditions on the post buckling was studied however only the first eigenmode was used as the geometric imperfection and the material nonlinearity effect was not considered thus the ultimate limit state was not reached in the fe analyses jelovica et al 2012 studied the influence of weld rotation stiffness on the global bifurcation buckling strength of laser welded web core sandwich plates the results showed a maximum of 24 decrease in buckling strength and it was important to take the deforming weld into account in buckling analysis furthermore jelovica et al 2014 conducted a study to investigate the influence of general corrosion on buckling strength of laser welded web core sandwich plates and a rapid decrease in the buckling strength was found for corrosion affecting the outer sides of the sandwich plate however the relevant studies of the ultimate strength of the laser welded web core sandwich plates are rarely reported especially when comparing with that of stiffened panels on the contrary the studies of the ultimate strength of stiffened panels are more systematic and comprehensive in which some effective methods have been developed which can be roughly divided into the following categories caldwell method caldwell 1965 nonlinear finite element method fujikubo et al 2005a liu et al 2018 xu and soares 2012 2013a idealized structural unit method isum paik and pedersen 1996 paik and thayamballi 2003a smith method gordo and soares 1993 and model test method gordo and soares 2009 xu and soares 2013b c with regards to the studies of the ultimate strength of the laser welded sandwich plates kozak 2006 conducted a series of experiments and numerical modeling to investigate the ultimate strength of the laser welded steel sandwich beams and derived that the failure modes depended on the plates cross sections kolsters and zenkert 2010 extended the buckling model into the elasto plastic regime to determine the ultimate strength of the sandwich plates experiments were also conducted to verify the results jelovica et al 2013 carried out ultimate strength experiments in three point bending for beams with different corrosion exposure times and found that the experimental ultimate strength was in good agreement with finite element simulations it can be concluded that the studies of the ultimate strength of the sandwich plates under the in plane compression are limited especially for the sandwich plates between strong supporters i e transverse frames and longitudinal girders when applied in real hull structures additionally the appropriate initial deflections have not been specified in previous studies which is deemed to be significant for the ultimate strength analyses furthermore the actual laser weld rotation stiffness and its statistical variation must be considered in the ultimate strength analyses of the sandwich plates for some investigations have shown that the connection between the face and core plates has significant influence on the load carrying behavior of sandwich plates haj ali et al 2009 jelovica et al 2012 rahman and abubakr 2004 saffirna et al 2021 yan and jelovica 2021 to fill in this research gap and get a better understanding of the load bearing characteristics more effort should be put into the study of the ultimate strength of laser welded web core sandwich plates under in plane compression either theoretically numerically or experimentally the present study aims to numerically investigate the ultimate strength behavior of the laser welded web core sandwich plates under in plane compression plates are loaded in the direction parallel to the web plates a series of nonlinear finite element analyses are carried out with both geometric nonlinearity and material nonlinearity being taken into consideration except for the global deflection of the sandwich plate the local deflections of the face plates are introduced in the ultimate strength analyses to study the influence of the local buckling on the ultimate strength the influence of magnitudes of the initial deflections on the ultimate strength of the web core sandwich plates is investigated besides four boundary condition cases are compared to discuss the influence of boundary conditions on the ultimate strength of the laser welded web core sandwich plates furthermore the influence of laser weld including the magnitude of the rotation stiffness and the contact of the web plates and the face plates on the ultimate strength of the sandwich plates is investigated 2 finite element modeling 2 1 geometry and material as shown in fig 1 t t and t b are thicknesses of the top and bottom face plates in this study the thickness of the top face plate is equal to that of the bottom face plate thus the thickness of face plates is collectively referred as t f h c is the height of the sandwich plate core while s denotes the spacing of the web plates the notation used to identify the plates is the following t f h c s t w is the thickness of the web plate in this paper four different cross sections are considered and the thickness of the web plates is 4 mm for all plates case a 2 5 40 120 is the standard sandwich configuration in engineering applications case b 4 40 120 is the sandwich plate with thick face plates case c 4 20 120 is the sandwich plate with thick face plates and small core height while case d 1 40 120 is the sandwich plate with thin face plates length a and width b of the sandwich plates are 2 76 m thus the aspect ratio a b is equal to unity laser weld rotation stiffness k θ is defined as the ratio between the moment at the weld and the rotation angle of the web and face plate see fig 1 given as 1 k θ m θ the shear stiffness in the transverse direction is directly affected by the laser weld rotation stiffness k θ and is given as romanoff et al 2007 2 d q y 12 d w s 2 k q d w d t 6 d s 12 d w k θ s 2 d s where the bending stiffness of the face and web plates is 3 d i e i t i 3 12 i t b w and k q is given as 4 k q 1 12 d t s 1 k θ t 1 k θ b 6 d t d w d s 1 12 d t d w d s d t d b the shear stiffness in the longitudinal direction is 5 d q x k 11 2 g t t t g b t b t w s g w h c where 6 k 11 1 a i τ i q q x s 2 t i d s i i t c b high tensile strength steel is used in this paper the strain hardening effect is not taken into account even though some researchers such as paik and thayamballi 2003b have pointed out that the strain hardening effect will make the ultimate strength of the stiffened plates larger than those without considering it however an elastic perfectly plastic steel material model is considered sufficient and adequate for pessimistic assessment in this regard the behavior of the material adopted in the present study is assumed to follow the elastic perfectly plastic manner without considering the strain hardening effect the schematic of the stress strain behavior is illustrated in fig 2 and the detailed material properties are listed in table 1 2 2 boundary and loading conditions in the studies of the buckling and the ultimate strength of the stiffened plates simplified boundary conditions such as the simply supported or clamped boundary conditions are adopted according to the most current practical design criteria from classification societies in general the stiffened plates are supported by strong supporters such as longitudinal girders and transverse frames along the edges which provides a finite amount of rotational restraint stiffness therefore the actual ultimate strength of the stiffened plates is between those under the simply supported boundary condition and the clamped boundary condition for simplicity in the present study the simply supported boundary condition and the clamped boundary condition are adopted while the symmetric boundary condition is not used for the reason it neglects the asymmetric factors due to the existence of the actual out of plane dimension a different approach is required to simply support or clamp the web core sandwich plates than that of the stiffened plates therefore the deflection restraint for the simply supported boundary condition is set only on the nodes at the geometrical mid plane this allows the rotation of the plate around the mid plane edge furthermore the vertical nodes along the edge are displaced equally in the edge direction to prevent the rotation of the in plane axis orthogonal to the edge for example all the nodes at a certain web plate have the same displacement in the y direction v see fig 3 a to clamp the sandwich plate edge vertical nodes at the edge have the same displacement both in the x and y direction u and v see fig 3 b in this study four types of boundary conditions are considered ss ss all edges simply supported cc cc all edges clamped ss cc the loaded edges simply supported and the unloaded edges clamped cc ss the loaded edges clamped and the unloaded edges simply supported see fig 3 thus four boundary condition cases are compared to investigate the influence of boundary conditions on the ultimate strength of laser welded web core sandwich plates the loading condition adopted in this paper is the in plane displacement load acted on the nodes at the geometrical mid plane of the loading edges by which end shortening can be measured directly the force load is obtained by summing up the reaction forces of nodes at the loading edges 2 3 initial imperfections compared to the traditional welding techniques such as flame cutting and fusion welding the energy density of laser welding is highly concentrated and the heat affected zone is relatively limited thus the imperfections including welding residual stress and deformation are relatively smaller than those of traditional welding nevertheless the imperfections can be still generated in plated structures during fabrication processes it is generally recognized that the initial imperfections tend to decrease the rigidity and ultimate strength of structures such as stiffened plates and should be accounted for in the ultimate strength assessment paik and seo 2009 the collapse behavior of plated structure subjected to compression depends on the shape of its initial deflection the influence of the initial imperfections on the ultimate strength behavior of welded steel plates has been studied by a lot of investigators such as yao et al 1998 and paik et al 2004 for simplicity and the reason of less importance compared to the welding deformation the welding induced residual stresses are not taken into account in the present study kozak 2006 precisely measured the initial deflections of each sandwich model prior to loading in his experimental study of sandwich plates under in plane load however the realistic measurement data of initial deflection is generally not available in the design or theoretical investigation and thus the initial deflections are considered as the superposition of the fourier components in the ultimate strength assessment of stiffened plates fujikubo et al 2005b xu et al 2017 jelovica and romanoff 2013 introduced the first eigenmode as the shape of the initial imperfection it is a global deflection with a single half wave in both longitudinal and transverse directions however the local deflections of the face plates are not considered which is not reasonable therefore in the present study two types of initial deflections including the local deflections of the face plates and the global deflection of the sandwich plate are considered see fig 4 the local deflections of the face plates include the symmetric local deflections and the asymmetric local deflections about the geometrical mid plane as shown in fig 5 it is commonly recognized that such regular initial deflections generally do not exist in realistic structures but are the idealization of initial deflections in the ultimate strength assessment as done in the fe analyses of the ultimate strength of the stiffened plates the initial deflections are given as follows 1 local deflections of the face plates symmetric local deflections of the face plates 7 w l o c s y m m e t r i c a 0 sin m π x a sin π y s for top face plate a 0 sin m π x a sin π y s for bottom face plate asymmetric local deflections of the face plates 8 w l o c a s y m m e t r i c a 0 sin m π x a sin π y s for top face plate a 0 sin m π x a sin π y s for bottom face plate 2 global deflection of the sandwich plate 9 w g l o b 0 sin m π x a sin π y b in this paper the amplitudes of the local deflections of the top and bottom face plates are assumed to be equal as a 0 while b 0 is the amplitude of the global deflection of the sandwich plate m is the buckling half wave number in the longitudinal direction of the local face plates and m is the buckling half wave number in the longitudinal direction of whole sandwich plates they are determined as the minimum integer that satisfies the following equations paik and thayamballi 2003b 10 a s m m 1 11 a b m m 1 in the ultimate strength analyses of stiffened plates with traditional welding procedure a 0 is categorized into three levels as follows smith et al 1988 12 a 0 0 025 β 2 t f slight degree 0 1 β 2 t f moderate degree 0 3 β 2 t f severe degree where a 0 is usually taken as the moderate degree i e a 0 0 1β 2 t f and b 0 0 0015a xu et al 2018 β is the slenderness ratio of the plate and defined by the following equation 13 β s t f σ y e considering that initial deflections of laser welding is smaller than that of conventional welding and recorded deformation amplitudes are not specified in literature in the present work various magnitudes of a 0 and b 0 are adopted to determine the effect of the amplitudes of initial deflections on the ultimate strength of sandwich plates see table 2 fig 6 shows the comparison of normalized load end shortening curves of case a sandwich plate with symmetric and antisymmetric local deflections of the face plates it can be observed that the two normalized load end shortening curves of case a sandwich plate with symmetric and antisymmetric local deflections of the face plates are very close and there is little difference in ultimate strength therefore it can be considered that the symmetry or antisymmetry of the local deflections of the face plates have little effect on the ultimate strength of the sandwich plates thus in the present study only the symmetric local deflections of the face plates are taken into account in the ultimate strength analyses of laser welded web core sandwich plates 2 4 adopted elements and convergence study in the present study the collapse behavior and ultimate strength of sandwich plates are assessed using the finite element code abaqus in which both geometric and material nonlinearities are taken into account s4r shell elements are used to model the face plates and web plates of the sandwich plate the s4r element type is a four node doubly curved general purpose shell that offers reduced integration to control hourglass instability per element node has six degrees of freedom the welds are modeled with spring elements connector elements conn3d2 which connect the face and web plates at their apparent intersection the element allows an explicit definition of the rotation stiffness i e moment angle relationship it is required that the mesh size of the fe model should be fine enough to accurately simulate the collapse behavior of the sandwich plates on the other hand finer mesh causes more computational efforts in this regard a balance between accuracy and computational time must be made in this paper the sizes of elements for the face plates and web plates are varied for convergence study three types of mesh configurations have been considered table 3 shows these three types of mesh sizes for the case of the simply supported case a sandwich plate with a 0 0 025β 2 t f and b 0 0 001a nonlinear fe analyses were carried out on a computer with an intel r xeon r gold 6139m cpu with 2 3 ghz and 128 gb ram in this section the weld is not considered which indicates that the rotation stiffness of the weld is infinite in the fe calculations fig 7 gives the normalized load end shortening curves for the convergence study it can be seen from table 3 and fig 7 that finer mesh leads to smaller ultimate strength but the difference is relatively small accordingly the middle mesh case has been selected for the meshing standards of the fe models in this paper 3 results and discussions 3 1 influence of magnitudes of initial deflections in this section case a 2 5 40 120 is used to study the influence of magnitudes of initial deflections on the ultimate strength of sandwich plates fig 8 a shows the difference between normalized load end shortening curves of the simply supported sandwich plate with and without considering material nonlinearity the magnitude of global deflection of the sandwich plate b 0 is 0 001a i e 2 8 mm while the local deflections of the face plates are not considered in this work the buckling strength is determined through linear buckling analysis in the commercial fe software abaqus in fig 8 a the two curves almost overlap before the buckling strength is reached indicating that the material nonlinearity has not taken effect during this period as reported by jelovica and romanoff 2013 when material nonlinearity is not taken into account the curve keeps rising with a slope smaller than that in the buckling regime local buckling leads to an additional reduction of sandwich plate stiffness in the post buckling range which is not significant in this case when local buckling occurs at point 1 in the post buckling regime see fig 8 b however when material nonlinearity is accounted for the curve rises to a maximum value i e the ultimate strength of the sandwich plate after which it begins to fall it suggests that the sandwich plate still has a certain load bearing margin after reaching the buckling strength local buckling does not occur until point 2 in the post collapse regime see fig 8 c therefore the sandwich plate collapses as a global buckling mode while local buckling has little effect on the ultimate strength of the sandwich plate in this case fig 9 a presents the normalized load end shortening curve of the simply supported case a sandwich plate by introducing local deflections of the face plates with a 0 0 27 mm and b 0 2 8 mm and fig 9 b g plot its stress distributions and deformations during the loading process it can be seen that before point 2 such as point 1 the sandwich plate deforms as the global deflection of the sandwich plate as fig 9 b while local buckling is not observed on the face plates at point 2 local buckling occurs near the unloading edges on the concave side see fig 9 c after that at point 3 the middle part on the concave side of the sandwich plate also buckles locally see fig 9 d further loading makes the compressive stress increases and the face plates buckle on the convex side of the unloaded edges at point 4 see fig 9 e the ultimate strength of the sandwich plate is reached at point 5 where the magnitude of local buckles grows see fig 9 f g in this case local buckling affects the ultimate strength of the sandwich plate and the collapse mode of the sandwich plate is a global mode with local buckling decreasing its ultimate capacity fig 10 presents normalized load end shortening curves with varying the magnitudes of local deflections of the face plates for the simply supported case a sandwich plate it is observed from fig 10 that the stiffness of the pre collapse regime is decreased as the magnitudes of local deflections of the face plates increase larger local deflections of the face plates will affect the normalized load end shortening curves earlier which indicates that local buckling occurs earlier and affects the ultimate strength of the sandwich plate with greater magnitudes of local deflections of the face plates therefore the ultimate strength of the sandwich plate is decreased as the local buckling reduces the stiffness of the sandwich plate to be specific the reductions are around 2 between a 0 0 and a 0 0 27 mm 4 between a 0 0 and a 0 0 54 mm and 10 between a 0 0 and a 0 1 1 mm in the post collapse range due to the local buckling the curve with larger magnitudes of local deflections of the face plates drops more gently than that with a smaller amplitude of local deflections it is worth noting that b 0 is from 0 0005a to 0 002a in fig 10 a d respectively which ranges from the small magnitude value to the large magnitude value of global imperfection for laser welding therefore the observations above are valid for all of the global imperfection magnitude values fig 11 shows the normalized load end shortening curves with varying the amplitude of global deflection of the simply supported case a sandwich plate it can be seen from fig 11 that for the sandwich plates with the same magnitudes of local deflections of the face plates the ultimate strength of the sandwich plate is decreased with the increase of the amplitude of global deflection of the sandwich plate the reductions being around 1 5 between b 0 1 4 mm and b 0 2 8 mm 3 between b 0 1 4 mm and b 0 4 2 mm and 4 5 between b 0 1 4 mm and b 0 5 6 mm however in the post collapse range the unloading curves almost overlap to explain it the deformation configuration of the sandwich plate is divided into two parts the deformations caused by the global buckling and the local buckling in the present study the case a sandwich plate first buckles globally and then buckles locally in this sense the case a sandwich plates with the same local imperfections and different global imperfections first buckle globally to the same degree of global deformation before local buckling occurs afterwards in the post collapse regime the case a sandwich plates tend to have the same deformation configurations and as a result have the same load carrying characteristics reciprocally a 0 is from 0 to 0 1β 2 t f in fig 11 a d respectively which ranges from the small magnitude value to the large magnitude value of local imperfection for laser welding therefore the observations above are valid for all of the local imperfection magnitude values through the above analyses the ultimate strength decreases by about 7 5 for each 1 mm increase of the magnitude of local deflections of the face plates while the ultimate strength is reduced by around 1 for each 1 mm increase of the magnitude of global deflection of the sandwich plate thus it can be concluded that the local imperfections have a larger influence than the global imperfection on the ultimate strength of the web core sandwich plates in engineering applications it will be a more effective way to increase the ultimate strength of the web core sandwich plates by reducing the magnitude of local imperfections 3 2 influence of boundary conditions fig 12 plots the normalized load end shortening curve of the clamped case a sandwich plate by introducing local deflections of the face plates with a 0 0 27 mm and b 0 2 8 mm and stress distributions and deformation in the loading process it can be seen from fig 12 that the sandwich plate deforms as the global buckling shape in the initial loading phase but the deformation is relatively restricted by the clamped boundary condition in contrast to fig 9 at point 1 local buckling occurs at the loaded edges on the convex side and central part on the concave side of the sandwich plate see fig 12 b c then the unloaded edges on both sides of the sandwich plate also buckle locally at point 2 the sandwich plate reaches the ultimate state where the structure fails rapidly and loses its load carrying capacity see fig 12 d e fig 13 shows the normalized load end shortening curves for the case a sandwich plate with different boundary conditions comparing to the curve with ss ss boundary condition it is evident that the sandwich plate with cc cc boundary condition has higher ultimate strength and the stiffness in the pre collapse regime is also higher than that with ss ss boundary condition however the boundary condition at the unloaded edges has little effect on the ultimate strength of the sandwich plate it can be seen from fig 13 that the difference between normalized load end shortening curves of ss ss and ss cc boundary conditions is negligible and the same is true for cc cc and cc ss boundary conditions it indicates that more rigorous boundary conditions on the loaded edges can significantly improve the ultimate capacity of the sandwich plate while the boundary conditions on the unloaded edges whether simply supported or clamped boundary conditions have little effect on the ultimate strength of the sandwich plate to explain this phenomenon the loading condition that the sandwich plates are compressed in the direction perpendicular to the web plates is considered for comparison in this section fig 14 gives normalized load end shortening curves for the case a sandwich plate with a 0 0 025β 2 t f and b 0 0 001a in different loading directions it can be seen from fig 14 a that the ultimate strength of the sandwich plates loaded in the direction parallel to the web plates is much higher than that of the sandwich plates loaded in the direction perpendicular to the web plates it is due to the orthotropic nature of the sandwich plates in addition the difference between the boundary conditions ss ss and cc cc is about 7 when the sandwich plates are loaded in the direction perpendicular to the web plates much lower than 40 when the sandwich plates are loaded in the direction parallel to the web plates which suggests that the ultimate strength of sandwich plates is not sensitive to the boundary conditions on the edges parallel to the web plates due to the orthotropy of the sandwich plates this is further confirmed by comparing ss ss to ss cc and cc ss to cc cc in fig 14 b which shows that there is no significant difference in the ultimate strength of the sandwich plates between the simply supported and clamped boundary conditions on the edges parallel to the web plates besides when comparing ss ss to cc ss and ss cc to cc cc in fig 14 b it can be observed that the sandwich plates with clamped boundary condition on the edges perpendicular to the web plates have slightly higher ultimate strength than that with simply supported boundary condition but the difference is not very significant 3 3 influence of t joint stiffness in this section the four different cross sections i e cases a d are used to study the influence of t joint stiffness on the ultimate strength of sandwich plates the properties of the cross sections are given in table 4 the influence of weld rotation stiffness on the transverse shear stiffness of the plates is presented in fig 15 romanoff et al 2007 conducted an experimental study to measure the stiffness of laser welded t joints in web core sandwich plates and present the effect of weld thickness t weld and root gap h rg see fig 16 a he found that the joint stiffness was normally distributed with the average equal to k θ 107 kn m m and a standard deviation of 21 kn m m the joint stiffness decreased when the weld thickness decreased in order to study the influence of amplitude of joint stiffness the average plus or minus two standard deviations are considered i e 65 kn m m and 149 kn m m respectively as having been done by jelovica et al 2012 and jelovica et al 2016 in addition the infinite rotation stiffness i e the thickness of weld being equal to the thickness of web plate is also analyzed to provide a comparison basis for the cases with finite rotation stiffness fig 17 presents the normalized load end shortening curves for the simply supported sandwich plates with different rotation stiffness and table 5 summarizes the ultimate strength of simply supported sandwich plates with different rotation stiffness fig 18 shows the influence of the weld rotation stiffness on the normalized ultimate strength it can be seen from fig 17 and table 5 that the ultimate strength of the sandwich plates shows a reduction when the weld t joint rotation stiffness is accounted for and the smaller rotation stiffness yields the smaller ultimate strength of sandwich plates to be specific the reduction in the ultimate strength of sandwich plates is related to the transverse shear stiffness d qy see figs 15 and 18 for the sandwich plates with transverse shear stiffness d qy being not decreased markedly when the t joint rotation stiffness is accounted for such as case d there is almost no obvious decrease in the ultimate strength however for the sandwich plates with transverse shear stiffness d qy being decreased significantly when the t joint rotation stiffness is accounted for such as cases b and c the ultimate strength of the sandwich plates decreases to a larger extent the most severe reduction 10 was observed for case b when the rotation stiffness k θ 65 kn m m is taken into account in comparison to the infinite rotation stiffness furthermore the rotation stiffness increased when the contact between the corner of the web plates and face plates occurred see fig 16 b therefore the rotation stiffness presents nonlinear characteristics the root gap h rg between the plates is significant in determining when this contact occurs and two root gaps are considered in the present study 2 μm and 10 μm jelovica et al 2014 used fem simulations to obtain the nonlinear rotation stiffness of the t joint due to the contact between the web plates and the face plates the results are presented in fig 19 hence the force displacement relation is transferred to the moment angle relation and it is used to define the behavior of the connector element fig 20 presents the normalized load end shortening curves for the simply supported sandwich plates with different root gaps table 6 summarizes the ultimate strength of the simply supported sandwich plates with different root gaps it can be observed from fig 20 and table 6 that except case d the contact in the joint slightly increases the ultimate strength of the sandwich plates by comparing to that of the sandwich plate with rotation stiffness k θ 107 kn m m and the smaller root gap results in the higher ultimate strength however this effect is not significant in all these four cases which indicates that the influence of nonlinearity of rotation stiffness can be neglected in the ultimate strength analyses of the sandwich plates 3 4 numerical verification few experiments on the ultimate strength of laser welded web core sandwich plates subjected to the in plane compression have been reported in kozak s work kozak 2006 laboratory full scale test and numerical modeling results of sandwich panels under in plane load were presented for comparison it was assumed that the numerical modeling of sandwich structures should be done carefully to reflect their particular properties thus solid elements were used to model the sandwich plates furthermore the real width of the laser weld as well as the gap between the web plates and face plates was modeled as a result only 1 4 of the structure was modeled for computational efficiency in this section shell elements are used to model the whole sandwich plate and spring elements are used to model the t joint properties to perform numerical verification with kozak s work kozak 2006 the magnitude of local deflections of face plates a 0 is 0 05β 2 t f while the magnitude of global deflection of sandwich plate b 0 is 0 001a in kozak s work kozak 2006 s 80 mm and h 60 mm the thicknesses of the face plate and web plate are 3 mm and 4 mm the length and width of the sandwich plate are 3000 mm and 500 mm therefore a 0 0 122 mm and b 0 3 mm fig 21 shows the numerical verification with the results from kozak s work kozak 2006 average rotation stiffness 107 kn m m and 2 μm root gap between face plates and web plates are considered it can be seen from fig 21 that the numerical results in the present study are close to the result calculated with solid elements except that the curve in the post collapse regime is slightly different there is only 0 9 difference in the ultimate strength and 7 difference in the end shortening in the ultimate limit state besides the curves of numerical results with k θ 107 kn m m and 2 μm root gap are almost overlapping which indicates that with or without considering the root gap between the face plates and web plates has little difference in this case fig 22 presents the comparison of stress distribution and deformed shape between kozak s work kozak 2006 and the present study with k θ 107 kn m m it can be seen from fig 22 that the stress distribution and deformed shape are very similar as a whole however compared to the modeling technique with solid elements modeling with shell elements and spring elements has the advantage of improving computing efficiency therefore it is reasonable and effective to model the laser welded web core sandwich plates with combined shell elements and spring elements in this paper 4 conclusions the main objective of this paper is to numerically study the ultimate strength characteristics of laser welded web core sandwich plates under in plane compression for this purpose four different cross sections are chosen in the present study and the thickness of the web plate is 4 mm for all sandwich plates after a series of nonlinear finite element analyses are performed with both geometric nonlinearity and material nonlinearity being taken into account the influence of initial deflections boundary conditions and the laser weld rotation stiffness on the ultimate strength behavior of laser welded web core sandwich plates have been investigated based on the results obtained from the present investigation the following conclusions can be drawn 1 when the local deflections of the face plates of case a sandwich plate are not considered in the ultimate strength analyses the sandwich plate collapses as a global buckling mode and local buckling has little effect on the ultimate strength of the sandwich plate in this case however when the local deflections of the face plates of case a sandwich plate are introduced in the ultimate strength analyses local buckling first occurring near the unloading edges on the concave side then the middle part on the concave side and at last on the convex side of the unloaded edges affects the ultimate strength of the sandwich plate and the collapse mode of the sandwich plate is a global mode with local buckling decreasing its ultimate capacity therefore it is necessary to introduce the local deflections of the face plates as well as the global deflections of the whole sandwich plates in the study of the ultimate strength especially when the influence of local buckling on the ultimate strength is needed to be considered 2 the stiffness of the pre collapse regime is decreased as the magnitudes of local deflections of the face plates increase larger local deflections of the face plates will affect the normalized load end shortening curves earlier local buckling occurs earlier and reduces the ultimate strength of the sandwich plate with greater magnitudes of local deflections of the face plates for the sandwich plates with the same magnitudes of the local deflections of the face plates the ultimate strength of the sandwich plate is decreased with the increase of the amplitude of the global deflection of the sandwich plate in the post collapse range the unloading curves almost overlap which shows that the global deformation of sandwich plates with different amplitudes of global deflection tends to be the same after the ultimate strength is reached 3 comparing to the curve with ss ss boundary condition it is evident that the sandwich plate with cc cc boundary condition has higher ultimate strength and the stiffness in the pre collapse regime is also higher than that with ss ss boundary condition however the boundary condition at the unloaded edges i e the simply supported or clamped boundary conditions has little effect on the ultimate strength of the sandwich plate 4 the ultimate strength of the sandwich plates shows a reduction when the weld t joint rotation stiffness is considered and the smaller rotation stiffness yields the smaller ultimate strength of sandwich plates the contact in the joint increases the ultimate strength of the sandwich plates and the smaller root gap results in the higher ultimate strength however this effect is not significant in all these four cases which indicates that the influence of nonlinearity of rotation stiffness can be neglected in the ultimate strength analyses of the sandwich plates credit authorship contribution statement qiang zhong methodology validation formal analysis data curation writing review editing deyu wang software supervision conceptualization resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this paper is co funded by nsfc no 51979163 no 51809167 and no 51809168 and the chinese government key research project kship ii project 201335 
20203,the present experiments are designed to investigate how an attack angle 0 6 influences the vortex induced vibration and the corresponding hydrodynamic damping of a hydrofoil for three main modes with a velocity ranging from 0 to 7 53 m s the feasibility of the experimental equipment and methods were verified the results show that the lock in region is wider for a larger attack angle while no obvious change is found in the vortex shedding frequency in the lock off region the natural frequencies are barely affected by the flow velocity and attack angle in the lock off region while they increase slightly with increasing velocity in the lock in region the hydrodynamic damping ratio remains almost constant at different attack angles when the velocity is below the resonance velocity when the velocity is above the resonance velocity the trend of the hydrodynamic damping ratio increasing linearly with increasing velocity is independent of the attack angle while the hydrodynamic damping ratio tends to decrease as the attack angle increases the hydrodynamic damping ratio in the lock in region is found to be negative and the range of negative hydrodynamic damping increases as the attack angle increases keywords experiment hydrofoil attack angle lock in hydrodynamic damping 1 introduction hydraulic machinery is the key equipment in water transportation and power production systems and its operation stability has received extensive attention in recent years trivedi 2017 soltani dehkharqani et al 2018 hydraulic machinery especially the pump turbine needs to operate under different flow rates and this inevitably leads to a frequent conversion of different attack angles at a considerable attack angle the secondary vortex starts at the leading edge of the blades dörfler et al 2013 which can even cause rotating stall and blocking the flow channel of the impeller zhao et al 2018 in order to accurately evaluate the vibration of hydraulic machinery at different attack angles it is necessary to clarify the influence of the attack angle on the fluid added modal parameters of the blade like structures factors affecting the vibration level of immersed structures include added stiffness added mass and the hydrodynamic damping ratio soltani dehkharqani et al 2018 according to previous investigations the added mass and hydrodynamic damping ratio have a significant influence on the vibration characteristic of hydraulic turbines whereas the added stiffness can be ignored soltanidehkharqani et al 2017 in particular in the case of a propeller runner the fluid added stiffness was less than 2 of the structural stiffness whereas the fluid added mass was around 3 59 times the structural mass gauthier et al 2017 the fluid added mass directly caused the reduction of natural frequency in water therefore the added mass effect could be determined based on the natural frequencies in air and in water de la torre et al 2014 added mass was found to be independent of the flowing velocity and the attack angle bergan et al 2019 ducoin et al 2012 in particular the natural frequency variation of a hydrofoil was less than 3 bergan et al 2019 as the velocity increased from 0 to 28 m s the natural frequencies of a hydrofoil in flowing water exhibited almost no change when the attack angle varied from 2 to 8 ducoin et al 2012 however the velocity was significantly related to the hydrodynamic damping ratio bergan et al 2019 roth et al 2009 yao et al 2014 yao et al 2014 found that the hydrodynamic damping ratio remained constant below the resonance velocity while it increased linearly as the velocity increased above the resonance velocity this trend was also observed in the experimental work of bergan et al 2019 the attack angle may have an influence on the boundary layer and wake characteristics thus resulting in varying hydrodynamic characteristics of the structure however the influence of the attack on the hydrodynamic damping ratio is still unclear the measurement of the hydrodynamic damping ratio includes three key elements i e excitation structure response signal measurement and hydrodynamic damping ratio identification as for excitation roth et al 2009 created a fast growing and collapsing bubble which generated strong shock wave to supply a transient excitation on the hydrofoil by using the hammers the transient excitations were also supplied to the structures by xiu et al 2018 and presas et al 2017 to supply controllable excitations to the hydrofoils the macro fiber composites piezoelectric actuation bergan et al 2019 seeley et al 2012 and lead zirconate titanate piezoelectric patch pzt yao et al 2014 presas et al 2017 were widely used and they were usually mounted on the surface of the hydrofoils presas et al 2017 compared the vibration response of a disc with hammer excitation and pzt excitation the result indicated that the difference in natural frequency in these two situations was less than 1 as for the signal measurement the laser doppler vibrometer ldv was widely used to measure the hydrofoil vibration bergan et al 2019 roth et al 2009 seeley et al 2012 this has the advantage of conducting a non contact measurement of vibration but it is expensive and may not be applicable in non transparent environments such as cavitation or high sediment flow pzt was much lighter than the test structure presas et al 2017 and was also widely used in vibration response measurement yao et al 2014 de la torre et al 2013 in particular the vibration signals measured by pzt were verified by comparing them with those measured by an accelerometer de la torre et al 2013 as for the hydrodynamic damping ratio identification one method was to perform function fitting based on the amplitudes of the vibration responses near the resonance frequency yao et al 2014 seeley et al 2012 the other method was based on the logarithmic decay time evolution of the vibration response roth et al 2009 zeng et al 2019a in order to isolate the vibration signal with the natural frequency of a single mode the butterworth band pass filter was used by roth et al 2009 however the feasibility of the filter parameters for different vibration systems needs to be verified indeed the attack angle was associated with flow separation and boundary layer characteristics ducoin et al 2009 therefore it was also associated with the vibration characteristics of structures ducoin et al 2012 however the effect of the attack angle on the vortex induced vibration has not been fully understood and no experiments have been found to systematically measure the hydrodynamic damping characteristics at different attack angles in this investigation we designed experiments to investigate the influence of the attack angles on the vortex induced vibration and hydrodynamic damping ratio characteristics experimental set up and data processing methods are introduced in section 2 in detail the feasibility of the equipment and method is verified in section 3 and the vibration characteristics of a hydrofoil with different attack angles are quantitatively analyzed and discussed in section 4 2 experimental and numerical modal analysis methods 2 1 experimental set up 2 1 1 test hydrofoil the tested hydrofoil is a naca 0009 hydrofoil with a blunt trailing edge as shown in fig 1 a the span width of the hydrofoil is 67 mm the chord length is 70 mm and the trailing edge thickness is 2 25 mm it is made of aluminum with a young modulus of 69 gpa a density of 2700 kg m3 and poisson s ratio of 0 334 one end of the hydrofoil is fixed to the connecting rod and the other end is free in relation to the connecting rod one end is constrained by a packing seal and the other end is constrained by a threaded connection two p 878 a1 piezoelectric patches pzt1 and pzt2 are fitted to the leading and trailing edges of the hydrofoil surface respectively this is made of piezoelectric ceramic material with dimensions of 27 mm 9 4 mm 0 6 mm and an operating voltage range of 20 120 v the spanwise profile of the hydrofoil is shown in fig 1 b which is a reduced scale 0 7 times model of the hydrofoil tested in the swiss federal institute of technology in lausanne epfl roth et al 2009 ausoni 2009 2 1 2 test rig the test system is illustrated in fig 2 a which is a closed loop cavitation tunnel in the beijing institute of technology the flow is driven into the test section by an axial flow pump and the flow velocity is monitored by an electromagnetic flow meter uncertainty is within 0 5 the turbulence level of the flow in the test section is reduced by a straightening vane in particular the turbulence intensity at the inlet of the test section is within 1 with a velocity of less than 10 m s more detailed information of this closed loop cavitation tunnel is provided in detail in reference wu et al 2015 the rectangular test section is shown in fig 2 b with a length of 0 7 m a width of 0 07 m and a height of 0 19 m according to the previous reviews luo et al 2016 cheng et al 2021 in the cavitating flow around the hydrofoil the cavitation may introduce an additional hydrodynamic force on the hydrofoil and has an additional influence on the hydrodynamic damping characteristic in the present investigation in order to avoid the additional influence of cavitation on the vibration characteristics of a hydrofoil at different angles of attack all the experiments are carried out in a cavitation free condition 2 1 3 test processing in the present experiment the detailed excitation methods are as follows 1 to verify the feasibility of the hammer as an exciter the hydrofoil is also excited by the pzt1 in air and the signals obtained from the two excitation methods are compared 2 to measure the natural frequency and hydrodynamic damping ratio a hammer is used to excite the hydrofoil 3 the vortex shedding frequency and vortex induced vibration of the hydrofoil are measured without any extra excitations it needs to be explained that the pzt1 was chosen to excite the hydrofoil at the design stage of the present experiment because many previous experiments showed the feasibility of pzt to excite submerged hydrofoils de la torre et al 2013 2014 yao et al 2014 however due to the mechanical noise caused by the operation of the pump and high turbulence noise in flowing water the vibration signals of the hydrofoil in the real experiment excited by pzt1 are very noisy therefore for the measurements of the modal parameters natural frequency and hydrodynamic damping ratio a hammer is finally used to supply transient excitation to the hydrofoil in order to ensure that the deformation of the hydrofoil in flowing water is measurable the excitation position is on the threaded end of the connecting rod as shown in fig 1 a the vibration response of the hydrofoil is recorded by the pzt2 and a test is designed in air to verify the feasibility of pzt2 as a sensor firstly a controllable voltage signal is sent out by the signal generator the duration of the sweep is 100s and the linear frequency range is from 1 to 2000 hz secondly the signal is fed to pzt1 through a power amplifier 10 times to excite the hydrofoil the amplitude of the sweep is within the operating voltage range of the pzt 20 to 120 v and 10 rounds of excitations are performed thirdly the vibration signal of the hydrofoil is monitored using pzt2 and an accelerometer with a type of ac135 2c 010 m the accelerometer is glued on the hydrofoil the signals transmitted from pzt2 and the accelerometer are recorded using an ni pxi 4472 digitizer and an ni 9234 digitizer respectively both with a sampling frequency of 10 khz finally the modal recognition results of the two measurement methods will be quantitatively analyzed 2 1 4 test contents in this experiment the test velocity ranges from 0 to 7 53 m s with four attack angles α 0 2 4 and 6 the following will be tested vortex induced vibrations natural frequencies and hydrodynamic damping ratios for the three main modes 2 2 signal processing methods 2 2 1 frequency identification the frequency analysis of the vibration signals in this investigation are carried out in two ways one is fast fourier transform fft and its solution method is given in detail in reference deergha rao and swamy 2018 the other method is continuous wavelet transform cwt based on the morlet mother wavelet pavesi et al 2008 zeng et al 2019b 1 w s n k 0 n 1 x k 2 π s δ t ψ 0 s ω k e i ω k n δ t where s is the wavelet scale n and k are the time and frequency index respectively x k is the discrete fourier transform of the original vibration signal δ t is the sampling interval s ψ 0 is the complex conjugate of the translated and scaled mother wavelet and ω k is the angular frequency rad s 2 2 2 hydrodynamic damping ratio identification the identification of the hydrodynamic damping ratio comprises three steps step 1 the vibration signal of the tested mode is isolated using the butterworth band pass filter method step 2 the filtered vibration signal can be treated as free vibration and the total damping ratio can be identified based on the logarithmic decay equation step 3 the hydrodynamic damping ratio is determined using the total damping ratio minus the damping ratio in air the equation of free vibration can be expressed as zeng et al 2019a 2 u t a e ζ t ω n t sin ω d t φ where a is the normalized amplitude ζ t is the total damping ratio ω n 2 π f n is the angular natural frequency rad s f n is the natural frequency hz ω d ω n 1 ζ t 2 is the damped angular natural frequency rad s and φ is the initial phase rad in the present investigation the total damping ratio is less than 0 1 and the relative difference between natural frequency and damped natural frequency is less than 0 5 the hydrodynamic damping ratio can be calculated as follows 3 ζ ζ t ζ a where ζ a is the damping ratio in air as for step 1 the cut off frequency and filter order are the main parameters for the butterworth band pass filter roth et al 2009 a numerical analysis is performed to validate the parameters of the butterworth filter based on the matlab code the time signal in fig 3 a is a synthetic signal generated by the matlab code based on the superposition of different modes in the case of a single mode the signal is the combination of natural frequency amplitude and damping ratio firstly the natural frequencies and corresponding amplitudes of different modes can be determined according to the frequency domain of a real experimental result secondly the damping ratios for different modes are designed by the matlab code the damping ratios in particular for the three main modes f n1 f n2 and f n3 are 0 03 0 02 and 0 01 respectively for the other modes the damping ratios are set at 0 01 thirdly the filter parameters of different modes are quantitatively adjusted in particular the cut off frequencies and filter orders for the three main modes in this case are shown in table 1 and the frequency response characteristics of the filters are shown in fig 3 b fourthly the vibration signal of a single mode is isolated as shown in fig 3 c finally as shown in fig 3 d two damping ratios can be obtained by fitting the upper and lower peak points according to equation 2 and the final damping ratio is their arithmetic average by using the properties of the butterworth band pass filter in table 1 the relative deviation between the designed and the identified damping ratios for the three main modes are only 2 3 and 1 respectively 2 2 3 definition of other parameters the flow velocity is calculated based on the volumetric flow rate and cross sectional area of the test section as follows 4 v q s where q is the volumetric flow rate m3 s and s is the cross sectional area m2 the strouhal number is calculated as follows ausoni 2009 5 s t h f h v where f is the vortex shedding frequency hz h is the trailing edge thickness m based on the flow velocity the natural frequency of the ith mode of the hydrofoil and the geometric dimensions of the hydrofoil the reduced velocity of the ith mode is defined as follows ausoni 2009 6 v v f n i l where f n i is the natural frequency of the ith mode hz and l is the chord length of the hydrofoil m 2 3 numerical modal analysis method the mode shape and corresponding natural frequency of the structure can be numerically simulated using the modal analysis approach with the finite element method fem de la torre et al 2014 the simulation results obtained by this approach were in good agreement with the experimental results liang et al 2007 moreover although the natural frequency of the structure in water was reduced due to the added mass effect the mode shape in water was almost the same as the mode shape in air zeng et al 2019a liang et al 2007 the structural dynamics equation can be expressed as liang et al 2007 7 m u c u k u f where m c and k are the mass damping and stiffness matrix of the hydrofoil respectively u is the modal displacement vector the overdot is the time differentiation and f is the load vector the detailed introduction of the modal analysis approach is given in reference liang et al 2007 modal analysis is carried out using the ansys code the material and constraints are the same as the experimental set up the nodes number is determined based on the grid convergence index gci method celik et al 2008 in particular the nodes number of the hydrofoil is around 70 thousand according to the previous modal analysis of a similar hydrofoil de la torre et al 2014 zeng et al 2019a the selected element type is a three dimensional eight nodes solid solid 185 3 feasibility analysis 3 1 comparison of results between pzt and accelerometer the feasibility of the pzt2 as a sensor is verified by comparing its signals with those obtained from an accelerometer in air the hydrofoil is excited by pzt1 using the sweep frequency excitation method the vibration responses are collected by an accelerometer and the pzt2 and the corresponding frequency domains are obtained by fft for the three main modes the relative differences of natural frequency obtained by the accelerometer and the pzt2 are only 1 69 1 44 and 1 75 respectively the feasibility of the pzt2 used for damping ratio measurement is also analyzed the filtered free vibrations of the third mode measured by the accelerometer and pzt2 are shown in fig 4 the phase angle of the vibration signal measured by pzt2 is shifted by 120 for display purposes the results show that their amplitude decay trends are in good agreement the damping ratio measured by the accelerometer and the pzt2 are 0 0067 and 0 0065 respectively and the relative deviation is only 3 in the work of de la torre et al de la torre et al 2013 the use of pzt as a sensor was also verified by comparing its signals with those from the accelerometers in addition the feasibility of the hammer as an exciter is verified by comparing the signals excited by the hammer and the pzt1 in particular with different excitation methods in still water the relative deviations of the natural frequencies for the three main modes are within 4 18 3 2 comparison of results with the previous works in epfl 3 2 1 strouhal number without extra excitation and with a 0 attack angle the frequency spectrums of vortex induced vibration at different velocities are shown in fig 5 a resonance occurs when the vortex shedding frequency is close to the natural frequencies f n1 and f n2 of the hydrofoil the vortex shedding frequency is identified based on the signal length of 10s the vortex shedding frequency and corresponding amplitude of vortex induced vibration are extracted as shown in fig 5 b the results show that there is a lock in phenomenon for the second mode while this phenomenon is not observed for the first mode this experimental result is the same as the conclusion drawn by ausoni et al ausoni 2009 outside the lock in region the vortex shedding frequency increases linearly as the velocity increases within the lock in region the vortex shedding frequency also increases slightly with increasing velocity while the relative variation is only within 7 the strouhal numbers at different reduced velocities are shown in fig 6 the reduced velocities are calculated based on the natural frequency of the second mode of the hydrofoil according to the experimental results of ausoni 2009 the strouhal number for the trip transition ranges from 0 158 to 0 193 in this test the strouhal number ranges from 0 162 to 0 177 and this is in good agreement with the result of ausoni 2009 3 2 2 hydrodynamic damping ratio the hydrodynamic damping ratios for the first mode are verified at different reduced velocities as shown in fig 7 the region a and b refers to the flow region where the velocity is below and above the resonance velocity respectively in region a the hydrodynamic damping ratio remains almost constant in region b the hydrodynamic damping ratio increases linearly with increasing velocity these trends are consistent with the experimental results obtained by roth et al 2009 4 results and discussions 4 1 vortex induced vibration the vortex shedding frequencies with different attack angles at different velocities are shown in fig 8 a when the velocity is below the lock in region the vortex shedding frequencies with different attack angles increase linearly with increasing velocity when α increases from 0 to 6 the attack angle only has a minor effect on the vortex shedding frequency and the relative deviation is within 4 9 at different attack angles significant differences in frequencies are observed when the velocities are close to the edges of the lock in region this can be explained as the high amplitude resonance forces the vortex shedding frequency to be consistent with the natural frequency of the structure in the lock in region the vortex shedding frequency tends to increase slightly with increasing velocity the width of the lock in region tends to increase as the attack angle increases in particular with 0 2 4 and 6 attack angles the lock in widths are around 1 11 m s 1 11 m s 1 33 m s and 1 55 m s respectively the corresponding amplitudes of the vortex shedding frequencies with different attack angles at different velocities are shown in fig 8 b when the vortex shedding frequency is close to the natural frequencies of the first and second modes resonance occurs and the corresponding amplitude is significantly amplified in particular with α 0 2 4 and 6 the amplitudes at lock off velocity 7 53 m s are only around 1 04 3 04 of those at resonance velocity 6 42 m s the resonance amplitude for the first mode is significantly smaller than that of the second mode in particular with different attack angles the amplitudes of the former are only 2 07 8 62 of the latter this may serve as an explanation for the phenomenon that the lock in is not observed for the first mode as for the different attack angle the resonance vibration level increases as the attack angle increases in particular the amplitude with α 0 is only 42 5 of that with α 6 at a velocity of 6 42 m s 4 2 mode shape the time evolution of the vibrating hydrofoil in still water after supplying transient excitation is shown in fig 9 a the vibration amplitude gradually decays due to damping the time frequency domain of the damped vibration is shown in fig 9 b there are three obvious natural frequency components named the first mode fn1 second mode fn2 and third mode fn3 respectively the mode shapes of the three main modes of the hydrofoil are simulated using the ansys code in air and in water as shown in fig 10 the types of mode shapes in water are the same as that in air in the case of the first and third modes the node lines are parallel to the chord as shown in fig 10 a and c as regards the second mode the node line is approximately perpendicular to the chord as shown in fig 10 b these mode shapes are similar to the results obtained by de la torre et al de la torre et al 2014 and yao et al 2014 as shown in table 2 the simulated natural frequencies in air and in water are in good agreement with those obtained by the experiment with relative deviations within 7 12 4 3 natural frequency the natural frequencies at different attack angles at different velocities for the first second and third modes are shown in fig 11 a b and c respectively the natural frequency is identified based on the signal length of 0 3s because the vibration response caused by the hammer excitation is decayed and hard to be identified after around 0 3s the uncertainty bar represents the 95 confidence interval of 10 replications there are two obvious phenomena one is the attack angle and velocity which have almost no effect on the natural frequency in the lock off region in particular the relative natural frequency variations for the first second and third modes are 9 61 4 42 and 3 68 respectively the other is that the natural frequency slightly increases with increasing velocity in the lock in region this may serve as an explanation for the phenomenon that the vortex shedding frequency increases slightly with increasing velocity in the lock in region in fact many previous investigations hoskoti et al 2018 mittal and navrose 2016 jiao and wu 2018 have shown that the natural frequency may increase with increasing velocity in the lock in region according to the work of jiao et al jiao and wu 2018 the large deformation in the lock in region may result in an increase in stiffness and therefore may also result in an increase in the natural frequency however it is not clear whether the large deformation in the lock in region has an influence on the added mass we intend to address the flow mechanism behind this in future research 4 4 hydrodynamic damping the hydrodynamic damping ratios with different attack angles at different velocities for the first second and third modes are shown in fig 12 a b and c respectively the uncertainty bar represents the 95 confidence interval of 10 replications the hydrodynamic damping ratio is obtained by subtracting the damping ratio in the air from the total damping ratio in particular the damping ratio in air for the first second and third modes are 0 022 0 018 and 0 007 respectively as shown in fig 12 a for the first mode when the velocity is below the resonance velocity the hydrodynamic damping ratios remain almost constant for different attack angles when the velocity is above the resonance velocity the hydrodynamic damping ratio increases with increasing velocity this is the same for different attack angles however the hydrodynamic damping ratio tends to decrease as the attack angle increases in particular at a velocity of around 7 1 m s the hydrodynamic damping ratios with 2 4 and 6 attack angles are around 78 33 87 39 89 85 of those with a 0 attack angle respectively as shown in fig 12 b for the second mode when the velocity is below the lock in region the hydrodynamic damping ratios remain the same for different attack angles in the lock in region the hydrodynamic damping ratio drops significantly more attention should be paid to two phenomena one is the hydrodynamic damping ratios which are almost all less than 0 in the lock in region this may result in high amplitude vortex induced vibration therefore forcing the vortex shedding frequency to be consistent with the natural frequency of the hydrofoil the reduced velocity range where the hydrodynamic damping ratio is less than 0 is defined as the negative hydrodynamic damping width the other phenomenon is that the negative hydrodynamic damping width with a larger attack angle is wider than that with a smaller attack angle this trend is similar to the lock in width changes with different attack angles at the reduced velocity of around 0 19 lock in region the hydrodynamic damping ratio decreases as the attack angle increases this may cause the vibration level of resonance to increase as the attack angle increases as shown in fig 12 c for the third mode all the test velocities are less than the resonance velocity and the hydrodynamic damping ratios are constant at different attack angles 5 conclusions the experiments on the naca 0009 hydrofoil have been carried out to investigate the influence of the attack angle 0 6 on the vortex induced vibration and hydrodynamic damping ratio characteristics ranging from 0 to 7 53 m s the feasibility of the experimental equipment and processing method has been verified and the main conclusions are summarized as follows 1 the vortex shedding frequencies and corresponding vibration amplitudes with different attack angles are compared when the velocity is below the lock in region the attack angle has almost no influence on the vortex shedding frequency with relative variation within 4 9 in the lock in region the vortex shedding frequencies with different attack angles increase slightly with increasing velocity however the lock in width with a larger attack angle is greater than that with a smaller attack angle the resonance amplitude increases as the attack angle increases for the second mode in particular resonance amplitude at a 0 attack angle is only around 42 5 of that with a 6 attack angle 2 the natural frequencies with different attack angles for the three main modes are investigated in the lock off region both velocity and the attack angle have almost no effect on the natural frequency in particular under the coupling effect of velocity and the attack angle the relative variations of natural frequencies for the first second and third modes are within 9 61 4 42 and 3 68 respectively while in the lock in region the natural frequencies with different attack angles increase slightly with increasing velocity this result in the vortex shedding frequency increases with increasing velocity in the lock in region 3 the hydrodynamic ratios with different attack angles for the three main modes are quantitatively analyzed when the velocity is below the resonance velocity the hydrodynamic damping ratio remains constant as the velocity increases and the attack angle has also almost no influence on the hydrodynamic damping ratio when the velocity is above the resonance velocity the hydrodynamic damping ratios with different attack angles increase with increasing velocity while hydrodynamic damping ratio tends to decreases as the attack angle increases in particular when the velocity is around 7 1 m s the hydrodynamic damping ratios with an attack angle of 2 4 and 6 are approximately 78 33 87 39 and 89 85 of that with a 0 attack angle respectively in the lock in region the hydrodynamic damping ratio is found to be negative and the negative hydrodynamic damping width increases as the attack angle increases credit authorship contribution statement yongshun zeng experiment validation investigation writing original draft visualization mindi zhang resources experiment validation investigation yuxin du experiment investigation zhifeng yao methodology conceptualization supervision writing review editing qin wu methodology validation fujun wang methodology conceptualization supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the financial support given by the national natural science foundation of china nos 51836010 51879266 and 51839001 and the beijing municipal science and technology project no z181100005518013 
20203,the present experiments are designed to investigate how an attack angle 0 6 influences the vortex induced vibration and the corresponding hydrodynamic damping of a hydrofoil for three main modes with a velocity ranging from 0 to 7 53 m s the feasibility of the experimental equipment and methods were verified the results show that the lock in region is wider for a larger attack angle while no obvious change is found in the vortex shedding frequency in the lock off region the natural frequencies are barely affected by the flow velocity and attack angle in the lock off region while they increase slightly with increasing velocity in the lock in region the hydrodynamic damping ratio remains almost constant at different attack angles when the velocity is below the resonance velocity when the velocity is above the resonance velocity the trend of the hydrodynamic damping ratio increasing linearly with increasing velocity is independent of the attack angle while the hydrodynamic damping ratio tends to decrease as the attack angle increases the hydrodynamic damping ratio in the lock in region is found to be negative and the range of negative hydrodynamic damping increases as the attack angle increases keywords experiment hydrofoil attack angle lock in hydrodynamic damping 1 introduction hydraulic machinery is the key equipment in water transportation and power production systems and its operation stability has received extensive attention in recent years trivedi 2017 soltani dehkharqani et al 2018 hydraulic machinery especially the pump turbine needs to operate under different flow rates and this inevitably leads to a frequent conversion of different attack angles at a considerable attack angle the secondary vortex starts at the leading edge of the blades dörfler et al 2013 which can even cause rotating stall and blocking the flow channel of the impeller zhao et al 2018 in order to accurately evaluate the vibration of hydraulic machinery at different attack angles it is necessary to clarify the influence of the attack angle on the fluid added modal parameters of the blade like structures factors affecting the vibration level of immersed structures include added stiffness added mass and the hydrodynamic damping ratio soltani dehkharqani et al 2018 according to previous investigations the added mass and hydrodynamic damping ratio have a significant influence on the vibration characteristic of hydraulic turbines whereas the added stiffness can be ignored soltanidehkharqani et al 2017 in particular in the case of a propeller runner the fluid added stiffness was less than 2 of the structural stiffness whereas the fluid added mass was around 3 59 times the structural mass gauthier et al 2017 the fluid added mass directly caused the reduction of natural frequency in water therefore the added mass effect could be determined based on the natural frequencies in air and in water de la torre et al 2014 added mass was found to be independent of the flowing velocity and the attack angle bergan et al 2019 ducoin et al 2012 in particular the natural frequency variation of a hydrofoil was less than 3 bergan et al 2019 as the velocity increased from 0 to 28 m s the natural frequencies of a hydrofoil in flowing water exhibited almost no change when the attack angle varied from 2 to 8 ducoin et al 2012 however the velocity was significantly related to the hydrodynamic damping ratio bergan et al 2019 roth et al 2009 yao et al 2014 yao et al 2014 found that the hydrodynamic damping ratio remained constant below the resonance velocity while it increased linearly as the velocity increased above the resonance velocity this trend was also observed in the experimental work of bergan et al 2019 the attack angle may have an influence on the boundary layer and wake characteristics thus resulting in varying hydrodynamic characteristics of the structure however the influence of the attack on the hydrodynamic damping ratio is still unclear the measurement of the hydrodynamic damping ratio includes three key elements i e excitation structure response signal measurement and hydrodynamic damping ratio identification as for excitation roth et al 2009 created a fast growing and collapsing bubble which generated strong shock wave to supply a transient excitation on the hydrofoil by using the hammers the transient excitations were also supplied to the structures by xiu et al 2018 and presas et al 2017 to supply controllable excitations to the hydrofoils the macro fiber composites piezoelectric actuation bergan et al 2019 seeley et al 2012 and lead zirconate titanate piezoelectric patch pzt yao et al 2014 presas et al 2017 were widely used and they were usually mounted on the surface of the hydrofoils presas et al 2017 compared the vibration response of a disc with hammer excitation and pzt excitation the result indicated that the difference in natural frequency in these two situations was less than 1 as for the signal measurement the laser doppler vibrometer ldv was widely used to measure the hydrofoil vibration bergan et al 2019 roth et al 2009 seeley et al 2012 this has the advantage of conducting a non contact measurement of vibration but it is expensive and may not be applicable in non transparent environments such as cavitation or high sediment flow pzt was much lighter than the test structure presas et al 2017 and was also widely used in vibration response measurement yao et al 2014 de la torre et al 2013 in particular the vibration signals measured by pzt were verified by comparing them with those measured by an accelerometer de la torre et al 2013 as for the hydrodynamic damping ratio identification one method was to perform function fitting based on the amplitudes of the vibration responses near the resonance frequency yao et al 2014 seeley et al 2012 the other method was based on the logarithmic decay time evolution of the vibration response roth et al 2009 zeng et al 2019a in order to isolate the vibration signal with the natural frequency of a single mode the butterworth band pass filter was used by roth et al 2009 however the feasibility of the filter parameters for different vibration systems needs to be verified indeed the attack angle was associated with flow separation and boundary layer characteristics ducoin et al 2009 therefore it was also associated with the vibration characteristics of structures ducoin et al 2012 however the effect of the attack angle on the vortex induced vibration has not been fully understood and no experiments have been found to systematically measure the hydrodynamic damping characteristics at different attack angles in this investigation we designed experiments to investigate the influence of the attack angles on the vortex induced vibration and hydrodynamic damping ratio characteristics experimental set up and data processing methods are introduced in section 2 in detail the feasibility of the equipment and method is verified in section 3 and the vibration characteristics of a hydrofoil with different attack angles are quantitatively analyzed and discussed in section 4 2 experimental and numerical modal analysis methods 2 1 experimental set up 2 1 1 test hydrofoil the tested hydrofoil is a naca 0009 hydrofoil with a blunt trailing edge as shown in fig 1 a the span width of the hydrofoil is 67 mm the chord length is 70 mm and the trailing edge thickness is 2 25 mm it is made of aluminum with a young modulus of 69 gpa a density of 2700 kg m3 and poisson s ratio of 0 334 one end of the hydrofoil is fixed to the connecting rod and the other end is free in relation to the connecting rod one end is constrained by a packing seal and the other end is constrained by a threaded connection two p 878 a1 piezoelectric patches pzt1 and pzt2 are fitted to the leading and trailing edges of the hydrofoil surface respectively this is made of piezoelectric ceramic material with dimensions of 27 mm 9 4 mm 0 6 mm and an operating voltage range of 20 120 v the spanwise profile of the hydrofoil is shown in fig 1 b which is a reduced scale 0 7 times model of the hydrofoil tested in the swiss federal institute of technology in lausanne epfl roth et al 2009 ausoni 2009 2 1 2 test rig the test system is illustrated in fig 2 a which is a closed loop cavitation tunnel in the beijing institute of technology the flow is driven into the test section by an axial flow pump and the flow velocity is monitored by an electromagnetic flow meter uncertainty is within 0 5 the turbulence level of the flow in the test section is reduced by a straightening vane in particular the turbulence intensity at the inlet of the test section is within 1 with a velocity of less than 10 m s more detailed information of this closed loop cavitation tunnel is provided in detail in reference wu et al 2015 the rectangular test section is shown in fig 2 b with a length of 0 7 m a width of 0 07 m and a height of 0 19 m according to the previous reviews luo et al 2016 cheng et al 2021 in the cavitating flow around the hydrofoil the cavitation may introduce an additional hydrodynamic force on the hydrofoil and has an additional influence on the hydrodynamic damping characteristic in the present investigation in order to avoid the additional influence of cavitation on the vibration characteristics of a hydrofoil at different angles of attack all the experiments are carried out in a cavitation free condition 2 1 3 test processing in the present experiment the detailed excitation methods are as follows 1 to verify the feasibility of the hammer as an exciter the hydrofoil is also excited by the pzt1 in air and the signals obtained from the two excitation methods are compared 2 to measure the natural frequency and hydrodynamic damping ratio a hammer is used to excite the hydrofoil 3 the vortex shedding frequency and vortex induced vibration of the hydrofoil are measured without any extra excitations it needs to be explained that the pzt1 was chosen to excite the hydrofoil at the design stage of the present experiment because many previous experiments showed the feasibility of pzt to excite submerged hydrofoils de la torre et al 2013 2014 yao et al 2014 however due to the mechanical noise caused by the operation of the pump and high turbulence noise in flowing water the vibration signals of the hydrofoil in the real experiment excited by pzt1 are very noisy therefore for the measurements of the modal parameters natural frequency and hydrodynamic damping ratio a hammer is finally used to supply transient excitation to the hydrofoil in order to ensure that the deformation of the hydrofoil in flowing water is measurable the excitation position is on the threaded end of the connecting rod as shown in fig 1 a the vibration response of the hydrofoil is recorded by the pzt2 and a test is designed in air to verify the feasibility of pzt2 as a sensor firstly a controllable voltage signal is sent out by the signal generator the duration of the sweep is 100s and the linear frequency range is from 1 to 2000 hz secondly the signal is fed to pzt1 through a power amplifier 10 times to excite the hydrofoil the amplitude of the sweep is within the operating voltage range of the pzt 20 to 120 v and 10 rounds of excitations are performed thirdly the vibration signal of the hydrofoil is monitored using pzt2 and an accelerometer with a type of ac135 2c 010 m the accelerometer is glued on the hydrofoil the signals transmitted from pzt2 and the accelerometer are recorded using an ni pxi 4472 digitizer and an ni 9234 digitizer respectively both with a sampling frequency of 10 khz finally the modal recognition results of the two measurement methods will be quantitatively analyzed 2 1 4 test contents in this experiment the test velocity ranges from 0 to 7 53 m s with four attack angles α 0 2 4 and 6 the following will be tested vortex induced vibrations natural frequencies and hydrodynamic damping ratios for the three main modes 2 2 signal processing methods 2 2 1 frequency identification the frequency analysis of the vibration signals in this investigation are carried out in two ways one is fast fourier transform fft and its solution method is given in detail in reference deergha rao and swamy 2018 the other method is continuous wavelet transform cwt based on the morlet mother wavelet pavesi et al 2008 zeng et al 2019b 1 w s n k 0 n 1 x k 2 π s δ t ψ 0 s ω k e i ω k n δ t where s is the wavelet scale n and k are the time and frequency index respectively x k is the discrete fourier transform of the original vibration signal δ t is the sampling interval s ψ 0 is the complex conjugate of the translated and scaled mother wavelet and ω k is the angular frequency rad s 2 2 2 hydrodynamic damping ratio identification the identification of the hydrodynamic damping ratio comprises three steps step 1 the vibration signal of the tested mode is isolated using the butterworth band pass filter method step 2 the filtered vibration signal can be treated as free vibration and the total damping ratio can be identified based on the logarithmic decay equation step 3 the hydrodynamic damping ratio is determined using the total damping ratio minus the damping ratio in air the equation of free vibration can be expressed as zeng et al 2019a 2 u t a e ζ t ω n t sin ω d t φ where a is the normalized amplitude ζ t is the total damping ratio ω n 2 π f n is the angular natural frequency rad s f n is the natural frequency hz ω d ω n 1 ζ t 2 is the damped angular natural frequency rad s and φ is the initial phase rad in the present investigation the total damping ratio is less than 0 1 and the relative difference between natural frequency and damped natural frequency is less than 0 5 the hydrodynamic damping ratio can be calculated as follows 3 ζ ζ t ζ a where ζ a is the damping ratio in air as for step 1 the cut off frequency and filter order are the main parameters for the butterworth band pass filter roth et al 2009 a numerical analysis is performed to validate the parameters of the butterworth filter based on the matlab code the time signal in fig 3 a is a synthetic signal generated by the matlab code based on the superposition of different modes in the case of a single mode the signal is the combination of natural frequency amplitude and damping ratio firstly the natural frequencies and corresponding amplitudes of different modes can be determined according to the frequency domain of a real experimental result secondly the damping ratios for different modes are designed by the matlab code the damping ratios in particular for the three main modes f n1 f n2 and f n3 are 0 03 0 02 and 0 01 respectively for the other modes the damping ratios are set at 0 01 thirdly the filter parameters of different modes are quantitatively adjusted in particular the cut off frequencies and filter orders for the three main modes in this case are shown in table 1 and the frequency response characteristics of the filters are shown in fig 3 b fourthly the vibration signal of a single mode is isolated as shown in fig 3 c finally as shown in fig 3 d two damping ratios can be obtained by fitting the upper and lower peak points according to equation 2 and the final damping ratio is their arithmetic average by using the properties of the butterworth band pass filter in table 1 the relative deviation between the designed and the identified damping ratios for the three main modes are only 2 3 and 1 respectively 2 2 3 definition of other parameters the flow velocity is calculated based on the volumetric flow rate and cross sectional area of the test section as follows 4 v q s where q is the volumetric flow rate m3 s and s is the cross sectional area m2 the strouhal number is calculated as follows ausoni 2009 5 s t h f h v where f is the vortex shedding frequency hz h is the trailing edge thickness m based on the flow velocity the natural frequency of the ith mode of the hydrofoil and the geometric dimensions of the hydrofoil the reduced velocity of the ith mode is defined as follows ausoni 2009 6 v v f n i l where f n i is the natural frequency of the ith mode hz and l is the chord length of the hydrofoil m 2 3 numerical modal analysis method the mode shape and corresponding natural frequency of the structure can be numerically simulated using the modal analysis approach with the finite element method fem de la torre et al 2014 the simulation results obtained by this approach were in good agreement with the experimental results liang et al 2007 moreover although the natural frequency of the structure in water was reduced due to the added mass effect the mode shape in water was almost the same as the mode shape in air zeng et al 2019a liang et al 2007 the structural dynamics equation can be expressed as liang et al 2007 7 m u c u k u f where m c and k are the mass damping and stiffness matrix of the hydrofoil respectively u is the modal displacement vector the overdot is the time differentiation and f is the load vector the detailed introduction of the modal analysis approach is given in reference liang et al 2007 modal analysis is carried out using the ansys code the material and constraints are the same as the experimental set up the nodes number is determined based on the grid convergence index gci method celik et al 2008 in particular the nodes number of the hydrofoil is around 70 thousand according to the previous modal analysis of a similar hydrofoil de la torre et al 2014 zeng et al 2019a the selected element type is a three dimensional eight nodes solid solid 185 3 feasibility analysis 3 1 comparison of results between pzt and accelerometer the feasibility of the pzt2 as a sensor is verified by comparing its signals with those obtained from an accelerometer in air the hydrofoil is excited by pzt1 using the sweep frequency excitation method the vibration responses are collected by an accelerometer and the pzt2 and the corresponding frequency domains are obtained by fft for the three main modes the relative differences of natural frequency obtained by the accelerometer and the pzt2 are only 1 69 1 44 and 1 75 respectively the feasibility of the pzt2 used for damping ratio measurement is also analyzed the filtered free vibrations of the third mode measured by the accelerometer and pzt2 are shown in fig 4 the phase angle of the vibration signal measured by pzt2 is shifted by 120 for display purposes the results show that their amplitude decay trends are in good agreement the damping ratio measured by the accelerometer and the pzt2 are 0 0067 and 0 0065 respectively and the relative deviation is only 3 in the work of de la torre et al de la torre et al 2013 the use of pzt as a sensor was also verified by comparing its signals with those from the accelerometers in addition the feasibility of the hammer as an exciter is verified by comparing the signals excited by the hammer and the pzt1 in particular with different excitation methods in still water the relative deviations of the natural frequencies for the three main modes are within 4 18 3 2 comparison of results with the previous works in epfl 3 2 1 strouhal number without extra excitation and with a 0 attack angle the frequency spectrums of vortex induced vibration at different velocities are shown in fig 5 a resonance occurs when the vortex shedding frequency is close to the natural frequencies f n1 and f n2 of the hydrofoil the vortex shedding frequency is identified based on the signal length of 10s the vortex shedding frequency and corresponding amplitude of vortex induced vibration are extracted as shown in fig 5 b the results show that there is a lock in phenomenon for the second mode while this phenomenon is not observed for the first mode this experimental result is the same as the conclusion drawn by ausoni et al ausoni 2009 outside the lock in region the vortex shedding frequency increases linearly as the velocity increases within the lock in region the vortex shedding frequency also increases slightly with increasing velocity while the relative variation is only within 7 the strouhal numbers at different reduced velocities are shown in fig 6 the reduced velocities are calculated based on the natural frequency of the second mode of the hydrofoil according to the experimental results of ausoni 2009 the strouhal number for the trip transition ranges from 0 158 to 0 193 in this test the strouhal number ranges from 0 162 to 0 177 and this is in good agreement with the result of ausoni 2009 3 2 2 hydrodynamic damping ratio the hydrodynamic damping ratios for the first mode are verified at different reduced velocities as shown in fig 7 the region a and b refers to the flow region where the velocity is below and above the resonance velocity respectively in region a the hydrodynamic damping ratio remains almost constant in region b the hydrodynamic damping ratio increases linearly with increasing velocity these trends are consistent with the experimental results obtained by roth et al 2009 4 results and discussions 4 1 vortex induced vibration the vortex shedding frequencies with different attack angles at different velocities are shown in fig 8 a when the velocity is below the lock in region the vortex shedding frequencies with different attack angles increase linearly with increasing velocity when α increases from 0 to 6 the attack angle only has a minor effect on the vortex shedding frequency and the relative deviation is within 4 9 at different attack angles significant differences in frequencies are observed when the velocities are close to the edges of the lock in region this can be explained as the high amplitude resonance forces the vortex shedding frequency to be consistent with the natural frequency of the structure in the lock in region the vortex shedding frequency tends to increase slightly with increasing velocity the width of the lock in region tends to increase as the attack angle increases in particular with 0 2 4 and 6 attack angles the lock in widths are around 1 11 m s 1 11 m s 1 33 m s and 1 55 m s respectively the corresponding amplitudes of the vortex shedding frequencies with different attack angles at different velocities are shown in fig 8 b when the vortex shedding frequency is close to the natural frequencies of the first and second modes resonance occurs and the corresponding amplitude is significantly amplified in particular with α 0 2 4 and 6 the amplitudes at lock off velocity 7 53 m s are only around 1 04 3 04 of those at resonance velocity 6 42 m s the resonance amplitude for the first mode is significantly smaller than that of the second mode in particular with different attack angles the amplitudes of the former are only 2 07 8 62 of the latter this may serve as an explanation for the phenomenon that the lock in is not observed for the first mode as for the different attack angle the resonance vibration level increases as the attack angle increases in particular the amplitude with α 0 is only 42 5 of that with α 6 at a velocity of 6 42 m s 4 2 mode shape the time evolution of the vibrating hydrofoil in still water after supplying transient excitation is shown in fig 9 a the vibration amplitude gradually decays due to damping the time frequency domain of the damped vibration is shown in fig 9 b there are three obvious natural frequency components named the first mode fn1 second mode fn2 and third mode fn3 respectively the mode shapes of the three main modes of the hydrofoil are simulated using the ansys code in air and in water as shown in fig 10 the types of mode shapes in water are the same as that in air in the case of the first and third modes the node lines are parallel to the chord as shown in fig 10 a and c as regards the second mode the node line is approximately perpendicular to the chord as shown in fig 10 b these mode shapes are similar to the results obtained by de la torre et al de la torre et al 2014 and yao et al 2014 as shown in table 2 the simulated natural frequencies in air and in water are in good agreement with those obtained by the experiment with relative deviations within 7 12 4 3 natural frequency the natural frequencies at different attack angles at different velocities for the first second and third modes are shown in fig 11 a b and c respectively the natural frequency is identified based on the signal length of 0 3s because the vibration response caused by the hammer excitation is decayed and hard to be identified after around 0 3s the uncertainty bar represents the 95 confidence interval of 10 replications there are two obvious phenomena one is the attack angle and velocity which have almost no effect on the natural frequency in the lock off region in particular the relative natural frequency variations for the first second and third modes are 9 61 4 42 and 3 68 respectively the other is that the natural frequency slightly increases with increasing velocity in the lock in region this may serve as an explanation for the phenomenon that the vortex shedding frequency increases slightly with increasing velocity in the lock in region in fact many previous investigations hoskoti et al 2018 mittal and navrose 2016 jiao and wu 2018 have shown that the natural frequency may increase with increasing velocity in the lock in region according to the work of jiao et al jiao and wu 2018 the large deformation in the lock in region may result in an increase in stiffness and therefore may also result in an increase in the natural frequency however it is not clear whether the large deformation in the lock in region has an influence on the added mass we intend to address the flow mechanism behind this in future research 4 4 hydrodynamic damping the hydrodynamic damping ratios with different attack angles at different velocities for the first second and third modes are shown in fig 12 a b and c respectively the uncertainty bar represents the 95 confidence interval of 10 replications the hydrodynamic damping ratio is obtained by subtracting the damping ratio in the air from the total damping ratio in particular the damping ratio in air for the first second and third modes are 0 022 0 018 and 0 007 respectively as shown in fig 12 a for the first mode when the velocity is below the resonance velocity the hydrodynamic damping ratios remain almost constant for different attack angles when the velocity is above the resonance velocity the hydrodynamic damping ratio increases with increasing velocity this is the same for different attack angles however the hydrodynamic damping ratio tends to decrease as the attack angle increases in particular at a velocity of around 7 1 m s the hydrodynamic damping ratios with 2 4 and 6 attack angles are around 78 33 87 39 89 85 of those with a 0 attack angle respectively as shown in fig 12 b for the second mode when the velocity is below the lock in region the hydrodynamic damping ratios remain the same for different attack angles in the lock in region the hydrodynamic damping ratio drops significantly more attention should be paid to two phenomena one is the hydrodynamic damping ratios which are almost all less than 0 in the lock in region this may result in high amplitude vortex induced vibration therefore forcing the vortex shedding frequency to be consistent with the natural frequency of the hydrofoil the reduced velocity range where the hydrodynamic damping ratio is less than 0 is defined as the negative hydrodynamic damping width the other phenomenon is that the negative hydrodynamic damping width with a larger attack angle is wider than that with a smaller attack angle this trend is similar to the lock in width changes with different attack angles at the reduced velocity of around 0 19 lock in region the hydrodynamic damping ratio decreases as the attack angle increases this may cause the vibration level of resonance to increase as the attack angle increases as shown in fig 12 c for the third mode all the test velocities are less than the resonance velocity and the hydrodynamic damping ratios are constant at different attack angles 5 conclusions the experiments on the naca 0009 hydrofoil have been carried out to investigate the influence of the attack angle 0 6 on the vortex induced vibration and hydrodynamic damping ratio characteristics ranging from 0 to 7 53 m s the feasibility of the experimental equipment and processing method has been verified and the main conclusions are summarized as follows 1 the vortex shedding frequencies and corresponding vibration amplitudes with different attack angles are compared when the velocity is below the lock in region the attack angle has almost no influence on the vortex shedding frequency with relative variation within 4 9 in the lock in region the vortex shedding frequencies with different attack angles increase slightly with increasing velocity however the lock in width with a larger attack angle is greater than that with a smaller attack angle the resonance amplitude increases as the attack angle increases for the second mode in particular resonance amplitude at a 0 attack angle is only around 42 5 of that with a 6 attack angle 2 the natural frequencies with different attack angles for the three main modes are investigated in the lock off region both velocity and the attack angle have almost no effect on the natural frequency in particular under the coupling effect of velocity and the attack angle the relative variations of natural frequencies for the first second and third modes are within 9 61 4 42 and 3 68 respectively while in the lock in region the natural frequencies with different attack angles increase slightly with increasing velocity this result in the vortex shedding frequency increases with increasing velocity in the lock in region 3 the hydrodynamic ratios with different attack angles for the three main modes are quantitatively analyzed when the velocity is below the resonance velocity the hydrodynamic damping ratio remains constant as the velocity increases and the attack angle has also almost no influence on the hydrodynamic damping ratio when the velocity is above the resonance velocity the hydrodynamic damping ratios with different attack angles increase with increasing velocity while hydrodynamic damping ratio tends to decreases as the attack angle increases in particular when the velocity is around 7 1 m s the hydrodynamic damping ratios with an attack angle of 2 4 and 6 are approximately 78 33 87 39 and 89 85 of that with a 0 attack angle respectively in the lock in region the hydrodynamic damping ratio is found to be negative and the negative hydrodynamic damping width increases as the attack angle increases credit authorship contribution statement yongshun zeng experiment validation investigation writing original draft visualization mindi zhang resources experiment validation investigation yuxin du experiment investigation zhifeng yao methodology conceptualization supervision writing review editing qin wu methodology validation fujun wang methodology conceptualization supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the financial support given by the national natural science foundation of china nos 51836010 51879266 and 51839001 and the beijing municipal science and technology project no z181100005518013 
20204,in this study the hybrid computational hydro acoustics cha method is applied to predict hydrodynamic noise due to tip vortex cavitation tvc of underwater submarine propellers the hybrid cha approach consists of two sequential methods delayed detached eddy simulation ddes technique with adaptive mesh refinement method and the ffowcs williams and hawkings fw h equation the former is utilized for accurate prediction of tvc of underwater propellers and the latter is used for efficient prediction of hydro acoustic pressure due to cavitating flow the target submarine and propeller are the darpa suboff submarine and two high skew propellers with skew angles of 17 and 38 the propellers are designed to investigate the effects of skew angle on tvc and its noise the corresponding experiments are performed in the large cavitation tunnel lct of the korea research institute of ships and ocean engineering kriso the two preliminary simulations are carried out to confirm the close reproduction of the experimental conditions in the main simulations first the flow through the lct test section is simulated to confirm the accurate reproduction of the wall boundary layer its validity is confirmed by comparing the predicted boundary layer profiles with the measured results second the flow over the darpa suboff submarine without a propeller in the lct test section is simulated to confirm the accurate prediction of the inflow distortion originating from the boundary layer flow of the submarine body its validity is also confirmed by comparing the predicted nominal wake field with the measured one after the close reproduction of these two effects is confirmed the cavitating flow of the propellers installed to the darpa suboff submarine body is simulated by using the ddes technique combined with adaptive mesh refinement and the tvc noise is predicted by applying the quadrupole corrected fw h equation to the surfaces enclosing the propellers the predicted tvc of the propeller closely follows the measured one the numerical and experimental results capture the tvc induced by the wake flows due to the submarine body s rudders and sail the predicted hydro acoustic pressure spectra due to the propellers cavitating flow also show excellent agreements with the predicted ones besides both the numerical and experimental results confirm that the lower noise is generated by the propeller with a higher skew angle keywords underwater propeller noise tip vortex cavitation cavitation noise darpa suboff submarine delayed detached eddy simulation acoustic analogy 1 introduction the increase in worldwide shipping has adversely affected the underwater ecosystem by disturbing the natural acoustic signal with underwater noise radiated from the surface and underwater vehicles park and yoon 2017 sohn et al 2015 chou et al 2021 the underwater noise generated by the ships can be classified into machinery noise and flow noise according to noise generation mechanism and the flow noise due to underwater propellers is recognized as one of the most dominant noise sources a lot of studies have been performed on marine propeller noise to reduce acoustic signature and more recently to reduce the influence of maritime noise on the environment lloyd et al 2015 underwater radiated noise by a propeller can be divided into two parts non cavitation and cavitation noise the primary sources of non cavitation noise are dipolar sources due to surface pressure on propeller blades and quadrupole sources such as tip vortex structure wang et al 2018 however it is well known that when cavitation occurs on a propeller the noise level is increased significantly in a broad high frequency range van oossanen 1974 the sheet and cloud cavitation which forms on the propeller surface are synchronized with the blade rotating frequency and increased the tonal noise ye et al 2012 while the tip vortex cavitation tvc occurs along the tip vortex trajectory of a propeller and contributes to the broadband noise in a frequency range above 1 khz lee et al 2013 therefore manufacturers and developers in related industrial fields are developing propellers that can operate at higher speeds without cavitation thereby developing surface ships and submarines of high hydrodynamic and low noise performances specifically the vital cavitation performance index is the cavitation inception speed cis which is defined as the speed at which cavitation starts to occur in the propeller the cis of a propeller usually depends on its tvc characteristics because the tvc is the first cavitation type that the propeller experiences as its rotating speed increase lee et al 2013 there are two ways to assess the occurrence of tvc and thus to determine the cis the optical and acoustic methods seol 2013 seol and kim 2018 in the optical method the high speed camera is used to capture cavitation shape and the cavitation size is used as a criterion to determine the cis in the acoustic method the noise spectrum is monitored as the operating speed increases and the abrupt increase in the spectrum is used as an indicator to determine the cis it is usually difficult to perform an experiment using a full scale model and instead the scaled model is widely used to evaluate its hydrodynamic and noise performances in an early stage of development however it is challenging to extrapolate the scaled results on the cis to the full scale due to the multi physical phenomena involved in the extrapolation ku et al 2020a 2020b 2020b instead numerical methods can be utilized to assess the tvc the numerical approaches used to predict the tvc can be classified into the lagrangian and eulerian approaches the lagrangian approach is based on the bubble dynamics equations applied to nuclei initially distributed in the inflow region the subsequent volume and location of each nucleus are tracked by solving the bubble dynamics equations on the hydrodynamic flow field obtained using the eulerian method using the lagrangian method ku et al 2020a 2020b predicted the tvc and tvc noise on the naca 16 020 elliptic wing and showed that the initial concentration of nuclei significantly affected the predicted cavitation pattern and its noise hsiao et al 2003 2017 hsiao and chahine 2008 and ma et al 2015 2018 also developed the lagrangian methods based on bubble dynamics theory using the one way and two way coupled methods with the eulerian approach they showed that the complex cavitation phenomena such as the merging stretching and collapse of bubbles could be simulated however it is still difficult to reproduce the experimentally observed pattern of the noise spectrum due to tvc using the lagrangian approaches the eulerian approach simulates the cavitation flow field using the cfd techniques based on the finite volume methods various cfd equations and techniques such as the rans the detached eddy simulation des and the large eddy simulation les have been used the unsteady hydrodynamic flow field obtained from the eulerian approaches is used as noise sources to predict the cavitation noise by using the acoustic analogy such as the ffowcs williams and hawkings fw h equations extended from the lighthill s acoustic analogy ffowcs williams and hawkings 1969 lighthill 1954 this kind of numerical method based on the sequential application of cfd and acoustic analogy can be classified as a hybrid computational underwater acoustic cha approach which corresponds to the hybrid computational aeroacoustic caa methods widely used in the related engineering fields especially the eulerian approach combined with the fw h equation has been successfully used in a wide range of applications from fan aerodynamic noise and airfoil cavitation noise heo et al 2011 kim et al 2017 2018 park et al 2019b ren et al 2013 seol et al 2005 applied the potential based panel method to simulate the propeller s cavitation flow and used the fw h acoustic analogy to predict the sheet cavitation noise ghassemi 2009 reported that the skew angle was a vital design parameter used to reduce the hydrodynamic drag showing that thrust and torque decreased as the skew angle increased in the non uniform wake flow the sheet cavitation flow was also investigated using the rans solver combined with the homogeneous mixture approximation and the merkle cavitation model ha et al 2018 kim et al 2017 2018 li et al 2018 predicted the cavitation flow and cavitation noise at the design speed condition using the des technique and the fw h equation the predicted noise spectrum was compared with the measurement data on the full scale ship bulut and ergin 2019 performed the rans des and les simulations on a circular cylinder and applied the fw h equation for cavitation noise prediction they reported that the des fwh and omega fwh methods are the most efficient numerical procedure in terms of accuracy and numerical cost gorji et al 2019 compared the hydrodynamic and noise performances of propellers according to the skew angle variation and reported that the noise level decreased up to 45 but the noise level increased in the case of a skew angle of 75 although there have been many studies to simulate the cavitation phenomenon using various numerical methods the accurate simulation of tvc remains one of the most challenging problems due to the complex physical mechanisms involved in its generation and the highly demanding numerical cost for resolving the tip vortex core with enough grids in this study a hybrid cha method is used to predict flow noise due to the tvc of underwater submarine propellers the hybrid cha approach consists of two sequential methods the delayed detached eddy simulation ddes technique combined with the adaptive grid refinement method for accurate simulation of tvc flow of underwater propellers and the quadrupole corrected fw h integral equation for prediction of acoustic pressure due to the tvc to highlight the effectiveness of current numerical methods a full submarine body equipped with a propeller is targeted the darpa suboff is used as a submarined body and two kinds of underwater propellers are designed to investigate the effects of skew angles two propellers have the same geometrical parameters except for the skew angles of 17 and 38 being named hsp17 and hsp38 for convenience respectively the cavitation flow and noise of the hsp17 and hsp38 installed to the darpa suboff body are predicted and compared the corresponding experiments are also performed in the large cavitation tunnel lct of the korea research institute of ships and ocean engineering kriso the validity of the numerical methods is confirmed by comparing the predicted results with the measured ones the main contribution of this paper is three fold first the hybrid cha method is presented to make efficient and reliable predictions of the tvc noise of marine propellers with full consideration of the entire hydrodynamic flow field of a submarine body second the effects of the nominal wake field formed by the boundary layer flow over the rudders and sail of the submarine body on the tvc are analyzed the wakes in the nominal wake field are found to enhance the cavitation on the propeller surface third the effects of the skew angle of an underwater propeller on tvc inception and noise are evaluated quantitatively both numerical and experimental results commonly revealed that the propeller with a higher skew angle induces weaker tvc and thus produces less flow noise this paper is structured as follows section 2 presents the geometries of the target submarine body and propellers computational domains and numerical methods used to investigate the tvc flow and noise in section 3 the experimental methods are described to visualize the cavitation flow and measure the hydro acoustic pressure due to cavitation in section 4 three types of numerical simulation results are presented first the boundary layer flow on the lct wall is predicted using the steady rans solver the predicted boundary layer profiles are compared with the measured ones to confirm the accurate reproduction of the inflow field to the tested target body second the hydrodynamic flow over the submarine body without a propeller is simulated using the steady rans solver the nominal wake field originating from the boundary layer flow on the submarine body is compared with the measured one to confirm the close reproduction of the inflow disturbance to the propellers finally the tvc flow field is predicted for the darpa suboff submarine body with high skew propellers using the ddes technique combined with adaptive mesh refinement procedure and the tvc noise is predicted by using the fw h acoustic analogy the validity of numerical results is confirmed by comparing the predicted tvc pattern and noise with the measured ones the effects of skew angle are also evaluated in terms of tvc strength and noise in section 5 the main results are summarized 2 numerical methods in this study two preliminary simulations are carried out to confirm the accurate computation of inflow conditions to the target propellers the boundary layer flow on the wall of the lct test section and the wake flow from the suboff submarine body the first preliminary simulation is carried out for flow passing through the lct test section in kriso without an immersed body the result obtained from this simulation is used to ensure enough resolution of grids near the wall through the comparison of the predicted boundary layer profiles with the measured ones the second preliminary simulation is performed considering only the suboff submarine body without a propeller in the test section of lct to characterize the wake flow due to the hull and rudders of the submarine body and confirm the validity of the numerical solutions through its comparison with the experimental results these two preliminary simulations are performed using the steady rans simulation the main simulations on the tvc flow of the propellers installed to the suboff submarine body are then performed using the ddes techniques combined with the adaptive grid refinement process finally cavitation noise prediction is made by applying the quadrupole corrected fw h integral equation to the cavitation flow field obtained from the ddes results the geometrical conditions of simulations made in this study are schematically presented in fig 1 note that the steady rans simulation is also performed to set up the initial condition for the main unsteady ddes simulations 2 1 geometries of target submarine body and propellers the outer boundary geometry of the entire computational domain is constructed to be the same as the test section of the lct in kriso the body shape of the target submarine is modeled from the darpa suboff submarine groves et al 1989 roddy 1990 fig 2 depicts the geometries of the lct test section and the darpa suboff submarine with the boundary conditions applied for subsequent simulations the detailed dimensions are presented in table 1 the inlet velocity and outlet pressure are set as the inlet and outlet boundary conditions the background pressure is specified with the operating pressure given from the experiment the no slip boundary condition is applied on the surface wall of the lct test section the submarine body and the underwater propellers the detailed boundary conditions for all simulations are shown in table 2 the two propellers are designed and manufactured to investigate the effect of skew angle one has a skew angle of 17 and the other 38 named hsp17 and hsp38 respectively the detailed shapes and the related dimensions of hsp17 and hsp38 are presented in fig 3 and table 3 respectively the rotational velocity of the propellers is set to be 25 rps to simulate the propeller s rotating motion the moving reference frame mrf and the sliding mesh techniques are applied for the steady rans and the unsteady ddes simulations respectively 2 2 governing equations and numerical schemes before the main numerical simulations are performed for predicting the tvc flow and noise of the target propellers the two preliminary simulations i and ii are carried out to confirm the grid resolutions which enable accurate predictions of the boundary layer flow on the lct test section and the wake flow due to the suboff body respectively the steady rans equations are used as the governing equations for these preliminary simulations however since the accurate simulation of cavitation flow and noise requires high order accuracy in time and space the unsteady ddes is used in combination with the homogeneous mixture assumption for modeling two phase flow in the main simulation then cavitation noise is predicted using the fw h integral equation with input from the unsteady ddes result the governing equations for hydrodynamic flow are numerically solved using the ansys fluent v20 1 and the fw h integral equation is solved using the in house code of which the validity is confirmed through its application to a benchmark problem in this study 2 2 1 reynolds averaged navier stokes equation rans the three dimensional incompressible steady rans equations are numerically solved in the preliminary simulations to check the numerical accuracy in terms of the boundary layer flow on the test section and the nominal wake field due to the submarine body the continuity and momentum equations are written as follows 1 ρ u i x i 0 2 ρ u i u j x j ρ g i p x i x j μ u i x j u j x i 2 3 δ i j u k x k x j ρ u i u j here p ρ u and μ denote the pressure density velocity and dynamic viscosity for fluid the subscript i means the i directional component in a cartesian coordinate δ i j is a kronecker delta function that is 1 for i j and 0 for i j and ρ u i u j is the reynolds stress tensor which needs to be solved by using a turbulence model the spatial derivative is discretized using the 2nd order upwind scheme based on the pressure based semi implicit method for pressure linked equations simple where the continuity and momentum equations are sequentially solved the operating pressure liquid density ρ l and liquid dynamic viscosity μ l are set to be 196 860 pa 999 6 kg m3 and 1 275 10 5 kg m s respectively non uniform wake flow reduces the propulsion performance of a propeller by decelerating the flow velocity at the stern the wake flow is affected by the boundary layer on the suboff body which is also affected by the boundary layer on the lct test section wall a turbulence model for this simulation needs to properly deal with adverse pressure gradient and flow separation within the boundary layer to simulate the boundary layer flow accurately the k ω sst turbulence model menter 1994 is used in the rans applying the k ω and k ε models to the regions near and away from the wall respectively the rans simulation results are also used to determine the initial conditions and grids for the subsequent unsteady ddes simulation described below 2 2 2 delayed detached eddy simulation ddes for the main simulation the three dimensional incompressible unsteady ddes simulation is performed the schnerr and sauer asnaghi et al 2018 schnerr and sauer 2001 lloyd et al 2017 yilmaz et al 2019 lidtke et al 2016 model is used for the prediction of cavitation with a homogeneous mixture assumption to improve numerical accuracy at the moderate numerical cost the des was devised by using the numerical strategy where the unsteady rans urans is used for the boundary layer flow near the wall and the les is used in the flow region outside the boundary layer region shur et al 1999 spalart et al 1997 strelets 2001 however because the des revealed inaccurate predictions in the thick boundary layer and the shallow separation region the ddes technique was developed to improve the des technique by delaying the les region into the boundary layer inner region gritskevich et al 2012 kim 2017 shur et al 2018 spalart et al 2006 the conceptual diagram for the des and ddes is shown in fig 4 the governing equations for the ddes are written in the form 3 ρ k t ρ u i k x i x i μ σ k μ t k x i p k ρ k 3 l d d e s 4 ρ ω t ρ u i ω x i x i μ σ k μ t ω x i 2 1 f 1 ρ σ ω 2 1 ω k x i ω x i α ρ μ t p k β ρ ω 2 5 μ t ρ a 1 k max a 1 k f 2 s here k ω μ and μ t denote the turbulent kinetic energy specific dissipation rate molecular viscosity and turbulent viscosity respectively l d d e s is the blending function based on the rans turbulent length scale and les grid length scale the other variables denote the constants used in the ddes model the numerical schemes used to discretize eqs 3 5 are the implicit bounded 2nd order scheme for the time derivative the bounded 2nd order discretization for the momentum equation the quadratic upstream interpolation for convective kinematics quick scheme for the volume fraction continuity equation and the 2nd order upwind scheme for the turbulent transport equations the maximum internal number of iterations is 20 and the residual of convergence criterion is 10 3 the absolute pressure p v density ρ v and dynamic viscosity μ v for vapor are set to be 1300 pa 9 925 10 3 kg m3 9 48844 10 6 kg m s respectively the liquid quantities are the same as those used in the preliminary simulations and the operating pressure for the main simulation is set to be 50 kpa 2 2 3 ffowcs williams and hawkings fw h acoustic analogy to predict the acoustic pressure due to tvc flow the fw h equation is used for an acoustic solver with input from the unsteady ddes simulation results the fw h equation is written as follows 6 4 π p x t t s q y τ r 1 m r d s y x i s f i y τ r 1 m r d s y 2 x i x j v t i j y τ r 1 m r d y where q ρ u i u i ρ 0 u i n ˆ i f i ρ u i u j u j p δ i j n ˆ i t i j ρ u i u j p p o c o 2 ρ ρ 0 δ i j u j 1 ρ ρ o v j ρ u j ρ o x and y denote the observer and source locations respectively and r x y is the distance between them here ρ p and u are density pressure and velocity of flow respectively and v and n ˆ mean the source surface velocity and unit normal vector perpendicular to the source surface respectively mach number m is defined as m v c where c is the speed of sound the subscript o and superscript denote mean and fluctuation properties respectively the fw h equation predicts compressible acoustic pressure due to three noise sources monopole dipole and quadrupole sources which are the first second and third terms respectively in the right side of eq 6 however the quadrupole term expressed using the lighthill stress tensor tij is generally ignored because its acoustic efficiency is much less than the other sources in low mach number flows for this reason the permeable fw h equation including only the surface sources is applied to predict cavitation noise farassat s 1a formulation where the monopole noise source is expressed as the thickness noise p t and the dipole noise source is expressed as the loading noise p l are used farassat 2007 singer et al 2003 in the form 7 4 π p t x t f 0 ρ 0 u n u n r 1 m r 2 r e t d s f 0 ρ 0 u n r m r c 0 m r m 2 r 2 1 m r 3 r e t d s 8 4 π p l x t 1 c 0 f 0 l r r 1 m r 2 r e t d s f 0 l r l m r 2 1 m r 3 r e t d s 1 c 0 f 0 l r r m r c 0 m r m 2 r 2 1 m r 3 r e t d s where u j 1 ρ ρ 0 v j ρ u j ρ 0 l i p i j n ˆ j ρ u i u n v n here the superscript means the source time derivative and the subscript n and r denote the normal and observer directional components computed using the dot product the ret means the integration at the retarded time τ t x y c the permeable or flow through integral surface in the kirchhoff formulation must be located in the linear region here the linear means that there are no other sources in the outer region of the integral surface and the source does not pass through the integral surface so that the acoustic information on the integral surface reaches the observer point without any interference when the permeable surface is in the nonlinear region the kirchhoff formulation shows a very non physical result on the other hand the fw h equation shows a physically valid result because it is derived from the navier stokes equations including all aerodynamics mechanisms brentner and farassat 1998 however it is still known to generate spurious noise when the source penetrates the integral surface unless the quadrupole term in the fw h equation is considered lockard and casper 2005 lopes et al 2017 wang et al 1996 this spurious noise can be corrected using the quadrupole correction term without volumetric integral ikeda et al 2012 2016 2017 the quadrupole correction term p q is expressed as follows 9 4 π p q x t 1 c 0 2 s 1 1 m r d t i j r ˆ i r ˆ j r 1 m r d 2 r e t s u c n ˆ d s where m r d u d r ˆ c and u d u c u here c r ˆ and u c are the sound speed displacement vector from a source to an observer and eddy convective velocity respectively then the quadrupole corrected acoustic pressure can be written in the form 10 p x t p t x t p l x t p q x t equation 10 is used for acoustic computations in this study 2 3 grid refinement procedure this section presents the grid refinement strategy for the simulations for the lct test section the suboff body and the propellers the commercial tool of the ansys fluent meshing is used to generate the grids and the cutcell grid technique is applied to generate the orthogonal grid in the unstructured grid system a prism layer is used in the regions near the test section wall and the suboff body surface to accurately calculate the high velocity gradient in the boundary layer the grids used for the preliminary simulations i and ii are presented in figs 5 and 6 respectively the y distributions are around 1 5 and 1 6 note that the y value lower than 5 is recommended for the k ω sst turbulence model to resolve boundary layer flow in a viscous sublayer region salim and cheah 2009 the detailed specifications for the grid sets are presented in table 4 the accurate prediction of tvc using numerical methods based on finite discretization formula derived from original differential equations is very challenging due to artificial numerical damping caused by truncation errors accompanying the finite discretization process and the round errors accumulating during iteration processes these errors can be reduced by applying high order numerical schemes on high resolution grids but at a prohibitive numerical cost ku et al 2020b applied a family of grids consisting of 3 6 13 5 27 and 54 grids located inside the vortex core to simulate wing tip vortex in a single phase problem and showed that the vortex dissipation is suppressed in the cases using more than 27 grid points inside the vortex core asnaghi et al 2018 2020 applied the grids of sizes between 0 05 mm and 0 2 mm to simulate the tvc and reported that at least 32 grid points were required inside the vortex core to capture the tvc for the 2nd order scheme accurately yilmaz et al 2019 used 2 3m grids with the adaptive grid refinement technique for a propeller in open water to simulate tvc and reported that more than 100 m grids are required to obtain the same flow field pattern if the adaptive grid refinement technique is not applied therefore from a practical point of view efficient grid strategy is required to simulate tvc accurately at a moderate numerical cost which enables its applicability to practical problems in this study the adaptive grid refinement method where grid resolution is locally increased in the region where the tvc occurs is used in combination with the rans and ddes solvers fig 7 shows the entire grids for the main simulation the grid refinement is made to the rotating region including the target propellers as shown in fig 7 a the grid type on the propeller surface is a polygonal grid as shown in fig 7 b the volumetric rotating region is constructed using the poly hexcore type grids six types of grid systems are used through the grid refinement procedure the cross sectional views of the grids from rans g1 to ddes g2 are shown in fig 8 the total number of each grid type is listed in table 5 note that the y values are the same for all the grid types since the grid resolution in the vortex core region in the flow field not the wall surface is refined therefore the y values remain similar to those in the preliminary simulation ii the grid types are divided into two groups which are used for the rans and ddes simulations respectively the main unsteady simulations based on the ddes techniques with sliding meshes are performed with initial condition obtained from the steady rans simulation performed with mrf technique to ensure stable and fast convergence of the unsteady simulations the grids used for the rans and ddes are named as the rans g and ddes g respectively and a higher number attached to the names means denser grids first the rans g1 is used to capture the initial vortex structure near the propeller blade tip and find vortex trajectories along downstream because the vortex structure may be dissipated quickly during its convection along the downstream direction due to numerical damping the rans g2 grid is used to simulate the vortex structure of the propeller blade s tip and hub along the downstream direction with more resolved meshes the number of grids in the rans g2 is much higher than that of the rans g1 approximately by 4 3 times several properties have been used to determine how well to resolve the vortex structure with given meshes such as minimum pressure vorticity q criterion and λ 2 criterion jeong and hussain 1995 ku et al 2020b in this study the minimum pressure is used to determine the location and strength of the vortex core center the related formula used to define vortex core curves is written as 11 r x a e b x c e d x y x r c o s θ 0 k x z x r sin θ 0 k x where k 2 π λ λ x n 1 x 1 θ 0 the angle of initial blade location eq 11 is used to identify the local region for more grid clustering fig 9 presents the adaptive grid refinement procedure from the predicted flow field result the radius of the vortex trajectories r x in eq 11 is determined as shown in fig 9 a and then the vortex trajectories in the form of y x z x in eq 11 are identified as shown in fig 9 b the grid resolution in the region containing the vortex trajectory is increased as shown in fig 9 c the rans g3 is obtained from the rans g2 by using the prescribed procedure then the tip vortex strength predicted using the rans g3 is checked to reproduce the required pattern in this study one more grid refinement procedure is applied to obtain the rans g4 from the rans g3 note that the number of total grids to construct the rans g3 and the rans g4 are both less than that of rans g2 the unsteady ddes simulation is then started from the steady rans result based on the rans g4 as the initial condition the subsequent regions for more grid refinement are determined by using pressure criterion satisfying inequality to capture the tip vortex cavitation with sufficient grid resolution without excess grids as shown in fig 9 d in this study the pressure criterion is set to be p v p p o p 5 k p a where p v and p o p are the vapor pressure and operating pressure respectively the corresponding regions are extracted using the polyhedral unstructured mesh adaption puma method in fluent the grid resolution in the hub region and propeller wing tip region is more increased as shown in the ddes g1 and ddes g2 respectively finally the ddes g2 grid is used to simulate the tvc the minimum grid size in the ddes g2 is 0 125 mm within the range of the grid size recommended by asnaghi et al 2018 fig 10 summarizes the entire numerical procedure including two preliminary simulations and one main simulation with their goals note that the steady rans simulations are also performed in the main simulation to refine grid resolution in a rotating grid region and to provide the initial condition for the ddes simulation 3 experimental methods experiments on cavitation inception and noise of the underwater propellers are performed in the large cavitation tunnel lct in the kriso the overall dimensions of the lct shown in fig 11 a are 60 0 m l 6 5 m w 19 8 m h those of the test section shown in fig 11 a and b are 12 5 m l 2 8 m w 1 8 m h more detailed information on the lct of the kriso can be found in the work by park et al 2016 fig 12 a shows the suboff submarine with the hsp17 and hsp38 installed in the test section of lct fig 12 b schematically presents the experimental setup including the noise measurement system the submarine is supported with two struts to secure structural stability however the effects of the struts on the inflow were found to be negligible at the propeller plane park et al 2019a a b k type 8105 hydrophone that is located under the floor of the test section is used to measure the radiated acoustic pressure the hydrophone is connected to the daq system with a frequency range up to 102 4 khz the measured noise spectrum is corrected using the transfer function procedure recommended by ittc jeong et al 2021 ittc 2017 the test conditions for the measurements are listed in table 6 here v is the inflow velocity in the test section n is the rotational speed of the propeller shaft σ n center is the cavitation number at the center of the propeller and α α s is the oxygen saturation that represents the air content in the water each measurement is conducted for 1 min with a sampling rate of 262 144 samples per second which ensures that the effect of instantaneous behavior is minimized the measured time series data is converted to the power spectral density psd using the hanning window with a bandwidth of 1 hz and 75 overlap 4 numerical results 4 1 verification of acoustic solver based on fw h acoustic analogy the acoustic problems are divided into three situations according to the relative motion of an observer or microphone and a target object to medium as shown in fig 13 one is fly over with stationary medium and observer but the source is stationary or moving the second is moving observer with a stationary medium an observer is mounted to the object and moves together the third is wind tunnel with a moving medium but stationary observer and source the moving observer and wind tunnel are essentially the same problems but farassat s 1a formulation does not directly consider the wind tunnel problem one standard practical method to deal with the wind tunnel problem is to transform the wind tunnel problem into the moving observer problem through algebraic treatments ghorbaniasl et al 2015 najafi yazdi et al 2011 weckmüller et al 2010 however some studies consider the wind tunnel problem directly using the fw h equation derived from the convective wave equation form in this study the fw h equation that can directly consider the wind tunnel problem is applied the acoustic solver based on the fw h equation used in this study is validated by applying it to the benchmark problem with the analytic solution najafi yazdi et al 2011 or other numerical results lockard 2002 the analytic solution for a point monopole source can be derived by using velocity potential and the acoustic properties such as acoustic pressure particle velocity vector and density fluctuation are expressed as follows 12 φ x t a 4 π r e x p i ω t r c 0 13 p x t ρ 0 t u 0 x 1 φ x t 14 u x t φ x t 15 ρ x t p x t c 0 2 a point monopole source is assumed to be a stationary source of ω l c 0 4 π 46 and a l c 0 0 01 in the region where the flow is moving at the speed of m u 0 c 0 0 5 the time data of two periods are used to predict the acoustic signal generated by the monopole source the permeable integral surface is constructed with cubic in the range of 5 l to 5 l in the three coordinate directions and the observer location is assumed to be at the 50l 0 0 the point monopole source is located at the 0 0 0 the observer permeable surface and source location are shown in fig 14 a and the analytic acoustic pressure field is shown in fig 14 b the comparison of the predicted acoustic pressure results with the analytic solution and other numerical results is presented in figs 15 and 16 the acoustic pressure obtained from the acoustic solver based on the permeable fw h integral equation is in excellent agreement with the other results in terms of the time history and the directivity of acoustic pressure as shown in fig 15 the acoustic pressure field predicted using the acoustic solver is also compared with the analytic solution in fig 16 there are again excellent agreements between the two results the validity of the acoustic solver is confirmed from these results 4 2 preliminary simulation i boundary layer flow on lct test section the preliminary simulation i is made with a focus on the accurate computation of boundary layer flow on the wall of the lct test section the velocity profiles predicted on the three locations that are the center points of the first fourth and seventh windows in the lct test section are compared with the results measured using the ldv fig 17 a shows the locations for the comparisons for the inflow velocities from 8 m s to 12 m s with a step of 2 m s fig 17 b c and d shows the compared results for three different inlet velocities at the three locations respectively it is well known that the boundary layer becomes thicker as it is convected downstream in a confined flow and the blockage effect accelerates the flow velocity to a higher velocity than the target velocity park et al 2019a therefore it is necessary to confirm whether these phenomena occur in both the experiment and simulation to ensure the validity of the simulation in the given grids it can be seen in fig 17 b c and d that the boundary layer thickness δ defined as the height where u u 0 99 increases as the flow goes downstream and the measured velocity profile closely follows the empirical turbulent velocity profile of the one seventh power law the incident flow into the lct test section in the experiment exhibits a more developed boundary layer flow because it passes through the converging section in front of the test section as shown in fig 11 a however because only the test section is considered as the simulation domain in the numerical approach some distance is required for the boundary layer flow to develop this is why the velocity profiles of the numerical results differ from the experimental results by more at the location of the 1st window than at the others as shown in fig 17 b to d park et al 2016 reported that this problem could be overcome by including the converging section as the simulation domain however it can be seen that the predicted velocity profiles follow the measured ones more closely as the flow goes downstream because the submarine body and the propellers are located near the 4th and 7th windows it is expected that the effects of the boundary layer of the test section wall are well resolved in the next preliminary simulation ii and the main simulation on the more from fig 17 b d the slower the inflow velocity is the smaller the difference between the simulation and the experiment the inlet flow velocity in the main simulation is 5 m s which is lower than the velocities considered in the preliminary simulation i and the difference between the experiment and the simulation is expected to be much smaller since the validity of grid resolution on the lct test section is verified from the preliminary simulation i the grid system on the lct test section is maintained with the same resolution as the preliminary simulation i in all subsequent simulations 4 3 preliminary simulation ii nominal wake field in this section the preliminary simulation ii focusing on the nominal wake field due to the sail and rudders of the submarine body is performed the validity of numerical results is confirmed by comparing the predicted results with the measured ones park et al 2019a first the total resistance of the suboff body is compared with the measured one ahn et al 2020 as the inflow velocity is varied from 2 m s to 12 m s the results are presented in fig 18 and table 7 there are fair agreements between the predicted and measured ones of which the maximum difference is within 5 the nominal wake field formed by wake flow due to the sail and rudders is compared with the measured one at the stern of the suboff body as shown in fig 19 the nominal wake field is monitored at x l oa 0 978 where the propeller rotating plane is located as shown in fig 19 a the location of x 0 denotes the submarine head there are good agreements between the two results from the wake field distribution as shown in fig 19 b and c the effects of the rudders located in the stern at 180 90 0 and 90 are clearly identified besides it can be found that the flow velocity reduction in the 90 location is most significant among the others at 0 180 and 90 the reason for this is the influence of the sail located above the head of the suboff body chase 2012 filip et al 2012 through the preliminary simulation ii the validity of the grid resolution around the suboff body is confirmed so that the grid system on the suboff body is maintained with the same resolution as the preliminary simulation ii in the following main simulations 4 4 main simulations tip vortex cavitation flow in this section the main simulations for cavitation flow on the hsp17 and hsp38 propellers are performed the steady rans simulation is first performed to set up the initial conditions for stable and fast convergence of the unsteady ddes simulation the inflow velocity and the propeller rotating speed are 5 m s and 25 rps respectively which are the same as the experimental conditions the time step is set to be 5 555 10 5 s for which the propeller rotates by 0 5 fig 20 shows the numerical results of vorticity magnitude on the cross sectional plane according to the used grids shown in fig 8 fig 20 a to d show the steady state single phase rans results obtained using the grids of the rans g1 to rans g4 whose resolutions are increased to improve the resolution of predicted numerical results and thus to accelerate the convergence of the unsteady two phase ddes results it can be seen from fig 20 a and b that the numerical result from the rans g2 grids of which the number is the most among the rans grids reveals a more resolved vortex structure than the initial grid of the rans g1 however the vortex structure s resolution in the rans g2 is identical to the result of rans g3 which has the second lowest number of grids from the result in fig 20 d it can be seen that the vortex strength of the rans g4 is maintained along the more downstream direction than the other results the numerical result obtained from the rans g4 is used as the initial condition for the unsteady ddes simulations fig 20 e and f show the unsteady two phase ddes simulation results obtained from the ddes g1 and the ddes g2 respectively it can be seen that the propeller wing tip vortex in the ddes g2 grid system exhibits a more highly resolved complex structure with a higher magnitude than that in the ddes g1 grid system besides the periodically detached vortex structure from the hub can be identified being similar to the von karman vortex the vortex structure is found to be rapidly dissipated as it approaches the right end in a downstream direction in fig 20 f because the right end is the boundary between the rotating grid system with higher grid resolution into the fixed grid system with lower grid resolution the predicted tvc pattern according to the types of grid systems used is shown in fig 21 the tvc pattern is depicted by using an iso surface with a volume fraction of 0 1 hu et al 2021 it can be seen that the tvc is more developed in the ddes g2 grids than that in the ddes g1 grids in this study the ddes g2 grids which show the most resolved tvc shape are used as the final grid system when the propeller passes through the wake flow regions which are shown in fig 19 the reduced axial flow velocity is incident into the propeller the decrease in the incident axial flow velocity at the same rotational speed causes the increase in the angle of attack aoa of the flow incident on the propeller as shown in fig 22 the increase in the aoa causes a strong vortex and thus induces cavitation more easily it can be seen from fig 21 that when the propeller passes the positions of 0 90 180 and 90 shown in fig 19 cavitation occurs in both propellers to illustrate these phenomena more clearly fig 23 shows the distribution of axial velocity components on the rotating propeller plane clear interaction between the wake flow field and the propeller blades can be seen at the positions of 0 90 180 and 90 fig 24 compares the predicted cavitation flow results with the measured ones the cavitation patterns in the numerical results are visualized by using the iso surface of a volume fraction of 0 1 it is seen that there are fair agreements between the numerical and experimental results on the more the cavitation patterns predicted at the blade tip and the hub are more active in the hsp17 propeller than in the hsp38 propeller this predicted trend is the same as the measured one these results confirm that the cavitation is suppressed as the skew angle increases the thrust coefficient k t which is the hydrodynamic performance indicator of a propeller is defined as follows 16 k t t ρ n 2 d 4 t thrust here ρ n and d denote the liquid density rotational speed and propeller diameter table 8 compares the predicted coefficients for the hsp17 and hsp38 propellers with the measured ones it can be confirmed that the numerical results agree well with the measured results the maximum difference between the two results is within 7 4 5 tip vortex cavitation noise in this study the quadrupole corrected fw h equation is applied to predict the tvc noise and the location of permeable integral surfaces of eqs 7 10 is presented in fig 25 the permeable integral surface is constructed to include the most critical flow noise sources within the rotating grid system it can be seen that the vortex structures pass through the integral surface because the vortex strength is maintained due to high grid resolution and high order numerical schemes as shown in fig 25 a however it has been reported that the vortex passing through the integral surface has an adverse effect on the accuracy of the fw h equation therefore the quadrupole corrected fw h equation is used as described in detail in section 2 2 3 fig 25 b shows the cylindrical permeable integral surface used in this study hydrodynamic pressure on the integral surface is presented in fig 25 c the sampling rate determined by the numerical time step size is 18 000 hz and the frequency resolution is 12 hz determined by the total time length for the signal processing which is slightly longer than that it takes for the propeller to spin twice the hanning window is applied to prevent leakage errors the maximum frequency for the analysis is set to be 6 khz that is two third of the nyquist frequency to avoid aliasing during the signal processing generally it is known that the tvc increases the broadband noise level in a frequency range above 1 khz and the sheet and cloud cavitation contribute to tonal noise components like the blade passing frequency bpf noise carlton 2012 therefore the acoustic spectrum range is set to be in a range higher than 1 khz the acoustic pressure is measured at the location indicated in fig 11 b and the numerical prediction is also carried out at the same position the power spectral density predicted for the hsp17 and hsp38 propellers are compared with the measured ones in fig 25 overall pwl levels and the difference between the two propellers are listed in table 9 there are good agreements between the two results regarding spectral shape overall levels and reduction levels ku et al 2020a 2020b 2020c revealed that the radiated acoustic spectral levels in the frequency range higher than 1 khz increased as the strength of tvc increases as described in the previous section the tip vortex strength of the hsp38 is less than that of the hsp17 accordingly the acoustic psd levels of the hsp38 are predicted to be less by 2 9 db than that of the hsp17 the same trend is confirmed in the measured spectrum although the measured reduction of 3 0 db is slightly higher than the predicted one however the 6th 12th harmonic components of the bpf noise of the hsp17 and hsp38 propellers are over estimated than the measured ones the over estimation seems to be due to slight overestimation of the sheet cavitation contributing more to the tonal noise components fig 26 c compares the same results in terms of the one third octave band spectrum the band levels in a low frequency region are overestimated due to strong tonal components but the skew effect observed in the experimental result is well reproduced by the numerical results the maximum difference in the 1 3 octave band levels between the two results is lower than 8 db the effects of different integral surfaces on the noise spectrum computed using the quadrupole corrected fw h equation are investigated fig 27 a shows the three different integral surfaces used for the computation of the fw h equation the integral surfaces are varied by changing the location of the downstream surface as 0 48d 0 65d and 0 82d all of which are still within the rotating grid region the corresponding acoustic psds predicted using the different integral surfaces are compared in fig 27 b where d denotes the propeller diameter as shown in table 3 note that the predictions shown in fig 26 were carried out using the integral surface whose downstream surface is located at 0 65d the intense vortex structure penetrates the downstream surface of the smallest permeable integral volume at 0 48d and the vortex structures gradually weaken along the downstream direction and pass through the source surfaces at 0 65d and 0 82d generally when the acoustic source such as the vortex structure passes through the integral surface spurious noise can be generated due to a lack of quadrupole term lopes et al 2017 ku et al 2018 cho et al 2020 this non physical noise can be suppressed using the quadrupole correction as explained in section 2 2 3 as shown in fig 27 b there are no noticeable differences between the predicted spectra table 10 lists the predicted overall noise levels whose differences are also within 1 db 5 conclusions in this study the tip vortex cavitation and noise of two propellers with different skew angles were numerically investigated using the hybrid computational hydro acoustic technique which consisted of the delayed detached eddy simulation with adaptive grid refinement method and the fw h integral equation careful attention was paid to the reproduction of experimental conditions in the corresponding numerical simulation which were the effects of the boundary layer on the lct test section wall and the nominal wake field due to a submarine body the preliminary simulations i and ii were carried out to investigate these effects after close reproduction of these two effects was confirmed the main simulations were carried out to predict the cavitation flow and noise of the hsp17 and hsp38 propellers installed on the suboff submarine body the effects of the nominal wake field and skew angle on cavitation occurrence and its noise were clearly shown in the numerical simulations and its validity was confirmed through the comparison of the predicted results with the measured ones through the comparison of the result obtained from the preliminary simulation i with the measured data it was confirmed that the boundary layer thickness on the wall of the lct test section gradually increased as the inlet flow moved in the downstream direction the boundary layer development which is frequently observed in a confined flow such as tunnel flow induces the blockage effect that increases the maximum flow velocity as the flow is convected in the downstream direction the reproduction of boundary layer flow in the numerical simulation was confirmed by comparing the predicted boundary layer profiles with the measured ones the preliminary simulation ii was performed on the darpa suboff submarine without a propeller the total resistance of the submarine body predicted for various inflow velocities was compared with the measured ones there were good agreements between the two results of which the maximum difference was less than 5 in addition the nominal wake field predicted at the stern was compared with the measured ones there were again excellent agreements between the two results both the numerical and experimental results revealed that the clear wake flows formed due to the rudders and sail of the submarine body after the close reproduction of measured inlet disturbance in the numerical simulations was confirmed the main simulations were carried out to investigate the cavitation flow and noise of the underwater propellers for effective and high resolution reproduction of tip vortex cavitation adaptive grid refinements were carried out on the rotating grids including the propellers six steps of grid refinements were made to reach the final grid system the first four steps of simulations which used the rans g1 to rans g4 grid systems were performed using the steady rans simulation of single phase hydrodynamic flow and the last two steps of simulations using the ddes g1 and ddes g2 grid systems were performed using the unsteady ddes simulation of two phase flow the ddes g2 grid system with the highest spatial resolution along the vortex trajectory was selected as the final grid system where the predicted tvc patterns for the hsp17 and hsp38 propellers show good agreements with the measured ones in addition the thrust coefficient of the propellers was compared with the measured data there were again good agreements between two results of which the difference is within 7 because a relatively low velocity flow is incident to the propellers at the angular positions corresponding to the locations of rudders and sail at the submarine stern the local angle of attacks of the incident flow at those positions were relatively increased the higher aoa induced the tvc as well as sheet cavitation in both the hsp17 and hsp38 propellers this result was observed in both the numerical and experimental results based on the unsteady ddes simulation results the acoustic sources were extracted by constructing the permeable integral surface in the rotating grid system with high spatial resolution and the cavitation noise is predicted by applying the quadrupole corrected fw h integral equation the predicted acoustic psd spectrum showed good agreement with the measured one besides the present numerical methods showed that the higher skew angle of the propeller blades induces lower cavitation noise which was confirmed by the experimental result the acoustic psds predicted using different permeable integral surfaces were compared revealing that there were no noticeable differences between them based on all of these results the present numerical methodology is expected to be used for the future development of high performance and low noise underwater propellers funding this research was funded by defense acquisition program administration and agency for defense development authors contributions c c provided the basic idea for this study and the overall numerical strategies g k and j c carried out the numerical simulations and worked on the analysis of numerical results h s constructed the experimental environment and conducted the experiments declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was carried out as a project of future submarine low noise propeller research laboratory of kriso supported by defense acquisition program administration and agency for defense development 
20204,in this study the hybrid computational hydro acoustics cha method is applied to predict hydrodynamic noise due to tip vortex cavitation tvc of underwater submarine propellers the hybrid cha approach consists of two sequential methods delayed detached eddy simulation ddes technique with adaptive mesh refinement method and the ffowcs williams and hawkings fw h equation the former is utilized for accurate prediction of tvc of underwater propellers and the latter is used for efficient prediction of hydro acoustic pressure due to cavitating flow the target submarine and propeller are the darpa suboff submarine and two high skew propellers with skew angles of 17 and 38 the propellers are designed to investigate the effects of skew angle on tvc and its noise the corresponding experiments are performed in the large cavitation tunnel lct of the korea research institute of ships and ocean engineering kriso the two preliminary simulations are carried out to confirm the close reproduction of the experimental conditions in the main simulations first the flow through the lct test section is simulated to confirm the accurate reproduction of the wall boundary layer its validity is confirmed by comparing the predicted boundary layer profiles with the measured results second the flow over the darpa suboff submarine without a propeller in the lct test section is simulated to confirm the accurate prediction of the inflow distortion originating from the boundary layer flow of the submarine body its validity is also confirmed by comparing the predicted nominal wake field with the measured one after the close reproduction of these two effects is confirmed the cavitating flow of the propellers installed to the darpa suboff submarine body is simulated by using the ddes technique combined with adaptive mesh refinement and the tvc noise is predicted by applying the quadrupole corrected fw h equation to the surfaces enclosing the propellers the predicted tvc of the propeller closely follows the measured one the numerical and experimental results capture the tvc induced by the wake flows due to the submarine body s rudders and sail the predicted hydro acoustic pressure spectra due to the propellers cavitating flow also show excellent agreements with the predicted ones besides both the numerical and experimental results confirm that the lower noise is generated by the propeller with a higher skew angle keywords underwater propeller noise tip vortex cavitation cavitation noise darpa suboff submarine delayed detached eddy simulation acoustic analogy 1 introduction the increase in worldwide shipping has adversely affected the underwater ecosystem by disturbing the natural acoustic signal with underwater noise radiated from the surface and underwater vehicles park and yoon 2017 sohn et al 2015 chou et al 2021 the underwater noise generated by the ships can be classified into machinery noise and flow noise according to noise generation mechanism and the flow noise due to underwater propellers is recognized as one of the most dominant noise sources a lot of studies have been performed on marine propeller noise to reduce acoustic signature and more recently to reduce the influence of maritime noise on the environment lloyd et al 2015 underwater radiated noise by a propeller can be divided into two parts non cavitation and cavitation noise the primary sources of non cavitation noise are dipolar sources due to surface pressure on propeller blades and quadrupole sources such as tip vortex structure wang et al 2018 however it is well known that when cavitation occurs on a propeller the noise level is increased significantly in a broad high frequency range van oossanen 1974 the sheet and cloud cavitation which forms on the propeller surface are synchronized with the blade rotating frequency and increased the tonal noise ye et al 2012 while the tip vortex cavitation tvc occurs along the tip vortex trajectory of a propeller and contributes to the broadband noise in a frequency range above 1 khz lee et al 2013 therefore manufacturers and developers in related industrial fields are developing propellers that can operate at higher speeds without cavitation thereby developing surface ships and submarines of high hydrodynamic and low noise performances specifically the vital cavitation performance index is the cavitation inception speed cis which is defined as the speed at which cavitation starts to occur in the propeller the cis of a propeller usually depends on its tvc characteristics because the tvc is the first cavitation type that the propeller experiences as its rotating speed increase lee et al 2013 there are two ways to assess the occurrence of tvc and thus to determine the cis the optical and acoustic methods seol 2013 seol and kim 2018 in the optical method the high speed camera is used to capture cavitation shape and the cavitation size is used as a criterion to determine the cis in the acoustic method the noise spectrum is monitored as the operating speed increases and the abrupt increase in the spectrum is used as an indicator to determine the cis it is usually difficult to perform an experiment using a full scale model and instead the scaled model is widely used to evaluate its hydrodynamic and noise performances in an early stage of development however it is challenging to extrapolate the scaled results on the cis to the full scale due to the multi physical phenomena involved in the extrapolation ku et al 2020a 2020b 2020b instead numerical methods can be utilized to assess the tvc the numerical approaches used to predict the tvc can be classified into the lagrangian and eulerian approaches the lagrangian approach is based on the bubble dynamics equations applied to nuclei initially distributed in the inflow region the subsequent volume and location of each nucleus are tracked by solving the bubble dynamics equations on the hydrodynamic flow field obtained using the eulerian method using the lagrangian method ku et al 2020a 2020b predicted the tvc and tvc noise on the naca 16 020 elliptic wing and showed that the initial concentration of nuclei significantly affected the predicted cavitation pattern and its noise hsiao et al 2003 2017 hsiao and chahine 2008 and ma et al 2015 2018 also developed the lagrangian methods based on bubble dynamics theory using the one way and two way coupled methods with the eulerian approach they showed that the complex cavitation phenomena such as the merging stretching and collapse of bubbles could be simulated however it is still difficult to reproduce the experimentally observed pattern of the noise spectrum due to tvc using the lagrangian approaches the eulerian approach simulates the cavitation flow field using the cfd techniques based on the finite volume methods various cfd equations and techniques such as the rans the detached eddy simulation des and the large eddy simulation les have been used the unsteady hydrodynamic flow field obtained from the eulerian approaches is used as noise sources to predict the cavitation noise by using the acoustic analogy such as the ffowcs williams and hawkings fw h equations extended from the lighthill s acoustic analogy ffowcs williams and hawkings 1969 lighthill 1954 this kind of numerical method based on the sequential application of cfd and acoustic analogy can be classified as a hybrid computational underwater acoustic cha approach which corresponds to the hybrid computational aeroacoustic caa methods widely used in the related engineering fields especially the eulerian approach combined with the fw h equation has been successfully used in a wide range of applications from fan aerodynamic noise and airfoil cavitation noise heo et al 2011 kim et al 2017 2018 park et al 2019b ren et al 2013 seol et al 2005 applied the potential based panel method to simulate the propeller s cavitation flow and used the fw h acoustic analogy to predict the sheet cavitation noise ghassemi 2009 reported that the skew angle was a vital design parameter used to reduce the hydrodynamic drag showing that thrust and torque decreased as the skew angle increased in the non uniform wake flow the sheet cavitation flow was also investigated using the rans solver combined with the homogeneous mixture approximation and the merkle cavitation model ha et al 2018 kim et al 2017 2018 li et al 2018 predicted the cavitation flow and cavitation noise at the design speed condition using the des technique and the fw h equation the predicted noise spectrum was compared with the measurement data on the full scale ship bulut and ergin 2019 performed the rans des and les simulations on a circular cylinder and applied the fw h equation for cavitation noise prediction they reported that the des fwh and omega fwh methods are the most efficient numerical procedure in terms of accuracy and numerical cost gorji et al 2019 compared the hydrodynamic and noise performances of propellers according to the skew angle variation and reported that the noise level decreased up to 45 but the noise level increased in the case of a skew angle of 75 although there have been many studies to simulate the cavitation phenomenon using various numerical methods the accurate simulation of tvc remains one of the most challenging problems due to the complex physical mechanisms involved in its generation and the highly demanding numerical cost for resolving the tip vortex core with enough grids in this study a hybrid cha method is used to predict flow noise due to the tvc of underwater submarine propellers the hybrid cha approach consists of two sequential methods the delayed detached eddy simulation ddes technique combined with the adaptive grid refinement method for accurate simulation of tvc flow of underwater propellers and the quadrupole corrected fw h integral equation for prediction of acoustic pressure due to the tvc to highlight the effectiveness of current numerical methods a full submarine body equipped with a propeller is targeted the darpa suboff is used as a submarined body and two kinds of underwater propellers are designed to investigate the effects of skew angles two propellers have the same geometrical parameters except for the skew angles of 17 and 38 being named hsp17 and hsp38 for convenience respectively the cavitation flow and noise of the hsp17 and hsp38 installed to the darpa suboff body are predicted and compared the corresponding experiments are also performed in the large cavitation tunnel lct of the korea research institute of ships and ocean engineering kriso the validity of the numerical methods is confirmed by comparing the predicted results with the measured ones the main contribution of this paper is three fold first the hybrid cha method is presented to make efficient and reliable predictions of the tvc noise of marine propellers with full consideration of the entire hydrodynamic flow field of a submarine body second the effects of the nominal wake field formed by the boundary layer flow over the rudders and sail of the submarine body on the tvc are analyzed the wakes in the nominal wake field are found to enhance the cavitation on the propeller surface third the effects of the skew angle of an underwater propeller on tvc inception and noise are evaluated quantitatively both numerical and experimental results commonly revealed that the propeller with a higher skew angle induces weaker tvc and thus produces less flow noise this paper is structured as follows section 2 presents the geometries of the target submarine body and propellers computational domains and numerical methods used to investigate the tvc flow and noise in section 3 the experimental methods are described to visualize the cavitation flow and measure the hydro acoustic pressure due to cavitation in section 4 three types of numerical simulation results are presented first the boundary layer flow on the lct wall is predicted using the steady rans solver the predicted boundary layer profiles are compared with the measured ones to confirm the accurate reproduction of the inflow field to the tested target body second the hydrodynamic flow over the submarine body without a propeller is simulated using the steady rans solver the nominal wake field originating from the boundary layer flow on the submarine body is compared with the measured one to confirm the close reproduction of the inflow disturbance to the propellers finally the tvc flow field is predicted for the darpa suboff submarine body with high skew propellers using the ddes technique combined with adaptive mesh refinement procedure and the tvc noise is predicted by using the fw h acoustic analogy the validity of numerical results is confirmed by comparing the predicted tvc pattern and noise with the measured ones the effects of skew angle are also evaluated in terms of tvc strength and noise in section 5 the main results are summarized 2 numerical methods in this study two preliminary simulations are carried out to confirm the accurate computation of inflow conditions to the target propellers the boundary layer flow on the wall of the lct test section and the wake flow from the suboff submarine body the first preliminary simulation is carried out for flow passing through the lct test section in kriso without an immersed body the result obtained from this simulation is used to ensure enough resolution of grids near the wall through the comparison of the predicted boundary layer profiles with the measured ones the second preliminary simulation is performed considering only the suboff submarine body without a propeller in the test section of lct to characterize the wake flow due to the hull and rudders of the submarine body and confirm the validity of the numerical solutions through its comparison with the experimental results these two preliminary simulations are performed using the steady rans simulation the main simulations on the tvc flow of the propellers installed to the suboff submarine body are then performed using the ddes techniques combined with the adaptive grid refinement process finally cavitation noise prediction is made by applying the quadrupole corrected fw h integral equation to the cavitation flow field obtained from the ddes results the geometrical conditions of simulations made in this study are schematically presented in fig 1 note that the steady rans simulation is also performed to set up the initial condition for the main unsteady ddes simulations 2 1 geometries of target submarine body and propellers the outer boundary geometry of the entire computational domain is constructed to be the same as the test section of the lct in kriso the body shape of the target submarine is modeled from the darpa suboff submarine groves et al 1989 roddy 1990 fig 2 depicts the geometries of the lct test section and the darpa suboff submarine with the boundary conditions applied for subsequent simulations the detailed dimensions are presented in table 1 the inlet velocity and outlet pressure are set as the inlet and outlet boundary conditions the background pressure is specified with the operating pressure given from the experiment the no slip boundary condition is applied on the surface wall of the lct test section the submarine body and the underwater propellers the detailed boundary conditions for all simulations are shown in table 2 the two propellers are designed and manufactured to investigate the effect of skew angle one has a skew angle of 17 and the other 38 named hsp17 and hsp38 respectively the detailed shapes and the related dimensions of hsp17 and hsp38 are presented in fig 3 and table 3 respectively the rotational velocity of the propellers is set to be 25 rps to simulate the propeller s rotating motion the moving reference frame mrf and the sliding mesh techniques are applied for the steady rans and the unsteady ddes simulations respectively 2 2 governing equations and numerical schemes before the main numerical simulations are performed for predicting the tvc flow and noise of the target propellers the two preliminary simulations i and ii are carried out to confirm the grid resolutions which enable accurate predictions of the boundary layer flow on the lct test section and the wake flow due to the suboff body respectively the steady rans equations are used as the governing equations for these preliminary simulations however since the accurate simulation of cavitation flow and noise requires high order accuracy in time and space the unsteady ddes is used in combination with the homogeneous mixture assumption for modeling two phase flow in the main simulation then cavitation noise is predicted using the fw h integral equation with input from the unsteady ddes result the governing equations for hydrodynamic flow are numerically solved using the ansys fluent v20 1 and the fw h integral equation is solved using the in house code of which the validity is confirmed through its application to a benchmark problem in this study 2 2 1 reynolds averaged navier stokes equation rans the three dimensional incompressible steady rans equations are numerically solved in the preliminary simulations to check the numerical accuracy in terms of the boundary layer flow on the test section and the nominal wake field due to the submarine body the continuity and momentum equations are written as follows 1 ρ u i x i 0 2 ρ u i u j x j ρ g i p x i x j μ u i x j u j x i 2 3 δ i j u k x k x j ρ u i u j here p ρ u and μ denote the pressure density velocity and dynamic viscosity for fluid the subscript i means the i directional component in a cartesian coordinate δ i j is a kronecker delta function that is 1 for i j and 0 for i j and ρ u i u j is the reynolds stress tensor which needs to be solved by using a turbulence model the spatial derivative is discretized using the 2nd order upwind scheme based on the pressure based semi implicit method for pressure linked equations simple where the continuity and momentum equations are sequentially solved the operating pressure liquid density ρ l and liquid dynamic viscosity μ l are set to be 196 860 pa 999 6 kg m3 and 1 275 10 5 kg m s respectively non uniform wake flow reduces the propulsion performance of a propeller by decelerating the flow velocity at the stern the wake flow is affected by the boundary layer on the suboff body which is also affected by the boundary layer on the lct test section wall a turbulence model for this simulation needs to properly deal with adverse pressure gradient and flow separation within the boundary layer to simulate the boundary layer flow accurately the k ω sst turbulence model menter 1994 is used in the rans applying the k ω and k ε models to the regions near and away from the wall respectively the rans simulation results are also used to determine the initial conditions and grids for the subsequent unsteady ddes simulation described below 2 2 2 delayed detached eddy simulation ddes for the main simulation the three dimensional incompressible unsteady ddes simulation is performed the schnerr and sauer asnaghi et al 2018 schnerr and sauer 2001 lloyd et al 2017 yilmaz et al 2019 lidtke et al 2016 model is used for the prediction of cavitation with a homogeneous mixture assumption to improve numerical accuracy at the moderate numerical cost the des was devised by using the numerical strategy where the unsteady rans urans is used for the boundary layer flow near the wall and the les is used in the flow region outside the boundary layer region shur et al 1999 spalart et al 1997 strelets 2001 however because the des revealed inaccurate predictions in the thick boundary layer and the shallow separation region the ddes technique was developed to improve the des technique by delaying the les region into the boundary layer inner region gritskevich et al 2012 kim 2017 shur et al 2018 spalart et al 2006 the conceptual diagram for the des and ddes is shown in fig 4 the governing equations for the ddes are written in the form 3 ρ k t ρ u i k x i x i μ σ k μ t k x i p k ρ k 3 l d d e s 4 ρ ω t ρ u i ω x i x i μ σ k μ t ω x i 2 1 f 1 ρ σ ω 2 1 ω k x i ω x i α ρ μ t p k β ρ ω 2 5 μ t ρ a 1 k max a 1 k f 2 s here k ω μ and μ t denote the turbulent kinetic energy specific dissipation rate molecular viscosity and turbulent viscosity respectively l d d e s is the blending function based on the rans turbulent length scale and les grid length scale the other variables denote the constants used in the ddes model the numerical schemes used to discretize eqs 3 5 are the implicit bounded 2nd order scheme for the time derivative the bounded 2nd order discretization for the momentum equation the quadratic upstream interpolation for convective kinematics quick scheme for the volume fraction continuity equation and the 2nd order upwind scheme for the turbulent transport equations the maximum internal number of iterations is 20 and the residual of convergence criterion is 10 3 the absolute pressure p v density ρ v and dynamic viscosity μ v for vapor are set to be 1300 pa 9 925 10 3 kg m3 9 48844 10 6 kg m s respectively the liquid quantities are the same as those used in the preliminary simulations and the operating pressure for the main simulation is set to be 50 kpa 2 2 3 ffowcs williams and hawkings fw h acoustic analogy to predict the acoustic pressure due to tvc flow the fw h equation is used for an acoustic solver with input from the unsteady ddes simulation results the fw h equation is written as follows 6 4 π p x t t s q y τ r 1 m r d s y x i s f i y τ r 1 m r d s y 2 x i x j v t i j y τ r 1 m r d y where q ρ u i u i ρ 0 u i n ˆ i f i ρ u i u j u j p δ i j n ˆ i t i j ρ u i u j p p o c o 2 ρ ρ 0 δ i j u j 1 ρ ρ o v j ρ u j ρ o x and y denote the observer and source locations respectively and r x y is the distance between them here ρ p and u are density pressure and velocity of flow respectively and v and n ˆ mean the source surface velocity and unit normal vector perpendicular to the source surface respectively mach number m is defined as m v c where c is the speed of sound the subscript o and superscript denote mean and fluctuation properties respectively the fw h equation predicts compressible acoustic pressure due to three noise sources monopole dipole and quadrupole sources which are the first second and third terms respectively in the right side of eq 6 however the quadrupole term expressed using the lighthill stress tensor tij is generally ignored because its acoustic efficiency is much less than the other sources in low mach number flows for this reason the permeable fw h equation including only the surface sources is applied to predict cavitation noise farassat s 1a formulation where the monopole noise source is expressed as the thickness noise p t and the dipole noise source is expressed as the loading noise p l are used farassat 2007 singer et al 2003 in the form 7 4 π p t x t f 0 ρ 0 u n u n r 1 m r 2 r e t d s f 0 ρ 0 u n r m r c 0 m r m 2 r 2 1 m r 3 r e t d s 8 4 π p l x t 1 c 0 f 0 l r r 1 m r 2 r e t d s f 0 l r l m r 2 1 m r 3 r e t d s 1 c 0 f 0 l r r m r c 0 m r m 2 r 2 1 m r 3 r e t d s where u j 1 ρ ρ 0 v j ρ u j ρ 0 l i p i j n ˆ j ρ u i u n v n here the superscript means the source time derivative and the subscript n and r denote the normal and observer directional components computed using the dot product the ret means the integration at the retarded time τ t x y c the permeable or flow through integral surface in the kirchhoff formulation must be located in the linear region here the linear means that there are no other sources in the outer region of the integral surface and the source does not pass through the integral surface so that the acoustic information on the integral surface reaches the observer point without any interference when the permeable surface is in the nonlinear region the kirchhoff formulation shows a very non physical result on the other hand the fw h equation shows a physically valid result because it is derived from the navier stokes equations including all aerodynamics mechanisms brentner and farassat 1998 however it is still known to generate spurious noise when the source penetrates the integral surface unless the quadrupole term in the fw h equation is considered lockard and casper 2005 lopes et al 2017 wang et al 1996 this spurious noise can be corrected using the quadrupole correction term without volumetric integral ikeda et al 2012 2016 2017 the quadrupole correction term p q is expressed as follows 9 4 π p q x t 1 c 0 2 s 1 1 m r d t i j r ˆ i r ˆ j r 1 m r d 2 r e t s u c n ˆ d s where m r d u d r ˆ c and u d u c u here c r ˆ and u c are the sound speed displacement vector from a source to an observer and eddy convective velocity respectively then the quadrupole corrected acoustic pressure can be written in the form 10 p x t p t x t p l x t p q x t equation 10 is used for acoustic computations in this study 2 3 grid refinement procedure this section presents the grid refinement strategy for the simulations for the lct test section the suboff body and the propellers the commercial tool of the ansys fluent meshing is used to generate the grids and the cutcell grid technique is applied to generate the orthogonal grid in the unstructured grid system a prism layer is used in the regions near the test section wall and the suboff body surface to accurately calculate the high velocity gradient in the boundary layer the grids used for the preliminary simulations i and ii are presented in figs 5 and 6 respectively the y distributions are around 1 5 and 1 6 note that the y value lower than 5 is recommended for the k ω sst turbulence model to resolve boundary layer flow in a viscous sublayer region salim and cheah 2009 the detailed specifications for the grid sets are presented in table 4 the accurate prediction of tvc using numerical methods based on finite discretization formula derived from original differential equations is very challenging due to artificial numerical damping caused by truncation errors accompanying the finite discretization process and the round errors accumulating during iteration processes these errors can be reduced by applying high order numerical schemes on high resolution grids but at a prohibitive numerical cost ku et al 2020b applied a family of grids consisting of 3 6 13 5 27 and 54 grids located inside the vortex core to simulate wing tip vortex in a single phase problem and showed that the vortex dissipation is suppressed in the cases using more than 27 grid points inside the vortex core asnaghi et al 2018 2020 applied the grids of sizes between 0 05 mm and 0 2 mm to simulate the tvc and reported that at least 32 grid points were required inside the vortex core to capture the tvc for the 2nd order scheme accurately yilmaz et al 2019 used 2 3m grids with the adaptive grid refinement technique for a propeller in open water to simulate tvc and reported that more than 100 m grids are required to obtain the same flow field pattern if the adaptive grid refinement technique is not applied therefore from a practical point of view efficient grid strategy is required to simulate tvc accurately at a moderate numerical cost which enables its applicability to practical problems in this study the adaptive grid refinement method where grid resolution is locally increased in the region where the tvc occurs is used in combination with the rans and ddes solvers fig 7 shows the entire grids for the main simulation the grid refinement is made to the rotating region including the target propellers as shown in fig 7 a the grid type on the propeller surface is a polygonal grid as shown in fig 7 b the volumetric rotating region is constructed using the poly hexcore type grids six types of grid systems are used through the grid refinement procedure the cross sectional views of the grids from rans g1 to ddes g2 are shown in fig 8 the total number of each grid type is listed in table 5 note that the y values are the same for all the grid types since the grid resolution in the vortex core region in the flow field not the wall surface is refined therefore the y values remain similar to those in the preliminary simulation ii the grid types are divided into two groups which are used for the rans and ddes simulations respectively the main unsteady simulations based on the ddes techniques with sliding meshes are performed with initial condition obtained from the steady rans simulation performed with mrf technique to ensure stable and fast convergence of the unsteady simulations the grids used for the rans and ddes are named as the rans g and ddes g respectively and a higher number attached to the names means denser grids first the rans g1 is used to capture the initial vortex structure near the propeller blade tip and find vortex trajectories along downstream because the vortex structure may be dissipated quickly during its convection along the downstream direction due to numerical damping the rans g2 grid is used to simulate the vortex structure of the propeller blade s tip and hub along the downstream direction with more resolved meshes the number of grids in the rans g2 is much higher than that of the rans g1 approximately by 4 3 times several properties have been used to determine how well to resolve the vortex structure with given meshes such as minimum pressure vorticity q criterion and λ 2 criterion jeong and hussain 1995 ku et al 2020b in this study the minimum pressure is used to determine the location and strength of the vortex core center the related formula used to define vortex core curves is written as 11 r x a e b x c e d x y x r c o s θ 0 k x z x r sin θ 0 k x where k 2 π λ λ x n 1 x 1 θ 0 the angle of initial blade location eq 11 is used to identify the local region for more grid clustering fig 9 presents the adaptive grid refinement procedure from the predicted flow field result the radius of the vortex trajectories r x in eq 11 is determined as shown in fig 9 a and then the vortex trajectories in the form of y x z x in eq 11 are identified as shown in fig 9 b the grid resolution in the region containing the vortex trajectory is increased as shown in fig 9 c the rans g3 is obtained from the rans g2 by using the prescribed procedure then the tip vortex strength predicted using the rans g3 is checked to reproduce the required pattern in this study one more grid refinement procedure is applied to obtain the rans g4 from the rans g3 note that the number of total grids to construct the rans g3 and the rans g4 are both less than that of rans g2 the unsteady ddes simulation is then started from the steady rans result based on the rans g4 as the initial condition the subsequent regions for more grid refinement are determined by using pressure criterion satisfying inequality to capture the tip vortex cavitation with sufficient grid resolution without excess grids as shown in fig 9 d in this study the pressure criterion is set to be p v p p o p 5 k p a where p v and p o p are the vapor pressure and operating pressure respectively the corresponding regions are extracted using the polyhedral unstructured mesh adaption puma method in fluent the grid resolution in the hub region and propeller wing tip region is more increased as shown in the ddes g1 and ddes g2 respectively finally the ddes g2 grid is used to simulate the tvc the minimum grid size in the ddes g2 is 0 125 mm within the range of the grid size recommended by asnaghi et al 2018 fig 10 summarizes the entire numerical procedure including two preliminary simulations and one main simulation with their goals note that the steady rans simulations are also performed in the main simulation to refine grid resolution in a rotating grid region and to provide the initial condition for the ddes simulation 3 experimental methods experiments on cavitation inception and noise of the underwater propellers are performed in the large cavitation tunnel lct in the kriso the overall dimensions of the lct shown in fig 11 a are 60 0 m l 6 5 m w 19 8 m h those of the test section shown in fig 11 a and b are 12 5 m l 2 8 m w 1 8 m h more detailed information on the lct of the kriso can be found in the work by park et al 2016 fig 12 a shows the suboff submarine with the hsp17 and hsp38 installed in the test section of lct fig 12 b schematically presents the experimental setup including the noise measurement system the submarine is supported with two struts to secure structural stability however the effects of the struts on the inflow were found to be negligible at the propeller plane park et al 2019a a b k type 8105 hydrophone that is located under the floor of the test section is used to measure the radiated acoustic pressure the hydrophone is connected to the daq system with a frequency range up to 102 4 khz the measured noise spectrum is corrected using the transfer function procedure recommended by ittc jeong et al 2021 ittc 2017 the test conditions for the measurements are listed in table 6 here v is the inflow velocity in the test section n is the rotational speed of the propeller shaft σ n center is the cavitation number at the center of the propeller and α α s is the oxygen saturation that represents the air content in the water each measurement is conducted for 1 min with a sampling rate of 262 144 samples per second which ensures that the effect of instantaneous behavior is minimized the measured time series data is converted to the power spectral density psd using the hanning window with a bandwidth of 1 hz and 75 overlap 4 numerical results 4 1 verification of acoustic solver based on fw h acoustic analogy the acoustic problems are divided into three situations according to the relative motion of an observer or microphone and a target object to medium as shown in fig 13 one is fly over with stationary medium and observer but the source is stationary or moving the second is moving observer with a stationary medium an observer is mounted to the object and moves together the third is wind tunnel with a moving medium but stationary observer and source the moving observer and wind tunnel are essentially the same problems but farassat s 1a formulation does not directly consider the wind tunnel problem one standard practical method to deal with the wind tunnel problem is to transform the wind tunnel problem into the moving observer problem through algebraic treatments ghorbaniasl et al 2015 najafi yazdi et al 2011 weckmüller et al 2010 however some studies consider the wind tunnel problem directly using the fw h equation derived from the convective wave equation form in this study the fw h equation that can directly consider the wind tunnel problem is applied the acoustic solver based on the fw h equation used in this study is validated by applying it to the benchmark problem with the analytic solution najafi yazdi et al 2011 or other numerical results lockard 2002 the analytic solution for a point monopole source can be derived by using velocity potential and the acoustic properties such as acoustic pressure particle velocity vector and density fluctuation are expressed as follows 12 φ x t a 4 π r e x p i ω t r c 0 13 p x t ρ 0 t u 0 x 1 φ x t 14 u x t φ x t 15 ρ x t p x t c 0 2 a point monopole source is assumed to be a stationary source of ω l c 0 4 π 46 and a l c 0 0 01 in the region where the flow is moving at the speed of m u 0 c 0 0 5 the time data of two periods are used to predict the acoustic signal generated by the monopole source the permeable integral surface is constructed with cubic in the range of 5 l to 5 l in the three coordinate directions and the observer location is assumed to be at the 50l 0 0 the point monopole source is located at the 0 0 0 the observer permeable surface and source location are shown in fig 14 a and the analytic acoustic pressure field is shown in fig 14 b the comparison of the predicted acoustic pressure results with the analytic solution and other numerical results is presented in figs 15 and 16 the acoustic pressure obtained from the acoustic solver based on the permeable fw h integral equation is in excellent agreement with the other results in terms of the time history and the directivity of acoustic pressure as shown in fig 15 the acoustic pressure field predicted using the acoustic solver is also compared with the analytic solution in fig 16 there are again excellent agreements between the two results the validity of the acoustic solver is confirmed from these results 4 2 preliminary simulation i boundary layer flow on lct test section the preliminary simulation i is made with a focus on the accurate computation of boundary layer flow on the wall of the lct test section the velocity profiles predicted on the three locations that are the center points of the first fourth and seventh windows in the lct test section are compared with the results measured using the ldv fig 17 a shows the locations for the comparisons for the inflow velocities from 8 m s to 12 m s with a step of 2 m s fig 17 b c and d shows the compared results for three different inlet velocities at the three locations respectively it is well known that the boundary layer becomes thicker as it is convected downstream in a confined flow and the blockage effect accelerates the flow velocity to a higher velocity than the target velocity park et al 2019a therefore it is necessary to confirm whether these phenomena occur in both the experiment and simulation to ensure the validity of the simulation in the given grids it can be seen in fig 17 b c and d that the boundary layer thickness δ defined as the height where u u 0 99 increases as the flow goes downstream and the measured velocity profile closely follows the empirical turbulent velocity profile of the one seventh power law the incident flow into the lct test section in the experiment exhibits a more developed boundary layer flow because it passes through the converging section in front of the test section as shown in fig 11 a however because only the test section is considered as the simulation domain in the numerical approach some distance is required for the boundary layer flow to develop this is why the velocity profiles of the numerical results differ from the experimental results by more at the location of the 1st window than at the others as shown in fig 17 b to d park et al 2016 reported that this problem could be overcome by including the converging section as the simulation domain however it can be seen that the predicted velocity profiles follow the measured ones more closely as the flow goes downstream because the submarine body and the propellers are located near the 4th and 7th windows it is expected that the effects of the boundary layer of the test section wall are well resolved in the next preliminary simulation ii and the main simulation on the more from fig 17 b d the slower the inflow velocity is the smaller the difference between the simulation and the experiment the inlet flow velocity in the main simulation is 5 m s which is lower than the velocities considered in the preliminary simulation i and the difference between the experiment and the simulation is expected to be much smaller since the validity of grid resolution on the lct test section is verified from the preliminary simulation i the grid system on the lct test section is maintained with the same resolution as the preliminary simulation i in all subsequent simulations 4 3 preliminary simulation ii nominal wake field in this section the preliminary simulation ii focusing on the nominal wake field due to the sail and rudders of the submarine body is performed the validity of numerical results is confirmed by comparing the predicted results with the measured ones park et al 2019a first the total resistance of the suboff body is compared with the measured one ahn et al 2020 as the inflow velocity is varied from 2 m s to 12 m s the results are presented in fig 18 and table 7 there are fair agreements between the predicted and measured ones of which the maximum difference is within 5 the nominal wake field formed by wake flow due to the sail and rudders is compared with the measured one at the stern of the suboff body as shown in fig 19 the nominal wake field is monitored at x l oa 0 978 where the propeller rotating plane is located as shown in fig 19 a the location of x 0 denotes the submarine head there are good agreements between the two results from the wake field distribution as shown in fig 19 b and c the effects of the rudders located in the stern at 180 90 0 and 90 are clearly identified besides it can be found that the flow velocity reduction in the 90 location is most significant among the others at 0 180 and 90 the reason for this is the influence of the sail located above the head of the suboff body chase 2012 filip et al 2012 through the preliminary simulation ii the validity of the grid resolution around the suboff body is confirmed so that the grid system on the suboff body is maintained with the same resolution as the preliminary simulation ii in the following main simulations 4 4 main simulations tip vortex cavitation flow in this section the main simulations for cavitation flow on the hsp17 and hsp38 propellers are performed the steady rans simulation is first performed to set up the initial conditions for stable and fast convergence of the unsteady ddes simulation the inflow velocity and the propeller rotating speed are 5 m s and 25 rps respectively which are the same as the experimental conditions the time step is set to be 5 555 10 5 s for which the propeller rotates by 0 5 fig 20 shows the numerical results of vorticity magnitude on the cross sectional plane according to the used grids shown in fig 8 fig 20 a to d show the steady state single phase rans results obtained using the grids of the rans g1 to rans g4 whose resolutions are increased to improve the resolution of predicted numerical results and thus to accelerate the convergence of the unsteady two phase ddes results it can be seen from fig 20 a and b that the numerical result from the rans g2 grids of which the number is the most among the rans grids reveals a more resolved vortex structure than the initial grid of the rans g1 however the vortex structure s resolution in the rans g2 is identical to the result of rans g3 which has the second lowest number of grids from the result in fig 20 d it can be seen that the vortex strength of the rans g4 is maintained along the more downstream direction than the other results the numerical result obtained from the rans g4 is used as the initial condition for the unsteady ddes simulations fig 20 e and f show the unsteady two phase ddes simulation results obtained from the ddes g1 and the ddes g2 respectively it can be seen that the propeller wing tip vortex in the ddes g2 grid system exhibits a more highly resolved complex structure with a higher magnitude than that in the ddes g1 grid system besides the periodically detached vortex structure from the hub can be identified being similar to the von karman vortex the vortex structure is found to be rapidly dissipated as it approaches the right end in a downstream direction in fig 20 f because the right end is the boundary between the rotating grid system with higher grid resolution into the fixed grid system with lower grid resolution the predicted tvc pattern according to the types of grid systems used is shown in fig 21 the tvc pattern is depicted by using an iso surface with a volume fraction of 0 1 hu et al 2021 it can be seen that the tvc is more developed in the ddes g2 grids than that in the ddes g1 grids in this study the ddes g2 grids which show the most resolved tvc shape are used as the final grid system when the propeller passes through the wake flow regions which are shown in fig 19 the reduced axial flow velocity is incident into the propeller the decrease in the incident axial flow velocity at the same rotational speed causes the increase in the angle of attack aoa of the flow incident on the propeller as shown in fig 22 the increase in the aoa causes a strong vortex and thus induces cavitation more easily it can be seen from fig 21 that when the propeller passes the positions of 0 90 180 and 90 shown in fig 19 cavitation occurs in both propellers to illustrate these phenomena more clearly fig 23 shows the distribution of axial velocity components on the rotating propeller plane clear interaction between the wake flow field and the propeller blades can be seen at the positions of 0 90 180 and 90 fig 24 compares the predicted cavitation flow results with the measured ones the cavitation patterns in the numerical results are visualized by using the iso surface of a volume fraction of 0 1 it is seen that there are fair agreements between the numerical and experimental results on the more the cavitation patterns predicted at the blade tip and the hub are more active in the hsp17 propeller than in the hsp38 propeller this predicted trend is the same as the measured one these results confirm that the cavitation is suppressed as the skew angle increases the thrust coefficient k t which is the hydrodynamic performance indicator of a propeller is defined as follows 16 k t t ρ n 2 d 4 t thrust here ρ n and d denote the liquid density rotational speed and propeller diameter table 8 compares the predicted coefficients for the hsp17 and hsp38 propellers with the measured ones it can be confirmed that the numerical results agree well with the measured results the maximum difference between the two results is within 7 4 5 tip vortex cavitation noise in this study the quadrupole corrected fw h equation is applied to predict the tvc noise and the location of permeable integral surfaces of eqs 7 10 is presented in fig 25 the permeable integral surface is constructed to include the most critical flow noise sources within the rotating grid system it can be seen that the vortex structures pass through the integral surface because the vortex strength is maintained due to high grid resolution and high order numerical schemes as shown in fig 25 a however it has been reported that the vortex passing through the integral surface has an adverse effect on the accuracy of the fw h equation therefore the quadrupole corrected fw h equation is used as described in detail in section 2 2 3 fig 25 b shows the cylindrical permeable integral surface used in this study hydrodynamic pressure on the integral surface is presented in fig 25 c the sampling rate determined by the numerical time step size is 18 000 hz and the frequency resolution is 12 hz determined by the total time length for the signal processing which is slightly longer than that it takes for the propeller to spin twice the hanning window is applied to prevent leakage errors the maximum frequency for the analysis is set to be 6 khz that is two third of the nyquist frequency to avoid aliasing during the signal processing generally it is known that the tvc increases the broadband noise level in a frequency range above 1 khz and the sheet and cloud cavitation contribute to tonal noise components like the blade passing frequency bpf noise carlton 2012 therefore the acoustic spectrum range is set to be in a range higher than 1 khz the acoustic pressure is measured at the location indicated in fig 11 b and the numerical prediction is also carried out at the same position the power spectral density predicted for the hsp17 and hsp38 propellers are compared with the measured ones in fig 25 overall pwl levels and the difference between the two propellers are listed in table 9 there are good agreements between the two results regarding spectral shape overall levels and reduction levels ku et al 2020a 2020b 2020c revealed that the radiated acoustic spectral levels in the frequency range higher than 1 khz increased as the strength of tvc increases as described in the previous section the tip vortex strength of the hsp38 is less than that of the hsp17 accordingly the acoustic psd levels of the hsp38 are predicted to be less by 2 9 db than that of the hsp17 the same trend is confirmed in the measured spectrum although the measured reduction of 3 0 db is slightly higher than the predicted one however the 6th 12th harmonic components of the bpf noise of the hsp17 and hsp38 propellers are over estimated than the measured ones the over estimation seems to be due to slight overestimation of the sheet cavitation contributing more to the tonal noise components fig 26 c compares the same results in terms of the one third octave band spectrum the band levels in a low frequency region are overestimated due to strong tonal components but the skew effect observed in the experimental result is well reproduced by the numerical results the maximum difference in the 1 3 octave band levels between the two results is lower than 8 db the effects of different integral surfaces on the noise spectrum computed using the quadrupole corrected fw h equation are investigated fig 27 a shows the three different integral surfaces used for the computation of the fw h equation the integral surfaces are varied by changing the location of the downstream surface as 0 48d 0 65d and 0 82d all of which are still within the rotating grid region the corresponding acoustic psds predicted using the different integral surfaces are compared in fig 27 b where d denotes the propeller diameter as shown in table 3 note that the predictions shown in fig 26 were carried out using the integral surface whose downstream surface is located at 0 65d the intense vortex structure penetrates the downstream surface of the smallest permeable integral volume at 0 48d and the vortex structures gradually weaken along the downstream direction and pass through the source surfaces at 0 65d and 0 82d generally when the acoustic source such as the vortex structure passes through the integral surface spurious noise can be generated due to a lack of quadrupole term lopes et al 2017 ku et al 2018 cho et al 2020 this non physical noise can be suppressed using the quadrupole correction as explained in section 2 2 3 as shown in fig 27 b there are no noticeable differences between the predicted spectra table 10 lists the predicted overall noise levels whose differences are also within 1 db 5 conclusions in this study the tip vortex cavitation and noise of two propellers with different skew angles were numerically investigated using the hybrid computational hydro acoustic technique which consisted of the delayed detached eddy simulation with adaptive grid refinement method and the fw h integral equation careful attention was paid to the reproduction of experimental conditions in the corresponding numerical simulation which were the effects of the boundary layer on the lct test section wall and the nominal wake field due to a submarine body the preliminary simulations i and ii were carried out to investigate these effects after close reproduction of these two effects was confirmed the main simulations were carried out to predict the cavitation flow and noise of the hsp17 and hsp38 propellers installed on the suboff submarine body the effects of the nominal wake field and skew angle on cavitation occurrence and its noise were clearly shown in the numerical simulations and its validity was confirmed through the comparison of the predicted results with the measured ones through the comparison of the result obtained from the preliminary simulation i with the measured data it was confirmed that the boundary layer thickness on the wall of the lct test section gradually increased as the inlet flow moved in the downstream direction the boundary layer development which is frequently observed in a confined flow such as tunnel flow induces the blockage effect that increases the maximum flow velocity as the flow is convected in the downstream direction the reproduction of boundary layer flow in the numerical simulation was confirmed by comparing the predicted boundary layer profiles with the measured ones the preliminary simulation ii was performed on the darpa suboff submarine without a propeller the total resistance of the submarine body predicted for various inflow velocities was compared with the measured ones there were good agreements between the two results of which the maximum difference was less than 5 in addition the nominal wake field predicted at the stern was compared with the measured ones there were again excellent agreements between the two results both the numerical and experimental results revealed that the clear wake flows formed due to the rudders and sail of the submarine body after the close reproduction of measured inlet disturbance in the numerical simulations was confirmed the main simulations were carried out to investigate the cavitation flow and noise of the underwater propellers for effective and high resolution reproduction of tip vortex cavitation adaptive grid refinements were carried out on the rotating grids including the propellers six steps of grid refinements were made to reach the final grid system the first four steps of simulations which used the rans g1 to rans g4 grid systems were performed using the steady rans simulation of single phase hydrodynamic flow and the last two steps of simulations using the ddes g1 and ddes g2 grid systems were performed using the unsteady ddes simulation of two phase flow the ddes g2 grid system with the highest spatial resolution along the vortex trajectory was selected as the final grid system where the predicted tvc patterns for the hsp17 and hsp38 propellers show good agreements with the measured ones in addition the thrust coefficient of the propellers was compared with the measured data there were again good agreements between two results of which the difference is within 7 because a relatively low velocity flow is incident to the propellers at the angular positions corresponding to the locations of rudders and sail at the submarine stern the local angle of attacks of the incident flow at those positions were relatively increased the higher aoa induced the tvc as well as sheet cavitation in both the hsp17 and hsp38 propellers this result was observed in both the numerical and experimental results based on the unsteady ddes simulation results the acoustic sources were extracted by constructing the permeable integral surface in the rotating grid system with high spatial resolution and the cavitation noise is predicted by applying the quadrupole corrected fw h integral equation the predicted acoustic psd spectrum showed good agreement with the measured one besides the present numerical methods showed that the higher skew angle of the propeller blades induces lower cavitation noise which was confirmed by the experimental result the acoustic psds predicted using different permeable integral surfaces were compared revealing that there were no noticeable differences between them based on all of these results the present numerical methodology is expected to be used for the future development of high performance and low noise underwater propellers funding this research was funded by defense acquisition program administration and agency for defense development authors contributions c c provided the basic idea for this study and the overall numerical strategies g k and j c carried out the numerical simulations and worked on the analysis of numerical results h s constructed the experimental environment and conducted the experiments declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was carried out as a project of future submarine low noise propeller research laboratory of kriso supported by defense acquisition program administration and agency for defense development 
