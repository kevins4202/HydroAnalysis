index,text
22255,the hydrodynamics of the waterjet propelled ships represents a challenging problem due to the complexity of the waterjet system itself and the waterjet hull interaction in this paper the self propulsion computations of a trimaran were performed by solving the unsteady rans equations the waterjet was simulated directly with multi reference frame model to improve the precision of the numerical simulations mesh independence studies of the hull and waterjet were carried out individually numerical simulations with without the waterjet were performed in a speed range of 0 196 fr 0 707 comparisons between numerical predictions and experimental data showed the numerical method could accurately predict the self propulsion performance a numerical tool was developed to obtain the capture area based on tracking the streamlines upstream which was practical and greatly simplified the post processing according to the ittc procedures and guidelines the overall efficiency and its components were analyzed in detail the results showed that the resistance increment was always positive while the waterjet thrust deduction fraction was negative the overall efficiency of the waterjet was mainly affected by the ideal jet efficiency and the pump efficiency the analysis of the waterjet powering characteristics can better understand the energy conversion and the interaction between the ship hull and waterjet keywords self propulsion numerical simulation waterjet trimaran nomenclature t gross gross thrust t net net thrust ivr intake velocity ratio nvr nozzle velocity ratio a 1 area of capture area a 6 area of nozzle section t total thrust deduction t r resistance increment fraction t j waterjet thrust deduction fraction r bh bare hull resistance f d external tow force s wetted surface u hull velocity c f frictional resistance coefficient re reynolds number p d delivered mechanical power p e effective power p te effective thrust power p jse effective jet system power p pe effective pump power h 35 pump head q shaft shaft torque q j flow rate k qj flow rate coefficient n rotational speed η d overall efficiency η 0 free steam efficiency η int interaction efficiency η i ideal jet efficiency η mi momentum interaction η ei energy interaction η duct ducting efficiency η p pump efficiency l duct duct length d duct duct diameter d pump pump diameter l pp length between perpendiculars b ship width d ship height δ displacement fr froude number y non dimensional wall distance h i third root of the total mesh number r t total resistance c t resistance coefficient σ sinkage θ trim angle k t thrust coefficient k q torque coefficient c p pressure coefficient 1 introduction in recent years the development of high speed ships has attracted the attention of the shipbuilding industry and navies from all countries compared with propellers driven ships waterjets driven ships exhibit high efficiency good maneuverability and good anti cavitation performance many high speed ships choose waterjet propulsion as their driving force accurate prediction of propulsive performance of the waterjet system has always been a concern of researchers with the rapid development of computational fluid dynamics cfd methods in the ship field cfd technology has been widely used and has made considerable progress van terwisga 1996 analyzed the interaction effects in the powering characteristics of waterjet propelled vessels an empirical prediction model was recommended for preliminary power speed computations bulten 2006 carried out a numerical study of the water jet system and analyzed the effects of the steady multi reference frame mrf model and the transient moving mesh model on the performance of the water system the results showed that the head torque and efficiency for the transient flow calculations were slightly higher numerical simulation of waterjet self propulsion has also been carried out by many researchers kandasamy et al 2010 derived an integral force moment waterjet model for ship local flow powering predictions an alternative control volume was used to balance the force and moment the predicted resistance error was less than 5 the average sinkage error was 9 0 and the average trim error was 13 7 takai et al 2011 analyzed the flow fields for a high speed sea lift hull by applying a body force to model the pump effect moreover the duct shape was optimized the results showed that the pressure loss could be reduced by optimizing the upper curve and lip shape of the channel and the inlet efficiency could be improved by optimizing the intake peri et al 2012 optimized the high speed waterjet catamaran aiming at reducing the resistance and inlet loss of the waterjet the total resistance was reduced by 6 after the optimization during the optimization process the low fidelity model was used to reduce the costs of the computation eslamdoost et al 2014 proposed a pressure jump method to study the interaction between the waterjet and hull the reason for the negative thrust reduction of the waterjet was analyzed it was found that the resistance increment was not the main cause but the non atmospheric pressure on the nozzle exit caused the negative thrust deduction gong et al 2017 carried out a numerical simulation of a waterjet self propelled ship the virtual disk and overset models were applied to compare the flow fields the results revealed that the hull flow fields from the two models were basically the same but the internal flow field calculated by the overset model was more applicable to the actual state of the impeller yi et al 2017 analyzed the hydrodynamic characteristics of submerged waterjet propulsion by combining experimental and numerical simulation methods and the experimental values were in good agreement with the cfd predictions the predicted resistance thrust and torque errors were 3 7 4 7 and 4 6 respectively at present most waterjet self propulsion studies was based on the virtual disk model miller et al 2006 or body force model rhee and coleman 2009 to simulate the pump effect this method can reduce the calculation cost but the thrust and torque coefficients are obtained in open water and the influence of the hull boundary layer and the non uniform flow distribution of the intake young et al 2011 are not considered because the error of momentum flux is the square of the error of the flow rate a 1 5 2 error of the flow rate can cause a 2 4 error of the momentum flux so the accuracy of the momentum flux depends on the accuracy of the flow rate in this study a waterjet was simulated directly using the steady mrf model which is more accurate than the virtual disk and body force models the overset mesh method was used to cope with the large hull attitude at high speeds the steady multi reference frame model was employed for the rotation of the impellers and the thrust was determined by integrating the forces acting on the waterjet the self propulsion point was obtained by modifying the rotational speeds of the impellers until the horizontal force was balanced numerical simulation and analysis of the self propulsion of a waterjet propelled trimaran were carried out first the resistance of the bare hull with a free surface was calculated numerically and the results were compared with the model test results to verify the accuracy a self propulsion simulation was subsequently performed the powering characteristics of the waterjet were calculated and analyzed the hydrodynamic characteristics of the waterjet and hull were obtained by this numerical study 2 basic theory in the waterjet experiments there are two different methods for predicting the thrust of the waterjet the momentum flux method and the direct thrust measurement method at the 24th international towing tank conference ittc 2005 it was concluded that the direct thrust measurement method was expensive and cumbersome by the waterjet specialist committee since the momentum flux method can select any suitable pump that meets the flow requirement and there is not complicated watertight sealing between the hull and waterjet system the momentum flux method has become the main method used by researchers in experiments and numerical calculations recommended procedures and guidelines for propulsive performance predictions ittc 2005 and uncertainty analysis ittc 2017 based on the momentum flow method were finally proposed based on the continuous improvements by the waterjet specialist committee 2 1 momentum flux theory based on the recommended procedures and guidelines for propulsive performance predictions ittc 2005 a control volume is shown in fig 1 which was applied to analyze the performance of the waterjet system using the momentum flux method numbers with circles denote the station numbers surface 1 is the imaginary capture area and is positioned one impeller diameter in front of the ramp tangency point a surface 2 is the imaginary streamtube which separates the control volume from the flow field surface 3 is the physical boundary of the waterjet system surface 4 is the surface between the stagnation lines and merge lines of hull and duct surface 5 is a section in the intake throat surface 6 is the nozzle section at the station 6 applying newton s second law to the control volume the conservation law of momentum follows the following equation in the i direction 1 a 1 a 6 ρ u i u k n k d a a 1 a 2 a 3 a 6 σ i j n j d a v 3 5 ρ f p i d v v 1 6 ρ f i d v where σ i j is the tensor f p i is the pump force and f i is the external force gravity force the terms on the left and right hand side represent the change in momentum flux and the forces acting on the control volume in the i direction respectively on the right hand side the first term represents the pressure and tangential stress force the second term represents the pump force acting on fluid and the third term represents the gravity force acting on control volume the gross thrust is the definition of the term on the left side of equation 1 the horizontal component of the gross thrust in the x direction is abbreviated as t gross and defined as follows 2 t g r o s s a 1 a 6 ρ u x u k n k d a the intake velocity ratio ivr is defined as the ratio of the average velocity on the capture area u 1 to the hull velocity u and the nozzle velocity ratio nvr is defined as the average velocity on the nozzle section u 6 to the hull velocity u defined as follows 3 i v r u 1 u n v r u 6 u the gross thrust can also be defined as follows 4 t g r o s s a 1 a 6 ρ u x u k n k d a ρ q j u n v r cos θ i v r where θ is the trim angle of the hull q j is the flow rate and the flow rate coefficient was defined as follows 5 k q j q j n d p u m p 3 the net thrust is defined as the force vector acting upon the duct boundary the pump housing and the shaft which directly pass the force through to the hull the horizontal component of the net thrust in x direction is abbreviated as t net and defined as follows 6 t n e t a 3 a 4 σ x d a v 3 5 ρ f p x d v it is difficult to measure the net thrust in experiments and thus the gross thrust is used to define the thrust deduction which is different from the definition in the conventional hull propeller theory the total thrust deduction is defined as the ratio of the difference between the bare hull resistance and the external tow force to the gross thrust and the external tow force accounts for the difference of the frictional resistance coefficient between the model and full scale 7 1 t r b h f d t g r o s s 8 f d 1 2 ρ s u 2 c f m c f s where t is the thrust deduction r bh is bare hull resistance f d is the external tow force s is the wet area of the hull at rest u is the hull velocity at model scale and c fm and c fs are the model and ship frictional resistance coefficients respectively which can be calculated from the 1957 ittc formula 9 c f 0 075 lg r e 2 2 where re is the reynolds number the resistance increment fraction and the waterjet thrust deduction fraction are defined as follows 10 1 t r r b h f d t n e t 1 t j t n e t t g r o s s combining equations 7 and 10 yields the following 11 1 t 1 t r 1 t j 2 2 description of powering characteristics based on the ittc regulations ittc 2005 the overall efficiency of the waterjet hull system η d can be divided into the free steam efficiency η 0 in ideal conditions where the intake velocity of the waterjet is uniform u and the pressure at the nozzle center is atmospheric pressure p 0 and the interaction efficiency η int which accounts for the effect of the waterjet hull interaction 12 η d η 0 η i n t the waterjet hull system is divided into subsystems and the schematic diagram of energy conversion between subsystems and the subsystem efficiencies are shown in fig 2 the free steam efficiency and the interaction efficiency are defined as follows 13 η 0 η i η d u c t η p u m p η i n t 1 t η e i η m i the overall efficiency of the waterjet hull system is given by 14 η d p e p d p e p t e p t e p t e 0 p t e 0 p j s e 0 p j s e 0 p j s e p j s e p p e p p e p d where p e is the effective power p d is the delivered mechanical power p te is the effective thrust power p jse is the effective jet system power p pe is the effective pump power and the other terms with subscript 0 are corresponding powers in the free steam condition the subsystem efficiencies are given as follows thrust deduction 15 1 t p e p t e r b h f d t g r o s s momentum interaction 16 1 η m i p t e p t e 0 t g r o s s t g r o s s 0 1 1 i v r n v r 1 ideal jet efficiency 17 η i p t e 0 p j s e 0 t g r o s s 0 u 0 q j h j s e 0 t g r o s s 0 u 0 e 6 e 0 2 n v r 1 the total axial energy flux e s through a cross sectional area a s at station s is defined as follows 18 e s a s ρ 1 2 u i 2 p ρ g z s u i n i d a energy interaction 19 η e i p j s e 0 p j s e e 6 e 0 e 6 e 1 ducting efficiency 20 η d u c t p j s e p p e e 6 e 0 ρ g q j h 35 pump efficiency 21 η p p p e p d ρ g q j h 35 2 π n q s h a f t 3 hull and waterjet geometry the hull used in this study was a trimaran and its main and side bodies were aligned at the stern the hull and waterjet geometries were at the model scale two waterjet systems were installed on the main body the numbers of impeller blades and guide vanes of the waterjet system were 6 and 11 respectively principal dimensions of the hull and waterjet are shown in table 1 the hull and waterjet model are shown in fig 3 4 computations of bare hull resistance 4 1 numerical methods the numerical simulations were conducted using the finite volume method fvm commercial software star ccm the sst k ω turbulence model was applied to solve governing equations the dimensionless distance from the center of the first grid to the wall is defined as y all y wall treatments cd adapco s c 2015 were selected the viscous sub layer was resolved if y 1 a wall function was used if y 30 and a blending function was used to resolve the buffer region 1 y 30 the volume of fluid vof method hirt and nichols 1981 was used to capture the free surface the convective and temporal discretization schemes were second order upwind schemes the implicit unsteady solver based on the separated flow model was used the physical time step was 0 02 s and there were 10 iterations in each time step a dynamic fluid body interaction dfbi rotation and translation motion ohmori 1998 was applied to simulate the 6 dof motion of hull and the sinkage and trim were free the numerical computational boundary conditions are shown in fig 4 considering the symmetry of the geometry and flow only half of the hull was modeled the computational domain was split into two different regions a background region and an overset region the background region was stationary and the overset region was moving with the hull an overset mesh was built between the background region and the overset region the length width and height of the computation domain were 13l pp 5l pp and 4l pp respectively the inlet was situated 2l pp in front of the stem and the outlet was located 10l pp behind the stern to completely develop the wake field in front of the outlet the vof wave damping length was set 4l pp to avoid the reflection of waves the boundary conditions were set as follows the velocity inlet boundary condition was applied to the inlet side top and bottom of the domain a pressure outlet boundary condition was applied to the outlet a symmetry boundary condition was set at the center plane of the hull a no slip wall boundary condition was used for the hull surface 4 2 mesh independence study of the bare hull computations of the bare hull resistance in calm water were carried out to obtain a complete prediction of the self propulsion an unstructured trimmed mesh was generated in this study six layers of prism meshes with a growth ratio of 1 2 were generated in the boundary layer four levels of blocks were used to refine the mesh around the hull three levels of blocks were used to refine the mesh around the free surface three cones like kelvin waves were used to capture the free surfaces better the mesh of the computational domain is shown in fig 5 a mesh independence study was carried out at fr 0 628 which is the design speed by varying the basic size of the mesh parameters five sets of meshes were generated the basic sizes and the total numbers of the five sets of meshes are shown in table 2 the total resistance coefficient c t is defined as follows 22 c t r t 0 5 ρ s u 2 where r t is the total resistance and s is the wet area of the hull at rest according to the least squares root method proposed by eça and hoekstra 2014 a mesh independence study method for the non uniform refinement ratio the numerical uncertainty of the bare hull was determined the non uniform refinement ratio is defined as follows 23 h i h 1 n 1 3 n i 3 where n i and h i are the total number of meshes and the typical mesh size for mesh number i n 1 and h 1 correspond to the finest mesh the convergence curve of c t is shown in fig 6 considering the computational accuracy and cost mesh number 3 was selected for the computations the numbers of mesh in background region and in the overset region were about 0 74 and 0 95 million the numerical uncertainty for these meshes was 2 65 fig 7 shows the y values on the hull at fr 0 628 4 3 results of bare hull resistance the calm water resistance tests were carried out in norwegian marine technology research institute marintek the hull model was towed by the carriage and equipped with a trip wire at the bow and stern the bare hull resistance was calculated in a speed range of 0 196 fr 0 707 and the hull was free to sink and trim fig 8 shows the computed and measured bare hull resistance results figs 9 and 10 show the sinkage and trim results respectively both the resistance and sinkage were under predicted compared to the experimental results while the trim results were over predicted the minimum resistance sinkage and trim errors were 1 95 9 77 and 4 59 respectively the average resistance sinkage and trim errors were 4 44 13 43 and 7 34 at a high speed range of fr 0 4 in general the calculated results of the bare hull were in good agreement with the experimental results thus the accuracy of the numerical method was verified and the numerical method is applicable and reliable for further calculations of the self propulsion 5 computations of self propulsion 5 1 mesh independence study of the waterjet system because the pump is an important part of the waterjet system to obtain an appropriate mesh size for the waterjet system a mesh independence study was carried out for the pump based on the least squares root method eça and hoekstra 2014 the numerical domain and boundary conditions of the waterjet pump are shown in fig 11 the domain was split into two different regions a stationary region and a rotating region in which the mrf model was set to simulate the rotation of the impellers the inlet was situated 5d duct in front of the pump and the velocity was set to the design flow rate with a uniform velocity distribution atmospheric pressure was applied to the outlet boundary no slip wall boundary conditions were applied to the other boundaries in the mrf model the rotational speeds of the impellers were set to the design rotational speed an unstructured trimmed mesh was generated for the pump feature curves of impellers and guide vanes were generated to refine the mesh around the curves five sets of meshes were generated similar to the mesh independence study of the hull five sets of meshes are shown in table 3 the mesh on the impellers guide vanes and housing of mesh number 3 are shown in fig 12 the thrust coefficient k t and the torque coefficient k q were defined as follows 24 k t t b l a d e ρ n 2 d p u m p 4 k q q s h a f t ρ n 2 d p u m p 5 where t blade is the thrust of all the blades of the pump and q shaft is the shaft torque the convergence curves of k t and k q are shown in figs 13 and 14 the results show that with the increase of mesh density level k t converges to 1 182 gradually and k q converges to 1 214 gradually the torques of mesh number 1 4 are all close to its convergence value considering the accuracies of k t and k q and the computational cost mesh number 3 was selected for further calculations the number of meshes in the rotating region was about 1 08 million and the number of meshes in the remaining region was about 1 82 million the numerical uncertainties of k t and k q for this mesh were 1 06 and 2 18 respectively the mesh for calculating the self propulsion was based on the mesh independence study of the bare hull and the pump since the flow fields around the waterjet intake in the waterjet duct and out of the nozzle were important the meshes in these regions were refined the total number of meshes for the simulation of the self propulsion flow was 4 86 million and the numbers of meshes in the background overset and rotating regions were about 0 68 2 74 and 1 45 million respectively fig 15 shows the mesh around the waterjet duct fig 16 shows the y values on the duct and blades of the waterjet 5 2 numerical methods the numerical method for simulating the self propulsion was similar to the method for simulating the bare hull the difference is that the rotating reference frame in the mrf model was the local hull fixed coordinate system which was moving with the dfbi motion the self propulsion point was obtained by modifying the rotational speeds of impellers until the total resistance was equal to the sum of the net thrust and the tow force it is generally considered that the thrust is proportional to the rotational speed in a small range of rotational speeds after convergence the rotational speed was n 1 and the corresponding horizontal force was fx 1 then n 1 was adjusted to n 2 in a small range and after convergence the corresponding horizontal force was fx 2 n 3 could be obtained according to n 1 n 2 fx 1 and fx 2 by a linear interpolation method by changing the rotational speed three times the horizontal force could be balanced there are two methods to obtain the capture area one method is based on solving a scalar equation and was used by bulten 2006 ding and wang 2010 and eslamdoost et al 2014 the other method is based on tracking streamlines upstream and was used by delaney et al 2009 in this study the latter method was applied streamlines were tracked upstream from station 3 and the shapes of the capture area were fitted by a quadratic polynomial with the streamline data at station 1a fig 17 shows streamlines tracked upstream and the boundary layer at station 1a for fr 0 628 a program was developed using the matlab language to simplify the post processing fig 18 shows the numerical tool for obtaining the capture area the blue dots are the data to be processed and the red line is the fitting curve the program is controlled by six parameters the first parameter is the dead rise angle of the hull at station 1a the second and third parameters are center coordinates of the capture area the fourth and fifth parameters are the extension coefficients used to ensure that the fitting curve exceeds the range of the streamlines and the sixth parameter is the scaling factor because the flow rate of the capture area calculated directly is slightly lower than the flow rate at station 3 a 0 5 1 enlargement of the capture area is needed fig 19 shows the steps for obtaining the capture area the section data of the streamlines blue dots is rotated by the dead rise angle of the hull to reduce gradient and improve the fitting accuracy the section data can be regarded as a convex set and the boundary points of the convex set are calculated the boundary points is fitted by a quadratic polynomial and the fitting curve is extended at the ends the fitting curve is rotated by the dead rise angle in reverse to restore its position the accuracy of the program was mainly affected by the number of streamlines and was tested by changing the number of streamlines with 500 1000 2000 4000 and 8000 the results showed that when the number of streamlines was greater than 1000 the shape of the capture area was no longer changed the shape of the capture area could be easily and accurately obtained by the program with 1000 streamlines and the time cost of post processing was greatly reduced in this paper the capture area was obtained when the sinkage and trim were equal to the averages of that in several periods 5 3 results of the self propulsion self propulsion tests were also carried out in marintek based on the recommended procedures and guidelines for propulsive performance predictions and the trimaran equipped with a twin waterjet propulsion system the flow rate was measured separately for each waterjet in the self propulsion tests wave patterns of the self propulsion at fr 0 314 0 471 and 0 628 are shown in fig 20 5 3 1 results of the resistance sinkage trim and wave pattern the self propulsion was calculated in a speed range of 0 275 fr 0 707 the free surface and the jet flow at fr 0 628 are shown in fig 21 under the impact of the jet flow a high and sharp wave peak formed behind the hull fig 22 shows the computed and measured resistance results of the self propelled hull the experimental resistance was estimated by the gross thrust measured in the self propulsion experiments plus the tow force for without assuming a jet thrust deduction factor the difference between computed and measured resistance of the self propulsion was lower than that of the bare hull figs 23 and 24 show the sinkage and trim results respectively the computed sinkage values were lower than the measured values however the computed trim values were higher than the measured values in the high speed range of fr 0 4 the average sinkage and trim errors were 13 24 and 12 04 respectively like the results of the bare hull simulation the match between the computed resistance sinkage and trim and the measured values was very good on the whole fig 25 shows the comparison of the wave pattern around the bare hull and the hull with the waterjet the wave patterns around the hull were basically the same but the wave patterns behind the hull were significantly different due to the jet flow the height of the stern wave peak was larger than that of the bare hull the width of the stern wave was smaller than that of the bare hull and a high and sharp wave peak formed which is also shown in figs 20 and 21 5 3 2 analysis of the capture area and nozzle section fig 26 shows the shape of the capture area and the velocity distribution on the capture area at different speeds as the boundary layer became thinner from the longitudinal section to the side of the hull the maximum velocity of the capture area was similar to the hull speed with the increase in the hull speed the width of the capture area basically remained unchanged while the height gradually decreased and the area of the capture area decreased monotonously consequently in fig 27 the area of the capture area was non dimensionalized by the ratio of the capture area to the nozzle section area fig 28 shows the velocity distribution on the nozzle section at the station 6 through the rectification of the guide vanes the velocity on the nozzle section was still not uniform the velocity at center of the nozzle section was low with the increase in the froude number the velocity distribution became increasingly more uniform fig 29 shows the calculated and measured ivr and nvr the match between the calculated and measured values was good on average the calculated ivr and nvr were over estimated by 5 13 and 1 32 respectively overall the ivr did not change significantly but the nvr decreased with the increase in the froude number fig 30 shows the comparison of the calculated and measured flow rate coefficients the flow rate coefficient increased slowly with the increase in the froude number the flow rate was over estimated and the average discrepancy was 2 63 finer mesh may be needed for the waterjet to predict the flow rate more accurately as shown in figs 29 and 30 the measured ivr and the flow rate coefficient exhibited slight sudden changes at fr 0 393 which was a critical speed when the trim angle increased rapidly and transom clearance occurred 5 3 3 analysis of powering characteristics to clearly understand the efficiency of energy conversion and the interaction between the ship hull and waterjet the powering characteristics were analyzed based on the theory in section 2 2 the total thrust deduction t and its components t r and t j are shown in fig 31 because the sinkage and trim of the self propulsion was higher than that of the bare hull the resistance increased at self propulsion the resistance increment t r was always positive t r decreased with the increase of speed for fr 0 393 and t r varied in a small range from 0 02 to 0 04 for fr 0 393 the waterjet thrust deduction fraction t j was negative for fr 0 668 meaning that t gross was less than t net and the absolute value of t j decreased with the increase of speed because the absolute values of t r were greater than those of t j the trend of t was similar to that of t r the interaction efficiency η int and its components 1 t η mi and η ei are shown in fig 32 although the values of η ei were about 0 05 greater than those of η mi their trends were basically the same and gradually decreased with the increase of fr the trend of η int was determined by that of 1 t the η int was greater than 1 0 at fr 0 314 indicating that the interaction of the hull and waterjet was beneficial for the rapidity performance the free stream efficiency η 0 and its components η i η duct and η pump are shown in fig 33 the ideal jet efficiency η i increased monotonically due to the monotonic decrease in nvr with the increase of fr the ducting efficiency η duct and the pump efficiency η pump were nearly constant over the entire froude number range the average η duct was 0 974 meaning that the energy loss caused by the duct was a small quantity at self propulsion the loss of the duct was very small when the design of the duct was reasonable the free stream efficiency increased monotonically with the increase of fr and was mainly affected by η i and η pump the overall efficiency η d and its components η int and η 0 are shown in fig 34 the overall efficiency increased with the increase of fr and the efficiency varied from 0 46 to 0 6 which were lower than that of the conventional propellers the overall efficiency was mainly determined by η 0 and influenced by η int in the design of the waterjet determining how to improve the ideal jet and pump efficiencies is important to the overall efficiency 5 3 4 pressure distribution of the waterjet fig 35 shows the pressure distribution on the duct and the blades of the waterjet the pressure distribution coefficient is defined with reference to the atmospheric pressure p 0 as follows 25 c p p p 0 0 5 ρ u 2 the pressure on the duct slowly decreased from the intake to the pump due to the rotation of the impellers the pressure gradient around the pump region varied significantly the guide vanes were in a high pressure environment and the regions near the tip were high pressure regions the regions around the leading edge and the tip clearance of the suction surface of the impellers were low pressure regions and cavitation phenomenon may have occurred 6 conclusion in this paper numerical simulations and analysis on the self propulsion performance of a waterjet propelled trimaran were conducted based on a rans solver the pump effect of the waterjet system was simulated directly by using the mrf model to improve the accuracy of prediction mesh independence studies have been performed for both the bare hull and for the isolated waterjet system to address the numerical uncertainty and define the computational mesh the validity of the numerical method was proven by comparing the numerical results of the bare hull and the self propulsion with the experimental results the good match between the computed and measured results showed that the present numerical method could accurately predict the self propulsion performance a numerical tool was developed to obtain the capture area by tracking streamlines upstream which greatly reduced the time cost of post processing based on the ittc regulations the powering characteristics were investigated to allow the energy conversion processes and the interaction between the hull and the waterjet to be easily understood the main conclusions are presented below 1 with the increase in the hull speed the area of the capture area decreased monotonically and the velocity distribution of the nozzle section became uniform 2 the resistance increment was always positive while the waterjet thrust deduction fraction was negative 3 the interaction of the hull and waterjet was beneficial for the rapidity performance at high speed 4 the energy loss caused by the duct was a small quantity over the entire froude number range 5 for a waterjet propelled ship improving the ideal jet efficiency and the pump efficiency were the main methods to improve the overall efficiency the analysis of the powering characteristics will pave the way for further improvements of the hydrodynamic performance acknowledgements this work was supported by the foundation for key laboratory of national science and technology of china grant number 61422230203 the authors appreciate the second international workshop on waterjet propulsion iwwp 2017 and the workshop on waterjet propulsion technology workshop 2018 for the academic exchange and discussion 
22255,the hydrodynamics of the waterjet propelled ships represents a challenging problem due to the complexity of the waterjet system itself and the waterjet hull interaction in this paper the self propulsion computations of a trimaran were performed by solving the unsteady rans equations the waterjet was simulated directly with multi reference frame model to improve the precision of the numerical simulations mesh independence studies of the hull and waterjet were carried out individually numerical simulations with without the waterjet were performed in a speed range of 0 196 fr 0 707 comparisons between numerical predictions and experimental data showed the numerical method could accurately predict the self propulsion performance a numerical tool was developed to obtain the capture area based on tracking the streamlines upstream which was practical and greatly simplified the post processing according to the ittc procedures and guidelines the overall efficiency and its components were analyzed in detail the results showed that the resistance increment was always positive while the waterjet thrust deduction fraction was negative the overall efficiency of the waterjet was mainly affected by the ideal jet efficiency and the pump efficiency the analysis of the waterjet powering characteristics can better understand the energy conversion and the interaction between the ship hull and waterjet keywords self propulsion numerical simulation waterjet trimaran nomenclature t gross gross thrust t net net thrust ivr intake velocity ratio nvr nozzle velocity ratio a 1 area of capture area a 6 area of nozzle section t total thrust deduction t r resistance increment fraction t j waterjet thrust deduction fraction r bh bare hull resistance f d external tow force s wetted surface u hull velocity c f frictional resistance coefficient re reynolds number p d delivered mechanical power p e effective power p te effective thrust power p jse effective jet system power p pe effective pump power h 35 pump head q shaft shaft torque q j flow rate k qj flow rate coefficient n rotational speed η d overall efficiency η 0 free steam efficiency η int interaction efficiency η i ideal jet efficiency η mi momentum interaction η ei energy interaction η duct ducting efficiency η p pump efficiency l duct duct length d duct duct diameter d pump pump diameter l pp length between perpendiculars b ship width d ship height δ displacement fr froude number y non dimensional wall distance h i third root of the total mesh number r t total resistance c t resistance coefficient σ sinkage θ trim angle k t thrust coefficient k q torque coefficient c p pressure coefficient 1 introduction in recent years the development of high speed ships has attracted the attention of the shipbuilding industry and navies from all countries compared with propellers driven ships waterjets driven ships exhibit high efficiency good maneuverability and good anti cavitation performance many high speed ships choose waterjet propulsion as their driving force accurate prediction of propulsive performance of the waterjet system has always been a concern of researchers with the rapid development of computational fluid dynamics cfd methods in the ship field cfd technology has been widely used and has made considerable progress van terwisga 1996 analyzed the interaction effects in the powering characteristics of waterjet propelled vessels an empirical prediction model was recommended for preliminary power speed computations bulten 2006 carried out a numerical study of the water jet system and analyzed the effects of the steady multi reference frame mrf model and the transient moving mesh model on the performance of the water system the results showed that the head torque and efficiency for the transient flow calculations were slightly higher numerical simulation of waterjet self propulsion has also been carried out by many researchers kandasamy et al 2010 derived an integral force moment waterjet model for ship local flow powering predictions an alternative control volume was used to balance the force and moment the predicted resistance error was less than 5 the average sinkage error was 9 0 and the average trim error was 13 7 takai et al 2011 analyzed the flow fields for a high speed sea lift hull by applying a body force to model the pump effect moreover the duct shape was optimized the results showed that the pressure loss could be reduced by optimizing the upper curve and lip shape of the channel and the inlet efficiency could be improved by optimizing the intake peri et al 2012 optimized the high speed waterjet catamaran aiming at reducing the resistance and inlet loss of the waterjet the total resistance was reduced by 6 after the optimization during the optimization process the low fidelity model was used to reduce the costs of the computation eslamdoost et al 2014 proposed a pressure jump method to study the interaction between the waterjet and hull the reason for the negative thrust reduction of the waterjet was analyzed it was found that the resistance increment was not the main cause but the non atmospheric pressure on the nozzle exit caused the negative thrust deduction gong et al 2017 carried out a numerical simulation of a waterjet self propelled ship the virtual disk and overset models were applied to compare the flow fields the results revealed that the hull flow fields from the two models were basically the same but the internal flow field calculated by the overset model was more applicable to the actual state of the impeller yi et al 2017 analyzed the hydrodynamic characteristics of submerged waterjet propulsion by combining experimental and numerical simulation methods and the experimental values were in good agreement with the cfd predictions the predicted resistance thrust and torque errors were 3 7 4 7 and 4 6 respectively at present most waterjet self propulsion studies was based on the virtual disk model miller et al 2006 or body force model rhee and coleman 2009 to simulate the pump effect this method can reduce the calculation cost but the thrust and torque coefficients are obtained in open water and the influence of the hull boundary layer and the non uniform flow distribution of the intake young et al 2011 are not considered because the error of momentum flux is the square of the error of the flow rate a 1 5 2 error of the flow rate can cause a 2 4 error of the momentum flux so the accuracy of the momentum flux depends on the accuracy of the flow rate in this study a waterjet was simulated directly using the steady mrf model which is more accurate than the virtual disk and body force models the overset mesh method was used to cope with the large hull attitude at high speeds the steady multi reference frame model was employed for the rotation of the impellers and the thrust was determined by integrating the forces acting on the waterjet the self propulsion point was obtained by modifying the rotational speeds of the impellers until the horizontal force was balanced numerical simulation and analysis of the self propulsion of a waterjet propelled trimaran were carried out first the resistance of the bare hull with a free surface was calculated numerically and the results were compared with the model test results to verify the accuracy a self propulsion simulation was subsequently performed the powering characteristics of the waterjet were calculated and analyzed the hydrodynamic characteristics of the waterjet and hull were obtained by this numerical study 2 basic theory in the waterjet experiments there are two different methods for predicting the thrust of the waterjet the momentum flux method and the direct thrust measurement method at the 24th international towing tank conference ittc 2005 it was concluded that the direct thrust measurement method was expensive and cumbersome by the waterjet specialist committee since the momentum flux method can select any suitable pump that meets the flow requirement and there is not complicated watertight sealing between the hull and waterjet system the momentum flux method has become the main method used by researchers in experiments and numerical calculations recommended procedures and guidelines for propulsive performance predictions ittc 2005 and uncertainty analysis ittc 2017 based on the momentum flow method were finally proposed based on the continuous improvements by the waterjet specialist committee 2 1 momentum flux theory based on the recommended procedures and guidelines for propulsive performance predictions ittc 2005 a control volume is shown in fig 1 which was applied to analyze the performance of the waterjet system using the momentum flux method numbers with circles denote the station numbers surface 1 is the imaginary capture area and is positioned one impeller diameter in front of the ramp tangency point a surface 2 is the imaginary streamtube which separates the control volume from the flow field surface 3 is the physical boundary of the waterjet system surface 4 is the surface between the stagnation lines and merge lines of hull and duct surface 5 is a section in the intake throat surface 6 is the nozzle section at the station 6 applying newton s second law to the control volume the conservation law of momentum follows the following equation in the i direction 1 a 1 a 6 ρ u i u k n k d a a 1 a 2 a 3 a 6 σ i j n j d a v 3 5 ρ f p i d v v 1 6 ρ f i d v where σ i j is the tensor f p i is the pump force and f i is the external force gravity force the terms on the left and right hand side represent the change in momentum flux and the forces acting on the control volume in the i direction respectively on the right hand side the first term represents the pressure and tangential stress force the second term represents the pump force acting on fluid and the third term represents the gravity force acting on control volume the gross thrust is the definition of the term on the left side of equation 1 the horizontal component of the gross thrust in the x direction is abbreviated as t gross and defined as follows 2 t g r o s s a 1 a 6 ρ u x u k n k d a the intake velocity ratio ivr is defined as the ratio of the average velocity on the capture area u 1 to the hull velocity u and the nozzle velocity ratio nvr is defined as the average velocity on the nozzle section u 6 to the hull velocity u defined as follows 3 i v r u 1 u n v r u 6 u the gross thrust can also be defined as follows 4 t g r o s s a 1 a 6 ρ u x u k n k d a ρ q j u n v r cos θ i v r where θ is the trim angle of the hull q j is the flow rate and the flow rate coefficient was defined as follows 5 k q j q j n d p u m p 3 the net thrust is defined as the force vector acting upon the duct boundary the pump housing and the shaft which directly pass the force through to the hull the horizontal component of the net thrust in x direction is abbreviated as t net and defined as follows 6 t n e t a 3 a 4 σ x d a v 3 5 ρ f p x d v it is difficult to measure the net thrust in experiments and thus the gross thrust is used to define the thrust deduction which is different from the definition in the conventional hull propeller theory the total thrust deduction is defined as the ratio of the difference between the bare hull resistance and the external tow force to the gross thrust and the external tow force accounts for the difference of the frictional resistance coefficient between the model and full scale 7 1 t r b h f d t g r o s s 8 f d 1 2 ρ s u 2 c f m c f s where t is the thrust deduction r bh is bare hull resistance f d is the external tow force s is the wet area of the hull at rest u is the hull velocity at model scale and c fm and c fs are the model and ship frictional resistance coefficients respectively which can be calculated from the 1957 ittc formula 9 c f 0 075 lg r e 2 2 where re is the reynolds number the resistance increment fraction and the waterjet thrust deduction fraction are defined as follows 10 1 t r r b h f d t n e t 1 t j t n e t t g r o s s combining equations 7 and 10 yields the following 11 1 t 1 t r 1 t j 2 2 description of powering characteristics based on the ittc regulations ittc 2005 the overall efficiency of the waterjet hull system η d can be divided into the free steam efficiency η 0 in ideal conditions where the intake velocity of the waterjet is uniform u and the pressure at the nozzle center is atmospheric pressure p 0 and the interaction efficiency η int which accounts for the effect of the waterjet hull interaction 12 η d η 0 η i n t the waterjet hull system is divided into subsystems and the schematic diagram of energy conversion between subsystems and the subsystem efficiencies are shown in fig 2 the free steam efficiency and the interaction efficiency are defined as follows 13 η 0 η i η d u c t η p u m p η i n t 1 t η e i η m i the overall efficiency of the waterjet hull system is given by 14 η d p e p d p e p t e p t e p t e 0 p t e 0 p j s e 0 p j s e 0 p j s e p j s e p p e p p e p d where p e is the effective power p d is the delivered mechanical power p te is the effective thrust power p jse is the effective jet system power p pe is the effective pump power and the other terms with subscript 0 are corresponding powers in the free steam condition the subsystem efficiencies are given as follows thrust deduction 15 1 t p e p t e r b h f d t g r o s s momentum interaction 16 1 η m i p t e p t e 0 t g r o s s t g r o s s 0 1 1 i v r n v r 1 ideal jet efficiency 17 η i p t e 0 p j s e 0 t g r o s s 0 u 0 q j h j s e 0 t g r o s s 0 u 0 e 6 e 0 2 n v r 1 the total axial energy flux e s through a cross sectional area a s at station s is defined as follows 18 e s a s ρ 1 2 u i 2 p ρ g z s u i n i d a energy interaction 19 η e i p j s e 0 p j s e e 6 e 0 e 6 e 1 ducting efficiency 20 η d u c t p j s e p p e e 6 e 0 ρ g q j h 35 pump efficiency 21 η p p p e p d ρ g q j h 35 2 π n q s h a f t 3 hull and waterjet geometry the hull used in this study was a trimaran and its main and side bodies were aligned at the stern the hull and waterjet geometries were at the model scale two waterjet systems were installed on the main body the numbers of impeller blades and guide vanes of the waterjet system were 6 and 11 respectively principal dimensions of the hull and waterjet are shown in table 1 the hull and waterjet model are shown in fig 3 4 computations of bare hull resistance 4 1 numerical methods the numerical simulations were conducted using the finite volume method fvm commercial software star ccm the sst k ω turbulence model was applied to solve governing equations the dimensionless distance from the center of the first grid to the wall is defined as y all y wall treatments cd adapco s c 2015 were selected the viscous sub layer was resolved if y 1 a wall function was used if y 30 and a blending function was used to resolve the buffer region 1 y 30 the volume of fluid vof method hirt and nichols 1981 was used to capture the free surface the convective and temporal discretization schemes were second order upwind schemes the implicit unsteady solver based on the separated flow model was used the physical time step was 0 02 s and there were 10 iterations in each time step a dynamic fluid body interaction dfbi rotation and translation motion ohmori 1998 was applied to simulate the 6 dof motion of hull and the sinkage and trim were free the numerical computational boundary conditions are shown in fig 4 considering the symmetry of the geometry and flow only half of the hull was modeled the computational domain was split into two different regions a background region and an overset region the background region was stationary and the overset region was moving with the hull an overset mesh was built between the background region and the overset region the length width and height of the computation domain were 13l pp 5l pp and 4l pp respectively the inlet was situated 2l pp in front of the stem and the outlet was located 10l pp behind the stern to completely develop the wake field in front of the outlet the vof wave damping length was set 4l pp to avoid the reflection of waves the boundary conditions were set as follows the velocity inlet boundary condition was applied to the inlet side top and bottom of the domain a pressure outlet boundary condition was applied to the outlet a symmetry boundary condition was set at the center plane of the hull a no slip wall boundary condition was used for the hull surface 4 2 mesh independence study of the bare hull computations of the bare hull resistance in calm water were carried out to obtain a complete prediction of the self propulsion an unstructured trimmed mesh was generated in this study six layers of prism meshes with a growth ratio of 1 2 were generated in the boundary layer four levels of blocks were used to refine the mesh around the hull three levels of blocks were used to refine the mesh around the free surface three cones like kelvin waves were used to capture the free surfaces better the mesh of the computational domain is shown in fig 5 a mesh independence study was carried out at fr 0 628 which is the design speed by varying the basic size of the mesh parameters five sets of meshes were generated the basic sizes and the total numbers of the five sets of meshes are shown in table 2 the total resistance coefficient c t is defined as follows 22 c t r t 0 5 ρ s u 2 where r t is the total resistance and s is the wet area of the hull at rest according to the least squares root method proposed by eça and hoekstra 2014 a mesh independence study method for the non uniform refinement ratio the numerical uncertainty of the bare hull was determined the non uniform refinement ratio is defined as follows 23 h i h 1 n 1 3 n i 3 where n i and h i are the total number of meshes and the typical mesh size for mesh number i n 1 and h 1 correspond to the finest mesh the convergence curve of c t is shown in fig 6 considering the computational accuracy and cost mesh number 3 was selected for the computations the numbers of mesh in background region and in the overset region were about 0 74 and 0 95 million the numerical uncertainty for these meshes was 2 65 fig 7 shows the y values on the hull at fr 0 628 4 3 results of bare hull resistance the calm water resistance tests were carried out in norwegian marine technology research institute marintek the hull model was towed by the carriage and equipped with a trip wire at the bow and stern the bare hull resistance was calculated in a speed range of 0 196 fr 0 707 and the hull was free to sink and trim fig 8 shows the computed and measured bare hull resistance results figs 9 and 10 show the sinkage and trim results respectively both the resistance and sinkage were under predicted compared to the experimental results while the trim results were over predicted the minimum resistance sinkage and trim errors were 1 95 9 77 and 4 59 respectively the average resistance sinkage and trim errors were 4 44 13 43 and 7 34 at a high speed range of fr 0 4 in general the calculated results of the bare hull were in good agreement with the experimental results thus the accuracy of the numerical method was verified and the numerical method is applicable and reliable for further calculations of the self propulsion 5 computations of self propulsion 5 1 mesh independence study of the waterjet system because the pump is an important part of the waterjet system to obtain an appropriate mesh size for the waterjet system a mesh independence study was carried out for the pump based on the least squares root method eça and hoekstra 2014 the numerical domain and boundary conditions of the waterjet pump are shown in fig 11 the domain was split into two different regions a stationary region and a rotating region in which the mrf model was set to simulate the rotation of the impellers the inlet was situated 5d duct in front of the pump and the velocity was set to the design flow rate with a uniform velocity distribution atmospheric pressure was applied to the outlet boundary no slip wall boundary conditions were applied to the other boundaries in the mrf model the rotational speeds of the impellers were set to the design rotational speed an unstructured trimmed mesh was generated for the pump feature curves of impellers and guide vanes were generated to refine the mesh around the curves five sets of meshes were generated similar to the mesh independence study of the hull five sets of meshes are shown in table 3 the mesh on the impellers guide vanes and housing of mesh number 3 are shown in fig 12 the thrust coefficient k t and the torque coefficient k q were defined as follows 24 k t t b l a d e ρ n 2 d p u m p 4 k q q s h a f t ρ n 2 d p u m p 5 where t blade is the thrust of all the blades of the pump and q shaft is the shaft torque the convergence curves of k t and k q are shown in figs 13 and 14 the results show that with the increase of mesh density level k t converges to 1 182 gradually and k q converges to 1 214 gradually the torques of mesh number 1 4 are all close to its convergence value considering the accuracies of k t and k q and the computational cost mesh number 3 was selected for further calculations the number of meshes in the rotating region was about 1 08 million and the number of meshes in the remaining region was about 1 82 million the numerical uncertainties of k t and k q for this mesh were 1 06 and 2 18 respectively the mesh for calculating the self propulsion was based on the mesh independence study of the bare hull and the pump since the flow fields around the waterjet intake in the waterjet duct and out of the nozzle were important the meshes in these regions were refined the total number of meshes for the simulation of the self propulsion flow was 4 86 million and the numbers of meshes in the background overset and rotating regions were about 0 68 2 74 and 1 45 million respectively fig 15 shows the mesh around the waterjet duct fig 16 shows the y values on the duct and blades of the waterjet 5 2 numerical methods the numerical method for simulating the self propulsion was similar to the method for simulating the bare hull the difference is that the rotating reference frame in the mrf model was the local hull fixed coordinate system which was moving with the dfbi motion the self propulsion point was obtained by modifying the rotational speeds of impellers until the total resistance was equal to the sum of the net thrust and the tow force it is generally considered that the thrust is proportional to the rotational speed in a small range of rotational speeds after convergence the rotational speed was n 1 and the corresponding horizontal force was fx 1 then n 1 was adjusted to n 2 in a small range and after convergence the corresponding horizontal force was fx 2 n 3 could be obtained according to n 1 n 2 fx 1 and fx 2 by a linear interpolation method by changing the rotational speed three times the horizontal force could be balanced there are two methods to obtain the capture area one method is based on solving a scalar equation and was used by bulten 2006 ding and wang 2010 and eslamdoost et al 2014 the other method is based on tracking streamlines upstream and was used by delaney et al 2009 in this study the latter method was applied streamlines were tracked upstream from station 3 and the shapes of the capture area were fitted by a quadratic polynomial with the streamline data at station 1a fig 17 shows streamlines tracked upstream and the boundary layer at station 1a for fr 0 628 a program was developed using the matlab language to simplify the post processing fig 18 shows the numerical tool for obtaining the capture area the blue dots are the data to be processed and the red line is the fitting curve the program is controlled by six parameters the first parameter is the dead rise angle of the hull at station 1a the second and third parameters are center coordinates of the capture area the fourth and fifth parameters are the extension coefficients used to ensure that the fitting curve exceeds the range of the streamlines and the sixth parameter is the scaling factor because the flow rate of the capture area calculated directly is slightly lower than the flow rate at station 3 a 0 5 1 enlargement of the capture area is needed fig 19 shows the steps for obtaining the capture area the section data of the streamlines blue dots is rotated by the dead rise angle of the hull to reduce gradient and improve the fitting accuracy the section data can be regarded as a convex set and the boundary points of the convex set are calculated the boundary points is fitted by a quadratic polynomial and the fitting curve is extended at the ends the fitting curve is rotated by the dead rise angle in reverse to restore its position the accuracy of the program was mainly affected by the number of streamlines and was tested by changing the number of streamlines with 500 1000 2000 4000 and 8000 the results showed that when the number of streamlines was greater than 1000 the shape of the capture area was no longer changed the shape of the capture area could be easily and accurately obtained by the program with 1000 streamlines and the time cost of post processing was greatly reduced in this paper the capture area was obtained when the sinkage and trim were equal to the averages of that in several periods 5 3 results of the self propulsion self propulsion tests were also carried out in marintek based on the recommended procedures and guidelines for propulsive performance predictions and the trimaran equipped with a twin waterjet propulsion system the flow rate was measured separately for each waterjet in the self propulsion tests wave patterns of the self propulsion at fr 0 314 0 471 and 0 628 are shown in fig 20 5 3 1 results of the resistance sinkage trim and wave pattern the self propulsion was calculated in a speed range of 0 275 fr 0 707 the free surface and the jet flow at fr 0 628 are shown in fig 21 under the impact of the jet flow a high and sharp wave peak formed behind the hull fig 22 shows the computed and measured resistance results of the self propelled hull the experimental resistance was estimated by the gross thrust measured in the self propulsion experiments plus the tow force for without assuming a jet thrust deduction factor the difference between computed and measured resistance of the self propulsion was lower than that of the bare hull figs 23 and 24 show the sinkage and trim results respectively the computed sinkage values were lower than the measured values however the computed trim values were higher than the measured values in the high speed range of fr 0 4 the average sinkage and trim errors were 13 24 and 12 04 respectively like the results of the bare hull simulation the match between the computed resistance sinkage and trim and the measured values was very good on the whole fig 25 shows the comparison of the wave pattern around the bare hull and the hull with the waterjet the wave patterns around the hull were basically the same but the wave patterns behind the hull were significantly different due to the jet flow the height of the stern wave peak was larger than that of the bare hull the width of the stern wave was smaller than that of the bare hull and a high and sharp wave peak formed which is also shown in figs 20 and 21 5 3 2 analysis of the capture area and nozzle section fig 26 shows the shape of the capture area and the velocity distribution on the capture area at different speeds as the boundary layer became thinner from the longitudinal section to the side of the hull the maximum velocity of the capture area was similar to the hull speed with the increase in the hull speed the width of the capture area basically remained unchanged while the height gradually decreased and the area of the capture area decreased monotonously consequently in fig 27 the area of the capture area was non dimensionalized by the ratio of the capture area to the nozzle section area fig 28 shows the velocity distribution on the nozzle section at the station 6 through the rectification of the guide vanes the velocity on the nozzle section was still not uniform the velocity at center of the nozzle section was low with the increase in the froude number the velocity distribution became increasingly more uniform fig 29 shows the calculated and measured ivr and nvr the match between the calculated and measured values was good on average the calculated ivr and nvr were over estimated by 5 13 and 1 32 respectively overall the ivr did not change significantly but the nvr decreased with the increase in the froude number fig 30 shows the comparison of the calculated and measured flow rate coefficients the flow rate coefficient increased slowly with the increase in the froude number the flow rate was over estimated and the average discrepancy was 2 63 finer mesh may be needed for the waterjet to predict the flow rate more accurately as shown in figs 29 and 30 the measured ivr and the flow rate coefficient exhibited slight sudden changes at fr 0 393 which was a critical speed when the trim angle increased rapidly and transom clearance occurred 5 3 3 analysis of powering characteristics to clearly understand the efficiency of energy conversion and the interaction between the ship hull and waterjet the powering characteristics were analyzed based on the theory in section 2 2 the total thrust deduction t and its components t r and t j are shown in fig 31 because the sinkage and trim of the self propulsion was higher than that of the bare hull the resistance increased at self propulsion the resistance increment t r was always positive t r decreased with the increase of speed for fr 0 393 and t r varied in a small range from 0 02 to 0 04 for fr 0 393 the waterjet thrust deduction fraction t j was negative for fr 0 668 meaning that t gross was less than t net and the absolute value of t j decreased with the increase of speed because the absolute values of t r were greater than those of t j the trend of t was similar to that of t r the interaction efficiency η int and its components 1 t η mi and η ei are shown in fig 32 although the values of η ei were about 0 05 greater than those of η mi their trends were basically the same and gradually decreased with the increase of fr the trend of η int was determined by that of 1 t the η int was greater than 1 0 at fr 0 314 indicating that the interaction of the hull and waterjet was beneficial for the rapidity performance the free stream efficiency η 0 and its components η i η duct and η pump are shown in fig 33 the ideal jet efficiency η i increased monotonically due to the monotonic decrease in nvr with the increase of fr the ducting efficiency η duct and the pump efficiency η pump were nearly constant over the entire froude number range the average η duct was 0 974 meaning that the energy loss caused by the duct was a small quantity at self propulsion the loss of the duct was very small when the design of the duct was reasonable the free stream efficiency increased monotonically with the increase of fr and was mainly affected by η i and η pump the overall efficiency η d and its components η int and η 0 are shown in fig 34 the overall efficiency increased with the increase of fr and the efficiency varied from 0 46 to 0 6 which were lower than that of the conventional propellers the overall efficiency was mainly determined by η 0 and influenced by η int in the design of the waterjet determining how to improve the ideal jet and pump efficiencies is important to the overall efficiency 5 3 4 pressure distribution of the waterjet fig 35 shows the pressure distribution on the duct and the blades of the waterjet the pressure distribution coefficient is defined with reference to the atmospheric pressure p 0 as follows 25 c p p p 0 0 5 ρ u 2 the pressure on the duct slowly decreased from the intake to the pump due to the rotation of the impellers the pressure gradient around the pump region varied significantly the guide vanes were in a high pressure environment and the regions near the tip were high pressure regions the regions around the leading edge and the tip clearance of the suction surface of the impellers were low pressure regions and cavitation phenomenon may have occurred 6 conclusion in this paper numerical simulations and analysis on the self propulsion performance of a waterjet propelled trimaran were conducted based on a rans solver the pump effect of the waterjet system was simulated directly by using the mrf model to improve the accuracy of prediction mesh independence studies have been performed for both the bare hull and for the isolated waterjet system to address the numerical uncertainty and define the computational mesh the validity of the numerical method was proven by comparing the numerical results of the bare hull and the self propulsion with the experimental results the good match between the computed and measured results showed that the present numerical method could accurately predict the self propulsion performance a numerical tool was developed to obtain the capture area by tracking streamlines upstream which greatly reduced the time cost of post processing based on the ittc regulations the powering characteristics were investigated to allow the energy conversion processes and the interaction between the hull and the waterjet to be easily understood the main conclusions are presented below 1 with the increase in the hull speed the area of the capture area decreased monotonically and the velocity distribution of the nozzle section became uniform 2 the resistance increment was always positive while the waterjet thrust deduction fraction was negative 3 the interaction of the hull and waterjet was beneficial for the rapidity performance at high speed 4 the energy loss caused by the duct was a small quantity over the entire froude number range 5 for a waterjet propelled ship improving the ideal jet efficiency and the pump efficiency were the main methods to improve the overall efficiency the analysis of the powering characteristics will pave the way for further improvements of the hydrodynamic performance acknowledgements this work was supported by the foundation for key laboratory of national science and technology of china grant number 61422230203 the authors appreciate the second international workshop on waterjet propulsion iwwp 2017 and the workshop on waterjet propulsion technology workshop 2018 for the academic exchange and discussion 
22256,feasible numerical method for the structural analysis of a steel lazy wave riser slwr static configuration is presented the method considers the whole riser which includes a buoyancy section and is partially suspended and partially laid on a seabed as a single continuous segment the riser is modeled by means of nonlinear large deformation beam theory the numerical solution is carried out in an incremental iterative manner allowing efficient treatment of riser seabed interaction circumventing the complexities with contact detection at each increment a new sequential equilibrium configuration is assessed by direct minimization of a total potential energy approximated as a riemann sum which yields algebraic system of nonlinear finite difference equations that is further solved iteratively with newton raphson technique the method does not require as an input a predefined length of the riser but allows its definition from the analysis the method is validated with abaqus representative parametric study is conducted to demonstrate the feasibility of the method considered the effects of the upper section length the buoyancy section length uplift loading ratio the horizontal top tension and ocean current the simplicity flexibility and robustness of the proposed method allow to enhance the efficiency of the engineering calculations and the design keywords buoyancy modules finite difference method energy minimization nonlinear analysis pipeline seabed interaction moving boundary conditions 1 introduction steel catenary risers scr provide a cost effective way to transfer hydrocarbon fluids from subsea units spread over the seabed to floating production systems on the sea surface bai and bai 2014 guo et al 2014 scr can be installed in several types of configurations according to the operating requirements and environmental conditions in conjunction with floating production systems the simplest configuration of scr in which it can be installed is a free hanging catenary fig 1 a this configuration is the easiest to install it requires the least subsea infrastructure and consequently is also the cheapest bai and bai 2014 guo et al 2014 however a free hanging catenary riser may be subjected to a severe periodic loading caused by host vessel movements and subsea currents this leads a riser to being periodically lifted off and lowered down onto the seafloor which affects its fatigue life thomas et al 2010 moreover during lowering down phase the riser due to its relative compression may be subjected to buckling and damage of tensile armor wire around the riser cross section bai and bai 2014 guo et al 2014 finally in deeper waters riser s suspended part becomes longer and its hang off tension grows which may particularly affect the flexible joint connecting the riser with the host vessel bai and bai 2014 borges et al 2014 guo et al 2014 zhang and li 2009 the abovementioned issues are possible to overcome by installing buoyancy modules in specific locations along the riser buoyancy modules are volumes fabricated of light materials such as syntactic foam or a thin walled air can wang et al 2014 whose specific weight is lower than the one of a seawater and thus underwater their buoyant weight becomes negative and provides the uplifting force in fact installation of buoyancy modules provides decoupling of the vessel motions from the touch down point tdp of the riser with a seabed reduction of top tension force which is dominant in these kind of structures and allows maintaining project specific riser configurations by accommodating a proper distance between the vessel and the touch down point so far there are several configurations in which a riser can be installed those configurations mostly differ in the use of buoyancy modules and the methods of anchoring the riser to the seabed bai and bai 2014 guo et al 2014 the most common and the simplest to incorporate the buoyancy modules is a steel lazy wave riser slwr configuration the slwr configuration is achieved by attaching uniformly distributed discrete buoyancy modules along the middle section of the suspended part of the riser while leaving its lower section loosely approach and lay on a seabed prior to its connection to a subsea unit fig 1b among the configurations that incorporate the buoyancy modules slwr requires minimal subsea infrastructure the cheapest and the easiest to install other configurations should be considered if slwr is not appropriate bai and bai 2014 guo et al 2014 nevertheless installing the buoyancy modules complicates either the riser design and its structural analysis first it increases the number of design parameters to consider e g buoyancy section length its location and its specific weight second because of the additional section with different mechanical properties already highly geometrically nonlinear structural analysis of the riser becomes even more severe a proper slwr structural analysis can be carried out by means of purpose oriented commercial software such as orcaflex riflex offpipe cable3d etc or general purpose commercial software e g abaqus dassault systems 2016 that software though can lead to sufficiently refined results usually adopts cumbersome graphical user interface gui which makes constructing and defining the model and processing the results relatively time consuming a riser design in its turn is an iterative process where numerous simulations have to be carried out first an initial riser configuration should be assumed and analyzed guo et al 2014 and then consecutively reanalyzed in order to achieve the optimal configuration consequently a more refined analysis as well as the use of the above commercial software are probably more justified for the final stages of the design some packages allow automation of the post processing for specific studies by using python scripting e g abaqus orcaflex heffernan 2016 python is a general purpose programming language which allows building high level interfaces on top of the commercial software s application programming interface api thus avoiding using gui and customizing a commercial fem software for narrower applications nevertheless it still requires certain programming expertise in this environment consequently through the design process engineers tend to look for more convenient and time saving ways to carry out those analyses proposing simplified static 2d models which however take less phenomena into account and may lead to a lesser precision nevertheless since first order effects which define the general riser configuration are in general static and in 2d those models are a cost effective alternative at least for the intermediate stages of the design lenci and callegari 2005 recently there is a plenty of such simplified models have been proposed ruan et al 2014 wang et al 2015a 2015b 2014 wang and duan 2015 those models usually divide the riser domain into several sections i e upper section buoyancy section lower section and sometimes laid on one fig 1b and consider each section separately applying continuity conditions at the section boundaries some models assume different idealized structural behavior within each section i e a cable with no flexural stiffness or beam undergoing small deformations and consequently have to assume simplifying force continuity conditions others though adopt the same structural behavior and consider a flexural stiffness in all the suspended sections thus eliminating a need for force continuity assumptions are still define separate governing equations for each section solely due to the difference in their gravity forces while the nature of the governing equations remains the same which still complicates the formulation in order to solve this problem in a more convenient way it is useful to derive the equations which characterize the riser configuration at the equilibrium directly by a minimization of a total potential energy of the system trapper 2019 this will eliminate the need to consider each section of the riser separately prescribing compatibility conditions between them and will allow to consider the whole riser as a single continuous section the aim of this paper is to present a simple numerical method for the structural analysis of a slwr the method considers the whole riser which is partially suspended in the water and incorporates a buoyancy section and partially laid on a seabed as a single continuous section the riser is modeled by means of nonlinear large deformation beam theory accounting for a riser seabed interaction the mathematical formulation of the problem is based on a total energy minimization principle e g reddy 2015 the numerical solution is carried out in an incremental iterative manner in two steps at the first step with analogy to pipeline installation process trapper 2019 intermediate solution for the free hanging catenary configuration i e without the buoyancy modules is achieved by incrementing the length of the riser this also allows efficient treatment of the riser seabed interaction circumventing the further complexities with contact detection at the second step the buoyancy upward force is being applied either incrementally in both steps at each increment a new sequential equilibrium configuration is obtained by direct minimization of a total potential energy discretized as a riemann sum which yields algebraic system of nonlinear finite difference equations that further solved with newton raphson iterative technique the innovation of the method presented in this paper is reflected in its efficiency i e its scope and accuracy relative to the complexity of its mathematical and numerical formulations its purpose is to provide a feasible computational tool to an offshore engineer which will help him to develop his own in house code or subroutine in matlab or any widely available programming language for his own particular needs with a fast and convenient processing of the results and have a full control over the calculations instead of using less flexible and more cumbersome commercial software with its time consuming gui for a model definition and data processing the method is very flexible to adaptation of new loads constraints or boundary conditions the relative flexibility and simplicity of the model allows easily conducting sensitivity analyses and re analyses in a single loop in order to define the key roles of various parameters involved and assist the offshore engineer to decide which slwr geometry is preferable in the certain conditions and thus reach the optimum in the design moreover the presented solution technique does not require to define total riser length apriori but allows assessing it as an output of the analysis on the other hand the proposed method is more accurate and much less involved and has a simpler mathematical formulation than the one used in ruan et al 2014 wang et al 2015a 2015b 2014 wang and duan 2015 for example since it does not require dividing the riser into segments considering each segment separately and applying consistency conditions between them moreover application of consistent energy minimization technique within a problem formulation significantly simplifies the mathematical formulation of the problem relative to the considerations of differential element equilibrium more widely accepted in pipeline and riser engineering and consequently makes it easier also to implement it numerically the proposed model adopts the following assumptions and limitations the model is limited to a static planar 2d problem 3d out of plane effects such as torsion lateral buckling walking and etc are not considered the riser is modeled as unshearable inextensible beam such that only bending deformation is considered in addition we consider only elastic riser boundary effects at the top of suspended part which may involve plastic deformations xie et al 2013 are neglected furthermore only linear elastic frictionless seabed in a form of winkler foundation which does not allow tension forces due to soil suction is considered finally in this paper we consider only horizontal and flat seabed still water and constant temperature the paper is organized as follows in the following section we present the proposed methodology discretization and the solution technique then we validate the model with abaqus in what follows representative parameter analyses are conducted to demonstrate the feasibility of the method in particular the effects of upper section length buoyancy section length upward force provided by the buoyancy modules uplift loading ratio the horizontal component of the top tension force supplied by a floating facility and the ocean current are considered 2 model overview the structural analysis of the riser aims at determination of the overall configuration including the horizontal distance of a touchdown point tdp from a hang off point hop the embedment into the seabed and determination of the internal forces bending moments shear forces and tension in addition the minimum length of the riser is also not known a priory and has to be defined installation of the buoyancy modules along some specific length of the suspended part of the riser results in its division into several sections fig 2 as follows 1 the upper section of length l u which connects between hop and the buoyancy section at point bu and usually contains a sag bend 2 the buoyancy section of length l b which is located between bu and bl points where the buoyancy modules are installed which by applying an upward force cause the section to form an arch bend though the buoyancy modules are discrete in this paper we adopt their effect as averaged over the length of the buoyancy section i e we adopt their equivalent submerged weight per unit length in addition we assume that the effect of buoyancy modules attachment on a flexural stiffness of the riser is negligible qiao et al 2016 3 the lower section of length l l which connects the buoyancy section at bl to the seabed at tdp 4 the touch down section of length l t d which connects between the tdp and the all as laid limit point and 5 the as laid section of length l a l where the embedment of the riser into the seabed is solely due to self weight the combined length of the touch down and the as laid sections we define as the laid on section of length l s l t d l a l and the total length of the riser l l u l b l l l t d l a l while the lengths of the upper section l u and the buoyancy section l b are prescribed the lengths of the lower section l l and the touch down section l t d are not known in advance and will be available as an output of the analysis apparently l s and l are not known in advance either in this study we define the length of the touch down section l t d and consequently a minimum total length of the riser such that the as laid embedment i e the embedment solely due to the self weight at the touch down section end point all as laid limit will naturally take place hence the as laid section l a l is not a part of the slwr minimal length l m i n l u l b l l l t d but it can exist if the length is extended beyond the minimal one in reality the above condition is not unique and may depend on a nature of a subsea unit connection at the bottom end of the riser e g well flowline etc i e the vertical displacement at the bottom end may be prescribed and not just be solely due to self weight of course those conditions can be adapted within the present model as well in case it is required however their effect on the overall configuration of the slwr will be negligible and consequently in this paper we will consider only the conditions as described above in what follows we present mathematical formulation and numerical technique to assess static equilibrium at each step of the analysis 3 mathematical formulation the model is established in the global coordinate system xy where the origin is set at top left corner of the domain fig 3 with x axis refers in the direction of the host vessel location to the right and y axis refers downwards to the seabed let us consider an elastic riser of length l constrained to deform in plane partially laid on a seabed with a linear stiffness per unit length k s along the length l s at depth h w and partially suspended fig 3 the riser is subjected to a distributed submerged self weight w g along its entire length distributed buoyancy load w b along the length of the buoyancy section l b distributed hydrodynamic loads f x and f y in x and y directions respectively due to an ocean current at the velocity v x and a horizontal tension point load p 0 which is controlled by the host vessel at hop the riser configuration is given by θ s which defines its local orientation where s is the arclength distance along the riser 0 s l measured from the fixed point fp the geometric boundary conditions for the above configuration are as follows at point fp the riser is restrained in x direction and against the rotation while is free to move in y direction 1 x 0 0 2 θ 0 2 π on the other hand at hop the riser is connected to a host vessel with a ball joint connection i e restrained in y direction while is free to rotate and move in x direction 3 y l 0 a desired distance in x direction is maintained by controlling p 0 by the host vessel rather than directly specifying the displacement then the position of the riser is given by cartesian coordinates x and y as follows 4 x s 0 s cos θ s d s 5 y s s l sin θ s d s pay attention eqs 4 and 5 automatically satisfy boundary conditions 1 and 3 by establishing the xy coordinate system in the way as described above the boundary conditions 1 and 3 are naturally adapted in the formulation i e in the easiest manner establishing model in a different coordinate system rather than the one in fig 3 may require more sophisticated ways to specify those boundary conditions e g by means of the lagrange multipliers audoly and pomeau 2010 which might significantly complicate the formulation in this paper we shall derive the equations which will define the riser configuration at equilibrium directly from minimum total potential energy principle this principle says that among all the possible geometric configurations consistent with the geometric constraints and forces applied to the system only the one that minimizes the total potential energy corresponds to the stable equilibrium configuration e g reddy 2015 in a static case the total potential energy consists of elastic strain energy of deformed body and potential energy of applied forces the above approach is usually simpler than a more widely accepted way in engineering to derive field equations by considering balance of forces and moments acting on the differential part of the body e g lenci and callegari 2005 wang et al 2010 yuan et al 2014 2012 zan et al 2016 the energy approach as described above naturally accounts for applied loads including force boundary conditions and often leads towards more convenient mathematical expressions such as lower order equations sometimes with even less variables audoly and pomeau 2010 nevertheless both methods eventually yield the same results for the system as shown in fig 3 the total potential energy is given by 6 u t o t 1 2 l e i κ s 2 d s 1 2 l s k s e s 2 d s l w g y s d s l b w b y s d s l f x x s d s l f y y s d s p 0 x l where e is the young s modulus of the riser i is the moment of inertia of the riser s cross section κ is its planar curvature 7 κ s d θ s d s and e s is the embedment of the riser into the seabed l s is a length of a section that is in contact with soil laid on section and l b is a length of a buoyancy section the first term in eq 6 represents the bending elastic energy stored in a deformed riser since in this paper we consider only planar deformation of inextensible unshearable riser the strain energy is contributed exclusively by in plane bending the second term in eq 6 represents the elastic energy stored in the deformation of elastic seabed since there is only a fraction of the riser that is in contact with a seabed while the other fraction is being suspended the embedment of the riser into the seabed e s is defined piecewise by 8 e s e y s y s h w y s h w 0 y s h w we assume that there is no suction force in a case of a separation randolph and gourvenec 2011 then the seabed support reaction per unit length is given by 9 r s s k s e s the third term in eq 6 represents the potential energy of submerged self weight of the riser w g the forth term in eq 6 represents the potential energy of submerged self weight of the buoyancy modules averaged over the section length w b the fifth and the sixth terms in eq 7 represent the potential energy of distributed loads f x and f y in x and y directions respectively due to ocean current in order to account for hydrodynamic loads due to ocean current at the velocity v x we adopt morison s equations morison et al 1950 which in a case of a steady flow provide drag forces exerted by ocean current on submerged objects those forces per unit length of the pipe in the normal and tangential directions are given as follow 10 f n 1 2 ρ w c n d v x y sin θ v x y sin θ 11 f τ 1 2 ρ w c τ π d v x y cos θ v x y cos θ where d is the outer diameter of the pipe and c n and c τ are the normal and tangent drag coefficients respectively projecting these forces in x and y directions yield 12 f x f n sin θ f τ cos θ 13 f y f n cos θ f τ sin θ and the last term in eq 6 represent the potential energy of the horizontal top load p 0 controlled by the host vessel once θ s is defined it is possible to evaluate bending moments shear forces and tension using the usual differential relations 14 m s e i κ s 15 s s d m s d s 16 d t s d s f x cos θ s f y w s sin θ s where 17 w s w g w b s l b 0 s l b is a generalized gravity load 4 numerical implementation 4 1 finite difference discretization to solve the above defined problem we adopt finite difference method which is probably the simplest method for the problem nevertheless finite element method for example can be either applied the total potential energy of the riser eq 6 can be expressed in terms of discrete variables θ i fig 4 written as a left riemann sum as follows 18 u t o t δ s i 1 n 1 2 e i θ i 1 θ i δ s 2 i 1 n 1 1 2 k s b i y i h w 2 i 1 n 1 w i y i i 1 n 1 f x i x i i 1 n 1 f y i y i p 0 x n 1 where i and j are the indices in what follows both indices are used interchangeably there are n subintervals of size δ s l n and n 1 nodes the seabed stiffness k s b i at node i obtained by rewriting eq 9 as follows 19 k s b i k s δ s y i h w 0 y i h w generalized gravity load at each riser s node is now given by 20 w i w s δ s and node hydrodynamic drag loads by 21 f x i f n i sin θ i f τ i cos θ i 22 f y i f n i cos θ i f τ i sin θ i which are obtained by projecting discrete drag components 23 f n i 1 2 ρ w c n d δ s v x i sin θ i v x i sin θ i 24 f τ i 1 2 ρ w c τ π d δ s v x i cos θ i v x i cos θ i to the xy frame at each step the riser configuration is given rewriting eqs 4 and 5 as discrete values as follows 25 x i j 1 i 1 cos θ j δ s 26 y i j i n sin θ j δ s in order to achieve a proper riser configuration at static equilibrium we look for an extremum which yields minimum of total energy which is a function of n 1 discrete variables θ 1 θ n 1 with respect to n discrete variables θ 2 θ n 1 27 u t o t θ 1 θ n 1 θ i 0 for i 2 n 1 the conditions of stationarity with respect to θ 1 is not required since this value is known from boundary conditions 2 and can be directly substituted i e θ 1 2 π substituting eq 17 26 into eq 27 yields 28 e i δ s θ i 1 2 θ i θ i 1 j 1 i k s b j k j n δ s sin θ k h w δ s cos θ i j i 1 n 1 f x j δ s sin θ i j 1 i f y j w j δ s cos θ i p 0 δ s sin θ i 0 for i 2 n 1 which is a set of difference equations in terms of θ i in order to obtain a more convenient expression for 28 it is reasonable to change the order of summation in a second term by adopting the fubini principle for sequences 29 j 1 i k s b j k j n δ s sin θ k j 1 n δ s sin θ j k 1 min i j k s b k and introduce the accumulated values as follow 30 k s b i k 1 i k s b k 31 w i k 1 i w k 32 f x i k i n 1 f x k 33 f y i k 1 i f y k substituting eq 29 33 into eq 28 yields 34 e i δ s θ i 1 2 θ i θ i 1 δ s cos θ i j 1 n k s b min i j δ s sin θ j h w k s b i δ s cos θ i f x i δ s sin θ i f y i w i δ s cos θ i p 0 δ s sin θ i 0 eq 34 is an algebraic system of n equations with n unknowns θ i i 2 n 1 which defines a static configuration of the riser 4 2 solution technique the system 34 is essentially nonlinear and we shall apply newton raphson method nocedal and wright 2006 to solve it newton raphson method is an iterative technique which requires an initial estimate for the solution and then at each iteration a new closer approximation is computed the process quits when the difference in approximation between the iterations becomes negligible the success of the process may actually depend on how close the initial estimate is if the initial estimate is too far from the real solution the process may not converge therefore we will put special attention to have a good initial estimate for the solution before we approach the solution of 34 to define riser configuration we shall remember that the total length of the riser is not known in advance as well as the length of the lower section and the laid on part therefore we proceed the solution of 34 in an incremental iterative manner in two steps as follows fig 5 in a first step we set a free hanging riser configuration with a sufficient laid on portion by incrementing the riser s length and in a second step we keep the total length constant and incrementally apply the buoyancy forces to the buoyancy section 4 2 1 first step in the first step we proceed as follows first we set the initial configuration in a form of a free hanging catenary e g kang et al 2015 of some initial length l 0 such that it will have no more than one point in a contact with a seabed the above configuration can be given by a catenary equation d tan θ d s w p 0 which ignores the bending stiffness solving it specifying zero slope boundary condition at fixed point fp and accounting for water depth h w yield both the initial arc length of the riser l 0 35 l 0 p 0 w sinh arcosh w p 0 h w 1 and its corresponding configuration 36 θ i 0 2 π arctan w p 0 i 1 δ s this catenary configuration will serve as the initial estimate for newton raphson process as described above for the first increment l 1 l 0 δ l next the solution is carried out in an incremental iterative way following the analogy to a pipe lay process where the pipeline with a fixed end fp on the bottom in x direction being gradually released from the laying vessel into the water fig 5 at each consequent increment m the riser length is being increased by δ l δ s i e l m l m 1 δ l and iteratively solved to obtain a new static equilibrium and thus a new consequent configuration during this process riser s nodes are laid down and one by one they come into a contact with the seabed soil active set wriggers 2006 of contact nodes beyond the tdp is sequentially updated with a new node namely at each iteration the contact force is being applied to the node j if it falls beyond the water depth i e y j h w literally this is done by updating k s b j value in 22 to yield new values for k s b i and k s b min i j the process should quit when the effect of the boundary conditions at laid end point fp on the overall configuration becomes negligible i e the internal forces and the embedment at any point on the riser segment between hop and aal fig 2 do not change any longer with the length increments fig 5 line 3 since in the second step some nodes in the neighborhood of tdp will be elevated and tdp will relocate back again it is recommended to continue the abovementioned process even longer or to simply artificially increase the length of the as laid section fig 5 dashed blue line 4 it should be noted that this step involves moving boundary conditions during this step at each increment the dimensions of the whole system grow by one n m n m 1 1 since we add additional node and subinterval for each subsequent length increment as initial estimate serves the configuration from the previous length increment fig 5 which then being again updated iteratively by newton raphson technique 4 2 2 second step in the second step we apply the uplift force throughout this step we keep the riser length constant and incrementally increase the uplift force at nodes located within the buoyancy section l b by updating their generalized gravity loads w i at increment m as follows w i m w i m 1 δ w b and thus w i in 31 throughout this process the nodes close to the tdp will elevate again fig 5 line 5 consequently during this step k s b j in 30 are being updated again to yield new values for k s b i and k s b min i j 4 2 3 typical increment in fact aside from the above mentioned updates in both steps typical increment and typical iteration are similar and proceed as follows for the sake of clarity let us rewrite eq 34 for increment m in a matrix form as follows 37 k θ m f θ m 0 we solve eq 37 iteratively with newton raphson method nocedal and wright 2006 linearizing eq 37 with a first order term of taylor series expansion yields the following linear equation for iteration n 38 k df d θ θ m n 1 δ θ m n k θ m n 1 f θ m n 1 with 39 θ m n θ m n 1 δ θ m n which is solved consecutively the iterative process quits when δ θ m n meets the convergence criterion the solution of previous increment θ m 1 serves as initial estimate for subsequent increment θ m 0 θ m 1 the expressions which appear in eq 38 are as follows 40 k e i δ s 1 2 1 and the other nonlinear terms are presented here in a form of matrix entries 41 f θ m n 1 i δ s cos θ i m n 1 j 1 n k s b min i j m n 1 δ s sin θ j m n 1 h w k s b i m n 1 δ s cos θ i m n 1 f x i m n 1 δ s sin θ i m n 1 f y i m n 1 w i m n 1 δ s cos θ i m n 1 p 0 δ s sin θ i m n 1 42 df d θ θ m n 1 i j δ s cos θ i m n 1 k s b min i j m n 1 δ s cos θ j m n 1 δ i j df d θ θ m n 1 i i 43 df d θ θ m n 1 i i δ s sin θ i m n 1 j 1 n k s b min i j m n 1 δ s sin θ j m n 1 h w k s b i m n 1 δ s sin θ i m n 1 f x i m n 1 δ s cos θ i m n 1 f y i m n 1 w i m n 1 δ s sin θ i m n 1 p 0 δ s cos θ i m n 1 where δ i j is a kronecker delta 44 δ i j 0 if i j 1 if i j once the variables θ i are calculated bending moments shear forces and tension can be back calculated by using eq 14 16 in their discrete forms as follows 45 m i e i κ i e i θ i θ i 1 δ s 46 s i m i m i 1 δ s 47 t i p 0 j i 1 n f x j cos θ i r h o p j i 1 n f y j w j sin θ i where the vertical reaction at hop fig 7 is given by 48 r h o p t n 1 sin θ n 1 s n 1 cos θ n 1 and axial tension at hop by 49 t n 1 p 0 s n 1 sin θ n 1 cos θ n 1 5 validation and parameter analysis in what follows we present the validation of the proposed method with abaqus finite difference grid convergence and the parameter analysis for all the forthcoming calculations we adopt the basic set of parameters as summarized in table 1 all the calculations except for abaqus reference solution were performed with matlab we adopt the riser dimensions materials and other parameters in a range as proposed by ref bai and bai 2014 guo et al 2014 randolph and gourvenec 2011 other parameters which appear in eq 6 are calculated as follows the moment of inertia of the riser s cross section is given by i π 4 d 2 4 d 2 t 4 while its area by a π d 2 2 d 2 t 2 a submerged buoyant density of the riser is given by ρ b ρ s ρ w for the sake of simplicity we assume the riser being filled with water then the submerged gravity load per unit length of the riser is given by w g ρ s ρ w g a and the average submerged weight per unit length of the buoyancy modules is given by w b ρ b ρ w g a b where a b is the averaged area of the buoyancy modules cross section in what follows the results are presented for the quantities as illustrated in fig 6 where e m a x is the maximum embedment e w k s is the as laid embedment and r s m a x is the maximum seabed support reaction seabed support reaction at as laid part is r s w g though we formulate the problem in the global coordinate system xy for the sake of convenience we adopt two additional abscissas to present the results the first one x h o p measured from the hop and the second one x t d p measured from the tdp both in negative x directions fig 6 5 1 validation and comparison the present method is first validated through the basic case adopting the characteristics as presented in table 1 with finite element solution by abaqus standard dassault systems 2016 for the sake of comparison a riser with a total length of 3024 m was selected in abaqus model two node hybrid linear beam elements b21h were used to model the riser the seabed is modeled as 2d planar analytical rigid shell body the contact between the riser and the seabed is defined using softened contact pressure overclosure relationship dassault systems 2016 comparisons of the configuration embedment tension shear forces and bending moments for varying size of subintervals δ s 8 1 m and for abaqus solution element size h el 0 5 m are shown in fig 7a b c d e respectively from these figures it can be seen that the results obtained by the proposed method and abaqus are in an excellent agreement since abaqus formulation adapts extensibility and shear flexibility we can also see the authenticity of those assumptions fig 8 show the convergence of maximum values of the above variables with increase in a number of subintervals for the proposed method it can be seen that all the tested quantities converge with a grid refinement with each grid refinement by twice the change in the solution drops the maximum error of the solution for various grids relatively to the solution with dense grid δ s 1 m is shown in table 2 it can be seen that for the embedment tension and bending moments the errors are less than 1 even for the coarse grid δ s 8 m on the other hand shear force at its peak value converges much slower about 10 even for δ s 2 m the reason for the later lays in the abrupt change in a shear force which is smeared over one subinterval 5 2 parameter analysis in what follows we present the parameter analysis the basic set of parameters is as summarized in table 1 at each simulation we change the value of only one specific parameter the parametric study presented in this paper is by no means comprehensive the aim of this study is to demonstrate the general scope of the proposed method and to show the general tendencies rather than provide specific design values consequently the conclusions raised about the results in the following subsections are related only to the used parameter ranges table 1 5 2 1 effect of upper section length in this series we perform a set of five simulations for different lengths of the upper section l u 1400 m 1600 m 1800 m 2000 m and 2200 m other parameters adopted for this series are kept constant as in table 1 fig 9 a shows the plot of configurations for different lengths of the upper section l u fig 9b plots the minimum total length of the riser l m i n which grows with an increase in l u horizontal distance from the hang off point hop to the touchdown point tdp l h o p t d p grows almost linearly with a growing length of the upper section as shown in fig 9c as shown in fig 9d vertical reaction between the riser and the floating production facility at hop also almost linearly grows with a growing length of the upper section while the hang off angle φ 0 fig 9e almost linearly drops with a growing length of the upper section both riser embedment and seabed support reaction for the chosen parameters look insensitive of the length of the upper section fig 10 a and b approaching as laid embedment and submerged self weight respectively beyond the tdp at steady state in reality accurately assessing riser embedment into the seabed is very important since it affects riser stability against hydrodynamic forces host vessel movements sideways and lateral buckling lateral and axial soil resistance and thermal insulation aubeny and biscontin 2009 dean 2010 mccarron 2011 palmer 2008 randolph and gourvenec 2011 randolph and white 2008 shiri 2014 fig 11 a c e depict axial tension shear forces and bending moments for different lengths of the upper section since riser is a tension dominated structure axial tension is the most important force within the following analyses it can be seen that in all of the following cases the resulting values of axial tension are higher by an order of magnitude than the resulting values of shear forces and bending moments by decreasing the length of the upper section axial tension at hop drops while maximum axial tension at buoyancy section grows both in almost linear manner fig 11b fig 11d shows that for a longer upper sections maximum shear force drops finally fig 11e and f indicate that bending moments are nearly constant along each section and insensitive to the upper section length 5 2 2 effect of buoyancy section length in this series we perform a set of five simulations for different lengths of the buoyancy section l b 300 m 450 m 600 m 750 m and 900 m other parameters adopted for this series kept constant as in table 1 fig 12 a shows the plot of configurations for different lengths of the buoyancy section l b fig 12b plots the minimum total length of the riser l m i n which grows linearly with an increase in l b horizontal distance from the hop to the tdp l h o p t d p grows almost linearly with growing length of the buoyancy section as shown in fig 12c as shown in fig 10d vertical reaction between the riser and the floating production facility at hop drops with a growing length of the buoyancy section while hang off angle φ 0 fig 10e grows with a growing length of the buoyancy section however both as in a case with l h o p t d p in a linear manner fig 13 a c d depict axial tension shear forces and bending moments for different lengths of the upper section by increasing the length of the buoyancy section axial tension at hop drops while maximum axial tension at buoyancy section grows both in almost linear manner fig 13d shows that the maximum shear force first grows with l b till 450 m and then drops down the reason for this behavior can be retrieved from fig 12a at l b 450 m the slope of the riser at the maximum shear force location a right boundary of a buoyancy section is flat which means that all the perturbation in vertical forces due to appearance of an upward buoyancy force is transformed to shear in all other cases shear obtains only a component fig 13e and f indicate that maximum bending moment as in a previous section is almost insensitive to the length of the buoyancy section 5 2 3 effect of uplift loading ratio in this series we perform a set of six simulations for different uplift loading ratios r u p 0 1 1 5 2 2 5 and 3 other parameters adopted for this series kept constant as appear in table 1 fig 14 a shows the plot of configurations for different uplift loading ratios r u p w b w g fig 12b plots the minimum total length of the riser l m i n which grows almost linearly with an increase in r u p horizontal distance from the floating production facility hop to the tdp l h o p t d p increases with uplift loading ratio as shown in fig 14c as is shown in fig 14d vertical reaction between the riser and the floating production facility at hop nearly linearly drops with the increase in uplift loading ratio while the hang off angle φ 0 nearly linearly grows fig 14e fig 15 a c e depict axial tension shear forces and bending moments along the riser for different uplift loading ratios since the bending stiffness of the riser is relatively small the riser response is dominated by tension axial tension is about three orders of magnitude higher than shear forces as the uplift force applied on the riser by the buoyancy modules grows the maximum tension at hop drops while maximum tension at buoyancy section grows fig 15b from r u p 1 up to r u p 2 an increase in the uplift loading ratio leads to an increase in a maximum shear force however from r u p 2 it drops down the reason for such a behavior as in a previous subsection lays in a slope of the riser at the maximum shear force location a right boundary of a buoyancy section as shows fig 15d for r u p 2 it is flat which means that all the perturbation in vertical forces due to appearance of an upward buoyancy force is directly transformed to shear in all other cases shear takes only a component from r u p 1 the uplift loading ratio linearly increases the bending moments at buoyancy section while bending moments at upper and lower sections remain constant and almost insensitive to r u p fig 15e and f as it can be seen from nearly all the figures a substantial change in the behavior starts above r u p 1 i e for when the upward force is higher than the buoyant gravity below that value the attachment of the buoyancy modules makes no sense 5 2 4 effect of a horizontal top tension load supplied by a host vessel in what follows we study the effect of the horizontal top tension force supplied by the floating facility on a riser through ball joint the horizontal top tension force p 0 should not be confused with the axial tension t within a riser in this series we perform a set of six simulations for different horizontal top tension forces p 0 0 1 mn 0 2 mn 0 4 mn 0 8 mn 1 6 mn and 3 2 mn other parameters adopted for this series kept constant as in table 1 fig 16 a shows the plot of configurations for different horizontal top tension force p 0 as p 0 grows the effect of arch bend becomes less visual fig 16a fig 16b plots the minimum total length of the riser l m i n which grows almost linearly with an increase in p 0 as well as vertical reaction between the riser and the floating production facility at hop fig 16d on the other hand horizontal distance from the hop to the tdp l h o p t d p and the hang off angle φ 0 also increase with p 0 as shown in fig 16c e however the rate of their growth with a growth in p 0 slows down fig 17 a and b depict the embedment and the support reaction respectively near the tdp it can be seen that for higher p 0 values the maximum embedment and the maximum support reaction approach the as laid embedment and the submerged self weight respectively it is obvious that maximum axial tension grows with a rise in a horizontal top tension however in order to study this effect more explicitly it is useful to look at the normalized axial tension values t p 0 and t m a x p 0 rather than an absolute ones fig 18 a and b fig 18a and b shows that though the maximum axial tension grows with a rising horizontal top tension maximum normalized axial tension drops i e tension in all material points along the pipeline approaches the horizontal top tension as the horizontal top tension grows the drop in a normalized axial tension at hop as the horizontal top tension grows is more substantial than the drop in a normalized maximum axial tension at buoyancy section for higher horizontal top tension values the assumption of a constant tension distribution along the riser yuan et al 2014 2012 becomes more reasonable fig 18c e depict absolute values of shear forces and bending moments for different horizontal top tension it can be seen that all the shear forces and the bending moments at arch bend and sag bends drop exponentially with a rise in a horizontal top tension fig 18d f as in previous subsections the maximum shear force depends on a slope of the riser at its location fig 18d in order to highlight this slope transition additional simulations with p 0 equal to 0 15 mn and 0 3 mn were performed and added to fig 18b d f 5 2 5 effect of ocean current velocity in what follows we study the effect of the ocean current velocity for the sake of simplicity we assume a parabolic velocity distribution with a depth v x y v 0 1 y h w 2 and perform a set of five simulations for different ocean current surface velocities v 0 1 m sec 0 5 m sec 0 m sec 0 5 m sec and 1 m sec other parameters adopted for this series kept constant as in table 1 fig 19 a shows the plot of configurations for different ocean current surface velocity v 0 fig 19b c d e depict axial tension shear forces bending moments and the embedments along the riser as fig 19b c d e indicate the effect of v 0 is almost linear near v 0 0 however grows sharper with the increase in the current velocity in both directions moreover fig 19b c d e also show that the behavior is not symmetric around v 0 0 the reason for this is that the loads due to the water currents also highly affect the axial tension within the riser subsection 5 2 4 the above coupled effect of the hydrodynamic loads with the axial tension is the major reason of this non symmetric response to demonstrate this non symmetric behavior we present a curve for a horizontal distance from the hop to the tdp l h o p t d p vs v 0 fig 19f 6 conclusions feasible numerical method for the structural analysis of a steel lazy wave riser static configuration is presented the method considers the whole riser which includes a buoyancy section and is partially suspended and partially laid on a seabed as a single continuous segment the equations which characterize the riser configuration at the equilibrium are derived directly by a minimization of a discretized total potential energy of the system the numerical solution allows efficient treatment of riser seabed interaction circumventing the complexities with a contact detection the method does not require a predefined length of the riser as an input but allows its definition from the analysis the parameter analysis has shown that the installation of buoyancy modules along some length of suspended part of the riser causes a reduction in a maximal tension force along the riser which is at hang off point the upward force provided by the buoyancy modules should be higher than the buoyant gravity of the riser otherwise there is no substantial change in the behavior and the attachment of the buoyancy modules makes no sense also it was observed that for higher horizontal top tension values the assumption of constant tension force along the riser yuan et al 2014 2012 becomes more reasonable comparison with abaqus beside the good agreement showed that for the parameters given in table 1 the assumption that the riser is unshearable and inextensible works very well in general direct minimization of a total potential energy is valid only for conservative systems where after the loading removal both the seabed and the pipeline return to their undisturbed initial state however since we apply loads and solve for equilibrium in an incremental manner we can sequentially calculate the dissipated energy through each increment and sequentially update the total energy for the rest of the analysis and thus analyze non conservative and path dependent problems the simplicity flexibility and robustness of the proposed method allow to enhance the efficiency of engineering calculations and design declaration of competing interest none acknowledgements this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors 
22256,feasible numerical method for the structural analysis of a steel lazy wave riser slwr static configuration is presented the method considers the whole riser which includes a buoyancy section and is partially suspended and partially laid on a seabed as a single continuous segment the riser is modeled by means of nonlinear large deformation beam theory the numerical solution is carried out in an incremental iterative manner allowing efficient treatment of riser seabed interaction circumventing the complexities with contact detection at each increment a new sequential equilibrium configuration is assessed by direct minimization of a total potential energy approximated as a riemann sum which yields algebraic system of nonlinear finite difference equations that is further solved iteratively with newton raphson technique the method does not require as an input a predefined length of the riser but allows its definition from the analysis the method is validated with abaqus representative parametric study is conducted to demonstrate the feasibility of the method considered the effects of the upper section length the buoyancy section length uplift loading ratio the horizontal top tension and ocean current the simplicity flexibility and robustness of the proposed method allow to enhance the efficiency of the engineering calculations and the design keywords buoyancy modules finite difference method energy minimization nonlinear analysis pipeline seabed interaction moving boundary conditions 1 introduction steel catenary risers scr provide a cost effective way to transfer hydrocarbon fluids from subsea units spread over the seabed to floating production systems on the sea surface bai and bai 2014 guo et al 2014 scr can be installed in several types of configurations according to the operating requirements and environmental conditions in conjunction with floating production systems the simplest configuration of scr in which it can be installed is a free hanging catenary fig 1 a this configuration is the easiest to install it requires the least subsea infrastructure and consequently is also the cheapest bai and bai 2014 guo et al 2014 however a free hanging catenary riser may be subjected to a severe periodic loading caused by host vessel movements and subsea currents this leads a riser to being periodically lifted off and lowered down onto the seafloor which affects its fatigue life thomas et al 2010 moreover during lowering down phase the riser due to its relative compression may be subjected to buckling and damage of tensile armor wire around the riser cross section bai and bai 2014 guo et al 2014 finally in deeper waters riser s suspended part becomes longer and its hang off tension grows which may particularly affect the flexible joint connecting the riser with the host vessel bai and bai 2014 borges et al 2014 guo et al 2014 zhang and li 2009 the abovementioned issues are possible to overcome by installing buoyancy modules in specific locations along the riser buoyancy modules are volumes fabricated of light materials such as syntactic foam or a thin walled air can wang et al 2014 whose specific weight is lower than the one of a seawater and thus underwater their buoyant weight becomes negative and provides the uplifting force in fact installation of buoyancy modules provides decoupling of the vessel motions from the touch down point tdp of the riser with a seabed reduction of top tension force which is dominant in these kind of structures and allows maintaining project specific riser configurations by accommodating a proper distance between the vessel and the touch down point so far there are several configurations in which a riser can be installed those configurations mostly differ in the use of buoyancy modules and the methods of anchoring the riser to the seabed bai and bai 2014 guo et al 2014 the most common and the simplest to incorporate the buoyancy modules is a steel lazy wave riser slwr configuration the slwr configuration is achieved by attaching uniformly distributed discrete buoyancy modules along the middle section of the suspended part of the riser while leaving its lower section loosely approach and lay on a seabed prior to its connection to a subsea unit fig 1b among the configurations that incorporate the buoyancy modules slwr requires minimal subsea infrastructure the cheapest and the easiest to install other configurations should be considered if slwr is not appropriate bai and bai 2014 guo et al 2014 nevertheless installing the buoyancy modules complicates either the riser design and its structural analysis first it increases the number of design parameters to consider e g buoyancy section length its location and its specific weight second because of the additional section with different mechanical properties already highly geometrically nonlinear structural analysis of the riser becomes even more severe a proper slwr structural analysis can be carried out by means of purpose oriented commercial software such as orcaflex riflex offpipe cable3d etc or general purpose commercial software e g abaqus dassault systems 2016 that software though can lead to sufficiently refined results usually adopts cumbersome graphical user interface gui which makes constructing and defining the model and processing the results relatively time consuming a riser design in its turn is an iterative process where numerous simulations have to be carried out first an initial riser configuration should be assumed and analyzed guo et al 2014 and then consecutively reanalyzed in order to achieve the optimal configuration consequently a more refined analysis as well as the use of the above commercial software are probably more justified for the final stages of the design some packages allow automation of the post processing for specific studies by using python scripting e g abaqus orcaflex heffernan 2016 python is a general purpose programming language which allows building high level interfaces on top of the commercial software s application programming interface api thus avoiding using gui and customizing a commercial fem software for narrower applications nevertheless it still requires certain programming expertise in this environment consequently through the design process engineers tend to look for more convenient and time saving ways to carry out those analyses proposing simplified static 2d models which however take less phenomena into account and may lead to a lesser precision nevertheless since first order effects which define the general riser configuration are in general static and in 2d those models are a cost effective alternative at least for the intermediate stages of the design lenci and callegari 2005 recently there is a plenty of such simplified models have been proposed ruan et al 2014 wang et al 2015a 2015b 2014 wang and duan 2015 those models usually divide the riser domain into several sections i e upper section buoyancy section lower section and sometimes laid on one fig 1b and consider each section separately applying continuity conditions at the section boundaries some models assume different idealized structural behavior within each section i e a cable with no flexural stiffness or beam undergoing small deformations and consequently have to assume simplifying force continuity conditions others though adopt the same structural behavior and consider a flexural stiffness in all the suspended sections thus eliminating a need for force continuity assumptions are still define separate governing equations for each section solely due to the difference in their gravity forces while the nature of the governing equations remains the same which still complicates the formulation in order to solve this problem in a more convenient way it is useful to derive the equations which characterize the riser configuration at the equilibrium directly by a minimization of a total potential energy of the system trapper 2019 this will eliminate the need to consider each section of the riser separately prescribing compatibility conditions between them and will allow to consider the whole riser as a single continuous section the aim of this paper is to present a simple numerical method for the structural analysis of a slwr the method considers the whole riser which is partially suspended in the water and incorporates a buoyancy section and partially laid on a seabed as a single continuous section the riser is modeled by means of nonlinear large deformation beam theory accounting for a riser seabed interaction the mathematical formulation of the problem is based on a total energy minimization principle e g reddy 2015 the numerical solution is carried out in an incremental iterative manner in two steps at the first step with analogy to pipeline installation process trapper 2019 intermediate solution for the free hanging catenary configuration i e without the buoyancy modules is achieved by incrementing the length of the riser this also allows efficient treatment of the riser seabed interaction circumventing the further complexities with contact detection at the second step the buoyancy upward force is being applied either incrementally in both steps at each increment a new sequential equilibrium configuration is obtained by direct minimization of a total potential energy discretized as a riemann sum which yields algebraic system of nonlinear finite difference equations that further solved with newton raphson iterative technique the innovation of the method presented in this paper is reflected in its efficiency i e its scope and accuracy relative to the complexity of its mathematical and numerical formulations its purpose is to provide a feasible computational tool to an offshore engineer which will help him to develop his own in house code or subroutine in matlab or any widely available programming language for his own particular needs with a fast and convenient processing of the results and have a full control over the calculations instead of using less flexible and more cumbersome commercial software with its time consuming gui for a model definition and data processing the method is very flexible to adaptation of new loads constraints or boundary conditions the relative flexibility and simplicity of the model allows easily conducting sensitivity analyses and re analyses in a single loop in order to define the key roles of various parameters involved and assist the offshore engineer to decide which slwr geometry is preferable in the certain conditions and thus reach the optimum in the design moreover the presented solution technique does not require to define total riser length apriori but allows assessing it as an output of the analysis on the other hand the proposed method is more accurate and much less involved and has a simpler mathematical formulation than the one used in ruan et al 2014 wang et al 2015a 2015b 2014 wang and duan 2015 for example since it does not require dividing the riser into segments considering each segment separately and applying consistency conditions between them moreover application of consistent energy minimization technique within a problem formulation significantly simplifies the mathematical formulation of the problem relative to the considerations of differential element equilibrium more widely accepted in pipeline and riser engineering and consequently makes it easier also to implement it numerically the proposed model adopts the following assumptions and limitations the model is limited to a static planar 2d problem 3d out of plane effects such as torsion lateral buckling walking and etc are not considered the riser is modeled as unshearable inextensible beam such that only bending deformation is considered in addition we consider only elastic riser boundary effects at the top of suspended part which may involve plastic deformations xie et al 2013 are neglected furthermore only linear elastic frictionless seabed in a form of winkler foundation which does not allow tension forces due to soil suction is considered finally in this paper we consider only horizontal and flat seabed still water and constant temperature the paper is organized as follows in the following section we present the proposed methodology discretization and the solution technique then we validate the model with abaqus in what follows representative parameter analyses are conducted to demonstrate the feasibility of the method in particular the effects of upper section length buoyancy section length upward force provided by the buoyancy modules uplift loading ratio the horizontal component of the top tension force supplied by a floating facility and the ocean current are considered 2 model overview the structural analysis of the riser aims at determination of the overall configuration including the horizontal distance of a touchdown point tdp from a hang off point hop the embedment into the seabed and determination of the internal forces bending moments shear forces and tension in addition the minimum length of the riser is also not known a priory and has to be defined installation of the buoyancy modules along some specific length of the suspended part of the riser results in its division into several sections fig 2 as follows 1 the upper section of length l u which connects between hop and the buoyancy section at point bu and usually contains a sag bend 2 the buoyancy section of length l b which is located between bu and bl points where the buoyancy modules are installed which by applying an upward force cause the section to form an arch bend though the buoyancy modules are discrete in this paper we adopt their effect as averaged over the length of the buoyancy section i e we adopt their equivalent submerged weight per unit length in addition we assume that the effect of buoyancy modules attachment on a flexural stiffness of the riser is negligible qiao et al 2016 3 the lower section of length l l which connects the buoyancy section at bl to the seabed at tdp 4 the touch down section of length l t d which connects between the tdp and the all as laid limit point and 5 the as laid section of length l a l where the embedment of the riser into the seabed is solely due to self weight the combined length of the touch down and the as laid sections we define as the laid on section of length l s l t d l a l and the total length of the riser l l u l b l l l t d l a l while the lengths of the upper section l u and the buoyancy section l b are prescribed the lengths of the lower section l l and the touch down section l t d are not known in advance and will be available as an output of the analysis apparently l s and l are not known in advance either in this study we define the length of the touch down section l t d and consequently a minimum total length of the riser such that the as laid embedment i e the embedment solely due to the self weight at the touch down section end point all as laid limit will naturally take place hence the as laid section l a l is not a part of the slwr minimal length l m i n l u l b l l l t d but it can exist if the length is extended beyond the minimal one in reality the above condition is not unique and may depend on a nature of a subsea unit connection at the bottom end of the riser e g well flowline etc i e the vertical displacement at the bottom end may be prescribed and not just be solely due to self weight of course those conditions can be adapted within the present model as well in case it is required however their effect on the overall configuration of the slwr will be negligible and consequently in this paper we will consider only the conditions as described above in what follows we present mathematical formulation and numerical technique to assess static equilibrium at each step of the analysis 3 mathematical formulation the model is established in the global coordinate system xy where the origin is set at top left corner of the domain fig 3 with x axis refers in the direction of the host vessel location to the right and y axis refers downwards to the seabed let us consider an elastic riser of length l constrained to deform in plane partially laid on a seabed with a linear stiffness per unit length k s along the length l s at depth h w and partially suspended fig 3 the riser is subjected to a distributed submerged self weight w g along its entire length distributed buoyancy load w b along the length of the buoyancy section l b distributed hydrodynamic loads f x and f y in x and y directions respectively due to an ocean current at the velocity v x and a horizontal tension point load p 0 which is controlled by the host vessel at hop the riser configuration is given by θ s which defines its local orientation where s is the arclength distance along the riser 0 s l measured from the fixed point fp the geometric boundary conditions for the above configuration are as follows at point fp the riser is restrained in x direction and against the rotation while is free to move in y direction 1 x 0 0 2 θ 0 2 π on the other hand at hop the riser is connected to a host vessel with a ball joint connection i e restrained in y direction while is free to rotate and move in x direction 3 y l 0 a desired distance in x direction is maintained by controlling p 0 by the host vessel rather than directly specifying the displacement then the position of the riser is given by cartesian coordinates x and y as follows 4 x s 0 s cos θ s d s 5 y s s l sin θ s d s pay attention eqs 4 and 5 automatically satisfy boundary conditions 1 and 3 by establishing the xy coordinate system in the way as described above the boundary conditions 1 and 3 are naturally adapted in the formulation i e in the easiest manner establishing model in a different coordinate system rather than the one in fig 3 may require more sophisticated ways to specify those boundary conditions e g by means of the lagrange multipliers audoly and pomeau 2010 which might significantly complicate the formulation in this paper we shall derive the equations which will define the riser configuration at equilibrium directly from minimum total potential energy principle this principle says that among all the possible geometric configurations consistent with the geometric constraints and forces applied to the system only the one that minimizes the total potential energy corresponds to the stable equilibrium configuration e g reddy 2015 in a static case the total potential energy consists of elastic strain energy of deformed body and potential energy of applied forces the above approach is usually simpler than a more widely accepted way in engineering to derive field equations by considering balance of forces and moments acting on the differential part of the body e g lenci and callegari 2005 wang et al 2010 yuan et al 2014 2012 zan et al 2016 the energy approach as described above naturally accounts for applied loads including force boundary conditions and often leads towards more convenient mathematical expressions such as lower order equations sometimes with even less variables audoly and pomeau 2010 nevertheless both methods eventually yield the same results for the system as shown in fig 3 the total potential energy is given by 6 u t o t 1 2 l e i κ s 2 d s 1 2 l s k s e s 2 d s l w g y s d s l b w b y s d s l f x x s d s l f y y s d s p 0 x l where e is the young s modulus of the riser i is the moment of inertia of the riser s cross section κ is its planar curvature 7 κ s d θ s d s and e s is the embedment of the riser into the seabed l s is a length of a section that is in contact with soil laid on section and l b is a length of a buoyancy section the first term in eq 6 represents the bending elastic energy stored in a deformed riser since in this paper we consider only planar deformation of inextensible unshearable riser the strain energy is contributed exclusively by in plane bending the second term in eq 6 represents the elastic energy stored in the deformation of elastic seabed since there is only a fraction of the riser that is in contact with a seabed while the other fraction is being suspended the embedment of the riser into the seabed e s is defined piecewise by 8 e s e y s y s h w y s h w 0 y s h w we assume that there is no suction force in a case of a separation randolph and gourvenec 2011 then the seabed support reaction per unit length is given by 9 r s s k s e s the third term in eq 6 represents the potential energy of submerged self weight of the riser w g the forth term in eq 6 represents the potential energy of submerged self weight of the buoyancy modules averaged over the section length w b the fifth and the sixth terms in eq 7 represent the potential energy of distributed loads f x and f y in x and y directions respectively due to ocean current in order to account for hydrodynamic loads due to ocean current at the velocity v x we adopt morison s equations morison et al 1950 which in a case of a steady flow provide drag forces exerted by ocean current on submerged objects those forces per unit length of the pipe in the normal and tangential directions are given as follow 10 f n 1 2 ρ w c n d v x y sin θ v x y sin θ 11 f τ 1 2 ρ w c τ π d v x y cos θ v x y cos θ where d is the outer diameter of the pipe and c n and c τ are the normal and tangent drag coefficients respectively projecting these forces in x and y directions yield 12 f x f n sin θ f τ cos θ 13 f y f n cos θ f τ sin θ and the last term in eq 6 represent the potential energy of the horizontal top load p 0 controlled by the host vessel once θ s is defined it is possible to evaluate bending moments shear forces and tension using the usual differential relations 14 m s e i κ s 15 s s d m s d s 16 d t s d s f x cos θ s f y w s sin θ s where 17 w s w g w b s l b 0 s l b is a generalized gravity load 4 numerical implementation 4 1 finite difference discretization to solve the above defined problem we adopt finite difference method which is probably the simplest method for the problem nevertheless finite element method for example can be either applied the total potential energy of the riser eq 6 can be expressed in terms of discrete variables θ i fig 4 written as a left riemann sum as follows 18 u t o t δ s i 1 n 1 2 e i θ i 1 θ i δ s 2 i 1 n 1 1 2 k s b i y i h w 2 i 1 n 1 w i y i i 1 n 1 f x i x i i 1 n 1 f y i y i p 0 x n 1 where i and j are the indices in what follows both indices are used interchangeably there are n subintervals of size δ s l n and n 1 nodes the seabed stiffness k s b i at node i obtained by rewriting eq 9 as follows 19 k s b i k s δ s y i h w 0 y i h w generalized gravity load at each riser s node is now given by 20 w i w s δ s and node hydrodynamic drag loads by 21 f x i f n i sin θ i f τ i cos θ i 22 f y i f n i cos θ i f τ i sin θ i which are obtained by projecting discrete drag components 23 f n i 1 2 ρ w c n d δ s v x i sin θ i v x i sin θ i 24 f τ i 1 2 ρ w c τ π d δ s v x i cos θ i v x i cos θ i to the xy frame at each step the riser configuration is given rewriting eqs 4 and 5 as discrete values as follows 25 x i j 1 i 1 cos θ j δ s 26 y i j i n sin θ j δ s in order to achieve a proper riser configuration at static equilibrium we look for an extremum which yields minimum of total energy which is a function of n 1 discrete variables θ 1 θ n 1 with respect to n discrete variables θ 2 θ n 1 27 u t o t θ 1 θ n 1 θ i 0 for i 2 n 1 the conditions of stationarity with respect to θ 1 is not required since this value is known from boundary conditions 2 and can be directly substituted i e θ 1 2 π substituting eq 17 26 into eq 27 yields 28 e i δ s θ i 1 2 θ i θ i 1 j 1 i k s b j k j n δ s sin θ k h w δ s cos θ i j i 1 n 1 f x j δ s sin θ i j 1 i f y j w j δ s cos θ i p 0 δ s sin θ i 0 for i 2 n 1 which is a set of difference equations in terms of θ i in order to obtain a more convenient expression for 28 it is reasonable to change the order of summation in a second term by adopting the fubini principle for sequences 29 j 1 i k s b j k j n δ s sin θ k j 1 n δ s sin θ j k 1 min i j k s b k and introduce the accumulated values as follow 30 k s b i k 1 i k s b k 31 w i k 1 i w k 32 f x i k i n 1 f x k 33 f y i k 1 i f y k substituting eq 29 33 into eq 28 yields 34 e i δ s θ i 1 2 θ i θ i 1 δ s cos θ i j 1 n k s b min i j δ s sin θ j h w k s b i δ s cos θ i f x i δ s sin θ i f y i w i δ s cos θ i p 0 δ s sin θ i 0 eq 34 is an algebraic system of n equations with n unknowns θ i i 2 n 1 which defines a static configuration of the riser 4 2 solution technique the system 34 is essentially nonlinear and we shall apply newton raphson method nocedal and wright 2006 to solve it newton raphson method is an iterative technique which requires an initial estimate for the solution and then at each iteration a new closer approximation is computed the process quits when the difference in approximation between the iterations becomes negligible the success of the process may actually depend on how close the initial estimate is if the initial estimate is too far from the real solution the process may not converge therefore we will put special attention to have a good initial estimate for the solution before we approach the solution of 34 to define riser configuration we shall remember that the total length of the riser is not known in advance as well as the length of the lower section and the laid on part therefore we proceed the solution of 34 in an incremental iterative manner in two steps as follows fig 5 in a first step we set a free hanging riser configuration with a sufficient laid on portion by incrementing the riser s length and in a second step we keep the total length constant and incrementally apply the buoyancy forces to the buoyancy section 4 2 1 first step in the first step we proceed as follows first we set the initial configuration in a form of a free hanging catenary e g kang et al 2015 of some initial length l 0 such that it will have no more than one point in a contact with a seabed the above configuration can be given by a catenary equation d tan θ d s w p 0 which ignores the bending stiffness solving it specifying zero slope boundary condition at fixed point fp and accounting for water depth h w yield both the initial arc length of the riser l 0 35 l 0 p 0 w sinh arcosh w p 0 h w 1 and its corresponding configuration 36 θ i 0 2 π arctan w p 0 i 1 δ s this catenary configuration will serve as the initial estimate for newton raphson process as described above for the first increment l 1 l 0 δ l next the solution is carried out in an incremental iterative way following the analogy to a pipe lay process where the pipeline with a fixed end fp on the bottom in x direction being gradually released from the laying vessel into the water fig 5 at each consequent increment m the riser length is being increased by δ l δ s i e l m l m 1 δ l and iteratively solved to obtain a new static equilibrium and thus a new consequent configuration during this process riser s nodes are laid down and one by one they come into a contact with the seabed soil active set wriggers 2006 of contact nodes beyond the tdp is sequentially updated with a new node namely at each iteration the contact force is being applied to the node j if it falls beyond the water depth i e y j h w literally this is done by updating k s b j value in 22 to yield new values for k s b i and k s b min i j the process should quit when the effect of the boundary conditions at laid end point fp on the overall configuration becomes negligible i e the internal forces and the embedment at any point on the riser segment between hop and aal fig 2 do not change any longer with the length increments fig 5 line 3 since in the second step some nodes in the neighborhood of tdp will be elevated and tdp will relocate back again it is recommended to continue the abovementioned process even longer or to simply artificially increase the length of the as laid section fig 5 dashed blue line 4 it should be noted that this step involves moving boundary conditions during this step at each increment the dimensions of the whole system grow by one n m n m 1 1 since we add additional node and subinterval for each subsequent length increment as initial estimate serves the configuration from the previous length increment fig 5 which then being again updated iteratively by newton raphson technique 4 2 2 second step in the second step we apply the uplift force throughout this step we keep the riser length constant and incrementally increase the uplift force at nodes located within the buoyancy section l b by updating their generalized gravity loads w i at increment m as follows w i m w i m 1 δ w b and thus w i in 31 throughout this process the nodes close to the tdp will elevate again fig 5 line 5 consequently during this step k s b j in 30 are being updated again to yield new values for k s b i and k s b min i j 4 2 3 typical increment in fact aside from the above mentioned updates in both steps typical increment and typical iteration are similar and proceed as follows for the sake of clarity let us rewrite eq 34 for increment m in a matrix form as follows 37 k θ m f θ m 0 we solve eq 37 iteratively with newton raphson method nocedal and wright 2006 linearizing eq 37 with a first order term of taylor series expansion yields the following linear equation for iteration n 38 k df d θ θ m n 1 δ θ m n k θ m n 1 f θ m n 1 with 39 θ m n θ m n 1 δ θ m n which is solved consecutively the iterative process quits when δ θ m n meets the convergence criterion the solution of previous increment θ m 1 serves as initial estimate for subsequent increment θ m 0 θ m 1 the expressions which appear in eq 38 are as follows 40 k e i δ s 1 2 1 and the other nonlinear terms are presented here in a form of matrix entries 41 f θ m n 1 i δ s cos θ i m n 1 j 1 n k s b min i j m n 1 δ s sin θ j m n 1 h w k s b i m n 1 δ s cos θ i m n 1 f x i m n 1 δ s sin θ i m n 1 f y i m n 1 w i m n 1 δ s cos θ i m n 1 p 0 δ s sin θ i m n 1 42 df d θ θ m n 1 i j δ s cos θ i m n 1 k s b min i j m n 1 δ s cos θ j m n 1 δ i j df d θ θ m n 1 i i 43 df d θ θ m n 1 i i δ s sin θ i m n 1 j 1 n k s b min i j m n 1 δ s sin θ j m n 1 h w k s b i m n 1 δ s sin θ i m n 1 f x i m n 1 δ s cos θ i m n 1 f y i m n 1 w i m n 1 δ s sin θ i m n 1 p 0 δ s cos θ i m n 1 where δ i j is a kronecker delta 44 δ i j 0 if i j 1 if i j once the variables θ i are calculated bending moments shear forces and tension can be back calculated by using eq 14 16 in their discrete forms as follows 45 m i e i κ i e i θ i θ i 1 δ s 46 s i m i m i 1 δ s 47 t i p 0 j i 1 n f x j cos θ i r h o p j i 1 n f y j w j sin θ i where the vertical reaction at hop fig 7 is given by 48 r h o p t n 1 sin θ n 1 s n 1 cos θ n 1 and axial tension at hop by 49 t n 1 p 0 s n 1 sin θ n 1 cos θ n 1 5 validation and parameter analysis in what follows we present the validation of the proposed method with abaqus finite difference grid convergence and the parameter analysis for all the forthcoming calculations we adopt the basic set of parameters as summarized in table 1 all the calculations except for abaqus reference solution were performed with matlab we adopt the riser dimensions materials and other parameters in a range as proposed by ref bai and bai 2014 guo et al 2014 randolph and gourvenec 2011 other parameters which appear in eq 6 are calculated as follows the moment of inertia of the riser s cross section is given by i π 4 d 2 4 d 2 t 4 while its area by a π d 2 2 d 2 t 2 a submerged buoyant density of the riser is given by ρ b ρ s ρ w for the sake of simplicity we assume the riser being filled with water then the submerged gravity load per unit length of the riser is given by w g ρ s ρ w g a and the average submerged weight per unit length of the buoyancy modules is given by w b ρ b ρ w g a b where a b is the averaged area of the buoyancy modules cross section in what follows the results are presented for the quantities as illustrated in fig 6 where e m a x is the maximum embedment e w k s is the as laid embedment and r s m a x is the maximum seabed support reaction seabed support reaction at as laid part is r s w g though we formulate the problem in the global coordinate system xy for the sake of convenience we adopt two additional abscissas to present the results the first one x h o p measured from the hop and the second one x t d p measured from the tdp both in negative x directions fig 6 5 1 validation and comparison the present method is first validated through the basic case adopting the characteristics as presented in table 1 with finite element solution by abaqus standard dassault systems 2016 for the sake of comparison a riser with a total length of 3024 m was selected in abaqus model two node hybrid linear beam elements b21h were used to model the riser the seabed is modeled as 2d planar analytical rigid shell body the contact between the riser and the seabed is defined using softened contact pressure overclosure relationship dassault systems 2016 comparisons of the configuration embedment tension shear forces and bending moments for varying size of subintervals δ s 8 1 m and for abaqus solution element size h el 0 5 m are shown in fig 7a b c d e respectively from these figures it can be seen that the results obtained by the proposed method and abaqus are in an excellent agreement since abaqus formulation adapts extensibility and shear flexibility we can also see the authenticity of those assumptions fig 8 show the convergence of maximum values of the above variables with increase in a number of subintervals for the proposed method it can be seen that all the tested quantities converge with a grid refinement with each grid refinement by twice the change in the solution drops the maximum error of the solution for various grids relatively to the solution with dense grid δ s 1 m is shown in table 2 it can be seen that for the embedment tension and bending moments the errors are less than 1 even for the coarse grid δ s 8 m on the other hand shear force at its peak value converges much slower about 10 even for δ s 2 m the reason for the later lays in the abrupt change in a shear force which is smeared over one subinterval 5 2 parameter analysis in what follows we present the parameter analysis the basic set of parameters is as summarized in table 1 at each simulation we change the value of only one specific parameter the parametric study presented in this paper is by no means comprehensive the aim of this study is to demonstrate the general scope of the proposed method and to show the general tendencies rather than provide specific design values consequently the conclusions raised about the results in the following subsections are related only to the used parameter ranges table 1 5 2 1 effect of upper section length in this series we perform a set of five simulations for different lengths of the upper section l u 1400 m 1600 m 1800 m 2000 m and 2200 m other parameters adopted for this series are kept constant as in table 1 fig 9 a shows the plot of configurations for different lengths of the upper section l u fig 9b plots the minimum total length of the riser l m i n which grows with an increase in l u horizontal distance from the hang off point hop to the touchdown point tdp l h o p t d p grows almost linearly with a growing length of the upper section as shown in fig 9c as shown in fig 9d vertical reaction between the riser and the floating production facility at hop also almost linearly grows with a growing length of the upper section while the hang off angle φ 0 fig 9e almost linearly drops with a growing length of the upper section both riser embedment and seabed support reaction for the chosen parameters look insensitive of the length of the upper section fig 10 a and b approaching as laid embedment and submerged self weight respectively beyond the tdp at steady state in reality accurately assessing riser embedment into the seabed is very important since it affects riser stability against hydrodynamic forces host vessel movements sideways and lateral buckling lateral and axial soil resistance and thermal insulation aubeny and biscontin 2009 dean 2010 mccarron 2011 palmer 2008 randolph and gourvenec 2011 randolph and white 2008 shiri 2014 fig 11 a c e depict axial tension shear forces and bending moments for different lengths of the upper section since riser is a tension dominated structure axial tension is the most important force within the following analyses it can be seen that in all of the following cases the resulting values of axial tension are higher by an order of magnitude than the resulting values of shear forces and bending moments by decreasing the length of the upper section axial tension at hop drops while maximum axial tension at buoyancy section grows both in almost linear manner fig 11b fig 11d shows that for a longer upper sections maximum shear force drops finally fig 11e and f indicate that bending moments are nearly constant along each section and insensitive to the upper section length 5 2 2 effect of buoyancy section length in this series we perform a set of five simulations for different lengths of the buoyancy section l b 300 m 450 m 600 m 750 m and 900 m other parameters adopted for this series kept constant as in table 1 fig 12 a shows the plot of configurations for different lengths of the buoyancy section l b fig 12b plots the minimum total length of the riser l m i n which grows linearly with an increase in l b horizontal distance from the hop to the tdp l h o p t d p grows almost linearly with growing length of the buoyancy section as shown in fig 12c as shown in fig 10d vertical reaction between the riser and the floating production facility at hop drops with a growing length of the buoyancy section while hang off angle φ 0 fig 10e grows with a growing length of the buoyancy section however both as in a case with l h o p t d p in a linear manner fig 13 a c d depict axial tension shear forces and bending moments for different lengths of the upper section by increasing the length of the buoyancy section axial tension at hop drops while maximum axial tension at buoyancy section grows both in almost linear manner fig 13d shows that the maximum shear force first grows with l b till 450 m and then drops down the reason for this behavior can be retrieved from fig 12a at l b 450 m the slope of the riser at the maximum shear force location a right boundary of a buoyancy section is flat which means that all the perturbation in vertical forces due to appearance of an upward buoyancy force is transformed to shear in all other cases shear obtains only a component fig 13e and f indicate that maximum bending moment as in a previous section is almost insensitive to the length of the buoyancy section 5 2 3 effect of uplift loading ratio in this series we perform a set of six simulations for different uplift loading ratios r u p 0 1 1 5 2 2 5 and 3 other parameters adopted for this series kept constant as appear in table 1 fig 14 a shows the plot of configurations for different uplift loading ratios r u p w b w g fig 12b plots the minimum total length of the riser l m i n which grows almost linearly with an increase in r u p horizontal distance from the floating production facility hop to the tdp l h o p t d p increases with uplift loading ratio as shown in fig 14c as is shown in fig 14d vertical reaction between the riser and the floating production facility at hop nearly linearly drops with the increase in uplift loading ratio while the hang off angle φ 0 nearly linearly grows fig 14e fig 15 a c e depict axial tension shear forces and bending moments along the riser for different uplift loading ratios since the bending stiffness of the riser is relatively small the riser response is dominated by tension axial tension is about three orders of magnitude higher than shear forces as the uplift force applied on the riser by the buoyancy modules grows the maximum tension at hop drops while maximum tension at buoyancy section grows fig 15b from r u p 1 up to r u p 2 an increase in the uplift loading ratio leads to an increase in a maximum shear force however from r u p 2 it drops down the reason for such a behavior as in a previous subsection lays in a slope of the riser at the maximum shear force location a right boundary of a buoyancy section as shows fig 15d for r u p 2 it is flat which means that all the perturbation in vertical forces due to appearance of an upward buoyancy force is directly transformed to shear in all other cases shear takes only a component from r u p 1 the uplift loading ratio linearly increases the bending moments at buoyancy section while bending moments at upper and lower sections remain constant and almost insensitive to r u p fig 15e and f as it can be seen from nearly all the figures a substantial change in the behavior starts above r u p 1 i e for when the upward force is higher than the buoyant gravity below that value the attachment of the buoyancy modules makes no sense 5 2 4 effect of a horizontal top tension load supplied by a host vessel in what follows we study the effect of the horizontal top tension force supplied by the floating facility on a riser through ball joint the horizontal top tension force p 0 should not be confused with the axial tension t within a riser in this series we perform a set of six simulations for different horizontal top tension forces p 0 0 1 mn 0 2 mn 0 4 mn 0 8 mn 1 6 mn and 3 2 mn other parameters adopted for this series kept constant as in table 1 fig 16 a shows the plot of configurations for different horizontal top tension force p 0 as p 0 grows the effect of arch bend becomes less visual fig 16a fig 16b plots the minimum total length of the riser l m i n which grows almost linearly with an increase in p 0 as well as vertical reaction between the riser and the floating production facility at hop fig 16d on the other hand horizontal distance from the hop to the tdp l h o p t d p and the hang off angle φ 0 also increase with p 0 as shown in fig 16c e however the rate of their growth with a growth in p 0 slows down fig 17 a and b depict the embedment and the support reaction respectively near the tdp it can be seen that for higher p 0 values the maximum embedment and the maximum support reaction approach the as laid embedment and the submerged self weight respectively it is obvious that maximum axial tension grows with a rise in a horizontal top tension however in order to study this effect more explicitly it is useful to look at the normalized axial tension values t p 0 and t m a x p 0 rather than an absolute ones fig 18 a and b fig 18a and b shows that though the maximum axial tension grows with a rising horizontal top tension maximum normalized axial tension drops i e tension in all material points along the pipeline approaches the horizontal top tension as the horizontal top tension grows the drop in a normalized axial tension at hop as the horizontal top tension grows is more substantial than the drop in a normalized maximum axial tension at buoyancy section for higher horizontal top tension values the assumption of a constant tension distribution along the riser yuan et al 2014 2012 becomes more reasonable fig 18c e depict absolute values of shear forces and bending moments for different horizontal top tension it can be seen that all the shear forces and the bending moments at arch bend and sag bends drop exponentially with a rise in a horizontal top tension fig 18d f as in previous subsections the maximum shear force depends on a slope of the riser at its location fig 18d in order to highlight this slope transition additional simulations with p 0 equal to 0 15 mn and 0 3 mn were performed and added to fig 18b d f 5 2 5 effect of ocean current velocity in what follows we study the effect of the ocean current velocity for the sake of simplicity we assume a parabolic velocity distribution with a depth v x y v 0 1 y h w 2 and perform a set of five simulations for different ocean current surface velocities v 0 1 m sec 0 5 m sec 0 m sec 0 5 m sec and 1 m sec other parameters adopted for this series kept constant as in table 1 fig 19 a shows the plot of configurations for different ocean current surface velocity v 0 fig 19b c d e depict axial tension shear forces bending moments and the embedments along the riser as fig 19b c d e indicate the effect of v 0 is almost linear near v 0 0 however grows sharper with the increase in the current velocity in both directions moreover fig 19b c d e also show that the behavior is not symmetric around v 0 0 the reason for this is that the loads due to the water currents also highly affect the axial tension within the riser subsection 5 2 4 the above coupled effect of the hydrodynamic loads with the axial tension is the major reason of this non symmetric response to demonstrate this non symmetric behavior we present a curve for a horizontal distance from the hop to the tdp l h o p t d p vs v 0 fig 19f 6 conclusions feasible numerical method for the structural analysis of a steel lazy wave riser static configuration is presented the method considers the whole riser which includes a buoyancy section and is partially suspended and partially laid on a seabed as a single continuous segment the equations which characterize the riser configuration at the equilibrium are derived directly by a minimization of a discretized total potential energy of the system the numerical solution allows efficient treatment of riser seabed interaction circumventing the complexities with a contact detection the method does not require a predefined length of the riser as an input but allows its definition from the analysis the parameter analysis has shown that the installation of buoyancy modules along some length of suspended part of the riser causes a reduction in a maximal tension force along the riser which is at hang off point the upward force provided by the buoyancy modules should be higher than the buoyant gravity of the riser otherwise there is no substantial change in the behavior and the attachment of the buoyancy modules makes no sense also it was observed that for higher horizontal top tension values the assumption of constant tension force along the riser yuan et al 2014 2012 becomes more reasonable comparison with abaqus beside the good agreement showed that for the parameters given in table 1 the assumption that the riser is unshearable and inextensible works very well in general direct minimization of a total potential energy is valid only for conservative systems where after the loading removal both the seabed and the pipeline return to their undisturbed initial state however since we apply loads and solve for equilibrium in an incremental manner we can sequentially calculate the dissipated energy through each increment and sequentially update the total energy for the rest of the analysis and thus analyze non conservative and path dependent problems the simplicity flexibility and robustness of the proposed method allow to enhance the efficiency of engineering calculations and design declaration of competing interest none acknowledgements this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors 
22257,a physically based computational model which implements a variety of technologies to real time simulation of the ocean surface dynamics and waves body interaction is proposed the method uses data from experimental observation of the real ocean stochastic description of irregular wind waves inverse non uniform fast fourier transform mathematical tool unstructured grid representation for changeable water surface and complex geometry of the floating object reasonably full and accurate immersed rigid body dynamics fast and stable algorithms for solving the equations of motion the integrated mathematical model combines the proven approaches which are adapted and modified for stated goals the developed approach does not impose restrictions on complexity of the immersed body configuration the implemented algorithms allow to perform an interactive simulation on a desktop computer using high resolution surface meshes without loss of frame rate some examples are considered to demonstrate the abilities of the model to simulate the interaction of partially submerged body rescue boat with wind generated irregular fluctuations of the water surface in the real time mode graphical abstract image 1 keywords real time physically based modelling irregular ocean waves dynamics unstructured surface mesh immersed rigid body dynamics inverse non uniform fast fourier transform nufft wave body interaction 1 introduction the tasks of a reliable mathematical modelling of changeable ocean surface and a detailed description of the interaction dynamics of waves and a freely floating body in real time mode are of undoubted scientific interest and are also very relevant in many areas of human activity in the cinema tessendorf 1999 2001 2002 ebert et al 2000 deusen et al 2004 and computer games industries ship simulator extremes 2019 virtual sailor 2019 when developing training simulators boeing and braunl 2007 ueng et al 2008 varela and guedes soares 2011 massei et al 2013 yu et al 2017 transas 2019 in scientific visualization giannakidis et al 2014 and in many other areas where computer graphics is widely applied the water surface is fairly common object which is the most difficult to reproduce computer generated ocean surfaces have been commonly used in movies such as waterworld titanic the perfect storm finding nemo life of pi and so on since 1995 the constantly changing configuration of the free water surface is difficult to give an accurate mathematical description even using a large number of geometric primitives the complex dynamic behavior of the ocean is controlled by multiple phenomena occurring at small and large scales and may vary from calm to agitated ocean from small waves to enormous shorebreaks darles et al 2011 these mechanisms vary considerably depending on the ocean surface location in physical oceanography water area is divided into deep ocean intermediate and shallow water areas in deep waters the parameters of waves on the free surface are defined by the oscillatory behavior of the air water interface as the waves enter shallow water near the shore their heights increase and they change into breaking waves over the past 30 years the computer graphics has advanced significantly in solving problem of reliable representing the visual complexity of the phenomena under consideration various algorithms and technologies are used in the development of expensive systems for 3d modeling and visualization of water surfaces the parametric approach is based on tracking of the paths of water particles and describes the free surface with parametric equations derived from satellite observations or buoys measurements biesel 1952 the spectral approximations describe the state of the sea using waves spectrum pierson and moskowitz 1964 hasselmann et al 1973 bouws et al 1985 and compute waves distribution according to their amplitudes and frequencies the basis of many algorithms reconstructing water surfaces is the fast fourier transform fft which is applied to specially processed random noise varying over time through a frequency dependent phase shift the works of dr j tessendorf and his co authors tessendorf 1999 2001 2002 ebert et al 2000 deusen et al 2004 have made an important contribution in this direction of realistic visualization of water surface behavior dr tessendorf s fluid dynamics tools for efficient simulation and rendering highly realistic ocean surfaces were successfully used in numerous films such as titanic waterworld and many others his achievements were reported annually from 1999 to 2004 at the siggraph conference and recognized by the academy award for technical achievement in 2008 however the traditional fft methods have some difficulty in modelling of the interaction between water waves and floating bodies in interactive mode finally the navier stokes partial differential equations describing the motion of a continuous linear viscous medium can be used for the most complete physically based representing of the dynamical behavior of the ocean the first two groups of methods which use oceanographic models are better suited for simulation of deep waters due to accurate representation of oscillatory motion of the sea surface but since they cannot take into account the interaction with the ocean floor in shallow waters only techniques relying on approximate solution of the navier stokes equations are capable to reproduce the complexity of sea dynamics near the shore the reliable integrated model of irregular waves affecting the floating body can be obtained only by taking into account the real physical properties of the aquatic environment immersed rigid body dynamics as well as the complex geometries of free water surface and immersed object it is necessary to increase the realism and at the same time to maintain the downward trend in the computer resources consumption when modeling natural phenomena a balance should be struck between realism of the model and computational complexity of the algorithms depending on the specific application the creation of the image of a dynamically changing water surface does not require an exact reproduction of the process from the point of view of physics of the phenomenon thus the development of new economic approaches which implement simplified but physically based models with the aim of increasing the effectiveness of the real time visualization systems is a very urgent task a number of ship motion loads prediction systems based on various physical models and techniques have recently been developed presently most computational algorithms implement mathematical models based on potential flow wave theory and methods which solve the reynolds averaged navier stokes rans equations the majority of techniques for computing ship motions belong to the first group a comprehensive review of the theoretical methods implemented in modern ship motion software to predict the wave wind current ice induced linear and nonlinear motion responses and structural loads for the design of ships and offshore structures was presented in hirdaris et al 2014 hirdaris et al 2014 summarized and classified the recent advances on ship motion prediction based on potential flow theories ranging from linear approaches to fully nonlinear methods four more partially nonlinear or blended methods were placed between these two extremes in the order of complexity in the framework of the linear theory the ship motions are determined by a linear superposition of sinusoidal components with a random initial phase bhattacharyya 1978 the amplitude of each of the components is calculated by response amplitude operators raos rao expresses the relationship between ship motion and wave height versus regular wave frequency lewis 1989 raos are obtained by a series of wave tank tests or calculated by specialized software programs implementing the classical strip theory salvesen et al 1970 the theory assumes the vessel hull to be an oscillating and translating slender body whose motion is characterized by added mass and damping coefficient in heave and pitch displacements the strip theory gives good results for ship motions in low to moderate regular waves in which the influence of nonlinearities is insignificant this promising technique was further extended and developed in fonseca and guedes soares 1998 sutulo et al 2010 varela and guedes soares 2011 by modelling the large amplitude motions and taking into account the influence of irregularity of waves and sea bottom for shallow waters fonseca and guedes soares 1998 were able to improve the method by expanding the scope of its applicability for modelling the large amplitude motions the paper by sutulo et al 2010 was dedicated to the development of boundary element method to compute the inertial added mass and damping characteristics of ship sections in variable depth shallow water areas with multi stepped and inclined bottoms varela and guedes soares 2011 presented a methodology to simulate the ship motions in irregular waves described by a real wave spectrum at interactive frame rates the inverse discrete fast fourier transform algorithm was applied to compute the sum of all elementary ship displacements induced by the irregular waves and get the final complex ship motion the random sea surface was deformed by thousands of wave trains with different amplitudes frequencies and directions the transfer functions of a liquefied gas carrier which described how the ship reacted to forces generated by wave trains with different properties were used to apply the method for a variation of sea states and maneuverability conditions the method provided the high degree of realism as well as establishment and maintenance of synchronism between the phases of wave trains and ship motions for all investigated ship positions speeds and headings a significant number of partially nonlinear methods have been developed to account for the various most important nonlinear effects rajendran et al 2015 suggested a method for predicting the body nonlinear froude krylov and hydrostatic forces as well as nonlinear radiation and diffraction forces which expresses the dependence of hydrodynamic forces on the time changing underwater hull shape the approach was used to calculate the vertical motions and bending moments on a modern cruise ship which were excited by the regular waves with different steepnesses mortola et al 2011 developed a time domain approach for prediction of ship motions and wave loads in the proposed mathematical formulation all the involved forces were nonlinear and time dependent the restoring froude krylov and diffraction forces were calculated at each time step for the exact position of the hull the diffraction forces were determined in accordance with the strip theory salvesen et al 1970 hydrodynamic coefficients were computed using strip theory for relevant combinations of section immersions and heel angles the simplified approach was applied for accounting the forward speed effects the raos of heave pitch and vertical bending moments vbm at midship were obtained for s175 containership in head regular waves in the case of zero speed the boundary element methods applied couple with the potential theory cannot describe breaking waves spray and water flowing onto and off the ship s deck besides it is necessary to involve other methods for calculation of the viscous forces therefore the recent research results show a trend toward the use of cfd simulations based on methods which solve the rans equations lavrov et al 2017 gadelho et al 2018 sayeed et al 2018 lavrov et al 2017 calculated the hydrodynamic coefficients of 2d ship sections subjected to forced nonlinear roll motions by using the navier stokes solver implemented in computational fluid dynamics openfoam software the hull section harmonically rolled on the water surface with frequencies which covered nearly all possible frequencies encountered in real sea waves the forced motions on ship sections oscillating in calm water as well as the free surface capturing were modeled the influence of viscosity on the roll motion was investigated the viscous unsteady results were compared with potential flow solutions and experimental data gadelho et al 2018 investigated the heaving and swinging characteristics of two dimensional sections of boat hull using open source code openfoam the hydrodynamic coefficients of ship hull sections subjected to heave and sway motions in shallow and deep water were numerically determined the work of gadelho et al 2018 demonstrated the results as values of the added mass and damping coefficients which correlate well with boundary integral equation method in the potential flow formulation a preliminary assessment of the necessity of viscosity consideration on the determination of the hydrodynamic coefficients which should depend on the section topology and depth was carried out the paper of sayeed et al 2018 covered the experimental and numerical investigations of the force and motion behavior of partially submerged berg bodies induced by irregular waves near a fixed structure numerical simulations of the waves body interaction were performed using rans based commercial cfd code flow3d the computational results were compared to the experimental data test cases from both force and motion experiments were simulated in irregular waves generated from experimental wave spectra as techniques become more sophisticated calculations become more time consuming complex partially and fully nonlinear potential theory flow models as well as navier stokes models agreed well with the experimental data hirdaris et al 2014 but their implementation in real time ship motion simulators can be problematic thus there is also a need to develop accurate and fast simplified numerical models which can be implemented in modern systems for real time monitoring the actual ship responses and associated structural loads due to weather changes and to possible variation in course or speed sutulo et al 2002 studied the problem of interactive simulation of the ship manoeuvring motion the simplified but fast approaches based on dynamic and kinematic prediction models were proposed the problem was treated as three degrees of freedom the surge sway and yaw translation along the x axis translation along the y axis and rotation around the vertical z axis respectively were taken into account in the motion equations the heave roll and pitch linear up down motion rotation about the x axis and rotation about the y axis respectively caused by the waves were not considered the coefficients of the manoeuvring equations were determined on the basis of manoeuvring characteristics which were obtained experimentally the model was developed for real time trajectory calculation in the manoeuvring simulator and provided the standard frame rate on a personal computer a ship motion short term time domain simulator was proposed by neri et al 2016 the authors presented a simple but reliable methodology for real time prediction of a cruise ship behavior during manoeuvres the method is quite general and could be applied to any kind of ship but it requires the manoeuvrability data contained in the manoeuvring booklet the experimental data were used to extract the model s parameters and coefficients the complex physical system of the ship was simplified with a three degrees of freedom model translation along z coordinate pitch and roll rotations were not considered the effect of wind and current were negligible the equations of motion taking into account the rudders torque water viscosity as well as forces and moments produced by the propeller were integrated in time to calculate the ship position and orientation at every time step zhang et al 2004 developed the simple and fast three degrees of freedom simulation model describing the real time motion of a ship sailing inside a harbor in surge sway and yaw directions the methodology was based on the calculation of total forces acting on the ship then the simplified first order differential equations establishing the relation between forces and accelerations were derived using newton s law the differential equations were solved by the runge kutta method to calculate the displacements of the ship the mathematical model was tested with ship trial manoeuvre data a three dimensional realistic view of the ship was reproduced by the virtual reality technique in the large ship manouvring simulator the assumption of a three degrees of freedom model is a reasonable and very good first approximation neglecting of z translation pitch and roll degrees of freedom is acceptable for positioning estimation and trajectory tracking for simulate port operations but is not suitable for ship s stability computational analysis cieutat et al 2001 developed the simplified methodology to compute the six components of the real time vessel motion the waved sea surface was generated by the approach based on the gerstner model where particles of water describe circular or elliptical stationary orbits fournier and reeves 1986 the wave height field was updated at every time step then the ship was oriented according to the tangent plane to the water surface the virtual model predicted the ship responses for surge sway and yaw as well as the heave roll and pitch motions another efficient computational model to simulate six degrees of freedom ship motions in real time was reported by ueng et al 2008 the six degrees of freedom were calculated separately and superimposed to generate the overall movement of the ship according to the vessel shape draft and mass the pitch heave and roll movements were induced by sea waves and the surge sway and yaw displacements were caused by propellers rudders current and wind the ship was treated as a rigid body floating on the surface of the deep sea the waves were comprised with sinusoidal modes of different frequencies speeds and angles the moving two dimensional uniform cartesian grid coupled with the ship was generated in the horizontal plane the rectangular grid boundary was determined by the bounding box of the vertical projection of the ship s body into the horizontal plane then the rectangular domain was divided by a uniform grid the height field of the sea surface was evaluated at each grid point the excitation force of water was calculated by multiplying the average height field with the area of the grid and the force for ship motions was computed for each ship motion component the net force was obtained by subtracting the resistance force from the force of water the accelerations velocities and magnitudes of the motions were calculated by applying newton s law one more real time simulator was described in the paper daqaq and nayfeh 2004 this simulator was applied as a platform to study the dynamics of ships and ship mounted cranes under dynamic sea environments and as a training platform for their operators the crane ship was assumed to be a rigid body with fixed moments and products of inertia in the body fixed frame the ship floated on the free wavy surface and arbitrary moved with six degrees of freedom the complete system of equations of motion was numerically integrated using a fourth order runge kutta method the ship motions were not really calculated in interactive regime instead a database containing the ship response such as positions velocities accelerations for a large number of sea conditions was used the dynamics characteristics were previously computed and the virtual environment was applied for post processing visualization and real time interaction with the ship mounted crane operator the results presented by authors daqaq and nayfeh 2004 demonstrated a sufficient realism in modeling different ship motion and cargo transfer scenarios during loading unloading operations the purpose of this study is to develop an integrated computational model combining the oceanographic measurement data stochastic description of irregular deep water wind waves inverse non uniform fast fourier transform nufft technique unstructured grid representation for water surface configuration and arbitrary geometry of the floating object reasonably full and accurate immersed rigid body dynamics fast and stable algorithms for solving the equations of motion with the goal of interactive simulation of the ocean surface dynamics and waves body interaction the effectiveness of the implemented computational method is demonstrated with several visual examples the layout of the paper is as follows section 2 is devoted to describing a mathematical model of the body waves system under consideration governing equations and the theoretical foundations of the proposed simulation method in section 3 the main concepts of the developed model details of algorithmic and practical implementation as well as justification of the simulation parameters choice are presented in section 4 the results of real time dynamic simulation of the ship in irregular wind waves which were obtained with the created model for different ocean states are considered section 5 contains a discussion of the abilities properties and characteristics of the model finally concluding remarks are provided in section 6 2 material and methods in the current section the underlying theoretical basis for the developed modelling method is given 2 1 theoretical background of a dynamic model of the surface irregular waves ocean dynamics in general is governed by the three dimensional nonstationary navier stokes equations a very difficult task of solving the navier stokes equations can be simplified using reasonable assumptions by neglecting the viscous dissipation compressibility and heat conduction effects the adiabatic motion of an ideal fluid in the gravity field can be described with the aid of the euler equation augmented by continuity equation landau and lifshitz 1987 pp 2 5 1 v t v v p ρ g v 0 where v v x t is the flow velocity vector with components υ x υ y υ z in three dimensional space ρ x t is the density of the fluid p x t is the pressure of the fluid g g 0 0 g is the vector of gravitational field strength is the nabla operator x x x y z is the radius vector of an arbitrary location within a fluid mass in the world coordinate system since gravity acting on the mass of the ocean fluid is a conservative force the dynamics of the ocean surface can be described with equations for potential flows assuming potentiality of the fluid flow eq 1 can be transformed into landau and lifshitz 1987 p 17 2 ϕ t 1 2 ϕ 2 p ρ g x 0 3 2 ϕ δ ϕ 0 where ϕ x t is the velocity potential v ϕ a number of additional assumptions are made for significantly simplifying the mathematical and computational complexity of the problem and for creating an interactive and efficient dynamic model of the waving free ocean surface the water surface in equilibrium in a gravitational field is a plane z 0 the z axis is directed upward under the action of some external perturbation the equilibrium is broken and wave disturbances begin to spread over the whole surface gravity waves propagate in a reservoir unlimited in two directions along the xy plane the model assumes that only free surface of a liquid is involved in the movement and the internal fluid volume is not considered the latter allows dimensionality reduction of the problem from 3d to 2d this may seem like an oversimplification however the very rapid damping of the oscillations of water particles with depth is an experimentally established fact dynamically changing ocean surface is represented as height field h x y t thus h x y t gives the vertical displacement of the sea surface in its oscillations it is also assumed that the velocity of the moving fluid particles is so small that the term v v may be omitted in comparison with v t in the euler equations see eq 1 the physical interpretation of this is easily considered the order of magnitude of the fluid particle velocity can be estimated as ϑ a τ where a is the amplitude τ is the period of oscillation of the fluid particle in an deep ocean wave the time derivative of velocity in turn is of the order of ϑ τ and the space derivative of velocity is of the order of ϑ λ where λ is the wavelength thus the condition v v v t is equivalent to the requirement a τ ϑ λ ϑ τ or a λ 1 and finally a λ this means the smallness of amplitude compared to wavelength landau and lifshitz 1987 pp 31 37 due to the smallness of the velocity the term v 2 2 ϕ 2 2 in eq 2 may be neglected since it contains the square of the velocity as a result of the linearization of eq 2 we obtain landau and lifshitz 1987 pp 31 37 4 p ρ ϕ t ρ g z let a constant external atmosphere pressure p 0 acts on the surface then at the surface eq 4 gives landau and lifshitz 1987 pp 31 37 5 p 0 ρ ϕ t ρ g h x y t the constant p 0 can be eliminated by redefining the potential ϕ adding to it a quantity p 0 t ρ which is independent of the coordinates we then obtain the condition at the surface in the form 6 ϕ x y z t t z h x y t g h x y t since the fluid particles at the surface move together with the fluid the normal velocity of the fluid close to the free surface must be equal to the normal velocity of the surface element on the assumptions that the amplitude of the wave oscillations is small enough and the ocean surface is not curved and oscillates up and down accepted simplifications are valid in the framework of the linear model we have landau and lifshitz 1987 pp 31 37 7 h x y t t ϕ x y z t z z h x y t the ratio for an approximate definition of the vertical derivative operator can be obtained from the continuity equation see eq 3 8 z 2 x 2 2 y 2 from eq 7 and taking into account eq 8 on the free water surface we get 9 h x y t t 2 x 2 2 y 2 ϕ x y t by differentiating eq 9 with respect to time t and substituting eq 6 into it we finally obtain the equation for the ocean surface dynamics 10 2 h x y t t 2 g 2 x 2 2 y 2 h x y t this equation of sea surface motion is linear with respect to the desired function h x y t the general solution of the linear differential equation is the sum of the particular solutions which have the form 11 h x y t h 0 exp i k x x k y y i ω t where k x k y h 0 ω are the wave parameters at a point on the water surface on substitution of the specific solution eq 11 into differential eq 10 we obtain 12 h 0 ω 2 g k 0 here k 2 π λ is the module of wave vector k k x k y λ is the length of the wave the algebraic eq 12 has the solutions ω g k except the trivial case h 0 0 which corresponds to a flat water surface the last relation is nothing more than the dispersion equation relating the frequency ω and wave vector k the temporal and spatial periodicity of the wave consequently for a given wave k the angular frequency and the propagation velocity are uniquely determined a statistical approach tessendorf 1999 2001 is applied to determine the amplitude values h 0 k ω the random amplitude realizations are based on oceanographic measurements of the variance properties of wave height on the open ocean dugan et al 1996 2001 and semi empirical models phillips 1958 1977 the expediency of using the dispersion equation for a real time simulation of water surfaces is supported with experimental results which confirm the probabilistic nature of the ocean swell processes the application of modern measuring equipment has made it possible to shoot high resolution photography and video of ocean surface dugan et al 1996 2001 the statistical and spectral characteristics of ocean waves can be obtained by subsequent processing of visual experimental data using special mathematical methods the fourier transform heideman et al 1985 of a time series of ocean surface images gives an output as a power spectral density function for real ocean waves this probability density function of wave heights ocean surface ordinates which describes both the frequency distribution and the angular spreading directional distribution of wave energy is closely related with the required amplitudes h 0 k ω as its statistically averaged value h 0 k ω 2 based on the fast fourier transform fft concept the swell height field is represented by the superposition of sinusoidal waves with complex amplitudes tessendorf 1999 2001 2002 ebert et al 2000 deusen et al 2004 13 h x y t k x k y h k x k y t exp i k x x k y y where the components of the wave vector are equal to 14 k x 2 π n n f 2 l x 2 π n π n f l x n 0 1 n f 1 k y 2 π m m f 2 l y 2 π m π m f l y m 0 1 m f 1 here n m are the whole numbers in the range 0 n n f 0 m m f i is the complex unit i 2 1 π is the pi number l x l y are the sizes of the computational domain the fft procedure produces the wave heights field at the nodes of computational grid n l x n f 1 m l y m f 1 where n f m f are the sizes of the fourier transform grid the main task is to generate a set of random time dependent amplitudes h k t corresponding to real oceanographic data observations show that the wind waves in the open ocean are quite well described by eq 13 based on the analysis of a large number of radar and wave buoy data scientists come to the conclusion that the swell height amplitudes h k t are statistically stationary gaussian random field with a spatial spectrum of fluctuations defined as 15 p h k h k t 2 various idealized semi empirical ocean wave spectra p h k are used in oceanography and ocean engineering the phillips spectrum is one of the most convenient ocean wave spectrum models for describing of gravity wind waves in a fully developed sea see e g phillips 1958 1977 the concept of a fully developed sea suggests that if the wind blew steadily for a long time over a large area the waves would come into equilibrium with the wind the phillips spectrum is computed as follows 16 p h k a exp 1 k l max 2 k 4 k ˆ w ˆ 2 here l max w 2 g is the maximum wave length for constant wind speed w g is the acceleration of gravity a is a normalization constant w w x w y is the vector of wind speed the normalized unit vectors of k and w are denoted with a hat the factor k ˆ w ˆ 2 in the spectrum expression eq 16 is intended to cut waves propagating perpendicular to the wind direction thus the ocean wave height field is formed by generating gaussian random numbers with given correlation properties required energy spectrum using a method based on the calculation of the discrete fourier transform see tessendorf 1999 2001 2002 ebert et al 2000 deusen et al 2004 the fourier amplitudes of a wave height field are generated in the following way 17 h 0 k 1 2 ξ r i ξ i p h k here ξ r ξ i are the random samples drawn from standard normal distribution with a mean of 0 and a standard deviation of 1 considering the dispersion equation ω k g k the temporal evolution of the ocean wave height field can be described as 18 h k t h 0 k exp i ω k t h 0 k exp i ω k t such representation ensures the implementation of the symmetry property of the complex conjugation operation h k t h k t and provides the propagation of waves both to the right and to the left the components of the right traveling wave correspond to the components of the left traveling wave only with the amplitudes replaced by their complex conjugates and with the signs of the wave vectors reversed the dynamic behavior of the wave pattern is achieved by the time evolution t d t of the swell height field see eq 18 inverse non uniform fast fourier transform is used to transfer from frequency to cartesian coordinates and subsequent visualization of the height map on unstructured grid the inverse nufft process reproduces the required waveform function by summation of generated series of sinusoidal terms eq 13 whose amplitudes form a power spectrum in the frequency domain in the present study the interactive simulation of deep ocean surface is performed by combining the phillips wave spectrum see eq 16 with inverse two dimensional non uniform fast fourier transform technique the used fast fourier transform algorithm for unevenly spaced data is an extension of the classic fft method cooley and tukey 1965 the suggested technique applies the uniform cartesian discretization of the two dimensional frequency domain and unstructured discretization of the spatial domain of the ocean surface the inverse nufft is applied for reproducing the ocean wave elevation field on an unstructured triangular grid this approach gives the following advantages and opportunities for further improvement of the model provides the ability to vary the degree of ocean surface resolution depending on the distance to the viewer for example in the case of using perspective grazing incidence view through adaptation of the grid it is achieved by changing the distances between mesh vertices according to the desired law depending on the distance to the selected domain boundary or to certain points inside the domain the gradual rarefaction of mesh knots with remoteness from viewer can significantly reduce computational cost which is especially important in dynamic modeling of the water surface gives the possibility to simulate the ocean surface regions of complex shapes with multiply connected boundaries of an arbitrary configuration it may be useful for describing a complex coastline and harbor configuration as well as for numerical investigation of wave induced ship motions near stationary marine structures and natural objects of any geometry in contrast the classical fft method can only reproduce the rectangular shaped part of the water surface the local interactive mesh condensation inside the computational domain real time grid adaptation will be useful for a more realistic representation of the sharp wave crests 2 2 theoretical basis of the model of interactive ship dynamics the ship of arbitrary configuration floating freely on the non stationary ruffled ocean surface is considered as partially submerged rigid body the vessel dynamics is described in a ship fixed coordinate system x y z this frame of reference is connected to the ship with its origin at the center of gravity cg wherein the coordinate axes are directed along the principal central axes of inertia of the body the complex motion of the ship in 3d space is defined by the six degrees of freedom the first three are translational motions in surge sway and heave positive or negative directions the last three are the pitching yawing and rolling movements around the transverse y vertical z and longitudinal x axes of the ship fixed coordinate system respectively the relation between the global reference frame xyz and the ship fixed coordinate system at a certain time t is described by the position vector of the center of gravity of the vessel r g c g r x c g r y c g r z c g and the orientation in terms of euler angles landau and lifshitz 1976 pp 110 116 yaw angle ψ roll angle ϕ and pitch angle θ this set of angles is called tait bryan angles tait 1869 bryan 1911 to be precise the motion of the vessel relative to the global frame of reference is characterized by linear velocity v g c g v x c g v y c g v z c g and angular velocity ω g ω x ω y ω z whose projections on the corresponding axes are defined as 19 v x c g d r x c g d t r x c g v y c g d r y c g d t r y c g v z c g d r z c g d t r z c g ω x d ϕ d t ϕ ω y d θ d t θ ω z d ψ d t ψ here the point denotes a time derivative based on newton s second law the equations of motion in a rotating reference frame are written as landau and lifshitz 1976 pp 110 116 20 f t o t m c g d v b c g d t ω b m c g v b c g m t o t i d ω b d t ω b i ω b here f t o t is the resultant force acting on the vessel m c g is the mass of the ship v b c g v x c g v y c g v z c g ω b ω x ω y ω z are the linear and angular velocities in the ship fixed coordinate system m t o t is the resultant moment i is the inertia tensor of the ship the hydrostatic pressure forces f h y d f x h y d f y h y d f z h y d acting on the submerged part of the vessel surface and gravity force f g contribute to the resultant force f t o t the gravity acts downward in the opposite direction to the z axis of the global coordinate system f g 0 0 f z g it is accepted that only the hydrostatic moments m t o t m h y d m x h y d m y h y d m z h y d affect the rotational motion of the ship the torque exerted by the gravitational force in the body fixed reference frame with its origin at the center of mass is zero thus the system of equation 20 describing the ship hull dynamics in the body fixed frame can be represented as follows 21 f x h y d f x g m c g d v x c g d t ω y v z c g ω z v y c g f y h y d f y g m c g d v y c g d t ω z v x c g ω x v z c g f z h y d f z g m c g d v z c g d t ω x v y c g ω y v x c g m x h y d i x x d ω x d t i y y i z z ω y ω z m y h y d i y y d ω y d t i z z i x x ω z ω x m z h y d i z z d ω z d t i x x i y y ω x ω y here f x g f y g f z g are the components of the gravity force f g in the ship fixed coordinate system i x x i y y i z z are the central principal moments of inertia eq 21 take into account that the axes of the rotating reference frame x y z coincide with the principal axes of the vessel the real time rigid body dynamic simulation is performed based on famous verlet algorithm verlet 1967 1968 the well known scheme of integration of equations of motion was originally designed for particles systems in the present study this technique is adapted to accurately computing the linear as well as angular interactive displacements of the rigid body under the action of the set of external forces 3 practical realization of the proposed model for simulation of ship dynamics in irregular waves in this section the details of algorithmic and practical realization of the body waves interactive simulation are presented the concept of the model is explained by concrete examples of dynamic interaction of partially submerged rescue boat with wind generated irregular fluctuations of the water surface for different ocean states particular attention is paid to the choice of modeling parameters the implementation of the interactive dynamic model of the ship on the irregular waves is performed in several stages a preparatory stage preprocessing and dynamic modelling of the body waves interaction 3 1 preparatory phase realization the implementation of the preparatory phase starts from the creation of the solid vessel model of arbitrary configuration with cad software for example autocad autodesk 2019 solidworks 2019 catia dassault systèmes 2019 and so on the three dimensional model of the ship hull is a solid object endowed with mass and volume the used method does not impose restrictions on the complexity of the ship form the mass inertia characteristics of the ship hull model such as the position of center of gravity the mass m c g and the principal moments of inertia i αα α x y z are assumed to be known for the mass and inertia moments it is possible to use approximate values for a number of considered examples the mass characteristics have the following meanings m c g 300 kg i x x 100 kg m 2 i y y 850 kg m 2 i z z 900 kg m 2 the 3d geometry of the vessel is covered with a rather detailed triangular surface mesh which is used as input data any grid generator can be chosen from a large number of existing mesh tools for triangulating the ship outer surface zheleznyakova 2015 fig 1 illustrates some results of the preparatory phase that precedes the simulation the left side of the figure demonstrates the cad solid model of the boat created with solidworks 2019 the overall dimensions in millimeters the distances from the lowermost point of the bow to the center of gravity measured along the body fixed axes and mass properties of the body are also presented the triangular surface mesh covering the ship hull and consisting of n b 5233 nodes and e b 10 462 elements is shown in the right part of fig 1 the implemented non uniform fast fourier transform nufft algorithm which uses the unstructured discretization of the ocean surface is also requires the prior creation of a 2d triangular grid consisting of n os nodes and e os elements in the rectangular domain corresponding to ocean surface patch this simple triangulation can be easily obtained by using any grid generator 3 2 preprocessing procedure the following input parameters must be specified in order to initiate the preprocessing stage of the modelling it is necessary to determine the sizes n f m f of the uniform cartesian fourier grid the number of frequency grid points must be a power of two in both directions the longitudinal and transverse dimensions of the ocean surface patch l x l y in meters wind speed module in meters per second x and y components of the wind direction vector the acceleration of gravity g and the density of water ρ the mosaic structure of the water surface consisting of several l x l y patches which are periodically repeated can be used to simulate of a vast ocean area if the size of the patch is large enough compared with the entire tiled ocean surface under consideration the mosaic structure of the water is invisible the preprocessing phase includes the following steps the first step is to generate the two dimensional uniform cartesian grid in spatial domain l x l y of the ocean surface 22 x n f y m f n l x n f 1 m l y m f 1 n 0 1 n f 1 m 0 1 m f 1 the distances between the uniformly distributed grid nodes must be at least several centimeters the linear approximation is not applicable for a smaller scale due the fact that the influences of nonlinear effects and the surface tension become noticeable the preprocessing involves the generation of a matrix for wave vectors on a fourier grid the wave vector values are determined to each of the n f m f fourier grid points 23 k n m k x n k y m 2 π n π n f l x 2 π m π m f l y k n m k n m k x n 2 k y m 2 n 0 1 n f 1 m 0 1 m f 1 the resultant discrete field is characterized by the fact that the magnitudes of wave vectors k increase and thus wavelengths decrease radially from the center of the domain see fig 2 upper left the power spectral density distribution in the wave number space is generated in accordance with the phillips spectrum see eq 16 thereafter 24 p n m h a exp 1 k n m l max 2 k n m 4 k x n k n m w x w k y n k n m w y w 2 n 0 1 n f 1 m 0 1 m f 1 the wave number module spectrum is defined by only one parameter the wind velocity vector which sets the wind strength and direction the velocity and direction of the storm wind may vary in wide ranges w 0 30 m s w x w cos γ w y w sin γ γ 0 2 π respectively the normalization constant a is chosen in the range of values 10 7 10 6 fig 2 upper right represents the phillips power spectrum on the fourier 128 128 grid for following parameter settings the normalization constant a is assumed to be 10 7 the velocity of the wind blowing in the negative x direction w x w 1 w y 0 is equal to w 10 m s the maximum wave length is equal to l max 10 m wherein the waves moving opposite to the wind direction are cutted off from the ratio of the phillips spectrum it follows that the grid steps in both n and m directions should be chosen one two or even three orders of magnitude smaller than value l max so as not to lose the main harmonics further preprocessing step is dedicated to creating the fourier complex amplitude fluctuations of an ocean surface the initial fields of real re and imaginary im components of the random complex amplitudes h n m 0 see eq 17 are generated based on the phillips spectrum p n m h for the given set of waves 25 h n m 0 re h n m 0 im h n m 0 1 2 ξ r n m p n m h i 1 2 ξ i n m p n m h n 0 1 n f 1 m 0 1 m f 1 the random samples drawn from standard normal distribution ξ r n m with a mean of 0 and a standard deviation of 1 on the fourier grid is presented in fig 2 middle left the adjacent right illustration at fig 2 shows the field of the real components of the fourier random complex amplitudes on the n m grid the conversion from wave number domain to frequency domain is performed using the dispersion relation for water waves connecting the wavelength or wave number and angular frequency 26 ω n m g k n m after that by using eq 18 the ocean surface elevation field in frequency domain at the initial moment of time t 0 can be calculated 27 h n m h 0 n m k φ n m h 0 n m k φ n m n 0 1 n f 1 m 0 1 m f 1 here φ n m φ n m are the complex phase and complex conjugate phase matrices 28 φ n m exp i ω n m t 0 cos ω n m t 0 i sin ω n m t 0 φ n m exp i ω n m t 0 cos ω n m t 0 i sin ω n m t 0 n 0 1 n f 1 m 0 1 m f 1 and h 0 n m k is the complex conjugate of the complex amplitude matrix h 0 n m k the latter is obtained by rotation of the complex amplitude matrix h n m 0 through 180 these amplitudes need only be calculated once during a simulation run the generated field of the initial ocean surface heights in the fourier domain is presented in the lower left corner of fig 2 next the inverse non uniform fast fourier transform is applied to calculate initial ocean wave elevation field on an unstructured triangular grid in the spatial domain the generated initial wave height field in meters in the spatial domain corresponding to wind velocity equal to w 10 m s is presented in the lower right corner of fig 2 the distribution of heights is represented as two color filled contour map the fully developed ocean waves are formed under the influence of wind blowing constantly in the negative x direction over a large water surface area the proposed nufft technology is based on the classical fft method supplemented by the interpolation procedure thus the last nufft step is algorithmically implemented as follows firstly the wave height map h n m is calculated from eq 13 on a regular grid of n m nodes in the spatial domain 29 z n m f h n m b m 0 m f 1 n 0 n f 1 h n m exp i x n f k x n i y m f k y m n 0 1 n f 1 m 0 1 m f 1 where the cartesian coordinates of the regular grid nodes x n f y m f are defined in accordance with eq 22 the wave vector components k x n k y m are computed with eq 23 and b is the wave height scale factor the multiplication of the height matrix by the checkerboard matrix c h n m 1 n m is also necessary to shift the center of the transform to the center of the data shift the zero frequency components at the center of the fourier transform domain secondly the interpolation of the height field z n m f from structured to triangular spatial ocean surface mesh z i o s is performed according to the bilinear interpolation template 30 z i o s z n i m i f b 11 i z n i 1 m i f b 21 i z n i m i 1 f b 12 i z n i 1 m i 1 f b 22 i n 0 1 n f 1 m 0 1 m f 1 i 0 1 n o s 1 where the coefficients b 11 i b 12 i b 21 i b 22 i for each i th unstructured grid node with coordinates x i o s y i o s are calculated as follows 31 b 11 i x n i 1 f x i o s y m i 1 f y i o s x n i 1 f x n i f y m i 1 f y m i f b 21 i x i o s x n i f y m i 1 f y i o s x n i 1 f x n i f y m i 1 f y m i f b 12 i x n i 1 f x i o s y i o s y m i f x n i 1 f x n i f y m i 1 f y m i f b 22 i x i o s x n i f y i o s y m i f x n i 1 f x n i f y m i 1 f y m i f n 0 1 n f 1 m 0 1 m f 1 i 0 1 n os 1 fig 3 gives some explanations to the nufft process the illustrations demonstrate the structure of the 128 128 uniform fourier grid and unstructured discretization of the 2d physical domain with the dimensions 25 m 25 m see fig 3 above the planar triangular grid is consists of n os 45 349 nodes and e os 89 896 elements the scaled up fragments of the grids are shown on the right the elucidation of eq 31 is clearly presented in fig 3 below the generated 3d waved ocean surface corresponds to wind velocity equal to w 10 m s the last one step of preprocessing is the analysis of the ship surface grid which involves calculating the unit outward normals cos n i ˆ α α x y z the coordinates of triangles centroids r α i α x y z in the ship fixed frame and computing the areas of mesh elements s i 3 3 implementation of the interactive dynamic simulation the initial ocean wave elevation field z i o s created on an unstructured triangular grid x i o s y i o s i 0 1 n os 1 is used as input the rescue boat floats freely on the non stationary ruffled water surface see fig 4 the global coordinate system of the computational domain is defined with x y axes lying in the plane of the flat rectangular ocean surface patch in equilibrium and directed along its sides and z axis which is directed vertically upwards at the beginning of the real time dynamic simulation at time t 0 the center of gravity cg of the ship model is located in the point 32 r x 0 c g x 0 o s r y 0 c g y 0 o s r z 0 c g z 0 o s 0 18 where x 0 o s y 0 o s z 0 o s are the coordinates of one of the vertices of the triangular ocean surface grid closest to the center of the modelling water surface patch l x l y the cg is placed at a height of 0 18 m above the water level or at a reasonable height close to this value the boat body is partially immersed in water and part of the surface mesh is located under the ocean surface fig 5 thus the triangular facets of the mesh are divided into dry and submerged based on the dynamically changing wave height data h x y t the triangular facet of the mesh is declared as submerged if its centroid is immersed otherwise if centroid of a triangular element is above water the facet is dry fig 5 using this approach if the condition of smallness of triangular elements is observed it is not necessary to determine the exact line of intersection the ship hull with the water surface and subdivide the triangular elements the ship fixed coordinate system x y z is connected to the ship with its origin at the center of gravity cg the axes x y z are directed along the principal central axes of inertia the longitudinal axis x of the vessel is directed from the stern to the bow the six degrees of freedom as they apply to the boat are shown in fig 6 the initial angular coordinates are determined as ϕ 0 θ 0 ψ 0 it is convenient to set them equal to 0 at the initial moment the ship body is at rest ω α 0 v α c g 0 α x y z time integration of the equations of motion see eq 21 goes as follows step 1 at time t 0 the position of the boat geometry in the global coordinate system is characterized by the center of gravity location r x c g r y c g r z c g and orientation ϕ θ ψ the motion parameters at the current time are described in the body fixed rotating coordinate system and defined by the angular and linear velocities ω α v α c g α x y z step 2 the current coordinates of nodes of the boat surface grid x j b y j b z j b j 0 1 n b 1 in the world frame are calculated as 33 x j b y j b z j b t x y z x y z x j b y j b z j b r x c g r y c g r z c g j 0 1 n b 1 here t x y z x y z is the transformation matrix which maps coordinates from the ship fixed frame to global frame this matrix is calculated for instant angular position ϕ t θ t ψ t of the boat with eq a 5 see appendix a for further details of calculating the transformation matrix 34 t x y z x y z cos ϕ cos ψ sin θ sin ϕ sin ψ cos ϕ sin ψ sin θ cos ψ cos θ sin ϕ sin ψ cos θ sin ψ sin θ sin ϕ cos ψ cos ϕ cos ψ sin θ sin ψ cos θ sin ϕ cos ψ sin θ cos ϕ sin ϕ cos θ cos ϕ in eq 33 x j b y j b z j b are the coordinates of the n b vertices of the original non transformed ship surface grid in the body fixed reference frame the coordinates of the triangles centroids r α i α x y z i 0 1 e b 1 are defined as arithmetic mean of the coordinates of its vertices step 3 the same bilinear interpolation technique see eq 30 and eq 31 is used to determine the water surface elevation h r x i r y i t at a given moment t at a point r x i r y i corresponding to the location of the i th facet centroid r α i α x y z of the vessel surface grid the triangular facets of the boat mesh are divided into submerged the centroid of the element is located under water r z i h and dry the centroid of the element is located above water r z i h based on the wave height data see fig 5 step 4 the components of resultant hydrostatic force f h y d f x h y d f y h y d f z h y d contributing to the total force f t o t see eq 21 are found by summation of the hydrostatic forces f i h y d f x i h y d f y i h y d f z i h y d acting on each of the i th immersed planar faces which can be arbitrarily oriented in 3d space see fig 7 35 f x h y d i ρ g d i cos n i ˆ x s i f y h y d i ρ g d i cos n i ˆ y s i f z h y d i ρ g d i cos n i ˆ z s i i i m m e r s e d i 0 1 e b 1 where ρ is the density of the fluid g is the gravitational acceleration d i is the immersion depth of the facet center s i is the area of the triangular surface element n i is the outward unit normal to the facet provided the triangular facets of the ship surface grid are small enough the hydrostatic forces f i h y d are considered to be applied at their centers this assumption allows to reduce the complexity of the calculations and increase computational productivity the components of the gravity force f g f x g f y g f z g also contributing to the total force f t o t see eq 20 are determined relative to the ship fixed coordinate system according to the last column of the transformation matrix t x y z x y z see eq a 4 and appendix a for details 36 f x g m c g g sin θ cos ϕ f y g m c g g sin ϕ f z g m c g g cos θ cos ϕ the rolling pitching and yawing resultant moments m x h y d m y h y d m z h y d in eq 21 are calculated as a sum of the i th elementary moments m x i h y d m y i h y d m z i h y d with respect to the axes of the body fixed coordinate system which correspond to the principal inertia axis of the vessel fig 7 37 m x h y d i f z i h y d r y i f y i h y d r z i m y h y d i f x i h y d r z i f z i h y d r x i m z h y d i f y i h y d r x i f x i h y d r y i i i m m e r s e d i 0 1 e b 1 here r b i r x i r y i r z i are the centroid coordinates of the i th immersed triangular facet of the ship surface mesh in the body fixed frame step 5 the resultant of the hydrostatic and gravitational forces according with the equations of linear motion see first free eq 21 yields acceleration a α c g α x y z for a center of gravity of the ship 38 a x c g 1 m c g f x h y d m c g g sin θ cos ϕ ω z v y c g ω y v z c g a y c g 1 m c g f y h y d m c g g sin ϕ ω x v z c g ω z v x c g a z c g 1 m c g f z h y d m c g g cos θ cos ϕ ω y v x c g ω x v y c g step 6 the linear velocities at time t d t and elementary time step displacements d r α c g can then be predicted from the current accelerations 39 v α c g t d t v α c g t a α c g t d t d r α c g v α c g t d t d t α x y z step 7 the corresponding elementary moving in the global frame is calculated with transformation matrix t x y z x y z see eq a 5 and appendix a for details 40 d r x c g d r y c g d r z c g t x y z x y z d r x c g d r y c g d r z c g step 8 the moments of the resultant hydrostatic forces cause angular accelerations see last free eq 21 41 ω x 1 i x x m x h y d i y y i z z ω y ω z ω y 1 i y y m y h y d i z z i x x ω z ω x ω z 1 i z z m z h y d i x x i y y ω x ω y step 9 the velocities of rotation about the ship fixed axis at time t d t are computed as 42 ω α t d t ω α t ω α t d t α x y z step 10 the transition from angular velocities relative to the body fixed frame of reference ω x ω y ω z to the angular velocities relative to the global coordinate system ϕ θ ψ is carried out by using transformation eq a 9 see appendix a for further details step 11 the determination of the elementary roll pitch and yaw turns in the world frame is performed as follows 43 d β β t d t d t β ϕ θ ψ step 12 further the method assumes the calculation of the new position of the vessel geometry in the global frame of reference at time t d t 44 r α c g t d t r α c g t d r α c g β t d t β t d β α x y z β ϕ θ ψ step 13 the wave pattern is updated for a next time step by the time evolution t d t of the complex phases see eq 28 and subsequent performing an inverse non uniform fast fourier transform to get the swell height field on triangular ocean surface grid see eq 29 and eq 30 4 results the results of real time dynamic simulation of the ship in irregular wind waves which were generated with the proposed model for different ocean states are presented on fig 8 10 figures demonstrate screenshots of the wind generated irregular fluctuations of the water surface that interact with the partially submerged boat body in the real time mode the interactive frame rate is assumed to be equal to 30 frames per second fps which is the standard of the video industry therefore a uniform time step d t 0 033 s is chosen instant wave patterns obtained with the described model are correspond to the ocean surface patch with dimensions of 25 25 m wind blowing in the negative x direction with speeds of 3 m s figs 8 10 m s fig 9 and 20 m s fig 10 figs 8 10 illustrate the ability of the model to simulate the rough sea states which agree well with the beaufort scale relating wind speed and conditions in the open ocean huler 2004 the light breeze with speed of 3 m s two points on the beaufort scale causes the short and quite pronounced wavelets with heights not exceeding 0 5 m the ocean disturbance number is equal to one fig 8 the fresh breeze blowing with velocity 10 m s five points on the beaufort scale generates extended 2 m waves the ocean disturbance number is equal to four fig 9 the gale force wind blowing steadily at 20 m s eight points on the beaufort scale provokes the significant ocean disturbance about six points with wave heights of 5 5 m fig 10 a series of animations anim 1 3 demonstrates the real time dynamic modeling of the rescue boat in irregular wind waves for the three considered ocean states 5 discussion this section is devoted to a discussion of the abilities properties and characteristics as well as accuracy stability and computational efficiency of the developed interactive waves body model the comparative analysis of the proposed method based on the results from the literature review shows for the considered problem of interactive ship motion simulation on a standard desktop computer the developed simplified approach may be more preferable than sophisticated high precision partially fully nonlinear potential theory methods hirdaris et al 2014 rajendran et al 2015 mortola et al 2011 and rans techniques lavrov et al 2017 gadelho et al 2018 sayeed et al 2018 due to their computational complexity these approaches are not suitable for real time modeling the actual ship responses and associated structural loads caused by weather changes and possible variation in course or speed despite the relative simplicity of the implemented physical concept the suggested model can provide any predetermined accuracy within the framework of the deep water and open water assumptions by refinement the grids covering the sea surface and the ship hull methodologies which are based on the linear strip theory fonseca and guedes soares 1998 sutulo et al 2010 varela and guedes soares 2011 can be used for computing the ship motions at interactive frame rates however raos should be preliminary determined for each particular ship hull with specific cargo conditions in contrast the proposed method allows to use arbitrary three dimensional geometric models of the ships of any complexity the behavior of the ship is fully determined by its geometry the ship s manoeuvring characteristics are not required the proposed method allows to create mathematical model for ship simulation without recourse to experimental data the minimum number of input parameters and fitting coefficients are needed to initiate the simulation users have the opportunity to vary the characteristics defining the vessel behavior even possessing only superficial knowledge in the ship theory the developed computational model can be used for predictive modelling at the initial design stage in shipbuilding industry to determine the configuration of a new vessel based on the design requirements as well as for mathematical support of the final phase devoted to the manoeuvrability tests the very fast three degrees of freedom models sutulo et al 2002 neri et al 2016 zhang et al 2004 do not compute wave induced ship motions and wave ship interactions also these approaches do not take into account the geometric configuration of the vessel neglecting the z translation pitch and roll degrees of freedom is a reasonable and very good first approximation these methods are acceptable for positioning estimation and trajectory tracking for simulate port operations but are not suitable for ship s stability computational analysis besides the approach developed by neri et al 2016 requires the manoeuvrability data the program implementation of the full six degrees of freedom ship model reported by daqaq and nayfeh 2004 is not actually a real time simulator the dynamics characteristics of the ship are previously determined for a large number of sea conditions the interactive virtual environment is used for post processing visualization and real time interaction with the ship mounted crane operator the suggested method provides the minimal discrepancy between the sea surface state and the motion response of the ship even a slight discrepancy becomes noticeable to a user significantly reducing the sense of immersion thus there is no need to establish and maintain the synchronism between the evolving irregular wave field and ship motions see for example varela and guedes soares 2011 the application of the proposed technique allows to get around the problem faced by cieutat et al 2001 their method uses the curvature of the waved sea surface as the only reason that causes the ship movement consequently the ship will stop moving immediately as soon as waves subside that is contrary to the real behavior of the ship the current approach preserves the physical soundness and accuracy to obtain valid conclusions in the absence of resistance in the proposed model the artificial limitations of the modules of linear and angular velocities of the ship are used wherein the direction of the linear or angular velocity vector does not change vector is normalized to the limiting value the ceiling values are selected in the ranges 0 5 1 5 m s and 0 3 0 8 rad s for linear and rotational velocities respectively depending on the strength of the storm and ship motions intensity the imposed limitation guarantees the dynamical stability during interactive simulation the stability and accuracy of the method for integration of the equations of motion of the ship as well as errors introduced by the surface fragmentation into grid facets can be estimated by a computational experiment for this purpose the calm wind conditions are simulated the vessel model is partially submerged in the mirror smooth water surface figs 11 12 the initial position of the ship the cg location relative to water level is set as close as possible to the equilibrium position r z 0 c g 0 1093 the latter is easily determined by several test runs in this special case the linear velocity is limited by the 0 001 m s and the angular velocity is limited by the 0 0005 rad s the time dependences of the components of total force f t o t f x t o t f y t o t f z t o t and resultant moment m t o t m x t o t m y t o t m z t o t are placed on figs 11 12 after short period of relaxation the relaxation period depends on the initial location of the ship and limiting values for velocities the system reaches near equilibrium state the forces and moments are almost compensated and experience only minor short term numerical fluctuations near the zero or near the acceptably small value of unbalanced force f x e r r f y e r r or moment m z e r r the real time dynamic simulations are run on a desktop computer with the cpu intel core i7 3770 3 4 ghz 16 gb ram and sufficient powerful graphics card the performance of about 106 frames per second is the limit of capability that the proposed algorithm provides for the tasks in question on the used computing equipment the developed model for simulation of the ocean surface dynamics and waves body interaction implements the algorithm which involves the following computationally expensive steps excluding preparatory phase create the field of the fourier random complex amplitudes in the frequency domain based on the wind wave energy spectrum performed once at the initial time step calculate the templates for interpolation of the wave height field from structured to triangular ocean surface mesh once at the initial time step analyzing the ship surface grid which involves computing the unit outward normals areas and centroids coordinates for the triangular elements once at the initial time step time shifting of the complex phases of the statistical wave ensemble performing an inverse non uniform fast fourier transform to get the swell height field on the triangular ocean surface grid at each time step defining the water surface elevation for every facet centroid of the vessel surface grid subsequent division into submerged and dry facets for each time step compute the components of total hydrostatic force rolling pitching and yawing resultant moments by summation of the elementary hydrostatic forces and moments acting on each of the i th immersed planar faces at each time step calculate of linear and angular motions parameters and the elementary time step displacements for a center of gravity of the ship for each time step conversion from the body fixed coordinate system to the global reference frame at each time step the computation times of the simulation phases cyclically repeating in every time step for hundred thousand iterations are given in table 1 computational cost of the dynamic simulation stages is measured by processor time it takes to run divided by the total number of time steps in s step it is clear from the data presented in the table that the inverse non uniform fast fourier transform is the most computationally expensive stage of modelling 6 conclusions a new economic approach to physical modeling of the ocean surface dynamics and interaction of irregular wind waves with a ship of arbitrary configuration in the real time is developed the interactive simulation of deep ocean surface is performed by combining the phillips wave spectrum which is obtained on the basis of observation data with inverse two dimensional non uniform fast fourier transform nufft technique the interactive simulation of the immersed rigid body dynamics is performed based on modified verlet algorithm the capability of simulating the dynamic wave body interaction in real time is achieved by using simple stable fast and computationally efficient algorithmic implementations despite the relative simplicity of the implemented physical concept the suggested model can provide any predetermined accuracy within the framework of the deep water and open water assumptions by refinement the grids covering the sea surface and the ship hull the described computational method does not impose restrictions on the complexity of the ship configuration the behavior of the ship is fully determined by its geometry the ship s manoeuvring characteristics are not required the proposed method allows to create mathematical model for ship simulation without recourse to experimental data the computational model does not require the routine selection of fitting coefficients which have no physical meaning it is necessary to determine a small number of physically based input parameters to initiate the simulation the dimensions of the ocean surface patch wind speed module and direction the acceleration of gravity the density of water and the mass inertia characteristics of the ship the mass principal moments of inertia cg location users have the opportunity to vary the characteristics defining the vessel behavior even possessing only superficial knowledge in the ship theory the developed computational model can be used for predictive modelling at the initial design stage in shipbuilding industry to determine the configuration of a new vessel based on the design requirements as well as for mathematical support of the final phase devoted to the manoeuvrability tests the application of unstructured grid approach allows to vary the degree of ocean surface resolution depending on the distance to the viewer for example in the case of using perspective grazing incidence view through adaptation of the grid it can be achieved by changing the distances between mesh vertices according to the desired law depending on the distance to the selected domain boundary or to certain points inside the domain the gradual increasing of distances between the nodes with remoteness from viewer can significantly reduce computational cost which is especially important in dynamic modeling of the water surface several examples of real time dynamic modeling of the rescue boat in irregular wind waves are considered in order to illustrate the capabilities of the method to reproduce the changeable water surface for ocean states in a wide range of wind speeds and body waves interaction the author hopes that the suggested technique is promising in terms of further improvement efforts will be made to increase the physical realism of the numerical model based on the proposed physical mathematical method the ship sea coupled model for simulation of ship motions will be expanded by including the effects of wind current propellers rudders and the nearby passing ship the visual realism of the ocean surface and the physical accuracy of the simulation will be raised due to increasing the number of elementary waves refinement the fourier grid it is also planned to add splashes foam the wave field induced by the ship itself and ship wake the local interactive condensation of the unstructured mesh nodes inside the computational domain real time grid adaptation will be applied for a more realistic representation of the sharp wave crests the advantages of unstructured grid approach will be used for simulating the ocean surface regions of arbitrary geometry with complex multiply connected boundaries describing coastline harbor or island configuration the numerical studies of wave induced ship motions near stationary marine structures and natural objects with complex geometry will be conducted acknowledgements the work was performed within the framework of the government program of basic research of the russian academy of sciences contract aaaa a17 117021310372 6 appendix a coordinate and velocities transformations from global to ship fixed coordinate systems and vice versa the transformation of coordinates from global frame xyz to ship fixed frame x y z is carried out through the three translations and three tait bryan positive rotations referred to above as yaw ψ roll ϕ and pitch θ they can be considered independent of the other fig a1 the first one is the counterclockwise rotation around the z axis when viewed looking down the positive z axis through an angle ψ see fig a1 left this intermediate transformation from frame xyz with unit vectors e x e y e z to frame x 1 y 1 z 1 with unit vectors e x 1 e y 1 e z 1 can be represented with a transformation matrix t x y z x 1 y 1 z 1 as follows a1 x 1 y 1 z 1 t x y z x 1 y 1 z 1 x y z cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 x y z the angular velocity vector corresponding to yaw rotation is equal in magnitude to ψ and is directed along rotation axis e z namely ω ψ ψ e z the second one is the counterclockwise rotation around the x 1 axis when viewed looking down the positive x 1 axis through an angle ϕ fig a1 middle the corresponding transformation of coordinates from x 1 y 1 z 1 to x 2 y 2 z 2 with unit vectors e x 2 e y 2 e z 2 performed as a2 x 2 y 2 z 2 t x 1 y 1 z 1 x 2 y 2 z 2 x 1 y 1 z 1 1 0 0 0 cos ϕ sin ϕ 0 sin ϕ cos ϕ x 1 y 1 z 1 the rotational velocity for this case can be represented as ω ϕ ϕ e x 1 the last one is the counterclockwise rotation around the y 2 axis when viewed looking down the positive y 2 axis through an angle θ fig a1 right the third transformation of coordinates from x 2 y 2 z 2 to x y z with unit vectors e x e y e z can be accomplished as a3 x y z t x 2 y 2 z 2 x y z x 2 y 2 z 2 cos θ 0 sin θ 0 1 0 sin θ 0 cos θ x 2 y 2 z 2 the pitch rotation around the y 2 axis is characterized by angular velocity ω θ θ e y 2 finally we have a 4 x y z t x 2 y 2 z 2 x y z t x 1 y 1 z 1 x 2 y 2 z 2 t x y z x 1 y 1 z 1 x y z t x y z x y z x y z cos θ cos ψ sin θ sin ϕ sin ψ cos θ sin ψ sin θ sin ϕ cos ψ sin θ cos ϕ cos ϕ sin ψ cos ϕ cos ψ sin ϕ sin θ cos ψ cos θ sin ϕ sin ψ sin θ sin ψ cos θ sin ϕ cos ψ cos θ cos ϕ x y z the reverse transformation from rotating coordinate system x y z to global frame x y z is based on the inversion of the elementary rotation matrices which is equivalent to their transpose a 5 x y z t x y z x 1 y 1 z 1 t t x 1 y 1 z 1 x 2 y 2 z 2 t t x 2 y 2 z 2 x y z t x y z t x y z x y z t x y z t x y z x y z x y z cos ϕ cos ψ sin θ sin ϕ sin ψ cos ϕ sin ψ sin θ cos ψ cos θ sin ϕ sin ψ cos θ sin ψ sin θ sin ϕ cos ψ cos ϕ cos ψ sin θ sin ψ cos θ sin ϕ cos ψ sin θ cos ϕ sin ϕ cos θ cos ϕ x y z from eq a 4 follows a 6 t x y z x y z e z t x 2 y 2 z 2 x y z t x 1 y 1 z 1 x 2 y 2 z 2 t x y z x 1 y 1 z 1 e z t x y z x y z 0 0 1 sin θ cos ϕ sin ϕ cos θ cos ϕ e z sin θ cos ϕ e x sin ϕ e y cos θ cos ϕ e z t x 1 y 1 z 1 x y z e x 1 t x 2 y 2 z 2 x y z t x 1 y 1 z 1 x 2 y 2 z 2 e x 1 cos θ sin θ sin ϕ sin θ cos ϕ 0 cos ϕ sin ϕ sin θ cos θ sin ϕ cos θ cos ϕ 1 0 0 cos θ 0 sin θ e x 1 cos θ e x sin θ e z t x 2 y 2 z 2 x y z e y 2 cos θ 0 sin θ 0 1 0 sin θ 0 cos θ 0 1 0 0 1 0 e y 2 e y the angular velocity vector taking into account eq a 6 can be written as a 7 ω ω ψ ω ϕ ω θ ψ e z ϕ e x 1 θ e y 2 ψ sin θ cos ϕ e x sin ϕ e y cos θ cos ϕ e z ϕ cos θ e x sin θ e z θ e y ψ sin θ cos ϕ ϕ cos θ e x ψ sin ϕ θ e y ψ cos θ cos ϕ ϕ sin θ e z the relationships between the components of rotational velocity vector of the ship fixed coordinate system and the euler tait bryan angles as well as their derivative can be obtained a 8 ω ω x ω y ω z ψ sin θ cos ϕ ϕ cos θ ψ sin ϕ θ ψ cos θ cos ϕ ϕ sin θ finally the ratios for components of angular velocity vector that are used to transition from a body fixed coordinate system to the global reference frame can be derived from eq a 8 a 9 ω ω x ω y ω z ϕ θ ψ ω x cos θ ω z sin θ ω y ω z cos θ tg ϕ ω x sin θ tg ϕ ω z cos θ cos ϕ ω x sin θ cos ϕ fig a1 the tait bryan angles and a sequence of three elemental rotations fig a1 appendix b supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106686 
22257,a physically based computational model which implements a variety of technologies to real time simulation of the ocean surface dynamics and waves body interaction is proposed the method uses data from experimental observation of the real ocean stochastic description of irregular wind waves inverse non uniform fast fourier transform mathematical tool unstructured grid representation for changeable water surface and complex geometry of the floating object reasonably full and accurate immersed rigid body dynamics fast and stable algorithms for solving the equations of motion the integrated mathematical model combines the proven approaches which are adapted and modified for stated goals the developed approach does not impose restrictions on complexity of the immersed body configuration the implemented algorithms allow to perform an interactive simulation on a desktop computer using high resolution surface meshes without loss of frame rate some examples are considered to demonstrate the abilities of the model to simulate the interaction of partially submerged body rescue boat with wind generated irregular fluctuations of the water surface in the real time mode graphical abstract image 1 keywords real time physically based modelling irregular ocean waves dynamics unstructured surface mesh immersed rigid body dynamics inverse non uniform fast fourier transform nufft wave body interaction 1 introduction the tasks of a reliable mathematical modelling of changeable ocean surface and a detailed description of the interaction dynamics of waves and a freely floating body in real time mode are of undoubted scientific interest and are also very relevant in many areas of human activity in the cinema tessendorf 1999 2001 2002 ebert et al 2000 deusen et al 2004 and computer games industries ship simulator extremes 2019 virtual sailor 2019 when developing training simulators boeing and braunl 2007 ueng et al 2008 varela and guedes soares 2011 massei et al 2013 yu et al 2017 transas 2019 in scientific visualization giannakidis et al 2014 and in many other areas where computer graphics is widely applied the water surface is fairly common object which is the most difficult to reproduce computer generated ocean surfaces have been commonly used in movies such as waterworld titanic the perfect storm finding nemo life of pi and so on since 1995 the constantly changing configuration of the free water surface is difficult to give an accurate mathematical description even using a large number of geometric primitives the complex dynamic behavior of the ocean is controlled by multiple phenomena occurring at small and large scales and may vary from calm to agitated ocean from small waves to enormous shorebreaks darles et al 2011 these mechanisms vary considerably depending on the ocean surface location in physical oceanography water area is divided into deep ocean intermediate and shallow water areas in deep waters the parameters of waves on the free surface are defined by the oscillatory behavior of the air water interface as the waves enter shallow water near the shore their heights increase and they change into breaking waves over the past 30 years the computer graphics has advanced significantly in solving problem of reliable representing the visual complexity of the phenomena under consideration various algorithms and technologies are used in the development of expensive systems for 3d modeling and visualization of water surfaces the parametric approach is based on tracking of the paths of water particles and describes the free surface with parametric equations derived from satellite observations or buoys measurements biesel 1952 the spectral approximations describe the state of the sea using waves spectrum pierson and moskowitz 1964 hasselmann et al 1973 bouws et al 1985 and compute waves distribution according to their amplitudes and frequencies the basis of many algorithms reconstructing water surfaces is the fast fourier transform fft which is applied to specially processed random noise varying over time through a frequency dependent phase shift the works of dr j tessendorf and his co authors tessendorf 1999 2001 2002 ebert et al 2000 deusen et al 2004 have made an important contribution in this direction of realistic visualization of water surface behavior dr tessendorf s fluid dynamics tools for efficient simulation and rendering highly realistic ocean surfaces were successfully used in numerous films such as titanic waterworld and many others his achievements were reported annually from 1999 to 2004 at the siggraph conference and recognized by the academy award for technical achievement in 2008 however the traditional fft methods have some difficulty in modelling of the interaction between water waves and floating bodies in interactive mode finally the navier stokes partial differential equations describing the motion of a continuous linear viscous medium can be used for the most complete physically based representing of the dynamical behavior of the ocean the first two groups of methods which use oceanographic models are better suited for simulation of deep waters due to accurate representation of oscillatory motion of the sea surface but since they cannot take into account the interaction with the ocean floor in shallow waters only techniques relying on approximate solution of the navier stokes equations are capable to reproduce the complexity of sea dynamics near the shore the reliable integrated model of irregular waves affecting the floating body can be obtained only by taking into account the real physical properties of the aquatic environment immersed rigid body dynamics as well as the complex geometries of free water surface and immersed object it is necessary to increase the realism and at the same time to maintain the downward trend in the computer resources consumption when modeling natural phenomena a balance should be struck between realism of the model and computational complexity of the algorithms depending on the specific application the creation of the image of a dynamically changing water surface does not require an exact reproduction of the process from the point of view of physics of the phenomenon thus the development of new economic approaches which implement simplified but physically based models with the aim of increasing the effectiveness of the real time visualization systems is a very urgent task a number of ship motion loads prediction systems based on various physical models and techniques have recently been developed presently most computational algorithms implement mathematical models based on potential flow wave theory and methods which solve the reynolds averaged navier stokes rans equations the majority of techniques for computing ship motions belong to the first group a comprehensive review of the theoretical methods implemented in modern ship motion software to predict the wave wind current ice induced linear and nonlinear motion responses and structural loads for the design of ships and offshore structures was presented in hirdaris et al 2014 hirdaris et al 2014 summarized and classified the recent advances on ship motion prediction based on potential flow theories ranging from linear approaches to fully nonlinear methods four more partially nonlinear or blended methods were placed between these two extremes in the order of complexity in the framework of the linear theory the ship motions are determined by a linear superposition of sinusoidal components with a random initial phase bhattacharyya 1978 the amplitude of each of the components is calculated by response amplitude operators raos rao expresses the relationship between ship motion and wave height versus regular wave frequency lewis 1989 raos are obtained by a series of wave tank tests or calculated by specialized software programs implementing the classical strip theory salvesen et al 1970 the theory assumes the vessel hull to be an oscillating and translating slender body whose motion is characterized by added mass and damping coefficient in heave and pitch displacements the strip theory gives good results for ship motions in low to moderate regular waves in which the influence of nonlinearities is insignificant this promising technique was further extended and developed in fonseca and guedes soares 1998 sutulo et al 2010 varela and guedes soares 2011 by modelling the large amplitude motions and taking into account the influence of irregularity of waves and sea bottom for shallow waters fonseca and guedes soares 1998 were able to improve the method by expanding the scope of its applicability for modelling the large amplitude motions the paper by sutulo et al 2010 was dedicated to the development of boundary element method to compute the inertial added mass and damping characteristics of ship sections in variable depth shallow water areas with multi stepped and inclined bottoms varela and guedes soares 2011 presented a methodology to simulate the ship motions in irregular waves described by a real wave spectrum at interactive frame rates the inverse discrete fast fourier transform algorithm was applied to compute the sum of all elementary ship displacements induced by the irregular waves and get the final complex ship motion the random sea surface was deformed by thousands of wave trains with different amplitudes frequencies and directions the transfer functions of a liquefied gas carrier which described how the ship reacted to forces generated by wave trains with different properties were used to apply the method for a variation of sea states and maneuverability conditions the method provided the high degree of realism as well as establishment and maintenance of synchronism between the phases of wave trains and ship motions for all investigated ship positions speeds and headings a significant number of partially nonlinear methods have been developed to account for the various most important nonlinear effects rajendran et al 2015 suggested a method for predicting the body nonlinear froude krylov and hydrostatic forces as well as nonlinear radiation and diffraction forces which expresses the dependence of hydrodynamic forces on the time changing underwater hull shape the approach was used to calculate the vertical motions and bending moments on a modern cruise ship which were excited by the regular waves with different steepnesses mortola et al 2011 developed a time domain approach for prediction of ship motions and wave loads in the proposed mathematical formulation all the involved forces were nonlinear and time dependent the restoring froude krylov and diffraction forces were calculated at each time step for the exact position of the hull the diffraction forces were determined in accordance with the strip theory salvesen et al 1970 hydrodynamic coefficients were computed using strip theory for relevant combinations of section immersions and heel angles the simplified approach was applied for accounting the forward speed effects the raos of heave pitch and vertical bending moments vbm at midship were obtained for s175 containership in head regular waves in the case of zero speed the boundary element methods applied couple with the potential theory cannot describe breaking waves spray and water flowing onto and off the ship s deck besides it is necessary to involve other methods for calculation of the viscous forces therefore the recent research results show a trend toward the use of cfd simulations based on methods which solve the rans equations lavrov et al 2017 gadelho et al 2018 sayeed et al 2018 lavrov et al 2017 calculated the hydrodynamic coefficients of 2d ship sections subjected to forced nonlinear roll motions by using the navier stokes solver implemented in computational fluid dynamics openfoam software the hull section harmonically rolled on the water surface with frequencies which covered nearly all possible frequencies encountered in real sea waves the forced motions on ship sections oscillating in calm water as well as the free surface capturing were modeled the influence of viscosity on the roll motion was investigated the viscous unsteady results were compared with potential flow solutions and experimental data gadelho et al 2018 investigated the heaving and swinging characteristics of two dimensional sections of boat hull using open source code openfoam the hydrodynamic coefficients of ship hull sections subjected to heave and sway motions in shallow and deep water were numerically determined the work of gadelho et al 2018 demonstrated the results as values of the added mass and damping coefficients which correlate well with boundary integral equation method in the potential flow formulation a preliminary assessment of the necessity of viscosity consideration on the determination of the hydrodynamic coefficients which should depend on the section topology and depth was carried out the paper of sayeed et al 2018 covered the experimental and numerical investigations of the force and motion behavior of partially submerged berg bodies induced by irregular waves near a fixed structure numerical simulations of the waves body interaction were performed using rans based commercial cfd code flow3d the computational results were compared to the experimental data test cases from both force and motion experiments were simulated in irregular waves generated from experimental wave spectra as techniques become more sophisticated calculations become more time consuming complex partially and fully nonlinear potential theory flow models as well as navier stokes models agreed well with the experimental data hirdaris et al 2014 but their implementation in real time ship motion simulators can be problematic thus there is also a need to develop accurate and fast simplified numerical models which can be implemented in modern systems for real time monitoring the actual ship responses and associated structural loads due to weather changes and to possible variation in course or speed sutulo et al 2002 studied the problem of interactive simulation of the ship manoeuvring motion the simplified but fast approaches based on dynamic and kinematic prediction models were proposed the problem was treated as three degrees of freedom the surge sway and yaw translation along the x axis translation along the y axis and rotation around the vertical z axis respectively were taken into account in the motion equations the heave roll and pitch linear up down motion rotation about the x axis and rotation about the y axis respectively caused by the waves were not considered the coefficients of the manoeuvring equations were determined on the basis of manoeuvring characteristics which were obtained experimentally the model was developed for real time trajectory calculation in the manoeuvring simulator and provided the standard frame rate on a personal computer a ship motion short term time domain simulator was proposed by neri et al 2016 the authors presented a simple but reliable methodology for real time prediction of a cruise ship behavior during manoeuvres the method is quite general and could be applied to any kind of ship but it requires the manoeuvrability data contained in the manoeuvring booklet the experimental data were used to extract the model s parameters and coefficients the complex physical system of the ship was simplified with a three degrees of freedom model translation along z coordinate pitch and roll rotations were not considered the effect of wind and current were negligible the equations of motion taking into account the rudders torque water viscosity as well as forces and moments produced by the propeller were integrated in time to calculate the ship position and orientation at every time step zhang et al 2004 developed the simple and fast three degrees of freedom simulation model describing the real time motion of a ship sailing inside a harbor in surge sway and yaw directions the methodology was based on the calculation of total forces acting on the ship then the simplified first order differential equations establishing the relation between forces and accelerations were derived using newton s law the differential equations were solved by the runge kutta method to calculate the displacements of the ship the mathematical model was tested with ship trial manoeuvre data a three dimensional realistic view of the ship was reproduced by the virtual reality technique in the large ship manouvring simulator the assumption of a three degrees of freedom model is a reasonable and very good first approximation neglecting of z translation pitch and roll degrees of freedom is acceptable for positioning estimation and trajectory tracking for simulate port operations but is not suitable for ship s stability computational analysis cieutat et al 2001 developed the simplified methodology to compute the six components of the real time vessel motion the waved sea surface was generated by the approach based on the gerstner model where particles of water describe circular or elliptical stationary orbits fournier and reeves 1986 the wave height field was updated at every time step then the ship was oriented according to the tangent plane to the water surface the virtual model predicted the ship responses for surge sway and yaw as well as the heave roll and pitch motions another efficient computational model to simulate six degrees of freedom ship motions in real time was reported by ueng et al 2008 the six degrees of freedom were calculated separately and superimposed to generate the overall movement of the ship according to the vessel shape draft and mass the pitch heave and roll movements were induced by sea waves and the surge sway and yaw displacements were caused by propellers rudders current and wind the ship was treated as a rigid body floating on the surface of the deep sea the waves were comprised with sinusoidal modes of different frequencies speeds and angles the moving two dimensional uniform cartesian grid coupled with the ship was generated in the horizontal plane the rectangular grid boundary was determined by the bounding box of the vertical projection of the ship s body into the horizontal plane then the rectangular domain was divided by a uniform grid the height field of the sea surface was evaluated at each grid point the excitation force of water was calculated by multiplying the average height field with the area of the grid and the force for ship motions was computed for each ship motion component the net force was obtained by subtracting the resistance force from the force of water the accelerations velocities and magnitudes of the motions were calculated by applying newton s law one more real time simulator was described in the paper daqaq and nayfeh 2004 this simulator was applied as a platform to study the dynamics of ships and ship mounted cranes under dynamic sea environments and as a training platform for their operators the crane ship was assumed to be a rigid body with fixed moments and products of inertia in the body fixed frame the ship floated on the free wavy surface and arbitrary moved with six degrees of freedom the complete system of equations of motion was numerically integrated using a fourth order runge kutta method the ship motions were not really calculated in interactive regime instead a database containing the ship response such as positions velocities accelerations for a large number of sea conditions was used the dynamics characteristics were previously computed and the virtual environment was applied for post processing visualization and real time interaction with the ship mounted crane operator the results presented by authors daqaq and nayfeh 2004 demonstrated a sufficient realism in modeling different ship motion and cargo transfer scenarios during loading unloading operations the purpose of this study is to develop an integrated computational model combining the oceanographic measurement data stochastic description of irregular deep water wind waves inverse non uniform fast fourier transform nufft technique unstructured grid representation for water surface configuration and arbitrary geometry of the floating object reasonably full and accurate immersed rigid body dynamics fast and stable algorithms for solving the equations of motion with the goal of interactive simulation of the ocean surface dynamics and waves body interaction the effectiveness of the implemented computational method is demonstrated with several visual examples the layout of the paper is as follows section 2 is devoted to describing a mathematical model of the body waves system under consideration governing equations and the theoretical foundations of the proposed simulation method in section 3 the main concepts of the developed model details of algorithmic and practical implementation as well as justification of the simulation parameters choice are presented in section 4 the results of real time dynamic simulation of the ship in irregular wind waves which were obtained with the created model for different ocean states are considered section 5 contains a discussion of the abilities properties and characteristics of the model finally concluding remarks are provided in section 6 2 material and methods in the current section the underlying theoretical basis for the developed modelling method is given 2 1 theoretical background of a dynamic model of the surface irregular waves ocean dynamics in general is governed by the three dimensional nonstationary navier stokes equations a very difficult task of solving the navier stokes equations can be simplified using reasonable assumptions by neglecting the viscous dissipation compressibility and heat conduction effects the adiabatic motion of an ideal fluid in the gravity field can be described with the aid of the euler equation augmented by continuity equation landau and lifshitz 1987 pp 2 5 1 v t v v p ρ g v 0 where v v x t is the flow velocity vector with components υ x υ y υ z in three dimensional space ρ x t is the density of the fluid p x t is the pressure of the fluid g g 0 0 g is the vector of gravitational field strength is the nabla operator x x x y z is the radius vector of an arbitrary location within a fluid mass in the world coordinate system since gravity acting on the mass of the ocean fluid is a conservative force the dynamics of the ocean surface can be described with equations for potential flows assuming potentiality of the fluid flow eq 1 can be transformed into landau and lifshitz 1987 p 17 2 ϕ t 1 2 ϕ 2 p ρ g x 0 3 2 ϕ δ ϕ 0 where ϕ x t is the velocity potential v ϕ a number of additional assumptions are made for significantly simplifying the mathematical and computational complexity of the problem and for creating an interactive and efficient dynamic model of the waving free ocean surface the water surface in equilibrium in a gravitational field is a plane z 0 the z axis is directed upward under the action of some external perturbation the equilibrium is broken and wave disturbances begin to spread over the whole surface gravity waves propagate in a reservoir unlimited in two directions along the xy plane the model assumes that only free surface of a liquid is involved in the movement and the internal fluid volume is not considered the latter allows dimensionality reduction of the problem from 3d to 2d this may seem like an oversimplification however the very rapid damping of the oscillations of water particles with depth is an experimentally established fact dynamically changing ocean surface is represented as height field h x y t thus h x y t gives the vertical displacement of the sea surface in its oscillations it is also assumed that the velocity of the moving fluid particles is so small that the term v v may be omitted in comparison with v t in the euler equations see eq 1 the physical interpretation of this is easily considered the order of magnitude of the fluid particle velocity can be estimated as ϑ a τ where a is the amplitude τ is the period of oscillation of the fluid particle in an deep ocean wave the time derivative of velocity in turn is of the order of ϑ τ and the space derivative of velocity is of the order of ϑ λ where λ is the wavelength thus the condition v v v t is equivalent to the requirement a τ ϑ λ ϑ τ or a λ 1 and finally a λ this means the smallness of amplitude compared to wavelength landau and lifshitz 1987 pp 31 37 due to the smallness of the velocity the term v 2 2 ϕ 2 2 in eq 2 may be neglected since it contains the square of the velocity as a result of the linearization of eq 2 we obtain landau and lifshitz 1987 pp 31 37 4 p ρ ϕ t ρ g z let a constant external atmosphere pressure p 0 acts on the surface then at the surface eq 4 gives landau and lifshitz 1987 pp 31 37 5 p 0 ρ ϕ t ρ g h x y t the constant p 0 can be eliminated by redefining the potential ϕ adding to it a quantity p 0 t ρ which is independent of the coordinates we then obtain the condition at the surface in the form 6 ϕ x y z t t z h x y t g h x y t since the fluid particles at the surface move together with the fluid the normal velocity of the fluid close to the free surface must be equal to the normal velocity of the surface element on the assumptions that the amplitude of the wave oscillations is small enough and the ocean surface is not curved and oscillates up and down accepted simplifications are valid in the framework of the linear model we have landau and lifshitz 1987 pp 31 37 7 h x y t t ϕ x y z t z z h x y t the ratio for an approximate definition of the vertical derivative operator can be obtained from the continuity equation see eq 3 8 z 2 x 2 2 y 2 from eq 7 and taking into account eq 8 on the free water surface we get 9 h x y t t 2 x 2 2 y 2 ϕ x y t by differentiating eq 9 with respect to time t and substituting eq 6 into it we finally obtain the equation for the ocean surface dynamics 10 2 h x y t t 2 g 2 x 2 2 y 2 h x y t this equation of sea surface motion is linear with respect to the desired function h x y t the general solution of the linear differential equation is the sum of the particular solutions which have the form 11 h x y t h 0 exp i k x x k y y i ω t where k x k y h 0 ω are the wave parameters at a point on the water surface on substitution of the specific solution eq 11 into differential eq 10 we obtain 12 h 0 ω 2 g k 0 here k 2 π λ is the module of wave vector k k x k y λ is the length of the wave the algebraic eq 12 has the solutions ω g k except the trivial case h 0 0 which corresponds to a flat water surface the last relation is nothing more than the dispersion equation relating the frequency ω and wave vector k the temporal and spatial periodicity of the wave consequently for a given wave k the angular frequency and the propagation velocity are uniquely determined a statistical approach tessendorf 1999 2001 is applied to determine the amplitude values h 0 k ω the random amplitude realizations are based on oceanographic measurements of the variance properties of wave height on the open ocean dugan et al 1996 2001 and semi empirical models phillips 1958 1977 the expediency of using the dispersion equation for a real time simulation of water surfaces is supported with experimental results which confirm the probabilistic nature of the ocean swell processes the application of modern measuring equipment has made it possible to shoot high resolution photography and video of ocean surface dugan et al 1996 2001 the statistical and spectral characteristics of ocean waves can be obtained by subsequent processing of visual experimental data using special mathematical methods the fourier transform heideman et al 1985 of a time series of ocean surface images gives an output as a power spectral density function for real ocean waves this probability density function of wave heights ocean surface ordinates which describes both the frequency distribution and the angular spreading directional distribution of wave energy is closely related with the required amplitudes h 0 k ω as its statistically averaged value h 0 k ω 2 based on the fast fourier transform fft concept the swell height field is represented by the superposition of sinusoidal waves with complex amplitudes tessendorf 1999 2001 2002 ebert et al 2000 deusen et al 2004 13 h x y t k x k y h k x k y t exp i k x x k y y where the components of the wave vector are equal to 14 k x 2 π n n f 2 l x 2 π n π n f l x n 0 1 n f 1 k y 2 π m m f 2 l y 2 π m π m f l y m 0 1 m f 1 here n m are the whole numbers in the range 0 n n f 0 m m f i is the complex unit i 2 1 π is the pi number l x l y are the sizes of the computational domain the fft procedure produces the wave heights field at the nodes of computational grid n l x n f 1 m l y m f 1 where n f m f are the sizes of the fourier transform grid the main task is to generate a set of random time dependent amplitudes h k t corresponding to real oceanographic data observations show that the wind waves in the open ocean are quite well described by eq 13 based on the analysis of a large number of radar and wave buoy data scientists come to the conclusion that the swell height amplitudes h k t are statistically stationary gaussian random field with a spatial spectrum of fluctuations defined as 15 p h k h k t 2 various idealized semi empirical ocean wave spectra p h k are used in oceanography and ocean engineering the phillips spectrum is one of the most convenient ocean wave spectrum models for describing of gravity wind waves in a fully developed sea see e g phillips 1958 1977 the concept of a fully developed sea suggests that if the wind blew steadily for a long time over a large area the waves would come into equilibrium with the wind the phillips spectrum is computed as follows 16 p h k a exp 1 k l max 2 k 4 k ˆ w ˆ 2 here l max w 2 g is the maximum wave length for constant wind speed w g is the acceleration of gravity a is a normalization constant w w x w y is the vector of wind speed the normalized unit vectors of k and w are denoted with a hat the factor k ˆ w ˆ 2 in the spectrum expression eq 16 is intended to cut waves propagating perpendicular to the wind direction thus the ocean wave height field is formed by generating gaussian random numbers with given correlation properties required energy spectrum using a method based on the calculation of the discrete fourier transform see tessendorf 1999 2001 2002 ebert et al 2000 deusen et al 2004 the fourier amplitudes of a wave height field are generated in the following way 17 h 0 k 1 2 ξ r i ξ i p h k here ξ r ξ i are the random samples drawn from standard normal distribution with a mean of 0 and a standard deviation of 1 considering the dispersion equation ω k g k the temporal evolution of the ocean wave height field can be described as 18 h k t h 0 k exp i ω k t h 0 k exp i ω k t such representation ensures the implementation of the symmetry property of the complex conjugation operation h k t h k t and provides the propagation of waves both to the right and to the left the components of the right traveling wave correspond to the components of the left traveling wave only with the amplitudes replaced by their complex conjugates and with the signs of the wave vectors reversed the dynamic behavior of the wave pattern is achieved by the time evolution t d t of the swell height field see eq 18 inverse non uniform fast fourier transform is used to transfer from frequency to cartesian coordinates and subsequent visualization of the height map on unstructured grid the inverse nufft process reproduces the required waveform function by summation of generated series of sinusoidal terms eq 13 whose amplitudes form a power spectrum in the frequency domain in the present study the interactive simulation of deep ocean surface is performed by combining the phillips wave spectrum see eq 16 with inverse two dimensional non uniform fast fourier transform technique the used fast fourier transform algorithm for unevenly spaced data is an extension of the classic fft method cooley and tukey 1965 the suggested technique applies the uniform cartesian discretization of the two dimensional frequency domain and unstructured discretization of the spatial domain of the ocean surface the inverse nufft is applied for reproducing the ocean wave elevation field on an unstructured triangular grid this approach gives the following advantages and opportunities for further improvement of the model provides the ability to vary the degree of ocean surface resolution depending on the distance to the viewer for example in the case of using perspective grazing incidence view through adaptation of the grid it is achieved by changing the distances between mesh vertices according to the desired law depending on the distance to the selected domain boundary or to certain points inside the domain the gradual rarefaction of mesh knots with remoteness from viewer can significantly reduce computational cost which is especially important in dynamic modeling of the water surface gives the possibility to simulate the ocean surface regions of complex shapes with multiply connected boundaries of an arbitrary configuration it may be useful for describing a complex coastline and harbor configuration as well as for numerical investigation of wave induced ship motions near stationary marine structures and natural objects of any geometry in contrast the classical fft method can only reproduce the rectangular shaped part of the water surface the local interactive mesh condensation inside the computational domain real time grid adaptation will be useful for a more realistic representation of the sharp wave crests 2 2 theoretical basis of the model of interactive ship dynamics the ship of arbitrary configuration floating freely on the non stationary ruffled ocean surface is considered as partially submerged rigid body the vessel dynamics is described in a ship fixed coordinate system x y z this frame of reference is connected to the ship with its origin at the center of gravity cg wherein the coordinate axes are directed along the principal central axes of inertia of the body the complex motion of the ship in 3d space is defined by the six degrees of freedom the first three are translational motions in surge sway and heave positive or negative directions the last three are the pitching yawing and rolling movements around the transverse y vertical z and longitudinal x axes of the ship fixed coordinate system respectively the relation between the global reference frame xyz and the ship fixed coordinate system at a certain time t is described by the position vector of the center of gravity of the vessel r g c g r x c g r y c g r z c g and the orientation in terms of euler angles landau and lifshitz 1976 pp 110 116 yaw angle ψ roll angle ϕ and pitch angle θ this set of angles is called tait bryan angles tait 1869 bryan 1911 to be precise the motion of the vessel relative to the global frame of reference is characterized by linear velocity v g c g v x c g v y c g v z c g and angular velocity ω g ω x ω y ω z whose projections on the corresponding axes are defined as 19 v x c g d r x c g d t r x c g v y c g d r y c g d t r y c g v z c g d r z c g d t r z c g ω x d ϕ d t ϕ ω y d θ d t θ ω z d ψ d t ψ here the point denotes a time derivative based on newton s second law the equations of motion in a rotating reference frame are written as landau and lifshitz 1976 pp 110 116 20 f t o t m c g d v b c g d t ω b m c g v b c g m t o t i d ω b d t ω b i ω b here f t o t is the resultant force acting on the vessel m c g is the mass of the ship v b c g v x c g v y c g v z c g ω b ω x ω y ω z are the linear and angular velocities in the ship fixed coordinate system m t o t is the resultant moment i is the inertia tensor of the ship the hydrostatic pressure forces f h y d f x h y d f y h y d f z h y d acting on the submerged part of the vessel surface and gravity force f g contribute to the resultant force f t o t the gravity acts downward in the opposite direction to the z axis of the global coordinate system f g 0 0 f z g it is accepted that only the hydrostatic moments m t o t m h y d m x h y d m y h y d m z h y d affect the rotational motion of the ship the torque exerted by the gravitational force in the body fixed reference frame with its origin at the center of mass is zero thus the system of equation 20 describing the ship hull dynamics in the body fixed frame can be represented as follows 21 f x h y d f x g m c g d v x c g d t ω y v z c g ω z v y c g f y h y d f y g m c g d v y c g d t ω z v x c g ω x v z c g f z h y d f z g m c g d v z c g d t ω x v y c g ω y v x c g m x h y d i x x d ω x d t i y y i z z ω y ω z m y h y d i y y d ω y d t i z z i x x ω z ω x m z h y d i z z d ω z d t i x x i y y ω x ω y here f x g f y g f z g are the components of the gravity force f g in the ship fixed coordinate system i x x i y y i z z are the central principal moments of inertia eq 21 take into account that the axes of the rotating reference frame x y z coincide with the principal axes of the vessel the real time rigid body dynamic simulation is performed based on famous verlet algorithm verlet 1967 1968 the well known scheme of integration of equations of motion was originally designed for particles systems in the present study this technique is adapted to accurately computing the linear as well as angular interactive displacements of the rigid body under the action of the set of external forces 3 practical realization of the proposed model for simulation of ship dynamics in irregular waves in this section the details of algorithmic and practical realization of the body waves interactive simulation are presented the concept of the model is explained by concrete examples of dynamic interaction of partially submerged rescue boat with wind generated irregular fluctuations of the water surface for different ocean states particular attention is paid to the choice of modeling parameters the implementation of the interactive dynamic model of the ship on the irregular waves is performed in several stages a preparatory stage preprocessing and dynamic modelling of the body waves interaction 3 1 preparatory phase realization the implementation of the preparatory phase starts from the creation of the solid vessel model of arbitrary configuration with cad software for example autocad autodesk 2019 solidworks 2019 catia dassault systèmes 2019 and so on the three dimensional model of the ship hull is a solid object endowed with mass and volume the used method does not impose restrictions on the complexity of the ship form the mass inertia characteristics of the ship hull model such as the position of center of gravity the mass m c g and the principal moments of inertia i αα α x y z are assumed to be known for the mass and inertia moments it is possible to use approximate values for a number of considered examples the mass characteristics have the following meanings m c g 300 kg i x x 100 kg m 2 i y y 850 kg m 2 i z z 900 kg m 2 the 3d geometry of the vessel is covered with a rather detailed triangular surface mesh which is used as input data any grid generator can be chosen from a large number of existing mesh tools for triangulating the ship outer surface zheleznyakova 2015 fig 1 illustrates some results of the preparatory phase that precedes the simulation the left side of the figure demonstrates the cad solid model of the boat created with solidworks 2019 the overall dimensions in millimeters the distances from the lowermost point of the bow to the center of gravity measured along the body fixed axes and mass properties of the body are also presented the triangular surface mesh covering the ship hull and consisting of n b 5233 nodes and e b 10 462 elements is shown in the right part of fig 1 the implemented non uniform fast fourier transform nufft algorithm which uses the unstructured discretization of the ocean surface is also requires the prior creation of a 2d triangular grid consisting of n os nodes and e os elements in the rectangular domain corresponding to ocean surface patch this simple triangulation can be easily obtained by using any grid generator 3 2 preprocessing procedure the following input parameters must be specified in order to initiate the preprocessing stage of the modelling it is necessary to determine the sizes n f m f of the uniform cartesian fourier grid the number of frequency grid points must be a power of two in both directions the longitudinal and transverse dimensions of the ocean surface patch l x l y in meters wind speed module in meters per second x and y components of the wind direction vector the acceleration of gravity g and the density of water ρ the mosaic structure of the water surface consisting of several l x l y patches which are periodically repeated can be used to simulate of a vast ocean area if the size of the patch is large enough compared with the entire tiled ocean surface under consideration the mosaic structure of the water is invisible the preprocessing phase includes the following steps the first step is to generate the two dimensional uniform cartesian grid in spatial domain l x l y of the ocean surface 22 x n f y m f n l x n f 1 m l y m f 1 n 0 1 n f 1 m 0 1 m f 1 the distances between the uniformly distributed grid nodes must be at least several centimeters the linear approximation is not applicable for a smaller scale due the fact that the influences of nonlinear effects and the surface tension become noticeable the preprocessing involves the generation of a matrix for wave vectors on a fourier grid the wave vector values are determined to each of the n f m f fourier grid points 23 k n m k x n k y m 2 π n π n f l x 2 π m π m f l y k n m k n m k x n 2 k y m 2 n 0 1 n f 1 m 0 1 m f 1 the resultant discrete field is characterized by the fact that the magnitudes of wave vectors k increase and thus wavelengths decrease radially from the center of the domain see fig 2 upper left the power spectral density distribution in the wave number space is generated in accordance with the phillips spectrum see eq 16 thereafter 24 p n m h a exp 1 k n m l max 2 k n m 4 k x n k n m w x w k y n k n m w y w 2 n 0 1 n f 1 m 0 1 m f 1 the wave number module spectrum is defined by only one parameter the wind velocity vector which sets the wind strength and direction the velocity and direction of the storm wind may vary in wide ranges w 0 30 m s w x w cos γ w y w sin γ γ 0 2 π respectively the normalization constant a is chosen in the range of values 10 7 10 6 fig 2 upper right represents the phillips power spectrum on the fourier 128 128 grid for following parameter settings the normalization constant a is assumed to be 10 7 the velocity of the wind blowing in the negative x direction w x w 1 w y 0 is equal to w 10 m s the maximum wave length is equal to l max 10 m wherein the waves moving opposite to the wind direction are cutted off from the ratio of the phillips spectrum it follows that the grid steps in both n and m directions should be chosen one two or even three orders of magnitude smaller than value l max so as not to lose the main harmonics further preprocessing step is dedicated to creating the fourier complex amplitude fluctuations of an ocean surface the initial fields of real re and imaginary im components of the random complex amplitudes h n m 0 see eq 17 are generated based on the phillips spectrum p n m h for the given set of waves 25 h n m 0 re h n m 0 im h n m 0 1 2 ξ r n m p n m h i 1 2 ξ i n m p n m h n 0 1 n f 1 m 0 1 m f 1 the random samples drawn from standard normal distribution ξ r n m with a mean of 0 and a standard deviation of 1 on the fourier grid is presented in fig 2 middle left the adjacent right illustration at fig 2 shows the field of the real components of the fourier random complex amplitudes on the n m grid the conversion from wave number domain to frequency domain is performed using the dispersion relation for water waves connecting the wavelength or wave number and angular frequency 26 ω n m g k n m after that by using eq 18 the ocean surface elevation field in frequency domain at the initial moment of time t 0 can be calculated 27 h n m h 0 n m k φ n m h 0 n m k φ n m n 0 1 n f 1 m 0 1 m f 1 here φ n m φ n m are the complex phase and complex conjugate phase matrices 28 φ n m exp i ω n m t 0 cos ω n m t 0 i sin ω n m t 0 φ n m exp i ω n m t 0 cos ω n m t 0 i sin ω n m t 0 n 0 1 n f 1 m 0 1 m f 1 and h 0 n m k is the complex conjugate of the complex amplitude matrix h 0 n m k the latter is obtained by rotation of the complex amplitude matrix h n m 0 through 180 these amplitudes need only be calculated once during a simulation run the generated field of the initial ocean surface heights in the fourier domain is presented in the lower left corner of fig 2 next the inverse non uniform fast fourier transform is applied to calculate initial ocean wave elevation field on an unstructured triangular grid in the spatial domain the generated initial wave height field in meters in the spatial domain corresponding to wind velocity equal to w 10 m s is presented in the lower right corner of fig 2 the distribution of heights is represented as two color filled contour map the fully developed ocean waves are formed under the influence of wind blowing constantly in the negative x direction over a large water surface area the proposed nufft technology is based on the classical fft method supplemented by the interpolation procedure thus the last nufft step is algorithmically implemented as follows firstly the wave height map h n m is calculated from eq 13 on a regular grid of n m nodes in the spatial domain 29 z n m f h n m b m 0 m f 1 n 0 n f 1 h n m exp i x n f k x n i y m f k y m n 0 1 n f 1 m 0 1 m f 1 where the cartesian coordinates of the regular grid nodes x n f y m f are defined in accordance with eq 22 the wave vector components k x n k y m are computed with eq 23 and b is the wave height scale factor the multiplication of the height matrix by the checkerboard matrix c h n m 1 n m is also necessary to shift the center of the transform to the center of the data shift the zero frequency components at the center of the fourier transform domain secondly the interpolation of the height field z n m f from structured to triangular spatial ocean surface mesh z i o s is performed according to the bilinear interpolation template 30 z i o s z n i m i f b 11 i z n i 1 m i f b 21 i z n i m i 1 f b 12 i z n i 1 m i 1 f b 22 i n 0 1 n f 1 m 0 1 m f 1 i 0 1 n o s 1 where the coefficients b 11 i b 12 i b 21 i b 22 i for each i th unstructured grid node with coordinates x i o s y i o s are calculated as follows 31 b 11 i x n i 1 f x i o s y m i 1 f y i o s x n i 1 f x n i f y m i 1 f y m i f b 21 i x i o s x n i f y m i 1 f y i o s x n i 1 f x n i f y m i 1 f y m i f b 12 i x n i 1 f x i o s y i o s y m i f x n i 1 f x n i f y m i 1 f y m i f b 22 i x i o s x n i f y i o s y m i f x n i 1 f x n i f y m i 1 f y m i f n 0 1 n f 1 m 0 1 m f 1 i 0 1 n os 1 fig 3 gives some explanations to the nufft process the illustrations demonstrate the structure of the 128 128 uniform fourier grid and unstructured discretization of the 2d physical domain with the dimensions 25 m 25 m see fig 3 above the planar triangular grid is consists of n os 45 349 nodes and e os 89 896 elements the scaled up fragments of the grids are shown on the right the elucidation of eq 31 is clearly presented in fig 3 below the generated 3d waved ocean surface corresponds to wind velocity equal to w 10 m s the last one step of preprocessing is the analysis of the ship surface grid which involves calculating the unit outward normals cos n i ˆ α α x y z the coordinates of triangles centroids r α i α x y z in the ship fixed frame and computing the areas of mesh elements s i 3 3 implementation of the interactive dynamic simulation the initial ocean wave elevation field z i o s created on an unstructured triangular grid x i o s y i o s i 0 1 n os 1 is used as input the rescue boat floats freely on the non stationary ruffled water surface see fig 4 the global coordinate system of the computational domain is defined with x y axes lying in the plane of the flat rectangular ocean surface patch in equilibrium and directed along its sides and z axis which is directed vertically upwards at the beginning of the real time dynamic simulation at time t 0 the center of gravity cg of the ship model is located in the point 32 r x 0 c g x 0 o s r y 0 c g y 0 o s r z 0 c g z 0 o s 0 18 where x 0 o s y 0 o s z 0 o s are the coordinates of one of the vertices of the triangular ocean surface grid closest to the center of the modelling water surface patch l x l y the cg is placed at a height of 0 18 m above the water level or at a reasonable height close to this value the boat body is partially immersed in water and part of the surface mesh is located under the ocean surface fig 5 thus the triangular facets of the mesh are divided into dry and submerged based on the dynamically changing wave height data h x y t the triangular facet of the mesh is declared as submerged if its centroid is immersed otherwise if centroid of a triangular element is above water the facet is dry fig 5 using this approach if the condition of smallness of triangular elements is observed it is not necessary to determine the exact line of intersection the ship hull with the water surface and subdivide the triangular elements the ship fixed coordinate system x y z is connected to the ship with its origin at the center of gravity cg the axes x y z are directed along the principal central axes of inertia the longitudinal axis x of the vessel is directed from the stern to the bow the six degrees of freedom as they apply to the boat are shown in fig 6 the initial angular coordinates are determined as ϕ 0 θ 0 ψ 0 it is convenient to set them equal to 0 at the initial moment the ship body is at rest ω α 0 v α c g 0 α x y z time integration of the equations of motion see eq 21 goes as follows step 1 at time t 0 the position of the boat geometry in the global coordinate system is characterized by the center of gravity location r x c g r y c g r z c g and orientation ϕ θ ψ the motion parameters at the current time are described in the body fixed rotating coordinate system and defined by the angular and linear velocities ω α v α c g α x y z step 2 the current coordinates of nodes of the boat surface grid x j b y j b z j b j 0 1 n b 1 in the world frame are calculated as 33 x j b y j b z j b t x y z x y z x j b y j b z j b r x c g r y c g r z c g j 0 1 n b 1 here t x y z x y z is the transformation matrix which maps coordinates from the ship fixed frame to global frame this matrix is calculated for instant angular position ϕ t θ t ψ t of the boat with eq a 5 see appendix a for further details of calculating the transformation matrix 34 t x y z x y z cos ϕ cos ψ sin θ sin ϕ sin ψ cos ϕ sin ψ sin θ cos ψ cos θ sin ϕ sin ψ cos θ sin ψ sin θ sin ϕ cos ψ cos ϕ cos ψ sin θ sin ψ cos θ sin ϕ cos ψ sin θ cos ϕ sin ϕ cos θ cos ϕ in eq 33 x j b y j b z j b are the coordinates of the n b vertices of the original non transformed ship surface grid in the body fixed reference frame the coordinates of the triangles centroids r α i α x y z i 0 1 e b 1 are defined as arithmetic mean of the coordinates of its vertices step 3 the same bilinear interpolation technique see eq 30 and eq 31 is used to determine the water surface elevation h r x i r y i t at a given moment t at a point r x i r y i corresponding to the location of the i th facet centroid r α i α x y z of the vessel surface grid the triangular facets of the boat mesh are divided into submerged the centroid of the element is located under water r z i h and dry the centroid of the element is located above water r z i h based on the wave height data see fig 5 step 4 the components of resultant hydrostatic force f h y d f x h y d f y h y d f z h y d contributing to the total force f t o t see eq 21 are found by summation of the hydrostatic forces f i h y d f x i h y d f y i h y d f z i h y d acting on each of the i th immersed planar faces which can be arbitrarily oriented in 3d space see fig 7 35 f x h y d i ρ g d i cos n i ˆ x s i f y h y d i ρ g d i cos n i ˆ y s i f z h y d i ρ g d i cos n i ˆ z s i i i m m e r s e d i 0 1 e b 1 where ρ is the density of the fluid g is the gravitational acceleration d i is the immersion depth of the facet center s i is the area of the triangular surface element n i is the outward unit normal to the facet provided the triangular facets of the ship surface grid are small enough the hydrostatic forces f i h y d are considered to be applied at their centers this assumption allows to reduce the complexity of the calculations and increase computational productivity the components of the gravity force f g f x g f y g f z g also contributing to the total force f t o t see eq 20 are determined relative to the ship fixed coordinate system according to the last column of the transformation matrix t x y z x y z see eq a 4 and appendix a for details 36 f x g m c g g sin θ cos ϕ f y g m c g g sin ϕ f z g m c g g cos θ cos ϕ the rolling pitching and yawing resultant moments m x h y d m y h y d m z h y d in eq 21 are calculated as a sum of the i th elementary moments m x i h y d m y i h y d m z i h y d with respect to the axes of the body fixed coordinate system which correspond to the principal inertia axis of the vessel fig 7 37 m x h y d i f z i h y d r y i f y i h y d r z i m y h y d i f x i h y d r z i f z i h y d r x i m z h y d i f y i h y d r x i f x i h y d r y i i i m m e r s e d i 0 1 e b 1 here r b i r x i r y i r z i are the centroid coordinates of the i th immersed triangular facet of the ship surface mesh in the body fixed frame step 5 the resultant of the hydrostatic and gravitational forces according with the equations of linear motion see first free eq 21 yields acceleration a α c g α x y z for a center of gravity of the ship 38 a x c g 1 m c g f x h y d m c g g sin θ cos ϕ ω z v y c g ω y v z c g a y c g 1 m c g f y h y d m c g g sin ϕ ω x v z c g ω z v x c g a z c g 1 m c g f z h y d m c g g cos θ cos ϕ ω y v x c g ω x v y c g step 6 the linear velocities at time t d t and elementary time step displacements d r α c g can then be predicted from the current accelerations 39 v α c g t d t v α c g t a α c g t d t d r α c g v α c g t d t d t α x y z step 7 the corresponding elementary moving in the global frame is calculated with transformation matrix t x y z x y z see eq a 5 and appendix a for details 40 d r x c g d r y c g d r z c g t x y z x y z d r x c g d r y c g d r z c g step 8 the moments of the resultant hydrostatic forces cause angular accelerations see last free eq 21 41 ω x 1 i x x m x h y d i y y i z z ω y ω z ω y 1 i y y m y h y d i z z i x x ω z ω x ω z 1 i z z m z h y d i x x i y y ω x ω y step 9 the velocities of rotation about the ship fixed axis at time t d t are computed as 42 ω α t d t ω α t ω α t d t α x y z step 10 the transition from angular velocities relative to the body fixed frame of reference ω x ω y ω z to the angular velocities relative to the global coordinate system ϕ θ ψ is carried out by using transformation eq a 9 see appendix a for further details step 11 the determination of the elementary roll pitch and yaw turns in the world frame is performed as follows 43 d β β t d t d t β ϕ θ ψ step 12 further the method assumes the calculation of the new position of the vessel geometry in the global frame of reference at time t d t 44 r α c g t d t r α c g t d r α c g β t d t β t d β α x y z β ϕ θ ψ step 13 the wave pattern is updated for a next time step by the time evolution t d t of the complex phases see eq 28 and subsequent performing an inverse non uniform fast fourier transform to get the swell height field on triangular ocean surface grid see eq 29 and eq 30 4 results the results of real time dynamic simulation of the ship in irregular wind waves which were generated with the proposed model for different ocean states are presented on fig 8 10 figures demonstrate screenshots of the wind generated irregular fluctuations of the water surface that interact with the partially submerged boat body in the real time mode the interactive frame rate is assumed to be equal to 30 frames per second fps which is the standard of the video industry therefore a uniform time step d t 0 033 s is chosen instant wave patterns obtained with the described model are correspond to the ocean surface patch with dimensions of 25 25 m wind blowing in the negative x direction with speeds of 3 m s figs 8 10 m s fig 9 and 20 m s fig 10 figs 8 10 illustrate the ability of the model to simulate the rough sea states which agree well with the beaufort scale relating wind speed and conditions in the open ocean huler 2004 the light breeze with speed of 3 m s two points on the beaufort scale causes the short and quite pronounced wavelets with heights not exceeding 0 5 m the ocean disturbance number is equal to one fig 8 the fresh breeze blowing with velocity 10 m s five points on the beaufort scale generates extended 2 m waves the ocean disturbance number is equal to four fig 9 the gale force wind blowing steadily at 20 m s eight points on the beaufort scale provokes the significant ocean disturbance about six points with wave heights of 5 5 m fig 10 a series of animations anim 1 3 demonstrates the real time dynamic modeling of the rescue boat in irregular wind waves for the three considered ocean states 5 discussion this section is devoted to a discussion of the abilities properties and characteristics as well as accuracy stability and computational efficiency of the developed interactive waves body model the comparative analysis of the proposed method based on the results from the literature review shows for the considered problem of interactive ship motion simulation on a standard desktop computer the developed simplified approach may be more preferable than sophisticated high precision partially fully nonlinear potential theory methods hirdaris et al 2014 rajendran et al 2015 mortola et al 2011 and rans techniques lavrov et al 2017 gadelho et al 2018 sayeed et al 2018 due to their computational complexity these approaches are not suitable for real time modeling the actual ship responses and associated structural loads caused by weather changes and possible variation in course or speed despite the relative simplicity of the implemented physical concept the suggested model can provide any predetermined accuracy within the framework of the deep water and open water assumptions by refinement the grids covering the sea surface and the ship hull methodologies which are based on the linear strip theory fonseca and guedes soares 1998 sutulo et al 2010 varela and guedes soares 2011 can be used for computing the ship motions at interactive frame rates however raos should be preliminary determined for each particular ship hull with specific cargo conditions in contrast the proposed method allows to use arbitrary three dimensional geometric models of the ships of any complexity the behavior of the ship is fully determined by its geometry the ship s manoeuvring characteristics are not required the proposed method allows to create mathematical model for ship simulation without recourse to experimental data the minimum number of input parameters and fitting coefficients are needed to initiate the simulation users have the opportunity to vary the characteristics defining the vessel behavior even possessing only superficial knowledge in the ship theory the developed computational model can be used for predictive modelling at the initial design stage in shipbuilding industry to determine the configuration of a new vessel based on the design requirements as well as for mathematical support of the final phase devoted to the manoeuvrability tests the very fast three degrees of freedom models sutulo et al 2002 neri et al 2016 zhang et al 2004 do not compute wave induced ship motions and wave ship interactions also these approaches do not take into account the geometric configuration of the vessel neglecting the z translation pitch and roll degrees of freedom is a reasonable and very good first approximation these methods are acceptable for positioning estimation and trajectory tracking for simulate port operations but are not suitable for ship s stability computational analysis besides the approach developed by neri et al 2016 requires the manoeuvrability data the program implementation of the full six degrees of freedom ship model reported by daqaq and nayfeh 2004 is not actually a real time simulator the dynamics characteristics of the ship are previously determined for a large number of sea conditions the interactive virtual environment is used for post processing visualization and real time interaction with the ship mounted crane operator the suggested method provides the minimal discrepancy between the sea surface state and the motion response of the ship even a slight discrepancy becomes noticeable to a user significantly reducing the sense of immersion thus there is no need to establish and maintain the synchronism between the evolving irregular wave field and ship motions see for example varela and guedes soares 2011 the application of the proposed technique allows to get around the problem faced by cieutat et al 2001 their method uses the curvature of the waved sea surface as the only reason that causes the ship movement consequently the ship will stop moving immediately as soon as waves subside that is contrary to the real behavior of the ship the current approach preserves the physical soundness and accuracy to obtain valid conclusions in the absence of resistance in the proposed model the artificial limitations of the modules of linear and angular velocities of the ship are used wherein the direction of the linear or angular velocity vector does not change vector is normalized to the limiting value the ceiling values are selected in the ranges 0 5 1 5 m s and 0 3 0 8 rad s for linear and rotational velocities respectively depending on the strength of the storm and ship motions intensity the imposed limitation guarantees the dynamical stability during interactive simulation the stability and accuracy of the method for integration of the equations of motion of the ship as well as errors introduced by the surface fragmentation into grid facets can be estimated by a computational experiment for this purpose the calm wind conditions are simulated the vessel model is partially submerged in the mirror smooth water surface figs 11 12 the initial position of the ship the cg location relative to water level is set as close as possible to the equilibrium position r z 0 c g 0 1093 the latter is easily determined by several test runs in this special case the linear velocity is limited by the 0 001 m s and the angular velocity is limited by the 0 0005 rad s the time dependences of the components of total force f t o t f x t o t f y t o t f z t o t and resultant moment m t o t m x t o t m y t o t m z t o t are placed on figs 11 12 after short period of relaxation the relaxation period depends on the initial location of the ship and limiting values for velocities the system reaches near equilibrium state the forces and moments are almost compensated and experience only minor short term numerical fluctuations near the zero or near the acceptably small value of unbalanced force f x e r r f y e r r or moment m z e r r the real time dynamic simulations are run on a desktop computer with the cpu intel core i7 3770 3 4 ghz 16 gb ram and sufficient powerful graphics card the performance of about 106 frames per second is the limit of capability that the proposed algorithm provides for the tasks in question on the used computing equipment the developed model for simulation of the ocean surface dynamics and waves body interaction implements the algorithm which involves the following computationally expensive steps excluding preparatory phase create the field of the fourier random complex amplitudes in the frequency domain based on the wind wave energy spectrum performed once at the initial time step calculate the templates for interpolation of the wave height field from structured to triangular ocean surface mesh once at the initial time step analyzing the ship surface grid which involves computing the unit outward normals areas and centroids coordinates for the triangular elements once at the initial time step time shifting of the complex phases of the statistical wave ensemble performing an inverse non uniform fast fourier transform to get the swell height field on the triangular ocean surface grid at each time step defining the water surface elevation for every facet centroid of the vessel surface grid subsequent division into submerged and dry facets for each time step compute the components of total hydrostatic force rolling pitching and yawing resultant moments by summation of the elementary hydrostatic forces and moments acting on each of the i th immersed planar faces at each time step calculate of linear and angular motions parameters and the elementary time step displacements for a center of gravity of the ship for each time step conversion from the body fixed coordinate system to the global reference frame at each time step the computation times of the simulation phases cyclically repeating in every time step for hundred thousand iterations are given in table 1 computational cost of the dynamic simulation stages is measured by processor time it takes to run divided by the total number of time steps in s step it is clear from the data presented in the table that the inverse non uniform fast fourier transform is the most computationally expensive stage of modelling 6 conclusions a new economic approach to physical modeling of the ocean surface dynamics and interaction of irregular wind waves with a ship of arbitrary configuration in the real time is developed the interactive simulation of deep ocean surface is performed by combining the phillips wave spectrum which is obtained on the basis of observation data with inverse two dimensional non uniform fast fourier transform nufft technique the interactive simulation of the immersed rigid body dynamics is performed based on modified verlet algorithm the capability of simulating the dynamic wave body interaction in real time is achieved by using simple stable fast and computationally efficient algorithmic implementations despite the relative simplicity of the implemented physical concept the suggested model can provide any predetermined accuracy within the framework of the deep water and open water assumptions by refinement the grids covering the sea surface and the ship hull the described computational method does not impose restrictions on the complexity of the ship configuration the behavior of the ship is fully determined by its geometry the ship s manoeuvring characteristics are not required the proposed method allows to create mathematical model for ship simulation without recourse to experimental data the computational model does not require the routine selection of fitting coefficients which have no physical meaning it is necessary to determine a small number of physically based input parameters to initiate the simulation the dimensions of the ocean surface patch wind speed module and direction the acceleration of gravity the density of water and the mass inertia characteristics of the ship the mass principal moments of inertia cg location users have the opportunity to vary the characteristics defining the vessel behavior even possessing only superficial knowledge in the ship theory the developed computational model can be used for predictive modelling at the initial design stage in shipbuilding industry to determine the configuration of a new vessel based on the design requirements as well as for mathematical support of the final phase devoted to the manoeuvrability tests the application of unstructured grid approach allows to vary the degree of ocean surface resolution depending on the distance to the viewer for example in the case of using perspective grazing incidence view through adaptation of the grid it can be achieved by changing the distances between mesh vertices according to the desired law depending on the distance to the selected domain boundary or to certain points inside the domain the gradual increasing of distances between the nodes with remoteness from viewer can significantly reduce computational cost which is especially important in dynamic modeling of the water surface several examples of real time dynamic modeling of the rescue boat in irregular wind waves are considered in order to illustrate the capabilities of the method to reproduce the changeable water surface for ocean states in a wide range of wind speeds and body waves interaction the author hopes that the suggested technique is promising in terms of further improvement efforts will be made to increase the physical realism of the numerical model based on the proposed physical mathematical method the ship sea coupled model for simulation of ship motions will be expanded by including the effects of wind current propellers rudders and the nearby passing ship the visual realism of the ocean surface and the physical accuracy of the simulation will be raised due to increasing the number of elementary waves refinement the fourier grid it is also planned to add splashes foam the wave field induced by the ship itself and ship wake the local interactive condensation of the unstructured mesh nodes inside the computational domain real time grid adaptation will be applied for a more realistic representation of the sharp wave crests the advantages of unstructured grid approach will be used for simulating the ocean surface regions of arbitrary geometry with complex multiply connected boundaries describing coastline harbor or island configuration the numerical studies of wave induced ship motions near stationary marine structures and natural objects with complex geometry will be conducted acknowledgements the work was performed within the framework of the government program of basic research of the russian academy of sciences contract aaaa a17 117021310372 6 appendix a coordinate and velocities transformations from global to ship fixed coordinate systems and vice versa the transformation of coordinates from global frame xyz to ship fixed frame x y z is carried out through the three translations and three tait bryan positive rotations referred to above as yaw ψ roll ϕ and pitch θ they can be considered independent of the other fig a1 the first one is the counterclockwise rotation around the z axis when viewed looking down the positive z axis through an angle ψ see fig a1 left this intermediate transformation from frame xyz with unit vectors e x e y e z to frame x 1 y 1 z 1 with unit vectors e x 1 e y 1 e z 1 can be represented with a transformation matrix t x y z x 1 y 1 z 1 as follows a1 x 1 y 1 z 1 t x y z x 1 y 1 z 1 x y z cos ψ sin ψ 0 sin ψ cos ψ 0 0 0 1 x y z the angular velocity vector corresponding to yaw rotation is equal in magnitude to ψ and is directed along rotation axis e z namely ω ψ ψ e z the second one is the counterclockwise rotation around the x 1 axis when viewed looking down the positive x 1 axis through an angle ϕ fig a1 middle the corresponding transformation of coordinates from x 1 y 1 z 1 to x 2 y 2 z 2 with unit vectors e x 2 e y 2 e z 2 performed as a2 x 2 y 2 z 2 t x 1 y 1 z 1 x 2 y 2 z 2 x 1 y 1 z 1 1 0 0 0 cos ϕ sin ϕ 0 sin ϕ cos ϕ x 1 y 1 z 1 the rotational velocity for this case can be represented as ω ϕ ϕ e x 1 the last one is the counterclockwise rotation around the y 2 axis when viewed looking down the positive y 2 axis through an angle θ fig a1 right the third transformation of coordinates from x 2 y 2 z 2 to x y z with unit vectors e x e y e z can be accomplished as a3 x y z t x 2 y 2 z 2 x y z x 2 y 2 z 2 cos θ 0 sin θ 0 1 0 sin θ 0 cos θ x 2 y 2 z 2 the pitch rotation around the y 2 axis is characterized by angular velocity ω θ θ e y 2 finally we have a 4 x y z t x 2 y 2 z 2 x y z t x 1 y 1 z 1 x 2 y 2 z 2 t x y z x 1 y 1 z 1 x y z t x y z x y z x y z cos θ cos ψ sin θ sin ϕ sin ψ cos θ sin ψ sin θ sin ϕ cos ψ sin θ cos ϕ cos ϕ sin ψ cos ϕ cos ψ sin ϕ sin θ cos ψ cos θ sin ϕ sin ψ sin θ sin ψ cos θ sin ϕ cos ψ cos θ cos ϕ x y z the reverse transformation from rotating coordinate system x y z to global frame x y z is based on the inversion of the elementary rotation matrices which is equivalent to their transpose a 5 x y z t x y z x 1 y 1 z 1 t t x 1 y 1 z 1 x 2 y 2 z 2 t t x 2 y 2 z 2 x y z t x y z t x y z x y z t x y z t x y z x y z x y z cos ϕ cos ψ sin θ sin ϕ sin ψ cos ϕ sin ψ sin θ cos ψ cos θ sin ϕ sin ψ cos θ sin ψ sin θ sin ϕ cos ψ cos ϕ cos ψ sin θ sin ψ cos θ sin ϕ cos ψ sin θ cos ϕ sin ϕ cos θ cos ϕ x y z from eq a 4 follows a 6 t x y z x y z e z t x 2 y 2 z 2 x y z t x 1 y 1 z 1 x 2 y 2 z 2 t x y z x 1 y 1 z 1 e z t x y z x y z 0 0 1 sin θ cos ϕ sin ϕ cos θ cos ϕ e z sin θ cos ϕ e x sin ϕ e y cos θ cos ϕ e z t x 1 y 1 z 1 x y z e x 1 t x 2 y 2 z 2 x y z t x 1 y 1 z 1 x 2 y 2 z 2 e x 1 cos θ sin θ sin ϕ sin θ cos ϕ 0 cos ϕ sin ϕ sin θ cos θ sin ϕ cos θ cos ϕ 1 0 0 cos θ 0 sin θ e x 1 cos θ e x sin θ e z t x 2 y 2 z 2 x y z e y 2 cos θ 0 sin θ 0 1 0 sin θ 0 cos θ 0 1 0 0 1 0 e y 2 e y the angular velocity vector taking into account eq a 6 can be written as a 7 ω ω ψ ω ϕ ω θ ψ e z ϕ e x 1 θ e y 2 ψ sin θ cos ϕ e x sin ϕ e y cos θ cos ϕ e z ϕ cos θ e x sin θ e z θ e y ψ sin θ cos ϕ ϕ cos θ e x ψ sin ϕ θ e y ψ cos θ cos ϕ ϕ sin θ e z the relationships between the components of rotational velocity vector of the ship fixed coordinate system and the euler tait bryan angles as well as their derivative can be obtained a 8 ω ω x ω y ω z ψ sin θ cos ϕ ϕ cos θ ψ sin ϕ θ ψ cos θ cos ϕ ϕ sin θ finally the ratios for components of angular velocity vector that are used to transition from a body fixed coordinate system to the global reference frame can be derived from eq a 8 a 9 ω ω x ω y ω z ϕ θ ψ ω x cos θ ω z sin θ ω y ω z cos θ tg ϕ ω x sin θ tg ϕ ω z cos θ cos ϕ ω x sin θ cos ϕ fig a1 the tait bryan angles and a sequence of three elemental rotations fig a1 appendix b supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106686 
22258,the primary objective of this study is to develop a new weather routing system for vessel navigation in coastal and marginal seas based on the a star algorithm the cost function inherent in the original a star algorithm is modified to account for oceanic and atmospheric conditions around the vessel of interest three options are introduced to search for optimal paths with the shortest travel distance shortest travel time and minimal fuel consumption an avoidance algorithm for unsafe conditions is further incorporated to exempt any arbitrary area from the navigation solution furthermore a compact ocean circulation model based on the regional ocean modeling system executable on typical laptop pcs is configured for a vessel borne weather routing system the system is successfully applied to evaluate the optimal vessel paths in the seto inland sea where high frequency tidal currents modified by complex topography make it essential to alter the vessel s speed keywords weather routing a star algorithm roms kuroshio optimal route numerical simulations 1 introduction reduction of carbon dioxide co2 emission has been a long standing issue for mediating global warming among others fuel efficiency in ship navigation is recognized as a fundamental factor that must be remedied buhaug et al 2009 presents that the proportion of co2 from ship emissions in 2007 was estimated to be 1 046 million tons accounting for 3 3 of the global co2 emission during that year for economical operation in marine logistics optimal routing to determine on time or shortest cruising path is indispensable in particular finding the shortest path is often more essential to immediate excursions for fishing rescues and leaked contaminants and to provide urgent evacuation from coastal disasters such as tsunamis and storms however vessel navigation is affected significantly by ambient oceanic and atmospheric conditions that restrict the optimal paths for instance opposing oceanic currents reduce the vessel s relative speed or increase fuel consumption whichever the operator cares for more seriously trodden et al 2015 bouman et al 2017 therefore weather routing hereinafter denoted as wr in which surrounding oceanic and atmospheric conditions are taken into account in navigation is highly desirable for desirable vessel navigation in general wr determines the optimal route by considering many factors such as weather and oceanic conditions characteristics of ships and areas of territorial waters sen and padhy 2010 tsou and cheng 2013 wr differs from automotive navigation systems in many aspects for example while automotive navigation systems usually consider only traffic congestion and negotiable roads wr must account for natural phenomena such as oceanic currents wind speeds and wave heights moreover in the open ocean there are very few obstacles except islands and territorial waters in contrast to the land hence because wr must deal with an infinite number of routes consisting of vast numbers of links and nodes but with fewer guideposts to find the optimal route its computational cost becomes drastically more expensive than that for automobile navigation furthermore it is necessary to design wr algorithms properly not only for the shortest route efentakis et al 2011 but also for the safest route kosmas and vlachos 2012 the minimum fuel route jung and rhyu 1999 papanikolaou et al 2016 and the combinations of these factors szlapczynska 2007 andersson 2015 therefore previous studies have attempted to develop path finding algorithms while minimizing the computational cost of wr one of the more popular methods for finding an optimal route for wr is the isochrone method proposed by journée and meijers 1980 although this method has been used for decades because of its simplicity the isochrones have to be manually determined a priori hagiwara 1989 improved the isochrone method to be suitable for computers by implementing an automated isochrone detection algorithm however the isochrone method occasionally generates so called isochrone loops making path finding impossible and failing to avoid crossing lands hence de wit 1990 and calvert et al 1991 introduced dynamic programming which uses a grid system that divides a possible sailing region into several cells where each crossing point of a cell boundary is used as a waypoint candidate some studies have made efforts to conduct a series of detailed investigations to reduce the navigators workload by using a dynamic programming method for grid size setting and design of the wr system wei and zhou 2012 kim and lee 2018 although these methods have been developed elaborately to account for oceanic and atmospheric conditions as much as possible their main drawbacks are computational inefficiency caused by a large number of nodes a requirement for large storage space inflexibility and slow computational speed with a gridded sea area dijkstra s algorithm dijkstra 1959 in graph theory is well known to be practical for ship navigation the algorithm begins at a specific node and extends outwards to calculate the shortest path between any two vertices in a weighted graph fig 1 a because the algorithm requires searches for all the nodes between the origin and destination it is computationally very expensive if the sea area of interest is gridded at fine lateral spacing by contrast the a star algorithm hart et al 1968 a modified method of dijkstra s algorithm uses heuristics by introducing a cost function for determining the shortest path to the destination fig 1b as compared to the original dijkstra s algorithm the a star algorithm enables us to significantly reduce computational cost to determine the optimal route by preferentially searching for the adjacent links and nodes pointing to the destination as illustrated above there are a substantial number of studies and algorithms for wr with some comparative assessments among the methods e g roh 2013 walther et al 2016 but the definitive algorithm suitable for wr has not yet been confirmed in this study our first objective is to propose a new marine wr system based upon the a star algorithm for determining the shortest path to the destination a cost function is additionally introduced to account for oceanic and atmospheric conditions around the vessel of interest combined with the heuristic function defined in the original a star algorithm in other words this study proposes to modify the cost function so that three options are considered to search for the optimal paths shortest travel distance shortest travel time and minimal fuel consumption furthermore most of previous wr studies have focused on ocean going vessels and ocean liners that cruise mostly on the open ocean their routing algorithms are mainly for long voyages where a wide range of route choices is possible nevertheless it is difficult to apply such algorithms directly for vessels sailing on coastal and marginal seas smierzchalski and michalewicz 2000 chen et al 2013 the primary reason is complexity of weather and oceanic conditions as well as coastline topography all of which are necessary for coastal wr thus there is room for improvement on wr in such areas one of the more significant issues arises from a poor resolution of the oceanic and atmospheric information released from agencies concerned in general these products have quite large spatial resolutions and large update intervals for example a regional oceanic reanalysis forecast product the japan coastal ocean prediction experiment jcope2 miyazawa et al 2009 of the japan agency for marine earth science and technology jamstec provides daily averaged data at a lateral grid spacing of about 10 km this resolution is not sufficient in crowded harbors and bays where detailed navigation is crucial because high frequency variability such as tidal currents characterize the ambient oceanic condition most prominently moreover data retrieval prior to departure and subsequent onboard predictions are occasionally indispensable because ample data retrieval through communications satellites during the voyage may not be feasible therefore this study also configures a compact and computationally efficient regional ocean model executable on typical laptop pcs aiming at a vessel borne weather routing system for suboptimal availability of weather and oceanic reanalysis prediction the model is coupled with the wr system based on the a star algorithm to evaluate the optimal vessel paths our test bed is the seto inland sea hereafter sis japan filled with an enormous number of commercial carriers and small fishery and pleasure boats in the sis the high frequency tidal currents modified by complex topography are substantial to alter the vessel s speed for optimal navigation therefore this study aims to achieve the following 1 develop a new wr system based on the a star algorithm which calculates an optimal route with consideration of oceanic and atmospheric conditions having capabilities of rerouting and avoidance functions for more accurate and safer navigation 2 assess the efficiency of the newly developed wr system by applying it to several scenarios including evacuation from a migrating typhoon and 3 configure a compact regional ocean circulation model executable on typical laptop pcs aiming at a vessel borne wr this paper is organized as follows section 2 describes the proposed algorithms for the wr system the configurations of the numerical models are given in section 3 the experimental results with the new wr algorithm are presented and discussed in section 4 finally summaries of this study are presented in section 5 2 weather routing algorithms 2 1 a star and dijkstra s algorithms in this study a new marine ship routing system is proposed based on the a star algorithm hart et al 1968 fig 1b this algorithm finds the shortest path to the destination using inter node traveling cost hereafter χ and a heuristic function hereafter h the heuristic function h is defined as the shortest path from each node to the final destination node determined a priori to minimize the cost χ to search neighboring nodes for candidates comprising the optimal path hence the a star algorithm enables us to significantly reduce computational time needed to determine the optimal route by using h as the guidepost if h is set at zero the a star algorithm simply reverts back to dijkstra s algorithm fig 1a fig 2 compares the efficiency of the dijkstra s algorithm and the a star algorithm in searching for the shortest path from the origin to the destination by illustrating the estimated shortest paths and the number of searches at every grid point even if no obstacles exist on the possible path fig 2a and b dijkstra s algorithm with h 0 searched all the grid points between the origin and the destination fig 2a on the other hand the a star algorithm successfully finds the shortest path without any unnecessary searches fig 2b that ensures significant improvement in computational efficiency if we place obstacles representing breakwaters of port facilities near the origin and destination the two algorithms detect the same optimal routes whereas the a star algorithm requires fewer computational steps and searched grid points than dijkstra s algorithm fig 2c and d therefore the a star algorithm significantly reduces search cost to find the shortest path without losing precision as compared to dijkstra s algorithm 2 2 three options useful for marine wr the traveling cost χ and heuristics h inherent in the original a star algorithm are designed with euclidean distances the optimal route is determined by minimizing the sum of the cost χ and the heuristics h such that the optimal route follows the paths of shortest euclidean distance in this study we incorporate the great circular distance hereinafter simply referred to as an arc length to χ and h and the effect of oceanic current and other factors to χ the first modification has usually been done in other marine wr algorithms the arc length l between two locations at latitude φ 1 longitude λ 1 and φ 2 λ 2 on the globe with a diameter of r may be approximated as 1 l r a c o s s i n φ 1 s i n φ 2 c o s φ 1 c o s φ 2 c o s λ 1 λ 2 thus in the shortest travel distance method the optimal route is searched without considering oceanic currents so the inter node traveling cost function from node m to node n χ n m is defined merely as 2 χ n m l where l is the arc length between nodes n and m as computed by eq 1 in the second modification we consider a weight on the cost χ by reflecting changes of the vessel s relative velocity to the local background currents as changes of an effective inter node traveling distance fig 1c i e we assume that the traveling distance is either shortened or elongated due to background current velocity if a vessel is sailing on still water at v o but the ocean moves at v i due to currents then the resultant absolute vessel speed is v o v i accordingly χ n m is modified as 3 χ n m v o v o v i l if the ambient current direction coincides with the vessel s traveling direction i e v o v i v o then the weighted χ n m l so that the navigator may favor sailing the vessel in this direction for the shorter travel time in contrast if the underlying current is in the same direction as the vessel then the vessel can decelerate its relative speed to v o v i to keep the absolute vessel speed unchanged to reduce fuel consumption according to previous studies e g lu et al 2015 bialystocki and konovessis 2016 fuel consumption of vessels is quadratically proportional to the relative vessel speed hence we introduce another modification for the minimal fuel consumption method in which 4 χ n m l v o v i v o 2 as a result three options are introduced to search for the optimum paths with the shortest travel distance 1 without considering oceanic currents 2 minimizing travel time while maintaining a constant propeller speed and 3 minimizing fuel consumption by preserving a constant vessel speed affected by oceanic currents while altering propeller speed although the first method corresponds to the original a star algorithm the latter two methods rely on the weighted cost function χ modified by oceanic and atmospheric conditions in addition a rerouting function is also implemented as well as an avoidance function for arbitrary areas where there are waves wind chemicals and any conditions that are undesirable for navigation the former is achieved simply by re computation of the optimal route whenever it is demanded upon updates of oceanic atmospheric or vessel conditions the latter is viable by removing the nodes that the vessel should avoid from wr computations 3 regional ocean circulation models the ocean model we use in this study is the regional oceanic modeling system roms shchepetkin and mcwilliams 2005 2008 a terrain following 3d primitive equation ocean circulation model with the hydrostatic and boussinesq approximations the following subsections describe the model configurations used for the wr experiments to validate and evaluate the proposed algorithms 3 1 northwestern pacific ocean model the first configuration used in this study is the northwestern pacific ocean downscaling roms model hereinafter nwpo fig 3 and table 1 developed in tada et al 2018 the daily averaged jcope2 reanalysis with a lateral grid spacing of 10 km is used as the initial and open boundary conditions the atmospheric conditions are imposed by using the grid point value mesoscale model gpv msm a high resolution atmospheric reanalysis product published by the japan meteorological agency jma the nwpo model domain extends horizontally 1 840 km 1 440 km with a lateral grid spacing of 2 km to encompass a sufficiently wide area that includes the kuroshio path and the track of typhoon 201418 phanfone temperature salinity nudging t s nudging marchesiello et al 2003 uchiyama et al 2018a with a weak nudging inverse time scale of 1 20 d 1 is applied towards the 10 day averaged jcope2 3d temperature and salinity fields to assure long term reproducibility of the kuroshio path this model was extensively validated to show good agreement with satellite and in situ observations in tada et al 2018 the nwpo model is used for testing graph search problems in consideration of the kuroshio path and rerouting and avoidance functions under a typhoon condition in sections 4 1 and 4 2 3 2 compact ocean model we configure a compact ocean model for the sis hereinafter seto 2km fig 3 that is sufficiently suited to execute on laptop computers or even on tablets and smartphones for a vessel borne quasi standalone wr system the model is again based on roms and designed to encompass the sis and the kuroshio with a horizontal grid spacing of 2 km a one way offline nesting is employed from the assimilative jcope2 oceanic reanalysis ten tidal constituents from the tpxo7 0 global tidal reanalysis egbert et al 1994 egbert and erofeeva 2002 are additionally imposed on the open boundaries to account for substantial tidal currents in the sis other numerical conditions are listed in table 1 by reducing horizontal and vertical resolutions omitting river inflows and simplifying the surface flux estimation without losing the required accuracy the model can compute 3d oceanic currents and density field for one calendar day in approximately 4 min using a typical laptop pc in the following analyses the seto 2km roms model runs for a two month period including the initial spin up of one month 3 3 validation of the compact ocean model the results of the seto 2km model are compared with those of another higher resolution sis model developed in kosako et al 2016 hereinafter seto 600m fig 3 and table 1 the seto 600m model is in a double nested configuration based on roms with grid spacings of 2 km and 600 m embedded in the jcope2 reanalysis the surface fluxes are obtained using the bulk formula that has been implemented in the coupled ocean atmosphere mesoscale prediction system coamps hodur 1997 the freshwater discharges from all the major rivers in each model domain are given as monthly climatological freshwater mass point sources based on the annual record of rainfall and discharge database issued by the japan river association the seto 600m model was also carefully validated with observed surface temperature and salinity in kosako et al 2016 as well as high frequency tidal signals in the sis in uchiyama et al 2018b other numerical configurations are the same as those of the seto 2km model as summarized in table 1 it is anticipated that the seto 2km model would be degraded by design from its higher resolution counterpart due to the simplified physics and numerical methods for the sake of portability the point to be confirmed here is whether the seto 2km is still reasonably precise for wr or not fig 4 shows the comparison of sea surface variables between the seto 2km and seto 600m models averaged over one month in february 2013 the surface temperature agreement is exhibited between the two models whereas the agreement is moderate for salinity and velocity the surface salinity of the seto 2km model is overestimated especially in the inner bay areas because the compact model does not account for major rivers that results in underestimation of freshwater input to the sis fig 4c and d the mean surface velocity distributions of the compact model are almost identical to those of the seto 600m despite the modest underestimation in the offshore area around the kuroshio path where the highest velocity emerges fig 4e and f such velocity intensification is well known to be associated with grid size refinement because the frontal structures around the kuroshio path are better resolved to enhance cross frontal lateral buoyancy and pressure gradient forces leading to geostrophic axial acceleration of the kuroshio the vertical cross sectional plots along the a b line see fig 3 for the location of the same variables as those in fig 4 show that the seto 2km model successfully reproduces the stratification of temperature and salinity near the kuroshio front fig 5 a and b in contrast the streamwise velocity along the kuroshio has an overall similarity but with intensified streamwise velocity in the seto 600m due to the enhanced frontal gradient fig 5e and f as anticipated although the model grid resolution and precise forcing are important in ensuring the detailed reproducibility the seto 2km model has a reasonable accuracy comparable to the high resolution model except for some limited regions such as near river mouths and the kuroshio path fig 6 compares the ocean currents of the seto 2km model and those from in situ observation data obtained by the ministry of land infrastructure transport and tourism this data contains current direction and velocity observed by upward looking adcps deployed at the bottoms the panels show comparisons in three layers surface middle and bottom at three points shown in fig 6a at 12 h intervals for one month period in february 2013 root mean square differences rmsds for modeled currents relative to the in situ data are calculated as 5 rmsd 1 n i 1 n f i y i 2 where n f and y are the number of observations modeled forecast value and observed value respectively at both p1 and p2 in fig 6a the seto 2km model reproduces currents in the bottom layer better than those in the surface and middle layers fig 6 b g the rmsds at p3 shows that the seto 2km model estimated the current well at each layer fig 6 h j consequently even though the seto 2km model is designed as a compact ocean model its reproducibility of depth dependent horizontal current velocity is reasonably well while we expect significant improvement by using finer resolution and more accurate and sufficient initial condition and forcing datasets fig 7 shows the result of a tidal harmonic analysis of surface elevations from the seto 2km model and in situ tidal observations at seven tide gauge stations of jma at kobe wakayama komatsushima kochi matsuyama uwajima and saiki shown by the cyan markers in fig 3b for a one month period in february 2013 we show the result for four selected principal tidal constituents m2 s2 k1 and o1 as scatterplots of amplitudes and phase epochs it is clearly demonstrated that the amplitudes and phases are reasonably well reproduced by the seto 2km model with the correlation coefficients of 0 944 and 0 999 respectively this result assures us that the present seto 2km model adequately reproduces high frequency tidal currents prominent in the sis from the results demonstrated above we would conclude that the compact seto 2km model is exploitable for ship routing problems in the sis 4 experiments 4 1 the three new wr methods a case study for an ocean liner in this subsection the optimal routes are evaluated by using the three new routing strategies a test problem considered here is wr of an ocean liner from okinawa to tokyo fig 3b a key point of this application is how the vessel utilizes the kuroshio drifting northeastward fig 8 because the kuroshio is recognized to be intense enough at up to 3 m s 6 kn to affect a vessel s speed some previous studies have tried to incorporate the current effects in wr chen et al 2015 chang et al 2013 hourly averaged oceanic surface currents are provided from the nwpo model whereas we used the values of surface currents at the departure time that were frozen during the voyage the rerouting function is also not considered in this experiment for brevity and simplicity the imposed speed of the vessel is 10 kn unless otherwise stated fig 8 shows the three optimal routes and associated calculation steps at each of the searched grid points the black curve in fig 8a represents the shortest travel distance route based on the original a star algorithm because this route is simply determined without any oceanic influences it is merely a straight line connecting the origin and the destination while avoiding islands we notice that the eastward zonal travel occurs after reaching the coastal area for shorter arcs at higher latitude by contrast the shortest travel time route fig 8b partially utilizes the kuroshio current flowing mostly parallel to the vessel s track the vessel does not take a roundabout route on the kuroshio off shikoku island but rather takes a straight course before it starts using the kuroshio from the kii peninsula on the other hand the minimal fuel consumption route fig 8c is quite different from the other two routes the vessel uses the kuroshio for a long distance as much as possible to minimize fuel consumption the lower panels of fig 8 show that the shortest travel time fig 8e and minimal fuel consumption methods fig 8f require much fewer searches and thus are computationally more efficient to find the optimal route than the original a star method fig 8d even though they account for influences of the kuroshio in the evaluation of the cost χ the two weighted a star searches suggest detours to utilize the kuroshio following the vessel to reduce χ whereas the minimal fuel route favors much greater detours apparently the degrees to which the weighted methods recommend utilization of the following currents depend on the ratio of the vessel s speed to the ambient current speed the kuroshio current is at 2 3 m s 4 6 kn near the ocean surface which is significant as compared to the vessel s speed set at 10 kn if the vessel were on the kuroshio path during its entire voyage the expected fuel consumption could be minimum on average however such a route requires large detours that eventually lead to extra fuel consumption due to longer travel time the weighted cost functions optimize the balance between these competing influences on the routing purposes on the other hand whereas the weighted searches are computationally less costly than the a star search the shortest travel time search takes more search steps to finalize the optimization than the minimum fuel search particularly in the east of the kii peninsula this result illustrates a sensitivity of the optimization to reduce the travel time by considering a balance between the faster vessel s absolute speed due to following the kuroshio and the longer travel distance due to detours the results of the three optimal path findings are summarized in table 2 needless to say the shortest travel distance route is the shortest in the case of the shortest travel time method although the distance traveled is longer than the shortest distance route by 20 km the algorithm successfully shortens the travel time by approximately 4 h thanks to the kuroshio effect in the case of the minimum fuel consumption method whereas the traveled distance and time are increased greatly the fuel consumption is reduced by 8 4 compared with the shortest distance route consequently it is confirmed that the developed wr algorithms successfully determine the optimal vessel tracks with the three options it is worth noting that the present method with the weighted cost χ is quite flexible and readily expandable to cases under other restrictions such as with retardation of the vessel s speed due to surface waves winds and even surrounding traffic 4 2 avoidance of a typhoon with the rerouting function the rerouting and avoidance functions are tested for a case with a typhoon traveling near the vessel track sailing from tokyo to okinawa the same nwpo model used in the preceding application provides the oceanic conditions an analysis is conducted with the shortest travel time method for the period when typhoon 201418 phanfone emerges in the domain many previous studies have tried to navigate ships in windy and high wave conditions by estimating the impact of the conditions on the vessel s body and motion journée and meijers 1980 shaoze et al 2016 however in this subsection we account for such severe weather conditions as simply as possible to evade complexity associated with interactions between the ship s body and the ocean merely for testing of the implemented avoidance function the avoidance condition is set with two criteria viz wind speed greater than 17 2 m s and wave height higher than 7 5 m these weather conditions are provided from the gpv msm atmospheric product and the gpv cwm spectral wave product both published by the jma the nodes that meet either of the two criteria are configured as obstacles similar to the land nodes where the vessel is unnavigable the time varying ambient currents are also considered in this experiment the rerouting is also performed at 1 h intervals to synchronize with the hourly update of the weather and oceanic information fig 9 shows the snapshots of the migrating typhoon visualized by significant wave height colors and wind speed at 10 m above the ocean surface contours with the vessel s tracks at intervals of 8 h the black dotted curve is the shortest travel time route without considering the typhoon while the blue dotted curves are the predicted shortest time routes sequentially updated with hourly rerouting the black solid curves are the actual vessel tracks the optimal vessel track is pronouncedly modified with the updated weather information to successfully avoid encountering the migrating typhoon interestingly the resultant optimal route is on the right side of the typhoon where wind and waves are usually larger than those on the other side in the northern hemisphere obviously this optimal path is affected by the along coast typhoon track attributable to less severe weather conditions on the right side of the typhoon for the vessel of interest the vessel navigates towards okinawa not only keeping away from the typhoon but also minimizing excess distance traveled to bypass the storm these results confirm that the present wr algorithm can determine desirable optimal routes with the rerouting and avoidance functionalities 4 3 ship routing under strong tidal currents in this subsection the seto 2km compact ocean model is exploited to develop and test a quasi standalone wr system suitable for regional ship navigation in estuaries bays and harbors as argued in section 3 this model is sufficiently capable of running on laptop computers tablets and smartphones on the ship while maintaining reasonable accuracy therefore our motivation to employ such a compact model totally differs from that in the preceding subsections where the high resolution oceanic downscaling products originally designed for research purposes were used for precise evaluation of the proposed algorithms the sis is characterized by complex topography that forms a typical basin strait system fig 3 where strong semi diurnal tidal currents develop near topographies e g uchiyama et al 2018b zhang et al 2019 we intend to find the optimal southwestward routes from osaka to kagawa which requires passing a narrow tidal strait where tidal currents are quite energetic because tidal currents fluctuate largely at the semi diurnal period in the area travel time and fuel efficiency are affected by their direction and intensity that depend on tidal phase and thus on the departure time fig 10 shows the optimal routes from osaka to kagawa with the shortest travel time method for the ship operated at 10 kn leaving osaka every 6 h from 0 00 utc on february 22 2013 the color represents the horizontal velocity magnitude averaged over the 6 h after each departure the vectors correspond to the direction and speed of the time averaged tidal currents overall the determined shortest travel time routes are similar to each other among all the cases the present wr system suggests passing through the northern strait with rather straight routes from the origin to the strait and from the strait to the destination the most striking differences associated with the tidal phase are confirmed by comparing two cases in which the ship departs at 12 00 and 18 00 on february 22 in 2013 fig 10c and d as labeled in fig 10 although the estimated routes travel distances and durations are approximately the same the difference of fuel efficiency is 14 5 for these two cases fig 11 shows the time series of the fuel efficiency according to the departure times shown on the abscissa normalized by that with the least efficiency the estimated fuel efficiency with different departure times varies at a 12 h period we found that the overall fuel efficiency depends on the condition of the tidal currents at the northern strait rather than on the departure time apparently this is caused by the predominance of the semi diurnal tidal variability in the sis for instance fig 10c clearly demonstrates that strong eastward tidal currents occur at the strait where the narrow channel topography intensifies tidal currents opposing the westward traveling vessel resulting in deceleration of the vessel in turn if the vessel leaves the origin at 18 00 fig 10d it approaches the strait at 20 00 when the tidal currents are headed westward to accelerate the vessel from these results the direction of the semi diurnal tidal currents in such a small estuary has a pronounced impact on vessel speed leading to substantial alteration of fuel efficiency 5 conclusions this study aimed to develop a weather routing wr system for vessel navigation based on the a star algorithm building upon the heuristics introduced to reduce computational cost as compared to that of the widely used dijkstra s algorithm the cost function was additionally modified to account for oceanic and atmospheric conditions around the vessel of interest three options were implemented to search for the optimal paths with the shortest travel time minimal fuel consumption and shortest travel distance in addition we introduced a rerouting function that recalculates and updates the optimal route recursively whenever the route should be reconsidered with updated oceanic and weather information an avoidance function to exclude specific nodes from the search was also incorporated into the wr system by setting thresholds according to oceanic and weather conditions the ocean liner examples along the northeastward drifting kuroshio current off japan with and without a migrating typhoon were chosen to test the developed wr system and to confirm the expected functionalities furthermore a compact regional ocean circulation model which is sufficiently accurate and executable on typical laptop pcs was configured for a vessel borne wr system this compact model was successfully applied to evaluate the optimal vessel paths in the sis where high frequency tidal currents modified by complex topographies are significant enough to alter the vessel s absolute speed to which fuel efficiency is eventually attributed to a remarkable extent in this study our purpose was accomplished by using simple datasets to design the compact ocean model for further applying this method to the practical implementation of wr systems in the japan s neighboring seas in the future the compact model will need to be operational and also coupled with atmospheric models in such a case the compact model would become more complicated and time consuming because forecasts of winds waves and currents for several days up front are necessary in other words more accurate and sophisticated wr system will be realized with higher performance pc and more frequent data updates the developed wr system is quite general computationally very low cost and universally applicable to any vessel navigation scenarios not only in the open ocean but also in estuaries and harbors with complex topographies although we mostly examined the effects of the ambient surface currents the proposed weighted cost function based on the a star algorithm has substantial flexibility and expandability to account for arbitrary oceanic and weather conditions around the vessel possible modifications are to be made by adjusting the weight defined as a function of the vessel s speed for instance given detailed wave or wind conditions around the vessel the traveling speed may be altered accordingly which in turn influences the effective inter node distance equivalent to the weighted cost the challenge towards an integrated vessel borne wr system with a compact ocean model is also a unique undertaking of this study such a system allows us tremendous flexibility in utility of the marine wr even though data retrieval is impossible or largely limited if the vessel is out of radio range under certain circumstances including cases of severe natural disasters acknowledgments this study was financially supported by the japan society for the promotion of science jsps grants in aid for scientific research 15kk0207 and 18h03798 at kobe university we also appreciate yota suzue cti engineering co ltd hiroaki tada nippon koei co ltd and yasumasa miyazawa japan agency for marine earth science and technology for their help in the development of the roms models embedded in the assimilative japan coastal ocean predictability experiments jcope2 oceanic reanalysis that was used in the present study 
22258,the primary objective of this study is to develop a new weather routing system for vessel navigation in coastal and marginal seas based on the a star algorithm the cost function inherent in the original a star algorithm is modified to account for oceanic and atmospheric conditions around the vessel of interest three options are introduced to search for optimal paths with the shortest travel distance shortest travel time and minimal fuel consumption an avoidance algorithm for unsafe conditions is further incorporated to exempt any arbitrary area from the navigation solution furthermore a compact ocean circulation model based on the regional ocean modeling system executable on typical laptop pcs is configured for a vessel borne weather routing system the system is successfully applied to evaluate the optimal vessel paths in the seto inland sea where high frequency tidal currents modified by complex topography make it essential to alter the vessel s speed keywords weather routing a star algorithm roms kuroshio optimal route numerical simulations 1 introduction reduction of carbon dioxide co2 emission has been a long standing issue for mediating global warming among others fuel efficiency in ship navigation is recognized as a fundamental factor that must be remedied buhaug et al 2009 presents that the proportion of co2 from ship emissions in 2007 was estimated to be 1 046 million tons accounting for 3 3 of the global co2 emission during that year for economical operation in marine logistics optimal routing to determine on time or shortest cruising path is indispensable in particular finding the shortest path is often more essential to immediate excursions for fishing rescues and leaked contaminants and to provide urgent evacuation from coastal disasters such as tsunamis and storms however vessel navigation is affected significantly by ambient oceanic and atmospheric conditions that restrict the optimal paths for instance opposing oceanic currents reduce the vessel s relative speed or increase fuel consumption whichever the operator cares for more seriously trodden et al 2015 bouman et al 2017 therefore weather routing hereinafter denoted as wr in which surrounding oceanic and atmospheric conditions are taken into account in navigation is highly desirable for desirable vessel navigation in general wr determines the optimal route by considering many factors such as weather and oceanic conditions characteristics of ships and areas of territorial waters sen and padhy 2010 tsou and cheng 2013 wr differs from automotive navigation systems in many aspects for example while automotive navigation systems usually consider only traffic congestion and negotiable roads wr must account for natural phenomena such as oceanic currents wind speeds and wave heights moreover in the open ocean there are very few obstacles except islands and territorial waters in contrast to the land hence because wr must deal with an infinite number of routes consisting of vast numbers of links and nodes but with fewer guideposts to find the optimal route its computational cost becomes drastically more expensive than that for automobile navigation furthermore it is necessary to design wr algorithms properly not only for the shortest route efentakis et al 2011 but also for the safest route kosmas and vlachos 2012 the minimum fuel route jung and rhyu 1999 papanikolaou et al 2016 and the combinations of these factors szlapczynska 2007 andersson 2015 therefore previous studies have attempted to develop path finding algorithms while minimizing the computational cost of wr one of the more popular methods for finding an optimal route for wr is the isochrone method proposed by journée and meijers 1980 although this method has been used for decades because of its simplicity the isochrones have to be manually determined a priori hagiwara 1989 improved the isochrone method to be suitable for computers by implementing an automated isochrone detection algorithm however the isochrone method occasionally generates so called isochrone loops making path finding impossible and failing to avoid crossing lands hence de wit 1990 and calvert et al 1991 introduced dynamic programming which uses a grid system that divides a possible sailing region into several cells where each crossing point of a cell boundary is used as a waypoint candidate some studies have made efforts to conduct a series of detailed investigations to reduce the navigators workload by using a dynamic programming method for grid size setting and design of the wr system wei and zhou 2012 kim and lee 2018 although these methods have been developed elaborately to account for oceanic and atmospheric conditions as much as possible their main drawbacks are computational inefficiency caused by a large number of nodes a requirement for large storage space inflexibility and slow computational speed with a gridded sea area dijkstra s algorithm dijkstra 1959 in graph theory is well known to be practical for ship navigation the algorithm begins at a specific node and extends outwards to calculate the shortest path between any two vertices in a weighted graph fig 1 a because the algorithm requires searches for all the nodes between the origin and destination it is computationally very expensive if the sea area of interest is gridded at fine lateral spacing by contrast the a star algorithm hart et al 1968 a modified method of dijkstra s algorithm uses heuristics by introducing a cost function for determining the shortest path to the destination fig 1b as compared to the original dijkstra s algorithm the a star algorithm enables us to significantly reduce computational cost to determine the optimal route by preferentially searching for the adjacent links and nodes pointing to the destination as illustrated above there are a substantial number of studies and algorithms for wr with some comparative assessments among the methods e g roh 2013 walther et al 2016 but the definitive algorithm suitable for wr has not yet been confirmed in this study our first objective is to propose a new marine wr system based upon the a star algorithm for determining the shortest path to the destination a cost function is additionally introduced to account for oceanic and atmospheric conditions around the vessel of interest combined with the heuristic function defined in the original a star algorithm in other words this study proposes to modify the cost function so that three options are considered to search for the optimal paths shortest travel distance shortest travel time and minimal fuel consumption furthermore most of previous wr studies have focused on ocean going vessels and ocean liners that cruise mostly on the open ocean their routing algorithms are mainly for long voyages where a wide range of route choices is possible nevertheless it is difficult to apply such algorithms directly for vessels sailing on coastal and marginal seas smierzchalski and michalewicz 2000 chen et al 2013 the primary reason is complexity of weather and oceanic conditions as well as coastline topography all of which are necessary for coastal wr thus there is room for improvement on wr in such areas one of the more significant issues arises from a poor resolution of the oceanic and atmospheric information released from agencies concerned in general these products have quite large spatial resolutions and large update intervals for example a regional oceanic reanalysis forecast product the japan coastal ocean prediction experiment jcope2 miyazawa et al 2009 of the japan agency for marine earth science and technology jamstec provides daily averaged data at a lateral grid spacing of about 10 km this resolution is not sufficient in crowded harbors and bays where detailed navigation is crucial because high frequency variability such as tidal currents characterize the ambient oceanic condition most prominently moreover data retrieval prior to departure and subsequent onboard predictions are occasionally indispensable because ample data retrieval through communications satellites during the voyage may not be feasible therefore this study also configures a compact and computationally efficient regional ocean model executable on typical laptop pcs aiming at a vessel borne weather routing system for suboptimal availability of weather and oceanic reanalysis prediction the model is coupled with the wr system based on the a star algorithm to evaluate the optimal vessel paths our test bed is the seto inland sea hereafter sis japan filled with an enormous number of commercial carriers and small fishery and pleasure boats in the sis the high frequency tidal currents modified by complex topography are substantial to alter the vessel s speed for optimal navigation therefore this study aims to achieve the following 1 develop a new wr system based on the a star algorithm which calculates an optimal route with consideration of oceanic and atmospheric conditions having capabilities of rerouting and avoidance functions for more accurate and safer navigation 2 assess the efficiency of the newly developed wr system by applying it to several scenarios including evacuation from a migrating typhoon and 3 configure a compact regional ocean circulation model executable on typical laptop pcs aiming at a vessel borne wr this paper is organized as follows section 2 describes the proposed algorithms for the wr system the configurations of the numerical models are given in section 3 the experimental results with the new wr algorithm are presented and discussed in section 4 finally summaries of this study are presented in section 5 2 weather routing algorithms 2 1 a star and dijkstra s algorithms in this study a new marine ship routing system is proposed based on the a star algorithm hart et al 1968 fig 1b this algorithm finds the shortest path to the destination using inter node traveling cost hereafter χ and a heuristic function hereafter h the heuristic function h is defined as the shortest path from each node to the final destination node determined a priori to minimize the cost χ to search neighboring nodes for candidates comprising the optimal path hence the a star algorithm enables us to significantly reduce computational time needed to determine the optimal route by using h as the guidepost if h is set at zero the a star algorithm simply reverts back to dijkstra s algorithm fig 1a fig 2 compares the efficiency of the dijkstra s algorithm and the a star algorithm in searching for the shortest path from the origin to the destination by illustrating the estimated shortest paths and the number of searches at every grid point even if no obstacles exist on the possible path fig 2a and b dijkstra s algorithm with h 0 searched all the grid points between the origin and the destination fig 2a on the other hand the a star algorithm successfully finds the shortest path without any unnecessary searches fig 2b that ensures significant improvement in computational efficiency if we place obstacles representing breakwaters of port facilities near the origin and destination the two algorithms detect the same optimal routes whereas the a star algorithm requires fewer computational steps and searched grid points than dijkstra s algorithm fig 2c and d therefore the a star algorithm significantly reduces search cost to find the shortest path without losing precision as compared to dijkstra s algorithm 2 2 three options useful for marine wr the traveling cost χ and heuristics h inherent in the original a star algorithm are designed with euclidean distances the optimal route is determined by minimizing the sum of the cost χ and the heuristics h such that the optimal route follows the paths of shortest euclidean distance in this study we incorporate the great circular distance hereinafter simply referred to as an arc length to χ and h and the effect of oceanic current and other factors to χ the first modification has usually been done in other marine wr algorithms the arc length l between two locations at latitude φ 1 longitude λ 1 and φ 2 λ 2 on the globe with a diameter of r may be approximated as 1 l r a c o s s i n φ 1 s i n φ 2 c o s φ 1 c o s φ 2 c o s λ 1 λ 2 thus in the shortest travel distance method the optimal route is searched without considering oceanic currents so the inter node traveling cost function from node m to node n χ n m is defined merely as 2 χ n m l where l is the arc length between nodes n and m as computed by eq 1 in the second modification we consider a weight on the cost χ by reflecting changes of the vessel s relative velocity to the local background currents as changes of an effective inter node traveling distance fig 1c i e we assume that the traveling distance is either shortened or elongated due to background current velocity if a vessel is sailing on still water at v o but the ocean moves at v i due to currents then the resultant absolute vessel speed is v o v i accordingly χ n m is modified as 3 χ n m v o v o v i l if the ambient current direction coincides with the vessel s traveling direction i e v o v i v o then the weighted χ n m l so that the navigator may favor sailing the vessel in this direction for the shorter travel time in contrast if the underlying current is in the same direction as the vessel then the vessel can decelerate its relative speed to v o v i to keep the absolute vessel speed unchanged to reduce fuel consumption according to previous studies e g lu et al 2015 bialystocki and konovessis 2016 fuel consumption of vessels is quadratically proportional to the relative vessel speed hence we introduce another modification for the minimal fuel consumption method in which 4 χ n m l v o v i v o 2 as a result three options are introduced to search for the optimum paths with the shortest travel distance 1 without considering oceanic currents 2 minimizing travel time while maintaining a constant propeller speed and 3 minimizing fuel consumption by preserving a constant vessel speed affected by oceanic currents while altering propeller speed although the first method corresponds to the original a star algorithm the latter two methods rely on the weighted cost function χ modified by oceanic and atmospheric conditions in addition a rerouting function is also implemented as well as an avoidance function for arbitrary areas where there are waves wind chemicals and any conditions that are undesirable for navigation the former is achieved simply by re computation of the optimal route whenever it is demanded upon updates of oceanic atmospheric or vessel conditions the latter is viable by removing the nodes that the vessel should avoid from wr computations 3 regional ocean circulation models the ocean model we use in this study is the regional oceanic modeling system roms shchepetkin and mcwilliams 2005 2008 a terrain following 3d primitive equation ocean circulation model with the hydrostatic and boussinesq approximations the following subsections describe the model configurations used for the wr experiments to validate and evaluate the proposed algorithms 3 1 northwestern pacific ocean model the first configuration used in this study is the northwestern pacific ocean downscaling roms model hereinafter nwpo fig 3 and table 1 developed in tada et al 2018 the daily averaged jcope2 reanalysis with a lateral grid spacing of 10 km is used as the initial and open boundary conditions the atmospheric conditions are imposed by using the grid point value mesoscale model gpv msm a high resolution atmospheric reanalysis product published by the japan meteorological agency jma the nwpo model domain extends horizontally 1 840 km 1 440 km with a lateral grid spacing of 2 km to encompass a sufficiently wide area that includes the kuroshio path and the track of typhoon 201418 phanfone temperature salinity nudging t s nudging marchesiello et al 2003 uchiyama et al 2018a with a weak nudging inverse time scale of 1 20 d 1 is applied towards the 10 day averaged jcope2 3d temperature and salinity fields to assure long term reproducibility of the kuroshio path this model was extensively validated to show good agreement with satellite and in situ observations in tada et al 2018 the nwpo model is used for testing graph search problems in consideration of the kuroshio path and rerouting and avoidance functions under a typhoon condition in sections 4 1 and 4 2 3 2 compact ocean model we configure a compact ocean model for the sis hereinafter seto 2km fig 3 that is sufficiently suited to execute on laptop computers or even on tablets and smartphones for a vessel borne quasi standalone wr system the model is again based on roms and designed to encompass the sis and the kuroshio with a horizontal grid spacing of 2 km a one way offline nesting is employed from the assimilative jcope2 oceanic reanalysis ten tidal constituents from the tpxo7 0 global tidal reanalysis egbert et al 1994 egbert and erofeeva 2002 are additionally imposed on the open boundaries to account for substantial tidal currents in the sis other numerical conditions are listed in table 1 by reducing horizontal and vertical resolutions omitting river inflows and simplifying the surface flux estimation without losing the required accuracy the model can compute 3d oceanic currents and density field for one calendar day in approximately 4 min using a typical laptop pc in the following analyses the seto 2km roms model runs for a two month period including the initial spin up of one month 3 3 validation of the compact ocean model the results of the seto 2km model are compared with those of another higher resolution sis model developed in kosako et al 2016 hereinafter seto 600m fig 3 and table 1 the seto 600m model is in a double nested configuration based on roms with grid spacings of 2 km and 600 m embedded in the jcope2 reanalysis the surface fluxes are obtained using the bulk formula that has been implemented in the coupled ocean atmosphere mesoscale prediction system coamps hodur 1997 the freshwater discharges from all the major rivers in each model domain are given as monthly climatological freshwater mass point sources based on the annual record of rainfall and discharge database issued by the japan river association the seto 600m model was also carefully validated with observed surface temperature and salinity in kosako et al 2016 as well as high frequency tidal signals in the sis in uchiyama et al 2018b other numerical configurations are the same as those of the seto 2km model as summarized in table 1 it is anticipated that the seto 2km model would be degraded by design from its higher resolution counterpart due to the simplified physics and numerical methods for the sake of portability the point to be confirmed here is whether the seto 2km is still reasonably precise for wr or not fig 4 shows the comparison of sea surface variables between the seto 2km and seto 600m models averaged over one month in february 2013 the surface temperature agreement is exhibited between the two models whereas the agreement is moderate for salinity and velocity the surface salinity of the seto 2km model is overestimated especially in the inner bay areas because the compact model does not account for major rivers that results in underestimation of freshwater input to the sis fig 4c and d the mean surface velocity distributions of the compact model are almost identical to those of the seto 600m despite the modest underestimation in the offshore area around the kuroshio path where the highest velocity emerges fig 4e and f such velocity intensification is well known to be associated with grid size refinement because the frontal structures around the kuroshio path are better resolved to enhance cross frontal lateral buoyancy and pressure gradient forces leading to geostrophic axial acceleration of the kuroshio the vertical cross sectional plots along the a b line see fig 3 for the location of the same variables as those in fig 4 show that the seto 2km model successfully reproduces the stratification of temperature and salinity near the kuroshio front fig 5 a and b in contrast the streamwise velocity along the kuroshio has an overall similarity but with intensified streamwise velocity in the seto 600m due to the enhanced frontal gradient fig 5e and f as anticipated although the model grid resolution and precise forcing are important in ensuring the detailed reproducibility the seto 2km model has a reasonable accuracy comparable to the high resolution model except for some limited regions such as near river mouths and the kuroshio path fig 6 compares the ocean currents of the seto 2km model and those from in situ observation data obtained by the ministry of land infrastructure transport and tourism this data contains current direction and velocity observed by upward looking adcps deployed at the bottoms the panels show comparisons in three layers surface middle and bottom at three points shown in fig 6a at 12 h intervals for one month period in february 2013 root mean square differences rmsds for modeled currents relative to the in situ data are calculated as 5 rmsd 1 n i 1 n f i y i 2 where n f and y are the number of observations modeled forecast value and observed value respectively at both p1 and p2 in fig 6a the seto 2km model reproduces currents in the bottom layer better than those in the surface and middle layers fig 6 b g the rmsds at p3 shows that the seto 2km model estimated the current well at each layer fig 6 h j consequently even though the seto 2km model is designed as a compact ocean model its reproducibility of depth dependent horizontal current velocity is reasonably well while we expect significant improvement by using finer resolution and more accurate and sufficient initial condition and forcing datasets fig 7 shows the result of a tidal harmonic analysis of surface elevations from the seto 2km model and in situ tidal observations at seven tide gauge stations of jma at kobe wakayama komatsushima kochi matsuyama uwajima and saiki shown by the cyan markers in fig 3b for a one month period in february 2013 we show the result for four selected principal tidal constituents m2 s2 k1 and o1 as scatterplots of amplitudes and phase epochs it is clearly demonstrated that the amplitudes and phases are reasonably well reproduced by the seto 2km model with the correlation coefficients of 0 944 and 0 999 respectively this result assures us that the present seto 2km model adequately reproduces high frequency tidal currents prominent in the sis from the results demonstrated above we would conclude that the compact seto 2km model is exploitable for ship routing problems in the sis 4 experiments 4 1 the three new wr methods a case study for an ocean liner in this subsection the optimal routes are evaluated by using the three new routing strategies a test problem considered here is wr of an ocean liner from okinawa to tokyo fig 3b a key point of this application is how the vessel utilizes the kuroshio drifting northeastward fig 8 because the kuroshio is recognized to be intense enough at up to 3 m s 6 kn to affect a vessel s speed some previous studies have tried to incorporate the current effects in wr chen et al 2015 chang et al 2013 hourly averaged oceanic surface currents are provided from the nwpo model whereas we used the values of surface currents at the departure time that were frozen during the voyage the rerouting function is also not considered in this experiment for brevity and simplicity the imposed speed of the vessel is 10 kn unless otherwise stated fig 8 shows the three optimal routes and associated calculation steps at each of the searched grid points the black curve in fig 8a represents the shortest travel distance route based on the original a star algorithm because this route is simply determined without any oceanic influences it is merely a straight line connecting the origin and the destination while avoiding islands we notice that the eastward zonal travel occurs after reaching the coastal area for shorter arcs at higher latitude by contrast the shortest travel time route fig 8b partially utilizes the kuroshio current flowing mostly parallel to the vessel s track the vessel does not take a roundabout route on the kuroshio off shikoku island but rather takes a straight course before it starts using the kuroshio from the kii peninsula on the other hand the minimal fuel consumption route fig 8c is quite different from the other two routes the vessel uses the kuroshio for a long distance as much as possible to minimize fuel consumption the lower panels of fig 8 show that the shortest travel time fig 8e and minimal fuel consumption methods fig 8f require much fewer searches and thus are computationally more efficient to find the optimal route than the original a star method fig 8d even though they account for influences of the kuroshio in the evaluation of the cost χ the two weighted a star searches suggest detours to utilize the kuroshio following the vessel to reduce χ whereas the minimal fuel route favors much greater detours apparently the degrees to which the weighted methods recommend utilization of the following currents depend on the ratio of the vessel s speed to the ambient current speed the kuroshio current is at 2 3 m s 4 6 kn near the ocean surface which is significant as compared to the vessel s speed set at 10 kn if the vessel were on the kuroshio path during its entire voyage the expected fuel consumption could be minimum on average however such a route requires large detours that eventually lead to extra fuel consumption due to longer travel time the weighted cost functions optimize the balance between these competing influences on the routing purposes on the other hand whereas the weighted searches are computationally less costly than the a star search the shortest travel time search takes more search steps to finalize the optimization than the minimum fuel search particularly in the east of the kii peninsula this result illustrates a sensitivity of the optimization to reduce the travel time by considering a balance between the faster vessel s absolute speed due to following the kuroshio and the longer travel distance due to detours the results of the three optimal path findings are summarized in table 2 needless to say the shortest travel distance route is the shortest in the case of the shortest travel time method although the distance traveled is longer than the shortest distance route by 20 km the algorithm successfully shortens the travel time by approximately 4 h thanks to the kuroshio effect in the case of the minimum fuel consumption method whereas the traveled distance and time are increased greatly the fuel consumption is reduced by 8 4 compared with the shortest distance route consequently it is confirmed that the developed wr algorithms successfully determine the optimal vessel tracks with the three options it is worth noting that the present method with the weighted cost χ is quite flexible and readily expandable to cases under other restrictions such as with retardation of the vessel s speed due to surface waves winds and even surrounding traffic 4 2 avoidance of a typhoon with the rerouting function the rerouting and avoidance functions are tested for a case with a typhoon traveling near the vessel track sailing from tokyo to okinawa the same nwpo model used in the preceding application provides the oceanic conditions an analysis is conducted with the shortest travel time method for the period when typhoon 201418 phanfone emerges in the domain many previous studies have tried to navigate ships in windy and high wave conditions by estimating the impact of the conditions on the vessel s body and motion journée and meijers 1980 shaoze et al 2016 however in this subsection we account for such severe weather conditions as simply as possible to evade complexity associated with interactions between the ship s body and the ocean merely for testing of the implemented avoidance function the avoidance condition is set with two criteria viz wind speed greater than 17 2 m s and wave height higher than 7 5 m these weather conditions are provided from the gpv msm atmospheric product and the gpv cwm spectral wave product both published by the jma the nodes that meet either of the two criteria are configured as obstacles similar to the land nodes where the vessel is unnavigable the time varying ambient currents are also considered in this experiment the rerouting is also performed at 1 h intervals to synchronize with the hourly update of the weather and oceanic information fig 9 shows the snapshots of the migrating typhoon visualized by significant wave height colors and wind speed at 10 m above the ocean surface contours with the vessel s tracks at intervals of 8 h the black dotted curve is the shortest travel time route without considering the typhoon while the blue dotted curves are the predicted shortest time routes sequentially updated with hourly rerouting the black solid curves are the actual vessel tracks the optimal vessel track is pronouncedly modified with the updated weather information to successfully avoid encountering the migrating typhoon interestingly the resultant optimal route is on the right side of the typhoon where wind and waves are usually larger than those on the other side in the northern hemisphere obviously this optimal path is affected by the along coast typhoon track attributable to less severe weather conditions on the right side of the typhoon for the vessel of interest the vessel navigates towards okinawa not only keeping away from the typhoon but also minimizing excess distance traveled to bypass the storm these results confirm that the present wr algorithm can determine desirable optimal routes with the rerouting and avoidance functionalities 4 3 ship routing under strong tidal currents in this subsection the seto 2km compact ocean model is exploited to develop and test a quasi standalone wr system suitable for regional ship navigation in estuaries bays and harbors as argued in section 3 this model is sufficiently capable of running on laptop computers tablets and smartphones on the ship while maintaining reasonable accuracy therefore our motivation to employ such a compact model totally differs from that in the preceding subsections where the high resolution oceanic downscaling products originally designed for research purposes were used for precise evaluation of the proposed algorithms the sis is characterized by complex topography that forms a typical basin strait system fig 3 where strong semi diurnal tidal currents develop near topographies e g uchiyama et al 2018b zhang et al 2019 we intend to find the optimal southwestward routes from osaka to kagawa which requires passing a narrow tidal strait where tidal currents are quite energetic because tidal currents fluctuate largely at the semi diurnal period in the area travel time and fuel efficiency are affected by their direction and intensity that depend on tidal phase and thus on the departure time fig 10 shows the optimal routes from osaka to kagawa with the shortest travel time method for the ship operated at 10 kn leaving osaka every 6 h from 0 00 utc on february 22 2013 the color represents the horizontal velocity magnitude averaged over the 6 h after each departure the vectors correspond to the direction and speed of the time averaged tidal currents overall the determined shortest travel time routes are similar to each other among all the cases the present wr system suggests passing through the northern strait with rather straight routes from the origin to the strait and from the strait to the destination the most striking differences associated with the tidal phase are confirmed by comparing two cases in which the ship departs at 12 00 and 18 00 on february 22 in 2013 fig 10c and d as labeled in fig 10 although the estimated routes travel distances and durations are approximately the same the difference of fuel efficiency is 14 5 for these two cases fig 11 shows the time series of the fuel efficiency according to the departure times shown on the abscissa normalized by that with the least efficiency the estimated fuel efficiency with different departure times varies at a 12 h period we found that the overall fuel efficiency depends on the condition of the tidal currents at the northern strait rather than on the departure time apparently this is caused by the predominance of the semi diurnal tidal variability in the sis for instance fig 10c clearly demonstrates that strong eastward tidal currents occur at the strait where the narrow channel topography intensifies tidal currents opposing the westward traveling vessel resulting in deceleration of the vessel in turn if the vessel leaves the origin at 18 00 fig 10d it approaches the strait at 20 00 when the tidal currents are headed westward to accelerate the vessel from these results the direction of the semi diurnal tidal currents in such a small estuary has a pronounced impact on vessel speed leading to substantial alteration of fuel efficiency 5 conclusions this study aimed to develop a weather routing wr system for vessel navigation based on the a star algorithm building upon the heuristics introduced to reduce computational cost as compared to that of the widely used dijkstra s algorithm the cost function was additionally modified to account for oceanic and atmospheric conditions around the vessel of interest three options were implemented to search for the optimal paths with the shortest travel time minimal fuel consumption and shortest travel distance in addition we introduced a rerouting function that recalculates and updates the optimal route recursively whenever the route should be reconsidered with updated oceanic and weather information an avoidance function to exclude specific nodes from the search was also incorporated into the wr system by setting thresholds according to oceanic and weather conditions the ocean liner examples along the northeastward drifting kuroshio current off japan with and without a migrating typhoon were chosen to test the developed wr system and to confirm the expected functionalities furthermore a compact regional ocean circulation model which is sufficiently accurate and executable on typical laptop pcs was configured for a vessel borne wr system this compact model was successfully applied to evaluate the optimal vessel paths in the sis where high frequency tidal currents modified by complex topographies are significant enough to alter the vessel s absolute speed to which fuel efficiency is eventually attributed to a remarkable extent in this study our purpose was accomplished by using simple datasets to design the compact ocean model for further applying this method to the practical implementation of wr systems in the japan s neighboring seas in the future the compact model will need to be operational and also coupled with atmospheric models in such a case the compact model would become more complicated and time consuming because forecasts of winds waves and currents for several days up front are necessary in other words more accurate and sophisticated wr system will be realized with higher performance pc and more frequent data updates the developed wr system is quite general computationally very low cost and universally applicable to any vessel navigation scenarios not only in the open ocean but also in estuaries and harbors with complex topographies although we mostly examined the effects of the ambient surface currents the proposed weighted cost function based on the a star algorithm has substantial flexibility and expandability to account for arbitrary oceanic and weather conditions around the vessel possible modifications are to be made by adjusting the weight defined as a function of the vessel s speed for instance given detailed wave or wind conditions around the vessel the traveling speed may be altered accordingly which in turn influences the effective inter node distance equivalent to the weighted cost the challenge towards an integrated vessel borne wr system with a compact ocean model is also a unique undertaking of this study such a system allows us tremendous flexibility in utility of the marine wr even though data retrieval is impossible or largely limited if the vessel is out of radio range under certain circumstances including cases of severe natural disasters acknowledgments this study was financially supported by the japan society for the promotion of science jsps grants in aid for scientific research 15kk0207 and 18h03798 at kobe university we also appreciate yota suzue cti engineering co ltd hiroaki tada nippon koei co ltd and yasumasa miyazawa japan agency for marine earth science and technology for their help in the development of the roms models embedded in the assimilative japan coastal ocean predictability experiments jcope2 oceanic reanalysis that was used in the present study 
22259,river current energy is considered as the greenest energy available as it has enormous energies stored it is a promising energy source in renewable energy due to the accessibility and availability the river nile in egypt has been selected in this work as the case study for this kind of energy the process of hydro kinetic energy conversion utilizes the contained kinetic energy in the river stream which can be extracted by a submerged vertical axis turbine the main objective of this work is to design and simulate a water current stream energy conversion system as a stand alone power station for the electric power generation the generated electric power is intended for rural and domestic applications cfd is used to simulate and redesign a drag turbine the numerical analysis indicates that the s shape blade has the maximum power coefficient of 24 6 for a tip speed ratio 0 8 and streamflow velocity 3 m s the results indicate that the maximum power coefficient of the s shape and the conventional design are 18 and 12 8 respectively at the tip speed ratio 0 8 and 0 5 m s the s shape enhances the turbine performance by 40 compared with the conventional design especially at low velocity keywords river current river nile vertical axis turbine hydro kinetic energy 1 introduction the captured energy from the river stream is being considered as a pivotal source of renewable energy the vertical axis turbine system is considered as a new and an emerging category of renewable energy technology and in remote areas an unconventional solution for electric power production antheaume et al 2008 the water current stream energy wcse conversion system will be considered as the first station conducted in egypt and in the middle east at all the construction of these stations and the prosperity of this type of electric power stations will contribute to the development of upper egypt in many fields like agriculture tourism and industry the main problem is that the ministry of electricity renewable energy at egypt does not have the vision or the strategy for the wave and water current stream energy conversion to generate electric power however this article encourages and introduces this type of renewable energy to draw attention to use it water turbines shapes were born from wind turbines with both types of vertical and horizontal axis turbines antheaume et al 2008 the high performance with high power production is introduced by a smooth linear flow of water at high velocity laskan inc report 2010 the flow features and characteristics of any river stream have some variation seasonal and daily and the installation of the water current turbine should be indeed considered the main feature of the river flow is unidirectional flow and this eliminates the need for yaw adjustments the hydrokinetic converter and the level of power output are directly affected by the water velocity the location and the position of the hydrokinetic device have a relation to the cross section of the flow channel moreover it is a very important and significant component for two essential reasons first depending on the river s bottom depth the energy flux at the surface of the water is stronger than the river s bottom in addition this quantity takes diverse values depending on the distance from the shore in a smooth channel the water current is fastest at the center but in a river this may vary depending on river bathymetry therefore the water velocity has a certain site specific and localized profile where the available amount of energy flux that can be obtained that can be produced depends on the rotor location antheaume et al 2008 second many river users are competing inside the water flow such as boats fishing vessels bridges etc and these might reduce the efficiency and effectiveness of the useable area for a turbine installation laskan inc report 2010 in addition other types of suspended and hanged particles and materials such as rock fish etc in the river verdant power 2006 could also be varying a vertical axis turbine fig 1 is considered for deployment at this location in lieu of a horizontal axis turbine for the following reasons 1 energy flux has a high due at the near of the surface of the river 2 the effect and influence of competing users from fishing and boating are avoided 3 footprint any trenching pilling at the bottom may become subject to the environmental scrutiny 4 the foundation and structure of vertical axis turbine are very low compared to the horizontal axis turbine 5 low cost and high durability 6 the manufacturing of this type especially the s shaped is available locally at egypt blue power co 7 the power production is continuous around the year with just a small adaptation to the water level tutar and veci 2015 investigated the effect of water depths with different wave boundary conditions on the performance of savonius turbine with single and multiple turbine arrays 3 turbines with three various positions of arrays however these arrays were conducted at several distances between them the submersion depth of the turbine blade underwater line had an influence on the rotor performance the rotor was fabricated with three blades each of which is made of a 2 mm aluminum sheet and is bent at a blade angle of 59 the blades were mounted on a 16 0 mm diameter shaft the rotor had a width of w 480 mm and an outer diameter of d 252 mm the submersion level was 5 0 and 5 cm with a rotor diameter of 25 cm they built the experimental model and tested it under a certain condition of water waves they concluded that the three blades rotor with 0 level center of rotor on water surface submersions had a maximum efficiency of 18 compared to 8 at 5 cm on the other side sarma and et al sarma et al 2014 conducted a numerical model of the savonius hydrokinetic turbine drag type moreover they tested it experimentally the experimental work was performed at the water channel with a water speed range from 0 3 to 0 9 m s they compared the produced power output from the same turbine in water and wind showing how the generated output power from water was greater than wind the power ratio between water and wind was calculated to be 61 32 with the turbine otherwise the simulation was done using the cfd program with maximum power coeffiecnt of 9 yaakob and et al yaakob et al 2013 studied the effect of the deflectors on the savonius hydrokinetic turbine inside a duct they had two different designs of deflectors the first one had one deflector and the second had two deflectors as in fig 2 the three dimensional cfd analysis was chosen by the authors to study and investigate the power and torque coefficient the power coefficient is defined as the ratio between the output power from the turbine by torque and angular velocity on the rotor to the incident power from the water stream on the blade according to the velocity of water stream the power coefficient was 0 27 in two deflectors compared to which equals 0 21 for only one deflector this increase in the cp indicated the influence of these deflectors on the whole performance of the savonius hydrokinetic turbine sharma and et al sharma et al 2014 reported the enhancement of the conventional savonius hydrokinetic turbine s efficiency of 21 as a maximum by controlling its design parameters the performance and characteristics of a two stage two bladed configuration of the savonius rotor had been investigated whole experiments had been carried out in a wind tunnel which has low wind speed the studied parameters were the overlap ratio tip speed ratio power coefficient cp and torque coefficient ct as shown and illustrated in fig 3 the study showed that a maximum cp of 0 517 was obtained at 9 37 overlap condition the overlap condition is meant that the both turbines had different installation angle to each other and to the incident air on them schleicher and et al chris schleicher et al 2013 worked numerically as a 3d simulation to generate 500 watt from the water current the turbine had the captured efficiency of 0 45 at a rotor diameter of 0 5334 m with water speed less than 2 2 m s zaidi and et al zaidi et al 2013 investigated the effect of the chord length of the helical blade 3d numerical simulation on the performance of the turbine grolov turbine this study was conducted and carried out by utilizing the commercial code fluent of ansys this investigation was performed by employing the shear stress transport sst k ω model they used the hydrofoil of naca 0012 with rotor radius 0 15 m with chord lengths of 0 006 0 0983 and 0 0988 m the data output from the 3d numerical simulation showed that the maximum cp was 58 at chord length 0 0983 m hantoro and et al hantoro et al 2018 performed an experimental study at an open channel to investigate an innovative design for the darrius type to be a hydrokinetic turbine they compared the convention one with 3 straight blades and two designs with 6 and 9 blades sbc where the swept area was the same for all the power coefficient for the 9 blades design was 0 42 at tsr 2 91 which is the maximum could be reached for the system kumar and sini kumar and saini 2017 carried out enhancement on the performance of the savonius hydrokinetic turbine using cfd analysis the simulation and calculations of the twisted savonius hydrokinetic turbine had been introduced and carried out by the commercial unsteady reynolds averaged navier stokes urans solver in conjunction with a realizable k ε turbulence model it had been found that savonius hydrokinetic turbine having a twist angle of 12 5 which produces an optimum power coefficient equals 0 39 at speed ratio equals to 0 9 with a water velocity of 2 m s it was found that savonius hydrokinetic turbine with a twist angle of 12 5 produces an optimum power coefficient of 0 39 at a tip speed ratio and water velocity of 0 9 and 2 m s respectively as appeared in all the previous work design and shapes of the blades are a very important factor for most of the energy conversion systems by this drag turbine the performance of this type of drag turbines can be substantially improved by employing multi objective optimization with its different techniques like ga or mopso algorithms ramadan et al 2018 mohammadi et al 2018 therefore a lot of authors tried to use multi objective optimization to improve the performance of this turbine actually multi objective optimization is used in improving the drag turbine ramadan et al 2018 mohammadi et al 2018 and the turbo machines in general polat and tuncer 2013 esmaeilzadeh and alam 2019 mengistu and ghaly 2008 samad and kim 2008 haldermohamed and samad 2018 mohamed et al 2008a this paper aims to investigate the ability to install the savonius turbine with s shape at the north of aswan dam aswan city egypt this design is targeting to be an off grid system as a stand alone system of electric power production authors tested this type of turbine numerically and experimentally at different wind speed the final result indicated that the power coefficient was 28 therefore it is encouraged us to use it as a hydrokinetic turbine mohamed et al 2008a the study is performed numerically at different water flow speed according to the selected locations as seen in fig 4 the statistical data of the water speed can be seen in fig 5 sattar and raslan 2014 the data were predicted for 120 days due to the flow rate at these locations as illustrated and shown in fig 6 the available power density javil and captured power density jcap of water flow these parameters are defined as follow 1 javil avilable power rotor area 0 5 ρ uw 3 a jcap javil c p 2 this type of stand alone power system could be the core of development in the rural area in upper egypt due to the simplicity of the turbine in both manufacturing and installation moreover table 1 indicates the average annual water level and velocity at 5 different zones with different in river s widths the flow rate is approximately 250 m3 s according to the study of yasser and radwa raslan and salama 2015 the system is designed to be flexible in level variation according to the water level this flexibility is conducted with benefit of installation near to the surface of water and the fixation at the rocks on the small islands in these zones with easily access 2 methodology by using the sliding mesh model smm the two dimensional unsteady flow is simulated to consider the physics of rotor rotation effects a double check on convergence is accomplished the first convergence criterion is depending on the torque coefficient c m as a global convergence criterion each simulation ends when the difference between the values of the torque coefficient c m shows a deviation of less than 1 compared with equivalent values of the previous periods after the fulfillment of the last criterion of convergence a further convergence check of residuals is set to 10 5 with a maximum number of iterations of 200 as 6 iterations per time step of 2π per revolution each simulation showed that it may require from 5 up to 15 cycles to reach the quasi steady state the initiate of the correct flow solution is carried out in the first cycle while the flow characteristics especially the power coefficient c p and the torque coefficient c m are calculated by averaging the results during the last two cycles the current investigation with maximum sub iterations of 200 to initiate the solution convergence at each time step is used a rectangular flow domain with suitable dimensions is adopted while the ratio between the sides flows domain length 45 and width with 25 the rotor diameter as shown in fig 7 ramadan et al 2018 el baz et al 2015 an unstructured grid consists of triangular and quadratic elements is adopted for both fixed and rotating flow domains as drawn in fig 8 the near wall region can be divided into three sub layers the viscous sub layer the buffer layer and the fully turbulent layer the unstructured grids are substantially increased in the vicinity of wall boundaries in order to get a normalized wall distance y 30 keeping y 30 makes the usage of wall functions is a must this is achieved by employing 15 boundary layers with a growth rate of 1 2 on all wall surfaces i e turbine shaft and its blades for open savonius turbine constant inlet velocity is used the simulation and it equals 0 5 m s as water current and retained constant in all simulations symmetry boundary conditions are imposed on both boundary streamlines i e normal derivatives of dependent variables are zero as appeared in fig 7 the interface boundary condition is used on the circumference of the rotating zone to keep the continuity in the flow field 3 results and discussion 3 1 validation of the model a numerical model for savonius of two blades is conducted with the same dimension as in el baz and et al el baz et al 2015 the flow field is solved by utilizing the unsteady flow with sliding mesh model smm which is recommended for rotating zones el baz et al 2015 this model is solved numerically by the commercial finite volume solver ansys fluent to get the torque coefficient and the power coefficient on the turbine blades the model is chosen to have the same dimension and the same configuration as in el baz and et al el baz et al 2015 therefore it can be validated easily with their turbine and with the experimental measurements for the same dimension and design for other articles as presented in table 2 the geometrical and design parameters are with a schematic description in figs 7 8 there are two parameters that have an influence on the performance of any turbine the torque coefficient cm and the power coefficient cp which are written as follows 3 c m t 0 5 ρ u w 2 a r where t is the average aerodynamic torque acting on the rotor shaft ρ is the density of the water uw is the approaching water speed a is the frontal area of the turbine and finally r is the rotor radius 4 c p t ω 0 5 ρ u w 3 a ω is the angular speed of the rotor the tip speed ratio λ of the turbine is defined as 5 λ r ω u w equation 4 can be rewritten as follows 6 cp λ cm these terms of power and torque coefficients are calculated at different reynolds s numbers based on the approaching water speed uw with kinematic viscosity υ and d is the blade diameter 7 re d ρ u w υ table 3 indicates the model specifications for the validation sequences according to el baz and et al el baz et al 2015 the realizable k ε model with standard wall function is adopted in the current model k epsilon k ε turbulence model is the most common model used in computational fluid dynamics cfd to simulate mean flow characteristics for turbulent flow conditions it is a two equation model that gives a general description of turbulence by means of two transport equations pdes the main references on this model are described by jones and launder 1972 and launder and sharma 1974 the original impetus for the k epsilon model was to improve the mixing length model as well as to find an alternative to algebraically prescribing turbulent length scales in moderate to high complexity flows https en wikipedia org wiki k epsilon turbulence model bardina et al 1997 the k ε model has been tailored specifically for planar shear layers https en wikipedia org wiki k epsilon turbulence model cite note 5and recirculating flows this model is the most widely used and validated turbulence model with applications ranging from industrial to environmental flows which explains its popularity it is usually useful for free shear layer flows with relatively small pressure gradients as well as in confined flows where the reynolds shear stresses are most important it can also be stated as the simplest turbulence model for which only initial and or boundary conditions needs to be supplied k ε model also performs satisfactorily in a variety of important cases such as unconfined flows https en wikipedia org wiki k epsilon turbulence model bradshaw 1987 curved boundary layers rotating flows and flows in non circular ducts https en wikipedia org wiki k epsilon turbulence model larsson et al 2011 a set of equations which can be applied to a large number of turbulent applications are versteeg and malalasekera 2007 for turbulent kinetic energy k 8 ρ k t ρ k u i x i x i u t σ k k x i 2 μ t e i j e i j ρ ε for dissipation 9 ρ ε t ρ ε u i x i x j u t σ ε ε x j c 1 ε ε k 2 μ t e i j e i j c 2 ε ρ ε 2 k 10 μ t c μ ρ k 2 ε where constants are c μ 0 09 σ k 1 σ ε 1 3 c 1ε 1 44 c 2ε 1 92 the domain is split into two zones the stationary and rotating zones the stationary zone domain embraces the water velocity inlet pressure outlet and the symmetry sides the suited mesh technique used is obtained in fig 4 near to the turbine blade high intensive mesh zone the enhanced wall function method is applied to ensure the precise resolution of the boundaries layer prediction el baz et al 2015 the wall function approach needs the dimensionless distance of the first grid point from the wall y it is a non dimensional distance based on local cell fluid velocity from the wall to the first mesh node to be greater than 30 this is used to the present work fig 9 illustrates the grid independence test at tip speed ratio equal to 1 with the torque coefficient the grid independency is checked for different cell numbers which ranged from 33000 to 79000 the torque coefficient becomes stable and constant after 45639 cells moreover the time step size is considered as in el baz and et al el baz et al 2015 to validate the model with the same specification as in figs 10 and 11 the present model results show a convincing agreement with the experiments for both power and torque coefficients the performance and the design of the savonius rotor rely on some parameters like the number of blades the number of stages and the geometry of the blades until now there is still no exact theoretical procedure to estimate the performance of the savonius drag rotor the most preferable way of optimizing the different parameters is to perform a number of experiments on different types of rotors in a low speed open test section wind tunnel fig 10 is showing the torque coefficient cm comparison between the present numerical investigations for 2 blades savonius turbine with kamoji et al 2008 re 155000 and hyashi et al hayashi et al 2005 as re 210000 as a result of the convergence appeared in fig 10 and fig 11 between the numerical works with other authors it encourages us to use the numerical model and create a numerical model with s shape to be the hydrokinetic turbine the s shape is used in this type of turbine because of the high performance compared to the conventional savonius turbine ramadan 2016 mohamed et al 2008b the numerical work is showing preliminary outcomes compared to the conventional savonius with two rotors figs 12 and 13 the efficiency of the s shape turbine reaches 18 approximately instead of 12 for conventional savonius this enhancement in power is due to the increase in the lifting force on the blade with highly negative pressure in fig 14 a the hydrokinetic momentum creates a high pressure zone located on the reversed blade of the conventional rotor this high pressure zone affects adversely the reversed rotor blade by a concentrated force fc perpendicular to such blade this force generates an adverse torque that reduces the rotor performance on the other hand the same force fc has been created on the reversed blade of the s shape rotor however according to the designed geometry of the blade the fc is analyzed into two force components drag force component fd and lift force component fl the fd is perpendicular to the tangent of the reversed s shape blade and fl is tangential to the reversed s shape blade as shown in fig 14 b the fd component generates an adverse torque less than that generated on the conventional rotor consequently the net torque generated on the blade increased obviously as shown in fig 12 the novelty of the s shape advanced blade is that only a component of this concentrated force acts in a direction opposing rotor rotation this lift force fl component enhances the power captured by the rotor also the s shape advanced blade has a two low pressure zones rather than the conventional one as shown in fig 14 a and b the novelty of the s shape reversed blade is that only a component of this concentrated force acts in a direction opposing rotor rotation this gives preference to the s shape rotor to capture more power the velocity contours for conventional and s shape rotor blades are shown in fig 15 a and b respectively a very low velocity region exists accompanied by the high pressure zones where the flow becomes semi stagnant and acts as a brake 3 2 numerical analysis of the s shape the numerical model is rebuilt with the s shape turbine with the same dimension of the validated conventional savonius fig 16 illustrates and shows the meshed model and the computational domain with the different boundary conditions of the inlet and outlet of the domain for the s shape the numerical study is performed with a water speed of 0 5 1 2 and 3 m s to investigate the power and torque coefficients and how these speeds influence the performance of the turbine fig 17 is showing the suggested s blade turbine design to get the maximum power as possible from the incident water flow 3 3 numerical results of the s shape fig 18 illustrates the output torque coefficient of the s blade turbine at different tip speed ratios the indicated results in this fig are the usual for this kind of the savonius turbine thus the torque coefficient decreases with an increase in the tip speed ratio fig 18 introduces the power coefficient with the different tip speed ratios at various water flow speed the optimum power coefficient is found at a tip speed ratio of 0 8 which is 24 6 at tip speed ratio 0 8 the flow streamlines are stickier on the blade suction side surface and the separation of the flow is less at this value hence it is considered as the optimum operating performance at turbine maximum speed at this tip speed ratio the blade captured more lifts and drags from the flow with higher value of lift to drag ratio which leads directly to an increase in the power coefficient moreover the pressure variation at this tip speed ratio is more than the other tip speed ratios as shown in fig 19 the increase in the water flow speed increases the power coefficient due to the power stored in the high flow velocity 4 conclusion the current paper investigates the possibility to use the s shape blade for the hydrokinetic turbine to be a stand alone power electric station this model is solved numerically by the commercial finite volume solver ansys fluent to get the torque coefficient and the power coefficient on the turbine blades the proposed location of installation of this kind of turbine is at upper egypt aswan city behind the aswan dam the streamflow velocity at this location is in the range from 1 to 3 m s the most significant findings are summarized as follows the numerical analysis indicates that the s shape blade has the maximum power coefficient of 24 6 for a tip speed ratio 0 8 and streamflow velocity 3 m s the more the streamflow velocity the more the maximum power coefficient at a tip speed ratio of 0 8 the results indicate that the maximum power coefficient of the new design s shape and the conventional design are 18 and 12 8 at the tip speed ratio 0 8 and streamflow velocity 0 5 m s respectively the new design s shape enhance the turbine performance by 40 compared with the conventional design especially at low stream flow velocity these premium results encourage the authors to work more to enhance the efficiency by getting the optimum turbine and efficiency for these locations due to these promising results the main hope of the present work is the spreading of this turbine along the river nile coast in upper egypt for the required development there acknowledgment interesting discussions with eng alaa el feky ceo of blue power company is appreciated by the authors nomenclature cm the torque coefficient cp the power coefficient t the average aerodynamic torque n m ρ the density of the water kg m3 re reynolds number u w the approaching water speed m s a the frontal area of the turbine m2 r the rotor radius m ω the angular speed of the rotor rad s λ the tip speed ratio of the turbine υ kinematic viscosity m2 s d the blade diameter m javil the available power density w m2 jcap the captured power density w m2 u i velocity component m s e i j rate of deformation μ t eddy velocity k turbulence kinetic energy ε rate of dissipation w l fc water line concentrated force n fd drag force n fl lift force n 
22259,river current energy is considered as the greenest energy available as it has enormous energies stored it is a promising energy source in renewable energy due to the accessibility and availability the river nile in egypt has been selected in this work as the case study for this kind of energy the process of hydro kinetic energy conversion utilizes the contained kinetic energy in the river stream which can be extracted by a submerged vertical axis turbine the main objective of this work is to design and simulate a water current stream energy conversion system as a stand alone power station for the electric power generation the generated electric power is intended for rural and domestic applications cfd is used to simulate and redesign a drag turbine the numerical analysis indicates that the s shape blade has the maximum power coefficient of 24 6 for a tip speed ratio 0 8 and streamflow velocity 3 m s the results indicate that the maximum power coefficient of the s shape and the conventional design are 18 and 12 8 respectively at the tip speed ratio 0 8 and 0 5 m s the s shape enhances the turbine performance by 40 compared with the conventional design especially at low velocity keywords river current river nile vertical axis turbine hydro kinetic energy 1 introduction the captured energy from the river stream is being considered as a pivotal source of renewable energy the vertical axis turbine system is considered as a new and an emerging category of renewable energy technology and in remote areas an unconventional solution for electric power production antheaume et al 2008 the water current stream energy wcse conversion system will be considered as the first station conducted in egypt and in the middle east at all the construction of these stations and the prosperity of this type of electric power stations will contribute to the development of upper egypt in many fields like agriculture tourism and industry the main problem is that the ministry of electricity renewable energy at egypt does not have the vision or the strategy for the wave and water current stream energy conversion to generate electric power however this article encourages and introduces this type of renewable energy to draw attention to use it water turbines shapes were born from wind turbines with both types of vertical and horizontal axis turbines antheaume et al 2008 the high performance with high power production is introduced by a smooth linear flow of water at high velocity laskan inc report 2010 the flow features and characteristics of any river stream have some variation seasonal and daily and the installation of the water current turbine should be indeed considered the main feature of the river flow is unidirectional flow and this eliminates the need for yaw adjustments the hydrokinetic converter and the level of power output are directly affected by the water velocity the location and the position of the hydrokinetic device have a relation to the cross section of the flow channel moreover it is a very important and significant component for two essential reasons first depending on the river s bottom depth the energy flux at the surface of the water is stronger than the river s bottom in addition this quantity takes diverse values depending on the distance from the shore in a smooth channel the water current is fastest at the center but in a river this may vary depending on river bathymetry therefore the water velocity has a certain site specific and localized profile where the available amount of energy flux that can be obtained that can be produced depends on the rotor location antheaume et al 2008 second many river users are competing inside the water flow such as boats fishing vessels bridges etc and these might reduce the efficiency and effectiveness of the useable area for a turbine installation laskan inc report 2010 in addition other types of suspended and hanged particles and materials such as rock fish etc in the river verdant power 2006 could also be varying a vertical axis turbine fig 1 is considered for deployment at this location in lieu of a horizontal axis turbine for the following reasons 1 energy flux has a high due at the near of the surface of the river 2 the effect and influence of competing users from fishing and boating are avoided 3 footprint any trenching pilling at the bottom may become subject to the environmental scrutiny 4 the foundation and structure of vertical axis turbine are very low compared to the horizontal axis turbine 5 low cost and high durability 6 the manufacturing of this type especially the s shaped is available locally at egypt blue power co 7 the power production is continuous around the year with just a small adaptation to the water level tutar and veci 2015 investigated the effect of water depths with different wave boundary conditions on the performance of savonius turbine with single and multiple turbine arrays 3 turbines with three various positions of arrays however these arrays were conducted at several distances between them the submersion depth of the turbine blade underwater line had an influence on the rotor performance the rotor was fabricated with three blades each of which is made of a 2 mm aluminum sheet and is bent at a blade angle of 59 the blades were mounted on a 16 0 mm diameter shaft the rotor had a width of w 480 mm and an outer diameter of d 252 mm the submersion level was 5 0 and 5 cm with a rotor diameter of 25 cm they built the experimental model and tested it under a certain condition of water waves they concluded that the three blades rotor with 0 level center of rotor on water surface submersions had a maximum efficiency of 18 compared to 8 at 5 cm on the other side sarma and et al sarma et al 2014 conducted a numerical model of the savonius hydrokinetic turbine drag type moreover they tested it experimentally the experimental work was performed at the water channel with a water speed range from 0 3 to 0 9 m s they compared the produced power output from the same turbine in water and wind showing how the generated output power from water was greater than wind the power ratio between water and wind was calculated to be 61 32 with the turbine otherwise the simulation was done using the cfd program with maximum power coeffiecnt of 9 yaakob and et al yaakob et al 2013 studied the effect of the deflectors on the savonius hydrokinetic turbine inside a duct they had two different designs of deflectors the first one had one deflector and the second had two deflectors as in fig 2 the three dimensional cfd analysis was chosen by the authors to study and investigate the power and torque coefficient the power coefficient is defined as the ratio between the output power from the turbine by torque and angular velocity on the rotor to the incident power from the water stream on the blade according to the velocity of water stream the power coefficient was 0 27 in two deflectors compared to which equals 0 21 for only one deflector this increase in the cp indicated the influence of these deflectors on the whole performance of the savonius hydrokinetic turbine sharma and et al sharma et al 2014 reported the enhancement of the conventional savonius hydrokinetic turbine s efficiency of 21 as a maximum by controlling its design parameters the performance and characteristics of a two stage two bladed configuration of the savonius rotor had been investigated whole experiments had been carried out in a wind tunnel which has low wind speed the studied parameters were the overlap ratio tip speed ratio power coefficient cp and torque coefficient ct as shown and illustrated in fig 3 the study showed that a maximum cp of 0 517 was obtained at 9 37 overlap condition the overlap condition is meant that the both turbines had different installation angle to each other and to the incident air on them schleicher and et al chris schleicher et al 2013 worked numerically as a 3d simulation to generate 500 watt from the water current the turbine had the captured efficiency of 0 45 at a rotor diameter of 0 5334 m with water speed less than 2 2 m s zaidi and et al zaidi et al 2013 investigated the effect of the chord length of the helical blade 3d numerical simulation on the performance of the turbine grolov turbine this study was conducted and carried out by utilizing the commercial code fluent of ansys this investigation was performed by employing the shear stress transport sst k ω model they used the hydrofoil of naca 0012 with rotor radius 0 15 m with chord lengths of 0 006 0 0983 and 0 0988 m the data output from the 3d numerical simulation showed that the maximum cp was 58 at chord length 0 0983 m hantoro and et al hantoro et al 2018 performed an experimental study at an open channel to investigate an innovative design for the darrius type to be a hydrokinetic turbine they compared the convention one with 3 straight blades and two designs with 6 and 9 blades sbc where the swept area was the same for all the power coefficient for the 9 blades design was 0 42 at tsr 2 91 which is the maximum could be reached for the system kumar and sini kumar and saini 2017 carried out enhancement on the performance of the savonius hydrokinetic turbine using cfd analysis the simulation and calculations of the twisted savonius hydrokinetic turbine had been introduced and carried out by the commercial unsteady reynolds averaged navier stokes urans solver in conjunction with a realizable k ε turbulence model it had been found that savonius hydrokinetic turbine having a twist angle of 12 5 which produces an optimum power coefficient equals 0 39 at speed ratio equals to 0 9 with a water velocity of 2 m s it was found that savonius hydrokinetic turbine with a twist angle of 12 5 produces an optimum power coefficient of 0 39 at a tip speed ratio and water velocity of 0 9 and 2 m s respectively as appeared in all the previous work design and shapes of the blades are a very important factor for most of the energy conversion systems by this drag turbine the performance of this type of drag turbines can be substantially improved by employing multi objective optimization with its different techniques like ga or mopso algorithms ramadan et al 2018 mohammadi et al 2018 therefore a lot of authors tried to use multi objective optimization to improve the performance of this turbine actually multi objective optimization is used in improving the drag turbine ramadan et al 2018 mohammadi et al 2018 and the turbo machines in general polat and tuncer 2013 esmaeilzadeh and alam 2019 mengistu and ghaly 2008 samad and kim 2008 haldermohamed and samad 2018 mohamed et al 2008a this paper aims to investigate the ability to install the savonius turbine with s shape at the north of aswan dam aswan city egypt this design is targeting to be an off grid system as a stand alone system of electric power production authors tested this type of turbine numerically and experimentally at different wind speed the final result indicated that the power coefficient was 28 therefore it is encouraged us to use it as a hydrokinetic turbine mohamed et al 2008a the study is performed numerically at different water flow speed according to the selected locations as seen in fig 4 the statistical data of the water speed can be seen in fig 5 sattar and raslan 2014 the data were predicted for 120 days due to the flow rate at these locations as illustrated and shown in fig 6 the available power density javil and captured power density jcap of water flow these parameters are defined as follow 1 javil avilable power rotor area 0 5 ρ uw 3 a jcap javil c p 2 this type of stand alone power system could be the core of development in the rural area in upper egypt due to the simplicity of the turbine in both manufacturing and installation moreover table 1 indicates the average annual water level and velocity at 5 different zones with different in river s widths the flow rate is approximately 250 m3 s according to the study of yasser and radwa raslan and salama 2015 the system is designed to be flexible in level variation according to the water level this flexibility is conducted with benefit of installation near to the surface of water and the fixation at the rocks on the small islands in these zones with easily access 2 methodology by using the sliding mesh model smm the two dimensional unsteady flow is simulated to consider the physics of rotor rotation effects a double check on convergence is accomplished the first convergence criterion is depending on the torque coefficient c m as a global convergence criterion each simulation ends when the difference between the values of the torque coefficient c m shows a deviation of less than 1 compared with equivalent values of the previous periods after the fulfillment of the last criterion of convergence a further convergence check of residuals is set to 10 5 with a maximum number of iterations of 200 as 6 iterations per time step of 2π per revolution each simulation showed that it may require from 5 up to 15 cycles to reach the quasi steady state the initiate of the correct flow solution is carried out in the first cycle while the flow characteristics especially the power coefficient c p and the torque coefficient c m are calculated by averaging the results during the last two cycles the current investigation with maximum sub iterations of 200 to initiate the solution convergence at each time step is used a rectangular flow domain with suitable dimensions is adopted while the ratio between the sides flows domain length 45 and width with 25 the rotor diameter as shown in fig 7 ramadan et al 2018 el baz et al 2015 an unstructured grid consists of triangular and quadratic elements is adopted for both fixed and rotating flow domains as drawn in fig 8 the near wall region can be divided into three sub layers the viscous sub layer the buffer layer and the fully turbulent layer the unstructured grids are substantially increased in the vicinity of wall boundaries in order to get a normalized wall distance y 30 keeping y 30 makes the usage of wall functions is a must this is achieved by employing 15 boundary layers with a growth rate of 1 2 on all wall surfaces i e turbine shaft and its blades for open savonius turbine constant inlet velocity is used the simulation and it equals 0 5 m s as water current and retained constant in all simulations symmetry boundary conditions are imposed on both boundary streamlines i e normal derivatives of dependent variables are zero as appeared in fig 7 the interface boundary condition is used on the circumference of the rotating zone to keep the continuity in the flow field 3 results and discussion 3 1 validation of the model a numerical model for savonius of two blades is conducted with the same dimension as in el baz and et al el baz et al 2015 the flow field is solved by utilizing the unsteady flow with sliding mesh model smm which is recommended for rotating zones el baz et al 2015 this model is solved numerically by the commercial finite volume solver ansys fluent to get the torque coefficient and the power coefficient on the turbine blades the model is chosen to have the same dimension and the same configuration as in el baz and et al el baz et al 2015 therefore it can be validated easily with their turbine and with the experimental measurements for the same dimension and design for other articles as presented in table 2 the geometrical and design parameters are with a schematic description in figs 7 8 there are two parameters that have an influence on the performance of any turbine the torque coefficient cm and the power coefficient cp which are written as follows 3 c m t 0 5 ρ u w 2 a r where t is the average aerodynamic torque acting on the rotor shaft ρ is the density of the water uw is the approaching water speed a is the frontal area of the turbine and finally r is the rotor radius 4 c p t ω 0 5 ρ u w 3 a ω is the angular speed of the rotor the tip speed ratio λ of the turbine is defined as 5 λ r ω u w equation 4 can be rewritten as follows 6 cp λ cm these terms of power and torque coefficients are calculated at different reynolds s numbers based on the approaching water speed uw with kinematic viscosity υ and d is the blade diameter 7 re d ρ u w υ table 3 indicates the model specifications for the validation sequences according to el baz and et al el baz et al 2015 the realizable k ε model with standard wall function is adopted in the current model k epsilon k ε turbulence model is the most common model used in computational fluid dynamics cfd to simulate mean flow characteristics for turbulent flow conditions it is a two equation model that gives a general description of turbulence by means of two transport equations pdes the main references on this model are described by jones and launder 1972 and launder and sharma 1974 the original impetus for the k epsilon model was to improve the mixing length model as well as to find an alternative to algebraically prescribing turbulent length scales in moderate to high complexity flows https en wikipedia org wiki k epsilon turbulence model bardina et al 1997 the k ε model has been tailored specifically for planar shear layers https en wikipedia org wiki k epsilon turbulence model cite note 5and recirculating flows this model is the most widely used and validated turbulence model with applications ranging from industrial to environmental flows which explains its popularity it is usually useful for free shear layer flows with relatively small pressure gradients as well as in confined flows where the reynolds shear stresses are most important it can also be stated as the simplest turbulence model for which only initial and or boundary conditions needs to be supplied k ε model also performs satisfactorily in a variety of important cases such as unconfined flows https en wikipedia org wiki k epsilon turbulence model bradshaw 1987 curved boundary layers rotating flows and flows in non circular ducts https en wikipedia org wiki k epsilon turbulence model larsson et al 2011 a set of equations which can be applied to a large number of turbulent applications are versteeg and malalasekera 2007 for turbulent kinetic energy k 8 ρ k t ρ k u i x i x i u t σ k k x i 2 μ t e i j e i j ρ ε for dissipation 9 ρ ε t ρ ε u i x i x j u t σ ε ε x j c 1 ε ε k 2 μ t e i j e i j c 2 ε ρ ε 2 k 10 μ t c μ ρ k 2 ε where constants are c μ 0 09 σ k 1 σ ε 1 3 c 1ε 1 44 c 2ε 1 92 the domain is split into two zones the stationary and rotating zones the stationary zone domain embraces the water velocity inlet pressure outlet and the symmetry sides the suited mesh technique used is obtained in fig 4 near to the turbine blade high intensive mesh zone the enhanced wall function method is applied to ensure the precise resolution of the boundaries layer prediction el baz et al 2015 the wall function approach needs the dimensionless distance of the first grid point from the wall y it is a non dimensional distance based on local cell fluid velocity from the wall to the first mesh node to be greater than 30 this is used to the present work fig 9 illustrates the grid independence test at tip speed ratio equal to 1 with the torque coefficient the grid independency is checked for different cell numbers which ranged from 33000 to 79000 the torque coefficient becomes stable and constant after 45639 cells moreover the time step size is considered as in el baz and et al el baz et al 2015 to validate the model with the same specification as in figs 10 and 11 the present model results show a convincing agreement with the experiments for both power and torque coefficients the performance and the design of the savonius rotor rely on some parameters like the number of blades the number of stages and the geometry of the blades until now there is still no exact theoretical procedure to estimate the performance of the savonius drag rotor the most preferable way of optimizing the different parameters is to perform a number of experiments on different types of rotors in a low speed open test section wind tunnel fig 10 is showing the torque coefficient cm comparison between the present numerical investigations for 2 blades savonius turbine with kamoji et al 2008 re 155000 and hyashi et al hayashi et al 2005 as re 210000 as a result of the convergence appeared in fig 10 and fig 11 between the numerical works with other authors it encourages us to use the numerical model and create a numerical model with s shape to be the hydrokinetic turbine the s shape is used in this type of turbine because of the high performance compared to the conventional savonius turbine ramadan 2016 mohamed et al 2008b the numerical work is showing preliminary outcomes compared to the conventional savonius with two rotors figs 12 and 13 the efficiency of the s shape turbine reaches 18 approximately instead of 12 for conventional savonius this enhancement in power is due to the increase in the lifting force on the blade with highly negative pressure in fig 14 a the hydrokinetic momentum creates a high pressure zone located on the reversed blade of the conventional rotor this high pressure zone affects adversely the reversed rotor blade by a concentrated force fc perpendicular to such blade this force generates an adverse torque that reduces the rotor performance on the other hand the same force fc has been created on the reversed blade of the s shape rotor however according to the designed geometry of the blade the fc is analyzed into two force components drag force component fd and lift force component fl the fd is perpendicular to the tangent of the reversed s shape blade and fl is tangential to the reversed s shape blade as shown in fig 14 b the fd component generates an adverse torque less than that generated on the conventional rotor consequently the net torque generated on the blade increased obviously as shown in fig 12 the novelty of the s shape advanced blade is that only a component of this concentrated force acts in a direction opposing rotor rotation this lift force fl component enhances the power captured by the rotor also the s shape advanced blade has a two low pressure zones rather than the conventional one as shown in fig 14 a and b the novelty of the s shape reversed blade is that only a component of this concentrated force acts in a direction opposing rotor rotation this gives preference to the s shape rotor to capture more power the velocity contours for conventional and s shape rotor blades are shown in fig 15 a and b respectively a very low velocity region exists accompanied by the high pressure zones where the flow becomes semi stagnant and acts as a brake 3 2 numerical analysis of the s shape the numerical model is rebuilt with the s shape turbine with the same dimension of the validated conventional savonius fig 16 illustrates and shows the meshed model and the computational domain with the different boundary conditions of the inlet and outlet of the domain for the s shape the numerical study is performed with a water speed of 0 5 1 2 and 3 m s to investigate the power and torque coefficients and how these speeds influence the performance of the turbine fig 17 is showing the suggested s blade turbine design to get the maximum power as possible from the incident water flow 3 3 numerical results of the s shape fig 18 illustrates the output torque coefficient of the s blade turbine at different tip speed ratios the indicated results in this fig are the usual for this kind of the savonius turbine thus the torque coefficient decreases with an increase in the tip speed ratio fig 18 introduces the power coefficient with the different tip speed ratios at various water flow speed the optimum power coefficient is found at a tip speed ratio of 0 8 which is 24 6 at tip speed ratio 0 8 the flow streamlines are stickier on the blade suction side surface and the separation of the flow is less at this value hence it is considered as the optimum operating performance at turbine maximum speed at this tip speed ratio the blade captured more lifts and drags from the flow with higher value of lift to drag ratio which leads directly to an increase in the power coefficient moreover the pressure variation at this tip speed ratio is more than the other tip speed ratios as shown in fig 19 the increase in the water flow speed increases the power coefficient due to the power stored in the high flow velocity 4 conclusion the current paper investigates the possibility to use the s shape blade for the hydrokinetic turbine to be a stand alone power electric station this model is solved numerically by the commercial finite volume solver ansys fluent to get the torque coefficient and the power coefficient on the turbine blades the proposed location of installation of this kind of turbine is at upper egypt aswan city behind the aswan dam the streamflow velocity at this location is in the range from 1 to 3 m s the most significant findings are summarized as follows the numerical analysis indicates that the s shape blade has the maximum power coefficient of 24 6 for a tip speed ratio 0 8 and streamflow velocity 3 m s the more the streamflow velocity the more the maximum power coefficient at a tip speed ratio of 0 8 the results indicate that the maximum power coefficient of the new design s shape and the conventional design are 18 and 12 8 at the tip speed ratio 0 8 and streamflow velocity 0 5 m s respectively the new design s shape enhance the turbine performance by 40 compared with the conventional design especially at low stream flow velocity these premium results encourage the authors to work more to enhance the efficiency by getting the optimum turbine and efficiency for these locations due to these promising results the main hope of the present work is the spreading of this turbine along the river nile coast in upper egypt for the required development there acknowledgment interesting discussions with eng alaa el feky ceo of blue power company is appreciated by the authors nomenclature cm the torque coefficient cp the power coefficient t the average aerodynamic torque n m ρ the density of the water kg m3 re reynolds number u w the approaching water speed m s a the frontal area of the turbine m2 r the rotor radius m ω the angular speed of the rotor rad s λ the tip speed ratio of the turbine υ kinematic viscosity m2 s d the blade diameter m javil the available power density w m2 jcap the captured power density w m2 u i velocity component m s e i j rate of deformation μ t eddy velocity k turbulence kinetic energy ε rate of dissipation w l fc water line concentrated force n fd drag force n fl lift force n 
