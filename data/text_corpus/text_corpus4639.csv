index,text
23195,the commercialisation of wave energy converters wecs is certain to require the deployment of multiple units in arrays the collocation of wec units into an array will lead to hydrodynamic interactions collectively referred to as array effects understanding these effects is important for successful developments concerning energy capture and government approval to better understand array effects physical experiments and numerical modelling can be completed prior to field deployments this work explores utilising the reflections from walls to simulate array effects including the application and assessment of stereo videogrammetry for experiments and numerical modelling with nemoh a linear potential flow solver the investigation uses a cylinder fixed in the centre of a wave flume to simulate wave scattering a component of the hydrodynamics of wecs the stereo videogrammetry method uses small buoyant wax particles so that the free surface can be mapped with software from lavision it is shown that the stereo videogrammetry approach applied is able to accurately measure water waves however there are challenges associated to higher steepness waves and the resulting drift of surface particles both the experimental and numerical investigations show great potential in the use of wall reflections to model array effects and correlate well keywords method of images wec array effects stereo videogrammetry linear potential flow nemoh nomenclature a wave amplitude m k wavenumber rad m t time s η surface elevation m η d diffracted wave m θ wave direction rad ω angular frequency rad s 1 introduction there are many types of wec operating principles in a range of stages of development around the world common examples include point absorbers oscillating water columns or wave surge converters babarit et al 2012 irrespective of device operating principle it is intrinsic that any deployment of a wecs will cause a variation in the natural wave field owing to both the presence of a structure in the water and the energy conversion process a single wec with a capacity on the order of 100kw 1mw will have only limited effect on the surrounding wave field however if wave energy is to be a notable contributor to the world s energy needs then wecs must be deployed in arrays of devices or in wec farms the deployment of an array of devices increases the importance of the wave field variation with the introduction of intra array effects and exacerbation of extra array effects collectively referred to as array effects folley et al 2012 stratigaki 2014 intra array interactions are those that relate how the variation of the wave climate caused by one device will affect the performance of any other device in close proximity to it these interactions will affect the power conversion of individual wecs with the potential to either increase or decrease power capture babarit 2013 extra array effects are the variations of the natural wave field surrounding the array of wecs oceans waves are an important physical process in the near shore and coastal zones responsible for maintaining coastal sediment budgets shoreline position through erosional accretion processes and the level of energy is a key characteristic of an ecosystem warner et al 2010 furthermore in some locations waves provide opportunities for surfing which can provide an important economic stimulus for a region lazarow et al 2007 thus an important consideration before widespread deployment of wec arrays is to understand the effects of deployment on the surrounding natural wave field via extra array effects the two primary physical processes that cause these array effects are wave scattering and the radiated wave wave scattering includes diffraction and reflection effects that are induced when subjecting a stationary structure to incident waves the radiation problem refers to energy transferred to water by a structure moving wec development has now progressed to the point where small arrays of wecs are being deployed in situ for example carnegie clean energy ltd formerly carnegie wave energy ltd deployed an array of three of their proprietary ceto 5 units each rated at 240 kw during the year 2015 as part of the perth wave energy project fiévez and sawyer 2015 concurrent to this deployment contardo et al 2017 conducted with a sparse array of measurement equipment to measure attenuation this work observed a 20 reduction in wind sea height 40 m down wave of a single wec and a 12 reduction at 80 m this activity and those similar provides a valuable opportunity to learn how the natural wave field responds however measuring variation of a natural wave field in situ is exposed to many factors that makes it more difficult to quantify the effect of the wec array particularly when the array is small an idealised setting such as can be defined in a wave basin or a wave flume provides opportunity to measure the attenuation of idealised waves surrounding an array of scaled wecs an alternative to physical testing is numerical modelling however numerical array modelling is not yet fully validated testing and modelling have the potential to provide valuable information to facilitate future commercial scale array deployments experimental investigation into array effects is in a phase of rapid development a summary of the current development of the experimental measurement of wec array effects is given by o boyle et al 2017 in brief experiments have consisted of measuring the variation in the wave field at point locations up and down wave of small arrays of wave energy converters alexandre et al 2009 haller et al 2011 payne 2008 porter 2012 stratigaki 2014 these works all identified a requirement for further spatial information on the variation of the wave field the work by o boyle et al 2017 sought to rectify this by collecting data over an area of 4 65 m by 5 1 m with a data resolution 150 mm this was accomplished by an array of 32 wave gauges with a spacing of 150 mm spread laterally across the experimental area recordings were made at one transverse plane prior to the measurement array being progressed 150 mm this approach requires an express assumption of repeatability mcnatt et al 2015 completed a study where 59 wave gauges were deemed necessary only 22 wave gauges could be recorded on any single run thus every experimental condition required a minimum of three runs this approach requires an assumption of repeatability the approach by black 2014 saw a novel alternative to wave gauges with stereo videogrammetry used to map the free surface in three dimensions the approach saw the water seeded with a glass based material that allowed cameras to discern the free surface a calibration process is used where the pixel coordinates between two cameras 4 variables are transposed to three dimensional space to achieve the goal of measuring array effects all the aforementioned studies completed work in wave basins where as much as possible effects from the basin walls were minimised or excluded from the study more recently work by penesis et al 2016 applied the software davis surface flow lavision 2015 which is capable of completing the necessary processing for stereo videogrammetry as discussed above the typical approach to measurement of array effects is to deploy small arrays of wecs for this the applicable number of models is required and access to a sufficiently large hydrodynamic wave basin consequentially costs increase rapidly as size of array increases with respect to both number of devices and scale the method of images is a concept whereby it is assumed a structure placed in a channel and subjected to incident waves is analogous to a row of the same structure of infinite width the concept has been applied extensively within linear wave theory to the diffraction problems of both electromagnetics and water wave theories butler and thomas 1993 dalrymple et al 1989 thomas 1991 in the field of hydrodynamics the historical intent has tended towards experimental testing in towing tank facilities thomas 1991 the goal being to allow for prediction of open water hydrodynamic characteristics as opposed to experimental measurements which include sidewall effects the method of images as applied to water waves was first applied by spring and monkmeyer 1975 the theory states that a single cylinder located between two parallel vertical walls is analogous to a row of cylinders with infinite width as is visually depicted in fig 1 the theory is based on the assumption that the walls are perfect reflectors and are parallel to the direction of propagation of the incident wave the same concept has also been applied to a viscous problem by zurcher 2015 where a catamaran demi hull was run alongside a towing tank wall where the positioning was such that the wall is at the analogous vessel centreline there are a number of numerical modelling techniques which are available to investigate array effects with detailed reviews available from folley 2016 folley et al 2012 at present there is no single best approach for the numerical modelling of wec array effects with a trade off required between computational expense and accurate representation of physical phenomena techniques such as spectral wave boussinesq and mild slope models are approaches that suit modelling wave propagation but none is capable of modelling the hydrodynamics of wecs an improvement of this are non hydrostatic wave flow models rijnsdorp et al 2017 to include device hydrodynamics approaches based on potential flow or computational fluid dynamics need be applied a common approach is to use linear potential flow theory with boundary element method bem to solve commercial examples are wamit lee 1995 and ansys aqwa ansys 2012 while babarit and delhommeau 2015 released an open source solver nemoh due to the recent release of this code very little work has been completed on validation a common approach to modelling wave structure interactions is to apply potential flow theory folley et al 2012 general potential flow theory assumes the fluid is inviscid and incompressible and the flow is irrotational these assumptions lead to a set of non linear equations it is possible to linearise these equations and reduce computational expense by assuming small amplitudes of waves and body motion as well as structures and the sea floor being impermeable with the problem linearised it is possible to solve the calculations in the frequency domain this three dimensional problem is transformed into a two dimensional problem with the application of green s second identity and an appropriate green s function the two dimensional domain is defined by discretising the structure wetted surface into a series of panels this study shall use the open source code nemoh initially released by ecole centrale nantes in 2014 the specific formulation of the solution is given by babarit and delhommeau 2015 this work aims to test the concept of using the method of images to simulate array effects of wecs we apply stereo videogrammetry to measure the response of the free surface to a fixed cylinder in a towing tank subjected to regular waves including an assessment of the measurement accuracy of stereo videogrammetry the fixed cylinder represents a highly simplified wec in addition a comparison with predictions from nemoh aim to contribute the validation of this open source code 2 method 2 1 experimental approach 2 1 1 setup experiments were conducted in the university of tasmania in the australian maritime college s towing tank the facility dimensions are 100 m long by 3 55 m wide with an operational water depth of 1 5 m the tank has a single hinged paddle wave maker at one end and a beach at the other the model setup consists of a fixed cylinder of 315 mm diameter by 1 8 m height which is positioned on the tank centreline 20 m from the wave maker running vertically from 100 mm above the tank floor to above the free surface the cylinder is fixed at the bottom and is fitted with two normally opposed load cells above the free surface so as to measure the pitch and roll moments about the bottom fixing fig 2 in order to assess the stereo videogrammetry measurements an array of eleven wave probes were deployed as depicted in fig 2 right an assumption of symmetry about the cylinder was made such that comparisons between the stereo videogrammetry and wave gauges can be made this assumption is required as the cameras require a clear field of view for measurement the stereo videogrammetry technique applied consisted of two machine vision cameras the cameras used were two baser ace 12 bit 4 megapixel usb3 cameras each fitted with a kowa 6 mm lm6hc 1 5 edmund optics lens extender and c mount orange longpass fiter midopt lp550 25 4 they were mounted in conjunction with five ultraviolet light sources as shown in fig 3 the ultraviolet lights stage spotlights were reflected off the roof to create a diffused light field over the water surface images were captured in synchronised image pairs from the two cameras at 25 hz in order for the water surface to be discernible it was seeded with fluorescent wax particles these particles are a composition of paraffin wax carnauba wax and a pigment at proportions of 90 7 5 and 2 5 by mass respectively the pigment causes the particles to fluoresce orange when subjected to ultraviolet light the targeted particle size was 5 5x1 mm this constitutes roughly 3 3 pixels in the photos for this experimental setup in order to minimise the amount of particles required a wave transparent fence was positioned both up and down wave of the setup the experimental condition can be seen in fig 2 left wave conditions investigated experimentally are amplitudes 25 mm 50 mm and 100 mm frequencies 0 25 hz 0 3 hz 0 4 hz 0 5 hz 0 6 hz 0 7 hz 0 8 hz 0 9 hz and 1 0 hz 2 1 2 stereo videogrammetry stereo photogrammetry is a process in which photographic images are used as a basis for measurement sorensen 1968 gives a description of the process as applied to hydrodynamic research although it should be noted there are numerous changes with the advent of digital photography as is outlined one of the key challenges is surface detection in hydrodynamic facilities the water is typically very clean and the bottom as such is clearly visible in such situations it is required to seed the water such that the free surface is clearly discernible black 2014 gives a description on the process as extended to videogrammetry for hydrodynamic interactions the same challenges relating to surface detection continue to exist the measurement accuracy of stereo videogrammetry has the capacity to relate well with wave gauges sorensen 1968 claims that there is a capacity to match or exceed the precision relative to wave gauges while black 2014 in a quantitative comparison of average wave height with wave gauges found errors to be in the range of 1 8 45 2 from eleven samples 2 1 3 calibration and data processing the calibration process for davis surface flow lavision 2015 requires a series of images be taken with different views of a calibration plate the calibration plate used was 2 4 m 2 4 m white in colour with an array of black dots 50 mm spacing 10 mm diameter the calibration plate was mounted on a polystyrene sheet such that it could be floated in the experimental area the plate sitting 49 mm above the water free surface the images for the calibration were taken by keeping the relative position of the cameras fixed while moving the cameras relative to the calibration plate examples of one image set is given in fig 4 two sets were used for the calibration once the calibration is complete it is important that the camera settings are not altered this includes aperture focus and relative position the resulting calibration coefficients are given in table 1 the videogrammetry method requires the free surface be seeded with particles the image on the left in fig 5 gives a sample of a raw image the particle density seen is about the minimum required for this porcess to be succesful the ouput from davis used in this work is the surface height the top right image in fig 5 presents a sample for an instant where the surface is still it can be seen that there is a variance of 10 mm across the surface there are also localised discontinuities which indicate a sharp jump in the surface elevation these discontinuites are processing error in the digital image correlation and are symptomatic of insufficient particle seeding to account for the variance in height we subtract the known zero level from the recorded level for every frame exported from davis to address the localised discontinuities we recall that free surface elevation is defined by 1 where η is the surface elevation a is the wave amplitude k is the wave number θ is the wave direction ω is the angular frequency and t is time 1 η x y a cos k x cos θ y sin θ ω t it can be shown from this that the maximum of the absolute of the gradient can be expressed by 2 2 max η x y k a the experimental waves are unlikely to adhere to linear theory thus we relax this condition to include a factor of safety of two given this it is assumed any region bound by high localised steepness η x y 2 k a is erroneous the area around these errors are dilated by 4 pixels to better eliminate the residual error the surface gradient components are computed by the matlab functions gradient abs and angle the holes are then filled from the outer most pixels with the use of the matlab function regionfill the filling process computes the discrete laplacian over the region and solves the dirichlet boundary value problem the resulting post processed surface from the raw zero elevation discussed earlier is presented in the bottom right of fig 5 the davis processing was completed on a pc with 64 gb ram and with two intel xeon e5 2630v2 cpu which results in 24 logical processors 2 6 ghz processing speed this setup resulted in processing times of roughly 10 s per frame the post davis processing error removal was completed on a machine with 16 gb ram with an intel core i7 4770 cpu with 8 logical processors 3 4 ghz processing speed post processing takes approximately 2s per frame raw data volume is 3 5 mb per frame and processed totals 10 mb per frame surface elevations measured by the wave gauges were compared with elevations for the equivalent location determined from the processed surface data performance metrics used to assess performance of the method for each wave gauge for each experiment include the instantaneous absolute and relative errors as defined by equations 3 and 4 respectively 3 absolute error t wave gauge t surface measurement t 4 relative error t wave gauge t surface measurement t wave amplitude and the root mean square error of each is defined by equation 5 where error is either the relative or absolute error 5 r m s e e r r o r t 2 for the comparison between stereo videogrammetry and nemoh a butterworth band pass filter was applied the band used was 0 1 1 2 hz 2 2 numerical model nemoh is an open source linear potential flow solver which applies boundary element method a detailed description of the modelling procedure is given by babarit and delhommeau 2015 or on the website lheea 2017 the modelling completed in this work was accomplished with matlab wrappers based upon those downloadable with the code 2017 modifications relate to modelling arrays and activating the surface post processing four scenarios were considered with nemoh these are illustrated in fig 6 and include a a single cylinder b three cylinders c five cylinders and d a method of images simulation all modelling in this study was completed with the assumption of symmetry about y 0 for modelling method of images a reflective wall is positioned as per the physical tank wall the water depth considered is 1 5 m and wave frequencies in the range of 0 2 hz 1 2 hz mesh convergence was completed with the characteristics selected given in table 2 the outputs from nemoh that have been used are the pitch excitation moment and the free surface the free surface used for comparison with the stereo videogrammetry is discretised into 4000 points 200 by 200 over an area 3 5 m by 3 5 m the time domain free surface expression for the nemoh is given 6 for a single frequency component a is the incident wave amplitude k is the wave number x and y are the position on the surface ω is the angular frequency t is time η d is the normalised diffracted wave amplitude and η d is the phase angle of the diffracted wave field 6 η x y t a ℜ e i k x cos θ y sin θ ω t η d x y e i η d x y ω t 3 results 3 1 stereo videogrammetry free surface 3 1 1 measurement accuracy the comparison between the wave gauges and the stereo videogrammetry is one of importance due to the relative novelty of the stereo videogrammetry approach all experimental results presented are for a setup with the cylinder located in the wave flume a time domain comparison for a wave with frequency 0 9 hz and amplitude 25 mm for wp 10 is given in fig 7 the top plot is an overlay of the two approaches and bottom presents the relative and absolute errors for this condition it is clear that there is very good agreement with only slight discrepancies around the crests and troughs a similar comparison is made in fig 8 except the condition has a frequency of 1 0 hz and amplitude 50 mm and location wp 06 these plots indicate that for the period of t 0 10 s indicate a similar accuracy to the previous run considered following this errors increase with a major discrepancy at 12 5 s this error is due to an entire time step failing to compute correctly the accuracy returns until 15 s at which point errors increase until the processing completely fails at 22 s these increasing errors and eventual failure to compute have been attributed to the particles being dispersed by a nonlinear drift effects extending the investigation from the two runs given above to all test conditions the rmse is compared with wave steepness in fig 9 the conditions ranged in frequency from 0 25 hz to 1 0 hz and amplitude from 25 mm to 100 mm wave steepness is used for the comparison as rmse varies with both the wave frequency and amplitude the left plot shows a comparison between the rmse of each run and the wave steepness while the right shows the processing failure rate and the total number of frames capture compared to wave steepness the wave steepness is that which was measured through phase averaging experimental results as opposed to requested from these plots it is clear that for low steepness wave s stereo videogrammetry is gives low error opposed to wave gauges and there is a very low risk of failure to process the results a caveat to this is in close proximity to the cylinder errors are larger the location closest to the cylinder wp 04 routinely exhibits the largest error for a run this is thought to be a result of higher nonlinearities in this region causing high drift resulting in fewer particles for the digital image correlation errors increase however as wave steepness increases furthermore the processing failure rate increases beyond 40 as steepness increases above 0 2 as highlighted above with fig 8 this is not due to the inability of davis to operate in these conditions it is a result of the seeded particles being swept away from the experimental area 3 1 2 surface data here we focus the result on the condition with an incident wave of frequency 0 9 hz and amplitude 50 mm this is presented in fig 10 and fig 11 a supplementry video related to these can be found at https doi org 10 1016 j oceaneng 2018 06 033 the phase averaged measured wave steepness is 0 17 which suggests an error of 5 10 compared to wave gauges from the investigation above the following is the supplementary data related to this article video 1 incident wave with 0 9hz frequency 0 05m wave amplitude the top plot shows the free surface elevation bottom left the free surface gradient magnitude and the bottom right the free surface gradient direction 1 video 1 fig 10 presents a sequence of five frames spaced evenly from just prior to when the developed incident wave front first hits through to when the first wave reflected from the diffraction field returns the data presented consist of the free surface on the left the gradient magnitude in the centre and gradient direction on the right the gradient magnitude is expressed in proportion of wave steepness and direction is aligned with the centreline in the first frame it can be seen that the initial wave has not yet struck however a very small part of the diffracted field is evident slightly up wave of the cylinder formed by the ramp up waves in the second frame as the incident wave has passed a clear scattered wave is evident especially in the gradient plots as time passes the scattered wave field is seen to develop with a reflection of the scattered wave apparent in the fifth frame on the gradient plot it is interesting to note through the data that the scattered waves are much more evident in the gradient plots as apposed the free surface plot and that the scattered waves have a shorter wavelength than the incident waves one concern in these plots is the radiated wave evident in the gradient plots in the top right corner 1300 mm 1500 mm from the third frame onward this radiated wave has been attributed to a small buoy used to connect the conceptually transparent particle fence to the tank wall the floats four used throughout the setup had mass of approximately 400 g and diameter 100 mm furthermore it can be observed that the region directly in the lee of the cylinder has increased errors as the run progresses this is the result of non linear drift forces causing the particles to disperse fig 11 shows the progression of the wave following from fig 10 the development of the scattered wave field is more evident the time period shown corresponds to the second order of interaction the hole in the lee of the cylinder is yet more evident as is the radiated wave from the fence in the top left corner of the frame as the run progresses errors increase evidenced by the larger hole and increased number of reconstruction errors squares this failure to process the surface can be attributed to high particle drift as a result of high steepness causing davis to fail to find correlation between the two raw images in other runs not shown successfully processed for the full capture period a correlation was experienced between successful processing and reduced wave steepness 3 2 free surface modelling from nemoh as with the stereo videogrammetry measurement the results presented are focused on waves with a frequency of 0 9 hz with an amplitude of 50 mm where relevant the results presented are for a single cylinder in fig 12 for three cylinders in a row in fig 13 five cylinders in a row in fig 14 and for the infinite case in fig 15 all figures show the same area as the stereo videogrammetry from the centreline of the tank to the wall the same format is applied across all four figures with the top two plots giving the frequency domain results consisting of the amplitude on the left and the phase angle on the right below on the bottom are an instance in the time domain with the elevation on the left surface gradient magnitude in the centre and surface gradient direction on the right the frequency domain surface components generated by nemoh show a convergence towards method of images as the number of cylinders vary from a single cylinder through to an infinite row key indicators to this is the variation in the amplitude with the localised zero region developing from 1 5 1 0 extending in the wave direction around to the lee of the structure similarly the time domain modelling is barely distinguishable after more than one cylinder is present with only slight changes to the peaks and troughs occurring it is interesting to note that the gradient plots gives the illusion that the incident wave is slightly oblique this is not the case but in fact a coincidence for this time step an extended time series of all four scenarios are can be found at https doi org 10 1016 j oceaneng 2018 06 033 where two wave periods are shown the following is the supplementary data related to this article video 2 nemoh free surface modelling first column is free surface elevation second column is magnitude of the free surface gradient and third column is direction of free surface gradient single cylinder second row three cylinders third row five cylinders forth row cylinder and wall 2 video 2 3 3 comparison between nemoh and videogrammetry a comparison between stereo videogrammetry and nemoh is now made for this comparison the stereo videogrammetry had a band pass filter applied to remove non first order diffraction effects fig 16 and fig 17 respectively present a single time step for a 0 4 hz and 0 9 hz incident wave both are with a 25 mm incident wave amplitude extended studies are presented in video format at https doi org 10 1016 j oceaneng 2018 06 033 for 0 4 and 0 9 hz respectively the following is the supplementary data related to this article video 3 a comparison between stereo videogrammetry measurement and nemoh modelling for an incident wave with 0 4 hz frequency and 25 mm amplitude steepness 0 0195 with t 0 when the first wave arrived at the cylinder top row stereo videogrammetry bottom row nemoh modelling for cylinder and wall case left column free surface elevation middle column free surface gradient magnitude right column free surface gradient amplitude 3 video 3 the following is the supplementary data related to this article video 4 a comparison between stereo videogrammetry measurement and nemoh modelling for an incident wave with 0 9 hz frequency and 25 mm amplitude steepness 0 0815 with t 0 when the first wave arrived at the cylinder top row stereo videogrammetry bottom row nemoh modelling for cylinder and wall case left column free surface elevation middle column free surface gradient magnitude right column free surface gradient amplitude 4 video 4 this qualitative comparison indicates that for the first order wave components there is very good agreement between the two methods for low steepness waves as is shown by fig 9 the stereo videogrammetry begins to break down as steepness increases the same is true with nemoh which includes the assumption that wave amplitude is small relative to the wavelength 3 4 excitation moment the experimentally measured excitation moments are compared with the four nemoh simulations in fig 18 the numerical simulations are completed in the frequency domain so are for an infinite time period and are normalised by wave amplitude the experimental measurements are the result of phase averaging over the experimental period this period is defined as the period from when the wave arrives at the structure to when the reflection from the beach arrives as such the experimental period is subjective on the celerity of the condition the experimental waves presented include runs with amplitude 25 and 50 mm the excitation moments are normalised by the incident wave amplitude the four nemoh simulations indicate the importance of multiple bodies for wec intra array effects further to this it is important to recall the relationship between computation time and number of panels comparing the numerical predictions with the experimental measurements it is difficult to discern a distinction such that it is possible to comment on the applicability of method of images while the general trend and magnitudes align there is more in common between the numerical predictions than the experimental measurements 4 discussion stereo videogrammetry proposes an interesting prospect for the measurement of wave field effects as compared to using large arrays of wave gauges the investigation into the measurement precision suggests that the technique used here floating wax flakes as surface markers is primarily suited to low wave steepness investigations the physical reason for this is that the approach requires that sufficient particles be on the free surface for the digital image correlation in non linear waves there is a drift component to the waves which transports the particles away from the area of investigation this drift of the particles causes in the digital image correlation failing resulting in either large errors or an inability to compute dispersion of the particles was a concern during the experimental design so fences were positioned around the measurement area so as to minimise the number of particles required the fences were connected to the sides of the tow tank with small foam floats which were restricted to heave motions these floats produced a radiated wave evident in the top right corners in figs 10 and 11 the error correction process applied to the data is good at removing any of the extreme localised errors however there are instances where the error is not sufficient to trigger the error removal improvements to the error correction could likely be made by include a time domain component to the identification and correction of the data the ideal however would be to reduce the frequency of the errors this could be accomplished by an improved calibration and increased particle density improving the calibration could be accomplished by a calibration plate which is closer to completely level there were slight undulations in the equipment used here the approach taken here to assess the measurement accuracy of stereo videogrammetry requires two assumptions to be true one that there is a perfect symmetry about the centreline of the tank and two that wave gauges return the true surface elevation the variation from these precepts specifically spatial variation in the across the wave front could easily account for the errors experienced with low wave steepnesses the particle retention approach employed in these experiments clearly generate noise in the desired data which is undesirable this noise is clearly a concern which needs to be addressed however it is interesting to note that once the noise was evident it was relatively simple to diagnose the cause in summary future work pertaining to the use of stereo videogrammetry for wave field measurements are assessment of the effect of particles on wave dynamics improvement of particle retention techniques alternatives to particles such as dyes the processing expense of videogrammetry is quite high at approximately 4 min of processing per second of experiment due to the large processing requirements it is not feasible to complete real time processing on all the experimental data this inability to completely check data integrity during experiments increases experimental risk in this campaign several runs were not able to be successfully processed for reasons which have not been attributed at this stage for the detractions of stereo videogrammetry discussed above it holds a number of benefits alternative approaches to the characterisation of the free surface such as mcnatt et al 2015 or o boyle et al 2017 use assumptions of repeatability to capture the full free surface characterisation these repeats cost time and introduces possible sources of error with the use of stereo videogrammetry it is possible to capture a large area at an instance furthermore work by penesis et al 2016 fleming and manasseh 2017 and nader et al 2017 have explored using the software to assess surface flow an additional capability of stereo videogrammetry not explored in this work in the course of using the surface data output from davis it was noticed there were clear localised errors in the surface these errors are identifiable via sharp unnatural jumps in the free surface in defining these errors for the purpose of correction it was observed that the simplest approach was to find the magnitude of the gradient across the free surface any region bound by unreasonably high gradient could be considered erroneous coincident to this deduction on error identification it was also observed that the diffracted wave field was also considerably more evident on these gradient plots the cause of the errors is largely due to insufficient particle seeding it was intended through this work to assess the feasibility to model arrays by way of reflections from the walls of a wave flume it was realised in the course of this study that this is not feasible with the experiments completed the information necessary to assess the reflections is a study into the amount of energy reflected the reflection coefficient and any phase shift which can be attributed to the process in an incident plus diffracted plus reflected diffracted wave field this is an exceptionally difficult proposition as it requires distinguishing the various components and comparing the two diffracted components which may not be entirely distinguishable an improved methodology was conceived through the work however this improved approach to be applied in future work consists of generating a monopole radiated wave in the channel allowing the wave field to progress through the reflection and capturing the free surface at an instance recalling for a monopole wave propagating from a point source a constant amplitude should be evident for the entire circumference and the surface wave remains in a circle the assessment process proposed will see the amplitude compared around a wave this will indicate the amount of energy reflection in conjunction to this the roundness will be assessed any variation from a true round would indicate any phase shift associated to the reflection or the walls not being perfectly planar all that is truly able to be commented on from the outputs of this work on the topic of reflections is that they are clearly evident in the stereo videogrammetry results this reflected wave field progresses through the experimental measurement period so it is possible to infer that the concept is sound the nemoh modelling has shown that the free surface results are almost indistinguishable for both time and frequency domain for all simulations besides the single cylinder the excitation moment investigation similarly did not show any great deviation between the numerical simulations the primary distinction experienced related to the processing times of the different simulation environments with an order two relationship between number of panels and processing time babarit and delhommeau 2015 folley et al 2012 the simulation with the walls was distinctly faster to process than the three and five cylinder symmetries explored in addition to this as the width of the array in terms of cylinders is extended the required number of panels per cylinder increases this is a result of the relative errors associated with discretisation of a cylinder surface into a series of quadrilaterals when these relative errors are propagated a short distance as for a single cylinder the resulting absolute error may be acceptable propagating the same relative a longer distance as is required for array simulation the resulting absolute error is greater this means that considerable processing savings can be made with judicious utilisation of symmetry planes the comparison between the stereo videogrammetry and the nemoh is quite good the filtered comparison of the free surfaces show that there is almost no distinction between the measurements and the nemoh modelling the experimentally measured excitation moments indicate a reasonable correlation with the numerical predictions with the exception of the 0 7 hz case this is thought to be related to the wavelength at this frequency 3 17 m being closest to the width of the wave flume 3 55 m of the conditions tested 5 conclusion in this study we have investigated reflections from walls to simulate arrays of wecs with the use of a simplified wec in the form of a cylinder the work applied novel experimental techniques in a wave flume applying stereo videogrammetry to measure the free surface and comparing the results to numerical simulations with nemoh the experiments consisted of regular wave frequencies ranging from 0 25 hz to 1 hz with wave amplitudes of 25 mm and 50 mm in the nemoh investigation different domains were considered ranging from a single cylinder through to small arrays with three and five cylinders before considering the infinite case using walls to model infinitely wide arrays for the primary condition in this study a regular wave with a frequency of 0 9 hz and amplitudes of 25 and 50 mm a detailed analysis of the moments and free surface effects were provided in the experimental investigation the use of stereo videogrammetry was assessed as a measurement technique prior to examples of the complete free surface being given it was demonstrated that the use of the gradient of the free surface is a valuable tool in visualising the different components within the sea state with this the development of the scattered wave field was shown including reflections from the tanks walls numerically it was shown that the use of walls to simulate arrays is a valuable tool to reduce computational expense nemoh was shown to perform well when comparing phase averaged moments and free surface estimation continuing work includes development of a process to assess the reflection coefficients in terms of both amplitude and phase variation further experiments would include evaluation of the radiated wave field in isolation from the incident and diffracted wave fields improvement in the method to retain the particles in the field of interest is also required to improve free surface capture future work includes applying stereo videogrammetry to map the free surface around a scaled wec representative of known operating devices to further investigate wec array effects acknowledgements brian winship and mark hemer are jointly funded by csiro oceans and atmosphere climate research centre and the australian renewable energy agency arena emerging renewables program erp a00521 the australian wave energy atlas project alan fleming irene penesis and gregor macfarlane are funded by arena emerging renewable program erp a00575 towards an australian capability in arrays of ocean wave power machines the following people provided valuable assistance during the experimental campaign liam honeychurch kirk meyer aidan bharath and andrew whitmore finally we thank lavision for their support in implementing this stereo videogrammetry approach 
23195,the commercialisation of wave energy converters wecs is certain to require the deployment of multiple units in arrays the collocation of wec units into an array will lead to hydrodynamic interactions collectively referred to as array effects understanding these effects is important for successful developments concerning energy capture and government approval to better understand array effects physical experiments and numerical modelling can be completed prior to field deployments this work explores utilising the reflections from walls to simulate array effects including the application and assessment of stereo videogrammetry for experiments and numerical modelling with nemoh a linear potential flow solver the investigation uses a cylinder fixed in the centre of a wave flume to simulate wave scattering a component of the hydrodynamics of wecs the stereo videogrammetry method uses small buoyant wax particles so that the free surface can be mapped with software from lavision it is shown that the stereo videogrammetry approach applied is able to accurately measure water waves however there are challenges associated to higher steepness waves and the resulting drift of surface particles both the experimental and numerical investigations show great potential in the use of wall reflections to model array effects and correlate well keywords method of images wec array effects stereo videogrammetry linear potential flow nemoh nomenclature a wave amplitude m k wavenumber rad m t time s η surface elevation m η d diffracted wave m θ wave direction rad ω angular frequency rad s 1 introduction there are many types of wec operating principles in a range of stages of development around the world common examples include point absorbers oscillating water columns or wave surge converters babarit et al 2012 irrespective of device operating principle it is intrinsic that any deployment of a wecs will cause a variation in the natural wave field owing to both the presence of a structure in the water and the energy conversion process a single wec with a capacity on the order of 100kw 1mw will have only limited effect on the surrounding wave field however if wave energy is to be a notable contributor to the world s energy needs then wecs must be deployed in arrays of devices or in wec farms the deployment of an array of devices increases the importance of the wave field variation with the introduction of intra array effects and exacerbation of extra array effects collectively referred to as array effects folley et al 2012 stratigaki 2014 intra array interactions are those that relate how the variation of the wave climate caused by one device will affect the performance of any other device in close proximity to it these interactions will affect the power conversion of individual wecs with the potential to either increase or decrease power capture babarit 2013 extra array effects are the variations of the natural wave field surrounding the array of wecs oceans waves are an important physical process in the near shore and coastal zones responsible for maintaining coastal sediment budgets shoreline position through erosional accretion processes and the level of energy is a key characteristic of an ecosystem warner et al 2010 furthermore in some locations waves provide opportunities for surfing which can provide an important economic stimulus for a region lazarow et al 2007 thus an important consideration before widespread deployment of wec arrays is to understand the effects of deployment on the surrounding natural wave field via extra array effects the two primary physical processes that cause these array effects are wave scattering and the radiated wave wave scattering includes diffraction and reflection effects that are induced when subjecting a stationary structure to incident waves the radiation problem refers to energy transferred to water by a structure moving wec development has now progressed to the point where small arrays of wecs are being deployed in situ for example carnegie clean energy ltd formerly carnegie wave energy ltd deployed an array of three of their proprietary ceto 5 units each rated at 240 kw during the year 2015 as part of the perth wave energy project fiévez and sawyer 2015 concurrent to this deployment contardo et al 2017 conducted with a sparse array of measurement equipment to measure attenuation this work observed a 20 reduction in wind sea height 40 m down wave of a single wec and a 12 reduction at 80 m this activity and those similar provides a valuable opportunity to learn how the natural wave field responds however measuring variation of a natural wave field in situ is exposed to many factors that makes it more difficult to quantify the effect of the wec array particularly when the array is small an idealised setting such as can be defined in a wave basin or a wave flume provides opportunity to measure the attenuation of idealised waves surrounding an array of scaled wecs an alternative to physical testing is numerical modelling however numerical array modelling is not yet fully validated testing and modelling have the potential to provide valuable information to facilitate future commercial scale array deployments experimental investigation into array effects is in a phase of rapid development a summary of the current development of the experimental measurement of wec array effects is given by o boyle et al 2017 in brief experiments have consisted of measuring the variation in the wave field at point locations up and down wave of small arrays of wave energy converters alexandre et al 2009 haller et al 2011 payne 2008 porter 2012 stratigaki 2014 these works all identified a requirement for further spatial information on the variation of the wave field the work by o boyle et al 2017 sought to rectify this by collecting data over an area of 4 65 m by 5 1 m with a data resolution 150 mm this was accomplished by an array of 32 wave gauges with a spacing of 150 mm spread laterally across the experimental area recordings were made at one transverse plane prior to the measurement array being progressed 150 mm this approach requires an express assumption of repeatability mcnatt et al 2015 completed a study where 59 wave gauges were deemed necessary only 22 wave gauges could be recorded on any single run thus every experimental condition required a minimum of three runs this approach requires an assumption of repeatability the approach by black 2014 saw a novel alternative to wave gauges with stereo videogrammetry used to map the free surface in three dimensions the approach saw the water seeded with a glass based material that allowed cameras to discern the free surface a calibration process is used where the pixel coordinates between two cameras 4 variables are transposed to three dimensional space to achieve the goal of measuring array effects all the aforementioned studies completed work in wave basins where as much as possible effects from the basin walls were minimised or excluded from the study more recently work by penesis et al 2016 applied the software davis surface flow lavision 2015 which is capable of completing the necessary processing for stereo videogrammetry as discussed above the typical approach to measurement of array effects is to deploy small arrays of wecs for this the applicable number of models is required and access to a sufficiently large hydrodynamic wave basin consequentially costs increase rapidly as size of array increases with respect to both number of devices and scale the method of images is a concept whereby it is assumed a structure placed in a channel and subjected to incident waves is analogous to a row of the same structure of infinite width the concept has been applied extensively within linear wave theory to the diffraction problems of both electromagnetics and water wave theories butler and thomas 1993 dalrymple et al 1989 thomas 1991 in the field of hydrodynamics the historical intent has tended towards experimental testing in towing tank facilities thomas 1991 the goal being to allow for prediction of open water hydrodynamic characteristics as opposed to experimental measurements which include sidewall effects the method of images as applied to water waves was first applied by spring and monkmeyer 1975 the theory states that a single cylinder located between two parallel vertical walls is analogous to a row of cylinders with infinite width as is visually depicted in fig 1 the theory is based on the assumption that the walls are perfect reflectors and are parallel to the direction of propagation of the incident wave the same concept has also been applied to a viscous problem by zurcher 2015 where a catamaran demi hull was run alongside a towing tank wall where the positioning was such that the wall is at the analogous vessel centreline there are a number of numerical modelling techniques which are available to investigate array effects with detailed reviews available from folley 2016 folley et al 2012 at present there is no single best approach for the numerical modelling of wec array effects with a trade off required between computational expense and accurate representation of physical phenomena techniques such as spectral wave boussinesq and mild slope models are approaches that suit modelling wave propagation but none is capable of modelling the hydrodynamics of wecs an improvement of this are non hydrostatic wave flow models rijnsdorp et al 2017 to include device hydrodynamics approaches based on potential flow or computational fluid dynamics need be applied a common approach is to use linear potential flow theory with boundary element method bem to solve commercial examples are wamit lee 1995 and ansys aqwa ansys 2012 while babarit and delhommeau 2015 released an open source solver nemoh due to the recent release of this code very little work has been completed on validation a common approach to modelling wave structure interactions is to apply potential flow theory folley et al 2012 general potential flow theory assumes the fluid is inviscid and incompressible and the flow is irrotational these assumptions lead to a set of non linear equations it is possible to linearise these equations and reduce computational expense by assuming small amplitudes of waves and body motion as well as structures and the sea floor being impermeable with the problem linearised it is possible to solve the calculations in the frequency domain this three dimensional problem is transformed into a two dimensional problem with the application of green s second identity and an appropriate green s function the two dimensional domain is defined by discretising the structure wetted surface into a series of panels this study shall use the open source code nemoh initially released by ecole centrale nantes in 2014 the specific formulation of the solution is given by babarit and delhommeau 2015 this work aims to test the concept of using the method of images to simulate array effects of wecs we apply stereo videogrammetry to measure the response of the free surface to a fixed cylinder in a towing tank subjected to regular waves including an assessment of the measurement accuracy of stereo videogrammetry the fixed cylinder represents a highly simplified wec in addition a comparison with predictions from nemoh aim to contribute the validation of this open source code 2 method 2 1 experimental approach 2 1 1 setup experiments were conducted in the university of tasmania in the australian maritime college s towing tank the facility dimensions are 100 m long by 3 55 m wide with an operational water depth of 1 5 m the tank has a single hinged paddle wave maker at one end and a beach at the other the model setup consists of a fixed cylinder of 315 mm diameter by 1 8 m height which is positioned on the tank centreline 20 m from the wave maker running vertically from 100 mm above the tank floor to above the free surface the cylinder is fixed at the bottom and is fitted with two normally opposed load cells above the free surface so as to measure the pitch and roll moments about the bottom fixing fig 2 in order to assess the stereo videogrammetry measurements an array of eleven wave probes were deployed as depicted in fig 2 right an assumption of symmetry about the cylinder was made such that comparisons between the stereo videogrammetry and wave gauges can be made this assumption is required as the cameras require a clear field of view for measurement the stereo videogrammetry technique applied consisted of two machine vision cameras the cameras used were two baser ace 12 bit 4 megapixel usb3 cameras each fitted with a kowa 6 mm lm6hc 1 5 edmund optics lens extender and c mount orange longpass fiter midopt lp550 25 4 they were mounted in conjunction with five ultraviolet light sources as shown in fig 3 the ultraviolet lights stage spotlights were reflected off the roof to create a diffused light field over the water surface images were captured in synchronised image pairs from the two cameras at 25 hz in order for the water surface to be discernible it was seeded with fluorescent wax particles these particles are a composition of paraffin wax carnauba wax and a pigment at proportions of 90 7 5 and 2 5 by mass respectively the pigment causes the particles to fluoresce orange when subjected to ultraviolet light the targeted particle size was 5 5x1 mm this constitutes roughly 3 3 pixels in the photos for this experimental setup in order to minimise the amount of particles required a wave transparent fence was positioned both up and down wave of the setup the experimental condition can be seen in fig 2 left wave conditions investigated experimentally are amplitudes 25 mm 50 mm and 100 mm frequencies 0 25 hz 0 3 hz 0 4 hz 0 5 hz 0 6 hz 0 7 hz 0 8 hz 0 9 hz and 1 0 hz 2 1 2 stereo videogrammetry stereo photogrammetry is a process in which photographic images are used as a basis for measurement sorensen 1968 gives a description of the process as applied to hydrodynamic research although it should be noted there are numerous changes with the advent of digital photography as is outlined one of the key challenges is surface detection in hydrodynamic facilities the water is typically very clean and the bottom as such is clearly visible in such situations it is required to seed the water such that the free surface is clearly discernible black 2014 gives a description on the process as extended to videogrammetry for hydrodynamic interactions the same challenges relating to surface detection continue to exist the measurement accuracy of stereo videogrammetry has the capacity to relate well with wave gauges sorensen 1968 claims that there is a capacity to match or exceed the precision relative to wave gauges while black 2014 in a quantitative comparison of average wave height with wave gauges found errors to be in the range of 1 8 45 2 from eleven samples 2 1 3 calibration and data processing the calibration process for davis surface flow lavision 2015 requires a series of images be taken with different views of a calibration plate the calibration plate used was 2 4 m 2 4 m white in colour with an array of black dots 50 mm spacing 10 mm diameter the calibration plate was mounted on a polystyrene sheet such that it could be floated in the experimental area the plate sitting 49 mm above the water free surface the images for the calibration were taken by keeping the relative position of the cameras fixed while moving the cameras relative to the calibration plate examples of one image set is given in fig 4 two sets were used for the calibration once the calibration is complete it is important that the camera settings are not altered this includes aperture focus and relative position the resulting calibration coefficients are given in table 1 the videogrammetry method requires the free surface be seeded with particles the image on the left in fig 5 gives a sample of a raw image the particle density seen is about the minimum required for this porcess to be succesful the ouput from davis used in this work is the surface height the top right image in fig 5 presents a sample for an instant where the surface is still it can be seen that there is a variance of 10 mm across the surface there are also localised discontinuities which indicate a sharp jump in the surface elevation these discontinuites are processing error in the digital image correlation and are symptomatic of insufficient particle seeding to account for the variance in height we subtract the known zero level from the recorded level for every frame exported from davis to address the localised discontinuities we recall that free surface elevation is defined by 1 where η is the surface elevation a is the wave amplitude k is the wave number θ is the wave direction ω is the angular frequency and t is time 1 η x y a cos k x cos θ y sin θ ω t it can be shown from this that the maximum of the absolute of the gradient can be expressed by 2 2 max η x y k a the experimental waves are unlikely to adhere to linear theory thus we relax this condition to include a factor of safety of two given this it is assumed any region bound by high localised steepness η x y 2 k a is erroneous the area around these errors are dilated by 4 pixels to better eliminate the residual error the surface gradient components are computed by the matlab functions gradient abs and angle the holes are then filled from the outer most pixels with the use of the matlab function regionfill the filling process computes the discrete laplacian over the region and solves the dirichlet boundary value problem the resulting post processed surface from the raw zero elevation discussed earlier is presented in the bottom right of fig 5 the davis processing was completed on a pc with 64 gb ram and with two intel xeon e5 2630v2 cpu which results in 24 logical processors 2 6 ghz processing speed this setup resulted in processing times of roughly 10 s per frame the post davis processing error removal was completed on a machine with 16 gb ram with an intel core i7 4770 cpu with 8 logical processors 3 4 ghz processing speed post processing takes approximately 2s per frame raw data volume is 3 5 mb per frame and processed totals 10 mb per frame surface elevations measured by the wave gauges were compared with elevations for the equivalent location determined from the processed surface data performance metrics used to assess performance of the method for each wave gauge for each experiment include the instantaneous absolute and relative errors as defined by equations 3 and 4 respectively 3 absolute error t wave gauge t surface measurement t 4 relative error t wave gauge t surface measurement t wave amplitude and the root mean square error of each is defined by equation 5 where error is either the relative or absolute error 5 r m s e e r r o r t 2 for the comparison between stereo videogrammetry and nemoh a butterworth band pass filter was applied the band used was 0 1 1 2 hz 2 2 numerical model nemoh is an open source linear potential flow solver which applies boundary element method a detailed description of the modelling procedure is given by babarit and delhommeau 2015 or on the website lheea 2017 the modelling completed in this work was accomplished with matlab wrappers based upon those downloadable with the code 2017 modifications relate to modelling arrays and activating the surface post processing four scenarios were considered with nemoh these are illustrated in fig 6 and include a a single cylinder b three cylinders c five cylinders and d a method of images simulation all modelling in this study was completed with the assumption of symmetry about y 0 for modelling method of images a reflective wall is positioned as per the physical tank wall the water depth considered is 1 5 m and wave frequencies in the range of 0 2 hz 1 2 hz mesh convergence was completed with the characteristics selected given in table 2 the outputs from nemoh that have been used are the pitch excitation moment and the free surface the free surface used for comparison with the stereo videogrammetry is discretised into 4000 points 200 by 200 over an area 3 5 m by 3 5 m the time domain free surface expression for the nemoh is given 6 for a single frequency component a is the incident wave amplitude k is the wave number x and y are the position on the surface ω is the angular frequency t is time η d is the normalised diffracted wave amplitude and η d is the phase angle of the diffracted wave field 6 η x y t a ℜ e i k x cos θ y sin θ ω t η d x y e i η d x y ω t 3 results 3 1 stereo videogrammetry free surface 3 1 1 measurement accuracy the comparison between the wave gauges and the stereo videogrammetry is one of importance due to the relative novelty of the stereo videogrammetry approach all experimental results presented are for a setup with the cylinder located in the wave flume a time domain comparison for a wave with frequency 0 9 hz and amplitude 25 mm for wp 10 is given in fig 7 the top plot is an overlay of the two approaches and bottom presents the relative and absolute errors for this condition it is clear that there is very good agreement with only slight discrepancies around the crests and troughs a similar comparison is made in fig 8 except the condition has a frequency of 1 0 hz and amplitude 50 mm and location wp 06 these plots indicate that for the period of t 0 10 s indicate a similar accuracy to the previous run considered following this errors increase with a major discrepancy at 12 5 s this error is due to an entire time step failing to compute correctly the accuracy returns until 15 s at which point errors increase until the processing completely fails at 22 s these increasing errors and eventual failure to compute have been attributed to the particles being dispersed by a nonlinear drift effects extending the investigation from the two runs given above to all test conditions the rmse is compared with wave steepness in fig 9 the conditions ranged in frequency from 0 25 hz to 1 0 hz and amplitude from 25 mm to 100 mm wave steepness is used for the comparison as rmse varies with both the wave frequency and amplitude the left plot shows a comparison between the rmse of each run and the wave steepness while the right shows the processing failure rate and the total number of frames capture compared to wave steepness the wave steepness is that which was measured through phase averaging experimental results as opposed to requested from these plots it is clear that for low steepness wave s stereo videogrammetry is gives low error opposed to wave gauges and there is a very low risk of failure to process the results a caveat to this is in close proximity to the cylinder errors are larger the location closest to the cylinder wp 04 routinely exhibits the largest error for a run this is thought to be a result of higher nonlinearities in this region causing high drift resulting in fewer particles for the digital image correlation errors increase however as wave steepness increases furthermore the processing failure rate increases beyond 40 as steepness increases above 0 2 as highlighted above with fig 8 this is not due to the inability of davis to operate in these conditions it is a result of the seeded particles being swept away from the experimental area 3 1 2 surface data here we focus the result on the condition with an incident wave of frequency 0 9 hz and amplitude 50 mm this is presented in fig 10 and fig 11 a supplementry video related to these can be found at https doi org 10 1016 j oceaneng 2018 06 033 the phase averaged measured wave steepness is 0 17 which suggests an error of 5 10 compared to wave gauges from the investigation above the following is the supplementary data related to this article video 1 incident wave with 0 9hz frequency 0 05m wave amplitude the top plot shows the free surface elevation bottom left the free surface gradient magnitude and the bottom right the free surface gradient direction 1 video 1 fig 10 presents a sequence of five frames spaced evenly from just prior to when the developed incident wave front first hits through to when the first wave reflected from the diffraction field returns the data presented consist of the free surface on the left the gradient magnitude in the centre and gradient direction on the right the gradient magnitude is expressed in proportion of wave steepness and direction is aligned with the centreline in the first frame it can be seen that the initial wave has not yet struck however a very small part of the diffracted field is evident slightly up wave of the cylinder formed by the ramp up waves in the second frame as the incident wave has passed a clear scattered wave is evident especially in the gradient plots as time passes the scattered wave field is seen to develop with a reflection of the scattered wave apparent in the fifth frame on the gradient plot it is interesting to note through the data that the scattered waves are much more evident in the gradient plots as apposed the free surface plot and that the scattered waves have a shorter wavelength than the incident waves one concern in these plots is the radiated wave evident in the gradient plots in the top right corner 1300 mm 1500 mm from the third frame onward this radiated wave has been attributed to a small buoy used to connect the conceptually transparent particle fence to the tank wall the floats four used throughout the setup had mass of approximately 400 g and diameter 100 mm furthermore it can be observed that the region directly in the lee of the cylinder has increased errors as the run progresses this is the result of non linear drift forces causing the particles to disperse fig 11 shows the progression of the wave following from fig 10 the development of the scattered wave field is more evident the time period shown corresponds to the second order of interaction the hole in the lee of the cylinder is yet more evident as is the radiated wave from the fence in the top left corner of the frame as the run progresses errors increase evidenced by the larger hole and increased number of reconstruction errors squares this failure to process the surface can be attributed to high particle drift as a result of high steepness causing davis to fail to find correlation between the two raw images in other runs not shown successfully processed for the full capture period a correlation was experienced between successful processing and reduced wave steepness 3 2 free surface modelling from nemoh as with the stereo videogrammetry measurement the results presented are focused on waves with a frequency of 0 9 hz with an amplitude of 50 mm where relevant the results presented are for a single cylinder in fig 12 for three cylinders in a row in fig 13 five cylinders in a row in fig 14 and for the infinite case in fig 15 all figures show the same area as the stereo videogrammetry from the centreline of the tank to the wall the same format is applied across all four figures with the top two plots giving the frequency domain results consisting of the amplitude on the left and the phase angle on the right below on the bottom are an instance in the time domain with the elevation on the left surface gradient magnitude in the centre and surface gradient direction on the right the frequency domain surface components generated by nemoh show a convergence towards method of images as the number of cylinders vary from a single cylinder through to an infinite row key indicators to this is the variation in the amplitude with the localised zero region developing from 1 5 1 0 extending in the wave direction around to the lee of the structure similarly the time domain modelling is barely distinguishable after more than one cylinder is present with only slight changes to the peaks and troughs occurring it is interesting to note that the gradient plots gives the illusion that the incident wave is slightly oblique this is not the case but in fact a coincidence for this time step an extended time series of all four scenarios are can be found at https doi org 10 1016 j oceaneng 2018 06 033 where two wave periods are shown the following is the supplementary data related to this article video 2 nemoh free surface modelling first column is free surface elevation second column is magnitude of the free surface gradient and third column is direction of free surface gradient single cylinder second row three cylinders third row five cylinders forth row cylinder and wall 2 video 2 3 3 comparison between nemoh and videogrammetry a comparison between stereo videogrammetry and nemoh is now made for this comparison the stereo videogrammetry had a band pass filter applied to remove non first order diffraction effects fig 16 and fig 17 respectively present a single time step for a 0 4 hz and 0 9 hz incident wave both are with a 25 mm incident wave amplitude extended studies are presented in video format at https doi org 10 1016 j oceaneng 2018 06 033 for 0 4 and 0 9 hz respectively the following is the supplementary data related to this article video 3 a comparison between stereo videogrammetry measurement and nemoh modelling for an incident wave with 0 4 hz frequency and 25 mm amplitude steepness 0 0195 with t 0 when the first wave arrived at the cylinder top row stereo videogrammetry bottom row nemoh modelling for cylinder and wall case left column free surface elevation middle column free surface gradient magnitude right column free surface gradient amplitude 3 video 3 the following is the supplementary data related to this article video 4 a comparison between stereo videogrammetry measurement and nemoh modelling for an incident wave with 0 9 hz frequency and 25 mm amplitude steepness 0 0815 with t 0 when the first wave arrived at the cylinder top row stereo videogrammetry bottom row nemoh modelling for cylinder and wall case left column free surface elevation middle column free surface gradient magnitude right column free surface gradient amplitude 4 video 4 this qualitative comparison indicates that for the first order wave components there is very good agreement between the two methods for low steepness waves as is shown by fig 9 the stereo videogrammetry begins to break down as steepness increases the same is true with nemoh which includes the assumption that wave amplitude is small relative to the wavelength 3 4 excitation moment the experimentally measured excitation moments are compared with the four nemoh simulations in fig 18 the numerical simulations are completed in the frequency domain so are for an infinite time period and are normalised by wave amplitude the experimental measurements are the result of phase averaging over the experimental period this period is defined as the period from when the wave arrives at the structure to when the reflection from the beach arrives as such the experimental period is subjective on the celerity of the condition the experimental waves presented include runs with amplitude 25 and 50 mm the excitation moments are normalised by the incident wave amplitude the four nemoh simulations indicate the importance of multiple bodies for wec intra array effects further to this it is important to recall the relationship between computation time and number of panels comparing the numerical predictions with the experimental measurements it is difficult to discern a distinction such that it is possible to comment on the applicability of method of images while the general trend and magnitudes align there is more in common between the numerical predictions than the experimental measurements 4 discussion stereo videogrammetry proposes an interesting prospect for the measurement of wave field effects as compared to using large arrays of wave gauges the investigation into the measurement precision suggests that the technique used here floating wax flakes as surface markers is primarily suited to low wave steepness investigations the physical reason for this is that the approach requires that sufficient particles be on the free surface for the digital image correlation in non linear waves there is a drift component to the waves which transports the particles away from the area of investigation this drift of the particles causes in the digital image correlation failing resulting in either large errors or an inability to compute dispersion of the particles was a concern during the experimental design so fences were positioned around the measurement area so as to minimise the number of particles required the fences were connected to the sides of the tow tank with small foam floats which were restricted to heave motions these floats produced a radiated wave evident in the top right corners in figs 10 and 11 the error correction process applied to the data is good at removing any of the extreme localised errors however there are instances where the error is not sufficient to trigger the error removal improvements to the error correction could likely be made by include a time domain component to the identification and correction of the data the ideal however would be to reduce the frequency of the errors this could be accomplished by an improved calibration and increased particle density improving the calibration could be accomplished by a calibration plate which is closer to completely level there were slight undulations in the equipment used here the approach taken here to assess the measurement accuracy of stereo videogrammetry requires two assumptions to be true one that there is a perfect symmetry about the centreline of the tank and two that wave gauges return the true surface elevation the variation from these precepts specifically spatial variation in the across the wave front could easily account for the errors experienced with low wave steepnesses the particle retention approach employed in these experiments clearly generate noise in the desired data which is undesirable this noise is clearly a concern which needs to be addressed however it is interesting to note that once the noise was evident it was relatively simple to diagnose the cause in summary future work pertaining to the use of stereo videogrammetry for wave field measurements are assessment of the effect of particles on wave dynamics improvement of particle retention techniques alternatives to particles such as dyes the processing expense of videogrammetry is quite high at approximately 4 min of processing per second of experiment due to the large processing requirements it is not feasible to complete real time processing on all the experimental data this inability to completely check data integrity during experiments increases experimental risk in this campaign several runs were not able to be successfully processed for reasons which have not been attributed at this stage for the detractions of stereo videogrammetry discussed above it holds a number of benefits alternative approaches to the characterisation of the free surface such as mcnatt et al 2015 or o boyle et al 2017 use assumptions of repeatability to capture the full free surface characterisation these repeats cost time and introduces possible sources of error with the use of stereo videogrammetry it is possible to capture a large area at an instance furthermore work by penesis et al 2016 fleming and manasseh 2017 and nader et al 2017 have explored using the software to assess surface flow an additional capability of stereo videogrammetry not explored in this work in the course of using the surface data output from davis it was noticed there were clear localised errors in the surface these errors are identifiable via sharp unnatural jumps in the free surface in defining these errors for the purpose of correction it was observed that the simplest approach was to find the magnitude of the gradient across the free surface any region bound by unreasonably high gradient could be considered erroneous coincident to this deduction on error identification it was also observed that the diffracted wave field was also considerably more evident on these gradient plots the cause of the errors is largely due to insufficient particle seeding it was intended through this work to assess the feasibility to model arrays by way of reflections from the walls of a wave flume it was realised in the course of this study that this is not feasible with the experiments completed the information necessary to assess the reflections is a study into the amount of energy reflected the reflection coefficient and any phase shift which can be attributed to the process in an incident plus diffracted plus reflected diffracted wave field this is an exceptionally difficult proposition as it requires distinguishing the various components and comparing the two diffracted components which may not be entirely distinguishable an improved methodology was conceived through the work however this improved approach to be applied in future work consists of generating a monopole radiated wave in the channel allowing the wave field to progress through the reflection and capturing the free surface at an instance recalling for a monopole wave propagating from a point source a constant amplitude should be evident for the entire circumference and the surface wave remains in a circle the assessment process proposed will see the amplitude compared around a wave this will indicate the amount of energy reflection in conjunction to this the roundness will be assessed any variation from a true round would indicate any phase shift associated to the reflection or the walls not being perfectly planar all that is truly able to be commented on from the outputs of this work on the topic of reflections is that they are clearly evident in the stereo videogrammetry results this reflected wave field progresses through the experimental measurement period so it is possible to infer that the concept is sound the nemoh modelling has shown that the free surface results are almost indistinguishable for both time and frequency domain for all simulations besides the single cylinder the excitation moment investigation similarly did not show any great deviation between the numerical simulations the primary distinction experienced related to the processing times of the different simulation environments with an order two relationship between number of panels and processing time babarit and delhommeau 2015 folley et al 2012 the simulation with the walls was distinctly faster to process than the three and five cylinder symmetries explored in addition to this as the width of the array in terms of cylinders is extended the required number of panels per cylinder increases this is a result of the relative errors associated with discretisation of a cylinder surface into a series of quadrilaterals when these relative errors are propagated a short distance as for a single cylinder the resulting absolute error may be acceptable propagating the same relative a longer distance as is required for array simulation the resulting absolute error is greater this means that considerable processing savings can be made with judicious utilisation of symmetry planes the comparison between the stereo videogrammetry and the nemoh is quite good the filtered comparison of the free surfaces show that there is almost no distinction between the measurements and the nemoh modelling the experimentally measured excitation moments indicate a reasonable correlation with the numerical predictions with the exception of the 0 7 hz case this is thought to be related to the wavelength at this frequency 3 17 m being closest to the width of the wave flume 3 55 m of the conditions tested 5 conclusion in this study we have investigated reflections from walls to simulate arrays of wecs with the use of a simplified wec in the form of a cylinder the work applied novel experimental techniques in a wave flume applying stereo videogrammetry to measure the free surface and comparing the results to numerical simulations with nemoh the experiments consisted of regular wave frequencies ranging from 0 25 hz to 1 hz with wave amplitudes of 25 mm and 50 mm in the nemoh investigation different domains were considered ranging from a single cylinder through to small arrays with three and five cylinders before considering the infinite case using walls to model infinitely wide arrays for the primary condition in this study a regular wave with a frequency of 0 9 hz and amplitudes of 25 and 50 mm a detailed analysis of the moments and free surface effects were provided in the experimental investigation the use of stereo videogrammetry was assessed as a measurement technique prior to examples of the complete free surface being given it was demonstrated that the use of the gradient of the free surface is a valuable tool in visualising the different components within the sea state with this the development of the scattered wave field was shown including reflections from the tanks walls numerically it was shown that the use of walls to simulate arrays is a valuable tool to reduce computational expense nemoh was shown to perform well when comparing phase averaged moments and free surface estimation continuing work includes development of a process to assess the reflection coefficients in terms of both amplitude and phase variation further experiments would include evaluation of the radiated wave field in isolation from the incident and diffracted wave fields improvement in the method to retain the particles in the field of interest is also required to improve free surface capture future work includes applying stereo videogrammetry to map the free surface around a scaled wec representative of known operating devices to further investigate wec array effects acknowledgements brian winship and mark hemer are jointly funded by csiro oceans and atmosphere climate research centre and the australian renewable energy agency arena emerging renewables program erp a00521 the australian wave energy atlas project alan fleming irene penesis and gregor macfarlane are funded by arena emerging renewable program erp a00575 towards an australian capability in arrays of ocean wave power machines the following people provided valuable assistance during the experimental campaign liam honeychurch kirk meyer aidan bharath and andrew whitmore finally we thank lavision for their support in implementing this stereo videogrammetry approach 
23196,an energy based formulation for vibro acoustic analysis of submerged submarine hull structures guoyong jin a xianglong ma b wenyao wang a zhigang liu a a college of power and energy engineering harbin engineering university harbin 150001 pr china college of power and energy engineering harbin engineering university harbin 150001 pr china b shanghai marine equipment research institute shanghai 200031 pr china shanghai marine equipment research institute shanghai 200031 pr china corresponding author an energy based formulation is developed to investigate the vibro acoustic behaviors of the submarine hull immersed in heavy fluid in the present paper the conical cylindrical hemispherical coupled shell with bulkheads and ring stiffeners is considered as the theoretical model of the hull structure which is discretized into a number of spectral elements according to the structure type displacement components of each spectral element are invariably expressed by a set of modified fourier series the external acoustic field is described by one dimensional helmholtz integral formulation that can be solved by the means of discretization along the generator line of the hull structure subsequently the full vibro acoustic model for the submerged hull is established by taking into account the energy of the acoustic field acting on the hull surface the reliability and accuracy of the present method is validated by comparison of vibration and acoustic responses with those from the commercial softwares several examples are conducted to understand the effects of bulkheads ring stiffeners and coupling stiffnesses on the vibro acoustic behavior of the submerged hull which provides some helpful information in the design of underwater hull structures keywords vibro acoustic analysis modified fourier series submerged submarine hull 1 introduction the hull is the key structure of submarines to directly face the external fluid of which the vibration transmitted from the internal power machine and the propeller shafting system can result in a high level of radiated noise in practice the detectable noise may raise security problems for submarines in this regard the radiated sound from the hull structure must be reduced in an adequately low level indeed the sound radiated to the external fluid and the vibration of the hull structure influences each other for the submerged hull structure thus thoroughly understanding the dynamic behavior of the submerged hull depends greatly on the formulation of the fully coupled vibro acoustic system the acoustic problems of elastic structures reported in the literature are generally solved by the means of the helmholtz equations or the helmholtz integral formulation since the analytical solutions greatly depends on the geometry considerable attention in the related literature is just devoted to a small number of simple structures such as infinite circular cylinders and spherical shells junger and feit 1986 skelton and james 1997 ding and chen 1998 fahy and gardonio 2007 rather than the shells with complex geometry and coupled structures the literature concerning the sound radiation of elementary shells with complex geometry is rather limited to conical shells and elliptical cylindrical shells caresta and kessissoglou 2008 li et al 2014 as far as a coupled structure under water is concerned the approximate method that provides a possible solution attracts increasing attentions recently the finite element method fem and the boundary element bem method are two popular approaches to describe radiated sound field from submerged structures in early papers alfredson 1973 arlett et al 1968 chien et al 1990 without regard to the structural geometry the submerged structure is discretized into a number of elements by these two approaches to describe its vibro acoustic behavior in order to reduce the modeling cost the coupled bem bem method has been developed by jeans and mathews mathews 1986 jeans and mathews 1990 1993 peters et al 2014 to investigate the dynamic behavior of structures immersed in an infinite fluid medium in which the structure and the acoustic field are described by finite elements and boundary elements respectively although commercial software such as ansys and virtual lab popularize these two numerical methods the accuracy of them highly depends on element meshing especially for high frequency analysis which limits the use of these two methods to predict vibro acoustic behavior for the case with large size besides the variational principle is also usually used to predict the acoustic characteristics of submerged structures gladwell 1966 wu 1989 chen and ginsberg 1993 bjarnason et al 1994 choi et al 1995 recently the semi analytical method attracts increasingly more attention to dynamic analysis of submerged shells of revolution soenarko 1993 wang et al 1997 wright et al 2009 in which the displacement function in the circumferential direction is expanded by the fourier series due to axisymmetrical properties in this way only the discretization along the generator line of the shell is needed resulting in one dimensional helmholtz integral instead of the traditional two dimensional integral which can reduce much efforts to solve acoustic problems of submerged shell structures the fully vibro acoustic system for the submarine hull structure is established by caresta and kessissoglou 2010 in which the structural responses of the hull are calculated through solving dynamic equations for each substructures while the direct boundary element method is introduced to solve the one dimensional helmholtz integral formulations in ref caresta and kessissoglou 2010 the submarine hull is simplified as a cylindrical shell closed by truncated conical shells with internal bulkheads and ring stiffeners the semi analytical method is developed by qu et al 2015 to investigate the vibro acoustic behavior of submerged coupled spherical cylindrical spherical shells reinforced by ring stiffeners and longitudinal stringers in this study the modified variational method is used to formulate the coupled stiffened shell whereas the collocation approach is introduced to solve the helmholtz integral formulation chen et al chen et al 2015 xie et al 2017 developed an analytical method to analyze free and forced vibration characteristics of ring stiffened combined conical cylindrical shells in which power series wave functions and bessel functions are used to express the displacement functions of conical segment cylindrical segment and annular plate respectively wang 2016 developed a semi analytical method to analyze the vibration response of submerged stiffened combined shells by coupling the precise transfer matrix method ptmm and wave superposition method wsm from the review of the literature the modeling accuracy of vibro acoustic system depends on descriptions of both the structure and the external acoustic fluid in practice the submarine hull generally consists of the truncated conical shell the cylindrical shell the hemispherical shell the bulkheads and the reinforcement in particular there are usually some structural types repeated involved in the whole structure such as the bulkhead and ring stiffeners subsequently developing a more efficient and accurate method for such complex coupled structure is also of great significance to investigate the vibro acoustic behavior for the submerged cases the modified fourier series spectral element approach is developed by jin et al 2017 to formulate such hull structures as mentioned the modified fourier series proposed originally by li 2000 is composed of a fourier series and auxiliary functions which can adapt arbitrary boundary and coupling conditions in ref jin et al 2017 the built up structure including repeated substructures is discretized as a number of spectral elements according to the structure type while the modified fourier series is invariably used to describe displacement components of each spectral element in the present work an energy based formulation is developed to analyze the vibro acoustic behaviors of submerged submarine hull structure which is simplified and modeled as a conical cylindrical hemispherical coupled shell with bulkheads and ring stiffeners for such complicated structures immersed in a heavy fluid medium the modified fourier series spectral element method is used to formulate the structural model while the external acoustic field is described by one dimensional helmholtz integral formulation that can be solved by the means of discretization into the system of linear equations the work done by the external acoustic field acting on the hull surface is considered to formulate the strong coupling relationship between the structural response and radiated sound pressure the accuracy of the present method is validated by comparison of vibration and acoustic responses with those from the commercial software several examples are conducted to investigate the effects of the bulkhead ring stiffener and coupling stiffness on the vibro acoustic behaviors of the submerged hull 2 theoretical formulation 2 1 model description the hull structure considered in the presented paper is a circular cylindrical shell closed at ends with truncated conical and hemispherical caps respectively as shown in fig 1 the cylindrical shell is reinforced by n r ring stiffeners that can be arbitrary in number size and space arrangement besides the internal space of the coupled shell is separated by bulkheads that are uniformly modeled as thin annular plates with inner radius r a the conical shell is truncated with left radius r 0 semi vertex angle φ 0 and length l c along the generator line whereas l l represents the length of the cylindrical shell with radius r as the spherical shell generally the truncated conical cylindrical and hemispherical shells as well as bulkheads are independently described by orthogonal coordinate systems x i θ i r i in which the subscript i c l s p respectively specifically x i is measured along the generator line where as θ i represents the circumferential direction and r i is the normal direction of the middle surface the displacement components of these shells in the x i θ i and r i directions are respectively denoted by u i v i and w i which can be written as 1 u i u x i θ i e j ω t 2 v i v x i θ i e j ω t 3 w i w x i θ i e j ω t where j 1 ω is the frequency and t represents the time the thickness of the shell components and annular plates is assumed to be uniform and adequately small compared to other geometrical parameters which makes the thin plate and shell theories applicable furthermore it is assumed that all the shell sub structures annular plates and ring stiffeners are made of same materials with young s modulus e poisson ratio μ and mass density ρ as the hull structure is immersed in an unbounded fluid a fully coupled vibro acoustic system is considered through the strong coupling between the vibration of the shell structure and the external sound field according to the energy principle the strong vibro acoustic coupling can be simulated by taking into account the energy of the external sound working on the shell surface under the framework the whole energy functional of the submerged hull structure consists of two components including the structural vibration energy and radiated sound energy the so called radiated sound energy is defined as the work done by the external acoustic field acting on the hull surface in what follows these two energy expressions are theoretical formulated respectively 2 2 structural vibration energy since the annular plate and the ring stiffener of same geometrical parameters are repeated employed in the present model the spectral element approach is introduced to reduce the cost of theoretical formulation development of the structural model of the hull structure is based on the modified fourier spectral element approach by the authors jin et al 2017 according to different structural geometries the hull structure is divided into five spectral elements including the truncated conical shell the cylindrical shell the hemispherical shell the annular plate and the ring stiffener the strain displacement equations for these spectral elements are given as follows according to the raissner theory the mid surface strains curvatures and twist changes of the shells and the annular plate can be uniformly expressed as 4 ε x i 1 a i u i x i μ a i b i a i θ i w i r x i 5 ε θ i 1 b i v i θ i u i a i b i b i x i w i r θ i 6 γ x i θ i a i b i θ i u i a i b i a i x i v i b i 7 k x i 1 a i x i u i r x i 1 a i w i x i 1 a i b i v i r θ i 1 b i w i θ i a i θ i 8 k θ i 1 b i θ i v i r θ i 1 b i w i θ i 1 a i b i u i r x i 1 a i w i θ i b i x i 9 τ x i θ i a i b i θ i u i a r x i 1 a i 2 w i x i b i a i v i b r θ i 1 b i 2 w i θ i where a i and b i are lamé parameters r x i and r θ i denote principle radii of curvature respectively in x i and θ i directions as listed in table 1 then the strain energy v i and the kinetic energy t i of each spectral element can be expressed as 10 v i k 2 s x θ ε x i 2 ε β i 2 2 μ ε x i ε θ i 1 μ 2 γ x i θ i 2 a i b i d x i d θ i d e 2 s x θ k x i 2 k β i 2 2 μ k x i k θ i 1 μ 2 τ x i θ i 2 a i b i d x i d θ i and 11 t i ρ h 2 s x θ u i t 2 v i t 2 w i t 2 a i b i d x i d θ i where k e h 1 μ 2 and d e e h 3 12 1 μ 2 are the extensional and flexural rigidities respectively in order to fully and accurately assemble these spectral elements as a whole structure three dimensional 3d elastic couplers are employed to formulate continuity and boundary conditions the 3d coupler is a artificial stiffness like spring system composed of three translational stiffnesses k x i i k θ i i k r i i and one rotational stiffness k w i i which provides coupling conditions in four directions since the shell structures and the annular plate considered in the present paper are rotational structures the cylindrical coordinate system is utilized to describe the continuity conditions at the junctions as shown in fig 1 four types of continuity conditions are involved in the hull structure including cone plate cone cylinder cylinder plate and cylinder sphere subjected to the cylindrical coordinate system these continuity conditions can be uniformly written with lamé parameters as 12 n x i cos θ i q x a 1 r θ i m x θ i θ i sin θ i ϒ n x i cos θ i q x i 1 r θ i m x θ i θ i sin θ i k x i i u i cos θ i w i sin θ i ϒ u i cos θ i w i sin θ i k x i i δ x i i 13 n x θ i n x θ i k θ i i v i ϒ v i k θ i i δ θ i i 14 n x i sin θ i q x i 1 r θ i m x θ i θ i cos θ i ϒ n x i sin θ i q x i 1 r θ i m x θ i θ i cos θ i k r i i u i sin θ i w i cos θ i ϒ u i sin θ i w i cos θ i k r i i δ r i i 15 m x i ϒ m x i k w i i w i α i u i r x i ϒ w i x i u i r x i k w i i δ w i i where ϒ 1 and 1 denotes the relative position factor n α i and n α β i are the in plane forces q α i is the transverse shear forces and m α i and m α β i are the bending and twist moments as shown in fig 2 from eqs 12 15 and fig 2 it can be found that all force and displacement components at each junction are fully coordinated by these four stiffness parameters which theoretically validates the accuracy and efficiency of 3d coupler to describe the continuity conditions of the hull structure thus arbitrary continuity conditions can be easily achieved just by varying stiffness of the coupler under the framework the energy caused by continuity conditions at arbitrary one junction can be uniformly written as 16 v c 1 2 0 2 π k x i i δ x i i 2 k θ i i δ θ i i 2 k r i i δ r i i 2 k w i i δ w i i 2 a l d θ as far as boundary conditions are concerned 3d couplers are used at the boundaries of the hull structure including the left boundary of the conical shell and the inner boundaries of the annular plates whereas the other ends of boundary couplers is clamped the direction arrangement of stiffness like springs in boundary couplers is subjected to the local coordinate system thus the boundary conditions of the hull structure can be expressed as 17 n x i k x i u i 18 n x θ i k θ i v i 19 q x i 1 r θ m x θ i θ i k r i w i 20 m x i k w i w i x i u i r x i where k x i k θ i k r i and k w i are stiffness parameters of boundary couplers it is observed from eqs 17 20 and fig 2 that all of forces and moments at boundaries of the hull structure are completely restrained the strain energy stored in the boundary couplers can be written as 21 v b 1 2 0 2 π k x i u i 2 k θ i v i 2 k r i w i 2 k w i w i x i 2 a i d θ i to achieve the accurate solution and simplify modeling procedure the ring stiffener is considered as the discrete structure of which the vibration behavior is described by the cylindrical shell without regard to cross section shape the displacement components of the ring stiffener can be expressed by those of the cylindrical shell as 22 u r l j u l e w l x l x l x l j 23 v r l j v l 1 e r e r w l θ l x l x l j 24 w r l j w l x l x l j where e denotes the eccentricity of the ring stiffener x l j is the position of the l j th ring stiffener located on the cylindrical shell taking the effects of stretching biaxial bending and wrapping into account the strain energy of the stiffeners can be written as 25 v r e 2 l j 1 n r 0 2 π i r k 1 2 i x k 2 2 a r e g 2 1 2 1 μ j r γ 2 d θ l where i r and i x are the second area moments with respect to r and x directions respectively a r is the cross sectional area of the stiffener j r represents the torsional rigidity and k 1 k 2 e g and γ can be expressed as 26 k 1 1 r e w r s n x l 1 r e 2 u r s n θ l 2 27 k 2 1 r e 2 w r j 2 w r s n θ l 2 28 e g 1 r e v r j θ l w r s n 29 γ 1 r e 2 w r s n x l θ l 1 r e u r s n θ l the kinetic energy of ring stiffeners with effects of the tri axial translational inertia and rotary inertia about x and r directions are given as 30 t p ρ 2 s n 1 n r 0 2 π a r u r t 2 v r t 2 w r t 2 i r i x i p t w r s n x 2 x l x s n d θ l 2 3 radiated sound energy as shown in fig 3 the acoustic field is described by a global coordinate system r θ z of which the origin is located at the geometrical center of the ring stiffened cylindrical shell where r is the direction of original point o pointing to the field point θ is the circumferential direction and z is the axial direction the sound pressure s p at a field point h r θ z can be written by the kirchhoff helmholtz integral formulation as 31 c h s p h 1 4 π s 0 s p h 0 g h h 0 n 0 g h h 0 s p h 0 n 0 d s 0 where c h is the coefficient determined by the position of the field point h r θ z h0 r 0 θ 0 z 0 is a point on the surface of the hull structure n 0 denotes the normal direction to the surface of the hull structure g h h 0 represents the free space green s function that can be expressed as 32 g h h 0 e j k f d r d r 33 d r h 2 h 0 2 r 2 r 0 2 2 r r 0 cos θ θ 0 z z 0 2 where the acoustic wave number k f ω c f and c f denotes the speed of sound in the fluid since the normal directions of the truncated conical cylindrical and hemispherical shells are different from each others the outward normal derivatives r n 0 and z n 0 can be uniformly expressed by α i and β i respectively as listed in table 2 due to the fact that the coupled shell are axisymetrical structure w h s p h g h h 0 g h h 0 n 0 can be expanded by the fourier series in the circumferential direction as 34 w h n 0 n w c r n z cos n θ n 1 n w s r n z sin n θ 35 s p h n 0 n p c r n z cos n θ n 1 n p s r n z sin n θ 36 g h h 0 n 0 n g r n z cos n θ cos n θ 0 n 1 n g r n z sin n θ sin n θ 0 37 g h h 0 n 0 n 0 n g r n z cos n θ cos n θ 0 n 1 n g r n z sin n θ sin n θ 0 where n is the circumferential modal number n is the truncated number for n and ψ g r n z and g r n z can be expressed respectively as 38 ψ θ θ 0 39 g r n z 1 π 0 π e j k f d r d r cos n ψ d ψ 40 g r n z 1 π 0 π i k f 1 d r e j k f d r d r 2 r 0 r cos ψ α i z 0 z β i cos n ψ d ψ the relationship between the sound pressure s p h0 and the normal displacement component w h0 at the surface of the hull structure is given as 41 s p h 0 n 0 ρ f ω 2 w h 0 substituting eqs 34 37 and 41 into eq 31 the helmholtz integral formulation for the hull structure in the present paper can be expressed as 42 c r z p c r n z 1 2 0 l z p c r n z g h h 0 n 0 ρ f ω 2 w r 0 n z 0 r 0 α i d z 0 with consideration of discontinuity of the surface curvature at the junctions the coefficient c r z in eq 42 can be written as 43 c r z 1 2 π 0 l z g h h 0 n 0 r 0 α i d z 0 44 g h h 0 1 π 0 π 1 4 π d r cos n ψ d ψ the sound pressure at the field point related to the normal displacement component of the hull structure is given as eq 42 however the quantity p c r n z exists at both sides of the equation which makes it difficult to achieve solution directly thus a direct boundary element method is introduced to calculate the sound pressure in the acoustic field the surface of the hull structure is scattered into n um nodes along axial direction including n c n l n s nodes respectively on the surfaces of the truncated conical cylindrical and hemispherical shells the axial coordinates for these nodes can be expressed as 45 z z 1 z 2 z g z n u m 1 g n u m then the helmholtz integral at the right hand of eq 41 is discretized into the sum of integrals between the adjacent two points as 46 c q p q 1 2 g 1 n u m 1 a g q b g q p g p g 1 c g q d g q w g w g 1 0 1 q n u m where 47 c q c r q z q 48 p q p c r q n z q 49 w g w g c w g l w g s t 50 a g q a g q c a g q l a g q s 51 b g q b g q c b g q l b g q s 52 c g q c g q c c g q l c g q s 53 d g q d g q c d g q l d g q s and the sub matrices in a g q b g q c g q d g q are given as 54 a g q i 1 z g 1 z g z g z g 1 z g 1 z g r q r 0 n z q z r 0 α i d z 55 b g q i 1 z g 1 z g z g z g 1 z z g g r q r 0 n z q z r 0 α i d z 56 c g q i ρ f ω 2 z g 1 z g z g z g 1 z g 1 z g r q r 0 n z q z r 0 α i d z 57 d g q i ρ f ω 2 z g 1 z g z g z g 1 z z g g r q r 0 n z q z r 0 α i d z substituting every adjacent two points in eq 45 into eq 46 the expression coefficients of radiated sound pressure s p with circumferential mode number n is obtained in the form of a system of linear equations as 58 p n h n 1 c n w n where 59 c n c t 0 n u m 1 0 n u m 1 d t 60 h n diag c 1 c n a t 0 n u m 1 0 n u m 1 b t 61 a 1 2 a 1 1 a 1 n u m a n u m 1 1 a n u m 1 n u m 62 b 1 2 b 1 1 b 1 n u m b n u m 1 1 b n u m 1 n u m 63 c 1 2 c 1 1 c 1 n u m c n u m 1 1 c n u m 1 n u m 64 d 1 2 d 1 1 d 1 n u m d n u m 1 1 d n u m 1 n u m then the radiated sound pressure can be achieved by assembling eq 58 with regard to the circumferential mode number n as 65 p c n p s n h n 1 c n 0 0 h n 1 c n w c n w s n where p c n and p s n are respectively are the coefficient vectors for p c and p s w c n and w s n are respectively the coefficient vectors for displacement response with respect to even and odd circumferential modal the work caused by the acoustic field acting on the surface of the hull structure can be obtained as 66 e w s 0 s p h 0 w h 0 d s 0 2 4 dynamic equation for the submerged hull structure besides the structural vibration energy and the radiated sound energy the energy functional of the external driving force is also formulated in the paper as the classical driving force type the point force f x f θ f r is considered to understand the dynamic behavior of the submarine structure where f x f θ f r denote respectively the forces in x i θ i and r i directions the potential energy e f of the point force can be written as 67 e f 0 2 π 0 l i f x f θ f r u i v i w i t δ x i x f θ i θ f a i b i d x i d θ i where x f θ f is the location coordinates of the driving force based on the structural vibration energy and the radiated sound energy the lagrange energy function for the submerged hull structure can be written as 68 l w v c v b e w e f i c p l s v i t i l j 1 n r v r j t r j the proper admissible displacement function is the key to achieve accurate solution for eq 68 for the complicated hull structure the admissible function must be applicable to each substructure consisting of differential problems involved in energy expressions and the elastic coupling conditions at junctions with these concerns the modified fourier series jin et al 2013 2014a 2014b su et al 2014 ye et al 2014 is invariably used to be the admissible functions for each substructure the function is composed of the conventional fourier series and auxiliary functions that can adapt arbitrary boundary and coupling conditions which can be written as 69 u i α i β i t d 0 1 m 0 n 0 a m n d i cos λ m i α i cos n β i π d 2 l 1 2 n 0 a l n d i ξ l α i cos n β i π d 2 e j ω t a m a l u i t 70 v i α i θ i t d 0 1 m 0 n 0 b m n d i cos λ m i α i cos n β i π d 2 l 1 2 n 0 b l n d i ξ l α i cos n β i π d 2 e j ω t b m b l v i t 71 w i α i β i t d 0 1 m 0 n 0 c m n d i cos λ m i α i cos n β i π d 2 l 1 4 n 0 c l n d i ς l α i cos n β i π d 2 e j ω t c m c l w i t where d 0 and 1 denote the even and odd circumferential modes respectively a m n d i a l n d i b m n d i b l n d i c m n d i c l n d i are the expansions coefficients corresponding to modal numbers which are listed in a m a l b m b l c m c l respectively whereas u m u l v m v l w m w l are respectively composed of corresponding admissible functions λ m i m π l i m n respectively are the meridional and circumferential mode number which are truncated at m and n in calculations ξ l α i and ς l α i respectively are the supplementary functions for in plane displacement components and normal displacement which are given jin et al 2017 as 72 ξ 1 α i α i α i l i 1 2 73 ξ 2 α i α i 2 l i α i l i 1 74 ς 1 α i 9 l i 4 π sin π α i 2 l i l i 12 π sin 3 π α 2 l i 75 ς 2 α i 9 l i 4 π cos π α i 2 l i l i 12 π cos 3 π α i 2 l i 76 ζ 3 α i l i 3 π 3 sin π α i 2 l i l i 3 3 π 3 sin 3 π α i 2 l i 77 ζ 4 α i l i 3 π 3 cos π α i 2 l i l i 3 3 π 3 cos 3 π α i 2 l i substituting eqs 69 77 into eq 68 and considering the coefficients involved in eqs 69 71 as independent generalized coordinates the task of solving vibro acoustic solution for the coupled structure involves simply seeking the proper expansion coefficients of the admissible functions in eqs 69 71 according to the hamilton principle these coefficients can be obtained through the variation proceeding as 78 l w θ 0 where θ represents the expansion coefficients in eqs 69 71 in general and then the dynamic equation for the submerged hull structure can be obtained as 79 k ω 2 m e l d f l where k and m are the generalized stiffness and mass matrices respectively which are given in ref jin et al 2017 f l denotes the generalized force vector e l is the matrix representing the effect of the external acoustic field acting on the hull structure and they can respectively written as 80 k k c p 11 c p 1 p 11 c l p 12 c p 2 p 12 c l 0 0 0 p 21 c p 1 k p 1 p 22 c p 1 0 0 0 0 p 21 c l 0 k l p 22 c l p 11 l p 2 p 11 l p 3 p 11 l s p 12 l p 2 p 12 l p 3 p 12 l s 0 0 p 21 l p 2 k p 2 p 22 l p 2 0 0 0 0 p 21 l p 3 0 k p 3 p 22 l p 3 0 0 0 p 21 l s 0 0 k s p 22 c s 81 m b l k d i a g m c m p 1 m l m p 2 m p 3 m s 82 f l f x u x f θ f f θ v x f θ f f r w x f θ f t 83 e l 2 l z n u m λ h λ 84 λ n z p ε n r 0 z p tan φ z p z n c ε n r z n c z p z n c n l 1 ε n r r 2 z p z n c n l 1 z n c n l 1 z p 85 h e c c n e c l n e c l n e s c n e s l n e s l n where the details of the k and m are referred to ref chen et al 2015 and 86 e c c n n u m p 2 m 6 2 n 1 m n 1 n 1 cos λ m c z p cos φ 87 e c c n n u m p 2 m 6 2 n 1 m 1 n 1 l 1 n 1 n 1 ζ l z p cos φ 88 e c l n n u m p 2 m 6 2 n 1 m n 1 n 1 cos λ m l z p z n c 89 e c l n n u m p 2 m 6 2 n 1 m 1 n 1 l 1 n 1 n 1 ζ l z p z n c 90 e c l n n u m p 2 m 6 2 n 1 m n 1 n 1 cos λ m s arccos z p z n c n x 1 r 91 e c l n n u m p 2 m 6 2 n 1 m 1 n 1 l 1 n 1 n 1 ζ l arccos z p z n c n x 1 r 92 e s c n n u m p 2 m 6 2 n 1 m 5 n 1 m n n cos λ m c z p cos φ 93 e c c n n u m p 2 m 6 2 n 1 m 5 n 1 m 1 n l 1 n n ζ l z p cos φ 94 e c l n n u m p 2 m 6 2 n 1 m 5 n 1 m n n cos λ m l z p z n c 95 e c l n n u m p 2 m 6 2 n 1 m 5 n 1 m 1 n l 1 n n ζ l z p z n c 96 e c l n n u m p 2 m 6 2 n 1 m 5 n 1 m n n cos λ m s arccos z p z n c n x 1 r 97 e c l n n u m p 2 m 6 2 n 1 m 5 n 1 m 1 n l 1 n n ζ l arccos z p z n c n x 1 r 3 results and discussion q e t 1 u t 2 q 0 numerical examples are conducted to validate the accuracy of the present method for predicting the vibration and acoustic responses of the coupled conical cylindrical hemispherical shell submerged in water the geometrical parameters of the coupled shell are given as r 0 0 2 m r 0 6 m h 0 008 m l l 4 5 m φ 0 15 and the coupled shell is made from steel with the material parameters are given as e 210 gpa μ 0 3 ρ 7800 kg m3 considering the effect of structural damping the complex young s modulus e is used as e e 1 j η where η 0 01 denotes the structural loss factor in the calculation the coupled shell is immersed in water of which the fluid density ρ f 1000 kg m3 and the sound velocity c f 1500 m s points o l l 4 0 a 2 l c 3 0 b l l 3 0 c 2 l l 3 d p i 4 0 on the surface with respect to local coordinate systems as shown in fig 4 are used to describe the vibro acoustic behaviors of the coupled shell the unit point force f w 0 0 1 is located at point o in the radial direction as the driving force since few vibration and acoustical results about the conical cylindrical spherical shell are reported in the literature the results obtained by the coupled fem and bem method through commercial ansys and virtual lab programs are used to validate the accuracy of the present method in which the shell63 elements are employed for the coupled shell and the direct boundary element approach is used the radial displacements and radiated sound pressures at the surface points of the submerged hull structure are given as shown in fig 5 some obvious discrepancies occur at some frequencies above 50 hz especially near the frequencies 60 hz and 80 hz which may be attributed to the insufficient modeling accuracy of the numerical model by fem bem in the higher frequency range however in general good agreement is observed between these two plots which validates the reliability and accuracy of the present method for predicting the vibro acoustic behaviors of submerged shell combinations under the point driving force the sound pressure contours of the coupled shell evaluated at 19 hz 47 hz and 95 hz respectively are depicted in fig 6 it is observed that the sound pressure on the surface of the cylindrical shell is higher than that in the truncated conical and hemispherical shells which means that radiated sound from the coupled shell is mainly contributed by the cylindrical shell in the frequency range from 0 hz to 100 hz in addition directivity plots of the near field sound pressure at points a b c and d are shown on the right side of fig 6 although the differences appear in the magnitude there are four central lobes for these four points at 19 hz as the frequency increases the number of central lobes for all points increases in complexity generally there are more central lobes for directivity patterns at points b and c than those at points a and d as the driving frequencies equal to 47 hz and 95 hz which implies that it is the cylindrical shell that makes the radiated sound of the coupled shell complicated in what follows the effects of external fluid ring stiffeners and bulkheads on the dynamic behaviors of the submerged hull structure will be evaluated through several numerical examples radial displacement responses in air and water at point o of the hull structure are shown in fig 7 in this example the density of the air is taken as 1 29 kg m3 and the sound velocity in the air is 340 m s from the results it can be found that the resonances of the hull structure immersed in water shift obviously towards low frequency compared with that in air which is due to large density of the water compared to the air as mentioned above the external fluid has great effect on the dynamic behaviors of the submerged hull structure which changes the radiated sound from the surface the radiated sound energy is the quantity to describe the sound radiation ability of vibrating structures the radiated sound energy from the hull structure in air and water are compared as shown in fig 8 from these two plots it can be seen that radiated sound energy from the hull structure submerged in water is higher and there are more resonances than that in air in the considered frequency range this result shows that the heavy fluid can result in high radiated sound compared to the light fluid fig 9 shows the effect of inner radius r a of the bulkhead on the radiated sound energy of the submerged hull structure as examples four different inner radii of bulkheads are considered as shown in the figure some resonance frequencies of the hull structure decrease with the increase of the inner radius which may be due to the fact that the stiffness of the submerged hull structure is large when the inner radius of bulkhead is small and it decreases as the inner radius increases however some resonance frequencies remain unchanged as the inner radius of bulkhead increases such as 5 hz which implies that the dynamical behaviors of the hull structure at these frequencies may be mainly dominated by other substructures rather than bulkheads the effect of bulkhead circular plate on the near field sound pressure of hull structure surface is examined fig 10 gives the near field sound pressure directivities of hull structure at 47 hz and point c with respect to two inner radii of bulkheads it can be seen that the sound pressure magnitude corresponding to r a 0 6 m is higher than that to r a 0 m furthermore the sound pressure directivity is changed the results show that the bulkhead has important influence on the sound pressure of hull structure surface radiated sound energy from the submerged hull structure with various number of ring stiffeners are shown in fig 11 it can be seen from the figure that most of the resonance frequencies increase as the number of ring stiffeners increase which is due to the fact that the ring stiffener can improve the stiffness of the hull structure however the first resonance frequency remains unchanged as the number of ring stiffeners increases of which the behavior is identical to that as the inner radius of bulkheads increases since the ring stiffeners are located at the inner surface of the hull structure and the dynamical behavior of the hull is dominated by other substructures rather than the cylindrical shell the ring stiffeners have little effect on the dynamical behavior of the hull at the first resonance frequency as the number of ring stiffeners increases the amplitude of the radiated sound energy from the submerged hull significantly decreases especially in higher frequency range generally the ring stiffeners have great effect on both resonance frequencies and sound radiation ability for the submerged hull structure the effect of stiffness of the 3d elastic coupler on the directivity patterns of the submerged hull structure is shown in fig 12 in which the points a c and d are evaluated at 19 hz and 47 hz the stiffness of the 3d elastic coupler has greater influence on the directivity pattern at point a among those three points and the magnitude increases as the stiffness increases which means that the sound radiation ability of the truncated conical shell is strengthened by increasing the rigidity and also greater effect of the stiffness is observed for the case at 19 hz than the case at 47 hz through the comparison of these figures especially at the point c generally at relatively low frequencies such as 19 hz large stiffness of the coupler results in similar behaviors of directivity patterns at these three points which implies that these substructures of the submerge hull vibrate as a whole structure with large stiffness of the 3d elastic coupler furthermore the stiffness has little effect on the sound radiation ability at the point d which means the hemispherical shell contributes little to vibro acoustic behaviors of the whole structure 4 conclusions the vibro acoustic behaviors of submerged hull structures are investigated by the energy based approach the modified fourier series spectral element method is developed to establish the structural model of the hull while one dimension helmholtz integral formulation is employed to describe the external acoustic field the full vibro acoustic coupling model is formulated by considering the work done by the external field acting on the hull surface the vibration and acoustic responses obtained by the present method agree well with those by the coupled bem fem approach which validates the accuracy of the present method to predict the vibro acoustic behaviors of such submerged hull structures several examples are calculated to investigate the effects of the external fluid medium the inner radius of bulkheads the number of ring stiffeners and stiffness parameters of 3d couplers on the vibro acoustic behaviors of the hull structure and the results show that heavy fluid medium large inner radius of internal bulkheads small number of ring stiffeners generally may lead to low resonance frequencies of the submerged hull from the view of given results the present method shows its ability to accurately predict the vibration and acoustic responses and provides clear physical insights into the vibro acoustic behaviors of complicated submerged hull structures since the geometry of the hull surface is not restricted in this paper and it is convenient to formulate the structural vibration energy and radiated sound energy of submerged structures with regards to the geometry of the hull surface the present method can be easily developed to conduct vibro acoustic analysis for other complicated submerged structures acknowledgement the national science foundation of china nos 51775125 51175098 and 51279035 and the fundamental research funds for the central universities of china are acknowledged heucfg201713 
23196,an energy based formulation for vibro acoustic analysis of submerged submarine hull structures guoyong jin a xianglong ma b wenyao wang a zhigang liu a a college of power and energy engineering harbin engineering university harbin 150001 pr china college of power and energy engineering harbin engineering university harbin 150001 pr china b shanghai marine equipment research institute shanghai 200031 pr china shanghai marine equipment research institute shanghai 200031 pr china corresponding author an energy based formulation is developed to investigate the vibro acoustic behaviors of the submarine hull immersed in heavy fluid in the present paper the conical cylindrical hemispherical coupled shell with bulkheads and ring stiffeners is considered as the theoretical model of the hull structure which is discretized into a number of spectral elements according to the structure type displacement components of each spectral element are invariably expressed by a set of modified fourier series the external acoustic field is described by one dimensional helmholtz integral formulation that can be solved by the means of discretization along the generator line of the hull structure subsequently the full vibro acoustic model for the submerged hull is established by taking into account the energy of the acoustic field acting on the hull surface the reliability and accuracy of the present method is validated by comparison of vibration and acoustic responses with those from the commercial softwares several examples are conducted to understand the effects of bulkheads ring stiffeners and coupling stiffnesses on the vibro acoustic behavior of the submerged hull which provides some helpful information in the design of underwater hull structures keywords vibro acoustic analysis modified fourier series submerged submarine hull 1 introduction the hull is the key structure of submarines to directly face the external fluid of which the vibration transmitted from the internal power machine and the propeller shafting system can result in a high level of radiated noise in practice the detectable noise may raise security problems for submarines in this regard the radiated sound from the hull structure must be reduced in an adequately low level indeed the sound radiated to the external fluid and the vibration of the hull structure influences each other for the submerged hull structure thus thoroughly understanding the dynamic behavior of the submerged hull depends greatly on the formulation of the fully coupled vibro acoustic system the acoustic problems of elastic structures reported in the literature are generally solved by the means of the helmholtz equations or the helmholtz integral formulation since the analytical solutions greatly depends on the geometry considerable attention in the related literature is just devoted to a small number of simple structures such as infinite circular cylinders and spherical shells junger and feit 1986 skelton and james 1997 ding and chen 1998 fahy and gardonio 2007 rather than the shells with complex geometry and coupled structures the literature concerning the sound radiation of elementary shells with complex geometry is rather limited to conical shells and elliptical cylindrical shells caresta and kessissoglou 2008 li et al 2014 as far as a coupled structure under water is concerned the approximate method that provides a possible solution attracts increasing attentions recently the finite element method fem and the boundary element bem method are two popular approaches to describe radiated sound field from submerged structures in early papers alfredson 1973 arlett et al 1968 chien et al 1990 without regard to the structural geometry the submerged structure is discretized into a number of elements by these two approaches to describe its vibro acoustic behavior in order to reduce the modeling cost the coupled bem bem method has been developed by jeans and mathews mathews 1986 jeans and mathews 1990 1993 peters et al 2014 to investigate the dynamic behavior of structures immersed in an infinite fluid medium in which the structure and the acoustic field are described by finite elements and boundary elements respectively although commercial software such as ansys and virtual lab popularize these two numerical methods the accuracy of them highly depends on element meshing especially for high frequency analysis which limits the use of these two methods to predict vibro acoustic behavior for the case with large size besides the variational principle is also usually used to predict the acoustic characteristics of submerged structures gladwell 1966 wu 1989 chen and ginsberg 1993 bjarnason et al 1994 choi et al 1995 recently the semi analytical method attracts increasingly more attention to dynamic analysis of submerged shells of revolution soenarko 1993 wang et al 1997 wright et al 2009 in which the displacement function in the circumferential direction is expanded by the fourier series due to axisymmetrical properties in this way only the discretization along the generator line of the shell is needed resulting in one dimensional helmholtz integral instead of the traditional two dimensional integral which can reduce much efforts to solve acoustic problems of submerged shell structures the fully vibro acoustic system for the submarine hull structure is established by caresta and kessissoglou 2010 in which the structural responses of the hull are calculated through solving dynamic equations for each substructures while the direct boundary element method is introduced to solve the one dimensional helmholtz integral formulations in ref caresta and kessissoglou 2010 the submarine hull is simplified as a cylindrical shell closed by truncated conical shells with internal bulkheads and ring stiffeners the semi analytical method is developed by qu et al 2015 to investigate the vibro acoustic behavior of submerged coupled spherical cylindrical spherical shells reinforced by ring stiffeners and longitudinal stringers in this study the modified variational method is used to formulate the coupled stiffened shell whereas the collocation approach is introduced to solve the helmholtz integral formulation chen et al chen et al 2015 xie et al 2017 developed an analytical method to analyze free and forced vibration characteristics of ring stiffened combined conical cylindrical shells in which power series wave functions and bessel functions are used to express the displacement functions of conical segment cylindrical segment and annular plate respectively wang 2016 developed a semi analytical method to analyze the vibration response of submerged stiffened combined shells by coupling the precise transfer matrix method ptmm and wave superposition method wsm from the review of the literature the modeling accuracy of vibro acoustic system depends on descriptions of both the structure and the external acoustic fluid in practice the submarine hull generally consists of the truncated conical shell the cylindrical shell the hemispherical shell the bulkheads and the reinforcement in particular there are usually some structural types repeated involved in the whole structure such as the bulkhead and ring stiffeners subsequently developing a more efficient and accurate method for such complex coupled structure is also of great significance to investigate the vibro acoustic behavior for the submerged cases the modified fourier series spectral element approach is developed by jin et al 2017 to formulate such hull structures as mentioned the modified fourier series proposed originally by li 2000 is composed of a fourier series and auxiliary functions which can adapt arbitrary boundary and coupling conditions in ref jin et al 2017 the built up structure including repeated substructures is discretized as a number of spectral elements according to the structure type while the modified fourier series is invariably used to describe displacement components of each spectral element in the present work an energy based formulation is developed to analyze the vibro acoustic behaviors of submerged submarine hull structure which is simplified and modeled as a conical cylindrical hemispherical coupled shell with bulkheads and ring stiffeners for such complicated structures immersed in a heavy fluid medium the modified fourier series spectral element method is used to formulate the structural model while the external acoustic field is described by one dimensional helmholtz integral formulation that can be solved by the means of discretization into the system of linear equations the work done by the external acoustic field acting on the hull surface is considered to formulate the strong coupling relationship between the structural response and radiated sound pressure the accuracy of the present method is validated by comparison of vibration and acoustic responses with those from the commercial software several examples are conducted to investigate the effects of the bulkhead ring stiffener and coupling stiffness on the vibro acoustic behaviors of the submerged hull 2 theoretical formulation 2 1 model description the hull structure considered in the presented paper is a circular cylindrical shell closed at ends with truncated conical and hemispherical caps respectively as shown in fig 1 the cylindrical shell is reinforced by n r ring stiffeners that can be arbitrary in number size and space arrangement besides the internal space of the coupled shell is separated by bulkheads that are uniformly modeled as thin annular plates with inner radius r a the conical shell is truncated with left radius r 0 semi vertex angle φ 0 and length l c along the generator line whereas l l represents the length of the cylindrical shell with radius r as the spherical shell generally the truncated conical cylindrical and hemispherical shells as well as bulkheads are independently described by orthogonal coordinate systems x i θ i r i in which the subscript i c l s p respectively specifically x i is measured along the generator line where as θ i represents the circumferential direction and r i is the normal direction of the middle surface the displacement components of these shells in the x i θ i and r i directions are respectively denoted by u i v i and w i which can be written as 1 u i u x i θ i e j ω t 2 v i v x i θ i e j ω t 3 w i w x i θ i e j ω t where j 1 ω is the frequency and t represents the time the thickness of the shell components and annular plates is assumed to be uniform and adequately small compared to other geometrical parameters which makes the thin plate and shell theories applicable furthermore it is assumed that all the shell sub structures annular plates and ring stiffeners are made of same materials with young s modulus e poisson ratio μ and mass density ρ as the hull structure is immersed in an unbounded fluid a fully coupled vibro acoustic system is considered through the strong coupling between the vibration of the shell structure and the external sound field according to the energy principle the strong vibro acoustic coupling can be simulated by taking into account the energy of the external sound working on the shell surface under the framework the whole energy functional of the submerged hull structure consists of two components including the structural vibration energy and radiated sound energy the so called radiated sound energy is defined as the work done by the external acoustic field acting on the hull surface in what follows these two energy expressions are theoretical formulated respectively 2 2 structural vibration energy since the annular plate and the ring stiffener of same geometrical parameters are repeated employed in the present model the spectral element approach is introduced to reduce the cost of theoretical formulation development of the structural model of the hull structure is based on the modified fourier spectral element approach by the authors jin et al 2017 according to different structural geometries the hull structure is divided into five spectral elements including the truncated conical shell the cylindrical shell the hemispherical shell the annular plate and the ring stiffener the strain displacement equations for these spectral elements are given as follows according to the raissner theory the mid surface strains curvatures and twist changes of the shells and the annular plate can be uniformly expressed as 4 ε x i 1 a i u i x i μ a i b i a i θ i w i r x i 5 ε θ i 1 b i v i θ i u i a i b i b i x i w i r θ i 6 γ x i θ i a i b i θ i u i a i b i a i x i v i b i 7 k x i 1 a i x i u i r x i 1 a i w i x i 1 a i b i v i r θ i 1 b i w i θ i a i θ i 8 k θ i 1 b i θ i v i r θ i 1 b i w i θ i 1 a i b i u i r x i 1 a i w i θ i b i x i 9 τ x i θ i a i b i θ i u i a r x i 1 a i 2 w i x i b i a i v i b r θ i 1 b i 2 w i θ i where a i and b i are lamé parameters r x i and r θ i denote principle radii of curvature respectively in x i and θ i directions as listed in table 1 then the strain energy v i and the kinetic energy t i of each spectral element can be expressed as 10 v i k 2 s x θ ε x i 2 ε β i 2 2 μ ε x i ε θ i 1 μ 2 γ x i θ i 2 a i b i d x i d θ i d e 2 s x θ k x i 2 k β i 2 2 μ k x i k θ i 1 μ 2 τ x i θ i 2 a i b i d x i d θ i and 11 t i ρ h 2 s x θ u i t 2 v i t 2 w i t 2 a i b i d x i d θ i where k e h 1 μ 2 and d e e h 3 12 1 μ 2 are the extensional and flexural rigidities respectively in order to fully and accurately assemble these spectral elements as a whole structure three dimensional 3d elastic couplers are employed to formulate continuity and boundary conditions the 3d coupler is a artificial stiffness like spring system composed of three translational stiffnesses k x i i k θ i i k r i i and one rotational stiffness k w i i which provides coupling conditions in four directions since the shell structures and the annular plate considered in the present paper are rotational structures the cylindrical coordinate system is utilized to describe the continuity conditions at the junctions as shown in fig 1 four types of continuity conditions are involved in the hull structure including cone plate cone cylinder cylinder plate and cylinder sphere subjected to the cylindrical coordinate system these continuity conditions can be uniformly written with lamé parameters as 12 n x i cos θ i q x a 1 r θ i m x θ i θ i sin θ i ϒ n x i cos θ i q x i 1 r θ i m x θ i θ i sin θ i k x i i u i cos θ i w i sin θ i ϒ u i cos θ i w i sin θ i k x i i δ x i i 13 n x θ i n x θ i k θ i i v i ϒ v i k θ i i δ θ i i 14 n x i sin θ i q x i 1 r θ i m x θ i θ i cos θ i ϒ n x i sin θ i q x i 1 r θ i m x θ i θ i cos θ i k r i i u i sin θ i w i cos θ i ϒ u i sin θ i w i cos θ i k r i i δ r i i 15 m x i ϒ m x i k w i i w i α i u i r x i ϒ w i x i u i r x i k w i i δ w i i where ϒ 1 and 1 denotes the relative position factor n α i and n α β i are the in plane forces q α i is the transverse shear forces and m α i and m α β i are the bending and twist moments as shown in fig 2 from eqs 12 15 and fig 2 it can be found that all force and displacement components at each junction are fully coordinated by these four stiffness parameters which theoretically validates the accuracy and efficiency of 3d coupler to describe the continuity conditions of the hull structure thus arbitrary continuity conditions can be easily achieved just by varying stiffness of the coupler under the framework the energy caused by continuity conditions at arbitrary one junction can be uniformly written as 16 v c 1 2 0 2 π k x i i δ x i i 2 k θ i i δ θ i i 2 k r i i δ r i i 2 k w i i δ w i i 2 a l d θ as far as boundary conditions are concerned 3d couplers are used at the boundaries of the hull structure including the left boundary of the conical shell and the inner boundaries of the annular plates whereas the other ends of boundary couplers is clamped the direction arrangement of stiffness like springs in boundary couplers is subjected to the local coordinate system thus the boundary conditions of the hull structure can be expressed as 17 n x i k x i u i 18 n x θ i k θ i v i 19 q x i 1 r θ m x θ i θ i k r i w i 20 m x i k w i w i x i u i r x i where k x i k θ i k r i and k w i are stiffness parameters of boundary couplers it is observed from eqs 17 20 and fig 2 that all of forces and moments at boundaries of the hull structure are completely restrained the strain energy stored in the boundary couplers can be written as 21 v b 1 2 0 2 π k x i u i 2 k θ i v i 2 k r i w i 2 k w i w i x i 2 a i d θ i to achieve the accurate solution and simplify modeling procedure the ring stiffener is considered as the discrete structure of which the vibration behavior is described by the cylindrical shell without regard to cross section shape the displacement components of the ring stiffener can be expressed by those of the cylindrical shell as 22 u r l j u l e w l x l x l x l j 23 v r l j v l 1 e r e r w l θ l x l x l j 24 w r l j w l x l x l j where e denotes the eccentricity of the ring stiffener x l j is the position of the l j th ring stiffener located on the cylindrical shell taking the effects of stretching biaxial bending and wrapping into account the strain energy of the stiffeners can be written as 25 v r e 2 l j 1 n r 0 2 π i r k 1 2 i x k 2 2 a r e g 2 1 2 1 μ j r γ 2 d θ l where i r and i x are the second area moments with respect to r and x directions respectively a r is the cross sectional area of the stiffener j r represents the torsional rigidity and k 1 k 2 e g and γ can be expressed as 26 k 1 1 r e w r s n x l 1 r e 2 u r s n θ l 2 27 k 2 1 r e 2 w r j 2 w r s n θ l 2 28 e g 1 r e v r j θ l w r s n 29 γ 1 r e 2 w r s n x l θ l 1 r e u r s n θ l the kinetic energy of ring stiffeners with effects of the tri axial translational inertia and rotary inertia about x and r directions are given as 30 t p ρ 2 s n 1 n r 0 2 π a r u r t 2 v r t 2 w r t 2 i r i x i p t w r s n x 2 x l x s n d θ l 2 3 radiated sound energy as shown in fig 3 the acoustic field is described by a global coordinate system r θ z of which the origin is located at the geometrical center of the ring stiffened cylindrical shell where r is the direction of original point o pointing to the field point θ is the circumferential direction and z is the axial direction the sound pressure s p at a field point h r θ z can be written by the kirchhoff helmholtz integral formulation as 31 c h s p h 1 4 π s 0 s p h 0 g h h 0 n 0 g h h 0 s p h 0 n 0 d s 0 where c h is the coefficient determined by the position of the field point h r θ z h0 r 0 θ 0 z 0 is a point on the surface of the hull structure n 0 denotes the normal direction to the surface of the hull structure g h h 0 represents the free space green s function that can be expressed as 32 g h h 0 e j k f d r d r 33 d r h 2 h 0 2 r 2 r 0 2 2 r r 0 cos θ θ 0 z z 0 2 where the acoustic wave number k f ω c f and c f denotes the speed of sound in the fluid since the normal directions of the truncated conical cylindrical and hemispherical shells are different from each others the outward normal derivatives r n 0 and z n 0 can be uniformly expressed by α i and β i respectively as listed in table 2 due to the fact that the coupled shell are axisymetrical structure w h s p h g h h 0 g h h 0 n 0 can be expanded by the fourier series in the circumferential direction as 34 w h n 0 n w c r n z cos n θ n 1 n w s r n z sin n θ 35 s p h n 0 n p c r n z cos n θ n 1 n p s r n z sin n θ 36 g h h 0 n 0 n g r n z cos n θ cos n θ 0 n 1 n g r n z sin n θ sin n θ 0 37 g h h 0 n 0 n 0 n g r n z cos n θ cos n θ 0 n 1 n g r n z sin n θ sin n θ 0 where n is the circumferential modal number n is the truncated number for n and ψ g r n z and g r n z can be expressed respectively as 38 ψ θ θ 0 39 g r n z 1 π 0 π e j k f d r d r cos n ψ d ψ 40 g r n z 1 π 0 π i k f 1 d r e j k f d r d r 2 r 0 r cos ψ α i z 0 z β i cos n ψ d ψ the relationship between the sound pressure s p h0 and the normal displacement component w h0 at the surface of the hull structure is given as 41 s p h 0 n 0 ρ f ω 2 w h 0 substituting eqs 34 37 and 41 into eq 31 the helmholtz integral formulation for the hull structure in the present paper can be expressed as 42 c r z p c r n z 1 2 0 l z p c r n z g h h 0 n 0 ρ f ω 2 w r 0 n z 0 r 0 α i d z 0 with consideration of discontinuity of the surface curvature at the junctions the coefficient c r z in eq 42 can be written as 43 c r z 1 2 π 0 l z g h h 0 n 0 r 0 α i d z 0 44 g h h 0 1 π 0 π 1 4 π d r cos n ψ d ψ the sound pressure at the field point related to the normal displacement component of the hull structure is given as eq 42 however the quantity p c r n z exists at both sides of the equation which makes it difficult to achieve solution directly thus a direct boundary element method is introduced to calculate the sound pressure in the acoustic field the surface of the hull structure is scattered into n um nodes along axial direction including n c n l n s nodes respectively on the surfaces of the truncated conical cylindrical and hemispherical shells the axial coordinates for these nodes can be expressed as 45 z z 1 z 2 z g z n u m 1 g n u m then the helmholtz integral at the right hand of eq 41 is discretized into the sum of integrals between the adjacent two points as 46 c q p q 1 2 g 1 n u m 1 a g q b g q p g p g 1 c g q d g q w g w g 1 0 1 q n u m where 47 c q c r q z q 48 p q p c r q n z q 49 w g w g c w g l w g s t 50 a g q a g q c a g q l a g q s 51 b g q b g q c b g q l b g q s 52 c g q c g q c c g q l c g q s 53 d g q d g q c d g q l d g q s and the sub matrices in a g q b g q c g q d g q are given as 54 a g q i 1 z g 1 z g z g z g 1 z g 1 z g r q r 0 n z q z r 0 α i d z 55 b g q i 1 z g 1 z g z g z g 1 z z g g r q r 0 n z q z r 0 α i d z 56 c g q i ρ f ω 2 z g 1 z g z g z g 1 z g 1 z g r q r 0 n z q z r 0 α i d z 57 d g q i ρ f ω 2 z g 1 z g z g z g 1 z z g g r q r 0 n z q z r 0 α i d z substituting every adjacent two points in eq 45 into eq 46 the expression coefficients of radiated sound pressure s p with circumferential mode number n is obtained in the form of a system of linear equations as 58 p n h n 1 c n w n where 59 c n c t 0 n u m 1 0 n u m 1 d t 60 h n diag c 1 c n a t 0 n u m 1 0 n u m 1 b t 61 a 1 2 a 1 1 a 1 n u m a n u m 1 1 a n u m 1 n u m 62 b 1 2 b 1 1 b 1 n u m b n u m 1 1 b n u m 1 n u m 63 c 1 2 c 1 1 c 1 n u m c n u m 1 1 c n u m 1 n u m 64 d 1 2 d 1 1 d 1 n u m d n u m 1 1 d n u m 1 n u m then the radiated sound pressure can be achieved by assembling eq 58 with regard to the circumferential mode number n as 65 p c n p s n h n 1 c n 0 0 h n 1 c n w c n w s n where p c n and p s n are respectively are the coefficient vectors for p c and p s w c n and w s n are respectively the coefficient vectors for displacement response with respect to even and odd circumferential modal the work caused by the acoustic field acting on the surface of the hull structure can be obtained as 66 e w s 0 s p h 0 w h 0 d s 0 2 4 dynamic equation for the submerged hull structure besides the structural vibration energy and the radiated sound energy the energy functional of the external driving force is also formulated in the paper as the classical driving force type the point force f x f θ f r is considered to understand the dynamic behavior of the submarine structure where f x f θ f r denote respectively the forces in x i θ i and r i directions the potential energy e f of the point force can be written as 67 e f 0 2 π 0 l i f x f θ f r u i v i w i t δ x i x f θ i θ f a i b i d x i d θ i where x f θ f is the location coordinates of the driving force based on the structural vibration energy and the radiated sound energy the lagrange energy function for the submerged hull structure can be written as 68 l w v c v b e w e f i c p l s v i t i l j 1 n r v r j t r j the proper admissible displacement function is the key to achieve accurate solution for eq 68 for the complicated hull structure the admissible function must be applicable to each substructure consisting of differential problems involved in energy expressions and the elastic coupling conditions at junctions with these concerns the modified fourier series jin et al 2013 2014a 2014b su et al 2014 ye et al 2014 is invariably used to be the admissible functions for each substructure the function is composed of the conventional fourier series and auxiliary functions that can adapt arbitrary boundary and coupling conditions which can be written as 69 u i α i β i t d 0 1 m 0 n 0 a m n d i cos λ m i α i cos n β i π d 2 l 1 2 n 0 a l n d i ξ l α i cos n β i π d 2 e j ω t a m a l u i t 70 v i α i θ i t d 0 1 m 0 n 0 b m n d i cos λ m i α i cos n β i π d 2 l 1 2 n 0 b l n d i ξ l α i cos n β i π d 2 e j ω t b m b l v i t 71 w i α i β i t d 0 1 m 0 n 0 c m n d i cos λ m i α i cos n β i π d 2 l 1 4 n 0 c l n d i ς l α i cos n β i π d 2 e j ω t c m c l w i t where d 0 and 1 denote the even and odd circumferential modes respectively a m n d i a l n d i b m n d i b l n d i c m n d i c l n d i are the expansions coefficients corresponding to modal numbers which are listed in a m a l b m b l c m c l respectively whereas u m u l v m v l w m w l are respectively composed of corresponding admissible functions λ m i m π l i m n respectively are the meridional and circumferential mode number which are truncated at m and n in calculations ξ l α i and ς l α i respectively are the supplementary functions for in plane displacement components and normal displacement which are given jin et al 2017 as 72 ξ 1 α i α i α i l i 1 2 73 ξ 2 α i α i 2 l i α i l i 1 74 ς 1 α i 9 l i 4 π sin π α i 2 l i l i 12 π sin 3 π α 2 l i 75 ς 2 α i 9 l i 4 π cos π α i 2 l i l i 12 π cos 3 π α i 2 l i 76 ζ 3 α i l i 3 π 3 sin π α i 2 l i l i 3 3 π 3 sin 3 π α i 2 l i 77 ζ 4 α i l i 3 π 3 cos π α i 2 l i l i 3 3 π 3 cos 3 π α i 2 l i substituting eqs 69 77 into eq 68 and considering the coefficients involved in eqs 69 71 as independent generalized coordinates the task of solving vibro acoustic solution for the coupled structure involves simply seeking the proper expansion coefficients of the admissible functions in eqs 69 71 according to the hamilton principle these coefficients can be obtained through the variation proceeding as 78 l w θ 0 where θ represents the expansion coefficients in eqs 69 71 in general and then the dynamic equation for the submerged hull structure can be obtained as 79 k ω 2 m e l d f l where k and m are the generalized stiffness and mass matrices respectively which are given in ref jin et al 2017 f l denotes the generalized force vector e l is the matrix representing the effect of the external acoustic field acting on the hull structure and they can respectively written as 80 k k c p 11 c p 1 p 11 c l p 12 c p 2 p 12 c l 0 0 0 p 21 c p 1 k p 1 p 22 c p 1 0 0 0 0 p 21 c l 0 k l p 22 c l p 11 l p 2 p 11 l p 3 p 11 l s p 12 l p 2 p 12 l p 3 p 12 l s 0 0 p 21 l p 2 k p 2 p 22 l p 2 0 0 0 0 p 21 l p 3 0 k p 3 p 22 l p 3 0 0 0 p 21 l s 0 0 k s p 22 c s 81 m b l k d i a g m c m p 1 m l m p 2 m p 3 m s 82 f l f x u x f θ f f θ v x f θ f f r w x f θ f t 83 e l 2 l z n u m λ h λ 84 λ n z p ε n r 0 z p tan φ z p z n c ε n r z n c z p z n c n l 1 ε n r r 2 z p z n c n l 1 z n c n l 1 z p 85 h e c c n e c l n e c l n e s c n e s l n e s l n where the details of the k and m are referred to ref chen et al 2015 and 86 e c c n n u m p 2 m 6 2 n 1 m n 1 n 1 cos λ m c z p cos φ 87 e c c n n u m p 2 m 6 2 n 1 m 1 n 1 l 1 n 1 n 1 ζ l z p cos φ 88 e c l n n u m p 2 m 6 2 n 1 m n 1 n 1 cos λ m l z p z n c 89 e c l n n u m p 2 m 6 2 n 1 m 1 n 1 l 1 n 1 n 1 ζ l z p z n c 90 e c l n n u m p 2 m 6 2 n 1 m n 1 n 1 cos λ m s arccos z p z n c n x 1 r 91 e c l n n u m p 2 m 6 2 n 1 m 1 n 1 l 1 n 1 n 1 ζ l arccos z p z n c n x 1 r 92 e s c n n u m p 2 m 6 2 n 1 m 5 n 1 m n n cos λ m c z p cos φ 93 e c c n n u m p 2 m 6 2 n 1 m 5 n 1 m 1 n l 1 n n ζ l z p cos φ 94 e c l n n u m p 2 m 6 2 n 1 m 5 n 1 m n n cos λ m l z p z n c 95 e c l n n u m p 2 m 6 2 n 1 m 5 n 1 m 1 n l 1 n n ζ l z p z n c 96 e c l n n u m p 2 m 6 2 n 1 m 5 n 1 m n n cos λ m s arccos z p z n c n x 1 r 97 e c l n n u m p 2 m 6 2 n 1 m 5 n 1 m 1 n l 1 n n ζ l arccos z p z n c n x 1 r 3 results and discussion q e t 1 u t 2 q 0 numerical examples are conducted to validate the accuracy of the present method for predicting the vibration and acoustic responses of the coupled conical cylindrical hemispherical shell submerged in water the geometrical parameters of the coupled shell are given as r 0 0 2 m r 0 6 m h 0 008 m l l 4 5 m φ 0 15 and the coupled shell is made from steel with the material parameters are given as e 210 gpa μ 0 3 ρ 7800 kg m3 considering the effect of structural damping the complex young s modulus e is used as e e 1 j η where η 0 01 denotes the structural loss factor in the calculation the coupled shell is immersed in water of which the fluid density ρ f 1000 kg m3 and the sound velocity c f 1500 m s points o l l 4 0 a 2 l c 3 0 b l l 3 0 c 2 l l 3 d p i 4 0 on the surface with respect to local coordinate systems as shown in fig 4 are used to describe the vibro acoustic behaviors of the coupled shell the unit point force f w 0 0 1 is located at point o in the radial direction as the driving force since few vibration and acoustical results about the conical cylindrical spherical shell are reported in the literature the results obtained by the coupled fem and bem method through commercial ansys and virtual lab programs are used to validate the accuracy of the present method in which the shell63 elements are employed for the coupled shell and the direct boundary element approach is used the radial displacements and radiated sound pressures at the surface points of the submerged hull structure are given as shown in fig 5 some obvious discrepancies occur at some frequencies above 50 hz especially near the frequencies 60 hz and 80 hz which may be attributed to the insufficient modeling accuracy of the numerical model by fem bem in the higher frequency range however in general good agreement is observed between these two plots which validates the reliability and accuracy of the present method for predicting the vibro acoustic behaviors of submerged shell combinations under the point driving force the sound pressure contours of the coupled shell evaluated at 19 hz 47 hz and 95 hz respectively are depicted in fig 6 it is observed that the sound pressure on the surface of the cylindrical shell is higher than that in the truncated conical and hemispherical shells which means that radiated sound from the coupled shell is mainly contributed by the cylindrical shell in the frequency range from 0 hz to 100 hz in addition directivity plots of the near field sound pressure at points a b c and d are shown on the right side of fig 6 although the differences appear in the magnitude there are four central lobes for these four points at 19 hz as the frequency increases the number of central lobes for all points increases in complexity generally there are more central lobes for directivity patterns at points b and c than those at points a and d as the driving frequencies equal to 47 hz and 95 hz which implies that it is the cylindrical shell that makes the radiated sound of the coupled shell complicated in what follows the effects of external fluid ring stiffeners and bulkheads on the dynamic behaviors of the submerged hull structure will be evaluated through several numerical examples radial displacement responses in air and water at point o of the hull structure are shown in fig 7 in this example the density of the air is taken as 1 29 kg m3 and the sound velocity in the air is 340 m s from the results it can be found that the resonances of the hull structure immersed in water shift obviously towards low frequency compared with that in air which is due to large density of the water compared to the air as mentioned above the external fluid has great effect on the dynamic behaviors of the submerged hull structure which changes the radiated sound from the surface the radiated sound energy is the quantity to describe the sound radiation ability of vibrating structures the radiated sound energy from the hull structure in air and water are compared as shown in fig 8 from these two plots it can be seen that radiated sound energy from the hull structure submerged in water is higher and there are more resonances than that in air in the considered frequency range this result shows that the heavy fluid can result in high radiated sound compared to the light fluid fig 9 shows the effect of inner radius r a of the bulkhead on the radiated sound energy of the submerged hull structure as examples four different inner radii of bulkheads are considered as shown in the figure some resonance frequencies of the hull structure decrease with the increase of the inner radius which may be due to the fact that the stiffness of the submerged hull structure is large when the inner radius of bulkhead is small and it decreases as the inner radius increases however some resonance frequencies remain unchanged as the inner radius of bulkhead increases such as 5 hz which implies that the dynamical behaviors of the hull structure at these frequencies may be mainly dominated by other substructures rather than bulkheads the effect of bulkhead circular plate on the near field sound pressure of hull structure surface is examined fig 10 gives the near field sound pressure directivities of hull structure at 47 hz and point c with respect to two inner radii of bulkheads it can be seen that the sound pressure magnitude corresponding to r a 0 6 m is higher than that to r a 0 m furthermore the sound pressure directivity is changed the results show that the bulkhead has important influence on the sound pressure of hull structure surface radiated sound energy from the submerged hull structure with various number of ring stiffeners are shown in fig 11 it can be seen from the figure that most of the resonance frequencies increase as the number of ring stiffeners increase which is due to the fact that the ring stiffener can improve the stiffness of the hull structure however the first resonance frequency remains unchanged as the number of ring stiffeners increases of which the behavior is identical to that as the inner radius of bulkheads increases since the ring stiffeners are located at the inner surface of the hull structure and the dynamical behavior of the hull is dominated by other substructures rather than the cylindrical shell the ring stiffeners have little effect on the dynamical behavior of the hull at the first resonance frequency as the number of ring stiffeners increases the amplitude of the radiated sound energy from the submerged hull significantly decreases especially in higher frequency range generally the ring stiffeners have great effect on both resonance frequencies and sound radiation ability for the submerged hull structure the effect of stiffness of the 3d elastic coupler on the directivity patterns of the submerged hull structure is shown in fig 12 in which the points a c and d are evaluated at 19 hz and 47 hz the stiffness of the 3d elastic coupler has greater influence on the directivity pattern at point a among those three points and the magnitude increases as the stiffness increases which means that the sound radiation ability of the truncated conical shell is strengthened by increasing the rigidity and also greater effect of the stiffness is observed for the case at 19 hz than the case at 47 hz through the comparison of these figures especially at the point c generally at relatively low frequencies such as 19 hz large stiffness of the coupler results in similar behaviors of directivity patterns at these three points which implies that these substructures of the submerge hull vibrate as a whole structure with large stiffness of the 3d elastic coupler furthermore the stiffness has little effect on the sound radiation ability at the point d which means the hemispherical shell contributes little to vibro acoustic behaviors of the whole structure 4 conclusions the vibro acoustic behaviors of submerged hull structures are investigated by the energy based approach the modified fourier series spectral element method is developed to establish the structural model of the hull while one dimension helmholtz integral formulation is employed to describe the external acoustic field the full vibro acoustic coupling model is formulated by considering the work done by the external field acting on the hull surface the vibration and acoustic responses obtained by the present method agree well with those by the coupled bem fem approach which validates the accuracy of the present method to predict the vibro acoustic behaviors of such submerged hull structures several examples are calculated to investigate the effects of the external fluid medium the inner radius of bulkheads the number of ring stiffeners and stiffness parameters of 3d couplers on the vibro acoustic behaviors of the hull structure and the results show that heavy fluid medium large inner radius of internal bulkheads small number of ring stiffeners generally may lead to low resonance frequencies of the submerged hull from the view of given results the present method shows its ability to accurately predict the vibration and acoustic responses and provides clear physical insights into the vibro acoustic behaviors of complicated submerged hull structures since the geometry of the hull surface is not restricted in this paper and it is convenient to formulate the structural vibration energy and radiated sound energy of submerged structures with regards to the geometry of the hull surface the present method can be easily developed to conduct vibro acoustic analysis for other complicated submerged structures acknowledgement the national science foundation of china nos 51775125 51175098 and 51279035 and the fundamental research funds for the central universities of china are acknowledged heucfg201713 
23197,static drift pure sway and pure yaw simulation results are determined for a container ship for simulation open source rans solver openfoam was used the simulation results were compared with two sets of experimental data next hydrodynamic derivatives were predicted from simulation results and compared with experimental ones the results show good agreement with experimental data except for some pure yaw cases overall the paper concludes that openfoam is well capable of estimating hydrodynamic derivatives maintaining reasonable accuracy and computational efficiency keywords static drift pure sway pure yaw pmm hydrodynamic derivatives kcs openfoam 1 introduction maneuverability prediction in the design stage is among the key requirements in ship design to ensure safety and reliability traditionally ship maneuverability characteristics are determined using model tests which are both expensive and time consuming however with the development of different computational fluid dynamics cfd tools and improvement in computational power designers and researchers are focusing more on cfd to predict ship s seakeeping and maneuverability characteristics ship designers use a number of ways to predict ship maneuverability characteristics in design stage like theoretical approach utilization of full scale database application of empirical method kijima and nakiri 2003 model test sutulo and guedes soares 2006 and numerical approach using cfd theoretical approaches are mostly limited to slender bodies and fail to consider hull and appendage interaction utilization of full scale data is only possible when similar ship models are already in operation applications of empirical formulas are also limited to particular hull forms or availability of data model tests are among the most popular methods for maneuverability prediction one common method used in the experimental study to determine ship maneuverability properties is the captive model test which includes oblique towing test ott rotating arm test rat circular motion test cmt and planar motion mechanism pmm similar tests can also be performed using cfd depending on the capabilities and extent of the solver being used the incorporation of cfd in ship maneuverability prediction has been relatively recent most of the early works related to cfd based maneuvering were focused on planar motion mechanism pmm simulations among the early researchers to discuss ship maneuverability using cfd were simonsen and stern 2005 cura hochbaum 2006 and wilson et al 2006 however pmm simulations were first widely discussed in simman 2008 workshop simman 2008 where different research groups presented static drift pure sway and pure yaw simulation results broglia et al 2008 showed pure sway and pure yaw motion results for kvlcc1 and 2 models with propeller and rudder simulated using a solver developed by insean cura hochbaum et al 2008 simulated static drift pure sway and pure yaw case for the two tanker models with propeller and rudder using a self developed code gullmineau et al 2008 provided pmm results for us navy frigate using isis cfd solver miller 2008 provided pmm calculation for dtmb 5415 using cfdship iowa wang et al 2011 simulated oblique motion for kvlcc2 in deep and shallow water using commercial code fluent simonsen et al 2012 presented zig zag turning circle and pmm results for an appended kcs model using star ccm and compared them with experimental data lee et al 2015 performed pmm simulation for a wind turbine installation vessel using openfoam ignoring free surface calculation later shen et al 2015 incorporated dynamic overset grid in openfoam and presented zig zag simulation results with self propulsion kim et al 2015 presented pmm simulation results for kcs model using in house code ship motion and predicted hydrodynamic derivatives from simulation results hajivand and mousavizadegan 2015a b also performed pmm simulation using star ccm and openfoam static drift only for dtmb 5512 model and predicted hydrodynamic derivatives from the simulation results recently yao et al 2016 presented static drift turning and pure sway simulation data using openfoam for tanker model kvlcc2 although maneuvering related simulations are gaining popularity lately their applications are mostly limited to large research groups and designers who have sufficient resources and access to well developed in house or commercial codes an alternative and economic solution to commercial and in house codes may be the use of the open source cfd toolkit openfoam several researchers have already demonstrated the capability of openfoam in performing maneuverability based simulations for different ship models however they were either limited to static cases or avoided free surface consideration furthermore existing papers do not discuss about the required settings for running such simulations this paper aims at contributing to the field by presenting static drift pure sway and pure yaw simulation results for a container ship model kcs using openfoam and estimating the hydrodynamic derivatives for it the paper aims at demonstrating openfoam s capability in performing maneuvering simulations with detail regarding the mesh dependency and related solver setup it also intends to show that the toolkit is able to perform maneuvering simulations with reasonable accuracy good efficiency and economy 2 method 2 1 simulation solver 2 1 1 mathematical model openfoam open field operation and manipulation is an open source library written in c language following object oriented paradigm the code is available under gnu general public license gpl it can be used to numerically solve a wide range of problems in fluid dynamics from laminar to turbulent flows with single and multi phases it can solve both structured and unstructured polyhedral meshes including h refinement or hanging nodes and contains an extensive range of solvers to perform different types of cfd simulations it has several packages to perform multiphase turbulent flow simulation for floating objects openfoam also allows relatively easy customization and modification of solvers because of its modular design the solver has been elaborately described by jasak 1996 2009 the openfoam solver used to perform ship hydrodynamic simulations for this paper simulates incompressible two phase flow the governing equations for the solver are the navier stokes equation 1 and continuity equation 2 for an incompressible laminar flow of a newtonian fluid in vector form the navier stokes and continuity equation are given by 1 ρ v t v v p μ 2 v ρ g 2 v 0 where v is the velocity p is the pressure μ is the dynamic viscosity g is acceleration due to gravity and 2 is the laplace operator further the continuity equation is of the form the volume of fluid vof method is used to model fluid as one continuum of mixed properties this vof method determines the fraction of each fluid that exists in each cell thus tracks the free surface elevation the equation for the volume fraction is obtained as 3 α t α u 0 where u is the velocity field α is the volume fraction of water in the cell and varies from 0 to 1 full of air to full of water respectively the unstructured collocated finite volume method fvm using gauss theorem together with user defined and implemented solution algorithm and time integration schemes drikakis et al 2007 is used to discretize the governing equations time integration is performed by a semi implicit second order two point backward differencing scheme pressure velocity coupling is obtained through pimple algorithm ferziger and peric 2008 a combination of simple and piso openfoam incorporates three different turbulence models k ε k ω and sst k ω turbulence is discretized using a 2nd order upwind difference turbulence for the presented simulations was modeled with the reynolds averaged stress ras sst k ω two equation model the parameters were calculated using common guidelines from an earlier study labanti et al 2016 2 1 2 coordinate system openfoam follows a cartesian coordinate system if not specified otherwise all systems are based on an origin point and coordinate rotation the solver has a local and a global coordinate system the local coordinate system is used to define the simulation domain comparing to global reference point the global and local coordinate system might be same or different depending on the simulation in ship simulation where there is flowing fluid the local and global coordinates both are defined using cartesian coordinate system the local coordinate systems are generally right handed the x axis is positive from stern to bow direction y is positive at star board side and z is positive upwards as shown in fig 1 2 1 3 boundary conditions the control volume represented a deep water condition so the two lateral sides and the bottom were symmetry plane type faces no additional information was required for this kind of boundary condition inlet outlet and atmosphere were patch faces with specific boundary condition for each one and hull had a wall type boundary for the presented simulation cases boundary conditions used for the fluid properties and turbulence parameters are as shown in table 1 here fv is fixedvalue dirichlet boundary condition specified by the user opmv is outlet phase mean velocity piov is pressure inlet outlet velocity that applies zero gradient for outflow whilst inflow velocity is the patch face normal component of the internal cell value and mwv is moving wall velocity ffp is fixed flux pressure that adjusts the pressure gradient such that the flux on the boundary is that one specified by the velocity boundary condition zg is zero gradient neumann boundary condition tp is total pressure calculated as static pressure reference plus the dynamic component due to velocity io is inlet outlet that provides a zero gradient outflow condition for a fixed value inflow kqrwf is the wall function for the turbulence kinetic energy nutkrwf is rough wall function for kinetic eddy viscosity and omegawf is the wall function for frequency 2 2 ship model the model ship used for this research is the kriso container ship kcs it is a 3600teu capacity container ship designed by kriso formerly moeri for research purpose the ship model is very popular among researchers as many of its experimental and cfd data are openly available and has been discussed in gothenburg tokyo and simman workshops fig 2 shows the hull shape and body plan of kcs model simman 2008 for validation of cfd results two different experimental fluid dynamics efd data were used in this paper the experiments were performed by hyundai heavy industries hhi and changwon national university cwnu kim et al 2015 the basic dimensions of the model ships are shown in table 2 along with the actual ship dimensions the cfd simulations were performed in hhi model scale 2 3 simulation mesh the domain size blockmesh for simulations was set following general ittc 2011 guidelines the inlet was placed two ship length windward the bow the outlet four ship length downstream the stern each lateral boundary was two ship lengths away from the ship s symmetry plane the depth or bottom of domain was set at one ship length and the atmosphere was at half ship length from free surface the hull form was integrated to the blockmesh by using snappyhexmesh utility which created a body fitted hexahedral mesh around the hull surface from the specified stl file the drift angles for simulations were applied to stl files and then snappyhexmesh was executed as for sway simulation sway motion was obtained by using dynamic mesh directory in blockmesh the region near the hull form was refined four times using toposet and snappyhexmesh was configured to perform single refinement near free surface and hull for investigating the grid dependency of the solver three mesh resolutions were used maintaining a refinement ratio of roughly 2 all simulations were performed with full hull both starboard and port side the mesh resolutions used were of 1 68 million fine 1 1 million mid and 0 4 million coarse for froude number 0 26 the simulations were performed using ltsinterfoam solver the grid based uncertainty analysis performed for kcs model in openfoam is shown in the equations s 1 depending on the sign of the convergence rest of the parameters are defined in table 3 table 3 the analysis shows that the meshes show good convergence for the drift cases except at 0 degree cases after analysis the medium mesh density 1 1 million was chosen for simulations the grid dependency analysis was performed by following the procedure prescribed by celik et al 2008 the method is mainly based on richardson extrapolation and is well accepted in scientific community conventionally the mesh resolution used for the study is slightly coarse however in case of pmm simulation only lateral pressure force and yaw moment are considered and forward frictional force is ignored which allows application of relatively lower mesh resolution near the hull surface the longitudinal and lateral force and the yaw moment results were considered to check mesh sensitivity for the analysis the grid refinement is performed in all x y and z axis maintaining same refinement ratio the order of accuracy p and grid convergence index gci are predicted using the following equations 4 p 1 ln r 21 ln ε 32 ε 21 ln r 21 p s r 32 p s 5 gci fine 21 1 25 e a 21 r 21 p 1 in the equations s 1 depending on the sign of the convergence rest of the parameters are defined in table 3 as can be seen from the analysis the results show both monotonous and oscillatory convergence this may be contributed to the very low mesh resolution used for the coarse mesh cases moreover the target for the simulations was to properly capture the lateral force and yaw moment thus meshing was done focusing on capturing lateral forces and moments not longitudinal forces as a result poor convergence and high uncertainty are observed in longitudinal force fx prediction however the uncertainty gci is much lower for lateral force and yaw moment overall the applied resolution is sufficient to attain reliable results with low uncertainty fig 3 shows general mesh configuration for the total domain free surface and hull form for capturing the sway and yaw amplitude region properly refinement area used in sway simulation mesh was larger comparing to drift simulation thus the mesh used for sway and yaw simulations had higher resolution 1 6 million cells comparing to drift simulation mesh furthermore in order to accommodate the sway motion interdymfoam solver was used for sway simulation instead of ltsinterfoam 2 4 computational resources the simulations were performed in a single node intel r core i5 cpu with 4 cores clock speed 2 27 ghz and 8 gb of physical memory the average time step used was 0 001 s and for simulating each case with stable output the required physical time was about 18 h per case all the simulations were run up to 35 s simulation time for attaining stable results 3 results the static drift simulations were performed with static mesh and ltsinterfoam solver was used whereas for pure sway and yaw simulation dynamic mesh with interdymfoam solver was used drift simulations were performed for six different drift angles sway simulations for seven sway rates and yaw simulations for six yaw rates from each simulation result lateral force and yaw moment were calculated later hydrodynamic derivatives were calculated from their slopes 3 1 static drift simulation static drift test is the towing of the ship in a tank in oblique condition as shown in fig 4 where β represents the drift angle for simulations the same conditions were reproduced in cfd environment using openfoam all simulations were performed at the static condition that is all ship motions were restricted initially simulations were run using ltsinterfoam and interfoam for two drift cases ltsinterfoam presented better results comparing to interfoam as shown in table 4 thus ltsinterfoam was preferred to perform rest of the simulations as for interdymfoam the solver took a longer time to produce stable results for static simulations which required longer resource allocation thus it was avoided for validation of results two sets of experimental data were used which were reported by kim et al 2015 the experiments were performed by hyundai heavy industry hhi and changwon national university cwnu hhi performed three runs with 0 6 and 12 degree drift and cwnu performed eight runs with drift angle varying from 0 to 14 with a 2 degree interval simulations were run from 0 to 12 using 2 degree interval all the simulations were performed in hhi model scale for lateral force and yaw moment non dimensionalization following equations were used as reported by kim et al 2015 6 f y f y n ρ v 2 l p p 2 7 m z m z n m ρ v 2 l p p 3 the static drift simulation results are shown in table 5 which is graphically represented in fig 5 and fig 6 as can be seen from the results the simulation results well capture the trend of lateral force and yaw moment the two sets of experimental data show slight disagreement with each other considering the scale of test models and test facilities such difference is natural for the simulations since hhi model was used results show better agreement with hhi data the results indicate that with increasing drifting angle the lateral force and yaw moment encountered by the ship increases thus with increasing drift angle higher power is required for propulsion fig 7 shows pressure distribution on free surface at drift angles 0 4 8 and 12 respectively as can be seen in drift motions maximum resistance is encountered by the ship bow front with the increase in drift angle pressure encountered by the ship also increases so does free surface deformation 3 2 pure sway simulation in pure sway test sway motion is applied on ship hull form externally and all ship motions are restricted a schematic diagram of sway motion is shown in fig 8 to reproduce sway motion test in cfd medium sway motion was applied externally on the simulation domain and all ship motions were kept restricted the simulations were performed with a dynamic mesh using interdymfoam solver of openfoam where sway motion was applied by selecting oscillatinglinearmotion module of solidbodymotionfunction in the dynamicmeshdict the sway motion applied on the domain is defined by the following equation 8 y o η sway sin ω t η s w a y is sway amplitude and ω is frequency which is 2 π t t is the period of one cycle the maximum y axis acceleration is ω 2 η s w a y in simulations the frequencies were kept constant and sway amplitudes were adjusted for different sway rates simulations were performed for eight different sway rates and were compared with experimental cases presented by hhi and cwnu hhi presented results for three different sway rates whereas cwnu presented four the sway forces were measured at maximum sway displacement where sway velocity is maximum and acceleration is minimum for non dimensionalization of sway forces and z moments the same equations 6 and 7 mentioned in static drift cases were used the pure sway simulation results are shown in table 6 all simulations were performed at froude number 0 26 although simulations were performed for a large number of sway rates the number of available experimental data for sway cases are limited furthermore kim et al 2015 only presented experimental data for sway forces in his paper not for z moments thus comparison of moment results was not possible the comparison of lateral force prediction between cfd and efd are shown in fig 9 the linear trend lines were generated using regression for all three data set the figure shows that although there are deviations among cfd and efd data cfd results well follow the trend line of hhi efd data fig 10 shows the maximum yaw moment prediction at different sway rates time history for simulation results showing longitudinal force lateral force and yaw moment at different sway rates are shown in fig 11 fig 12 and fig 13 the time histories show the gradual increase in forces and moment encountered by the ship with increasing sway rate the sway motion creates a rapid change of pressure in the lateral direction depending on the ship s position on sway path pressure distribution on the free surface and on the hull for port and starboard side are found to be different fig 13 shows pressure distribution on the zero surface for a kcs model in pure sway motion at sway rate 0 2 the ship s positions at the sway path are shown in the bottom right figure pressure distribution on the hull surface is shown in fig 15 for the same positions 3 3 pure sway simulation similar to previous case in pure yaw yaw motion is applied externally on ship hull form keeping other ship motions restricted a schematic diagram of yaw motion is shown in fig 16 to reproduce yaw motion test in cfd medium yaw motion was applied externally on the simulation domain and all ship motions were kept restricted the simulations were performed with a dynamic mesh using interdymfoam solver of openfoam where yaw motion was applied by coupling oscillatinglinearmotion and oscillatingrotatingmotion using multimotion module of solidbodymotionfunction in the dynamicmeshdict a cosine function was used in the oscillatingrotatingmotion module to impose the yaw angle and a sine function in the oscillatinglinearmotion to update the ship position following the yaw angle an initial acceleration period was also imposed to ensure gradual positioning of the ship to maximum yaw angle see fig 17 the yaw motion applied on the domain is defined by the following equation 9 ψ ψ 0 cos 2 π ω t 10 r p m m ψ 0 2 π ω sin 2 π ω t 11 r p m m ψ 0 2 π ω 2 sin 2 π ω t 12 r m a x r p m m l p p u ψ 0 is the yaw amplitude rad ψ is the heading angle and ω is the frequency which is 2 π t t is the period of one cycle r p m m is the yaw rate and r p m m the yaw acceleration and r is the non dimensionalized yaw velocity all the simulations were performed at the design froude number of 0 26 and mesh resolution was kept the same as the pure sway case 1 6 million in the simulations the yaw angle was kept constant and the frequency and sway position was adjusted according to the yaw rate total seven cases were simulated with varying yaw rate the case settings are shown in table 7 the simulation results were compared with experimental data provided by hhi and cwnu kim et al 2015 however the data from hhi was limited to three cases and for cwnu it was six furthermore due to different yaw angle settings the yaw acceleration rate observed in the experimental and cfd cases are different in case of pure yaw motion there is a phase gap between the yaw angle and the lateral motion when the yaw angle is maximum lateral position or sway is at zero and when yaw is at zero sway is at maximum fig 13 shows the time history of the results for the simulation ran at 0 50 yaw rate the figure shows that the peak value for lateral force is observed roughly when the yaw is at maximum and the peak value for yaw moment is observed when yaw angle is minimum since different frequencies were used for each yaw simulation case a combined time history for all the cases could not be presented here to determine the yaw derivatives yr and nr f y and m z should be estimated at minimum yaw angle amplitude and for y r and n r f y and m z should be estimated at maximum yaw angle amplitude lewis 1988 thus for varying yaw rate lateral force and yaw moment data were collected at zero yaw angle and for varying yaw acceleration rate lateral force and yaw moment were calculated at maximum yaw angle the cfd simulation results along with comparison with experimental data and simulation data are shown in table 8 and table 9 for better comparison the results for varying yaw rate are also shown in fig 18 and fig 19 and for yaw acceleration rate in fig 20 and fig 21 as can be seen from the results the simulation results for varying yaw rate do not agree well with experimental data however the results well follow the trend line since the purpose of the simulations is to calculate the hydrodynamic derivatives a well followed trend line is more important comparing to accurate value prediction thus for these cases a comparatively lower mesh resolution could be applied which saved in computational expenses furthermore even for the experimental data the two results from hhi and cwnu do not agree very well with each other either hhi provided only three results which is insufficient to properly realize the result trend line in case of results for varying yaw acceleration rate simulation results agree poorly with experimental data even the trend line could not be captured properly this might be because of the low yaw angle applied for the simulations comparing to the experimental cases furthermore during pure yaw simulation a sharp change in fluid flow is encountered from ship s bow and stern direction during changing yaw angle as the lateral force and yaw moment encountered is the sum of force and moment all through the hull surface the changing flow pattern results into unstable predictions simonsen and stern 2008 this sharp change is often difficult to capture and requires high mesh resolution with low time step to demonstrate the change of pressure at the free surface due to yaw motion pressure distribution at zero water level is shown in fig 22 for varying yaw angles at yaw rate 0 50 3 4 hydrodynamic derivatives prediction hydrodynamic derivatives or coefficients represent the rate of change in force or moment with the rate of change in velocity or acceleration the value of hydrodynamic derivatives help to determine the stability and maneuverability characteristics of a vessel thus they are determined in advance to ensure proper functioning of a marine vehicle hydrodynamic coefficients are also known as added mass and damping coefficients the added mass coefficients are acceleration dependent whereas the damping coefficients are velocity dependent the added mass coefficients may be calculated through non viscous fluid flow solution around the hull the damping is caused by the wave formation in the free water surface and the viscosity effect the total damping coefficient is predicted by solving viscous fluid flow around the vessel generally captive model tests are used with conditions to derive these coefficients among captive tests planar motion mechanism pmm test is a very popular method used for deriving all the damping and added mass coefficients lewis 1988 in this paper the hydrodynamic derivatives were predicted from lateral forces and yaw moments encountered by the ship model at different drift sway and yaw conditions by using curve fitting to the data for forces and moments as a function of drift angle β sway rate v max yaw rate r max and yaw acceleration rate r dot max the hydrodynamic derivatives or coefficients xvv yv yvvv nv nvvv y v n v y r n r y r and n r can be predicted among the derivatives yv and nv are linear and rest are non linear although some of the non linear derivatives can be predicted from static drift results their reliability can be limited since experimental data is not available for comparison of all these non linear derivatives only linear derivatives were predicted from the drift results yv was predicted from the slope of lateral motion f y and nv was predicted from the slope of yaw moment m z the slopes were generated using linear regression the predicted results and comparison with efd data are shown in table 10 the results show reasonable agreement with cfd and efd data next pure sway simulation results were used for predicting two non linear derivatives from pure sway simulations derivatives y v and n v were calculated the derivatives were predicted from the slopes of peak sway forces fig 9 and yaw moments fig 10 at different sway rates linear regression was used to produce trend lines for cfd and efd data and from them slopes were calculated the hydrodynamic derivatives derived from pure sway simulation are shown in table 11 in both static drift and pure sway cases hydrodynamic derivatives predicted by cfd show better agreement with hhi data comparing to cwnu data this may be because all the simulations were performed depicting hhi model test furthermore considering the model scale used by cwnu which was rather small hhi results may be considered more reliable finally pure yaw simulation results were used to predict y r n r y r and n r derivatives y r and n r were calculated from the lateral force and yaw moment for varying sway rate and y r and n r were calculated from varying yaw acceleration rate results linear regression was used to produce trend lines for cfd and efd data and from them slopes were calculated the hydrodynamic derivatives derived from pure yaw simulation are shown in table 12 as can be observed from the predicted yaw derivatives the simulation results agree very poorly with experimental data however the experimental data themselves do not agree well with each other furthermore for stability n r should have a negative value which is not the case even for experimental data for pure yaw case hhi presented only three cases which might be enough to get a proper representation of the force and moment trend line for yaw motion furthermore for simulation higher yaw angle may be needed to better predict the forces and moments as mentioned in the previous section 4 conclusion prediction of ship hydrodynamic derivatives is an essential part of ship design to ensure that the design meets required stability and maneuverability characteristics the paper presents the estimated value of some hydrodynamic derivatives of a container ship using cfd medium the results show good agreement with experimental data except for some of the pure yaw cases simulations were performed for a kcs model at different static drift pure sway and pure yaw conditions and lateral forces and yaw moments were predicted the predicted results show good agreement with experimental data later hydrodynamic derivatives were calculated from the simulation results which also are in reasonable agreement with experiments except for yaw derivatives the paper concludes that the open source cfd toolkit openfoam is well capable of performing most of the maneuverability related simulations with reasonable accuracy consuming minimum computational resources however in the paper it was only possible to predict drift and sway simulation results with reasonable accuracy using openfoam further investigation is needed to improve the prediction results for pure yaw cases the solver also shows higher deviation with experimental data at higher amplitude drift angles and sway rates thus further research is needed to improve the predictions and incorporate other maneuverability related simulation capabilities to openfoam acknowledgments the work was a part of shopera energy efficient safe ship operation collaborative project which was co funded by the research dg of the european commission contract no 605221 within the rtd activities of the fp7 thematic priority transport fp7 sst 2013 rtd 1 activity 7 2 4 improving safety and security sst 2013 4 1 ships in operation http shopera org 
23197,static drift pure sway and pure yaw simulation results are determined for a container ship for simulation open source rans solver openfoam was used the simulation results were compared with two sets of experimental data next hydrodynamic derivatives were predicted from simulation results and compared with experimental ones the results show good agreement with experimental data except for some pure yaw cases overall the paper concludes that openfoam is well capable of estimating hydrodynamic derivatives maintaining reasonable accuracy and computational efficiency keywords static drift pure sway pure yaw pmm hydrodynamic derivatives kcs openfoam 1 introduction maneuverability prediction in the design stage is among the key requirements in ship design to ensure safety and reliability traditionally ship maneuverability characteristics are determined using model tests which are both expensive and time consuming however with the development of different computational fluid dynamics cfd tools and improvement in computational power designers and researchers are focusing more on cfd to predict ship s seakeeping and maneuverability characteristics ship designers use a number of ways to predict ship maneuverability characteristics in design stage like theoretical approach utilization of full scale database application of empirical method kijima and nakiri 2003 model test sutulo and guedes soares 2006 and numerical approach using cfd theoretical approaches are mostly limited to slender bodies and fail to consider hull and appendage interaction utilization of full scale data is only possible when similar ship models are already in operation applications of empirical formulas are also limited to particular hull forms or availability of data model tests are among the most popular methods for maneuverability prediction one common method used in the experimental study to determine ship maneuverability properties is the captive model test which includes oblique towing test ott rotating arm test rat circular motion test cmt and planar motion mechanism pmm similar tests can also be performed using cfd depending on the capabilities and extent of the solver being used the incorporation of cfd in ship maneuverability prediction has been relatively recent most of the early works related to cfd based maneuvering were focused on planar motion mechanism pmm simulations among the early researchers to discuss ship maneuverability using cfd were simonsen and stern 2005 cura hochbaum 2006 and wilson et al 2006 however pmm simulations were first widely discussed in simman 2008 workshop simman 2008 where different research groups presented static drift pure sway and pure yaw simulation results broglia et al 2008 showed pure sway and pure yaw motion results for kvlcc1 and 2 models with propeller and rudder simulated using a solver developed by insean cura hochbaum et al 2008 simulated static drift pure sway and pure yaw case for the two tanker models with propeller and rudder using a self developed code gullmineau et al 2008 provided pmm results for us navy frigate using isis cfd solver miller 2008 provided pmm calculation for dtmb 5415 using cfdship iowa wang et al 2011 simulated oblique motion for kvlcc2 in deep and shallow water using commercial code fluent simonsen et al 2012 presented zig zag turning circle and pmm results for an appended kcs model using star ccm and compared them with experimental data lee et al 2015 performed pmm simulation for a wind turbine installation vessel using openfoam ignoring free surface calculation later shen et al 2015 incorporated dynamic overset grid in openfoam and presented zig zag simulation results with self propulsion kim et al 2015 presented pmm simulation results for kcs model using in house code ship motion and predicted hydrodynamic derivatives from simulation results hajivand and mousavizadegan 2015a b also performed pmm simulation using star ccm and openfoam static drift only for dtmb 5512 model and predicted hydrodynamic derivatives from the simulation results recently yao et al 2016 presented static drift turning and pure sway simulation data using openfoam for tanker model kvlcc2 although maneuvering related simulations are gaining popularity lately their applications are mostly limited to large research groups and designers who have sufficient resources and access to well developed in house or commercial codes an alternative and economic solution to commercial and in house codes may be the use of the open source cfd toolkit openfoam several researchers have already demonstrated the capability of openfoam in performing maneuverability based simulations for different ship models however they were either limited to static cases or avoided free surface consideration furthermore existing papers do not discuss about the required settings for running such simulations this paper aims at contributing to the field by presenting static drift pure sway and pure yaw simulation results for a container ship model kcs using openfoam and estimating the hydrodynamic derivatives for it the paper aims at demonstrating openfoam s capability in performing maneuvering simulations with detail regarding the mesh dependency and related solver setup it also intends to show that the toolkit is able to perform maneuvering simulations with reasonable accuracy good efficiency and economy 2 method 2 1 simulation solver 2 1 1 mathematical model openfoam open field operation and manipulation is an open source library written in c language following object oriented paradigm the code is available under gnu general public license gpl it can be used to numerically solve a wide range of problems in fluid dynamics from laminar to turbulent flows with single and multi phases it can solve both structured and unstructured polyhedral meshes including h refinement or hanging nodes and contains an extensive range of solvers to perform different types of cfd simulations it has several packages to perform multiphase turbulent flow simulation for floating objects openfoam also allows relatively easy customization and modification of solvers because of its modular design the solver has been elaborately described by jasak 1996 2009 the openfoam solver used to perform ship hydrodynamic simulations for this paper simulates incompressible two phase flow the governing equations for the solver are the navier stokes equation 1 and continuity equation 2 for an incompressible laminar flow of a newtonian fluid in vector form the navier stokes and continuity equation are given by 1 ρ v t v v p μ 2 v ρ g 2 v 0 where v is the velocity p is the pressure μ is the dynamic viscosity g is acceleration due to gravity and 2 is the laplace operator further the continuity equation is of the form the volume of fluid vof method is used to model fluid as one continuum of mixed properties this vof method determines the fraction of each fluid that exists in each cell thus tracks the free surface elevation the equation for the volume fraction is obtained as 3 α t α u 0 where u is the velocity field α is the volume fraction of water in the cell and varies from 0 to 1 full of air to full of water respectively the unstructured collocated finite volume method fvm using gauss theorem together with user defined and implemented solution algorithm and time integration schemes drikakis et al 2007 is used to discretize the governing equations time integration is performed by a semi implicit second order two point backward differencing scheme pressure velocity coupling is obtained through pimple algorithm ferziger and peric 2008 a combination of simple and piso openfoam incorporates three different turbulence models k ε k ω and sst k ω turbulence is discretized using a 2nd order upwind difference turbulence for the presented simulations was modeled with the reynolds averaged stress ras sst k ω two equation model the parameters were calculated using common guidelines from an earlier study labanti et al 2016 2 1 2 coordinate system openfoam follows a cartesian coordinate system if not specified otherwise all systems are based on an origin point and coordinate rotation the solver has a local and a global coordinate system the local coordinate system is used to define the simulation domain comparing to global reference point the global and local coordinate system might be same or different depending on the simulation in ship simulation where there is flowing fluid the local and global coordinates both are defined using cartesian coordinate system the local coordinate systems are generally right handed the x axis is positive from stern to bow direction y is positive at star board side and z is positive upwards as shown in fig 1 2 1 3 boundary conditions the control volume represented a deep water condition so the two lateral sides and the bottom were symmetry plane type faces no additional information was required for this kind of boundary condition inlet outlet and atmosphere were patch faces with specific boundary condition for each one and hull had a wall type boundary for the presented simulation cases boundary conditions used for the fluid properties and turbulence parameters are as shown in table 1 here fv is fixedvalue dirichlet boundary condition specified by the user opmv is outlet phase mean velocity piov is pressure inlet outlet velocity that applies zero gradient for outflow whilst inflow velocity is the patch face normal component of the internal cell value and mwv is moving wall velocity ffp is fixed flux pressure that adjusts the pressure gradient such that the flux on the boundary is that one specified by the velocity boundary condition zg is zero gradient neumann boundary condition tp is total pressure calculated as static pressure reference plus the dynamic component due to velocity io is inlet outlet that provides a zero gradient outflow condition for a fixed value inflow kqrwf is the wall function for the turbulence kinetic energy nutkrwf is rough wall function for kinetic eddy viscosity and omegawf is the wall function for frequency 2 2 ship model the model ship used for this research is the kriso container ship kcs it is a 3600teu capacity container ship designed by kriso formerly moeri for research purpose the ship model is very popular among researchers as many of its experimental and cfd data are openly available and has been discussed in gothenburg tokyo and simman workshops fig 2 shows the hull shape and body plan of kcs model simman 2008 for validation of cfd results two different experimental fluid dynamics efd data were used in this paper the experiments were performed by hyundai heavy industries hhi and changwon national university cwnu kim et al 2015 the basic dimensions of the model ships are shown in table 2 along with the actual ship dimensions the cfd simulations were performed in hhi model scale 2 3 simulation mesh the domain size blockmesh for simulations was set following general ittc 2011 guidelines the inlet was placed two ship length windward the bow the outlet four ship length downstream the stern each lateral boundary was two ship lengths away from the ship s symmetry plane the depth or bottom of domain was set at one ship length and the atmosphere was at half ship length from free surface the hull form was integrated to the blockmesh by using snappyhexmesh utility which created a body fitted hexahedral mesh around the hull surface from the specified stl file the drift angles for simulations were applied to stl files and then snappyhexmesh was executed as for sway simulation sway motion was obtained by using dynamic mesh directory in blockmesh the region near the hull form was refined four times using toposet and snappyhexmesh was configured to perform single refinement near free surface and hull for investigating the grid dependency of the solver three mesh resolutions were used maintaining a refinement ratio of roughly 2 all simulations were performed with full hull both starboard and port side the mesh resolutions used were of 1 68 million fine 1 1 million mid and 0 4 million coarse for froude number 0 26 the simulations were performed using ltsinterfoam solver the grid based uncertainty analysis performed for kcs model in openfoam is shown in the equations s 1 depending on the sign of the convergence rest of the parameters are defined in table 3 table 3 the analysis shows that the meshes show good convergence for the drift cases except at 0 degree cases after analysis the medium mesh density 1 1 million was chosen for simulations the grid dependency analysis was performed by following the procedure prescribed by celik et al 2008 the method is mainly based on richardson extrapolation and is well accepted in scientific community conventionally the mesh resolution used for the study is slightly coarse however in case of pmm simulation only lateral pressure force and yaw moment are considered and forward frictional force is ignored which allows application of relatively lower mesh resolution near the hull surface the longitudinal and lateral force and the yaw moment results were considered to check mesh sensitivity for the analysis the grid refinement is performed in all x y and z axis maintaining same refinement ratio the order of accuracy p and grid convergence index gci are predicted using the following equations 4 p 1 ln r 21 ln ε 32 ε 21 ln r 21 p s r 32 p s 5 gci fine 21 1 25 e a 21 r 21 p 1 in the equations s 1 depending on the sign of the convergence rest of the parameters are defined in table 3 as can be seen from the analysis the results show both monotonous and oscillatory convergence this may be contributed to the very low mesh resolution used for the coarse mesh cases moreover the target for the simulations was to properly capture the lateral force and yaw moment thus meshing was done focusing on capturing lateral forces and moments not longitudinal forces as a result poor convergence and high uncertainty are observed in longitudinal force fx prediction however the uncertainty gci is much lower for lateral force and yaw moment overall the applied resolution is sufficient to attain reliable results with low uncertainty fig 3 shows general mesh configuration for the total domain free surface and hull form for capturing the sway and yaw amplitude region properly refinement area used in sway simulation mesh was larger comparing to drift simulation thus the mesh used for sway and yaw simulations had higher resolution 1 6 million cells comparing to drift simulation mesh furthermore in order to accommodate the sway motion interdymfoam solver was used for sway simulation instead of ltsinterfoam 2 4 computational resources the simulations were performed in a single node intel r core i5 cpu with 4 cores clock speed 2 27 ghz and 8 gb of physical memory the average time step used was 0 001 s and for simulating each case with stable output the required physical time was about 18 h per case all the simulations were run up to 35 s simulation time for attaining stable results 3 results the static drift simulations were performed with static mesh and ltsinterfoam solver was used whereas for pure sway and yaw simulation dynamic mesh with interdymfoam solver was used drift simulations were performed for six different drift angles sway simulations for seven sway rates and yaw simulations for six yaw rates from each simulation result lateral force and yaw moment were calculated later hydrodynamic derivatives were calculated from their slopes 3 1 static drift simulation static drift test is the towing of the ship in a tank in oblique condition as shown in fig 4 where β represents the drift angle for simulations the same conditions were reproduced in cfd environment using openfoam all simulations were performed at the static condition that is all ship motions were restricted initially simulations were run using ltsinterfoam and interfoam for two drift cases ltsinterfoam presented better results comparing to interfoam as shown in table 4 thus ltsinterfoam was preferred to perform rest of the simulations as for interdymfoam the solver took a longer time to produce stable results for static simulations which required longer resource allocation thus it was avoided for validation of results two sets of experimental data were used which were reported by kim et al 2015 the experiments were performed by hyundai heavy industry hhi and changwon national university cwnu hhi performed three runs with 0 6 and 12 degree drift and cwnu performed eight runs with drift angle varying from 0 to 14 with a 2 degree interval simulations were run from 0 to 12 using 2 degree interval all the simulations were performed in hhi model scale for lateral force and yaw moment non dimensionalization following equations were used as reported by kim et al 2015 6 f y f y n ρ v 2 l p p 2 7 m z m z n m ρ v 2 l p p 3 the static drift simulation results are shown in table 5 which is graphically represented in fig 5 and fig 6 as can be seen from the results the simulation results well capture the trend of lateral force and yaw moment the two sets of experimental data show slight disagreement with each other considering the scale of test models and test facilities such difference is natural for the simulations since hhi model was used results show better agreement with hhi data the results indicate that with increasing drifting angle the lateral force and yaw moment encountered by the ship increases thus with increasing drift angle higher power is required for propulsion fig 7 shows pressure distribution on free surface at drift angles 0 4 8 and 12 respectively as can be seen in drift motions maximum resistance is encountered by the ship bow front with the increase in drift angle pressure encountered by the ship also increases so does free surface deformation 3 2 pure sway simulation in pure sway test sway motion is applied on ship hull form externally and all ship motions are restricted a schematic diagram of sway motion is shown in fig 8 to reproduce sway motion test in cfd medium sway motion was applied externally on the simulation domain and all ship motions were kept restricted the simulations were performed with a dynamic mesh using interdymfoam solver of openfoam where sway motion was applied by selecting oscillatinglinearmotion module of solidbodymotionfunction in the dynamicmeshdict the sway motion applied on the domain is defined by the following equation 8 y o η sway sin ω t η s w a y is sway amplitude and ω is frequency which is 2 π t t is the period of one cycle the maximum y axis acceleration is ω 2 η s w a y in simulations the frequencies were kept constant and sway amplitudes were adjusted for different sway rates simulations were performed for eight different sway rates and were compared with experimental cases presented by hhi and cwnu hhi presented results for three different sway rates whereas cwnu presented four the sway forces were measured at maximum sway displacement where sway velocity is maximum and acceleration is minimum for non dimensionalization of sway forces and z moments the same equations 6 and 7 mentioned in static drift cases were used the pure sway simulation results are shown in table 6 all simulations were performed at froude number 0 26 although simulations were performed for a large number of sway rates the number of available experimental data for sway cases are limited furthermore kim et al 2015 only presented experimental data for sway forces in his paper not for z moments thus comparison of moment results was not possible the comparison of lateral force prediction between cfd and efd are shown in fig 9 the linear trend lines were generated using regression for all three data set the figure shows that although there are deviations among cfd and efd data cfd results well follow the trend line of hhi efd data fig 10 shows the maximum yaw moment prediction at different sway rates time history for simulation results showing longitudinal force lateral force and yaw moment at different sway rates are shown in fig 11 fig 12 and fig 13 the time histories show the gradual increase in forces and moment encountered by the ship with increasing sway rate the sway motion creates a rapid change of pressure in the lateral direction depending on the ship s position on sway path pressure distribution on the free surface and on the hull for port and starboard side are found to be different fig 13 shows pressure distribution on the zero surface for a kcs model in pure sway motion at sway rate 0 2 the ship s positions at the sway path are shown in the bottom right figure pressure distribution on the hull surface is shown in fig 15 for the same positions 3 3 pure sway simulation similar to previous case in pure yaw yaw motion is applied externally on ship hull form keeping other ship motions restricted a schematic diagram of yaw motion is shown in fig 16 to reproduce yaw motion test in cfd medium yaw motion was applied externally on the simulation domain and all ship motions were kept restricted the simulations were performed with a dynamic mesh using interdymfoam solver of openfoam where yaw motion was applied by coupling oscillatinglinearmotion and oscillatingrotatingmotion using multimotion module of solidbodymotionfunction in the dynamicmeshdict a cosine function was used in the oscillatingrotatingmotion module to impose the yaw angle and a sine function in the oscillatinglinearmotion to update the ship position following the yaw angle an initial acceleration period was also imposed to ensure gradual positioning of the ship to maximum yaw angle see fig 17 the yaw motion applied on the domain is defined by the following equation 9 ψ ψ 0 cos 2 π ω t 10 r p m m ψ 0 2 π ω sin 2 π ω t 11 r p m m ψ 0 2 π ω 2 sin 2 π ω t 12 r m a x r p m m l p p u ψ 0 is the yaw amplitude rad ψ is the heading angle and ω is the frequency which is 2 π t t is the period of one cycle r p m m is the yaw rate and r p m m the yaw acceleration and r is the non dimensionalized yaw velocity all the simulations were performed at the design froude number of 0 26 and mesh resolution was kept the same as the pure sway case 1 6 million in the simulations the yaw angle was kept constant and the frequency and sway position was adjusted according to the yaw rate total seven cases were simulated with varying yaw rate the case settings are shown in table 7 the simulation results were compared with experimental data provided by hhi and cwnu kim et al 2015 however the data from hhi was limited to three cases and for cwnu it was six furthermore due to different yaw angle settings the yaw acceleration rate observed in the experimental and cfd cases are different in case of pure yaw motion there is a phase gap between the yaw angle and the lateral motion when the yaw angle is maximum lateral position or sway is at zero and when yaw is at zero sway is at maximum fig 13 shows the time history of the results for the simulation ran at 0 50 yaw rate the figure shows that the peak value for lateral force is observed roughly when the yaw is at maximum and the peak value for yaw moment is observed when yaw angle is minimum since different frequencies were used for each yaw simulation case a combined time history for all the cases could not be presented here to determine the yaw derivatives yr and nr f y and m z should be estimated at minimum yaw angle amplitude and for y r and n r f y and m z should be estimated at maximum yaw angle amplitude lewis 1988 thus for varying yaw rate lateral force and yaw moment data were collected at zero yaw angle and for varying yaw acceleration rate lateral force and yaw moment were calculated at maximum yaw angle the cfd simulation results along with comparison with experimental data and simulation data are shown in table 8 and table 9 for better comparison the results for varying yaw rate are also shown in fig 18 and fig 19 and for yaw acceleration rate in fig 20 and fig 21 as can be seen from the results the simulation results for varying yaw rate do not agree well with experimental data however the results well follow the trend line since the purpose of the simulations is to calculate the hydrodynamic derivatives a well followed trend line is more important comparing to accurate value prediction thus for these cases a comparatively lower mesh resolution could be applied which saved in computational expenses furthermore even for the experimental data the two results from hhi and cwnu do not agree very well with each other either hhi provided only three results which is insufficient to properly realize the result trend line in case of results for varying yaw acceleration rate simulation results agree poorly with experimental data even the trend line could not be captured properly this might be because of the low yaw angle applied for the simulations comparing to the experimental cases furthermore during pure yaw simulation a sharp change in fluid flow is encountered from ship s bow and stern direction during changing yaw angle as the lateral force and yaw moment encountered is the sum of force and moment all through the hull surface the changing flow pattern results into unstable predictions simonsen and stern 2008 this sharp change is often difficult to capture and requires high mesh resolution with low time step to demonstrate the change of pressure at the free surface due to yaw motion pressure distribution at zero water level is shown in fig 22 for varying yaw angles at yaw rate 0 50 3 4 hydrodynamic derivatives prediction hydrodynamic derivatives or coefficients represent the rate of change in force or moment with the rate of change in velocity or acceleration the value of hydrodynamic derivatives help to determine the stability and maneuverability characteristics of a vessel thus they are determined in advance to ensure proper functioning of a marine vehicle hydrodynamic coefficients are also known as added mass and damping coefficients the added mass coefficients are acceleration dependent whereas the damping coefficients are velocity dependent the added mass coefficients may be calculated through non viscous fluid flow solution around the hull the damping is caused by the wave formation in the free water surface and the viscosity effect the total damping coefficient is predicted by solving viscous fluid flow around the vessel generally captive model tests are used with conditions to derive these coefficients among captive tests planar motion mechanism pmm test is a very popular method used for deriving all the damping and added mass coefficients lewis 1988 in this paper the hydrodynamic derivatives were predicted from lateral forces and yaw moments encountered by the ship model at different drift sway and yaw conditions by using curve fitting to the data for forces and moments as a function of drift angle β sway rate v max yaw rate r max and yaw acceleration rate r dot max the hydrodynamic derivatives or coefficients xvv yv yvvv nv nvvv y v n v y r n r y r and n r can be predicted among the derivatives yv and nv are linear and rest are non linear although some of the non linear derivatives can be predicted from static drift results their reliability can be limited since experimental data is not available for comparison of all these non linear derivatives only linear derivatives were predicted from the drift results yv was predicted from the slope of lateral motion f y and nv was predicted from the slope of yaw moment m z the slopes were generated using linear regression the predicted results and comparison with efd data are shown in table 10 the results show reasonable agreement with cfd and efd data next pure sway simulation results were used for predicting two non linear derivatives from pure sway simulations derivatives y v and n v were calculated the derivatives were predicted from the slopes of peak sway forces fig 9 and yaw moments fig 10 at different sway rates linear regression was used to produce trend lines for cfd and efd data and from them slopes were calculated the hydrodynamic derivatives derived from pure sway simulation are shown in table 11 in both static drift and pure sway cases hydrodynamic derivatives predicted by cfd show better agreement with hhi data comparing to cwnu data this may be because all the simulations were performed depicting hhi model test furthermore considering the model scale used by cwnu which was rather small hhi results may be considered more reliable finally pure yaw simulation results were used to predict y r n r y r and n r derivatives y r and n r were calculated from the lateral force and yaw moment for varying sway rate and y r and n r were calculated from varying yaw acceleration rate results linear regression was used to produce trend lines for cfd and efd data and from them slopes were calculated the hydrodynamic derivatives derived from pure yaw simulation are shown in table 12 as can be observed from the predicted yaw derivatives the simulation results agree very poorly with experimental data however the experimental data themselves do not agree well with each other furthermore for stability n r should have a negative value which is not the case even for experimental data for pure yaw case hhi presented only three cases which might be enough to get a proper representation of the force and moment trend line for yaw motion furthermore for simulation higher yaw angle may be needed to better predict the forces and moments as mentioned in the previous section 4 conclusion prediction of ship hydrodynamic derivatives is an essential part of ship design to ensure that the design meets required stability and maneuverability characteristics the paper presents the estimated value of some hydrodynamic derivatives of a container ship using cfd medium the results show good agreement with experimental data except for some of the pure yaw cases simulations were performed for a kcs model at different static drift pure sway and pure yaw conditions and lateral forces and yaw moments were predicted the predicted results show good agreement with experimental data later hydrodynamic derivatives were calculated from the simulation results which also are in reasonable agreement with experiments except for yaw derivatives the paper concludes that the open source cfd toolkit openfoam is well capable of performing most of the maneuverability related simulations with reasonable accuracy consuming minimum computational resources however in the paper it was only possible to predict drift and sway simulation results with reasonable accuracy using openfoam further investigation is needed to improve the prediction results for pure yaw cases the solver also shows higher deviation with experimental data at higher amplitude drift angles and sway rates thus further research is needed to improve the predictions and incorporate other maneuverability related simulation capabilities to openfoam acknowledgments the work was a part of shopera energy efficient safe ship operation collaborative project which was co funded by the research dg of the european commission contract no 605221 within the rtd activities of the fp7 thematic priority transport fp7 sst 2013 rtd 1 activity 7 2 4 improving safety and security sst 2013 4 1 ships in operation http shopera org 
23198,this paper presents the further development of a constrained interpolation profile cip based method to solve highly non linear 3 d slamming problems with a parallel computing algorithm and an improved interface capturing scheme the water entry problems governed by the navier stokes n s equations were treated as multi phase problems solid water and air and solved by the fractional step method in which the 3 d cip method was employed for the advection phase and a pressure based algorithm was applied to the non advection phase the interfaces between different phases were captured by using density functions the advection of the water phase was solved by applying the thinc wlic scheme i e tangent of hyperbola for interface capturing with weighted line interface calculation a six degree of freedom 6dof motion solver was developed to simulate the free fall water entry a message passing interface mpi parallel computing scheme was implemented by decomposing the computational domain the speed up performance was investigated validation studies were carried out for the water entry of a 3 d wedge with prescribed velocities the free fall water entry of a modified wigley hull and an inclined circular cylinder was also studied the computed slamming forces and motions were compared with experimental results and other published numerical results keywords slamming cip method parallel computing interface capturing 1 introduction large amplitude ship motions can result in impulsive water impact and green water on deck which will subsequently cause damages to ship structures it is important to understand and predict the flow behaviour and the impact loads on ships during water entry the slamming problem is highly nonlinear and involves breaking water surfaces and air bubbles early studies were carried out by simplifying the problem into the symmetric entry of a wedge into calm water theoretical analysis of the impact problems was pioneered by von karman 1929 and wagner 1932 korobkin and pukhnachov 1988 presents a review of earlier research various numerical methods have been developed to solve water entry problems the water entry of a wedge was studied by vinje and brevig 1981 greenhow 1987 and zhao and faltinsen 1993 using the potential flow theory zhao et al 1996 further developed and extended the method to general asymmetric bodies chuang et al 2006 studied the water entry problem based on desingularized cauchy s formula by removing the corner singularity at the intersection point of a body and the water surface xu et al 2008 solved the oblique water entry problem of an asymmetrical wedge with boundary element method bem and an analytical solution for the jet xu and wu 2015 used bem with vortex shedding to study the oblique water entry of a wedge the pressure jump was addressed by imposing the kutta condition at the wedge apex although progress has been made with the potential flow theory difficulties exist in treating the highly non linear free surface especially the breaking surfaces which can be overcome by computational fluid dynamics cfd methods for example kleefsman et al 2005 solved the 2 d water entry problem of symmetric bodies based on the volume of fluid vof method and the finite volume method kim et al 2007 applied the smoothed particle hydrodynamics sph method to study 2 d water entry of asymmetric bodies wang and soares 2014 investigated the water impact of 3 d buoys by using an explicit finite element method fem with an arbitrary lagrangian eulerian ale solver zhang et al 2015 studied the effect of compressibility on pressure distribution based on a fem solver the constrained interpolation profile cip method developed by takewaki et al 1985 yabe et al 1991 and yabe 1991 has been employed in water entry studies the cip method is a high order upwind scheme to capture the advection of a profile it uses both the advection function of the profile and its spatial derivatives in each grid cell which leads to sub cell resolution and retains the sharpness of the profile hu and kashiwagi 2004 demonstrated that the cip combined and unified procedure ccup is robust in the simulation of violent free surface flows zhu et al 2007 applied ccup to the problem of a 2 d circular cylinder entering and existing water yang and qiu 2012a b employed the cip method to solve 2 d and 3 d slamming problems wen and qiu 2016 further developed the cip method by implementing a parallel computing scheme to solve 2 d slamming problems further studies were carried out in this work to improve the cip method for 3 d slamming computations a message passing interface mpi algorithm and a domain decomposition approach were developed for parallel computing the tangent of hyperbola for interface capturing with weighted line interface calculation thinc wlic scheme was employed to capture water surfaces a six degree of freedom 6dof motion solver was developed to enable free fall simulations validation studies were carried out for the water entry of a wedge section a wigley hull and an inclined cylinder the effects of domain size water depth grid resolution and time step on the solutions were examined the numerical results were compared with experimental data and numerical solutions by other methods 2 mathematical formulation 2 1 governing equations the governing equations for the viscous flow can be written as 1 ρ t u i ρ x i ρ u i x i 2 u i t u j u i x j 1 ρ σ i j x j f i where t is time x i i 1 2 3 are the spatial coordinates in a 3 d cartesian coordinate system ρ is the density of the fluid u i are the velocity components p is the pressure and f i are the body forces it is assumed that the fluid is newtonian the total stress σ i j can then be written as σ i j p δ i j 2 μ s i j 2 μ δ i j s k k 3 s i j 1 2 u i x j u j x i where μ is the dynamic viscosity and δ i j is the kronecker delta function since the temperature variation is not considered in this study the equation of state can be written as p f ρ applying it to eq 1 the pressure equation can be obtained as 3 p t u i p x i ρ c 2 u i x i where c p ρ is the sound speed 2 2 the fractional step approach and the cip method by applying the fractional step approach to eqs 1 3 the governing equations are split and solved stepwise according to the following steps 1 advection phase 4 ρ t u i ρ x i 0 5 u i t u j u i x j 0 6 p t u i p x i 0 2 non advection phase i 7 u i t 2 μ ρ x j s i j 1 3 δ i j s k k f i 3 non advection phase ii 8 ρ t ρ u i x i 9 u i t 1 ρ p x i 10 p t ρ c 2 u i x i the advection phase is solved by the cip method which computes the advection of a variable χ governed by the following equation 11 χ t u i χ x i h x i t where the variable χ can represent ρ u i and p in eqs 4 6 and h is an arbitrary function in the cip method the transportation of χ and its spatial gradients φ i χ x i are both considered by differentiating eq 11 the advection equation of φ i can be obtained in a similar form the advection of χ and φ i is calculated by a semi lagrangian approach 12 χ x χ ˆ n x u δ t 13 φ i x φ i ˆ n x u δ t where x is the position vector of an arbitrary point u is the velocity vector in the cell χ ˆ n is an interpolation approximation to χ n at the previous time step and φ i ˆ n χ ˆ n x i the interpolation function χ ˆ n is a cubic polynomial constructed at each computational cell and its coefficients are determined from the continuity of χ n and φ i n at grid points details on the cip method can be found in the work of yabe et al 1991 and yabe 1991 in the non advection phase i the euler explicit scheme is applied for time integration and the central finite difference method is used for the spatial derivatives for the non advection phase ii a poisson type equation can be obtained from eqs 9 and 10 14 x i 1 ρ p n 1 x i p n 1 p ρ c 2 δ t 2 1 δ t u i x i where denotes an intermediate value computed from the advection phase and denotes an intermediate value calculated from the non advection phase ii for an incompressible flow eq 14 becomes 15 x i 1 ρ p n 1 x i 1 δ t u i x i the biconjugate gradient stabilized method with the jacobi preconditioner is applied to solve eqs 14 and 15 2 3 staggered grid system a staggered cartesian grid system where different variables are stored in different locations within a grid was used to discretize the computational domain preliminary studies by wen and qiu 2015 indicated that non staggered grids could lead to divergence in the computations a staggered grid system seems to be able to address the divergence problem as shown in fig 1 four types of nodes are employed in the computational domain the p nodes denoted by circles contain the pressure values and other physical properties such as the density of fluid ρ the dynamic viscosity μ and the sound speed c the u nodes squares the v nodes triangles and the w nodes stars store the velocity components along x axis y axis and z axis respectively in each grid the p node is located at the centre of the cell the u node is on the right side cell surface the v node is positioned at the back cell surface and the w node is located on the upper horizontal cell surface the derivatives can be evaluated at different locations for example based on the central difference method the spatial derivative u 1 x at a p node p i j k can be calculated using the neighbouring velocities at u nodes 16 u 1 x p i j k u 1 u i j k u 1 u i 1 j k x u i j k x u i 1 j k 2 4 interface capturing the water entry is considered as a multi phase problem involving water air and solid phases since eqs 14 and 15 are valid for all three phases the pressure field can be solved in the whole computational domain discretized by a fixed cartesian grid the boundary conditions on the interfaces between different phases are not needed density functions ϕ m m 1 2 3 are used to capture the interfaces between body water and air where ϕ 1 denotes the water phase ϕ 2 represents the air phase and ϕ 3 denotes the solid phase the density functions have values between 0 and 1 and satisfy the following relationship at each grid node 17 m 1 3 ϕ m 1 0 at each time step ϕ 3 is calculated from the position of the rigid body and the volume fraction of a grid cell inside the rigid body the volume fraction for grid i j k is determined by using gaussian quadratures as follows 18 ϕ 3 i j k 1 δ x δ y δ z ω ϕ 3 x y z d x d y d z 1 δ x δ y δ z a 1 n b 1 n c 1 n w a w b w c j ϕ 3 x a y b z c where ω is the grid cell at i j k ϕ 3 x y z 1 if a point x y z is inside or on the solid body surface and ϕ 3 x y z 0 otherwise n is the number of gaussian points w s are weights x s y s and z s are the coordinates at gaussian points and j is the jacobian of the transformation between the global and local coordinate systems the density function of water phase ϕ 1 is obtained by solving the advection equation eq 19 using the thinc wlic interface capturing scheme and ϕ 2 is determined from eq 17 at each computational cell 19 ϕ 1 t u i ϕ 1 x i 0 the thinc wlic scheme proposed by yokoi 2007 is a combination of the wlic method and the thinc scheme the thinc scheme proposed by xiao et al 2005 for incompressible free surface flow allows for conservation of mass as well as reduced oscillation and smearing on the interfaces in the case of three dimensional applications the dimensional splitting method is applied so that only the formulation for one dimensional thinc is needed taking the advection of water phase in the x axis as an example the formulation of the one dimensional thinc scheme is briefly summarized below the advection equation of the density function of water ϕ 1 in the velocity field u x t can be written in the conservation form as follows 20 ϕ 1 t u ϕ 1 x ϕ 1 u x discretization of eq 20 using a finite volume method over a computational cell x i 1 2 x i 1 2 and a time step t n t n 1 yields 21 ϕ 1 n 1 ϕ 1 n ψ i 1 2 ψ i 1 2 δ x δ t δ x ϕ 1 n u i 1 2 n u i 1 2 n where ϕ 1 n 1 δ x x i 1 2 x i 1 2 ϕ 1 d x is the cell averaged density function of water at time instance t n ψ i 1 2 t n t n 1 u ϕ 1 i 1 2 d t is the flux across the cell boundary x x i 1 2 over the time step δ t t n 1 t n the fluxes on cell boundaries are calculated by a semi lagrangian method instead of using a polynomial function as in the cip method the thinc scheme uses a stepwise modified hyperbolic tangent function to approximate the profile in the upwind cell 22 γ i x 1 2 1 γ tanh β x x i 1 2 δ x δ where γ β and δ are parameters to be determined after γ x is determined the fluxes at the cell boundaries can be calculated and used in updating ϕ 1 n 1 detailed formulations for the thinc scheme can be found in the work of xiao et al 2005 and hu and kashiwagi 2008 yokoi 2007 improved the multi dimensional thinc scheme by superimposing three line interfaces along x y and z directions ϕ 1 x ϕ 1 y and ϕ 1 z respectively the line interfaces are constructed like the classic simple line interface calculation slic method or the vof method by hirt and nichols 1981 by making use of the surface normal the three line interfaces are combined using weights 23 ϕ 1 w x n ϕ 1 x w y n ϕ 1 y w z n ϕ 1 z where w x n w y n and w z n are the weights calculated from the surface normal vectors n n x n y n z t as below 24 w x n x n x n y n z w y n y n x n y n z w z n z n x n y n z in the thinc wlic scheme ϕ 1 x is constructed using eq 22 and ϕ 1 z ϕ 1 y ϕ 1 for the advection along the x axis similar formulations can be obtained for the advection along the y axis and the z axis considering the constructed interfaces fluxes for the three dimensional case can then be calculated as below 25 ψ x i 1 2 j k w x ψ x x i 1 2 j k 1 w x ϕ 1 i s j k u i 1 2 j k δ t 26 ψ y i j 1 2 k w y ψ y y i j 1 2 k 1 w y ϕ 1 i j s k v i j 1 2 k δ t 27 ψ z i j k 1 2 w z ψ z z i j k 1 2 1 w z ϕ 1 i j k s w i j k 1 2 δ t where ψ x x i 1 2 j k ψ y y i j 1 2 k and ψ z z i j k 1 2 are the fluxes calculated based on the thinc scheme u v and w are the velocity components and the subscripts i s j s and k s denote the density functions in the upwind grids in the x y and z directions respectively details on the formulations can be found in the work of yokoi 2007 2 5 parallel computing since eqs 14 and 15 are solved for all three phases and the pressure distribution is solved in the whole computational domain parallel computing techniques can be applied in a straightforward way in this work an mpi scheme was employed as shown in fig 2 the whole computational domain is first partitioned into n p r o c n x p r o c n y p r o c n z p r o c sub domains similar or equal number of grids are evenly distributed in these sub domains each sub domain is then assigned to one processor or cpu with a unique identity number the cartesian topology was applied to handle the assignment of processors to sub domains the identity numbers of the neighbouring processors are then acquired and stored each processor uses its local memory since the computation of spatial derivatives on the boundary grids in a sub domain requires values in neighbouring processors communications with neighbouring processors are involved to share the values on the boundaries between sub domains in the parallel computations all processors need to store one additional layer of nodes on the boundaries the values in these nodes need to be updated from neighbouring processors before they can be used the communications between processors are achieved by the mpi approach the speed up performance was studied by simulating the water entry of a 3 d wedge using various numbers of processors on a work station it can be seen from fig 3 that the parallelization speeds up the simulation it should be noted that very minor less than 0 01 difference in the predicted slamming force can be found for the water entry case when varying the number of processors and using different partition schemes this is due to the machine error which can be built up in the computations however the difference is negligible 2 6 equations of motion once the pressure distribution in the computational domain is obtained the hydrodynamic force acting on the solid body can be calculated by integrating the pressure on its surface based on gauss s theorem the hydrodynamic force f f x f y f z t can be expressed as 28 f x ω p x ϕ 2 d ω 29 f y ω p y ϕ 2 d ω 30 f z ω p z ϕ 2 d ω where ω denotes the computational domain ϕ 2 is the density function of the solid phase the moment m m x m y m z t with respect to the center of gravity x c x c y c z c t can be obtained as 31 m x ω y y c p z z z c p y ϕ 2 d ω 32 m y ω z z c p x x x c p z ϕ 2 d ω 33 m z ω x x c p y y y c p x ϕ 2 d ω after the hydrodynamic force and moment are obtained the translational and rotational motions of the solid body can be obtained by solving the equations of motion the state variable vector for a rigid body s t can be defined as 34 s t x c t q t p t l t where x c t is the center of gravity in the global coordinate system q t is the quaternion vector denoting the orientation of the solid body p t is the translational momentum vector and l t is the angular momentum vector the equations of motion can be written as follows 35 d d t s t d d t x c t q t p t l t v t 1 2 ω t q t f t m t where ω t q t denotes the quaternion multiplication between the quaternions 0 ω and q v t is the translational velocity vector and ω t is the angular velocity vector in this work the euler explicit scheme was applied to solve the equations of motion 2 7 evaluation of spatial discretization errors uncertainties in the numerical solutions due to spatial discretization errors were evaluated in this work using the grid convergence index gci method proposed by celik et al 2008 the procedure based on the richardson extrapolation is briefly summarized as follows three sets of grid were chosen with grid sizes h 1 h 2 and h 3 where the grid h 1 is the finest computations were carried out using these three grids and the values of interested variables were obtained for example the maximum slamming force the results are denoted as α 1 α 2 and α 3 where α represents the maximum slamming force introducing r 21 h 2 h 1 and r 32 h 3 h 2 the apparent order k was calculated using 36 k 1 ln r 21 ln ε 32 ε 21 q k where ε 32 α 3 α 2 ε 21 α 2 α 1 q k ln r 21 k s r 32 k s s sign ε 32 ε 21 and q k 0 in the case of r 21 r 32 the extrapolated values were calculated from 37 α e 21 r 21 k α 1 α 2 r 21 k 1 the approximate relative error the extrapolated relative error and the gci were obtained using the following equations respectively 38 e a 21 α 1 α 2 α 1 39 e e 21 α e 21 α 1 α e 21 40 gci 1 25 e a 21 r 21 k 1 3 numerical results validation studies were carried out for the water entry of a 3 d wedge the free fall of a wigley hull and an inclined cylinder and the numerical solutions were compared with experimental data and those by other numerical methods in the computations block computational domains were employed as shown in fig 4 where d is the water depth and w and s are the width and the length of the computational domain respectively the solid body for example a 3 d wedge section is located in the middle of the domain non uniform cartesian grids were used with finer grids distributed near the path of the body fig 5 presents a cross section of the non uniform grids 3 1 case a water entry of a 3 d wedge in the experiments on the water entry of a 3 d wedge by zhao et al 1996 the width of the wedge was b w 0 5 m length l w 1 0 m and its deadrise angle was 30 the length of the measurement segment was 0 2 m the time history of the drop velocity in the tests by zhao et al 1996 was taken as prescribed one in the simulations the initial time is denoted as the moment when the wedge touched the water surface the sensitivity of the numerical solutions to the size of the computational domain was studied the simulations were performed using various domain widths w domain lengths s and water depths d in the sensitivity studies of the domain width w 1 6 m 2 4 m and 3 0 m were used while d 1 5 m and s 1 5 m three water depths d 0 5 m 1 0 m and 1 5 m were examined with fixed domain width and length w 2 4 m and s 1 5 m the numerical solutions are presented in fig 6 a and b respectively it can be seen that the domain size had insignificant effect on the solutions in the following computations w 2 4 m and d 1 0 m were used the sensitivity studies on the domain length s were also conducted with s 2 2 m 2 4 m and 2 6 m and the results are presented in fig 7 it is shown that the numerical results were insensitive to the domain length and s 2 2 m were therefore chosen for the following computations effects of the grid resolution and the time step on the solutions were also investigated in terms of studies on the grid size the minimum grid spacings δ x 0 02 m 0 01 m and 0 005 m were employed and the time step was set as δ t 0 0001 s the total number of grids varied from 274 000 to 13 500 000 three time steps 0 0001 s 0 00005 s and 0 000025 s were used to examine the effect of the time step on the solutions with the finest grid their corresponding courant numbers were around 0 15 0 075 and 0 0375 respectively note that the wedge length l w 1 0 m was set in all sensitivity studies the effects of grid size and time step on solutions are shown in fig 8 a and b respectively the results are sensitive to the grid size but relatively insensitive to the time step and the chosen courant numbers it should be noted that low courant numbers are required to better solve the advection equations and therefore the impulsive impact problems by the present method the courant numbers of less than 0 2 were thus set in all the following computations based on the predicted maximum slamming forces using three sets of grids the gci was evaluated and is given in table 1 along with the variables as defined in eqs 36 40 note that α 1 denotes the predicted maximum slamming force based on the finest grid the uncertainty in the predicted maximum slamming force due to spatial discretization errors is less than 1 the effect of the length of the wedge on the solution was investigated with l w 0 6 m 0 8 m 1 0 m and 1 5 m note that while l w was varied the length of measurement segment was kept the same as that in experiments 0 2 m the solutions are presented in fig 9 in comparison with the two dimensional results it is apparent that a larger wedge length leads to a greater slamming force on the measurement segment this is likely caused by 3 d effects the two dimensional solutions in which l w is considered infinite and no 3 d effect is involved are much larger than the three dimensional results the effect of air compressibility on the predicted slamming force was further investigated the solutions from compressible and incompressible solvers are presented in fig 10 as expected no significant difference can be observed for the wedge with a deadrise angle of 30 note that the air compressibility has an effect on the slamming force only at low deadrise angles less than 4 where compressed air cushions occur yang and qiu 2012a the time history of the computed vertical slamming force using grids with a minimum spacing of 0 005 m and the time step of 0 00005 s is presented in fig 11 and compared with experimental results and the numerical solutions based on the potential flow theory by zhao et al 1996 the vof method by kleefsman et al 2005 and the cip method by yang and qiu 2012a note that l w 1 0 m the same value as that in the experiment by zhao et al 1996 was used in the simulations it is clearly observed that 2d bem over predicted the slamming force however the bem results with 3d correction fall in the range of 3d results by other cfd methods the present method led to much better agreement with the experimental results the numerical results are also compared with solutions based on a different interface capturing scheme in which the governing advection equation for the water phase eq 19 was solved by using the cip method instead of the thinc wlic scheme discrepancies can be found between solutions based on the cip method and the thinc wlic scheme the slamming force was under estimated by the cip method the results based on the parallel cip method have similar trends to those based on the original cip method by yang and qiu 2012a but with suppressed oscillation this may be due to the fact that the solid phase was treated differently in the cip method by yang and qiu 2012a in which the distance for a grid to a panel on the body surface was used to calculate the density function for solid the present method applied 4 point gaussian quadratures to calculate the density function local pressure distributions on the bottom of the wedge at three time instants during the water entry were compared with the numerical solutions and experimental data by zhao et al 1996 in fig 12 in the figure p p p 0 1 2 ρ v t 2 where v t is the drop velocity at the instant t t 0 corresponds to the moment when the wedge keel touches the water surface p 0 0 is the reference pressure ρ is the density of water z z 0 t v t d t and z is the vertical position of a point on the wedge surface measuring from the keel of the wedge it can be seen that the local pressures are generally in good agreement with experimental data and are better predicted by the present method than those by bem the snap shots for free surfaces at six time instants t 0 0005 s 0 005 s 0 01 s 0 015 s 0 02 s and 0 024 s are presented in fig 13 note that the free surface contours were obtained by using the density functions in the computational domain and the isosurface with ϕ 1 0 5 it can be seen that water sprays were well captured the predicted pressure distributions on the wedge bottom at these time instants are also presented in the figures 3 2 case b free fall of a wigley hull the present method with the motion solver was applied to the free fall of a modified wigley hull entering calm water the mathematical hull form is given as 41 η 1 ζ 2 1 ξ 2 1 0 2 ξ 2 ζ 2 1 ζ 8 1 ξ 2 4 where ξ 2 x l s η 2 y b s positive to port side ζ z d s with the vertical axis positive upwards l s 2 x l s 2 b s 2 y b s 2 d s z 0 the drop tests were carried out by hong et al 2012 the length beam and draft of the model are l s 1 25 m b s 0 25 m d s 0 25 m respectively the total mass of the model and the experimental apparatus including sensors is m 149 4 k g the dimensions of the tank used for the tests by hong et al 2012 are 5 m long and 3 m wide and the water depth is 1 4 m sensitivity studies on the size of the computational domain were carried out by using the actual tank size and a smaller domain with w 2 0 m s 1 0 m and d 1 0 m in the sensitivity studies the drop height was set as h 0 5 m as shown in fig 14 the numerical results are not sensitive to the domain size as a result w 2 0 m s 1 0 m and d 1 0 m were used in the following computations the convergences of the numerical solutions to the grid size and the time step are presented in fig 15 a and b respectively with the drop height of h 0 5 m three sets of grids with minimum grids δ x 0 005 m 0 004 m and 0 003 m were employed and the corresponding numbers of grids varied from 10 700 000 to 42 000 000 relatively finer grids than those in the case of the 3 d wedge were used due to the curvature of the wigley hull surface it can be observed from fig 15a that the predicted slamming forces are sensitive to the grid size the maximum slamming forces using coarser grids were smaller than those based on finer grids from the predicted maximum slamming forces the gci for this case denoted as case b1 was evaluated and is presented in table 1 the same studies were extended to another drop height h 0 4 m the calculated gci is given in table 1 case b2 the gci s for both drop heights are less than 2 in the convergence studies on the time step three time steps δ t 0 0002 s 0 0001 s and 0 00005 s were used it can be observed from fig 15b that the time step had an insignificant effect on the predicted slamming force four drop heights h 0 2 m 0 3 m 0 4 m and 0 5 m were further studied using δ x 0 003 m and δ t 0 00005 s the corresponding simulation conditions are summarized in table 2 as shown in fig 16 the predicted maximum vertical slamming forces f s are in good agreement with the experimental results by hong et al 2012 especially at low drop heights at greater drop heights h 0 4 m and h 0 5 m the differences are less than 10 it can be observed that the discrepancies between experimental and numerical results increase as the drop height increases this is mainly due to the increased numerical dissipation and energy loss in water jets and bubbles 3 3 case c free fall of an inclined circular cylinder the numerical method with the motion solver was further validated for the free fall of an inclined cylinder entering calm water experiments on the inclined cylinder were carried out by wei and hu 2015 the simulations are more challenging since the water entry involves not only the initial impact but also the formation and collapse of cavities three different inclined angles θ 0 20 7 48 6 and 55 6 were investigated table 3 presents the properties of the cylinder and the entry conditions in the experiments by wei and hu 2015 the drop tests were conducted in a water tank of 1 35 m 1 35 m 1 35 m a high speed camera was used to track the free surface and motions of the cylinder in the present studies the predicted water surface and motions were compared with the experimental data sensitivity studies on the domain size the grid size and the time step were performed for case c1 θ 0 20 7 the effect of the computational domain size on the solution was first examined using the actual tank dimensions and a smaller domain with w 1 0 m s 0 6 m and d 1 0 m the predicted time histories of the velocity components in the x and z directions u and w the rotational angle θ and the angular velocity d θ d t are presented in fig 17 it can be seen that the numerical results are insensitive to the domain size therefore w 1 0 m s 0 6 m and d 1 0 m were used for the following computations sensitivity studies on the numerical solutions to spatial and temporal discretizations were further performed note that finer grids and smaller time steps were required for this case in comparison with the wedge and the wigley hull cases due to the small diameter of the cylinder the large drop velocities cavities and violent free surfaces five minimum grid sizes δ x 0 01 m 0 005 m 0 004 m 0 0025 m and 0 002 m were investigated the numerical results are presented and compared with the experimental data in fig 18 it can be observed that the numerical solutions are sensitive to the grid size as shown in fig 18c and d larger grid sizes led to much greater discrepancies in the angular velocity and rotational angle however the grid size has less effect on velocities u and w the gci was evaluated for the vertical position of the center of gravity of the cylinder using three sets of grids with δ x 0 01 m 0 005 m and 0 002 m and the value is presented in table 1 the uncertainty is less than 1 it can be seen from fig 19 that the time step has relatively small effect on the numerical solutions the numerical results for cases c2 and c3 are presented in figs 20 and 21 respectively the grid with a minimum grid size of 0 004 m was used and the time step was set as δ t 0 00005 s it can be found that the magnitude of the angular velocity increased more rapidly compared with the experimental results the vertical velocity dropped more quickly than the experimental one as well the translational velocities however were better predicted although the present method works well in predicting forces for initial impact problems it needs improvement for the free fall of the inclined cylinder with rotational body motions especially in simulating cavities and to include the exit phase the snap shots for flow fields at six time instants t 0 002 s 0 013 s 0 051 s 0 100 s 0 122 s and 0 143 s are presented and compared with experimental ones in fig 22 note that the results were based on the finest grid and δ t 0 00005 s the free surface contours were obtained by plotting the isosurfaces using ϕ 1 0 5 the initial impact was shown in fig 22a sprays at the left end were captured in fig 22b in fig 22c f a cavity was formed and moved along the cylinder surface the whole process was in general captured by the present method 4 conclusions a cip based finite difference method was further developed to solve 3 d water entry problems by implementing a parallel algorithm and an interface capturing scheme thinc wlic a six dof motion solver was developed to enable free fall motion simulations the multi phase problems governed by the navier stokes equations were solved on a fixed cartesian grid the free surfaces were captured by using density functions the staggered grids were used to achieve greater accuracy in solutions and better numerical stability it was demonstrated that the parallel computing scheme speeded up the computations as expected validation studies were carried out for a three dimensional wedge a modified wigley hull and an inclined cylinder convergence studies were conducted with respect to the size of the computational domain grid resolution and the time step the predicted slamming forces were compared with experimental results and numerical solutions by other methods it was found that the present method considering free motions is able to solve the slamming problems involving breaking free surfaces and air bubbles with good performance in terms of speed up and accuracy improvements are needed to address the the later phase of free fall motion for the inclinded cylinder which is coupled with complex cavity dynamics and rotational body motions acknowledgements this work was supported by the natural science and engineering research council nserc of canada 
23198,this paper presents the further development of a constrained interpolation profile cip based method to solve highly non linear 3 d slamming problems with a parallel computing algorithm and an improved interface capturing scheme the water entry problems governed by the navier stokes n s equations were treated as multi phase problems solid water and air and solved by the fractional step method in which the 3 d cip method was employed for the advection phase and a pressure based algorithm was applied to the non advection phase the interfaces between different phases were captured by using density functions the advection of the water phase was solved by applying the thinc wlic scheme i e tangent of hyperbola for interface capturing with weighted line interface calculation a six degree of freedom 6dof motion solver was developed to simulate the free fall water entry a message passing interface mpi parallel computing scheme was implemented by decomposing the computational domain the speed up performance was investigated validation studies were carried out for the water entry of a 3 d wedge with prescribed velocities the free fall water entry of a modified wigley hull and an inclined circular cylinder was also studied the computed slamming forces and motions were compared with experimental results and other published numerical results keywords slamming cip method parallel computing interface capturing 1 introduction large amplitude ship motions can result in impulsive water impact and green water on deck which will subsequently cause damages to ship structures it is important to understand and predict the flow behaviour and the impact loads on ships during water entry the slamming problem is highly nonlinear and involves breaking water surfaces and air bubbles early studies were carried out by simplifying the problem into the symmetric entry of a wedge into calm water theoretical analysis of the impact problems was pioneered by von karman 1929 and wagner 1932 korobkin and pukhnachov 1988 presents a review of earlier research various numerical methods have been developed to solve water entry problems the water entry of a wedge was studied by vinje and brevig 1981 greenhow 1987 and zhao and faltinsen 1993 using the potential flow theory zhao et al 1996 further developed and extended the method to general asymmetric bodies chuang et al 2006 studied the water entry problem based on desingularized cauchy s formula by removing the corner singularity at the intersection point of a body and the water surface xu et al 2008 solved the oblique water entry problem of an asymmetrical wedge with boundary element method bem and an analytical solution for the jet xu and wu 2015 used bem with vortex shedding to study the oblique water entry of a wedge the pressure jump was addressed by imposing the kutta condition at the wedge apex although progress has been made with the potential flow theory difficulties exist in treating the highly non linear free surface especially the breaking surfaces which can be overcome by computational fluid dynamics cfd methods for example kleefsman et al 2005 solved the 2 d water entry problem of symmetric bodies based on the volume of fluid vof method and the finite volume method kim et al 2007 applied the smoothed particle hydrodynamics sph method to study 2 d water entry of asymmetric bodies wang and soares 2014 investigated the water impact of 3 d buoys by using an explicit finite element method fem with an arbitrary lagrangian eulerian ale solver zhang et al 2015 studied the effect of compressibility on pressure distribution based on a fem solver the constrained interpolation profile cip method developed by takewaki et al 1985 yabe et al 1991 and yabe 1991 has been employed in water entry studies the cip method is a high order upwind scheme to capture the advection of a profile it uses both the advection function of the profile and its spatial derivatives in each grid cell which leads to sub cell resolution and retains the sharpness of the profile hu and kashiwagi 2004 demonstrated that the cip combined and unified procedure ccup is robust in the simulation of violent free surface flows zhu et al 2007 applied ccup to the problem of a 2 d circular cylinder entering and existing water yang and qiu 2012a b employed the cip method to solve 2 d and 3 d slamming problems wen and qiu 2016 further developed the cip method by implementing a parallel computing scheme to solve 2 d slamming problems further studies were carried out in this work to improve the cip method for 3 d slamming computations a message passing interface mpi algorithm and a domain decomposition approach were developed for parallel computing the tangent of hyperbola for interface capturing with weighted line interface calculation thinc wlic scheme was employed to capture water surfaces a six degree of freedom 6dof motion solver was developed to enable free fall simulations validation studies were carried out for the water entry of a wedge section a wigley hull and an inclined cylinder the effects of domain size water depth grid resolution and time step on the solutions were examined the numerical results were compared with experimental data and numerical solutions by other methods 2 mathematical formulation 2 1 governing equations the governing equations for the viscous flow can be written as 1 ρ t u i ρ x i ρ u i x i 2 u i t u j u i x j 1 ρ σ i j x j f i where t is time x i i 1 2 3 are the spatial coordinates in a 3 d cartesian coordinate system ρ is the density of the fluid u i are the velocity components p is the pressure and f i are the body forces it is assumed that the fluid is newtonian the total stress σ i j can then be written as σ i j p δ i j 2 μ s i j 2 μ δ i j s k k 3 s i j 1 2 u i x j u j x i where μ is the dynamic viscosity and δ i j is the kronecker delta function since the temperature variation is not considered in this study the equation of state can be written as p f ρ applying it to eq 1 the pressure equation can be obtained as 3 p t u i p x i ρ c 2 u i x i where c p ρ is the sound speed 2 2 the fractional step approach and the cip method by applying the fractional step approach to eqs 1 3 the governing equations are split and solved stepwise according to the following steps 1 advection phase 4 ρ t u i ρ x i 0 5 u i t u j u i x j 0 6 p t u i p x i 0 2 non advection phase i 7 u i t 2 μ ρ x j s i j 1 3 δ i j s k k f i 3 non advection phase ii 8 ρ t ρ u i x i 9 u i t 1 ρ p x i 10 p t ρ c 2 u i x i the advection phase is solved by the cip method which computes the advection of a variable χ governed by the following equation 11 χ t u i χ x i h x i t where the variable χ can represent ρ u i and p in eqs 4 6 and h is an arbitrary function in the cip method the transportation of χ and its spatial gradients φ i χ x i are both considered by differentiating eq 11 the advection equation of φ i can be obtained in a similar form the advection of χ and φ i is calculated by a semi lagrangian approach 12 χ x χ ˆ n x u δ t 13 φ i x φ i ˆ n x u δ t where x is the position vector of an arbitrary point u is the velocity vector in the cell χ ˆ n is an interpolation approximation to χ n at the previous time step and φ i ˆ n χ ˆ n x i the interpolation function χ ˆ n is a cubic polynomial constructed at each computational cell and its coefficients are determined from the continuity of χ n and φ i n at grid points details on the cip method can be found in the work of yabe et al 1991 and yabe 1991 in the non advection phase i the euler explicit scheme is applied for time integration and the central finite difference method is used for the spatial derivatives for the non advection phase ii a poisson type equation can be obtained from eqs 9 and 10 14 x i 1 ρ p n 1 x i p n 1 p ρ c 2 δ t 2 1 δ t u i x i where denotes an intermediate value computed from the advection phase and denotes an intermediate value calculated from the non advection phase ii for an incompressible flow eq 14 becomes 15 x i 1 ρ p n 1 x i 1 δ t u i x i the biconjugate gradient stabilized method with the jacobi preconditioner is applied to solve eqs 14 and 15 2 3 staggered grid system a staggered cartesian grid system where different variables are stored in different locations within a grid was used to discretize the computational domain preliminary studies by wen and qiu 2015 indicated that non staggered grids could lead to divergence in the computations a staggered grid system seems to be able to address the divergence problem as shown in fig 1 four types of nodes are employed in the computational domain the p nodes denoted by circles contain the pressure values and other physical properties such as the density of fluid ρ the dynamic viscosity μ and the sound speed c the u nodes squares the v nodes triangles and the w nodes stars store the velocity components along x axis y axis and z axis respectively in each grid the p node is located at the centre of the cell the u node is on the right side cell surface the v node is positioned at the back cell surface and the w node is located on the upper horizontal cell surface the derivatives can be evaluated at different locations for example based on the central difference method the spatial derivative u 1 x at a p node p i j k can be calculated using the neighbouring velocities at u nodes 16 u 1 x p i j k u 1 u i j k u 1 u i 1 j k x u i j k x u i 1 j k 2 4 interface capturing the water entry is considered as a multi phase problem involving water air and solid phases since eqs 14 and 15 are valid for all three phases the pressure field can be solved in the whole computational domain discretized by a fixed cartesian grid the boundary conditions on the interfaces between different phases are not needed density functions ϕ m m 1 2 3 are used to capture the interfaces between body water and air where ϕ 1 denotes the water phase ϕ 2 represents the air phase and ϕ 3 denotes the solid phase the density functions have values between 0 and 1 and satisfy the following relationship at each grid node 17 m 1 3 ϕ m 1 0 at each time step ϕ 3 is calculated from the position of the rigid body and the volume fraction of a grid cell inside the rigid body the volume fraction for grid i j k is determined by using gaussian quadratures as follows 18 ϕ 3 i j k 1 δ x δ y δ z ω ϕ 3 x y z d x d y d z 1 δ x δ y δ z a 1 n b 1 n c 1 n w a w b w c j ϕ 3 x a y b z c where ω is the grid cell at i j k ϕ 3 x y z 1 if a point x y z is inside or on the solid body surface and ϕ 3 x y z 0 otherwise n is the number of gaussian points w s are weights x s y s and z s are the coordinates at gaussian points and j is the jacobian of the transformation between the global and local coordinate systems the density function of water phase ϕ 1 is obtained by solving the advection equation eq 19 using the thinc wlic interface capturing scheme and ϕ 2 is determined from eq 17 at each computational cell 19 ϕ 1 t u i ϕ 1 x i 0 the thinc wlic scheme proposed by yokoi 2007 is a combination of the wlic method and the thinc scheme the thinc scheme proposed by xiao et al 2005 for incompressible free surface flow allows for conservation of mass as well as reduced oscillation and smearing on the interfaces in the case of three dimensional applications the dimensional splitting method is applied so that only the formulation for one dimensional thinc is needed taking the advection of water phase in the x axis as an example the formulation of the one dimensional thinc scheme is briefly summarized below the advection equation of the density function of water ϕ 1 in the velocity field u x t can be written in the conservation form as follows 20 ϕ 1 t u ϕ 1 x ϕ 1 u x discretization of eq 20 using a finite volume method over a computational cell x i 1 2 x i 1 2 and a time step t n t n 1 yields 21 ϕ 1 n 1 ϕ 1 n ψ i 1 2 ψ i 1 2 δ x δ t δ x ϕ 1 n u i 1 2 n u i 1 2 n where ϕ 1 n 1 δ x x i 1 2 x i 1 2 ϕ 1 d x is the cell averaged density function of water at time instance t n ψ i 1 2 t n t n 1 u ϕ 1 i 1 2 d t is the flux across the cell boundary x x i 1 2 over the time step δ t t n 1 t n the fluxes on cell boundaries are calculated by a semi lagrangian method instead of using a polynomial function as in the cip method the thinc scheme uses a stepwise modified hyperbolic tangent function to approximate the profile in the upwind cell 22 γ i x 1 2 1 γ tanh β x x i 1 2 δ x δ where γ β and δ are parameters to be determined after γ x is determined the fluxes at the cell boundaries can be calculated and used in updating ϕ 1 n 1 detailed formulations for the thinc scheme can be found in the work of xiao et al 2005 and hu and kashiwagi 2008 yokoi 2007 improved the multi dimensional thinc scheme by superimposing three line interfaces along x y and z directions ϕ 1 x ϕ 1 y and ϕ 1 z respectively the line interfaces are constructed like the classic simple line interface calculation slic method or the vof method by hirt and nichols 1981 by making use of the surface normal the three line interfaces are combined using weights 23 ϕ 1 w x n ϕ 1 x w y n ϕ 1 y w z n ϕ 1 z where w x n w y n and w z n are the weights calculated from the surface normal vectors n n x n y n z t as below 24 w x n x n x n y n z w y n y n x n y n z w z n z n x n y n z in the thinc wlic scheme ϕ 1 x is constructed using eq 22 and ϕ 1 z ϕ 1 y ϕ 1 for the advection along the x axis similar formulations can be obtained for the advection along the y axis and the z axis considering the constructed interfaces fluxes for the three dimensional case can then be calculated as below 25 ψ x i 1 2 j k w x ψ x x i 1 2 j k 1 w x ϕ 1 i s j k u i 1 2 j k δ t 26 ψ y i j 1 2 k w y ψ y y i j 1 2 k 1 w y ϕ 1 i j s k v i j 1 2 k δ t 27 ψ z i j k 1 2 w z ψ z z i j k 1 2 1 w z ϕ 1 i j k s w i j k 1 2 δ t where ψ x x i 1 2 j k ψ y y i j 1 2 k and ψ z z i j k 1 2 are the fluxes calculated based on the thinc scheme u v and w are the velocity components and the subscripts i s j s and k s denote the density functions in the upwind grids in the x y and z directions respectively details on the formulations can be found in the work of yokoi 2007 2 5 parallel computing since eqs 14 and 15 are solved for all three phases and the pressure distribution is solved in the whole computational domain parallel computing techniques can be applied in a straightforward way in this work an mpi scheme was employed as shown in fig 2 the whole computational domain is first partitioned into n p r o c n x p r o c n y p r o c n z p r o c sub domains similar or equal number of grids are evenly distributed in these sub domains each sub domain is then assigned to one processor or cpu with a unique identity number the cartesian topology was applied to handle the assignment of processors to sub domains the identity numbers of the neighbouring processors are then acquired and stored each processor uses its local memory since the computation of spatial derivatives on the boundary grids in a sub domain requires values in neighbouring processors communications with neighbouring processors are involved to share the values on the boundaries between sub domains in the parallel computations all processors need to store one additional layer of nodes on the boundaries the values in these nodes need to be updated from neighbouring processors before they can be used the communications between processors are achieved by the mpi approach the speed up performance was studied by simulating the water entry of a 3 d wedge using various numbers of processors on a work station it can be seen from fig 3 that the parallelization speeds up the simulation it should be noted that very minor less than 0 01 difference in the predicted slamming force can be found for the water entry case when varying the number of processors and using different partition schemes this is due to the machine error which can be built up in the computations however the difference is negligible 2 6 equations of motion once the pressure distribution in the computational domain is obtained the hydrodynamic force acting on the solid body can be calculated by integrating the pressure on its surface based on gauss s theorem the hydrodynamic force f f x f y f z t can be expressed as 28 f x ω p x ϕ 2 d ω 29 f y ω p y ϕ 2 d ω 30 f z ω p z ϕ 2 d ω where ω denotes the computational domain ϕ 2 is the density function of the solid phase the moment m m x m y m z t with respect to the center of gravity x c x c y c z c t can be obtained as 31 m x ω y y c p z z z c p y ϕ 2 d ω 32 m y ω z z c p x x x c p z ϕ 2 d ω 33 m z ω x x c p y y y c p x ϕ 2 d ω after the hydrodynamic force and moment are obtained the translational and rotational motions of the solid body can be obtained by solving the equations of motion the state variable vector for a rigid body s t can be defined as 34 s t x c t q t p t l t where x c t is the center of gravity in the global coordinate system q t is the quaternion vector denoting the orientation of the solid body p t is the translational momentum vector and l t is the angular momentum vector the equations of motion can be written as follows 35 d d t s t d d t x c t q t p t l t v t 1 2 ω t q t f t m t where ω t q t denotes the quaternion multiplication between the quaternions 0 ω and q v t is the translational velocity vector and ω t is the angular velocity vector in this work the euler explicit scheme was applied to solve the equations of motion 2 7 evaluation of spatial discretization errors uncertainties in the numerical solutions due to spatial discretization errors were evaluated in this work using the grid convergence index gci method proposed by celik et al 2008 the procedure based on the richardson extrapolation is briefly summarized as follows three sets of grid were chosen with grid sizes h 1 h 2 and h 3 where the grid h 1 is the finest computations were carried out using these three grids and the values of interested variables were obtained for example the maximum slamming force the results are denoted as α 1 α 2 and α 3 where α represents the maximum slamming force introducing r 21 h 2 h 1 and r 32 h 3 h 2 the apparent order k was calculated using 36 k 1 ln r 21 ln ε 32 ε 21 q k where ε 32 α 3 α 2 ε 21 α 2 α 1 q k ln r 21 k s r 32 k s s sign ε 32 ε 21 and q k 0 in the case of r 21 r 32 the extrapolated values were calculated from 37 α e 21 r 21 k α 1 α 2 r 21 k 1 the approximate relative error the extrapolated relative error and the gci were obtained using the following equations respectively 38 e a 21 α 1 α 2 α 1 39 e e 21 α e 21 α 1 α e 21 40 gci 1 25 e a 21 r 21 k 1 3 numerical results validation studies were carried out for the water entry of a 3 d wedge the free fall of a wigley hull and an inclined cylinder and the numerical solutions were compared with experimental data and those by other numerical methods in the computations block computational domains were employed as shown in fig 4 where d is the water depth and w and s are the width and the length of the computational domain respectively the solid body for example a 3 d wedge section is located in the middle of the domain non uniform cartesian grids were used with finer grids distributed near the path of the body fig 5 presents a cross section of the non uniform grids 3 1 case a water entry of a 3 d wedge in the experiments on the water entry of a 3 d wedge by zhao et al 1996 the width of the wedge was b w 0 5 m length l w 1 0 m and its deadrise angle was 30 the length of the measurement segment was 0 2 m the time history of the drop velocity in the tests by zhao et al 1996 was taken as prescribed one in the simulations the initial time is denoted as the moment when the wedge touched the water surface the sensitivity of the numerical solutions to the size of the computational domain was studied the simulations were performed using various domain widths w domain lengths s and water depths d in the sensitivity studies of the domain width w 1 6 m 2 4 m and 3 0 m were used while d 1 5 m and s 1 5 m three water depths d 0 5 m 1 0 m and 1 5 m were examined with fixed domain width and length w 2 4 m and s 1 5 m the numerical solutions are presented in fig 6 a and b respectively it can be seen that the domain size had insignificant effect on the solutions in the following computations w 2 4 m and d 1 0 m were used the sensitivity studies on the domain length s were also conducted with s 2 2 m 2 4 m and 2 6 m and the results are presented in fig 7 it is shown that the numerical results were insensitive to the domain length and s 2 2 m were therefore chosen for the following computations effects of the grid resolution and the time step on the solutions were also investigated in terms of studies on the grid size the minimum grid spacings δ x 0 02 m 0 01 m and 0 005 m were employed and the time step was set as δ t 0 0001 s the total number of grids varied from 274 000 to 13 500 000 three time steps 0 0001 s 0 00005 s and 0 000025 s were used to examine the effect of the time step on the solutions with the finest grid their corresponding courant numbers were around 0 15 0 075 and 0 0375 respectively note that the wedge length l w 1 0 m was set in all sensitivity studies the effects of grid size and time step on solutions are shown in fig 8 a and b respectively the results are sensitive to the grid size but relatively insensitive to the time step and the chosen courant numbers it should be noted that low courant numbers are required to better solve the advection equations and therefore the impulsive impact problems by the present method the courant numbers of less than 0 2 were thus set in all the following computations based on the predicted maximum slamming forces using three sets of grids the gci was evaluated and is given in table 1 along with the variables as defined in eqs 36 40 note that α 1 denotes the predicted maximum slamming force based on the finest grid the uncertainty in the predicted maximum slamming force due to spatial discretization errors is less than 1 the effect of the length of the wedge on the solution was investigated with l w 0 6 m 0 8 m 1 0 m and 1 5 m note that while l w was varied the length of measurement segment was kept the same as that in experiments 0 2 m the solutions are presented in fig 9 in comparison with the two dimensional results it is apparent that a larger wedge length leads to a greater slamming force on the measurement segment this is likely caused by 3 d effects the two dimensional solutions in which l w is considered infinite and no 3 d effect is involved are much larger than the three dimensional results the effect of air compressibility on the predicted slamming force was further investigated the solutions from compressible and incompressible solvers are presented in fig 10 as expected no significant difference can be observed for the wedge with a deadrise angle of 30 note that the air compressibility has an effect on the slamming force only at low deadrise angles less than 4 where compressed air cushions occur yang and qiu 2012a the time history of the computed vertical slamming force using grids with a minimum spacing of 0 005 m and the time step of 0 00005 s is presented in fig 11 and compared with experimental results and the numerical solutions based on the potential flow theory by zhao et al 1996 the vof method by kleefsman et al 2005 and the cip method by yang and qiu 2012a note that l w 1 0 m the same value as that in the experiment by zhao et al 1996 was used in the simulations it is clearly observed that 2d bem over predicted the slamming force however the bem results with 3d correction fall in the range of 3d results by other cfd methods the present method led to much better agreement with the experimental results the numerical results are also compared with solutions based on a different interface capturing scheme in which the governing advection equation for the water phase eq 19 was solved by using the cip method instead of the thinc wlic scheme discrepancies can be found between solutions based on the cip method and the thinc wlic scheme the slamming force was under estimated by the cip method the results based on the parallel cip method have similar trends to those based on the original cip method by yang and qiu 2012a but with suppressed oscillation this may be due to the fact that the solid phase was treated differently in the cip method by yang and qiu 2012a in which the distance for a grid to a panel on the body surface was used to calculate the density function for solid the present method applied 4 point gaussian quadratures to calculate the density function local pressure distributions on the bottom of the wedge at three time instants during the water entry were compared with the numerical solutions and experimental data by zhao et al 1996 in fig 12 in the figure p p p 0 1 2 ρ v t 2 where v t is the drop velocity at the instant t t 0 corresponds to the moment when the wedge keel touches the water surface p 0 0 is the reference pressure ρ is the density of water z z 0 t v t d t and z is the vertical position of a point on the wedge surface measuring from the keel of the wedge it can be seen that the local pressures are generally in good agreement with experimental data and are better predicted by the present method than those by bem the snap shots for free surfaces at six time instants t 0 0005 s 0 005 s 0 01 s 0 015 s 0 02 s and 0 024 s are presented in fig 13 note that the free surface contours were obtained by using the density functions in the computational domain and the isosurface with ϕ 1 0 5 it can be seen that water sprays were well captured the predicted pressure distributions on the wedge bottom at these time instants are also presented in the figures 3 2 case b free fall of a wigley hull the present method with the motion solver was applied to the free fall of a modified wigley hull entering calm water the mathematical hull form is given as 41 η 1 ζ 2 1 ξ 2 1 0 2 ξ 2 ζ 2 1 ζ 8 1 ξ 2 4 where ξ 2 x l s η 2 y b s positive to port side ζ z d s with the vertical axis positive upwards l s 2 x l s 2 b s 2 y b s 2 d s z 0 the drop tests were carried out by hong et al 2012 the length beam and draft of the model are l s 1 25 m b s 0 25 m d s 0 25 m respectively the total mass of the model and the experimental apparatus including sensors is m 149 4 k g the dimensions of the tank used for the tests by hong et al 2012 are 5 m long and 3 m wide and the water depth is 1 4 m sensitivity studies on the size of the computational domain were carried out by using the actual tank size and a smaller domain with w 2 0 m s 1 0 m and d 1 0 m in the sensitivity studies the drop height was set as h 0 5 m as shown in fig 14 the numerical results are not sensitive to the domain size as a result w 2 0 m s 1 0 m and d 1 0 m were used in the following computations the convergences of the numerical solutions to the grid size and the time step are presented in fig 15 a and b respectively with the drop height of h 0 5 m three sets of grids with minimum grids δ x 0 005 m 0 004 m and 0 003 m were employed and the corresponding numbers of grids varied from 10 700 000 to 42 000 000 relatively finer grids than those in the case of the 3 d wedge were used due to the curvature of the wigley hull surface it can be observed from fig 15a that the predicted slamming forces are sensitive to the grid size the maximum slamming forces using coarser grids were smaller than those based on finer grids from the predicted maximum slamming forces the gci for this case denoted as case b1 was evaluated and is presented in table 1 the same studies were extended to another drop height h 0 4 m the calculated gci is given in table 1 case b2 the gci s for both drop heights are less than 2 in the convergence studies on the time step three time steps δ t 0 0002 s 0 0001 s and 0 00005 s were used it can be observed from fig 15b that the time step had an insignificant effect on the predicted slamming force four drop heights h 0 2 m 0 3 m 0 4 m and 0 5 m were further studied using δ x 0 003 m and δ t 0 00005 s the corresponding simulation conditions are summarized in table 2 as shown in fig 16 the predicted maximum vertical slamming forces f s are in good agreement with the experimental results by hong et al 2012 especially at low drop heights at greater drop heights h 0 4 m and h 0 5 m the differences are less than 10 it can be observed that the discrepancies between experimental and numerical results increase as the drop height increases this is mainly due to the increased numerical dissipation and energy loss in water jets and bubbles 3 3 case c free fall of an inclined circular cylinder the numerical method with the motion solver was further validated for the free fall of an inclined cylinder entering calm water experiments on the inclined cylinder were carried out by wei and hu 2015 the simulations are more challenging since the water entry involves not only the initial impact but also the formation and collapse of cavities three different inclined angles θ 0 20 7 48 6 and 55 6 were investigated table 3 presents the properties of the cylinder and the entry conditions in the experiments by wei and hu 2015 the drop tests were conducted in a water tank of 1 35 m 1 35 m 1 35 m a high speed camera was used to track the free surface and motions of the cylinder in the present studies the predicted water surface and motions were compared with the experimental data sensitivity studies on the domain size the grid size and the time step were performed for case c1 θ 0 20 7 the effect of the computational domain size on the solution was first examined using the actual tank dimensions and a smaller domain with w 1 0 m s 0 6 m and d 1 0 m the predicted time histories of the velocity components in the x and z directions u and w the rotational angle θ and the angular velocity d θ d t are presented in fig 17 it can be seen that the numerical results are insensitive to the domain size therefore w 1 0 m s 0 6 m and d 1 0 m were used for the following computations sensitivity studies on the numerical solutions to spatial and temporal discretizations were further performed note that finer grids and smaller time steps were required for this case in comparison with the wedge and the wigley hull cases due to the small diameter of the cylinder the large drop velocities cavities and violent free surfaces five minimum grid sizes δ x 0 01 m 0 005 m 0 004 m 0 0025 m and 0 002 m were investigated the numerical results are presented and compared with the experimental data in fig 18 it can be observed that the numerical solutions are sensitive to the grid size as shown in fig 18c and d larger grid sizes led to much greater discrepancies in the angular velocity and rotational angle however the grid size has less effect on velocities u and w the gci was evaluated for the vertical position of the center of gravity of the cylinder using three sets of grids with δ x 0 01 m 0 005 m and 0 002 m and the value is presented in table 1 the uncertainty is less than 1 it can be seen from fig 19 that the time step has relatively small effect on the numerical solutions the numerical results for cases c2 and c3 are presented in figs 20 and 21 respectively the grid with a minimum grid size of 0 004 m was used and the time step was set as δ t 0 00005 s it can be found that the magnitude of the angular velocity increased more rapidly compared with the experimental results the vertical velocity dropped more quickly than the experimental one as well the translational velocities however were better predicted although the present method works well in predicting forces for initial impact problems it needs improvement for the free fall of the inclined cylinder with rotational body motions especially in simulating cavities and to include the exit phase the snap shots for flow fields at six time instants t 0 002 s 0 013 s 0 051 s 0 100 s 0 122 s and 0 143 s are presented and compared with experimental ones in fig 22 note that the results were based on the finest grid and δ t 0 00005 s the free surface contours were obtained by plotting the isosurfaces using ϕ 1 0 5 the initial impact was shown in fig 22a sprays at the left end were captured in fig 22b in fig 22c f a cavity was formed and moved along the cylinder surface the whole process was in general captured by the present method 4 conclusions a cip based finite difference method was further developed to solve 3 d water entry problems by implementing a parallel algorithm and an interface capturing scheme thinc wlic a six dof motion solver was developed to enable free fall motion simulations the multi phase problems governed by the navier stokes equations were solved on a fixed cartesian grid the free surfaces were captured by using density functions the staggered grids were used to achieve greater accuracy in solutions and better numerical stability it was demonstrated that the parallel computing scheme speeded up the computations as expected validation studies were carried out for a three dimensional wedge a modified wigley hull and an inclined cylinder convergence studies were conducted with respect to the size of the computational domain grid resolution and the time step the predicted slamming forces were compared with experimental results and numerical solutions by other methods it was found that the present method considering free motions is able to solve the slamming problems involving breaking free surfaces and air bubbles with good performance in terms of speed up and accuracy improvements are needed to address the the later phase of free fall motion for the inclinded cylinder which is coupled with complex cavity dynamics and rotational body motions acknowledgements this work was supported by the natural science and engineering research council nserc of canada 
23199,a coupled wave current system has been developed in the present paper based on two open source community models the finite volume community ocean model fvcom and the simulating waves nearshore swan using model coupling toolkit mct the coupled system runs on unstructured grids and multiple processors and information including water elevations and currents from fvcom and wave parameters from swan exchanges between fvcom and swan in both on line and two way manners the system was evaluated against laboratory experiments and the evaluation showed that the simulated results agree well with the measured data compared to the existing off line coupling system based on fvcom and swan the system in the present study is able to accomplish the on line two way coupling and at the same time is more efficient for computations and easier to use for the nearshore wave current simulations keywords coupled model radiation stress fvcom swan mct 1 introduction waves and currents commonly interact with each other in coastal waters and play a key role in sediment transport morphological evolution and pollutant mixing rodriguez et al 1995 li and johns 1998 bever and macwilliams 2013 the interactions are nonlinear and complex olabarrieta et al 2011 roland et al 2012 benetazzo et al 2013 on one hand the gradient of wave radiation stresses generates wave induced currents longuet higgins 1970 garcez faria et al 2000 and thus further influences the mean water level by increasing water levels near the shoreline or decreasing water levels near the wave breaking point longuet higgins and stewart 1964 guza and thornton 1981 meanwhile waves in the surf zone can enhance the horizontal mixing and bottom drag on the other hand changes in water levels and currents can in turn affect the motion and evolution of waves dutour sikiric et al 2013 allard et al 2014 a coupling system of waves and currents in a numerical model usually uses the following two ways one is the off line coupling and the other is the on line coupling for the off line coupling the wave model and the current model run independently and the model results are archived separately the effects of waves on currents or the effects of currents on waves were estimated by using the archived wave or current results the data can be transferred from one model to the other one one way or exchanged between both the two models two way in the two way approach in order to include the nonlinear interactions between waves and currents it usually uses an iteration manner for example yoon et al 2004 and huang et al 2010 until the solution converges for the on line coupling alternatively the current and wave models run simultaneously and the information exchanges for calculating interactions at predefined time steps during the program execution which is a two way coupling method singhal et al 2013 compared the one way current to wave off line and two way on line coupling methods for the wave current interactions in cook inlet alaska their results indicated that an online coupling may not be necessary because the effect of waves on currents is marginal at the spatial scale of about 1 5 km however simulations of waves over submerged shoal by yoon et al 2004 and zheng et al 2012 pointed out that only two way coupled method can account for the wave induced current and the influence of current on wave distributions the investigations of a storm surge by a recent study of staneva et al 2016 demonstrated that the effects of two way coupling are clearly more important than that of a one way coupling especially in the shallow waters where nonlinear interactions dominate the wave current coupling compared to the file based coupling with an off line method the on line coupling is likely to be more efficient bettencourt 2002 recently some on line coupled models for currents and waves have been developed for example brown et al 2011 coupled the modified spectral wave model wam to the proudman oceanographic laboratory coastal ocean modeling system polcoms with an aim to simulate wave current interactions in shallow waters bennis et al 2011 coupled the spectral wave model of wavewatch iii with a 3 d hydrodynamical model for applications at regional scale mars3d roland et al 2009 developed a 2 d coupled wave current model based on the wind wave model ii wwm ii and the shallow water hydrodynamic finite element model shyfem which has an unstructured model mesh the wwm ii model was also coupled with the semi implicit eulerian lagrangian finite element selfe ocean model roland et al 2012 and the regional ocean modeling system roms dutour sikiric et al 2013 wang and shen 2011 developed a spectral wave model and coupled it to the finite volume community ocean model fvcom of chen et al 2003 the simulating waves nearshore swan model as one of the most commonly used wave model has been coupled to different ocean circulation models warner et al 2008b liu et al 2010 dietrich et al 2011 guillou and chapalain 2011 kumar et al 2012 bever and macwilliams 2013 allard et al 2014 feng et al 2016 most of the coupled models based on swan are developed on structured meshes except for the models of bever and macwilliams 2013 dietrich et al 2011 and feng et al 2016 bever and macwilliams 2013 coupled the swan model to the unstructured tidal residual and inter tidal mudflat untrim hydrodynamic model of casulli and zanolli 2005 dietrich et al 2011 and feng et al 2016 coupled the swan model to the depth integrated advanced circulation adcirc model in the present paper another unstructured mesh model fvcom will be coupled with swan both swan and fvcom are extensively used in coastal and nearshore studies and they are open source community models different from wu et al 2011 who coupled a finite volume version of swan called swave developed by qi et al 2009 and fvcom directly where swave is a module of fvcom in our study original swan is coupled to fvcom original swan adopts fully implicit method and is stable for any time step zijlema 2010 while swave uses explicit or semi implicit method qi et al 2009 which however usually requires a smaller time step than swan this indicates that swave is less efficient than swan model and this may largely limit the applications of fvcom especially in a situation where waves are important in the present study a popular coupling tool model coupling toolkit mct is used mct allows the exchange of distributed data between component models and preservation of the original codes of the individual model as much as possible it has been used in the coupled system of roms warner et al 2008b it is relatively easy to update the codes of swan and fvcom in the coupled model when the new versions of these two models are released the rest of this paper is organized as follow the models and coupling method are presented in section 2 model evaluation is given in section 3 model efficiency analysis is discussed in section 4 and conclusions are drawn in section 5 2 approaches to the coupled model 2 1 models 2 1 1 fvcom the fvcom model initially developed by chen et al 2003 has been successfully applied to studies for regional scale ocean and coastal areas lai et al 2010 it is discretized using an unstructured triangle mesh in the horizontal direction and a terrain following coordinate sigma coordinate is used in the vertical the three dimensional governing equations with boussinesq approximation are presented as follows 1 u d t u 2 d x u v d y u ω σ f v d g d η x d ρ 0 p a x g d ρ 0 σ 0 d ρ x d σ d x σ 0 σ ρ σ d σ d s x x x d s x y y s p x σ 1 d σ k m u σ d f u 2 v d t u v d x v 2 d y v ω σ f u d g d η y d ρ 0 p a y g d ρ 0 σ 0 d ρ y d σ d y σ 0 σ ρ σ d σ d s y x x d s y y y s p y σ 1 d σ k m v σ d f v 3 u x v y σ x u σ σ y v σ 1 d w σ 0 4 η t d u x d v y ω σ 0 where u v and w are the velocity components in the horizontal x y and vertical z directions respectively ω is the transformed vertical velocity corresponding to the σ coordinate η is the water surface elevation d is the total water depth f is the coriolis parameter ρ 0 is the reference density ρ is the in situ density p a is the atmospheric pressure k m is the vertical eddy viscosity g is the gravitational acceleration f u and f v are the horizontal diffusion terms and s xx s xy and s yy represent the components of wave radiation stresses expressions of recent three dimensional wave radiation stresses of ji et al 2017 are adopted here their work has improved the expressions of mellor 2003 2015 by the terms representing the vertical variation of the dynamic pressure which were derived through the lagrangian wave solutions including the bottom slope effects the horizontal radiation tress terms in eq 1 and eq 2 are 5 s x x k e k x k x k 2 f c c f c s f c s f c c f s s f c s k x k x k c 2 l a r r z n s y y k e k y k y k 2 f c c f c s f c s f c c f s s f c s k y k y k c 2 l a r r z n s x y s y x k e k x k y k 2 f c c f c s k x k y k a r r z n where the terms using brackets represent traditional radiation stresses due to waves mellor 2003 2015 ji et al 2017 and the last terms are the surface roller terms svendsen 1984a in eq 5 k is the wavenumber with k x and k y as the x and y components c is the phase celerity l is the wave length e is the wave energy and a r is the roller area which is calculated based on the formula of svendsen 1984a 6 a r α 2 h s l q b where h s is the significant wave height q b is the fraction of breaking waves and α is a parameter r z n in eq 5 represents the vertical distribution for wave surface roller which is calculated as follows 7 r z n 1 tanh 2 σ d h s 4 following ji et al 2017 the vertical radiation tress terms in eq 1 and eq 2 are written as 8 s p x 1 2 g a 0 m 2 a 0 m 1 x 1 2 k g a 0 2 d x m 2 n 1 m 1 n 2 s p y 1 2 g a 0 m 2 a 0 m 1 y 1 2 k g a 0 2 d y m 2 n 1 m 1 n 2 where a 0 is the wave amplitude m 1 m 2 n 1 and n 2 are parameters whose calculation method are referred to ji et al 2017 f ss f cs f sc and f cc in eq 5 are vertical distribution functions for wave radiation stresses mellor 2003 2015 9 f s s sinh k d 1 σ sinh k d f c s cosh k d 1 σ sinh k d f s c sinh k d 1 σ cosh k d f c c cosh k d 1 σ cosh k d 2 1 2 swan swan is a spectral wave model originally developed by booij et al 1999 which has become a popular model for the simulation of coastal waves both structured and unstructured grids are supported in swan model the governing equation of this model is given as 10 t n x c x n y c y n γ c γ n θ c θ n s γ where n is the wave action density γ is the frequency θ is the propagation direction c x and c y are the x and y components of propagation speed c γ and c θ are the γ and θ components of propagation speed and s is the source term for the wave energy 2 2 mct mct is an open source toolkit used for model coupling larson et al 2005 mct uses message passing interface mpi and supports parallel computing which is used in fvcom and swan in coupling mct provides code interfaces to describe the parallel decomposition of grids for fvcom and swan and exchange data between the two models mct has been applied to many coupled ocean wave models based on structured grids for example roms and swan warner et al 2008b its application to fvcom with a wave model however is not available 2 3 coupling according to malleron et al 2011 three kinds of techniques can be used for coupling two models the first is to merge codes of these two models directly transferring of results between the two models is based on memory in this case using the computer memory is efficient however modelers have to modify the model codes which is not always easy since the two models are usually developed independently the second approach is to utilize the existing communication tools or protocols such as mpi this method also needs special knowledge for model developers the third approach is to use a model coupling tool which provides an interface to transfer data automatically between the two coupled models this method reduces significantly the workload of the code modification during the model development and has been extensively used in contemporary model coupling warner et al 2008b bennis et al 2011 allard et al 2014 feng et al 2016 in this study we use the third approach and the coupling tool is mct following the method of warner et al 2008a for coupling two models using mct fvcom and swan are compiled separately to object files and linked together as one executable program which needs a coded master program with an aim to control the execution flow and setup the parallel computing environment including initialization and allocation processors for each component model as schematically illustrated in fig 1 initializations of mct are required in both the two models including the description of mesh decomposition and establishing connections between the two models fvcom and swan run simultaneously and exchange information at predefined time intervals by calling mct application program interfaces apis data transferring between fvcom and swan and description of mesh decomposition are briefly introduced in this section the detailed method to use mct can be referenced to warner et al 2008a 2 3 1 data transferring between fvcom and swan only two dimensional variables are exchanged between fvcom and swan the water surface elevation η vertically integrated velocity u a and v a are transferred by fvcom to swan model water surface elevation is used to modify the water depth in swan model and the current velocity influences the propagation of waves swan model transfers to fvcom with significant wave height h s mean wave length l m mean wave direction θ m and fraction of breaking waves q b which are used to calculate wave radiation stresses and surface rollers in eq 1 and eq 2 for fvcom model the water surface elevation is stored at nodes and vertically integrated velocities are stored in cells all the variables are stored at nodes in swan model to facilitate the data exchange vertically integrated velocities in fvcom are interpolated to nodes firstly and then they are transferred to swan through mct 2 3 2 mesh decomposition and its description using mct fvcom and swan are run on the same unstructured grid to avoid data interpolation between the two models the global mesh is decomposed into different subdomains for parallel computing and each subdomain is mapped to a processor the mesh decomposition is schematically indicated in fig 2 information exchange among the processors is performed through mpi the whole mesh shown in fig 2 consists of 8 cells and 10 nodes which are mapped to two processors for parallel computing the processor p1 is responsible for cells c1 c4 and processor p2 is responsible for cells c5 c8 to complete the parallel computing data at halo points nodes n3 n7 n8 and n9 are stored by both the two corresponding processors the grid information needs to be described with a specific format in mct for model coupling which means that mct should know how the grid is decomposed among different processors for each of the coupled models for unstructured grids mct provides domain descriptor globalsegmap where the unstructured mesh is described using a linearized method take the domain decomposition in fig 2 as an example arrays start and length are used to store the mesh information nodes n1 n2 n3 n6 n7 n8 and n9 are described by processor p1 in mct the array elements start 1 1 and length 1 3 represent nodes n1 n2 and n3 and start 2 6 and length 1 4 represent nodes n6 n7 n8 and n9 it is noted that repeated information for mesh description is not allowed in mct or data exchange between the coupled models cannot be completed data at nodes n3 n7 n8 and n9 are stored by both the two corresponding processors however each of these nodes should be described by only one processor for the domain description in mct in this paper these data are stored by the processor with smaller processor index which means p1 is responsible for nodes n3 n7 n8 and n9 in domain description 3 model evaluation 3 1 wave induced setup in the coastal surf zone decreasing of wave heights due to wave breaking can result in decreasing of wave radiation stress towards the shoreline which leads to the increase of mean water level i e wave induced setup to balance the gradient of wave radiation stress longuet higgins and stewart 1964 changes in water level can in turn affect wave heights nearshore these processes can be used to test the capacity of the developed coupled model on simulation of wave induced setup and related wave heights experiments of stive 1985 are used to evaluate the coupled model in this study the experiments are accomplished in a wave flume with the still water depth of 0 7 m in the horizontal section and the slope of a plane concrete beach in the right part is 1 40 fig 3 irregular waves with significant wave height of 0 194 m and peak spectral period of 1 58 s are imposed from the left boundary in the model the grid size is 1 m at the left boundary and gradually changes to 0 5 m at the right boundary the time step is 5 s for swan and 0 002 s for fvcom and the time interval for data exchanges between the two models is 5 s as shown in fig 4 simulated results of wave heights along the centerline of the computational domain in the x direction agree well with experimental data both the model results and experimental data show that the wave height keeps nearly constant within 25 m and rapidly decreases at 30 m the coupled model illustrates the depth induced wave breaking in the shallow waters the distribution of wave heights as shown in fig 4 can result in a horizontal gradient of wave radiation stresses which leads to wave induced set up i e increasing water levels near the shoreline longuet higgins and stewart 1964 simulated water surface elevations agree well with experimental data of stive 1985 as shown in fig 5 3 2 wave induced longshore currents when waves propagate obliquely in the onshore direction and eventually break on a beach variations of wave heights can result in the gradient of wave radiation stress in not only the cross shore but also longshore direction the gradient of wave radiation stress in the cross shore direction can lead to setup as mentioned in section 3 1 and the gradient of wave radiation stress in the longshore direction generates a mean current that flows parallel to the coast i e wave induced longshore currents longuet higgins 1970 the change of mean water levels and wave induced longshore currents can in turn influence the distribution of wave heights these processes can be used to test the capacity of the developed coupled model on the computation of wave induced longshore currents and related wave heights experiments of hamilton and ebersole 2001 are used to evaluate the coupled model one of their test cases with irregular waves is chosen for this section called test8e in their paper the experiments are carried out in a wave basin with the still water depth of 0 667 m at the wave generator and the slope of the concrete beach is 1 30 as shown in fig 6 irregular waves with significant wave height of 0 225 m and peak spectral wave period of 2 5 s are generated at the wave generator the angle between wave propagation direction and shore normal is 10 in the model the grid size of the unstructured mesh is 1 m at the left boundary and gradually changes to 0 2 m at the right boundary the time step is 5 s for swan and 0 002 s for fvcom and the time interval for data exchanges between the two models is 5 s as shown in fig 7 a wave heights simulated by the coupled model agree well with experimental data of hamilton and ebersole 2001 the simulated wave induced vertically integrated longshore current velocities by the coupled model could basically agree with the experimental data at most of the points as shown in fig 7 b near the wave breaking point at x 15 m and at the section near x 26 m where the maximum longshore current occurs the simulated longshore currents are slightly different from the experimental data the longshore current presents nearly uniform vertical distribution with depth according to experimental measurement visser 1991 hamilton and ebersole 2001 the simulated vertical profiles of mean longshore current velocities agree basically with the measured data fig 8 root mean square errors rmses of simulated longshore current velocities at all the profile positions shown in fig 8 are in the range of 0 030 0 069 m s table 1 relative rmses rrmses defined same as in kumar et al 2012 at the profile positions are in the range of 0 10 0 22 except 0 357 at no 1 profile which is assumed to be still acceptable considering the quite small absolute values of observed data at this profile the overall errors for this case are small consistent with those of kumar et al 2012 for a similar application see their table 4 the slight difference between simulated results and experimental data on longshore current near x 26 m is likely because the adopted wave roller model in fvcom is not optimized for this case moghimi et al 2013 chen and zhang 2016 we use the formulations of svendsen 1984a and warner et al 2008b to calculate the roller area and roller energy larger value of α in eq 6 could result in more energy transferred into water column from wave roller eq 5 whose value is chosen as 0 06 for all the test cases according to svendsen 1984a for simplicity simulated results with α 0 12 are also presented in fig 8 to test the effect of wave roller on the longshore current velocities transferring more energy from wave roller into water column momentum could lead to the local peak value of longshore current shifting towards the shoreline moghimi et al 2013 chen and zhang 2016 in the present model adjusting wave roller coefficient α from 0 06 to 0 12 increases longshore current velocities at profile position of x 27 28 m fig 8 agreeing better with observed data these results are consistent with those of moghimi et al 2013 and chen and zhang 2016 an alternative wave roller model needs to solve time dependent roller evolution equations for example xie 2011 and moghimi et al 2013 tuning the wave roller model may improve the results whereas this is not the objective of the present study which focuses on providing a framework of a coupled model based on community models on unstructured grids the wave roller model used in fvcom could be improved in the future 3 3 wave induced cross shore flow undertow in the coastal surf zone the depth averaged wave radiation stress and pressure gradient due to wave set up can balance each other as shown in section 3 1 the local difference in the vertical between these two forces can lead to a seaward mean flow below the level of wave trough called undertow svendsen 1984b ting and kirby 1994 and the increase in mean water level due to wave set up can influence the wave heights distributions in the shore normal these processes can be used to test the capacity of the developed coupled model on simulation of wave induced cross shore currents and related wave heights data from the test case 1a of roelvink and reniers 1995 on undertow are used to evaluate the coupled model the experiments were carried out in the delta flume of delft hydraulics with the length of 200 m and still water depth of 4 1 m at offshore irregular waves with significant wave height of 0 9 m and peak spectral wave period of 5 s were generated at the wave generator the beach consists of fine sand with the equilibrium beach profile shown in fig 9 in the model the grid size of the unstructured mesh is 2 m at the left boundary and gradually changes to 1 m at the right boundary the time step is 5 s for swan and 0 01 s for fvcom and the time interval for data exchanges between the two models is 5 s simulated results of wave heights along the centerline of the computational domain in the x direction agree well with experimental data fig 9 waves break near x 130 m giving rise to decrease of wave heights which results in cross shore wave averaged flows the simulated cross shore averaged flow velocities show a general agreement with the measured data at different locations in the shore normal direction fig 10 rmses of simulated cross shore velocities at all profile positions shown in fig 10 are in the range of 0 008 0 060 m s table 2 the mean value of rrmses at all the profile positions is 0 57 which is similar to the results of kumar et al 2012 for another application on barred beach see their table 4 larger value of rrmse at no 3 profile may be because of the small absolute values of observed data at this profile which are quite close to zero the developed coupled model can capture the vertical structure of undertow however simulated flow velocities near still water surface elevation are slightly different from the experimental data near x 130 m and near x 150 m this is likely because the adopted wave roller model in fvcom is not optimized for this case moghimi et al 2013 chen and zhang 2016 3 4 tide wave interaction in an ideal bay the coupled mode is applied to a case of tide wave interaction in an ideal bay as shown in fig 11 the length of the domain is 30 km and the width is 14 km the upside boundary of this ideal case is an open boundary where the tide and wave are imposed and the other three boundaries are land boundaries the bottom is plane and its slope is 1 1000 which is a common slope in the muddy tidal flats the significant wave height at the upper boundary is 3 m and the peak spectral wave period is 8 s the angle of wave incidence relative to shore normal is 10 an ideal tidal constituent is chosen to drive the model whose range and period are 4 m and 12 h respectively the mesh size is nearly uniform and chosen as 100 m it is worth to note that the model in the ideal case uses a resolution of 100 m instead of 1 m in the subsections of 3 1 3 3 because of the different model domains the coriolis force is not considered for simplicity the time step is 2 min for swan and 0 25 s for fvcom and the time interval for data exchange between the two component models is 2 min swan and fvcom model are also run separately to compare the simulated results with those by the coupled model in coastal areas water surface elevations vary with time due to influences of the tide leading to changes of water depth which could result in breaking of waves and variations of wave heights distribution hence for a run of only swan model wave heights reach a steady state without the influence of varying water depth decreasing gradually towards the coastline as shown in fig 12 a however for a run of the coupled model waves change periodically with tides the wave height distribution at the time of high tide is quite different from that of low tide in fig 12 b and c the wave height shows a constant in the run of only swan model while it oscillates within the tidal period in the coupled model run fig 13 the distribution of wave heights along the centerline x 15 km indicates that wave breaking occurs near x 9 km at the time of high tide and near x 13 km at the time of low tide fig 14 wave breaking could generate wave induced setup as explained in section 3 1 compared to results of only fvcom model simulated water surface elevations along the centerline x 15 km by the coupled model at times of high tide and low tide clearly show wave induced setup see fig 15 in shallow waters maximum wave induced set up can increase surface elevation by about 8 5 and 9 1 at the time of high tide and low tide respectively comparisons between the results of elevations at point a x 15 km y 6 km by the coupled model and those by only fvcom model demonstrate that wave induced setup increases water surface elevations see fig 16 especially at times of low tide in addition to wave induced setup variation of wave distributions could also lead to longshore and cross shore currents wave induced longshore and cross shore flow velocities are obtained by the difference between simulated results of coupled model and those of only fvcom model simulated depth integrated longshore currents by the coupled model at times of high tide and low tide are shown in fig 17 because of discrepancy between wave heights distribution at times of high tide and low tide fig 14 wave induced longshore currents are different at these times the position of the peak value for longshore currents is more towards the shore at the time of high tide and more away from the shore at the time of low tide fig 17 in the vertical direction the wave induced longshore current velocity at the point a exponentially increases with depth in the bottom layer and then linearly to the water surface fig 18 it reaches 0 21 m s at the time of high tide about four times of that at the time of low tide wave induced cross shore flow velocities are relatively small compared to the tidal current velocities at the point a at the time of maximum flood and ebb fig 19 in short the above results indicate that the developed two way coupled model could account for the interaction between wave and tide in the nearshore region 4 comparison between on line and off line coupling in the above developed model fvcom and swan models are two way coupled in an on line manner they can also be two way coupled in an off line manner for the case of wave induced longshore currents in section 3 2 the off line two way coupling can be performed as follows swan model runs firstly and saves the results of wave parameters at every exchange interval into files and then fvcom model is executed with the results of swan model as input files writing the results of water surface elevation and vertically integrated velocities into files swan model reruns with the results of fvcom as input then fvcom model runs again using the results of the second run of swan model the off line coupling can avoid the effort of codes modification of each component model it usually uses an iteration manner to obtain converged solutions for the case of wave induced longshore currents in section 3 2 table 3 shows the relative root mean square errors of off line coupling to the on line coupling for the vertical profile of longshore current velocity at each profile position fig 8 after the second iteration it is acceptable to infer that solution of off line coupling is converged to that of the on line coupling according to the data shown in table 3 for the first run of fvcom the relative root mean square errors at most positions are less than 5 except the position nearest shoreline profile no 7 in table 3 wave induced set up mainly influences water surface elevations in the section near the shoreline see fig 5 in the first fun of fvcom the input data from swan model have not considered the influence of surface elevation variation due to wave set up thus the error of wave parameters results in that the error of longshore current in the section near the shoreline is larger than that in other section in the first fun of fvcom the computational costs of the two coupling methods for the case in section 3 2 are compared in table 4 all the calculations are carried out on a pc station configured with two cpus intel xeon x5650 2 67 ghz 12 cores totally available and 24 gb memory for both the two coupling methods 8 processors are used for fvom model and 4 processors for swan model according to the results in table 4 the on line two way coupling method is more efficient than the off line coupling method it is noted that the times listed in table 4 only represent the computation costs for the case the off line coupling method is a file based approach it also needs to spend some times on transforming the results of one model into input files of specific formats for another model which is not required by the on line coupling thus it is not as convenient as the on line coupling manner in addition it is inevitable to write files to disk and read files from disk for the off line coupling however the data are stored in memory and are exchanged directly for the on line coupling method which is expected more flexible than the file based approach the computational efficiency of the on line coupled model depends on the allocation of processors for each component model in this study fvcom and swan models run simultaneously on different processors and exchange data at certain time steps this synchronization leads to that the total computational time depends on the slower component model allocating more processors for the slower component will improve the efficiency however it is difficult to get the most optional allocation of processors in advance the allocation schemes may be different for different cases the optional allocation could be roughly decided by prior trials 5 conclusions a two way on line coupled model on unstructured grids has been developed based on fvcom and swan models mct is used as the model coupler to perform data exchange between fvcom and swan models the original codes of the two component models are preserved as much as possible fvcom and swan could run simultaneously and exchange information at predefined time intervals the coupled model is evaluated by applications to four test cases i e wave induced setup wave induced longshore current undertow and tide wave interaction in an ideal bay simulated results by the coupled model agree with the experimental data for the first three cases calculations in the fourth case suggest that the coupled model can account for the interaction between wave and tide in the nearshore in addition the comparison of computation costs between the off line and on line two way coupling indicates that the on line coupling of the developed model is more efficient than the file based off line coupling this paper focuses on providing a framework for coupling fvcom and swan on unstructured grids through mct both these models are open source community model and continually improved by the community it is expected that the present work can provide a simulation tool for the investigation in coastal and nearshore areas acknowledgments this work is supported by grants from the national key research and development program of china 2017yfc1404200 the national natural science foundation of china 51509183 the open fund of state key laboratory of coastal and offshore engineering dalian university of technology lp1511 and the creative research groups of the national natural science foundation of china 51621092 special thanks to crystal fulcher who provided the source codes of adcirc model which were used to perform domain decomposition and communication by the unstructured mesh version of swan 
23199,a coupled wave current system has been developed in the present paper based on two open source community models the finite volume community ocean model fvcom and the simulating waves nearshore swan using model coupling toolkit mct the coupled system runs on unstructured grids and multiple processors and information including water elevations and currents from fvcom and wave parameters from swan exchanges between fvcom and swan in both on line and two way manners the system was evaluated against laboratory experiments and the evaluation showed that the simulated results agree well with the measured data compared to the existing off line coupling system based on fvcom and swan the system in the present study is able to accomplish the on line two way coupling and at the same time is more efficient for computations and easier to use for the nearshore wave current simulations keywords coupled model radiation stress fvcom swan mct 1 introduction waves and currents commonly interact with each other in coastal waters and play a key role in sediment transport morphological evolution and pollutant mixing rodriguez et al 1995 li and johns 1998 bever and macwilliams 2013 the interactions are nonlinear and complex olabarrieta et al 2011 roland et al 2012 benetazzo et al 2013 on one hand the gradient of wave radiation stresses generates wave induced currents longuet higgins 1970 garcez faria et al 2000 and thus further influences the mean water level by increasing water levels near the shoreline or decreasing water levels near the wave breaking point longuet higgins and stewart 1964 guza and thornton 1981 meanwhile waves in the surf zone can enhance the horizontal mixing and bottom drag on the other hand changes in water levels and currents can in turn affect the motion and evolution of waves dutour sikiric et al 2013 allard et al 2014 a coupling system of waves and currents in a numerical model usually uses the following two ways one is the off line coupling and the other is the on line coupling for the off line coupling the wave model and the current model run independently and the model results are archived separately the effects of waves on currents or the effects of currents on waves were estimated by using the archived wave or current results the data can be transferred from one model to the other one one way or exchanged between both the two models two way in the two way approach in order to include the nonlinear interactions between waves and currents it usually uses an iteration manner for example yoon et al 2004 and huang et al 2010 until the solution converges for the on line coupling alternatively the current and wave models run simultaneously and the information exchanges for calculating interactions at predefined time steps during the program execution which is a two way coupling method singhal et al 2013 compared the one way current to wave off line and two way on line coupling methods for the wave current interactions in cook inlet alaska their results indicated that an online coupling may not be necessary because the effect of waves on currents is marginal at the spatial scale of about 1 5 km however simulations of waves over submerged shoal by yoon et al 2004 and zheng et al 2012 pointed out that only two way coupled method can account for the wave induced current and the influence of current on wave distributions the investigations of a storm surge by a recent study of staneva et al 2016 demonstrated that the effects of two way coupling are clearly more important than that of a one way coupling especially in the shallow waters where nonlinear interactions dominate the wave current coupling compared to the file based coupling with an off line method the on line coupling is likely to be more efficient bettencourt 2002 recently some on line coupled models for currents and waves have been developed for example brown et al 2011 coupled the modified spectral wave model wam to the proudman oceanographic laboratory coastal ocean modeling system polcoms with an aim to simulate wave current interactions in shallow waters bennis et al 2011 coupled the spectral wave model of wavewatch iii with a 3 d hydrodynamical model for applications at regional scale mars3d roland et al 2009 developed a 2 d coupled wave current model based on the wind wave model ii wwm ii and the shallow water hydrodynamic finite element model shyfem which has an unstructured model mesh the wwm ii model was also coupled with the semi implicit eulerian lagrangian finite element selfe ocean model roland et al 2012 and the regional ocean modeling system roms dutour sikiric et al 2013 wang and shen 2011 developed a spectral wave model and coupled it to the finite volume community ocean model fvcom of chen et al 2003 the simulating waves nearshore swan model as one of the most commonly used wave model has been coupled to different ocean circulation models warner et al 2008b liu et al 2010 dietrich et al 2011 guillou and chapalain 2011 kumar et al 2012 bever and macwilliams 2013 allard et al 2014 feng et al 2016 most of the coupled models based on swan are developed on structured meshes except for the models of bever and macwilliams 2013 dietrich et al 2011 and feng et al 2016 bever and macwilliams 2013 coupled the swan model to the unstructured tidal residual and inter tidal mudflat untrim hydrodynamic model of casulli and zanolli 2005 dietrich et al 2011 and feng et al 2016 coupled the swan model to the depth integrated advanced circulation adcirc model in the present paper another unstructured mesh model fvcom will be coupled with swan both swan and fvcom are extensively used in coastal and nearshore studies and they are open source community models different from wu et al 2011 who coupled a finite volume version of swan called swave developed by qi et al 2009 and fvcom directly where swave is a module of fvcom in our study original swan is coupled to fvcom original swan adopts fully implicit method and is stable for any time step zijlema 2010 while swave uses explicit or semi implicit method qi et al 2009 which however usually requires a smaller time step than swan this indicates that swave is less efficient than swan model and this may largely limit the applications of fvcom especially in a situation where waves are important in the present study a popular coupling tool model coupling toolkit mct is used mct allows the exchange of distributed data between component models and preservation of the original codes of the individual model as much as possible it has been used in the coupled system of roms warner et al 2008b it is relatively easy to update the codes of swan and fvcom in the coupled model when the new versions of these two models are released the rest of this paper is organized as follow the models and coupling method are presented in section 2 model evaluation is given in section 3 model efficiency analysis is discussed in section 4 and conclusions are drawn in section 5 2 approaches to the coupled model 2 1 models 2 1 1 fvcom the fvcom model initially developed by chen et al 2003 has been successfully applied to studies for regional scale ocean and coastal areas lai et al 2010 it is discretized using an unstructured triangle mesh in the horizontal direction and a terrain following coordinate sigma coordinate is used in the vertical the three dimensional governing equations with boussinesq approximation are presented as follows 1 u d t u 2 d x u v d y u ω σ f v d g d η x d ρ 0 p a x g d ρ 0 σ 0 d ρ x d σ d x σ 0 σ ρ σ d σ d s x x x d s x y y s p x σ 1 d σ k m u σ d f u 2 v d t u v d x v 2 d y v ω σ f u d g d η y d ρ 0 p a y g d ρ 0 σ 0 d ρ y d σ d y σ 0 σ ρ σ d σ d s y x x d s y y y s p y σ 1 d σ k m v σ d f v 3 u x v y σ x u σ σ y v σ 1 d w σ 0 4 η t d u x d v y ω σ 0 where u v and w are the velocity components in the horizontal x y and vertical z directions respectively ω is the transformed vertical velocity corresponding to the σ coordinate η is the water surface elevation d is the total water depth f is the coriolis parameter ρ 0 is the reference density ρ is the in situ density p a is the atmospheric pressure k m is the vertical eddy viscosity g is the gravitational acceleration f u and f v are the horizontal diffusion terms and s xx s xy and s yy represent the components of wave radiation stresses expressions of recent three dimensional wave radiation stresses of ji et al 2017 are adopted here their work has improved the expressions of mellor 2003 2015 by the terms representing the vertical variation of the dynamic pressure which were derived through the lagrangian wave solutions including the bottom slope effects the horizontal radiation tress terms in eq 1 and eq 2 are 5 s x x k e k x k x k 2 f c c f c s f c s f c c f s s f c s k x k x k c 2 l a r r z n s y y k e k y k y k 2 f c c f c s f c s f c c f s s f c s k y k y k c 2 l a r r z n s x y s y x k e k x k y k 2 f c c f c s k x k y k a r r z n where the terms using brackets represent traditional radiation stresses due to waves mellor 2003 2015 ji et al 2017 and the last terms are the surface roller terms svendsen 1984a in eq 5 k is the wavenumber with k x and k y as the x and y components c is the phase celerity l is the wave length e is the wave energy and a r is the roller area which is calculated based on the formula of svendsen 1984a 6 a r α 2 h s l q b where h s is the significant wave height q b is the fraction of breaking waves and α is a parameter r z n in eq 5 represents the vertical distribution for wave surface roller which is calculated as follows 7 r z n 1 tanh 2 σ d h s 4 following ji et al 2017 the vertical radiation tress terms in eq 1 and eq 2 are written as 8 s p x 1 2 g a 0 m 2 a 0 m 1 x 1 2 k g a 0 2 d x m 2 n 1 m 1 n 2 s p y 1 2 g a 0 m 2 a 0 m 1 y 1 2 k g a 0 2 d y m 2 n 1 m 1 n 2 where a 0 is the wave amplitude m 1 m 2 n 1 and n 2 are parameters whose calculation method are referred to ji et al 2017 f ss f cs f sc and f cc in eq 5 are vertical distribution functions for wave radiation stresses mellor 2003 2015 9 f s s sinh k d 1 σ sinh k d f c s cosh k d 1 σ sinh k d f s c sinh k d 1 σ cosh k d f c c cosh k d 1 σ cosh k d 2 1 2 swan swan is a spectral wave model originally developed by booij et al 1999 which has become a popular model for the simulation of coastal waves both structured and unstructured grids are supported in swan model the governing equation of this model is given as 10 t n x c x n y c y n γ c γ n θ c θ n s γ where n is the wave action density γ is the frequency θ is the propagation direction c x and c y are the x and y components of propagation speed c γ and c θ are the γ and θ components of propagation speed and s is the source term for the wave energy 2 2 mct mct is an open source toolkit used for model coupling larson et al 2005 mct uses message passing interface mpi and supports parallel computing which is used in fvcom and swan in coupling mct provides code interfaces to describe the parallel decomposition of grids for fvcom and swan and exchange data between the two models mct has been applied to many coupled ocean wave models based on structured grids for example roms and swan warner et al 2008b its application to fvcom with a wave model however is not available 2 3 coupling according to malleron et al 2011 three kinds of techniques can be used for coupling two models the first is to merge codes of these two models directly transferring of results between the two models is based on memory in this case using the computer memory is efficient however modelers have to modify the model codes which is not always easy since the two models are usually developed independently the second approach is to utilize the existing communication tools or protocols such as mpi this method also needs special knowledge for model developers the third approach is to use a model coupling tool which provides an interface to transfer data automatically between the two coupled models this method reduces significantly the workload of the code modification during the model development and has been extensively used in contemporary model coupling warner et al 2008b bennis et al 2011 allard et al 2014 feng et al 2016 in this study we use the third approach and the coupling tool is mct following the method of warner et al 2008a for coupling two models using mct fvcom and swan are compiled separately to object files and linked together as one executable program which needs a coded master program with an aim to control the execution flow and setup the parallel computing environment including initialization and allocation processors for each component model as schematically illustrated in fig 1 initializations of mct are required in both the two models including the description of mesh decomposition and establishing connections between the two models fvcom and swan run simultaneously and exchange information at predefined time intervals by calling mct application program interfaces apis data transferring between fvcom and swan and description of mesh decomposition are briefly introduced in this section the detailed method to use mct can be referenced to warner et al 2008a 2 3 1 data transferring between fvcom and swan only two dimensional variables are exchanged between fvcom and swan the water surface elevation η vertically integrated velocity u a and v a are transferred by fvcom to swan model water surface elevation is used to modify the water depth in swan model and the current velocity influences the propagation of waves swan model transfers to fvcom with significant wave height h s mean wave length l m mean wave direction θ m and fraction of breaking waves q b which are used to calculate wave radiation stresses and surface rollers in eq 1 and eq 2 for fvcom model the water surface elevation is stored at nodes and vertically integrated velocities are stored in cells all the variables are stored at nodes in swan model to facilitate the data exchange vertically integrated velocities in fvcom are interpolated to nodes firstly and then they are transferred to swan through mct 2 3 2 mesh decomposition and its description using mct fvcom and swan are run on the same unstructured grid to avoid data interpolation between the two models the global mesh is decomposed into different subdomains for parallel computing and each subdomain is mapped to a processor the mesh decomposition is schematically indicated in fig 2 information exchange among the processors is performed through mpi the whole mesh shown in fig 2 consists of 8 cells and 10 nodes which are mapped to two processors for parallel computing the processor p1 is responsible for cells c1 c4 and processor p2 is responsible for cells c5 c8 to complete the parallel computing data at halo points nodes n3 n7 n8 and n9 are stored by both the two corresponding processors the grid information needs to be described with a specific format in mct for model coupling which means that mct should know how the grid is decomposed among different processors for each of the coupled models for unstructured grids mct provides domain descriptor globalsegmap where the unstructured mesh is described using a linearized method take the domain decomposition in fig 2 as an example arrays start and length are used to store the mesh information nodes n1 n2 n3 n6 n7 n8 and n9 are described by processor p1 in mct the array elements start 1 1 and length 1 3 represent nodes n1 n2 and n3 and start 2 6 and length 1 4 represent nodes n6 n7 n8 and n9 it is noted that repeated information for mesh description is not allowed in mct or data exchange between the coupled models cannot be completed data at nodes n3 n7 n8 and n9 are stored by both the two corresponding processors however each of these nodes should be described by only one processor for the domain description in mct in this paper these data are stored by the processor with smaller processor index which means p1 is responsible for nodes n3 n7 n8 and n9 in domain description 3 model evaluation 3 1 wave induced setup in the coastal surf zone decreasing of wave heights due to wave breaking can result in decreasing of wave radiation stress towards the shoreline which leads to the increase of mean water level i e wave induced setup to balance the gradient of wave radiation stress longuet higgins and stewart 1964 changes in water level can in turn affect wave heights nearshore these processes can be used to test the capacity of the developed coupled model on simulation of wave induced setup and related wave heights experiments of stive 1985 are used to evaluate the coupled model in this study the experiments are accomplished in a wave flume with the still water depth of 0 7 m in the horizontal section and the slope of a plane concrete beach in the right part is 1 40 fig 3 irregular waves with significant wave height of 0 194 m and peak spectral period of 1 58 s are imposed from the left boundary in the model the grid size is 1 m at the left boundary and gradually changes to 0 5 m at the right boundary the time step is 5 s for swan and 0 002 s for fvcom and the time interval for data exchanges between the two models is 5 s as shown in fig 4 simulated results of wave heights along the centerline of the computational domain in the x direction agree well with experimental data both the model results and experimental data show that the wave height keeps nearly constant within 25 m and rapidly decreases at 30 m the coupled model illustrates the depth induced wave breaking in the shallow waters the distribution of wave heights as shown in fig 4 can result in a horizontal gradient of wave radiation stresses which leads to wave induced set up i e increasing water levels near the shoreline longuet higgins and stewart 1964 simulated water surface elevations agree well with experimental data of stive 1985 as shown in fig 5 3 2 wave induced longshore currents when waves propagate obliquely in the onshore direction and eventually break on a beach variations of wave heights can result in the gradient of wave radiation stress in not only the cross shore but also longshore direction the gradient of wave radiation stress in the cross shore direction can lead to setup as mentioned in section 3 1 and the gradient of wave radiation stress in the longshore direction generates a mean current that flows parallel to the coast i e wave induced longshore currents longuet higgins 1970 the change of mean water levels and wave induced longshore currents can in turn influence the distribution of wave heights these processes can be used to test the capacity of the developed coupled model on the computation of wave induced longshore currents and related wave heights experiments of hamilton and ebersole 2001 are used to evaluate the coupled model one of their test cases with irregular waves is chosen for this section called test8e in their paper the experiments are carried out in a wave basin with the still water depth of 0 667 m at the wave generator and the slope of the concrete beach is 1 30 as shown in fig 6 irregular waves with significant wave height of 0 225 m and peak spectral wave period of 2 5 s are generated at the wave generator the angle between wave propagation direction and shore normal is 10 in the model the grid size of the unstructured mesh is 1 m at the left boundary and gradually changes to 0 2 m at the right boundary the time step is 5 s for swan and 0 002 s for fvcom and the time interval for data exchanges between the two models is 5 s as shown in fig 7 a wave heights simulated by the coupled model agree well with experimental data of hamilton and ebersole 2001 the simulated wave induced vertically integrated longshore current velocities by the coupled model could basically agree with the experimental data at most of the points as shown in fig 7 b near the wave breaking point at x 15 m and at the section near x 26 m where the maximum longshore current occurs the simulated longshore currents are slightly different from the experimental data the longshore current presents nearly uniform vertical distribution with depth according to experimental measurement visser 1991 hamilton and ebersole 2001 the simulated vertical profiles of mean longshore current velocities agree basically with the measured data fig 8 root mean square errors rmses of simulated longshore current velocities at all the profile positions shown in fig 8 are in the range of 0 030 0 069 m s table 1 relative rmses rrmses defined same as in kumar et al 2012 at the profile positions are in the range of 0 10 0 22 except 0 357 at no 1 profile which is assumed to be still acceptable considering the quite small absolute values of observed data at this profile the overall errors for this case are small consistent with those of kumar et al 2012 for a similar application see their table 4 the slight difference between simulated results and experimental data on longshore current near x 26 m is likely because the adopted wave roller model in fvcom is not optimized for this case moghimi et al 2013 chen and zhang 2016 we use the formulations of svendsen 1984a and warner et al 2008b to calculate the roller area and roller energy larger value of α in eq 6 could result in more energy transferred into water column from wave roller eq 5 whose value is chosen as 0 06 for all the test cases according to svendsen 1984a for simplicity simulated results with α 0 12 are also presented in fig 8 to test the effect of wave roller on the longshore current velocities transferring more energy from wave roller into water column momentum could lead to the local peak value of longshore current shifting towards the shoreline moghimi et al 2013 chen and zhang 2016 in the present model adjusting wave roller coefficient α from 0 06 to 0 12 increases longshore current velocities at profile position of x 27 28 m fig 8 agreeing better with observed data these results are consistent with those of moghimi et al 2013 and chen and zhang 2016 an alternative wave roller model needs to solve time dependent roller evolution equations for example xie 2011 and moghimi et al 2013 tuning the wave roller model may improve the results whereas this is not the objective of the present study which focuses on providing a framework of a coupled model based on community models on unstructured grids the wave roller model used in fvcom could be improved in the future 3 3 wave induced cross shore flow undertow in the coastal surf zone the depth averaged wave radiation stress and pressure gradient due to wave set up can balance each other as shown in section 3 1 the local difference in the vertical between these two forces can lead to a seaward mean flow below the level of wave trough called undertow svendsen 1984b ting and kirby 1994 and the increase in mean water level due to wave set up can influence the wave heights distributions in the shore normal these processes can be used to test the capacity of the developed coupled model on simulation of wave induced cross shore currents and related wave heights data from the test case 1a of roelvink and reniers 1995 on undertow are used to evaluate the coupled model the experiments were carried out in the delta flume of delft hydraulics with the length of 200 m and still water depth of 4 1 m at offshore irregular waves with significant wave height of 0 9 m and peak spectral wave period of 5 s were generated at the wave generator the beach consists of fine sand with the equilibrium beach profile shown in fig 9 in the model the grid size of the unstructured mesh is 2 m at the left boundary and gradually changes to 1 m at the right boundary the time step is 5 s for swan and 0 01 s for fvcom and the time interval for data exchanges between the two models is 5 s simulated results of wave heights along the centerline of the computational domain in the x direction agree well with experimental data fig 9 waves break near x 130 m giving rise to decrease of wave heights which results in cross shore wave averaged flows the simulated cross shore averaged flow velocities show a general agreement with the measured data at different locations in the shore normal direction fig 10 rmses of simulated cross shore velocities at all profile positions shown in fig 10 are in the range of 0 008 0 060 m s table 2 the mean value of rrmses at all the profile positions is 0 57 which is similar to the results of kumar et al 2012 for another application on barred beach see their table 4 larger value of rrmse at no 3 profile may be because of the small absolute values of observed data at this profile which are quite close to zero the developed coupled model can capture the vertical structure of undertow however simulated flow velocities near still water surface elevation are slightly different from the experimental data near x 130 m and near x 150 m this is likely because the adopted wave roller model in fvcom is not optimized for this case moghimi et al 2013 chen and zhang 2016 3 4 tide wave interaction in an ideal bay the coupled mode is applied to a case of tide wave interaction in an ideal bay as shown in fig 11 the length of the domain is 30 km and the width is 14 km the upside boundary of this ideal case is an open boundary where the tide and wave are imposed and the other three boundaries are land boundaries the bottom is plane and its slope is 1 1000 which is a common slope in the muddy tidal flats the significant wave height at the upper boundary is 3 m and the peak spectral wave period is 8 s the angle of wave incidence relative to shore normal is 10 an ideal tidal constituent is chosen to drive the model whose range and period are 4 m and 12 h respectively the mesh size is nearly uniform and chosen as 100 m it is worth to note that the model in the ideal case uses a resolution of 100 m instead of 1 m in the subsections of 3 1 3 3 because of the different model domains the coriolis force is not considered for simplicity the time step is 2 min for swan and 0 25 s for fvcom and the time interval for data exchange between the two component models is 2 min swan and fvcom model are also run separately to compare the simulated results with those by the coupled model in coastal areas water surface elevations vary with time due to influences of the tide leading to changes of water depth which could result in breaking of waves and variations of wave heights distribution hence for a run of only swan model wave heights reach a steady state without the influence of varying water depth decreasing gradually towards the coastline as shown in fig 12 a however for a run of the coupled model waves change periodically with tides the wave height distribution at the time of high tide is quite different from that of low tide in fig 12 b and c the wave height shows a constant in the run of only swan model while it oscillates within the tidal period in the coupled model run fig 13 the distribution of wave heights along the centerline x 15 km indicates that wave breaking occurs near x 9 km at the time of high tide and near x 13 km at the time of low tide fig 14 wave breaking could generate wave induced setup as explained in section 3 1 compared to results of only fvcom model simulated water surface elevations along the centerline x 15 km by the coupled model at times of high tide and low tide clearly show wave induced setup see fig 15 in shallow waters maximum wave induced set up can increase surface elevation by about 8 5 and 9 1 at the time of high tide and low tide respectively comparisons between the results of elevations at point a x 15 km y 6 km by the coupled model and those by only fvcom model demonstrate that wave induced setup increases water surface elevations see fig 16 especially at times of low tide in addition to wave induced setup variation of wave distributions could also lead to longshore and cross shore currents wave induced longshore and cross shore flow velocities are obtained by the difference between simulated results of coupled model and those of only fvcom model simulated depth integrated longshore currents by the coupled model at times of high tide and low tide are shown in fig 17 because of discrepancy between wave heights distribution at times of high tide and low tide fig 14 wave induced longshore currents are different at these times the position of the peak value for longshore currents is more towards the shore at the time of high tide and more away from the shore at the time of low tide fig 17 in the vertical direction the wave induced longshore current velocity at the point a exponentially increases with depth in the bottom layer and then linearly to the water surface fig 18 it reaches 0 21 m s at the time of high tide about four times of that at the time of low tide wave induced cross shore flow velocities are relatively small compared to the tidal current velocities at the point a at the time of maximum flood and ebb fig 19 in short the above results indicate that the developed two way coupled model could account for the interaction between wave and tide in the nearshore region 4 comparison between on line and off line coupling in the above developed model fvcom and swan models are two way coupled in an on line manner they can also be two way coupled in an off line manner for the case of wave induced longshore currents in section 3 2 the off line two way coupling can be performed as follows swan model runs firstly and saves the results of wave parameters at every exchange interval into files and then fvcom model is executed with the results of swan model as input files writing the results of water surface elevation and vertically integrated velocities into files swan model reruns with the results of fvcom as input then fvcom model runs again using the results of the second run of swan model the off line coupling can avoid the effort of codes modification of each component model it usually uses an iteration manner to obtain converged solutions for the case of wave induced longshore currents in section 3 2 table 3 shows the relative root mean square errors of off line coupling to the on line coupling for the vertical profile of longshore current velocity at each profile position fig 8 after the second iteration it is acceptable to infer that solution of off line coupling is converged to that of the on line coupling according to the data shown in table 3 for the first run of fvcom the relative root mean square errors at most positions are less than 5 except the position nearest shoreline profile no 7 in table 3 wave induced set up mainly influences water surface elevations in the section near the shoreline see fig 5 in the first fun of fvcom the input data from swan model have not considered the influence of surface elevation variation due to wave set up thus the error of wave parameters results in that the error of longshore current in the section near the shoreline is larger than that in other section in the first fun of fvcom the computational costs of the two coupling methods for the case in section 3 2 are compared in table 4 all the calculations are carried out on a pc station configured with two cpus intel xeon x5650 2 67 ghz 12 cores totally available and 24 gb memory for both the two coupling methods 8 processors are used for fvom model and 4 processors for swan model according to the results in table 4 the on line two way coupling method is more efficient than the off line coupling method it is noted that the times listed in table 4 only represent the computation costs for the case the off line coupling method is a file based approach it also needs to spend some times on transforming the results of one model into input files of specific formats for another model which is not required by the on line coupling thus it is not as convenient as the on line coupling manner in addition it is inevitable to write files to disk and read files from disk for the off line coupling however the data are stored in memory and are exchanged directly for the on line coupling method which is expected more flexible than the file based approach the computational efficiency of the on line coupled model depends on the allocation of processors for each component model in this study fvcom and swan models run simultaneously on different processors and exchange data at certain time steps this synchronization leads to that the total computational time depends on the slower component model allocating more processors for the slower component will improve the efficiency however it is difficult to get the most optional allocation of processors in advance the allocation schemes may be different for different cases the optional allocation could be roughly decided by prior trials 5 conclusions a two way on line coupled model on unstructured grids has been developed based on fvcom and swan models mct is used as the model coupler to perform data exchange between fvcom and swan models the original codes of the two component models are preserved as much as possible fvcom and swan could run simultaneously and exchange information at predefined time intervals the coupled model is evaluated by applications to four test cases i e wave induced setup wave induced longshore current undertow and tide wave interaction in an ideal bay simulated results by the coupled model agree with the experimental data for the first three cases calculations in the fourth case suggest that the coupled model can account for the interaction between wave and tide in the nearshore in addition the comparison of computation costs between the off line and on line two way coupling indicates that the on line coupling of the developed model is more efficient than the file based off line coupling this paper focuses on providing a framework for coupling fvcom and swan on unstructured grids through mct both these models are open source community model and continually improved by the community it is expected that the present work can provide a simulation tool for the investigation in coastal and nearshore areas acknowledgments this work is supported by grants from the national key research and development program of china 2017yfc1404200 the national natural science foundation of china 51509183 the open fund of state key laboratory of coastal and offshore engineering dalian university of technology lp1511 and the creative research groups of the national natural science foundation of china 51621092 special thanks to crystal fulcher who provided the source codes of adcirc model which were used to perform domain decomposition and communication by the unstructured mesh version of swan 
