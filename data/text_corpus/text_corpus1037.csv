index,text
5185,modeling of overland flow for a depression dominated area is a difficult task due to the spatial distribution of depressions particularly the hierarchical relationships of depressions and their variable contributing areas make the hydrologic modeling more complicated in traditional hydrologic modeling however digital elevation models dems that are used to represent surface topography are often edited by filling depressions before delineation and the impacts of depressions are considered by using certain simplified and lumped approaches due to such flaws these hydrologic models fail to account for the actual dynamic influences of surface depressions the objective of this study is to improve hydrologic modeling for depression dominated regions by developing a new modeling framework to quantify the influence of spatially distributed depressions to achieve this objective a new puddle based unit pbu probability distributed model pbu pdm is developed and coupled with the existing soil and water assessment tool swat the pbu pdm facilitates separate simulations for non depressional and depressional areas and accounts for the hierarchical relationships of depressions their filling and spilling processes and the dynamic variations in their contributing areas the pbu pdm enhanced swat was applied to the upper maple river watershed in north dakota and calibrated and validated using the observed data in particular it was also compared with the original swat model which demonstrated the abilities of pbu pdm to mimic the filling spilling overland flow dynamics and the threshold behavior the pbu pdm provides improved watershed scale hydrologic modeling especially for depression dominated areas keywords surface depressions puddle based unit pbu channel based unit cbu probability distributed model hydrologic modeling 1 introduction surface topography affects overland flow generation surface runoff and other hydrologic processes abedini et al 2006 chu 2017 darboux and huang 2005 for example depressions act as surface impoundment and intercept surface runoff generated from their upstream contributing areas until reaching their maximum depression storage mds thresholds also each depression has a unique mds contributing area ca and relationships with its surrounding depressions and thus undergoes specific dynamic puddle to puddle p2p filling spilling merging processes during rainfall events chu et al 2013 the influence of depressions makes hydrologic processes more complicated in many traditional watershed hydrologic models a digital elevation model dem which is used to represent surface topography is preprocessed by filling all sinks or depressions the impacts of depressions are usually simulated by using certain oversimplified and lumped approaches such as a single depression storage threshold control on the initiation of surface runoff e g amoah et al 2013 tahmasebi nasab et al 2017a in reality smaller depressions that connect to the outlet may contribute runoff water before larger depressions are fully filled thus the lumped methods do not consider the spatial distributions of depressions and cannot fully simulate the real dynamic influences of depressions on hydrologic processes evenson et al 2015 golden et al 2014 golden et al 2017 tahmasebi nasab et al 2017a therefore how to characterize and account for depressions in hydrologic models is an important task especially for depression dominated areas some modeling efforts have been made to consider the spatial variations of depressions in hydrologic modeling e g chu et al 2010 chu et al 2013 shaw et al 2013 shook et al 2013 yang and chu 2015 evenson et al 2015 evenson et al 2016 ameli and creed 2017 tahmasebi nasab et al 2017b shaw et al 2013 developed a simple pothole terrain analysis algorithm spill to simulate the fill spill processes of all depressions and quantify surface depression storage and basin ca under different runoff conditions shook et al 2011 developed a fully distributed wetland dem ponding model wdpm to simulate the filling and depleting processes of depressions dynamic ponding storage of each depression time varying basin ca and surface runoff in a wetland dominated region chu et al 2010 proposed a puddle delineation pd algorithm based on which a depression dominated delineation d cubed algorithm was further developed tahmasebi nasab et al 2017b the algorithms have been used to identify depressions puddles track the ca of each puddle determine the hierarchical relationships of puddles compute flow directions and accumulations and calculate topographic parameters particularly the d cubed algorithm delineates a surface into a number of puddle based units pbus and channel based units cbus chu et al 2013 and yang and chu 2015 developed a physically based distributed p2p model for simulating overland flow processes over depression dominated areas based on the detailed surface microtopographic characteristics from the pd algorithm the p2p model simulates the dynamic filling spilling merging and splitting processes of puddles and reveals the real microtopography controlled drainage patterns however modeling overland flow dynamics over all depressions needs high resolution input data and requires high computational capacity making these distributed models more suitable for smaller scale modeling problems for watershed scale modeling evenson et al 2015 evenson et al 2016 evenson et al 2018 modified swat to simulate the influences of geographically isolated wetlands giws on downstream hydrology in their studies the hydrologic response units hrus were re defined by distinguishing giws from their catchment areas and introducing a series of giw hrus i e wetlands and catchment hrus an extended swat pothole function was utilized to simulate the outflows of giws which were further routed the redefinition of hrus resulted in a significant increase in the number of hrus evenson et al 2016 which consequently made long term modeling including input data preparation model calibration and validation more challenging alternatively the geometric properties of depressions e g area depth and storage capacity can be quantified by a frequency distribution ullah and dickinson 1979 which potentially improves surface runoff simulation for depression dominated surfaces abedini 1998 kuchment et al 2000 mekonnen et al 2014 mekonnen et al 2016 abedini 1998 applied the probability distributed model pdm originally developed by moore 1985 to describe the spatial variations of depression storage capacities characterize the dynamic cas and calculate the water storage of depressions and surface runoff kuchment et al 2000 utilized an exponential distribution function to represent the spatial distribution of surface depressional storages and applied the distribution to the simulation of runoff processes in a wetland covered basin following abedini 1998 and moore 2007 mekonnen et al 2014 and mekonnen et al 2016 incorporated the pdm into the mesh modeling system modélisation environmentale communautaire surface and hydrology pietroniro et al 2006 and swat to account for the heterogeneity of storages of depressions and simulate surface runoff their modeling results indicated that such a statistical approach was able to simulate the influence of spatially distributed depressions for larger watersheds with numerous depressions the probability distributed approach is feasible and convenient for considering the diversity of depressions however the pdm does not consider the dynamic relationships of depressions and their cas to the best of our knowledge no probability distributed approach has been developed to address the impacts of such complicated properties of depressions on hydrologic modeling the objective of this study is to improve hydrologic modeling for depression dominated regions by quantifying the influence of spatially distributed depressions to achieve this objective a new pbu based probability distributed model pbu pdm is developed and coupled with the existing swat to account for the spatial distributions and relationships of surface depressions and simulate their filling and spilling processes and the dynamic variations in their contributing areas the pbu pdm is then applied to the upper maple river watershed in north dakota and its performances in both calibration and validation are evaluated 2 methodology and materials 2 1 characterization of surface topography to provide the detailed topographic information of depressions e g size storage ca and the relationships with surrounding depressions for the pbu pdm modeling the d cubed algorithm tahmasebi nasab et al 2017b was utilized based on the original dem of a watershed the d cubed algorithm identifies depressions puddles by searching their centers thresholds and all included cells which are defined as first level depressions puddles if two or more first level puddles share a common threshold they potentially merge and form a second level puddle all higher level puddles are formed in the same fashion such different levels of puddles define their hierarchical relationships this process continues until all highest level puddles are determined then the mds and maximum ponding area mpa of each puddle and other topographic parameters are computed during the delineation process the d cubed algorithm also provides the details on flow directions flow accumulations and channel segments importantly the algorithm identifies all pbus and cbus the former pbu consists of a highest level puddle and its ca while the latter cbu includes a channel segment and its ca pbus and cbus can connect to each other and the interconnections of all pbus and cbus form a cascaded channel puddle drainage system which contributes runoff water to the watershed outlet table 1 lists all acronyms and variables parameters used in this paper 2 2 model development 2 2 1 overall modeling framework in the original swat modeling a watershed is delineated into a number of subbasins by using a pre filled dem based on the meteorological and hydrologic data soil type land use and other input data swat provides the simulated surface runoff infiltration evapotranspiration and other hydrologic variables thus the original swat modeling is performed for a depressionless well connected surface for the pbu pdm enhanced swat model in addition to the aforementioned input data a set of topographic property parameters and data from the d cubed algorithm are used for developing the pdms for all subbasins the land phase modeling is performed for all subbasins which is followed by channel routing for the entire drainage system fig 1 for the land phase modeling of each subbasin within the subbasin loop a two step modeling is performed 1 swat subbasin based modeling step 1 and 2 pbu pdm modeling step 2 fig 1 in step 1 hydrologic processes such as surface runoff and infiltration are simulated for all subbasins while step 2 implements the pbu pdm simulation specifically the surface runoff simulated in step 1 without consideration of the influence of depressions is transferred into the pbu pdm as detailed in the following subsection the pbu pdm simulates the dynamic variations in depression storage across all subbasins and the threshold controlled surface runoff reaching the main channels which is further transferred back to the swat model for channel routing throughout the entire channel network 2 2 2 new pbu pdm based on the original dem the d cubed algorithm divides a basin into a number of subbasins each of which is further divided into numerous pbus depressional area and cbus non depressional area in the pbu pdm separate simulations are conducted for the cbus and pbus of each subbasin fig 2 a since a cbu does not contain any depression the surface runoff generated from a cbu is equal to that simulated in the swat modeling step 1 fig 1 and is assumed to contribute directly to the corresponding subbasin main channel for pbus however a series of pdms fig 2a are used to determine the temporal variations of depression storage and surface runoff from such depressional areas as basic modeling units pbus account for the hierarchical relationships of depressions and their cas to develop the pdms for depressional areas fig 2a water balance is analyzed for an individual pbu fig 3 specifically a pbu consists of a ca and a ponding area pa the ca receives precipitation water and loses water by infiltration and the resulting surface runoff contributes to its associated pa fig 3a the pa receives water from precipitation and surface runoff from its ca and loses water through evaporation and seepage if the net water input difference between inputs and losses of the pa exceeds the available depression storage of the pbu the highest level puddle is fully filled reaching its mds and overflowing to its downstream fig 3b the outflow and depression storage of the pbu can be mathematically expressed as follows note that hydrologic variables d c s s0 and r are expressed as a depth over the pbu 1 r d c s 0 d c s 0 0 d c s 0 2 s c d c s 0 d s 0 d c s 0 in which 3 d p r e c i p e v a p s e e p a g e p a a runoff ca 1 p a a where r is the surface runoff generated from the pbu at the end of a given time step l d is the net water input of the pa of the pbu during the time step l c is the depression storage capacity of the highest level puddle of the pbu l s0 is the depression storage of the pbu at the beginning of the time step l s is the depression storage of the pbu at the end of a time step l runoff ca is the surface runoff generated from the ca of the pbu during the time step l and is equal to the surface runoff simulated in the swat modeling step 1 fig 1 and pa and a are respectively the area of the ponding area and the entire surface area of the pbu l2 the water evaporation and seepage of the pa are respectively given by arnold et al 1998 4 evap η p e t 5 seepage k δ t where η is the evaporation coefficient of the pa of the pbu pet is the potential evapotranspiration l k is the saturated hydraulic conductivity of the bottom sediment of the pa of the pbu l t and δt is the time interval t which is a daily increment in this study it is worth noting that the infiltration of the cas of all pbus and cbus is calculated in the swat modeling step 1 fig 1 and updated at each daily step based on the soil water content and top soil temperature and the percolation from the bottom of the soil profile and the seepage from the pas of pbus enter the deep vadose zone and the groundwater zone within a subbasin precipitation evaporation and seepage are considered to be the same for all pbus all depressions are assumed empty at the beginning of simulation in applications the issue associated with this initial condition can be addressed by the warm up simulation to simplify the pbu pdm for pbus the maximum ponding area of a pbu is used in the computation of net water input according to eqs 1 3 the pbus with the same ratio of maximum ponding area to the pbu area i e r mpa mpa a have the same net water input and the generated surface runoff and depression storage of the pbus are only related to their depression storage capacities and the filling conditions of their highest level puddles for the pbus with the same r mpa following abedini 1998 and mekonnen et al 2016 the probability distributed approach can be applied to simulate the filling spilling overland flow processes thus the pbus with the same r mpa are assigned to the same group as a result all pbus within one subbasin are assigned to different groups based on their r mpa values fig 2a that is one subbasin may include many groups each of which contains many pbus that have the same r mpa then a pdm is developed for each group to calculate the total amount of water stored in this group and the surface runoff generated from this group at each time step fig 2a fig 2b d show how the pdm determines the total depression storage and surface runoff for group i of subbasin j this group consists of a set of pbus with different depression storage capacities which are represented by the columns with different heights in fig 2b the probability of each depression storage capacity is determined by frequency analysis for depression storage capacities of all pbus in this group through analysis of water balance of the ca and pa of each pbu in group i of subbasin j at time step k eqs 1 3 the pbus with the same depression storage capacities have the same depression storage and outflow their values depend on the filling spilling condition to determine the filling spilling condition of the pbus in a group the concept of group threshold capacity is introduced fig 2c during the filling process with a positive net water input if a pbu happens to be fully filled and does not generate outflow e g pbu4 in fig 2c the depression storage capacity of this pbu at that time step is defined as the group threshold capacity thus if the depression storage capacity of a pbu in group i of subbasin j is greater than the group threshold capacity e g pbus 5 6 and 7 in fig 2c it will not contribute runoff water and its depression storage equals the group threshold capacity if the pbus in group i of subbasin j have a depression storage capacity smaller than the group threshold capacity e g pbus 1 2 and 3 in fig 2c they reach their depression storage capacities and the excess water becomes surface runoff outflow the proportion of the area of the pbus that contributes surface runoff to the subbasin outlet can be calculated by eq 6 and the total depression storage in group i of subbasin j at time step k is given by eq 7 moore 1985 6 p c c i j g t c i j k 0 g t c i j k f c c i j d c c i j 7 s i j k 0 g t c i j k c c i j f c c i j d c c i j g t c i j k g t c i j k maxc i j f c c i j d c c i j g t c i j k m i n g t c i j k maxc i j where s i j k is the total depression storage of group i in subbasin j at time step k l gtc i j k is the threshold capacity of group i in subbasin j at time step k l c c i j is the depression storage capacity of group i in subbasin j l maxc i j is the maximum depression storage capacity of group i in subbasin j l and f c c i j is the probability of occurrence of depression storage capacity cc i j of group i in subbasin j according to kuchment et al 2000 and mekonnen et al 2016 depression storage capacity follows a continuous exponential distribution thus an exponential function eq 8 is used in this study to describe the probability distribution of depression storage capacities and the total water stored in the pbus of group i in subbasin j at time step k is given by eq 9 8 f c c i j α i j e x p β i j c c i j 9 s i j k α i j β i j 2 1 exp β i j gtc i j k g t c i j k m i n g t c i j k maxc i j where α i j and β i j are the coefficients of the exponential function of group i in subbasin j the two coefficients are obtained by fitting the distribution of the depression storage capacities of the pbus of group i in subbasin j and can vary over groups and subbasins to determine the group threshold capacity and the generated surface runoff two scenarios are considered if the net water input of group i in subbasin j at time step k 1 is greater than zero the group threshold capacity increases by the net water input during this time step eq 10 fig 2d the water stored during the current time step is given by eq 11 and the surface runoff generated in this group during this time step is given by eq 12 fig 2d 10 gtc i j k 1 gtc i j k d i j k 1 gtc i j k 1 m i n gtc i j k 1 m a x c i j 11 δ s i j k 1 s i j k 1 s i j k 12 r i j k 1 d i j k 1 δ s i j k 1 where δs i j k 1 is the depression storage change of group i in subbasin j during time step k 1 l and r i j k 1 is the surface runoff generated from group i in subbasin j at time step k 1 l if d i j k 1 less than 0 no runoff is generated in group i eq 13 at time step k 1 the storage decreases due to the negative net water input eq 14 and the group threshold capacity can be obtained by solving eq 7 13 r i j k 1 0 d i j k 1 0 14 s i j k 1 s i j k d i j k 1 d i j k 1 0 the actual amount of water stored in the pbus of subbasin j can be expressed as 15 s j k i 1 n s i j k g i where s j k is the depression storage of subbasin j at time step k l and gi is the ratio of the area of group i to the total area of subbasin j similar to the original swat the surface runoff generated from cbus and pbus is routed to the main channel in the subbasin by for cbus 16 r cbu j k r cbu j k rs cbu j k 1 rfr j for pbus 17 r i j k r i j k rs i j k 1 rfr j and the total runoff water reaching the main channel in the subbasin is given by 18 r j k i 1 n r i j k g i r cbu j k g cbu where r cbu j k is the surface runoff from cbus that reaches the main channel of subbasin j at time step k l r cbu j k is the surface runoff generated in the cbus of subbasin j at time step k l rs cbu j k 1 is the surface runoff stored on the cbus of subbasin j at time step k 1 l rfr j is the surface runoff release fraction of subbasin j r i j k is the surface runoff from group i that reaches the main channel of subbasin j at time step k l rs i j k 1 is the surface runoff stored on the surface of group i in subbasin j at time step k 1 l r j k is the surface runoff that reaches the main channel of subbasin j at time step k l and gcbu is the ratio of the area of the cbus in subbasin j to the total area of subbasin j it is worth noting that the ca of a pbu can be large so that the surface runoff from the entire ca may not reach its corresponding pa of the pbu within one daily time step thus the ca runoff release fraction parameter is used to separate the surface runoff generated from the ca in one day into two parts runoff water reaching the pa and runoff water stored on the ca the former is a water input of the pa at the current time step and the latter is a water input of the pa at the following time steps since the sizes of cas of pbus vary the median ca in each group instead of the average ca is utilized to calculate the ca runoff release fraction for the group which can be obtained by 19 c a r f r i j rfr j medca i j a j where ca rfr i j is the surface runoff release fraction for the cas of all depressions of group i in subbasin j medca i j is the median area of the cas of all depressions of group i in subbasin j l2 and a j is the entire surface area of subbasin j l2 2 3 application of the pbu pdm the pbu pdm enhanced swat model was applied to a study area in the prairie pothole region ppr of north dakota fig 4 a it is the upper portion of the maple river watershed with an outlet at the usgs gaging station 05059700 at maple river nr enderlin latitude 46 37 18 longitude 97 34 25 the drainage area is 2183 36 km2 81 24 of which is agricultural lands the upper maple river watershed covers parts of five counties in the east central north dakota including barnes cass griggs ransom and steele counties in this study a 30 m dem was downloaded from the usgs national map tnm the arcswat an extension of arcgis was used to preprocess the dem by filling depressions delineate the watershed into subbasins and prepare the input data the original dem was also imported into d cubed algorithm to identify depressions and compute topographic parameters for all subbasins the land use and land cover lulc data were obtained from the national land cover database nlcd 2011 and the soil type data were obtained from the soil survey geographic database ssurgo 8 different lulc types and 47 different soil types were considered in the modeling the lulc and soil type data were further used in swat to define hrus and calculate curve numbers this watershed included 5 climate stations fig 4a which provided daily precipitation temperature solar radiation wind speed and humidity for swat modeling the climate data were obtained from the climate forecast system reanalysis cfsr the soil conservation service curve number scs cn method the penman monteith method and the variable storage routing method were selected in arcswat to simulate rainfall excess potential evapotranspiration and perform channel routing to demonstrate the improved capabilities the pbu pdm enhanced swat model was compared with the original swat model in the original swat model depression storage is a part of the initial abstraction which is defined as 20 of the potential maximum retention in the curve number method in this study this default initial abstract coefficient i e 0 2 was used in addition the original swat model was also calibrated by adjusting this initial abstraction coefficient in the swat source code to further evaluate its performance in contrast the pbu pdm enhanced swat model explicitly simulates the influences of depressions on surface runoff filling and spilling processes and the dynamic variations in contributing areas thus the initial abstraction in the enhanced swat model did not include depression storage and its value was also obtained through model calibration 2 4 model calibration and validation the entire modeling system was calibrated and validated specifically a 4 year period from 1994 to 1997 was selected as the warm up period the calibration and validation periods ranged from 1998 to 2002 and from 2003 to 2006 respectively the observed discharge data at the final outlet used for model calibration and validation were downloaded from the usgs national water information system the sufi 2 algorithm in swat cup was utilized for model calibration and validation the model performance was evaluated by using two statistical measures nash sutcliffe efficiency nse nash and sutcliffe 1970 and percent bias pbias gupta et al 1999 that are respectively expressed as 20 nse 1 i 1 n q obs i q sim i 2 i 1 n q obs i q obs 2 21 pbias i 1 n q sim i q obs i i 1 n q obs i 100 where n is the total number of discharge observations q sim i is the simulated outlet discharge l3 t q obs i is the observed outlet discharge l3 t q obs is the average of the observed outlet discharges l3 t 3 results and discussions 3 1 surface delineation results and pbu pdm the upper maple river watershed was divided into 16 subbasins fig 4b which were further divided into many pbus and cbus fig 4c table 2 lists the major topographic parameters for all subbasins of the upper maple river watershed determined by the d cubed algorithm as shown in table 2 the cbus only account for 5 54 29 32 of their subbasin areas and the remaining areas are pbus suggesting that most surface runoff in a subbasin was from its pbus and subject to the threshold control the number of pbus and their sizes and mds values varied among subbasins table 2 the total mds of the 16 subbasins ranged from 3 07 106 to 26 06 106 m3 and the mds of individual pbus ranged widely from a value smaller than 0 01 m3 to 6 47 106 m3 for the development of pbu pdm all pbus within each subbasin were aggregated into many groups based on their rmpa values a probability distributed function was created for each group table 2 lists the number of groups for all subbasins ranging from 6 to 9 as an example table 3 shows the details on the groups of subbasin 9 including the number of pbus rmpa ranges maximum and minimum depression storage capacities and percent areas as well as the fitted probability distributed functions in addition group 6 in subbasin 9 has only one pbu with a significantly large depression storage capacity table 3 which unlikely contributes any runoff water under a normal climate condition thus no pdm was developed for this group the impact of this group on the modeling should be limited since it only accounts for 1 of the area of subbasin 9 table 3 fig 5 shows the cumulative probability distributions of depression storage capacities of pbus for all groups in three representative subbasins subbasins 4 9 and 13 that have unique topographic characteristics subbasins 9 and 13 have relatively small and large mds of individual pbus respectively while subbasin 4 has a moderate mds of individual pbus table 2 and fig 5 the groups of different subbasins that have the same rmpa ranges show a similar trend with the increase in the group number or rmpa values the depression storage capacities of pbus increase resultantly the capacity curve covers a wider range 3 2 model performance following lin mohammad and zheng 2015 and based on the special need of the new pbu pdm model 18 parameters were selected for model calibration and the calibrated values are shown in table 4 particularly two depression related parameters evaporation coefficient of depressions η and hydrologic conductivity through the bottom of depressions k eqs 4 and 5 were included in the pbu pdm depression simulation and the initial abstraction coefficient λ was also calibrated in the original swat model and the pbu pdm enhanced swat model the comparisons of the simulated and observed hydrographs for the calibration and validation periods are shown in fig 6 overall the pbu pdm enhanced swat model provided reasonable hydrographs for both periods the magnitude timing and duration of most of the peak flows simulated by the pbu pdm enhanced swat model reasonably matched the observed data fig 6 however the original swat model with the default initial abstraction significantly overestimated most of peak flows showing a pattern of quick rise and short recession this is because the default initial abstraction failed to account for the magnitude and the actual hydrologic roles of surface depressions other studies e g tahmasebi nasab et al 2017a mekonnen et al 2016 also indicated that the original swat model tended to overestimate peak flows for depression dominated watersheds by calibrating the initial abstraction coefficient the calibrated value was 0 8 some peaks matched the observed data while many others underestimated peak flows since surface runoff initiated until the initial abstraction was fully satisfied fig 6 the underestimated peaks occurred in short snowmelt periods for the original swat model and the pbu pdm enhanced swat model can be attributed to the limited capability of swat in the modeling of snowmelt and the related processes in such a cold region which was also indicated by tahmasebi nasab et al 2018 in addition to the snowmelt induced high peaks the simulated streamflow did not match the observed data very well in 2000 and 2003 in which the precipitation was relatively low additionally together with previous warm and dry winters the soil water contents in these two years were very low which further reduced the surface runoff thus the original swat model and the pbu pdm enhanced swat model underestimated the surface runoff and discharges at the final outlet in these two years except for these two years other low flows in the dry time periods simulated by the pbu pdm enhanced swat model matched the observed ones very well while the original swat model underestimated such low flows fig 6 this is because the pbu pdm enhanced swat model allowed smaller depressions to contribute surface runoff before larger depressions were fully filled while the original swat model generated surface runoff only after the initial abstraction was satisfied for each rainfall event the underestimation of low flows in the original swat model was also found by tahmasebi nasab et al 2017a the performances of the original swat model and the pbu pdm enhanced swat model were also evaluated by using the two statistical measures nse and pbias table 5 according to moriasi et al 2007 moriasi et al 2015 the model can be considered satisfactory if nse greater than 0 5 and pbias is within 15 in the pbu pdm enhanced swat model the nse values were 0 71 and 0 53 for the calibration and validation periods respectively indicating a satisfactory agreement between the simulated and observed daily discharges however the nse values of the original swat model for both default and calibrated initial abstraction options i e the initial abstraction coefficient values are 0 2 and 0 8 respectively fell out of the satisfactory range in the calibration and validation periods table 5 the poor simulation results are similar to those of other studies that used the original swat model for depression dominated watersheds for example the nse values ranged from 35 7 to 0 005 in the study of chanasyk et al 2003 and from 6 5 to 0 39 in the study of mekonnen et al 2016 the pbias values of the pbu pdm enhanced swat model were 0 5 and 4 0 for the calibration and validation periods respectively which also fell into the recommended range 15 pbias 15 the negative values of pbias suggest that the pbu pdm enhanced swat model had a slight underestimation of the daily streamflow at the final outlet however the pbias values of the original swat model for both initial abstraction options fell out of the satisfactory range in the calibration and validation periods table 5 fig 7 illustrates the simulated monthly surface runoff released from all pbus in the watershed i e monthly depths of surface runoff over the entire watershed surface and the probabilities of monthly overflows water spill of all pbus i e monthly percentages of the areas of the pbus that spill in the watershed from 1998 to 2006 the box plot shows the minimum 25th percentile median 75th percentile and maximum of the areas of the pbus that spill in each month the minimum probability of water spilling from the pbus is 0 indicating that in at least one day in the month all pbus did not spill this is reasonable when there was no net water input on that day both curves show the seasonal variations in surface runoff that is the pbus had a higher potential to be fully filled and then spill runoff water from march to may this finding is consistent with those obtained from other studies in the ppr for example evenson et al 2016 simulated hydrologic processes in the pipestem creek watershed and found that the prairie pothole wetlands had higher spilling frequency in spring months march through may kantrud et al 1989 demonstrated that the spilling events of seasonal and semipermanent prairie wetlands in north dakota occurred mainly in april through may according to the graphical and statistical comparisons in this study the original swat model without accounting for the actual hydrologic roles of depressions may not be able to precisely simulate hydrologic processes in depression dominated watersheds in contrast the pbu pdm enhanced swat model developed in this study provides improved modeling capabilities 3 3 pbu pdm vs threshold controlled runoff to further examine the improvement of the pbu pdm in the simulation of surface runoff generation processes under the influence of spatially distributed depressions the variations of ca were analyzed for any daily time step the group threshold capacity may increase or decrease depending on the climate condition if the net input is less than 0 the group threshold capacity decreases and the contributing area of the group is 0 otherwise the group threshold capacity increases and the contributing area is determined by the probability distributed function of the group fig 8 a shows the normalized contributing area versus the normalized group threshold capacity for all groups in subbasin 9 with an increase in the group threshold capacity the contributing area of this group also increases when the group threshold capacity reaches its maximum depression storage capacity i e gtc i j k maxc i j 1 all pbus in this group may contribute runoff water to the main channel of the subbasin and the normalized contributing area of the group becomes 1 0 for group 1 of subbasin 9 with an increase in the group threshold capacity the contributing area increased rapidly before the threshold capacity reached 20 of its maximum at 20 of the maximum depression storage capacity nearly 86 of the group area contributed runoff water to the main channel of the subbasin this is because the group contained many pbus with smaller depression storage capacity fig 5 that were quickly fully filled and then contributed their runoff water to the main channel in contrast the remaining 14 of the area in this group consisted of large pbus with greater depression storage capacity and it took a longer time to fully fill them the contributing areas of other groups also increased with the increase of the group threshold capacity but the increasing rates were different depending on their probability distributed functions of depression storage capacities the modeling results demonstrated that the pbu pdm revealed the dynamic variations of contributing area by tracking the group threshold capacity which improved the modeling of the depression controlled surface runoff generation processes and the related threshold behavior in addition to the dynamic contributing area the time varying water storage and release of pbus were also simulated by the pbu pdm as an example fig 8b shows the relationship of the group depression storage and the group threshold capacity for group 1 in subbasin 9 which was obtained based on its probability distributed function eq 9 the total amount of water stored in the pbu depressions of group 1 increased rapidly before the group threshold capacity reached 10 mm and then increased gradually until the maximum group threshold capacity i e 58 04 mm was reached this changing pattern can be attributed to the fact that about 82 of the pbus had depression storage capacities less than 10 mm and the remaining 18 of the pbus had relatively larger depression storage capacities requiring a long time to be fully filled note that the pbus with depression storage capacities greater than the group threshold capacity at a time step experienced the filling process only and their depression storage equaled the group threshold capacity the pbus with depression storage capacities lower than the group threshold capacity underwent both filling and spilling processes as a result runoff was generated from these pbus and its quantity is given by eq 12 fig 8c shows the group net water input group threshold capacity group depression storage and surface runoff for group 1 of subbasin 9 during a selected 31 day period in may 1999 with the change in the net water input the group threshold capacity group depression storage and surface runoff varied accordingly when the net water input was less than 0 the group depression storage decreased due to evaporation and seepage the group threshold capacity also decreased and there was no surface runoff from this group otherwise the group threshold capacity and group depression storage increased and surface runoff was generated surface runoff simulated by the pbu pdm initiated when the net water input was greater than 0 note that the pbu pdm allows the pbus with depression storage capacities lower than the group threshold capacity to contribute surface runoff while the pbus with depression storage capacities higher than the group threshold capacity are still filling the quantity of the surface runoff from a group simulated by its pbu pdm was reduced due to the storage feature of pbus which helped the pbu pdm enhanced swat model to effectively avoid the potential overestimation underestimation of discharge for wet dry periods 3 4 pbu pdm vs two other modified swat models the swat model for giws by evenson et al 2015 evenson et al 2016 referred to as swat giws herein and the swat pdld model mekonnen et al 2016 are different modified swat models which quantify the hydrologic effects of spatially distributed depressions or wetlands specifically the swat giws simulates depression storage and outflow of individual wetlands whereas the swat pdld model simulates the total depression storage and surface runoff for a series of depressions using probability distributed models in the swat giws hrus determined by the combination of soil type landuse and slope are further redefined by a fourth attribute i e spatial and hydrologic relationships of hrus creating new giw hrus and catchment hrus to respectively represent wetlands and the associated catchment areas then a pothole function is used to simulate the water balance for each giw hru in which the water inflow comes from its catchment hrus the generated surface runoff from a giw hru is further routed to other giw hrus by assuming that outflow of giws with fewer catchment areas spills to giws with more catchment areas or subbasin main channel if the giw hru does not have a downgradient giw hru for each application a large quantity of input files e g 62 721 hrus in the pipestem creek watershed evenson et al 2016 need to be constructed for simulation parameters of new hrus and fill spill relationships of giw hrus and thus high computational capacities for model running are required making the model calibration and validation for long time periods more challenging in addition the swat giws simulates the hydrologic effect of wetlands that are geographically isolated which may not be applicable for depression dominated areas due to the hierarchical relationships of depressions for example when applying the swat giws to a depression dominated watershed and considering each depression as a giw hru if one giw hru that has the potential to merge with another giw hru that is fully filled its excess water tends to spill to its downgradient giw hru in the model instead of the one to be merged moreover since the mds of the merged depression is larger than that of each depression the model without considering the hierarchical relationships of depressions tends to underestimate mds and overestimate surface runoff for such a depression dominated watershed to make the swat giws more suitable for depression dominated areas additional data preprocessing and modeling efforts are needed to account for the hierarchical relationships of surface depressions instead of processing each individual depression the swat pdld model and the pbu pdm enhanced swat model implement probability distributed models to deal with water balance for a series of depressions with similar hydrotopographic properties which is more feasible and convenient for input data preparation and modeling running specifically the swat pdld model conceptualizes each individual depression as a basic unit and assumes that all depressions within the same subbasin have the same net water input and their outflows directly enter the subbasin main channel based on this assumption a probability distribution function is applied to calculate the total depression storage of all depressions and the total surface runoff generated from the subbasin in reality the depressions that have different hierarchical relationships with other depressions may have distinct net water inputs making the probability distribution function of a subbasin unsuitable for quantifying the total depression storage and surface runoff in addition if a depression is fully filled it may spill to and merge with other depressions instead of contributing its runoff water directly to the subbasin main channel indicating that the probability distribution function may overestimate the surface runoff in this study however a pbu which includes all depressions having the potential to merge and form the highest level puddle ponding area and the corresponding contributing area is considered as a basic modeling unit to account for the hierarchical relationships of depressions a pbu generates surface runoff only when its mds is reached which avoids underestimating the total mds of a subbasin and overestimating the surface runoff from the subbasin to take advantage of the probability distribution approach all pbus within a subbasin that have the same net water input are grouped and a probability distribution function is utilized for each group to quantify the total depression storage and surface runoff of the group with such a modeling framework the pbu pdm enhanced swat model is able to quantify the hydrologic effects of spatially distributed depressions and further improve hydrologic modeling for depression dominated areas 4 summary and conclusions in this study the new pbu pdm was developed and integrated with swat to improve hydrologic modeling for depression dominated regions in the pbu pdm surface runoff generation processes were simulated separately for non depressional areas i e cbus and depressional areas i e pbus the surface runoff simulated from cbus contributed directly to the main channel for pbus however the pbu pdm simulated the runoff water intercepted by and released from pbus in particular the pbu pdm accounted for the hierarchical relationships of depressions and the contributing areas of depressions all pbus within a subbasin were grouped and a probability distribution function was developed for each group to simulate the influence of depressions on surface runoff generation processes the topographic characteristics including pbus and their surface area mpa and mds were delineated and calculated by using the d cubed algorithm and further used for the development of the probability distribution functions the pbu pdm enhanced swat model was applied to the upper maple river watershed in north dakota and compared with the original swat model to demonstrate its unique features and capability of hydrologic modeling for depression dominated areas comparisons of the discharges simulated by the pbu pdm enhanced swat model and the original swat model against the observed data indicated that the original swat model tended to overestimate underestimate the discharges for wet dry periods whereas the pbu pdm enhanced swat model provided improved modeling for this depression dominated watershed specifically the simulation results highlighted the performance of the pbu pdm in the modeling of surface runoff generation processes as well as the variability in contributing area and the depression filling spilling dynamics of pbus by tracking the group threshold capacities the pbus with depression storage capacities greater than the group threshold capacities underwent filling process only while the pbus with depression storage capacities lower than the group threshold capacities experienced both filling and spilling processes which led to the initiation of surface runoff thus the contributing area only consisted of those pbus with depression storage capacities lower than their group threshold capacities by this means the water stored in and released from pbus was quantified and the depression controlled surface runoff was simulated in summary the pbu pdm enhanced swat model considers the hierarchical relationships of depressions which avoids underestimating the total maximum depression storage and overestimating surface runoff it utilizes the probability distribution approach at a level of pbus within each individual subbasin to quantify the hydrologic effects of spatially distributed depressions which facilitates the efficient modeling of threshold controlled runoff processes the pbu pdm can also be incorporated into other watershed scale models for simulating hydrologic processes especially in depression dominated regions credit authorship contribution statement lan zeng conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization jingli shao conceptualization methodology investigation writing review editing supervision xuefeng chu conceptualization methodology formal analysis investigation writing review editing data curation supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this material is based upon work primarily supported by the u s national science foundation under grant no nsf epscor award iia 1355466 the north dakota water resources research institute also provided partial financial support in the form of a graduate fellowship for the first author 
5185,modeling of overland flow for a depression dominated area is a difficult task due to the spatial distribution of depressions particularly the hierarchical relationships of depressions and their variable contributing areas make the hydrologic modeling more complicated in traditional hydrologic modeling however digital elevation models dems that are used to represent surface topography are often edited by filling depressions before delineation and the impacts of depressions are considered by using certain simplified and lumped approaches due to such flaws these hydrologic models fail to account for the actual dynamic influences of surface depressions the objective of this study is to improve hydrologic modeling for depression dominated regions by developing a new modeling framework to quantify the influence of spatially distributed depressions to achieve this objective a new puddle based unit pbu probability distributed model pbu pdm is developed and coupled with the existing soil and water assessment tool swat the pbu pdm facilitates separate simulations for non depressional and depressional areas and accounts for the hierarchical relationships of depressions their filling and spilling processes and the dynamic variations in their contributing areas the pbu pdm enhanced swat was applied to the upper maple river watershed in north dakota and calibrated and validated using the observed data in particular it was also compared with the original swat model which demonstrated the abilities of pbu pdm to mimic the filling spilling overland flow dynamics and the threshold behavior the pbu pdm provides improved watershed scale hydrologic modeling especially for depression dominated areas keywords surface depressions puddle based unit pbu channel based unit cbu probability distributed model hydrologic modeling 1 introduction surface topography affects overland flow generation surface runoff and other hydrologic processes abedini et al 2006 chu 2017 darboux and huang 2005 for example depressions act as surface impoundment and intercept surface runoff generated from their upstream contributing areas until reaching their maximum depression storage mds thresholds also each depression has a unique mds contributing area ca and relationships with its surrounding depressions and thus undergoes specific dynamic puddle to puddle p2p filling spilling merging processes during rainfall events chu et al 2013 the influence of depressions makes hydrologic processes more complicated in many traditional watershed hydrologic models a digital elevation model dem which is used to represent surface topography is preprocessed by filling all sinks or depressions the impacts of depressions are usually simulated by using certain oversimplified and lumped approaches such as a single depression storage threshold control on the initiation of surface runoff e g amoah et al 2013 tahmasebi nasab et al 2017a in reality smaller depressions that connect to the outlet may contribute runoff water before larger depressions are fully filled thus the lumped methods do not consider the spatial distributions of depressions and cannot fully simulate the real dynamic influences of depressions on hydrologic processes evenson et al 2015 golden et al 2014 golden et al 2017 tahmasebi nasab et al 2017a therefore how to characterize and account for depressions in hydrologic models is an important task especially for depression dominated areas some modeling efforts have been made to consider the spatial variations of depressions in hydrologic modeling e g chu et al 2010 chu et al 2013 shaw et al 2013 shook et al 2013 yang and chu 2015 evenson et al 2015 evenson et al 2016 ameli and creed 2017 tahmasebi nasab et al 2017b shaw et al 2013 developed a simple pothole terrain analysis algorithm spill to simulate the fill spill processes of all depressions and quantify surface depression storage and basin ca under different runoff conditions shook et al 2011 developed a fully distributed wetland dem ponding model wdpm to simulate the filling and depleting processes of depressions dynamic ponding storage of each depression time varying basin ca and surface runoff in a wetland dominated region chu et al 2010 proposed a puddle delineation pd algorithm based on which a depression dominated delineation d cubed algorithm was further developed tahmasebi nasab et al 2017b the algorithms have been used to identify depressions puddles track the ca of each puddle determine the hierarchical relationships of puddles compute flow directions and accumulations and calculate topographic parameters particularly the d cubed algorithm delineates a surface into a number of puddle based units pbus and channel based units cbus chu et al 2013 and yang and chu 2015 developed a physically based distributed p2p model for simulating overland flow processes over depression dominated areas based on the detailed surface microtopographic characteristics from the pd algorithm the p2p model simulates the dynamic filling spilling merging and splitting processes of puddles and reveals the real microtopography controlled drainage patterns however modeling overland flow dynamics over all depressions needs high resolution input data and requires high computational capacity making these distributed models more suitable for smaller scale modeling problems for watershed scale modeling evenson et al 2015 evenson et al 2016 evenson et al 2018 modified swat to simulate the influences of geographically isolated wetlands giws on downstream hydrology in their studies the hydrologic response units hrus were re defined by distinguishing giws from their catchment areas and introducing a series of giw hrus i e wetlands and catchment hrus an extended swat pothole function was utilized to simulate the outflows of giws which were further routed the redefinition of hrus resulted in a significant increase in the number of hrus evenson et al 2016 which consequently made long term modeling including input data preparation model calibration and validation more challenging alternatively the geometric properties of depressions e g area depth and storage capacity can be quantified by a frequency distribution ullah and dickinson 1979 which potentially improves surface runoff simulation for depression dominated surfaces abedini 1998 kuchment et al 2000 mekonnen et al 2014 mekonnen et al 2016 abedini 1998 applied the probability distributed model pdm originally developed by moore 1985 to describe the spatial variations of depression storage capacities characterize the dynamic cas and calculate the water storage of depressions and surface runoff kuchment et al 2000 utilized an exponential distribution function to represent the spatial distribution of surface depressional storages and applied the distribution to the simulation of runoff processes in a wetland covered basin following abedini 1998 and moore 2007 mekonnen et al 2014 and mekonnen et al 2016 incorporated the pdm into the mesh modeling system modélisation environmentale communautaire surface and hydrology pietroniro et al 2006 and swat to account for the heterogeneity of storages of depressions and simulate surface runoff their modeling results indicated that such a statistical approach was able to simulate the influence of spatially distributed depressions for larger watersheds with numerous depressions the probability distributed approach is feasible and convenient for considering the diversity of depressions however the pdm does not consider the dynamic relationships of depressions and their cas to the best of our knowledge no probability distributed approach has been developed to address the impacts of such complicated properties of depressions on hydrologic modeling the objective of this study is to improve hydrologic modeling for depression dominated regions by quantifying the influence of spatially distributed depressions to achieve this objective a new pbu based probability distributed model pbu pdm is developed and coupled with the existing swat to account for the spatial distributions and relationships of surface depressions and simulate their filling and spilling processes and the dynamic variations in their contributing areas the pbu pdm is then applied to the upper maple river watershed in north dakota and its performances in both calibration and validation are evaluated 2 methodology and materials 2 1 characterization of surface topography to provide the detailed topographic information of depressions e g size storage ca and the relationships with surrounding depressions for the pbu pdm modeling the d cubed algorithm tahmasebi nasab et al 2017b was utilized based on the original dem of a watershed the d cubed algorithm identifies depressions puddles by searching their centers thresholds and all included cells which are defined as first level depressions puddles if two or more first level puddles share a common threshold they potentially merge and form a second level puddle all higher level puddles are formed in the same fashion such different levels of puddles define their hierarchical relationships this process continues until all highest level puddles are determined then the mds and maximum ponding area mpa of each puddle and other topographic parameters are computed during the delineation process the d cubed algorithm also provides the details on flow directions flow accumulations and channel segments importantly the algorithm identifies all pbus and cbus the former pbu consists of a highest level puddle and its ca while the latter cbu includes a channel segment and its ca pbus and cbus can connect to each other and the interconnections of all pbus and cbus form a cascaded channel puddle drainage system which contributes runoff water to the watershed outlet table 1 lists all acronyms and variables parameters used in this paper 2 2 model development 2 2 1 overall modeling framework in the original swat modeling a watershed is delineated into a number of subbasins by using a pre filled dem based on the meteorological and hydrologic data soil type land use and other input data swat provides the simulated surface runoff infiltration evapotranspiration and other hydrologic variables thus the original swat modeling is performed for a depressionless well connected surface for the pbu pdm enhanced swat model in addition to the aforementioned input data a set of topographic property parameters and data from the d cubed algorithm are used for developing the pdms for all subbasins the land phase modeling is performed for all subbasins which is followed by channel routing for the entire drainage system fig 1 for the land phase modeling of each subbasin within the subbasin loop a two step modeling is performed 1 swat subbasin based modeling step 1 and 2 pbu pdm modeling step 2 fig 1 in step 1 hydrologic processes such as surface runoff and infiltration are simulated for all subbasins while step 2 implements the pbu pdm simulation specifically the surface runoff simulated in step 1 without consideration of the influence of depressions is transferred into the pbu pdm as detailed in the following subsection the pbu pdm simulates the dynamic variations in depression storage across all subbasins and the threshold controlled surface runoff reaching the main channels which is further transferred back to the swat model for channel routing throughout the entire channel network 2 2 2 new pbu pdm based on the original dem the d cubed algorithm divides a basin into a number of subbasins each of which is further divided into numerous pbus depressional area and cbus non depressional area in the pbu pdm separate simulations are conducted for the cbus and pbus of each subbasin fig 2 a since a cbu does not contain any depression the surface runoff generated from a cbu is equal to that simulated in the swat modeling step 1 fig 1 and is assumed to contribute directly to the corresponding subbasin main channel for pbus however a series of pdms fig 2a are used to determine the temporal variations of depression storage and surface runoff from such depressional areas as basic modeling units pbus account for the hierarchical relationships of depressions and their cas to develop the pdms for depressional areas fig 2a water balance is analyzed for an individual pbu fig 3 specifically a pbu consists of a ca and a ponding area pa the ca receives precipitation water and loses water by infiltration and the resulting surface runoff contributes to its associated pa fig 3a the pa receives water from precipitation and surface runoff from its ca and loses water through evaporation and seepage if the net water input difference between inputs and losses of the pa exceeds the available depression storage of the pbu the highest level puddle is fully filled reaching its mds and overflowing to its downstream fig 3b the outflow and depression storage of the pbu can be mathematically expressed as follows note that hydrologic variables d c s s0 and r are expressed as a depth over the pbu 1 r d c s 0 d c s 0 0 d c s 0 2 s c d c s 0 d s 0 d c s 0 in which 3 d p r e c i p e v a p s e e p a g e p a a runoff ca 1 p a a where r is the surface runoff generated from the pbu at the end of a given time step l d is the net water input of the pa of the pbu during the time step l c is the depression storage capacity of the highest level puddle of the pbu l s0 is the depression storage of the pbu at the beginning of the time step l s is the depression storage of the pbu at the end of a time step l runoff ca is the surface runoff generated from the ca of the pbu during the time step l and is equal to the surface runoff simulated in the swat modeling step 1 fig 1 and pa and a are respectively the area of the ponding area and the entire surface area of the pbu l2 the water evaporation and seepage of the pa are respectively given by arnold et al 1998 4 evap η p e t 5 seepage k δ t where η is the evaporation coefficient of the pa of the pbu pet is the potential evapotranspiration l k is the saturated hydraulic conductivity of the bottom sediment of the pa of the pbu l t and δt is the time interval t which is a daily increment in this study it is worth noting that the infiltration of the cas of all pbus and cbus is calculated in the swat modeling step 1 fig 1 and updated at each daily step based on the soil water content and top soil temperature and the percolation from the bottom of the soil profile and the seepage from the pas of pbus enter the deep vadose zone and the groundwater zone within a subbasin precipitation evaporation and seepage are considered to be the same for all pbus all depressions are assumed empty at the beginning of simulation in applications the issue associated with this initial condition can be addressed by the warm up simulation to simplify the pbu pdm for pbus the maximum ponding area of a pbu is used in the computation of net water input according to eqs 1 3 the pbus with the same ratio of maximum ponding area to the pbu area i e r mpa mpa a have the same net water input and the generated surface runoff and depression storage of the pbus are only related to their depression storage capacities and the filling conditions of their highest level puddles for the pbus with the same r mpa following abedini 1998 and mekonnen et al 2016 the probability distributed approach can be applied to simulate the filling spilling overland flow processes thus the pbus with the same r mpa are assigned to the same group as a result all pbus within one subbasin are assigned to different groups based on their r mpa values fig 2a that is one subbasin may include many groups each of which contains many pbus that have the same r mpa then a pdm is developed for each group to calculate the total amount of water stored in this group and the surface runoff generated from this group at each time step fig 2a fig 2b d show how the pdm determines the total depression storage and surface runoff for group i of subbasin j this group consists of a set of pbus with different depression storage capacities which are represented by the columns with different heights in fig 2b the probability of each depression storage capacity is determined by frequency analysis for depression storage capacities of all pbus in this group through analysis of water balance of the ca and pa of each pbu in group i of subbasin j at time step k eqs 1 3 the pbus with the same depression storage capacities have the same depression storage and outflow their values depend on the filling spilling condition to determine the filling spilling condition of the pbus in a group the concept of group threshold capacity is introduced fig 2c during the filling process with a positive net water input if a pbu happens to be fully filled and does not generate outflow e g pbu4 in fig 2c the depression storage capacity of this pbu at that time step is defined as the group threshold capacity thus if the depression storage capacity of a pbu in group i of subbasin j is greater than the group threshold capacity e g pbus 5 6 and 7 in fig 2c it will not contribute runoff water and its depression storage equals the group threshold capacity if the pbus in group i of subbasin j have a depression storage capacity smaller than the group threshold capacity e g pbus 1 2 and 3 in fig 2c they reach their depression storage capacities and the excess water becomes surface runoff outflow the proportion of the area of the pbus that contributes surface runoff to the subbasin outlet can be calculated by eq 6 and the total depression storage in group i of subbasin j at time step k is given by eq 7 moore 1985 6 p c c i j g t c i j k 0 g t c i j k f c c i j d c c i j 7 s i j k 0 g t c i j k c c i j f c c i j d c c i j g t c i j k g t c i j k maxc i j f c c i j d c c i j g t c i j k m i n g t c i j k maxc i j where s i j k is the total depression storage of group i in subbasin j at time step k l gtc i j k is the threshold capacity of group i in subbasin j at time step k l c c i j is the depression storage capacity of group i in subbasin j l maxc i j is the maximum depression storage capacity of group i in subbasin j l and f c c i j is the probability of occurrence of depression storage capacity cc i j of group i in subbasin j according to kuchment et al 2000 and mekonnen et al 2016 depression storage capacity follows a continuous exponential distribution thus an exponential function eq 8 is used in this study to describe the probability distribution of depression storage capacities and the total water stored in the pbus of group i in subbasin j at time step k is given by eq 9 8 f c c i j α i j e x p β i j c c i j 9 s i j k α i j β i j 2 1 exp β i j gtc i j k g t c i j k m i n g t c i j k maxc i j where α i j and β i j are the coefficients of the exponential function of group i in subbasin j the two coefficients are obtained by fitting the distribution of the depression storage capacities of the pbus of group i in subbasin j and can vary over groups and subbasins to determine the group threshold capacity and the generated surface runoff two scenarios are considered if the net water input of group i in subbasin j at time step k 1 is greater than zero the group threshold capacity increases by the net water input during this time step eq 10 fig 2d the water stored during the current time step is given by eq 11 and the surface runoff generated in this group during this time step is given by eq 12 fig 2d 10 gtc i j k 1 gtc i j k d i j k 1 gtc i j k 1 m i n gtc i j k 1 m a x c i j 11 δ s i j k 1 s i j k 1 s i j k 12 r i j k 1 d i j k 1 δ s i j k 1 where δs i j k 1 is the depression storage change of group i in subbasin j during time step k 1 l and r i j k 1 is the surface runoff generated from group i in subbasin j at time step k 1 l if d i j k 1 less than 0 no runoff is generated in group i eq 13 at time step k 1 the storage decreases due to the negative net water input eq 14 and the group threshold capacity can be obtained by solving eq 7 13 r i j k 1 0 d i j k 1 0 14 s i j k 1 s i j k d i j k 1 d i j k 1 0 the actual amount of water stored in the pbus of subbasin j can be expressed as 15 s j k i 1 n s i j k g i where s j k is the depression storage of subbasin j at time step k l and gi is the ratio of the area of group i to the total area of subbasin j similar to the original swat the surface runoff generated from cbus and pbus is routed to the main channel in the subbasin by for cbus 16 r cbu j k r cbu j k rs cbu j k 1 rfr j for pbus 17 r i j k r i j k rs i j k 1 rfr j and the total runoff water reaching the main channel in the subbasin is given by 18 r j k i 1 n r i j k g i r cbu j k g cbu where r cbu j k is the surface runoff from cbus that reaches the main channel of subbasin j at time step k l r cbu j k is the surface runoff generated in the cbus of subbasin j at time step k l rs cbu j k 1 is the surface runoff stored on the cbus of subbasin j at time step k 1 l rfr j is the surface runoff release fraction of subbasin j r i j k is the surface runoff from group i that reaches the main channel of subbasin j at time step k l rs i j k 1 is the surface runoff stored on the surface of group i in subbasin j at time step k 1 l r j k is the surface runoff that reaches the main channel of subbasin j at time step k l and gcbu is the ratio of the area of the cbus in subbasin j to the total area of subbasin j it is worth noting that the ca of a pbu can be large so that the surface runoff from the entire ca may not reach its corresponding pa of the pbu within one daily time step thus the ca runoff release fraction parameter is used to separate the surface runoff generated from the ca in one day into two parts runoff water reaching the pa and runoff water stored on the ca the former is a water input of the pa at the current time step and the latter is a water input of the pa at the following time steps since the sizes of cas of pbus vary the median ca in each group instead of the average ca is utilized to calculate the ca runoff release fraction for the group which can be obtained by 19 c a r f r i j rfr j medca i j a j where ca rfr i j is the surface runoff release fraction for the cas of all depressions of group i in subbasin j medca i j is the median area of the cas of all depressions of group i in subbasin j l2 and a j is the entire surface area of subbasin j l2 2 3 application of the pbu pdm the pbu pdm enhanced swat model was applied to a study area in the prairie pothole region ppr of north dakota fig 4 a it is the upper portion of the maple river watershed with an outlet at the usgs gaging station 05059700 at maple river nr enderlin latitude 46 37 18 longitude 97 34 25 the drainage area is 2183 36 km2 81 24 of which is agricultural lands the upper maple river watershed covers parts of five counties in the east central north dakota including barnes cass griggs ransom and steele counties in this study a 30 m dem was downloaded from the usgs national map tnm the arcswat an extension of arcgis was used to preprocess the dem by filling depressions delineate the watershed into subbasins and prepare the input data the original dem was also imported into d cubed algorithm to identify depressions and compute topographic parameters for all subbasins the land use and land cover lulc data were obtained from the national land cover database nlcd 2011 and the soil type data were obtained from the soil survey geographic database ssurgo 8 different lulc types and 47 different soil types were considered in the modeling the lulc and soil type data were further used in swat to define hrus and calculate curve numbers this watershed included 5 climate stations fig 4a which provided daily precipitation temperature solar radiation wind speed and humidity for swat modeling the climate data were obtained from the climate forecast system reanalysis cfsr the soil conservation service curve number scs cn method the penman monteith method and the variable storage routing method were selected in arcswat to simulate rainfall excess potential evapotranspiration and perform channel routing to demonstrate the improved capabilities the pbu pdm enhanced swat model was compared with the original swat model in the original swat model depression storage is a part of the initial abstraction which is defined as 20 of the potential maximum retention in the curve number method in this study this default initial abstract coefficient i e 0 2 was used in addition the original swat model was also calibrated by adjusting this initial abstraction coefficient in the swat source code to further evaluate its performance in contrast the pbu pdm enhanced swat model explicitly simulates the influences of depressions on surface runoff filling and spilling processes and the dynamic variations in contributing areas thus the initial abstraction in the enhanced swat model did not include depression storage and its value was also obtained through model calibration 2 4 model calibration and validation the entire modeling system was calibrated and validated specifically a 4 year period from 1994 to 1997 was selected as the warm up period the calibration and validation periods ranged from 1998 to 2002 and from 2003 to 2006 respectively the observed discharge data at the final outlet used for model calibration and validation were downloaded from the usgs national water information system the sufi 2 algorithm in swat cup was utilized for model calibration and validation the model performance was evaluated by using two statistical measures nash sutcliffe efficiency nse nash and sutcliffe 1970 and percent bias pbias gupta et al 1999 that are respectively expressed as 20 nse 1 i 1 n q obs i q sim i 2 i 1 n q obs i q obs 2 21 pbias i 1 n q sim i q obs i i 1 n q obs i 100 where n is the total number of discharge observations q sim i is the simulated outlet discharge l3 t q obs i is the observed outlet discharge l3 t q obs is the average of the observed outlet discharges l3 t 3 results and discussions 3 1 surface delineation results and pbu pdm the upper maple river watershed was divided into 16 subbasins fig 4b which were further divided into many pbus and cbus fig 4c table 2 lists the major topographic parameters for all subbasins of the upper maple river watershed determined by the d cubed algorithm as shown in table 2 the cbus only account for 5 54 29 32 of their subbasin areas and the remaining areas are pbus suggesting that most surface runoff in a subbasin was from its pbus and subject to the threshold control the number of pbus and their sizes and mds values varied among subbasins table 2 the total mds of the 16 subbasins ranged from 3 07 106 to 26 06 106 m3 and the mds of individual pbus ranged widely from a value smaller than 0 01 m3 to 6 47 106 m3 for the development of pbu pdm all pbus within each subbasin were aggregated into many groups based on their rmpa values a probability distributed function was created for each group table 2 lists the number of groups for all subbasins ranging from 6 to 9 as an example table 3 shows the details on the groups of subbasin 9 including the number of pbus rmpa ranges maximum and minimum depression storage capacities and percent areas as well as the fitted probability distributed functions in addition group 6 in subbasin 9 has only one pbu with a significantly large depression storage capacity table 3 which unlikely contributes any runoff water under a normal climate condition thus no pdm was developed for this group the impact of this group on the modeling should be limited since it only accounts for 1 of the area of subbasin 9 table 3 fig 5 shows the cumulative probability distributions of depression storage capacities of pbus for all groups in three representative subbasins subbasins 4 9 and 13 that have unique topographic characteristics subbasins 9 and 13 have relatively small and large mds of individual pbus respectively while subbasin 4 has a moderate mds of individual pbus table 2 and fig 5 the groups of different subbasins that have the same rmpa ranges show a similar trend with the increase in the group number or rmpa values the depression storage capacities of pbus increase resultantly the capacity curve covers a wider range 3 2 model performance following lin mohammad and zheng 2015 and based on the special need of the new pbu pdm model 18 parameters were selected for model calibration and the calibrated values are shown in table 4 particularly two depression related parameters evaporation coefficient of depressions η and hydrologic conductivity through the bottom of depressions k eqs 4 and 5 were included in the pbu pdm depression simulation and the initial abstraction coefficient λ was also calibrated in the original swat model and the pbu pdm enhanced swat model the comparisons of the simulated and observed hydrographs for the calibration and validation periods are shown in fig 6 overall the pbu pdm enhanced swat model provided reasonable hydrographs for both periods the magnitude timing and duration of most of the peak flows simulated by the pbu pdm enhanced swat model reasonably matched the observed data fig 6 however the original swat model with the default initial abstraction significantly overestimated most of peak flows showing a pattern of quick rise and short recession this is because the default initial abstraction failed to account for the magnitude and the actual hydrologic roles of surface depressions other studies e g tahmasebi nasab et al 2017a mekonnen et al 2016 also indicated that the original swat model tended to overestimate peak flows for depression dominated watersheds by calibrating the initial abstraction coefficient the calibrated value was 0 8 some peaks matched the observed data while many others underestimated peak flows since surface runoff initiated until the initial abstraction was fully satisfied fig 6 the underestimated peaks occurred in short snowmelt periods for the original swat model and the pbu pdm enhanced swat model can be attributed to the limited capability of swat in the modeling of snowmelt and the related processes in such a cold region which was also indicated by tahmasebi nasab et al 2018 in addition to the snowmelt induced high peaks the simulated streamflow did not match the observed data very well in 2000 and 2003 in which the precipitation was relatively low additionally together with previous warm and dry winters the soil water contents in these two years were very low which further reduced the surface runoff thus the original swat model and the pbu pdm enhanced swat model underestimated the surface runoff and discharges at the final outlet in these two years except for these two years other low flows in the dry time periods simulated by the pbu pdm enhanced swat model matched the observed ones very well while the original swat model underestimated such low flows fig 6 this is because the pbu pdm enhanced swat model allowed smaller depressions to contribute surface runoff before larger depressions were fully filled while the original swat model generated surface runoff only after the initial abstraction was satisfied for each rainfall event the underestimation of low flows in the original swat model was also found by tahmasebi nasab et al 2017a the performances of the original swat model and the pbu pdm enhanced swat model were also evaluated by using the two statistical measures nse and pbias table 5 according to moriasi et al 2007 moriasi et al 2015 the model can be considered satisfactory if nse greater than 0 5 and pbias is within 15 in the pbu pdm enhanced swat model the nse values were 0 71 and 0 53 for the calibration and validation periods respectively indicating a satisfactory agreement between the simulated and observed daily discharges however the nse values of the original swat model for both default and calibrated initial abstraction options i e the initial abstraction coefficient values are 0 2 and 0 8 respectively fell out of the satisfactory range in the calibration and validation periods table 5 the poor simulation results are similar to those of other studies that used the original swat model for depression dominated watersheds for example the nse values ranged from 35 7 to 0 005 in the study of chanasyk et al 2003 and from 6 5 to 0 39 in the study of mekonnen et al 2016 the pbias values of the pbu pdm enhanced swat model were 0 5 and 4 0 for the calibration and validation periods respectively which also fell into the recommended range 15 pbias 15 the negative values of pbias suggest that the pbu pdm enhanced swat model had a slight underestimation of the daily streamflow at the final outlet however the pbias values of the original swat model for both initial abstraction options fell out of the satisfactory range in the calibration and validation periods table 5 fig 7 illustrates the simulated monthly surface runoff released from all pbus in the watershed i e monthly depths of surface runoff over the entire watershed surface and the probabilities of monthly overflows water spill of all pbus i e monthly percentages of the areas of the pbus that spill in the watershed from 1998 to 2006 the box plot shows the minimum 25th percentile median 75th percentile and maximum of the areas of the pbus that spill in each month the minimum probability of water spilling from the pbus is 0 indicating that in at least one day in the month all pbus did not spill this is reasonable when there was no net water input on that day both curves show the seasonal variations in surface runoff that is the pbus had a higher potential to be fully filled and then spill runoff water from march to may this finding is consistent with those obtained from other studies in the ppr for example evenson et al 2016 simulated hydrologic processes in the pipestem creek watershed and found that the prairie pothole wetlands had higher spilling frequency in spring months march through may kantrud et al 1989 demonstrated that the spilling events of seasonal and semipermanent prairie wetlands in north dakota occurred mainly in april through may according to the graphical and statistical comparisons in this study the original swat model without accounting for the actual hydrologic roles of depressions may not be able to precisely simulate hydrologic processes in depression dominated watersheds in contrast the pbu pdm enhanced swat model developed in this study provides improved modeling capabilities 3 3 pbu pdm vs threshold controlled runoff to further examine the improvement of the pbu pdm in the simulation of surface runoff generation processes under the influence of spatially distributed depressions the variations of ca were analyzed for any daily time step the group threshold capacity may increase or decrease depending on the climate condition if the net input is less than 0 the group threshold capacity decreases and the contributing area of the group is 0 otherwise the group threshold capacity increases and the contributing area is determined by the probability distributed function of the group fig 8 a shows the normalized contributing area versus the normalized group threshold capacity for all groups in subbasin 9 with an increase in the group threshold capacity the contributing area of this group also increases when the group threshold capacity reaches its maximum depression storage capacity i e gtc i j k maxc i j 1 all pbus in this group may contribute runoff water to the main channel of the subbasin and the normalized contributing area of the group becomes 1 0 for group 1 of subbasin 9 with an increase in the group threshold capacity the contributing area increased rapidly before the threshold capacity reached 20 of its maximum at 20 of the maximum depression storage capacity nearly 86 of the group area contributed runoff water to the main channel of the subbasin this is because the group contained many pbus with smaller depression storage capacity fig 5 that were quickly fully filled and then contributed their runoff water to the main channel in contrast the remaining 14 of the area in this group consisted of large pbus with greater depression storage capacity and it took a longer time to fully fill them the contributing areas of other groups also increased with the increase of the group threshold capacity but the increasing rates were different depending on their probability distributed functions of depression storage capacities the modeling results demonstrated that the pbu pdm revealed the dynamic variations of contributing area by tracking the group threshold capacity which improved the modeling of the depression controlled surface runoff generation processes and the related threshold behavior in addition to the dynamic contributing area the time varying water storage and release of pbus were also simulated by the pbu pdm as an example fig 8b shows the relationship of the group depression storage and the group threshold capacity for group 1 in subbasin 9 which was obtained based on its probability distributed function eq 9 the total amount of water stored in the pbu depressions of group 1 increased rapidly before the group threshold capacity reached 10 mm and then increased gradually until the maximum group threshold capacity i e 58 04 mm was reached this changing pattern can be attributed to the fact that about 82 of the pbus had depression storage capacities less than 10 mm and the remaining 18 of the pbus had relatively larger depression storage capacities requiring a long time to be fully filled note that the pbus with depression storage capacities greater than the group threshold capacity at a time step experienced the filling process only and their depression storage equaled the group threshold capacity the pbus with depression storage capacities lower than the group threshold capacity underwent both filling and spilling processes as a result runoff was generated from these pbus and its quantity is given by eq 12 fig 8c shows the group net water input group threshold capacity group depression storage and surface runoff for group 1 of subbasin 9 during a selected 31 day period in may 1999 with the change in the net water input the group threshold capacity group depression storage and surface runoff varied accordingly when the net water input was less than 0 the group depression storage decreased due to evaporation and seepage the group threshold capacity also decreased and there was no surface runoff from this group otherwise the group threshold capacity and group depression storage increased and surface runoff was generated surface runoff simulated by the pbu pdm initiated when the net water input was greater than 0 note that the pbu pdm allows the pbus with depression storage capacities lower than the group threshold capacity to contribute surface runoff while the pbus with depression storage capacities higher than the group threshold capacity are still filling the quantity of the surface runoff from a group simulated by its pbu pdm was reduced due to the storage feature of pbus which helped the pbu pdm enhanced swat model to effectively avoid the potential overestimation underestimation of discharge for wet dry periods 3 4 pbu pdm vs two other modified swat models the swat model for giws by evenson et al 2015 evenson et al 2016 referred to as swat giws herein and the swat pdld model mekonnen et al 2016 are different modified swat models which quantify the hydrologic effects of spatially distributed depressions or wetlands specifically the swat giws simulates depression storage and outflow of individual wetlands whereas the swat pdld model simulates the total depression storage and surface runoff for a series of depressions using probability distributed models in the swat giws hrus determined by the combination of soil type landuse and slope are further redefined by a fourth attribute i e spatial and hydrologic relationships of hrus creating new giw hrus and catchment hrus to respectively represent wetlands and the associated catchment areas then a pothole function is used to simulate the water balance for each giw hru in which the water inflow comes from its catchment hrus the generated surface runoff from a giw hru is further routed to other giw hrus by assuming that outflow of giws with fewer catchment areas spills to giws with more catchment areas or subbasin main channel if the giw hru does not have a downgradient giw hru for each application a large quantity of input files e g 62 721 hrus in the pipestem creek watershed evenson et al 2016 need to be constructed for simulation parameters of new hrus and fill spill relationships of giw hrus and thus high computational capacities for model running are required making the model calibration and validation for long time periods more challenging in addition the swat giws simulates the hydrologic effect of wetlands that are geographically isolated which may not be applicable for depression dominated areas due to the hierarchical relationships of depressions for example when applying the swat giws to a depression dominated watershed and considering each depression as a giw hru if one giw hru that has the potential to merge with another giw hru that is fully filled its excess water tends to spill to its downgradient giw hru in the model instead of the one to be merged moreover since the mds of the merged depression is larger than that of each depression the model without considering the hierarchical relationships of depressions tends to underestimate mds and overestimate surface runoff for such a depression dominated watershed to make the swat giws more suitable for depression dominated areas additional data preprocessing and modeling efforts are needed to account for the hierarchical relationships of surface depressions instead of processing each individual depression the swat pdld model and the pbu pdm enhanced swat model implement probability distributed models to deal with water balance for a series of depressions with similar hydrotopographic properties which is more feasible and convenient for input data preparation and modeling running specifically the swat pdld model conceptualizes each individual depression as a basic unit and assumes that all depressions within the same subbasin have the same net water input and their outflows directly enter the subbasin main channel based on this assumption a probability distribution function is applied to calculate the total depression storage of all depressions and the total surface runoff generated from the subbasin in reality the depressions that have different hierarchical relationships with other depressions may have distinct net water inputs making the probability distribution function of a subbasin unsuitable for quantifying the total depression storage and surface runoff in addition if a depression is fully filled it may spill to and merge with other depressions instead of contributing its runoff water directly to the subbasin main channel indicating that the probability distribution function may overestimate the surface runoff in this study however a pbu which includes all depressions having the potential to merge and form the highest level puddle ponding area and the corresponding contributing area is considered as a basic modeling unit to account for the hierarchical relationships of depressions a pbu generates surface runoff only when its mds is reached which avoids underestimating the total mds of a subbasin and overestimating the surface runoff from the subbasin to take advantage of the probability distribution approach all pbus within a subbasin that have the same net water input are grouped and a probability distribution function is utilized for each group to quantify the total depression storage and surface runoff of the group with such a modeling framework the pbu pdm enhanced swat model is able to quantify the hydrologic effects of spatially distributed depressions and further improve hydrologic modeling for depression dominated areas 4 summary and conclusions in this study the new pbu pdm was developed and integrated with swat to improve hydrologic modeling for depression dominated regions in the pbu pdm surface runoff generation processes were simulated separately for non depressional areas i e cbus and depressional areas i e pbus the surface runoff simulated from cbus contributed directly to the main channel for pbus however the pbu pdm simulated the runoff water intercepted by and released from pbus in particular the pbu pdm accounted for the hierarchical relationships of depressions and the contributing areas of depressions all pbus within a subbasin were grouped and a probability distribution function was developed for each group to simulate the influence of depressions on surface runoff generation processes the topographic characteristics including pbus and their surface area mpa and mds were delineated and calculated by using the d cubed algorithm and further used for the development of the probability distribution functions the pbu pdm enhanced swat model was applied to the upper maple river watershed in north dakota and compared with the original swat model to demonstrate its unique features and capability of hydrologic modeling for depression dominated areas comparisons of the discharges simulated by the pbu pdm enhanced swat model and the original swat model against the observed data indicated that the original swat model tended to overestimate underestimate the discharges for wet dry periods whereas the pbu pdm enhanced swat model provided improved modeling for this depression dominated watershed specifically the simulation results highlighted the performance of the pbu pdm in the modeling of surface runoff generation processes as well as the variability in contributing area and the depression filling spilling dynamics of pbus by tracking the group threshold capacities the pbus with depression storage capacities greater than the group threshold capacities underwent filling process only while the pbus with depression storage capacities lower than the group threshold capacities experienced both filling and spilling processes which led to the initiation of surface runoff thus the contributing area only consisted of those pbus with depression storage capacities lower than their group threshold capacities by this means the water stored in and released from pbus was quantified and the depression controlled surface runoff was simulated in summary the pbu pdm enhanced swat model considers the hierarchical relationships of depressions which avoids underestimating the total maximum depression storage and overestimating surface runoff it utilizes the probability distribution approach at a level of pbus within each individual subbasin to quantify the hydrologic effects of spatially distributed depressions which facilitates the efficient modeling of threshold controlled runoff processes the pbu pdm can also be incorporated into other watershed scale models for simulating hydrologic processes especially in depression dominated regions credit authorship contribution statement lan zeng conceptualization methodology software validation formal analysis investigation writing original draft writing review editing visualization jingli shao conceptualization methodology investigation writing review editing supervision xuefeng chu conceptualization methodology formal analysis investigation writing review editing data curation supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this material is based upon work primarily supported by the u s national science foundation under grant no nsf epscor award iia 1355466 the north dakota water resources research institute also provided partial financial support in the form of a graduate fellowship for the first author 
5186,high spatio temporal variability of daily rainfall in bali island can create the absence of structure in the daily variogram in certain days this research proposes a new technique applying space time variogram for 3 successive daily rainfall to detect structure in variogram estimation by merging rain gauges and satellite data applying ordinary kriging ok regression kriging with cmorph cm regression kriging with trmm tr and blended monthly rainfall mont to obtain daily blended gridded rainfall estimates original retrieval of cmorph cm or and trmm tr or also used as control points to assess the proposed method uncertainty and sensitivity analysis including cross validation were carried out to validate the proposed method the result shows that a new technique adapted from cmorph specific character can be applied to detect the existence of structure in variogram blended gridded daily rainfall estimates of cm has highest probability detection of rainy events while ok the lowest generally the four interpolation methods ok cm mont tr have low accuracy at leeward and in a coastal area all of them have almost similar performance indicated by no clear distinction of rmse value from cross validation cm mont and tr have a good sensitivity with maximum and minimum temperature indicating that satellite data can improve the gridded rainfall estimates however it is required an improvement of daily gridded rainfall estimates since there are large rmse values and low coefficient correlation in certain days because of strong and erratic behavior of rainy events in a mountainous tropical island of bali keywords blended daily rainfall estimates cmorph space time variogram bali island 1 introduction 1 1 background as the rainiest places in the world mountainous tropical island is characterized by highly variable of daily precipitation cronin et al 2015 the presence of sea border mountain range and prevailing winds enhances the complexity of convective circulation system in this island leading to complex rainfall structure in space and time qian 2008 sato et al 2009 yokoi et al 2017 kriging is one of common methods to investigate rainfall structure in space time which is able to include linearity correlation with some parameters i e environmental condition of the island kyriakidis et al 2001 seo et al 2015 vajda and venäläinen 2003 satellite data li and shao 2010 velasco forero et al 2009 and extended to space time domain spadavecchia and williams 2009 one of kriging approach implementing a linear relationship between rainfall and these parameters is regression kriging hengl et al 2007 in regression kriging rain gauge data is as the source of primary variable and satellite data as an additional or secondary variable both data sources were merged to obtain distributed blended daily rainfall estimates velasco forero et al 2009 this merged technique takes advantages of the strength of both data sources satellite data can provide a spatial structure of rainfall in ungauged sites gebregiorgis and hossain 2013 woldemeskel et al 2013 because of time series data availability and area coverage irrespective of terrain or climate grimes 2008 rain gauge data provides true value in corresponding gauge location ebert et al 2007 the selection of satellite data to be merged with rain gauge data in a certain area depends on the performance of satellite data the spatio temporal resolution of satellite data the algorithm of satellite data geographic location and environmental condition of the study area cmorph the climate prediction center morphing method coarser resolution cmorph25 27 km2 grid size is the best performance in bali island rahmawati and lubczynski 2018 however cmorph finer spatial resolution cmorph8 8 km2 grid size was selected to blend with rain gauge data because this finer spatial resolution can provide more detail rainfall information in limited rain gauges networks clarke and buarque 2013 in bali island moreover blended monthly rainfall estimates from cmorph8 and rain gauge is also merged with daily rain gauge data to regionalize geographic and environmental condition of daily rainfall trmm tmpa tropical rainfall measuring mission multi satellite precipitation analysis 3b42 was used to obtain distributed blended daily rainfall estimates because it had lowest hits bias in estimating rainfall in bali island rahmawati and lubczynski 2018 bali island is a mountainous tropical island which has high spatial and temporal variability of daily rainfall rahmawati and lubczynski 2018 highly variable of rainfall in bali island is because of the mixture effect of land sea breeze and topography concavity of land windward leeward monsoon mean flows and gravity wave kikuchi and wang 2008 these conditions resulting in daily complex convective circulation system that is responsible for the absence of structure of daily variogram in certain days highly variable of precipitation amount at coast to coastline coastal to inland areas windward to leeward sides which depends on the conditions ogino et al 2016 smith et al 2012 leading to the absence of the structure in daily variogram however the possible existence of structure in the variogram can be detected with an appropriate method finkelstein 1984 therefore the aim of this research is to propose a new technique applying space time variogram for 3 successive daily rainfall in a day where the absence of structure in the daily variogram estimation was found at limited rain gauge networks the proposed method applied 3 successive daily rainfall e g not 2 or 4 days to build space time variogram to detect possible existence of variogram structure it is related to the behavior of cmorph8 which mostly have difficulty in detecting 3 days successive rainfalls in bali island at least 40 60 of miss rainfall events performed by cmorph8 is from the inability to detect these 3 days successive rainy events each of 35 daily ground rainfall estimates was compared with the corresponding of cmorph8 pixel within period 1 october 2003 30 september 2006 rahmawati and lubczynski 2018 to find this behavior cmorph25 and trmm 3b42 were also been compared with daily ground rainfall estimates however the specific behavior can clearly be detected in cmorph8 since this paper used the finer spatial scale of cmorph8 not the coarse spatial scale of cmorph25 to detect possible existence of variogram structure therefore from this point forward cmorph8 is called cmorph in order to obtain distributed gridded daily rainfall estimates the specific purposes of this research are as follows 1 daily blended rainfall estimates with space time variogram of 3 days successive daily rainfall and 2 validation of daily blended rainfall estimates using space time variogram of 3 successive daily rainfall with uncertainty analysis and sensitivity analysis 1 2 study area description the indonesian bali island is a mountainous tropical island that has various altitudes ranging from 0 to 3 028 m a s l bali island mostly has undulating rolling topography 66 of the area with slope ranging from 3 to 14 this island has a latitudinal mountain range of gunung agung that separates bali into two watershed divides northern and southern which has different rainfall characteristics the northern has an average annual rainfall of 1761 3 mm while the southern 2024 5 mm 2 methods 2 1 data and materials the 3 years data 1 097 days from 1 october 2003 to 30 september 2006 of daily rainfall from 45 rain gauge stations fig 1 obtained from research center for water resources locally known pusair and from indonesian agency for meteorology climatology and geophysics locally known bmkg was used to detect a days where there is the absence of variogram structure on daily basis daily variogram estimation was built for 1 097 days from 45 rain gauges to obtain gridded rainfall estimates over bali island from the total number of 1 097 sample days it was detected that there are 398 number of days that no possible existence of structure in the daily variogram the possible existence of structure in the variogram for 398 days is carried out applying space time variogram of 3 successive daily rainfall four interpolation methods were performed to obtain gridded rainfall estimates for these 398 days these interpolation methods consisted of ordinary kriging ok regression kriging with cmorph as an additional variable cm regression kriging with blended monthly cmorph as an additional variable mont and regression kriging with trmm as an additional variable tr then the original of cmorph cm or and trmm tr or retrievals was also compared with gridded blended rainfall estimates as control points cm or and tr or were not assessed in cross validation and sensitivity analysis 30 minutes cmorph was aggregated into daily basis and resampled into 1 km2 grid size cmorph gridded rainfall is generated every 30 min at 0 0727 0 0727 degrees lat lon fig 1 as a merged product of infra red ir and passive micro wave pmw images using lagrangian interpolation to morph pmw datasets janowiak et al 2005 joyce et al 2010 it is available at global coverage at 60 n 60s total 50 rain gauges with monthly data at the same period from 1 october 2003 to 30 september 2006 were used to define monthly blended ground rainfall estimates with cmorph rainfall estimates five additional rain gauge stations with monthly data fig 1 were available for interpolation the 30 minutes cmorph is aggregated into monthly basis and resampled into 1 km2 grid size to be blended with monthly gauge rainfall estimates trmm 3b42 trmm is a product of trmm 2a25 precipitation radar with infrared precipitation estimates the monthly total from trmm was used to calibrate infrared precipitation estimates from three hours temporal resolution of geostationary operational environmental system ward et al 2011 trmm has a temporal resolution of 3 h and a spatial resolution of 0 25⁰ huffman et al 2010 the trmm data covers over tropics between 30⁰ n and 30⁰s ward et al 2011 the dataset for validation includes measurement from 2 independent rain gauges for which one of them has missing data these gauges are a ngurah rai with complete 3 years data period b tiying gading with missing data of 31 days within period 1 october 31 december 2003 the maximum and minimum daily temperature from climatology station of ngurah rai also used to assess sensitivity analysis with the volume of gridded blended rainfall estimates in bali island 2 2 methodology it is necessary to find an appropriate method to obtain the possible existence of variogram structure to generate gridded rainfall estimates for advances application and many purposes in water resources related studies in bali island in total 398 days from 1 097 days 1 october 2003 to 30 september 2006 was identified no possible existence of spatial structure in the daily variogram the absence of spatial structure in the daily variogram within a period of 1 097 days was detected applying variogram estimation with three cutoff and width scenarios the three scenarios of cutoff and width were a 58 500 m and 5 000 m b 60 000 m and 4 500 m c 60 000 m and 4 200 m these 3 scenarios of cutoff and width were used to acquire a sufficient number of points pairs in every distance class minimum 30 journel and huijbregts 1978 spherical and exponential models were used to fit variogram estimation space time variogram from 3 successive daily rainfall was estimated to build possible existence of spatial structure in variogram for each 398 days regression kriging with cmorph as an additional variable cm regression kriging with blended monthly cmorph as an additional variable mont and regression kriging with trmm as an additional variable tr was applied to obtained gridded blended rainfall estimates daily rainfall interpolation applying ordinary kriging ok was also performed as an additional sensitivity test when there are no additional variables in blended rainfall estimates kebaili bargaoui and chebbi 2009 the formula for ordinary kriging is illustrated as in equation 1 while the formula for regression kriging is expressed as in equations 2 and 3 feki et al 2012 hengl et al 2007 moral 2010 the formula of space time variogram estimation is expressed in equation 4 modifying from sterk and stein 1997 the data from 3 successive days of rainfall was combined only not standardized as in equation 4 in sterk and stein 1997 the example of this new modified method is shown in fig 2 1 z x 0 i 1 n λ i z x i where z x0 is rainfall prediction at location x0 rainfall sample data at location xi x2 xn weight λi depends on spatial autocorrelation structure of the variables this weight is selected a minimized prediction error variance 2 z rk x m x r x where zrk x is daily rainfall at point prediction of x m x is the trend that is fitted using linier regression at point prediction of x and the r x is the residuals at point prediction of x that is estimated using ordinary kriging therefore for the n sample points the prediction of zrk x is 3 z rk x j 0 p c j v j x i 1 n w i x r x i v 0 x 1 where the coefficients of estimated trend model is c j the jth predictor at location is vj x the number of predictors is p the weights determined by solving the ordinary kriging system of the regression residuals is r xj 4 γ 1 2 n h t 1 t i 1 n t h z it z i h t 2 where γ is variogram for a days where there is no spatial structure of rainfall zit and zi h t is the ith pair of standardized rainfall observations at time t separated by vector h of which they are nt h the total number of pairs of points for each vector h is equal to n h t is 1th day successive daily rainfall and t is 3rd day of successive daily rainfall i is different spatial locations of the observations the space time variogram estimation and interpolation were performed in r software applying gstat package pebesma and heuvelink 2016 pebesma and wesseling 1998 space time variogram can improve the reliability of prediction by incorporating space time correlation varouchakis and hristopulos 2017 that provide probability framework for data analysis and prediction based on the joint spatial and temporal dependencies between observations zeng et al 2014 principal component analysis pca is also applied in r software to set daily cmorph monthly blended rain gauge cmorph and trmm as an independent variable in interpolation pca is a linear method to reduce the dimensionality of the data by transforming the initial variables into new variables i e the so called principal components while capturing the maximum information present in the data set and minimizing errors between the initial variables with new variables pca maps the original n dimensions variables of the data matrix x onto a new orthogonal space so that a new data orientation follows the direction of the largest variance in the data pca produces a visualization of the 2d relationship between variables and illustrates a group of subjects with similar characteristics demšar et al 2013 emmanuel et al 2012 the performance of daily gridded blended rainfall estimates was evaluated applying uncertainty analysis cross validation and sensitivity analysis the validation scheme applying cross validation and sensitivity analysis is separated into the rainy and dry season rainy season is from october march while april september dry season the uncertainty was carried out for each of the 45 rain gauges fig 1 which used for interpolation were compared with corresponding pixels of daily blended rainfall estimates applying probability of detection for rain podrain equation 5 and false alarm ratio far equation 6 following tang et al 2010 as shown in matrix in table 1 pod and far can evaluate the ability of a blended model to detect rainfall and the nature of the error cohen liechti et al 2012 ebert et al 2007 also pod rain can be used to detect the accuracy in estimating rainy events and to show the highest level of reliability and precision compared to other common metrics in categorical statistics while far is to detect the probable frequency in estimating rainfall both of them has the highest accuracy to detect transfer error in interpolation tang and hossain 2009 2011 the optimal value of pod is 1 while far 0 duan et al 2016 there is no separation analysis between rainy and dry season to evaluate gridded blended rainfall estimates with this validation scheme 5 pod r a i n n a n a n b 6 far n b n b n a cross validating the blended rainfall datasets was performed to evaluate the quality of rainfall estimates applying space time variogram of 3 successive daily rainfall cross validation is also called a leave one site out procedure which is a technique to remove one rain gauge and re estimate rainfall at removed rain gauge station at the remaining rain gauges in this method one rain gauge is disregarded from the dataset and other available rain gauges are used for rainfall estimation for each time step diodato 2005 rabiei and haberlandt 2015 schuurmans et al 2007 cross validation statistics of daily mean error me equation 7 and daily root mean square error rmse equation 8 from the difference between estimated value z and the observed value z1 diodato 2005 xi is the location at i or at station i then n is the number of observation 45 rain gauges is as below me and rmse in cross validation statistics are the common method to check the quality of interpolation the analysis was carried out in rainy and dry season separately 7 me 1 n i 1 n z x i z 1 x i 8 rmse 1 n i 1 n z x i z 1 x i 2 next the validation of daily gridded rainfall estimates is by comparing each of the 2 independent rain gauges fig 1 with corresponding pixels of daily blended rainfall estimates applying me mean error equation 9 rmse root mean square error equation 10 and cc coefficient correlation equation 11 as follows the analysis was carried out in rainy and dry season separately 9 me 1 n i 1 n r m i rg i 10 r m s e 1 n i 1 n rm i rg i 2 11 cc i 1 n rg i rg i rm i rm i i 1 n rg i rg i 2 i 1 n rm i rm i 2 where rm i is rainfall value based on blended rainfall estimation in day t at station i mm day 1 rgi is rainfall value based on rain gauge observation in day t at station i mm day 1 n is total number of observation 1 gauge the optimal value of me and rmse is 0 while cc 1 the sensitivity analysis was carried out for testing the daily gridded blended rainfall estimates corresponding to the volume of rainfall as the input for an integrated hydrological model ordinary kriging was used to check the changes in volume using the additional variable of cm mont and tr the formula to calculate volume is in equation 12 while sensitivity analysis formula is varying on input volume because of varying additional variable modified from lee and chung 2007 this volume was compared with maximum and minimum temperatures from the gauge that was not used for interpolation to check the sensitivity of interpolation method temperature can be used to test the performance of gridded blended rainfall estimates lee and chung 2007 and rainfall sensitivity polson et al 2016 minimum and maximum temperature were selected to test the sensitivity of gridded rainfall estimates because the daily temperature has a close relationship with daily rainfall berg et al 2015 rehfeld and laepple 2016 rainfall and temperature have a negative correlation in daily time scale in the tropics williams et al 2012 moreover changes in temperature effects total column water vapor moisture clouds and total rainfall lauer et al 2013 strauch et al 2015 12 v t pm t x a where vt is the volume of rainfall in day t m3 day 1 pm t is merged rainfall estimates in day t mm day 1 and a is the area mm2 3 result and discussion the absence of rainfall structure in the daily variogram usually occurs in a day before or after heavy rainfall in bali island this heavy rainfall probably can be related to madden jullian oscillation mjo mjo influences deep convection and heavy rainfall in maritime continent kanamori et al 2018 including in bali and borneo islands especially in rainy season hidayat and kizu 2010 mjo especially has a stronger effect for a diurnal cycle in the coastal region compared to the inner region in borneo ichikawa and yasunari 2006 differences of rainfall peak migration from the coastline into inner region result in highly variable of daily rainfall in space and time mori et al 2004 which probably leading to the absence of rainfall structure in daily variogram in total 398 days is no possible existence of structure in the daily variogram from the total number of sample days 1097 within the period of 1 october 2003 to 30 september 2006 the analysis of these 398 days could be separated into the rainy and dry season the rainy season consisted of rainy season 1 1 october 2003 31 march 2004 rainy season 2 1 october 2004 31 march 2005 and rainy season 3 1 october 2005 31 march 2006 the number of absence in variogram structure in rainy season 1 2 and 3 respectively 65 days 53 days and 50 days the dry season consisted of dry season 1 1 april 30 september 2004 dry season 2 1 april 30 september 2005 and dry season 3 1 april 30 september 2006 with the number of absence in variogram structure respectively 61 days 71 days and 98 days 3 1 uncertainty analysis fig 3 presents the probability of detection pod of rainy events between ok cm cm or mont tr and tr or against 45 rain gauges within 398 days in bali island the distribution of ok pod is quite similar at coastal inner and mountainous areas indicating that ok has a comparable probability to detect rainy events in any part of the study area the value of pod is mostly low which more than 50 of pod value is 0 5 additionally ok is mostly not capable to detect greater than 70 precipitation events indicating ok has the lowest level of reliability and precision in detecting rainy events in contrast with ok cm has a larger probability to detect rainy events the pod of cm is mostly between 0 5 and 0 7 only 15 is 0 5 and 17 is 0 7 cm also significantly shows improvement in estimating rainfall when it compared with cm or at least 22 of low pod values 0 5 decreases in cm when cm or was blended with rain gauge data cm is also more capable to detect 70 precipitation events than cm or this detection ability approximately increases 75 from the total of the sample observation the distribution of cm pod illustrated it has a good performance at inner and mountainous areas than at coastal areas there is no improvement in pod value of 0 5 in coastal areas when cm compared to cm or the coastal pod values also can be lower than 0 5 cm is not a good performance at coastal areas because pmw sensors of cmorph mask out emission signal from coastline areas in case the emission signal comes from the land janowiak et al 2005 so cmorph estimates rainfall based on where the emission of the signal originates from land or sea cm also performs better in rainfall estimation than mont especially at the mountainous area similar case with tr cm has better accuracy than tr however mont and tr pod values show improvement than cm or and tr or reflecting higher accuracy of rainfall estimates to blend rain gauge with satellite data in general the gridded rainfall estimates of cm performs the best in detecting rainy events while ok the worst the satellite data improves rainfall estimation resulting in better performance the gridded rainfall estimates of cm tr and mont compared to ok the four interpolation performs relatively similar with pod 0 5 which mostly occurs in the coastal area there is a possibility that the life cycle of diurnal precipitation from the coast coastline to landward at coastal areas had large variation kikuchi and wang 2008 this condition cannot be predicted by all four interpolation methods therefore the pod values are low moreover rapid growth phase of intense precipitation from the seaside of coastal to landside of coastal due to the different shifting time of rainfall event and rainfall amount at a different location of the island resulting in an error of rainfall estimation saito et al 2001 fig 4 shows false alarm ratio far between ok cm cm or mont tr and tr or against 45 rain gauges within 398 days in bali island there is a clear evident that satellite data can improve the accuracy of gridded rainfall estimates the accuracy of blended cm and tr is larger compared to satellite data only cm or and tr or the far values of cm and tr decrease compared to cm or and tr or cm or also performs better than rain gauge data only ok to obtain gridded rainfall estimates the performance of interpolation methods can be clearly ranked as follows cm tr mont ok then the value of far between satellite data and rain gauge data is as follows tr or ok cm or reflecting that cm or best performance the spatial distribution of far shows the rainfall estimates have better performance at windward than at leeward the number of far values is comparable for 0 6 at windward and leeward sides although the number of observation is larger at windward than leeward the improved performance of blended models i e cm mont and tr are lower at the leeward than at windward sides when they are compared to rainfall estimates from the gauge data only and satellite data only i e cm or ok and tr or it is related to the difficulty of the algorithm to detect rainfall at leeward location because extensive rain frequently does not occur the occurrence of this extensive rain depends on stabilization of convection forced descent and wave breaking while at windward heavy rainfall will occur as the slope increase kirshbaum and smith 2009 the cross validation me and rmse boxplot made for ok cm mont and tr are presented in figs 5 and 6 in a rainy and dry season respectively fig 5 shows that all four interpolation methods underestimate rainfall in both rainy and dry season the differences performance of all of the four gridded rainfall estimates is not significantly clear except in rainy season 3 and dry season 1 the superiority performance among all four methods does not show obviously the four interpolation methods underestimate precipitation with an average me value ranging from 0 06 to 0 08 mm day 1 in rainy season while 0 05 to 0 07 mm day 1 in dry season the tendencies of underestimation by all of the interpolation method because of underestimation of strong rainy events the general trend evident of fig 6 is that using root mean square error as validation measure there are no significant differences performance observed across various interpolation method it is related to cm generally performs better than ok tr and mont in the magnitude of 1 2 mm day 1 the rmse distribution is mostly below 20 mm day 1 which is much lower than average daily rainfall 48 mm day 1 within this period in bali island the validation of four interpolation methods i e ok cm mont and tr including satellite data only i e cm or and tr or applying me is presented in fig 7 for 2 rain gauges separately in a rainy and dry season during most of the period there is an underestimation in rainfall values from all interpolation methods and all satellite data products in rainy and dry season the maximum daily rainfall is 120 mm in both stations in rainy season while the maximum daily rainfall can be captured by cm or tr or and ok is 102 102 and 99 2 mm respectively resulting in an underestimation of rainfall in most of the period of simulation ok shows close performance to cm and mont but with underestimation of peak rainy events and overestimation of low rain rate in rainy and dry seasons although ok and cm perform better than mont tr outperforms ok cm and mont mirroring from the pattern observed in orange lines of me with respect to cm or and tr or cm and tr significantly improve the accuracy estimation of precipitation the magnitude of underestimation and overestimation for cm or and tr or decrease in cm and tr the large value of me in cm or can be dropped significantly in cm which means the finer resolution of cm or performs better than courser resolution of tr or to be blended with ground rainfall estimates all four interpolation methods have a tendency to underestimate rainfall estimates because the algorithms have difficulty to detect heavy rain rate that do not occur at the same time in any part of the island rainfall is suppressed over the island the morning but strong convection develops in offshores dropping much rain which is the opposite in the evening where over the island dropping much rain ichikawa and yasunari 2006 resulting in all interpolation methods underestimates rainy events sato et al 2009 it is clearly presented in coastal area gauge station ngurah rai and inner region gauge station tiying gading the peak of underestimation occurs differently within the time period of simulation in both stations the validation of the proposed methods applying rmse is presented in fig 8 for 2 rain gauges separately in a rainy and dry season the rmse graph shows that the four interpolation methods are quite similar to each other in each gauge the rmse of ok cm tr and mont is mostly overlapping each other emphasizing small value differences of rmse in the range of 0 1 0 4 mm day 1 the similarity performance of these four interpolation methods also can be identified from the large of rmse values in certain days which can be in transition wettest or driest months it is likely because the highly variable rainfall in these days at coastal at inner and mountainous areas could not be predicted correctly resulting in large rmse value the performance of four interpolation methods at individual gauges ngurah rai and tiying gading stations shows large rmse in certain days in the rainy and dry season at ngurah rai the coastal station the large rmses occur on the wettest month of january in rainy season while in dry season no specific month at tiying gading station the inner station there is no specific indication in which months of certain days have large rmse it is probably a lot of factor influence rainfall events at inner than at coastal area such as land sea breeze from the south and the breeze from mountain range in the north concavity of the land sea kikuchi and wang 2008 therefore a lot of extensive rain could not be predicted in a specific day at inner area scatterplots of daily coefficient correlation for all gridded rainfall estimates againt 2 rain gauge data are shown in fig 9 in rainy and dry season separately 1st row is ngurah rai 2nd row is tiying gading cm and ok capture such patterns with a higher coefficient correlation compared to others however cm performs better than ok because ok has a lower coefficient correlation of 0 01 and 0 05 the largest coefficient correlation value of 0 8 is observed in the dry season it is because rainfall in indonesia is most predictable during dry season which is related to the lack of spatial coherence due to low latitude convective dynamics and non balanced flow regime in rainy season haylock and mcbride 2001 in addition fig 9 shows that the lowest coefficient correlation value of 0 0 is observed for tr it can be seen that there is a poor agreement between gridded rainfall estimates and rain gauge data with very low coefficient correlation in the certain time period in rainy and dry season it is because one two days erratic rainy events with rain rate 40 100 mm day 1 in transition season are measured by rain gauge while gridded rainfall estimates only predict 3 5 mm day 1 resulting in a low coefficient correlation of rainfall estimates in bali island it is in agreement with sanchez moreno et al 2014 that states a single strong rainy event can control daily rainfall in the time of simulation leading to a very low correlation coefficient it is also in agreement with prasetia et al 2013 that a daily rainfall has a coefficient correlation value of 0 16 0 58 for a local pattern because local effects are dominating rainfall haylock and mcbride 2001 while 0 07 0 52 for an equatorial pattern in indonesia prasetia et al 2013 it can be noticed also from fig 9 the cc values of cm and tr are lower compared to cm or and tr or at certain time only it is because the additional information from gauge data give a false rain rate estimation to the blended model it is because the spatial distribution of daily rainfall varies at the leeward windward coastal line coastal areas an inner region and mountain area it depends on a lot of factors such as mountain width kirshbaum and smith 2009 and distance from the sea sato et al 2009 3 2 sensitivity analysis the sensitivity of interpolation cm mont and tr against the minimum and maximum temperatures applying space time variogram from 3 successive daily rainfall is displayed in fig 10 three of them have sensitivity with maximum and minimum temperatures reflecting that the three interpolation methods are a good performance to detect the possible existence of variogram structure it also can be concluded that additional information of rainfall from satellite data can improve the performance of gridded rainfall estimates all three methods are more sensitive to maximum temperature than the minimum temperature in both rainy and dry season generally gridded rainfall estimates have a negative correlation with temperature for instance higher rainfall is associated with lower temperature in term of the sensitivity of gridded rainfall estimates against temperature cm performs the best followed by mont and tr cm mont and tr also show a good agreement in dry season compared to rainy season because there is possibility rainfall in dry season is more convective in nature 4 conclusion the absence of structure in daily variogram can be built applying space time variogram from 3 successive daily rainfall all four interpolation methods have a weakness to estimate strong rainy events among the other interpolation methods cm has the best consistency in estimating rainfall achieving the best performance in most of the assessment metrics several points can be concluded as follows a cm perform better than ok indicating that gridded daily rainfall estimates in this island require additional information such as satellite data to improve rainfall estimates b cm performs better than tr reflecting that high spatio temporal variability of daily rainfall requires finer spatial resolution c ok mostly performs better than cm or and tr or while cm or and tr or performs better than ok in certain time indicating that gridded rainfall estimates should take into account both rain gauge data and satellite data further research to improve gridded daily rainfall estimates should be performed in bali island for estimating rainfall input for hydrological modeling since spatial variability of rainfall influences in the accuracy of streamflow prediction nguyen et al 2018 the improvement of gridded daily rainfall estimates can be obtained from wind factor and distance from the sea since four interpolation methods have low accuracy in the leeward and coastal area the spatial stratification of interpolation at coastal area inner and mountainous areas probably also can improve gridded daily rainfall estimates beek et al 1992 however limited rain gauge networks in each spatial stratification can be an obstacle to detect the existence of structure in variogram on daily basis it is also recommended to evaluate gridded daily rainfall estimates with both spatial stratification of the study area and space time variogram from 3 successive daily rainfall to solve the absence of structure in daily variogram due to highly variable of spatio temporal rainfall in bali it is also recommended to improve gridded daily rainfall estimates to finer scale rain gauge data to analyze erratic and strong rainy events because of the diurnal cycle of precipitation in the mountainous tropical island of bali declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to thank indonesia endowment fund for education lpdp to finance this research special thanks also to maciek w lubczynski and z su for an interesting discussion about rainfall topics moreover the author would like to thank the master program on watershed and coastal management and planning mppdas faculty of geography gadjah mada university for the help during fieldwork and all institutions such as pusair and bmkg for the data collection the author gratefully acknowledges the comments from the anonymous reviewers that have helped to improve this manuscript 
5186,high spatio temporal variability of daily rainfall in bali island can create the absence of structure in the daily variogram in certain days this research proposes a new technique applying space time variogram for 3 successive daily rainfall to detect structure in variogram estimation by merging rain gauges and satellite data applying ordinary kriging ok regression kriging with cmorph cm regression kriging with trmm tr and blended monthly rainfall mont to obtain daily blended gridded rainfall estimates original retrieval of cmorph cm or and trmm tr or also used as control points to assess the proposed method uncertainty and sensitivity analysis including cross validation were carried out to validate the proposed method the result shows that a new technique adapted from cmorph specific character can be applied to detect the existence of structure in variogram blended gridded daily rainfall estimates of cm has highest probability detection of rainy events while ok the lowest generally the four interpolation methods ok cm mont tr have low accuracy at leeward and in a coastal area all of them have almost similar performance indicated by no clear distinction of rmse value from cross validation cm mont and tr have a good sensitivity with maximum and minimum temperature indicating that satellite data can improve the gridded rainfall estimates however it is required an improvement of daily gridded rainfall estimates since there are large rmse values and low coefficient correlation in certain days because of strong and erratic behavior of rainy events in a mountainous tropical island of bali keywords blended daily rainfall estimates cmorph space time variogram bali island 1 introduction 1 1 background as the rainiest places in the world mountainous tropical island is characterized by highly variable of daily precipitation cronin et al 2015 the presence of sea border mountain range and prevailing winds enhances the complexity of convective circulation system in this island leading to complex rainfall structure in space and time qian 2008 sato et al 2009 yokoi et al 2017 kriging is one of common methods to investigate rainfall structure in space time which is able to include linearity correlation with some parameters i e environmental condition of the island kyriakidis et al 2001 seo et al 2015 vajda and venäläinen 2003 satellite data li and shao 2010 velasco forero et al 2009 and extended to space time domain spadavecchia and williams 2009 one of kriging approach implementing a linear relationship between rainfall and these parameters is regression kriging hengl et al 2007 in regression kriging rain gauge data is as the source of primary variable and satellite data as an additional or secondary variable both data sources were merged to obtain distributed blended daily rainfall estimates velasco forero et al 2009 this merged technique takes advantages of the strength of both data sources satellite data can provide a spatial structure of rainfall in ungauged sites gebregiorgis and hossain 2013 woldemeskel et al 2013 because of time series data availability and area coverage irrespective of terrain or climate grimes 2008 rain gauge data provides true value in corresponding gauge location ebert et al 2007 the selection of satellite data to be merged with rain gauge data in a certain area depends on the performance of satellite data the spatio temporal resolution of satellite data the algorithm of satellite data geographic location and environmental condition of the study area cmorph the climate prediction center morphing method coarser resolution cmorph25 27 km2 grid size is the best performance in bali island rahmawati and lubczynski 2018 however cmorph finer spatial resolution cmorph8 8 km2 grid size was selected to blend with rain gauge data because this finer spatial resolution can provide more detail rainfall information in limited rain gauges networks clarke and buarque 2013 in bali island moreover blended monthly rainfall estimates from cmorph8 and rain gauge is also merged with daily rain gauge data to regionalize geographic and environmental condition of daily rainfall trmm tmpa tropical rainfall measuring mission multi satellite precipitation analysis 3b42 was used to obtain distributed blended daily rainfall estimates because it had lowest hits bias in estimating rainfall in bali island rahmawati and lubczynski 2018 bali island is a mountainous tropical island which has high spatial and temporal variability of daily rainfall rahmawati and lubczynski 2018 highly variable of rainfall in bali island is because of the mixture effect of land sea breeze and topography concavity of land windward leeward monsoon mean flows and gravity wave kikuchi and wang 2008 these conditions resulting in daily complex convective circulation system that is responsible for the absence of structure of daily variogram in certain days highly variable of precipitation amount at coast to coastline coastal to inland areas windward to leeward sides which depends on the conditions ogino et al 2016 smith et al 2012 leading to the absence of the structure in daily variogram however the possible existence of structure in the variogram can be detected with an appropriate method finkelstein 1984 therefore the aim of this research is to propose a new technique applying space time variogram for 3 successive daily rainfall in a day where the absence of structure in the daily variogram estimation was found at limited rain gauge networks the proposed method applied 3 successive daily rainfall e g not 2 or 4 days to build space time variogram to detect possible existence of variogram structure it is related to the behavior of cmorph8 which mostly have difficulty in detecting 3 days successive rainfalls in bali island at least 40 60 of miss rainfall events performed by cmorph8 is from the inability to detect these 3 days successive rainy events each of 35 daily ground rainfall estimates was compared with the corresponding of cmorph8 pixel within period 1 october 2003 30 september 2006 rahmawati and lubczynski 2018 to find this behavior cmorph25 and trmm 3b42 were also been compared with daily ground rainfall estimates however the specific behavior can clearly be detected in cmorph8 since this paper used the finer spatial scale of cmorph8 not the coarse spatial scale of cmorph25 to detect possible existence of variogram structure therefore from this point forward cmorph8 is called cmorph in order to obtain distributed gridded daily rainfall estimates the specific purposes of this research are as follows 1 daily blended rainfall estimates with space time variogram of 3 days successive daily rainfall and 2 validation of daily blended rainfall estimates using space time variogram of 3 successive daily rainfall with uncertainty analysis and sensitivity analysis 1 2 study area description the indonesian bali island is a mountainous tropical island that has various altitudes ranging from 0 to 3 028 m a s l bali island mostly has undulating rolling topography 66 of the area with slope ranging from 3 to 14 this island has a latitudinal mountain range of gunung agung that separates bali into two watershed divides northern and southern which has different rainfall characteristics the northern has an average annual rainfall of 1761 3 mm while the southern 2024 5 mm 2 methods 2 1 data and materials the 3 years data 1 097 days from 1 october 2003 to 30 september 2006 of daily rainfall from 45 rain gauge stations fig 1 obtained from research center for water resources locally known pusair and from indonesian agency for meteorology climatology and geophysics locally known bmkg was used to detect a days where there is the absence of variogram structure on daily basis daily variogram estimation was built for 1 097 days from 45 rain gauges to obtain gridded rainfall estimates over bali island from the total number of 1 097 sample days it was detected that there are 398 number of days that no possible existence of structure in the daily variogram the possible existence of structure in the variogram for 398 days is carried out applying space time variogram of 3 successive daily rainfall four interpolation methods were performed to obtain gridded rainfall estimates for these 398 days these interpolation methods consisted of ordinary kriging ok regression kriging with cmorph as an additional variable cm regression kriging with blended monthly cmorph as an additional variable mont and regression kriging with trmm as an additional variable tr then the original of cmorph cm or and trmm tr or retrievals was also compared with gridded blended rainfall estimates as control points cm or and tr or were not assessed in cross validation and sensitivity analysis 30 minutes cmorph was aggregated into daily basis and resampled into 1 km2 grid size cmorph gridded rainfall is generated every 30 min at 0 0727 0 0727 degrees lat lon fig 1 as a merged product of infra red ir and passive micro wave pmw images using lagrangian interpolation to morph pmw datasets janowiak et al 2005 joyce et al 2010 it is available at global coverage at 60 n 60s total 50 rain gauges with monthly data at the same period from 1 october 2003 to 30 september 2006 were used to define monthly blended ground rainfall estimates with cmorph rainfall estimates five additional rain gauge stations with monthly data fig 1 were available for interpolation the 30 minutes cmorph is aggregated into monthly basis and resampled into 1 km2 grid size to be blended with monthly gauge rainfall estimates trmm 3b42 trmm is a product of trmm 2a25 precipitation radar with infrared precipitation estimates the monthly total from trmm was used to calibrate infrared precipitation estimates from three hours temporal resolution of geostationary operational environmental system ward et al 2011 trmm has a temporal resolution of 3 h and a spatial resolution of 0 25⁰ huffman et al 2010 the trmm data covers over tropics between 30⁰ n and 30⁰s ward et al 2011 the dataset for validation includes measurement from 2 independent rain gauges for which one of them has missing data these gauges are a ngurah rai with complete 3 years data period b tiying gading with missing data of 31 days within period 1 october 31 december 2003 the maximum and minimum daily temperature from climatology station of ngurah rai also used to assess sensitivity analysis with the volume of gridded blended rainfall estimates in bali island 2 2 methodology it is necessary to find an appropriate method to obtain the possible existence of variogram structure to generate gridded rainfall estimates for advances application and many purposes in water resources related studies in bali island in total 398 days from 1 097 days 1 october 2003 to 30 september 2006 was identified no possible existence of spatial structure in the daily variogram the absence of spatial structure in the daily variogram within a period of 1 097 days was detected applying variogram estimation with three cutoff and width scenarios the three scenarios of cutoff and width were a 58 500 m and 5 000 m b 60 000 m and 4 500 m c 60 000 m and 4 200 m these 3 scenarios of cutoff and width were used to acquire a sufficient number of points pairs in every distance class minimum 30 journel and huijbregts 1978 spherical and exponential models were used to fit variogram estimation space time variogram from 3 successive daily rainfall was estimated to build possible existence of spatial structure in variogram for each 398 days regression kriging with cmorph as an additional variable cm regression kriging with blended monthly cmorph as an additional variable mont and regression kriging with trmm as an additional variable tr was applied to obtained gridded blended rainfall estimates daily rainfall interpolation applying ordinary kriging ok was also performed as an additional sensitivity test when there are no additional variables in blended rainfall estimates kebaili bargaoui and chebbi 2009 the formula for ordinary kriging is illustrated as in equation 1 while the formula for regression kriging is expressed as in equations 2 and 3 feki et al 2012 hengl et al 2007 moral 2010 the formula of space time variogram estimation is expressed in equation 4 modifying from sterk and stein 1997 the data from 3 successive days of rainfall was combined only not standardized as in equation 4 in sterk and stein 1997 the example of this new modified method is shown in fig 2 1 z x 0 i 1 n λ i z x i where z x0 is rainfall prediction at location x0 rainfall sample data at location xi x2 xn weight λi depends on spatial autocorrelation structure of the variables this weight is selected a minimized prediction error variance 2 z rk x m x r x where zrk x is daily rainfall at point prediction of x m x is the trend that is fitted using linier regression at point prediction of x and the r x is the residuals at point prediction of x that is estimated using ordinary kriging therefore for the n sample points the prediction of zrk x is 3 z rk x j 0 p c j v j x i 1 n w i x r x i v 0 x 1 where the coefficients of estimated trend model is c j the jth predictor at location is vj x the number of predictors is p the weights determined by solving the ordinary kriging system of the regression residuals is r xj 4 γ 1 2 n h t 1 t i 1 n t h z it z i h t 2 where γ is variogram for a days where there is no spatial structure of rainfall zit and zi h t is the ith pair of standardized rainfall observations at time t separated by vector h of which they are nt h the total number of pairs of points for each vector h is equal to n h t is 1th day successive daily rainfall and t is 3rd day of successive daily rainfall i is different spatial locations of the observations the space time variogram estimation and interpolation were performed in r software applying gstat package pebesma and heuvelink 2016 pebesma and wesseling 1998 space time variogram can improve the reliability of prediction by incorporating space time correlation varouchakis and hristopulos 2017 that provide probability framework for data analysis and prediction based on the joint spatial and temporal dependencies between observations zeng et al 2014 principal component analysis pca is also applied in r software to set daily cmorph monthly blended rain gauge cmorph and trmm as an independent variable in interpolation pca is a linear method to reduce the dimensionality of the data by transforming the initial variables into new variables i e the so called principal components while capturing the maximum information present in the data set and minimizing errors between the initial variables with new variables pca maps the original n dimensions variables of the data matrix x onto a new orthogonal space so that a new data orientation follows the direction of the largest variance in the data pca produces a visualization of the 2d relationship between variables and illustrates a group of subjects with similar characteristics demšar et al 2013 emmanuel et al 2012 the performance of daily gridded blended rainfall estimates was evaluated applying uncertainty analysis cross validation and sensitivity analysis the validation scheme applying cross validation and sensitivity analysis is separated into the rainy and dry season rainy season is from october march while april september dry season the uncertainty was carried out for each of the 45 rain gauges fig 1 which used for interpolation were compared with corresponding pixels of daily blended rainfall estimates applying probability of detection for rain podrain equation 5 and false alarm ratio far equation 6 following tang et al 2010 as shown in matrix in table 1 pod and far can evaluate the ability of a blended model to detect rainfall and the nature of the error cohen liechti et al 2012 ebert et al 2007 also pod rain can be used to detect the accuracy in estimating rainy events and to show the highest level of reliability and precision compared to other common metrics in categorical statistics while far is to detect the probable frequency in estimating rainfall both of them has the highest accuracy to detect transfer error in interpolation tang and hossain 2009 2011 the optimal value of pod is 1 while far 0 duan et al 2016 there is no separation analysis between rainy and dry season to evaluate gridded blended rainfall estimates with this validation scheme 5 pod r a i n n a n a n b 6 far n b n b n a cross validating the blended rainfall datasets was performed to evaluate the quality of rainfall estimates applying space time variogram of 3 successive daily rainfall cross validation is also called a leave one site out procedure which is a technique to remove one rain gauge and re estimate rainfall at removed rain gauge station at the remaining rain gauges in this method one rain gauge is disregarded from the dataset and other available rain gauges are used for rainfall estimation for each time step diodato 2005 rabiei and haberlandt 2015 schuurmans et al 2007 cross validation statistics of daily mean error me equation 7 and daily root mean square error rmse equation 8 from the difference between estimated value z and the observed value z1 diodato 2005 xi is the location at i or at station i then n is the number of observation 45 rain gauges is as below me and rmse in cross validation statistics are the common method to check the quality of interpolation the analysis was carried out in rainy and dry season separately 7 me 1 n i 1 n z x i z 1 x i 8 rmse 1 n i 1 n z x i z 1 x i 2 next the validation of daily gridded rainfall estimates is by comparing each of the 2 independent rain gauges fig 1 with corresponding pixels of daily blended rainfall estimates applying me mean error equation 9 rmse root mean square error equation 10 and cc coefficient correlation equation 11 as follows the analysis was carried out in rainy and dry season separately 9 me 1 n i 1 n r m i rg i 10 r m s e 1 n i 1 n rm i rg i 2 11 cc i 1 n rg i rg i rm i rm i i 1 n rg i rg i 2 i 1 n rm i rm i 2 where rm i is rainfall value based on blended rainfall estimation in day t at station i mm day 1 rgi is rainfall value based on rain gauge observation in day t at station i mm day 1 n is total number of observation 1 gauge the optimal value of me and rmse is 0 while cc 1 the sensitivity analysis was carried out for testing the daily gridded blended rainfall estimates corresponding to the volume of rainfall as the input for an integrated hydrological model ordinary kriging was used to check the changes in volume using the additional variable of cm mont and tr the formula to calculate volume is in equation 12 while sensitivity analysis formula is varying on input volume because of varying additional variable modified from lee and chung 2007 this volume was compared with maximum and minimum temperatures from the gauge that was not used for interpolation to check the sensitivity of interpolation method temperature can be used to test the performance of gridded blended rainfall estimates lee and chung 2007 and rainfall sensitivity polson et al 2016 minimum and maximum temperature were selected to test the sensitivity of gridded rainfall estimates because the daily temperature has a close relationship with daily rainfall berg et al 2015 rehfeld and laepple 2016 rainfall and temperature have a negative correlation in daily time scale in the tropics williams et al 2012 moreover changes in temperature effects total column water vapor moisture clouds and total rainfall lauer et al 2013 strauch et al 2015 12 v t pm t x a where vt is the volume of rainfall in day t m3 day 1 pm t is merged rainfall estimates in day t mm day 1 and a is the area mm2 3 result and discussion the absence of rainfall structure in the daily variogram usually occurs in a day before or after heavy rainfall in bali island this heavy rainfall probably can be related to madden jullian oscillation mjo mjo influences deep convection and heavy rainfall in maritime continent kanamori et al 2018 including in bali and borneo islands especially in rainy season hidayat and kizu 2010 mjo especially has a stronger effect for a diurnal cycle in the coastal region compared to the inner region in borneo ichikawa and yasunari 2006 differences of rainfall peak migration from the coastline into inner region result in highly variable of daily rainfall in space and time mori et al 2004 which probably leading to the absence of rainfall structure in daily variogram in total 398 days is no possible existence of structure in the daily variogram from the total number of sample days 1097 within the period of 1 october 2003 to 30 september 2006 the analysis of these 398 days could be separated into the rainy and dry season the rainy season consisted of rainy season 1 1 october 2003 31 march 2004 rainy season 2 1 october 2004 31 march 2005 and rainy season 3 1 october 2005 31 march 2006 the number of absence in variogram structure in rainy season 1 2 and 3 respectively 65 days 53 days and 50 days the dry season consisted of dry season 1 1 april 30 september 2004 dry season 2 1 april 30 september 2005 and dry season 3 1 april 30 september 2006 with the number of absence in variogram structure respectively 61 days 71 days and 98 days 3 1 uncertainty analysis fig 3 presents the probability of detection pod of rainy events between ok cm cm or mont tr and tr or against 45 rain gauges within 398 days in bali island the distribution of ok pod is quite similar at coastal inner and mountainous areas indicating that ok has a comparable probability to detect rainy events in any part of the study area the value of pod is mostly low which more than 50 of pod value is 0 5 additionally ok is mostly not capable to detect greater than 70 precipitation events indicating ok has the lowest level of reliability and precision in detecting rainy events in contrast with ok cm has a larger probability to detect rainy events the pod of cm is mostly between 0 5 and 0 7 only 15 is 0 5 and 17 is 0 7 cm also significantly shows improvement in estimating rainfall when it compared with cm or at least 22 of low pod values 0 5 decreases in cm when cm or was blended with rain gauge data cm is also more capable to detect 70 precipitation events than cm or this detection ability approximately increases 75 from the total of the sample observation the distribution of cm pod illustrated it has a good performance at inner and mountainous areas than at coastal areas there is no improvement in pod value of 0 5 in coastal areas when cm compared to cm or the coastal pod values also can be lower than 0 5 cm is not a good performance at coastal areas because pmw sensors of cmorph mask out emission signal from coastline areas in case the emission signal comes from the land janowiak et al 2005 so cmorph estimates rainfall based on where the emission of the signal originates from land or sea cm also performs better in rainfall estimation than mont especially at the mountainous area similar case with tr cm has better accuracy than tr however mont and tr pod values show improvement than cm or and tr or reflecting higher accuracy of rainfall estimates to blend rain gauge with satellite data in general the gridded rainfall estimates of cm performs the best in detecting rainy events while ok the worst the satellite data improves rainfall estimation resulting in better performance the gridded rainfall estimates of cm tr and mont compared to ok the four interpolation performs relatively similar with pod 0 5 which mostly occurs in the coastal area there is a possibility that the life cycle of diurnal precipitation from the coast coastline to landward at coastal areas had large variation kikuchi and wang 2008 this condition cannot be predicted by all four interpolation methods therefore the pod values are low moreover rapid growth phase of intense precipitation from the seaside of coastal to landside of coastal due to the different shifting time of rainfall event and rainfall amount at a different location of the island resulting in an error of rainfall estimation saito et al 2001 fig 4 shows false alarm ratio far between ok cm cm or mont tr and tr or against 45 rain gauges within 398 days in bali island there is a clear evident that satellite data can improve the accuracy of gridded rainfall estimates the accuracy of blended cm and tr is larger compared to satellite data only cm or and tr or the far values of cm and tr decrease compared to cm or and tr or cm or also performs better than rain gauge data only ok to obtain gridded rainfall estimates the performance of interpolation methods can be clearly ranked as follows cm tr mont ok then the value of far between satellite data and rain gauge data is as follows tr or ok cm or reflecting that cm or best performance the spatial distribution of far shows the rainfall estimates have better performance at windward than at leeward the number of far values is comparable for 0 6 at windward and leeward sides although the number of observation is larger at windward than leeward the improved performance of blended models i e cm mont and tr are lower at the leeward than at windward sides when they are compared to rainfall estimates from the gauge data only and satellite data only i e cm or ok and tr or it is related to the difficulty of the algorithm to detect rainfall at leeward location because extensive rain frequently does not occur the occurrence of this extensive rain depends on stabilization of convection forced descent and wave breaking while at windward heavy rainfall will occur as the slope increase kirshbaum and smith 2009 the cross validation me and rmse boxplot made for ok cm mont and tr are presented in figs 5 and 6 in a rainy and dry season respectively fig 5 shows that all four interpolation methods underestimate rainfall in both rainy and dry season the differences performance of all of the four gridded rainfall estimates is not significantly clear except in rainy season 3 and dry season 1 the superiority performance among all four methods does not show obviously the four interpolation methods underestimate precipitation with an average me value ranging from 0 06 to 0 08 mm day 1 in rainy season while 0 05 to 0 07 mm day 1 in dry season the tendencies of underestimation by all of the interpolation method because of underestimation of strong rainy events the general trend evident of fig 6 is that using root mean square error as validation measure there are no significant differences performance observed across various interpolation method it is related to cm generally performs better than ok tr and mont in the magnitude of 1 2 mm day 1 the rmse distribution is mostly below 20 mm day 1 which is much lower than average daily rainfall 48 mm day 1 within this period in bali island the validation of four interpolation methods i e ok cm mont and tr including satellite data only i e cm or and tr or applying me is presented in fig 7 for 2 rain gauges separately in a rainy and dry season during most of the period there is an underestimation in rainfall values from all interpolation methods and all satellite data products in rainy and dry season the maximum daily rainfall is 120 mm in both stations in rainy season while the maximum daily rainfall can be captured by cm or tr or and ok is 102 102 and 99 2 mm respectively resulting in an underestimation of rainfall in most of the period of simulation ok shows close performance to cm and mont but with underestimation of peak rainy events and overestimation of low rain rate in rainy and dry seasons although ok and cm perform better than mont tr outperforms ok cm and mont mirroring from the pattern observed in orange lines of me with respect to cm or and tr or cm and tr significantly improve the accuracy estimation of precipitation the magnitude of underestimation and overestimation for cm or and tr or decrease in cm and tr the large value of me in cm or can be dropped significantly in cm which means the finer resolution of cm or performs better than courser resolution of tr or to be blended with ground rainfall estimates all four interpolation methods have a tendency to underestimate rainfall estimates because the algorithms have difficulty to detect heavy rain rate that do not occur at the same time in any part of the island rainfall is suppressed over the island the morning but strong convection develops in offshores dropping much rain which is the opposite in the evening where over the island dropping much rain ichikawa and yasunari 2006 resulting in all interpolation methods underestimates rainy events sato et al 2009 it is clearly presented in coastal area gauge station ngurah rai and inner region gauge station tiying gading the peak of underestimation occurs differently within the time period of simulation in both stations the validation of the proposed methods applying rmse is presented in fig 8 for 2 rain gauges separately in a rainy and dry season the rmse graph shows that the four interpolation methods are quite similar to each other in each gauge the rmse of ok cm tr and mont is mostly overlapping each other emphasizing small value differences of rmse in the range of 0 1 0 4 mm day 1 the similarity performance of these four interpolation methods also can be identified from the large of rmse values in certain days which can be in transition wettest or driest months it is likely because the highly variable rainfall in these days at coastal at inner and mountainous areas could not be predicted correctly resulting in large rmse value the performance of four interpolation methods at individual gauges ngurah rai and tiying gading stations shows large rmse in certain days in the rainy and dry season at ngurah rai the coastal station the large rmses occur on the wettest month of january in rainy season while in dry season no specific month at tiying gading station the inner station there is no specific indication in which months of certain days have large rmse it is probably a lot of factor influence rainfall events at inner than at coastal area such as land sea breeze from the south and the breeze from mountain range in the north concavity of the land sea kikuchi and wang 2008 therefore a lot of extensive rain could not be predicted in a specific day at inner area scatterplots of daily coefficient correlation for all gridded rainfall estimates againt 2 rain gauge data are shown in fig 9 in rainy and dry season separately 1st row is ngurah rai 2nd row is tiying gading cm and ok capture such patterns with a higher coefficient correlation compared to others however cm performs better than ok because ok has a lower coefficient correlation of 0 01 and 0 05 the largest coefficient correlation value of 0 8 is observed in the dry season it is because rainfall in indonesia is most predictable during dry season which is related to the lack of spatial coherence due to low latitude convective dynamics and non balanced flow regime in rainy season haylock and mcbride 2001 in addition fig 9 shows that the lowest coefficient correlation value of 0 0 is observed for tr it can be seen that there is a poor agreement between gridded rainfall estimates and rain gauge data with very low coefficient correlation in the certain time period in rainy and dry season it is because one two days erratic rainy events with rain rate 40 100 mm day 1 in transition season are measured by rain gauge while gridded rainfall estimates only predict 3 5 mm day 1 resulting in a low coefficient correlation of rainfall estimates in bali island it is in agreement with sanchez moreno et al 2014 that states a single strong rainy event can control daily rainfall in the time of simulation leading to a very low correlation coefficient it is also in agreement with prasetia et al 2013 that a daily rainfall has a coefficient correlation value of 0 16 0 58 for a local pattern because local effects are dominating rainfall haylock and mcbride 2001 while 0 07 0 52 for an equatorial pattern in indonesia prasetia et al 2013 it can be noticed also from fig 9 the cc values of cm and tr are lower compared to cm or and tr or at certain time only it is because the additional information from gauge data give a false rain rate estimation to the blended model it is because the spatial distribution of daily rainfall varies at the leeward windward coastal line coastal areas an inner region and mountain area it depends on a lot of factors such as mountain width kirshbaum and smith 2009 and distance from the sea sato et al 2009 3 2 sensitivity analysis the sensitivity of interpolation cm mont and tr against the minimum and maximum temperatures applying space time variogram from 3 successive daily rainfall is displayed in fig 10 three of them have sensitivity with maximum and minimum temperatures reflecting that the three interpolation methods are a good performance to detect the possible existence of variogram structure it also can be concluded that additional information of rainfall from satellite data can improve the performance of gridded rainfall estimates all three methods are more sensitive to maximum temperature than the minimum temperature in both rainy and dry season generally gridded rainfall estimates have a negative correlation with temperature for instance higher rainfall is associated with lower temperature in term of the sensitivity of gridded rainfall estimates against temperature cm performs the best followed by mont and tr cm mont and tr also show a good agreement in dry season compared to rainy season because there is possibility rainfall in dry season is more convective in nature 4 conclusion the absence of structure in daily variogram can be built applying space time variogram from 3 successive daily rainfall all four interpolation methods have a weakness to estimate strong rainy events among the other interpolation methods cm has the best consistency in estimating rainfall achieving the best performance in most of the assessment metrics several points can be concluded as follows a cm perform better than ok indicating that gridded daily rainfall estimates in this island require additional information such as satellite data to improve rainfall estimates b cm performs better than tr reflecting that high spatio temporal variability of daily rainfall requires finer spatial resolution c ok mostly performs better than cm or and tr or while cm or and tr or performs better than ok in certain time indicating that gridded rainfall estimates should take into account both rain gauge data and satellite data further research to improve gridded daily rainfall estimates should be performed in bali island for estimating rainfall input for hydrological modeling since spatial variability of rainfall influences in the accuracy of streamflow prediction nguyen et al 2018 the improvement of gridded daily rainfall estimates can be obtained from wind factor and distance from the sea since four interpolation methods have low accuracy in the leeward and coastal area the spatial stratification of interpolation at coastal area inner and mountainous areas probably also can improve gridded daily rainfall estimates beek et al 1992 however limited rain gauge networks in each spatial stratification can be an obstacle to detect the existence of structure in variogram on daily basis it is also recommended to evaluate gridded daily rainfall estimates with both spatial stratification of the study area and space time variogram from 3 successive daily rainfall to solve the absence of structure in daily variogram due to highly variable of spatio temporal rainfall in bali it is also recommended to improve gridded daily rainfall estimates to finer scale rain gauge data to analyze erratic and strong rainy events because of the diurnal cycle of precipitation in the mountainous tropical island of bali declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to thank indonesia endowment fund for education lpdp to finance this research special thanks also to maciek w lubczynski and z su for an interesting discussion about rainfall topics moreover the author would like to thank the master program on watershed and coastal management and planning mppdas faculty of geography gadjah mada university for the help during fieldwork and all institutions such as pusair and bmkg for the data collection the author gratefully acknowledges the comments from the anonymous reviewers that have helped to improve this manuscript 
5187,ensemble learning el an alternative approach in the machine learning field offers an accurate reference evapotranspiration eto prediction which is of paramount significance for the hydrological studies and agricultural water practices although the fao 56 penman monteith pm equation is regarded as an ideal model for estimating eto its applicability is limited due to the absence of required climatic datasets in many regions of the world despite its significance only a few studies use the el algorithms for the eto prediction perspective in this study we contribute to fill this gap from a two fold way first we present the potential of new el random tree rt bagging and random subspace rs algorithms which were compared with two commonly used random forest rf and support vector machine svm algorithms for predicting daily eto with the climatic data limited humid region in bangladesh during 1983 2017 using a five fold cross validation scheme second we explore the role of contributing variables influencing eto change at the regional scale when a lack of climatic datasets tmax maximum temperature tmin minimum temperature and rs solar radiation as 3 input combinations obtained the reasonable precision for estimating eto in all climatic regions except for south central and south western regions compared to other state of arts models the rt model performed superior to predict eto in all input combinations followed by the rf bagging rs and svm considering less difficulty level high prediction accuracy more dependability and fewer computation costs of studied models rt and rf models have been suggested as the promising potentials for daily eto estimate in subtropical climate regions of bangladesh and also may be applicable worldwide in the similar climates the importance analysis from the rf model depicted that the wind speed u2 and solar radiation rs are the largest influential variables affecting the observed and predicted daily eto changes in bangladesh keywords bagging random tree random subspace subtropical humid climate ensemble model bangladesh 1 introduction appraising reference evapotranspiration eto is essential for effectively managing and designing agricultural hydrology the optimal irrigation scheduling plan and crop growth modeling feng et al 2017 karimi et al 2017 wang et al 2019 wu et al 2019 as a nexus of the hydrological and carbon cycles eto is influenced by crop yield and energy balance along with affecting ocean atmospheric circulation which subsequently influences climate change jung et al 2010 fan et al 2019 however direct estimation of eto through weighted lysimeters or eddy covariance is complicated time consuming and expensive irmak et al 2003 fan et al 2018 thus many empirical as well as semi empirical models e g temperature based mass transfer based and radiation based models are developed and proposed to estimate eto with specific climatic variables of these the fao 56 penman monteith model fao56 pm has been extensively employed as the reference model for different regions with diverse climatic conditions allen et al 1998 li et al 2018a with good accuracy and consistency the main advantage of the fao56 pm model is that it has taken into account both the principles of aerodynamics and thermodynamic components nevertheless fao56 pm model needs a diversity of meteorological variables for computing e g minimum as well as maximum air temperatures solar radiation relative humidity and wind speed tabari et al 2013 shiri et al 2014 chu et al 2017 fan et al 2018 which notably limits its universal application occasionally these climatic variables are incomplete or unavailable in a particular region traore et al 2010 data quality and difficulty in obtaining all the factors influenced by climatic variables can pose major hindrances on its application especially in developing countries like bangladesh for example bangladesh meteorological department bmd operates only 35 weather stations across bangladesh it should be noted that the bmd has no radiation station thus the current model for estimating the solar radiation by weather dataset is inaccurate fan et al 2020 in this case an alternative empirical model depending on the limited climatic dataset is required kisi and alizamir 2018 hence it is urgent to develop an alternative promising model that can estimate eto with high accuracy the estimation of eto is regarded as a set of complicated as well as nonlinear phenomena relying on a huge number of climate datasets fan et al 2018 it is difficult to make an empirical model to accurately explain all the nonlinear and complicated phenomena principally in the deficiency of several key climatic variables region specific application is the main drawback of the most empirical models kisi 2016 to overall this drawback research scholars have used artificial intelligence e g machine learning algorithms for estimating eto because the machine learning ensemble model can provide easy solutions for nonlinear and multi parameter functions and also there is no need to prior knowledge of input parameters kisi 2016 wang et al 2017 in the last two decades owing to their outstanding performance in confronting nonlinear interactions between the model input and output parameters machine learning ensemble algorithms have been widely employed to predict eto precisely in data limited areas feng et al 2016 jovic et al 2018 different machine learning ensemble models have been recommended to forecast eto in several climatic regions throughout the world e g 1 neuron based machine learning algorithms including artificial neural networks anns are the most popular and extensively employed models for eto forecasting traore et al 2016 ferreira et al 2019 other neuron based ensemble algorithms are generalized regression neural networks feng et al 2017 multi layer perception mlp traore et al 2016 extreme learning machine elm abdullah et al 2015 gocić et al 2015 feng et al 2016 and radial basis function neural networks rbf petković et al 2016 2 kernel based machine learning ensemble algorithms e g support vector machine svm tabari et al 2012 shiri et al 2014 mohammadrezapoura et al 2018 chen et al 2020 have been largely applied for eto prediction other kernel based models are least squares support vector machine lssvm kisi 2016 3 tree based machine learning ensemble algorithms are used for predicting eto recently e g m5 model tree m5tree rahimikhoob 2014 regression tree granata 2019 as well as random forest rf feng et al 2017 chen et al 2020 gradient boosting on decision trees with categorical features support catboost huang et al 2019 light gradient boosting machine lightgbm fan et al 2019 4 meta based machine learning ensemble algorithms are rarely employed for eto forecasting such as bagging granata 2019 and random sub space rs 5 other ensemble algorithms including multivariate adaptive regression splines mars mehdizadeh et al 2017 adaptive neuro fuzzy inference system anfis sanikhani et al 2019 gradient boost regression ponraj and vigneswaran 2019 fuzzy genetic models kisi and cengiz 2013 hybrid machine learning tikhamarine et al 2019 deep learning dl saggi and jain 2019 and neuro computing model banda et al 2017 among various machine learning ensemble algorithms the kernel based algorithms including svm have gained popularity for eto forecasting tabari et al 2012 however they are complicated and demand high computation costs hassan et al 2017 in contrast the meta based and tree based ensemble algorithms e g bagging random subspace rt and rf models have recently drawn researcher s attention as they are comparatively simple and accurate but robust algorithms and powerful ability in eto prediction hassan et al 2017 feng et al 2017 chen et al 2020 the earlier studies reported that kernel based svm outperformed than other machine learning ensemble models to estimate eto in the semi arid region of iran tabari et al 2012 humid region of china wen et al 2015 sub humid region of turkey kisi 2016 and sub tropical region of china wu and fan 2019 by contrast fan et al 2018 revealed the performance of kernel based and tree based models to predict daily eto and found that extreme gradient boosting xgboost and gradient boosting decision tree gbdt revealed high precision and stability in comparison with the kernel based elm and svm models in several climatic regions of china similarly the rf model provided better daily eto prediction than any other models in southwestern china feng et al 2017 wang et al 2019 and southern iran shiri 2018 the random forest rf has some advantages e g high forecasting accuracy incomplete number of user based variables and capability of avoiding over fitting problems wang et al 2019 in addition to this it can determine the relative importance of climatic variables nevertheless there is no other common consensus on the choice of the optimal model for eto prediction hence new models are required and should be verified this study presents the potentials of the latest ensemble learning models e g meta based bagging random tree and random subspace for daily eto prediction modeling because these ensemble learning models are scarcely applied for daily eto prediction particularly the meta based ensembles random subspace bagging and tree based ensemble random tree are novel approaches for soft computing that are employed to improve the forecasting accuracy of a single classifier for example a random subspace rs is an effective meta based algorithm for developing ensembles that aid from bootstrap and combination kuncheva et al 2010 dong et al 2020 similar to the rs the bagging ensemble algorithm is one of the most population ensemble learning models that can give superior performance in solving the non linear problem roshan and asadi 2020 in bagging classifiers are learned in parallel via each training dataset as the bag which is developed by using bootstrap breiman 1996 meta based bagging algorithm is more competent than boosting based algorithms khoshgoftaar et al 2010 dong et al 2020 conversely a random tree rt is a modified supervised tree based ensemble algorithm that produces a set of each learner mishra and ratha 2016 which is the amalgamation of random forest and bagging it helps address the existence of over fitting problems compared to the random forest with high accuracy landwehr et al 2005 the rt model can deal with regression as well as classification problems the major advantage of rt is that it can handle nonlinear multiple heterogeneous phenomena between the model input and output variables as so to reach high model precision mishra and ratha 2016 there are still several challenges in using ensemble learning models on the eto estimation studies that are difficult to solve first to the best of the authors knowledge the new robust ensemble models e g random tree bagging and random subspace have not yet been employed in hydrological researches especially in evapotranspiration modeling so far there exist no earlier studies that explored the possibilities and applicability of any of these new ensemble models there exists a distinct gap in the efficiency of machine learning ensemble models to forecast daily eto in several climatic sub regions of bangladesh therefore it is a key concern for investigating the new ensemble learning algorithms to bangladesh s environmental conditions to achieve satisfactory precision besides the accuracy of each new ensemble algorithm is diverse in various climatic regions because various contributing factors may be used hassan et al 2017 second there is no agreement on which algorithm is the best for eto prediction the fact that these ensemble learning algorithms have various structures and function distributions for the best climatic variables third the comparison between new ensemble learning algorithms rs bagging and rt and commonly used rf and svm models is yet to be comprehensively explored in the existing literature although high accuracy of eto prediction is the focal concern when using the soft computing model well steady and fewer computation costs are important for consideration hassan et al 2017 fourth although several studies have only concentrated on the significance of climatic variables affecting the observed eto that varies from climatic zone to zone thomas 2000 yang et al 2011 li et al 2018b duethmann and blöschl 2018 maček et al 2018 wang et al 2019 whether the most dominating climatic variables affecting the daily evapotranspiration system are less investigated in previous studies however the solutions to these issues remain uncertain therefore the present study focuses on solving these issues for selecting bangladesh as a case study area 1 to evaluate the performance of four input combination of climatic datasets on the precision of daily eto prediction in subtropical humid climatic regions of bangladesh 2 to develop the new two meta and tree based with one kernel based ensemble models such as bagging rs rt rf and svm to predict daily eto with the limited climatic dataset 3 to evaluate the predictive accuracy as well as stability of five ensemble models 4 to compare the computational costs of rt rs and bagging models with equivalent rf and svm models for computing daily eto and 5 to identify the contribution of the four climatic variables u2 hr rs tmax affecting the daily and predicted eto changes in bangladesh using the rf model 2 data and method 2 1 study area description bangladesh positioned in south east asia the world s largest deltaic country is placed in the gbm ganges brahmaputra meghna river basin rahman and islam 2019 most of its land area is low lying and the part of the southeast and northeast has some hilly areas geographically bangladesh encompasses between the 20030 n to 26045 n latitudes and 8800 e to 92045 e longitudes fig 1 there are seven climatic sub regions in bangladesh as shown in fig 1 the seven sub regions are i south eastern zone ii north eastern zone iii northern part of the northern zone iv north western zone v western zone vi south western zone and finally vii south central zone it enjoys a sub tropical monsoon climate characterized with 3 major seasons of monsoon pre monsoon and winter islam et al 2019 although bangladesh experiences a sub tropical humid monsoonal climate with northwestern region suffer drought frequently due to inadequate water resources annual mean rainfall less than 1200 mm western bangladesh has usually become drier compared to other regions in bangladesh islam et al 2017 it occupies the world s largest sea beach cox s bazar and largest mangrove forest sundarbans in its southern part climatic variability is a regular scenario it is thus accepted that accurate appraisal is a vital step for agricultural hydrological distribution and practices 2 2 data sources bangladesh meteorological department bmd has 43 weather stations across the country from which historical daily minimum and maximum temperature c mean relative humidity wind speed knots and sunshine h day 1 datasets of 9 stations were sourced in this study 9 weather stations from 7 climatic regions each climatic region occupies one station except south eastern and south central zone which occupy two stations were selected for eto calculation over the 35 years from 1983 to 2017 a brief geographical and meteorological description of our selected stations is found in table 1 extra terrestrial radiation ra wind speed at 2 m height u2 and global solar radiation rs cannot directly be measured by weather stations daily rs ra and u2 were estimated using the procedures recommended by allen et al 1998 with the available meteorological datasets 80 data were used in training and the remaining 20 data were used for testing a detailed flowchart of data management arrangement and analysis is found in fig 2 2 3 fao56 penman monteith equation several studies have been conducted to model evapotranspiration by machine learning algorithms from the popular instrument evaporation pan abghari et al 2012 rahimikhoob et al 2013 goyal et al 2014 kisi 2015 in recent decades research scholars have preferred to estimate the reference evapotranspiration eto from available daily meteorological data by using the equation proposed by allen et al 1998 for eto prediction wen et al 2015 martí et al 2015 wu and fan 2019 wu et al 2019 wang et al 2019 valle júnior et al 2020 our study estimated the eto by using available daily meteorological data employing the fao56 pm recommended equation rather than using the data of eto measured from an evaporation pan another justification for estimating eto is that till now bmd does not provide eto data this model fao56 pm equation is renowned as the standard model for estimating eto across the world which was proposed by allen et al 1998 the fao56 pm model expressed as et0 0 408 δ r n g γ 900 t 273 u 2 e s e a δ γ 1 0 34 u 2 1 where eto is reference evapotranspiration mmd 1 r n is net radiation at the crop surface mj m 2 d 1 g is soil heat flux density mj m 2 d 1 t is mean daily air temperature at 2 m height c u 2 is wind speed at 2 m height m s 1 e s is saturation vapour pressure kpa e a is actual vapour pressure kpa e s e a i s saturation vapour pressure deficit kpa δ is slope of vapour pressure curve kpa c 1 γ is psychrometric constant kpa c 1 allen et al 1998 recommended g 0 the detailed procedures of eto estimation is found in fao 56 paper allen et al 1998 rn is calculated by the eqs 2 11 2 rn rns rnl 3 rns 1 α rs 4 r s a s b s n n r a 5 r a 24 60 π g s c d r ω s s i n φ s i n δ c o s φ c o s δ s i n ω s 6 d r 10 033 c o s 2 π 365 j 7 δ 0 409 s i n 2 π 365 j 1 39 8 ωs arccos tan φ tan δ 9 radians π 180 decimal degrees 10 r n l σ t m a x k 4 t m i n k 4 2 0 34 0 14 e a 1 35 r s r s o 0 35 11 r s a 0 75 2 x 10 5 z r a u2 is calculated from the following eq 12 recommended by allen et al 1998 12 u 2 u z 4 87 i n 67 8 z 5 42 where rns denotes shortwave radiation mj m 2 d 1 rnl denotes longwave radiation mj m 2 d 1 rs denotes global solar radiation mj m 2 d 1 n means maximum possible sunshine duration and n means actual possible sunshine duration ra means extraterrestrial radiation mj m 2 d 1 gsc 0 0820 mj m 2 min 1 indicates solar constant ωs means sunset hour angle rad dr indicates inverse relative distance earth sun latitude rad denotes by φ δ represents solar declination rad j is the julian number of day in a year σ 4 903 10 9 mj k 4 m 2 d 1 indicates stefan boltzmann constant α α 0 23 is albedo tmaxk and tmin k are respectively maximum and minimum absolute temperatures during 24 h and rso means solar radiation in a clear sky mj m 2 d 1 allen et al 1998 recommended 0 25 for as and 0 50 for bs uz means wind speed at zm above from ground surface m s 2 and z is respective station elevation above sea level m 2 4 ensemble learning algorithms for estimating daily eto 2 4 1 bagging bagging a meta based decision tree is an effective simple popular and useful ensemble learning algorithm roshan and asadi 2020 breiman 1996 first introduced this decision tree the bagging creates sampling subsets by randomly training set of the sample and then utilized these attained subsets to train the basic algorithm for combination the training of the basic algorithm in the bagging is carried out in a parallel way bagging is used for both the classification as well as regression dong et al 2020 it is the function of using the bootstrap of the original training dataset n the classifiers trained with training datasets are considered as the base classifiers in the testing stage the input datasets are predicted by base classifiers it is a powerful ensemble model as it never over fitting on the training dataset 2 4 2 random forest rf it is a tree based supervised ensemble learning model proposed by breiman 2001 breiman improved the bagging models to rf it is used for predicting as well as regression problems it is a simple and robust model plus prediction accuracy compare to the adaboost the error produced by rf is depended based on individual trees the rf model trains various decision trees from two viewpoints one is the sample dimension and another one is the feature dimension dong et al 2020 as a consequence it improves the problem that decision trees are closed to over fitting by combining voting outcomes of various decision trees the training of the basic algorithm in the rf model is parallel as like as the bagging model the rf model gives forecasting with high precision without over fitting data set for modeling of hydrological features breiman 2001 for more detailed about the rf ensemble algorithm the reader is referred to hastie et al 2009 hassan et al 2017 feng et al 2017 rahman and islam 2019 as a tree based ensemble algorithm it is essential to appraise the importance degree of the climatic variables based on the rf model wang et al 2019 in the present study the rf model was used in estimating daily eto as well as identifying the contributing climatic variables for estimating daily eto changes the importance degree of climatic variables was computed by calculating the decrease in forecasting accuracy resulting from randomly assigned the values of a climatic variable 2 4 3 random subspace rs the rs model is a semi supervised meta based algorithm similar to bagging requiring parameters of ensemble size l as well as feature subset m kuncheva et al 2010 this model is called random forest when combined with bagging this model is in addition used for building support vector machine svm linear classifiers and so one this is an attractive model as the number of training points is less than the features the rs model develops a set of feature subspaces through randomly sampling characteristics and then trains basic algorithms in these subspaces to create numerous outcomes before being merged into the ultimate outcomes ho 1995 dong et al 2020 the basic algorithm in the rs is also trained in a parallel manner 2 4 4 random tree rt the rt model is a modified supervised ensemble learning algorithm that produces lots of individual classifiers this tree based classifier model was pioneered by leo breiman and adele cutler kalmegh 2015 the rt model is an ensemble of tree predictors which is also known as a forest this model is not only used for regression but also for classification problems it is the combination of two ensemble learning algorithms as rf and bagging it utilizes a bagging concept to generate a random sampling data set for producing the decision trees in an ideal tree each node is fragmented using the optimal fragment among individual variables a good prediction score can be originated by using this model compared to other ensemble models this ensemble learning method has some advantages in terms of precision consistency and generalization in comparison with other ensemble algorithms this rt model is utilized to solve non linear problems such as data mining studies mishra and ratha 2016 the more detailed of this rt model can be found elsewhere yali and donald 1997 mishra and ratha 2016 2 4 5 support vector machine svm the svm model is a kernel based supervised learning algorithm introduced by vapnik 1995 that is intended to generate the best separating hyper plane between different categories hastie et al 2009 it is applied for prediction in addition to regression problems in the fields of meteorology hydrology environmental sciences chen et al 2014 it can convert lower input datasets into higher dimensional features different categories of classification functions were employed such as exponential kernel chen et al 2014 radial basis function kernel rbfk gayen et al 2019 linear kernel and polynomial kernel amiri et al 2019 of these an exponential kernel function developed by gholami et al 2020 was utilized in this study the furthermore details of the svm can be found in the literature hastie et al 2009 gholami et al 2020 the aforementioned 5 models were utilized for modeling after optimizing the parameters of these algorithms several techniques exist for parameter optimization which is known as tuning one of the popular techniques for parameter optimization or tuning is grid search this study used the grid search technique for tuning which is very much essential for knowing the accuracy of the respective models and its performances only the models on respective input combinations which showed good accuracy more than 85 used in the present study for eto forecasting optimized parameters were used for 5 models which are shown in table 4 2 5 input combination and cross validation several input combinations were tested for knowing its accuracy before eto forecasting a tmax tmin latitude julian date hr b tmax tmin rs u2 hr c tmax tmin ra u2 hr d tmax tmin hr e tmax tmin rs f tmax tmin ra g tmax tmin latitude julian date and h tmax tmin were tested by using grid search among the 8 combination inputs only four input combinations showed preferable accuracy more than 85 for eto forecasting which were utilized in this study and the remaining 5 input combinations were omitted for eto forecasting as it showed very poor accuracy four input combination datasets which were used in this study for estimating daily eto as shown in the table 2 the four input datasets were c1 tmax tmin rs u2 hr c2 tmax tmin ra u2 hr c3 tmax tmin rs and c4 tmax tmin ra during 1983 2017 in this study 5 fold cross validation was undertaken the complete meteorological datasets of 1983 2017 were divided into 5 equal stages for cross validation as shown in the table 3 four stages were meant for training and remaining one was meant for testing in every application testing stage was changed and all the models were tested at 5 stages 2 6 performance evaluation of five machine learning models performance evaluation of five machine learning models based on the precision of each model for estimating daily eto was undertaken by four statistical indicators these four statistical indicators were correlation coefficient r2 root mean square error rmse mean absolute error mae despotovic et al 2015 and mean absolute percentage error mape kim and kim 2016 the statistical indicators are expressed by the following four equations eqs 2 5 2 r 2 i 1 n y i m y i e 2 i 1 n y i m y i e 2 3 rmse 1 n i 1 n y i m y i e 2 4 mape 1 n i 1 n y i m y i e y i m 5 mae 1 n i 1 n y i m y i e where y i m y i e and n is the observed eto predicted eto and total observations respectively higher the values of r square more the model accuracy the value of r square is ranged from 0 to 1 if the value of r square is 1 then it indicates there is no error in building that model and higher performance evaluation the lower values of rmse mape and mae indicate the higher performance evaluation of the models 3 results 3 1 meteorological condition daily average relative humidity minimum temperature maximum temperature wind speed at 2 m height net radiation evapotranspiration across the country are respectively 80 21 39 c 29 94 c 1 32 m s 1 10 44 mj m 2 d 1 and 3 72 mm d 1 long term 1983 2017 historical average monthly distribution of tmax tmin ra rs hr and u2 is shown in fig 3 the low temperature both tmax and tmin reported in january and december while the high minimum temperature found in june july and august and the higher maximum temperature recorded in april and may fig 3a monthly mean tmax was comparatively higher than tmin during the observation period except for july both extra terrestrial radiation and global solar radiation varied with a similar pattern except for the months of april and june the highest global solar radiation found in april and the maximum extra terrestrial radiation detected in may fig 3b about 85 86 relative humidity observed in july august and september and low relative humidity less than 70 but more than 65 found in march fig 3c january february october november and december experienced the low wind speed 1 04 1 21 m s 1 while may june and july showed the maximum wind speed 2 3 2 4 m s 1 fig 3d 3 2 performance evaluation of five ensemble models under four input combination the statistical results of five novel machine learning models bag rf rs rt and svm at nine stations bogura dhaka jashore mymensingh patuakhali rajshahi rangamati rangpur and sylhet for predicting daily reference evapotranspiration eto of both the training and testing phases under four input combinations are shown in the tables 5 7 approximately similar statistical results have been found in all the stations and brief performance evaluation of rangpur of five models is presented in this study statistical results tables 5 7 of all stations showed that the rt model has the higher values of r2 and lower values of rmse and mae for both the training and testing phases followed by rf bag and rs whereas svm showed the lowest performance among the five models for predicting daily eto bag and rs are the third and fourth well performed models respectively except for dhaka and jashore all the models showed high performance accuracy higher values of r2 lower values of rmse and mae in the first input dataset of c1 tmax tmin u2 rs hr in dhaka bag and rs showed high performance accuracy in the second input dataset of c2 tmax tmin ra u2 hr and in jashore bag and rf showed high performance accuracy in the second input dataset of c2 table 5 c2 tmax tmin ra u2 hr c3 tmax tmin rs and c4 tmax tmin ra are respectively 2nd 3rd and 4th well performed input datasets respectively table 5 7 also showed the mape of all stations of five models under four input combinations depicting rt is the best model for all stations under all input combinations align with the r2 rmse and mae mape indicates that the c1 dataset provides high predicting accuracy c2 c3 and c4 combinations provide second third and fourth performance accuracy respectively for predicting daily eto the standard deviation of daily eto values estimated by fao56 pm and five machine learning models of all stations of four input combinations presented in the supplementary section of fig s1 fig s1 depicted those standard deviations of eto values estimated by fao56 pm and rt found to be the same in all input combinations in all stations standard deviations of eto values produced by rf found to be very close to rt fig 4 showed the scatter plots of eto values estimated by five models and by the fao56 pm model of rangpur stations under the full datasets during a five fold cross validation scheme in the testing phase this figure demonstrates that the five models showed different forecast accuracy in different stages in general s5 2011 2017 stage showed high prediction accuracy following the previous statistical results rt rf and bag produced daily eto values which are very close to the values estimated by the fao56 pm model fig 5 showed the scatter plots of eto values predicted by five models against the eto values estimated by the fao56 pm model in the testing phase of four input combinations in rangpur station this figure also depicted that the rt and rf models produced the eto values very close to the fao56 pm values bag and rs showed moderate performance accuracy whereas svm showed the least performance accuracy for predicting daily eto tmax tmin u2 rs hr combination found as the best combination for predicting daily eto as it produced values very close to the values produced by the fao56 pm model with the lowest statistical error tmax tmin ra found as the least acceptable combination for predicting daily eto as it produced values far away from the values produced by the fao56 pm model fig s2 in the supplementary section showed the time series plots of daily eto values estimated by the fao56 pm model and five machine learning models throughout the year of 2017 of rangpur station under four input combinations the figure showed that satisfactory results given by rt and rf respectively in all combinations of inputs following all the statistical analyses the kernel based model svm found to be the least acceptable model for predicting daily eto from tables 5 7 and figs 4 and 5 figs s1 and s2 it indicated that the rt and rf models were the best models respectively to estimate the daily eto and the input combination of c1 tmax tmin rs u2 hr was the best input datasets to estimate daily eto in both training and testing phases 3 3 assessment of the stability of five machine learning models the average rmse of nine weather stations both at training and testing phases for all the ensemble models under four input combinations shown in fig 6 fig 6 showed that rt and rf models respectively the best performed models with lowest values of rmse and highest accuracy in both training and testing phases of all input combinations rs and svm found as the least performed models with higher values of rmse compared to rt rf and bag models in both training and testing phases of all input combinations the percentage increase or decrease in testing phase rmse over the training phase rmse mean values of nine weather stations presented in fig 6 it is found that only in the first c1 input combination and rs and svm in third c3 input combination the percentage of rmse increased in the testing phase over the training phase in contrast the percentage of rmse decreased in the testing phase over the training phase in the second c2 and fourth c4 as well as the remaining models rt rf bag of c3 input combinations except for the input combination of c1 in the remaining three combinations of the percentage of rmse for rt and rf models decreased notably in the testing phase over the training phase indicating more stable models respectively for estimating daily eto 3 4 comparison of computation costs of five machine learning models fig 7 showed the computation costs of five machine learning models mean value of all weather stations used for predicting daily eto at both training and testing phases of all input combinations datasets svm consumed fig 7 notably much more time than the remaining four models to forecast daily eto in all input combinations rt consumed the least computational time in all input combinations for forecasting daily eto rs and bag also consumed less time but more than rt than rf whereas rf consumed less time than svm in predicting daily eto in all input combinations of datasets among all models and input combinations rt and c1 input combinations consumed less time indicating the most preferable and acceptable model and input combinations respectively 3 5 identifying the contributing factors of the climatic variables in estimating daily eto using rf model the random forest rf model was employed to carry out the importance degree analysis of the contributing climatic variables this model was conducted for determining the order of contribution status of several climatic variables affecting the observed eto based on the fao56 pm model and predicted eto based on the rt model in all stations across bangladesh fig s3 here the c1 input combination was designed for predicting daily eto using the rt model as both the input combination and among all the models rt proved as best for predicting daily eto the results showed that the green color column of the histogram most stations showing the u2 wind speed as the first largest contributing variables in these the histograms indicating the u2 influences the observed eto most table 8 and fig s3 a table 8 shows that among the 9 stations of bangladesh six stations belong to u2 that implies the highest contributing factor the u2 is comprised of almost 66 of all the stations which were identified mostly in the southeast and southwestern coastal regions followed by northeastern northern part and western climatic regions hr was to be found as the second largest contributing variable affecting 44 of the total observed eto variation which distributed mostly in south central and northeastern regions of bangladesh fig s3 it is observed that tmin and ra are as lowest contributing variables fig s3 a in affecting the observed daily eto as for the predicted eto it can be seen from table 8 that 4 stations of the total study region get the maximum contribution from rs solar radiation which accounts for almost 44 of the country distributed in the southeast northwestern and western climatic regions of bangladesh the rs were to be found as the first largest contributing variables table 8 and fig s3 b influencing the predicted eto changes similarly the second largest contributing variable is the hr relative humidity which comprises 45 of the country so the outcomes imply that u2 hr and rs are the main contributing climatic variables for daily eto changes across bangladesh 4 discussion 4 1 performance appraisal of five ensemble models under input combination approaches the combination of the input variables plays a pivotal role in forecasting the precision of the machine learning ensemble models for daily eto estimation the models adopted complete climate dataset exhibited the optimal forecast precision compared to the incomplete input dataset in this study the results indicate that all the models exhibited in high predictive performance in the first input combinations except for dhaka and jashore stations this may be ascribed to the variation of data distribution arrangement of training and testing stages at dhaka and jashore stations situated in the south central and south western climatic zones feng et al 2017 showed that machine learning ensemble models with maximum minimum temperature sunshine duration found reasonable eto estimates in the humid region china our findings indicate that solar radiation sunshine hours were much significant than wind speed and relative humidity for daily eto computation upon temperatures in subtropical climatic sub regions of bangladesh the models based on the only maximum and minimum temperatures and extra terrestrial solar radiation and net solar radiation c3 and c4 can also generate satisfactory eto estimates in all climatic regions where the estimation of the other climatic variables e g global solar radiation relative humidity and wind speed are unavailable our results are consistent with the earlier studies tabari et al 2012 fan et al 2018 huang et al 2019 chen et al 2020 where they stated that more input variables progress the forecasting precision of model however the contribution of climatic variables for eto computation varied in different climatic zone the tree based rt ensemble model usually depicted the best performance in appraising daily eto for four input combination strategies followed by rf this tree based ensemble model outperformed the other models bag rs and svm at nine stations in the testing phase huang et al 2019 found that tree based catboost model estimated more precise eto values than the svm model for predicting daily eto in humid climatic regions of china fan et al 2019 used a new tree based algorithm namely lightgbm which performed better than the rf m5tree and empirical models for estimating daily eto in the humid subtropical region of china besides feng et al 2017 exhibited the superiority of the tree based rf model than wnn and grnn models for daily eto prediction in southwest china granata 2019 have found that rf provided the best outcomes while svr was the least performing model in the humid subtropical region of central florida usa shiri 2018 argued that the hybrid rf tree based model was successfully applied for eto prediction in southern iran however the rt model found similar estimates of eto to the rf model with a little difference in rmse 4 for the five input combination strategies tmax tmin u2 hr and rs similar to the prior results rt and rf models gave the best precision in training and testing periods among five algorithms in the testing stage the rt model showed the best precision with complete and incomplete combinations of variables as model input whereas the svm model performed worst accuracy with all input combinations tables 5 7 compared with station specific model precisions on appraising eto of nine stations figs 4 6 the svm model revealed decreases in model precision however the magnitudes of decreases were less than 4 in rmse or mae in the rt model furthermore variations in the predictive precision between two models using the combinations of three input climatic variables strategies tmax tmin and rs ra were little rmse 20 the results also implied that five machine learning ensemble models found slight well predictive accuracy in the northeastern southeastern hilly regions and northern climatic zone in comparison with the south central and western climatic zones different statistical errors were observed in five fold cross validation phases which was mostly because of spatial as well as temporal variations in climatic variables among these phases kisi 2016 also confirmed that the use of the k fold cross validation model for dependable appraisal of daily eto is required in various climatic zones 4 2 stability appraisal of ensemble models the steadiness of machine learning ensemble models is a crucial issue to examine when appraising consistent eto modeling the current study indicated that the tree based algorithms e g rt and rf models reliably demonstrated the highest decrease in testing rmse among five machine learning models this decrease showed the stability of rt and rf models as these generated considerable increases in prediction precision when new climatic datasets were used our results are in disagreement with the outcomes of fan et al 2018 they found that tree based models like rf and m5tee models revealed instable due to the largest increase in testing rmse than other models likewise huang et al 2019 revealed that svm models exhibited the most static performance with the lowest increases in testing rmse from 4 8 to 37 4 hassan et al 2017 reported that the rf and bagging models usually showed a higher rise in testing rmse than the svr model for measuring solar radiation an hourly basis moreover the meta based algorithms e g bagging and rs ensemble models commonly higher performance for classification problems but lower in regression problems because they are unable to provide constant outputs in this case these two algorithms cannot produce good prediction accuracy which leads to an over fitting problem when noisy testing datasets are applied for estimation purposes however the rt and rf models demonstrated well stability with satisfactory increase where the decision trees provide more weight to the points inadequately forecasted by the previous predictors and a weighted vote is ultimately reserved for estimates liaw and wiener 2002 this approach can generally overcome over fitting difficulty besides the rt ensemble model was the most stable model with the lowest increases in testing rmse on the contrary the rs and svm models have a huge number of hyper variables which require to be cautiously tuned for eto modeling purposes our results recommend that the newly tree based rt algorithm with much development upon the conventional rf model has good potential for avoiding the difficulty of over fitting therefore a k fold cross validation model is needed to choose the best variables and confirm the good stability of the machine learning ensemble models 4 3 computational costs of ensemble algorithms to confirm whether there is any superiority for the tree based model rt ensemble algorithm in calculating efficiency the computational cost of datasets was performed the results suggested that the average time consumed by the rt ensemble algorithm was much lower than that those of the corresponding meta based and kernel tree based algorithms fig 7 particularly computation costs of the tree based model rt were almost 1 5 times less computational costs of rs and bagging and nearly 2 0 times fewer computation costs of the rf model and approximately 2 5 times less the computational costs of the svm model the main reason is that a tree based algorithm like rt is usually being able to construct a decision tree in parallel which might be more or less reduced the computing cost among the studied five models the svm ensemble model depicted the highest computational cost when the size of training data enlarged computation costs of bag rf and svm increased abruptly but the time cost of rt did not change so much it is clear that the average computing time cost depends on each algorithm and relying on the size of the training dataset however it is observed that the computational costs of these machine learning ensemble models will enlarge with the rise in the value and number of the applied model variables our finding is also similar to the fan et al 2018 where the rf and xgboost models have less computational cost and well efficiency because they trained in parallel and the other models did not show similarly likewise huang et al 2019 revealed that the tree based model catboost has found less computation cost than other rf and svm models in time and space hassan et al 2017 argued that computational costs of the conventional svr model were nearly 40 times the computational costs of tree based ensemble models e g bagging rf boosting and decision tree for measuring solar radiation on an hourly basis the time differences among these five studied models are assumed to be much higher or a lower time scale e g daily or when long term climatic variables in different sites were utilized for the development of model construction 4 4 comprehensive appraisal of ensemble models based on the aforementioned discussion the five ensemble models are ranked from the worst to best based on their predictive accuracies in the following order svm rs bag rf and rt these ensemble models are further ranked based on their relative stabilities as follows rt rf bag rs and svm besides considering their computational cost these ensemble models can be ordered in the following way rt rs bag rf and svm machine learning ensemble models are used to forecast eto as they are much precise than any empirical model however empirical models are usually stable whereas unsteady machine learning ensemble models can generate significantly least predictive precision when a new dataset is adopted hassan et al 2017 dong et al 2020 among the studied ensemble models rt and rf models found as the best combination of precision and more constancy followed by the bag rs and svm models thus the prediction accuracy computational costs as well as stability based on the complexity level of the studied models the comparatively tree based rt and rf models are suggested for daily eto prediction although the tree based rf ensemble model exhibited relative higher accuracy and stability than bag rs and svm ensemble models but revealed more computational costs than those models practically many data driven models commonly consider a single dataset for training and a single dataset for testing which may be misled or provide solely partially robust conclusions because the performance precision is only stated to a specific pattern of the original dataset collection and maybe not typical shiri et al 2014 shiri 2018 martí et al 2015 in practice the definition of the dataset added in each dataset is vital for appraising the model performance however in many cases a cross validation strategy is enough for confirming valid performance appraisal although most complex strategies like bootstrap may be used kohavi 1995 thus the performance of any models highly based on the data patterns and climatic regions for instance a similar model revealed different performances in different studies under various climatic settings fan et al 2018 wu and fan 2019 similar to our study several scholars e g thaseen and kumar 2013 kalmegh 2015 mishra and ratha 2016 kaur 2018 found that the rt model performed better than rf model table s1 so this study recommended that tree based rt can be a promising machine learning ensemble model considering precision constancy and computation cost for daily eto prediction using limited climate datasets in the various climatic zones of bangladesh and may apply to similar climates worldwide however future research is required to appraise the performance of potential rt models at various periods e g hourly or monthly scales or other similar regions of the world with humid subtropical climates 4 5 contribution of the influencing factors on observed and predicted daily eto the key driver of the eto system in bangladesh is the wind speed u2 and solar radiation as well as other climatic factors such as sea surface temperature topographic influence and land atmosphere circulation mcvicar and roderick 2010 li et al 2018b wang et al 2019 these drivers may be responsible for the daily eto variation in a particular climatic zone change in daily eto estimation and prediction has a strong association with the wind speed and solar radiation which move southward to increase easterlies our finding showed that overall evapotranspiration in bangladesh is affected by the change of u2 for the observed eto and rs for the predicted eto mostly many studies have reported that solar radiation and wind speed are the most contributing climatic variables influencing eto variation in different countries yang et al 2011 tabari et al 2012 herath et al 2018 maček et al 2018 duethmann and blöschl 2018 this is further supported by the study exhibiting that five climatic variables included where wind speed u2 and solar radiation are the most climatological contributing factor and the relative humidity hr is the second highest influencing factor in the variability of observed and predicted daily eto chen et al 2006 argued that relative humidity was the second most contributing factor affecting eto variation which was following this study similar to our study wang et al 2019 reported that the order of the rank of climatic variables is sunshine duration followed by temperature relative humidity and wind speed mostly associated with eto changes in southwest china the present study reveals that u2 and rs had a strong impact on daily eto changes in bangladesh apart from the strong impact of wind speed and solar radiation with the eto system intense human induced activities such as land use variation improved irrigation system use of greenhouse gases for growing crop productions regional precipitation changes cloud microphysics for aerosol effects may be affected by eto changes in bangladesh the association between greenhouse gases and human induced aerosols influenced the evaporation paradox that should be explored in further studies the future research should be focused on investigating the contribution of human activities in regional climate change analyzing the mechanisms of eto enhancing crop water demand for water limited regions to give a better decision making for the planning of sustainable water resource and agricultural irrigation system in bangladesh 5 conclusions we presented the potential of novel tree based rt model and meta based bagging and rs models for precisely estimating daily eto with four input combinations of climate datasets in seven climatic regions of bangladesh these ensemble models were compared with two commonly applied tree based rf models and kernel based svm models using the daily climatic dataset from nine meteorological stations of bangladesh during 1983 2017 the probable causes of the observed and predicted daily eto changes were also investigated the main conclusions were drawn from the present study as follows when lacking complete climatic variables five ensemble models could obtain satisfactory precision for estimating daily eto using tmax tmin and rs as 3 input combinations in all climatic regions of bangladesh the tmax tmin rs u2 and hr were found to be the best input combinations in seven climatic regions except for south central and south western regions while tmax tmin and ra were detected the least input combinations for the predicting daily eto during the training and testing phases the rt and rf models offered superior forecasting precision higher value of r2 and lower value of rmse and mae and much stable in both complete and incomplete combinations of input variables than other bagging rs and svm models considering the best prediction accuracy and consistency and much less computational costs the tree based rt model outperformed other models followed by rf bagging rs and svm overall the comparatively simple tree based rt and rf models are highly suggested as potential alternative tools for estimating daily eto with the limited weather datasets in the subtropical humid climate of bangladesh the importance degree calculated for the four climatic variables using the rf machine learning model revealed that wind speed u2 is the primary influential variable for the observed daily eto and solar radiation rs for the predicted daily eto which affects the evapotranspiration variations in bangladesh the relative humidity is the second largest contributing factor influencing the evapotranspiration system our study implies that a possible decrease in the wind speed combined with solar radiation and relative humidity decline might have lower evapotranspiration which could lead to the evaporation paradox in the future due to the high impact of these three climatic variables on the eto the results of the study will be helpful for irrigation engineers hydrologists and researchers who plan simulate or appraise the performance of different ensemble models also policymakers and practitioners will use for future agricultural water resource management in bangladesh under global warming declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful to the authority of begum rokeya university brur and bangladesh meteorological department bmd dhaka bangladesh for providing data facilities and others logistic support during the research period authors contributions r salam and a r m t islam conceived and designed the study r salam conducted and contributed to the analysis both r salam and a r m t islam interpreted the analytical data and drafted the manuscript finally both authors read and approved the final manuscript funding the authors received no specific funding for this research work appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125241 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5187,ensemble learning el an alternative approach in the machine learning field offers an accurate reference evapotranspiration eto prediction which is of paramount significance for the hydrological studies and agricultural water practices although the fao 56 penman monteith pm equation is regarded as an ideal model for estimating eto its applicability is limited due to the absence of required climatic datasets in many regions of the world despite its significance only a few studies use the el algorithms for the eto prediction perspective in this study we contribute to fill this gap from a two fold way first we present the potential of new el random tree rt bagging and random subspace rs algorithms which were compared with two commonly used random forest rf and support vector machine svm algorithms for predicting daily eto with the climatic data limited humid region in bangladesh during 1983 2017 using a five fold cross validation scheme second we explore the role of contributing variables influencing eto change at the regional scale when a lack of climatic datasets tmax maximum temperature tmin minimum temperature and rs solar radiation as 3 input combinations obtained the reasonable precision for estimating eto in all climatic regions except for south central and south western regions compared to other state of arts models the rt model performed superior to predict eto in all input combinations followed by the rf bagging rs and svm considering less difficulty level high prediction accuracy more dependability and fewer computation costs of studied models rt and rf models have been suggested as the promising potentials for daily eto estimate in subtropical climate regions of bangladesh and also may be applicable worldwide in the similar climates the importance analysis from the rf model depicted that the wind speed u2 and solar radiation rs are the largest influential variables affecting the observed and predicted daily eto changes in bangladesh keywords bagging random tree random subspace subtropical humid climate ensemble model bangladesh 1 introduction appraising reference evapotranspiration eto is essential for effectively managing and designing agricultural hydrology the optimal irrigation scheduling plan and crop growth modeling feng et al 2017 karimi et al 2017 wang et al 2019 wu et al 2019 as a nexus of the hydrological and carbon cycles eto is influenced by crop yield and energy balance along with affecting ocean atmospheric circulation which subsequently influences climate change jung et al 2010 fan et al 2019 however direct estimation of eto through weighted lysimeters or eddy covariance is complicated time consuming and expensive irmak et al 2003 fan et al 2018 thus many empirical as well as semi empirical models e g temperature based mass transfer based and radiation based models are developed and proposed to estimate eto with specific climatic variables of these the fao 56 penman monteith model fao56 pm has been extensively employed as the reference model for different regions with diverse climatic conditions allen et al 1998 li et al 2018a with good accuracy and consistency the main advantage of the fao56 pm model is that it has taken into account both the principles of aerodynamics and thermodynamic components nevertheless fao56 pm model needs a diversity of meteorological variables for computing e g minimum as well as maximum air temperatures solar radiation relative humidity and wind speed tabari et al 2013 shiri et al 2014 chu et al 2017 fan et al 2018 which notably limits its universal application occasionally these climatic variables are incomplete or unavailable in a particular region traore et al 2010 data quality and difficulty in obtaining all the factors influenced by climatic variables can pose major hindrances on its application especially in developing countries like bangladesh for example bangladesh meteorological department bmd operates only 35 weather stations across bangladesh it should be noted that the bmd has no radiation station thus the current model for estimating the solar radiation by weather dataset is inaccurate fan et al 2020 in this case an alternative empirical model depending on the limited climatic dataset is required kisi and alizamir 2018 hence it is urgent to develop an alternative promising model that can estimate eto with high accuracy the estimation of eto is regarded as a set of complicated as well as nonlinear phenomena relying on a huge number of climate datasets fan et al 2018 it is difficult to make an empirical model to accurately explain all the nonlinear and complicated phenomena principally in the deficiency of several key climatic variables region specific application is the main drawback of the most empirical models kisi 2016 to overall this drawback research scholars have used artificial intelligence e g machine learning algorithms for estimating eto because the machine learning ensemble model can provide easy solutions for nonlinear and multi parameter functions and also there is no need to prior knowledge of input parameters kisi 2016 wang et al 2017 in the last two decades owing to their outstanding performance in confronting nonlinear interactions between the model input and output parameters machine learning ensemble algorithms have been widely employed to predict eto precisely in data limited areas feng et al 2016 jovic et al 2018 different machine learning ensemble models have been recommended to forecast eto in several climatic regions throughout the world e g 1 neuron based machine learning algorithms including artificial neural networks anns are the most popular and extensively employed models for eto forecasting traore et al 2016 ferreira et al 2019 other neuron based ensemble algorithms are generalized regression neural networks feng et al 2017 multi layer perception mlp traore et al 2016 extreme learning machine elm abdullah et al 2015 gocić et al 2015 feng et al 2016 and radial basis function neural networks rbf petković et al 2016 2 kernel based machine learning ensemble algorithms e g support vector machine svm tabari et al 2012 shiri et al 2014 mohammadrezapoura et al 2018 chen et al 2020 have been largely applied for eto prediction other kernel based models are least squares support vector machine lssvm kisi 2016 3 tree based machine learning ensemble algorithms are used for predicting eto recently e g m5 model tree m5tree rahimikhoob 2014 regression tree granata 2019 as well as random forest rf feng et al 2017 chen et al 2020 gradient boosting on decision trees with categorical features support catboost huang et al 2019 light gradient boosting machine lightgbm fan et al 2019 4 meta based machine learning ensemble algorithms are rarely employed for eto forecasting such as bagging granata 2019 and random sub space rs 5 other ensemble algorithms including multivariate adaptive regression splines mars mehdizadeh et al 2017 adaptive neuro fuzzy inference system anfis sanikhani et al 2019 gradient boost regression ponraj and vigneswaran 2019 fuzzy genetic models kisi and cengiz 2013 hybrid machine learning tikhamarine et al 2019 deep learning dl saggi and jain 2019 and neuro computing model banda et al 2017 among various machine learning ensemble algorithms the kernel based algorithms including svm have gained popularity for eto forecasting tabari et al 2012 however they are complicated and demand high computation costs hassan et al 2017 in contrast the meta based and tree based ensemble algorithms e g bagging random subspace rt and rf models have recently drawn researcher s attention as they are comparatively simple and accurate but robust algorithms and powerful ability in eto prediction hassan et al 2017 feng et al 2017 chen et al 2020 the earlier studies reported that kernel based svm outperformed than other machine learning ensemble models to estimate eto in the semi arid region of iran tabari et al 2012 humid region of china wen et al 2015 sub humid region of turkey kisi 2016 and sub tropical region of china wu and fan 2019 by contrast fan et al 2018 revealed the performance of kernel based and tree based models to predict daily eto and found that extreme gradient boosting xgboost and gradient boosting decision tree gbdt revealed high precision and stability in comparison with the kernel based elm and svm models in several climatic regions of china similarly the rf model provided better daily eto prediction than any other models in southwestern china feng et al 2017 wang et al 2019 and southern iran shiri 2018 the random forest rf has some advantages e g high forecasting accuracy incomplete number of user based variables and capability of avoiding over fitting problems wang et al 2019 in addition to this it can determine the relative importance of climatic variables nevertheless there is no other common consensus on the choice of the optimal model for eto prediction hence new models are required and should be verified this study presents the potentials of the latest ensemble learning models e g meta based bagging random tree and random subspace for daily eto prediction modeling because these ensemble learning models are scarcely applied for daily eto prediction particularly the meta based ensembles random subspace bagging and tree based ensemble random tree are novel approaches for soft computing that are employed to improve the forecasting accuracy of a single classifier for example a random subspace rs is an effective meta based algorithm for developing ensembles that aid from bootstrap and combination kuncheva et al 2010 dong et al 2020 similar to the rs the bagging ensemble algorithm is one of the most population ensemble learning models that can give superior performance in solving the non linear problem roshan and asadi 2020 in bagging classifiers are learned in parallel via each training dataset as the bag which is developed by using bootstrap breiman 1996 meta based bagging algorithm is more competent than boosting based algorithms khoshgoftaar et al 2010 dong et al 2020 conversely a random tree rt is a modified supervised tree based ensemble algorithm that produces a set of each learner mishra and ratha 2016 which is the amalgamation of random forest and bagging it helps address the existence of over fitting problems compared to the random forest with high accuracy landwehr et al 2005 the rt model can deal with regression as well as classification problems the major advantage of rt is that it can handle nonlinear multiple heterogeneous phenomena between the model input and output variables as so to reach high model precision mishra and ratha 2016 there are still several challenges in using ensemble learning models on the eto estimation studies that are difficult to solve first to the best of the authors knowledge the new robust ensemble models e g random tree bagging and random subspace have not yet been employed in hydrological researches especially in evapotranspiration modeling so far there exist no earlier studies that explored the possibilities and applicability of any of these new ensemble models there exists a distinct gap in the efficiency of machine learning ensemble models to forecast daily eto in several climatic sub regions of bangladesh therefore it is a key concern for investigating the new ensemble learning algorithms to bangladesh s environmental conditions to achieve satisfactory precision besides the accuracy of each new ensemble algorithm is diverse in various climatic regions because various contributing factors may be used hassan et al 2017 second there is no agreement on which algorithm is the best for eto prediction the fact that these ensemble learning algorithms have various structures and function distributions for the best climatic variables third the comparison between new ensemble learning algorithms rs bagging and rt and commonly used rf and svm models is yet to be comprehensively explored in the existing literature although high accuracy of eto prediction is the focal concern when using the soft computing model well steady and fewer computation costs are important for consideration hassan et al 2017 fourth although several studies have only concentrated on the significance of climatic variables affecting the observed eto that varies from climatic zone to zone thomas 2000 yang et al 2011 li et al 2018b duethmann and blöschl 2018 maček et al 2018 wang et al 2019 whether the most dominating climatic variables affecting the daily evapotranspiration system are less investigated in previous studies however the solutions to these issues remain uncertain therefore the present study focuses on solving these issues for selecting bangladesh as a case study area 1 to evaluate the performance of four input combination of climatic datasets on the precision of daily eto prediction in subtropical humid climatic regions of bangladesh 2 to develop the new two meta and tree based with one kernel based ensemble models such as bagging rs rt rf and svm to predict daily eto with the limited climatic dataset 3 to evaluate the predictive accuracy as well as stability of five ensemble models 4 to compare the computational costs of rt rs and bagging models with equivalent rf and svm models for computing daily eto and 5 to identify the contribution of the four climatic variables u2 hr rs tmax affecting the daily and predicted eto changes in bangladesh using the rf model 2 data and method 2 1 study area description bangladesh positioned in south east asia the world s largest deltaic country is placed in the gbm ganges brahmaputra meghna river basin rahman and islam 2019 most of its land area is low lying and the part of the southeast and northeast has some hilly areas geographically bangladesh encompasses between the 20030 n to 26045 n latitudes and 8800 e to 92045 e longitudes fig 1 there are seven climatic sub regions in bangladesh as shown in fig 1 the seven sub regions are i south eastern zone ii north eastern zone iii northern part of the northern zone iv north western zone v western zone vi south western zone and finally vii south central zone it enjoys a sub tropical monsoon climate characterized with 3 major seasons of monsoon pre monsoon and winter islam et al 2019 although bangladesh experiences a sub tropical humid monsoonal climate with northwestern region suffer drought frequently due to inadequate water resources annual mean rainfall less than 1200 mm western bangladesh has usually become drier compared to other regions in bangladesh islam et al 2017 it occupies the world s largest sea beach cox s bazar and largest mangrove forest sundarbans in its southern part climatic variability is a regular scenario it is thus accepted that accurate appraisal is a vital step for agricultural hydrological distribution and practices 2 2 data sources bangladesh meteorological department bmd has 43 weather stations across the country from which historical daily minimum and maximum temperature c mean relative humidity wind speed knots and sunshine h day 1 datasets of 9 stations were sourced in this study 9 weather stations from 7 climatic regions each climatic region occupies one station except south eastern and south central zone which occupy two stations were selected for eto calculation over the 35 years from 1983 to 2017 a brief geographical and meteorological description of our selected stations is found in table 1 extra terrestrial radiation ra wind speed at 2 m height u2 and global solar radiation rs cannot directly be measured by weather stations daily rs ra and u2 were estimated using the procedures recommended by allen et al 1998 with the available meteorological datasets 80 data were used in training and the remaining 20 data were used for testing a detailed flowchart of data management arrangement and analysis is found in fig 2 2 3 fao56 penman monteith equation several studies have been conducted to model evapotranspiration by machine learning algorithms from the popular instrument evaporation pan abghari et al 2012 rahimikhoob et al 2013 goyal et al 2014 kisi 2015 in recent decades research scholars have preferred to estimate the reference evapotranspiration eto from available daily meteorological data by using the equation proposed by allen et al 1998 for eto prediction wen et al 2015 martí et al 2015 wu and fan 2019 wu et al 2019 wang et al 2019 valle júnior et al 2020 our study estimated the eto by using available daily meteorological data employing the fao56 pm recommended equation rather than using the data of eto measured from an evaporation pan another justification for estimating eto is that till now bmd does not provide eto data this model fao56 pm equation is renowned as the standard model for estimating eto across the world which was proposed by allen et al 1998 the fao56 pm model expressed as et0 0 408 δ r n g γ 900 t 273 u 2 e s e a δ γ 1 0 34 u 2 1 where eto is reference evapotranspiration mmd 1 r n is net radiation at the crop surface mj m 2 d 1 g is soil heat flux density mj m 2 d 1 t is mean daily air temperature at 2 m height c u 2 is wind speed at 2 m height m s 1 e s is saturation vapour pressure kpa e a is actual vapour pressure kpa e s e a i s saturation vapour pressure deficit kpa δ is slope of vapour pressure curve kpa c 1 γ is psychrometric constant kpa c 1 allen et al 1998 recommended g 0 the detailed procedures of eto estimation is found in fao 56 paper allen et al 1998 rn is calculated by the eqs 2 11 2 rn rns rnl 3 rns 1 α rs 4 r s a s b s n n r a 5 r a 24 60 π g s c d r ω s s i n φ s i n δ c o s φ c o s δ s i n ω s 6 d r 10 033 c o s 2 π 365 j 7 δ 0 409 s i n 2 π 365 j 1 39 8 ωs arccos tan φ tan δ 9 radians π 180 decimal degrees 10 r n l σ t m a x k 4 t m i n k 4 2 0 34 0 14 e a 1 35 r s r s o 0 35 11 r s a 0 75 2 x 10 5 z r a u2 is calculated from the following eq 12 recommended by allen et al 1998 12 u 2 u z 4 87 i n 67 8 z 5 42 where rns denotes shortwave radiation mj m 2 d 1 rnl denotes longwave radiation mj m 2 d 1 rs denotes global solar radiation mj m 2 d 1 n means maximum possible sunshine duration and n means actual possible sunshine duration ra means extraterrestrial radiation mj m 2 d 1 gsc 0 0820 mj m 2 min 1 indicates solar constant ωs means sunset hour angle rad dr indicates inverse relative distance earth sun latitude rad denotes by φ δ represents solar declination rad j is the julian number of day in a year σ 4 903 10 9 mj k 4 m 2 d 1 indicates stefan boltzmann constant α α 0 23 is albedo tmaxk and tmin k are respectively maximum and minimum absolute temperatures during 24 h and rso means solar radiation in a clear sky mj m 2 d 1 allen et al 1998 recommended 0 25 for as and 0 50 for bs uz means wind speed at zm above from ground surface m s 2 and z is respective station elevation above sea level m 2 4 ensemble learning algorithms for estimating daily eto 2 4 1 bagging bagging a meta based decision tree is an effective simple popular and useful ensemble learning algorithm roshan and asadi 2020 breiman 1996 first introduced this decision tree the bagging creates sampling subsets by randomly training set of the sample and then utilized these attained subsets to train the basic algorithm for combination the training of the basic algorithm in the bagging is carried out in a parallel way bagging is used for both the classification as well as regression dong et al 2020 it is the function of using the bootstrap of the original training dataset n the classifiers trained with training datasets are considered as the base classifiers in the testing stage the input datasets are predicted by base classifiers it is a powerful ensemble model as it never over fitting on the training dataset 2 4 2 random forest rf it is a tree based supervised ensemble learning model proposed by breiman 2001 breiman improved the bagging models to rf it is used for predicting as well as regression problems it is a simple and robust model plus prediction accuracy compare to the adaboost the error produced by rf is depended based on individual trees the rf model trains various decision trees from two viewpoints one is the sample dimension and another one is the feature dimension dong et al 2020 as a consequence it improves the problem that decision trees are closed to over fitting by combining voting outcomes of various decision trees the training of the basic algorithm in the rf model is parallel as like as the bagging model the rf model gives forecasting with high precision without over fitting data set for modeling of hydrological features breiman 2001 for more detailed about the rf ensemble algorithm the reader is referred to hastie et al 2009 hassan et al 2017 feng et al 2017 rahman and islam 2019 as a tree based ensemble algorithm it is essential to appraise the importance degree of the climatic variables based on the rf model wang et al 2019 in the present study the rf model was used in estimating daily eto as well as identifying the contributing climatic variables for estimating daily eto changes the importance degree of climatic variables was computed by calculating the decrease in forecasting accuracy resulting from randomly assigned the values of a climatic variable 2 4 3 random subspace rs the rs model is a semi supervised meta based algorithm similar to bagging requiring parameters of ensemble size l as well as feature subset m kuncheva et al 2010 this model is called random forest when combined with bagging this model is in addition used for building support vector machine svm linear classifiers and so one this is an attractive model as the number of training points is less than the features the rs model develops a set of feature subspaces through randomly sampling characteristics and then trains basic algorithms in these subspaces to create numerous outcomes before being merged into the ultimate outcomes ho 1995 dong et al 2020 the basic algorithm in the rs is also trained in a parallel manner 2 4 4 random tree rt the rt model is a modified supervised ensemble learning algorithm that produces lots of individual classifiers this tree based classifier model was pioneered by leo breiman and adele cutler kalmegh 2015 the rt model is an ensemble of tree predictors which is also known as a forest this model is not only used for regression but also for classification problems it is the combination of two ensemble learning algorithms as rf and bagging it utilizes a bagging concept to generate a random sampling data set for producing the decision trees in an ideal tree each node is fragmented using the optimal fragment among individual variables a good prediction score can be originated by using this model compared to other ensemble models this ensemble learning method has some advantages in terms of precision consistency and generalization in comparison with other ensemble algorithms this rt model is utilized to solve non linear problems such as data mining studies mishra and ratha 2016 the more detailed of this rt model can be found elsewhere yali and donald 1997 mishra and ratha 2016 2 4 5 support vector machine svm the svm model is a kernel based supervised learning algorithm introduced by vapnik 1995 that is intended to generate the best separating hyper plane between different categories hastie et al 2009 it is applied for prediction in addition to regression problems in the fields of meteorology hydrology environmental sciences chen et al 2014 it can convert lower input datasets into higher dimensional features different categories of classification functions were employed such as exponential kernel chen et al 2014 radial basis function kernel rbfk gayen et al 2019 linear kernel and polynomial kernel amiri et al 2019 of these an exponential kernel function developed by gholami et al 2020 was utilized in this study the furthermore details of the svm can be found in the literature hastie et al 2009 gholami et al 2020 the aforementioned 5 models were utilized for modeling after optimizing the parameters of these algorithms several techniques exist for parameter optimization which is known as tuning one of the popular techniques for parameter optimization or tuning is grid search this study used the grid search technique for tuning which is very much essential for knowing the accuracy of the respective models and its performances only the models on respective input combinations which showed good accuracy more than 85 used in the present study for eto forecasting optimized parameters were used for 5 models which are shown in table 4 2 5 input combination and cross validation several input combinations were tested for knowing its accuracy before eto forecasting a tmax tmin latitude julian date hr b tmax tmin rs u2 hr c tmax tmin ra u2 hr d tmax tmin hr e tmax tmin rs f tmax tmin ra g tmax tmin latitude julian date and h tmax tmin were tested by using grid search among the 8 combination inputs only four input combinations showed preferable accuracy more than 85 for eto forecasting which were utilized in this study and the remaining 5 input combinations were omitted for eto forecasting as it showed very poor accuracy four input combination datasets which were used in this study for estimating daily eto as shown in the table 2 the four input datasets were c1 tmax tmin rs u2 hr c2 tmax tmin ra u2 hr c3 tmax tmin rs and c4 tmax tmin ra during 1983 2017 in this study 5 fold cross validation was undertaken the complete meteorological datasets of 1983 2017 were divided into 5 equal stages for cross validation as shown in the table 3 four stages were meant for training and remaining one was meant for testing in every application testing stage was changed and all the models were tested at 5 stages 2 6 performance evaluation of five machine learning models performance evaluation of five machine learning models based on the precision of each model for estimating daily eto was undertaken by four statistical indicators these four statistical indicators were correlation coefficient r2 root mean square error rmse mean absolute error mae despotovic et al 2015 and mean absolute percentage error mape kim and kim 2016 the statistical indicators are expressed by the following four equations eqs 2 5 2 r 2 i 1 n y i m y i e 2 i 1 n y i m y i e 2 3 rmse 1 n i 1 n y i m y i e 2 4 mape 1 n i 1 n y i m y i e y i m 5 mae 1 n i 1 n y i m y i e where y i m y i e and n is the observed eto predicted eto and total observations respectively higher the values of r square more the model accuracy the value of r square is ranged from 0 to 1 if the value of r square is 1 then it indicates there is no error in building that model and higher performance evaluation the lower values of rmse mape and mae indicate the higher performance evaluation of the models 3 results 3 1 meteorological condition daily average relative humidity minimum temperature maximum temperature wind speed at 2 m height net radiation evapotranspiration across the country are respectively 80 21 39 c 29 94 c 1 32 m s 1 10 44 mj m 2 d 1 and 3 72 mm d 1 long term 1983 2017 historical average monthly distribution of tmax tmin ra rs hr and u2 is shown in fig 3 the low temperature both tmax and tmin reported in january and december while the high minimum temperature found in june july and august and the higher maximum temperature recorded in april and may fig 3a monthly mean tmax was comparatively higher than tmin during the observation period except for july both extra terrestrial radiation and global solar radiation varied with a similar pattern except for the months of april and june the highest global solar radiation found in april and the maximum extra terrestrial radiation detected in may fig 3b about 85 86 relative humidity observed in july august and september and low relative humidity less than 70 but more than 65 found in march fig 3c january february october november and december experienced the low wind speed 1 04 1 21 m s 1 while may june and july showed the maximum wind speed 2 3 2 4 m s 1 fig 3d 3 2 performance evaluation of five ensemble models under four input combination the statistical results of five novel machine learning models bag rf rs rt and svm at nine stations bogura dhaka jashore mymensingh patuakhali rajshahi rangamati rangpur and sylhet for predicting daily reference evapotranspiration eto of both the training and testing phases under four input combinations are shown in the tables 5 7 approximately similar statistical results have been found in all the stations and brief performance evaluation of rangpur of five models is presented in this study statistical results tables 5 7 of all stations showed that the rt model has the higher values of r2 and lower values of rmse and mae for both the training and testing phases followed by rf bag and rs whereas svm showed the lowest performance among the five models for predicting daily eto bag and rs are the third and fourth well performed models respectively except for dhaka and jashore all the models showed high performance accuracy higher values of r2 lower values of rmse and mae in the first input dataset of c1 tmax tmin u2 rs hr in dhaka bag and rs showed high performance accuracy in the second input dataset of c2 tmax tmin ra u2 hr and in jashore bag and rf showed high performance accuracy in the second input dataset of c2 table 5 c2 tmax tmin ra u2 hr c3 tmax tmin rs and c4 tmax tmin ra are respectively 2nd 3rd and 4th well performed input datasets respectively table 5 7 also showed the mape of all stations of five models under four input combinations depicting rt is the best model for all stations under all input combinations align with the r2 rmse and mae mape indicates that the c1 dataset provides high predicting accuracy c2 c3 and c4 combinations provide second third and fourth performance accuracy respectively for predicting daily eto the standard deviation of daily eto values estimated by fao56 pm and five machine learning models of all stations of four input combinations presented in the supplementary section of fig s1 fig s1 depicted those standard deviations of eto values estimated by fao56 pm and rt found to be the same in all input combinations in all stations standard deviations of eto values produced by rf found to be very close to rt fig 4 showed the scatter plots of eto values estimated by five models and by the fao56 pm model of rangpur stations under the full datasets during a five fold cross validation scheme in the testing phase this figure demonstrates that the five models showed different forecast accuracy in different stages in general s5 2011 2017 stage showed high prediction accuracy following the previous statistical results rt rf and bag produced daily eto values which are very close to the values estimated by the fao56 pm model fig 5 showed the scatter plots of eto values predicted by five models against the eto values estimated by the fao56 pm model in the testing phase of four input combinations in rangpur station this figure also depicted that the rt and rf models produced the eto values very close to the fao56 pm values bag and rs showed moderate performance accuracy whereas svm showed the least performance accuracy for predicting daily eto tmax tmin u2 rs hr combination found as the best combination for predicting daily eto as it produced values very close to the values produced by the fao56 pm model with the lowest statistical error tmax tmin ra found as the least acceptable combination for predicting daily eto as it produced values far away from the values produced by the fao56 pm model fig s2 in the supplementary section showed the time series plots of daily eto values estimated by the fao56 pm model and five machine learning models throughout the year of 2017 of rangpur station under four input combinations the figure showed that satisfactory results given by rt and rf respectively in all combinations of inputs following all the statistical analyses the kernel based model svm found to be the least acceptable model for predicting daily eto from tables 5 7 and figs 4 and 5 figs s1 and s2 it indicated that the rt and rf models were the best models respectively to estimate the daily eto and the input combination of c1 tmax tmin rs u2 hr was the best input datasets to estimate daily eto in both training and testing phases 3 3 assessment of the stability of five machine learning models the average rmse of nine weather stations both at training and testing phases for all the ensemble models under four input combinations shown in fig 6 fig 6 showed that rt and rf models respectively the best performed models with lowest values of rmse and highest accuracy in both training and testing phases of all input combinations rs and svm found as the least performed models with higher values of rmse compared to rt rf and bag models in both training and testing phases of all input combinations the percentage increase or decrease in testing phase rmse over the training phase rmse mean values of nine weather stations presented in fig 6 it is found that only in the first c1 input combination and rs and svm in third c3 input combination the percentage of rmse increased in the testing phase over the training phase in contrast the percentage of rmse decreased in the testing phase over the training phase in the second c2 and fourth c4 as well as the remaining models rt rf bag of c3 input combinations except for the input combination of c1 in the remaining three combinations of the percentage of rmse for rt and rf models decreased notably in the testing phase over the training phase indicating more stable models respectively for estimating daily eto 3 4 comparison of computation costs of five machine learning models fig 7 showed the computation costs of five machine learning models mean value of all weather stations used for predicting daily eto at both training and testing phases of all input combinations datasets svm consumed fig 7 notably much more time than the remaining four models to forecast daily eto in all input combinations rt consumed the least computational time in all input combinations for forecasting daily eto rs and bag also consumed less time but more than rt than rf whereas rf consumed less time than svm in predicting daily eto in all input combinations of datasets among all models and input combinations rt and c1 input combinations consumed less time indicating the most preferable and acceptable model and input combinations respectively 3 5 identifying the contributing factors of the climatic variables in estimating daily eto using rf model the random forest rf model was employed to carry out the importance degree analysis of the contributing climatic variables this model was conducted for determining the order of contribution status of several climatic variables affecting the observed eto based on the fao56 pm model and predicted eto based on the rt model in all stations across bangladesh fig s3 here the c1 input combination was designed for predicting daily eto using the rt model as both the input combination and among all the models rt proved as best for predicting daily eto the results showed that the green color column of the histogram most stations showing the u2 wind speed as the first largest contributing variables in these the histograms indicating the u2 influences the observed eto most table 8 and fig s3 a table 8 shows that among the 9 stations of bangladesh six stations belong to u2 that implies the highest contributing factor the u2 is comprised of almost 66 of all the stations which were identified mostly in the southeast and southwestern coastal regions followed by northeastern northern part and western climatic regions hr was to be found as the second largest contributing variable affecting 44 of the total observed eto variation which distributed mostly in south central and northeastern regions of bangladesh fig s3 it is observed that tmin and ra are as lowest contributing variables fig s3 a in affecting the observed daily eto as for the predicted eto it can be seen from table 8 that 4 stations of the total study region get the maximum contribution from rs solar radiation which accounts for almost 44 of the country distributed in the southeast northwestern and western climatic regions of bangladesh the rs were to be found as the first largest contributing variables table 8 and fig s3 b influencing the predicted eto changes similarly the second largest contributing variable is the hr relative humidity which comprises 45 of the country so the outcomes imply that u2 hr and rs are the main contributing climatic variables for daily eto changes across bangladesh 4 discussion 4 1 performance appraisal of five ensemble models under input combination approaches the combination of the input variables plays a pivotal role in forecasting the precision of the machine learning ensemble models for daily eto estimation the models adopted complete climate dataset exhibited the optimal forecast precision compared to the incomplete input dataset in this study the results indicate that all the models exhibited in high predictive performance in the first input combinations except for dhaka and jashore stations this may be ascribed to the variation of data distribution arrangement of training and testing stages at dhaka and jashore stations situated in the south central and south western climatic zones feng et al 2017 showed that machine learning ensemble models with maximum minimum temperature sunshine duration found reasonable eto estimates in the humid region china our findings indicate that solar radiation sunshine hours were much significant than wind speed and relative humidity for daily eto computation upon temperatures in subtropical climatic sub regions of bangladesh the models based on the only maximum and minimum temperatures and extra terrestrial solar radiation and net solar radiation c3 and c4 can also generate satisfactory eto estimates in all climatic regions where the estimation of the other climatic variables e g global solar radiation relative humidity and wind speed are unavailable our results are consistent with the earlier studies tabari et al 2012 fan et al 2018 huang et al 2019 chen et al 2020 where they stated that more input variables progress the forecasting precision of model however the contribution of climatic variables for eto computation varied in different climatic zone the tree based rt ensemble model usually depicted the best performance in appraising daily eto for four input combination strategies followed by rf this tree based ensemble model outperformed the other models bag rs and svm at nine stations in the testing phase huang et al 2019 found that tree based catboost model estimated more precise eto values than the svm model for predicting daily eto in humid climatic regions of china fan et al 2019 used a new tree based algorithm namely lightgbm which performed better than the rf m5tree and empirical models for estimating daily eto in the humid subtropical region of china besides feng et al 2017 exhibited the superiority of the tree based rf model than wnn and grnn models for daily eto prediction in southwest china granata 2019 have found that rf provided the best outcomes while svr was the least performing model in the humid subtropical region of central florida usa shiri 2018 argued that the hybrid rf tree based model was successfully applied for eto prediction in southern iran however the rt model found similar estimates of eto to the rf model with a little difference in rmse 4 for the five input combination strategies tmax tmin u2 hr and rs similar to the prior results rt and rf models gave the best precision in training and testing periods among five algorithms in the testing stage the rt model showed the best precision with complete and incomplete combinations of variables as model input whereas the svm model performed worst accuracy with all input combinations tables 5 7 compared with station specific model precisions on appraising eto of nine stations figs 4 6 the svm model revealed decreases in model precision however the magnitudes of decreases were less than 4 in rmse or mae in the rt model furthermore variations in the predictive precision between two models using the combinations of three input climatic variables strategies tmax tmin and rs ra were little rmse 20 the results also implied that five machine learning ensemble models found slight well predictive accuracy in the northeastern southeastern hilly regions and northern climatic zone in comparison with the south central and western climatic zones different statistical errors were observed in five fold cross validation phases which was mostly because of spatial as well as temporal variations in climatic variables among these phases kisi 2016 also confirmed that the use of the k fold cross validation model for dependable appraisal of daily eto is required in various climatic zones 4 2 stability appraisal of ensemble models the steadiness of machine learning ensemble models is a crucial issue to examine when appraising consistent eto modeling the current study indicated that the tree based algorithms e g rt and rf models reliably demonstrated the highest decrease in testing rmse among five machine learning models this decrease showed the stability of rt and rf models as these generated considerable increases in prediction precision when new climatic datasets were used our results are in disagreement with the outcomes of fan et al 2018 they found that tree based models like rf and m5tee models revealed instable due to the largest increase in testing rmse than other models likewise huang et al 2019 revealed that svm models exhibited the most static performance with the lowest increases in testing rmse from 4 8 to 37 4 hassan et al 2017 reported that the rf and bagging models usually showed a higher rise in testing rmse than the svr model for measuring solar radiation an hourly basis moreover the meta based algorithms e g bagging and rs ensemble models commonly higher performance for classification problems but lower in regression problems because they are unable to provide constant outputs in this case these two algorithms cannot produce good prediction accuracy which leads to an over fitting problem when noisy testing datasets are applied for estimation purposes however the rt and rf models demonstrated well stability with satisfactory increase where the decision trees provide more weight to the points inadequately forecasted by the previous predictors and a weighted vote is ultimately reserved for estimates liaw and wiener 2002 this approach can generally overcome over fitting difficulty besides the rt ensemble model was the most stable model with the lowest increases in testing rmse on the contrary the rs and svm models have a huge number of hyper variables which require to be cautiously tuned for eto modeling purposes our results recommend that the newly tree based rt algorithm with much development upon the conventional rf model has good potential for avoiding the difficulty of over fitting therefore a k fold cross validation model is needed to choose the best variables and confirm the good stability of the machine learning ensemble models 4 3 computational costs of ensemble algorithms to confirm whether there is any superiority for the tree based model rt ensemble algorithm in calculating efficiency the computational cost of datasets was performed the results suggested that the average time consumed by the rt ensemble algorithm was much lower than that those of the corresponding meta based and kernel tree based algorithms fig 7 particularly computation costs of the tree based model rt were almost 1 5 times less computational costs of rs and bagging and nearly 2 0 times fewer computation costs of the rf model and approximately 2 5 times less the computational costs of the svm model the main reason is that a tree based algorithm like rt is usually being able to construct a decision tree in parallel which might be more or less reduced the computing cost among the studied five models the svm ensemble model depicted the highest computational cost when the size of training data enlarged computation costs of bag rf and svm increased abruptly but the time cost of rt did not change so much it is clear that the average computing time cost depends on each algorithm and relying on the size of the training dataset however it is observed that the computational costs of these machine learning ensemble models will enlarge with the rise in the value and number of the applied model variables our finding is also similar to the fan et al 2018 where the rf and xgboost models have less computational cost and well efficiency because they trained in parallel and the other models did not show similarly likewise huang et al 2019 revealed that the tree based model catboost has found less computation cost than other rf and svm models in time and space hassan et al 2017 argued that computational costs of the conventional svr model were nearly 40 times the computational costs of tree based ensemble models e g bagging rf boosting and decision tree for measuring solar radiation on an hourly basis the time differences among these five studied models are assumed to be much higher or a lower time scale e g daily or when long term climatic variables in different sites were utilized for the development of model construction 4 4 comprehensive appraisal of ensemble models based on the aforementioned discussion the five ensemble models are ranked from the worst to best based on their predictive accuracies in the following order svm rs bag rf and rt these ensemble models are further ranked based on their relative stabilities as follows rt rf bag rs and svm besides considering their computational cost these ensemble models can be ordered in the following way rt rs bag rf and svm machine learning ensemble models are used to forecast eto as they are much precise than any empirical model however empirical models are usually stable whereas unsteady machine learning ensemble models can generate significantly least predictive precision when a new dataset is adopted hassan et al 2017 dong et al 2020 among the studied ensemble models rt and rf models found as the best combination of precision and more constancy followed by the bag rs and svm models thus the prediction accuracy computational costs as well as stability based on the complexity level of the studied models the comparatively tree based rt and rf models are suggested for daily eto prediction although the tree based rf ensemble model exhibited relative higher accuracy and stability than bag rs and svm ensemble models but revealed more computational costs than those models practically many data driven models commonly consider a single dataset for training and a single dataset for testing which may be misled or provide solely partially robust conclusions because the performance precision is only stated to a specific pattern of the original dataset collection and maybe not typical shiri et al 2014 shiri 2018 martí et al 2015 in practice the definition of the dataset added in each dataset is vital for appraising the model performance however in many cases a cross validation strategy is enough for confirming valid performance appraisal although most complex strategies like bootstrap may be used kohavi 1995 thus the performance of any models highly based on the data patterns and climatic regions for instance a similar model revealed different performances in different studies under various climatic settings fan et al 2018 wu and fan 2019 similar to our study several scholars e g thaseen and kumar 2013 kalmegh 2015 mishra and ratha 2016 kaur 2018 found that the rt model performed better than rf model table s1 so this study recommended that tree based rt can be a promising machine learning ensemble model considering precision constancy and computation cost for daily eto prediction using limited climate datasets in the various climatic zones of bangladesh and may apply to similar climates worldwide however future research is required to appraise the performance of potential rt models at various periods e g hourly or monthly scales or other similar regions of the world with humid subtropical climates 4 5 contribution of the influencing factors on observed and predicted daily eto the key driver of the eto system in bangladesh is the wind speed u2 and solar radiation as well as other climatic factors such as sea surface temperature topographic influence and land atmosphere circulation mcvicar and roderick 2010 li et al 2018b wang et al 2019 these drivers may be responsible for the daily eto variation in a particular climatic zone change in daily eto estimation and prediction has a strong association with the wind speed and solar radiation which move southward to increase easterlies our finding showed that overall evapotranspiration in bangladesh is affected by the change of u2 for the observed eto and rs for the predicted eto mostly many studies have reported that solar radiation and wind speed are the most contributing climatic variables influencing eto variation in different countries yang et al 2011 tabari et al 2012 herath et al 2018 maček et al 2018 duethmann and blöschl 2018 this is further supported by the study exhibiting that five climatic variables included where wind speed u2 and solar radiation are the most climatological contributing factor and the relative humidity hr is the second highest influencing factor in the variability of observed and predicted daily eto chen et al 2006 argued that relative humidity was the second most contributing factor affecting eto variation which was following this study similar to our study wang et al 2019 reported that the order of the rank of climatic variables is sunshine duration followed by temperature relative humidity and wind speed mostly associated with eto changes in southwest china the present study reveals that u2 and rs had a strong impact on daily eto changes in bangladesh apart from the strong impact of wind speed and solar radiation with the eto system intense human induced activities such as land use variation improved irrigation system use of greenhouse gases for growing crop productions regional precipitation changes cloud microphysics for aerosol effects may be affected by eto changes in bangladesh the association between greenhouse gases and human induced aerosols influenced the evaporation paradox that should be explored in further studies the future research should be focused on investigating the contribution of human activities in regional climate change analyzing the mechanisms of eto enhancing crop water demand for water limited regions to give a better decision making for the planning of sustainable water resource and agricultural irrigation system in bangladesh 5 conclusions we presented the potential of novel tree based rt model and meta based bagging and rs models for precisely estimating daily eto with four input combinations of climate datasets in seven climatic regions of bangladesh these ensemble models were compared with two commonly applied tree based rf models and kernel based svm models using the daily climatic dataset from nine meteorological stations of bangladesh during 1983 2017 the probable causes of the observed and predicted daily eto changes were also investigated the main conclusions were drawn from the present study as follows when lacking complete climatic variables five ensemble models could obtain satisfactory precision for estimating daily eto using tmax tmin and rs as 3 input combinations in all climatic regions of bangladesh the tmax tmin rs u2 and hr were found to be the best input combinations in seven climatic regions except for south central and south western regions while tmax tmin and ra were detected the least input combinations for the predicting daily eto during the training and testing phases the rt and rf models offered superior forecasting precision higher value of r2 and lower value of rmse and mae and much stable in both complete and incomplete combinations of input variables than other bagging rs and svm models considering the best prediction accuracy and consistency and much less computational costs the tree based rt model outperformed other models followed by rf bagging rs and svm overall the comparatively simple tree based rt and rf models are highly suggested as potential alternative tools for estimating daily eto with the limited weather datasets in the subtropical humid climate of bangladesh the importance degree calculated for the four climatic variables using the rf machine learning model revealed that wind speed u2 is the primary influential variable for the observed daily eto and solar radiation rs for the predicted daily eto which affects the evapotranspiration variations in bangladesh the relative humidity is the second largest contributing factor influencing the evapotranspiration system our study implies that a possible decrease in the wind speed combined with solar radiation and relative humidity decline might have lower evapotranspiration which could lead to the evaporation paradox in the future due to the high impact of these three climatic variables on the eto the results of the study will be helpful for irrigation engineers hydrologists and researchers who plan simulate or appraise the performance of different ensemble models also policymakers and practitioners will use for future agricultural water resource management in bangladesh under global warming declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful to the authority of begum rokeya university brur and bangladesh meteorological department bmd dhaka bangladesh for providing data facilities and others logistic support during the research period authors contributions r salam and a r m t islam conceived and designed the study r salam conducted and contributed to the analysis both r salam and a r m t islam interpreted the analytical data and drafted the manuscript finally both authors read and approved the final manuscript funding the authors received no specific funding for this research work appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125241 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5188,poor forecasting of climate variables at river basin scale leads to situations which entail considerable risks and losses in various sectors such as the agriculture the environment and water resources lack of accurate sub seasonal and seasonal precipitation predictions are major management and operation predicaments in the transboundary sistan basin located in afghanistan and iran and selected as the case study in this paper the outputs of thenorth american multi model ensemble nmme as a seasonalforecasting system were utilized in the target region in order to evaluate the performance of the raw outputs of four nmme models namely ncep cfsv2 cmc cancm3 cmc2 cancm4 ncar ccsm4 the individual model ensemble mean was compared to the observations results highlighted the need for post processing of the nmme outputs for this purpose three different commonly used methods including grandnmme bias correction quantile mapping qm and copula approaches alongside a novel hybrid technique were applied to improve future predictions of precipitation patterns for the hindcast period of 1982 2010 and forecast period of 2012 2016 all four methods were performed for each month in each 0 5 degree cell over the following one to six months the findings demonstrated the performance of different nmme models were not the same over time and space among the models the ncep cfsv2 and cmc2 cancm4 seemed to best capture the spatial variability of precipitation in the study area in addition they performed better in estimating the amounts of precipitation among the methods the qm the copula and the hybrid were all successful in improving the geographic patterns of the data furthermore they were all able to enhance the accuracy of the data at different timescales the hybrid method showed substantial improvements over the seasonal predictions overall the findings illustrated that collective use of methods may narrow the potential uncertainty in projections of regional changes keywords bias correction copula method hybrid method nmme precipitation forecasts 1 introduction providing reliable monthly and seasonal climate forecasts especially in water scarce regions renders decision makers the optimalplanningofwater resources allocations so far several studies have been conducted to investigate short term climate projections e g the global forecast system gfs forecasts as well as long term predictions e g forecasts of the general circulation models gcms based on intergovernmental panel on climate change ipcc scenarios however few studies have addressed those numerical models providing monthly and seasonal medium term forecasts a common approach in these studies is to evaluate the accuracy of the different models and apply post processing methods to assist the outputs of the models different methods have been proposed to predict climate variables or to modify the outputs of the numerical climate models one of the most common approaches in relevant studies is the statistical approach statistical methods such as data driven methods and artificial intelligence methods are based on the use of climate variables as well as time series data fallah ghalhary et al 2009 nikbakht shahbazi et al 2012 modaresi et al 2015 xu et al 2018 another approach is to use dynamic statistical methods in which the outputs of dynamic models are statistically post processed in this technique the data is statistically downscaled with appropriate spatial resolution khalili et al 2013 tian et al 2014 kim et al 2014 shukla et al 2014 liu et al 2015 barnston et al 2015 ma et al 2016 barbero et al 2017 anuchaivong et al 2017 delsole and banerjee 2017 satti et al 2017 though the study of medium range predictions has been seldom documented the performance of such global models for drought and flood predictions need to be more investigated locally the north american multi model ensemble nmme is a seasonal forecasting system consisting of coupled models providing valuable climate variables predictions at different lead times some studies have applied the nmme forecasts and evaluated the performance of nmme predictions over different regions and from various perspectives bastola et al 2013 infanti and kirtman 2014 delsole et al 2014 yuan et al 2015 ehsan et al 2016 ma et al 2016 madadgar et al 2016 shukla et al 2016 bastola et al 2013 assessed the skill of seasonal hydrological prediction experiments over 28 watersheds throughout the southeastern united states they focused on the hindcast period of 1982 to 2008 and then the retrospective prediction of streamflow was based on multiple calibrated rainfall runoff models and concluded the performance of models varying with season and location similar approach was also utilized to analyze seasonal forecasting of hydrologic extremes at major river basins over the globe yuan et al 2015 they found that increasing the number of models will substantially improve the performance of predictions infanti and kirtman 2014 analyzed the skill of precipitation predictions of nmme models with a focus on southeastern united states they revealed that the nmme system consistently showed low systematic error and relatively high skill in predicting precipitation particularly in winter months as compared to individual model results delsole et al 2014 proposed an objective procedure for deciding if the skill of a combination of forecasts is larger than that of a single forecast and for deciding if the observed improvement is dominated by reduction of noise associated with ensemble averaging or by addition of new predictable signals the procedure was applied to el niño southern oscillation hindcasts from nmme and found that the observed skill advantage of the nmme compared to individual models was greater than that expected from increased ensemble size alone and was more consistent with the addition of new signals madadgar et al 2016 introduced an approach to bias correct and improve the nmme prediction data over california and nevada given the importance of skillful meteorological forecasts the main goals of the present study are organized as follows a evaluating the performance of the raw nmme precipitation data over the target region as well as inter model differences b developing a novel hybrid post processing technique joining the model hindcasts and historical observational data in order to promote the performance of the nmme monthly forecast data c comparing the skill of the proposed hybrid method with some other under debated methods namely the grandnmme quantile mapping qm and copula methods and d determining the improvements made by the methods for 1 month to 6 month forecasts the study was conducted in sistan basin stretching across parts of south western afghanistan and south eastern iran facing many problems including floods and droughts research shows that water stress in this area is classified as water scarcity therefore reliable precipitation predictions with the help of nmme data can be applied in medium term planning to alleviatethese problems the rest of the paper is organized in the following sections sect 2 introduces the case study the used nmme models as the materials of the study and methodology which describes the concept of the used enhancement methods and the hybrid technique in three subsections next the results of the proposed approaches for the selected study area are given in sect 3 and finally several discussions and concluding remarks are presented in sect 4 2 materials and methods 2 1 study area the sistan basin stretches across parts of south western afghanistan including helmand hirmand river basin and south eastern iran including sistan and baluchestan province fig 1 the basin is one of the driest in the world facing prolonged droughts helmand river draining most of the basin with a length of more than 1000 km is fed by the snowmelt of the hindu kush mountains most of the water flows through a channel called the sistan river into lake hamoun which is entirely located in iran the prevailing climate of the region is desert and arid with an average annual rainfall of about 200 mm and an average annual temperature of about 20 c research indicates that water stress in this area is classified as water scarcity as a result skillful precipitation forecasts can be used in medium term planning to assist alleviate conditions 2 2 data sources 2 2 1 observational data in this study the global precipitation climatology centre gpcc data was utilized at 0 5 spatial resolution as the reference database gpcc operated by the germany s national meteorological service the deutscher wetterdienst dwd under the auspices of theworld meteorological organization wmo in 1989 gathers in situ precipitation data across the globe to analyze precipitation over land schneider et al 2018 2 2 2 nmme data nmme is an experimental multi model seasonal forecasting system consisting of coupled models from the united states modeling centers including the national oceanic and atmospheric administration and the national center for environmental prediction noaa ncep the noaa s geophysical fluid dynamics laboratory noaa gfdl the international research institute iri the national center for atmospheric research ncar the national aeronautics and space administration nasa and the environment canada s canadian meteorological centre cmc the nmme models used in the study produce monthly forecasts of climatic variables such as precipitation for the next 9 and 11 months in the process of producing the predictions sources of uncertainty especially initial conditions uncertainty are considered as ensemble members access to hindcast and forecast data of nmme models has been available to all users since 2011 table 1 gives more information about the used nmme models as described in khajehei et al 2017 and ma et al 2017 these models were regridded to 0 5 0 5 for a more detailed assessment the four seasonal forecasting systems used in the study included 54 ensemble members for the hindcast period 1982 2010 and 58 ensemble members for the forecast period 2012 2016 in the present study post processing methods were applied directly to the ensemble means of each individual model 2 3 methodology this study proposes a precipitation prediction framework that combines the dynamical nmme forecasts with statistical methods in each 0 5 degree cell across the study area for this purpose four post processing methods including the grandnmme quantile mapping qm copula and hybrid methods were utilized then the forecast produced from the dynamical and statistical methods were compared all four of the methods were performed for each month over the next one to six months note that precipitation anomalies were calculated based on the average precipitation for each forecast period over 1982 2010 at each grid cell using gpcc data so below average precipitation and above average precipitation are considered as negative anomaly and positive anomaly respectively in the following a brief overview of the proposed methods is elaborated 2 3 1 grandnmme method in this method the arithmetic mean of the predictions derived from the raw nmme data is considered as the precipitation amount madadgar et al 2016 it is one of the simplest correction methods using all ensemble members with the same weights inheriting their positive and negative features equally cash et al 2017 detailed information about the method is provided in madadgar et al 2016 2 3 2 quantile mapping qm method the idea of the qm method is to correct the distribution function of the simulated precipitation values to agree with the observed distribution function the method attempts to create a transfer function to shift the distribution function of the simulated data to the occurrence distribution of precipitation teutschbein and seibert 2012 fang et al 2015 it is used to adjust mean standard deviation and quantile values of the simulated with the observed precipitation values furthermore it preserves the extremes themeßl et al 2012 it is often assumed that the gamma distribution with shape parameter α and scale parameter β thom 1958 is suitable for distributions of precipitation events piani et al 2010 1 f γ x α β x α 1 1 β α γ α e x β x 0 α β 0 in the present study the gamma cumulative distribution functions cdfs were constructed for both the simulated and observed data for the hindcast and forecast period for each month m teutschbein and seibert 2012 then the following equations were used to bias correct the precipitation values 2 pr hind qm cdf obs 1 cdf hind pr hind m α hind m â β hind m α obs m β obs m 3 pr fore qm cdf obs 1 cdf hind pr fore m α hind m â β hind m α obs m β obs m where prqm is the bias corrected precipitation and hind fore and obs represent the hindcast forecast and observed precipitation data respectively all these mentioned data are categorized into twelve month by month datasets monthly classes fig 2 illustrates an exemplary procedure of the method it is worth nothing that the efficiency of the gamma distribution function was evaluated here with the well known kolmogrov smirov test k s described in sect 2 4 2 3 3 copula based post processing method in this method the forecast improvement relies on the joint distribution functions between the observations and the simulated precipitation data in hindcast period one of the traditional methods of precipitation analysis is the bayesian joint probability approach which is developed by wang et al 2009 and robertson and wang 2011 in this method the joint distributions are investigated by transformation of non gaussian variables into the normal space furthermore using multivariate normal distributions is common to evaluate joint probability distributions copula functions have constructed the joint distributions regardless of the marginal distributions morillas 2005 nelsen 2006 they have been used in different fields of hydrology such as precipitation estimation and drought forecasting laux et al 2009 madadgar and moradkhani 2013 slater and villarini 2017 xu et al 2019 in this paper a bayesian post processing approach based on copula functions was used sadegh et al 2017 same as the previous method the post processing of the predictions using this method requires the assumption of a repetitive past behavior of the system in the future the post processing steps by this method used in this study are described below a categorize data in this respect in the present study 12 time series were produced for predicted and observed data in each 0 5 degree cell so that each time series represents the rainfall in a particular month in successive years in other words same as the other proposed methods the data was divided into twelve monthly classes and the procedure was applied to each class separately b find the marginal distributions this is essentially the distribution that best fit the precipitation data precipitation predictions and the observational data and is required for application of the copula method for this purpose commonly used parametric or nonparametric distributions can be employed unlike parametric distributions in nonparametric distributions no specific form is considered for the model parameters and distribution joe 1997 liebscher 2006 in the present study a normal kernel density distribution was applied as a nonparametric distribution c determine the suitable copula function a copula is a mathematical function which joins or couples a multivariate distribution function to its one dimensional marginal distribution functions sklar 1959 the formulation of the theorem can be described as 4 c 0 1 n 0 1 based on the sklar s theorem in a n dimensional space f can be defined as follows 5 f x 1 x 2 x n c f 1 x 1 f 2 x 2 f n x n where f1 f2 fn are the marginal distribution functions and c represents the copula function so far several copula families have been introduced commonly used copula functions in hydrology are archimedean and elliptical families de michele and salvadori 2003 grimaldi and serinaldi 2006 zhang and singh 2006 the copula functions with their characteristics used in this study are listed in table 2 finding an appropriate copula function can be achieved analytically based on statistical tests in the definition of a copula function initially φ which is called the generator is defined as a continuous and strictly descending function 6 φ 0 1 0 the archimedean copula function is defined as schweizer 1991 brechmann and schepsmeier 2013 7 c f 1 x 1 f 2 x 2 f n x n φ 1 φ f 1 x 1 φ f 2 x 2 φ f n x n where φ 1 notifies the inverse of φ if 0 t φ 0 and in other cases is zero marshall and olkin 1988 and given a distribution function f with invertible margins f1 f2 fn then 8 c f 1 x 1 f 2 x 2 f n x n f f 1 1 f 1 x 1 f 2 1 f 2 x 2 f n 1 f n x n is a copula and c is called elliptical if f is elliptical significant advantages of these copula functions include they are easy to build compared to the other families they have explicit formulas and many of the available copula functions belong to these families d correct the precipitation predictions simulated forecast f at each time step is modified using conditional probability distribution function cpdf of the observed data o the joint pdf of the observation and forecast f f o in bayesian network is written as 9 f f o f f f o f so as copula functions ease the analytical calculation the equation can be replaced with a simpler form as 10 f o f f f o f f f o t f t c u v f f t f o t f f t c u v f o t u f 1 o v f 2 f where f o t f t represents the cpdf of the observation given forecast and f o t and f f t are the pdf of the observation and forecast at time t respectively khajehei et al 2017 the cpdf f o t f t is produced during the following steps 1 choose the predicted value at time t 2 generate random data by sampling from the historical observational data 3 calculate the copula density function for sampled observational data and the forecast at time t 4 obtain the cpdf and 5 estimate the modified forecast based on the cpdf 2 3 4 hybrid method in order to find the best combination of the four selected seasonal forecasting systems taking advantages of the models it is required to weigh each model based on its success in forecasting the amount of precipitation chen and dool 2017 to do this after bias correction of the data it is necessary to determine monthly weights in each 0 5 degree cell in such a way that combination of the models minimize and maximize the mean error me and the correlation coefficient r respectively this necessitates solving a multi objective optimization problem using these two statistical parameters as the objective functions leads to estimation of both the amount of precipitation and the trend of changes as accurately as possible in this respect three prerequisites for decision making are required 1 finding the best feasible solution space of alternatives different combination of models attaining acceptable values of the objectives satisfying the objective set 2 distinguishing between alternatives the possible solutions based on level of the achievement of the objectives based on the value of their objectives and 3 selecting an alternative as the final selection with regards to the previous steps here in order to address these preconditions in finding the best combination of the nmme models the framework proposed by yazdandoost and izadi 2016 was used fig 3 this framework combines non dominated sorting geneticalgorithmii nsga ii to identify the best set of solutions with evaluating the trade offs between any number of objectives entropy method finding the relative importance of the objectives with respect to the uncertain nature of the objectives and technique for order of preference by similarity to ideal solution topsis method with the aim of choosing the best option from the available alternatives detailed information about the proposed framework is provided in yazdandoost and izadi 2016 nsga ii first proposed by deb et al 2002 is able to provide the best possible set of optimal compromise solutions pareto front by intentionally searching a broad range of possible answers while providing a balanced interaction among objectives and constraints in pareto front a solution that is better for one objective cannot be found without necessarily worsening at least one other objective therefore tracking performance of each objective with variation of the other one is the valuable information that can be extracted from pareto front here in the first step the proposed optimization algorithm was used to allocate weights to each model at a 0 5 and monthly spatial temporal resolution o b j e c t i v e s minimize m e l 1 l p i j m o b s l z 1 k w i j m z p i j m z l m a x i m i z e r l 1 l z 1 k w i j m z p i j m z l z 1 k w i j m z p i j m z l p i j m o b s l p i j m o b s l l 1 l z 1 k w i j m z p i j m z l z 1 k w i j d z p i j m z l 2 l 1 l p i j m o b s l p i j m o b s l 2 11 s u b j e c t t o w i j m z 0 z 1 k w i j m z 1 where p i j m z is the amount of rainfall given by the selected zth nmme model by the coordinates of i j on the mth month of the year and w i j m z is the amount of the assigned weight to the nmme model corresponding to the same cell and same month in addition l is the length of the overlapping period between the model and gpcc in years in the next step the entropy method was applied as a weight allocation method to specify the relative importance of objectives the method can evaluate the amount of uncertainty represented by a discrete probability distribution pi implying that a broad distribution represents more uncertainty than a sharply peaked one hwang and yoon 1981 the intervention of uncertainty in decision making phase without any need for complex calculations are the advantages of entropy shannon and weaver 1947 the entropy idea is particularly useful to investigate contrasts between sets of data in other word if all the values for a certain criterion are the same the criterion may be eliminated hwang and yoon 1981 then the final option needs to be selected from the optimal options topsis is a procedure based on the concept that the final alternative should have the shortest geometric distance from the positive ideal solution and the longest geometric distance from the negative ideal solution hwang and yoon 1981 garcía cascales and lamata 2012 at the final step the simple additive weighting saw method was used to generate hybrid precipitation data in other words the monthly precipitation of each 0 5 degree cell was obtained from sum of the weights in the amount of precipitation corresponding to each nmme model detailed information about topsis entropy and saw is provided in hwang and yoon 1981 2 4 evaluation process in this study kolmogorv smirnov test k s was utilized to inspect how well the observation and nmme data fit the gamma distribution this nonparametric test can provide sufficient confidence about the use of the gamma distribution function as the reference distribution suitable for the given data series stephens 1974 12 d m a x f x g x where f x and g x are the empirical and reference cdfs respectively the null hypothesis in k s test is that the reference distribution is able to describe the given dataset observation and forecast with the significance level of α 0 05 if the calculated p value is larger than α the null hypothesis is not rejected and that specific distribution will be chosen among the approved parametric distributions in order to assess the forecast skill of the proposed post processing methods three measures were utilized absolute percent bias continuous ranked probability score and kling gupta efficiency absolute percent bias apb with optimal value of zero deterministically evaluates the deviation of the forecasts from the observations moriasi et al 2007 13 a p b i 1 n f o r e i o b s i i 1 n o b s i 100 where f o r e i is the prediction at time i and o b s i represents the true value the continuous ranked probability score crps is the integral of the brier score at all possible thresholds 14 c r p s f x fore f x obs 2 d x 15 f x obs 0 x o b s e r v e d d a t a 1 x o b s e r v e d d a t a where f x fore is the forecast probability i e cdf of the forecast the optimal value for crps is zero hersbach 2000 the cprs is one of the most widely used accuracy metrics in order to assess the respective accuracy of two probabilistic forecasting models this metric notably differs from simpler metrics because of its asymmetric expression while the forecasts are probabilistic the observations are deterministic the cprs does not focus on any specific point of the probability distribution but considers the distribution of the forecasts as a whole to assess the accuracy of the forecast versus observation the kling gupta efficiency kge measure is utilized gupta et al 2009 16 k g e 1 r 1 2 α 1 2 β 1 2 where r α and β represent the linear correlation coefficient the ratio of variance of forecast to variance in observation and the ratio bias respectively the range of kge is from to 1 with optimal value of 1 3 results and discussion at this stage in order to evaluate the performance of the raw outputs of individual model ensemble mean the coordination of the data with the observations was first investigated fig 4 shows the results of comparing the nmme precipitation forecasted outputs with the observed gpcc data for the month of january during the hindcast and forecast periods as a non limited example with 0 month lead time according to the results the mean value of precipitation observed in january during the hindcast and the forecast periods were around 25 and 18 mm respectively concerning fig 4 results showed that none of the raw models have been able to provide accurate magnitudes and spatial patterns of precipitation in comparison to the observational data however among the models the ncep cfsv2 and cmc2 cancm4 seemed to best capture the spatial variability of precipitation data in addition marginal values did not follow a specific trend results from fig 4 along with previous studies tian et al 2014 yuan et al 2015 madadgar et al 2016 khajehei et al 2017 highlight the need for post processing the nmme outputs as mentioned in the present study the k s test was utilized to investigate how well the data fit the gamma distribution fig 5 shows the results in this figure the cells which the gamma distribution is appropriate for based on the k s test are shown in red and the others are depicted in blue as seen in this figure the fitness of the gamma distribution function is proved in almost all extents of the study area fig 6 illustrates the results of comparing the grandnmme qm copula and hybrid methods with the observed gpcc data in the hindcast and forecast periods for the month of january as a sample for a one month forecast as expected fig 6 shows that the proposed methods have had a significant impact on improving the amounts and geographic patterns of precipitation compared to the raw model estimations fig 4 these improvements are not only visually visible but also quantitatively debatable for this purpose figs 7 and 8 show the hindcast and forecast anomalies of the raw model outputs and the post processing methods respectively as seen in figs 7 and 8 among the raw nmme models as an inter model comparison cmc1 cancm3 overestimated the amounts of precipitation more than the others in the study area while cmc2 cancm4 had the best performance individually compared to the other models during the both of hindcast and forecast periods results of post processing methods also showed that during the month of january as an example the grandnmme and copula methods overestimated the precipitation values as the amount of mean hindcast anomalies were 3 26 and 0 91 mm respectively however these changed to 0 02 and 0 00 mm for the qm and hybrid methods respectively as a brief and simple result the post processing methods enhanced the predictions over the region and in terms of anomalies the grandnmme and the hybrid methods exhibit the lowest and the highest accuracy over the target region respectively as previously mentioned three measures including apb crps and kge were utilized to confirm the proposed methods forecast skill in the area fig 9 presents the results as seen in the figure the proposed post processing methods had significant improvement in terms of apb and crps in addition superiority of the hybrid method is generally magnificent compared to the other methods therefore it can be claimed that the proposed methods can provide a higher accuracy in precipitation predictions in the target region in order to inspect how the increase in lead time affects the accuracy of the raw models and the post processing estimations the same process was carried out for the lead time 5 figs 10 14 show the results for lead 5 comparing these figures with the results of lead 0 reveals that the efficiency of the improvement methods declines as lead time increases but this is not necessarily true for the case of raw outputs as their changes do not follow specific patterns fig 10 focusing on the anomaly plots at lead 5 all the methods overestimated the precipitation data during the forecast period fig 13 but in general the qm copula and hybrid methods slightly modified the results figs 11 14 as there is nointentto limit the analysis of the proposed post processing methods in the month of january they were applied for different months of the year to examine how the prediction s accuracy may change over time for this purpose the results of the improvement methods were presented in a one month forecast table 3 summarizes the results of the methods for the total basin average in the hindcast and forecast periods for all months in cases where nmme models have not produced data the sign is used and the closest values to the observed data are also shown in bold in this table comparing the performance of different post processing methods for each different month proves the superiority of the hybrid method as an effective post processing approach of the nmme precipitation forecasts to have a better understanding of the performance of the methods and compare them over different forecast period lengths table 4 summarizes the results for the month of may as a sample during the hindcast and forecast period for the total basin average same as the previous table the closest values to the observed gpcc data are shown in bold superiority of the hybrid technique to the other methods over different period lengths is more pronounced in this table in addition in cases where this method is not the best there is no significant difference however since the mean values cannot provide the final judgment about the best method the correlation coefficient r was also considered figs 15 and 16 illustrate the results of the changes in this index for the total basin average throughout the hindcast and forecast periods based on the results it is concluded that all the methods are able to provide higher accurate predictions in the study area among the methods the qm approach may not improve the predictions since the predicted amount of rainfall in the forecast period exceeds the minimum or maximum of the data in the hindcast period the restriction is removed in the copula method using nonparametric distributions and applying dynamic ranges proportional to the minimum and maximum values in the data in addition the hybrid method tries to discover different optimal combinations in general the findings illustrate that if all the prediction improvement methods are used the potential uncertainty in projections of regional changes would be reduced 4 conclusions the present study provided a thorough assessment of the skill of the nmme precipitation data over sistan basin in this respect four nmme models were utilized totaling 54 and 58 ensemble members for the hindcast period of 1982 2010 and the forecast period of 2012 2016 respectively in order to evaluate the performance of the raw outputs of four individual model ensemble means the coordination of the data with the gpcc observations was investigated results highlighted the need for post processing the nmme outputs for this purpose three commonly used methods including the grandnmme bias correction qm and copula methods alongside a novel hybrid technique were applied in the proposed method using a combination of multi criteria decision making methods including nsga ii entropy and topsis monthly weights of the four selected models were calculated for each 0 5 degree cell in such a way that the estimation error and the correlation coefficient of the data were minimized and maximized respectively the major findings are summarized as follows the performance of different nmme models were not the same over time and space among the models the ncep cfsv2 and cmc2 cancm4 models seemed to best capture the spatial variability of precipitation in the study area in addition to the geographic patterns they performed better in estimating the amounts of precipitation overall the predictions are more skillful in the south eastern basin the qm copula and hybrid techniques were all successful in improving the spatial variability of the nmme precipitation data furthermore the copula and hybrid methods were both able to enhance the accuracy of the data overall the findings demonstrated the superiority of the developed hybrid approach in monthly and seasonal precipitation predictions by taking advantages of the individual nmme models and minimizing the negative effects of environmental physical and temporal conditions on the accuracy of the estimated precipitation the proposed approach for developing a precipitation forecasting system can be further strengthened and extended from several aspects 1 although only two metrics depending on precipitation were utilized as the genetic algorithm objective functions the algorithm s performance proved that considering other climatic or environmental parameters could be added as future research to promote the efficiency of the proposed algorithm 2 as the evaluation of different methods depends on desired aims spatial and temporal conditions statistical metrics etc determining the final chosen method is usually associated with uncertainties sensitivity analysis is an approach to handle this type of challenge declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the regional water company of sistan and baluchestan of iran 
5188,poor forecasting of climate variables at river basin scale leads to situations which entail considerable risks and losses in various sectors such as the agriculture the environment and water resources lack of accurate sub seasonal and seasonal precipitation predictions are major management and operation predicaments in the transboundary sistan basin located in afghanistan and iran and selected as the case study in this paper the outputs of thenorth american multi model ensemble nmme as a seasonalforecasting system were utilized in the target region in order to evaluate the performance of the raw outputs of four nmme models namely ncep cfsv2 cmc cancm3 cmc2 cancm4 ncar ccsm4 the individual model ensemble mean was compared to the observations results highlighted the need for post processing of the nmme outputs for this purpose three different commonly used methods including grandnmme bias correction quantile mapping qm and copula approaches alongside a novel hybrid technique were applied to improve future predictions of precipitation patterns for the hindcast period of 1982 2010 and forecast period of 2012 2016 all four methods were performed for each month in each 0 5 degree cell over the following one to six months the findings demonstrated the performance of different nmme models were not the same over time and space among the models the ncep cfsv2 and cmc2 cancm4 seemed to best capture the spatial variability of precipitation in the study area in addition they performed better in estimating the amounts of precipitation among the methods the qm the copula and the hybrid were all successful in improving the geographic patterns of the data furthermore they were all able to enhance the accuracy of the data at different timescales the hybrid method showed substantial improvements over the seasonal predictions overall the findings illustrated that collective use of methods may narrow the potential uncertainty in projections of regional changes keywords bias correction copula method hybrid method nmme precipitation forecasts 1 introduction providing reliable monthly and seasonal climate forecasts especially in water scarce regions renders decision makers the optimalplanningofwater resources allocations so far several studies have been conducted to investigate short term climate projections e g the global forecast system gfs forecasts as well as long term predictions e g forecasts of the general circulation models gcms based on intergovernmental panel on climate change ipcc scenarios however few studies have addressed those numerical models providing monthly and seasonal medium term forecasts a common approach in these studies is to evaluate the accuracy of the different models and apply post processing methods to assist the outputs of the models different methods have been proposed to predict climate variables or to modify the outputs of the numerical climate models one of the most common approaches in relevant studies is the statistical approach statistical methods such as data driven methods and artificial intelligence methods are based on the use of climate variables as well as time series data fallah ghalhary et al 2009 nikbakht shahbazi et al 2012 modaresi et al 2015 xu et al 2018 another approach is to use dynamic statistical methods in which the outputs of dynamic models are statistically post processed in this technique the data is statistically downscaled with appropriate spatial resolution khalili et al 2013 tian et al 2014 kim et al 2014 shukla et al 2014 liu et al 2015 barnston et al 2015 ma et al 2016 barbero et al 2017 anuchaivong et al 2017 delsole and banerjee 2017 satti et al 2017 though the study of medium range predictions has been seldom documented the performance of such global models for drought and flood predictions need to be more investigated locally the north american multi model ensemble nmme is a seasonal forecasting system consisting of coupled models providing valuable climate variables predictions at different lead times some studies have applied the nmme forecasts and evaluated the performance of nmme predictions over different regions and from various perspectives bastola et al 2013 infanti and kirtman 2014 delsole et al 2014 yuan et al 2015 ehsan et al 2016 ma et al 2016 madadgar et al 2016 shukla et al 2016 bastola et al 2013 assessed the skill of seasonal hydrological prediction experiments over 28 watersheds throughout the southeastern united states they focused on the hindcast period of 1982 to 2008 and then the retrospective prediction of streamflow was based on multiple calibrated rainfall runoff models and concluded the performance of models varying with season and location similar approach was also utilized to analyze seasonal forecasting of hydrologic extremes at major river basins over the globe yuan et al 2015 they found that increasing the number of models will substantially improve the performance of predictions infanti and kirtman 2014 analyzed the skill of precipitation predictions of nmme models with a focus on southeastern united states they revealed that the nmme system consistently showed low systematic error and relatively high skill in predicting precipitation particularly in winter months as compared to individual model results delsole et al 2014 proposed an objective procedure for deciding if the skill of a combination of forecasts is larger than that of a single forecast and for deciding if the observed improvement is dominated by reduction of noise associated with ensemble averaging or by addition of new predictable signals the procedure was applied to el niño southern oscillation hindcasts from nmme and found that the observed skill advantage of the nmme compared to individual models was greater than that expected from increased ensemble size alone and was more consistent with the addition of new signals madadgar et al 2016 introduced an approach to bias correct and improve the nmme prediction data over california and nevada given the importance of skillful meteorological forecasts the main goals of the present study are organized as follows a evaluating the performance of the raw nmme precipitation data over the target region as well as inter model differences b developing a novel hybrid post processing technique joining the model hindcasts and historical observational data in order to promote the performance of the nmme monthly forecast data c comparing the skill of the proposed hybrid method with some other under debated methods namely the grandnmme quantile mapping qm and copula methods and d determining the improvements made by the methods for 1 month to 6 month forecasts the study was conducted in sistan basin stretching across parts of south western afghanistan and south eastern iran facing many problems including floods and droughts research shows that water stress in this area is classified as water scarcity therefore reliable precipitation predictions with the help of nmme data can be applied in medium term planning to alleviatethese problems the rest of the paper is organized in the following sections sect 2 introduces the case study the used nmme models as the materials of the study and methodology which describes the concept of the used enhancement methods and the hybrid technique in three subsections next the results of the proposed approaches for the selected study area are given in sect 3 and finally several discussions and concluding remarks are presented in sect 4 2 materials and methods 2 1 study area the sistan basin stretches across parts of south western afghanistan including helmand hirmand river basin and south eastern iran including sistan and baluchestan province fig 1 the basin is one of the driest in the world facing prolonged droughts helmand river draining most of the basin with a length of more than 1000 km is fed by the snowmelt of the hindu kush mountains most of the water flows through a channel called the sistan river into lake hamoun which is entirely located in iran the prevailing climate of the region is desert and arid with an average annual rainfall of about 200 mm and an average annual temperature of about 20 c research indicates that water stress in this area is classified as water scarcity as a result skillful precipitation forecasts can be used in medium term planning to assist alleviate conditions 2 2 data sources 2 2 1 observational data in this study the global precipitation climatology centre gpcc data was utilized at 0 5 spatial resolution as the reference database gpcc operated by the germany s national meteorological service the deutscher wetterdienst dwd under the auspices of theworld meteorological organization wmo in 1989 gathers in situ precipitation data across the globe to analyze precipitation over land schneider et al 2018 2 2 2 nmme data nmme is an experimental multi model seasonal forecasting system consisting of coupled models from the united states modeling centers including the national oceanic and atmospheric administration and the national center for environmental prediction noaa ncep the noaa s geophysical fluid dynamics laboratory noaa gfdl the international research institute iri the national center for atmospheric research ncar the national aeronautics and space administration nasa and the environment canada s canadian meteorological centre cmc the nmme models used in the study produce monthly forecasts of climatic variables such as precipitation for the next 9 and 11 months in the process of producing the predictions sources of uncertainty especially initial conditions uncertainty are considered as ensemble members access to hindcast and forecast data of nmme models has been available to all users since 2011 table 1 gives more information about the used nmme models as described in khajehei et al 2017 and ma et al 2017 these models were regridded to 0 5 0 5 for a more detailed assessment the four seasonal forecasting systems used in the study included 54 ensemble members for the hindcast period 1982 2010 and 58 ensemble members for the forecast period 2012 2016 in the present study post processing methods were applied directly to the ensemble means of each individual model 2 3 methodology this study proposes a precipitation prediction framework that combines the dynamical nmme forecasts with statistical methods in each 0 5 degree cell across the study area for this purpose four post processing methods including the grandnmme quantile mapping qm copula and hybrid methods were utilized then the forecast produced from the dynamical and statistical methods were compared all four of the methods were performed for each month over the next one to six months note that precipitation anomalies were calculated based on the average precipitation for each forecast period over 1982 2010 at each grid cell using gpcc data so below average precipitation and above average precipitation are considered as negative anomaly and positive anomaly respectively in the following a brief overview of the proposed methods is elaborated 2 3 1 grandnmme method in this method the arithmetic mean of the predictions derived from the raw nmme data is considered as the precipitation amount madadgar et al 2016 it is one of the simplest correction methods using all ensemble members with the same weights inheriting their positive and negative features equally cash et al 2017 detailed information about the method is provided in madadgar et al 2016 2 3 2 quantile mapping qm method the idea of the qm method is to correct the distribution function of the simulated precipitation values to agree with the observed distribution function the method attempts to create a transfer function to shift the distribution function of the simulated data to the occurrence distribution of precipitation teutschbein and seibert 2012 fang et al 2015 it is used to adjust mean standard deviation and quantile values of the simulated with the observed precipitation values furthermore it preserves the extremes themeßl et al 2012 it is often assumed that the gamma distribution with shape parameter α and scale parameter β thom 1958 is suitable for distributions of precipitation events piani et al 2010 1 f γ x α β x α 1 1 β α γ α e x β x 0 α β 0 in the present study the gamma cumulative distribution functions cdfs were constructed for both the simulated and observed data for the hindcast and forecast period for each month m teutschbein and seibert 2012 then the following equations were used to bias correct the precipitation values 2 pr hind qm cdf obs 1 cdf hind pr hind m α hind m â β hind m α obs m β obs m 3 pr fore qm cdf obs 1 cdf hind pr fore m α hind m â β hind m α obs m β obs m where prqm is the bias corrected precipitation and hind fore and obs represent the hindcast forecast and observed precipitation data respectively all these mentioned data are categorized into twelve month by month datasets monthly classes fig 2 illustrates an exemplary procedure of the method it is worth nothing that the efficiency of the gamma distribution function was evaluated here with the well known kolmogrov smirov test k s described in sect 2 4 2 3 3 copula based post processing method in this method the forecast improvement relies on the joint distribution functions between the observations and the simulated precipitation data in hindcast period one of the traditional methods of precipitation analysis is the bayesian joint probability approach which is developed by wang et al 2009 and robertson and wang 2011 in this method the joint distributions are investigated by transformation of non gaussian variables into the normal space furthermore using multivariate normal distributions is common to evaluate joint probability distributions copula functions have constructed the joint distributions regardless of the marginal distributions morillas 2005 nelsen 2006 they have been used in different fields of hydrology such as precipitation estimation and drought forecasting laux et al 2009 madadgar and moradkhani 2013 slater and villarini 2017 xu et al 2019 in this paper a bayesian post processing approach based on copula functions was used sadegh et al 2017 same as the previous method the post processing of the predictions using this method requires the assumption of a repetitive past behavior of the system in the future the post processing steps by this method used in this study are described below a categorize data in this respect in the present study 12 time series were produced for predicted and observed data in each 0 5 degree cell so that each time series represents the rainfall in a particular month in successive years in other words same as the other proposed methods the data was divided into twelve monthly classes and the procedure was applied to each class separately b find the marginal distributions this is essentially the distribution that best fit the precipitation data precipitation predictions and the observational data and is required for application of the copula method for this purpose commonly used parametric or nonparametric distributions can be employed unlike parametric distributions in nonparametric distributions no specific form is considered for the model parameters and distribution joe 1997 liebscher 2006 in the present study a normal kernel density distribution was applied as a nonparametric distribution c determine the suitable copula function a copula is a mathematical function which joins or couples a multivariate distribution function to its one dimensional marginal distribution functions sklar 1959 the formulation of the theorem can be described as 4 c 0 1 n 0 1 based on the sklar s theorem in a n dimensional space f can be defined as follows 5 f x 1 x 2 x n c f 1 x 1 f 2 x 2 f n x n where f1 f2 fn are the marginal distribution functions and c represents the copula function so far several copula families have been introduced commonly used copula functions in hydrology are archimedean and elliptical families de michele and salvadori 2003 grimaldi and serinaldi 2006 zhang and singh 2006 the copula functions with their characteristics used in this study are listed in table 2 finding an appropriate copula function can be achieved analytically based on statistical tests in the definition of a copula function initially φ which is called the generator is defined as a continuous and strictly descending function 6 φ 0 1 0 the archimedean copula function is defined as schweizer 1991 brechmann and schepsmeier 2013 7 c f 1 x 1 f 2 x 2 f n x n φ 1 φ f 1 x 1 φ f 2 x 2 φ f n x n where φ 1 notifies the inverse of φ if 0 t φ 0 and in other cases is zero marshall and olkin 1988 and given a distribution function f with invertible margins f1 f2 fn then 8 c f 1 x 1 f 2 x 2 f n x n f f 1 1 f 1 x 1 f 2 1 f 2 x 2 f n 1 f n x n is a copula and c is called elliptical if f is elliptical significant advantages of these copula functions include they are easy to build compared to the other families they have explicit formulas and many of the available copula functions belong to these families d correct the precipitation predictions simulated forecast f at each time step is modified using conditional probability distribution function cpdf of the observed data o the joint pdf of the observation and forecast f f o in bayesian network is written as 9 f f o f f f o f so as copula functions ease the analytical calculation the equation can be replaced with a simpler form as 10 f o f f f o f f f o t f t c u v f f t f o t f f t c u v f o t u f 1 o v f 2 f where f o t f t represents the cpdf of the observation given forecast and f o t and f f t are the pdf of the observation and forecast at time t respectively khajehei et al 2017 the cpdf f o t f t is produced during the following steps 1 choose the predicted value at time t 2 generate random data by sampling from the historical observational data 3 calculate the copula density function for sampled observational data and the forecast at time t 4 obtain the cpdf and 5 estimate the modified forecast based on the cpdf 2 3 4 hybrid method in order to find the best combination of the four selected seasonal forecasting systems taking advantages of the models it is required to weigh each model based on its success in forecasting the amount of precipitation chen and dool 2017 to do this after bias correction of the data it is necessary to determine monthly weights in each 0 5 degree cell in such a way that combination of the models minimize and maximize the mean error me and the correlation coefficient r respectively this necessitates solving a multi objective optimization problem using these two statistical parameters as the objective functions leads to estimation of both the amount of precipitation and the trend of changes as accurately as possible in this respect three prerequisites for decision making are required 1 finding the best feasible solution space of alternatives different combination of models attaining acceptable values of the objectives satisfying the objective set 2 distinguishing between alternatives the possible solutions based on level of the achievement of the objectives based on the value of their objectives and 3 selecting an alternative as the final selection with regards to the previous steps here in order to address these preconditions in finding the best combination of the nmme models the framework proposed by yazdandoost and izadi 2016 was used fig 3 this framework combines non dominated sorting geneticalgorithmii nsga ii to identify the best set of solutions with evaluating the trade offs between any number of objectives entropy method finding the relative importance of the objectives with respect to the uncertain nature of the objectives and technique for order of preference by similarity to ideal solution topsis method with the aim of choosing the best option from the available alternatives detailed information about the proposed framework is provided in yazdandoost and izadi 2016 nsga ii first proposed by deb et al 2002 is able to provide the best possible set of optimal compromise solutions pareto front by intentionally searching a broad range of possible answers while providing a balanced interaction among objectives and constraints in pareto front a solution that is better for one objective cannot be found without necessarily worsening at least one other objective therefore tracking performance of each objective with variation of the other one is the valuable information that can be extracted from pareto front here in the first step the proposed optimization algorithm was used to allocate weights to each model at a 0 5 and monthly spatial temporal resolution o b j e c t i v e s minimize m e l 1 l p i j m o b s l z 1 k w i j m z p i j m z l m a x i m i z e r l 1 l z 1 k w i j m z p i j m z l z 1 k w i j m z p i j m z l p i j m o b s l p i j m o b s l l 1 l z 1 k w i j m z p i j m z l z 1 k w i j d z p i j m z l 2 l 1 l p i j m o b s l p i j m o b s l 2 11 s u b j e c t t o w i j m z 0 z 1 k w i j m z 1 where p i j m z is the amount of rainfall given by the selected zth nmme model by the coordinates of i j on the mth month of the year and w i j m z is the amount of the assigned weight to the nmme model corresponding to the same cell and same month in addition l is the length of the overlapping period between the model and gpcc in years in the next step the entropy method was applied as a weight allocation method to specify the relative importance of objectives the method can evaluate the amount of uncertainty represented by a discrete probability distribution pi implying that a broad distribution represents more uncertainty than a sharply peaked one hwang and yoon 1981 the intervention of uncertainty in decision making phase without any need for complex calculations are the advantages of entropy shannon and weaver 1947 the entropy idea is particularly useful to investigate contrasts between sets of data in other word if all the values for a certain criterion are the same the criterion may be eliminated hwang and yoon 1981 then the final option needs to be selected from the optimal options topsis is a procedure based on the concept that the final alternative should have the shortest geometric distance from the positive ideal solution and the longest geometric distance from the negative ideal solution hwang and yoon 1981 garcía cascales and lamata 2012 at the final step the simple additive weighting saw method was used to generate hybrid precipitation data in other words the monthly precipitation of each 0 5 degree cell was obtained from sum of the weights in the amount of precipitation corresponding to each nmme model detailed information about topsis entropy and saw is provided in hwang and yoon 1981 2 4 evaluation process in this study kolmogorv smirnov test k s was utilized to inspect how well the observation and nmme data fit the gamma distribution this nonparametric test can provide sufficient confidence about the use of the gamma distribution function as the reference distribution suitable for the given data series stephens 1974 12 d m a x f x g x where f x and g x are the empirical and reference cdfs respectively the null hypothesis in k s test is that the reference distribution is able to describe the given dataset observation and forecast with the significance level of α 0 05 if the calculated p value is larger than α the null hypothesis is not rejected and that specific distribution will be chosen among the approved parametric distributions in order to assess the forecast skill of the proposed post processing methods three measures were utilized absolute percent bias continuous ranked probability score and kling gupta efficiency absolute percent bias apb with optimal value of zero deterministically evaluates the deviation of the forecasts from the observations moriasi et al 2007 13 a p b i 1 n f o r e i o b s i i 1 n o b s i 100 where f o r e i is the prediction at time i and o b s i represents the true value the continuous ranked probability score crps is the integral of the brier score at all possible thresholds 14 c r p s f x fore f x obs 2 d x 15 f x obs 0 x o b s e r v e d d a t a 1 x o b s e r v e d d a t a where f x fore is the forecast probability i e cdf of the forecast the optimal value for crps is zero hersbach 2000 the cprs is one of the most widely used accuracy metrics in order to assess the respective accuracy of two probabilistic forecasting models this metric notably differs from simpler metrics because of its asymmetric expression while the forecasts are probabilistic the observations are deterministic the cprs does not focus on any specific point of the probability distribution but considers the distribution of the forecasts as a whole to assess the accuracy of the forecast versus observation the kling gupta efficiency kge measure is utilized gupta et al 2009 16 k g e 1 r 1 2 α 1 2 β 1 2 where r α and β represent the linear correlation coefficient the ratio of variance of forecast to variance in observation and the ratio bias respectively the range of kge is from to 1 with optimal value of 1 3 results and discussion at this stage in order to evaluate the performance of the raw outputs of individual model ensemble mean the coordination of the data with the observations was first investigated fig 4 shows the results of comparing the nmme precipitation forecasted outputs with the observed gpcc data for the month of january during the hindcast and forecast periods as a non limited example with 0 month lead time according to the results the mean value of precipitation observed in january during the hindcast and the forecast periods were around 25 and 18 mm respectively concerning fig 4 results showed that none of the raw models have been able to provide accurate magnitudes and spatial patterns of precipitation in comparison to the observational data however among the models the ncep cfsv2 and cmc2 cancm4 seemed to best capture the spatial variability of precipitation data in addition marginal values did not follow a specific trend results from fig 4 along with previous studies tian et al 2014 yuan et al 2015 madadgar et al 2016 khajehei et al 2017 highlight the need for post processing the nmme outputs as mentioned in the present study the k s test was utilized to investigate how well the data fit the gamma distribution fig 5 shows the results in this figure the cells which the gamma distribution is appropriate for based on the k s test are shown in red and the others are depicted in blue as seen in this figure the fitness of the gamma distribution function is proved in almost all extents of the study area fig 6 illustrates the results of comparing the grandnmme qm copula and hybrid methods with the observed gpcc data in the hindcast and forecast periods for the month of january as a sample for a one month forecast as expected fig 6 shows that the proposed methods have had a significant impact on improving the amounts and geographic patterns of precipitation compared to the raw model estimations fig 4 these improvements are not only visually visible but also quantitatively debatable for this purpose figs 7 and 8 show the hindcast and forecast anomalies of the raw model outputs and the post processing methods respectively as seen in figs 7 and 8 among the raw nmme models as an inter model comparison cmc1 cancm3 overestimated the amounts of precipitation more than the others in the study area while cmc2 cancm4 had the best performance individually compared to the other models during the both of hindcast and forecast periods results of post processing methods also showed that during the month of january as an example the grandnmme and copula methods overestimated the precipitation values as the amount of mean hindcast anomalies were 3 26 and 0 91 mm respectively however these changed to 0 02 and 0 00 mm for the qm and hybrid methods respectively as a brief and simple result the post processing methods enhanced the predictions over the region and in terms of anomalies the grandnmme and the hybrid methods exhibit the lowest and the highest accuracy over the target region respectively as previously mentioned three measures including apb crps and kge were utilized to confirm the proposed methods forecast skill in the area fig 9 presents the results as seen in the figure the proposed post processing methods had significant improvement in terms of apb and crps in addition superiority of the hybrid method is generally magnificent compared to the other methods therefore it can be claimed that the proposed methods can provide a higher accuracy in precipitation predictions in the target region in order to inspect how the increase in lead time affects the accuracy of the raw models and the post processing estimations the same process was carried out for the lead time 5 figs 10 14 show the results for lead 5 comparing these figures with the results of lead 0 reveals that the efficiency of the improvement methods declines as lead time increases but this is not necessarily true for the case of raw outputs as their changes do not follow specific patterns fig 10 focusing on the anomaly plots at lead 5 all the methods overestimated the precipitation data during the forecast period fig 13 but in general the qm copula and hybrid methods slightly modified the results figs 11 14 as there is nointentto limit the analysis of the proposed post processing methods in the month of january they were applied for different months of the year to examine how the prediction s accuracy may change over time for this purpose the results of the improvement methods were presented in a one month forecast table 3 summarizes the results of the methods for the total basin average in the hindcast and forecast periods for all months in cases where nmme models have not produced data the sign is used and the closest values to the observed data are also shown in bold in this table comparing the performance of different post processing methods for each different month proves the superiority of the hybrid method as an effective post processing approach of the nmme precipitation forecasts to have a better understanding of the performance of the methods and compare them over different forecast period lengths table 4 summarizes the results for the month of may as a sample during the hindcast and forecast period for the total basin average same as the previous table the closest values to the observed gpcc data are shown in bold superiority of the hybrid technique to the other methods over different period lengths is more pronounced in this table in addition in cases where this method is not the best there is no significant difference however since the mean values cannot provide the final judgment about the best method the correlation coefficient r was also considered figs 15 and 16 illustrate the results of the changes in this index for the total basin average throughout the hindcast and forecast periods based on the results it is concluded that all the methods are able to provide higher accurate predictions in the study area among the methods the qm approach may not improve the predictions since the predicted amount of rainfall in the forecast period exceeds the minimum or maximum of the data in the hindcast period the restriction is removed in the copula method using nonparametric distributions and applying dynamic ranges proportional to the minimum and maximum values in the data in addition the hybrid method tries to discover different optimal combinations in general the findings illustrate that if all the prediction improvement methods are used the potential uncertainty in projections of regional changes would be reduced 4 conclusions the present study provided a thorough assessment of the skill of the nmme precipitation data over sistan basin in this respect four nmme models were utilized totaling 54 and 58 ensemble members for the hindcast period of 1982 2010 and the forecast period of 2012 2016 respectively in order to evaluate the performance of the raw outputs of four individual model ensemble means the coordination of the data with the gpcc observations was investigated results highlighted the need for post processing the nmme outputs for this purpose three commonly used methods including the grandnmme bias correction qm and copula methods alongside a novel hybrid technique were applied in the proposed method using a combination of multi criteria decision making methods including nsga ii entropy and topsis monthly weights of the four selected models were calculated for each 0 5 degree cell in such a way that the estimation error and the correlation coefficient of the data were minimized and maximized respectively the major findings are summarized as follows the performance of different nmme models were not the same over time and space among the models the ncep cfsv2 and cmc2 cancm4 models seemed to best capture the spatial variability of precipitation in the study area in addition to the geographic patterns they performed better in estimating the amounts of precipitation overall the predictions are more skillful in the south eastern basin the qm copula and hybrid techniques were all successful in improving the spatial variability of the nmme precipitation data furthermore the copula and hybrid methods were both able to enhance the accuracy of the data overall the findings demonstrated the superiority of the developed hybrid approach in monthly and seasonal precipitation predictions by taking advantages of the individual nmme models and minimizing the negative effects of environmental physical and temporal conditions on the accuracy of the estimated precipitation the proposed approach for developing a precipitation forecasting system can be further strengthened and extended from several aspects 1 although only two metrics depending on precipitation were utilized as the genetic algorithm objective functions the algorithm s performance proved that considering other climatic or environmental parameters could be added as future research to promote the efficiency of the proposed algorithm 2 as the evaluation of different methods depends on desired aims spatial and temporal conditions statistical metrics etc determining the final chosen method is usually associated with uncertainties sensitivity analysis is an approach to handle this type of challenge declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the regional water company of sistan and baluchestan of iran 
5189,describing and mapping soil water content swc distribution are required to understand and explain the hydrological phenomena at various spatial scales soil drought in the hilly and gully regions of loess plateau reduces agricultural production and plants biomass which has attracted great attention but few studies associated it with the gullied terrain to understand the swc distribution pattern in the slope gully system we established a cross section transect for swc observation across a permanent gully and acquired 23 occasions of swc data in the periods from october 2014 to september 2018 the standardized beta coefficient in stepwise multiple linear regression was employed to determine the strength of the effect of the selected variables soil textural separates soil depth relative height distance to the gully and saturated hydraulic conductivity on sws distribution spectral and cross spectral analysis were performed on the time series of swc to evaluate the cyclical behavior and the similarity for adjacent sites respectively the following results were obtained first the swc distribution had a bilateral asymmetrical pattern across the gully which constituted a specific and detailed content of spatial variability of swc second soil water storage in the slope gully system was primarily affected by soil texture meanwhile the effect of distance to the gully was stronger than that of soil depth third the swc of the adjacent pair sites presented consistent periodic behavior the cross spectral analysis indicated a dissimilar pattern for soil layer of 0 60 cm and deep synchrony for the other depth layers in conclusion the gully edge effect aggravated the swc status in the south bank and caused a bilateral asymmetrical pattern in the slope gully system these results improved our knowledge on the complicated distribution of swc in the gullied region moreover the results indicate that ignoring the nearby areas of a permanent gully in a catchment is inappropriate when investigating soil water resources keywords gully edge effect permanent gully slope gully system soil water content spatial pattern soil erosion 1 introduction permanent gullies are a kind of striking intricate and dissected landform on the surface of earth they take place in the conditions of erodible soils soft lithologies or geotechnically instable slopes castillo and gómez 2016 evolve under the control of underlying paleotopography xiong and tang 2019 and sporadically accelerate in the combined forces of rainstorm snowmelt and irrational land use garcía ruiz 2010 golosov et al 2018 they are not only a geological window to observe soil horizons sediment layers and rock types but also an indicator to reflect the past human environment interactions and the present day geomorphological processes zgłobicki et al 2019 furthermore the gullies function as sediment sources stores and conveyors that link hillslopes to downstream channels aber et al 2010 and stand for a principal form of land degradation and geomorphological hazards derbyshire 2001 in arid and semi arid regions gullies incision and extension have caused considerable damage to agricultural lands thus threatening the sustainability of agro environment and agro ecosystems the loess plateau in china is such a typical region characterized by fragmented landscape and fragile ecosystem permanent gullies have a tremendous density over china s loess plateau cheng et al 2017 zheng et al 2006a zheng et al 2006b where pervasive gullies with diverse sizes and complex shapes chu 1956 wu et al 2018 zhao et al 2019a occupy 50 60 of the area in the northern hilly and gully loess regions huang and ren 2006 the gully upland and the bilateral banks generally act as an entity for runoff yield and sediment discharge and they can be termed as a slope gully system gao et al 2013 lei and tang 1997 this system is a hydrological and erosional one at a spatial scale less than a catchment gan et al 2019 the permanent gully can enhance the heterogeneity of soil water retention capacity in the slope gully system gan et al 2019 and provide more detailed information than the catchment especially on the distribution pattern of soil water content swc gao et al 2011 gao et al 2013 gao et al 2016 sadeghi et al 2019 in the danangou catchment elsen et al 2003 observed a low swc in the gully sidewall and an extremely low swc in the gully steep parts such as sidewall pipes and vertical walls gao et al 2011 found that the ridges pipes and inside slopeland in the yuanzegou catchment significantly affected the swc distributions around the gully melliger and niemann 2010 considered that the gully increased the spatial variability of the near surface swc due to the rapid drying of the sidewall and persistent wetness of the gully bottom these results were verified in gao et al 2016 which found that the occurrence of permanent gullies clearly altered the pattern of swc spatial variability the swc distribution influences the erosion process and gully stability in a slope gully system gully acts as a sink of water from hillslope runoff li et al 2015 the high level of swc promotes plant growth in the gully bottom and moss development xiao et al 2019 on the sidewall which not only enhances the vegetation cover and biodiversity robinson et al 2016 in the catchment ecosystem but also protects the slope gully system against further erosion melliger and niemann 2010 meanwhile high swc impacts soil shear strength and impairs its ability to resist water erosion gao et al 2011 melliger and niemann 2010 and soil collapse these findings suggest that it is fundamental and indispensable to understand the spatial temporal variability of swc in the slope gully system besides gao et al 2013 found that the gullies and uplands exhibited similar swc patterns in response to rainfall events however it is not known whether swc in the bilateral banks had similar patterns the relevant research to be carried out is expected to be an important aspect and necessary supplement of swc spatial variability in the catchment to date the influence of the microclimate around the gully especially light and wind on the swc distribution pattern is poorly understood soler et al 2002 found that a nocturnal drainage flow formed in a gully with a depth of approximately 8 m and a width of several hundred meters the gully sidewall experienced high rates of evaporation due to positive energy advection and enhanced turbulence around the gully soler et al 2002 in an intact slope in the semiarid region a large amount of soil water evaporates in the upward direction if the perspective switches from the slope to the slope gully system then the sidewall evaporation appears to be another important source of soil water loss considering that the bilateral evaporation occurs in the gully bank huo et al 2008 li et al 2018 zheng et al 2006b the frequency and quantity of soil water loss are highly likely to increase it is worth noting that bilateral evaporation in the gullied catchment participates in the atmospheric circulation which may further contribute to soil drought frustrated agriculture and vegetation degradation in the regional scale zheng et al 2006a zheng et al 2006b the occurrence and impact of bilateral evaporation around the gully can be defined as the main cause of the gully edge effect a strong basis for the edge effect is tobler s first law of geography which indicates that most geographic variables show a distance decay effect with distance being an important variable that governs the influence of one entity on another waters 2016 some experimental verification for gully edge effect presented in huo and shao 2005 and zheng et al 2006a in a gully bank vegetated peashrub huo and shao 2005 found an increase trend of swc with the distance to the gully edge the maximum influencing distance of gully sidewall evaporation on swc was 4 m in the gully bank in a gully bank vegetated purple alfalfa zheng et al 2006a considered that the maximum influencing distance was a variable and the maximum depth influenced by bilateral evaporation was less than that 4 3 m vs 6 m reported by huo and shao 2005 these researchers used bilateral evaporation to explain the soil drought in gully banks but did not propose the notion of gully edge effect dong et al 2017 found that deep loessial soil desiccation on the dividing waterline in the gullied area was more severe in the transect near the permanent gully than that far from it jia et al 2013 found significant differences of soil water storage sws on two hillslopes separated by a deep gully however they missed to examine the effect of distance to the gully on sws although less information on the edge effect in the gullied area is documented li et al 2018 melliger and niemann 2010 soler et al 2002 the edge effect has been confirmed to have diverse presentation in fragmented forest the edge effect influences the microenvironmental abiotic attributes e g light air temperature soil moisture and humidity and biotic components e g seed dispersal and species composition gehlhausen et al 2000 giambelluca et al 2003 found that the transpiration rates of well exposed trees significantly decreased with distance from the edge wuyts et al 2013 considered that increased evapotranspiration and reduced soil moisture levels near the forest edge were among the main drivers behind the differences in the ecosystem processes between the forest edge and core forest clément et al 2017 considered that high density of forest edge was beneficial for water quality as it extended the interface with the agricultural sources overall we realized that the edge effect has various consequences in the fragmented forest and the manifestation of the edge effect on the swc in the gully bank is a consequence of bilateral evaporation however whether the spatial pattern of swc in a slope gully system is a presentation of the gully edge effect is undetermined in the hill and gully regions of the loess plateau the bilateral banks of gullies were chronically developed into sloping farmland or terraces for grain production for example the area proportion of land developed into farmland in the quanjiagou catchment was as high as 58 2 before 1990 fu and gulinck 1994 since 1999 a large portion of the cultivated land around the gullies was revegetated naturally or with shrub or grass because the grain for green project mainly aims to control soil erosion lü et al 2012 numerous researchers and farmers have perceived the low productivity in the gully bank induced by soil drought the effect of the gullied terrain on swc is becoming increasingly important in the fragmented catchment gao et al 2011 gao et al 2013 gao et al 2016 sadeghi et al 2019 yu et al 2017 zhang et al 2016 koupai et al 2008 considering the poor knowledge of the gully edge effect on swc and the abovementioned relevant advances we conducted a long term swc observation along a transect in the traverse section of a permanent gully this study aims to 1 describe the swc distribution pattern in the slope gully system and 2 test whether the spatial distribution of sws across a permanent gully can be explained by the edge effect 2 research area and methods 2 1 liudaogou catchment the liudaogou catchment 38 46 38 51 n 110 21 110 23 e in shenmu county shaanxi province china lies within a transitional belt that extends from the loess plateau to the mu us desert the catchment covers an area of 7 09 km2 and the altitude above sea level ranges from 1081 m to 1273 9 m the density of gullies with length 100 m is 6 45 km km 2 and the proportion of the gullied area to the total area is 38 zhu and shao 2008 the permanent gullies in and around the catchment have complicated geometric shapes and large aerial extent a field survey on 32 secondary gullies shows that the gully ranges from 51 m to 353 m in length with those longer than 100 m occupying 81 3 of the total the mean width is twice the mean depth in the gully cross sections zhao et al 2019b the semiarid and temperate continental monsoon climate dominates the northern loess plateau the mean annual rainfall in this catchment is 437 mm and 70 rainfall is experienced between june and september in the period between 2004 and 2017 the annual precipitation reached a minimum of 298 mm and a maximum of 695 mm the annual evapotranspiration were 478 38 mm in 2015 and 600 70 mm in 2016 qi et al 2019 the monthly temperature varied between 14 51 c and 25 32 c in the growing season and between 12 19 c and 13 00 c in the non growing season jia et al 2019 the main plant species consists of caragana korshinskii kom medicago sativa stipa bungeana salix psammophila lespedeza davurica artemisia capillaris tripolium vulgare populus simonii and prunus armeniaca the catchment landscape is characterized by a mosaic distribution of planted forest grassland terraces check dam farmland sloping fallow etc 2 2 observational transect this study was undertaken around a permanent gully near the catchment boundary the selected gully has an apparent inflection point in its longitudinal extension with its head cut adjacent to the dividing line of the catchment the permanent gully is 218 5 m long 2 m to 17 3 m deep and 3 5 22 2 m wide the full view taken by a drone is presented in fig 1 a c and gan et al 2019 other information can also be found in li et al 2018 within the middle slope section of the curving gully a transverse section with 2 m in width and 3 m in depth was selected at the position of 73 1 m from the gully outlet perpendicular to the longitudinal extension rather than at anobliqueangle to the direction of the middle slope section a transect incorporating 13 observational sites was designed along the northeast southwest direction fig 1 the two banks cut off from each other due to the gully were characterized by similar landforms and vegetation one site in the gully bottom and six sites in each bank were established with each installed an aluminum neutron probe access tube in 2014 the distance interval of the adjacent observational sites was 1 m in the southwest and northeast banks hereinafter referred to as south and north banks respectively in the transverse section of the gully the observational sites from north to south are labeled as 6 5 4 3 2 1 0 1 2 3 4 5 6 the 0 stands for the observational site located in the gully bottom the installation depth of neutron tube in each site approximated to 5 0 m li et al 2018 due to caps loss since august 2017 rainfall water fell into some neutron tubes and could not be pumped the available depth of swc observation turned to be 4 6 m one transect virtually means three topographic treatments south bank north bank and gully the examples of one transect field experiment are not rare along a hillslope transect of rattlesnake hill famiglietti et al 1998 established 21 sampling locations with 10 m interval and obtained 88 occasions of surface swc data over the 217 day periods of the experiment to characterize variability of saturated hydraulic conductivity ks yang et al 2019 arranged 86 sampling sites with 10 km interval along a 860 km south north transect across the loess plateau in western siberia wild et al 2015 employed a 1500 km latitudinal transect incorporating 7 sampling sites to study microbial nitrogen dynamics in this study the strategy of intense sampling with 1 m interval would minimize the spatial variability of possible factors influencing swc only one sampling transect with long term observation therefore was capable to preliminarily investigate the gully edge effect besides the data in zheng et al 2006a zheng et al 2006b and huo et al 2008 were reanalyzed as experimental support the results were compared in the part of discussion 2 3 data collection and analysis in the vertical soil profiles the swc measurement interval was 10 cm at 0 100 cm and 20 cm at 100 460 cm swc data acquired on 23 occasions between october 2014 and september 2018 were employed in this study li et al 2018 also used the swc data in the transect with a consistent direction to the gully cross section to explore the swc spatial pattern in a slope gully system the calibration equation between slow neutron counting rate and swc in the volumetric form was not presented here to avoid repetition li et al 2018 the sws within a certain depth layer was calculated through multiplying the volumetric swc with its corresponding depth jia and shao 2013 the time averaged sws at each depth was calculated for every site the site averaged sws on each date was calculated for the three topographic treatments south bank north bank and gully the depth interval for the soil sample collection is 20 cm at 0 300 cm and 40 cm at 300 460 cm soil textural separates were determined by laser diffraction with a mastersizer 2000 the soil texture classification was performed on the basis of the usda soil taxonomy the ks was estimated with textural separates and surface bulk density as input variables with the help of retc software and van genuchten model the relative height for each site was defined as the elevation difference between the sampling site and the reference site which were acquired through a real time kinematic rtk gps south galaxy g6 rtk system south surveying mapping technology co ltd the planimetric and altimetric precisions are 0 25 m 10 6 m and 0 50 m 10 6 m respectively stepwise multiple linear regression was performed with ibm spss statistics version 25 the general form of multiple regression linear model is 1 y b 0 b 1 x 1 b 2 x 2 b i x i e where y stands for the dependent variable it was sws mm in this study xi stands for the i independent variable mainly derived from soil textural separates soil depth cm relative height m and distance to the gully cm the e is the residual term of the model reflecting the difference between the observed and fitted linear relationship the b0 is the intercept which anchors the regression line in the right place the b1 b2 and bi are the regression coefficients which are also called unstandardized coefficients since they are measured in their natural units for this reason the regression coefficients in most cases cannot be compared with one another to determine which one is more influential in the model meyers et al 2006 in comparison the standardized beta coefficients β can be used to compare the strength of the effects of the independent variables to the dependent variable since they have the same units and are on the same scale freedman 2009 the mathematical relationship between regression coefficients b and standardized beta coefficient β is established via the standard deviation of x and y siegel 2020 that is 2 β b s x s y for a multiple regression linear model the higher the absolute value of standardized beta coefficients the stronger the effect of the independent variable to the dependent variable the assumptions required for the validity of the multiple regression analysis mainly include independence of observations no multicollinearity as well as homoscedasticity and normality of residuals the durbin watson value within 1 5 2 5 is a criteria to judge no autocorrelation in the residuals it is used to meet the assumption of independence of the residuals in the regression based on the results of pearson s bivariate correlations among all independent variables silt content was removed from the regression to avoid multicollinearity the tolerance variance inflation factor eigenvalues and condition index values are used to guarantee that the regression in this study passed the multicollinearity assumption the assumption of homoscedasticity and normality of residuals are tested with a q q plot the points following the diagonal line with no strong deviations indicate that the residuals are normally distributed spectral analysis a general method used in a variety of domains was performed on the time series of swc to describe their cyclical behavior the cross spectral computation on two series of swc for the adjacent sites in the same bank of the gully was performed to decide whether the periodicities are related with each other two test statistics namely fisher s kappa and bartlett s kolmogorov smirnov statistics and the corresponding p values were used for white noise if the p values are lower than the significance level 0 05 then the assumption that the time series is just white noise is rejected an overview of spectral analysis and its application to practical hydrologic problems are provided in fleming et al 2002 the swc profiles were classified into four depth layers namely 0 60 80 160 180 260 and 280 460 cm on the basis of the coefficients of variation cv for swc at each depth supplemental fig 1 this task was performed to explore the periodic characteristics and simplify this research at depth layers of 0 60 and 280 460 cm most cv values were higher than 0 20 and lower than 0 10 respectively most cv values corresponding to the depth layers of 80 160 and 180 260 cm fell in the range of 0 15 0 20 and 0 10 0 15 respectively defining the water active layers with cv zhao et al 2019a and quantifying the soil water resources are efficient methods for homogeneous soil in the loess plateau the intervals of swc observation and soil texture measurement in the soil profiles were partially consistent in view of these cases the classification of the swc depth layer in this study was acceptable 3 results 3 1 bilateral asymmetry of swc distribution across the gully fig 2 depicts the distribution of time averaged swc in the soil profile covering all the observational sites in the transverse section of the gully most observational depths in the south bank distinctly exhibited low levels of swc especially for the sites approaching the gully edge only the upper soil depths at a few sites of the north bank were characterized by similarly low levels of swc a relatively drought stricken area surrounded by an isoline of 14 was identified in the south bank the isolines of 14 and 16 extended more deeply in the south bank than in the north one thus the south bank of the gully had a larger dry area than the north bank along the horizontal and vertical directions as shown by the distribution of 20 isoline a moist area below each bank was observed such area could be called the outskirts on the basis of its position the isolines of 12 14 16 and 18 were densely distributed in the outskirts of the south bank this notion indicates the possible position for an active exchange of soil moisture in the inclined transitional belt the counterpart in the north bank was dominated by sparse isolines of 18 and 20 indicating the stable characteristics of swc variation these results indicate that swc distribution in the transverse section of the gully exhibited an asymmetrical spatial pattern the asymmetrical pattern of south drought and north moisture appeared nearly on all the observational occasions especially for the depth layers of 0 60 cm and 80 160 cm fig 3 in the whole soil profiles the counterpart sites of 2 and 2 presented a maximal sws difference of 126 34 mm followed by pairs of 3 and 3 with 99 49 mm 5 and 5 with 72 29 mm 1 and 1 with 50 51 mm 6 and 6 with 49 24 mm and 4 and 4 with 36 55 mm fig 4 specifically the depth layer of 80 160 cm had maximal sws differences that varied from 14 31 mm for pairs 6 and 6 to 51 97 mm for pairs 5 and 5 the sws difference achieved 66 39 mm for site pair 2 and 2 in the depth layer of 280 460 cm moreover as shown by the wide gap between depth sws curves the south bank sharply contrasted with the north bank within the depth layers of 40 140 cm in site 0 in the gully bottom sws variation with depth exhibited a decreasing trend within the depth layer of 200 280 cm which might indicate that the common recharge depth was at 200 cm the depth sws curves of the two banks approached or crossed each other at the depth range of 380 460 cm the sws in the south bank was even higher than that in the north bank such results could be ascribed to the winding trajectory of the gully fig 1a high level of soil moisture and high possibility of lateral recharge in the gully bottom zheng et al 2006a thus it is relative but not absolute that the two banks cut off from each other due to the permanent gully this kind of asymmetry also revealed the limited effects of bilateral evaporation on swc in the vertical profiles 3 2 recognition of gully edge effect on soil moisture in the slope gully system the effects of soil textural separates soil depth relative height distance to the gully abbreviated as italic distance in the equation below and ks on sws were evaluated to explain the asymmetrical pattern of south drought and north moisture numerous variables such as sand content relative height and ks were excluded through multiple stepwise regression the regression model was expressed as follows sws 4 42 0 975 clay 0 004 distance 0 003 depth r 2 0 727 p 0 001 3 where sws clay distance and depth are soil water storage mm clay content distance to the gully cm and soil depth cm respectively the strength of the effect of the included variables on sws distribution in the transect decreased as clay β 0 747 p 0 001 distance β 0 201 p 0 001 and depth β 0 105 p 0 009 this result indicates the strong effect of clay content on sws in the same slope gully system li et al 2018 also found that clay content was the most important parameter influencing sws it is beyond expectation that the effect of distance to the gully was stronger than that of soil depth since most literatures incorporated soil depth into the function of sws huang and shao 2019 but ignored the effect of distance to the gully fig 5 indicates that the effect of input variables on sws distribution differed among the three topographic treatments and fluctuated in the observational periods the clay content was consistently included as an input variable for the south bank and was sometimes replaced by sand content for the north bank and gully the β of clay content for the south bank and the gully had a wider range compared with that for the north bank these results confirmed that soil texture played a dominant role in controlling sws distribution in the gully and its south bank among the selected factors in the gully sidewall over drying periods gao et al 2011 obtained the similar result that soil texture influenced the variability of swc more strongly than terrain attributes the negative effect of relative height on sws in the north bank and the positive effect of ks on sws in the south bank were also identified the higher strength of distance than depth on sws presented in most occasions in the south and north banks thereby highlighting the effect of distance to the gully on sws distribution in contrast to the south bank the strength of soil depth frequently exceeded the distance to the gully in the north bank revealing the important role of micro topography in the distribution pattern of sws in the slope gully system one possible reason is that micro topography controls sws variability indirectly via redistributing soil properties gao et al 2011 3 3 surface dissimilarity and deep synchrony for swc of adjacent sites spectral analysis on the basis of fourier transform was used to determine if the cycles characterize the temporal variation of swc this task was performed to further explore the association between the distance to the gully and swc pattern the cross spectrum was also used to determine the degree of fluctuation synchrony between two time series as the function of frequency according to the relative positions of peaks in the pair series edwards and thornes 1973 this method is expected to offer a way to evaluate the similarity or dissimilarity between two series of swc for the adjacent sites fig 6 the swc data in our study are unevenly spaced time series but any two series have the same data length we did not leverage the lomb scargle periodogram schulz and stattegger 1997 townsend 2010 on the photometric time series here the main interest lies in determining the similarity or dissimilarity over interpretation of results with these techniques was sufficiently avoided the largest peak in all the spectra correspond to the same date that is the 1514th julian day since october 10 2014 which fell on the observational periods between september 22 2017 and april 8 2018 although the spectral shape differed with distances to the gully and depth layers the significant cycle of 1514th days greatly contributed to the signal of swc behavior this result could be linked to the effect of cumulative precipitation on soil moisture in the wet years of 2016 and 2017 jia et al 2019 especially the aftermath of an extreme rainstorm event on july 26 2017 bai et al 2020 the 1514th julian day was close to the observational duration of this study it is important to state that the spectral density is a kind of statistical distribution supplemental table 1 which is why the results yielded useful information even if the underlying structure did not show a good spectral behavior besides the operation of fourier transform in spectral analysis can successfully deal with aperiodic function fleming et al 2002 and the phenomenon that looks aperiodic the findings above suggest a dependence of swc cyclic behavior on the appearance of wet years in the arid and semiarid region the peak number is comparatively greater at a depth of 0 60 cm than at other depth layers however the fisher s kappa did not detected periodic component in 2 3 of the swc time series that corresponded to 0 60 cm depth layer supplemental table 1 in either case the low magnitude of short periodicity makes a small contribution to the overall signals fleming et al 2002 large magnitudes mainly appear within depth layer of 80 160 cm in the north and south banks and 0 60 cm in the north bank the magnitude for the site located far from the gully was higher than or equal to the adjacent site closer to the gully these results imply that the large magnitudes of swc spectra corresponded to a relatively wet status of soil in all cases if the adjacent pairs were taken as input and output signals then their spectral shapes were similar more direct is the cross spectral results which suggest a dissimilarity at a depth of 0 60 cm and synchrony at three other depth layers the deeper of the observation and the further distance to the gully the more similar for the spectra of adjacent sites this result leads us tentatively to regard the cyclic pattern as genuine that is the input signal is the dominant physical control over periodicity in output signal fleming et al 2002 although the bilateral banks seem to be cut off by the permanent gully and edge effect causes a bilateral asymmetrical pattern of swc soil moisture connectivity of adjacent sites in each bank still contribute to a synchronous behavior for the deep swc 4 discussion the permanent gullies exhibit diversity in size extension direction cross section shape slope aspect sidewall gradient and border curvature etc the gully edge effect depends on the diversity of gullies in order to support this statement and know more about the relationships between distance and sws linear functions were employed to reanalyze the data of zheng et al 2006a zheng et al 2006b and huo et al 2008 the specific results are shown in fig 7 significant positive relationships p 0 001 present in huo et al 2008 and the two banks of this study it should be noted that zheng et al 2006a zheng et al 2006b fitted a power function between distance and sws in which the independent variable of distance 0 2 1 2 and 3 m away from the gully edge did not incorporate all the values since 5 m was considered to be the maximum influencing distance of bilateral evaporation these results conformed the contribution of distance to the variability of sws in the banks of the gullies among the four fitted functions the south bank of the gully had the lowest intercept indicating the driest soil status corresponding to gully edge effect based on the linearly fitted results the distance to the gully in south bank could explain more variability of sws than that in the north bank 54 vs 30 this findings agree to a certain extent with the previous conclusion that swc had bilateral asymmetrical pattern the asymmetric pattern of swc across the gully is closely related to gully edge effect which can be regarded as a manifestation of bilateral evaporation what s more the quantitative findings suggest that the gully edge effect should be incorporated into the understanding of sws distribution in the slope gully system based on a preliminary experiment our results quantified the effects of bilaterally intensified evaporation on swc in the gully bank since the gully edge within the gully bank is prone to collapse and sometimes ambiguous in technical identification sun et al 2019 we deemed the conceptualization of gully edge effect was not limited to bilateral evaporation it should encompass the outward migration of gully border as well as the rapid drainage of runoff and etc anyhow bilateral evaporation and edge effect make the bank a particular location for the gully and susceptible to soil drought gully edge effect can lead to soil drought in the bank area which issupposedto be one of the major reasons for low production of the sloping farmland or terrace near the permanent gullies to beobjective some other factors also contribute to soil drought around the gully for example highly irregular micro topography can lead to non uniform infiltration of rainfall and aggravate the moisture status of the gully bank the vertical incision of the gully facilitates the sub surface flow outlet which is not conducive to soil water conservation and groundwater recharge in addition the spatial differences in the soil physical and hydrological properties form a mosaic of areas with a contrasting hydrological response such mosaic pattern was characterized by areas of relatively wet and dry soil during dry weather fitzjohn et al 1998 therefore gullied terrain contributes greatly to soil drought in the loess plateau in the bank of the large sized gully past inhabitants dug caves from the escarpments which seldom collapsed unless earthquake and torrential rain damaged the structures derbyshire 2001 pietz 2015 to this point soil drought in the gully bank was beneficial to cave dwelling security the influence of complex terrain on sws heterogeneity and the dependence of sws on soil depth have been widely reported huang and shao 2019 penna et al 2009 zhu and lin 2011 in the heavy gullied catchment the extent of the gully influencing sws spatial variability depends on the design of sampling locations a certain width under the influence of the edge effect should be considered for the gully bank however the uplands has often been used as a surrogate of the whole catchment in soil moisture investigation gao et al 2013 the common design of a sampling transect often skips the gully and is along the direction of the hillslope our findings emphasize the need to traverse the gully to guarantee a reliable evaluation of sws this idea is consistent with the transect design strategy in li et al 2015 which reported that sws peaks concentrated near the gullies along a 1340 m long transect if the gullies are neglected in the design of sampling plans and the implementation of in situ observation then the quantity of soil water resources might be overestimated or underestimated to accurately represent spatial means of swc in a gullied catchment an increase of the sampling number is suggested gao et al 2016 5 conclusions this study identified the unilateral soil drought caused by the gully edge effect in a slope gully system the swc spatial pattern across the permanent gully was characterized by contrasting sws for the counterpart sites in the bilateral banks the spectral behavior and cross correlation of swc for the adjacent sites indicated surface dissimilarity and deep synchrony for swc of adjacent sites the conception of gully edge effect was proposed and enriched in this preliminary experiment the gully edge effect is an adverse factor for the conservation of soil water resources in the gullied region we also stated the significance of not overlooking the permanent gully during soil drought explanation in summary the asymmetrical pattern of sws across the gully is one aspect of heterogeneous distribution of swc these findings are helpful for land use planning and management guiding ecosystem restoration and agriculture development as well as the adjustment of soil conservation strategy in the gullied region credit authorship contribution statement yu hua jia conceptualization data curation formal analysis writing original draft tong chuan li investigation ming an shao project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china 41571221 41807011 many thanks go to xiao xu jia ji yong zheng and yun qiang wang for their help on theoretical guiding before the experiment hao ming fan for providing rtk instrument ming yang zhao bo feng and miao gan for the on site observations and yan wu pei and ying zhao for the assistance in taking pictures of the sampling transect appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125288 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
5189,describing and mapping soil water content swc distribution are required to understand and explain the hydrological phenomena at various spatial scales soil drought in the hilly and gully regions of loess plateau reduces agricultural production and plants biomass which has attracted great attention but few studies associated it with the gullied terrain to understand the swc distribution pattern in the slope gully system we established a cross section transect for swc observation across a permanent gully and acquired 23 occasions of swc data in the periods from october 2014 to september 2018 the standardized beta coefficient in stepwise multiple linear regression was employed to determine the strength of the effect of the selected variables soil textural separates soil depth relative height distance to the gully and saturated hydraulic conductivity on sws distribution spectral and cross spectral analysis were performed on the time series of swc to evaluate the cyclical behavior and the similarity for adjacent sites respectively the following results were obtained first the swc distribution had a bilateral asymmetrical pattern across the gully which constituted a specific and detailed content of spatial variability of swc second soil water storage in the slope gully system was primarily affected by soil texture meanwhile the effect of distance to the gully was stronger than that of soil depth third the swc of the adjacent pair sites presented consistent periodic behavior the cross spectral analysis indicated a dissimilar pattern for soil layer of 0 60 cm and deep synchrony for the other depth layers in conclusion the gully edge effect aggravated the swc status in the south bank and caused a bilateral asymmetrical pattern in the slope gully system these results improved our knowledge on the complicated distribution of swc in the gullied region moreover the results indicate that ignoring the nearby areas of a permanent gully in a catchment is inappropriate when investigating soil water resources keywords gully edge effect permanent gully slope gully system soil water content spatial pattern soil erosion 1 introduction permanent gullies are a kind of striking intricate and dissected landform on the surface of earth they take place in the conditions of erodible soils soft lithologies or geotechnically instable slopes castillo and gómez 2016 evolve under the control of underlying paleotopography xiong and tang 2019 and sporadically accelerate in the combined forces of rainstorm snowmelt and irrational land use garcía ruiz 2010 golosov et al 2018 they are not only a geological window to observe soil horizons sediment layers and rock types but also an indicator to reflect the past human environment interactions and the present day geomorphological processes zgłobicki et al 2019 furthermore the gullies function as sediment sources stores and conveyors that link hillslopes to downstream channels aber et al 2010 and stand for a principal form of land degradation and geomorphological hazards derbyshire 2001 in arid and semi arid regions gullies incision and extension have caused considerable damage to agricultural lands thus threatening the sustainability of agro environment and agro ecosystems the loess plateau in china is such a typical region characterized by fragmented landscape and fragile ecosystem permanent gullies have a tremendous density over china s loess plateau cheng et al 2017 zheng et al 2006a zheng et al 2006b where pervasive gullies with diverse sizes and complex shapes chu 1956 wu et al 2018 zhao et al 2019a occupy 50 60 of the area in the northern hilly and gully loess regions huang and ren 2006 the gully upland and the bilateral banks generally act as an entity for runoff yield and sediment discharge and they can be termed as a slope gully system gao et al 2013 lei and tang 1997 this system is a hydrological and erosional one at a spatial scale less than a catchment gan et al 2019 the permanent gully can enhance the heterogeneity of soil water retention capacity in the slope gully system gan et al 2019 and provide more detailed information than the catchment especially on the distribution pattern of soil water content swc gao et al 2011 gao et al 2013 gao et al 2016 sadeghi et al 2019 in the danangou catchment elsen et al 2003 observed a low swc in the gully sidewall and an extremely low swc in the gully steep parts such as sidewall pipes and vertical walls gao et al 2011 found that the ridges pipes and inside slopeland in the yuanzegou catchment significantly affected the swc distributions around the gully melliger and niemann 2010 considered that the gully increased the spatial variability of the near surface swc due to the rapid drying of the sidewall and persistent wetness of the gully bottom these results were verified in gao et al 2016 which found that the occurrence of permanent gullies clearly altered the pattern of swc spatial variability the swc distribution influences the erosion process and gully stability in a slope gully system gully acts as a sink of water from hillslope runoff li et al 2015 the high level of swc promotes plant growth in the gully bottom and moss development xiao et al 2019 on the sidewall which not only enhances the vegetation cover and biodiversity robinson et al 2016 in the catchment ecosystem but also protects the slope gully system against further erosion melliger and niemann 2010 meanwhile high swc impacts soil shear strength and impairs its ability to resist water erosion gao et al 2011 melliger and niemann 2010 and soil collapse these findings suggest that it is fundamental and indispensable to understand the spatial temporal variability of swc in the slope gully system besides gao et al 2013 found that the gullies and uplands exhibited similar swc patterns in response to rainfall events however it is not known whether swc in the bilateral banks had similar patterns the relevant research to be carried out is expected to be an important aspect and necessary supplement of swc spatial variability in the catchment to date the influence of the microclimate around the gully especially light and wind on the swc distribution pattern is poorly understood soler et al 2002 found that a nocturnal drainage flow formed in a gully with a depth of approximately 8 m and a width of several hundred meters the gully sidewall experienced high rates of evaporation due to positive energy advection and enhanced turbulence around the gully soler et al 2002 in an intact slope in the semiarid region a large amount of soil water evaporates in the upward direction if the perspective switches from the slope to the slope gully system then the sidewall evaporation appears to be another important source of soil water loss considering that the bilateral evaporation occurs in the gully bank huo et al 2008 li et al 2018 zheng et al 2006b the frequency and quantity of soil water loss are highly likely to increase it is worth noting that bilateral evaporation in the gullied catchment participates in the atmospheric circulation which may further contribute to soil drought frustrated agriculture and vegetation degradation in the regional scale zheng et al 2006a zheng et al 2006b the occurrence and impact of bilateral evaporation around the gully can be defined as the main cause of the gully edge effect a strong basis for the edge effect is tobler s first law of geography which indicates that most geographic variables show a distance decay effect with distance being an important variable that governs the influence of one entity on another waters 2016 some experimental verification for gully edge effect presented in huo and shao 2005 and zheng et al 2006a in a gully bank vegetated peashrub huo and shao 2005 found an increase trend of swc with the distance to the gully edge the maximum influencing distance of gully sidewall evaporation on swc was 4 m in the gully bank in a gully bank vegetated purple alfalfa zheng et al 2006a considered that the maximum influencing distance was a variable and the maximum depth influenced by bilateral evaporation was less than that 4 3 m vs 6 m reported by huo and shao 2005 these researchers used bilateral evaporation to explain the soil drought in gully banks but did not propose the notion of gully edge effect dong et al 2017 found that deep loessial soil desiccation on the dividing waterline in the gullied area was more severe in the transect near the permanent gully than that far from it jia et al 2013 found significant differences of soil water storage sws on two hillslopes separated by a deep gully however they missed to examine the effect of distance to the gully on sws although less information on the edge effect in the gullied area is documented li et al 2018 melliger and niemann 2010 soler et al 2002 the edge effect has been confirmed to have diverse presentation in fragmented forest the edge effect influences the microenvironmental abiotic attributes e g light air temperature soil moisture and humidity and biotic components e g seed dispersal and species composition gehlhausen et al 2000 giambelluca et al 2003 found that the transpiration rates of well exposed trees significantly decreased with distance from the edge wuyts et al 2013 considered that increased evapotranspiration and reduced soil moisture levels near the forest edge were among the main drivers behind the differences in the ecosystem processes between the forest edge and core forest clément et al 2017 considered that high density of forest edge was beneficial for water quality as it extended the interface with the agricultural sources overall we realized that the edge effect has various consequences in the fragmented forest and the manifestation of the edge effect on the swc in the gully bank is a consequence of bilateral evaporation however whether the spatial pattern of swc in a slope gully system is a presentation of the gully edge effect is undetermined in the hill and gully regions of the loess plateau the bilateral banks of gullies were chronically developed into sloping farmland or terraces for grain production for example the area proportion of land developed into farmland in the quanjiagou catchment was as high as 58 2 before 1990 fu and gulinck 1994 since 1999 a large portion of the cultivated land around the gullies was revegetated naturally or with shrub or grass because the grain for green project mainly aims to control soil erosion lü et al 2012 numerous researchers and farmers have perceived the low productivity in the gully bank induced by soil drought the effect of the gullied terrain on swc is becoming increasingly important in the fragmented catchment gao et al 2011 gao et al 2013 gao et al 2016 sadeghi et al 2019 yu et al 2017 zhang et al 2016 koupai et al 2008 considering the poor knowledge of the gully edge effect on swc and the abovementioned relevant advances we conducted a long term swc observation along a transect in the traverse section of a permanent gully this study aims to 1 describe the swc distribution pattern in the slope gully system and 2 test whether the spatial distribution of sws across a permanent gully can be explained by the edge effect 2 research area and methods 2 1 liudaogou catchment the liudaogou catchment 38 46 38 51 n 110 21 110 23 e in shenmu county shaanxi province china lies within a transitional belt that extends from the loess plateau to the mu us desert the catchment covers an area of 7 09 km2 and the altitude above sea level ranges from 1081 m to 1273 9 m the density of gullies with length 100 m is 6 45 km km 2 and the proportion of the gullied area to the total area is 38 zhu and shao 2008 the permanent gullies in and around the catchment have complicated geometric shapes and large aerial extent a field survey on 32 secondary gullies shows that the gully ranges from 51 m to 353 m in length with those longer than 100 m occupying 81 3 of the total the mean width is twice the mean depth in the gully cross sections zhao et al 2019b the semiarid and temperate continental monsoon climate dominates the northern loess plateau the mean annual rainfall in this catchment is 437 mm and 70 rainfall is experienced between june and september in the period between 2004 and 2017 the annual precipitation reached a minimum of 298 mm and a maximum of 695 mm the annual evapotranspiration were 478 38 mm in 2015 and 600 70 mm in 2016 qi et al 2019 the monthly temperature varied between 14 51 c and 25 32 c in the growing season and between 12 19 c and 13 00 c in the non growing season jia et al 2019 the main plant species consists of caragana korshinskii kom medicago sativa stipa bungeana salix psammophila lespedeza davurica artemisia capillaris tripolium vulgare populus simonii and prunus armeniaca the catchment landscape is characterized by a mosaic distribution of planted forest grassland terraces check dam farmland sloping fallow etc 2 2 observational transect this study was undertaken around a permanent gully near the catchment boundary the selected gully has an apparent inflection point in its longitudinal extension with its head cut adjacent to the dividing line of the catchment the permanent gully is 218 5 m long 2 m to 17 3 m deep and 3 5 22 2 m wide the full view taken by a drone is presented in fig 1 a c and gan et al 2019 other information can also be found in li et al 2018 within the middle slope section of the curving gully a transverse section with 2 m in width and 3 m in depth was selected at the position of 73 1 m from the gully outlet perpendicular to the longitudinal extension rather than at anobliqueangle to the direction of the middle slope section a transect incorporating 13 observational sites was designed along the northeast southwest direction fig 1 the two banks cut off from each other due to the gully were characterized by similar landforms and vegetation one site in the gully bottom and six sites in each bank were established with each installed an aluminum neutron probe access tube in 2014 the distance interval of the adjacent observational sites was 1 m in the southwest and northeast banks hereinafter referred to as south and north banks respectively in the transverse section of the gully the observational sites from north to south are labeled as 6 5 4 3 2 1 0 1 2 3 4 5 6 the 0 stands for the observational site located in the gully bottom the installation depth of neutron tube in each site approximated to 5 0 m li et al 2018 due to caps loss since august 2017 rainfall water fell into some neutron tubes and could not be pumped the available depth of swc observation turned to be 4 6 m one transect virtually means three topographic treatments south bank north bank and gully the examples of one transect field experiment are not rare along a hillslope transect of rattlesnake hill famiglietti et al 1998 established 21 sampling locations with 10 m interval and obtained 88 occasions of surface swc data over the 217 day periods of the experiment to characterize variability of saturated hydraulic conductivity ks yang et al 2019 arranged 86 sampling sites with 10 km interval along a 860 km south north transect across the loess plateau in western siberia wild et al 2015 employed a 1500 km latitudinal transect incorporating 7 sampling sites to study microbial nitrogen dynamics in this study the strategy of intense sampling with 1 m interval would minimize the spatial variability of possible factors influencing swc only one sampling transect with long term observation therefore was capable to preliminarily investigate the gully edge effect besides the data in zheng et al 2006a zheng et al 2006b and huo et al 2008 were reanalyzed as experimental support the results were compared in the part of discussion 2 3 data collection and analysis in the vertical soil profiles the swc measurement interval was 10 cm at 0 100 cm and 20 cm at 100 460 cm swc data acquired on 23 occasions between october 2014 and september 2018 were employed in this study li et al 2018 also used the swc data in the transect with a consistent direction to the gully cross section to explore the swc spatial pattern in a slope gully system the calibration equation between slow neutron counting rate and swc in the volumetric form was not presented here to avoid repetition li et al 2018 the sws within a certain depth layer was calculated through multiplying the volumetric swc with its corresponding depth jia and shao 2013 the time averaged sws at each depth was calculated for every site the site averaged sws on each date was calculated for the three topographic treatments south bank north bank and gully the depth interval for the soil sample collection is 20 cm at 0 300 cm and 40 cm at 300 460 cm soil textural separates were determined by laser diffraction with a mastersizer 2000 the soil texture classification was performed on the basis of the usda soil taxonomy the ks was estimated with textural separates and surface bulk density as input variables with the help of retc software and van genuchten model the relative height for each site was defined as the elevation difference between the sampling site and the reference site which were acquired through a real time kinematic rtk gps south galaxy g6 rtk system south surveying mapping technology co ltd the planimetric and altimetric precisions are 0 25 m 10 6 m and 0 50 m 10 6 m respectively stepwise multiple linear regression was performed with ibm spss statistics version 25 the general form of multiple regression linear model is 1 y b 0 b 1 x 1 b 2 x 2 b i x i e where y stands for the dependent variable it was sws mm in this study xi stands for the i independent variable mainly derived from soil textural separates soil depth cm relative height m and distance to the gully cm the e is the residual term of the model reflecting the difference between the observed and fitted linear relationship the b0 is the intercept which anchors the regression line in the right place the b1 b2 and bi are the regression coefficients which are also called unstandardized coefficients since they are measured in their natural units for this reason the regression coefficients in most cases cannot be compared with one another to determine which one is more influential in the model meyers et al 2006 in comparison the standardized beta coefficients β can be used to compare the strength of the effects of the independent variables to the dependent variable since they have the same units and are on the same scale freedman 2009 the mathematical relationship between regression coefficients b and standardized beta coefficient β is established via the standard deviation of x and y siegel 2020 that is 2 β b s x s y for a multiple regression linear model the higher the absolute value of standardized beta coefficients the stronger the effect of the independent variable to the dependent variable the assumptions required for the validity of the multiple regression analysis mainly include independence of observations no multicollinearity as well as homoscedasticity and normality of residuals the durbin watson value within 1 5 2 5 is a criteria to judge no autocorrelation in the residuals it is used to meet the assumption of independence of the residuals in the regression based on the results of pearson s bivariate correlations among all independent variables silt content was removed from the regression to avoid multicollinearity the tolerance variance inflation factor eigenvalues and condition index values are used to guarantee that the regression in this study passed the multicollinearity assumption the assumption of homoscedasticity and normality of residuals are tested with a q q plot the points following the diagonal line with no strong deviations indicate that the residuals are normally distributed spectral analysis a general method used in a variety of domains was performed on the time series of swc to describe their cyclical behavior the cross spectral computation on two series of swc for the adjacent sites in the same bank of the gully was performed to decide whether the periodicities are related with each other two test statistics namely fisher s kappa and bartlett s kolmogorov smirnov statistics and the corresponding p values were used for white noise if the p values are lower than the significance level 0 05 then the assumption that the time series is just white noise is rejected an overview of spectral analysis and its application to practical hydrologic problems are provided in fleming et al 2002 the swc profiles were classified into four depth layers namely 0 60 80 160 180 260 and 280 460 cm on the basis of the coefficients of variation cv for swc at each depth supplemental fig 1 this task was performed to explore the periodic characteristics and simplify this research at depth layers of 0 60 and 280 460 cm most cv values were higher than 0 20 and lower than 0 10 respectively most cv values corresponding to the depth layers of 80 160 and 180 260 cm fell in the range of 0 15 0 20 and 0 10 0 15 respectively defining the water active layers with cv zhao et al 2019a and quantifying the soil water resources are efficient methods for homogeneous soil in the loess plateau the intervals of swc observation and soil texture measurement in the soil profiles were partially consistent in view of these cases the classification of the swc depth layer in this study was acceptable 3 results 3 1 bilateral asymmetry of swc distribution across the gully fig 2 depicts the distribution of time averaged swc in the soil profile covering all the observational sites in the transverse section of the gully most observational depths in the south bank distinctly exhibited low levels of swc especially for the sites approaching the gully edge only the upper soil depths at a few sites of the north bank were characterized by similarly low levels of swc a relatively drought stricken area surrounded by an isoline of 14 was identified in the south bank the isolines of 14 and 16 extended more deeply in the south bank than in the north one thus the south bank of the gully had a larger dry area than the north bank along the horizontal and vertical directions as shown by the distribution of 20 isoline a moist area below each bank was observed such area could be called the outskirts on the basis of its position the isolines of 12 14 16 and 18 were densely distributed in the outskirts of the south bank this notion indicates the possible position for an active exchange of soil moisture in the inclined transitional belt the counterpart in the north bank was dominated by sparse isolines of 18 and 20 indicating the stable characteristics of swc variation these results indicate that swc distribution in the transverse section of the gully exhibited an asymmetrical spatial pattern the asymmetrical pattern of south drought and north moisture appeared nearly on all the observational occasions especially for the depth layers of 0 60 cm and 80 160 cm fig 3 in the whole soil profiles the counterpart sites of 2 and 2 presented a maximal sws difference of 126 34 mm followed by pairs of 3 and 3 with 99 49 mm 5 and 5 with 72 29 mm 1 and 1 with 50 51 mm 6 and 6 with 49 24 mm and 4 and 4 with 36 55 mm fig 4 specifically the depth layer of 80 160 cm had maximal sws differences that varied from 14 31 mm for pairs 6 and 6 to 51 97 mm for pairs 5 and 5 the sws difference achieved 66 39 mm for site pair 2 and 2 in the depth layer of 280 460 cm moreover as shown by the wide gap between depth sws curves the south bank sharply contrasted with the north bank within the depth layers of 40 140 cm in site 0 in the gully bottom sws variation with depth exhibited a decreasing trend within the depth layer of 200 280 cm which might indicate that the common recharge depth was at 200 cm the depth sws curves of the two banks approached or crossed each other at the depth range of 380 460 cm the sws in the south bank was even higher than that in the north bank such results could be ascribed to the winding trajectory of the gully fig 1a high level of soil moisture and high possibility of lateral recharge in the gully bottom zheng et al 2006a thus it is relative but not absolute that the two banks cut off from each other due to the permanent gully this kind of asymmetry also revealed the limited effects of bilateral evaporation on swc in the vertical profiles 3 2 recognition of gully edge effect on soil moisture in the slope gully system the effects of soil textural separates soil depth relative height distance to the gully abbreviated as italic distance in the equation below and ks on sws were evaluated to explain the asymmetrical pattern of south drought and north moisture numerous variables such as sand content relative height and ks were excluded through multiple stepwise regression the regression model was expressed as follows sws 4 42 0 975 clay 0 004 distance 0 003 depth r 2 0 727 p 0 001 3 where sws clay distance and depth are soil water storage mm clay content distance to the gully cm and soil depth cm respectively the strength of the effect of the included variables on sws distribution in the transect decreased as clay β 0 747 p 0 001 distance β 0 201 p 0 001 and depth β 0 105 p 0 009 this result indicates the strong effect of clay content on sws in the same slope gully system li et al 2018 also found that clay content was the most important parameter influencing sws it is beyond expectation that the effect of distance to the gully was stronger than that of soil depth since most literatures incorporated soil depth into the function of sws huang and shao 2019 but ignored the effect of distance to the gully fig 5 indicates that the effect of input variables on sws distribution differed among the three topographic treatments and fluctuated in the observational periods the clay content was consistently included as an input variable for the south bank and was sometimes replaced by sand content for the north bank and gully the β of clay content for the south bank and the gully had a wider range compared with that for the north bank these results confirmed that soil texture played a dominant role in controlling sws distribution in the gully and its south bank among the selected factors in the gully sidewall over drying periods gao et al 2011 obtained the similar result that soil texture influenced the variability of swc more strongly than terrain attributes the negative effect of relative height on sws in the north bank and the positive effect of ks on sws in the south bank were also identified the higher strength of distance than depth on sws presented in most occasions in the south and north banks thereby highlighting the effect of distance to the gully on sws distribution in contrast to the south bank the strength of soil depth frequently exceeded the distance to the gully in the north bank revealing the important role of micro topography in the distribution pattern of sws in the slope gully system one possible reason is that micro topography controls sws variability indirectly via redistributing soil properties gao et al 2011 3 3 surface dissimilarity and deep synchrony for swc of adjacent sites spectral analysis on the basis of fourier transform was used to determine if the cycles characterize the temporal variation of swc this task was performed to further explore the association between the distance to the gully and swc pattern the cross spectrum was also used to determine the degree of fluctuation synchrony between two time series as the function of frequency according to the relative positions of peaks in the pair series edwards and thornes 1973 this method is expected to offer a way to evaluate the similarity or dissimilarity between two series of swc for the adjacent sites fig 6 the swc data in our study are unevenly spaced time series but any two series have the same data length we did not leverage the lomb scargle periodogram schulz and stattegger 1997 townsend 2010 on the photometric time series here the main interest lies in determining the similarity or dissimilarity over interpretation of results with these techniques was sufficiently avoided the largest peak in all the spectra correspond to the same date that is the 1514th julian day since october 10 2014 which fell on the observational periods between september 22 2017 and april 8 2018 although the spectral shape differed with distances to the gully and depth layers the significant cycle of 1514th days greatly contributed to the signal of swc behavior this result could be linked to the effect of cumulative precipitation on soil moisture in the wet years of 2016 and 2017 jia et al 2019 especially the aftermath of an extreme rainstorm event on july 26 2017 bai et al 2020 the 1514th julian day was close to the observational duration of this study it is important to state that the spectral density is a kind of statistical distribution supplemental table 1 which is why the results yielded useful information even if the underlying structure did not show a good spectral behavior besides the operation of fourier transform in spectral analysis can successfully deal with aperiodic function fleming et al 2002 and the phenomenon that looks aperiodic the findings above suggest a dependence of swc cyclic behavior on the appearance of wet years in the arid and semiarid region the peak number is comparatively greater at a depth of 0 60 cm than at other depth layers however the fisher s kappa did not detected periodic component in 2 3 of the swc time series that corresponded to 0 60 cm depth layer supplemental table 1 in either case the low magnitude of short periodicity makes a small contribution to the overall signals fleming et al 2002 large magnitudes mainly appear within depth layer of 80 160 cm in the north and south banks and 0 60 cm in the north bank the magnitude for the site located far from the gully was higher than or equal to the adjacent site closer to the gully these results imply that the large magnitudes of swc spectra corresponded to a relatively wet status of soil in all cases if the adjacent pairs were taken as input and output signals then their spectral shapes were similar more direct is the cross spectral results which suggest a dissimilarity at a depth of 0 60 cm and synchrony at three other depth layers the deeper of the observation and the further distance to the gully the more similar for the spectra of adjacent sites this result leads us tentatively to regard the cyclic pattern as genuine that is the input signal is the dominant physical control over periodicity in output signal fleming et al 2002 although the bilateral banks seem to be cut off by the permanent gully and edge effect causes a bilateral asymmetrical pattern of swc soil moisture connectivity of adjacent sites in each bank still contribute to a synchronous behavior for the deep swc 4 discussion the permanent gullies exhibit diversity in size extension direction cross section shape slope aspect sidewall gradient and border curvature etc the gully edge effect depends on the diversity of gullies in order to support this statement and know more about the relationships between distance and sws linear functions were employed to reanalyze the data of zheng et al 2006a zheng et al 2006b and huo et al 2008 the specific results are shown in fig 7 significant positive relationships p 0 001 present in huo et al 2008 and the two banks of this study it should be noted that zheng et al 2006a zheng et al 2006b fitted a power function between distance and sws in which the independent variable of distance 0 2 1 2 and 3 m away from the gully edge did not incorporate all the values since 5 m was considered to be the maximum influencing distance of bilateral evaporation these results conformed the contribution of distance to the variability of sws in the banks of the gullies among the four fitted functions the south bank of the gully had the lowest intercept indicating the driest soil status corresponding to gully edge effect based on the linearly fitted results the distance to the gully in south bank could explain more variability of sws than that in the north bank 54 vs 30 this findings agree to a certain extent with the previous conclusion that swc had bilateral asymmetrical pattern the asymmetric pattern of swc across the gully is closely related to gully edge effect which can be regarded as a manifestation of bilateral evaporation what s more the quantitative findings suggest that the gully edge effect should be incorporated into the understanding of sws distribution in the slope gully system based on a preliminary experiment our results quantified the effects of bilaterally intensified evaporation on swc in the gully bank since the gully edge within the gully bank is prone to collapse and sometimes ambiguous in technical identification sun et al 2019 we deemed the conceptualization of gully edge effect was not limited to bilateral evaporation it should encompass the outward migration of gully border as well as the rapid drainage of runoff and etc anyhow bilateral evaporation and edge effect make the bank a particular location for the gully and susceptible to soil drought gully edge effect can lead to soil drought in the bank area which issupposedto be one of the major reasons for low production of the sloping farmland or terrace near the permanent gullies to beobjective some other factors also contribute to soil drought around the gully for example highly irregular micro topography can lead to non uniform infiltration of rainfall and aggravate the moisture status of the gully bank the vertical incision of the gully facilitates the sub surface flow outlet which is not conducive to soil water conservation and groundwater recharge in addition the spatial differences in the soil physical and hydrological properties form a mosaic of areas with a contrasting hydrological response such mosaic pattern was characterized by areas of relatively wet and dry soil during dry weather fitzjohn et al 1998 therefore gullied terrain contributes greatly to soil drought in the loess plateau in the bank of the large sized gully past inhabitants dug caves from the escarpments which seldom collapsed unless earthquake and torrential rain damaged the structures derbyshire 2001 pietz 2015 to this point soil drought in the gully bank was beneficial to cave dwelling security the influence of complex terrain on sws heterogeneity and the dependence of sws on soil depth have been widely reported huang and shao 2019 penna et al 2009 zhu and lin 2011 in the heavy gullied catchment the extent of the gully influencing sws spatial variability depends on the design of sampling locations a certain width under the influence of the edge effect should be considered for the gully bank however the uplands has often been used as a surrogate of the whole catchment in soil moisture investigation gao et al 2013 the common design of a sampling transect often skips the gully and is along the direction of the hillslope our findings emphasize the need to traverse the gully to guarantee a reliable evaluation of sws this idea is consistent with the transect design strategy in li et al 2015 which reported that sws peaks concentrated near the gullies along a 1340 m long transect if the gullies are neglected in the design of sampling plans and the implementation of in situ observation then the quantity of soil water resources might be overestimated or underestimated to accurately represent spatial means of swc in a gullied catchment an increase of the sampling number is suggested gao et al 2016 5 conclusions this study identified the unilateral soil drought caused by the gully edge effect in a slope gully system the swc spatial pattern across the permanent gully was characterized by contrasting sws for the counterpart sites in the bilateral banks the spectral behavior and cross correlation of swc for the adjacent sites indicated surface dissimilarity and deep synchrony for swc of adjacent sites the conception of gully edge effect was proposed and enriched in this preliminary experiment the gully edge effect is an adverse factor for the conservation of soil water resources in the gullied region we also stated the significance of not overlooking the permanent gully during soil drought explanation in summary the asymmetrical pattern of sws across the gully is one aspect of heterogeneous distribution of swc these findings are helpful for land use planning and management guiding ecosystem restoration and agriculture development as well as the adjustment of soil conservation strategy in the gullied region credit authorship contribution statement yu hua jia conceptualization data curation formal analysis writing original draft tong chuan li investigation ming an shao project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china 41571221 41807011 many thanks go to xiao xu jia ji yong zheng and yun qiang wang for their help on theoretical guiding before the experiment hao ming fan for providing rtk instrument ming yang zhao bo feng and miao gan for the on site observations and yan wu pei and ying zhao for the assistance in taking pictures of the sampling transect appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2020 125288 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
