index,text
22205,the vortical structures around a yawed square cylinder oscillating in quiescent water are investigated using the particle image velocimetry technique following a previous study on the hydrodynamics lou et al 2017 the present experiments are performed at different yaw angles α and keulegan carpenter kc numbers to correlate the independence principle ip to vortical flow structures at kc 6 the vortex pair shows no shedding similar vortex patterns at different yaw angles result in similar hydrodynamic behaviors which validates the ip at small kc numbers the single and double pairs of vortex shedding regimes are observed for α 0 at kc 11 and 19 respectively and the vortex shedding process is determined by the movement of the cylinder as well as the interaction between vortices and shear layers as α increases to 45 the shear layers are stretched and show attachment to the upper and lower sides of the cylinder for most of the time within one oscillating cycle the shedding is only observed at the end of each half cycle and the vortices are found to reattach to the cylinder body the subsequent drag force behavior of the yawed cylinder displays significant differences from that at α 0 and hence the ip is no longer applicable at kc 11 and 19 when kc increases to 25 a three pairs of vortex shedding regime can be observed at both α 0 and 45 a similar flow feature characterized by the shear layer attachment when the cylinder is at the neutral position and the vortex shedding at the end of each half cycle has been found for both α 0 and 45 this result indicates that the ip becomes valid for the yawed square cylinder when the kc is sufficiently large until it is analogous to the steady flow keywords vortical structure yawed square cylinder oscillatory flow independence principle particle image velocimetry 1 introduction the flow field around a cylindrical structure exposed to the oscillatory flow has attracted extensive attentions due to its high relevance to coastal and offshore engineering in oscillatory flows it is known that both the flow regimes and hydrodynamics are functions of keulegan carpenter number kc u m t d where u m is the maximum velocity of the sinusoidal oscillation t is the oscillatory period and d is the characteristic length of the cylinder and stokes number β re kc where re u m d ν is reynolds number and ν is the kinematic viscosity of the fluid with the application of the particle image velocimetry piv technique in the last few decades the observation on the flow field around a cylinder becomes visually possible and this technique has been employed in a number of studies on the interactions between cylindrical structures and oscillatory flows or waves sarpkaya 2002 lam and dai 2002 yang and rockwell 2004 ozgoren and rockwell 2007 by presenting flow properties accessible to visual perceptions the piv technique provides an intuitional way to facilitate the understanding and analysis on the phenomenon lately extensive investigations on the bluff body of a square cross section in oscillatory flows have been carried out due to its practical application such as pontoons for tension leg platforms bearman et al 1984 or components of truss structures venugopal et al 2006 as well as its advantages in the hydrodynamic performance and the construction cost ozgoren and rockwell 1988 excited cylinders with various cross sections by controlling the transverse oscillations to the incident flow and examined the effect of excitations on the phase shift and recovery in the near wake of the cylinder they found that when the excitation frequency was equal to the vortex shedding frequency of the stationary cylinder the near wake structure was phase locked to the cylinder motion and the phase of the shedding vortices with respect to the cylinder displacement switched every half oscillating cycle this phenomenon has been found to be associated with the cylinder geometry and it does not occur when the cylinder has a significant after body e g a square cylinder at a threshold value of the oscillating frequency the near wake structure showed a new mode which was characterized by the formation of small scale vortices and the impairment of large scale vortices okajima et al 1998 carried out a flow visualization together with a force measurement for a square cylinder encountering oscillatory flows it was found that the inertia coefficient showed a constant value for a large range of kc numbers and its variation was practically independent of β number the kc number determined the shedding frequency of vortices and the classification of flow patterns there was a good agreement between the vortex shedding process and the time trace of the lift force but the periodicity in the flow patterns was found to be weak an isolated square cylinder undergoing a forced oscillation at various frequencies was studied by kumar and gowda 2007 using the flow visualization technique and the geometry influence was checked by comparing the flow patterns with those of an oscillating circular cylinder the vortex vortex interaction was significant at low excitation frequencies due to the long feeding time as well as the coalescence of vortices which makes the vortices grow large in size before shedding the shear layer was observed to undergo swinging along the cylinder surface for a circular cylinder whereas for a square cylinder the wake region was fairly stable numerical simulations were conducted on a square cylinder immersed in the oscillatory flow by chern et al 2007 at moderate re and kc numbers they employed the spectral analysis on the in line force coefficients to demonstrate the change of the flow from order to chaos it was concluded that the influence of re on the force coefficients was not significant while kc played a dominant role in the variation of the force coefficients more harmonics calculated from fourier analysis were observed in the in line force coefficients with the increase of kc indicating the complex vortex shedding regimes at large kc numbers in reality however the flow may approach the cylindrical structure obliquely owing to the directionality of the structure to simplify the analysis only the velocity component perpendicular to the cylinder axis is used to quantify the hydrodynamic forces and the strouhal number st this is the so called independence principle ip that the drag coefficient and st are independent of the cylinder yaw angle when the flow velocity component perpendicular to the cylinder axis is considered for a yawed circular cylinder in oscillatory flows or waves under different kc and β numbers previous studies mainly concentrated on measurements of the hydrodynamic forces acting on the cylinder body for instance the ip was found to be inapplicable for a yawed circular cylinder by sarpkaya 1982 due to the deviation in the drag coefficient at large cylinder yaw angles except in the drag dominated high kc range kc 20 where the ip might be valid from the measurement of oscillatory wave forces on a yawed circular cylinder cotter and chakrabarti 1984 found that the ip was valid for kc 5 until a yaw angle of 45 as the differences in both the inertia and drag coefficients were negligible between the yawed and vertical cylinders chakrabarti and armbrust 1987 investigated the total force coefficient for a yawed circular cylinder in the oscillatory flow and it was found that significant differences existed in both drag and inertia coefficients within the kc range of 10 20 between the yaw angle of 0 and 30 indicating the invalidity of the ip the different force behaviors should be attributed to the effect of the vortex interaction at different yaw angles sundar et al 1998 set up a circular cylinder yawed against or along the wave propagation direction at an angle 0 45 and measured the wave induced dynamic pressures around the cylinder body the ip was not valid for kc 4 as the drag coefficient at the yaw angle of 45 was found to be higher than that of small angles while the inertia coefficient at 45 was much lower than that of small angles therefore the orientation angle of the cylinder with respect to the wave propagation should be considered in the evaluation of hydrodynamic forces as summarized above previous studies about the square cylinder in oscillatory flows or waves mainly focus on the flow approaching the cylinder at an angle of zero even for the yawed circular cylinder the investigations were only limited to the force measurement although the validity of the ip for a yawed square cylinder in oscillatory flow has been examined by lou et al 2017 in terms of the hydrodynamic coefficients and the vortex shedding frequency the mechanism behind the force behavior remains unknown with the aid of the piv technique the present study is concerned with the formation shedding and evolution of the vortices by investigating the phase averaged flow fields at different cylinder yaw angles and kc numbers which compensates that reported in lou et al 2017 this paper starts with the demonstration of flow fields around a circular cylinder in oscillatory flows for benchmark purposes then the evolutions of vortices around a yawed square cylinder are presented and discussed for different yaw angles the ip is correlated to vortical flow structures at various kc numbers and finally the conclusions are drawn in addition comparisons have also been made for the flow features between the yawed square cylinder and the yawed circular one due to the length limitation of the paper only results of four kc numbers are presented here by following the previous study by lou et al 2017 from which the classification of vortex shedding pattern is reproduced fig 1 the selection of kc numbers in the present study follows two rules one is that each kc number should represent a vortex shedding regime varying from no shedding to three pairs of vortices shedding the other is to cover ranges for both validity and invalidity of the ip apart from the present results of the vortex shedding pattern the drag coefficients at the selected kc numbers reproduced from the study by lou et al 2017 are also included in this paper to consolidate the evaluation on the ip results of vortex shedding frequency for different yaw angles are no longer discussed here due to the weak dependence of the strouhal number on the yaw angle as concluded by lou et al 2017 2 experimental setup 2 1 oscillating motion system the experiment was conducted in a water flume with dimensions of 0 4 m width 15 m length 0 5 m depth schematics of front view and three dimensional 3d view of the setup are shown in fig 2 the whole setup consists of two systems i e the oscillating motion system and the flow visualization system a belt driven linear actuator hisaka was used to achieve the sinusoidal oscillation along a long beam which was fixed on top of the water flume and located in the middle of the flume width a 7340 type ni national instrument motion control card was used for the communication with a motion controller umi universal motion interface 7764 a sinusoidal oscillation control software was adopted to generate the oscillatory motion within a period t range of 1 0 10 0 s and an amplitude a range of 0 0 7 m which could be modelled as x t a cos 2 π t t x is the position and a function of time t transparent solid cylinder rods made of acrylic with a side width d 0 01 m or 0 02 m were employed in the tests the material of transparent acrylic guarantees high light transmission and low light reflection leading to practically no block on the laser illuminating area behind the cylinder the cylinder models were cut at four different angles α 0 15 30 and 45 on both ends to make the cylinder bodies yawed and two end cross sections parallel with the bottom wall of the flume the yaw angle α is defined as the angle between the flow direction and the plane perpendicular to the cylinder axis which is equal to the angle between the cylinder axis and the vertical plane y z fig 2 the cylinder model was mounted on the carrier which can slide along the beam the vertical projection length of the cylinder immersed in water was maintained as 0 35 m and the gap between the end of the cylinder and the bottom of the water flume was kept to be 0 003 m to reduce the end effect the interval between two consecutive tests was set to be at least 180 s to ensure that the water surface totally leveled out before the next test two energy absorbers placed at respective end of the flume so that to reduce the residual effect the flow regime is governed by the kc number which is determined by the oscillation amplitude when the cylinder side width is fixed i e kc u m t d 2 π a t d t 2 π a d the present study selected one oscillating amplitude to obtain a kc number corresponding to one vortex shedding regime e g d 0 02 m and a 0 02 m corresponding to kc 6 for no vortex shedding regime d 0 02 m and a 0 035 m corresponding to kc 11 for single pair of vortex shedding regime etc table 1 lists the experimental parameters in the present study with an oscillatory period of 2 s it should be noticed that apart from the cylinder model with a side length of 0 02 m the one with a smaller side width 0 01 m was also employed to achieve a high kc number with a relatively small oscillation amplitude due to the limited imaging area of the camera it has been suggested by a previous study okajima et al 1998 that within the range of β number examined in the present study its effect on the measured force coefficients of a square cylinder is negligible lam and dai 2002 also suggested that when re was sufficiently high above 1000 the effect of β could be secondary therefore the difference in β numbers which attributed to the different cylinder side width has been neglected in the present study the blockage was 1 20 or less for the present experiment the free surface effect was evaluated by the froude number f r u m g h where g is the gravitational acceleration and h is the submerged depth of the plane examined below the still water surface and the maximum value of f r was found to be 0 121 therefore the effect from the free surface was considered to be negligible as well 2 2 flow visualization system the test section of the water flume is made of high quality optical glass for the laser illumination and the camera imaging the digital piv system employed a 5 watt continuous wave argo ion laser for the illumination a laser sheet was shot from the side of the water flume to cut through the cylinder for the measurement of vortical structures fig 2 the laser sheet was with a thickness of 1 mm and was set as 0 15 m above the bottom of the water flume the water was seeded with neutrally buoyant synthetic polycrystalline particles with a diameter of 1 5 μm the particle has a density close to that of water and thus can suspend and be uniformly distributed in water the images were captured by a high speed camera photron fastcam sa3 this monochrome camera has a maximum image resolution of 1024 pixels 1024 pixels and a maximum frame rate of 2000 frames s given the internal memory of the camera a resolution of 1024 pixels 784 pixels together with a sampling rate of 500 frames s and a shutter speed of 1 2000 s were chosen after a number of trial tests to obtain the optimal images with high definition and contrast at this frame rate about 7200 continuous flow fields were obtained for each case which covered about 8 oscillating cycles the maximum effective plane of the laser sheet applied in the present experiment was 120 mm 120 mm the interrogation window size was set to be 32 pixels 32 pixels with an overlap of 50 leading to an effective grid size of 1 9 mm patterns of instantaneous vortices were realized using the frame to frame correlation technique keane and adrian 1992 which was implemented using a post processing software microvec vision asia the software is able to correct or remove inappropriate vectors caused by the experimental uncertainties based on a built in evaluation algorithm the uncertainty in the measurement was estimated to be approximately 5 the present flow field tends to be three dimensional especially when the cylinder is yawed the out of plane velocity may lead to errors in the two dimensional measurement due to the perspective projection effect this systematic effect as suggested by wang and zhou 2009 can be treated as random errors and should not affect the realization of the flow fields 3 results and discussions 3 1 vortical structures around a yawed circular cylinder 3 1 1 vortex pattern at kc 6 to verify the present experimental setup the instantaneous vortex contours and the corresponding vector fields around a circular cylinder at kc 6 are firstly examined and the results are shown in fig 3 hereafter the dash lines represent the negative contours rotating in clockwise direction and the solid lines represent the positive contours rotating in counter clockwise direction both the x and y axes are normalized with d the vorticity is normalized by d and u m and denoted by the asterisk i e ω z ω z d u m the zero position on x axis indicates the neutral position of the sinusoidal oscillating motion and the zero position on y axis indicates the position of the centerline of the wake a circular cylinder with a diameter of 0 02 m was oscillated with a period of 2 s and an amplitude of 0 02 m corresponding to β 200 and re 1200 based on the classification of vortex shedding regimes from the previous study williamson 1985 the flow pattern is characterized by the generation of a pair of asymmetric vortices without shedding as seen from fig 3 a a pair of vortices are formed on the right side of the cylinder when the cylinder just arrives at the leftmost position or starts to move towards the right as the cylinder is moving to right the vortex pair becomes asymmetric at t t 4 when the negative vortex at the lower side of the cylinder grows stronger fig 3b in the second half of the cycle a similar process has been observed except that the positive and negative vortices are swapped in location clearly there is no shedding occurring as the attached vortex pair is washed away quickly over the cylinder surface and the detached vortices vanish rapidly according to lam et al 2010a no large scale vortices can be completely shed from the cylinder when kc is smaller than 8 and only small vortices are found to remain attached to or detached from the cylinder surface for a short time which has also been observed in the present study both the vector fields displayed on the right hand column and the contour plots on the left hand column correspond well with the results of a circular cylinder at kc 6 28 by lam and dai 2002 3 1 2 vortex pattern at kc 11 the large scale structures are of importance in the analysis on the evolution of vortical flow structures the phase averaging method has been employed in the present study to obtain the large scale vortex contours due to the highly periodic and repeatable flow patterns over the cycles eight phases are locked within one oscillating period namely t 0 t 8 2t 8 7t 8 and 8 piv realizations are averaged for each phase fig 4 shows the phase averaged vortex contours around a circular cylinder at kc 11 starting with the cylinder is at the leftmost position a cylinder with a diameter of 0 02 m was oscillated with a period of 2 s and an amplitude of 0 035 m corresponding to β 200 and re 2200 the flow pattern should be characterized by a vortex street aligned in a lateral direction or at an oblique angle to the cylinder oscillating direction williamson 1985 it can be seen from fig 4 that the vortices in the form of a transverse street occur only on one side of the cylinder oscillating line and the vortices are convecting away at about 45 to the oscillating direction which was also reported by lam and dai 2002 at the similar kc at t t 8 a newly shed negative vortex from the end of the previous cycle is observed and it travels in the direction inclined to the oscillating line from t t 8 fig 4 b a positive vortex formed in the previous phase keeps growing on the upper side of the cylinder body and meanwhile another negative vortex starts to form on the lower side of the cylinder at t 2t 8 fig 4 c the cylinder is travelling with the highest speed to the right and the positive vortex at the upper side keeps growing and shows a trend of detaching from fig 4 d to fig 4 e the well established positive vortex is shed from the cylinder body by the intrusion of the flow stream into the space between the moving cylinder and the shear layer associated with the shedding of the positive vortex the negative one is observed to move upward along the cylinder surface as shown in fig 4 f to fig 4 h another vortex rotating in clockwise direction is strengthened and detached by following a similar process to the first half period when the cylinder is moving from the right to the left attentions should be drawn on the origination of the negative vortex at the very beginning at t t 8 when this clockwise roll starts to show up until being detached in fig 4 g this clockwise rotating vortex moves from the lower side to the upper side of the cylinder body a similar process for the counter clockwise vortex should be obtained due to symmetric nature of the flow field as reported by lam and dai 2002 two counter rotating vortices were formed and shed from the alternate sides of the cylinder over two strokes within kc 7 13 due to the secondary flow stream inclined at roughly 45 and the returning stroke of the cylinder the shed vortices were convecting upward in the lateral direction with an angle to the oscillating direction when the cylinder is yawed with an angle only the velocity component perpendicular to the cylinder axis u m n is considered in the calculation of kc i e kc u m n t d where u m n u m cos α therefore the amplitude of the oscillation at α 45 is required to be larger than that of α 0 to obtain the same kc number to keep it consistent and avoid confusions hereafter all the kc numbers in the present study are normalized by u m n and are denoted as kc the phase averaged vortex contours at α 45 and kc 11 are shown in fig 5 as the images were taken from the plane parallel with the oscillating direction the cross section of the circular cylinder becomes ellipse when it is yawed in some figures e g figs 5 a and h the cylinder body cannot be presented due to the limited imaging area at t t 8 and 2t 8 a pair of vortices with opposite signs are formed and developed at upper and lower sides of the cylinder body respectively from t 2t 8 to 3t 8 the asymmetric vortex pair is formed and part of the positive vortex is detached from the cylinder body while the negative vortex contour is enhanced when the cylinder keeps moving to the right apart from the high speed of the cylinder motion the shedding of the positive vortex is also associated with the fluid circulation induced by the adjacent negative vortex in fig 5 c this mode of vortex interaction assisting the shedding was also proposed by lam et al 2010a at kc 16 the negative vortex at the lower side moves along the cylinder surface to the upper side and is shed at the end of the first half cycle t 4t 8 both the positive and negative contours break down into smaller scale structures and dissipate quickly after shedding meanwhile another pair of vortices starts to form at this phase with an equal strength but with the negative vortex on the upper side and the positive one on the lower side of the cylinder fig 5 e as the cylinder keeps moving to the left the negative vortex still shows an enhancement while the positive vortex shows a reduction until the end of the cycle the negative vortex is shed from the cylinder body it can be seen that the shedding vortex contour at α 45 is still convecting only upward about 45 with respect to the oscillating direction after detaching leading to a lateral vortex street regime at this kc number in addition the swinging of the vortex contours at α 45 is not as strong as that at α 0 and the shedding process is delayed at α 45 due to the longer after body when the cylinder is yawed this phenomenon limits the wake width of the yawed cylinder and leads to less blocking in the wake therefore a decrease in the drag force is observed for a circular cylinder yawed with large angles at kc 11 chakrabarti and armbrust 1987 on the other hand the delayed vortex shedding at α 45 induces a larger vortex formation length which also contributes to the reduction of the drag as the vortices are formed further away from the base of the cylinder and hence the base pressure increases 3 2 vortical structures around a yawed square cylinder 3 2 1 vortex pattern at kc 6 before the investigation on the vortical structures the spectrum of the lift force for the square cylinder at zero yaw angle is examined to determine the vortex shedding regime the results reproduced from lou et al 2017 are displayed in fig 6 the vortex shedding frequency f l is indicated by the most pronounced peak on the power spectrum when it is normalized by the frequency of the oscillatory motion f o the value n l f l f o is defined as the dominant frequency which corresponds to the number of vortex pair shed per half oscillating period plus 1 for example it is found that n l 1 at kc 6 from fig 6 and hence a flow regime with zero vortex pair shedding should be anticipated fig 7 10 demonstrate the phase averaged vortex contours around a square cylinder at kc 6 for different yaw angles at α 0 fig 7 the vortex pair formed at the upper and lower sides of the cylinder surface is relatively symmetric about the wake centerline this should be attributed to the effect from the cross section that the separation points of the square cylinder are fixed at the two tips of the cylinder and thus leading to the symmetric vortex shedding it is also found that there is no movement of the attached vortices along the cylinder surface these results are in agreement with those by chern et al 2007 from a numerical study on a square cylinder that one pair of symmetric vortices is formed at the leeside of the cylinder at t 4t 8 of every cycle once the flow or cylinder moving direction is changed the symmetric vortex pair disappears they also proposed that this flow mode showed up at about kc 3 10 and the symmetric flow field resulted in rather small lift forces which was found by lou et al 2017 as well overall the flow fields demonstrate an apparent periodicity from cycle to cycle and an anti symmetry between the first half and the second half of the oscillating cycle at t t 8 a positive vortex and a negative vortex are formed at upper and lower sides of the cylinder body respectively for the next two phases the vortex pair continues to grow there seems to be a vortex shedding at the end of the first half cycle t 4t 8 but the vortex pair disappears rapidly then the second half cycle starts and the same process as the first half cycle repeats only with the location swapped between the positive and negative vortices when the yaw angle is introduced fig 8 10 one can see that the flow features are similar to those at α 0 the cross section of the square cylinder becomes a rectangle when it is yawed generally the vortex pair formed at the upper and lower sides of the cylinder surface still shows a symmetry about the wake centerline the evolution of the vortices for the first half cycle is practically a mirror process of that for the second half cycle the vortex contours at α 15 and 30 seem to break into small scale structures due to the shedding at the end of the first half cycle according to fig 8 d and fig 9 d which should result from the high speed of the cylinder passing the neutral position from the former phase this phenomenon is absent for α 45 of which the longer after body makes the shear layer harder to separate this long after body effect can be significant as one can see from fig 10 a c that the positive vortex on the upper side of the cylinder is shed at first but coalescent into the shear layer at the next phase the maximum magnitude of the vortex contours shows a reduction of approximately 14 as α varies from 0 to 45 although the patterns of contours at α 45 are still organized as mentioned previously the amplitudes of the oscillating motion for α 30 and 45 are actually larger than that for α 0 to obtain the same kc according to lam and dai 2002 the vortices at larger oscillating amplitude covered a larger area and possessed a higher magnitude which should be attributed to the longer stroke of the cylinder movement and thus permits the growth of the attached vortices this probably cancels out the effect from the axial flows when the cylinder is yawed at large angles if the axial velocity component is generated as that in the steady flow lou et al 2016 on the other hand at small kc numbers the strokes of the cylinder are rather small therefore the flow acceleration and the vortex activities are not very strong and hence less influence from the movement of the water particles around the cylinder will be observed this may reduce the effect of the yaw angles on the flow field and lead to similar flow features the normalized drag c d n coefficient at a stokes number β 500 close to the present study reproduced from lou et al 2017 for kc numbers examined here are demonstrated in fig 11 for reference the ratio between the coefficient at various yaw angles and the coefficient at α 0 indicated by the subscript 0 is also included to provide a more direct evaluation on the ip the ratio should be equal to 1 for the validity of the ip however a tolerance of 5 due to the experimental uncertainty should be accounted according to fig 11 the maximum difference in drag coefficient between α 0 and 45 is found to be 1 5 at kc 6 as the hydrodynamic forces are highly associated with the flow field the anticipated similar vortex shedding process for various yaw angles has been discussed above for which the ip is found to be valid until 45 lou et al 2017 at low kc numbers the oscillating acceleration and vortex shedding are not very strong therefore less influence on the movement of the water particles from the yaw angle are expected 3 2 2 vortex patterns at kc 11 the flow regime at kc 11 is classified as the single pair of vortices shedding according to fig 6 b with the peak location at n l 2 the phase averaged vortex contours at α 0 15 and 45 are shown in figs 12 14 respectively at α 0 a pair of vortices with opposite signs is formed at either side of the cylinder from t t 8 in fig 12 b as the cylinder continues moving to the right the positive vortex at the upper side grows faster than the negative one at the lower side this asymmetric flow filed leads to the generation of the lift force lou et al 2017 from t 2t 8 to 3t 8 the positive vortex continues to stretch and wrap the negative one displaying a trend to be shed at the end of the first half cycle fig 12 e a pair of vortices is shed from the cylinder body one can also see another positive vortex starts to grow at the lower side then the negative vortex is totally reattached to the upper side as the cylinder is moving from the rightmost position to the left at t 5t 8 the pair of vortices continues to grow and eventually sheds at the end of the cycle this vortex formation and shedding process around a square cylinder was also found by kumar and gowda 2007 who concluded that the momentary reattachment of the shear layers on the respective side cut off the feeding vorticity into the respective vortices some differences can be observed in the flow features compared with those of the circular cylinder shown in fig 4 the flow pattern around a circular cylinder is characterized by a vortex street aligned in a lateral direction or at an oblique angle to the cylinder oscillating direction at this kc number in contrast this vortex shedding pattern is absent for the square cylinder kumar and gowda 2007 explained that the difference in the geometry contributes to the difference in the flow field i e a circular cylinder had more vortices shed from the upper shear layer than the lower one thus leading to the asymmetric shedding whereas a square cylinder had an equal number of vortices in both shear layers thus making the base region relatively stable as a matter of fact the shear layer swings around the circular cylinder when the cylinder oscillates resulting in the separation points move along the cylinder surface while for the square cylinder the separation points are fixed at the two tips and there is no shear layer swinging around the cylinder surface in addition the vortex streets formed along the cylinder centerline indicate that the secondary flow stream moves along the oscillating line and changes direction accordingly when the cylinder reverses lam et al 2010b this secondary flow stream effect was also mentioned by chern et al 2007 that the shed vortex was dragged to the other side of the cylinder which was also observed for the positive vortex from t 5t 8 to 6t 8 as shown in fig 12 as α increases to 15 figure not shown here it has been noticed that the contour patterns of the vortex are not as organized as those at α 0 since more small scale structures are observed but overall the flow field still shows some similarities the vortex shedding process at α 30 shown in fig 13 displays a different feature to that at α 0 two vortices rotating in different directions are formed and continue to grow when the cylinder is moving from the left to the neutral position t 2t 8 however at t 3t 8 fig 13 d the formed vortex pair is being detached from the cylinder at t 6t 8 another pair of vortices is shed in the leeward wake as the cylinder passes the neutral position compared with the flow field of α 15 some differences can also be observed at t 3t 8 where the vortical structures are more attached around the cylinder surface which should be attributed to the longer after body at α 30 than that at α 15 as α increases to 45 fig 14 the vortex contours show more differences from those at the smaller yaw angles when the cylinder starts to move from the leftmost position to the right a pair of vortices with opposite signs is just shed from the stretched shear layers from t t 8 to 3t 8 a vortex pair is formed with a positive vortex at the upper side and a negative vortex at the lower side and both vortices are well established with similar strength ω z m a x 6 7 ω z m i n 6 2 at 3t 8 a vortex pair is shed from the leeward side of the cylinder fig 14 d however the newly shed vortex pair displays an asymmetric feature that the negative vortex continues to grow and the positive one dissipates rapidly as there is only one well established negative shedding contour observed when the cylinder reaches the rightmost position t 4t 8 when the cylinder starts to move to the left the negative vortex also disappears rather fast as there is no shed vortex observed at the following phase at the end of the cycle a negative vortex is shed from the upper side of the cylinder while a positive one is about to shed but delayed by the stretched shear layer at the lower side the delayed separation of the shear layers due to the long after body at large yaw angles may be mixed with the feeding fluid or the newly formed vortices brought by the returning stroke of the cylinder on the other hand a larger amplitude is required in the oscillatory motion of the cylinder at α 45 to gain the same kc number as that at α 0 under this condition the shear layers get more flow to feed the vortices before they are detached which explains the higher drag coefficients at larger yaw angles fig 11 and thus leading to the invalidity of the ip at this kc number 3 2 3 vortex pattern at kc 19 when kc increases to 19 the flow field is characterized by the double pairs of vortices shedding which has been reflected in fig 6 c with n l 3 more complex vortex shedding regimes are expected at large kc numbers and the flow filed becomes more chaotic the phase averaged vortex contours at α 0 15 and 45 are displayed here in figs 15 17 respectively at α 0 the cylinder just reaches the leftmost position at t 0 fig 15 a when two pairs of vortices are shed at the end of the previous cycle with the positive and negative vortices at the respective side however due to the stroke of the cylinder and the secondary flow stream the two newly shed vortex pairs coalesce into one pair at the next phase when passing the neutral position fig 15 c the cylinder travels with the highest speed and the vortex pair reattaches to the cylinder from t 2t 8 to 3t 8 one negative vortex and one positive vortex have been shed alternately the negative vortex dissipates rapidly fig 15 d and the positive one is driven by the secondary flow stream from the left side to the right side of the cylinder fig 15 e at t 5t 8 two vortices with different signs are formed on either side of the cylinder and they continue to grow when the cylinder is returning to the neutral position at t 6t 8 the newly formed two vortices keep growing until the next phase and are shed at the end of the cycle fig 15 h at α 15 more small scale structures are observed in the flow field as shown in fig 16 a pair of shed vortices is observed when the cylinder reaches the leftmost position at t 0 two vortices with different signs are attached to the cylinder body and continue to gain strength when the cylinder is moving from the left to the neutral position t 2t 8 at t 3t 8 fig 16 d the vortex pair is shed from the cylinder and it tends to be convected by the secondary flow stream at an angle with respect to the oscillating line at t 4t 8 a pair of vortices on the windward is about to shed but reattaches to the cylinder body in the next phase the shedding of vortex pair takes place on the leeward when the cylinder returns to the neutral position at t 6t 8 then another primary vortex pair continues to grow until the end of the whole cycle fig 16 h it can be seen from fig 17 that generally the formation and shedding process of vortices at α 45 are more symmetric than that at α 0 unlike that at α 0 with two vortex pairs shed almost at the same time at α 45 one pair of vortices is shed earlier and driven by the secondary flow stream at an angle with respect to the oscillating line fig 17 a the movement of vortical structures in the diagonal direction makes it difficult for the vortices to reattach to the cylinder during the first half cycle a vortex pair is formed and continues to grow as the cylinder is moving to the neutral position the vortex pair is stretched and it attaches to the surface of the cylinder at t 3t 8 there seems to be a pair of vortices about to shed until the end of the first half cycle t 4t 8 one can see two pairs of vortices are shed from the cylinder body and convecting in the diagonal direction and hence the α 45 case displays a larger wake width compared with that at α 0 a wider wake leads to more blocking of the fluid which results in an increase in the drag force fig 6 the difference in the flow field features and the subsequent force coefficients between the vertical cylinder and the yawed one leads to the invalidity of the ip 3 2 4 vortex pattern at kc 25 at kc 25 the three pairs of vortex shedding regime can be observed for both α 0 and 45 as shown in figs 18 and 19 respectively correspondingly the location of the peak on the spectrum of lift force leads to a dominant frequency of n l 4 due to the larger amplitude of the oscillating motion the vortices shed from the previous stroke may be present with the returning cylinder resulting in strong vortex interaction and dislocation for α 0 the cylinder is at the leftmost position at t 0 fig 18 a and it is observed that a pair of vortices has already been shed and the positive vortex of another pair is about to detach from the cylinder surface the nearly shed positive vortex from the previous phase then coalesces to the shear layer and continues to grow by the feeding from the incoming flow at t t 8 as the cylinder is moving fast to the neutral position t 2t 8 a negative vortex is shed from the lower surface and a positive vortex starts to form on the upper surface at the end of the first half cycle one negative vortex and one positive vortex are shed alternately from the leeward side of the cylinder this vortex interaction mechanism was also found by lam et al 2010a from a circular cylinder at kc 24 i e a shed vortex attached to the shear layer from one side e g windward and another vortex was shed from the other side e g leeward of the cylinder at the next phase when the cylinder returns from the right to the left another pair of vortices starts to form and grow the present result that the vortex street lies along the cylinder motion line is similar to that of a circular cylinder at kc 24 shown by lam et al 2010a at α 45 two pairs of vortices have already been shed from the cylinder body when the cylinder is at the leftmost position fig 19 a due to the limit imaging area the full cylinder body cannot be shown at phase t 0 but there should be another pair of vortices being formed on either side of the cylinder judging from the plot at t t 8 when the cylinder moves to the neutral position t 2t 8 the vortex pair continues to grow in strength but totally attaches to the long body of the cylinder the early shed vortex pair dissipates rather rapidly as no contours observed far away from the cylinder body a pair of vortices continues to grow and they are shed alternatively at t 3t 8 fig 19 d which has also been found at α 0 at t 4t 8 the positive vortex shed from the previous phase grows significantly in shape and there is another negative vortex being shed from the cylinder the newly shed negative vortex later coalesces to the shear layer and attaches to the upper side of the cylinder due to the returning stroke from the right to the left at t 5t 8 the convection of the negative vortex results from the effect of the secondary flow stream and the induced flow by the vortices as mentioned previously the secondary flow stream can move the shear layer along the surface of a circular cylinder due to its continuous curvature lam et al 2010a for a square cylinder however the vortex has to be detached before being transported by the secondary flow stream due to the fixed separation points vortex contours at both α 0 and 45 show similar features such as the relatively equal wake width the reattachment of the shear layer due to the delayed separation as well as the significant shedding normally at the end or beginning of each half cycle one can anticipate that the hydrodynamic behaviors should be similar for these two angles at kc 25 which is consistent with the results shown in fig 6 as the ip is found to be valid at this kc for α 45 apart from the vorticity the circulation at each phase is also of interest to examine so that more information on the vortex shedding can be extracted the circulation γ is calculated by integrating the measured spanwise vorticity over an area enclosed by the contour as γ ω z d a where a is the integrating area determined by the cutoff value selected obasaju et al 1988 showed that an area covering the cylinder surface would lead to a zero circulation which resulted from the cancellation of positive and negative values hence the integration has been carried out respectively for positive and negative contours around the cylinder body in the present study tow cutoff values of 30 and 40 of the maximum ω z contour are applied and it reveals a difference of approximately 15 for the circulation values the cutoff value of 30 is selected to enclose a larger integration area first of all the results at kc 25 for α 0 and 45 within an oscillating period are shown in fig 20 the circulation has been normalized as γ γ u m n d and the oscillating motion profile is also included in the figure generally the positive and negative circulations obtain a similar absolute value at the same phase the peak value of the circulation within an oscillation period appears approximately at the phase with the maximum velocity or the zero amplitude i e t 2t 8 or t 6t 8 this should be attributed to the strong interaction between the moving cylinder and the rolling shear layer for both the vertical and yawed cylinder the variation of the normalized circulation shows a similar trend and a comparable magnitude the maximum normalized circulation γ m a x within a oscillating period for different kc numbers is investigated here as well its dependence on the cylinder yaw angle is shown in fig 21 and the results show that the yaw angle effect is negligible in addition the value of γ m a x increases with the increasing kc number which results from the longer stroke of the cylinder movement and thus permits more growth in the attached vortices 4 conclusions following a previous study on the hydrodynamics of a yawed square cylinder in oscillatory flow lou et al 2017 the vortical structures around the cylinder yawed at 0 15 30 and 45 were investigated using the piv technique the ip has been correlated to the vortex formation shedding and evolution process and the effect of the yaw angle on the flow field has been examined the main findings are summarized below 1 at kc 6 a symmetric vortex pair is observed and shows no shedding the pattern of the vortices at α 45 is still as organized as that at α 0 at this low kc number the small relative motion between the cylinder and the water particles reduces the effect of the yaw angle and results in similar flow features which leads to similar hydrodynamic behaviors for the vertical and yawed cylinders and validates the ip at small kc numbers 2 at kc 11 and 19 the corresponding single pair and double pairs of vortex shedding regimes are observed respectively the vortex shedding process is determined by the movement of the cylinder and the interaction between the vortices and the shear layers as α increases to 45 the shear layers are stretched and the vortices show attachments to the upper and lower sides of the cylinder body for most of the time within one oscillating cycle the shedding is only observed at the end of each half cycle and the vortices are found to reattach to the cylinder due to the transportation by the secondary flow stream therefore the subsequent hydrodynamic behavior displays significant differences between the yawed and the vertical cylinders which invalidates the ip for kc 11 and 19 3 when kc increases to 25 a three pairs of vortex shedding regime is observed for both α 0 and 45 the phenomenon of the shear layer attachment when the cylinder is at the neutral position as well as the vortex shedding at the end of each half cycle indicate a similar flow field feature for both angles this result implies that the ip becomes valid when the kc is sufficiently large until it is analogous to the steady flow 4 the shear layers swing along the cylinder surface and show asymmetric shedding due to the movable separation points on a circular cylinder however the shear layers are more attached and symmetric due to the fixed separation points at the tips of a square cylinder the different geometries result in significant differences in the formation and evolution of vortices and the subsequent hydrodynamic force behaviors credit author statement xiaofan lou conceptualization methodology investigation data curation writing original draft preparation writing review editing kaibing zhang data curation visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge the support from national key research and development program of china 2017yfc1404202 and 2016yfe0200100 this work is also supported by national natural science foundation of china 51909028 x lou also sincerely acknowledges the support from australian research council through arc discovery projects dp110105171 
22205,the vortical structures around a yawed square cylinder oscillating in quiescent water are investigated using the particle image velocimetry technique following a previous study on the hydrodynamics lou et al 2017 the present experiments are performed at different yaw angles α and keulegan carpenter kc numbers to correlate the independence principle ip to vortical flow structures at kc 6 the vortex pair shows no shedding similar vortex patterns at different yaw angles result in similar hydrodynamic behaviors which validates the ip at small kc numbers the single and double pairs of vortex shedding regimes are observed for α 0 at kc 11 and 19 respectively and the vortex shedding process is determined by the movement of the cylinder as well as the interaction between vortices and shear layers as α increases to 45 the shear layers are stretched and show attachment to the upper and lower sides of the cylinder for most of the time within one oscillating cycle the shedding is only observed at the end of each half cycle and the vortices are found to reattach to the cylinder body the subsequent drag force behavior of the yawed cylinder displays significant differences from that at α 0 and hence the ip is no longer applicable at kc 11 and 19 when kc increases to 25 a three pairs of vortex shedding regime can be observed at both α 0 and 45 a similar flow feature characterized by the shear layer attachment when the cylinder is at the neutral position and the vortex shedding at the end of each half cycle has been found for both α 0 and 45 this result indicates that the ip becomes valid for the yawed square cylinder when the kc is sufficiently large until it is analogous to the steady flow keywords vortical structure yawed square cylinder oscillatory flow independence principle particle image velocimetry 1 introduction the flow field around a cylindrical structure exposed to the oscillatory flow has attracted extensive attentions due to its high relevance to coastal and offshore engineering in oscillatory flows it is known that both the flow regimes and hydrodynamics are functions of keulegan carpenter number kc u m t d where u m is the maximum velocity of the sinusoidal oscillation t is the oscillatory period and d is the characteristic length of the cylinder and stokes number β re kc where re u m d ν is reynolds number and ν is the kinematic viscosity of the fluid with the application of the particle image velocimetry piv technique in the last few decades the observation on the flow field around a cylinder becomes visually possible and this technique has been employed in a number of studies on the interactions between cylindrical structures and oscillatory flows or waves sarpkaya 2002 lam and dai 2002 yang and rockwell 2004 ozgoren and rockwell 2007 by presenting flow properties accessible to visual perceptions the piv technique provides an intuitional way to facilitate the understanding and analysis on the phenomenon lately extensive investigations on the bluff body of a square cross section in oscillatory flows have been carried out due to its practical application such as pontoons for tension leg platforms bearman et al 1984 or components of truss structures venugopal et al 2006 as well as its advantages in the hydrodynamic performance and the construction cost ozgoren and rockwell 1988 excited cylinders with various cross sections by controlling the transverse oscillations to the incident flow and examined the effect of excitations on the phase shift and recovery in the near wake of the cylinder they found that when the excitation frequency was equal to the vortex shedding frequency of the stationary cylinder the near wake structure was phase locked to the cylinder motion and the phase of the shedding vortices with respect to the cylinder displacement switched every half oscillating cycle this phenomenon has been found to be associated with the cylinder geometry and it does not occur when the cylinder has a significant after body e g a square cylinder at a threshold value of the oscillating frequency the near wake structure showed a new mode which was characterized by the formation of small scale vortices and the impairment of large scale vortices okajima et al 1998 carried out a flow visualization together with a force measurement for a square cylinder encountering oscillatory flows it was found that the inertia coefficient showed a constant value for a large range of kc numbers and its variation was practically independent of β number the kc number determined the shedding frequency of vortices and the classification of flow patterns there was a good agreement between the vortex shedding process and the time trace of the lift force but the periodicity in the flow patterns was found to be weak an isolated square cylinder undergoing a forced oscillation at various frequencies was studied by kumar and gowda 2007 using the flow visualization technique and the geometry influence was checked by comparing the flow patterns with those of an oscillating circular cylinder the vortex vortex interaction was significant at low excitation frequencies due to the long feeding time as well as the coalescence of vortices which makes the vortices grow large in size before shedding the shear layer was observed to undergo swinging along the cylinder surface for a circular cylinder whereas for a square cylinder the wake region was fairly stable numerical simulations were conducted on a square cylinder immersed in the oscillatory flow by chern et al 2007 at moderate re and kc numbers they employed the spectral analysis on the in line force coefficients to demonstrate the change of the flow from order to chaos it was concluded that the influence of re on the force coefficients was not significant while kc played a dominant role in the variation of the force coefficients more harmonics calculated from fourier analysis were observed in the in line force coefficients with the increase of kc indicating the complex vortex shedding regimes at large kc numbers in reality however the flow may approach the cylindrical structure obliquely owing to the directionality of the structure to simplify the analysis only the velocity component perpendicular to the cylinder axis is used to quantify the hydrodynamic forces and the strouhal number st this is the so called independence principle ip that the drag coefficient and st are independent of the cylinder yaw angle when the flow velocity component perpendicular to the cylinder axis is considered for a yawed circular cylinder in oscillatory flows or waves under different kc and β numbers previous studies mainly concentrated on measurements of the hydrodynamic forces acting on the cylinder body for instance the ip was found to be inapplicable for a yawed circular cylinder by sarpkaya 1982 due to the deviation in the drag coefficient at large cylinder yaw angles except in the drag dominated high kc range kc 20 where the ip might be valid from the measurement of oscillatory wave forces on a yawed circular cylinder cotter and chakrabarti 1984 found that the ip was valid for kc 5 until a yaw angle of 45 as the differences in both the inertia and drag coefficients were negligible between the yawed and vertical cylinders chakrabarti and armbrust 1987 investigated the total force coefficient for a yawed circular cylinder in the oscillatory flow and it was found that significant differences existed in both drag and inertia coefficients within the kc range of 10 20 between the yaw angle of 0 and 30 indicating the invalidity of the ip the different force behaviors should be attributed to the effect of the vortex interaction at different yaw angles sundar et al 1998 set up a circular cylinder yawed against or along the wave propagation direction at an angle 0 45 and measured the wave induced dynamic pressures around the cylinder body the ip was not valid for kc 4 as the drag coefficient at the yaw angle of 45 was found to be higher than that of small angles while the inertia coefficient at 45 was much lower than that of small angles therefore the orientation angle of the cylinder with respect to the wave propagation should be considered in the evaluation of hydrodynamic forces as summarized above previous studies about the square cylinder in oscillatory flows or waves mainly focus on the flow approaching the cylinder at an angle of zero even for the yawed circular cylinder the investigations were only limited to the force measurement although the validity of the ip for a yawed square cylinder in oscillatory flow has been examined by lou et al 2017 in terms of the hydrodynamic coefficients and the vortex shedding frequency the mechanism behind the force behavior remains unknown with the aid of the piv technique the present study is concerned with the formation shedding and evolution of the vortices by investigating the phase averaged flow fields at different cylinder yaw angles and kc numbers which compensates that reported in lou et al 2017 this paper starts with the demonstration of flow fields around a circular cylinder in oscillatory flows for benchmark purposes then the evolutions of vortices around a yawed square cylinder are presented and discussed for different yaw angles the ip is correlated to vortical flow structures at various kc numbers and finally the conclusions are drawn in addition comparisons have also been made for the flow features between the yawed square cylinder and the yawed circular one due to the length limitation of the paper only results of four kc numbers are presented here by following the previous study by lou et al 2017 from which the classification of vortex shedding pattern is reproduced fig 1 the selection of kc numbers in the present study follows two rules one is that each kc number should represent a vortex shedding regime varying from no shedding to three pairs of vortices shedding the other is to cover ranges for both validity and invalidity of the ip apart from the present results of the vortex shedding pattern the drag coefficients at the selected kc numbers reproduced from the study by lou et al 2017 are also included in this paper to consolidate the evaluation on the ip results of vortex shedding frequency for different yaw angles are no longer discussed here due to the weak dependence of the strouhal number on the yaw angle as concluded by lou et al 2017 2 experimental setup 2 1 oscillating motion system the experiment was conducted in a water flume with dimensions of 0 4 m width 15 m length 0 5 m depth schematics of front view and three dimensional 3d view of the setup are shown in fig 2 the whole setup consists of two systems i e the oscillating motion system and the flow visualization system a belt driven linear actuator hisaka was used to achieve the sinusoidal oscillation along a long beam which was fixed on top of the water flume and located in the middle of the flume width a 7340 type ni national instrument motion control card was used for the communication with a motion controller umi universal motion interface 7764 a sinusoidal oscillation control software was adopted to generate the oscillatory motion within a period t range of 1 0 10 0 s and an amplitude a range of 0 0 7 m which could be modelled as x t a cos 2 π t t x is the position and a function of time t transparent solid cylinder rods made of acrylic with a side width d 0 01 m or 0 02 m were employed in the tests the material of transparent acrylic guarantees high light transmission and low light reflection leading to practically no block on the laser illuminating area behind the cylinder the cylinder models were cut at four different angles α 0 15 30 and 45 on both ends to make the cylinder bodies yawed and two end cross sections parallel with the bottom wall of the flume the yaw angle α is defined as the angle between the flow direction and the plane perpendicular to the cylinder axis which is equal to the angle between the cylinder axis and the vertical plane y z fig 2 the cylinder model was mounted on the carrier which can slide along the beam the vertical projection length of the cylinder immersed in water was maintained as 0 35 m and the gap between the end of the cylinder and the bottom of the water flume was kept to be 0 003 m to reduce the end effect the interval between two consecutive tests was set to be at least 180 s to ensure that the water surface totally leveled out before the next test two energy absorbers placed at respective end of the flume so that to reduce the residual effect the flow regime is governed by the kc number which is determined by the oscillation amplitude when the cylinder side width is fixed i e kc u m t d 2 π a t d t 2 π a d the present study selected one oscillating amplitude to obtain a kc number corresponding to one vortex shedding regime e g d 0 02 m and a 0 02 m corresponding to kc 6 for no vortex shedding regime d 0 02 m and a 0 035 m corresponding to kc 11 for single pair of vortex shedding regime etc table 1 lists the experimental parameters in the present study with an oscillatory period of 2 s it should be noticed that apart from the cylinder model with a side length of 0 02 m the one with a smaller side width 0 01 m was also employed to achieve a high kc number with a relatively small oscillation amplitude due to the limited imaging area of the camera it has been suggested by a previous study okajima et al 1998 that within the range of β number examined in the present study its effect on the measured force coefficients of a square cylinder is negligible lam and dai 2002 also suggested that when re was sufficiently high above 1000 the effect of β could be secondary therefore the difference in β numbers which attributed to the different cylinder side width has been neglected in the present study the blockage was 1 20 or less for the present experiment the free surface effect was evaluated by the froude number f r u m g h where g is the gravitational acceleration and h is the submerged depth of the plane examined below the still water surface and the maximum value of f r was found to be 0 121 therefore the effect from the free surface was considered to be negligible as well 2 2 flow visualization system the test section of the water flume is made of high quality optical glass for the laser illumination and the camera imaging the digital piv system employed a 5 watt continuous wave argo ion laser for the illumination a laser sheet was shot from the side of the water flume to cut through the cylinder for the measurement of vortical structures fig 2 the laser sheet was with a thickness of 1 mm and was set as 0 15 m above the bottom of the water flume the water was seeded with neutrally buoyant synthetic polycrystalline particles with a diameter of 1 5 μm the particle has a density close to that of water and thus can suspend and be uniformly distributed in water the images were captured by a high speed camera photron fastcam sa3 this monochrome camera has a maximum image resolution of 1024 pixels 1024 pixels and a maximum frame rate of 2000 frames s given the internal memory of the camera a resolution of 1024 pixels 784 pixels together with a sampling rate of 500 frames s and a shutter speed of 1 2000 s were chosen after a number of trial tests to obtain the optimal images with high definition and contrast at this frame rate about 7200 continuous flow fields were obtained for each case which covered about 8 oscillating cycles the maximum effective plane of the laser sheet applied in the present experiment was 120 mm 120 mm the interrogation window size was set to be 32 pixels 32 pixels with an overlap of 50 leading to an effective grid size of 1 9 mm patterns of instantaneous vortices were realized using the frame to frame correlation technique keane and adrian 1992 which was implemented using a post processing software microvec vision asia the software is able to correct or remove inappropriate vectors caused by the experimental uncertainties based on a built in evaluation algorithm the uncertainty in the measurement was estimated to be approximately 5 the present flow field tends to be three dimensional especially when the cylinder is yawed the out of plane velocity may lead to errors in the two dimensional measurement due to the perspective projection effect this systematic effect as suggested by wang and zhou 2009 can be treated as random errors and should not affect the realization of the flow fields 3 results and discussions 3 1 vortical structures around a yawed circular cylinder 3 1 1 vortex pattern at kc 6 to verify the present experimental setup the instantaneous vortex contours and the corresponding vector fields around a circular cylinder at kc 6 are firstly examined and the results are shown in fig 3 hereafter the dash lines represent the negative contours rotating in clockwise direction and the solid lines represent the positive contours rotating in counter clockwise direction both the x and y axes are normalized with d the vorticity is normalized by d and u m and denoted by the asterisk i e ω z ω z d u m the zero position on x axis indicates the neutral position of the sinusoidal oscillating motion and the zero position on y axis indicates the position of the centerline of the wake a circular cylinder with a diameter of 0 02 m was oscillated with a period of 2 s and an amplitude of 0 02 m corresponding to β 200 and re 1200 based on the classification of vortex shedding regimes from the previous study williamson 1985 the flow pattern is characterized by the generation of a pair of asymmetric vortices without shedding as seen from fig 3 a a pair of vortices are formed on the right side of the cylinder when the cylinder just arrives at the leftmost position or starts to move towards the right as the cylinder is moving to right the vortex pair becomes asymmetric at t t 4 when the negative vortex at the lower side of the cylinder grows stronger fig 3b in the second half of the cycle a similar process has been observed except that the positive and negative vortices are swapped in location clearly there is no shedding occurring as the attached vortex pair is washed away quickly over the cylinder surface and the detached vortices vanish rapidly according to lam et al 2010a no large scale vortices can be completely shed from the cylinder when kc is smaller than 8 and only small vortices are found to remain attached to or detached from the cylinder surface for a short time which has also been observed in the present study both the vector fields displayed on the right hand column and the contour plots on the left hand column correspond well with the results of a circular cylinder at kc 6 28 by lam and dai 2002 3 1 2 vortex pattern at kc 11 the large scale structures are of importance in the analysis on the evolution of vortical flow structures the phase averaging method has been employed in the present study to obtain the large scale vortex contours due to the highly periodic and repeatable flow patterns over the cycles eight phases are locked within one oscillating period namely t 0 t 8 2t 8 7t 8 and 8 piv realizations are averaged for each phase fig 4 shows the phase averaged vortex contours around a circular cylinder at kc 11 starting with the cylinder is at the leftmost position a cylinder with a diameter of 0 02 m was oscillated with a period of 2 s and an amplitude of 0 035 m corresponding to β 200 and re 2200 the flow pattern should be characterized by a vortex street aligned in a lateral direction or at an oblique angle to the cylinder oscillating direction williamson 1985 it can be seen from fig 4 that the vortices in the form of a transverse street occur only on one side of the cylinder oscillating line and the vortices are convecting away at about 45 to the oscillating direction which was also reported by lam and dai 2002 at the similar kc at t t 8 a newly shed negative vortex from the end of the previous cycle is observed and it travels in the direction inclined to the oscillating line from t t 8 fig 4 b a positive vortex formed in the previous phase keeps growing on the upper side of the cylinder body and meanwhile another negative vortex starts to form on the lower side of the cylinder at t 2t 8 fig 4 c the cylinder is travelling with the highest speed to the right and the positive vortex at the upper side keeps growing and shows a trend of detaching from fig 4 d to fig 4 e the well established positive vortex is shed from the cylinder body by the intrusion of the flow stream into the space between the moving cylinder and the shear layer associated with the shedding of the positive vortex the negative one is observed to move upward along the cylinder surface as shown in fig 4 f to fig 4 h another vortex rotating in clockwise direction is strengthened and detached by following a similar process to the first half period when the cylinder is moving from the right to the left attentions should be drawn on the origination of the negative vortex at the very beginning at t t 8 when this clockwise roll starts to show up until being detached in fig 4 g this clockwise rotating vortex moves from the lower side to the upper side of the cylinder body a similar process for the counter clockwise vortex should be obtained due to symmetric nature of the flow field as reported by lam and dai 2002 two counter rotating vortices were formed and shed from the alternate sides of the cylinder over two strokes within kc 7 13 due to the secondary flow stream inclined at roughly 45 and the returning stroke of the cylinder the shed vortices were convecting upward in the lateral direction with an angle to the oscillating direction when the cylinder is yawed with an angle only the velocity component perpendicular to the cylinder axis u m n is considered in the calculation of kc i e kc u m n t d where u m n u m cos α therefore the amplitude of the oscillation at α 45 is required to be larger than that of α 0 to obtain the same kc number to keep it consistent and avoid confusions hereafter all the kc numbers in the present study are normalized by u m n and are denoted as kc the phase averaged vortex contours at α 45 and kc 11 are shown in fig 5 as the images were taken from the plane parallel with the oscillating direction the cross section of the circular cylinder becomes ellipse when it is yawed in some figures e g figs 5 a and h the cylinder body cannot be presented due to the limited imaging area at t t 8 and 2t 8 a pair of vortices with opposite signs are formed and developed at upper and lower sides of the cylinder body respectively from t 2t 8 to 3t 8 the asymmetric vortex pair is formed and part of the positive vortex is detached from the cylinder body while the negative vortex contour is enhanced when the cylinder keeps moving to the right apart from the high speed of the cylinder motion the shedding of the positive vortex is also associated with the fluid circulation induced by the adjacent negative vortex in fig 5 c this mode of vortex interaction assisting the shedding was also proposed by lam et al 2010a at kc 16 the negative vortex at the lower side moves along the cylinder surface to the upper side and is shed at the end of the first half cycle t 4t 8 both the positive and negative contours break down into smaller scale structures and dissipate quickly after shedding meanwhile another pair of vortices starts to form at this phase with an equal strength but with the negative vortex on the upper side and the positive one on the lower side of the cylinder fig 5 e as the cylinder keeps moving to the left the negative vortex still shows an enhancement while the positive vortex shows a reduction until the end of the cycle the negative vortex is shed from the cylinder body it can be seen that the shedding vortex contour at α 45 is still convecting only upward about 45 with respect to the oscillating direction after detaching leading to a lateral vortex street regime at this kc number in addition the swinging of the vortex contours at α 45 is not as strong as that at α 0 and the shedding process is delayed at α 45 due to the longer after body when the cylinder is yawed this phenomenon limits the wake width of the yawed cylinder and leads to less blocking in the wake therefore a decrease in the drag force is observed for a circular cylinder yawed with large angles at kc 11 chakrabarti and armbrust 1987 on the other hand the delayed vortex shedding at α 45 induces a larger vortex formation length which also contributes to the reduction of the drag as the vortices are formed further away from the base of the cylinder and hence the base pressure increases 3 2 vortical structures around a yawed square cylinder 3 2 1 vortex pattern at kc 6 before the investigation on the vortical structures the spectrum of the lift force for the square cylinder at zero yaw angle is examined to determine the vortex shedding regime the results reproduced from lou et al 2017 are displayed in fig 6 the vortex shedding frequency f l is indicated by the most pronounced peak on the power spectrum when it is normalized by the frequency of the oscillatory motion f o the value n l f l f o is defined as the dominant frequency which corresponds to the number of vortex pair shed per half oscillating period plus 1 for example it is found that n l 1 at kc 6 from fig 6 and hence a flow regime with zero vortex pair shedding should be anticipated fig 7 10 demonstrate the phase averaged vortex contours around a square cylinder at kc 6 for different yaw angles at α 0 fig 7 the vortex pair formed at the upper and lower sides of the cylinder surface is relatively symmetric about the wake centerline this should be attributed to the effect from the cross section that the separation points of the square cylinder are fixed at the two tips of the cylinder and thus leading to the symmetric vortex shedding it is also found that there is no movement of the attached vortices along the cylinder surface these results are in agreement with those by chern et al 2007 from a numerical study on a square cylinder that one pair of symmetric vortices is formed at the leeside of the cylinder at t 4t 8 of every cycle once the flow or cylinder moving direction is changed the symmetric vortex pair disappears they also proposed that this flow mode showed up at about kc 3 10 and the symmetric flow field resulted in rather small lift forces which was found by lou et al 2017 as well overall the flow fields demonstrate an apparent periodicity from cycle to cycle and an anti symmetry between the first half and the second half of the oscillating cycle at t t 8 a positive vortex and a negative vortex are formed at upper and lower sides of the cylinder body respectively for the next two phases the vortex pair continues to grow there seems to be a vortex shedding at the end of the first half cycle t 4t 8 but the vortex pair disappears rapidly then the second half cycle starts and the same process as the first half cycle repeats only with the location swapped between the positive and negative vortices when the yaw angle is introduced fig 8 10 one can see that the flow features are similar to those at α 0 the cross section of the square cylinder becomes a rectangle when it is yawed generally the vortex pair formed at the upper and lower sides of the cylinder surface still shows a symmetry about the wake centerline the evolution of the vortices for the first half cycle is practically a mirror process of that for the second half cycle the vortex contours at α 15 and 30 seem to break into small scale structures due to the shedding at the end of the first half cycle according to fig 8 d and fig 9 d which should result from the high speed of the cylinder passing the neutral position from the former phase this phenomenon is absent for α 45 of which the longer after body makes the shear layer harder to separate this long after body effect can be significant as one can see from fig 10 a c that the positive vortex on the upper side of the cylinder is shed at first but coalescent into the shear layer at the next phase the maximum magnitude of the vortex contours shows a reduction of approximately 14 as α varies from 0 to 45 although the patterns of contours at α 45 are still organized as mentioned previously the amplitudes of the oscillating motion for α 30 and 45 are actually larger than that for α 0 to obtain the same kc according to lam and dai 2002 the vortices at larger oscillating amplitude covered a larger area and possessed a higher magnitude which should be attributed to the longer stroke of the cylinder movement and thus permits the growth of the attached vortices this probably cancels out the effect from the axial flows when the cylinder is yawed at large angles if the axial velocity component is generated as that in the steady flow lou et al 2016 on the other hand at small kc numbers the strokes of the cylinder are rather small therefore the flow acceleration and the vortex activities are not very strong and hence less influence from the movement of the water particles around the cylinder will be observed this may reduce the effect of the yaw angles on the flow field and lead to similar flow features the normalized drag c d n coefficient at a stokes number β 500 close to the present study reproduced from lou et al 2017 for kc numbers examined here are demonstrated in fig 11 for reference the ratio between the coefficient at various yaw angles and the coefficient at α 0 indicated by the subscript 0 is also included to provide a more direct evaluation on the ip the ratio should be equal to 1 for the validity of the ip however a tolerance of 5 due to the experimental uncertainty should be accounted according to fig 11 the maximum difference in drag coefficient between α 0 and 45 is found to be 1 5 at kc 6 as the hydrodynamic forces are highly associated with the flow field the anticipated similar vortex shedding process for various yaw angles has been discussed above for which the ip is found to be valid until 45 lou et al 2017 at low kc numbers the oscillating acceleration and vortex shedding are not very strong therefore less influence on the movement of the water particles from the yaw angle are expected 3 2 2 vortex patterns at kc 11 the flow regime at kc 11 is classified as the single pair of vortices shedding according to fig 6 b with the peak location at n l 2 the phase averaged vortex contours at α 0 15 and 45 are shown in figs 12 14 respectively at α 0 a pair of vortices with opposite signs is formed at either side of the cylinder from t t 8 in fig 12 b as the cylinder continues moving to the right the positive vortex at the upper side grows faster than the negative one at the lower side this asymmetric flow filed leads to the generation of the lift force lou et al 2017 from t 2t 8 to 3t 8 the positive vortex continues to stretch and wrap the negative one displaying a trend to be shed at the end of the first half cycle fig 12 e a pair of vortices is shed from the cylinder body one can also see another positive vortex starts to grow at the lower side then the negative vortex is totally reattached to the upper side as the cylinder is moving from the rightmost position to the left at t 5t 8 the pair of vortices continues to grow and eventually sheds at the end of the cycle this vortex formation and shedding process around a square cylinder was also found by kumar and gowda 2007 who concluded that the momentary reattachment of the shear layers on the respective side cut off the feeding vorticity into the respective vortices some differences can be observed in the flow features compared with those of the circular cylinder shown in fig 4 the flow pattern around a circular cylinder is characterized by a vortex street aligned in a lateral direction or at an oblique angle to the cylinder oscillating direction at this kc number in contrast this vortex shedding pattern is absent for the square cylinder kumar and gowda 2007 explained that the difference in the geometry contributes to the difference in the flow field i e a circular cylinder had more vortices shed from the upper shear layer than the lower one thus leading to the asymmetric shedding whereas a square cylinder had an equal number of vortices in both shear layers thus making the base region relatively stable as a matter of fact the shear layer swings around the circular cylinder when the cylinder oscillates resulting in the separation points move along the cylinder surface while for the square cylinder the separation points are fixed at the two tips and there is no shear layer swinging around the cylinder surface in addition the vortex streets formed along the cylinder centerline indicate that the secondary flow stream moves along the oscillating line and changes direction accordingly when the cylinder reverses lam et al 2010b this secondary flow stream effect was also mentioned by chern et al 2007 that the shed vortex was dragged to the other side of the cylinder which was also observed for the positive vortex from t 5t 8 to 6t 8 as shown in fig 12 as α increases to 15 figure not shown here it has been noticed that the contour patterns of the vortex are not as organized as those at α 0 since more small scale structures are observed but overall the flow field still shows some similarities the vortex shedding process at α 30 shown in fig 13 displays a different feature to that at α 0 two vortices rotating in different directions are formed and continue to grow when the cylinder is moving from the left to the neutral position t 2t 8 however at t 3t 8 fig 13 d the formed vortex pair is being detached from the cylinder at t 6t 8 another pair of vortices is shed in the leeward wake as the cylinder passes the neutral position compared with the flow field of α 15 some differences can also be observed at t 3t 8 where the vortical structures are more attached around the cylinder surface which should be attributed to the longer after body at α 30 than that at α 15 as α increases to 45 fig 14 the vortex contours show more differences from those at the smaller yaw angles when the cylinder starts to move from the leftmost position to the right a pair of vortices with opposite signs is just shed from the stretched shear layers from t t 8 to 3t 8 a vortex pair is formed with a positive vortex at the upper side and a negative vortex at the lower side and both vortices are well established with similar strength ω z m a x 6 7 ω z m i n 6 2 at 3t 8 a vortex pair is shed from the leeward side of the cylinder fig 14 d however the newly shed vortex pair displays an asymmetric feature that the negative vortex continues to grow and the positive one dissipates rapidly as there is only one well established negative shedding contour observed when the cylinder reaches the rightmost position t 4t 8 when the cylinder starts to move to the left the negative vortex also disappears rather fast as there is no shed vortex observed at the following phase at the end of the cycle a negative vortex is shed from the upper side of the cylinder while a positive one is about to shed but delayed by the stretched shear layer at the lower side the delayed separation of the shear layers due to the long after body at large yaw angles may be mixed with the feeding fluid or the newly formed vortices brought by the returning stroke of the cylinder on the other hand a larger amplitude is required in the oscillatory motion of the cylinder at α 45 to gain the same kc number as that at α 0 under this condition the shear layers get more flow to feed the vortices before they are detached which explains the higher drag coefficients at larger yaw angles fig 11 and thus leading to the invalidity of the ip at this kc number 3 2 3 vortex pattern at kc 19 when kc increases to 19 the flow field is characterized by the double pairs of vortices shedding which has been reflected in fig 6 c with n l 3 more complex vortex shedding regimes are expected at large kc numbers and the flow filed becomes more chaotic the phase averaged vortex contours at α 0 15 and 45 are displayed here in figs 15 17 respectively at α 0 the cylinder just reaches the leftmost position at t 0 fig 15 a when two pairs of vortices are shed at the end of the previous cycle with the positive and negative vortices at the respective side however due to the stroke of the cylinder and the secondary flow stream the two newly shed vortex pairs coalesce into one pair at the next phase when passing the neutral position fig 15 c the cylinder travels with the highest speed and the vortex pair reattaches to the cylinder from t 2t 8 to 3t 8 one negative vortex and one positive vortex have been shed alternately the negative vortex dissipates rapidly fig 15 d and the positive one is driven by the secondary flow stream from the left side to the right side of the cylinder fig 15 e at t 5t 8 two vortices with different signs are formed on either side of the cylinder and they continue to grow when the cylinder is returning to the neutral position at t 6t 8 the newly formed two vortices keep growing until the next phase and are shed at the end of the cycle fig 15 h at α 15 more small scale structures are observed in the flow field as shown in fig 16 a pair of shed vortices is observed when the cylinder reaches the leftmost position at t 0 two vortices with different signs are attached to the cylinder body and continue to gain strength when the cylinder is moving from the left to the neutral position t 2t 8 at t 3t 8 fig 16 d the vortex pair is shed from the cylinder and it tends to be convected by the secondary flow stream at an angle with respect to the oscillating line at t 4t 8 a pair of vortices on the windward is about to shed but reattaches to the cylinder body in the next phase the shedding of vortex pair takes place on the leeward when the cylinder returns to the neutral position at t 6t 8 then another primary vortex pair continues to grow until the end of the whole cycle fig 16 h it can be seen from fig 17 that generally the formation and shedding process of vortices at α 45 are more symmetric than that at α 0 unlike that at α 0 with two vortex pairs shed almost at the same time at α 45 one pair of vortices is shed earlier and driven by the secondary flow stream at an angle with respect to the oscillating line fig 17 a the movement of vortical structures in the diagonal direction makes it difficult for the vortices to reattach to the cylinder during the first half cycle a vortex pair is formed and continues to grow as the cylinder is moving to the neutral position the vortex pair is stretched and it attaches to the surface of the cylinder at t 3t 8 there seems to be a pair of vortices about to shed until the end of the first half cycle t 4t 8 one can see two pairs of vortices are shed from the cylinder body and convecting in the diagonal direction and hence the α 45 case displays a larger wake width compared with that at α 0 a wider wake leads to more blocking of the fluid which results in an increase in the drag force fig 6 the difference in the flow field features and the subsequent force coefficients between the vertical cylinder and the yawed one leads to the invalidity of the ip 3 2 4 vortex pattern at kc 25 at kc 25 the three pairs of vortex shedding regime can be observed for both α 0 and 45 as shown in figs 18 and 19 respectively correspondingly the location of the peak on the spectrum of lift force leads to a dominant frequency of n l 4 due to the larger amplitude of the oscillating motion the vortices shed from the previous stroke may be present with the returning cylinder resulting in strong vortex interaction and dislocation for α 0 the cylinder is at the leftmost position at t 0 fig 18 a and it is observed that a pair of vortices has already been shed and the positive vortex of another pair is about to detach from the cylinder surface the nearly shed positive vortex from the previous phase then coalesces to the shear layer and continues to grow by the feeding from the incoming flow at t t 8 as the cylinder is moving fast to the neutral position t 2t 8 a negative vortex is shed from the lower surface and a positive vortex starts to form on the upper surface at the end of the first half cycle one negative vortex and one positive vortex are shed alternately from the leeward side of the cylinder this vortex interaction mechanism was also found by lam et al 2010a from a circular cylinder at kc 24 i e a shed vortex attached to the shear layer from one side e g windward and another vortex was shed from the other side e g leeward of the cylinder at the next phase when the cylinder returns from the right to the left another pair of vortices starts to form and grow the present result that the vortex street lies along the cylinder motion line is similar to that of a circular cylinder at kc 24 shown by lam et al 2010a at α 45 two pairs of vortices have already been shed from the cylinder body when the cylinder is at the leftmost position fig 19 a due to the limit imaging area the full cylinder body cannot be shown at phase t 0 but there should be another pair of vortices being formed on either side of the cylinder judging from the plot at t t 8 when the cylinder moves to the neutral position t 2t 8 the vortex pair continues to grow in strength but totally attaches to the long body of the cylinder the early shed vortex pair dissipates rather rapidly as no contours observed far away from the cylinder body a pair of vortices continues to grow and they are shed alternatively at t 3t 8 fig 19 d which has also been found at α 0 at t 4t 8 the positive vortex shed from the previous phase grows significantly in shape and there is another negative vortex being shed from the cylinder the newly shed negative vortex later coalesces to the shear layer and attaches to the upper side of the cylinder due to the returning stroke from the right to the left at t 5t 8 the convection of the negative vortex results from the effect of the secondary flow stream and the induced flow by the vortices as mentioned previously the secondary flow stream can move the shear layer along the surface of a circular cylinder due to its continuous curvature lam et al 2010a for a square cylinder however the vortex has to be detached before being transported by the secondary flow stream due to the fixed separation points vortex contours at both α 0 and 45 show similar features such as the relatively equal wake width the reattachment of the shear layer due to the delayed separation as well as the significant shedding normally at the end or beginning of each half cycle one can anticipate that the hydrodynamic behaviors should be similar for these two angles at kc 25 which is consistent with the results shown in fig 6 as the ip is found to be valid at this kc for α 45 apart from the vorticity the circulation at each phase is also of interest to examine so that more information on the vortex shedding can be extracted the circulation γ is calculated by integrating the measured spanwise vorticity over an area enclosed by the contour as γ ω z d a where a is the integrating area determined by the cutoff value selected obasaju et al 1988 showed that an area covering the cylinder surface would lead to a zero circulation which resulted from the cancellation of positive and negative values hence the integration has been carried out respectively for positive and negative contours around the cylinder body in the present study tow cutoff values of 30 and 40 of the maximum ω z contour are applied and it reveals a difference of approximately 15 for the circulation values the cutoff value of 30 is selected to enclose a larger integration area first of all the results at kc 25 for α 0 and 45 within an oscillating period are shown in fig 20 the circulation has been normalized as γ γ u m n d and the oscillating motion profile is also included in the figure generally the positive and negative circulations obtain a similar absolute value at the same phase the peak value of the circulation within an oscillation period appears approximately at the phase with the maximum velocity or the zero amplitude i e t 2t 8 or t 6t 8 this should be attributed to the strong interaction between the moving cylinder and the rolling shear layer for both the vertical and yawed cylinder the variation of the normalized circulation shows a similar trend and a comparable magnitude the maximum normalized circulation γ m a x within a oscillating period for different kc numbers is investigated here as well its dependence on the cylinder yaw angle is shown in fig 21 and the results show that the yaw angle effect is negligible in addition the value of γ m a x increases with the increasing kc number which results from the longer stroke of the cylinder movement and thus permits more growth in the attached vortices 4 conclusions following a previous study on the hydrodynamics of a yawed square cylinder in oscillatory flow lou et al 2017 the vortical structures around the cylinder yawed at 0 15 30 and 45 were investigated using the piv technique the ip has been correlated to the vortex formation shedding and evolution process and the effect of the yaw angle on the flow field has been examined the main findings are summarized below 1 at kc 6 a symmetric vortex pair is observed and shows no shedding the pattern of the vortices at α 45 is still as organized as that at α 0 at this low kc number the small relative motion between the cylinder and the water particles reduces the effect of the yaw angle and results in similar flow features which leads to similar hydrodynamic behaviors for the vertical and yawed cylinders and validates the ip at small kc numbers 2 at kc 11 and 19 the corresponding single pair and double pairs of vortex shedding regimes are observed respectively the vortex shedding process is determined by the movement of the cylinder and the interaction between the vortices and the shear layers as α increases to 45 the shear layers are stretched and the vortices show attachments to the upper and lower sides of the cylinder body for most of the time within one oscillating cycle the shedding is only observed at the end of each half cycle and the vortices are found to reattach to the cylinder due to the transportation by the secondary flow stream therefore the subsequent hydrodynamic behavior displays significant differences between the yawed and the vertical cylinders which invalidates the ip for kc 11 and 19 3 when kc increases to 25 a three pairs of vortex shedding regime is observed for both α 0 and 45 the phenomenon of the shear layer attachment when the cylinder is at the neutral position as well as the vortex shedding at the end of each half cycle indicate a similar flow field feature for both angles this result implies that the ip becomes valid when the kc is sufficiently large until it is analogous to the steady flow 4 the shear layers swing along the cylinder surface and show asymmetric shedding due to the movable separation points on a circular cylinder however the shear layers are more attached and symmetric due to the fixed separation points at the tips of a square cylinder the different geometries result in significant differences in the formation and evolution of vortices and the subsequent hydrodynamic force behaviors credit author statement xiaofan lou conceptualization methodology investigation data curation writing original draft preparation writing review editing kaibing zhang data curation visualization writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to acknowledge the support from national key research and development program of china 2017yfc1404202 and 2016yfe0200100 this work is also supported by national natural science foundation of china 51909028 x lou also sincerely acknowledges the support from australian research council through arc discovery projects dp110105171 
22206,floating production storage and offloading fpso units are important to deep water engineering however the welding of some important joints of the units induces significant residual stresses which could be released under external loading with significant safety implications firstly the residual stress and its release under loading were measured by a non destructive x ray method and also simulated with the thermal elastic plastic theory then the effect of residual stress and its release on fatigue life of the welded joint was tested with a designed experimental setup and simulated with s n curve method the experimental and simulation results were found to be essentially consistent the consideration of the residual stresses in a typical welded joint significantly decreased the fatigue life hence for service safety the residual stresses should always be considered in the analysis of the fatigue life of a welded fpso structure keywords welded joint residual stress release fatigue experiment numerical simulation 1 introduction there has been a significant increase in the exploration and development of deep sea oil and gas reservoirs in recent times and this has been accompanied by increased demand for floating production storage and offloading fpso units an fpso unit is similar to an oil tanker in appearance but has a considerably more complex structure an fpso unit is generally designed for long term uninterrupted offshore production and it is impossible to conduct frequent maintenance activities on it while in service however the unit usually suffers high cycle fatigue damage due to periodic wave loading as a large welded structure fabricated from high strength steel the plastic properties and toughness index decline with increasing yield strength accompanied by increased sensitivity to the residual stress induced by the welding process luo et al 2018 wan et al 2019 generally the superposition of wave loads on the initial residual stress easily causes the structure of the fpso unit to approach the yield stress during operation resulting in significant reduction of the fatigue strength in practice the static pre load of the structure substantially exceeds the normal wave load experienced in service kim et al 1997 this means that the higher initial residual stresses are often released in the structure the effect of this release should therefore be considered when the fatigue strength of an fpso structure is estimated jiang et al jiang et al 2018 zhang et al 2018 xie et al 2017 used neutron diffraction nd measurement to study the law of residual stress of butt welded joints studied the relaxation of weld residual stress in a butt welded joint under cyclic loading by experimental and finite element method and investigated the fatigue life of a dissimilar welded joint based on continuum damage mechanics cdm with the effect of the residual stress on fatigue life kim and lotsberg 2004 conducted fatigue tests to investigate typical welded joints of an fpso produced in the same welding batch and found that their fatigue lives were highly dispersed due to the differing levels of the residual stresses sonsino 2009 experimentally investigated the effect of residual stress on the fatigue behaviour of the welded transverse stiffener of an offshore platform han et al 2004 also used test data regarding the residual stress relaxation of welded joints to develop a modified fatigue life formula li et al 2018 calculated the fatigue life of the shock absorption support of a ship with the power spectral density method and miner linear cumulative damage theory by taking the residual stress into consideration zhang et al and nguyen et al zhang and moan 2006 nguyen and wahab 1998 numerically simulated the fatigue life of some fpso joints and butt welded joints in a ship and the effect of the residual stress release on the fatigue strength was taken into consideration through experiment and numerical simulation farajian sohi et al 2010 demonstrated the effect of the welding residual stress relaxation of simple butt welded joints on the fatigue strength however there are presently limited specifications and calculation criteria for considering the effect of the residual stress evolution in fatigue strength assessment cheng 2009 polezhayeva et al 2010 furthermore the few studies that utilised both experiment and numerical simulation focused on analyses of the effects of the residual stress and its evolution on the fatigue strength of welded joints in an fpso unit the main contribution of this paper includes that a combined experiment and numerical simulation method is adopted to investigate the effects of residual stress and its evolution on the fatigue life of a t shaped welded joint in an fpso unit based on the principles of thermodynamics and cumulative fatigue damage the relationships among the residual stress external load and fatigue life of the joint were established 2 basic theory and research methods 2 1 theory of finite element method for residual stress 2 1 1 welding temperature field during a welding process heat is transferred from the arc to the welded area where it is used to melt the metal weld material the heat is subsequently dissipated by convection and radiation resulting in the cooling solidification and shrinking of the weld metal hence prediction of the residual stress and deformation caused by the welding process requires the initial determination of the temperature field at the joint the welding process is a nonlinear high temperature transient heat transfer process and accords with the law of energy conservation and the fourier theorem the governing equation of the welding process temperature is as follows xie 2006 1 ρ c t t x λ t x y λ t y z λ t z q where x y and z denote the three dimensions of the rectangular coordinates of the welding c is the specific heat capacity ρ is the density of the material t is the heat transfer time t is the temperature field distribution function λ is the thermal conductivity and q is the internal heat source intensity among these parameters λ ρ and c vary with the temperature eq 1 is a generalised equation and assessment of the welding temperature field requires both the specific boundary conditions and initial conditions 2 1 2 welding stress field the welding residual stress is generated by the plastic deformation of the material during the welding process mainly through the generation of a temperature field in the thermal elastic plastic analysis of the process the finite element method is used to simulate the welding heat and thermal strain behaviour of the welded material to determine the welding thermal stress and strain in the present study the thermal elastic plastic theory was used to analyse the stress fields by numerical simulation the constitutive relationship of the stress field is as follows xie 2006 2 d σ d d ε c d t where d σ is the stress increment d is the elastic matrix dε is the strain increment c is a vector of the material performance with respect to the temperature and dt is the temperature increment 2 2 fatigue strength analysis methods 2 2 1 hot spot stress method the hot spot stress method is widely used to calculate the fatigue strength of a typical welded joint of an fpso unit in the engineering field the first step is the calculation of the structural hot spot stress the detailed calculation of the fatigue hot spot stress is described in the guidelines for fatigue strength of ship structure china classification society 2015 the stress gradients near the welding seam is shown in fig 1 the equation for calculating the hot spot stress is as follows 3 σ h o t 1 5 σ t 2 0 5 σ 3 t 2 where σ hot is the hot spot stress namely the surface structural stress of the hot spot σ t 2 is the reference stress at t 2 where t is the weld thickness and σ 3t 2 is the reference stress at 3t 2 2 2 2 s n curve method an s n curve describes the relationship between the stress level and the fatigue life and can be expressed by the following equation 4 n s m a where a and m are fatigue test constants s is the alternating stress level and n is the number of stress cycles before failure of the component the s n curve is generally obtained experimentally although those of some materials can be obtained by statistical analysis with the exclusion of the uncertain factors s n curves can be categorised into b c d e f f2 g w and t levels which represent the most commonly used classification standard and is recommended by the british department of energy common structure rules fo 2006 when the number of cycles n is less than n q the number of cycles to the fatigue limit the relationship between n and s in eq 4 can be expressed as 5 n a s m when n is greater than n q the relationship can be expresses as 6 n c s r the values of a m c and r are determined by fatigue testing the above relationships are illustrated in fig 2 in the present study the class d s n curve was used to calculate the fatigue life as shown in fig 2 the parameters of the curve are presented in table 1 where log k 2 is the intercept of the curve on the log n axis and s q is the fatigue limit at n q 2 3 analysis method the initial residual stress of the welded joint was first examined a load was loaded and then unloaded to obtain the release of the residual stress it should be noted that the release of the residual stress caused by the welding of a joint is not affected by the number of constant amplitude cycles lotsberg 2006 li and wang 2008 finally the fatigue life of the welded joint was analysed an mts fatigue testing machine was used to perform the residual stress release and fatigue experiments numerical simulation analyses of the initial welding residual stresses and the residual stress release due to loading were also performed as well as calculation of the fatigue the results were used to determine the effects of the residual stress and its release on the fatigue strength of the welded joint fig 3 shows the flowchart of the analysis method used in this study 3 test piece and experimental setup design 3 1 relevant test piece details this study considered the toe of the bracket that connects the ribs and longitudinal bulkheads of an fpso unit as a typical node for the fatigue analysis dnv gl as 2016 fpso jip fatigue capacity 2000 the joint was represented by a simplified t shaped welded model as shown in fig 4 a the joint material was q345 steel which is commonly used in fpso units it has a yield strength σ s of 345 mpa ultimate strength σ b of 470 mpa and an elastic modulus of 2 1 105 mpa based on the test requirements the specific size of the model was shown in fig 4 b the weld size is a particularly important characteristic of welding test pieces the jtp common structure rules fo 2006 standard welding requirements were referenced for this study when the web thickness of a t weld structure fig 4 c is greater than 15 mm and exceeds the panel thickness the weld is considered as a double sided continuous weld based on the requirement of weld size in the specification the angle of fillet weld was 45 considering the errors in specimen processing the size of weld toe was 10 mm 3 2 experimental setup design the mts fatigue testing machine was used to conduct loading and unloading tests as shown in fig 5 according to the reference dnv gl as 2016 the weld toe of the test piece was the location that was most prone to fatigue damage hence a fixture was designed as shown in fig 5 a the length of the test bench was about 1050 mm the fixture was fabricated from steel and assembled with the mts fatigue testing machine as shown in fig 5 b as shown in fig 5 the test equipment consisted of a loading device a fixture and a test piece the fixture was used to fix the test piece so that it did not move during the test the loading device was used for single loading and unloading to examine the residual stress release as well as for fatigue cycle loading to examine the fatigue life of the test piece to ensure that the stress of the test piece was consistent with that in actual service point a was made to contact the loading device and subjected to compressive loading as shown in fig 5 a this resulted in the application of a tensile stress to point b weld toe an external load of 98 000 n was applied to the joint by the mts fatigue testing machine fig 5 and the residual stresses in the test piece were released under the load a stress of 0 85 σ s was recorded at the joint during the loading consistent with the actual operation condition of an fpso unit 4 analysis of welding residual stress and its release of t shaped welded joint 4 1 experiment 4 1 1 experiment equipment the x ray diffraction theory was used for the measurement of the residual stress guo et al 2010 and an x ray measurement instrument was used to measure the stresses at the different measurement points as shown in fig 6 4 1 2 arrangement of residual stress measurement points with reference to previous research common structure rules fo 2006 fpso jip fatigue capacity 2000 wu et al 2007 it was easy to reproduce the fatigue damage of a typical fpso unit welded joint caused by long term tensile stressing in fig 7 the area of the short weld a is a hot spot dnv gl as 2016 the welding residual stress in the x direction fig 7 is the stress that mainly determines the fatigue strength of the welded joint the welding residual stress in the x direction was thus the primary focus of the present study owing to the density of the set measurement points only five typical points are labelled in fig 7 measurement points 1 to 13 are along the centre line of the test piece perpendicular to the short weld seam a fig 7 measurement points 9 14 and 15 are located on a line perpendicular to the centre line measurements points 14 and 15 are also on the same side of the centre line the specific location details of all the measurement points are presented in fig 7 and tables 2 and 3 in tables 2 and 3 where d 1 is the distance between the measurement points and point b the intersection of the weld toe end and the weld centre line and d 2 is the distance between the measurement points and point c along the weld centre line 13 mm away from the weld toe end 4 1 3 results and analysis three groups of joint specimens were considered for the initial residual stress measurements before loading table 4 presents the average values of the initial residual stresses measured at each measurement points for three specimen groups the corresponding residual stresses measured under loading and subsequent unloading are presented in table 5 4 2 numerical simulation 4 2 1 simulation method the thermal elastic plastic theory was used to develop the numerical simulation program of the welding residual stresses with ansys parametric design language apdl the program was then used to conduct finite element analyses of the welding residual stresses of the t shaped welded joint before and after loading 4 2 2 thermal physical and mechanical properties of materials the dimensions of the t shaped joint are shown in fig 4 the welded joint was made from q345 steel the physical properties cheng 2007 of the material at different temperatures are presented in table 6 and fig 8 owing to the difficulty of measuring the properties at high temperatures they were determined by interpolation to simplify the finite element simulation it was assumed that the weld material was the same as the base metal with the same physical properties 4 2 3 meshing and boundary conditions in the meshing of the residual stress model the mesh near the weld was made denser with the size of 5 mm 5 mm 5 mm to increase the calculation accuracy while that away from the weld was made sparse with the size of 10 mm 5 mm 5 mm to shorten the calculation time the overall mesh is shown in fig 9 in the temperature field analysis the initial and ambient temperatures were both set to 25 c to simulate the actual weld conditions the convective heat transfer coefficient was set to 62 5 w m2 c sun and wan 2007 and the eight node hexahedral solid70 element was selected as the element type of the t shaped joint in the case of the analysis of the stress and strain fields the eight node hexahedral solid45 element was selected as the element type of the joint prescribed temperature method cho et al 2004 liu et al 2016 2017 was used in this study to efficiently simulate the temperature field the input temperature was 1500 c and the arc efficiency was 0 75 an element birth and death heat source model was used for the finite element simulation of the welding process the welding parameters were as follows welding method carbon dioxide arc welding welding current 120 200a welding voltage 28v and the welding speed 10 cm min respectively it was necessary to ensure that the model did not undergo rigid displacement during the welding meanwhile care was also taken to avoid hampering the welding deformation and stress release the imposed boundary conditions were as follows 1 boundary conditions of initial residual stress simulation for the initial residual stress simulation the boundary conditions at node a and one end of the panel were set to u x u y u z 0 and that node b to u z 0 at the other end of the panel those at nodes c and d were both set to u z 0 the boundary conditions at the web located far from the weld toe were set to u x u y u z 0 as indicated in fig 9 a 2 boundary conditions of residual stress simulation after loading and unloading the application of the external load of 98 000 n to the test specimen was described above the boundary conditions applied to the simulation model were based on the actual form of the loading in the test fig 5 the two ends of the test piece were supported by circular tubes and the boundary conditions at these ends were thus set to u x u y u z 0 the applied load and boundary conditions are illustrated in fig 9 b 4 2 4 finite element simulation results and comparison with test results an indirect method was employed for the finite element simulation of the welding process the initial residual stress and the residual stress after 98 000 n loading and unloading were determined the results were compared with those of the physical tests as shown in figs 10 and 11 here σ x is the residual stress in the x direction fig 7 figs 10 and 11 show that the finite element analysis results are in good agreement with the test results confirming the effectiveness of the proposed method for numerical simulation of the welding residual stress the following conclusions can be drawn from table 4 and fig 10 1 the welding residual stresses are mainly tensile stresses in the vertical direction of the weld and decrease with increasing distance d 1 from the toe end of the weld the residual stress varies significantly near the weld area with the maximum value of 325 7 mpa occurring near the weld toe of the short weld a the maximum stress is close to the yield stress of the material the residual stress distribution is also relatively flat far away from weld area approaching 60 mpa at approximately 25 mm from the weld 2 after the loading and unloading of the external load the residual tensile stresses are reduced to a level below the initial values the release of the residual stress increases with increasing closeness to the weld toe area the maximum reduction of the residual stress is 268 7 mpa which represents a stress release rate of 82 5 the following conclusions can be drawn from table 5 and fig 11 1 the weld direction residual stresses are tensile stresses in the vicinity of the weld centre line the residual stresses decrease to 0 at a distance of approximately 22 mm from the weld and are then transformed into gradually increasing compressive stresses after the loading and unloading of the external load there is a reduction of the residual tensile stresses with greater reduction occurring near the weld the maximum residual tensile stress release after unloading is 90 2 mpa which represents a maximum release rate of 56 3 2 there is no change in the distribution of the residual compressive stress away from the weld area although the stress decreases with increasing distance 5 effect of residual stress on fatigue life of t shaped welded joint 5 1 experimental investigation the test piece used for this aspect of the study was the same as that used to measure the residual stress a constant amplitude cyclic external load was applied to the t shaped joint using the mts fatigue testing machine fig 5 with minimum and maximum loads are 0 and 98 000 n respectively the loading frequency is 0 1hz fig 5 illustrates the application of the load which was continued until failure of the joint as shown in fig 12 it can be observed from the figure that the t shaped welded joint was damaged at the weld toe the average fatigue life was 2 9 105 cycles as indicated in table 7 5 2 calculation and analysis of fatigue life 5 2 1 numerical simulation of hot spot stress 5 2 1 1 meshing and boundary conditions based on the dimensions of the t shaped joint shown in fig 4 a finite element model of the joint was established using msc patran the model material was the same as that of the model used for the residual stress analysis the hot spot method mentioned earlier was used for the meshing and the size of the mesh near the weld toe is 5 mm 5 mm 5 mm the overall mesh is shown in fig 13 a 98 000 n constant amplitude cyclic load was applied to the joint as shown in fig 13 b based on the physical test the boundary conditions at the support of the joint model were set to free rotation but complete displacement constraint u x u y u z 0 as shown in fig 13 a the structural stress in the model under the external load of 98 000 n without consideration of the residual stress was calculated the distribution of the stress induced by the external load in the x direction fig 7 is shown in fig 14 it can be seen from fig 14 that the maximum x direction stress of 251 mpa 0 72σ s occurs around the short weld toe in consistency with the observations in dnv gl as 2016 and confirming the susceptibility of the area to fatigue damage 5 2 1 2 analysis of hot spot stress 5 2 1 2 1 without considering residual stress the stress generated by the application of the 98 000 n compression load to the welded structure was analysed without consideration of the residual stress the x direction stress at t 2 from the weld toe was determined to be 212 mpa while that at 3t 2 from the weld toe was determined to be 170 mpa the stress distribution is summarised in table 8 based on the hot spot stress method described earlier indicated in eq 3 the x direction hot spot stress at the weld toe was determined to be 233 mpa 5 2 1 2 2 considering residual stress with consideration of the welding residual stresses that were analysed earlier the same compression load in section 5 2 1 2 1 above was applied to the welded structure in this case the x direction stresses at t 2 and 3t 2 from the weld toe were determined to be 311 and 249 mpa respectively the stress distribution is summarised in table 9 as indicated in eq 3 the x direction hot spot stress at the weld toe was determined to be 342 mpa after removal of the load the x direction residual stress at the weld toe was 46 mpa 5 2 2 fatigue cyclic loading 5 2 2 1 without considering residual stress the maximum and minimum x direction fatigue cyclic stresses at the weld toe were determined to be σ max 233 mpa and σ min 0 mpa respectively as shown in fig 15 5 2 2 2 considering residual stress under cyclic loading the maximum and minimum x direction fatigue cyclic stresses at the weld toe with consideration of the welding residual stress were determined to be σ max 342 mpa and σ min 46 mpa respectively as shown in fig 15 the σ min was determined by the residual stress after release under the effect of external loading as shown in fig 15 the cyclic stress amplitude δs increases from 233 mpa to 296 mpa and the mean stress with consideration of the residual stress is higher than that without consideration of the residual stress the residual stress is thus important to analysis of the fatigue life 5 2 3 calculation of fatigue life the s n curve method was used to calculate the fatigue life of the welded joint the level d s n curve was particularly employed 5 2 3 1 without considering residual stress the fatigue life of the weld toe was determined to be 5 48 105 cycles this agrees well with the experimental measurement using the physical model which was also destroyed at the same location as shown in fig 12 5 2 3 2 considering residual stress based on the hot spot stress and fatigue cyclic loading that were obtained considering the residual stress the fatigue life of the welded joint was determined to be 2 2 105 cycles with the failure occurring at the same location as observed without considering the residual stress 5 3 comparison of experimentally and numerically determined fatigue lives table 10 summarises the average fatigue life measurements of the typical welded joint investigated in the present study the relative error between the numerically determined value without considering the residual stress and the experimental result is 89 0 while that between the numerically determined value considering the residual stress and the experimental result is 24 1 further a comparison of the numerical results with and without considering the residual stresses reveals that the former is 59 8 lower the reduction of fatigue life is caused by the increase of stress amplitude when the residual stresses were considered it is thus evident that the residual stress significantly impacts the fatigue life of a welded joint and should be taken into account in the fatigue life analysis of a welded component 6 conclusions in this paper the welding residual stress release and fatigue life of a t shaped welded joint in an fpso unit were investigated by physical test and numerical simulation an experimental setup was designed to simulate the actual operational conditions of fpso the initial residual stress and its release were measured by x ray measurement instrument and simulated with thermal elastic plastic theory the experimental results were in agreement with the numerical simulation results through comparative analysis the fatigue life of the t shaped welded joint was tested by the designed experimental setup and calculated with s n curve method under two conditions of considering residual stress and without considering residual stress the calculated fatigue life with the residual stress taken into account was close to the experimental results based on the result analysis the following conclusions are given as follows 1 the experimental setup designed could be more efficient to simulate the effect of residual stress and its release on the fatigue life of fpso in service 2 external loading significantly altered the residual stresses with the application and removal of a load resulting in partial release of the residual stresses the stress release increased with increasing closeness to the weld toe 3 considering the welding residual stresses increased the cyclic stress amplitude of the t shaped welded joint resulting in a shorter fatigue life compared to without considering the residual stress 4 under the condition of considering the release of residual stress the rationality of structural fatigue assessment was increased which could effectively improve the safety and reliability of the structure therefore when an analysis of the fatigue life of a welded fpso structure is conducted the residual stress should be taken into account author contributions liangbi li qianqian jia and peng qian carried out and revised most of the work presented here zhengquan wan and yiwen zhang designed the experiment for this paper and jichun li contributed to the summarizing proposed ideas of section 1 declaration of competing interest the authors declare no conflicts of interest acknowledgments this work was supported by the national key research and development plan of china grant no 2017yfc0305501 the national natural science foundation of china grant no 51479084 and the 2016 youth academic leaders project of the qing lan project in jiangsu universities 
22206,floating production storage and offloading fpso units are important to deep water engineering however the welding of some important joints of the units induces significant residual stresses which could be released under external loading with significant safety implications firstly the residual stress and its release under loading were measured by a non destructive x ray method and also simulated with the thermal elastic plastic theory then the effect of residual stress and its release on fatigue life of the welded joint was tested with a designed experimental setup and simulated with s n curve method the experimental and simulation results were found to be essentially consistent the consideration of the residual stresses in a typical welded joint significantly decreased the fatigue life hence for service safety the residual stresses should always be considered in the analysis of the fatigue life of a welded fpso structure keywords welded joint residual stress release fatigue experiment numerical simulation 1 introduction there has been a significant increase in the exploration and development of deep sea oil and gas reservoirs in recent times and this has been accompanied by increased demand for floating production storage and offloading fpso units an fpso unit is similar to an oil tanker in appearance but has a considerably more complex structure an fpso unit is generally designed for long term uninterrupted offshore production and it is impossible to conduct frequent maintenance activities on it while in service however the unit usually suffers high cycle fatigue damage due to periodic wave loading as a large welded structure fabricated from high strength steel the plastic properties and toughness index decline with increasing yield strength accompanied by increased sensitivity to the residual stress induced by the welding process luo et al 2018 wan et al 2019 generally the superposition of wave loads on the initial residual stress easily causes the structure of the fpso unit to approach the yield stress during operation resulting in significant reduction of the fatigue strength in practice the static pre load of the structure substantially exceeds the normal wave load experienced in service kim et al 1997 this means that the higher initial residual stresses are often released in the structure the effect of this release should therefore be considered when the fatigue strength of an fpso structure is estimated jiang et al jiang et al 2018 zhang et al 2018 xie et al 2017 used neutron diffraction nd measurement to study the law of residual stress of butt welded joints studied the relaxation of weld residual stress in a butt welded joint under cyclic loading by experimental and finite element method and investigated the fatigue life of a dissimilar welded joint based on continuum damage mechanics cdm with the effect of the residual stress on fatigue life kim and lotsberg 2004 conducted fatigue tests to investigate typical welded joints of an fpso produced in the same welding batch and found that their fatigue lives were highly dispersed due to the differing levels of the residual stresses sonsino 2009 experimentally investigated the effect of residual stress on the fatigue behaviour of the welded transverse stiffener of an offshore platform han et al 2004 also used test data regarding the residual stress relaxation of welded joints to develop a modified fatigue life formula li et al 2018 calculated the fatigue life of the shock absorption support of a ship with the power spectral density method and miner linear cumulative damage theory by taking the residual stress into consideration zhang et al and nguyen et al zhang and moan 2006 nguyen and wahab 1998 numerically simulated the fatigue life of some fpso joints and butt welded joints in a ship and the effect of the residual stress release on the fatigue strength was taken into consideration through experiment and numerical simulation farajian sohi et al 2010 demonstrated the effect of the welding residual stress relaxation of simple butt welded joints on the fatigue strength however there are presently limited specifications and calculation criteria for considering the effect of the residual stress evolution in fatigue strength assessment cheng 2009 polezhayeva et al 2010 furthermore the few studies that utilised both experiment and numerical simulation focused on analyses of the effects of the residual stress and its evolution on the fatigue strength of welded joints in an fpso unit the main contribution of this paper includes that a combined experiment and numerical simulation method is adopted to investigate the effects of residual stress and its evolution on the fatigue life of a t shaped welded joint in an fpso unit based on the principles of thermodynamics and cumulative fatigue damage the relationships among the residual stress external load and fatigue life of the joint were established 2 basic theory and research methods 2 1 theory of finite element method for residual stress 2 1 1 welding temperature field during a welding process heat is transferred from the arc to the welded area where it is used to melt the metal weld material the heat is subsequently dissipated by convection and radiation resulting in the cooling solidification and shrinking of the weld metal hence prediction of the residual stress and deformation caused by the welding process requires the initial determination of the temperature field at the joint the welding process is a nonlinear high temperature transient heat transfer process and accords with the law of energy conservation and the fourier theorem the governing equation of the welding process temperature is as follows xie 2006 1 ρ c t t x λ t x y λ t y z λ t z q where x y and z denote the three dimensions of the rectangular coordinates of the welding c is the specific heat capacity ρ is the density of the material t is the heat transfer time t is the temperature field distribution function λ is the thermal conductivity and q is the internal heat source intensity among these parameters λ ρ and c vary with the temperature eq 1 is a generalised equation and assessment of the welding temperature field requires both the specific boundary conditions and initial conditions 2 1 2 welding stress field the welding residual stress is generated by the plastic deformation of the material during the welding process mainly through the generation of a temperature field in the thermal elastic plastic analysis of the process the finite element method is used to simulate the welding heat and thermal strain behaviour of the welded material to determine the welding thermal stress and strain in the present study the thermal elastic plastic theory was used to analyse the stress fields by numerical simulation the constitutive relationship of the stress field is as follows xie 2006 2 d σ d d ε c d t where d σ is the stress increment d is the elastic matrix dε is the strain increment c is a vector of the material performance with respect to the temperature and dt is the temperature increment 2 2 fatigue strength analysis methods 2 2 1 hot spot stress method the hot spot stress method is widely used to calculate the fatigue strength of a typical welded joint of an fpso unit in the engineering field the first step is the calculation of the structural hot spot stress the detailed calculation of the fatigue hot spot stress is described in the guidelines for fatigue strength of ship structure china classification society 2015 the stress gradients near the welding seam is shown in fig 1 the equation for calculating the hot spot stress is as follows 3 σ h o t 1 5 σ t 2 0 5 σ 3 t 2 where σ hot is the hot spot stress namely the surface structural stress of the hot spot σ t 2 is the reference stress at t 2 where t is the weld thickness and σ 3t 2 is the reference stress at 3t 2 2 2 2 s n curve method an s n curve describes the relationship between the stress level and the fatigue life and can be expressed by the following equation 4 n s m a where a and m are fatigue test constants s is the alternating stress level and n is the number of stress cycles before failure of the component the s n curve is generally obtained experimentally although those of some materials can be obtained by statistical analysis with the exclusion of the uncertain factors s n curves can be categorised into b c d e f f2 g w and t levels which represent the most commonly used classification standard and is recommended by the british department of energy common structure rules fo 2006 when the number of cycles n is less than n q the number of cycles to the fatigue limit the relationship between n and s in eq 4 can be expressed as 5 n a s m when n is greater than n q the relationship can be expresses as 6 n c s r the values of a m c and r are determined by fatigue testing the above relationships are illustrated in fig 2 in the present study the class d s n curve was used to calculate the fatigue life as shown in fig 2 the parameters of the curve are presented in table 1 where log k 2 is the intercept of the curve on the log n axis and s q is the fatigue limit at n q 2 3 analysis method the initial residual stress of the welded joint was first examined a load was loaded and then unloaded to obtain the release of the residual stress it should be noted that the release of the residual stress caused by the welding of a joint is not affected by the number of constant amplitude cycles lotsberg 2006 li and wang 2008 finally the fatigue life of the welded joint was analysed an mts fatigue testing machine was used to perform the residual stress release and fatigue experiments numerical simulation analyses of the initial welding residual stresses and the residual stress release due to loading were also performed as well as calculation of the fatigue the results were used to determine the effects of the residual stress and its release on the fatigue strength of the welded joint fig 3 shows the flowchart of the analysis method used in this study 3 test piece and experimental setup design 3 1 relevant test piece details this study considered the toe of the bracket that connects the ribs and longitudinal bulkheads of an fpso unit as a typical node for the fatigue analysis dnv gl as 2016 fpso jip fatigue capacity 2000 the joint was represented by a simplified t shaped welded model as shown in fig 4 a the joint material was q345 steel which is commonly used in fpso units it has a yield strength σ s of 345 mpa ultimate strength σ b of 470 mpa and an elastic modulus of 2 1 105 mpa based on the test requirements the specific size of the model was shown in fig 4 b the weld size is a particularly important characteristic of welding test pieces the jtp common structure rules fo 2006 standard welding requirements were referenced for this study when the web thickness of a t weld structure fig 4 c is greater than 15 mm and exceeds the panel thickness the weld is considered as a double sided continuous weld based on the requirement of weld size in the specification the angle of fillet weld was 45 considering the errors in specimen processing the size of weld toe was 10 mm 3 2 experimental setup design the mts fatigue testing machine was used to conduct loading and unloading tests as shown in fig 5 according to the reference dnv gl as 2016 the weld toe of the test piece was the location that was most prone to fatigue damage hence a fixture was designed as shown in fig 5 a the length of the test bench was about 1050 mm the fixture was fabricated from steel and assembled with the mts fatigue testing machine as shown in fig 5 b as shown in fig 5 the test equipment consisted of a loading device a fixture and a test piece the fixture was used to fix the test piece so that it did not move during the test the loading device was used for single loading and unloading to examine the residual stress release as well as for fatigue cycle loading to examine the fatigue life of the test piece to ensure that the stress of the test piece was consistent with that in actual service point a was made to contact the loading device and subjected to compressive loading as shown in fig 5 a this resulted in the application of a tensile stress to point b weld toe an external load of 98 000 n was applied to the joint by the mts fatigue testing machine fig 5 and the residual stresses in the test piece were released under the load a stress of 0 85 σ s was recorded at the joint during the loading consistent with the actual operation condition of an fpso unit 4 analysis of welding residual stress and its release of t shaped welded joint 4 1 experiment 4 1 1 experiment equipment the x ray diffraction theory was used for the measurement of the residual stress guo et al 2010 and an x ray measurement instrument was used to measure the stresses at the different measurement points as shown in fig 6 4 1 2 arrangement of residual stress measurement points with reference to previous research common structure rules fo 2006 fpso jip fatigue capacity 2000 wu et al 2007 it was easy to reproduce the fatigue damage of a typical fpso unit welded joint caused by long term tensile stressing in fig 7 the area of the short weld a is a hot spot dnv gl as 2016 the welding residual stress in the x direction fig 7 is the stress that mainly determines the fatigue strength of the welded joint the welding residual stress in the x direction was thus the primary focus of the present study owing to the density of the set measurement points only five typical points are labelled in fig 7 measurement points 1 to 13 are along the centre line of the test piece perpendicular to the short weld seam a fig 7 measurement points 9 14 and 15 are located on a line perpendicular to the centre line measurements points 14 and 15 are also on the same side of the centre line the specific location details of all the measurement points are presented in fig 7 and tables 2 and 3 in tables 2 and 3 where d 1 is the distance between the measurement points and point b the intersection of the weld toe end and the weld centre line and d 2 is the distance between the measurement points and point c along the weld centre line 13 mm away from the weld toe end 4 1 3 results and analysis three groups of joint specimens were considered for the initial residual stress measurements before loading table 4 presents the average values of the initial residual stresses measured at each measurement points for three specimen groups the corresponding residual stresses measured under loading and subsequent unloading are presented in table 5 4 2 numerical simulation 4 2 1 simulation method the thermal elastic plastic theory was used to develop the numerical simulation program of the welding residual stresses with ansys parametric design language apdl the program was then used to conduct finite element analyses of the welding residual stresses of the t shaped welded joint before and after loading 4 2 2 thermal physical and mechanical properties of materials the dimensions of the t shaped joint are shown in fig 4 the welded joint was made from q345 steel the physical properties cheng 2007 of the material at different temperatures are presented in table 6 and fig 8 owing to the difficulty of measuring the properties at high temperatures they were determined by interpolation to simplify the finite element simulation it was assumed that the weld material was the same as the base metal with the same physical properties 4 2 3 meshing and boundary conditions in the meshing of the residual stress model the mesh near the weld was made denser with the size of 5 mm 5 mm 5 mm to increase the calculation accuracy while that away from the weld was made sparse with the size of 10 mm 5 mm 5 mm to shorten the calculation time the overall mesh is shown in fig 9 in the temperature field analysis the initial and ambient temperatures were both set to 25 c to simulate the actual weld conditions the convective heat transfer coefficient was set to 62 5 w m2 c sun and wan 2007 and the eight node hexahedral solid70 element was selected as the element type of the t shaped joint in the case of the analysis of the stress and strain fields the eight node hexahedral solid45 element was selected as the element type of the joint prescribed temperature method cho et al 2004 liu et al 2016 2017 was used in this study to efficiently simulate the temperature field the input temperature was 1500 c and the arc efficiency was 0 75 an element birth and death heat source model was used for the finite element simulation of the welding process the welding parameters were as follows welding method carbon dioxide arc welding welding current 120 200a welding voltage 28v and the welding speed 10 cm min respectively it was necessary to ensure that the model did not undergo rigid displacement during the welding meanwhile care was also taken to avoid hampering the welding deformation and stress release the imposed boundary conditions were as follows 1 boundary conditions of initial residual stress simulation for the initial residual stress simulation the boundary conditions at node a and one end of the panel were set to u x u y u z 0 and that node b to u z 0 at the other end of the panel those at nodes c and d were both set to u z 0 the boundary conditions at the web located far from the weld toe were set to u x u y u z 0 as indicated in fig 9 a 2 boundary conditions of residual stress simulation after loading and unloading the application of the external load of 98 000 n to the test specimen was described above the boundary conditions applied to the simulation model were based on the actual form of the loading in the test fig 5 the two ends of the test piece were supported by circular tubes and the boundary conditions at these ends were thus set to u x u y u z 0 the applied load and boundary conditions are illustrated in fig 9 b 4 2 4 finite element simulation results and comparison with test results an indirect method was employed for the finite element simulation of the welding process the initial residual stress and the residual stress after 98 000 n loading and unloading were determined the results were compared with those of the physical tests as shown in figs 10 and 11 here σ x is the residual stress in the x direction fig 7 figs 10 and 11 show that the finite element analysis results are in good agreement with the test results confirming the effectiveness of the proposed method for numerical simulation of the welding residual stress the following conclusions can be drawn from table 4 and fig 10 1 the welding residual stresses are mainly tensile stresses in the vertical direction of the weld and decrease with increasing distance d 1 from the toe end of the weld the residual stress varies significantly near the weld area with the maximum value of 325 7 mpa occurring near the weld toe of the short weld a the maximum stress is close to the yield stress of the material the residual stress distribution is also relatively flat far away from weld area approaching 60 mpa at approximately 25 mm from the weld 2 after the loading and unloading of the external load the residual tensile stresses are reduced to a level below the initial values the release of the residual stress increases with increasing closeness to the weld toe area the maximum reduction of the residual stress is 268 7 mpa which represents a stress release rate of 82 5 the following conclusions can be drawn from table 5 and fig 11 1 the weld direction residual stresses are tensile stresses in the vicinity of the weld centre line the residual stresses decrease to 0 at a distance of approximately 22 mm from the weld and are then transformed into gradually increasing compressive stresses after the loading and unloading of the external load there is a reduction of the residual tensile stresses with greater reduction occurring near the weld the maximum residual tensile stress release after unloading is 90 2 mpa which represents a maximum release rate of 56 3 2 there is no change in the distribution of the residual compressive stress away from the weld area although the stress decreases with increasing distance 5 effect of residual stress on fatigue life of t shaped welded joint 5 1 experimental investigation the test piece used for this aspect of the study was the same as that used to measure the residual stress a constant amplitude cyclic external load was applied to the t shaped joint using the mts fatigue testing machine fig 5 with minimum and maximum loads are 0 and 98 000 n respectively the loading frequency is 0 1hz fig 5 illustrates the application of the load which was continued until failure of the joint as shown in fig 12 it can be observed from the figure that the t shaped welded joint was damaged at the weld toe the average fatigue life was 2 9 105 cycles as indicated in table 7 5 2 calculation and analysis of fatigue life 5 2 1 numerical simulation of hot spot stress 5 2 1 1 meshing and boundary conditions based on the dimensions of the t shaped joint shown in fig 4 a finite element model of the joint was established using msc patran the model material was the same as that of the model used for the residual stress analysis the hot spot method mentioned earlier was used for the meshing and the size of the mesh near the weld toe is 5 mm 5 mm 5 mm the overall mesh is shown in fig 13 a 98 000 n constant amplitude cyclic load was applied to the joint as shown in fig 13 b based on the physical test the boundary conditions at the support of the joint model were set to free rotation but complete displacement constraint u x u y u z 0 as shown in fig 13 a the structural stress in the model under the external load of 98 000 n without consideration of the residual stress was calculated the distribution of the stress induced by the external load in the x direction fig 7 is shown in fig 14 it can be seen from fig 14 that the maximum x direction stress of 251 mpa 0 72σ s occurs around the short weld toe in consistency with the observations in dnv gl as 2016 and confirming the susceptibility of the area to fatigue damage 5 2 1 2 analysis of hot spot stress 5 2 1 2 1 without considering residual stress the stress generated by the application of the 98 000 n compression load to the welded structure was analysed without consideration of the residual stress the x direction stress at t 2 from the weld toe was determined to be 212 mpa while that at 3t 2 from the weld toe was determined to be 170 mpa the stress distribution is summarised in table 8 based on the hot spot stress method described earlier indicated in eq 3 the x direction hot spot stress at the weld toe was determined to be 233 mpa 5 2 1 2 2 considering residual stress with consideration of the welding residual stresses that were analysed earlier the same compression load in section 5 2 1 2 1 above was applied to the welded structure in this case the x direction stresses at t 2 and 3t 2 from the weld toe were determined to be 311 and 249 mpa respectively the stress distribution is summarised in table 9 as indicated in eq 3 the x direction hot spot stress at the weld toe was determined to be 342 mpa after removal of the load the x direction residual stress at the weld toe was 46 mpa 5 2 2 fatigue cyclic loading 5 2 2 1 without considering residual stress the maximum and minimum x direction fatigue cyclic stresses at the weld toe were determined to be σ max 233 mpa and σ min 0 mpa respectively as shown in fig 15 5 2 2 2 considering residual stress under cyclic loading the maximum and minimum x direction fatigue cyclic stresses at the weld toe with consideration of the welding residual stress were determined to be σ max 342 mpa and σ min 46 mpa respectively as shown in fig 15 the σ min was determined by the residual stress after release under the effect of external loading as shown in fig 15 the cyclic stress amplitude δs increases from 233 mpa to 296 mpa and the mean stress with consideration of the residual stress is higher than that without consideration of the residual stress the residual stress is thus important to analysis of the fatigue life 5 2 3 calculation of fatigue life the s n curve method was used to calculate the fatigue life of the welded joint the level d s n curve was particularly employed 5 2 3 1 without considering residual stress the fatigue life of the weld toe was determined to be 5 48 105 cycles this agrees well with the experimental measurement using the physical model which was also destroyed at the same location as shown in fig 12 5 2 3 2 considering residual stress based on the hot spot stress and fatigue cyclic loading that were obtained considering the residual stress the fatigue life of the welded joint was determined to be 2 2 105 cycles with the failure occurring at the same location as observed without considering the residual stress 5 3 comparison of experimentally and numerically determined fatigue lives table 10 summarises the average fatigue life measurements of the typical welded joint investigated in the present study the relative error between the numerically determined value without considering the residual stress and the experimental result is 89 0 while that between the numerically determined value considering the residual stress and the experimental result is 24 1 further a comparison of the numerical results with and without considering the residual stresses reveals that the former is 59 8 lower the reduction of fatigue life is caused by the increase of stress amplitude when the residual stresses were considered it is thus evident that the residual stress significantly impacts the fatigue life of a welded joint and should be taken into account in the fatigue life analysis of a welded component 6 conclusions in this paper the welding residual stress release and fatigue life of a t shaped welded joint in an fpso unit were investigated by physical test and numerical simulation an experimental setup was designed to simulate the actual operational conditions of fpso the initial residual stress and its release were measured by x ray measurement instrument and simulated with thermal elastic plastic theory the experimental results were in agreement with the numerical simulation results through comparative analysis the fatigue life of the t shaped welded joint was tested by the designed experimental setup and calculated with s n curve method under two conditions of considering residual stress and without considering residual stress the calculated fatigue life with the residual stress taken into account was close to the experimental results based on the result analysis the following conclusions are given as follows 1 the experimental setup designed could be more efficient to simulate the effect of residual stress and its release on the fatigue life of fpso in service 2 external loading significantly altered the residual stresses with the application and removal of a load resulting in partial release of the residual stresses the stress release increased with increasing closeness to the weld toe 3 considering the welding residual stresses increased the cyclic stress amplitude of the t shaped welded joint resulting in a shorter fatigue life compared to without considering the residual stress 4 under the condition of considering the release of residual stress the rationality of structural fatigue assessment was increased which could effectively improve the safety and reliability of the structure therefore when an analysis of the fatigue life of a welded fpso structure is conducted the residual stress should be taken into account author contributions liangbi li qianqian jia and peng qian carried out and revised most of the work presented here zhengquan wan and yiwen zhang designed the experiment for this paper and jichun li contributed to the summarizing proposed ideas of section 1 declaration of competing interest the authors declare no conflicts of interest acknowledgments this work was supported by the national key research and development plan of china grant no 2017yfc0305501 the national natural science foundation of china grant no 51479084 and the 2016 youth academic leaders project of the qing lan project in jiangsu universities 
22207,balancing the trade off between the simulation detail and the computational efficiency in a hydrodynamic numerical model is generally difficult e g one can hardly find a single set of governing equations that is capable of efficiently describing the wave propagation processes from offshore to nearshore and accurately presenting the details of wave breaking and interacting with coastal structures simultaneously to address this predicament open boundary coupling schemes are proposed in this paper to hybridize a swe shallow water equations based sph smoothed particle hydrodynamics model with a ns navier stokes equations based sph model the ns sph model is used to present the nonlinear hydrodynamic features in the main study domains while the remaining domains are simulated with the swe sph model which calculates much faster than the ns sph model the hybrid sph models are applied to simulate solitary wave propagation steady flows over a bump dam breaking waves and standing waves the hybridization performance on the information transmitting mass and energy conservation simulation detail computational accuracy computational efficiency and computational convergence speed is fully validated and evaluated the results indicate that the proposed open boundary coupling schemes are capable of improving the computational efficiency on the premise of computational accuracy and simulation detail keywords smoothed particle hydrodynamics hybrid model open boundary condition shallow water equation navier stokes equation 1 introduction the sph smoothed particle hydrodynamics method gingold and monaghan 1977 liu and liu 2003 monaghan 1994 is a promising meshfree lagrangian numerical method that shows advantages over conventional euler mesh based methods on the aspects of moving boundaries free surfaces and multiphase interface capture and particle tracking during the most recent decade the sph method has been widely applied to simulate highly nonlinear hydrodynamic problems gotoh and khayyer 2018 violeau and rogers 2016 zhang et al 2017 with complex water surfaces and fluid structure interactions e g hydraulic jumps federico et al 2012 tidal bores ni et al 2018a b nearshore wave shoaling li et al 2012 wave runup and breaking on beaches dalrymple and rogers 2006 lo and shao 2002 and waves interacting against coastal facilities altomare et al 2017 ni and feng 2014 liu et al 2014 great efforts have been made on the theoretical study of sph method including numerical stability antuono et al 2010 marrone et al 2011 conservation and error analysis gotoh et al 2014 gui et al 2015 khayyer et al 2017a khayyer et al 2017b wang et al 2019 sun et al 2019 violeau and fonty 2019 solid boundary conditions ferrand et al 2013 fourtakas et al 2019 open boundary conditions ni et al 2018a b wang et al 2019 etc nevertheless one of the drawbacks of the sph method is its low computational efficiency and the main solutions at present include high performance computing hpc domínguez et al 2013 rustico et al 2014 particle refinement techniques barcarolo et al 2014 vacondio et al 2013 and hybridization techniques which are discussed in this paper hybrid sph models can be divided into two categories according to the purpose of hybridization one category of hybrid sph models uses various numerical models to describe the corresponding movements of various subjects in the same system e g using an sph model to simulate the nonlinear water movements inside a tank while using an fem finite element method model to simulate the interaction between an elastic plate and the sloshing water yang et al 2012 khayyer et al 2018 another example altomare et al 2014a b is using an sph model to simulate nearshore water waves while using a dem discrete element method model to simulate the armor blocks on sea breakwaters and studying the wave runup features however the aforementioned hybrid sph models will not be discussed here the second category of hybrid sph models which are the study topic in this paper aim to improve the computational efficiency on the premise of computational accuracy and simulation detail by using sph models to present the nonlinear hydrodynamic features in the main study domains while using conventional mesh based methods or simplified models to simulate the rest of the system this category of hybrid sph models can be further divided into two types a layer coupling model lcm and a section coupling model scm navier stokes ns equations are generally adopted as the governing equations by the submodels of lcms which are arranged up and down as shown in fig 1 a the upper submodel uses the sph method to discretize the governing equations to capture the nonlinear water surfaces while the lower submodel uses conventional euler meshes to improve computational efficiency the two way coupling scheme also known as the strong coupling scheme is applied to connect the two submodels since the evolution of the free surface is not involved with the coupling boundaries the two way coupling schemes for lcm are relatively easy to handle for example marrone et al 2016 proposed a hybrid model that connected a wcsph weakly compressible sph model and an fvm finite volume method model while the hybridization of an isph incompressible sph model and an fvm model was implemented by napoli et al 2016 section coupling models are more common in the applications of hybrid numerical wave flumes which use ns equations based sph submodels to simulate the nearshore wave evolutions and the detailed wave structure interactions e g wave breaking and overtopping while mesh based numerical methods are used to solve nonlinear swes shallow water equations or boussinesq equations and to describe the wave propagations from offshore to nearshore according to the coupling schemes that connect the submodels scms generally include wave paddle coupling overlapping zone coupling and open boundary coupling wave paddle coupling fig 1 b is the most widely used scheme early in 2010 narayanaswamy et al 2010 hybridized the boussinesq equation based funwave model kirby et al 1998 with the sphysics model gomez gesteira et al 2012 using a two way solid wave paddle and validated the hybrid sph model with a solitary wave propagation case later altomare et al 2014a b 2015 implemented a one way hybridization between the swash model zijlema et al 2011 and the dualsphysics model crespo et al 2015 deformable wave paddles were adopted to adjust to the velocity distributions in various water depths similarly verbrugghe et al 2018 used deformable wave paddles to connect the openwave3d model engsig karup et al 2009 and the dualsphysics model and it was a two way hybridization different from wave paddle coupling which transports water surface fluctuation with moving boundaries overlapping zone coupling fourtakas et al 2017 sriram et al 2014 transports the velocities and pressures through the submodels by overlapping zones as shown in fig 1 c the overlapping zones transform with the movement of the water body and there are no particle creations or particle deletions among the submodels as the mass transportation phenomenon will be induced by the nonlinear nearshore waves in the propagation directions the aforementioned coupling boundaries including wave paddles and overlapping zones will gradually deviate from the initial positions with the simulation progress moreover deformable coupling boundaries e g deformable wave paddles and deformable overlapping zones will suffer from the growing larger transformations caused by the velocity difference between the upper water and the lower water these transformations will be strengthened by the nonlinear mass transportation effect leading to eventual coupling failure additionally the two aforementioned coupling schemes do not suit the flow conditions because the schemes limit particle creation and particle deletion operations by contrast open boundary coupling bears no such problems the positions of the open boundaries remain steady during the simulation similar to conventional mesh based models introducing a euler perspective into the lagrangian system few scms have been reported using open boundary coupling schemes probably due to the difficulties in implementing open boundaries with varying free surfaces in an sph model considering its lagrangian features kassiotis et al 2011 implemented a one way hybridization of an fdm based boussinesq wave model and an sph model and simulated the wave runup on a block protected breakwater however the incident waves will be reflected to the offshore side after interacting with coastal structures and an original open boundary is not capable of transmitting the reflected waves back to the mesh based submodel on the offshore side instead second reflections will be induced at the open boundaries resulting in wave energy accumulation in the nearshore submodel and incorrect information synchronization between submodels thus the hybrid model becomes unstable and the results of long term simulation are unreliable hence further work should be conducted on the modifications and improvements of the open boundary coupling scheme in this paper a two way open boundary coupling scheme and a modified one way open boundary coupling scheme using a nonreflective open boundary are proposed to hybridize a one dimensional swe based sph model with a vertical two dimensional ns equations based sph model the paper is structured as follows the categories and research progress of hybrid sph models are reviewed in section one the submodel implementations and the open boundary coupling schemes are introduced in section two the two way coupling performance of the proposed hybrid sph model is validated using a solitary wave propagation test case in section three the hybrid model is then applied in section four to simulate steady flows over a bump dam breaking waves runup on a slope dam breaking waves impacting against a vertical wall and standing waves further verifying the modeling accuracy and the computational efficiency sections five and six present the conclusions and acknowledgements respectively 2 hybrid models and coupling methodology in conventional section coupling models the submodels on the nearshore side are generally implemented based on ns equations and solved with the sph method while mesh based wave models are chosen to be the submodels on the offshore side a similar nearshore submodel is adopted here named ns sph while the offshore submodel is also an sph model that is based on one dimensional linear swes named swe sph accordingly this is the first hybrid sph model that combines two sph submodels using different governing equations to implement the information and mass exchange between swe sph and ns sph two open boundary coupling schemes are proposed in this paper including a two way coupling scheme and a one way coupling scheme based on a nonreflective open boundary condition the implementation of the two submodels and the coupling schemes are introduced successively 2 1 ns sph model the core concept of the sph method is discretizing the study subject into a group of particles that not only have material properties e g density velocity and pressure but also work as computational nodes a field function f r eq 1 and its derivative f r eq 2 at any location r in the system can be calculated by accumulating the contributions from all the neighboring particles with a weighting function called the kernel function readers are suggested to refer to the works of liu and liu 2003 for a more detailed theoretical discussion and formulation 1 f r i j 1 n m j ρ j f r j w i j 2 f r i j 1 n m j ρ j f r j i w i j where f is an arbitrary field function in the system the subscripts i and j denote the central particle and the neighboring particles respectively m and ρ denote the mass and density of a particle the kernel function w ij w r i r j h where h is the smoothing length presents the weighting influence of particle j on particle i the momentum equation of the navier stokes equations can be written into the lagrangian form as 3 d u d t 1 ρ p g υ 0 2 u 1 ρ τ where the third and the fourth terms on the right hand side denote the laminar viscosity term and the sps sub particle scale turbulent viscosity term gotoh et al 2004 based on the les large eddy simulation model ν 0 is the kinetic viscosity and τ is the sps turbulent stress tensor with 4 τ α β υ t ρ 2 s α β 2 3 k δ α β 2 3 ρ c i δ 2 δ α β s α β 2 where k is the sps turbulent kinetic energy the turbulent viscosity eddy coefficient υ t c s δ 2 s where the smagorinsky constant c s 0 12 δ αβ 1 α β 0 α β and δ is the particle initial interval s 2 s α β s α β and s αβ is the element of the sps strain tensor 5 s α β 1 2 u α x β u β x α then eq 3 can be written into sph form as 6 d u i d t j 1 n m j p j ρ j 2 p i ρ i 2 i w i j g j 1 n 4 υ 0 m j r i j u i j i w i j ρ i ρ j r i j 2 j 1 n m j τ j ρ j 2 τ i ρ i 2 i w i j the ns sph model follows the assumption of wcsph and the δ sph formula antuono et al 2010 marrone et al 2011 is adopted here to calculate the change rate of fluid particle densities 7 ⅆ ρ i ⅆ t j 1 n m j u i j i w i j δ h c 0 j 1 n m j ρ j ψ i j i w i j 8 ψ i j 2 ρ j ρ i r i j r i j 2 ρ i l ρ j l 9 ρ i l j 1 n ρ j ρ i l i i w i j d v j 10 l i j 1 n r j r i i w i j d v j 1 where the second term on the right hand side of eq 7 is the dissipative term for the density change rate the dissipative term helps reduce the unphysical oscillation of fluid density and pressure in wcsph where δ controls the dissipative intensity δ 0 1 in this paper the fluid pressure relates to its density explicitly based on the assumption of artificial compression thus the pressure can be calculated by the equation of state directly as 11 p b ρ ρ 0 γ 1 where γ 7 and b c 0 2 ρ 0 γ ρ 0 is the reference density and we have ρ 0 1000 kg m3 in the water simulation c 0 is the artificial speed of sound which is generally larger than 10 times the reference velocity to maintain the change rate of fluid density within 1 theoretically the reference velocity in this paper is calculated using gd 0 5 where g is the gravity acceleration and d is the water column height in the dam breaking case or the initial water depth in the numerical wave flume case 2 2 swe sph model the shallow water equations can be obtained by integrating the navier stokes equations in the vertical direction the linear swes without the coriolis force term and viscosity term are written in the lagrangian form xia et al 2013 as 12 d d d t d u 13 d u d t g d b g s f where d b and u denote the water depth bed elevation and the depth averaged horizontal velocity respectively s f denotes the bed friction contribution and is calculated by eq 14 where n is the manning coefficient 14 s f n 2 u u d 4 3 then eq 13 is written in sph form to obtain the acceleration of particle i 15 d u i d t g j 1 n v j i w i j g j 1 n v j d j b j b i i w i j j 1 n v j π i j i w i j g n 2 u i u i d i 4 3 where v j denotes the volume of neighboring particle j v j d j in the swe sph model has a similar meaning as m j ρ j in the ns sph model i e the system space that is occupied by particles j area for 2d and length for 1d the artificial viscosity term which helps stabilize the calculation is obtained by 16 π i j α μ i j c i j 2 μ i j d i j u i j r i j 0 0 u i j r i j 0 where u ij and r ij are the relative velocity and the relative position between the central particle i and the neighboring particles j respectively u ij u i u j and r ij r i r j c i j and d i j are the mean speed of sound and the mean water depth respectively with c i j c i c j 2 and d i j d i d j 2 and c i g d i μ ij h i j u ij r ij r ij 2 where h i j is the mean smoothing length with h i j h i h j 2 the artificial viscosity coefficient α in this paper equals 1 0 which makes a satisfactory balance between the numerical stability and the numerical dissipation according to the mass conservation and the incompressible assumption the volume of each particle in swe sph remains constant indicating that the smoothing length reduces as the water depth increases or the smoothing length increases as the water depth reduces thus the variable smoothing length is obtained by 17 h i h 0 d 0 d i 1 d m where h 0 and d 0 are the initial smoothing length and the initial water depth of particle i respectively d m is the system dimension the modified formula for water depth integration eq 18 proposed by xia et al 2013 which helps reduce error in the presence of steep topography is adopted to calculate the water depth d and the smoothing length h together with eq 17 18 d i i 1 n v j w i j i 1 n v j d j b i b j w i j the particle s bed elevation b i is calculated using the approach suggested by vacondio et al 2012a b in which a set of fixed bed particles are distributed in a cartesian grid and the bed elevation of particle i is interpolated from the bed particles in its supporting domain defined as 19 b i 1 κ i i 1 n b ω j b b j b w r i r j b h j b where n b is the bed particle number in the supporting domain and b j b h j b and ω j b denote the bed elevation the smoothing length and the occupied space area for 2d and length for 1d of bed particle j respectively κ i is the modification coefficient of the smoothing function given as 20 κ i i 1 n b ω j b w r i r j b h j b 2 3 coupling methodology in the most widely used wave paddle coupling scheme for sph hybridization the fluid movement information should be first transformed into the movement of a solid paddle which is then used to drive the fluid in the other submodel in contrast the open boundary ni et al 2016 2018a b coupling scheme fig 2 proposed in this paper reduces the intermediate steps and makes the information exchange between submodels more direct and more expedite the submodel communication for two way open boundary coupling is sketched in fig 3 and the scheme works as follows for the swe sph model the water depth d swe and the depth averaged velocity u swe at x swe are interpolated from the neighboring swe fluid particles and transmitted to ns obc open boundary condition the buffer zone particles dashed circles in the ns obc are redistributed according to the new water depth and their velocities are updated as well driving the internal fluid movement in the ns sph meanwhile for the ns sph model the free surface elevation at x ns is captured to obtain the water depth d ns and the depth averaged velocity u ns is integrated from the bed to the water surface the two variables are transmitted to swe obc and are used to update the velocity and water depth properties of the swe buffer zone particles gray circles completing the loop of information feedback from ns sph to swe sph the width of the open boundary is 4 times the particle initial interval and the influence on the hybridization can be neglected since the two submodels are both capable of creating and deleting particles through their own open boundaries independently the proposed hybrid model can transmit not only surface waves but also water flows which are the limitations of wave paddle coupling and overlapping zone coupling conventional section coupling models are generally used in nonbreaking wave cases and they theoretically do not suit breaking wave cases due to the limitation of coupling schemes it is discovered that numerical instability will also be triggered when breaking waves propagate through the aforementioned two way open boundary and sometimes this results in the model blowing up thus a modified one way open boundary coupling scheme based on the nonreflective fobc flather s open boundary condition ni et al 2016 2018a b is proposed here as a supplement for the two way open boundary coupling scheme see fig 4 the computational domain of swe sph covers the entire domain of the hybrid model considering the cpu time of swe sph can be neglected when compared with that of ns sph similar to the two way open boundary coupling scheme the water depth d swe and the depth averaged velocity u swe at x swe are also interpolated from the neighboring swe fluid particles and transmitted to fobc the buffer zone particles are updated following the rules of fobc and drive the internal fluid movement in ns sph as shown in fig 5 when the reflected waves from beaches or coastal structures interact with the coupling boundaries those waves will be transmitted outward of the system thoroughly owing to the nonreflective features of fobc hence the second reflection that occurred in front of the original open boundaries by kassiotis et al 2011 will be efficiently prevented practical application cases section 4 2 in this paper show that the modified one way open boundary coupling scheme acts as a satisfactory connection between swe sph and ns sph when breaking waves or breaking bores propagate through it should also be noted that the time step in ns sph is used as the time step for swe sph since the former is much smaller than the latter moreover the cpu time rate between swe sph and ns sph is approximately 10 4 so the computational efficiency of the hybrid model is mainly controlled by the corresponding parameters in ns sph e g particle numbers and speed of sound 3 solitary wave propagation through two way coupling boundaries nonreflective energy transmitting and unrestricted mass transportation between submodels are the main criteria for a qualified hybridization scheme in this section a solitary wave propagation case is used to validate the proposed coupling scheme the flume with a flat bed in fig 6 is 5 0 m in length and 0 4 m in depth the solitary wave with h 0 1 m is generated by the open boundary on the left hand side of the flume and propagates to the fobc on the right end the reason why the solitary wave propagation case is chosen is that unlike the oscillation movement patterns of regular waves all water particles in a solitary wave travel in the same direction as the wave this feature guarantees the monodirectional transport of fluctuations and mass among the submodels and makes it easy to identify if there is a reflection when the transport travels from a submodel to another a swe sph model case a and a ns sph model case b are used as the control groups to simulate the solitary wave case separately as shown in fig 7 a and fig 7 b since the linear swes are applied as the governing equations in swe sph the nonlinear feature of solitary waves makes the wave profile gradually lean forward into a bore shape in contrast ns equations give a better description of solitary wave propagation during which the wave profile remains symmetrical and stable in case c and case d the flume is separated into two parts at x 2 5 m and different submodels are hybridized to validate the performance of the coupling schemes when solitary waves propagate from ns sph to swe sph or from swe sph to ns sph fig 7 c shows that the solitary wave propagates through the coupling boundaries without reflections although there is a refraction of the wave peak trajectory due to the use of different governing equations in the case of swe sph ns sph fig 7 d a slight reflection is observed at the coupling boundaries this indicates that the two way coupling of ns sph and swe sph is actually not equal in one direction with another in the open boundary of ns sph there is no other hydrodynamic information except for water depth and depth averaged velocity e g the vertical distribution of horizontal velocity and pressure and the vertical velocity of water particles in the open boundary of swe sph water depth and depth averaged velocity are the only two variables that can be provided when the information is transmitted from ns sph to swe sph although parts of the hydrodynamic details are lost during the coupling process there is still enough information for the calculation of linear swes however when the information is transmitted in the opposite direction there is not enough information for the complete calculation of ns sph some basic assumptions must be made on the coupling open boundaries e g zero vertical velocities and hydrostatic pressure leading to the aforementioned reflection if water particles periodically oscillate around the coupling boundaries e g regular waves nonneglectable numerical noise will probably be induced by the reflection phenomena better results are expected if the ns sph model is hybridized with nonlinear swe based or boussinesq equation based numerical models during the time 2 5 s t 3 5 s the entire profile of the solitary wave is within the computational domain and the water mass of the entire system remains constant with little fluctuation rate which is 0 17 in both case c and case d this indicates that the mass of the proposed hybrid model using a two way open boundary coupling scheme is conserved satisfactorily during the solitary wave propagation through the coupling boundaries the continuity of physical fields such as velocity and pressure is another criteria for a hybridization scheme fig 8 and fig 9 present the velocity field and pressure field evolutions in the ns sph swe sph solitary wave propagation case respectively enlarged snapshots are also provided in fig 10 which shows the particle distributions near the coupling open boundary when the solitary wave peak is propagating through figs 8 10 indicate that the existence of the coupling open boundary has negligible influence on the continuity of velocity and pressure fields which remain stable and smooth when the solitary wave propagates from ns sph domain to swe sph domain in the ns sph swe sph case three sensors are deployed at p1 2 45 m 0 1 m p2 2 45 m 0 2 m and p3 2 45 m 0 3 m to measure the density evolutions near the coupling open boundary as shown in fig 11 the particle density is slightly larger than the reference density ρ 0 1000 kg m3 due to the weakly compressible feature of wcsph the deeper the water is the larger the density becomes when the solitary wave propagates over the density sensors the measured densities vary with the evolutions of water depth although there are some fluctuations on the density evolution curves the general performance is satisfactory as the change rate of fluid density is kept within 1 in line with the numerical assumption the convergence speed of the hybrid sph model is also evaluated using three test cases with different particles resolutions of 0 02 m 0 0133 m and 0 01 m the l2 norm of the water depth error is shown in fig 12 with a satisfactory order of convergence of 1 52 for ns sph submodel and 1 16 for swe sph submodel 4 hybrid model applications 4 1 steady flows over a bump shallow water equations are commonly applied to simulate free surface water flows which have a much larger horizontal scale than vertical scale the sph models vacondio et al 2012a b xia et al 2013 based on swes have proven that they are capable of not only addressing generally shallow water flows but also efficiently capturing flow shocks and automatically identifying wetting drying boundaries steady flows over a bump are widely used as one of the benchmark test cases ni et al 2016 vacondio et al 2012a b for swe models the subcritical flows from the upstream are turned into a supercritical state after flushing over a bump and a hydraulic jump is then formed between the bump and the subcritical flow in the downstream as shown in fig 13 a in this paper a 1d slip channel with a length of 10 m and a bump height of 0 2 m is used to increase the simulation difficulty the bump width is set to 0 2 m which is only half of that value in general cases the bed elevation of the channel is defined by eq 21 as 21 b x 0 2 0 2 x 5 2 x 4 6 m 0 x 4 6 m the inflow velocity in the upstream is 0 435 m s and the outflow depth in the downstream is 0 330 m the numerical resolution of swe sph and ns sph is 0 02 m and 0 01 m respectively the simulation time of the case here is 25 s and fig 13 shows the flow velocities when the system comes into a steady state the comparisons between the numerical results and the analytical solutions of swes indicate that swe sph is capable of predicting the transcritical flows with a hydraulic jump see fig 13 a however if the test case is resimulated using the ns sph model fig 13 d deviations of numerical results between these two models will be discovered around the hydraulic jump behind the bump the reason is that the basic assumptions of swes do not hold true for the local flows around steep topography so that the swe based models fail to handle the violent hydraulic features of velocity distribution and free surface variations an accurate description of the highly nonlinear hydrodynamic phenomenon near the hydraulic jump including water body collapsing water particle splashing and backflow zone can only be achieved using ns equations on the other hand if the whole computational domain is simulated by ns sph most of the cpu power will be wasted on the upstream and downstream channels with slowly varying water levels which actually has been very well described by swe sph hence in this section the ns sph model is applied to simulate the transcritical flow and the hydraulic jump near the bump while the swe sph model is utilized to simulate the rest of the domain meanwhile submodels are hybridized with a two way open boundary coupling scheme to improve the computational efficiency on the premise of computational accuracy and simulation detail fig 14 and fig 15 present the horizontal velocity distributions and the vertical velocity distributions at four sections x 4 5 m 5 5 m 6 2 m and 7 5 m near the hydraulic jump the circles denote the results of ns sph fig 13 d while the solid lines denote the results of the hybrid model fig 13 c figs 14 and 15 show that the proposed hybrid model matches the full scale ns sph model in the corresponding computational domain additionally the computational efficiency of various models is compared in table 1 where n p and t denote the particle number and the cpu time used in case d with full scale ns sph it is indicated that 1 the swe sph cpu time is negligible 2 the hybrid model cpu time is remarkably reduced compared with the full scale ns sph and 3 the cpu time is generally proportional to the used particle number all the aforementioned results have proven that the proposed hybrid sph model reaches the same level of computational accuracy and simulation detail in modeling highly nonlinear hydrodynamic problems compared with the full scale ns sph model while achieving considerable improvement in the computational efficiency 4 2 dam breaking waves runup on a slope dam breaking and wave runup are two classic problems in hydrodynamic simulations which both involve nonlinear water surface evolutions and wetting drying boundaries in this section the two cases are joined to form a test of dam breaking waves runup on a slope which is applied to further verify the performance of the proposed open boundary coupling scheme at the initial state fig 16 a a rectangle water body with a height of 0 25 m and a length of 2 25 m is deployed on a flat bed a solid wall is set on the left of the water body and a 1 10 slope is set at x 3 40 m the water body collapses due to gravity after the simulation starts the breaking wave runs up along the slope and turns the kinetic energy into potential energy as shown in fig 16 b the water front on the slope then slips down and runs toward the offshore side in the form of breaking bores later the water body oscillates between the solid wall and the slope until the mechanical energy is dissipated and the water ultimately calms down on the bed extreme nonlinear water movements e g dam breaking waves and breaking bores transmitting through coupling boundaries are involved in this test case resulting in much larger numerical difficulty than nonbreaking regular wave propagation cases simulated by conventional hybrid sph models even if the two way open boundary coupling scheme is applied the hybrid model is still not robust enough to bear the shock from the breaking waves due to the huge mismatch between the information provided by different submodels hence the modified one way open boundary coupling scheme is utilized in this section to address this challenging problem the coupling boundary is set at x 2 00 m the right side of which is modeled with ns sph while swe sph covers the entire computational domain the computational resolution is 0 005 m and the simulation time is 20 s this test case was also simulated by de leffe et al 2010 using another swe based sph model and the water surface evolutions at x 1 4 m and x 3 4 m were validated with experimental data in this paper two more gauges are deployed on the slope at x 4 0 m and x 4 5 m to compare the performance of various numerical models similar to the case of steady flows over a bump three different numerical models are used here including swe sph hybrid sph and ns sph the free water surface evolutions at 4 gauges are validated in fig 17 and table 2 compares the relative errors between various model results and the experimental data de leffe et al 2010 the relative errors are calculated by eq 22 where h 0 is the initial water depth of 0 25 m generally the numerical results of the three models agree with the experimental data satisfactorily ns sph yields a slightly smaller error than swe sph and the hybrid model yields an equivalent level of error with the other two models there are no experimental data at gauge 3 and gauge 4 while the relative errors between hybrid sph and ns sph at the two gauges are 3 70 and 2 65 respectively indicating good agreement in the prediction of water wave evolutions on the slope 22 ε η a η b 1 n 1 n η a η b h 0 2 the general propagations of breaking waves e g runup on the slope fig 18 a can be well predicted by the swe sph model however due to the limitation of the simplified governing equations the swe sph model cannot provide detailed nonlinear water movements with fractured surfaces e g the breaking bores induced by the water slipping down from the slope fig 18 b the plunging waves on the slope fig 18 c and the undular bores propagating toward the shore fig 18 d in contrast the proposed hybrid model not only inherits the excellent capability of simulating complex hydrodynamics problems from the ns sph model but also improves the computational efficiency remarkably as shown in table 3 the particle number in the hybrid model ranges from 5560 to 22506 during the 20 s simulation and the mean number is approximately 15154 which is only 44 9 of the particle numbers required in ns sph and requiring only 50 9 of the original cpu time in addition to computational accuracy computational efficiency and simulation detail the conservation of system mass is another important performance index that should be considered for hybridization schemes especially in cases with water particles traveling around the coupling boundaries unobstructed mass transportation and qualified conservation of system mass are the key factors in long term simulation the one way open boundary coupling scheme is potentially more likely to lose its balance of system mass compared with a two way scheme fig 19 presents the time evolutions of the system mass during the simulation indicating that the mass of the two submodels fluctuates as the water body oscillates on the bed the total mass of the hybrid model generally remains steady with a mean fluctuation rate of 3 0 the mass fluctuation gradually decreases as the simulation progresses and the total mass converges to the eventual theoretical value considering that only the one way coupling scheme is used in the case that suffers from multiple shocks from the breaking waves the mass conservation performance of this modified one way coupling model is acceptable 4 3 dam breaking waves impacting against a vertical wall another classic case of dam breaking waves impacting against a vertical wall which is often used in the simulation of tsunami or green water is applied in this section to validate the force calculation of hybrid sph model as shown in fig 20 a a rectangle water body with a height of 0 60 m and a length of 1 20 m is deployed on the left part of a water tank with a length of 3 22 m at the initial state the dam breaking waves run downstream along the flat bed and impact against the vertical wall on the right side of the tank then the waves are reflected and propagate backward with violet and breaking free surface similar to the dam breaking case in section 4 2 the one way open boundary coupling scheme is also used here with a coupling boundary at x 1 00 m the entire computational area is modeled by swe sph while the ns sph only calculates right part of the tank the test case is also modeled with ns sph as comparisons for the hybrid sph results the particle resolution of both hybrid sph model and ns sph model is set as 0 005 m the laboratory experiment of this dam breaking case was conducted by buchner 2002 and the impacting force on the vertical wall was measured by two pressure sensors which were located at p1 3 22 m 0 16 m and p2 3 22 m 0 584 m respectively four water level gauges were also deployed at x 2 725 m 2 228 m 1 73 m and 0 6 m to measure the free surface evolutions the pressure evolutions of p1 and p2 by hybrid sph model and ns sph model are presented in fig 21 the numerical results are shifted by 0 327 s to compare with experimental data buchner 2002 the two peak type pressure evolutions at p1 is well simulated by sph models and the peak values are generally satisfactory the pressure at p2 is mainly the result of hydrostatic pressure which is also well predicted owing to the accurate calculation of water front uprising the pressure results given by hybrid sph model and ns sph model generally match with each other indicating that the coupling scheme has acceptable error on the force calculation snapshots of pressure fields solved by hybrid sph model at t 1 24 s and t 1 82 s are also provided in fig 22 where fluid particles in ns sph model are color mapped and free surface particles in swe sph model are presented with black solid circles the free water surface evolutions at four gauges are validated in fig 23 which shows a good match between the numerical results and experimental data before the reflected waves arrive at the gauges around t 2 0 s since multiple water air interfaces are formed due to the plunging waves and the top surface is detected as the free water surface the numerical water levels of h1 h2 and h3 during t 1 7 s 2 5 s are unauthentic and they are generally larger that experimental data after the water movement gradually calms down the numerical results and the experimental data agree with each other again 4 4 standing waves a simple standing wave flume with a length of 2l 5 00 m and water depth of d 0 4 m is simulated as the last case in this paper to evaluate the energy conservation performance in long term run using hybrid sph model with one way open boundary coupling scheme the computational domain of swe sph covers the entire flume while ns sph calculates the domain from x l to x 2l as shown in fig 24 regular waves with wave period t 1 45 s wave height h 0 04 m and wave length l 2 50 m are generated on the left part of the flume using an open boundary wave generation algorithm ni et al 2016 the incident waves propagate through the coupling open boundary and get reflected by the vertical wall at x 2l then standing waves are induced due to the interaction between the reflected waves and the incident waves this case runs for 15 wave periods with particle resolution of 0 01 m fig 25 shows the free water surface evolutions at x d 0 l 4 l 2 and 3l 4 respectively where x d denotes the distance from the targeted section to the vertical wall the water levels vary in a simple harmonic pattern with wave heights of 2h at the antinodes of standing waves x d 0 and x d l 2 as predicted by analytical solutions while water surface almost remains steady at the first node from the vertical wall fig 25 b the water surface at the second node from the vertical wall fig 25 d varies in a regular pattern probably due to the influence of skew waves which propagate from swe sph and has been discussed in section 3 nevertheless the skewness vanishes after waves propagate in ns sph as shown in fig 26 while fig 27 provides pressure field snapshots of the standing waves during one wave period this standing wave case also indicates that energy conserves satisfactorily in the proposed hybrid sph numerical wave flume which is not only robust in long term run but also remains a steady mean water level 5 conclusions this work proposes a two way open boundary coupling scheme and a modified one way open boundary coupling scheme based on a nonreflective fobc to hybridize a swe sph model with a ns sph model the ns sph model is used to present the nonlinear hydrodynamic features in the concerned areas while the rest of the areas are simulated with the swe sph model which calculates much faster than the former model the hybridization performance on the information transmitting mass and energy conservation simulation detail computational accuracy computational efficiency and computational convergence speed is evaluated and discussed using five test cases including solitary wave propagations steady flows over a bump dam breaking waves runup on a slope dam breaking waves impacting against a vertical wall and standing waves it is indicated that the proposed open boundary coupling schemes are capable of improving the computational efficiency on the premise of computational accuracy and simulation detail the information transmitting and the conservation of system mass are both satisfactory it should be noted that the open boundary condition in this paper is implemented based on the buffer zone techniques which basically assume that there is only one water surface at a given section thus cases with multiple surfaces e g wave breaking at the open boundary are technically not properly treated numerical unstable issues may also occur when where is a strong vortex across the open boundary more advanced open boundary techniques ferrand et al 2017 for the sph method are expected to be applied to further improve the hybridization robustness and the simulation accuracy for violent hydrodynamic conditions additionally well developed grid based models e g funwave swash and openwave3d etc which are governed by nonlinear shallow water equations or boussinesq equations can also be coupled with ns sph using the proposed scheme and be applied to model the water movements in the offshore areas and provide a better simulation of the nonlinear wave propagation process from the offshore to the nearshore acknowledgements this work is supported by the national natural science foundation of china no 51809238 and no 51779228 the fundamental research funds for the central universities no 2019b06514 and the scientific research program of zhejiang institute of hydraulics estuary no a17001 the authors wish to thank the anonymous reviewers for their constructive comments 
22207,balancing the trade off between the simulation detail and the computational efficiency in a hydrodynamic numerical model is generally difficult e g one can hardly find a single set of governing equations that is capable of efficiently describing the wave propagation processes from offshore to nearshore and accurately presenting the details of wave breaking and interacting with coastal structures simultaneously to address this predicament open boundary coupling schemes are proposed in this paper to hybridize a swe shallow water equations based sph smoothed particle hydrodynamics model with a ns navier stokes equations based sph model the ns sph model is used to present the nonlinear hydrodynamic features in the main study domains while the remaining domains are simulated with the swe sph model which calculates much faster than the ns sph model the hybrid sph models are applied to simulate solitary wave propagation steady flows over a bump dam breaking waves and standing waves the hybridization performance on the information transmitting mass and energy conservation simulation detail computational accuracy computational efficiency and computational convergence speed is fully validated and evaluated the results indicate that the proposed open boundary coupling schemes are capable of improving the computational efficiency on the premise of computational accuracy and simulation detail keywords smoothed particle hydrodynamics hybrid model open boundary condition shallow water equation navier stokes equation 1 introduction the sph smoothed particle hydrodynamics method gingold and monaghan 1977 liu and liu 2003 monaghan 1994 is a promising meshfree lagrangian numerical method that shows advantages over conventional euler mesh based methods on the aspects of moving boundaries free surfaces and multiphase interface capture and particle tracking during the most recent decade the sph method has been widely applied to simulate highly nonlinear hydrodynamic problems gotoh and khayyer 2018 violeau and rogers 2016 zhang et al 2017 with complex water surfaces and fluid structure interactions e g hydraulic jumps federico et al 2012 tidal bores ni et al 2018a b nearshore wave shoaling li et al 2012 wave runup and breaking on beaches dalrymple and rogers 2006 lo and shao 2002 and waves interacting against coastal facilities altomare et al 2017 ni and feng 2014 liu et al 2014 great efforts have been made on the theoretical study of sph method including numerical stability antuono et al 2010 marrone et al 2011 conservation and error analysis gotoh et al 2014 gui et al 2015 khayyer et al 2017a khayyer et al 2017b wang et al 2019 sun et al 2019 violeau and fonty 2019 solid boundary conditions ferrand et al 2013 fourtakas et al 2019 open boundary conditions ni et al 2018a b wang et al 2019 etc nevertheless one of the drawbacks of the sph method is its low computational efficiency and the main solutions at present include high performance computing hpc domínguez et al 2013 rustico et al 2014 particle refinement techniques barcarolo et al 2014 vacondio et al 2013 and hybridization techniques which are discussed in this paper hybrid sph models can be divided into two categories according to the purpose of hybridization one category of hybrid sph models uses various numerical models to describe the corresponding movements of various subjects in the same system e g using an sph model to simulate the nonlinear water movements inside a tank while using an fem finite element method model to simulate the interaction between an elastic plate and the sloshing water yang et al 2012 khayyer et al 2018 another example altomare et al 2014a b is using an sph model to simulate nearshore water waves while using a dem discrete element method model to simulate the armor blocks on sea breakwaters and studying the wave runup features however the aforementioned hybrid sph models will not be discussed here the second category of hybrid sph models which are the study topic in this paper aim to improve the computational efficiency on the premise of computational accuracy and simulation detail by using sph models to present the nonlinear hydrodynamic features in the main study domains while using conventional mesh based methods or simplified models to simulate the rest of the system this category of hybrid sph models can be further divided into two types a layer coupling model lcm and a section coupling model scm navier stokes ns equations are generally adopted as the governing equations by the submodels of lcms which are arranged up and down as shown in fig 1 a the upper submodel uses the sph method to discretize the governing equations to capture the nonlinear water surfaces while the lower submodel uses conventional euler meshes to improve computational efficiency the two way coupling scheme also known as the strong coupling scheme is applied to connect the two submodels since the evolution of the free surface is not involved with the coupling boundaries the two way coupling schemes for lcm are relatively easy to handle for example marrone et al 2016 proposed a hybrid model that connected a wcsph weakly compressible sph model and an fvm finite volume method model while the hybridization of an isph incompressible sph model and an fvm model was implemented by napoli et al 2016 section coupling models are more common in the applications of hybrid numerical wave flumes which use ns equations based sph submodels to simulate the nearshore wave evolutions and the detailed wave structure interactions e g wave breaking and overtopping while mesh based numerical methods are used to solve nonlinear swes shallow water equations or boussinesq equations and to describe the wave propagations from offshore to nearshore according to the coupling schemes that connect the submodels scms generally include wave paddle coupling overlapping zone coupling and open boundary coupling wave paddle coupling fig 1 b is the most widely used scheme early in 2010 narayanaswamy et al 2010 hybridized the boussinesq equation based funwave model kirby et al 1998 with the sphysics model gomez gesteira et al 2012 using a two way solid wave paddle and validated the hybrid sph model with a solitary wave propagation case later altomare et al 2014a b 2015 implemented a one way hybridization between the swash model zijlema et al 2011 and the dualsphysics model crespo et al 2015 deformable wave paddles were adopted to adjust to the velocity distributions in various water depths similarly verbrugghe et al 2018 used deformable wave paddles to connect the openwave3d model engsig karup et al 2009 and the dualsphysics model and it was a two way hybridization different from wave paddle coupling which transports water surface fluctuation with moving boundaries overlapping zone coupling fourtakas et al 2017 sriram et al 2014 transports the velocities and pressures through the submodels by overlapping zones as shown in fig 1 c the overlapping zones transform with the movement of the water body and there are no particle creations or particle deletions among the submodels as the mass transportation phenomenon will be induced by the nonlinear nearshore waves in the propagation directions the aforementioned coupling boundaries including wave paddles and overlapping zones will gradually deviate from the initial positions with the simulation progress moreover deformable coupling boundaries e g deformable wave paddles and deformable overlapping zones will suffer from the growing larger transformations caused by the velocity difference between the upper water and the lower water these transformations will be strengthened by the nonlinear mass transportation effect leading to eventual coupling failure additionally the two aforementioned coupling schemes do not suit the flow conditions because the schemes limit particle creation and particle deletion operations by contrast open boundary coupling bears no such problems the positions of the open boundaries remain steady during the simulation similar to conventional mesh based models introducing a euler perspective into the lagrangian system few scms have been reported using open boundary coupling schemes probably due to the difficulties in implementing open boundaries with varying free surfaces in an sph model considering its lagrangian features kassiotis et al 2011 implemented a one way hybridization of an fdm based boussinesq wave model and an sph model and simulated the wave runup on a block protected breakwater however the incident waves will be reflected to the offshore side after interacting with coastal structures and an original open boundary is not capable of transmitting the reflected waves back to the mesh based submodel on the offshore side instead second reflections will be induced at the open boundaries resulting in wave energy accumulation in the nearshore submodel and incorrect information synchronization between submodels thus the hybrid model becomes unstable and the results of long term simulation are unreliable hence further work should be conducted on the modifications and improvements of the open boundary coupling scheme in this paper a two way open boundary coupling scheme and a modified one way open boundary coupling scheme using a nonreflective open boundary are proposed to hybridize a one dimensional swe based sph model with a vertical two dimensional ns equations based sph model the paper is structured as follows the categories and research progress of hybrid sph models are reviewed in section one the submodel implementations and the open boundary coupling schemes are introduced in section two the two way coupling performance of the proposed hybrid sph model is validated using a solitary wave propagation test case in section three the hybrid model is then applied in section four to simulate steady flows over a bump dam breaking waves runup on a slope dam breaking waves impacting against a vertical wall and standing waves further verifying the modeling accuracy and the computational efficiency sections five and six present the conclusions and acknowledgements respectively 2 hybrid models and coupling methodology in conventional section coupling models the submodels on the nearshore side are generally implemented based on ns equations and solved with the sph method while mesh based wave models are chosen to be the submodels on the offshore side a similar nearshore submodel is adopted here named ns sph while the offshore submodel is also an sph model that is based on one dimensional linear swes named swe sph accordingly this is the first hybrid sph model that combines two sph submodels using different governing equations to implement the information and mass exchange between swe sph and ns sph two open boundary coupling schemes are proposed in this paper including a two way coupling scheme and a one way coupling scheme based on a nonreflective open boundary condition the implementation of the two submodels and the coupling schemes are introduced successively 2 1 ns sph model the core concept of the sph method is discretizing the study subject into a group of particles that not only have material properties e g density velocity and pressure but also work as computational nodes a field function f r eq 1 and its derivative f r eq 2 at any location r in the system can be calculated by accumulating the contributions from all the neighboring particles with a weighting function called the kernel function readers are suggested to refer to the works of liu and liu 2003 for a more detailed theoretical discussion and formulation 1 f r i j 1 n m j ρ j f r j w i j 2 f r i j 1 n m j ρ j f r j i w i j where f is an arbitrary field function in the system the subscripts i and j denote the central particle and the neighboring particles respectively m and ρ denote the mass and density of a particle the kernel function w ij w r i r j h where h is the smoothing length presents the weighting influence of particle j on particle i the momentum equation of the navier stokes equations can be written into the lagrangian form as 3 d u d t 1 ρ p g υ 0 2 u 1 ρ τ where the third and the fourth terms on the right hand side denote the laminar viscosity term and the sps sub particle scale turbulent viscosity term gotoh et al 2004 based on the les large eddy simulation model ν 0 is the kinetic viscosity and τ is the sps turbulent stress tensor with 4 τ α β υ t ρ 2 s α β 2 3 k δ α β 2 3 ρ c i δ 2 δ α β s α β 2 where k is the sps turbulent kinetic energy the turbulent viscosity eddy coefficient υ t c s δ 2 s where the smagorinsky constant c s 0 12 δ αβ 1 α β 0 α β and δ is the particle initial interval s 2 s α β s α β and s αβ is the element of the sps strain tensor 5 s α β 1 2 u α x β u β x α then eq 3 can be written into sph form as 6 d u i d t j 1 n m j p j ρ j 2 p i ρ i 2 i w i j g j 1 n 4 υ 0 m j r i j u i j i w i j ρ i ρ j r i j 2 j 1 n m j τ j ρ j 2 τ i ρ i 2 i w i j the ns sph model follows the assumption of wcsph and the δ sph formula antuono et al 2010 marrone et al 2011 is adopted here to calculate the change rate of fluid particle densities 7 ⅆ ρ i ⅆ t j 1 n m j u i j i w i j δ h c 0 j 1 n m j ρ j ψ i j i w i j 8 ψ i j 2 ρ j ρ i r i j r i j 2 ρ i l ρ j l 9 ρ i l j 1 n ρ j ρ i l i i w i j d v j 10 l i j 1 n r j r i i w i j d v j 1 where the second term on the right hand side of eq 7 is the dissipative term for the density change rate the dissipative term helps reduce the unphysical oscillation of fluid density and pressure in wcsph where δ controls the dissipative intensity δ 0 1 in this paper the fluid pressure relates to its density explicitly based on the assumption of artificial compression thus the pressure can be calculated by the equation of state directly as 11 p b ρ ρ 0 γ 1 where γ 7 and b c 0 2 ρ 0 γ ρ 0 is the reference density and we have ρ 0 1000 kg m3 in the water simulation c 0 is the artificial speed of sound which is generally larger than 10 times the reference velocity to maintain the change rate of fluid density within 1 theoretically the reference velocity in this paper is calculated using gd 0 5 where g is the gravity acceleration and d is the water column height in the dam breaking case or the initial water depth in the numerical wave flume case 2 2 swe sph model the shallow water equations can be obtained by integrating the navier stokes equations in the vertical direction the linear swes without the coriolis force term and viscosity term are written in the lagrangian form xia et al 2013 as 12 d d d t d u 13 d u d t g d b g s f where d b and u denote the water depth bed elevation and the depth averaged horizontal velocity respectively s f denotes the bed friction contribution and is calculated by eq 14 where n is the manning coefficient 14 s f n 2 u u d 4 3 then eq 13 is written in sph form to obtain the acceleration of particle i 15 d u i d t g j 1 n v j i w i j g j 1 n v j d j b j b i i w i j j 1 n v j π i j i w i j g n 2 u i u i d i 4 3 where v j denotes the volume of neighboring particle j v j d j in the swe sph model has a similar meaning as m j ρ j in the ns sph model i e the system space that is occupied by particles j area for 2d and length for 1d the artificial viscosity term which helps stabilize the calculation is obtained by 16 π i j α μ i j c i j 2 μ i j d i j u i j r i j 0 0 u i j r i j 0 where u ij and r ij are the relative velocity and the relative position between the central particle i and the neighboring particles j respectively u ij u i u j and r ij r i r j c i j and d i j are the mean speed of sound and the mean water depth respectively with c i j c i c j 2 and d i j d i d j 2 and c i g d i μ ij h i j u ij r ij r ij 2 where h i j is the mean smoothing length with h i j h i h j 2 the artificial viscosity coefficient α in this paper equals 1 0 which makes a satisfactory balance between the numerical stability and the numerical dissipation according to the mass conservation and the incompressible assumption the volume of each particle in swe sph remains constant indicating that the smoothing length reduces as the water depth increases or the smoothing length increases as the water depth reduces thus the variable smoothing length is obtained by 17 h i h 0 d 0 d i 1 d m where h 0 and d 0 are the initial smoothing length and the initial water depth of particle i respectively d m is the system dimension the modified formula for water depth integration eq 18 proposed by xia et al 2013 which helps reduce error in the presence of steep topography is adopted to calculate the water depth d and the smoothing length h together with eq 17 18 d i i 1 n v j w i j i 1 n v j d j b i b j w i j the particle s bed elevation b i is calculated using the approach suggested by vacondio et al 2012a b in which a set of fixed bed particles are distributed in a cartesian grid and the bed elevation of particle i is interpolated from the bed particles in its supporting domain defined as 19 b i 1 κ i i 1 n b ω j b b j b w r i r j b h j b where n b is the bed particle number in the supporting domain and b j b h j b and ω j b denote the bed elevation the smoothing length and the occupied space area for 2d and length for 1d of bed particle j respectively κ i is the modification coefficient of the smoothing function given as 20 κ i i 1 n b ω j b w r i r j b h j b 2 3 coupling methodology in the most widely used wave paddle coupling scheme for sph hybridization the fluid movement information should be first transformed into the movement of a solid paddle which is then used to drive the fluid in the other submodel in contrast the open boundary ni et al 2016 2018a b coupling scheme fig 2 proposed in this paper reduces the intermediate steps and makes the information exchange between submodels more direct and more expedite the submodel communication for two way open boundary coupling is sketched in fig 3 and the scheme works as follows for the swe sph model the water depth d swe and the depth averaged velocity u swe at x swe are interpolated from the neighboring swe fluid particles and transmitted to ns obc open boundary condition the buffer zone particles dashed circles in the ns obc are redistributed according to the new water depth and their velocities are updated as well driving the internal fluid movement in the ns sph meanwhile for the ns sph model the free surface elevation at x ns is captured to obtain the water depth d ns and the depth averaged velocity u ns is integrated from the bed to the water surface the two variables are transmitted to swe obc and are used to update the velocity and water depth properties of the swe buffer zone particles gray circles completing the loop of information feedback from ns sph to swe sph the width of the open boundary is 4 times the particle initial interval and the influence on the hybridization can be neglected since the two submodels are both capable of creating and deleting particles through their own open boundaries independently the proposed hybrid model can transmit not only surface waves but also water flows which are the limitations of wave paddle coupling and overlapping zone coupling conventional section coupling models are generally used in nonbreaking wave cases and they theoretically do not suit breaking wave cases due to the limitation of coupling schemes it is discovered that numerical instability will also be triggered when breaking waves propagate through the aforementioned two way open boundary and sometimes this results in the model blowing up thus a modified one way open boundary coupling scheme based on the nonreflective fobc flather s open boundary condition ni et al 2016 2018a b is proposed here as a supplement for the two way open boundary coupling scheme see fig 4 the computational domain of swe sph covers the entire domain of the hybrid model considering the cpu time of swe sph can be neglected when compared with that of ns sph similar to the two way open boundary coupling scheme the water depth d swe and the depth averaged velocity u swe at x swe are also interpolated from the neighboring swe fluid particles and transmitted to fobc the buffer zone particles are updated following the rules of fobc and drive the internal fluid movement in ns sph as shown in fig 5 when the reflected waves from beaches or coastal structures interact with the coupling boundaries those waves will be transmitted outward of the system thoroughly owing to the nonreflective features of fobc hence the second reflection that occurred in front of the original open boundaries by kassiotis et al 2011 will be efficiently prevented practical application cases section 4 2 in this paper show that the modified one way open boundary coupling scheme acts as a satisfactory connection between swe sph and ns sph when breaking waves or breaking bores propagate through it should also be noted that the time step in ns sph is used as the time step for swe sph since the former is much smaller than the latter moreover the cpu time rate between swe sph and ns sph is approximately 10 4 so the computational efficiency of the hybrid model is mainly controlled by the corresponding parameters in ns sph e g particle numbers and speed of sound 3 solitary wave propagation through two way coupling boundaries nonreflective energy transmitting and unrestricted mass transportation between submodels are the main criteria for a qualified hybridization scheme in this section a solitary wave propagation case is used to validate the proposed coupling scheme the flume with a flat bed in fig 6 is 5 0 m in length and 0 4 m in depth the solitary wave with h 0 1 m is generated by the open boundary on the left hand side of the flume and propagates to the fobc on the right end the reason why the solitary wave propagation case is chosen is that unlike the oscillation movement patterns of regular waves all water particles in a solitary wave travel in the same direction as the wave this feature guarantees the monodirectional transport of fluctuations and mass among the submodels and makes it easy to identify if there is a reflection when the transport travels from a submodel to another a swe sph model case a and a ns sph model case b are used as the control groups to simulate the solitary wave case separately as shown in fig 7 a and fig 7 b since the linear swes are applied as the governing equations in swe sph the nonlinear feature of solitary waves makes the wave profile gradually lean forward into a bore shape in contrast ns equations give a better description of solitary wave propagation during which the wave profile remains symmetrical and stable in case c and case d the flume is separated into two parts at x 2 5 m and different submodels are hybridized to validate the performance of the coupling schemes when solitary waves propagate from ns sph to swe sph or from swe sph to ns sph fig 7 c shows that the solitary wave propagates through the coupling boundaries without reflections although there is a refraction of the wave peak trajectory due to the use of different governing equations in the case of swe sph ns sph fig 7 d a slight reflection is observed at the coupling boundaries this indicates that the two way coupling of ns sph and swe sph is actually not equal in one direction with another in the open boundary of ns sph there is no other hydrodynamic information except for water depth and depth averaged velocity e g the vertical distribution of horizontal velocity and pressure and the vertical velocity of water particles in the open boundary of swe sph water depth and depth averaged velocity are the only two variables that can be provided when the information is transmitted from ns sph to swe sph although parts of the hydrodynamic details are lost during the coupling process there is still enough information for the calculation of linear swes however when the information is transmitted in the opposite direction there is not enough information for the complete calculation of ns sph some basic assumptions must be made on the coupling open boundaries e g zero vertical velocities and hydrostatic pressure leading to the aforementioned reflection if water particles periodically oscillate around the coupling boundaries e g regular waves nonneglectable numerical noise will probably be induced by the reflection phenomena better results are expected if the ns sph model is hybridized with nonlinear swe based or boussinesq equation based numerical models during the time 2 5 s t 3 5 s the entire profile of the solitary wave is within the computational domain and the water mass of the entire system remains constant with little fluctuation rate which is 0 17 in both case c and case d this indicates that the mass of the proposed hybrid model using a two way open boundary coupling scheme is conserved satisfactorily during the solitary wave propagation through the coupling boundaries the continuity of physical fields such as velocity and pressure is another criteria for a hybridization scheme fig 8 and fig 9 present the velocity field and pressure field evolutions in the ns sph swe sph solitary wave propagation case respectively enlarged snapshots are also provided in fig 10 which shows the particle distributions near the coupling open boundary when the solitary wave peak is propagating through figs 8 10 indicate that the existence of the coupling open boundary has negligible influence on the continuity of velocity and pressure fields which remain stable and smooth when the solitary wave propagates from ns sph domain to swe sph domain in the ns sph swe sph case three sensors are deployed at p1 2 45 m 0 1 m p2 2 45 m 0 2 m and p3 2 45 m 0 3 m to measure the density evolutions near the coupling open boundary as shown in fig 11 the particle density is slightly larger than the reference density ρ 0 1000 kg m3 due to the weakly compressible feature of wcsph the deeper the water is the larger the density becomes when the solitary wave propagates over the density sensors the measured densities vary with the evolutions of water depth although there are some fluctuations on the density evolution curves the general performance is satisfactory as the change rate of fluid density is kept within 1 in line with the numerical assumption the convergence speed of the hybrid sph model is also evaluated using three test cases with different particles resolutions of 0 02 m 0 0133 m and 0 01 m the l2 norm of the water depth error is shown in fig 12 with a satisfactory order of convergence of 1 52 for ns sph submodel and 1 16 for swe sph submodel 4 hybrid model applications 4 1 steady flows over a bump shallow water equations are commonly applied to simulate free surface water flows which have a much larger horizontal scale than vertical scale the sph models vacondio et al 2012a b xia et al 2013 based on swes have proven that they are capable of not only addressing generally shallow water flows but also efficiently capturing flow shocks and automatically identifying wetting drying boundaries steady flows over a bump are widely used as one of the benchmark test cases ni et al 2016 vacondio et al 2012a b for swe models the subcritical flows from the upstream are turned into a supercritical state after flushing over a bump and a hydraulic jump is then formed between the bump and the subcritical flow in the downstream as shown in fig 13 a in this paper a 1d slip channel with a length of 10 m and a bump height of 0 2 m is used to increase the simulation difficulty the bump width is set to 0 2 m which is only half of that value in general cases the bed elevation of the channel is defined by eq 21 as 21 b x 0 2 0 2 x 5 2 x 4 6 m 0 x 4 6 m the inflow velocity in the upstream is 0 435 m s and the outflow depth in the downstream is 0 330 m the numerical resolution of swe sph and ns sph is 0 02 m and 0 01 m respectively the simulation time of the case here is 25 s and fig 13 shows the flow velocities when the system comes into a steady state the comparisons between the numerical results and the analytical solutions of swes indicate that swe sph is capable of predicting the transcritical flows with a hydraulic jump see fig 13 a however if the test case is resimulated using the ns sph model fig 13 d deviations of numerical results between these two models will be discovered around the hydraulic jump behind the bump the reason is that the basic assumptions of swes do not hold true for the local flows around steep topography so that the swe based models fail to handle the violent hydraulic features of velocity distribution and free surface variations an accurate description of the highly nonlinear hydrodynamic phenomenon near the hydraulic jump including water body collapsing water particle splashing and backflow zone can only be achieved using ns equations on the other hand if the whole computational domain is simulated by ns sph most of the cpu power will be wasted on the upstream and downstream channels with slowly varying water levels which actually has been very well described by swe sph hence in this section the ns sph model is applied to simulate the transcritical flow and the hydraulic jump near the bump while the swe sph model is utilized to simulate the rest of the domain meanwhile submodels are hybridized with a two way open boundary coupling scheme to improve the computational efficiency on the premise of computational accuracy and simulation detail fig 14 and fig 15 present the horizontal velocity distributions and the vertical velocity distributions at four sections x 4 5 m 5 5 m 6 2 m and 7 5 m near the hydraulic jump the circles denote the results of ns sph fig 13 d while the solid lines denote the results of the hybrid model fig 13 c figs 14 and 15 show that the proposed hybrid model matches the full scale ns sph model in the corresponding computational domain additionally the computational efficiency of various models is compared in table 1 where n p and t denote the particle number and the cpu time used in case d with full scale ns sph it is indicated that 1 the swe sph cpu time is negligible 2 the hybrid model cpu time is remarkably reduced compared with the full scale ns sph and 3 the cpu time is generally proportional to the used particle number all the aforementioned results have proven that the proposed hybrid sph model reaches the same level of computational accuracy and simulation detail in modeling highly nonlinear hydrodynamic problems compared with the full scale ns sph model while achieving considerable improvement in the computational efficiency 4 2 dam breaking waves runup on a slope dam breaking and wave runup are two classic problems in hydrodynamic simulations which both involve nonlinear water surface evolutions and wetting drying boundaries in this section the two cases are joined to form a test of dam breaking waves runup on a slope which is applied to further verify the performance of the proposed open boundary coupling scheme at the initial state fig 16 a a rectangle water body with a height of 0 25 m and a length of 2 25 m is deployed on a flat bed a solid wall is set on the left of the water body and a 1 10 slope is set at x 3 40 m the water body collapses due to gravity after the simulation starts the breaking wave runs up along the slope and turns the kinetic energy into potential energy as shown in fig 16 b the water front on the slope then slips down and runs toward the offshore side in the form of breaking bores later the water body oscillates between the solid wall and the slope until the mechanical energy is dissipated and the water ultimately calms down on the bed extreme nonlinear water movements e g dam breaking waves and breaking bores transmitting through coupling boundaries are involved in this test case resulting in much larger numerical difficulty than nonbreaking regular wave propagation cases simulated by conventional hybrid sph models even if the two way open boundary coupling scheme is applied the hybrid model is still not robust enough to bear the shock from the breaking waves due to the huge mismatch between the information provided by different submodels hence the modified one way open boundary coupling scheme is utilized in this section to address this challenging problem the coupling boundary is set at x 2 00 m the right side of which is modeled with ns sph while swe sph covers the entire computational domain the computational resolution is 0 005 m and the simulation time is 20 s this test case was also simulated by de leffe et al 2010 using another swe based sph model and the water surface evolutions at x 1 4 m and x 3 4 m were validated with experimental data in this paper two more gauges are deployed on the slope at x 4 0 m and x 4 5 m to compare the performance of various numerical models similar to the case of steady flows over a bump three different numerical models are used here including swe sph hybrid sph and ns sph the free water surface evolutions at 4 gauges are validated in fig 17 and table 2 compares the relative errors between various model results and the experimental data de leffe et al 2010 the relative errors are calculated by eq 22 where h 0 is the initial water depth of 0 25 m generally the numerical results of the three models agree with the experimental data satisfactorily ns sph yields a slightly smaller error than swe sph and the hybrid model yields an equivalent level of error with the other two models there are no experimental data at gauge 3 and gauge 4 while the relative errors between hybrid sph and ns sph at the two gauges are 3 70 and 2 65 respectively indicating good agreement in the prediction of water wave evolutions on the slope 22 ε η a η b 1 n 1 n η a η b h 0 2 the general propagations of breaking waves e g runup on the slope fig 18 a can be well predicted by the swe sph model however due to the limitation of the simplified governing equations the swe sph model cannot provide detailed nonlinear water movements with fractured surfaces e g the breaking bores induced by the water slipping down from the slope fig 18 b the plunging waves on the slope fig 18 c and the undular bores propagating toward the shore fig 18 d in contrast the proposed hybrid model not only inherits the excellent capability of simulating complex hydrodynamics problems from the ns sph model but also improves the computational efficiency remarkably as shown in table 3 the particle number in the hybrid model ranges from 5560 to 22506 during the 20 s simulation and the mean number is approximately 15154 which is only 44 9 of the particle numbers required in ns sph and requiring only 50 9 of the original cpu time in addition to computational accuracy computational efficiency and simulation detail the conservation of system mass is another important performance index that should be considered for hybridization schemes especially in cases with water particles traveling around the coupling boundaries unobstructed mass transportation and qualified conservation of system mass are the key factors in long term simulation the one way open boundary coupling scheme is potentially more likely to lose its balance of system mass compared with a two way scheme fig 19 presents the time evolutions of the system mass during the simulation indicating that the mass of the two submodels fluctuates as the water body oscillates on the bed the total mass of the hybrid model generally remains steady with a mean fluctuation rate of 3 0 the mass fluctuation gradually decreases as the simulation progresses and the total mass converges to the eventual theoretical value considering that only the one way coupling scheme is used in the case that suffers from multiple shocks from the breaking waves the mass conservation performance of this modified one way coupling model is acceptable 4 3 dam breaking waves impacting against a vertical wall another classic case of dam breaking waves impacting against a vertical wall which is often used in the simulation of tsunami or green water is applied in this section to validate the force calculation of hybrid sph model as shown in fig 20 a a rectangle water body with a height of 0 60 m and a length of 1 20 m is deployed on the left part of a water tank with a length of 3 22 m at the initial state the dam breaking waves run downstream along the flat bed and impact against the vertical wall on the right side of the tank then the waves are reflected and propagate backward with violet and breaking free surface similar to the dam breaking case in section 4 2 the one way open boundary coupling scheme is also used here with a coupling boundary at x 1 00 m the entire computational area is modeled by swe sph while the ns sph only calculates right part of the tank the test case is also modeled with ns sph as comparisons for the hybrid sph results the particle resolution of both hybrid sph model and ns sph model is set as 0 005 m the laboratory experiment of this dam breaking case was conducted by buchner 2002 and the impacting force on the vertical wall was measured by two pressure sensors which were located at p1 3 22 m 0 16 m and p2 3 22 m 0 584 m respectively four water level gauges were also deployed at x 2 725 m 2 228 m 1 73 m and 0 6 m to measure the free surface evolutions the pressure evolutions of p1 and p2 by hybrid sph model and ns sph model are presented in fig 21 the numerical results are shifted by 0 327 s to compare with experimental data buchner 2002 the two peak type pressure evolutions at p1 is well simulated by sph models and the peak values are generally satisfactory the pressure at p2 is mainly the result of hydrostatic pressure which is also well predicted owing to the accurate calculation of water front uprising the pressure results given by hybrid sph model and ns sph model generally match with each other indicating that the coupling scheme has acceptable error on the force calculation snapshots of pressure fields solved by hybrid sph model at t 1 24 s and t 1 82 s are also provided in fig 22 where fluid particles in ns sph model are color mapped and free surface particles in swe sph model are presented with black solid circles the free water surface evolutions at four gauges are validated in fig 23 which shows a good match between the numerical results and experimental data before the reflected waves arrive at the gauges around t 2 0 s since multiple water air interfaces are formed due to the plunging waves and the top surface is detected as the free water surface the numerical water levels of h1 h2 and h3 during t 1 7 s 2 5 s are unauthentic and they are generally larger that experimental data after the water movement gradually calms down the numerical results and the experimental data agree with each other again 4 4 standing waves a simple standing wave flume with a length of 2l 5 00 m and water depth of d 0 4 m is simulated as the last case in this paper to evaluate the energy conservation performance in long term run using hybrid sph model with one way open boundary coupling scheme the computational domain of swe sph covers the entire flume while ns sph calculates the domain from x l to x 2l as shown in fig 24 regular waves with wave period t 1 45 s wave height h 0 04 m and wave length l 2 50 m are generated on the left part of the flume using an open boundary wave generation algorithm ni et al 2016 the incident waves propagate through the coupling open boundary and get reflected by the vertical wall at x 2l then standing waves are induced due to the interaction between the reflected waves and the incident waves this case runs for 15 wave periods with particle resolution of 0 01 m fig 25 shows the free water surface evolutions at x d 0 l 4 l 2 and 3l 4 respectively where x d denotes the distance from the targeted section to the vertical wall the water levels vary in a simple harmonic pattern with wave heights of 2h at the antinodes of standing waves x d 0 and x d l 2 as predicted by analytical solutions while water surface almost remains steady at the first node from the vertical wall fig 25 b the water surface at the second node from the vertical wall fig 25 d varies in a regular pattern probably due to the influence of skew waves which propagate from swe sph and has been discussed in section 3 nevertheless the skewness vanishes after waves propagate in ns sph as shown in fig 26 while fig 27 provides pressure field snapshots of the standing waves during one wave period this standing wave case also indicates that energy conserves satisfactorily in the proposed hybrid sph numerical wave flume which is not only robust in long term run but also remains a steady mean water level 5 conclusions this work proposes a two way open boundary coupling scheme and a modified one way open boundary coupling scheme based on a nonreflective fobc to hybridize a swe sph model with a ns sph model the ns sph model is used to present the nonlinear hydrodynamic features in the concerned areas while the rest of the areas are simulated with the swe sph model which calculates much faster than the former model the hybridization performance on the information transmitting mass and energy conservation simulation detail computational accuracy computational efficiency and computational convergence speed is evaluated and discussed using five test cases including solitary wave propagations steady flows over a bump dam breaking waves runup on a slope dam breaking waves impacting against a vertical wall and standing waves it is indicated that the proposed open boundary coupling schemes are capable of improving the computational efficiency on the premise of computational accuracy and simulation detail the information transmitting and the conservation of system mass are both satisfactory it should be noted that the open boundary condition in this paper is implemented based on the buffer zone techniques which basically assume that there is only one water surface at a given section thus cases with multiple surfaces e g wave breaking at the open boundary are technically not properly treated numerical unstable issues may also occur when where is a strong vortex across the open boundary more advanced open boundary techniques ferrand et al 2017 for the sph method are expected to be applied to further improve the hybridization robustness and the simulation accuracy for violent hydrodynamic conditions additionally well developed grid based models e g funwave swash and openwave3d etc which are governed by nonlinear shallow water equations or boussinesq equations can also be coupled with ns sph using the proposed scheme and be applied to model the water movements in the offshore areas and provide a better simulation of the nonlinear wave propagation process from the offshore to the nearshore acknowledgements this work is supported by the national natural science foundation of china no 51809238 and no 51779228 the fundamental research funds for the central universities no 2019b06514 and the scientific research program of zhejiang institute of hydraulics estuary no a17001 the authors wish to thank the anonymous reviewers for their constructive comments 
22208,a numerical model is employed here to study seiche oscillations of layered or stratified fluids in a closed rectangular tank under various initial inclination angles of the free surface and interfacial layers to the normal water table as seiche setup conditions laboratory experiments were also conducted for layered sloshing in a rectangular tank the numerical model was validated against the experimental data and the available numerical results the effect of the setup angle on the maximum interfacial and free surface wave height time series were then studied in relation to their corresponding dominant frequency response the effects of internal structures on the rate of wave decay were analyzed for internal and free surface waves with key findings being reported keywords seiche oscillations sloshing layered fluids interfacial wave wave damping 1 introduction seiche is free fluid oscillations synonymous to enclosed or semi enclosed water bodies in nature initiation is caused by strong wind action during storms which in some cases applies a unidirectional wind pressure load on the water free surface and this pressure pushes the lake water in the direction of the storm thereby increasing the water table on one side creating an inclined free surface once this storm subsides and the applied wind pressure seizes to act the action of gravity causes the fluid to sway in a free sloshing like manner until it reaches equilibrium this action in extreme cases has been known to create waves which cause damage to boats structures and even endanger the lives of humans the multiphase study of this phenomenon considers the modeling of the fluid volume as a composite of two density stratified fluid layers as is the case in lakes which have stratification due to variations water temperature salinity content or impurities the vertical movement caused by internal waves during this process has chemical and biological consequences in lake environments free oscillation or seiche has been widely investigated in water bodies like lakes estuaries and coastal localities thanks to their large impact on circulation flow and bio chemical processes niedda and greppi 2007 lemmin et al 2005 analyzed season long water level records at 12 stations around the lake of geneva for evidence of internal seiches modified by coriolis force niedda and greppi 2007 highlighted that the seiche oscillation is one of the mechanisms responsible for driving residual currents in lagoon jordi et al 2008 described the seiche in mediterranean harbour as the principal mechanism that controls the sediment resuspension and the variability of the suspended sediment using both observations and model simulations qin and lin 2017 developed a gis based integrated framework for coastal seiches monitoring and forecasting system for preliminary predictions of seiche events in the north jiangsu shoal china cueva et al 2019 presented an analysis of the natural frequencies and vibration modes of the structure of the superficial seiches of lake chapala using mathematical modelling and measurements their results provided the spatial distribution of lake water level oscillations for seiche periods de jong and battjes 2004 identified the main mechanism of the generation of seiches in the port of rotterdam and investigated the seiche characteristics chen 2005 assumed that there is no wind acting on the free surface and investigated seiche oscillation in a rectangular basin caused by a sinusoidal form initial free surface by using a 3d nonhydrodynamic model named less3d lake and estuary simulation system in three dimensions ahn 2008 studied the seiche wave formation in deep and shallow water waves their work was able to estimate the velocity of gravity waves in the transition region between deep and shallow water waves bukreev et al 2013 studied the seiche oscillation in a rectangle channel with an abrupt expansion of the cross section in their study they investigated the natural frequencies of the seiche oscillation in a rectangular cross section experimentally and numerically bowers et al 2013 concluded that the tide forcing a shallow coastal water body can produce an oscillation at the natural period of the water body namely seiche which mean that a shallow water body zhang et al 2018 appears to be a necessary requirement for the production of tide produced seiches cushman roisin et al 2005 studied the influence of water stratification on decaying surface seiche modes they concluded that in enclosed water bodies such as lakes in which external seiches are standing waves their period is weakly dependent on the stratification in semi enclosed systems such as bays and coastal seas from which surface gravity waves can radiate into the open ocean the external seiche period is a more sensitive function of stratification seiche oscillation is very closely related to the sloshing phenomenon in tanks that contain a fluid with a free surface a close look at sloshing thus gives a basis of understanding the similarities to seiche oscillations and in favor of proposing how this could be used to study seiche occurrence faltinsen and timokha 2009 and ibrahim 2015 are good sources which could broaden the readers understanding on free surface sloshing seibi and perez 2007 described the setting up of a test rig to study liquid sloshing including a data acquisition system lin 2007 developed a model to simulate fluid sloshing in a horizontally excited tank with different excitation frequencies and the numerical results compared well with the established analytical results vorobyev et al 2011 simulated centralized sloshing with a central water column collapsing within the confines of a cylindrical tank smoothed particle hydrodynamics sph simulation on large amplitude sloshing for fluids in a 2d tank was studied by wang et al 2013 in their results they deduced that the sph method was very effective for solving nonlinear sloshing as well as for violent fluid sloshing and wave breaking aly et al 2015 used a stabilized incompressible sph method in pressure calculations in a highly nonlinear sloshing problem luo et al 2016 and luo and koh 2017 studied the 3d sloshing in a scaled membrane type lng tank numerically and experimentally sivý et al 2017 studied fluid structure interaction in a sloshing tank by dividing the liquid mass into impulsive and convective zones they aimed to deal with the seismic design of open cylindrical liquid storage tanks xue et al 2017a proposed a finite difference model for studying violent transient sloshing and considering turbulence the numerical modeled matched well with an experimental case and results accounted well for strong nonlinearity chen and xue 2018 studied the effect of different filling levels excitation frequency and amplitude on sloshing by using openfoam and validating their model via experimental data jin and lin 2019 studied the viscous effect of liquid sloshing under external excitation they adopted a 3d two phase flow model to study sloshing of a highly viscous fluid and validated against available analytical solutions and numerical results xue et al 2019 carried out fluid dynamics analysis of sloshing pressure distribution in storage vessels of different shapes effects of the baffles or obstacles on free surface wave are widely reported which can dissipate wave energy by multiple damping mechanisms xue and lin 2011 jung et al 2012 studied effect of vertical baffle heights on sloshing in their study vortexes were seen to develop in the vicinity of the baffle tip as it damps the energy in the fluid xue et al 2012 conducted sloshing studies in relation to the effect of perforated baffles in a cubic tank their study highlighted the baffles effect on damping impact pressure on the tank walls koh et al 2013 studied a novel sloshing mitigation device i e the constrained floating baffle based on the improved consistent particle method xue et al 2013a studied the effect of perforated baffles on reducing sloshing in a rectangular tank with an experimental setup and compared results with an in house numerical wave tank model newtank xue et al 2017b experimentally studied the effect of different vertical baffle configurations in reducing sloshing pressure under various excitation frequencies this study gave a detailed insight on the effectiveness of baffles in reducing sloshing pressure yu et al 2019 studied the use of a vertical slat screen in reducing in shallow water sloshing in a tank this study showed that sloshing damping does not always increase with an increase in the screen number but is also dependent on the position of the screen xiang et al 2019 analyzed the wave clipping effects of artificial islands in plain reservoir by employing mike21 sw model they concluded that artificial islands at suitable locations in the reservoir can attenuate the wave heights by approximately 10 30 the study of layered sloshing can also throw light on layered seiche oscillations a couple of studies have been conducted in the past that deal with a layered fluid sloshing in a closed tank kargbo et al 2019 looked at the effect of layered sloshing and internal wave interaction on submersed structures this study showed that internal wave progression is affected by internal structures with interfacial waves being higher than the corresponding free surface wave veletsos and shivakumar 1993 conducted studies on layered sloshing considering n layers and their study stated that for n number of homogeneous layers there are an n number of horizontal natural modes la rocca et al 2002 conducted theoretical studies on layered sloshing using a variational form of the potential formulation of the fluid motion and in his study was able to account for the effects of dissipative forces sciortino et al 2009 used a hamiltonian approach to study layered sloshing in a cylindrical tank and was able to analyze the traveling waves created during sloshing ishiyama et al 2013 looked at how a magnetic fluid affected layered sloshing their study discovered that the magnetic field altered the natural frequency and the pressure exerted by the fluid on the tank walls in general studies on seiche in lakes have been able to improve on the general understanding of seiche oscillations in nature and the developments in sloshing analyses have bolstered our understanding on this phenomenon this work however looks at how seiche oscillations could be developed numerically for single and layered cases and how the setup affects the oscillation how layered seiche oscillations and interfacial waves interact with damping structures is also an area which this study seeks to add further understanding on 2 mathematical model and numerical method 2 1 governing equation the incompressible navier stokes equation governs the fluid domain 1 ρ u t ρ u u p i μ u u t f 2 u 0 the velocity is given by u with the pressure given by p whereas the fluid density is given by ρ the dynamic viscosity and the body force are given by μ and f respectively with the unit diagonal matrix represented by i 2 2 numerical method in this study the fluid domain of the model is represented by the incompressible navier stokes equation with the ale method being employed to track the fluid interface deformations this model is based on the finite element method fem and is developed using the cfd module of comsol for the convenience of the following discussions the time item of the momentum equation is ignored for the time being and the body force is set to zero therefore the steady laminar equations in the domain ω with non slip and zero normal stress conditions on the domain boundaries γ 0 and γ n respectively in component form are 3 ρ u j u i j p i μ u i j u j i j in ω u i j 0 in ω u i 0 on γ 0 p n i μ u i j u j i n j 0 on γ n a test function v i is selected from the momentum equation and in such v i 0 on γ 0 where as a test function z is chosen in the case of the continuity equation the continuity and momentum equations and are multiplied by a test function and integrated over the domain 4 ρ ω u j u i j v i d v ω p i v i d v μ ω u i j u j i j v i d v ω u i i z d v 0 integration by parts applied to the pressure and vicious term yields 5 ω p i v i d v γ n p n i v i d s ω p v i i d v ω u i j u j i i v i d v μ ω u i j u j i n j v i d s μ ω u i j u j i v i j d v 6 μ γ n u i j u j i n j v i d s μ 2 ω u i j u j i v i j v j i d v the sum from the boundary terms from equations 5 and 6 give zero stress boundary condition integral 7 γ n p n i v i d s μ γ n u i j u j i n j v i d s γ n p n i μ u i j u j i n j v i d s 0 putting expressions 5 7 back in the integral expression 4 gives the final variational form 8 ρ ω u i u i j v i d v ω p v i i d v μ 2 ω u i j u j i v i j v j i d v 9 ω u i i z d v 0 for solving the unsteady flow it is noted that the time item should be added to equation 8 also all the mentioned formulations are already implanted within this software the non slip boundary condition on γ 0 is enforced explicitly on the fem functions with appropriate selection of the function space the zero normal stress boundary condition on γ n is implicitly enforced through the variational form p1 p1 discretization which apply separate discretization for the velocity and pressure is done using the continuous piecewise linear elements for both variables further details on the comsol solver equations can be obtained from the comsol users guide multiphysics comsol 1998 and the reference kargbo et al 2019 2 2 1 boundary conditions the model consists of solid walls and a free surface the slip boundary for the navier stokes equation is 10 u n 0 where n nx ny t is the boundary normal equation 10 is applied to the walls which are modeled with slip boundary condition the normal vector is dependent on the degrees of freedom of the moving mesh hence weak constraints are used to remedy constraining forces on the fluid equations and mesh weak constraints are used to enforce the slip boundary condition without a constraint force acting on the moving mesh equations 11 λ ˆ u n λ u ˆ n for some lagrange multiplier variable λ where λ ˆ and u ˆ denote test functions the fluid is free to move in the top boundary neglecting the stress in the surrounding environment the stress continuity equation on the free surface is given by 12 p i μ u u t n p 0 n where p 0 is the surrounding pressure and μ is the viscosity of the fluid without loss of generality p 0 0 for this model 2 2 2 boundary condition for mesh to follow the fluid motion in relation to the mesh motion it is conventional in most cases to couple the mesh motion to the fluid motion normal to the surface the coupling is not done in the tangential direction as it will soon lead the solution to non convergence due to excessive deformation of the mesh the boundary condition for the mesh on the free surface is thus given by 13 x t y t t n u n where n is the boundary normal to x t y t t the velocity mesh for this boundary condition with the weak constraints activated the moving mesh interface adds the weak expression 14 λ ˆ x t y t t u n λ χ ˆ y ˆ t n this is added to ensure that there are no constraint forces acting on the fluid equations the moving mesh is not constrained in the tangential direction on the side wall at the side to enable it to follow the motion of the fluid here again λ denotes some lagrange multiplier variable not the same as before and x ˆ y ˆ and λ ˆ denote test functions 2 2 3 free surface and interfacial surface tracking method the free surface boundaries of the computational domain are moving and deformed with time as a result of the motion and physical parameters of the computational domain the motion of this free surface is tracked by a deformed moving mesh which moves in conformity with the deformation computation domain with a new mesh being generated for each configuration of the boundaries this technique of movement which is also referred to as the arbitrary lagrangian eulerian ale method is used to track the free surface of this model consider a mesh at time t n the velocity field is computed for the time t n 1 on this same mesh the new free surface is then computed with the lagrangian formula 15 x n 1 x n u δ t the partial differential equation governing the displacement field of the mesh is given by 16 d i v σ 0 the cauchy stress tensor is σ the mass of the fluid is considered in the domain and as such the mesh is considered as incompressible we consider a linear elasticity model given by the constitutive relation 17 σ c ε the constitutive matrix c is element dependent the constitutive matrix elements are also inversely proportional to the element size in order to solve the mesh equation eq 15 for free surface boundary conditions it is assumed that no fluid particle can cross the free surface this condition is expressed by setting the normal mesh velocity at the free surface equal to the normal fluid velocity 18 v v m e s h n 0 the fluid velocity is given by v is and n is the unit normal vector the above mentioned free surface tracking method is also employed to track the interfacial surface 3 model validation 3 1 mesh convergence mesh convergence analysis was done for the tank setup described in fig 1 the mesh parameters were categorized into fine normal and coarse with the specifications of each mesh as described by table 1 the movement equation of the tank is x t a c o s ω t with excitation amplitude of a 0 01m and frequency of ω 5 15 rad s the mesh categories described in table 1 were used to conduct error analysis the normal mesh was used a reference mesh and compared to the coarse and fine mesh by plotting error bars as shown in fig 2 for coarse mesh error and fine mesh error respectively from the convergence plots it is seen that the fine mesh and the normal mesh had a strong similarity the coarse mesh also had satisfactory comparisons with the normal mesh for computational time saving purposes the normal mesh was chosen throughout this study time step analysis was also done to see the model s response to various time steps time step values of time step used were 0 1s 0 01s and 0 001s a rectangular tank described in fig 1 was used the movement equation of the tank is x t a c o s ω t with amplitude of a 0 01m and frequency of ω 5 15 rad s from the results show in fig 3 a and fig 3 b for interfacial and free surface respectively it is seen that for the time steps used the difference in result was very minimal for computational purposes a time step of 0 01s was used 3 2 layered sloshing in a rectangular tank the numerical model was further compared to laboratory experiments of two layers sloshing conducted at state key laboratory of hydraulics and mountain river engineering sichuan university xue et al 2013b the test system including experimental photograph and layout of the sensors is shown in fig 1 the details are also found in previous work xue and lin 2011 the test system consisted of a layered fluid in a rectangular tank an irregular wave maker three wave gauges three pressure sensors one displacement sensor and data acquisition system the tank motion is controlled by an irregular wave maker the tank with length l 0 57m was filled with two immiscible fluids 0 diesel oil and tap water their densities are ρ 1 846 2 k g m 3 and ρ 2 1000 k g m 3 respectively the height of two layers fluids with density ρ 1 and ρ 2 are h ρ 1 0 05 m and h ρ 2 0 1 m respectively three wave gauges and three pressure sensors were mounted on the rectangular tank as shown in fig 1 b the movement function of the shake table controlled by the irregular wave maker is given by 19 x t a c o s ω t where a is 0 01m with various excitation frequencies being ω 4 24 r a d s ω 5 15 r a d s the comparison of the layered sloshing in a rectangular tank of the experimental results to the numerical simulation is shown in figs 4 5 for the interfacial wave elevation time series and in fig 6 for the pressure time series as shown in figs 4 and 5 the results from the probe 1 were under predicted by the numerical model the possible reason is that in the experiments the wave probe 1 is not strictly in the center of the tank where the wave amplitude is very small and the wave amplitude is sensitive to position fortunately the numerical results from the wave probes near the tank walls probe 2 and probe 3 and the pressure sensors match well with the experimental data moreover the experimental snapshots and numerical profiles of the layered profile at various moments are presented in fig 7 it is noted that the higher frequency interfacial waves were not captured numerically due to neglecting the effect of surface tension at the interfacial surface in numerical model but nonetheless the agreement between the numerical results and experimental data was also satisfactory indicating that the model employed here is a robust tool for simulating layered fluids sloshing problem 3 3 liquid sloshing in a tank with vertical baffles a vertical baffled tank model was setup as shown in fig 8 and compared for validation with numerical results from belakroum et al 2010 who investigated effect of the baffles on passive reducing sloshing in rectangular tanks partially filled with liquid the tank has a length l of 0 9m and a liquid filling level h of 0 6m in case 1 the height of the bottom mounted baffle is 0 3m and is placed at the bottom center of the tank and in case 2 the height of the vertical baffle is 0 075m and is placed near the free surface as is seen in fig 8 the tank motion is subjected to the following sinusoidal function 20 x t a sin ω t where the amplitude is a 0 00198m and the excitation frequency is ω 5 4 rad s fig 9 shows the present results of the free surface elevation time history at the left wall compared well with the available numerical results from belakroum et al 2010 however slight discrepancy in amplitude and slight phase lag is observed in the comparisons due to considering the impulse acceleration in present simulations overall the present results however are in a satisfactory agreement with the available numerical results moreover fig 9 a and b indicates the temporal evolution of the free surface elevations at the left wall after installing the vertical baffle placed at the bottom of the tank and near the free surface respectively it can be observed obviously that the vertical baffle near free surface is more effective in reducing sloshing amplitude than the vertical baffle mounted on the bottom of the tank although its length is only one quarter of the vertical baffle on the bottom 4 single layer induced seiche oscillations in a rectangular tank 4 1 model setup to replicate the seiche setup phenomenon and action as observed in lakes and enclosed water bodies a case is setup with an initially inclines free surface as shown in fig 10 with a closed tank of dimensions and fluid domain surface area as described in table 2 no motion excitation amplitude and frequency were applied to the system to initiate sloshing but the fluid motion is caused by gravity acting on the initially inclined fluid surface on the commencement of the simulation for the assumption of a flat bottom the characteristic period t of a barotropic seiche is given by 21 t 2 l m g h where m 1 2 3 l is the length of the water basin h h 1 h 2 2 is the water depth and g is the gravitational acceleration niedda and greppi 2007 four case studies are modeled as shown in table 2 namely case 1 case 2 case 3 and case 4 respectively as is seen in table 2 the volume of the fluid is kept constant for all cases with changes only being made to the inclination angle of the free surface the area of the trapezium shown in table 2 is considered for the 2d setup of the fluid domain 4 2 wave time series and spectral analysis for single seiche oscillations as shown in fig 10 free surface wave heights were recorded on the right and left tank walls as c1 and c2 respectively seiche setup was modeled with different free surface inclination angles and at the commencement of the simulation the fluid mass can oscillate under gravity till it reaches equilibrium as observed in the free surface time series shown in figs 11 14 the inclination angle was developed using the details and dimensions of the four cases studied as given in table 2 to alter the inclination angle of the free surface the height of h2 in the tank setup was varied giving free surface inclinations related to h2 0 115m 0 125m 0 145m and 0 165m with their respective sloshing wave time series being plotted in figs 11 14 respectively as well as their respective fast fourier transform fft a fft provides a power spectral analysis technique of the time series and enables the natural or peak frequencies of the system to be identified from the fft diagrams high frequency components at high inclined fluid surface conditions can be observed this may be due to the rapid descending of the inclined fluid surface under gravity which may cause fast oscillation of fluid particles in the process meanwhile a typical nonlinear wave phenomenon i e the wave crest becomes sharper and the trough becomes flatter with larger inclination angle is obviously observed in fig 15 indicating that wave wave interactions are enhanced by increasing inclination angle more high frequency components are thus observed in figs 12 14 the free surface time series showed that at the initial commencement of the simulation the fluid sloshed from side to side with wave heights decreasing as the time progresses until equilibrium is obtained figs 11 14 shown that the higher h2 values the sloshing fluid had higher wave heights and took longer to reach equilibrium this can be seen obviously in fig 14 where h2 0 165m and the free surface wave time series is seen to have higher wave heights as compared to the other cases studied in figs 11 13 lowest wave heights for all the cases studied is observed when h2 0 115m as shown in fig 11 a comparative analysis shown in fig 15 compares all cases for values of h2 0 115m 0 125m 0 145m and 0 165 m at right and left tank walls by wave gauges c1 and c2 respectively this further shows that at higher values of h2 or inclination angle is associated with higher wave heights and longer sloshing time of the free surface before it reaches equilibrium power spectral analysis for single layer seiche under setup as described by fig 10 and table 2 is plotted for various initial free surface inclination angles for h2 0 115m 0 125m 0 145m and 0 165m as shown in figs 11 14 the frequency analysis was done for wave heights at c1 and c2 and it is observed that the peak frequency values at c1 and c2 were similar in value this can be seen in fig 11 where the peak frequency is given as 0 93 hz which is around the first order natural frequency calculated by equation 21 for h2 0 125m the peak frequency is also given as 0 93 hz as seen in fig 12 as h2 is increased to h2 0 145m as shown in fig 13 thereby increasing the free surface inclination angle the peak frequency is given as 0 96 hz which showed a slight increase from the previous h2 values of figs 11 and 12 it is also observed that for h2 0 165m the peak value is around 0 96 hz which is very close to the peak frequency when h2 0 145m from the spectral analysis it can be summed that for the same filling levels or for a certain volume of fluid the natural or peak frequency is not significantly altered by varying the inclination angle of the free surface 4 3 comparison of velocity profile of seiche oscillations under various initial free surface inclination angle velocity screen shots were taken for seiche initiated sloshing under four different initial free surface inclination angles the free surface inclination angles were given by h2 0 115m 0 125m 0 145 m and 0 165m as is seen in fig 16 from the screen shots the fluid is seen to slosh from side to side for all h2 heights the velocity distribution varied for all inclination angles with one notable observation being that for higher h2 values a higher maximum velocity of the fluid domain is observed and this can clearly be seen at t 1 3s this showed that an increase in inclination angle caused an increase in the fluid velocity as it sloshes from side to side interesting velocity distributions can be observed at certain time frames at t 2 77s it is seen that the screen shot for h2 0 115m has a velocity distribution characteristic of central larger and surrounding smaller with compared to the other cases of h2 0 125m 0 145m and 0 165m i e the fluid velocity is concentrated in the center with higher velocity in the center being encircle by lower velocity distribution whereas the maximum velocity concentration is closer spread out and closer to the free surface for the other values of h2 similar interesting velocity differences can be observed at t 5 79s where for all values of h2 each had a uniquely different velocity distribution profile at this time frame 5 two layered induced seiche oscillations in a rectangular tank 5 1 model setup a setup was developed to study multiphase or layered seiche comprising of two immiscible fluids in a closed tank as is seen in fig 17 the tank and domain dimensions are as described by table 2 two cases were setup for studies with an inclined layered fluid domain for an unbaffled and central mounted vertical baffles case as in described in fig 17 this analysis is done for cases with and without a baffle using the cases as describe in table 2 with the four cases shown in the table being developed with a second fluid layer 2 having a height of h3 being placed on top and parallel to the bottom fluid as shown in fig 17 5 2 wave time series and spectral analysis for two layered seiche oscillations time series graphs are shown for the interfacial and free surface evolution for layered seiche together with their corresponding power spectral analysis it is seen that the baffles had an effect in reducing the interfacial and free surface wave displacement height as well as bringing the sloshing fluid to attain equilibrium in a shorter time thereby speeding up the creation of a still fluid surface this can be seen in fig 18 which shows seiche sloshing for the interfacial and free surface layer for h2 0 165m for cases with and without a baffle in fig 18 the interfacial and free surface wave interacting with a baffle is seen to quickly reach equilibrium with lesser sloshing heights as compared to the same case without a baffle this can be further observed in fig 24 which shows screen shots of the velocity profile of the seiche for various initial inclination angles this is also seen in for other initial inclination angles of the free surface the baffled cases can also be seen to have significant second peak frequencies values with high amplitudes as compared to the unbaffled case where in the first peak frequency is significantly higher than the second peak frequency this can be seen in the fft of figs 18 20 it is seen that the first sloshing cycle attains the highest maximum wave height with subsequent wave heights reducing gradually till the initial and free surface attain equilibrium with a still fluid table as the initial inclination angle of the free surface is reduced the fluid attains lower maximum wave heights and reaches equilibrium much faster as is seen in fig 20 for h2 0 125m corresponding power spectral analysis of the interfacial and free surface wave time series are presented for both baffled and unbaffled cases in fig 18 for h2 0 165m it is seen that the baffle split the peak frequency without baffle into two dominant response frequencies in fig 18 for the internal or interfacial wave the peak frequency is given as 0 99 hz for unbaffled case of the interfacial waves and 0 92 hz and 1 64 hz when a baffle is used it is also seen that the third peak frequencies have very small amplitudes when compared to the peak frequencies when considering the unbaffled cases similarly for the free surface the baffle split the same peak frequency of 0 99 hz into two dominant frequencies 0 88 hz and 1 60 hz this can be also observed in figs 19 and 20 for the cases without and with the baffle under various initial free surface inclination angles moreover it was observed that effect of the baffle on frequency domain of the free surface elevation time series was different from that of the internal wave elevation the spectral density analysis mainly shows the energy distribution in frequency domain this also shows a relation between the inclination angle and the two layer fluids energy distribution in frequency domain however the fluids energy distribution in time was not observed by using fft method wavelet transform which is a time frequency analysis method can provide local information and therefore may be viable to identify the time frequency characteristics of the time series of free surface and interfacial wave ma et al 2010 tai et al 2019 in figs 21 23 wavelet spectrum are shown for the time series for h2 0 125m 0 145m and 0 165m respectively which obviously exhibits the energy distribution of external wave and internal wave in different frequencies and its variation over the time 5 3 effect of the baffles on velocity profile of seiche oscillations the seiche oscillations for h2 0 165m for cases with and without a vertical baffle were compared with results of the velocity screen shots shown in fig 24 the effect of the baffle on the oscillation was desired to be observed for the highest h2 value covered in this study to observe how high inclination angle of the free and interfacial surfaces interact with and without internal structures such as baffles the velocity distribution obviously varied for the case with a baffle when compared to that for the unbaffled case for the baffled case obvious vortex shedding can be observed near the tip of the baffle which in turn might dissipate fluid energy as opposed to the case without a baffle this can be clearly observed in fig 24 at t 1 62 s this same observation can be deduced for the other time frames of fig 24 at t 1 62 s and 2 77 s it can be observed that the baffled case created interfacial wave high frequency oscillation and an upward interfacial wave displacement just above the baffle position this displacement is not observed for the unbaffled case the baffle here is seen to interrupt with the hydrodynamic flow path of the fluid with particular effects been observed on the interfacial wave 6 conclusions an incompressible navier stokes solver for simulating seiche phenomena was built based on the cfd module of comsol with the interface being tracked by the arbitrary lagrangian eulerian ale method laboratory experiments of layered sloshing in a rectangular tank were conducted to validate the present numerical model good agreements are obtained for the interfacial wave elevations and the pressures between the numerical results and the experimental data non layered and layered seiche was simulated by using the present numerical model time series plots of the interfacial and free surface wave were plotted as well as their corresponding fft to identify their dominant response frequency of the seiche oscillation system it showed that conditions of the wave setup influence the maximum elevation of the free surface and interfacial wave higher setup in inclination angles or heights created higher maximum wave height oscillations as well as longer wave decay time the dominant response frequency values observed through the fft were not greatly affected by the inclination angle with peak frequency values being mostly the same for all inclination angles for the constant fluid volume used in this study which were also around the natural frequencies calculated theoretically the maximum wave height was dependent on the inclination angle with lower inclination angle recording lower maximum wave height values higher velocity values were observed in the fluid domain for higher initial inclination angle values or setup height at any given time the effect of internal baffles on layered seiche oscillation was also studied with the internal baffles seen to greatly reduce the wave heights for both surface and interfacial waves the baffles accelerated the wave decay for both free surface wave and interfacial wave and also affected the dominant response frequencies of the seiche oscillations the influence of the baffle on interfacial wave and free surface wave is different interfacial wave high frequency oscillation near the baffle tip was observed at special time declaration of competing interest the authors declare no conflict of interest acknowledgements this work is supported by the national natural science foundation of china no 51679079 the fundamental research funds for the central universities china no 2018b12814 the national science found for distinguished young scholars no 51425901 and the program for excellent innovative talents of hohai university china appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106842 
22208,a numerical model is employed here to study seiche oscillations of layered or stratified fluids in a closed rectangular tank under various initial inclination angles of the free surface and interfacial layers to the normal water table as seiche setup conditions laboratory experiments were also conducted for layered sloshing in a rectangular tank the numerical model was validated against the experimental data and the available numerical results the effect of the setup angle on the maximum interfacial and free surface wave height time series were then studied in relation to their corresponding dominant frequency response the effects of internal structures on the rate of wave decay were analyzed for internal and free surface waves with key findings being reported keywords seiche oscillations sloshing layered fluids interfacial wave wave damping 1 introduction seiche is free fluid oscillations synonymous to enclosed or semi enclosed water bodies in nature initiation is caused by strong wind action during storms which in some cases applies a unidirectional wind pressure load on the water free surface and this pressure pushes the lake water in the direction of the storm thereby increasing the water table on one side creating an inclined free surface once this storm subsides and the applied wind pressure seizes to act the action of gravity causes the fluid to sway in a free sloshing like manner until it reaches equilibrium this action in extreme cases has been known to create waves which cause damage to boats structures and even endanger the lives of humans the multiphase study of this phenomenon considers the modeling of the fluid volume as a composite of two density stratified fluid layers as is the case in lakes which have stratification due to variations water temperature salinity content or impurities the vertical movement caused by internal waves during this process has chemical and biological consequences in lake environments free oscillation or seiche has been widely investigated in water bodies like lakes estuaries and coastal localities thanks to their large impact on circulation flow and bio chemical processes niedda and greppi 2007 lemmin et al 2005 analyzed season long water level records at 12 stations around the lake of geneva for evidence of internal seiches modified by coriolis force niedda and greppi 2007 highlighted that the seiche oscillation is one of the mechanisms responsible for driving residual currents in lagoon jordi et al 2008 described the seiche in mediterranean harbour as the principal mechanism that controls the sediment resuspension and the variability of the suspended sediment using both observations and model simulations qin and lin 2017 developed a gis based integrated framework for coastal seiches monitoring and forecasting system for preliminary predictions of seiche events in the north jiangsu shoal china cueva et al 2019 presented an analysis of the natural frequencies and vibration modes of the structure of the superficial seiches of lake chapala using mathematical modelling and measurements their results provided the spatial distribution of lake water level oscillations for seiche periods de jong and battjes 2004 identified the main mechanism of the generation of seiches in the port of rotterdam and investigated the seiche characteristics chen 2005 assumed that there is no wind acting on the free surface and investigated seiche oscillation in a rectangular basin caused by a sinusoidal form initial free surface by using a 3d nonhydrodynamic model named less3d lake and estuary simulation system in three dimensions ahn 2008 studied the seiche wave formation in deep and shallow water waves their work was able to estimate the velocity of gravity waves in the transition region between deep and shallow water waves bukreev et al 2013 studied the seiche oscillation in a rectangle channel with an abrupt expansion of the cross section in their study they investigated the natural frequencies of the seiche oscillation in a rectangular cross section experimentally and numerically bowers et al 2013 concluded that the tide forcing a shallow coastal water body can produce an oscillation at the natural period of the water body namely seiche which mean that a shallow water body zhang et al 2018 appears to be a necessary requirement for the production of tide produced seiches cushman roisin et al 2005 studied the influence of water stratification on decaying surface seiche modes they concluded that in enclosed water bodies such as lakes in which external seiches are standing waves their period is weakly dependent on the stratification in semi enclosed systems such as bays and coastal seas from which surface gravity waves can radiate into the open ocean the external seiche period is a more sensitive function of stratification seiche oscillation is very closely related to the sloshing phenomenon in tanks that contain a fluid with a free surface a close look at sloshing thus gives a basis of understanding the similarities to seiche oscillations and in favor of proposing how this could be used to study seiche occurrence faltinsen and timokha 2009 and ibrahim 2015 are good sources which could broaden the readers understanding on free surface sloshing seibi and perez 2007 described the setting up of a test rig to study liquid sloshing including a data acquisition system lin 2007 developed a model to simulate fluid sloshing in a horizontally excited tank with different excitation frequencies and the numerical results compared well with the established analytical results vorobyev et al 2011 simulated centralized sloshing with a central water column collapsing within the confines of a cylindrical tank smoothed particle hydrodynamics sph simulation on large amplitude sloshing for fluids in a 2d tank was studied by wang et al 2013 in their results they deduced that the sph method was very effective for solving nonlinear sloshing as well as for violent fluid sloshing and wave breaking aly et al 2015 used a stabilized incompressible sph method in pressure calculations in a highly nonlinear sloshing problem luo et al 2016 and luo and koh 2017 studied the 3d sloshing in a scaled membrane type lng tank numerically and experimentally sivý et al 2017 studied fluid structure interaction in a sloshing tank by dividing the liquid mass into impulsive and convective zones they aimed to deal with the seismic design of open cylindrical liquid storage tanks xue et al 2017a proposed a finite difference model for studying violent transient sloshing and considering turbulence the numerical modeled matched well with an experimental case and results accounted well for strong nonlinearity chen and xue 2018 studied the effect of different filling levels excitation frequency and amplitude on sloshing by using openfoam and validating their model via experimental data jin and lin 2019 studied the viscous effect of liquid sloshing under external excitation they adopted a 3d two phase flow model to study sloshing of a highly viscous fluid and validated against available analytical solutions and numerical results xue et al 2019 carried out fluid dynamics analysis of sloshing pressure distribution in storage vessels of different shapes effects of the baffles or obstacles on free surface wave are widely reported which can dissipate wave energy by multiple damping mechanisms xue and lin 2011 jung et al 2012 studied effect of vertical baffle heights on sloshing in their study vortexes were seen to develop in the vicinity of the baffle tip as it damps the energy in the fluid xue et al 2012 conducted sloshing studies in relation to the effect of perforated baffles in a cubic tank their study highlighted the baffles effect on damping impact pressure on the tank walls koh et al 2013 studied a novel sloshing mitigation device i e the constrained floating baffle based on the improved consistent particle method xue et al 2013a studied the effect of perforated baffles on reducing sloshing in a rectangular tank with an experimental setup and compared results with an in house numerical wave tank model newtank xue et al 2017b experimentally studied the effect of different vertical baffle configurations in reducing sloshing pressure under various excitation frequencies this study gave a detailed insight on the effectiveness of baffles in reducing sloshing pressure yu et al 2019 studied the use of a vertical slat screen in reducing in shallow water sloshing in a tank this study showed that sloshing damping does not always increase with an increase in the screen number but is also dependent on the position of the screen xiang et al 2019 analyzed the wave clipping effects of artificial islands in plain reservoir by employing mike21 sw model they concluded that artificial islands at suitable locations in the reservoir can attenuate the wave heights by approximately 10 30 the study of layered sloshing can also throw light on layered seiche oscillations a couple of studies have been conducted in the past that deal with a layered fluid sloshing in a closed tank kargbo et al 2019 looked at the effect of layered sloshing and internal wave interaction on submersed structures this study showed that internal wave progression is affected by internal structures with interfacial waves being higher than the corresponding free surface wave veletsos and shivakumar 1993 conducted studies on layered sloshing considering n layers and their study stated that for n number of homogeneous layers there are an n number of horizontal natural modes la rocca et al 2002 conducted theoretical studies on layered sloshing using a variational form of the potential formulation of the fluid motion and in his study was able to account for the effects of dissipative forces sciortino et al 2009 used a hamiltonian approach to study layered sloshing in a cylindrical tank and was able to analyze the traveling waves created during sloshing ishiyama et al 2013 looked at how a magnetic fluid affected layered sloshing their study discovered that the magnetic field altered the natural frequency and the pressure exerted by the fluid on the tank walls in general studies on seiche in lakes have been able to improve on the general understanding of seiche oscillations in nature and the developments in sloshing analyses have bolstered our understanding on this phenomenon this work however looks at how seiche oscillations could be developed numerically for single and layered cases and how the setup affects the oscillation how layered seiche oscillations and interfacial waves interact with damping structures is also an area which this study seeks to add further understanding on 2 mathematical model and numerical method 2 1 governing equation the incompressible navier stokes equation governs the fluid domain 1 ρ u t ρ u u p i μ u u t f 2 u 0 the velocity is given by u with the pressure given by p whereas the fluid density is given by ρ the dynamic viscosity and the body force are given by μ and f respectively with the unit diagonal matrix represented by i 2 2 numerical method in this study the fluid domain of the model is represented by the incompressible navier stokes equation with the ale method being employed to track the fluid interface deformations this model is based on the finite element method fem and is developed using the cfd module of comsol for the convenience of the following discussions the time item of the momentum equation is ignored for the time being and the body force is set to zero therefore the steady laminar equations in the domain ω with non slip and zero normal stress conditions on the domain boundaries γ 0 and γ n respectively in component form are 3 ρ u j u i j p i μ u i j u j i j in ω u i j 0 in ω u i 0 on γ 0 p n i μ u i j u j i n j 0 on γ n a test function v i is selected from the momentum equation and in such v i 0 on γ 0 where as a test function z is chosen in the case of the continuity equation the continuity and momentum equations and are multiplied by a test function and integrated over the domain 4 ρ ω u j u i j v i d v ω p i v i d v μ ω u i j u j i j v i d v ω u i i z d v 0 integration by parts applied to the pressure and vicious term yields 5 ω p i v i d v γ n p n i v i d s ω p v i i d v ω u i j u j i i v i d v μ ω u i j u j i n j v i d s μ ω u i j u j i v i j d v 6 μ γ n u i j u j i n j v i d s μ 2 ω u i j u j i v i j v j i d v the sum from the boundary terms from equations 5 and 6 give zero stress boundary condition integral 7 γ n p n i v i d s μ γ n u i j u j i n j v i d s γ n p n i μ u i j u j i n j v i d s 0 putting expressions 5 7 back in the integral expression 4 gives the final variational form 8 ρ ω u i u i j v i d v ω p v i i d v μ 2 ω u i j u j i v i j v j i d v 9 ω u i i z d v 0 for solving the unsteady flow it is noted that the time item should be added to equation 8 also all the mentioned formulations are already implanted within this software the non slip boundary condition on γ 0 is enforced explicitly on the fem functions with appropriate selection of the function space the zero normal stress boundary condition on γ n is implicitly enforced through the variational form p1 p1 discretization which apply separate discretization for the velocity and pressure is done using the continuous piecewise linear elements for both variables further details on the comsol solver equations can be obtained from the comsol users guide multiphysics comsol 1998 and the reference kargbo et al 2019 2 2 1 boundary conditions the model consists of solid walls and a free surface the slip boundary for the navier stokes equation is 10 u n 0 where n nx ny t is the boundary normal equation 10 is applied to the walls which are modeled with slip boundary condition the normal vector is dependent on the degrees of freedom of the moving mesh hence weak constraints are used to remedy constraining forces on the fluid equations and mesh weak constraints are used to enforce the slip boundary condition without a constraint force acting on the moving mesh equations 11 λ ˆ u n λ u ˆ n for some lagrange multiplier variable λ where λ ˆ and u ˆ denote test functions the fluid is free to move in the top boundary neglecting the stress in the surrounding environment the stress continuity equation on the free surface is given by 12 p i μ u u t n p 0 n where p 0 is the surrounding pressure and μ is the viscosity of the fluid without loss of generality p 0 0 for this model 2 2 2 boundary condition for mesh to follow the fluid motion in relation to the mesh motion it is conventional in most cases to couple the mesh motion to the fluid motion normal to the surface the coupling is not done in the tangential direction as it will soon lead the solution to non convergence due to excessive deformation of the mesh the boundary condition for the mesh on the free surface is thus given by 13 x t y t t n u n where n is the boundary normal to x t y t t the velocity mesh for this boundary condition with the weak constraints activated the moving mesh interface adds the weak expression 14 λ ˆ x t y t t u n λ χ ˆ y ˆ t n this is added to ensure that there are no constraint forces acting on the fluid equations the moving mesh is not constrained in the tangential direction on the side wall at the side to enable it to follow the motion of the fluid here again λ denotes some lagrange multiplier variable not the same as before and x ˆ y ˆ and λ ˆ denote test functions 2 2 3 free surface and interfacial surface tracking method the free surface boundaries of the computational domain are moving and deformed with time as a result of the motion and physical parameters of the computational domain the motion of this free surface is tracked by a deformed moving mesh which moves in conformity with the deformation computation domain with a new mesh being generated for each configuration of the boundaries this technique of movement which is also referred to as the arbitrary lagrangian eulerian ale method is used to track the free surface of this model consider a mesh at time t n the velocity field is computed for the time t n 1 on this same mesh the new free surface is then computed with the lagrangian formula 15 x n 1 x n u δ t the partial differential equation governing the displacement field of the mesh is given by 16 d i v σ 0 the cauchy stress tensor is σ the mass of the fluid is considered in the domain and as such the mesh is considered as incompressible we consider a linear elasticity model given by the constitutive relation 17 σ c ε the constitutive matrix c is element dependent the constitutive matrix elements are also inversely proportional to the element size in order to solve the mesh equation eq 15 for free surface boundary conditions it is assumed that no fluid particle can cross the free surface this condition is expressed by setting the normal mesh velocity at the free surface equal to the normal fluid velocity 18 v v m e s h n 0 the fluid velocity is given by v is and n is the unit normal vector the above mentioned free surface tracking method is also employed to track the interfacial surface 3 model validation 3 1 mesh convergence mesh convergence analysis was done for the tank setup described in fig 1 the mesh parameters were categorized into fine normal and coarse with the specifications of each mesh as described by table 1 the movement equation of the tank is x t a c o s ω t with excitation amplitude of a 0 01m and frequency of ω 5 15 rad s the mesh categories described in table 1 were used to conduct error analysis the normal mesh was used a reference mesh and compared to the coarse and fine mesh by plotting error bars as shown in fig 2 for coarse mesh error and fine mesh error respectively from the convergence plots it is seen that the fine mesh and the normal mesh had a strong similarity the coarse mesh also had satisfactory comparisons with the normal mesh for computational time saving purposes the normal mesh was chosen throughout this study time step analysis was also done to see the model s response to various time steps time step values of time step used were 0 1s 0 01s and 0 001s a rectangular tank described in fig 1 was used the movement equation of the tank is x t a c o s ω t with amplitude of a 0 01m and frequency of ω 5 15 rad s from the results show in fig 3 a and fig 3 b for interfacial and free surface respectively it is seen that for the time steps used the difference in result was very minimal for computational purposes a time step of 0 01s was used 3 2 layered sloshing in a rectangular tank the numerical model was further compared to laboratory experiments of two layers sloshing conducted at state key laboratory of hydraulics and mountain river engineering sichuan university xue et al 2013b the test system including experimental photograph and layout of the sensors is shown in fig 1 the details are also found in previous work xue and lin 2011 the test system consisted of a layered fluid in a rectangular tank an irregular wave maker three wave gauges three pressure sensors one displacement sensor and data acquisition system the tank motion is controlled by an irregular wave maker the tank with length l 0 57m was filled with two immiscible fluids 0 diesel oil and tap water their densities are ρ 1 846 2 k g m 3 and ρ 2 1000 k g m 3 respectively the height of two layers fluids with density ρ 1 and ρ 2 are h ρ 1 0 05 m and h ρ 2 0 1 m respectively three wave gauges and three pressure sensors were mounted on the rectangular tank as shown in fig 1 b the movement function of the shake table controlled by the irregular wave maker is given by 19 x t a c o s ω t where a is 0 01m with various excitation frequencies being ω 4 24 r a d s ω 5 15 r a d s the comparison of the layered sloshing in a rectangular tank of the experimental results to the numerical simulation is shown in figs 4 5 for the interfacial wave elevation time series and in fig 6 for the pressure time series as shown in figs 4 and 5 the results from the probe 1 were under predicted by the numerical model the possible reason is that in the experiments the wave probe 1 is not strictly in the center of the tank where the wave amplitude is very small and the wave amplitude is sensitive to position fortunately the numerical results from the wave probes near the tank walls probe 2 and probe 3 and the pressure sensors match well with the experimental data moreover the experimental snapshots and numerical profiles of the layered profile at various moments are presented in fig 7 it is noted that the higher frequency interfacial waves were not captured numerically due to neglecting the effect of surface tension at the interfacial surface in numerical model but nonetheless the agreement between the numerical results and experimental data was also satisfactory indicating that the model employed here is a robust tool for simulating layered fluids sloshing problem 3 3 liquid sloshing in a tank with vertical baffles a vertical baffled tank model was setup as shown in fig 8 and compared for validation with numerical results from belakroum et al 2010 who investigated effect of the baffles on passive reducing sloshing in rectangular tanks partially filled with liquid the tank has a length l of 0 9m and a liquid filling level h of 0 6m in case 1 the height of the bottom mounted baffle is 0 3m and is placed at the bottom center of the tank and in case 2 the height of the vertical baffle is 0 075m and is placed near the free surface as is seen in fig 8 the tank motion is subjected to the following sinusoidal function 20 x t a sin ω t where the amplitude is a 0 00198m and the excitation frequency is ω 5 4 rad s fig 9 shows the present results of the free surface elevation time history at the left wall compared well with the available numerical results from belakroum et al 2010 however slight discrepancy in amplitude and slight phase lag is observed in the comparisons due to considering the impulse acceleration in present simulations overall the present results however are in a satisfactory agreement with the available numerical results moreover fig 9 a and b indicates the temporal evolution of the free surface elevations at the left wall after installing the vertical baffle placed at the bottom of the tank and near the free surface respectively it can be observed obviously that the vertical baffle near free surface is more effective in reducing sloshing amplitude than the vertical baffle mounted on the bottom of the tank although its length is only one quarter of the vertical baffle on the bottom 4 single layer induced seiche oscillations in a rectangular tank 4 1 model setup to replicate the seiche setup phenomenon and action as observed in lakes and enclosed water bodies a case is setup with an initially inclines free surface as shown in fig 10 with a closed tank of dimensions and fluid domain surface area as described in table 2 no motion excitation amplitude and frequency were applied to the system to initiate sloshing but the fluid motion is caused by gravity acting on the initially inclined fluid surface on the commencement of the simulation for the assumption of a flat bottom the characteristic period t of a barotropic seiche is given by 21 t 2 l m g h where m 1 2 3 l is the length of the water basin h h 1 h 2 2 is the water depth and g is the gravitational acceleration niedda and greppi 2007 four case studies are modeled as shown in table 2 namely case 1 case 2 case 3 and case 4 respectively as is seen in table 2 the volume of the fluid is kept constant for all cases with changes only being made to the inclination angle of the free surface the area of the trapezium shown in table 2 is considered for the 2d setup of the fluid domain 4 2 wave time series and spectral analysis for single seiche oscillations as shown in fig 10 free surface wave heights were recorded on the right and left tank walls as c1 and c2 respectively seiche setup was modeled with different free surface inclination angles and at the commencement of the simulation the fluid mass can oscillate under gravity till it reaches equilibrium as observed in the free surface time series shown in figs 11 14 the inclination angle was developed using the details and dimensions of the four cases studied as given in table 2 to alter the inclination angle of the free surface the height of h2 in the tank setup was varied giving free surface inclinations related to h2 0 115m 0 125m 0 145m and 0 165m with their respective sloshing wave time series being plotted in figs 11 14 respectively as well as their respective fast fourier transform fft a fft provides a power spectral analysis technique of the time series and enables the natural or peak frequencies of the system to be identified from the fft diagrams high frequency components at high inclined fluid surface conditions can be observed this may be due to the rapid descending of the inclined fluid surface under gravity which may cause fast oscillation of fluid particles in the process meanwhile a typical nonlinear wave phenomenon i e the wave crest becomes sharper and the trough becomes flatter with larger inclination angle is obviously observed in fig 15 indicating that wave wave interactions are enhanced by increasing inclination angle more high frequency components are thus observed in figs 12 14 the free surface time series showed that at the initial commencement of the simulation the fluid sloshed from side to side with wave heights decreasing as the time progresses until equilibrium is obtained figs 11 14 shown that the higher h2 values the sloshing fluid had higher wave heights and took longer to reach equilibrium this can be seen obviously in fig 14 where h2 0 165m and the free surface wave time series is seen to have higher wave heights as compared to the other cases studied in figs 11 13 lowest wave heights for all the cases studied is observed when h2 0 115m as shown in fig 11 a comparative analysis shown in fig 15 compares all cases for values of h2 0 115m 0 125m 0 145m and 0 165 m at right and left tank walls by wave gauges c1 and c2 respectively this further shows that at higher values of h2 or inclination angle is associated with higher wave heights and longer sloshing time of the free surface before it reaches equilibrium power spectral analysis for single layer seiche under setup as described by fig 10 and table 2 is plotted for various initial free surface inclination angles for h2 0 115m 0 125m 0 145m and 0 165m as shown in figs 11 14 the frequency analysis was done for wave heights at c1 and c2 and it is observed that the peak frequency values at c1 and c2 were similar in value this can be seen in fig 11 where the peak frequency is given as 0 93 hz which is around the first order natural frequency calculated by equation 21 for h2 0 125m the peak frequency is also given as 0 93 hz as seen in fig 12 as h2 is increased to h2 0 145m as shown in fig 13 thereby increasing the free surface inclination angle the peak frequency is given as 0 96 hz which showed a slight increase from the previous h2 values of figs 11 and 12 it is also observed that for h2 0 165m the peak value is around 0 96 hz which is very close to the peak frequency when h2 0 145m from the spectral analysis it can be summed that for the same filling levels or for a certain volume of fluid the natural or peak frequency is not significantly altered by varying the inclination angle of the free surface 4 3 comparison of velocity profile of seiche oscillations under various initial free surface inclination angle velocity screen shots were taken for seiche initiated sloshing under four different initial free surface inclination angles the free surface inclination angles were given by h2 0 115m 0 125m 0 145 m and 0 165m as is seen in fig 16 from the screen shots the fluid is seen to slosh from side to side for all h2 heights the velocity distribution varied for all inclination angles with one notable observation being that for higher h2 values a higher maximum velocity of the fluid domain is observed and this can clearly be seen at t 1 3s this showed that an increase in inclination angle caused an increase in the fluid velocity as it sloshes from side to side interesting velocity distributions can be observed at certain time frames at t 2 77s it is seen that the screen shot for h2 0 115m has a velocity distribution characteristic of central larger and surrounding smaller with compared to the other cases of h2 0 125m 0 145m and 0 165m i e the fluid velocity is concentrated in the center with higher velocity in the center being encircle by lower velocity distribution whereas the maximum velocity concentration is closer spread out and closer to the free surface for the other values of h2 similar interesting velocity differences can be observed at t 5 79s where for all values of h2 each had a uniquely different velocity distribution profile at this time frame 5 two layered induced seiche oscillations in a rectangular tank 5 1 model setup a setup was developed to study multiphase or layered seiche comprising of two immiscible fluids in a closed tank as is seen in fig 17 the tank and domain dimensions are as described by table 2 two cases were setup for studies with an inclined layered fluid domain for an unbaffled and central mounted vertical baffles case as in described in fig 17 this analysis is done for cases with and without a baffle using the cases as describe in table 2 with the four cases shown in the table being developed with a second fluid layer 2 having a height of h3 being placed on top and parallel to the bottom fluid as shown in fig 17 5 2 wave time series and spectral analysis for two layered seiche oscillations time series graphs are shown for the interfacial and free surface evolution for layered seiche together with their corresponding power spectral analysis it is seen that the baffles had an effect in reducing the interfacial and free surface wave displacement height as well as bringing the sloshing fluid to attain equilibrium in a shorter time thereby speeding up the creation of a still fluid surface this can be seen in fig 18 which shows seiche sloshing for the interfacial and free surface layer for h2 0 165m for cases with and without a baffle in fig 18 the interfacial and free surface wave interacting with a baffle is seen to quickly reach equilibrium with lesser sloshing heights as compared to the same case without a baffle this can be further observed in fig 24 which shows screen shots of the velocity profile of the seiche for various initial inclination angles this is also seen in for other initial inclination angles of the free surface the baffled cases can also be seen to have significant second peak frequencies values with high amplitudes as compared to the unbaffled case where in the first peak frequency is significantly higher than the second peak frequency this can be seen in the fft of figs 18 20 it is seen that the first sloshing cycle attains the highest maximum wave height with subsequent wave heights reducing gradually till the initial and free surface attain equilibrium with a still fluid table as the initial inclination angle of the free surface is reduced the fluid attains lower maximum wave heights and reaches equilibrium much faster as is seen in fig 20 for h2 0 125m corresponding power spectral analysis of the interfacial and free surface wave time series are presented for both baffled and unbaffled cases in fig 18 for h2 0 165m it is seen that the baffle split the peak frequency without baffle into two dominant response frequencies in fig 18 for the internal or interfacial wave the peak frequency is given as 0 99 hz for unbaffled case of the interfacial waves and 0 92 hz and 1 64 hz when a baffle is used it is also seen that the third peak frequencies have very small amplitudes when compared to the peak frequencies when considering the unbaffled cases similarly for the free surface the baffle split the same peak frequency of 0 99 hz into two dominant frequencies 0 88 hz and 1 60 hz this can be also observed in figs 19 and 20 for the cases without and with the baffle under various initial free surface inclination angles moreover it was observed that effect of the baffle on frequency domain of the free surface elevation time series was different from that of the internal wave elevation the spectral density analysis mainly shows the energy distribution in frequency domain this also shows a relation between the inclination angle and the two layer fluids energy distribution in frequency domain however the fluids energy distribution in time was not observed by using fft method wavelet transform which is a time frequency analysis method can provide local information and therefore may be viable to identify the time frequency characteristics of the time series of free surface and interfacial wave ma et al 2010 tai et al 2019 in figs 21 23 wavelet spectrum are shown for the time series for h2 0 125m 0 145m and 0 165m respectively which obviously exhibits the energy distribution of external wave and internal wave in different frequencies and its variation over the time 5 3 effect of the baffles on velocity profile of seiche oscillations the seiche oscillations for h2 0 165m for cases with and without a vertical baffle were compared with results of the velocity screen shots shown in fig 24 the effect of the baffle on the oscillation was desired to be observed for the highest h2 value covered in this study to observe how high inclination angle of the free and interfacial surfaces interact with and without internal structures such as baffles the velocity distribution obviously varied for the case with a baffle when compared to that for the unbaffled case for the baffled case obvious vortex shedding can be observed near the tip of the baffle which in turn might dissipate fluid energy as opposed to the case without a baffle this can be clearly observed in fig 24 at t 1 62 s this same observation can be deduced for the other time frames of fig 24 at t 1 62 s and 2 77 s it can be observed that the baffled case created interfacial wave high frequency oscillation and an upward interfacial wave displacement just above the baffle position this displacement is not observed for the unbaffled case the baffle here is seen to interrupt with the hydrodynamic flow path of the fluid with particular effects been observed on the interfacial wave 6 conclusions an incompressible navier stokes solver for simulating seiche phenomena was built based on the cfd module of comsol with the interface being tracked by the arbitrary lagrangian eulerian ale method laboratory experiments of layered sloshing in a rectangular tank were conducted to validate the present numerical model good agreements are obtained for the interfacial wave elevations and the pressures between the numerical results and the experimental data non layered and layered seiche was simulated by using the present numerical model time series plots of the interfacial and free surface wave were plotted as well as their corresponding fft to identify their dominant response frequency of the seiche oscillation system it showed that conditions of the wave setup influence the maximum elevation of the free surface and interfacial wave higher setup in inclination angles or heights created higher maximum wave height oscillations as well as longer wave decay time the dominant response frequency values observed through the fft were not greatly affected by the inclination angle with peak frequency values being mostly the same for all inclination angles for the constant fluid volume used in this study which were also around the natural frequencies calculated theoretically the maximum wave height was dependent on the inclination angle with lower inclination angle recording lower maximum wave height values higher velocity values were observed in the fluid domain for higher initial inclination angle values or setup height at any given time the effect of internal baffles on layered seiche oscillation was also studied with the internal baffles seen to greatly reduce the wave heights for both surface and interfacial waves the baffles accelerated the wave decay for both free surface wave and interfacial wave and also affected the dominant response frequencies of the seiche oscillations the influence of the baffle on interfacial wave and free surface wave is different interfacial wave high frequency oscillation near the baffle tip was observed at special time declaration of competing interest the authors declare no conflict of interest acknowledgements this work is supported by the national natural science foundation of china no 51679079 the fundamental research funds for the central universities china no 2018b12814 the national science found for distinguished young scholars no 51425901 and the program for excellent innovative talents of hohai university china appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106842 
22209,an efficient numerical model for wave induced flows and their interaction with impermeable coastal structures is presented using recent developments in the field of two fluid water air navier stokes ns simulations an efficient numerical wave tank nwt was developed which combines the immersed boundary ib method and fast direct solvers fds conventional ns based nwts require significant computational resources which prevents their use in discretisation demanding cases or extensive parametric studies the computational efficiency of the new nwt was achieved by replacing the conventional variable coefficient poisson equation with a constant coefficient one which is solved with a fds results of the accuracy limitations and computational performance of the nwt are presented and discussed based on several validation tests 1 propagation of a 2 n d order stokes wave 2 formation of a standing wave 3 spilling breaking over a mild slope bed 4 three dimensional 3d interaction of a solitary wave with a vertical abutment and 5 diffraction of a solitary wave by a single row pile breakwater the computational performance of the new nwt was demonstrated for problems with 1 280 million grid nodes the overall speed up of the new nwt increases with the problem size and it is estimated to be about 30 for large 3d problems keywords numerical wave tank 3d wave induced flow fast poisson solver level set method immersed boundary method computational efficiency 1 introduction the use of computational fluid dynamics cfd in wave induced flows based on the solution of the full set navier stokes ns equations is gaining attention in the ocean and coastal engineering community mainly because of the evolution in computing power however even today detailed three dimensional 3d ns simulations can be prohibitively expensive for practical applications because of the physical complexity and or the size of the problem considered therefore the development of efficient numerical methods is essential to reduce the required computational cost and enable easier access to discretisation demanding flow cases and extensive parametric studies a typical example of a challenging field for cfd is the modelling of 3d ocean and coastal flows with ns based numerical wave tanks nwts nwts of this type should be able to simulate complex hydrodynamic processes including phenomena such as wave breaking where the interaction between the air and the water phases should be taken into account the resultant ns equations are those describing the incompressible turbulent flow of two immiscible fluids separated by an interface the numerical solution of the equations is usually achieved by time marching approaches such as the classical fractional step method under these circumstances mass continuity is imposed by a poisson equation for pressure which is the most computationally intensive part of the simulation thus any reduction of the computational cost for the solution of the poisson equation significantly reduces the required computational resources in total in contrast to single fluid problems the poisson equation in two fluid flows depends on the time evolution of the density field as well therefore the motion of the interface eventually leads to a poisson equation with variable coefficients in space and time for conventional direct solvers e g lu based this means that a large matrix should be inversed at every time step leading to a prohibitively high computational cost until recently the most popular and the only affordable choice was the use of iterative solvers where the coefficients are updated at every time step without any matrix inversion there is considerable literature related to nwts using different discretisation methods e g finite differences finite volumes or finite elements and interface tracking approaches e g volume of fluid vof or level set their common characteristic is the use of an iterative solver for the variable coefficient poisson equation for instance the open source software reef 3d bihs et al 2016 solves the ns equations on cartesian staggered grids with the finite differences method and the tracking of the interface is performed with the level set method regarding the solution of the poisson equation there are multiple choices of iterative solvers such as the preconditioned bicgstab the conjugate gradient or the algebraic multi grid solver included in the mathematical library hypre falgout and yang 2002 the open source software openfoam also includes several nwt options like waves2foam jacobsen 2017 naoefoam sjtu cao and wan 2014 or ihfoam higuera et al 2014 using either a relaxation method or an active wave absorption approach higuera et al 2013a for the wave generation in all these openfoam implementations the finite volume method and the vof method are used for the descritisation and the interface tracking respectively the variable coefficient poisson equation is usually solved using the preconditioned conjugate gradient pcg solver with the geometric algebraic multi grid gamg as a preconditioner even though other options of iterative solvers and preconditioners are also available in openfoam similar solvers are also used by commercial codes such as flow 3d hirt 2011 ansys fluent ansys fluent 2011 and cfx ansys cfx 2012 in flow 3d the generalised minimum residual solver gmres is used while in ansys fluent and cfx the algebraic multi grid solver is coupled with an incomplete lu ilu smoother in house nwts presented so far guo et al 2013 ha et al 2014 wang et al 2009 also use iterative solvers for the variable coefficient poisson equation a breakthrough study in the area of two fluid flow simulations which enables significant reduction in computational cost was presented in dodd and ferrante 2014 where the variable coefficient poisson equation was transformed into a constant coefficient one an evident advantage of such a constant coefficient poisson equation formulation is that there is no need to rebuild the matrix of the equation at every time step the most important advantage though is that fast direct solvers fds can be employed which can accelerate the solution of the poisson equation by 1 2 orders of magnitude dodd and ferrante 2014 frantzis and grigoriadis 2019 the advantage of fds is more evident when 3d cases are simulated because of their parallel efficiency this is achieved by using fast fourier transformation fft to decompose the original 3d problem into a series of smaller 2d or 1d problems however the original formulation suggested by dodd and ferrante 2014 is suitable for flows on a cartesian domain without the presence of obstacles structures more recently this formulation was extended in frantzis and grigoriadis 2019 in order to enable the proper coupling with the immersed boundary ib method this extension allowed the use of the formulation even in cases where wave induced two fluid flows interact with obstacles structures immersed into a cartesian grid while all the advantages of using fds were maintained the purpose of the present study was to develop an efficient nwt by extending the method presented in frantzis and grigoriadis 2019 for wave induced flows and validate its suitability for offshore and coastal applications the developed nwt includes a wavemaker zone a relaxation zone and or an absorption zone similar to the ones described in guo et al 2013 and jacobsen et al 2012 which are based on the work of mayer et al 1998 an extensive validation is presented for 1 the propagation of a 2 n d order stokes wave 2 the formation of a standing wave 3 a 2d spilling breaker compared against experimental data ting and kirby 1994 1996 4 the 3d interaction between a solitary wave and a rectangular abutment compared against laboratory experiments lara et al 2012 and 5 the 3d interaction of a solitary wave with a single row pile breakwater compared against both experimental data and numerical results jiang et al 2015 the requirement of the method for small time steps as reported in frantzis and grigoriadis 2019 was also examined to quantify its effect on the computational performance and efficiency of the new nwt the paper is organised as follows the mathematical model and the numerical methods are described in section 2 section 3 includes benchmark and validation results for 2d and 3d cases the performance of the developed nwt is demonstrated in section 4 by comparing the computational cost against conventional nwts using iterative pressure solvers finally conclusions and discussion for the potential and the efficiency of the new nwt are presented in section 5 2 mathematical description and numerical methods 2 1 governing equations the incompressible flow of two immiscible viscous fluids where the surface tension effects are negligible is described by the navier stokes equations which in their non dimensional form read 1 u 0 2 u t u u 1 ρ r e μ r e μ t u u t p ρ a f r where u p ρ μ and μ t are the non dimensional velocity pressure density dynamic viscosity and dynamic turbulent eddy viscosity fields respectively all these variables evolve in space and time the non dimensional reynolds r e and froude f r numbers which appear in eq 2 are given by 3 r e u o l o ρ o μ o and f r u o 2 l o g where l o u o ρ o and μ o denote the characteristic scales for length velocity density and dynamic viscosity respectively in the present study ρ o and μ o correspond to the ones of the heavier fluid i e water in the right hand side rhs of eq 2 the term a denotes the non dimensional external acceleration vector field which in the general case may vary in space and time for the nwt presented here a is constant both in space and time i e 4 a g g where g is the gravitational acceleration vector 2 2 sub grid scale modelling the use of the large eddy simulation les is employed in the present nwt to model the sub grid scales sgs of motion which are not resolved by the grid in the les modelling framework the effect of the sgs motions is modelled by introducing additional viscosity to the flow called eddy viscosity this model has been used in the past to study either 2d or 3d wave hydrodynamics dimas and koutrouveli 2019 guo et al 2013 hieu and tanimoto 2006 li et al 2004 using the standard smagorinsky model smagorinsky 1963 the dynamic eddy viscosity is given by 5 μ t ρ c s δ 2 s where δ δ x δ y δ z 1 3 is the filter length scale defined by the grid sizes δ x δ y and δ z and s 2 s s 1 2 is the modulus of the strain rate tensor s in the standard version of the smagorinsky model the parameter c s has a constant value the optimal value of the smagorinsky constant c s varies according to the flow and ranges from 0 065 to 0 23 in the literature meyers and sagaut 2006 thus c s parameter can be tuned and set to a different value between cases in order to obtain the best possible agreement for the cases examined in the present study c s 0 2 unless otherwise stated to recover the proper near wall behaviour the eddy viscosity is modified with a van driest type of damping close to solid boundaries depending on the distance and the wall friction as described in grigoriadis et al 2003 for the cases presented here and the numerical resolution used wall functions are not applied however one could implement such wall function approximations without any complication in a similar manner different sgs and turbulence modelling approaches e g k ε k ω or detached eddy simulation des could also be employed 2 3 interface capturing and fluid properties the position and the motion of the interface is captured by the conservative version sussman et al 1998 of the level set method osher and sethian 1988 which is based on the solution of the advection and the re initialisation equations 6 φ t u φ 0 7 φ τ s φ o φ 1 f φ φ o δ φ o φ o where the scalar variable φ defines the signed distance from the interface and φ 0 corresponds to the position of the interface τ is an artificial time and φ o is the resultant field after the advection step eq 6 and before subjected to re initialisation eq 7 the functions s f and δ are defined as 8 s φ 1 if φ ε water φ ε 1 π sin π φ ε if ε φ ε interface region 1 if φ ε air 9 f φ φ o v s φ o 1 φ δ φ d v v δ 2 φ o φ o d v 10 δ φ 0 if φ ε water 1 2 ε 1 cos π φ ε if ε φ ε interface region 0 if φ ε air it is noted that the solution of eqs 6 and 7 is required only in a bandwidth around the interface see eq 13 solving these equations only in a narrow bandwidth around the interface might lead to spurious artifacts when merging or diverging interfaces occur in order to avoid such issues the modified advection equation proposed in peng et al 1999 is used a detailed description of the level set method implemented in the nwt is given in frantzis and grigoriadis 2019 in order to avoid numerical instabilities due to the discontinuous fields of density and viscosity an artificial thickness of the interface between the two fluids was introduced in this transition zone the density and the viscosity are considered to vary smoothly across the free surface according to 11 ρ ρ 1 ρ 2 ρ 1 h φ 12 μ μ 1 μ 2 μ 1 h φ where subscripts 1 and 2 correspond to water and air respectively h φ is the smoothed heaviside function osher and fedkiw 2006 defined as 13 h φ 0 if φ ε water 1 4 φ ε 1 π sin π φ ε if ε φ ε interface 1 if φ ε air and ε is a constant defining the half thickness of the transition zone typical values of ε range from one to three times the minimum gird size calderer et al 2014 in the present study ε was set equal to 2 min δ x m i n δ y m i n δ z m i n if the interface is rapidly deforming or the density ratio and the r e number are too large higher values of ε up to eight grid sizes iafrati and campana 2005 could be required the reader is referred to the study of iafrati and campana 2005 for a detailed discussion about the need for a larger artificial thickness of the interface and the effect of this value it has to be noted that very fine deformations of the free surface such as droplets and bubbles which are smaller than the spatial numerical resolution are not captured according to deane and stokes 2002 bubbles larger than the hinze scale 1 m m are subjected to fragmentation while the size of smaller bubbles is stable due to surface tension forces taking into account the smearing thickness of the interface the grid resolution should be even finer than the hinze scale to resolve the smallest bubbles droplets with pure air water in their core such a resolution is prohibitively expensive for real scale breaking waves that include air entertainment phenomena for a breaking wave an initially formed large air pocket experiences fragmentation generating smaller bubbles these bubbles start disappearing when their size becomes comparable to the grid spacing violating the mass conservation iafrati 2009 and consequently affecting the accuracy of the simulated breaking wave 2 4 numerical implementation and discretisation schemes the in house code developed in frantzis and grigoriadis 2019 was used to solve the equations presented in sections 2 1 2 3 the discretisation of these equations is performed using finite differences on a cartesian staggered grid arrangement the velocity components u v w are defined at the cell faces and the rest of the variables p ρ μ φ are defined at the cell centre the time advancement of the velocity and pressure fields was performed using the fractional step method chorin 1968 to solve eqs 1 and 2 the fully explicit 2 n d order adams bashforth scheme with a variable time step was employed for the temporal discretisation it is noted that when a variable time step is used a limit in the change of its value between successive time steps is required to avoid stability issues for instance when a rapid drop of the time step is computed the temporal advancement scheme converges to an explicit euler time stepping which is unconditionally unstable in the current implementation the time step change was limited to 5 between successive iterations even though the velocity did not change that rapidly to activate this restriction in the fractional step method a provisional velocity field is calculated at first which in our case reads 14 u u n δ t n 1 1 δ t n 1 2 δ t n ξ u n δ t n 1 2 δ t n ξ u n 1 where δ t n is the time step of the n t h iteration the operator ξ is defined by the rhs of eq 2 excluding the pressure gradient and the gravitational terms i e 15 ξ u n u n u n 1 ρ n 1 r e μ n 1 u n u n imposing mass continuity results into a variable coefficient poisson equation for the pressure field p n 1 16 p n 1 ρ n 1 1 δ t n 1 u a f r where the last term in the rhs is equal to zero because the acceleration vector does not change in space in dodd and ferrante 2014 the following splitting scheme was introduced 17 p n 1 ρ n 1 p n 1 ρ o 1 ρ n 1 1 ρ o p ˆ where p ˆ is an approximation of the pressure field at the new time step p n 1 using a variable time step p ˆ was calculated by a linear extrapolation according to 18 p ˆ 1 δ t n 1 δ t n p n δ t n 1 δ t n p n 1 when the splitting scheme of eq 17 is applied to eq 16 the poisson equation transforms into a constant coefficient one the adoption of the splitting scheme to obtain a constant coefficient formulation introduces an additional temporal error in the numerical procedure according to eq 17 this error is proportional to the time step size since a sufficiently small time step would lead to p ˆ p n 1 meaning that eq 17 will represent an exact relation and not an approximation anymore the need of using smaller time steps to eliminate the temporal error related with the splitting scheme is demonstrated and discussed in detail in frantzis and grigoriadis 2019 the original formulation of eq 17 was modified in frantzis and grigoriadis 2019 to achieve a proper coupling of fds and the ib method solving a constant coefficient poisson equation for the pressure difference δ p n 1 p n 1 p n 19 2 δ p n 1 ρ o δ t n 1 u 1 ρ o ρ n 1 p ˆ 2 p n the resultant poisson eq 19 is solved using a fishpak based fds grigoriadis et al 2004 which decomposes a 3d problem using fft along direction s with equidistant grid and periodic or homogeneous neumann boundary condition s bcs for the pressure difference in the present study a single fft decomposition is used for the 3d cases either along the span wise or the stream wise direction depending on the grid spacing and the bcs for instance fft decomposition can be performed along the span wise direction if it is discretised with a uniform grid even though a non uniform grid might be used along the stream wise direction the distinction of this formulation from other two fluid formulations coupled with the ib method is that the part of the domain occupied by the solid is included in the solution of the poisson equation otherwise the use of the fds would not be allowed using the formulation of eq 16 and including the solid part in the poisson solution one should define a density value for the solid nodes in regions where the free surface intersects the ib solid interface this is not a trivial task and may lead to stability issues because the proper bc on the ib would not be satisfied the reader is referred to the study of frantzis and grigoriadis 2019 for a detailed explanation and discussion once the poisson eq 19 is solved the pressure and velocity fields at the new time instant n 1 are updated by a consistent correction step 20 p n 1 p n δ p n 1 21 u n 1 u δ t n 1 p n 1 ρ o 1 ρ n 1 1 ρ o p ˆ δ t n 1 a f r regarding the spatial discretisation the convective terms of eq 15 are discretised using the modified upwind quick scheme of perng and street 1989 which has an improved accuracy of 3 r d order yue et al 2003 while the diffusion term is discretised using standard 2 n d order central differences the discretisation of eq 19 is also performed using standard 2 n d order central differences the level set advection equation eq 6 is discretised in space using the weno scheme jiang and shu 1995 the re initialisation equation eq 7 can be discretised with either a 2 n d order upwind scheme or a 5 t h order weno scheme for the results presented in this study a 2 n d order scheme was used shu and osher 1988 yue et al 2003 a 3 r d order runge kutta scheme is used for the time advancement of eqs 6 and 7 the presence of solid obstacles within the computational domain are taken into account using the ib method peskin 1972 following a direct forcing approach for the velocities balaras 2004 the pressure bcs on the ib solid interface are properly recovered using the indirect approach presented in frantzis and grigoriadis 2019 this is a key step in the development of the proposed nwt because in contrast to other conventional approaches the poisson equation is solved in the entire domain fluid and solid phase retaining 2 n d order of accuracy in space and time the reader is referred to the work of frantzis and grigoriadis 2019 for a detailed discussion on the relevant modifications of the provisional velocity fields and the treatment of the pressure gradient terms in order to ensure numerical stability constraints related to the time step must be applied for problems where there is no surface tension these restrictions are imposed through the c f l convection stability limit and the v s l viscous stability limit given below in their non dimensional form nguyen et al 2001 22 c f l m a x u i m a x δ t c f l n 1 a i f r δ t c f l n 1 δ x i 23 v s l m a x μ r e μ t ρ δ t v s l n 1 δ x i 2 where δ t c f l and δ t v s l satisfy the corresponding constraints by setting appropriate values for c f l m a x and v s l m a x respectively the minimum δ t n 1 is dynamically computed at each time step to satisfy both constraints i e 24 δ t n 1 min δ t c f l n 1 δ t v s l n 1 the v s l constraint can be eliminated if an implicit scheme is used for the time advancement of the diffusive terms the limiting value of c f l m a x depends on the temporal discretisation scheme of the convective terms and its stability limits the limitation of 5 in the change between successive time steps mentioned earlier could lead in regions where the c f l value would not satisfy the limit of c f l m a x such a scenario does not appear in the simulations since there are no rapid changes in the velocity components this is also related to the generally small values of c f l m a x and consequently time steps that are required by the constant coefficient approach a detailed analysis of the effect of the upper value for c f l m a x in combination with the splitting scheme is presented in section 3 1 2 5 wave generation and absorption in the new nwt the relaxation method was adopted for the wave generation and absorption the relaxation method was presented in mayer et al 1998 and it is also adopted by well known open source cfd tools such as openfoam jacobsen et al 2012 and reef3d bihs et al 2016 the basic idea of this method is to smoothly remove waves that travel towards a specific direction where a non reflecting boundary is desired the nwt consists of different zones that are depicted in fig 2 the actual simulation takes place in the working section the generation of the desired waves is performed at the left side of the nwt by the wavemaker and the relaxation zones in the wavemaker zone the analytical solution of the desired wave to be simulated is imposed by updating the velocity components and the position of the free surface at every time step this is performed gradually from the left boundary up to the end of the wavemaker zone meaning that the exact solution of the simulated wave is applied only at the end of the wavemaker zone while at its left boundary zero velocity and free surface elevation are applied the imposed values for the velocity and the free surface elevation are given by 25 u x 1 r x u t a r g e t x 26 φ x 1 r x φ t a r g e t x where u t a r g e t and φ t a r g e t are the analytical values that correspond to the generated wave for the specific location and time instant r x is a smoothly varying function which is equal to unity at the beginning of the zone and equal to zero at its end in the relaxation zone which is located exactly next to the wavemaker zone the desired waves are generated while at the same time any reflections travelling towards this zone from right to the left are smoothly absorbed in this zone the computed velocity components and the free surface elevation are replaced by their relaxed values according to the analytical values therefore any disturbances deviations from the analytical values are smoothly removed from the simulation the relaxed values are given by 27 u x 1 r 1 x u t a r g e t x r 1 x u c o m p u t e d x 28 φ x 1 r 1 x φ t a r g e t x r 1 x φ c o m p u t e d x where u c o m p u t e d and φ c o m p u t e d refer to the calculated values by the solution of the ns equations in case a non reflecting boundary is required at the right side of the nwt an absorption zone is used to smoothly absorb waves propagating from left to right therefore this zone operates as an outlet or a numerical beach in this zone the values of both u and φ are relaxed by 29 u x 1 r x u t a r g e t x r x u c o m p u t e d x 30 φ x 1 r x φ t a r g e t x r x φ c o m p u t e d x where u t a r g e t is set to zero and the values of φ t a r g e t correspond to the still water depth in eqs 25 30 x represents the non dimensional horizontal position of each zone defined by 31 x x x b z o n e x e z o n e x b z o n e where x b z o n e and x e z o n e denote the begin and end of each zone respectively the relaxation function used in this study is the one presented in jacobsen et al 2012 in the form 32 r x 1 e x c r 1 e 1 f o r x 0 1 where c r is the coefficient of the exponential usually taken equal to 3 5 comparing the relaxed functions of the relaxation zone eqs 27 and 28 to that of the absorption zone eqs 29 and 30 the input parameter in the relaxation function r is set to 1 x instead of x so that r 1 and r x 0 at the end of the relaxation zone i e x 1 the variation of the relaxation function along the absorption and relaxation zones is schematically shown in fig 1 it is worth mentioning that the wave theories employed for the calculation of the values of the imposed free surface elevation and velocities in the wavemaker and relaxation zones assume an inviscid and irrotational flow as a result the bottom boundary condition in these regions is always set to free slip moreover at the beginning of the simulation a ramp function in time is employed to achieve the desired wave values the ramp function lasts one wave period and its purpose is to eliminate the impulse effect when a sudden velocity is introduced to the wavemaker at the first time step the simulation steps for the developed nwt algorithm are summarised below 1 initialisation of the interface position φ field velocity and pressure fields 2 calculation of the time step δ t n 1 to satisfy stability limits from eq 24 3 update of the position of the interface solving eq 6 4 calculation of the minimum signed distances φ around the interface from eq 7 5 update of the φ field in the wavemaker relaxation and absorption zones using the corresponding relaxation functions eqs 26 28 and 30 6 calculation of the provisional velocity field u from eq 14 7 modification of u for the nodes close to the ib to satisfy the no slip wall bc 8 solution of the constant coefficient poisson equation for the pressure difference eq 19 using a fds 9 correction of the pressure and velocity fields at the new time instant using eq 20 and eq 21 10 update of the velocity field in the wavemaker relaxation and absorption zones using the relaxation functions eqs 25 27 and 29 11 return to step 2 for the new time step 3 validation in this section the validity of the new nwt is demonstrated in several benchmark test cases first the spatial and temporal accuracy of the nwt was examined for 2 n d order stokes waves section 3 1 and a standing wave section 3 2 for these simpler flow cases the ib method was not used so that the effectiveness of the constant coefficient poisson formulation could be compared against analytical solutions the capability of the nwt to capture complex hydrodynamic phenomena was examined by simulating a spilling breaker over a constant slope bed section 3 3 the interaction of a solitary wave with a rectangular abutment section 3 4 and the diffraction of a solitary wave by a single row pile breakwater section 3 5 in all test cases presented hereafter the non dimensionalisation was based on the still water depth d fig 2 as the characteristic length scale l o and g d as the characteristic velocity scale u o following these definitions the froude number was equal to unity 3 1 stokes waves in this validation the two dimensional vertical 2dv propagation of nonlinear stokes waves was simulated in order to assess the performance of the nwt in terms of its spatial and temporal accuracy 2 n d order stokes waves were generated in the wavemaker zone with wave height h 0 1 d wave period t 5 235 d g and wavelength λ 4 d the dimensions of the computational domain were l x l z 60 d 2 d the total simulation time was set to 50 wave periods to demonstrate that the nwt has negligible numerical dissipation and dispersion errors after long integration times for a direct comparison with the analytical solution the diffusion terms of eq 15 were deactivated in order to model inviscid and irrotational flow and the velocity bc on the bed was set to free slip an open bc was applied along the top boundary enforcing homogeneous neumann bc for both horizontal and vertical velocity components for the pressure a homogeneous neumann bc was used in all boundaries except in the upper one where constant atmospheric pressure was applied using a dirichlet bc to ensure the absence of reflections in the working section 16 x d 36 long relaxation and absorption zones were used i e 16 d and 24 d corresponding to 4 λ and 6 λ respectively the time step was only governed by the c f l criterion the v s l restriction was negligible due to the absence of viscous terms all the following results refer to the periodical steady state solutions first the spatial accuracy was examined by setting c f l m a x 0 025 where the temporal errors were found to be negligible uniform grids were used in both vertical and horizontal directions two vertical resolutions δ z d 0 025 d and 0 125 and three aspect ratios a r δ x δ z 4 2 and 1 were considered the comparison of the theoretical wave profile against the calculated one for different grid resolutions is shown in fig 3 while the corresponding maximum errors for the wavelength ε λ the wave crest level ε c r e s t the wave trough level ε t r o u g h and the wave height ε h are shown in table 1 the wave crest and trough levels were captured with a maximum error of less than 1 6 for all grid resolutions while the wave height was captured with an error less than 1 regarding the wavelength it is observed that the results gradually converge to the analytical solution as the horizontal resolution increases for the coarser vertical resolution fig 3a the wavelength is slightly underestimated but the error is less than about 1 for a r 2 for the finer vertical resolution fig 3b the underestimation of the wavelength is even smaller with an error less than about 0 1 for a r 2 the temporal accuracy of the nwt was tested using a fixed grid size of δ x δ z 0 025 d 0 0125 d where the results were found to be grid independent the time step was dynamically adapted according to the c f l restriction of eq 22 by setting the value of c f l m a x five different values of c f l m a x were examined as shown in fig 4 for the larger value of c f l m a x 0 2 the wavelength was underestimated by about 6 while the wave height was in general decreasing in the working section using smaller time steps c f l m a x 0 1 the predicted wave height and wave crest and trough levels have less than 1 error in comparison to the analytical solution for the wave length the error was down to about 0 5 for c f l m a x 0 05 and diminished to 0 1 for smaller time steps c f l m a x 0 025 therefore based on the examined case it was concluded that c f l m a x 0 025 is the appropriate value to ensure negligible numerical dissipation and dispersion errors to further investigate the origin of the temporal error identical simulations were performed solving the variable coefficient poisson equation eq 16 with an lu based direct solver the variable coefficient solver with c f l m a x 0 1 achieves the same accuracy with the constant coefficient one with c f l m a x 0 025 the same value of c f l m a x 0 1 was also reported to diminish temporal errors in a conventional nwt with the open source software reef3d bihs et al 2016 it is therefore evident that the stricter time step requirement of the present nwt does not originate from the time advancement scheme but from the splitting scheme of eq 17 therefore one may conclude that a c f l reduction of four times is required in the present nwt which is based on a constant coefficient poisson equation due to the effect of the splitting scheme in frantzis and grigoriadis 2019 it was shown that the time step reduction factor is governed by the density ratio of the two fluids simulated as it is demonstrated in section 4 though even with this additional cost of performing four times more time steps the present nwt is still computationally more efficient compared to conventional approaches which are based on the variable coefficient poisson equation as mentioned in section 2 4 the novelty of the proposed nwt is the solution of a poisson equation with constant coefficients for the calculation of the pressure therefore in order to ensure that the dynamic pressure is also accurately calculated the numerical predictions of the proposed nwt were compared against the analytical solution of 2 n d order stokes waves and the numerical results provided by the variable coefficient poisson equation as demonstrated in fig 5 the numerical results correspond to a numerical grid of δ z d 0 0125 d and δ x d 0 0250 d and a c f l m a x value of 0 025 and 0 100 for the constant and the variable coefficient approach respectively fig 5a and fig 5b show the vertical profile of the dynamic pressure below a crest and a trough location respectively in the working section according to these results it is evident that the new nwt has the same accuracy for the dynamic pressure prediction as the conventional one with the variable coefficient poisson equation deviations between the numerical results and the analytical solution occur mostly near the bed and free surface regions as it was anticipated the latter are the consequence of the fact that in the numerical one fluid treatment the density changes gradually from water to air across the free surface apart from that smaller differences with the analytical solution which assumes potential flow arise due to the numerical dissipation in the nwt even though the diffusion terms were eliminated by setting r e which is introduced mainly by the upwind scheme quick used for the discretisation of the convective term in eq 15 therefore it can be safely concluded that the new nwt provides the same degree of accuracy with the conventional approach when the additional temporal error is eliminated by using smaller time step values i e c f l m a x 0 025 3 2 formation of a standing wave in this validation the nwt was assessed in terms of the performance of its relaxation zone which is essential for the concurrent generation of waves and absorption of returning wave due to reflections to this purpose a 2d standing wave was simulated to demonstrate that even the most extreme reflections can be absorbed the dimensions of the computational domain were l x l z 30 d 2 d in order to simulate a perfect wave reflection from a vertical wall for comparison with the analytical solution of stanging waves the diffusion terms of eq 15 were deactivated in order to model inviscid and irrotational flow and free slip bcs were imposed on the bed and the right reflective wall an open bc was applied along the top boundary the wave parameters were identical to the ones used in section 3 1 i e h 0 1 d and λ 4 d the length of the relaxation zone was set equal to four wavelengths a uniform grid was used in both vertical and horizontal directions using grid sizes of δ x δ z 0 025 d 0 0125 d following the analysis of the previous section the time step was dynamically adapted according to the c f l criterion by setting c f l m a x 0 025 a total simulation time of 50 wave periods was used after a transient interval of about 20 wave periods a standing wave was clearly established in the domain and the solution did not deviate between successive wave periods typical snapshots of the free surface profile every 1 16 of the wave period are presented in fig 6 in the relaxation zone the returning reflected wave is dissipated and the incident wave height value is recovered at x 12 d i e within one wavelength from the right side of the relaxation zone in the working section the expected pattern of nodes and antinodes of a standing wave is observed while the height of the standing wave is twice the incident one the maximum error for the prediction of crest and trough levels was less than 2 while the maximum error for the wavelength was less than 1 these results verify that the implemented wavemaker relaxation method is very capable to concurrently generate waves and absorb extreme reflections 3 3 spilling breaker in this validation a spilling breaker was simulated in order to assess the implementation of the ib method and the capability of the nwt to capture challenging nearshore processes employing fast direct pressure solvers in a computational domain with immersed bodies could possibly generate numerical instabilities for two fluid problems this is a matter of concern especially in areas where the free surface interface intersects solid obstacles frantzis and grigoriadis 2019 in conventional nwts using the ib method this is not an issue because the solid parts of the domain are excluded from the variable coefficient poisson equation solver e g reef3d bihs et al 2016 employed the ib method for the simulations of the experiment in ting and kirby 1996 the well documented experimental study in ting and kirby 1996 was also selected for the present validation this challenging case involves spilling wave breaking along a mild slope bed as shown in fig 7 this case has been studied numerically by several researchers using different approaches for instance water phase only models were presented solving the euler equations and using breaking models based on the boussinesq equations dimas and dimakopoulos 2009 or the large wave simulation dimakopoulos and dimas 2011 the most generalised approach of solving the ns equations which models the physical problem with the least assumptions has been extensively adopted to study this spilling breaker case chella et al 2015 christensen 2006 guo et al 2013 horikawa 1988 jacobsen et al 2012 wang et al 2009 xie 2013 zhao et al 2004 for the present simulations the original experimental configuration was used without modifications allowing the inclusion of the motion of the free surface in the swash zone i e wave setup and run up contrary in some studies e g guo et al 2013 jacobsen et al 2012 the sloping bed was modified at the shoreline in order to be fully submerged and eliminate the existence of a contact point between the free surface and the sloping bed which introduced robustness issues in the particular two fluid models the intention of including the physical swash zone in the present model was to demonstrate the absence of such robustness issues in the presented nwt in the experimental study the water depth in the horizontal region was equal to d 0 4 m and the slope of the bed was 1 35 the wave height of the incident waves was h 0 125 m with a period of t 2 s to match the experimental conditions incident waves with h 0 3125 d and t 9 903 d g were generated at r e 789 238 using the linear dispersion relationship the wavelength was estimated to be λ 9 236 d the length of the relaxation zone was set equal to one wavelength l r z 9 236 d the dimensions of the 2d computational domain were l x l z 60 d 2 5 d with the sloping bed starting at a distance of 20 d from the left boundary of the nwt for this set of parameters according to the wave theory diagram kamphuis 2010 le méhauté 2013 the us army corps of engineers 1973 the 5 t h order stokes theory is considered as marginally valid christensen 2006 therefore the wave generation was performed using the 5 t h order stokes theory reported in fenton 1990 other numerical studies chella et al 2015 xie 2013 zhao et al 2004 adopted the cnoidal theory of a 3 r d order horikawa 1988 or a 5 t h order fenton and herbich 1998 approximation there are also studies brown et al 2016 jacobsen et al 2012 that used the stream function theory rienecker and fenton 1981 two different uniform grids were employed a coarse one with n x n z cells and a finer one with n x n z 2400 200 cells similar to the one used by chella et al 2015 the results presented here are reported for the finer grid which proved to sufficiently resolve the quantities of interest the time step was dynamically controlled restricted by c f l m a x 0 02 and by v s l m a x 0 03 eq 24 the smagorinksy sgs model was used with c s 0 2 christensen 2006 the simulation was performed for a total of 40 wave periods to ensure that the robustness of the algorithm is maintained for long integration times the last ten periods were used to collect period averaged and phase averaged results which are presented below the number of simulated wave periods in the present study was large when compared to a number of previous studies for instance in chella et al 2015 and other studies christensen 2006 wang et al 2009 xie 2013 simulations for 10 12 5 20 and 25 wave periods were performed respectively longer simulations have been performed by jacobsen et al 2012 and brown et al 2016 using 130 and 50 wave periods respectively the evolution of the free surface along with the velocity magnitude and vector field in the water is shown in fig 8 the free surface elevation z relative to the mean free surface elevation η x is displayed in fig 9 at the locations of the wave gauges w g in fig 7 located at x d 3 75 1 25 11 25 13 75 15 0 16 75 17 5 20 0 the comparison against the experimental data in ting and kirby 1996 shows a very good agreement specifically only minor differences are observed in the horizontal region upstream of the slope w g 1 and w g 2 which are attributed to the use of the 5 t h order stokes theory to numerically generate the waves that unavoidably deviate slightly from the waves generated experimentally further downstream the presence of the sloping bed has a dominant role in modifying the incident waves it is therefore not surprising that the agreement is actually improved in this region w g 3 w g 5 and even after the wave breaking location w g 6 w g 8 in addition fig 10 shows the comparison of the free surface envelope between the present numerical results and the experimental data in ting and kirby 1996 first of all regarding the wave breaking location i e depth and height that offer challenges to be accurately captured a very good agreement is observed at x d 16 0 as far as the crest level with respect to the mean free surface elevation η m a x η d is concerned which is not always accurately captured an almost perfect agreement was found in all stream wise locations due to turbulence the free surface elevation and consequently the corresponding values for the crest and the trough levels differ between periods thus η m a x d and η m i n d were calculated by averaging the crest and trough elevation respectively of the five last periods considerable differences between η m a x d and its averaged value were found only in the region after the wave breaking and close to it i e 17 x d 26 after the breaking point in the surf zone the predicted wave height decreases at the same rate as in the experiments showing that the wave dissipation was predicted correctly only in the inner surf zone which is closer to the swash zone the crest level was slightly over predicted also a very good agreement was found for the trough level with respect to the mean free surface elevation regarding the mean free surface elevation it was found to be in satisfactory agreement in the surf zone i e after the breaking point and slightly before the breaking point in the region with larger water depth this was slightly over predicted which might be attributed to the deviations between the numerically and experimentally generated waves as mentioned before to further validate the accuracy of the nwt the comparison of the horizontal velocity component at three vertical levels and three horizontal locations is displayed in figs 11 13 for locations u m 1 u m 3 in fig 7 the numerical model seems to perform better close to the free surface compared to the region close to the bed a slight over prediction of horizontal velocity occurs close to the bed which was also observed in other similar numerical studies chella et al 2015 zhao et al 2004 figs 14 and 15 present the comparison for the phase averaged vertical component of velocity w at three vertical levels for the locations of u m 2 and u m 3 in fig 7 the comparison looks quite convincing accurately capturing the temporal variation and the maximum and minimum values at all locations moreover the comparison for the undertow profiles period averaged velocity at six locations in the surf zone x d 3 75 1 25 11 25 13 75 15 0 16 75 17 5 20 0 is presented in fig 16 where variables are non dimensionalised with respect to the local mean water depth h x d x η x and d x is the corresponding still water depth and η x is the mean free surface elevation in accordance with the phase averaged horizontal velocity the undertow profiles are predicted more accurately at the levels closer to the free surface for locations of the surf zone further away from the breaking point with smaller water depths the predicted undertow is underestimated especially close to the bed this could be an indication of limited numerical resolution in this area because fewer grid nodes exist within the water depth for shallower locations for instance the vertical distance between the still water level and the inclined bed includes approximately 42 cells at the location x d 16 6625 while at the inner surf zone of x d 24 3125 only 23 cells are included for locations even closer to the coast the results would be less reliable since fewer gird cells exist between the bed and the free surface while a number of grid cells correspond to the artificial thickness smoothing distance of the interface where the density is smaller than that of the water moreover the discrepancies in the simulated undertow might be attributed to an over dissipation of the sgs model close to the bed failing to capture the increased gradients u z that are occurred in the inner surf zone locations based on the results in brown et al 2016 where different rans models were examined the simulated undertow is very sensitive to the selected turbulence sgs model this argument is further supported by the results in christensen 2006 where the les with the smagorinsky sgs model was used similar to the present study indicating that the bottom close undertow was underestimated at the locations closer to the coast as well even though the variable coefficient poisson was solved therefore it is safely concluded that the differences in undertow are not attributed to the alternative solution of the poisson but only to the selected turbulence model summarising the results presented in figs 9 16 and comparing them with the numerical results reported in other studies that used conventional nwts e g brown et al 2016 chella et al 2015 christensen 2006 xie 2013 zhao et al 2004 the accuracy is very satisfactory even for very long integration times numerical instabilities were not present in the region where the sea bed was intersected by the free surface the present nwt seems to fail capturing the undertow profile closer to the bed at locations in the inner surf zone closer to the coast however according to the above discussion this might be attributed to the selected turbulence model which requires further investigation by testing other sgs models or using a wall function which might be more appropriate due to the under resolution of the boundary layer therefore it is concluded that the proposed nwt can simulate breaking waves with comparable accuracy to that of conventional nwts 3 4 3d interaction of a solitary wave with a rectangular abutment in this validation the interaction of a solitary wave with an abutment was simulated to demonstrate the capability of the nwt in capturing complex 3d flows the numerical results are compared against the experimental measurements in higuera et al 2013b and lara et al 2012 the experiments were conducted in a wave tank with a still water depth d 0 45 m and width w n w t 0 58 m as schematically shown in fig 17 a rectangular abutment with dimensions w a b t l a b t 0 3 0 24 m was attached to the left wall of the wave tank with respect to the wave direction in this case the x axis is the stream wise horizontal z axis is the vertical and y axis is the span wise coordinate the offshore face of the abutment is at a distance x a b t 8 96 m from the end wall of the wave tank a solitary wave with a height of h 0 1 m travels along the wave tank interacts with the abutment reflects at the end wall of the wave tank and re interacts with the abutment the characteristic length and velocity scales for this case are l o d 0 45 m and u o g d 2 101 m s using these scales the non dimensional wave height and reynolds number were h d 0 222 and r e 941 752 the height of the computational domain was chosen to be twice the still water depth i e h n w t d 2 here the length of the nwt was l n w t d 52 889 which includes a wavemaker zone of length l w m d 8 889 and a relaxation zone of the same length l r z d 8 889 a uniform mesh was used in all three directions while the poisson equation was decomposed into multiple 2d systems of equations by performing fft decomposition along the stream wise x direction this decomposition allows an efficient parallelisation of the poisson solution and a significant reduction of memory requirements discussed in detail in section 4 the generation of the solitary wave was performed using the 3 r d order analytical solution in grimshaw 1970 the presence of the abutment was taken into account using the ib method the smagorinsky sgs model was used with c s 0 1 because the larger value of 0 2 was found to over dissipate the wave height when coarser grid resolution was used the time step was dynamically controlled using the v s l and c f l criteria by setting c f l m a x 0 02 and v s l m a x 0 03 for a total simulation time of 100 dimensionless time units t o l o u o which corresponds to about 21 5 s regarding the discetisation of the domain four different numerical grids were used as indicated in table 2 the first three grids that correspond to c o a r s e m e d i u m and f i n e resolution respectively were used to investigate the convergence of the model while the finest grid used f i n e 2 was performed to present the computational performance of the model when large grids are required snapshots of the free surface elevation in fig 18 a and fig 18b show the interaction of the incident and the reflected respectively solitary wave with the abutment as it was computed by the finest grid f i n e 2 the free surface elevation was recorded at several locations in the nwt fig 17 which coincide with the locations of wave gauges table 3 in the corresponding experimental and numerical studies higuera et al 2013b lara et al 2012 and bihs et al 2016 the comparison to the experimental data is shown in fig 19 two peaks in each free surface elevation recording can be clearly observed for all wave gauges these peaks correspond to the passage of the solitary wave before first peak and after second peak its reflection at the end wall of the wave tank for the wave gauges seawards of the abutment w g 1 w g 4 the first free surface peak is always greater than the second one on the other hand for the wave gauges leewards of the abutment the second peak is either greater or at least comparable to the first one for all gauges examined these peaks in the free surface elevation recordings are quite accurately captured in the new nwt and all grid resolutions examined as far as the convergence is concerned it is concluded that the m e d i u m grid with a total of about 3 8 10 6 cells is sufficient while finer resolutions does not seem to significantly affect the results the error of the simulations with respect to the experimental measurements was calculated as η n u m η e x p η e x p where η e x p and η m u m are the peak values of the experiments and the present numerical results respectively the maximum error among all wave gauges was 7 4 for the first peak in w g 4 and 2 4 for the second peak in w g 1 additionally the time interval between peaks is also in excellent agreement with the experimental data which is an indication that the celerity of the solitary wave was accurately captured the simulation with a numerical grid of n x n y n z 2600 64 100 cells resulting to a total of 16 64 million grid cells was performed to demonstrate the computational performance of the presented efficient nwt regarding the computational cost of this simulation a total of 35 h were required for the simulation of 100 time units i e an average of 1 63 h per second simulated the simulation was executed exclusively on a single server equipped with 64 g b y t e s of ram and two intel r xeon r e5 2680 cpu units of 14 cores each synchronised at 2 4 g h z the same simulation could be completed in less than a week on a personal computer or a modern laptop 3 5 3d interaction of a solitary wave with a single row pile breakwater in this section an additional 3d flow problem was simulated to further examine and demonstrate the capabilities of the new nwt for this purpose the interaction of a solitary wave with a pile breakwater was simulated following the study in jiang et al 2015 the case selected includes extreme deformation of the free surface leading to breaking and air entrapment phenomena apart from experimental measurements numerical predictions for the global forces exerted on the piles were also reported in jiang et al 2015 using the waves2foam module of openfoam jacobsen 2017 the experiments were performed in a wave flume with dimensions of 45 m in length 0 8 m in width and water depth d 0 2 m the pile breakwater consisted of a single row of circular piles with diameter d c y l 0 05 m a schematic diagram of the simulated case is presented in fig 20 showing three of the piles the experimental reynolds number was r e 279 152 the diameter of the pile was d c y l 0 25 d and the centre to centre distance between two adjacent cylinders was s 0 4 d these parameters correspond to a gap width of e 0 15 d and a porosity of the pile breakwater ε e s 37 5 the height of the examined incident solitary wave was h i 0 35 d the free surface elevation at a specific location and time is denoted by η x t the incident height h i and the reflected height of the solitary wave were identified by the recording of a wave gauge sensor w g 1 positioned 3 0 m seawards of the centre of the piles the free surface elevation was also recorded by a second sensor w g 2 located at a distance of 1 0 m seawards of the piles in the leeward side of the piles two additional sensors w g 3 and w g 4 were also placed at distances of 0 5 m and 1 5 m respectively in order to obtain the transmitted wave height the stream wise and vertical velocity components of the velocity were measured using two acoustic doppler velocimetry a d v sensors located 0 5 m seawards and 0 3 m leewards from the piles both a d v sensors were placed 0 08 m above the seabed and at the transverse location corresponding to the middle of the gap between piles in the experimental part of the study in jiang et al 2015 the breakwater consisted of ten piles confined by the side walls of the wave tank in the present study the computational domain was truncated along the span wise y direction to save computational resources in the numerical part of the study in jiang et al 2015 a truncated domain was also used including five cylinders in the span wise direction in the present study after a series of preliminary simulations with five three and one pile it was concluded that even considering a single pile was sufficient provided that periodic bcs were employed along the span wise direction therefore for all the presented results below a periodic single pile was considered the bottom boundary of the numerical flume was prescribed as a no slip wall along the top boundary of the flume open bcs were applied at the domain s outlet and for the case presented in this paragraph only instead of employing an absorption zone a convective outlet bc was used 33 u t u c u 0 where u c is the convective velocity which was chosen equal to the celerity of the incident solitary wave the dimensionless value of the wave celerity given by the analytical solution of grimshaw 1970 reads 34 u c 1 1 2 h i d 3 20 h i d 2 3 56 h i d 3 for this specific case of a solitary wave adopting a convective outlet bc instead of an absorption zone proved to be a justified choice after a series of preliminary simulations as it will be demonstrated below for different wave conditions the effectiveness of this approach to minimise reflections could be investigated but falls outside the scope of the present study the total length of the numerical wave flume was 50 d this comprised of a wavemaker zone l w m 5 d a relaxation zone l r z 10 d and a working section l w s 35 d the height of the numerical wave flume was chosen equal to h n w t 2 d and the span wise extent was w n w t 0 4 d the centre of the pile breakwater was at a distance x c y l 25 d from the end of the relaxation zone fig 20 a uniform grid was used along the span wise y and vertical z directions in the stream wise direction x a constant grid spacing δ x m i n was used in the region 10 d c y l with respect to the centre of the pile breakwater seawards and leewards of this region the grid size was expanding linearly at a rate of 3 till a maximum value of δ x m a x 4 δ x m i n which was maintained in the rest of the nwt similar to the validation case of section 3 4 the 3d domain is decomposed into multiple 2d planes in this case though the fft decomposition is performed in the span wise direction where both bcs are neumann and equidistant grid is used since the fft is not performed in the other directions the grid spacing in these directions does not have to be uniform two different grid resolutions were tested a coarser grid with n x n y n z 1342 32 150 6 4 million cells and a finer one with 1990 48 200 19 1 million cells the minimum grid size in the stream wise direction was δ x m i n d 80 and d 120 for the coarser and the finer grid respectively the smagorinsky sgs model was used with c s 0 2 and the c f l m a x and v s l m a x were set equal to 0 02 and 0 03 respectively concerning the computational cost a total of 18 and 78 h were required for the coarser and the finer grid respectively when executed on a single server using 28 cores synchronised at 2 4 g h z the comparison of the free surface elevation and the velocity measurements recorded by the wave gauges w g 1 4 and the two velocity sensors a d v 1 2 is presented in figs 21 and 22 respectively both coarse and fine grids were found to accurately capture the temporal evolution of the free surface in terms of the peak values for both seaward w g 1 2 and leeward w g 3 4 locations in the seaward region fig 21a and fig 21b the second peak recorded by each sensor w g 1 and w g 2 corresponds to the wave reflected by the piles of the breakwater the elevation of this reflected wave was found to be in perfect agreement with the predictions reported in jiang et al 2015 using openfoam compared to the experimental measurements all numerical results were found to over predict the elevation of the reflected wave especially at w g 1 in the leeward region the primary peak of the free surface elevation evolution w g 3 and w g 4 in fig 21c and fig 21d corresponds to the transmitted wave this was found in almost perfect agreement with both the experimental and the numerical results in jiang et al 2015 a secondary peak of free surface elevation appears in the openfoam results only this could be an indication of insufficient absorption of the transmitted wave at the end of domain which generates a small reflection the present results are in better agreement with the experimental measurements in the leeward region of the breakwater indicating that the adoption of a convective outlet bc eq 33 is capable of restricting reflecting waves in the case of a solitary wave the predicted velocity time series in the new nwt are in very good agreement with both the experimental measurements and the openfoam results jiang et al 2015 in the seaward region a d v 1 in the leeward region a d v 2 all numerical results show deviations from the experimental data after the primary peak in this region these differences may be attributed to the sgs contribution of the turbulence model which are activated by intense vortical motions and disturb the flow locally the consistency of the present nwt to accurately predict the global forces exerted on the piles is presented in fig 23 the present numerical results using two different grid resolutions were compared with those provided in jiang et al 2015 using openfoam in the present nwt the global force is calculated in a straightforward manner by integrating the pressure and the viscous forces around the surface of the pile the good agreement between the different numerical models shown in fig 23 verifies the consistency and the capability of the present nwt to accurately calculate and predict global forces acting on the ib solid interfaces small deviations between the present nwt and openfoam results are sensible especially if one considers the differences on grids numerical techniques and free surface tracking methods the evolution of the free surface shape during the incidence of the solitary wave and its diffraction by the piles of the breakwater is shown in fig 24 observing these snapshots it is obvious that the simulated case is characterised by a violent motion of the free surface which includes breaking events and air entrapment the backward breaking that occurs can be explained as a hydraulic jump since the solitary wave behaves similar to unidirectional flows in the vicinity of the crest location 4 computational performance in this section the performance and the efficiency of the proposed nwt is assessed against a conventional approach the analysis focuses on the poisson solution which is the most computationally intensive procedure of the simulation in order to demonstrate and quantify the advantage of the proposed nwt the computational cost of the constant coefficient poisson solver with fds presented in section 2 4 is compared against a variable coefficient one using an iterative solver it is noted that the results presented in this paragraph refer to the speed up of solving the poisson only and its effect on the total speed up when an explicit scheme is used for the temporal advancement of the velocity field for a code that uses an implicit scheme for the temporal discretisation the effect of the poisson speed up on the total speed up would not be the same due to the different percentage of poisson s computational cost to the total cost and due to the increased time step values that can be used by the implicit schemes to provide accurate predictions one should perform the relevant simulation tests to estimate the speed up or speed down the implementation of the new nwt employs a fishpak based grigoriadis et al 2004 fds with fft decomposition along a single direction to solve the constant coefficient poisson equation eq 19 using openmp directives for the paralellisation the conventional approach was based on the variable coefficient poisson equation eq 16 which was solved using an iterative solver the most popular choices for iterative poisson solvers are the algebraic multigrid amg and the jacobi preconditioned bicgstab the comparison between fds and the amg iterative solver was already presented in dodd and ferrante 2014 and frantzis and grigoriadis 2019 for two fluid flow problems in dodd and ferrante 2014 the performance results were carried out using a domain with triple periodicity and a resolution of 1024 grid cells in each direction using a fds which performed fft decomposition in all three directions and 1024 computing cores for the simulations the speed up for the solution of the poisson was measured to be about 20 60 according to the selected convergence tolerance for the amg iterative solver as a result the total speed up was found to be about 10 40 later frantzis and grigoriadis 2019 compared the computational performance of an amg iterative solver and a fds that is parallelised with openmp and uses fft decomposition along a single direction of the domain only for a domain of 320 256 320 grid cells and a density ratio equal to 1000 which is closer to that of water and air a speed up of about 300 was measured for the poisson solution they also found that a time step reduction might be required which for the problems of their interest was proportional to the density ratio between the two fluids simulated for the problems of their interest and a density ratio equal to 1000 the required time step reduction factor was found equal to 10 concluding in a final speed up equal to 10 in the present study the fds is compared against the jacobi preconditioned bicgstab which is also used by the open source cfd software reef3d bihs et al 2016 the current implementation of bicgstab for poisson solution employs the widely used hypre library falgout and yang 2002 with message passing interface mpi it should be noted that the poisson equation is solved to machine precision with the fds while a user defined convergence tolerance is required by an iterative solver to set this value preliminary runs with the bicgstab based solver indicated that comparable flow fields are achieved using the default value of the convergence tolerance i e 10 7 for the norm of the relative residual to achieve the same accuracy between the two approaches a c f l reduction factor r f of four was required for the fds based solver as was deduced by the c f l analysis of section 3 1 in order to eliminate the temporal splitting error of eq 17 consequently the values of the c f l m a x were set to 0 025 for the fds based solver and 0 1 for the bicgstab based solver the comparison was performed for a 3d nwt without any obstruction using wave parameters identical to the ones selected for the case of propagating waves in section 3 1 a domain of length l n w t 250 d width w n w t 5 d and height h n w t 8 d was used all performance tests were executed exclusively on a single server equipped with two intel xeon e5 2680 processors of 14 cores each synchronised at 2 4 g h z the performance of the two approaches is summarised in table 4 for five different grid resolutions ranging from a total of 1 280 million cells for each grid the cpu time of the poisson solution per time step is presented in the 2 n d and 3 r d columns for the two solvers the speed up of the fds over the bicgstab is shown in the 4 t h column for a single poisson solution i e without accounting for the c f l reduction as expected mainly because of the fft decomposition employed by the fds a remarkable speed up of about 240 520 was achieved the overall speed up of the full ns solution for the proposed nwt is reported in the last column of table 4 including the c f l reduction this speed up strongly depends on i the time step reduction factor r f ii the size of the problem and iii the percentage of the computational time of the poisson solution in the time step using the fds 5 t h column as demonstrated in section 3 1 a reduction factor of r f 4 is necessary for the case of a fds based nwt the overall speed up was found to increase substantially with the grid size for the smallest problem considered here the full ns simulation was accelerated approximately 6 times for larger problems where the computational cost is even more critical the simulation was accelerated up to about 30 times looking at the results of table 4 one could possibly argue whether the presented nwt would be favorable against conventional nwts with implicit schemes that allow significantly larger values of time step in order to obtain accurate results on the total speed up or speed down the relevant simulation tests should be performed because the cost of calculating the provisional velocity in a single time step is increased when an implicit scheme is used compared to the explicit ones a quite conservative prediction can be made by assuming that an implicit treatment of the velocity does not increase the cost per time step of calculating the provisional velocity taking this into account and considering that 20 times larger time steps i e c f l 0 5 and r f 20 can be used the final speed up last column of table 4 would be at least equal to 1 3 and 6 for the smaller and larger grid examined first and last row of table 4 respectively an additional advantage of the fds in the present nwt is the reduced demand for installed physical memory ram which also facilitates the simulation of considerably larger problems the ram required by the new nwt increases more or less linearly with the number of grid nodes demanding only 220 mbytes of ram per million grid nodes this advantage emerges from the fft decomposition which transforms the original 3d problem into multiple 2d problems planes the only coefficients which differ between these 2d problems are the diagonal ones therefore it is sufficient to store only one set of coefficients for a single 2d plane and just one dimensional array containing the diagonal part 5 conclusions a new method was adopted to develop an efficient nwt that solves the full set of the navier stokes equations for two fluid incompressible flow the new nwt offers the capability of simulating wave induced flows and their interaction with complex shaped impermeable coastal structures the latter is consistently coupled with fds for the solution of the resultant two fluid poisson equation frantzis and grigoriadis 2019 in the present study wave generation and absorption of regular and solitary waves is achieved using a relaxation method the interface separating water and air is modelled with the conservative level set method sgs motions were taken into account using the standard smagorinsky les model the proposed numerical wave tank is validated against analytical solutions experimental measurements and other numerical studies for different test cases i the inviscid propagation of 2 n d order stokes waves ii the formation of an inviscid standing wave iii the 2d spilling breaker over a mild slope bed iv the 3d interaction of a solitary wave with a vertical abutment and v the 3d interaction of a solitary wave and a single row pile breakwater it is demonstrated that the developed nwt is capable to accurately simulate wave hydrodynamic problems as far as the spilling breaker case is concerned an underestimation of the undertow was found in the proximity of the bed only for locations in the inner surf zone i e close to the coast however the lack of accuracy in these results is not attributed to the constant coefficient poisson equation since numerous results available in the literature that were generated with the conventional approach indicate similar agreement according to these results we concluded that this is related with the selected sgs model the computational performance of the proposed nwt was analysed and quantified against the conventional approach for various problem sizes when an explicit time stepping scheme is used speed up factors of about 30 were measured for large 3d problems even though four times smaller time steps were required compared to a conventional approach with an implicit time stepping that allows larger c f l values it was estimated that the proposed nwt would perform at least 6 times faster for large 3d problems such speed up factors enable highly resolved future investigations and parametric studies of computationally demanding wave induced nonlinear flow cases such as breaking waves with air entrainment the presented nwt can be further extended in several ways to allow the simulation of a wider range of challenging problems and wave parameters possible extensions include the adoption of different wave generation techniques such as the active wave absorption higuera et al 2013a or the inclusion of irregular waves lara et al 2006 in addition one could also employ wall approximate conditions different sgs models or interface capturing methods e g vof hirt and nichols 1981 and other parallelisation techniques e g mpi and or gpu computing the presented nwt can also be extended for the simulation of wave induced flows interacting with permeable porous structure without significant modification or any complication to the method using the darcy forchheimer equation to take into account the resistance forces relevant studies that coupled this equation with the ns equations can be found in jensen et al 2014 and del jesus et al 2012 furthermore the efficient simulation of strongly coupled fluid structure interaction fsi problems would be also feasible by extending the presented nwt to moving immersed boundaries author contributions section c frantzis methodology software validation formal analysis investigation writing original draft d g e grigoriadis supervision conceptualization software resources writing review editing funding acquisition a a dimas writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research leading to these results has received funding from the people programme marie curie actions of the european union s seventh framework programme fp7 2007 2013 under rea grant agreement n o 607394 seditrans 
22209,an efficient numerical model for wave induced flows and their interaction with impermeable coastal structures is presented using recent developments in the field of two fluid water air navier stokes ns simulations an efficient numerical wave tank nwt was developed which combines the immersed boundary ib method and fast direct solvers fds conventional ns based nwts require significant computational resources which prevents their use in discretisation demanding cases or extensive parametric studies the computational efficiency of the new nwt was achieved by replacing the conventional variable coefficient poisson equation with a constant coefficient one which is solved with a fds results of the accuracy limitations and computational performance of the nwt are presented and discussed based on several validation tests 1 propagation of a 2 n d order stokes wave 2 formation of a standing wave 3 spilling breaking over a mild slope bed 4 three dimensional 3d interaction of a solitary wave with a vertical abutment and 5 diffraction of a solitary wave by a single row pile breakwater the computational performance of the new nwt was demonstrated for problems with 1 280 million grid nodes the overall speed up of the new nwt increases with the problem size and it is estimated to be about 30 for large 3d problems keywords numerical wave tank 3d wave induced flow fast poisson solver level set method immersed boundary method computational efficiency 1 introduction the use of computational fluid dynamics cfd in wave induced flows based on the solution of the full set navier stokes ns equations is gaining attention in the ocean and coastal engineering community mainly because of the evolution in computing power however even today detailed three dimensional 3d ns simulations can be prohibitively expensive for practical applications because of the physical complexity and or the size of the problem considered therefore the development of efficient numerical methods is essential to reduce the required computational cost and enable easier access to discretisation demanding flow cases and extensive parametric studies a typical example of a challenging field for cfd is the modelling of 3d ocean and coastal flows with ns based numerical wave tanks nwts nwts of this type should be able to simulate complex hydrodynamic processes including phenomena such as wave breaking where the interaction between the air and the water phases should be taken into account the resultant ns equations are those describing the incompressible turbulent flow of two immiscible fluids separated by an interface the numerical solution of the equations is usually achieved by time marching approaches such as the classical fractional step method under these circumstances mass continuity is imposed by a poisson equation for pressure which is the most computationally intensive part of the simulation thus any reduction of the computational cost for the solution of the poisson equation significantly reduces the required computational resources in total in contrast to single fluid problems the poisson equation in two fluid flows depends on the time evolution of the density field as well therefore the motion of the interface eventually leads to a poisson equation with variable coefficients in space and time for conventional direct solvers e g lu based this means that a large matrix should be inversed at every time step leading to a prohibitively high computational cost until recently the most popular and the only affordable choice was the use of iterative solvers where the coefficients are updated at every time step without any matrix inversion there is considerable literature related to nwts using different discretisation methods e g finite differences finite volumes or finite elements and interface tracking approaches e g volume of fluid vof or level set their common characteristic is the use of an iterative solver for the variable coefficient poisson equation for instance the open source software reef 3d bihs et al 2016 solves the ns equations on cartesian staggered grids with the finite differences method and the tracking of the interface is performed with the level set method regarding the solution of the poisson equation there are multiple choices of iterative solvers such as the preconditioned bicgstab the conjugate gradient or the algebraic multi grid solver included in the mathematical library hypre falgout and yang 2002 the open source software openfoam also includes several nwt options like waves2foam jacobsen 2017 naoefoam sjtu cao and wan 2014 or ihfoam higuera et al 2014 using either a relaxation method or an active wave absorption approach higuera et al 2013a for the wave generation in all these openfoam implementations the finite volume method and the vof method are used for the descritisation and the interface tracking respectively the variable coefficient poisson equation is usually solved using the preconditioned conjugate gradient pcg solver with the geometric algebraic multi grid gamg as a preconditioner even though other options of iterative solvers and preconditioners are also available in openfoam similar solvers are also used by commercial codes such as flow 3d hirt 2011 ansys fluent ansys fluent 2011 and cfx ansys cfx 2012 in flow 3d the generalised minimum residual solver gmres is used while in ansys fluent and cfx the algebraic multi grid solver is coupled with an incomplete lu ilu smoother in house nwts presented so far guo et al 2013 ha et al 2014 wang et al 2009 also use iterative solvers for the variable coefficient poisson equation a breakthrough study in the area of two fluid flow simulations which enables significant reduction in computational cost was presented in dodd and ferrante 2014 where the variable coefficient poisson equation was transformed into a constant coefficient one an evident advantage of such a constant coefficient poisson equation formulation is that there is no need to rebuild the matrix of the equation at every time step the most important advantage though is that fast direct solvers fds can be employed which can accelerate the solution of the poisson equation by 1 2 orders of magnitude dodd and ferrante 2014 frantzis and grigoriadis 2019 the advantage of fds is more evident when 3d cases are simulated because of their parallel efficiency this is achieved by using fast fourier transformation fft to decompose the original 3d problem into a series of smaller 2d or 1d problems however the original formulation suggested by dodd and ferrante 2014 is suitable for flows on a cartesian domain without the presence of obstacles structures more recently this formulation was extended in frantzis and grigoriadis 2019 in order to enable the proper coupling with the immersed boundary ib method this extension allowed the use of the formulation even in cases where wave induced two fluid flows interact with obstacles structures immersed into a cartesian grid while all the advantages of using fds were maintained the purpose of the present study was to develop an efficient nwt by extending the method presented in frantzis and grigoriadis 2019 for wave induced flows and validate its suitability for offshore and coastal applications the developed nwt includes a wavemaker zone a relaxation zone and or an absorption zone similar to the ones described in guo et al 2013 and jacobsen et al 2012 which are based on the work of mayer et al 1998 an extensive validation is presented for 1 the propagation of a 2 n d order stokes wave 2 the formation of a standing wave 3 a 2d spilling breaker compared against experimental data ting and kirby 1994 1996 4 the 3d interaction between a solitary wave and a rectangular abutment compared against laboratory experiments lara et al 2012 and 5 the 3d interaction of a solitary wave with a single row pile breakwater compared against both experimental data and numerical results jiang et al 2015 the requirement of the method for small time steps as reported in frantzis and grigoriadis 2019 was also examined to quantify its effect on the computational performance and efficiency of the new nwt the paper is organised as follows the mathematical model and the numerical methods are described in section 2 section 3 includes benchmark and validation results for 2d and 3d cases the performance of the developed nwt is demonstrated in section 4 by comparing the computational cost against conventional nwts using iterative pressure solvers finally conclusions and discussion for the potential and the efficiency of the new nwt are presented in section 5 2 mathematical description and numerical methods 2 1 governing equations the incompressible flow of two immiscible viscous fluids where the surface tension effects are negligible is described by the navier stokes equations which in their non dimensional form read 1 u 0 2 u t u u 1 ρ r e μ r e μ t u u t p ρ a f r where u p ρ μ and μ t are the non dimensional velocity pressure density dynamic viscosity and dynamic turbulent eddy viscosity fields respectively all these variables evolve in space and time the non dimensional reynolds r e and froude f r numbers which appear in eq 2 are given by 3 r e u o l o ρ o μ o and f r u o 2 l o g where l o u o ρ o and μ o denote the characteristic scales for length velocity density and dynamic viscosity respectively in the present study ρ o and μ o correspond to the ones of the heavier fluid i e water in the right hand side rhs of eq 2 the term a denotes the non dimensional external acceleration vector field which in the general case may vary in space and time for the nwt presented here a is constant both in space and time i e 4 a g g where g is the gravitational acceleration vector 2 2 sub grid scale modelling the use of the large eddy simulation les is employed in the present nwt to model the sub grid scales sgs of motion which are not resolved by the grid in the les modelling framework the effect of the sgs motions is modelled by introducing additional viscosity to the flow called eddy viscosity this model has been used in the past to study either 2d or 3d wave hydrodynamics dimas and koutrouveli 2019 guo et al 2013 hieu and tanimoto 2006 li et al 2004 using the standard smagorinsky model smagorinsky 1963 the dynamic eddy viscosity is given by 5 μ t ρ c s δ 2 s where δ δ x δ y δ z 1 3 is the filter length scale defined by the grid sizes δ x δ y and δ z and s 2 s s 1 2 is the modulus of the strain rate tensor s in the standard version of the smagorinsky model the parameter c s has a constant value the optimal value of the smagorinsky constant c s varies according to the flow and ranges from 0 065 to 0 23 in the literature meyers and sagaut 2006 thus c s parameter can be tuned and set to a different value between cases in order to obtain the best possible agreement for the cases examined in the present study c s 0 2 unless otherwise stated to recover the proper near wall behaviour the eddy viscosity is modified with a van driest type of damping close to solid boundaries depending on the distance and the wall friction as described in grigoriadis et al 2003 for the cases presented here and the numerical resolution used wall functions are not applied however one could implement such wall function approximations without any complication in a similar manner different sgs and turbulence modelling approaches e g k ε k ω or detached eddy simulation des could also be employed 2 3 interface capturing and fluid properties the position and the motion of the interface is captured by the conservative version sussman et al 1998 of the level set method osher and sethian 1988 which is based on the solution of the advection and the re initialisation equations 6 φ t u φ 0 7 φ τ s φ o φ 1 f φ φ o δ φ o φ o where the scalar variable φ defines the signed distance from the interface and φ 0 corresponds to the position of the interface τ is an artificial time and φ o is the resultant field after the advection step eq 6 and before subjected to re initialisation eq 7 the functions s f and δ are defined as 8 s φ 1 if φ ε water φ ε 1 π sin π φ ε if ε φ ε interface region 1 if φ ε air 9 f φ φ o v s φ o 1 φ δ φ d v v δ 2 φ o φ o d v 10 δ φ 0 if φ ε water 1 2 ε 1 cos π φ ε if ε φ ε interface region 0 if φ ε air it is noted that the solution of eqs 6 and 7 is required only in a bandwidth around the interface see eq 13 solving these equations only in a narrow bandwidth around the interface might lead to spurious artifacts when merging or diverging interfaces occur in order to avoid such issues the modified advection equation proposed in peng et al 1999 is used a detailed description of the level set method implemented in the nwt is given in frantzis and grigoriadis 2019 in order to avoid numerical instabilities due to the discontinuous fields of density and viscosity an artificial thickness of the interface between the two fluids was introduced in this transition zone the density and the viscosity are considered to vary smoothly across the free surface according to 11 ρ ρ 1 ρ 2 ρ 1 h φ 12 μ μ 1 μ 2 μ 1 h φ where subscripts 1 and 2 correspond to water and air respectively h φ is the smoothed heaviside function osher and fedkiw 2006 defined as 13 h φ 0 if φ ε water 1 4 φ ε 1 π sin π φ ε if ε φ ε interface 1 if φ ε air and ε is a constant defining the half thickness of the transition zone typical values of ε range from one to three times the minimum gird size calderer et al 2014 in the present study ε was set equal to 2 min δ x m i n δ y m i n δ z m i n if the interface is rapidly deforming or the density ratio and the r e number are too large higher values of ε up to eight grid sizes iafrati and campana 2005 could be required the reader is referred to the study of iafrati and campana 2005 for a detailed discussion about the need for a larger artificial thickness of the interface and the effect of this value it has to be noted that very fine deformations of the free surface such as droplets and bubbles which are smaller than the spatial numerical resolution are not captured according to deane and stokes 2002 bubbles larger than the hinze scale 1 m m are subjected to fragmentation while the size of smaller bubbles is stable due to surface tension forces taking into account the smearing thickness of the interface the grid resolution should be even finer than the hinze scale to resolve the smallest bubbles droplets with pure air water in their core such a resolution is prohibitively expensive for real scale breaking waves that include air entertainment phenomena for a breaking wave an initially formed large air pocket experiences fragmentation generating smaller bubbles these bubbles start disappearing when their size becomes comparable to the grid spacing violating the mass conservation iafrati 2009 and consequently affecting the accuracy of the simulated breaking wave 2 4 numerical implementation and discretisation schemes the in house code developed in frantzis and grigoriadis 2019 was used to solve the equations presented in sections 2 1 2 3 the discretisation of these equations is performed using finite differences on a cartesian staggered grid arrangement the velocity components u v w are defined at the cell faces and the rest of the variables p ρ μ φ are defined at the cell centre the time advancement of the velocity and pressure fields was performed using the fractional step method chorin 1968 to solve eqs 1 and 2 the fully explicit 2 n d order adams bashforth scheme with a variable time step was employed for the temporal discretisation it is noted that when a variable time step is used a limit in the change of its value between successive time steps is required to avoid stability issues for instance when a rapid drop of the time step is computed the temporal advancement scheme converges to an explicit euler time stepping which is unconditionally unstable in the current implementation the time step change was limited to 5 between successive iterations even though the velocity did not change that rapidly to activate this restriction in the fractional step method a provisional velocity field is calculated at first which in our case reads 14 u u n δ t n 1 1 δ t n 1 2 δ t n ξ u n δ t n 1 2 δ t n ξ u n 1 where δ t n is the time step of the n t h iteration the operator ξ is defined by the rhs of eq 2 excluding the pressure gradient and the gravitational terms i e 15 ξ u n u n u n 1 ρ n 1 r e μ n 1 u n u n imposing mass continuity results into a variable coefficient poisson equation for the pressure field p n 1 16 p n 1 ρ n 1 1 δ t n 1 u a f r where the last term in the rhs is equal to zero because the acceleration vector does not change in space in dodd and ferrante 2014 the following splitting scheme was introduced 17 p n 1 ρ n 1 p n 1 ρ o 1 ρ n 1 1 ρ o p ˆ where p ˆ is an approximation of the pressure field at the new time step p n 1 using a variable time step p ˆ was calculated by a linear extrapolation according to 18 p ˆ 1 δ t n 1 δ t n p n δ t n 1 δ t n p n 1 when the splitting scheme of eq 17 is applied to eq 16 the poisson equation transforms into a constant coefficient one the adoption of the splitting scheme to obtain a constant coefficient formulation introduces an additional temporal error in the numerical procedure according to eq 17 this error is proportional to the time step size since a sufficiently small time step would lead to p ˆ p n 1 meaning that eq 17 will represent an exact relation and not an approximation anymore the need of using smaller time steps to eliminate the temporal error related with the splitting scheme is demonstrated and discussed in detail in frantzis and grigoriadis 2019 the original formulation of eq 17 was modified in frantzis and grigoriadis 2019 to achieve a proper coupling of fds and the ib method solving a constant coefficient poisson equation for the pressure difference δ p n 1 p n 1 p n 19 2 δ p n 1 ρ o δ t n 1 u 1 ρ o ρ n 1 p ˆ 2 p n the resultant poisson eq 19 is solved using a fishpak based fds grigoriadis et al 2004 which decomposes a 3d problem using fft along direction s with equidistant grid and periodic or homogeneous neumann boundary condition s bcs for the pressure difference in the present study a single fft decomposition is used for the 3d cases either along the span wise or the stream wise direction depending on the grid spacing and the bcs for instance fft decomposition can be performed along the span wise direction if it is discretised with a uniform grid even though a non uniform grid might be used along the stream wise direction the distinction of this formulation from other two fluid formulations coupled with the ib method is that the part of the domain occupied by the solid is included in the solution of the poisson equation otherwise the use of the fds would not be allowed using the formulation of eq 16 and including the solid part in the poisson solution one should define a density value for the solid nodes in regions where the free surface intersects the ib solid interface this is not a trivial task and may lead to stability issues because the proper bc on the ib would not be satisfied the reader is referred to the study of frantzis and grigoriadis 2019 for a detailed explanation and discussion once the poisson eq 19 is solved the pressure and velocity fields at the new time instant n 1 are updated by a consistent correction step 20 p n 1 p n δ p n 1 21 u n 1 u δ t n 1 p n 1 ρ o 1 ρ n 1 1 ρ o p ˆ δ t n 1 a f r regarding the spatial discretisation the convective terms of eq 15 are discretised using the modified upwind quick scheme of perng and street 1989 which has an improved accuracy of 3 r d order yue et al 2003 while the diffusion term is discretised using standard 2 n d order central differences the discretisation of eq 19 is also performed using standard 2 n d order central differences the level set advection equation eq 6 is discretised in space using the weno scheme jiang and shu 1995 the re initialisation equation eq 7 can be discretised with either a 2 n d order upwind scheme or a 5 t h order weno scheme for the results presented in this study a 2 n d order scheme was used shu and osher 1988 yue et al 2003 a 3 r d order runge kutta scheme is used for the time advancement of eqs 6 and 7 the presence of solid obstacles within the computational domain are taken into account using the ib method peskin 1972 following a direct forcing approach for the velocities balaras 2004 the pressure bcs on the ib solid interface are properly recovered using the indirect approach presented in frantzis and grigoriadis 2019 this is a key step in the development of the proposed nwt because in contrast to other conventional approaches the poisson equation is solved in the entire domain fluid and solid phase retaining 2 n d order of accuracy in space and time the reader is referred to the work of frantzis and grigoriadis 2019 for a detailed discussion on the relevant modifications of the provisional velocity fields and the treatment of the pressure gradient terms in order to ensure numerical stability constraints related to the time step must be applied for problems where there is no surface tension these restrictions are imposed through the c f l convection stability limit and the v s l viscous stability limit given below in their non dimensional form nguyen et al 2001 22 c f l m a x u i m a x δ t c f l n 1 a i f r δ t c f l n 1 δ x i 23 v s l m a x μ r e μ t ρ δ t v s l n 1 δ x i 2 where δ t c f l and δ t v s l satisfy the corresponding constraints by setting appropriate values for c f l m a x and v s l m a x respectively the minimum δ t n 1 is dynamically computed at each time step to satisfy both constraints i e 24 δ t n 1 min δ t c f l n 1 δ t v s l n 1 the v s l constraint can be eliminated if an implicit scheme is used for the time advancement of the diffusive terms the limiting value of c f l m a x depends on the temporal discretisation scheme of the convective terms and its stability limits the limitation of 5 in the change between successive time steps mentioned earlier could lead in regions where the c f l value would not satisfy the limit of c f l m a x such a scenario does not appear in the simulations since there are no rapid changes in the velocity components this is also related to the generally small values of c f l m a x and consequently time steps that are required by the constant coefficient approach a detailed analysis of the effect of the upper value for c f l m a x in combination with the splitting scheme is presented in section 3 1 2 5 wave generation and absorption in the new nwt the relaxation method was adopted for the wave generation and absorption the relaxation method was presented in mayer et al 1998 and it is also adopted by well known open source cfd tools such as openfoam jacobsen et al 2012 and reef3d bihs et al 2016 the basic idea of this method is to smoothly remove waves that travel towards a specific direction where a non reflecting boundary is desired the nwt consists of different zones that are depicted in fig 2 the actual simulation takes place in the working section the generation of the desired waves is performed at the left side of the nwt by the wavemaker and the relaxation zones in the wavemaker zone the analytical solution of the desired wave to be simulated is imposed by updating the velocity components and the position of the free surface at every time step this is performed gradually from the left boundary up to the end of the wavemaker zone meaning that the exact solution of the simulated wave is applied only at the end of the wavemaker zone while at its left boundary zero velocity and free surface elevation are applied the imposed values for the velocity and the free surface elevation are given by 25 u x 1 r x u t a r g e t x 26 φ x 1 r x φ t a r g e t x where u t a r g e t and φ t a r g e t are the analytical values that correspond to the generated wave for the specific location and time instant r x is a smoothly varying function which is equal to unity at the beginning of the zone and equal to zero at its end in the relaxation zone which is located exactly next to the wavemaker zone the desired waves are generated while at the same time any reflections travelling towards this zone from right to the left are smoothly absorbed in this zone the computed velocity components and the free surface elevation are replaced by their relaxed values according to the analytical values therefore any disturbances deviations from the analytical values are smoothly removed from the simulation the relaxed values are given by 27 u x 1 r 1 x u t a r g e t x r 1 x u c o m p u t e d x 28 φ x 1 r 1 x φ t a r g e t x r 1 x φ c o m p u t e d x where u c o m p u t e d and φ c o m p u t e d refer to the calculated values by the solution of the ns equations in case a non reflecting boundary is required at the right side of the nwt an absorption zone is used to smoothly absorb waves propagating from left to right therefore this zone operates as an outlet or a numerical beach in this zone the values of both u and φ are relaxed by 29 u x 1 r x u t a r g e t x r x u c o m p u t e d x 30 φ x 1 r x φ t a r g e t x r x φ c o m p u t e d x where u t a r g e t is set to zero and the values of φ t a r g e t correspond to the still water depth in eqs 25 30 x represents the non dimensional horizontal position of each zone defined by 31 x x x b z o n e x e z o n e x b z o n e where x b z o n e and x e z o n e denote the begin and end of each zone respectively the relaxation function used in this study is the one presented in jacobsen et al 2012 in the form 32 r x 1 e x c r 1 e 1 f o r x 0 1 where c r is the coefficient of the exponential usually taken equal to 3 5 comparing the relaxed functions of the relaxation zone eqs 27 and 28 to that of the absorption zone eqs 29 and 30 the input parameter in the relaxation function r is set to 1 x instead of x so that r 1 and r x 0 at the end of the relaxation zone i e x 1 the variation of the relaxation function along the absorption and relaxation zones is schematically shown in fig 1 it is worth mentioning that the wave theories employed for the calculation of the values of the imposed free surface elevation and velocities in the wavemaker and relaxation zones assume an inviscid and irrotational flow as a result the bottom boundary condition in these regions is always set to free slip moreover at the beginning of the simulation a ramp function in time is employed to achieve the desired wave values the ramp function lasts one wave period and its purpose is to eliminate the impulse effect when a sudden velocity is introduced to the wavemaker at the first time step the simulation steps for the developed nwt algorithm are summarised below 1 initialisation of the interface position φ field velocity and pressure fields 2 calculation of the time step δ t n 1 to satisfy stability limits from eq 24 3 update of the position of the interface solving eq 6 4 calculation of the minimum signed distances φ around the interface from eq 7 5 update of the φ field in the wavemaker relaxation and absorption zones using the corresponding relaxation functions eqs 26 28 and 30 6 calculation of the provisional velocity field u from eq 14 7 modification of u for the nodes close to the ib to satisfy the no slip wall bc 8 solution of the constant coefficient poisson equation for the pressure difference eq 19 using a fds 9 correction of the pressure and velocity fields at the new time instant using eq 20 and eq 21 10 update of the velocity field in the wavemaker relaxation and absorption zones using the relaxation functions eqs 25 27 and 29 11 return to step 2 for the new time step 3 validation in this section the validity of the new nwt is demonstrated in several benchmark test cases first the spatial and temporal accuracy of the nwt was examined for 2 n d order stokes waves section 3 1 and a standing wave section 3 2 for these simpler flow cases the ib method was not used so that the effectiveness of the constant coefficient poisson formulation could be compared against analytical solutions the capability of the nwt to capture complex hydrodynamic phenomena was examined by simulating a spilling breaker over a constant slope bed section 3 3 the interaction of a solitary wave with a rectangular abutment section 3 4 and the diffraction of a solitary wave by a single row pile breakwater section 3 5 in all test cases presented hereafter the non dimensionalisation was based on the still water depth d fig 2 as the characteristic length scale l o and g d as the characteristic velocity scale u o following these definitions the froude number was equal to unity 3 1 stokes waves in this validation the two dimensional vertical 2dv propagation of nonlinear stokes waves was simulated in order to assess the performance of the nwt in terms of its spatial and temporal accuracy 2 n d order stokes waves were generated in the wavemaker zone with wave height h 0 1 d wave period t 5 235 d g and wavelength λ 4 d the dimensions of the computational domain were l x l z 60 d 2 d the total simulation time was set to 50 wave periods to demonstrate that the nwt has negligible numerical dissipation and dispersion errors after long integration times for a direct comparison with the analytical solution the diffusion terms of eq 15 were deactivated in order to model inviscid and irrotational flow and the velocity bc on the bed was set to free slip an open bc was applied along the top boundary enforcing homogeneous neumann bc for both horizontal and vertical velocity components for the pressure a homogeneous neumann bc was used in all boundaries except in the upper one where constant atmospheric pressure was applied using a dirichlet bc to ensure the absence of reflections in the working section 16 x d 36 long relaxation and absorption zones were used i e 16 d and 24 d corresponding to 4 λ and 6 λ respectively the time step was only governed by the c f l criterion the v s l restriction was negligible due to the absence of viscous terms all the following results refer to the periodical steady state solutions first the spatial accuracy was examined by setting c f l m a x 0 025 where the temporal errors were found to be negligible uniform grids were used in both vertical and horizontal directions two vertical resolutions δ z d 0 025 d and 0 125 and three aspect ratios a r δ x δ z 4 2 and 1 were considered the comparison of the theoretical wave profile against the calculated one for different grid resolutions is shown in fig 3 while the corresponding maximum errors for the wavelength ε λ the wave crest level ε c r e s t the wave trough level ε t r o u g h and the wave height ε h are shown in table 1 the wave crest and trough levels were captured with a maximum error of less than 1 6 for all grid resolutions while the wave height was captured with an error less than 1 regarding the wavelength it is observed that the results gradually converge to the analytical solution as the horizontal resolution increases for the coarser vertical resolution fig 3a the wavelength is slightly underestimated but the error is less than about 1 for a r 2 for the finer vertical resolution fig 3b the underestimation of the wavelength is even smaller with an error less than about 0 1 for a r 2 the temporal accuracy of the nwt was tested using a fixed grid size of δ x δ z 0 025 d 0 0125 d where the results were found to be grid independent the time step was dynamically adapted according to the c f l restriction of eq 22 by setting the value of c f l m a x five different values of c f l m a x were examined as shown in fig 4 for the larger value of c f l m a x 0 2 the wavelength was underestimated by about 6 while the wave height was in general decreasing in the working section using smaller time steps c f l m a x 0 1 the predicted wave height and wave crest and trough levels have less than 1 error in comparison to the analytical solution for the wave length the error was down to about 0 5 for c f l m a x 0 05 and diminished to 0 1 for smaller time steps c f l m a x 0 025 therefore based on the examined case it was concluded that c f l m a x 0 025 is the appropriate value to ensure negligible numerical dissipation and dispersion errors to further investigate the origin of the temporal error identical simulations were performed solving the variable coefficient poisson equation eq 16 with an lu based direct solver the variable coefficient solver with c f l m a x 0 1 achieves the same accuracy with the constant coefficient one with c f l m a x 0 025 the same value of c f l m a x 0 1 was also reported to diminish temporal errors in a conventional nwt with the open source software reef3d bihs et al 2016 it is therefore evident that the stricter time step requirement of the present nwt does not originate from the time advancement scheme but from the splitting scheme of eq 17 therefore one may conclude that a c f l reduction of four times is required in the present nwt which is based on a constant coefficient poisson equation due to the effect of the splitting scheme in frantzis and grigoriadis 2019 it was shown that the time step reduction factor is governed by the density ratio of the two fluids simulated as it is demonstrated in section 4 though even with this additional cost of performing four times more time steps the present nwt is still computationally more efficient compared to conventional approaches which are based on the variable coefficient poisson equation as mentioned in section 2 4 the novelty of the proposed nwt is the solution of a poisson equation with constant coefficients for the calculation of the pressure therefore in order to ensure that the dynamic pressure is also accurately calculated the numerical predictions of the proposed nwt were compared against the analytical solution of 2 n d order stokes waves and the numerical results provided by the variable coefficient poisson equation as demonstrated in fig 5 the numerical results correspond to a numerical grid of δ z d 0 0125 d and δ x d 0 0250 d and a c f l m a x value of 0 025 and 0 100 for the constant and the variable coefficient approach respectively fig 5a and fig 5b show the vertical profile of the dynamic pressure below a crest and a trough location respectively in the working section according to these results it is evident that the new nwt has the same accuracy for the dynamic pressure prediction as the conventional one with the variable coefficient poisson equation deviations between the numerical results and the analytical solution occur mostly near the bed and free surface regions as it was anticipated the latter are the consequence of the fact that in the numerical one fluid treatment the density changes gradually from water to air across the free surface apart from that smaller differences with the analytical solution which assumes potential flow arise due to the numerical dissipation in the nwt even though the diffusion terms were eliminated by setting r e which is introduced mainly by the upwind scheme quick used for the discretisation of the convective term in eq 15 therefore it can be safely concluded that the new nwt provides the same degree of accuracy with the conventional approach when the additional temporal error is eliminated by using smaller time step values i e c f l m a x 0 025 3 2 formation of a standing wave in this validation the nwt was assessed in terms of the performance of its relaxation zone which is essential for the concurrent generation of waves and absorption of returning wave due to reflections to this purpose a 2d standing wave was simulated to demonstrate that even the most extreme reflections can be absorbed the dimensions of the computational domain were l x l z 30 d 2 d in order to simulate a perfect wave reflection from a vertical wall for comparison with the analytical solution of stanging waves the diffusion terms of eq 15 were deactivated in order to model inviscid and irrotational flow and free slip bcs were imposed on the bed and the right reflective wall an open bc was applied along the top boundary the wave parameters were identical to the ones used in section 3 1 i e h 0 1 d and λ 4 d the length of the relaxation zone was set equal to four wavelengths a uniform grid was used in both vertical and horizontal directions using grid sizes of δ x δ z 0 025 d 0 0125 d following the analysis of the previous section the time step was dynamically adapted according to the c f l criterion by setting c f l m a x 0 025 a total simulation time of 50 wave periods was used after a transient interval of about 20 wave periods a standing wave was clearly established in the domain and the solution did not deviate between successive wave periods typical snapshots of the free surface profile every 1 16 of the wave period are presented in fig 6 in the relaxation zone the returning reflected wave is dissipated and the incident wave height value is recovered at x 12 d i e within one wavelength from the right side of the relaxation zone in the working section the expected pattern of nodes and antinodes of a standing wave is observed while the height of the standing wave is twice the incident one the maximum error for the prediction of crest and trough levels was less than 2 while the maximum error for the wavelength was less than 1 these results verify that the implemented wavemaker relaxation method is very capable to concurrently generate waves and absorb extreme reflections 3 3 spilling breaker in this validation a spilling breaker was simulated in order to assess the implementation of the ib method and the capability of the nwt to capture challenging nearshore processes employing fast direct pressure solvers in a computational domain with immersed bodies could possibly generate numerical instabilities for two fluid problems this is a matter of concern especially in areas where the free surface interface intersects solid obstacles frantzis and grigoriadis 2019 in conventional nwts using the ib method this is not an issue because the solid parts of the domain are excluded from the variable coefficient poisson equation solver e g reef3d bihs et al 2016 employed the ib method for the simulations of the experiment in ting and kirby 1996 the well documented experimental study in ting and kirby 1996 was also selected for the present validation this challenging case involves spilling wave breaking along a mild slope bed as shown in fig 7 this case has been studied numerically by several researchers using different approaches for instance water phase only models were presented solving the euler equations and using breaking models based on the boussinesq equations dimas and dimakopoulos 2009 or the large wave simulation dimakopoulos and dimas 2011 the most generalised approach of solving the ns equations which models the physical problem with the least assumptions has been extensively adopted to study this spilling breaker case chella et al 2015 christensen 2006 guo et al 2013 horikawa 1988 jacobsen et al 2012 wang et al 2009 xie 2013 zhao et al 2004 for the present simulations the original experimental configuration was used without modifications allowing the inclusion of the motion of the free surface in the swash zone i e wave setup and run up contrary in some studies e g guo et al 2013 jacobsen et al 2012 the sloping bed was modified at the shoreline in order to be fully submerged and eliminate the existence of a contact point between the free surface and the sloping bed which introduced robustness issues in the particular two fluid models the intention of including the physical swash zone in the present model was to demonstrate the absence of such robustness issues in the presented nwt in the experimental study the water depth in the horizontal region was equal to d 0 4 m and the slope of the bed was 1 35 the wave height of the incident waves was h 0 125 m with a period of t 2 s to match the experimental conditions incident waves with h 0 3125 d and t 9 903 d g were generated at r e 789 238 using the linear dispersion relationship the wavelength was estimated to be λ 9 236 d the length of the relaxation zone was set equal to one wavelength l r z 9 236 d the dimensions of the 2d computational domain were l x l z 60 d 2 5 d with the sloping bed starting at a distance of 20 d from the left boundary of the nwt for this set of parameters according to the wave theory diagram kamphuis 2010 le méhauté 2013 the us army corps of engineers 1973 the 5 t h order stokes theory is considered as marginally valid christensen 2006 therefore the wave generation was performed using the 5 t h order stokes theory reported in fenton 1990 other numerical studies chella et al 2015 xie 2013 zhao et al 2004 adopted the cnoidal theory of a 3 r d order horikawa 1988 or a 5 t h order fenton and herbich 1998 approximation there are also studies brown et al 2016 jacobsen et al 2012 that used the stream function theory rienecker and fenton 1981 two different uniform grids were employed a coarse one with n x n z cells and a finer one with n x n z 2400 200 cells similar to the one used by chella et al 2015 the results presented here are reported for the finer grid which proved to sufficiently resolve the quantities of interest the time step was dynamically controlled restricted by c f l m a x 0 02 and by v s l m a x 0 03 eq 24 the smagorinksy sgs model was used with c s 0 2 christensen 2006 the simulation was performed for a total of 40 wave periods to ensure that the robustness of the algorithm is maintained for long integration times the last ten periods were used to collect period averaged and phase averaged results which are presented below the number of simulated wave periods in the present study was large when compared to a number of previous studies for instance in chella et al 2015 and other studies christensen 2006 wang et al 2009 xie 2013 simulations for 10 12 5 20 and 25 wave periods were performed respectively longer simulations have been performed by jacobsen et al 2012 and brown et al 2016 using 130 and 50 wave periods respectively the evolution of the free surface along with the velocity magnitude and vector field in the water is shown in fig 8 the free surface elevation z relative to the mean free surface elevation η x is displayed in fig 9 at the locations of the wave gauges w g in fig 7 located at x d 3 75 1 25 11 25 13 75 15 0 16 75 17 5 20 0 the comparison against the experimental data in ting and kirby 1996 shows a very good agreement specifically only minor differences are observed in the horizontal region upstream of the slope w g 1 and w g 2 which are attributed to the use of the 5 t h order stokes theory to numerically generate the waves that unavoidably deviate slightly from the waves generated experimentally further downstream the presence of the sloping bed has a dominant role in modifying the incident waves it is therefore not surprising that the agreement is actually improved in this region w g 3 w g 5 and even after the wave breaking location w g 6 w g 8 in addition fig 10 shows the comparison of the free surface envelope between the present numerical results and the experimental data in ting and kirby 1996 first of all regarding the wave breaking location i e depth and height that offer challenges to be accurately captured a very good agreement is observed at x d 16 0 as far as the crest level with respect to the mean free surface elevation η m a x η d is concerned which is not always accurately captured an almost perfect agreement was found in all stream wise locations due to turbulence the free surface elevation and consequently the corresponding values for the crest and the trough levels differ between periods thus η m a x d and η m i n d were calculated by averaging the crest and trough elevation respectively of the five last periods considerable differences between η m a x d and its averaged value were found only in the region after the wave breaking and close to it i e 17 x d 26 after the breaking point in the surf zone the predicted wave height decreases at the same rate as in the experiments showing that the wave dissipation was predicted correctly only in the inner surf zone which is closer to the swash zone the crest level was slightly over predicted also a very good agreement was found for the trough level with respect to the mean free surface elevation regarding the mean free surface elevation it was found to be in satisfactory agreement in the surf zone i e after the breaking point and slightly before the breaking point in the region with larger water depth this was slightly over predicted which might be attributed to the deviations between the numerically and experimentally generated waves as mentioned before to further validate the accuracy of the nwt the comparison of the horizontal velocity component at three vertical levels and three horizontal locations is displayed in figs 11 13 for locations u m 1 u m 3 in fig 7 the numerical model seems to perform better close to the free surface compared to the region close to the bed a slight over prediction of horizontal velocity occurs close to the bed which was also observed in other similar numerical studies chella et al 2015 zhao et al 2004 figs 14 and 15 present the comparison for the phase averaged vertical component of velocity w at three vertical levels for the locations of u m 2 and u m 3 in fig 7 the comparison looks quite convincing accurately capturing the temporal variation and the maximum and minimum values at all locations moreover the comparison for the undertow profiles period averaged velocity at six locations in the surf zone x d 3 75 1 25 11 25 13 75 15 0 16 75 17 5 20 0 is presented in fig 16 where variables are non dimensionalised with respect to the local mean water depth h x d x η x and d x is the corresponding still water depth and η x is the mean free surface elevation in accordance with the phase averaged horizontal velocity the undertow profiles are predicted more accurately at the levels closer to the free surface for locations of the surf zone further away from the breaking point with smaller water depths the predicted undertow is underestimated especially close to the bed this could be an indication of limited numerical resolution in this area because fewer grid nodes exist within the water depth for shallower locations for instance the vertical distance between the still water level and the inclined bed includes approximately 42 cells at the location x d 16 6625 while at the inner surf zone of x d 24 3125 only 23 cells are included for locations even closer to the coast the results would be less reliable since fewer gird cells exist between the bed and the free surface while a number of grid cells correspond to the artificial thickness smoothing distance of the interface where the density is smaller than that of the water moreover the discrepancies in the simulated undertow might be attributed to an over dissipation of the sgs model close to the bed failing to capture the increased gradients u z that are occurred in the inner surf zone locations based on the results in brown et al 2016 where different rans models were examined the simulated undertow is very sensitive to the selected turbulence sgs model this argument is further supported by the results in christensen 2006 where the les with the smagorinsky sgs model was used similar to the present study indicating that the bottom close undertow was underestimated at the locations closer to the coast as well even though the variable coefficient poisson was solved therefore it is safely concluded that the differences in undertow are not attributed to the alternative solution of the poisson but only to the selected turbulence model summarising the results presented in figs 9 16 and comparing them with the numerical results reported in other studies that used conventional nwts e g brown et al 2016 chella et al 2015 christensen 2006 xie 2013 zhao et al 2004 the accuracy is very satisfactory even for very long integration times numerical instabilities were not present in the region where the sea bed was intersected by the free surface the present nwt seems to fail capturing the undertow profile closer to the bed at locations in the inner surf zone closer to the coast however according to the above discussion this might be attributed to the selected turbulence model which requires further investigation by testing other sgs models or using a wall function which might be more appropriate due to the under resolution of the boundary layer therefore it is concluded that the proposed nwt can simulate breaking waves with comparable accuracy to that of conventional nwts 3 4 3d interaction of a solitary wave with a rectangular abutment in this validation the interaction of a solitary wave with an abutment was simulated to demonstrate the capability of the nwt in capturing complex 3d flows the numerical results are compared against the experimental measurements in higuera et al 2013b and lara et al 2012 the experiments were conducted in a wave tank with a still water depth d 0 45 m and width w n w t 0 58 m as schematically shown in fig 17 a rectangular abutment with dimensions w a b t l a b t 0 3 0 24 m was attached to the left wall of the wave tank with respect to the wave direction in this case the x axis is the stream wise horizontal z axis is the vertical and y axis is the span wise coordinate the offshore face of the abutment is at a distance x a b t 8 96 m from the end wall of the wave tank a solitary wave with a height of h 0 1 m travels along the wave tank interacts with the abutment reflects at the end wall of the wave tank and re interacts with the abutment the characteristic length and velocity scales for this case are l o d 0 45 m and u o g d 2 101 m s using these scales the non dimensional wave height and reynolds number were h d 0 222 and r e 941 752 the height of the computational domain was chosen to be twice the still water depth i e h n w t d 2 here the length of the nwt was l n w t d 52 889 which includes a wavemaker zone of length l w m d 8 889 and a relaxation zone of the same length l r z d 8 889 a uniform mesh was used in all three directions while the poisson equation was decomposed into multiple 2d systems of equations by performing fft decomposition along the stream wise x direction this decomposition allows an efficient parallelisation of the poisson solution and a significant reduction of memory requirements discussed in detail in section 4 the generation of the solitary wave was performed using the 3 r d order analytical solution in grimshaw 1970 the presence of the abutment was taken into account using the ib method the smagorinsky sgs model was used with c s 0 1 because the larger value of 0 2 was found to over dissipate the wave height when coarser grid resolution was used the time step was dynamically controlled using the v s l and c f l criteria by setting c f l m a x 0 02 and v s l m a x 0 03 for a total simulation time of 100 dimensionless time units t o l o u o which corresponds to about 21 5 s regarding the discetisation of the domain four different numerical grids were used as indicated in table 2 the first three grids that correspond to c o a r s e m e d i u m and f i n e resolution respectively were used to investigate the convergence of the model while the finest grid used f i n e 2 was performed to present the computational performance of the model when large grids are required snapshots of the free surface elevation in fig 18 a and fig 18b show the interaction of the incident and the reflected respectively solitary wave with the abutment as it was computed by the finest grid f i n e 2 the free surface elevation was recorded at several locations in the nwt fig 17 which coincide with the locations of wave gauges table 3 in the corresponding experimental and numerical studies higuera et al 2013b lara et al 2012 and bihs et al 2016 the comparison to the experimental data is shown in fig 19 two peaks in each free surface elevation recording can be clearly observed for all wave gauges these peaks correspond to the passage of the solitary wave before first peak and after second peak its reflection at the end wall of the wave tank for the wave gauges seawards of the abutment w g 1 w g 4 the first free surface peak is always greater than the second one on the other hand for the wave gauges leewards of the abutment the second peak is either greater or at least comparable to the first one for all gauges examined these peaks in the free surface elevation recordings are quite accurately captured in the new nwt and all grid resolutions examined as far as the convergence is concerned it is concluded that the m e d i u m grid with a total of about 3 8 10 6 cells is sufficient while finer resolutions does not seem to significantly affect the results the error of the simulations with respect to the experimental measurements was calculated as η n u m η e x p η e x p where η e x p and η m u m are the peak values of the experiments and the present numerical results respectively the maximum error among all wave gauges was 7 4 for the first peak in w g 4 and 2 4 for the second peak in w g 1 additionally the time interval between peaks is also in excellent agreement with the experimental data which is an indication that the celerity of the solitary wave was accurately captured the simulation with a numerical grid of n x n y n z 2600 64 100 cells resulting to a total of 16 64 million grid cells was performed to demonstrate the computational performance of the presented efficient nwt regarding the computational cost of this simulation a total of 35 h were required for the simulation of 100 time units i e an average of 1 63 h per second simulated the simulation was executed exclusively on a single server equipped with 64 g b y t e s of ram and two intel r xeon r e5 2680 cpu units of 14 cores each synchronised at 2 4 g h z the same simulation could be completed in less than a week on a personal computer or a modern laptop 3 5 3d interaction of a solitary wave with a single row pile breakwater in this section an additional 3d flow problem was simulated to further examine and demonstrate the capabilities of the new nwt for this purpose the interaction of a solitary wave with a pile breakwater was simulated following the study in jiang et al 2015 the case selected includes extreme deformation of the free surface leading to breaking and air entrapment phenomena apart from experimental measurements numerical predictions for the global forces exerted on the piles were also reported in jiang et al 2015 using the waves2foam module of openfoam jacobsen 2017 the experiments were performed in a wave flume with dimensions of 45 m in length 0 8 m in width and water depth d 0 2 m the pile breakwater consisted of a single row of circular piles with diameter d c y l 0 05 m a schematic diagram of the simulated case is presented in fig 20 showing three of the piles the experimental reynolds number was r e 279 152 the diameter of the pile was d c y l 0 25 d and the centre to centre distance between two adjacent cylinders was s 0 4 d these parameters correspond to a gap width of e 0 15 d and a porosity of the pile breakwater ε e s 37 5 the height of the examined incident solitary wave was h i 0 35 d the free surface elevation at a specific location and time is denoted by η x t the incident height h i and the reflected height of the solitary wave were identified by the recording of a wave gauge sensor w g 1 positioned 3 0 m seawards of the centre of the piles the free surface elevation was also recorded by a second sensor w g 2 located at a distance of 1 0 m seawards of the piles in the leeward side of the piles two additional sensors w g 3 and w g 4 were also placed at distances of 0 5 m and 1 5 m respectively in order to obtain the transmitted wave height the stream wise and vertical velocity components of the velocity were measured using two acoustic doppler velocimetry a d v sensors located 0 5 m seawards and 0 3 m leewards from the piles both a d v sensors were placed 0 08 m above the seabed and at the transverse location corresponding to the middle of the gap between piles in the experimental part of the study in jiang et al 2015 the breakwater consisted of ten piles confined by the side walls of the wave tank in the present study the computational domain was truncated along the span wise y direction to save computational resources in the numerical part of the study in jiang et al 2015 a truncated domain was also used including five cylinders in the span wise direction in the present study after a series of preliminary simulations with five three and one pile it was concluded that even considering a single pile was sufficient provided that periodic bcs were employed along the span wise direction therefore for all the presented results below a periodic single pile was considered the bottom boundary of the numerical flume was prescribed as a no slip wall along the top boundary of the flume open bcs were applied at the domain s outlet and for the case presented in this paragraph only instead of employing an absorption zone a convective outlet bc was used 33 u t u c u 0 where u c is the convective velocity which was chosen equal to the celerity of the incident solitary wave the dimensionless value of the wave celerity given by the analytical solution of grimshaw 1970 reads 34 u c 1 1 2 h i d 3 20 h i d 2 3 56 h i d 3 for this specific case of a solitary wave adopting a convective outlet bc instead of an absorption zone proved to be a justified choice after a series of preliminary simulations as it will be demonstrated below for different wave conditions the effectiveness of this approach to minimise reflections could be investigated but falls outside the scope of the present study the total length of the numerical wave flume was 50 d this comprised of a wavemaker zone l w m 5 d a relaxation zone l r z 10 d and a working section l w s 35 d the height of the numerical wave flume was chosen equal to h n w t 2 d and the span wise extent was w n w t 0 4 d the centre of the pile breakwater was at a distance x c y l 25 d from the end of the relaxation zone fig 20 a uniform grid was used along the span wise y and vertical z directions in the stream wise direction x a constant grid spacing δ x m i n was used in the region 10 d c y l with respect to the centre of the pile breakwater seawards and leewards of this region the grid size was expanding linearly at a rate of 3 till a maximum value of δ x m a x 4 δ x m i n which was maintained in the rest of the nwt similar to the validation case of section 3 4 the 3d domain is decomposed into multiple 2d planes in this case though the fft decomposition is performed in the span wise direction where both bcs are neumann and equidistant grid is used since the fft is not performed in the other directions the grid spacing in these directions does not have to be uniform two different grid resolutions were tested a coarser grid with n x n y n z 1342 32 150 6 4 million cells and a finer one with 1990 48 200 19 1 million cells the minimum grid size in the stream wise direction was δ x m i n d 80 and d 120 for the coarser and the finer grid respectively the smagorinsky sgs model was used with c s 0 2 and the c f l m a x and v s l m a x were set equal to 0 02 and 0 03 respectively concerning the computational cost a total of 18 and 78 h were required for the coarser and the finer grid respectively when executed on a single server using 28 cores synchronised at 2 4 g h z the comparison of the free surface elevation and the velocity measurements recorded by the wave gauges w g 1 4 and the two velocity sensors a d v 1 2 is presented in figs 21 and 22 respectively both coarse and fine grids were found to accurately capture the temporal evolution of the free surface in terms of the peak values for both seaward w g 1 2 and leeward w g 3 4 locations in the seaward region fig 21a and fig 21b the second peak recorded by each sensor w g 1 and w g 2 corresponds to the wave reflected by the piles of the breakwater the elevation of this reflected wave was found to be in perfect agreement with the predictions reported in jiang et al 2015 using openfoam compared to the experimental measurements all numerical results were found to over predict the elevation of the reflected wave especially at w g 1 in the leeward region the primary peak of the free surface elevation evolution w g 3 and w g 4 in fig 21c and fig 21d corresponds to the transmitted wave this was found in almost perfect agreement with both the experimental and the numerical results in jiang et al 2015 a secondary peak of free surface elevation appears in the openfoam results only this could be an indication of insufficient absorption of the transmitted wave at the end of domain which generates a small reflection the present results are in better agreement with the experimental measurements in the leeward region of the breakwater indicating that the adoption of a convective outlet bc eq 33 is capable of restricting reflecting waves in the case of a solitary wave the predicted velocity time series in the new nwt are in very good agreement with both the experimental measurements and the openfoam results jiang et al 2015 in the seaward region a d v 1 in the leeward region a d v 2 all numerical results show deviations from the experimental data after the primary peak in this region these differences may be attributed to the sgs contribution of the turbulence model which are activated by intense vortical motions and disturb the flow locally the consistency of the present nwt to accurately predict the global forces exerted on the piles is presented in fig 23 the present numerical results using two different grid resolutions were compared with those provided in jiang et al 2015 using openfoam in the present nwt the global force is calculated in a straightforward manner by integrating the pressure and the viscous forces around the surface of the pile the good agreement between the different numerical models shown in fig 23 verifies the consistency and the capability of the present nwt to accurately calculate and predict global forces acting on the ib solid interfaces small deviations between the present nwt and openfoam results are sensible especially if one considers the differences on grids numerical techniques and free surface tracking methods the evolution of the free surface shape during the incidence of the solitary wave and its diffraction by the piles of the breakwater is shown in fig 24 observing these snapshots it is obvious that the simulated case is characterised by a violent motion of the free surface which includes breaking events and air entrapment the backward breaking that occurs can be explained as a hydraulic jump since the solitary wave behaves similar to unidirectional flows in the vicinity of the crest location 4 computational performance in this section the performance and the efficiency of the proposed nwt is assessed against a conventional approach the analysis focuses on the poisson solution which is the most computationally intensive procedure of the simulation in order to demonstrate and quantify the advantage of the proposed nwt the computational cost of the constant coefficient poisson solver with fds presented in section 2 4 is compared against a variable coefficient one using an iterative solver it is noted that the results presented in this paragraph refer to the speed up of solving the poisson only and its effect on the total speed up when an explicit scheme is used for the temporal advancement of the velocity field for a code that uses an implicit scheme for the temporal discretisation the effect of the poisson speed up on the total speed up would not be the same due to the different percentage of poisson s computational cost to the total cost and due to the increased time step values that can be used by the implicit schemes to provide accurate predictions one should perform the relevant simulation tests to estimate the speed up or speed down the implementation of the new nwt employs a fishpak based grigoriadis et al 2004 fds with fft decomposition along a single direction to solve the constant coefficient poisson equation eq 19 using openmp directives for the paralellisation the conventional approach was based on the variable coefficient poisson equation eq 16 which was solved using an iterative solver the most popular choices for iterative poisson solvers are the algebraic multigrid amg and the jacobi preconditioned bicgstab the comparison between fds and the amg iterative solver was already presented in dodd and ferrante 2014 and frantzis and grigoriadis 2019 for two fluid flow problems in dodd and ferrante 2014 the performance results were carried out using a domain with triple periodicity and a resolution of 1024 grid cells in each direction using a fds which performed fft decomposition in all three directions and 1024 computing cores for the simulations the speed up for the solution of the poisson was measured to be about 20 60 according to the selected convergence tolerance for the amg iterative solver as a result the total speed up was found to be about 10 40 later frantzis and grigoriadis 2019 compared the computational performance of an amg iterative solver and a fds that is parallelised with openmp and uses fft decomposition along a single direction of the domain only for a domain of 320 256 320 grid cells and a density ratio equal to 1000 which is closer to that of water and air a speed up of about 300 was measured for the poisson solution they also found that a time step reduction might be required which for the problems of their interest was proportional to the density ratio between the two fluids simulated for the problems of their interest and a density ratio equal to 1000 the required time step reduction factor was found equal to 10 concluding in a final speed up equal to 10 in the present study the fds is compared against the jacobi preconditioned bicgstab which is also used by the open source cfd software reef3d bihs et al 2016 the current implementation of bicgstab for poisson solution employs the widely used hypre library falgout and yang 2002 with message passing interface mpi it should be noted that the poisson equation is solved to machine precision with the fds while a user defined convergence tolerance is required by an iterative solver to set this value preliminary runs with the bicgstab based solver indicated that comparable flow fields are achieved using the default value of the convergence tolerance i e 10 7 for the norm of the relative residual to achieve the same accuracy between the two approaches a c f l reduction factor r f of four was required for the fds based solver as was deduced by the c f l analysis of section 3 1 in order to eliminate the temporal splitting error of eq 17 consequently the values of the c f l m a x were set to 0 025 for the fds based solver and 0 1 for the bicgstab based solver the comparison was performed for a 3d nwt without any obstruction using wave parameters identical to the ones selected for the case of propagating waves in section 3 1 a domain of length l n w t 250 d width w n w t 5 d and height h n w t 8 d was used all performance tests were executed exclusively on a single server equipped with two intel xeon e5 2680 processors of 14 cores each synchronised at 2 4 g h z the performance of the two approaches is summarised in table 4 for five different grid resolutions ranging from a total of 1 280 million cells for each grid the cpu time of the poisson solution per time step is presented in the 2 n d and 3 r d columns for the two solvers the speed up of the fds over the bicgstab is shown in the 4 t h column for a single poisson solution i e without accounting for the c f l reduction as expected mainly because of the fft decomposition employed by the fds a remarkable speed up of about 240 520 was achieved the overall speed up of the full ns solution for the proposed nwt is reported in the last column of table 4 including the c f l reduction this speed up strongly depends on i the time step reduction factor r f ii the size of the problem and iii the percentage of the computational time of the poisson solution in the time step using the fds 5 t h column as demonstrated in section 3 1 a reduction factor of r f 4 is necessary for the case of a fds based nwt the overall speed up was found to increase substantially with the grid size for the smallest problem considered here the full ns simulation was accelerated approximately 6 times for larger problems where the computational cost is even more critical the simulation was accelerated up to about 30 times looking at the results of table 4 one could possibly argue whether the presented nwt would be favorable against conventional nwts with implicit schemes that allow significantly larger values of time step in order to obtain accurate results on the total speed up or speed down the relevant simulation tests should be performed because the cost of calculating the provisional velocity in a single time step is increased when an implicit scheme is used compared to the explicit ones a quite conservative prediction can be made by assuming that an implicit treatment of the velocity does not increase the cost per time step of calculating the provisional velocity taking this into account and considering that 20 times larger time steps i e c f l 0 5 and r f 20 can be used the final speed up last column of table 4 would be at least equal to 1 3 and 6 for the smaller and larger grid examined first and last row of table 4 respectively an additional advantage of the fds in the present nwt is the reduced demand for installed physical memory ram which also facilitates the simulation of considerably larger problems the ram required by the new nwt increases more or less linearly with the number of grid nodes demanding only 220 mbytes of ram per million grid nodes this advantage emerges from the fft decomposition which transforms the original 3d problem into multiple 2d problems planes the only coefficients which differ between these 2d problems are the diagonal ones therefore it is sufficient to store only one set of coefficients for a single 2d plane and just one dimensional array containing the diagonal part 5 conclusions a new method was adopted to develop an efficient nwt that solves the full set of the navier stokes equations for two fluid incompressible flow the new nwt offers the capability of simulating wave induced flows and their interaction with complex shaped impermeable coastal structures the latter is consistently coupled with fds for the solution of the resultant two fluid poisson equation frantzis and grigoriadis 2019 in the present study wave generation and absorption of regular and solitary waves is achieved using a relaxation method the interface separating water and air is modelled with the conservative level set method sgs motions were taken into account using the standard smagorinsky les model the proposed numerical wave tank is validated against analytical solutions experimental measurements and other numerical studies for different test cases i the inviscid propagation of 2 n d order stokes waves ii the formation of an inviscid standing wave iii the 2d spilling breaker over a mild slope bed iv the 3d interaction of a solitary wave with a vertical abutment and v the 3d interaction of a solitary wave and a single row pile breakwater it is demonstrated that the developed nwt is capable to accurately simulate wave hydrodynamic problems as far as the spilling breaker case is concerned an underestimation of the undertow was found in the proximity of the bed only for locations in the inner surf zone i e close to the coast however the lack of accuracy in these results is not attributed to the constant coefficient poisson equation since numerous results available in the literature that were generated with the conventional approach indicate similar agreement according to these results we concluded that this is related with the selected sgs model the computational performance of the proposed nwt was analysed and quantified against the conventional approach for various problem sizes when an explicit time stepping scheme is used speed up factors of about 30 were measured for large 3d problems even though four times smaller time steps were required compared to a conventional approach with an implicit time stepping that allows larger c f l values it was estimated that the proposed nwt would perform at least 6 times faster for large 3d problems such speed up factors enable highly resolved future investigations and parametric studies of computationally demanding wave induced nonlinear flow cases such as breaking waves with air entrainment the presented nwt can be further extended in several ways to allow the simulation of a wider range of challenging problems and wave parameters possible extensions include the adoption of different wave generation techniques such as the active wave absorption higuera et al 2013a or the inclusion of irregular waves lara et al 2006 in addition one could also employ wall approximate conditions different sgs models or interface capturing methods e g vof hirt and nichols 1981 and other parallelisation techniques e g mpi and or gpu computing the presented nwt can also be extended for the simulation of wave induced flows interacting with permeable porous structure without significant modification or any complication to the method using the darcy forchheimer equation to take into account the resistance forces relevant studies that coupled this equation with the ns equations can be found in jensen et al 2014 and del jesus et al 2012 furthermore the efficient simulation of strongly coupled fluid structure interaction fsi problems would be also feasible by extending the presented nwt to moving immersed boundaries author contributions section c frantzis methodology software validation formal analysis investigation writing original draft d g e grigoriadis supervision conceptualization software resources writing review editing funding acquisition a a dimas writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research leading to these results has received funding from the people programme marie curie actions of the european union s seventh framework programme fp7 2007 2013 under rea grant agreement n o 607394 seditrans 
