index,text
21465,as a critical step designing the ship controller and the maritime traffic simulator the system identification of a ship dynamic model from input output data is a promising direction however the noise in the training data significantly reduces the accuracy in identification and prediction here we present a robust nonparametric system identification technique for a ship maneuvering model based on gaussian process gp regression to solve the problem caused by noise the input noisy gaussian process nigp model is employed and it can automatically propagate the input uncertainty to the output in the learning model using the taylor approximation polluted simulation datasets obtained from the numerical model of a parametric container ship are used for training zigzag and turning circle maneuvering motions are performed and a comparison with gp and svm is implemented to validate the proposed approach the results indicate that the developed scheme for system identification of ships is accurate and robust with noisy input keywords ship maneuvering system system identification nonparametric dynamics model noisy input gaussian processes 1 introduction along with the progress of research in automation technology and intelligent traffic maritime autonomous surface ships mass imo 2018 and maritime traffic simulators mts hahn 2014 have been proposed and have attracted much attention establishing highly accurate ship maneuvering model is a crucial technology for ship autonomous navigation control and collision avoidance systems according to the machine executable collision regulations for marine autonomous systems maxcmas projects varas et al 2017 the establishment of a ship dynamic model usually uses a combination of mechanism modeling and identification the system identification technique with full scale trails or free running tests is an economically feasible and powerful method sutulo and guedes soares 2014 with the development of machine learning theory moreover system identification based on the data of planar motion mechanism pmm also shows good predictive performance because pmm experiment can provide abundant information for identification ross et al 2015 estimated the hydrodynamic parameters of nonlinear dynamic ship model with pmm tests xu and guedes soares 2020 proposed to use support vector machine svm to substitute the maneuvering model in shallow water generally identification techniques can be categorized into two groups parametric models and the nonparametric models bai et al 2019 a parametric model is also called a white box model in which the mathematical structure is predefined entirely from prior knowledge and physical insight and then the hydrodynamic derivatives in the ship dynamic model can be estimated by system identification methods such as ridge regression yoon and rhee 2003 maximum likelihood ml hassani et al 2013 artificial neural networks ann bhattacharyya and haddara 2006 the unscented kalman filter revestido herrero and velasco gonzález 2012 semi conjugate bayesian regression xue et al 2020 and the svm xu et al 2019 zhu et al 2019 parametric modeling has made great progress but it still contains some inherent problems i e parameter drift luo and li 2017 unmodeled dynamics such as low external perturbations and the coupling effect among the different degrees of freedom dofs haranen et al 2016 the noise in the training data is the main cause of drift of the parameter where the genetic algorithm ga using the hausdorff metric sutulo and guedes soares 2014 and the v svm wang et al 2019 are proposed to alleviate the effect of the noise in addition parametric modeling requires a detailed 3d model of the vehicle to calculate the inertial mass by potential flow theory which leads to calculation difficulties for old ships or vehicles with a complex shape in contrast to the parametric model the nonparametric model maps input data into a high dimensional feature hilbert space without any physical insight ljung 1995 which is known as the black box model in the field of computer science machine learning techniques have been widely applied in the nonparametric system identification of marine vehicles a recursive neural network rnn is first used to fit a maneuvering simulation model for surface ships moreira and guedes soares 2003 wang et al 2015a proposed generalized ellipsoidal basis function fuzzy neural networks to identify the motion dynamics of a large tanker however these ann methods have some drawbacks such as the difficulties in determining the networks structure and the need for a large amount of data for training in addition anns are not robust against noisy data more promising methods based on nonlinear kernels including svm wang et al 2015b the gaussian process gp ramire et al 2018 locally weighted learning lwl bai et al 2019 kernel ridge and symbolic regression moreno et al 2019 are used for the nonparametric identification of ship dynamic models and have obtained encouraging results the key advantage of kernel method is the nonlinear patterns in the dynamic model can be found at a reasonable computational cost among them the gp further strengthens the generalization ability with a priori introduction from a bayesian perspective most of the above works do not take into full account the effects of noise on the algorithm or only use synthetic data without noise which reduces the accuracy of the system identification since ship motion data under real sea conditions contain complex noise over the last decade the use of the gaussian process williams and rasmussen 2006 as a probabilistic nonparametric multivariable model has grown significantly the gp uses bayesian probability theory to make possible predictions rather than providing a single best fit to the observed data gp models have been widely adopted in the modeling and control of dynamic systems due to their advantages of working well with a relatively small number of identification data and noisy output kocijan 2016 in addition the gp can calculate the uncertainty of each step prediction result through the variance function and substitute the uncertainty into the next prediction girard et al 2003 which provides a wider application for time series prediction and control for example model predictive control mpc combined with gp is now a research hotspot in the field of control cao et al 2017 hewing et al 2019 in the field of marine systems multi output gaussian processes are used to identify the dynamic model of a container ship ramire et al 2018 and show better performance than rnn astfalck et al 2019 proposed using a bayesian approach including the gp to predict and quantify the extremal responses in dynamic structures rong et al 2019 applied the gp model to predict the trajectory uncertainty in real time based on automatic identification system ais data however the standard gp model assumes that the measurements of the input data are noise free williams and rasmussen 2006 while the input and output ship motion data are both corrupted by noise this assumption leads to poor modeling robustness and performance to the best of our knowledge nonparametric modeling based on gp with input noise has not been investigated for the identification of marine vehicles in this paper a nonlinear autoregressive model with exogenous input narx system identification methodology for ships is presented based on an improved gp which can automatically propagate the input noise to the output with the taylor approximation two sets of zigzag maneuvering polluted datasets from a classic container ship are used for training the gp model the performance of the robustness and generalization of narx is compared with the regular gaussian process rgp and svm these methods are verified by predicting other maneuvering motions the remainder of this paper is organized as follows section 2 explains the general gp and improved gp with noisy input data in section 3 the regression model for identification from a container ship dynamic 4 dof model is used as the study object in section 4 simulation examples are implemented to demonstrate the robustness of the identification scheme the conclusions and future work are discussed in section 5 2 gaussian process modeling framework 2 1 regular gaussian process regression gp can be viewed as a collection of random variables with a joint gaussian distribution for any finite subject gp can be conveniently specified by a mean function m x and a covariance function k x x as 1 m x e f x 2 k x x e f x m x f x m x where e denotes the expectation operator gp regression approximates an unknown function f x which maps a d dimensional input to a scalar output value f a number of training points n which include d dimensional inputs x i i 1 n and noisy observations y i i 1 n are given these collections of variables are denoted as the n d input x and the n 1 output vector y the regular gaussian process rgp assumes that the training outputs are corrupted by noise 3 y f x ε y where ε y is gaussian white noise with zero mean and variance σ y 2 the regular gp regression defines a gp prior on the function values 4 p f x n m x k x x with these modeling assumptions in place the likelihood function can be obtained 5 p y f x i 1 n n y i f i σ y 2 then combining the prior eq 4 and the likelihood function eq 5 we can obtain the posterior probability distribution and predict the function values f at a whole set of test points x 6 f y n m x m x k x x k x x k x x k σ y 2 i which leads to the rgp regression predictive equations 7 p f x x y n m s 8 m m x k x x k x x σ y 2 i 1 y m x 9 s k x x k x x k x x σ y 2 i 1 k x x the proposed model adopts the commonly used squared exponential se covariance function expressed as 10 k x i x j σ f 2 exp 1 2 x i x j t x i x j where σ f denotes the amplitude and is a diagonal matrix of the squared length scale hyperparameters typically the hyperparameters are learned by the maximum likelihood method the log likelihood function is given by 11 l o g p r g p y x θ 1 2 y m x t k x x σ y 2 i 1 y m x 1 2 l o g k x x σ y 2 i n 2 l o g 2 π this formula results in a nonlinear nonconvex optimization problem that is usually solved by the gradient ascent method note that the first term is called the data fit which measures how well the outputs y fit the hyperparameters the second term is called the complexity penalty it has an automatic regularization built into it through its foundation in bayesian probability theory the advantage of the complexity penalty is that unlike other methods such as neural networks gaussian process regression has a far smaller risk of overfitting 2 2 noisy input gaussian process regression as mentioned in the previous subsection the traditional formulation of gp regression only considers output noise σ y 2 while the input data are assumed to be noise free however the noise in the output will be passed to the input in the narx models as shown in fig 1 where c k denotes the command signals such as propeller speed and rudder angle of the ship ramire et al 2018 y k is the original output y ˆ k is polluted by noise ε z stands for the z transformation and subscript k denotes time step to deal with the uncertain input observations girard 2004 proposed an approximate approach for dealing with stochastic trial points consisted of using a taylor approximation of the gp and integrating over that this method was further developed by deisenroth 2010 and applied in his pilco algorithm deisenroth and rasmussen 2011 dallaire et al 2009 applied the uncertainty by incorporating the se covariance function to marginalize out the inputs uncertainty and to keep an analytical posterior distribution over the functions the main problem with the above approaches is that they do not consider posterior data resulting in their predictions not using all available information and not being as accurate as they could be bijl 2018 mchutchon and rasmussen 2011 proposed the nigp method which does take into account the posterior data nigp further assumes that the inputs are also noisy and the actual inputs and outputs are labeled x and y respectively 12 x x ε x where ε x is gaussian white noise with zero mean and variance x the prerequisites for this model are that each input dimension as independently corrupted by noise so x is diagonal similar to eq 3 the output function can be written as 13 y f x ε x ε y we can use a first order taylor series expansion of the gp latent function f to write an approximation to eq 11 as 14 y f x ε x t f x x ε y note that the expansion can be expanded to higher terms however these higher term calculations cost a computational load and provide no significant improvement mchutchon 2015 for notational convenience the derivative of one gp mean function in eq 14 will be denoted as f a d dimensional vector f an n d matrix denotes the value of the derivative for the n functions given that the gp prior is the same as that of the rgp p f x n 0 k x x where k x x is the n n training data covariance matrix we can obtain the predictive posterior mean and variance as 15 e f x y x k x x k x x σ y 2 i d i a g f x f t 1 y 16 v f x y x k x x k x x k x x σ y 2 i d i a g f x f t 1 k x x where the notation d i a g results in a diagonal matrix in this way the input is treated as deterministic and a correction term d i a g f x f t is added to the output noise more specifically the influence of the input noise depends on the slope of the function we are approximating our model is essentially same as a rgp if the posterior mean is fully flat the next problem is to approximate the posterior distribution based on its derivative of it compared to the rgp the nigp introduces extra hyperparameters ε x per input dimension a major advantage of this model is that these hyperparameters can be trained alongside any others by marginal likelihood note that maximum likelihood is more susceptible to overfitting than marginal likelihood maximization the marginal likelihood function of the nigp is 17 l o g p n i g p y x θ 1 2 log k n 1 2 m x y t β n 2 l o g 2 π where 18 k n k x x d i a g f x f t σ y 2 i 19 β k n 1 m x y the solution uses a two step iterative approach first we evaluate a regular gp without any input noise then calculate the derivatives and use them to approximate the posterior distribution the marginal likelihood of the gp with corrected variance is then computed we can cycle this process until things have converged this step involves chaining the derivatives of the marginal likelihood back through the slope calculation moreover the gradient descent algorithm is employed to tune the hyperparameters a complete explanation can be found in mchutchon 2015 and some supplementary notes in bijl 2018 2 3 nonlinear dynamic ship model to describe the ship motion characteristics as shown in fig 2 two reference frames the earth fixed inertial frame o 1 x 0 y 0 z 0 and body fixed moving frame o 2 x 0 y 0 z 0 are adopted the nonlinear 4 dof dynamic maneuvering motion model for the high speed container ship is given as follows son and nomoto 1982 20 m x u u m y v v r f x m y v v m x u u r y r r f y i x k p p f k w g m ϕ i z n r r n v v f n the variants are used in accordance with sname fossen 2011 where m denotes the ship mass w is the weight of the displaced water g m is the metacenter height u v r are the velocity of the surge sway and yaw motions respectively i z denotes the moments of inertia of the ship about the z 0 axes x u y v y r n v and n r are acceleration derivatives which can be determined using potential theory f x f y f k and f n are the forces and moment disturbing quantity at x 0 axis y 0 axis and z 0 axis respectively for notational convenience the left side of eq 20 containing the mass inertia coefficients and acceleration derivatives is labeled j the maneuvering model of eq 20 can be discretized using euler s method 21 v i 1 v i f j h where v u v r p t f f x f y f k f n t h is the interval time and i and i 1 are the adjacent time steps the nonlinear forces and moment are defined as 22 f x x u u u u 1 t t x v r v r x v v v 2 x r r r 2 x ϕ ϕ ϕ 2 x δ s i n δ x e x t 23 f y y v v y r r y ϕ ϕ y p p y v v v v 3 y r r r r 3 y v v r v 2 r y v r r v r 2 y v v ϕ v 2 ϕ y v ϕ ϕ v ϕ 2 y r r ϕ r 2 ϕ y r ϕ ϕ r ϕ 2 y δ c o s δ y e x t 24 f k k v v k r r k ϕ ϕ k p p k v v v v 3 k r r r r 3 k v v r v 2 r k v ϕ ϕ v ϕ 2 k v r r v r 2 k v v ϕ v 2 ϕ k r r ϕ r 2 ϕ k r ϕ ϕ r ϕ 2 k δ c o s δ k e x t 25 f n n v v n r r n ϕ ϕ n p p n v v v v 3 n r r r r 3 n v v r v 2 r n v r r v r 2 n v v ϕ v 2 ϕ n v ϕ ϕ v ϕ 2 n r r ϕ r 2 ϕ n r ϕ ϕ r ϕ 2 n δ c o s δ n e x t where t and t denote the thrust deduction factor and propeller thrust respectively and δ is the rudder angle the main particulars of the container ship are given in table 1 and the value of the hydrodynamic derivatives can be found in fossen 2011 3 numerical example study and results 3 1 identification model formulation the 4 dof dynamic parametric model including the roll motion of the container ship is used to generate training data that include the zigzag maneuver and turning circle maneuver and to test the identification methods note that using the 4 dof model considering the roll motion makes the simulated maneuvers have features that are nearly similar to those of the experiment the identification model without roll effects is shown in fig 3 the reason for identifying the 3 dof simplified model is to decrease the complexity of controller designs and reduce the training time by removing low impact input variables for ships even in the container ship the narx model is known as the time series dataset regression and prediction model where the model has to predict the next state given the current state kocijan 2016 for the ship narx identification methodology using nigp the input training datasets include polluted ship speed measurements u v r and control variables rudder angle δ at time step i 1 and the output value is the ship speed at time step i in the process of prediction the next rudder angle δ k command is determined by the controller according to the ship s motion status and then it enters the learned model as an input variable with the speed values note that the propeller thrust is assumed to be constant at cruising speed moreover the regression structure here is a multitask model normally when using a filter or smoother to preprocess noisy time series data the noise of each dimension is processed separately in contrast nigp can use data from all the outputs when learning the input noise variances not only does this estimate noise more effectively but it also reduces overfitting 3 2 simulation training data the container ship son and nomoto 1982 motion datasets used for training and validation are generated by the marine systems simulator mss perez et al 2006 the selected parametric numerical model has been employed for testing the system identification algorithms ramire et al 2018 zhu et al 2019 input training data play an important role in developing a dynamic model through system identification different methods for the design of experiments doe for marine vehicles have been proposed based on optimization algorithms and improved the accuracy of the identified model nouri et al 2018 however in most cases the zigzag test and turning circle test data are more convenient to obtain bai et al 2019 mei et al 2019 moreno salinas et al 2019 compared with zigzag maneuvers the turning test is not a good choice for system identification because of lack of persistence of excitation according to ljung 1995 because after the specified rudder is turned in the motion of circle the rudder angle as the excitation signal will no longer change and the observation values remains basically unchanged which will cause the vectors in the dataset matrix to be highly correlated xue et al 2020 wang and zou 2018 argued that utilizing multiple datasets including different zigzag tests can provide more information and features of the dynamic model hence 10 10 and 25 15 zigzag maneuvers are implemented in mss the duration of each maneuver is 420 s s and the container ship motion data are recorded with a time interval of 2s for training the training data with 420 points are polluted following the sutulo and guedes soares 2014 method as 26 ζ t ζ 0 t ζ m a x k ζ ξ t where ζ 0 t is the original sampling data ζ m a x is the maximum absolute value in the original recorded data and k ζ is the specific reduction factor for different variables which is set to 0 05 for rudder angle 0 15 for surge velocity and 1 3 for the other responses ξ t is a discrete random variable subject to a gaussian distribution the polluted results of the yaw motion and rudder angle are shown in fig 4 3 3 modeling and validation of the generalization performance the polluted data including 420 samples are used to train the rgp with the maximum likelihood using eq 11 nigp is trained with the iterative scheme which alternates between optimising the hyperparameters with marginal likelihood maximization using eq 17 and calculating the posterior gradient to add input noise respectively as a comparison the svm regression model is also tested with the same data used for the gp the se kernel function as eq 27 with an automatic kernel scale σ s v m is used to train the svm 27 k x i x j exp x i x j 2 2 σ s v m the bayesian optimization algorithm snoek et al 2012 one of the most effective global optimization algorithms is employed to tune the hyperparameters including box constraints kernel scale and epsilon in svm using the bayesopt matlab function the method of cross validation is hold out validation where 80 of the data is used for training and 20 is used for validation each group of data is numbered and randomly selected according to the ratio all the calculations and simulations are carried out in matlab r2019a with an i7 7700hq cpu and 16 gb ram the training time for tuning the hyperparameters of each model is shown in table 2 the runtime of the calculation seems to be long but it is acceptable for offline algorithms sutulo and guedes soares 2014 the training time of the svm model is longer because it uses the global optimization algorithm while the training method of gp uses a local optimal method as for modeling time the nigp model takes the longest time because it additionally calculates the gradient of gp and then uses it to add the input noise the modeling time of rgp is the shortest because the inverse of the covariance matrix term k x x σ y 2 i 1 is saved after the last step of training process and imported into the modeling calculation function to save calculation time in our program while the svm function integrated by matlab only passed hyperparameters during modeling generalization verification is necessary for identification modeling generalization performance is the ability to predict other motions not included in the training data thus other maneuvering motions that are substantially different from those of the training set which include 20 20 zigzag test and the port and starboard 30 turning circle test are predicted based on the rgp svm and nigp the input excitation of the zigzag maneuver is more complicated than the turning circle and can better reflect the dynamic performance of the learned model fig 5 depicts the 20 20 zigzag test results of the speeds in the 3 dof motions and the heading angle showing that prediction results by the learned three models are similar to the mss simulation data in sway and yaw motion the predicted surge velocity provided by nigp is in better agreement with the simulation than rgp and svm the reason for substantial difference in the prediction results of the surge movement may be that its fluctuation is more serious than that of the other motion so the rgp and svm without considering input noise are less effective note that the variance 2 σ 2 is plotted in fig 5 the variance can be seen as a confidence level of the predicted mean the confidence level of nigp is much smaller than rgp indicating that the proposed nigp model is more robust with noisy training datasets to precisely evaluate the performance of the model root mean square error rmse symmetric mean absolute percentage error smape and r 2 are adopted wang et al 2019 xu and guedes soares 2020 rmse smape and r 2 are defined from eq 28 to eq 30 respectively 28 r m s e 1 n i 1 n y i ˆ y i 2 29 s m a p e 100 n i 1 n y i ˆ y i y i ˆ y i 2 30 r 2 1 i 1 n y i y i ˆ 2 i 1 n y i y 2 where y i ˆ denotes the prediction value y i is the actual value and y is the mean value note that smape provides a percentage error between 0 and 200 the speed results are listed in table 3 the rmse and smape values are smaller and r 2 values are bigger when the forecast is more accurate similar to the information obtained from fig 5 the prediction error of surge speed based on nigp is much smaller than that based on rgp and svm table 3 shows that svm using bao has a higher prediction accuracy than rgp for validation of the port and starboard 30 turning circle test predictions of speed and trajectory are shown and compared with the mss simulation in fig 6 and fig 7 the results of the turning circle test are similar to those of the zigzag test in which the prediction data from nigp is more accurate than rgp and svm in the turning circle test the excitation signal will remain unchanged after a certain moment and the model will be in a stable state for a long time so the error index of each speed will not be suitable for comparison the ship trajectory can comprehensively reflect the prediction accuracy of the models because it is the result of the coupling and accumulation of speeds in all directions for the turning circle test the predicted trajectory of the nigp best matches the mss due to the cumulative error of speed there is a significant difference in trajectories between the rgp and the simulation admittedly there is still some error between the nigp predictions and the mss simulations one of the reasons is that the limited training data do not contain sufficient information that can fully reflect the dynamic characteristics of the ship model the dynamic characteristics of the model with a rudder angle of 30 are not included in the training data moreover the iterative scheme with gradient descent for nigp is not a global optimization algorithm so the model has the risk of fall into local optimum according to the above simulations it is obvious that the proposed nigp model has better adaptability and greater robustness with noisy observations as shown in table 2 this method increases the burden of calculation due to estimating and superimposing noise in terms of complexity and accuracy this approach is worthwhile because actual data are always contaminated by noise while the increased calculation time is acceptable 4 conclusions and discussion in this study a nonparametric model based on nigp was presented for the identification of a ship dynamic maneuvering model dealing with the noise effectively in the narx model is the key to building a stable identification model for the first time the nigp model which combines the taylor approximation and multiple iterations to estimate the input noise and propagate it to the output is used to build the identification framework of the ship dynamic model the methodology has been validated with polluted data obtained from a coupled 4 dof parametric model namely the performance of the model has been tested with standard maneuvering motions including the 20 20 zigzag test and 30 turning circle test showing higher accuracy and robustness than rgp and svm therefore it has been demonstrated that the proposed scheme is a powerful and robust modeling tool for predicting the motions of ship maneuvers forthcoming work will focus on using real maneuver data from experiments of marine vehicles in combination with the presented method to identify the dynamic model on the other hand we will introduce the sparse methods in the proposed scheme to improve operating speed and apply it to online identification credit authorship contribution statement yifan xue conceptualization methodology software yanjun liu funding acquisition resources chen ji software validation investigation gang xue supervision visualization shuting huang writing review editing declaration of competing interest the authors declare that they have no known compering financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported in part by the national key r d program of china under grant no 2019yfb2005303 the national natural science foundation of china shandong province joint fund grant no u1706230 the laboratory for marine geology qingdao national laboratory for marine science and technology grant no mgqnlm201806 appendix a supplementary data the following are the supplementary data to this article fig6a fig6a fig6b fig6b fig7a fig7a fig7b fig7b fig5 fig5 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107862 
21465,as a critical step designing the ship controller and the maritime traffic simulator the system identification of a ship dynamic model from input output data is a promising direction however the noise in the training data significantly reduces the accuracy in identification and prediction here we present a robust nonparametric system identification technique for a ship maneuvering model based on gaussian process gp regression to solve the problem caused by noise the input noisy gaussian process nigp model is employed and it can automatically propagate the input uncertainty to the output in the learning model using the taylor approximation polluted simulation datasets obtained from the numerical model of a parametric container ship are used for training zigzag and turning circle maneuvering motions are performed and a comparison with gp and svm is implemented to validate the proposed approach the results indicate that the developed scheme for system identification of ships is accurate and robust with noisy input keywords ship maneuvering system system identification nonparametric dynamics model noisy input gaussian processes 1 introduction along with the progress of research in automation technology and intelligent traffic maritime autonomous surface ships mass imo 2018 and maritime traffic simulators mts hahn 2014 have been proposed and have attracted much attention establishing highly accurate ship maneuvering model is a crucial technology for ship autonomous navigation control and collision avoidance systems according to the machine executable collision regulations for marine autonomous systems maxcmas projects varas et al 2017 the establishment of a ship dynamic model usually uses a combination of mechanism modeling and identification the system identification technique with full scale trails or free running tests is an economically feasible and powerful method sutulo and guedes soares 2014 with the development of machine learning theory moreover system identification based on the data of planar motion mechanism pmm also shows good predictive performance because pmm experiment can provide abundant information for identification ross et al 2015 estimated the hydrodynamic parameters of nonlinear dynamic ship model with pmm tests xu and guedes soares 2020 proposed to use support vector machine svm to substitute the maneuvering model in shallow water generally identification techniques can be categorized into two groups parametric models and the nonparametric models bai et al 2019 a parametric model is also called a white box model in which the mathematical structure is predefined entirely from prior knowledge and physical insight and then the hydrodynamic derivatives in the ship dynamic model can be estimated by system identification methods such as ridge regression yoon and rhee 2003 maximum likelihood ml hassani et al 2013 artificial neural networks ann bhattacharyya and haddara 2006 the unscented kalman filter revestido herrero and velasco gonzález 2012 semi conjugate bayesian regression xue et al 2020 and the svm xu et al 2019 zhu et al 2019 parametric modeling has made great progress but it still contains some inherent problems i e parameter drift luo and li 2017 unmodeled dynamics such as low external perturbations and the coupling effect among the different degrees of freedom dofs haranen et al 2016 the noise in the training data is the main cause of drift of the parameter where the genetic algorithm ga using the hausdorff metric sutulo and guedes soares 2014 and the v svm wang et al 2019 are proposed to alleviate the effect of the noise in addition parametric modeling requires a detailed 3d model of the vehicle to calculate the inertial mass by potential flow theory which leads to calculation difficulties for old ships or vehicles with a complex shape in contrast to the parametric model the nonparametric model maps input data into a high dimensional feature hilbert space without any physical insight ljung 1995 which is known as the black box model in the field of computer science machine learning techniques have been widely applied in the nonparametric system identification of marine vehicles a recursive neural network rnn is first used to fit a maneuvering simulation model for surface ships moreira and guedes soares 2003 wang et al 2015a proposed generalized ellipsoidal basis function fuzzy neural networks to identify the motion dynamics of a large tanker however these ann methods have some drawbacks such as the difficulties in determining the networks structure and the need for a large amount of data for training in addition anns are not robust against noisy data more promising methods based on nonlinear kernels including svm wang et al 2015b the gaussian process gp ramire et al 2018 locally weighted learning lwl bai et al 2019 kernel ridge and symbolic regression moreno et al 2019 are used for the nonparametric identification of ship dynamic models and have obtained encouraging results the key advantage of kernel method is the nonlinear patterns in the dynamic model can be found at a reasonable computational cost among them the gp further strengthens the generalization ability with a priori introduction from a bayesian perspective most of the above works do not take into full account the effects of noise on the algorithm or only use synthetic data without noise which reduces the accuracy of the system identification since ship motion data under real sea conditions contain complex noise over the last decade the use of the gaussian process williams and rasmussen 2006 as a probabilistic nonparametric multivariable model has grown significantly the gp uses bayesian probability theory to make possible predictions rather than providing a single best fit to the observed data gp models have been widely adopted in the modeling and control of dynamic systems due to their advantages of working well with a relatively small number of identification data and noisy output kocijan 2016 in addition the gp can calculate the uncertainty of each step prediction result through the variance function and substitute the uncertainty into the next prediction girard et al 2003 which provides a wider application for time series prediction and control for example model predictive control mpc combined with gp is now a research hotspot in the field of control cao et al 2017 hewing et al 2019 in the field of marine systems multi output gaussian processes are used to identify the dynamic model of a container ship ramire et al 2018 and show better performance than rnn astfalck et al 2019 proposed using a bayesian approach including the gp to predict and quantify the extremal responses in dynamic structures rong et al 2019 applied the gp model to predict the trajectory uncertainty in real time based on automatic identification system ais data however the standard gp model assumes that the measurements of the input data are noise free williams and rasmussen 2006 while the input and output ship motion data are both corrupted by noise this assumption leads to poor modeling robustness and performance to the best of our knowledge nonparametric modeling based on gp with input noise has not been investigated for the identification of marine vehicles in this paper a nonlinear autoregressive model with exogenous input narx system identification methodology for ships is presented based on an improved gp which can automatically propagate the input noise to the output with the taylor approximation two sets of zigzag maneuvering polluted datasets from a classic container ship are used for training the gp model the performance of the robustness and generalization of narx is compared with the regular gaussian process rgp and svm these methods are verified by predicting other maneuvering motions the remainder of this paper is organized as follows section 2 explains the general gp and improved gp with noisy input data in section 3 the regression model for identification from a container ship dynamic 4 dof model is used as the study object in section 4 simulation examples are implemented to demonstrate the robustness of the identification scheme the conclusions and future work are discussed in section 5 2 gaussian process modeling framework 2 1 regular gaussian process regression gp can be viewed as a collection of random variables with a joint gaussian distribution for any finite subject gp can be conveniently specified by a mean function m x and a covariance function k x x as 1 m x e f x 2 k x x e f x m x f x m x where e denotes the expectation operator gp regression approximates an unknown function f x which maps a d dimensional input to a scalar output value f a number of training points n which include d dimensional inputs x i i 1 n and noisy observations y i i 1 n are given these collections of variables are denoted as the n d input x and the n 1 output vector y the regular gaussian process rgp assumes that the training outputs are corrupted by noise 3 y f x ε y where ε y is gaussian white noise with zero mean and variance σ y 2 the regular gp regression defines a gp prior on the function values 4 p f x n m x k x x with these modeling assumptions in place the likelihood function can be obtained 5 p y f x i 1 n n y i f i σ y 2 then combining the prior eq 4 and the likelihood function eq 5 we can obtain the posterior probability distribution and predict the function values f at a whole set of test points x 6 f y n m x m x k x x k x x k x x k σ y 2 i which leads to the rgp regression predictive equations 7 p f x x y n m s 8 m m x k x x k x x σ y 2 i 1 y m x 9 s k x x k x x k x x σ y 2 i 1 k x x the proposed model adopts the commonly used squared exponential se covariance function expressed as 10 k x i x j σ f 2 exp 1 2 x i x j t x i x j where σ f denotes the amplitude and is a diagonal matrix of the squared length scale hyperparameters typically the hyperparameters are learned by the maximum likelihood method the log likelihood function is given by 11 l o g p r g p y x θ 1 2 y m x t k x x σ y 2 i 1 y m x 1 2 l o g k x x σ y 2 i n 2 l o g 2 π this formula results in a nonlinear nonconvex optimization problem that is usually solved by the gradient ascent method note that the first term is called the data fit which measures how well the outputs y fit the hyperparameters the second term is called the complexity penalty it has an automatic regularization built into it through its foundation in bayesian probability theory the advantage of the complexity penalty is that unlike other methods such as neural networks gaussian process regression has a far smaller risk of overfitting 2 2 noisy input gaussian process regression as mentioned in the previous subsection the traditional formulation of gp regression only considers output noise σ y 2 while the input data are assumed to be noise free however the noise in the output will be passed to the input in the narx models as shown in fig 1 where c k denotes the command signals such as propeller speed and rudder angle of the ship ramire et al 2018 y k is the original output y ˆ k is polluted by noise ε z stands for the z transformation and subscript k denotes time step to deal with the uncertain input observations girard 2004 proposed an approximate approach for dealing with stochastic trial points consisted of using a taylor approximation of the gp and integrating over that this method was further developed by deisenroth 2010 and applied in his pilco algorithm deisenroth and rasmussen 2011 dallaire et al 2009 applied the uncertainty by incorporating the se covariance function to marginalize out the inputs uncertainty and to keep an analytical posterior distribution over the functions the main problem with the above approaches is that they do not consider posterior data resulting in their predictions not using all available information and not being as accurate as they could be bijl 2018 mchutchon and rasmussen 2011 proposed the nigp method which does take into account the posterior data nigp further assumes that the inputs are also noisy and the actual inputs and outputs are labeled x and y respectively 12 x x ε x where ε x is gaussian white noise with zero mean and variance x the prerequisites for this model are that each input dimension as independently corrupted by noise so x is diagonal similar to eq 3 the output function can be written as 13 y f x ε x ε y we can use a first order taylor series expansion of the gp latent function f to write an approximation to eq 11 as 14 y f x ε x t f x x ε y note that the expansion can be expanded to higher terms however these higher term calculations cost a computational load and provide no significant improvement mchutchon 2015 for notational convenience the derivative of one gp mean function in eq 14 will be denoted as f a d dimensional vector f an n d matrix denotes the value of the derivative for the n functions given that the gp prior is the same as that of the rgp p f x n 0 k x x where k x x is the n n training data covariance matrix we can obtain the predictive posterior mean and variance as 15 e f x y x k x x k x x σ y 2 i d i a g f x f t 1 y 16 v f x y x k x x k x x k x x σ y 2 i d i a g f x f t 1 k x x where the notation d i a g results in a diagonal matrix in this way the input is treated as deterministic and a correction term d i a g f x f t is added to the output noise more specifically the influence of the input noise depends on the slope of the function we are approximating our model is essentially same as a rgp if the posterior mean is fully flat the next problem is to approximate the posterior distribution based on its derivative of it compared to the rgp the nigp introduces extra hyperparameters ε x per input dimension a major advantage of this model is that these hyperparameters can be trained alongside any others by marginal likelihood note that maximum likelihood is more susceptible to overfitting than marginal likelihood maximization the marginal likelihood function of the nigp is 17 l o g p n i g p y x θ 1 2 log k n 1 2 m x y t β n 2 l o g 2 π where 18 k n k x x d i a g f x f t σ y 2 i 19 β k n 1 m x y the solution uses a two step iterative approach first we evaluate a regular gp without any input noise then calculate the derivatives and use them to approximate the posterior distribution the marginal likelihood of the gp with corrected variance is then computed we can cycle this process until things have converged this step involves chaining the derivatives of the marginal likelihood back through the slope calculation moreover the gradient descent algorithm is employed to tune the hyperparameters a complete explanation can be found in mchutchon 2015 and some supplementary notes in bijl 2018 2 3 nonlinear dynamic ship model to describe the ship motion characteristics as shown in fig 2 two reference frames the earth fixed inertial frame o 1 x 0 y 0 z 0 and body fixed moving frame o 2 x 0 y 0 z 0 are adopted the nonlinear 4 dof dynamic maneuvering motion model for the high speed container ship is given as follows son and nomoto 1982 20 m x u u m y v v r f x m y v v m x u u r y r r f y i x k p p f k w g m ϕ i z n r r n v v f n the variants are used in accordance with sname fossen 2011 where m denotes the ship mass w is the weight of the displaced water g m is the metacenter height u v r are the velocity of the surge sway and yaw motions respectively i z denotes the moments of inertia of the ship about the z 0 axes x u y v y r n v and n r are acceleration derivatives which can be determined using potential theory f x f y f k and f n are the forces and moment disturbing quantity at x 0 axis y 0 axis and z 0 axis respectively for notational convenience the left side of eq 20 containing the mass inertia coefficients and acceleration derivatives is labeled j the maneuvering model of eq 20 can be discretized using euler s method 21 v i 1 v i f j h where v u v r p t f f x f y f k f n t h is the interval time and i and i 1 are the adjacent time steps the nonlinear forces and moment are defined as 22 f x x u u u u 1 t t x v r v r x v v v 2 x r r r 2 x ϕ ϕ ϕ 2 x δ s i n δ x e x t 23 f y y v v y r r y ϕ ϕ y p p y v v v v 3 y r r r r 3 y v v r v 2 r y v r r v r 2 y v v ϕ v 2 ϕ y v ϕ ϕ v ϕ 2 y r r ϕ r 2 ϕ y r ϕ ϕ r ϕ 2 y δ c o s δ y e x t 24 f k k v v k r r k ϕ ϕ k p p k v v v v 3 k r r r r 3 k v v r v 2 r k v ϕ ϕ v ϕ 2 k v r r v r 2 k v v ϕ v 2 ϕ k r r ϕ r 2 ϕ k r ϕ ϕ r ϕ 2 k δ c o s δ k e x t 25 f n n v v n r r n ϕ ϕ n p p n v v v v 3 n r r r r 3 n v v r v 2 r n v r r v r 2 n v v ϕ v 2 ϕ n v ϕ ϕ v ϕ 2 n r r ϕ r 2 ϕ n r ϕ ϕ r ϕ 2 n δ c o s δ n e x t where t and t denote the thrust deduction factor and propeller thrust respectively and δ is the rudder angle the main particulars of the container ship are given in table 1 and the value of the hydrodynamic derivatives can be found in fossen 2011 3 numerical example study and results 3 1 identification model formulation the 4 dof dynamic parametric model including the roll motion of the container ship is used to generate training data that include the zigzag maneuver and turning circle maneuver and to test the identification methods note that using the 4 dof model considering the roll motion makes the simulated maneuvers have features that are nearly similar to those of the experiment the identification model without roll effects is shown in fig 3 the reason for identifying the 3 dof simplified model is to decrease the complexity of controller designs and reduce the training time by removing low impact input variables for ships even in the container ship the narx model is known as the time series dataset regression and prediction model where the model has to predict the next state given the current state kocijan 2016 for the ship narx identification methodology using nigp the input training datasets include polluted ship speed measurements u v r and control variables rudder angle δ at time step i 1 and the output value is the ship speed at time step i in the process of prediction the next rudder angle δ k command is determined by the controller according to the ship s motion status and then it enters the learned model as an input variable with the speed values note that the propeller thrust is assumed to be constant at cruising speed moreover the regression structure here is a multitask model normally when using a filter or smoother to preprocess noisy time series data the noise of each dimension is processed separately in contrast nigp can use data from all the outputs when learning the input noise variances not only does this estimate noise more effectively but it also reduces overfitting 3 2 simulation training data the container ship son and nomoto 1982 motion datasets used for training and validation are generated by the marine systems simulator mss perez et al 2006 the selected parametric numerical model has been employed for testing the system identification algorithms ramire et al 2018 zhu et al 2019 input training data play an important role in developing a dynamic model through system identification different methods for the design of experiments doe for marine vehicles have been proposed based on optimization algorithms and improved the accuracy of the identified model nouri et al 2018 however in most cases the zigzag test and turning circle test data are more convenient to obtain bai et al 2019 mei et al 2019 moreno salinas et al 2019 compared with zigzag maneuvers the turning test is not a good choice for system identification because of lack of persistence of excitation according to ljung 1995 because after the specified rudder is turned in the motion of circle the rudder angle as the excitation signal will no longer change and the observation values remains basically unchanged which will cause the vectors in the dataset matrix to be highly correlated xue et al 2020 wang and zou 2018 argued that utilizing multiple datasets including different zigzag tests can provide more information and features of the dynamic model hence 10 10 and 25 15 zigzag maneuvers are implemented in mss the duration of each maneuver is 420 s s and the container ship motion data are recorded with a time interval of 2s for training the training data with 420 points are polluted following the sutulo and guedes soares 2014 method as 26 ζ t ζ 0 t ζ m a x k ζ ξ t where ζ 0 t is the original sampling data ζ m a x is the maximum absolute value in the original recorded data and k ζ is the specific reduction factor for different variables which is set to 0 05 for rudder angle 0 15 for surge velocity and 1 3 for the other responses ξ t is a discrete random variable subject to a gaussian distribution the polluted results of the yaw motion and rudder angle are shown in fig 4 3 3 modeling and validation of the generalization performance the polluted data including 420 samples are used to train the rgp with the maximum likelihood using eq 11 nigp is trained with the iterative scheme which alternates between optimising the hyperparameters with marginal likelihood maximization using eq 17 and calculating the posterior gradient to add input noise respectively as a comparison the svm regression model is also tested with the same data used for the gp the se kernel function as eq 27 with an automatic kernel scale σ s v m is used to train the svm 27 k x i x j exp x i x j 2 2 σ s v m the bayesian optimization algorithm snoek et al 2012 one of the most effective global optimization algorithms is employed to tune the hyperparameters including box constraints kernel scale and epsilon in svm using the bayesopt matlab function the method of cross validation is hold out validation where 80 of the data is used for training and 20 is used for validation each group of data is numbered and randomly selected according to the ratio all the calculations and simulations are carried out in matlab r2019a with an i7 7700hq cpu and 16 gb ram the training time for tuning the hyperparameters of each model is shown in table 2 the runtime of the calculation seems to be long but it is acceptable for offline algorithms sutulo and guedes soares 2014 the training time of the svm model is longer because it uses the global optimization algorithm while the training method of gp uses a local optimal method as for modeling time the nigp model takes the longest time because it additionally calculates the gradient of gp and then uses it to add the input noise the modeling time of rgp is the shortest because the inverse of the covariance matrix term k x x σ y 2 i 1 is saved after the last step of training process and imported into the modeling calculation function to save calculation time in our program while the svm function integrated by matlab only passed hyperparameters during modeling generalization verification is necessary for identification modeling generalization performance is the ability to predict other motions not included in the training data thus other maneuvering motions that are substantially different from those of the training set which include 20 20 zigzag test and the port and starboard 30 turning circle test are predicted based on the rgp svm and nigp the input excitation of the zigzag maneuver is more complicated than the turning circle and can better reflect the dynamic performance of the learned model fig 5 depicts the 20 20 zigzag test results of the speeds in the 3 dof motions and the heading angle showing that prediction results by the learned three models are similar to the mss simulation data in sway and yaw motion the predicted surge velocity provided by nigp is in better agreement with the simulation than rgp and svm the reason for substantial difference in the prediction results of the surge movement may be that its fluctuation is more serious than that of the other motion so the rgp and svm without considering input noise are less effective note that the variance 2 σ 2 is plotted in fig 5 the variance can be seen as a confidence level of the predicted mean the confidence level of nigp is much smaller than rgp indicating that the proposed nigp model is more robust with noisy training datasets to precisely evaluate the performance of the model root mean square error rmse symmetric mean absolute percentage error smape and r 2 are adopted wang et al 2019 xu and guedes soares 2020 rmse smape and r 2 are defined from eq 28 to eq 30 respectively 28 r m s e 1 n i 1 n y i ˆ y i 2 29 s m a p e 100 n i 1 n y i ˆ y i y i ˆ y i 2 30 r 2 1 i 1 n y i y i ˆ 2 i 1 n y i y 2 where y i ˆ denotes the prediction value y i is the actual value and y is the mean value note that smape provides a percentage error between 0 and 200 the speed results are listed in table 3 the rmse and smape values are smaller and r 2 values are bigger when the forecast is more accurate similar to the information obtained from fig 5 the prediction error of surge speed based on nigp is much smaller than that based on rgp and svm table 3 shows that svm using bao has a higher prediction accuracy than rgp for validation of the port and starboard 30 turning circle test predictions of speed and trajectory are shown and compared with the mss simulation in fig 6 and fig 7 the results of the turning circle test are similar to those of the zigzag test in which the prediction data from nigp is more accurate than rgp and svm in the turning circle test the excitation signal will remain unchanged after a certain moment and the model will be in a stable state for a long time so the error index of each speed will not be suitable for comparison the ship trajectory can comprehensively reflect the prediction accuracy of the models because it is the result of the coupling and accumulation of speeds in all directions for the turning circle test the predicted trajectory of the nigp best matches the mss due to the cumulative error of speed there is a significant difference in trajectories between the rgp and the simulation admittedly there is still some error between the nigp predictions and the mss simulations one of the reasons is that the limited training data do not contain sufficient information that can fully reflect the dynamic characteristics of the ship model the dynamic characteristics of the model with a rudder angle of 30 are not included in the training data moreover the iterative scheme with gradient descent for nigp is not a global optimization algorithm so the model has the risk of fall into local optimum according to the above simulations it is obvious that the proposed nigp model has better adaptability and greater robustness with noisy observations as shown in table 2 this method increases the burden of calculation due to estimating and superimposing noise in terms of complexity and accuracy this approach is worthwhile because actual data are always contaminated by noise while the increased calculation time is acceptable 4 conclusions and discussion in this study a nonparametric model based on nigp was presented for the identification of a ship dynamic maneuvering model dealing with the noise effectively in the narx model is the key to building a stable identification model for the first time the nigp model which combines the taylor approximation and multiple iterations to estimate the input noise and propagate it to the output is used to build the identification framework of the ship dynamic model the methodology has been validated with polluted data obtained from a coupled 4 dof parametric model namely the performance of the model has been tested with standard maneuvering motions including the 20 20 zigzag test and 30 turning circle test showing higher accuracy and robustness than rgp and svm therefore it has been demonstrated that the proposed scheme is a powerful and robust modeling tool for predicting the motions of ship maneuvers forthcoming work will focus on using real maneuver data from experiments of marine vehicles in combination with the presented method to identify the dynamic model on the other hand we will introduce the sparse methods in the proposed scheme to improve operating speed and apply it to online identification credit authorship contribution statement yifan xue conceptualization methodology software yanjun liu funding acquisition resources chen ji software validation investigation gang xue supervision visualization shuting huang writing review editing declaration of competing interest the authors declare that they have no known compering financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported in part by the national key r d program of china under grant no 2019yfb2005303 the national natural science foundation of china shandong province joint fund grant no u1706230 the laboratory for marine geology qingdao national laboratory for marine science and technology grant no mgqnlm201806 appendix a supplementary data the following are the supplementary data to this article fig6a fig6a fig6b fig6b fig7a fig7a fig7b fig7b fig5 fig5 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107862 
21466,to investigate the effect of a multiphase internal flow with hydrate phase transition on the vortex induced vibration viv of a marine riser a numerical model is established that first solves the flow parameters and the natural frequencies of risers with different gas intake ratios are obtained then a viv equation that considers the effect of the multiphase internal flow is established the newmark β method is used to solve the viv equation in the time domain finally the effect of the gas intake ratio on the natural frequencies and the vortex induced vibration response is studied the results show that the natural frequencies increase with an increase of the gas intake ratio and the changing trends of higher modes are quite obvious when the riser is subjected to a linear shear flow the viv show a multi mode response and the structural response changes from high order mode dominant to low order mode dominant with an increase of the gas intake ratio this can be explained in terms of the natural frequency of riser which increases with the increase of the gas intake ratio moreover the spanwise reduced velocity decreases which makes frequency locking occur more easily in the low order modes keywords marine risers multiphase internal flow hydrate phase transition vortex induced vibration 1 introduction marine risers are important equipment for deep water oil and gas exploration and development their upper ends are controlled by the top tension provided by the floating platform and their lower ends are connected with the wellhead of the seabed zhao et al 2018 during a marine riser s service period a high pressure oil flow passes through its interior and external environmental loads such as currents act upon it hence the viv responses of marine risers are very complex at present most of the studies on risers focus on the environmental load and top excitation khan et al 2011 lou and yu 2014 lei et al 2017 yin et al 2019 for a deep water riser internal flow effect has received considerable attention in recent years the effect of a single parameter of internal flow on the natural frequencies is investigated in the research papers wu and lou 1991 chucheepsakul et al 1999 guo et al 2004 kaewunruen et al 2005 guo and lou 2008 zhang et al 2015 xie et al 2019 the work of montoya hernández et al 2014 solved the pressure of multiphase internal flow and found that the natural frequency decreases with the increase of the velocity their results is helpful to the selection of the velocity of multiphase flow in practical engineering given the fact that the flow parameters should be coupled in the model of multiphase internal flow this work aim to solve flow parameters in a coupled way and further explore the effect of gas intake ratio on the viv when the flow parameters of pressure density velocity and acceleration change simultaneously arising from gas intake ratio instead of studying the effect of a single parameter on the natural frequencies the results can provide information for the effect of oil gas ratio which is a essential parameter in mixed oil and gas transportation some scholars have also investigated the effect of multiphase internal flow on dynamic behavior of risers without the consideration of the hydrate phase transition monprapussorn et al 2007 cabrera miranda and paik 2019 yang et al 2019 in fact there are always multiphase fluids such as crude oil natural gas and water in mixed oil and gas transportation because of the low temperatures and high pressures in the riser natural gas and water will produce natural gas hydrate as the internal fluid flow is upward the natural gas hydrate will decompose into natural gas after leaving the stable region the changes of multiphase flow parameters are obvious and should not be ignored especially in the hydrate decomposition stage therefore there are sufficient reasons to take this factor into account wang and sun 2014 studied the effect of hydrate phase transition on the internal pressure however hydrate phase transition can affect other flow parameters of the multiphase internal flow as well including the density velocity and acceleration of internal flow at present hydrate phase transition has not been considered in the analysis of viv this paper concentrates on the effect of gas intake ratio on the viv response and hydrate phase transition is considered to make the hydrodynamic model more precise the remainder of this paper is organized as follows first we establish a numerical multiphase internal flow model by considering hydrate phase transition in section 2 1 where the flow parameters are solved with the finite difference method subsequently the parameters of the multiphase internal flow are introduced into the viv equation in section 2 2 next the effect of the multiphase flow considering hydrate phase transition on the viv is discussed in section 3 we then present our conclusions in section 4 2 numerical model 2 1 model of a multiphase flow multiphase internal flow is a multiphase and multicomponent mixing system with hydrate phase transition in this work a numerical model of multiphase internal flow that considers hydrate phase transition is presented 2 1 1 hydrate phase transition model 1 phase equilibrium model the chen guo model is based on statistical thermodynamics theory which has good accuracy and wide applicability and easily converges to a solution hence the chen guo model is used to obtain the phase equilibrium conditions of natural gas hydrate chen and guo 1998 the equations of chen guo model are given in eq 1 1 f l f l 0 1 l θ 1 l α l θ 1 l l c 1 l f l 1 l c 1 l f l where f l is the fugacity of the gas f l 0 is the minimum fugacity required for the pure gas and pure water to form a stable hydrate when the system pressure approaches zero θ 1 l is the occupancy rate of guest molecule l in a type 1 cavity and c 1 l is the langmuir constant of guest molecule l in the type 1 cavity α is a constant of guest molecule l in the type 1 cavity 2 hydrate formation model the formation process of a gas hydrate is shown in fig 1 which is regarded as a problem of hydrate shell formation on a water particle surface that gradually expands inward based on vysniauskas bishnoi model s model vysniauskas et al 1983 dho et al 1993 and the hydrate shell model proposed by turner et al 2009 the hydrate formation rate equation expressed by methane gas consumption is shown in eq 2 2 u h k f 6 a e w 0 d 0 e w e w 0 2 3 exp δ e a r t exp a δ t b p γ where u h is the methane consumption rate k f is the hydrate formation rate constant a is the cross sectional area of the riser d 0 is the droplet s diameter e w 0 is the water content at the beginning of hydrate formation e w is the water content in the cross sectional area δ e a is the activation energy r is the gas constant t is the temperature p is the pressure δ t is the undercooling where δ t t c t t c is the phase equilibrium temperature and a b and γ are experimental constants 3 hydrate decomposition model a schematic diagram of the hydrate decomposition process is shown in fig 2 the process of hydrate decomposition is regarded as a problem of isometric sphere ablation from outside to inside the solution to the hydrate decomposition rate is based on the kim boshini hydrate decomposition kinetics model kim and boshini 1987 the gas production rate of hydrate decomposition is given in eq 3 3 n h k d 6 a e w 0 d 0 e w d e h e w 0 2 3 exp δ e a r t f e q f l o where n h is gas production rate k d is the hydrate decomposition rate constant e w d is the water content at the beginning of hydrate decomposition e h is the volume fraction of the hydrate in the cross sectional area and f e q and f l o are the reaction equilibrium gas fugacity and local gas fugacity respectively 2 1 2 governing equations of a multiphase internal flow drift flow theory zuber and findlay 1965 is used to model multiphase internal flows in this work the theory is based on two phase velocity field when the multiphase fluid flows at a certain speed the gas phase has a drift velocity relative to this speed while the liquid phase has a reverse drift velocity to maintain the continuity the model needs to establish the mass conservation equation of each phase to solve the velocity the velocity of each phase is calculated by the linear relationship between the drift velocity and the velocity of the mixture when dealing with the momentum and energy conservation equations the multiphase fluid is regarded as the quasi single phase mixture to solve the pressure and temperature 1 mass conservation equations 4 z ρ g e g a v g t ρ g e g a ω g x g u h z ρ w e w a v w t ρ w e w a 1 x g u h z ρ h e h a v h t ρ h e h a u h z ρ o e o a v o t ρ o e o a ω o 2 momentum conservation equations 5 z ρ g e g a v g 2 ρ w e w a v w 2 ρ h e h a v h 2 ρ o e o a v o 2 t ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o a g ρ g e g ρ w e w ρ h e h ρ o e o d a p d z d a p d z f r 3 energy conservation equations 6 t ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g a 2 f m v 2 ω a d r i u h δ h h m h ω g h 1 2 v g 2 g z ω w h 1 2 v w 2 g z ω o h 1 2 v o 2 g z 2 b t e t a further b in eq 6 can be calculated as shown in eq 7 7 b ω a c a π d r o u a where v g v w v o and v h are the velocity of the gas water oil and hydrate respectively ρ g ρ w ρ o and ρ h denote the density of the gas water oil and hydrate respectively e g e w e o and e h are the volume fractions of the gas water oil and hydrate respectively x g is the gas mass fraction in the hydrate u h is the hydrate formation decomposition rate f r is the frictional pressure drop and p is the pressure in the riser ω g ω w and ω o are the mass production rates of the gas water and oil respectively h is the enthalpy which consists of the internal energy and pressure energy v m is the velocity of mixture d r i is the inner diameter of the riser ω a is the mass flow of the fluid m h is the average molecular weight of the hydrates δ h h is the hydrate phase transition heat and t a and t e denote the temperature in the riser and the ambient temperature respectively g is acceleration of gravity c a is the specific heat capacity of the fluid d r o is the outer diameter of the riser u a is the convective heat transfer coefficient between the fluid and the environment 2 1 3 auxiliary equations because there are many variables in the numerical model proposed above it is necessary to establish auxiliary equations to make the governing equations closed 1 velocity equations 8 v e o v o e w v w e h v h e g v g v g v v g d v o v w v h v v l d 2 volume fraction equations 9 e g q g a v v g d e o 1 e g q o q o q w q h e w 1 e g q w q o q w q h e h 1 e g q h q o q w q h where v is the velocity of the mixture v g d and v l d are the drift velocity of gas and liquid relative to the mixture respectively q g q w q h and q o are the flow rates of the gas water hydrate and oil respectively 3 frictional pressure drop equations frictional pressure drop can be expressed as 10 d p d z f r 2 f m μ m 2 ρ m d r i 1 f m 4 lg 1 3 7065 δ d r i 5 0452 lg a r e m a 1 2 8257 δ d r i 1 11098 7 149 r e m 0 8981 r e m v d r i ρ m μ m μ m μ g e g μ w e w μ o e o ρ m ρ g e g ρ w e w ρ o e o where f m is the flow friction coefficient δ d r i is the wall relative roughness r e m is mixture reynolds number μ m is the mixture viscosity ρ m is the mixture density the gas viscosity is given by hagen 1999 11 μ g μ s a 1 a μ s μ 0 t t 0 3 2 t 0 s 0 t s 0 2 a 1 1 0 023 t 1800 1 tanh t 1800 1 0 125 log 10 p 6 5 1 5 0 125 log 10 p a 2 exp t 1800 14 5 1 5 log 10 p 0 9 0 1 log 10 p 1 1 the values of the corresponding parameters are μ 0 3 584 10 7 t 0 491 6 s 0 199 montoya hernandez et al 2014 the water viscosity can be calculated by hagen 1999 12 μ w e 1 12646 0 039638 t 1 7 29769 10 3 t the heavy oil viscosity can is given by emmanuel and jack 1990 13 μ o 10 10 2 06492 0 0179 a p i 0 7022 log t 1 where api is the oil specific gravity 2 1 4 solutions to the governing equations since the theoretical model of a multiphase internal flow involves many variables it is difficult to obtain its analytical solution rather only a numerical solution can be obtained in order to ensure convergence and computational speed the governing equations were discretized with a four point difference scheme and the discretized forms of govern equations are given as follows 1 mass conservation equations 14 ρ g e g v g a j 1 n 1 ρ g e g v g a j n 1 δ s 2 δ t ρ g e g a j n ρ g e g a j 1 n ρ g e g a j n 1 ρ g e g a j 1 n 1 δ s 2 ω g x g r h j n 1 ω g x g r h j 1 n 1 ρ w e w v w a j 1 n 1 ρ w e w v w a j n 1 δ s 2 δ t ρ w e w a j n ρ w e w a j 1 n ρ w e w a j n 1 ρ w e w a j 1 n 1 δ s 2 1 x g u h j n 1 1 x g u h j 1 n 1 ρ o e o v o a j 1 n 1 ρ o e o v o a j n 1 δ s 2 δ t ρ o e o a j n ρ o e o a j 1 n ρ o e o a j n 1 ρ o e o a j 1 n 1 δ s 2 ω o j n 1 ω o j 1 n 1 ρ h e h v h a j 1 n 1 ρ h e h v h a j n 1 δ s 2 δ t ρ h e h a j n ρ h e h a j 1 n ρ h e h a j n 1 ρ h e h a j 1 n 1 δ s 2 u h j n 1 u h j 1 n 1 2 momentum conservation equation 15 p j 1 n 1 p j n 1 δ s 2 δ t ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o j n ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o j 1 n ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o j n 1 ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o j 1 n 1 ρ g e g a v g 2 ρ w e w a v w 2 ρ h e h a v h 2 ρ o e o a v o 2 j n 1 ρ g e g a v g 2 ρ w e w a v w 2 ρ h e h a v h 2 ρ o e o a v o 2 j 1 n 1 δ s 2 a g ρ g e g ρ w e w ρ h e h ρ o e o j n 1 a g ρ g e g ρ w e w ρ h e h ρ o e o j 1 n 1 δ s 2 a d p d z f r j n 1 a d p d z f r j 1 n 1 3 energy conservation equation 16 w g h 1 2 v g 2 g ω w h 1 2 v w 2 g ω ο h 1 2 v ο 2 g j 1 n 1 w g h 1 2 v g 2 g ω w h 1 2 v w 2 g ω ο h 1 2 v ο 2 g j n 1 ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j n 1 δ s 2 ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j n ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j 1 n ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j n 1 ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j 1 n 1 δ s 2 2 b t e t a u h δ h h m h j n 1 2 b t e t a u h δ h h m h j 1 n 1 the scheme can then be solved iteratively using a forecast correction method here we assume that at time n the parameters for any two nodes j and j 1 in the riser are known the solution process is shown in fig 3 by taking nodes j and j 1 from time n to n 1 as an example through the above steps the parameters of all nodes at time n 1 can be calculated and according to the boundary conditions at time n 2 the parameters at time n 2 can be obtained similarly the flow parameters at all times can be calculated 2 1 5 definite conditions 1 definite conditions of the temperature the initial condition of the instantaneous temperature field is a temperature field calculated at a steady state and the boundary condition is the fluid temperature at the inlet of the riser thus the definite conditions of the temperature are given in eq 17 17 t 0 t t i t h 0 t e where h is the water depth t e is the seawater temperature and t i is the temperature of the inlet fluid 2 definite conditions of the pressure and flow parameters the pressure at the riser outlet can be measured directly assuming that the flow rate of each phase at the riser inlet is a constant the definite conditions of the pressure and flow parameters are given in eq 18 18 p z 0 0 0098 ρ l z f r z p o q g h t q g i q w h t q w i p h t p i where ρ l is the mixture density f r is the friction pressure drop q g i q o i and q w i are the flow rates of the gas oil and water at the riser inlet respectively and p i and p o are the pressures at the riser inlet and outlet respectively 2 2 viv equation the riser model studied in this paper is shown in fig 4 generally an empirical formula model of a lift oscillator is used to calculate the vortex induced viv force it is assumed that the riser vibrations are caused by the nonlinear wake oscillator and the vibrations will have the opposite effect on the oscillator in the cartesian coordinate system the origin is at the bottom of the sea h is the water depth l is the length of the riser z is the vertical coordinate of the riser element and x v z t represents the lateral displacement due to the vortex induced vibration of the riser at different positions and at different times the differential arc lengths of the riser element after deformation are given in eq 19 19 d s d x 2 d z 2 1 d x d z 2 d z 1 v 2 d z where d x and d z represent the lengths of the riser units in the lateral and vertical directions respectively next the nonlinear term s can be calculated as shown in eq 20 20 s d s d z 1 v 2 according to lagrange strain theory the strain of the riser s microelement can be obtained as eq 21 21 ε ε 0 d s d s 0 d s 0 ε 0 d s d z d z ε 0 1 v 2 1 where ε 0 is the initial deformation of the riser element and d s 0 is the initial differential arc length of the riser s element the wake oscillator model of facchinetti et al 2004 is adopted here where the motion equation of the wake oscillator is as follows 22 q ε ω s q 2 1 q ω s 2 q a v where ε is a parameter related to nonlinearity a is a fluid coupling dynamic parameter and v is the accelerated motion of the structure q is the lift oscillator coefficient which is expressed as 23 q 2 c l c l 0 where c l 0 is the amplitude of the lift coefficient of the fixed cylinder in the fluid and c l is the vortex lift coefficient ω s is the circular frequency of vortex shedding which is recorded as 24 ω s 2 π s t u d r o 25 c l 1 2 c l 0 q where s t is strouhal number u is the current velocity the force in the lateral direction of the riser is the vortex induced lift force a differential equation of the lateral viv of the riser can be obtained as 26 m r m i m a v c s v 2 m i v v s m i v v s m i v 2 s 2 t n v e i v 4 s 5 f f s where m r m i and m a are the riser mass internal fluid mass and added fluid mass respectively c is the riser damping coefficient v is the velocity of the internal flow which is obtained in eq 8 e is the elastic modulus i is the moment of inertia of the cross section of the riser indicates differentiation with respect to time indicates differentiation with respect to z f f is the vortex induced lift force further t n can be calculated by eq 27 27 t n e a ε 2 μ p e a e h z p i a i where μ is poisson s ratio p i and p e are the internal and external pressure respectively and a i and a e are the cross sectional areas inside and outside the riser respectively 28 c γ ω s ρ d 2 where γ is the additional damping coefficient of the fluid and 29 f f 1 2 ρ u 2 d c l by substituting eq 25 into the viv equation eq 26 the following form can be obtained 30 m v c c s v 2 m i v v s m i v v s m i v 2 s 2 t e v e i v 4 s 5 1 4 ρ u 2 d c l 0 q s the expression of the lateral displacement v and oscillator coefficient q of riser unit is as follows 31 v y ϕ z 32 q η ϕ z where ϕ z is the vibration mode function of the riser here the shape of the vibration mode function of a unit length riser is taken as the hermite interpolation function by substituting eq 31 into eq 30 and integrating along the length of the riser the following equation is obtained after simplification and deformation 33 y 2 ξ ω n γ ω s φ y ω n 2 y f where 34 ξ c 2 m ω n e 0 l n t s n d z e 0 l n t n d z the mass ratio φ is defined as 35 φ m ρ d 2 e 0 l n t n d z e 0 l n t s n d z 36 f 1 4 m e 0 l n t ρ u 2 d c l 0 q d z e 0 l n t n d z the dimensionless time and displacement are introduced as follows 37 τ t ω s y v d the frequency ratio is defined as 38 δ ω n ω s ω n 2 π s t u d 1 s t v r where s t is the strouhal number v r is the reduced velocity v r u f n d and f n is the natural frequency of the riser according to the experimental results of khalak and williamson 1996 when the reduced velocity is in the range of 4 0 8 0 the riser is prone to frequency locking as shown in fig 5 the corresponding riser vibration amplitude increases significantly by substituting eq 22 into eq 33 dimensionless equations of the viv are obtained as follows 39 y 2 ξ δ γ φ y δ 2 y r η 40 η ε η 2 1 η η a y the dimensionless coupling term is 41 r c l 0 2 1 8 π 2 s t 2 μ if frequency locking occurs the response and lift are usually harmonic and their frequencies are the same the solutions to the fluid structure coupling equations eqs 39 and 40 can then be recorded as follows 42 y t y 0 cos κ τ θ 43 η t η 0 cos κ τ where y 0 is the response amplitude of riser η 0 is the lift oscillator amplitude and θ is the phase difference κ is the detuning ratio given as 44 κ ω v ω s where ω v is the viv frequency by substituting eqs 42 and 43 into eq 39 trigonometrically expanding cos κ τ θ and making the sum of the coefficients of sin κ τ and cos κ τ zero we can get 45 tan θ 2 ξ δ γ φ κ δ 2 κ 2 46 y 0 η 0 r δ 2 κ 2 2 2 ξ δ γ φ 2 κ 2 0 5 47 η 0 2 1 a r ε c δ 2 κ 2 2 2 ξ δ γ φ 2 κ 2 0 5 48 κ 6 1 2 δ 2 2 ξ δ γ φ 2 κ 4 2 δ 2 2 ξ δ γ φ 2 δ 4 κ 2 δ 4 g 0 where 49 c 2 ξ δ γ φ 2 κ 2 50 g a r κ 2 δ 2 κ 2 κ can be obtained by solving eq 48 and substituting κ into eq 44 as follows 51 η 2 1 a r ε c δ 2 κ 2 2 2 ξ γ φ 2 κ 2 0 5 cos κ τ by substituting the value of eq 51 into eq 32 the value of the lift oscillator coefficient q can be obtained and then the displacement response of viv can be determined using eq 30 according to the recommended test parameters of the wake oscillator model of facchinetti et al 2004 we used γ 0 8 c l 0 0 3 ε 0 3 s t 0 2 a 12 c m 1 to calculate the vortex induced lift and obtain the viv response assuming that the ends of the riser are hinged the boundary conditions are as follows v 0 t v l t 0 52 d 2 v d z 2 z 0 d 2 v d z 2 z l 0 the vibration equation was discretized using hermite interpolation the matrix form of the vibration equation of riser is as follows 53 m v c v k v f where m c k and f are the mass matrix the damping matrix the stiffness matrix and the external force matrix respectively which are given as 54 m e m e e 0 l n t m n d z c e c e e 0 l n t c s n d z e 0 l n t 2 m i v n d z k e k e e 0 l n t m i v n d z e 0 l n t m i v 2 t n s 2 n d z e 0 l n t e i s n d z f e f e e 0 l n t f f s d z where n is the hermite interpolation function and l is length of finite element of the riser where l 10 m in this paper in the process of solving the vibration equation of riser in this paper there is a nonlinear term related to the large deformation of the riser at present the direct integral solution of the structural dynamics can be divided into an explicit integral method and an implicit integral method the central difference method is usually used in dynamic analyses however the central difference method is a conditional stability algorithm where the time step length must be less than a certain critical value otherwise the calculation results can easily be distorted for marine deep water risers and for problems with large response time scales an implicit algorithm with unconditional stability is usually used deep water risers are long flexible pipes that are prone to large deformations and non linear deformations under marine environmental loads the newmark β method is an implicit direct integration algorithm which is unconditionally stable when the appropriate integration constants are selected it can use large time steps in the calculation process so it is especially suitable for the transient response analysis of a riser system with a long time history therefore the newmark β method was used here to solve the viv response and the integration constants used are α 1 2 β 1 4 the whole solution process is shown in fig 6 2 3 program verification a program was developed based on the established numerical model of the multiphase internal flow and the vibration equation of the marine riser this program was validated by calculating the internal pressure and natural frequency with the parameters given by montoya hernandez et al 2014 further in order to validate the correctness of the program of viv model the viv forces at different times were calculated according to the wake oscillator model then pipe 59 element was used in the ansys software to establish the riser model finally the viv forces at different times are introduced in transient dynamic analysis to obtain the viv response of the riser in ansys the parameters of the multiphase internal flow are shown in table 1 and the parameters of the viv analysis are given in table 2 fig 7 a shows that the internal pressure predicted by the internal flow analysis model in this paper is in good agreement with that predicted in the literature the reason for the discrepancy is that the effect of hydrate phase transition on the pressure is taken into account in our internal flow model fig 7b also shows a good agreement between the program results and ansys software analysis the amplitude increases gradually with time and does not change when it reaches a certain value 3 results and discussion 3 1 analysis of the flow parameters of the multiphase internal flow the riser s internal flow was modelled as a multiphase and multicomponent mixing system in this part we study the effects of gas intake ratio gas volume fraction at the riser inlet on the multiphase flow parameters during the flow process from the underwater wellhead to floating platform as shown in table 3 because the density of natural gas is determined by its temperature and pressure the density is calculated as follows 55 ρ g 3486 6 p ρ g s z t where ρ g s is the relative density of natural gas where the composition of natural gas only includes methane in this paper ρ g s 0 5548 and z is the compression factor of natural gas which is dimensionless fig 8 a shows the internal temperature and phase equilibrium temperature under different gas intake ratios the intersection point between the internal temperature curve and the phase equilibrium curve is the critical point of the hydrate phase transition below this critical point the hydrate is in the formation region above the critical point the hydrate is in the decomposition region fig 8b displays the heat produced by friction between the internal flow and the wall the hydrate phase transition and the heat transfer between the internal flow and the external seawater when the gas intake ratio is 20 it can be seen that the internal temperature is mainly affected by the heat transfer from the external seawater while the hydrate phase transition and the friction between the internal flow and the wall have little influence on the internal temperature assuming that the inlet temperature of the internal flow is 10 c the internal temperature decreases when the external seawater temperature is lower than the internal temperature reaching the lowest value at 900 m below the water surface the inlet temperature then rises with the rapid increase of the sea water temperature near the water s surface reaching a maximum at the outlet it can be seen from fig 8a that the outlet temperature at gas intake ratios of 10 20 30 and 40 are 17 97 c 17 43 c 17 04 c and 16 67 c respectively that is to say when the inlet temperature is the same the higher the gas intake ratio the lower the outlet temperature this is because as the gas intake ratio increases the internal flow velocity increases see fig 8c resulting in a decrease in the heat transfer time at the same time an increase of the gas volume fraction decreases the specific heat capacity and thermal conductivity of the internal flow both of which reduce the heat transfer between the internal flow and the external sea water therefore at the same inlet temperature the temperature of a lower gas intake ratio is closer to the ambient temperature fig 8c f shows the changes of the velocity acceleration density and pressure respectively at different gas intake ratios as the fluid flows upward the expansion of the gas and the decomposition of the hydrate increase the gas volume fraction the mixed phase velocity and the acceleration while the density decreases the low density causes the gravity pressure drop to decrease while the high velocity caused by the high gas intake ratio increases the frictional pressure drop rate but the effect of the gravity pressure drop is much greater than the frictional pressure drop resulting in a net decrease in the total pressure drop when the riser outlet pressure remains unchanged the overall internal pressure decreases therefore the phase equilibrium curve shifts to the left and the hydrate formation region descends in depth at the same time it can be observed that the formation of the hydrates consumes gas and slows down the change of the flow parameters caused by gas expansion in the hydrate decomposition region gas generated by hydrate decomposition accelerates the changes of the multiphase flow parameters especially near the water s surface according to the above discussion the flow parameters such as the velocity acceleration density and pressure constantly change in the upward flow changes in the flow parameters will affect the stiffness matrix mass matrix and damping matrix in the discrete vibration differential equation of the riser in the next section the effect of the multiphase internal flow on the dynamic characteristics and viv responses will be further discussed based on the calculated results given in this section 3 2 effect of the gas intake ratio on the natural frequencies of the riser fig 9 a d are the first fifth tenth and fifteenth order natural frequencies of the riser for constant flow velocities v 0 m s and v 0 79 m s and gas intake ratios 10 20 30 and 40 when the internal flow is purely liquid and the velocity is constant v 0 m s and v 0 79 m s the first fifth tenth and fifteenth order natural frequencies decrease with an increase of the internal flow velocity however when the velocity increment is small the natural frequency of the riser decreases slightly which is consistent with the conclusions of montoya hernandez et al 2014 when the fluid in the riser is a multiphase flow with hydrate phase transition the natural frequencies of the riser at different gas intake ratios were obtained based on the calculated results of the internal flow parameters presented in section 3 1 the results show that the natural frequencies of risers in the first fifth tenth and fifteenth modes increase with an increase of the gas intake ratio the natural frequencies of different modes show similar regularity with an increase of air volume but the trend of increasing natural frequencies with an increase of the gas intake ratio is more obvious in the higher modes according to the results given in section 3 1 an increase of gas intake cause the density and pressure decrease the acceleration to increase as can be found in eq 54 the mass matrix and stiffness matrix show that the stiffness matrix increase with an decrease of internal pressure and an increase of acceleration whereas the mass matrix decrease with an decrease of density the natural frequencies are related to the mass and stiffness of the riser therefore the change of these parameters arising from an increasing gas intake ratio can cause the stiffness to increase and the mass to decrease which will eventually cause the natural frequencies to increase so when the fluid in the riser is a multiphase flow with hydrate phase transition the natural vibration frequency of the riser generally shows an increasing trend with an increase of the gas intake ratio 3 3 analysis of viv of a marine riser with a multiphase internal flow according to the current research on the effect of internal flow on the dynamic characteristics of marine risers the flow parameters along the riser remain unchanged in the same case given the fact that the multiphase flow parameters change constantly along the span to further study the effect of the multiphase internal flow on the spanwise viv response of a marine riser the following three cases are considered the parameters of the current are shown in table 4 and the other parameters are shown in table 3 3 3 1 effect of the gas intake ratio on the amplitude envelope fig 10 and fig 11 show the amplitude envelope and response spectra of viv subjected to a uniform flow and a linear shear flow respectively when the velocity of the uniform flow is 0 2 m s the frequency locking of the riser and current occurs in the fourth mode where the response frequency is approximately equal to the fourth natural frequency of the riser fig 11a as can be seen from fig 10a the amplitude envelope decreases with an increase of the gas intake ratio which is due to the natural vibration frequency concurrently increasing with the gas intake ratio as shown in section 3 2 the reduced velocity decreases with an increase of the natural frequency and when it is in the range of the upper branch the amplitude decreases with a decrease of the reduced velocity fig 5 it also can be seen from fig 10b and c that when subjected to a linear shear flow as the vortex discharge frequency changes according to the velocity of the current the viv shows a multi mode response fig 11b and c and the amplitude envelope changes significantly with an increasing gas intake ratio this can be explained by the changing gas intake ratio affecting the natural frequency of the riser which then affects the frequency locking mode between the riser and the current 3 3 2 effect of the gas intake ratio on the response spectrum characteristics since the shear flow more closely resembles an actual marine environment the multi mode viv subjected to a shear flow is more complex therefore in this section we further study the multi mode viv in case 2 and analyze the effect of the gas intake ratio on the response spectrum characteristics as can be seen from fig 12 a when the gas intake ratio is 10 the spanwise distribution of the power spectral density in the frequency domain shows five response frequencies corresponding to the fourth to eighth order natural frequencies the locking vibration in the upper region of the riser gradually transits from the eighth order to the seventh order with an increase of the gas intake ratio when the air intake ratio is 40 the response corresponding to the eighth order natural frequency basically disappears and only four frequencies corresponding to the fourth to the seventh orders can be observed along the span it can also be seen from fig 12 that with an increase of the gas intake ratio the peak value of power spectral density gradually shifts from the middle to the lower part of the riser 3 3 3 effect of the gas intake ratio on the response time frequency characteristics the frequency spectrum analysis shows that when the riser is subjected to a linear shear flow the viv for different gas intake ratios show a multi mode response but it is impossible to determine whether the dominant frequency of the response changes with time therefore time frequency analyses were carried out using wavelet transforms the instantaneous frequency and time function of the response were monitored using the spanwise position of the riser the scale shows the square magnitude of a continuous wavelet transforms as a function of frequency and time fig 13 a c and 13e show displacement time history curves within 200 s at the middle of riser z 600 for gas intake ratios of 0 20 and 40 respectively fig 13b d and 13f are the corresponding displacement time frequency nephograms from them it can be seen that the response at the middle of the riser is a multi frequency vibration corresponding to the fourth to eighth order natural frequencies of the riser the frequencies do not change after the response becomes stable but with an increase of the gas intake ratio the structural response gradually changes from high order mode dominant to low order mode dominant this is because when the natural frequency of the riser increases with the gas intake ratio the velocity along the entire span decreases and the frequency locking more likely occurs in low order modes 4 conclusions in this paper a numerical model of a multiphase internal flow with hydrate phase transition was established the multiphase internal flow included oil gas water and hydrate and was regarded as quasi single phase mixture the flow parameters were first solved with the finite difference method then by considering the effects of the multiphase internal flow a viv equation of marine riser was established the newmark β method was used to solve the viv response in the time domain the viv characteristics of the riser were analyzed including the effect of the gas intake ratio on the natural frequencies of the riser and the viv response the following conclusions can be drawn 1 from the riser s inlet to its outlet the pressure and density of the internal flow decrease while the velocity and acceleration increase in the hydrate formation region because the formation of hydrates consumes gas the flow parameters changed slowly in the hydrate decomposition region the decomposition of the hydrates increases the gas volume fraction and accelerates the changing trend of the flow parameters at the same time the pressure and density of the internal flow decrease while the velocity and acceleration increase with an increase of gas intake 2 the natural frequency of the riser decreases with an increase of the internal flow velocity but an increase of gas intake also changes other flow parameters including the acceleration pressure and density which result in an increase of the natural frequency of the riser with the increase of gas intake where the changing trend is obvious in higher modes 3 when the riser is subjected to a linear shear flow the viv show a multi mode response which is different to the single frequency response when the riser is subjected to a uniform flow with an increase of the gas intake ratio the structural response changes from high order mode dominant to low order mode dominant this can be explained by the natural frequency of riser increasing with the increase of the gas intake ratio simultaneously the spanwise reduced velocity decreases which makes frequency locking more easily occur in the low order mode credit authorship contribution statement weixing liang writing review editing formal analysis min lou writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by the national natural science foundation of china grant 51579245 and the national key research and development program of china grant 2016yfc0303800 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107758 
21466,to investigate the effect of a multiphase internal flow with hydrate phase transition on the vortex induced vibration viv of a marine riser a numerical model is established that first solves the flow parameters and the natural frequencies of risers with different gas intake ratios are obtained then a viv equation that considers the effect of the multiphase internal flow is established the newmark β method is used to solve the viv equation in the time domain finally the effect of the gas intake ratio on the natural frequencies and the vortex induced vibration response is studied the results show that the natural frequencies increase with an increase of the gas intake ratio and the changing trends of higher modes are quite obvious when the riser is subjected to a linear shear flow the viv show a multi mode response and the structural response changes from high order mode dominant to low order mode dominant with an increase of the gas intake ratio this can be explained in terms of the natural frequency of riser which increases with the increase of the gas intake ratio moreover the spanwise reduced velocity decreases which makes frequency locking occur more easily in the low order modes keywords marine risers multiphase internal flow hydrate phase transition vortex induced vibration 1 introduction marine risers are important equipment for deep water oil and gas exploration and development their upper ends are controlled by the top tension provided by the floating platform and their lower ends are connected with the wellhead of the seabed zhao et al 2018 during a marine riser s service period a high pressure oil flow passes through its interior and external environmental loads such as currents act upon it hence the viv responses of marine risers are very complex at present most of the studies on risers focus on the environmental load and top excitation khan et al 2011 lou and yu 2014 lei et al 2017 yin et al 2019 for a deep water riser internal flow effect has received considerable attention in recent years the effect of a single parameter of internal flow on the natural frequencies is investigated in the research papers wu and lou 1991 chucheepsakul et al 1999 guo et al 2004 kaewunruen et al 2005 guo and lou 2008 zhang et al 2015 xie et al 2019 the work of montoya hernández et al 2014 solved the pressure of multiphase internal flow and found that the natural frequency decreases with the increase of the velocity their results is helpful to the selection of the velocity of multiphase flow in practical engineering given the fact that the flow parameters should be coupled in the model of multiphase internal flow this work aim to solve flow parameters in a coupled way and further explore the effect of gas intake ratio on the viv when the flow parameters of pressure density velocity and acceleration change simultaneously arising from gas intake ratio instead of studying the effect of a single parameter on the natural frequencies the results can provide information for the effect of oil gas ratio which is a essential parameter in mixed oil and gas transportation some scholars have also investigated the effect of multiphase internal flow on dynamic behavior of risers without the consideration of the hydrate phase transition monprapussorn et al 2007 cabrera miranda and paik 2019 yang et al 2019 in fact there are always multiphase fluids such as crude oil natural gas and water in mixed oil and gas transportation because of the low temperatures and high pressures in the riser natural gas and water will produce natural gas hydrate as the internal fluid flow is upward the natural gas hydrate will decompose into natural gas after leaving the stable region the changes of multiphase flow parameters are obvious and should not be ignored especially in the hydrate decomposition stage therefore there are sufficient reasons to take this factor into account wang and sun 2014 studied the effect of hydrate phase transition on the internal pressure however hydrate phase transition can affect other flow parameters of the multiphase internal flow as well including the density velocity and acceleration of internal flow at present hydrate phase transition has not been considered in the analysis of viv this paper concentrates on the effect of gas intake ratio on the viv response and hydrate phase transition is considered to make the hydrodynamic model more precise the remainder of this paper is organized as follows first we establish a numerical multiphase internal flow model by considering hydrate phase transition in section 2 1 where the flow parameters are solved with the finite difference method subsequently the parameters of the multiphase internal flow are introduced into the viv equation in section 2 2 next the effect of the multiphase flow considering hydrate phase transition on the viv is discussed in section 3 we then present our conclusions in section 4 2 numerical model 2 1 model of a multiphase flow multiphase internal flow is a multiphase and multicomponent mixing system with hydrate phase transition in this work a numerical model of multiphase internal flow that considers hydrate phase transition is presented 2 1 1 hydrate phase transition model 1 phase equilibrium model the chen guo model is based on statistical thermodynamics theory which has good accuracy and wide applicability and easily converges to a solution hence the chen guo model is used to obtain the phase equilibrium conditions of natural gas hydrate chen and guo 1998 the equations of chen guo model are given in eq 1 1 f l f l 0 1 l θ 1 l α l θ 1 l l c 1 l f l 1 l c 1 l f l where f l is the fugacity of the gas f l 0 is the minimum fugacity required for the pure gas and pure water to form a stable hydrate when the system pressure approaches zero θ 1 l is the occupancy rate of guest molecule l in a type 1 cavity and c 1 l is the langmuir constant of guest molecule l in the type 1 cavity α is a constant of guest molecule l in the type 1 cavity 2 hydrate formation model the formation process of a gas hydrate is shown in fig 1 which is regarded as a problem of hydrate shell formation on a water particle surface that gradually expands inward based on vysniauskas bishnoi model s model vysniauskas et al 1983 dho et al 1993 and the hydrate shell model proposed by turner et al 2009 the hydrate formation rate equation expressed by methane gas consumption is shown in eq 2 2 u h k f 6 a e w 0 d 0 e w e w 0 2 3 exp δ e a r t exp a δ t b p γ where u h is the methane consumption rate k f is the hydrate formation rate constant a is the cross sectional area of the riser d 0 is the droplet s diameter e w 0 is the water content at the beginning of hydrate formation e w is the water content in the cross sectional area δ e a is the activation energy r is the gas constant t is the temperature p is the pressure δ t is the undercooling where δ t t c t t c is the phase equilibrium temperature and a b and γ are experimental constants 3 hydrate decomposition model a schematic diagram of the hydrate decomposition process is shown in fig 2 the process of hydrate decomposition is regarded as a problem of isometric sphere ablation from outside to inside the solution to the hydrate decomposition rate is based on the kim boshini hydrate decomposition kinetics model kim and boshini 1987 the gas production rate of hydrate decomposition is given in eq 3 3 n h k d 6 a e w 0 d 0 e w d e h e w 0 2 3 exp δ e a r t f e q f l o where n h is gas production rate k d is the hydrate decomposition rate constant e w d is the water content at the beginning of hydrate decomposition e h is the volume fraction of the hydrate in the cross sectional area and f e q and f l o are the reaction equilibrium gas fugacity and local gas fugacity respectively 2 1 2 governing equations of a multiphase internal flow drift flow theory zuber and findlay 1965 is used to model multiphase internal flows in this work the theory is based on two phase velocity field when the multiphase fluid flows at a certain speed the gas phase has a drift velocity relative to this speed while the liquid phase has a reverse drift velocity to maintain the continuity the model needs to establish the mass conservation equation of each phase to solve the velocity the velocity of each phase is calculated by the linear relationship between the drift velocity and the velocity of the mixture when dealing with the momentum and energy conservation equations the multiphase fluid is regarded as the quasi single phase mixture to solve the pressure and temperature 1 mass conservation equations 4 z ρ g e g a v g t ρ g e g a ω g x g u h z ρ w e w a v w t ρ w e w a 1 x g u h z ρ h e h a v h t ρ h e h a u h z ρ o e o a v o t ρ o e o a ω o 2 momentum conservation equations 5 z ρ g e g a v g 2 ρ w e w a v w 2 ρ h e h a v h 2 ρ o e o a v o 2 t ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o a g ρ g e g ρ w e w ρ h e h ρ o e o d a p d z d a p d z f r 3 energy conservation equations 6 t ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g a 2 f m v 2 ω a d r i u h δ h h m h ω g h 1 2 v g 2 g z ω w h 1 2 v w 2 g z ω o h 1 2 v o 2 g z 2 b t e t a further b in eq 6 can be calculated as shown in eq 7 7 b ω a c a π d r o u a where v g v w v o and v h are the velocity of the gas water oil and hydrate respectively ρ g ρ w ρ o and ρ h denote the density of the gas water oil and hydrate respectively e g e w e o and e h are the volume fractions of the gas water oil and hydrate respectively x g is the gas mass fraction in the hydrate u h is the hydrate formation decomposition rate f r is the frictional pressure drop and p is the pressure in the riser ω g ω w and ω o are the mass production rates of the gas water and oil respectively h is the enthalpy which consists of the internal energy and pressure energy v m is the velocity of mixture d r i is the inner diameter of the riser ω a is the mass flow of the fluid m h is the average molecular weight of the hydrates δ h h is the hydrate phase transition heat and t a and t e denote the temperature in the riser and the ambient temperature respectively g is acceleration of gravity c a is the specific heat capacity of the fluid d r o is the outer diameter of the riser u a is the convective heat transfer coefficient between the fluid and the environment 2 1 3 auxiliary equations because there are many variables in the numerical model proposed above it is necessary to establish auxiliary equations to make the governing equations closed 1 velocity equations 8 v e o v o e w v w e h v h e g v g v g v v g d v o v w v h v v l d 2 volume fraction equations 9 e g q g a v v g d e o 1 e g q o q o q w q h e w 1 e g q w q o q w q h e h 1 e g q h q o q w q h where v is the velocity of the mixture v g d and v l d are the drift velocity of gas and liquid relative to the mixture respectively q g q w q h and q o are the flow rates of the gas water hydrate and oil respectively 3 frictional pressure drop equations frictional pressure drop can be expressed as 10 d p d z f r 2 f m μ m 2 ρ m d r i 1 f m 4 lg 1 3 7065 δ d r i 5 0452 lg a r e m a 1 2 8257 δ d r i 1 11098 7 149 r e m 0 8981 r e m v d r i ρ m μ m μ m μ g e g μ w e w μ o e o ρ m ρ g e g ρ w e w ρ o e o where f m is the flow friction coefficient δ d r i is the wall relative roughness r e m is mixture reynolds number μ m is the mixture viscosity ρ m is the mixture density the gas viscosity is given by hagen 1999 11 μ g μ s a 1 a μ s μ 0 t t 0 3 2 t 0 s 0 t s 0 2 a 1 1 0 023 t 1800 1 tanh t 1800 1 0 125 log 10 p 6 5 1 5 0 125 log 10 p a 2 exp t 1800 14 5 1 5 log 10 p 0 9 0 1 log 10 p 1 1 the values of the corresponding parameters are μ 0 3 584 10 7 t 0 491 6 s 0 199 montoya hernandez et al 2014 the water viscosity can be calculated by hagen 1999 12 μ w e 1 12646 0 039638 t 1 7 29769 10 3 t the heavy oil viscosity can is given by emmanuel and jack 1990 13 μ o 10 10 2 06492 0 0179 a p i 0 7022 log t 1 where api is the oil specific gravity 2 1 4 solutions to the governing equations since the theoretical model of a multiphase internal flow involves many variables it is difficult to obtain its analytical solution rather only a numerical solution can be obtained in order to ensure convergence and computational speed the governing equations were discretized with a four point difference scheme and the discretized forms of govern equations are given as follows 1 mass conservation equations 14 ρ g e g v g a j 1 n 1 ρ g e g v g a j n 1 δ s 2 δ t ρ g e g a j n ρ g e g a j 1 n ρ g e g a j n 1 ρ g e g a j 1 n 1 δ s 2 ω g x g r h j n 1 ω g x g r h j 1 n 1 ρ w e w v w a j 1 n 1 ρ w e w v w a j n 1 δ s 2 δ t ρ w e w a j n ρ w e w a j 1 n ρ w e w a j n 1 ρ w e w a j 1 n 1 δ s 2 1 x g u h j n 1 1 x g u h j 1 n 1 ρ o e o v o a j 1 n 1 ρ o e o v o a j n 1 δ s 2 δ t ρ o e o a j n ρ o e o a j 1 n ρ o e o a j n 1 ρ o e o a j 1 n 1 δ s 2 ω o j n 1 ω o j 1 n 1 ρ h e h v h a j 1 n 1 ρ h e h v h a j n 1 δ s 2 δ t ρ h e h a j n ρ h e h a j 1 n ρ h e h a j n 1 ρ h e h a j 1 n 1 δ s 2 u h j n 1 u h j 1 n 1 2 momentum conservation equation 15 p j 1 n 1 p j n 1 δ s 2 δ t ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o j n ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o j 1 n ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o j n 1 ρ g e g a v g ρ w e w a v w ρ h e h a v h ρ o e o a v o j 1 n 1 ρ g e g a v g 2 ρ w e w a v w 2 ρ h e h a v h 2 ρ o e o a v o 2 j n 1 ρ g e g a v g 2 ρ w e w a v w 2 ρ h e h a v h 2 ρ o e o a v o 2 j 1 n 1 δ s 2 a g ρ g e g ρ w e w ρ h e h ρ o e o j n 1 a g ρ g e g ρ w e w ρ h e h ρ o e o j 1 n 1 δ s 2 a d p d z f r j n 1 a d p d z f r j 1 n 1 3 energy conservation equation 16 w g h 1 2 v g 2 g ω w h 1 2 v w 2 g ω ο h 1 2 v ο 2 g j 1 n 1 w g h 1 2 v g 2 g ω w h 1 2 v w 2 g ω ο h 1 2 v ο 2 g j n 1 ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j n 1 δ s 2 ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j n ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j 1 n ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j n 1 ρ g e g h 1 2 v g 2 g ρ w e w h 1 2 v w 2 g ρ o e o h 1 2 v o 2 g j 1 n 1 δ s 2 2 b t e t a u h δ h h m h j n 1 2 b t e t a u h δ h h m h j 1 n 1 the scheme can then be solved iteratively using a forecast correction method here we assume that at time n the parameters for any two nodes j and j 1 in the riser are known the solution process is shown in fig 3 by taking nodes j and j 1 from time n to n 1 as an example through the above steps the parameters of all nodes at time n 1 can be calculated and according to the boundary conditions at time n 2 the parameters at time n 2 can be obtained similarly the flow parameters at all times can be calculated 2 1 5 definite conditions 1 definite conditions of the temperature the initial condition of the instantaneous temperature field is a temperature field calculated at a steady state and the boundary condition is the fluid temperature at the inlet of the riser thus the definite conditions of the temperature are given in eq 17 17 t 0 t t i t h 0 t e where h is the water depth t e is the seawater temperature and t i is the temperature of the inlet fluid 2 definite conditions of the pressure and flow parameters the pressure at the riser outlet can be measured directly assuming that the flow rate of each phase at the riser inlet is a constant the definite conditions of the pressure and flow parameters are given in eq 18 18 p z 0 0 0098 ρ l z f r z p o q g h t q g i q w h t q w i p h t p i where ρ l is the mixture density f r is the friction pressure drop q g i q o i and q w i are the flow rates of the gas oil and water at the riser inlet respectively and p i and p o are the pressures at the riser inlet and outlet respectively 2 2 viv equation the riser model studied in this paper is shown in fig 4 generally an empirical formula model of a lift oscillator is used to calculate the vortex induced viv force it is assumed that the riser vibrations are caused by the nonlinear wake oscillator and the vibrations will have the opposite effect on the oscillator in the cartesian coordinate system the origin is at the bottom of the sea h is the water depth l is the length of the riser z is the vertical coordinate of the riser element and x v z t represents the lateral displacement due to the vortex induced vibration of the riser at different positions and at different times the differential arc lengths of the riser element after deformation are given in eq 19 19 d s d x 2 d z 2 1 d x d z 2 d z 1 v 2 d z where d x and d z represent the lengths of the riser units in the lateral and vertical directions respectively next the nonlinear term s can be calculated as shown in eq 20 20 s d s d z 1 v 2 according to lagrange strain theory the strain of the riser s microelement can be obtained as eq 21 21 ε ε 0 d s d s 0 d s 0 ε 0 d s d z d z ε 0 1 v 2 1 where ε 0 is the initial deformation of the riser element and d s 0 is the initial differential arc length of the riser s element the wake oscillator model of facchinetti et al 2004 is adopted here where the motion equation of the wake oscillator is as follows 22 q ε ω s q 2 1 q ω s 2 q a v where ε is a parameter related to nonlinearity a is a fluid coupling dynamic parameter and v is the accelerated motion of the structure q is the lift oscillator coefficient which is expressed as 23 q 2 c l c l 0 where c l 0 is the amplitude of the lift coefficient of the fixed cylinder in the fluid and c l is the vortex lift coefficient ω s is the circular frequency of vortex shedding which is recorded as 24 ω s 2 π s t u d r o 25 c l 1 2 c l 0 q where s t is strouhal number u is the current velocity the force in the lateral direction of the riser is the vortex induced lift force a differential equation of the lateral viv of the riser can be obtained as 26 m r m i m a v c s v 2 m i v v s m i v v s m i v 2 s 2 t n v e i v 4 s 5 f f s where m r m i and m a are the riser mass internal fluid mass and added fluid mass respectively c is the riser damping coefficient v is the velocity of the internal flow which is obtained in eq 8 e is the elastic modulus i is the moment of inertia of the cross section of the riser indicates differentiation with respect to time indicates differentiation with respect to z f f is the vortex induced lift force further t n can be calculated by eq 27 27 t n e a ε 2 μ p e a e h z p i a i where μ is poisson s ratio p i and p e are the internal and external pressure respectively and a i and a e are the cross sectional areas inside and outside the riser respectively 28 c γ ω s ρ d 2 where γ is the additional damping coefficient of the fluid and 29 f f 1 2 ρ u 2 d c l by substituting eq 25 into the viv equation eq 26 the following form can be obtained 30 m v c c s v 2 m i v v s m i v v s m i v 2 s 2 t e v e i v 4 s 5 1 4 ρ u 2 d c l 0 q s the expression of the lateral displacement v and oscillator coefficient q of riser unit is as follows 31 v y ϕ z 32 q η ϕ z where ϕ z is the vibration mode function of the riser here the shape of the vibration mode function of a unit length riser is taken as the hermite interpolation function by substituting eq 31 into eq 30 and integrating along the length of the riser the following equation is obtained after simplification and deformation 33 y 2 ξ ω n γ ω s φ y ω n 2 y f where 34 ξ c 2 m ω n e 0 l n t s n d z e 0 l n t n d z the mass ratio φ is defined as 35 φ m ρ d 2 e 0 l n t n d z e 0 l n t s n d z 36 f 1 4 m e 0 l n t ρ u 2 d c l 0 q d z e 0 l n t n d z the dimensionless time and displacement are introduced as follows 37 τ t ω s y v d the frequency ratio is defined as 38 δ ω n ω s ω n 2 π s t u d 1 s t v r where s t is the strouhal number v r is the reduced velocity v r u f n d and f n is the natural frequency of the riser according to the experimental results of khalak and williamson 1996 when the reduced velocity is in the range of 4 0 8 0 the riser is prone to frequency locking as shown in fig 5 the corresponding riser vibration amplitude increases significantly by substituting eq 22 into eq 33 dimensionless equations of the viv are obtained as follows 39 y 2 ξ δ γ φ y δ 2 y r η 40 η ε η 2 1 η η a y the dimensionless coupling term is 41 r c l 0 2 1 8 π 2 s t 2 μ if frequency locking occurs the response and lift are usually harmonic and their frequencies are the same the solutions to the fluid structure coupling equations eqs 39 and 40 can then be recorded as follows 42 y t y 0 cos κ τ θ 43 η t η 0 cos κ τ where y 0 is the response amplitude of riser η 0 is the lift oscillator amplitude and θ is the phase difference κ is the detuning ratio given as 44 κ ω v ω s where ω v is the viv frequency by substituting eqs 42 and 43 into eq 39 trigonometrically expanding cos κ τ θ and making the sum of the coefficients of sin κ τ and cos κ τ zero we can get 45 tan θ 2 ξ δ γ φ κ δ 2 κ 2 46 y 0 η 0 r δ 2 κ 2 2 2 ξ δ γ φ 2 κ 2 0 5 47 η 0 2 1 a r ε c δ 2 κ 2 2 2 ξ δ γ φ 2 κ 2 0 5 48 κ 6 1 2 δ 2 2 ξ δ γ φ 2 κ 4 2 δ 2 2 ξ δ γ φ 2 δ 4 κ 2 δ 4 g 0 where 49 c 2 ξ δ γ φ 2 κ 2 50 g a r κ 2 δ 2 κ 2 κ can be obtained by solving eq 48 and substituting κ into eq 44 as follows 51 η 2 1 a r ε c δ 2 κ 2 2 2 ξ γ φ 2 κ 2 0 5 cos κ τ by substituting the value of eq 51 into eq 32 the value of the lift oscillator coefficient q can be obtained and then the displacement response of viv can be determined using eq 30 according to the recommended test parameters of the wake oscillator model of facchinetti et al 2004 we used γ 0 8 c l 0 0 3 ε 0 3 s t 0 2 a 12 c m 1 to calculate the vortex induced lift and obtain the viv response assuming that the ends of the riser are hinged the boundary conditions are as follows v 0 t v l t 0 52 d 2 v d z 2 z 0 d 2 v d z 2 z l 0 the vibration equation was discretized using hermite interpolation the matrix form of the vibration equation of riser is as follows 53 m v c v k v f where m c k and f are the mass matrix the damping matrix the stiffness matrix and the external force matrix respectively which are given as 54 m e m e e 0 l n t m n d z c e c e e 0 l n t c s n d z e 0 l n t 2 m i v n d z k e k e e 0 l n t m i v n d z e 0 l n t m i v 2 t n s 2 n d z e 0 l n t e i s n d z f e f e e 0 l n t f f s d z where n is the hermite interpolation function and l is length of finite element of the riser where l 10 m in this paper in the process of solving the vibration equation of riser in this paper there is a nonlinear term related to the large deformation of the riser at present the direct integral solution of the structural dynamics can be divided into an explicit integral method and an implicit integral method the central difference method is usually used in dynamic analyses however the central difference method is a conditional stability algorithm where the time step length must be less than a certain critical value otherwise the calculation results can easily be distorted for marine deep water risers and for problems with large response time scales an implicit algorithm with unconditional stability is usually used deep water risers are long flexible pipes that are prone to large deformations and non linear deformations under marine environmental loads the newmark β method is an implicit direct integration algorithm which is unconditionally stable when the appropriate integration constants are selected it can use large time steps in the calculation process so it is especially suitable for the transient response analysis of a riser system with a long time history therefore the newmark β method was used here to solve the viv response and the integration constants used are α 1 2 β 1 4 the whole solution process is shown in fig 6 2 3 program verification a program was developed based on the established numerical model of the multiphase internal flow and the vibration equation of the marine riser this program was validated by calculating the internal pressure and natural frequency with the parameters given by montoya hernandez et al 2014 further in order to validate the correctness of the program of viv model the viv forces at different times were calculated according to the wake oscillator model then pipe 59 element was used in the ansys software to establish the riser model finally the viv forces at different times are introduced in transient dynamic analysis to obtain the viv response of the riser in ansys the parameters of the multiphase internal flow are shown in table 1 and the parameters of the viv analysis are given in table 2 fig 7 a shows that the internal pressure predicted by the internal flow analysis model in this paper is in good agreement with that predicted in the literature the reason for the discrepancy is that the effect of hydrate phase transition on the pressure is taken into account in our internal flow model fig 7b also shows a good agreement between the program results and ansys software analysis the amplitude increases gradually with time and does not change when it reaches a certain value 3 results and discussion 3 1 analysis of the flow parameters of the multiphase internal flow the riser s internal flow was modelled as a multiphase and multicomponent mixing system in this part we study the effects of gas intake ratio gas volume fraction at the riser inlet on the multiphase flow parameters during the flow process from the underwater wellhead to floating platform as shown in table 3 because the density of natural gas is determined by its temperature and pressure the density is calculated as follows 55 ρ g 3486 6 p ρ g s z t where ρ g s is the relative density of natural gas where the composition of natural gas only includes methane in this paper ρ g s 0 5548 and z is the compression factor of natural gas which is dimensionless fig 8 a shows the internal temperature and phase equilibrium temperature under different gas intake ratios the intersection point between the internal temperature curve and the phase equilibrium curve is the critical point of the hydrate phase transition below this critical point the hydrate is in the formation region above the critical point the hydrate is in the decomposition region fig 8b displays the heat produced by friction between the internal flow and the wall the hydrate phase transition and the heat transfer between the internal flow and the external seawater when the gas intake ratio is 20 it can be seen that the internal temperature is mainly affected by the heat transfer from the external seawater while the hydrate phase transition and the friction between the internal flow and the wall have little influence on the internal temperature assuming that the inlet temperature of the internal flow is 10 c the internal temperature decreases when the external seawater temperature is lower than the internal temperature reaching the lowest value at 900 m below the water surface the inlet temperature then rises with the rapid increase of the sea water temperature near the water s surface reaching a maximum at the outlet it can be seen from fig 8a that the outlet temperature at gas intake ratios of 10 20 30 and 40 are 17 97 c 17 43 c 17 04 c and 16 67 c respectively that is to say when the inlet temperature is the same the higher the gas intake ratio the lower the outlet temperature this is because as the gas intake ratio increases the internal flow velocity increases see fig 8c resulting in a decrease in the heat transfer time at the same time an increase of the gas volume fraction decreases the specific heat capacity and thermal conductivity of the internal flow both of which reduce the heat transfer between the internal flow and the external sea water therefore at the same inlet temperature the temperature of a lower gas intake ratio is closer to the ambient temperature fig 8c f shows the changes of the velocity acceleration density and pressure respectively at different gas intake ratios as the fluid flows upward the expansion of the gas and the decomposition of the hydrate increase the gas volume fraction the mixed phase velocity and the acceleration while the density decreases the low density causes the gravity pressure drop to decrease while the high velocity caused by the high gas intake ratio increases the frictional pressure drop rate but the effect of the gravity pressure drop is much greater than the frictional pressure drop resulting in a net decrease in the total pressure drop when the riser outlet pressure remains unchanged the overall internal pressure decreases therefore the phase equilibrium curve shifts to the left and the hydrate formation region descends in depth at the same time it can be observed that the formation of the hydrates consumes gas and slows down the change of the flow parameters caused by gas expansion in the hydrate decomposition region gas generated by hydrate decomposition accelerates the changes of the multiphase flow parameters especially near the water s surface according to the above discussion the flow parameters such as the velocity acceleration density and pressure constantly change in the upward flow changes in the flow parameters will affect the stiffness matrix mass matrix and damping matrix in the discrete vibration differential equation of the riser in the next section the effect of the multiphase internal flow on the dynamic characteristics and viv responses will be further discussed based on the calculated results given in this section 3 2 effect of the gas intake ratio on the natural frequencies of the riser fig 9 a d are the first fifth tenth and fifteenth order natural frequencies of the riser for constant flow velocities v 0 m s and v 0 79 m s and gas intake ratios 10 20 30 and 40 when the internal flow is purely liquid and the velocity is constant v 0 m s and v 0 79 m s the first fifth tenth and fifteenth order natural frequencies decrease with an increase of the internal flow velocity however when the velocity increment is small the natural frequency of the riser decreases slightly which is consistent with the conclusions of montoya hernandez et al 2014 when the fluid in the riser is a multiphase flow with hydrate phase transition the natural frequencies of the riser at different gas intake ratios were obtained based on the calculated results of the internal flow parameters presented in section 3 1 the results show that the natural frequencies of risers in the first fifth tenth and fifteenth modes increase with an increase of the gas intake ratio the natural frequencies of different modes show similar regularity with an increase of air volume but the trend of increasing natural frequencies with an increase of the gas intake ratio is more obvious in the higher modes according to the results given in section 3 1 an increase of gas intake cause the density and pressure decrease the acceleration to increase as can be found in eq 54 the mass matrix and stiffness matrix show that the stiffness matrix increase with an decrease of internal pressure and an increase of acceleration whereas the mass matrix decrease with an decrease of density the natural frequencies are related to the mass and stiffness of the riser therefore the change of these parameters arising from an increasing gas intake ratio can cause the stiffness to increase and the mass to decrease which will eventually cause the natural frequencies to increase so when the fluid in the riser is a multiphase flow with hydrate phase transition the natural vibration frequency of the riser generally shows an increasing trend with an increase of the gas intake ratio 3 3 analysis of viv of a marine riser with a multiphase internal flow according to the current research on the effect of internal flow on the dynamic characteristics of marine risers the flow parameters along the riser remain unchanged in the same case given the fact that the multiphase flow parameters change constantly along the span to further study the effect of the multiphase internal flow on the spanwise viv response of a marine riser the following three cases are considered the parameters of the current are shown in table 4 and the other parameters are shown in table 3 3 3 1 effect of the gas intake ratio on the amplitude envelope fig 10 and fig 11 show the amplitude envelope and response spectra of viv subjected to a uniform flow and a linear shear flow respectively when the velocity of the uniform flow is 0 2 m s the frequency locking of the riser and current occurs in the fourth mode where the response frequency is approximately equal to the fourth natural frequency of the riser fig 11a as can be seen from fig 10a the amplitude envelope decreases with an increase of the gas intake ratio which is due to the natural vibration frequency concurrently increasing with the gas intake ratio as shown in section 3 2 the reduced velocity decreases with an increase of the natural frequency and when it is in the range of the upper branch the amplitude decreases with a decrease of the reduced velocity fig 5 it also can be seen from fig 10b and c that when subjected to a linear shear flow as the vortex discharge frequency changes according to the velocity of the current the viv shows a multi mode response fig 11b and c and the amplitude envelope changes significantly with an increasing gas intake ratio this can be explained by the changing gas intake ratio affecting the natural frequency of the riser which then affects the frequency locking mode between the riser and the current 3 3 2 effect of the gas intake ratio on the response spectrum characteristics since the shear flow more closely resembles an actual marine environment the multi mode viv subjected to a shear flow is more complex therefore in this section we further study the multi mode viv in case 2 and analyze the effect of the gas intake ratio on the response spectrum characteristics as can be seen from fig 12 a when the gas intake ratio is 10 the spanwise distribution of the power spectral density in the frequency domain shows five response frequencies corresponding to the fourth to eighth order natural frequencies the locking vibration in the upper region of the riser gradually transits from the eighth order to the seventh order with an increase of the gas intake ratio when the air intake ratio is 40 the response corresponding to the eighth order natural frequency basically disappears and only four frequencies corresponding to the fourth to the seventh orders can be observed along the span it can also be seen from fig 12 that with an increase of the gas intake ratio the peak value of power spectral density gradually shifts from the middle to the lower part of the riser 3 3 3 effect of the gas intake ratio on the response time frequency characteristics the frequency spectrum analysis shows that when the riser is subjected to a linear shear flow the viv for different gas intake ratios show a multi mode response but it is impossible to determine whether the dominant frequency of the response changes with time therefore time frequency analyses were carried out using wavelet transforms the instantaneous frequency and time function of the response were monitored using the spanwise position of the riser the scale shows the square magnitude of a continuous wavelet transforms as a function of frequency and time fig 13 a c and 13e show displacement time history curves within 200 s at the middle of riser z 600 for gas intake ratios of 0 20 and 40 respectively fig 13b d and 13f are the corresponding displacement time frequency nephograms from them it can be seen that the response at the middle of the riser is a multi frequency vibration corresponding to the fourth to eighth order natural frequencies of the riser the frequencies do not change after the response becomes stable but with an increase of the gas intake ratio the structural response gradually changes from high order mode dominant to low order mode dominant this is because when the natural frequency of the riser increases with the gas intake ratio the velocity along the entire span decreases and the frequency locking more likely occurs in low order modes 4 conclusions in this paper a numerical model of a multiphase internal flow with hydrate phase transition was established the multiphase internal flow included oil gas water and hydrate and was regarded as quasi single phase mixture the flow parameters were first solved with the finite difference method then by considering the effects of the multiphase internal flow a viv equation of marine riser was established the newmark β method was used to solve the viv response in the time domain the viv characteristics of the riser were analyzed including the effect of the gas intake ratio on the natural frequencies of the riser and the viv response the following conclusions can be drawn 1 from the riser s inlet to its outlet the pressure and density of the internal flow decrease while the velocity and acceleration increase in the hydrate formation region because the formation of hydrates consumes gas the flow parameters changed slowly in the hydrate decomposition region the decomposition of the hydrates increases the gas volume fraction and accelerates the changing trend of the flow parameters at the same time the pressure and density of the internal flow decrease while the velocity and acceleration increase with an increase of gas intake 2 the natural frequency of the riser decreases with an increase of the internal flow velocity but an increase of gas intake also changes other flow parameters including the acceleration pressure and density which result in an increase of the natural frequency of the riser with the increase of gas intake where the changing trend is obvious in higher modes 3 when the riser is subjected to a linear shear flow the viv show a multi mode response which is different to the single frequency response when the riser is subjected to a uniform flow with an increase of the gas intake ratio the structural response changes from high order mode dominant to low order mode dominant this can be explained by the natural frequency of riser increasing with the increase of the gas intake ratio simultaneously the spanwise reduced velocity decreases which makes frequency locking more easily occur in the low order mode credit authorship contribution statement weixing liang writing review editing formal analysis min lou writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by the national natural science foundation of china grant 51579245 and the national key research and development program of china grant 2016yfc0303800 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 107758 
21467,this work deals with the optimization of the internal layout oil tankers under uncertainties aiming at the robustness of ship safety and the improvement of economical functionality in the domain of environmental pollution prevention the design variables are the positions of watertight members in the internal layout and the original merit functions are the maximization of cargo capacity and minimization of the longitudinal bending moment in sagging and hogging conditions the constraints are the regulatory limits and the essential requirement of a proper design the uncertainties of the prediction of bending moment and accidental consequences are incorporated into the objectives and constraints of the defined problem by a robust based approach a multi objective genetic algorithm is applied to the converted problem under uncertainty to approach the pareto solutions finally the selection of final design among the pareto frontier is defined as a post optimization process by using a method of multi criteria decision making the discussion of the final design is provided by a comparative study keywords internal layout of tankers pareto solutions multi objective optimization uncertainty modelling robust based optimization multi criteria decision making 1 introduction the ship design can be formulated as an optimization problem to provide the ship with the desired functionalities so the design problem requires to identify the design variables objectives constraints strategies for achieving the objectives and a model that quantifies the relationship between the design variables and merit functions in the domain of constraints nowacki 2010 the majority of ship optimization problems have assumed that the design variables objectives and constraints are deterministic parameters and these assumptions lead to the definition of a deterministic optimization problem however those parameters and functions include uncertainty in the real life which need to be contributed in the optimization problem priftis et al 2018 introducing the uncertainties to the definition of optimization problem requires methods for analysing the optimization problem under uncertainty the defined optimization problem under uncertainty is mostly focused to incorporate the uncertain parameters in the design of ship hull properties for the conceptual design of a bulk carrier ship hannapel and vlahopoulos 2010 introduced uncertainties to the prediction model of the main dimensions of the vessel the prediction model was a set of empirical equations that are generated by regression analysis the approach of robust based was applied to define the objectives and a reliability based approach was used to convert the constraints from the deterministic base a similar optimization problem was defined for the conceptual design of a bulk carrier by diez and peri 2010a the robust based approach was used for optimizing the main dimensions of the ship under the uncertainty of the prediction model in a different approach for solving the same problem diez and peri 2010b applied stochastic programming to convert the deterministic optimization to optimization under uncertainty targeting the design of ship body lines hou et al 2018 defined the optimization problem to minimize eedi by limiting the ship volume and resistance to an acceptable level the uncertainties were introduced into design variables of waterline length and breadth and hull control factors the reliability based approach was applied to convert the deterministic problem to optimization under uncertainty to improve the lifecycle performance safety efficiency and economic functions nikolopoulos and boulougouris 2018 defined the optimization problem by considering uncertainty due to various sources the design variables included the parameters that control the main dimensions of the ship and a few parameters that control the internal layout dimensions of a container ship the source of uncertainties were the regression models that provided for prediction the environmental conditions and economic functions from the collected big data regarding the design of the internal layout of ships the size and location of the internal spaces are established in the early stage of ship design for the oil tankers the internal hull layout design can be defined as an optimization problem to improve ship performance during the life cycle guan et al 2018 however no research is identified with a specific focus on the determination of internal dimensions of oil tankers with the approach of optimization under uncertainty the internal layout of oil tankers can be optimized targeting the improvement of the economic returns and the safety and prevention of environmental pollution the prominent indications of these objectives are identified as the cargo capacity induced bending moment to the ship hull and oil outflow performance for a fixed hull ship jafaryeganeh et al 2019 in this regard papanikolaou et al 2010 applied a deterministic optimization procedure for the arrangement of the cargo area of an aframax class tanker to minimize the accidental oil outflow and improvement of economic competitiveness however the uncertainty of the oil outflow due to the accidents was not discussed the oil outflow is a consequence of damage of oil tanks a prediction model of damages is recommended by imo 2003 using the probabilistic distributions the applied probability density functions pdfs are based on the statistics of damage accidents which include 52 collisions and 63 groundings this type of statistics has been used in specific studies on the consequences of collision and grounding pedersen 2010 prestileo et al 2013 the statistics can be updated by the availability of new data and the uncertainty of the predicted value of oil outflow needs to be treated during the optimization process the minimization of still water bending moment swbm also was used as a safety objective to optimize the internal dimensions of oil tankers in chen et al 2010 yu and lin 2013 yu et al 2015 and su et al 2019 however none of them considered the uncertainty of the prediction of induced loads during the optimization procedure in this regard guedes soares and moan 1988 presented a statistical model for prediction of the swbm variability for the different type of the ships they collected recorded data from the on board load distribution equipment normalized by the minimum requirement of swbm that is recommended by the classification societies rules the variability of swbm was modelled by a normal distribution where the expected value and standard deviation depends on the length of the ship and the average non dimensional deadweight this model reflects the real operational conditions of ships and is better than using the cases in the loading manual as this is a design document and often the operations are different for double hull tankers hørte et al 2007 proposed a stochastic model to predict the variability of the sagging swbm in full load condition the sagging bending moment was statistically analysed from loading manual data which was the only one available for the sample tankers the model presented the normal distribution for sagging bending moment where the expected value and standard deviation of the distribution are 70 and 20 of maximum sagging bending moment in the loading manual respectively later teixeira et al 2013 applied a similar approach to predict a model of swbm for the two main load condition of the full ballast and full load in the oil tankers similar to sagging swbm the model presents the normal distribution for hogging swbm with the expected value and standard deviation of 70 and 20 of maximum hogging bending moment in the loading manual respectively once the design variables objective functions and constraints are defined for an optimization problem the uncertainties need to be incorporated in the problem in general the optimization problems under uncertainties include five main steps identify the uncertainty types quantify the uncertainties uncertainty propagation define the optimization problem and analyse the results messac 2015 a variety of methods have been implemented to perform the tasks in each step fig 1 the steps one to three are dedicated to the identification and modelling the source of uncertainties and method of introducing the effect of uncertainties on the interest functions more detail of the applied methods in these topics can be found in canavero 2019 step four deals with the development of an optimization problem under uncertainties based on the defined problem in step five the developed problems under uncertainty can be solved using the common optimization algorithm which is applied to deterministic problems to explore the trade off between the solutions deb et al 2015 the widely used methods for handling the optimization under uncertainty are robust based design optimization rdo or rbo reliability based design optimization rbdo robust and reliability based design optimization r2bdo or rbrdo and stochastic programming birge and louveaux 2011 in the present work the focus is on the robust based approach however the concept of the reliability based approach needs to be elaborated due to a common method for constraint translation with the robust based a robust based design intends to approach the design with lower sensitivity to the variables fig 2 shows the difference between deterministic and robust optimum for a sample of a single variable single objective optimization problem with a constraint yao et al 2011 where x 1 is the solution for the minimum value of the objective function and x 2 is the solution of the same problem in the framework of robust design the variation of the objective function at the deterministic solution relative to the change of the design variable is larger than the variation of the robust solution a reliability based design intends to approach the design with higher confidence in the system operation without failure i e the reliable design intends to decrease the failure probability in a determined period fig 3 shows the difference between deterministic and reliable optimum for a sample of a two variable single objective optimization problem with two constraints yao et al 2011 where x 1 is the vector solution for the minimum value of the objective function and x 2 is the vector solution of the same problem in the framework of reliability based design the reliability of the solution is provided by considering a marginal distance from the boundaries between the feasible and infeasible solutions thus the reliability optimization aims not only to the improvement of objective functions but also aims to increase the assurance level of satisfying the constraints it should be noted that methods of converting the constraints from the determinist framework to robust based are similar to the methods that are applied to the reliability based definition thus the form of robust based problems that include robust constraints handling become similar to the robust and reliability based design optimization du and chen 2000 for inequality constraints the approaches are based on the definition of a margin relative to the original constraint and then the solutions can be limited to a domain of feasible solutions that has a distance from the infeasible domain the concept is depicted in fig 4 by a shift of constraints toward the original feasible domain this work deals with the improvement of the design of the internal layout of oil tankers targeting safety and economic feedback considering the incorporated uncertainty thus the work is presented in the five steps 1 definition of the design of the internal hull layout of the oil tankers as a deterministic framework of the optimization problem 2 presentation of the applied method for uncertainties modelling in the objective functions and constraints 3 introducing the robust based method for incorporating uncertainties into the optimization problem 4 applying the methodology for a case study and approaching to the pareto solutions for the designs 5 selection of final design among the obtained non dominated solutions by a multi attribute decision making method 2 deterministic optimization problem the following formulation presents a general form of the multi objective multi constraint deterministic optimization problem where all the variables including the design parameters objective functions and constraints are deterministic 1 find x to minimize f x subject to g x 0 x l x x u where x is the vector of design variables with the vectors of lower and higher bounds of x l and x u respectively f is the vector of objective functions and g is the vector of the general form of constraints including the equality and non equality limitations the subdivision design of the oil tanker is adopted with the general form of deterministic optimization problems by identifications of the design variables constraints and objective functions 2 1 design parameters in this work the ship hull is assumed to be fixed so the overall dimensions of the available space of the internal layout of the ship do not change during the variations in the optimization process however the dedicated space for the tanks and compartment can be defined by alternative designs similarly the topology of the arranged tanks and compartments are assumed to be fixed because the typical arrangement of the layout is similar for each type of ship on the other hand the number of watertight bulkheads wtb is depended on the specified limits in the damage stability regulation for the tankers iacs 2017 i e there is no direct recommendation for the number of wtb of oil tankers once the damage stability calculation resulted in a minimum number of wtb for a reference ship with a fixed hull shape the optimum number is achieved the variation in the number of wtb can only be possible by increasing the number therefore the main challenge of the problem is defined by the determination of the dimensions of the internal compartments and tanks to approach the optimum of the interest functions the design variables of the problem are defined below the positions of the transverse bulkheads alongside the ship l i i 1 n t 1 the longitudinal positions of inclination of wing tank l s1 and l s2 the position of the collision bulkhead l cbd the widths of the wing tanks for each longitudinal subdivision w i i 1 n t the heights of double bottom tanks for each longitudinal subdivision h i i 1 n t where n t is the number of wtb l i is a discrete real parameter due to the following the distances of frame spacing it should be noted that these parameters define a generic framework for producing different configurations such as parallel or inclined walls of the wing tank fig 5 shows the adapted set of variables for a case of an oil tanker where unique values are assumed for the minimum widths of wing tanks and the heights of double bottom 2 2 constraints the majority of constraints are non equality type due to regulations however they can be translated to equality constraints for instance intact stability criteria include non equality limitations for transverse and longitudinal stabilities eventually all those constraints can be translated to an equality constraint of intact stability regulations with two options of pass equal to 1 or not pass not equal to 1 a combination of the two approaches was applied to constraints to simplify the categorization of the limits especially the approach is helpful during the identification of the priorities for constraint conversion to robust based approach the constraint 1 to 6 define limits for the design variables and constraint 7 to 11 are implemented on the evaluation functions constraint 1 limitation for the collision bulkhead according to solas imo 2012 as below 2 min 0 05l 10 0 m l cbd max 0 05l 3 0 08l where l is the length of the ship constraint 2 the minimum requirement for protective spaces in wall side according to marpol imo 2006 regulation 19 3 w min w i w min min 0 5 dwt 2000 2 0 m where dwt is the deadweight of the ship constraint 3 the minimum requirement for protective spaces in bottom side according to marpol imo 2006 regulation 19 4 h min h i h min min b 15 2 0 m where b is the breadth of the ship constraint 4 the limit between two consecutive bulkheads 5 l db l i l afl i 1 6 where l afl is the minimum allowable length according to the floodable length calculation and l db is the maximum extent of damage according to marpol regulation 28 this constraint leads to removing some infeasible solutions at the beginning of the evaluations thus there is no need to continue with the damage stability calculations for those solutions constraint 5 the minimum requirement of capacity for the slop and fuel tanks 6 l slop l fuel l 7 where the l slop is the slop tank length that is calculated by the minimum required volume l fuel is the length of the fuel tank that is assumed to be constant l 7 is the design variable that controls the length of the 6th oil tank in addition to the slop and fuel tank constraint 6 the minimum required volume for engine room and propulsion room 7 v eng v prop v req where v eng and v prop are the volumes of the engine room and the propulsion room respectively v req is the minimum required volume for engine and propulsion room constraint 7 an equality constraint to pass all the requirement for segregated ballast tank according to marpol imo 2006 regulation 18 as listed below d m 2 0 0 02l 8 t s 0 015l d a d i where d m and d a are the draught of amidships and aft respectively d i is the minimum draught for full immersion of the propeller s t s is trim by stern constraint 8 the maximum allowable draft as below 9 d m d max where d max is the maximum allowable draft at amidships according to the international convention on load lines imo 1966 constraint 9 an equality constraint to pass all the requirement for intact stability criteria according to marpol imo 2006 regulation 27 as listed below 10 g m 0 0 15 m a g z curve 0 30 0 055 m r a d a g z curve 0 40 0 09 m r a d a g z curve 30 40 0 03 m r a d g z 0 02 m θ 30 where gm 0 is the initial metacentric height gz is the righting lever θ is the angle of heel θ m a x g z is the maximum of the righting arm a g z curve presents the area under the righting lever curve gz curve relative to the heeling angle so a g z curve 0 30 a g z curve 0 40 and a g z curve 30 40 are the areas up to 30 up to 40 and between 30 and 40 heeling angles respectively constraint 10 an equality constraint to pass all the requirement for damage stability criteria according to marpol imo 2006 regulation 28 as listed below 11 wl f m θ f 25 or θ f no deck immersion 30 θ r 20 g z r 0 1 m a g z curve θ f θ r 0 0175 m r a d where wl f is the final waterline after each scenario of damage the m is the specified marginal distance due to definition of the ship margin line θ f is the angle of the heel due to flooding θ r is the range of positive stability after flooding due to each damage scenario gz r is the maximum residual righting lever and a g z curve θ f θ r is the area under the righting lever curve gz curve between θ f and θ r heeling angles constraint 11 the maximum value for the accidental oil outflow according to marpol imo 2006 regulation 23 as below 12 o m k where o m is the mean oil outflow parameter and k is 0 021 when the cargo volume is less than 100 000 m3 at 98 tank filling 2 3 objective functions the main aims of the optimization problem are defined to increase safety and economic functions thus the following objectives are defined for the optimization problem 1 maximization of the cargo capacity the major financial return of oil tankers depends on the available capacity of loading cargo oil due to fixed dimensions of hull increasing the cargo capacity may not be in the same direction of improving safety and environmental protection for instance a ship with a larger capacity of cargo oil is exposed to a higher risk of oil outflow in the event of accidents so improving the economic functionality together with safety and pollution prevention is a challenging task 2 minimization of the maximum hogging still water bending moment 3 minimization of the maximum sagging still water bending moment the still water loads are induced on the ship hull due to the difference between the weight and buoyancy distributions the vertical still water loads are the most investigated component of the induced loads because of the high values of the imposed loads relative to the other variables thus these loads have a significant effect for the design of the ship s structure and are consequently more effective on the safety of the ship hull the vertical bending moment is a significant indication of the imposed load to the ship hull among the components of induced loads due to the still water the maximum still water bending moment swbm is induced to this ship hull in the hogging condition however the sagging has a more important effect on the safety and environment protection objectives because the sagging extreme values are in the full load condition while the extreme values of hogging are usually happening in the full ballast conditions thus the minimization of maximum sagging and hogging loading was defined as two separate objectives fig 6 shows the dependency of the three objectives 3 uncertainty modelling the uncertainty was only modelled for the objective functions of swbm the other objective function cargo capacity is assumed to be a deterministic value because the tankers normally operate in two load conditions of full load and ballast in the full load conditions usually the maximum allowable cargo capacity is used and in the full ballast condition no cargo would be carried by the oil tankers for the constraints the uncertainty was only modelled for the accidental oil outflow because pollution prevention is one of the major concerns of oil tankers in the event of accidents the tankers are usually in the safe side of stability criteria thus increasing the reliability margin relative to constraints of intact and damage stability criteria are more interesting in the other type of the ships such as containers ship 3 1 uncertainty modelling of swbm as the objective function the swbm is a function of two variables of weight and buoyancy distributions however the weight distribution except traverse bulkheads can be considered as an independent variable especially in the present study because the hull was assumed to be fixed during the design process the buoyancy is dependent on the weight distribution of the designs the weight includes the lightship and deadweight the lightship weight is assumed to be constant in an operational ship during her lifetime the deadweight is affected by the variation of the cargo during the loading and unloading in the ports exchange of water ballast for environmental protection and the changes of the consumables during the voyage the impact of consumables changes is more important for the voyages with a long duration therefore these variations introduced an uncertainty on the predicted values and distributions of swbm in the ship operation guedes soares 1990 the uncertainty of these values is modelled by normal distributions the expected values and standard deviations of the distributions were evaluated by the following equations teixeira et al 2013 13 μ s a g 0 7 m a x s w b m i s a g i 1 n σ s a g 0 2 m a x s w b m i s a g i 1 n μ h o g 0 7 m a x s w b m i h o g i 1 n σ h o g 0 2 m a x s w b m i h o g i 1 n where μ s a g and μ h o g are the expected values of the sagging and hogging σ s a g and σ h o g are the standard deviation of sagging and hogging respectively n is the number of load cases in the loading manual 3 2 uncertainty modelling of oil outflow as constraint the simplified method of prediction of damage probabilities of oil tankers is applied to calculate the expected value of oil outflow similarly the standard deviation of the predicted value was evaluated to be used for uncertainty prediction imo 2003 assign the probabilities of damage scenarios using the location and extent of penetration for side or bottom damage cases the damage shape is assumed to be a rectangular parallelepiped to simulate the location and extent of penetration the dimensions of the damage box are determined by the longitudinal transversal and height of the damaged compartments for each damage case thus the probability of happening a damage case is equal to the cumulative probability of the breaching from the side and bottom for the assumed dimension of the damage box as below 14 g l s x l y l z l 0 l 0 b 0 h f s 2 f s 3 f s 4 d z d y d x p b s 0 x l 0 z l g l s d z d x where f s2 is a function for the longitudinal extent of penetration f s3 is a function for the transverse penetration f s4 is a function for the vertical extent and p bs is the cumulative probability of breaching from the side at the location of x l y l z l with the dimensions of l b and h 15 g l b x l y l z l 0 l 0 h 0 b f b 2 f b 3 f b 4 d y d z d x p b b 0 x l 0 y l g l b d y d x where f b2 is a function for the longitudinal extent f b3 is a function for the vertical penetration f b4 is a function for the transverse extent and p bb is the cumulative probability of breaching from the bottom at the location of x l y l z l with the dimensions of l b and h later imo simplified the implementation of probability distributions functions by adapting the location and dimensions of the damage boxes to a set of tables and simple equations this application is more suitable for evaluating the probabilities of the predefined damage scenarios because the probability can be specified by coordinates of the planes that surround the damaged compartments or tanks in a damage case thus the simplified approach is used in this work for calculating the probability of breaching of compartments from the side and bottom more detail of the applied approach can be found in imo 2004 hereafter the formulation of imo 2004 was adapted with the common symbols of uncertainty modelling such as μ for expected value and σ for standard deviations when probability of breaching of compartments from the side p b s i and bottom p b b i is calculated the expected value of oil outflow due to side and bottom damage can be calculated as below 16 μ o m s i 1 n o p b s i o s i μ o m b 0 i 1 n o p b b i o b 0 i μ o m b 2 5 i 1 n o p b b i o b 2 5 i where o s i o b 0 i and o b 2 5 i are oil outflow for ith oil tank from the side damage and bottom damage for 0 m and 2 5 m tide condition respectively these values are calculated based on pressure balance principles n o is the number of oil tanks μ o m s μ o m b 0 and μ o m b 2 5 are expected values of the oil outflow of the tanks due to the side damage and bottom damage for 0 m and 2 5 m tide condition respectively these values are aggregated and normalized by the following equation according to the regulation 23 of marpol imo 2006 17 μ o 0 6 c d b 0 7 μ o m b 0 0 3 μ o m b 2 5 0 4 c 3 μ o m s c where μ o is non dimensional expected value of oil outflow for the oil tanker c is the total volume of cargo oil at 98 tank filling in m 3 c 3 is 1 for the arrangement of oil tanks that include longitudinal bulkheads inside the cargo tanks and c db is 0 6 for cargo tanks that bounded from below by non oil compartments although the regulations only introduced the expected value for the prediction of mean oil outflow by a non dimension index this work developed the application of the regulations for calculating the standard deviation of the predicted oil outflow thus following the similar approach for expected values of oil outflow the standard deviation of oil outflow was calculated in below 18 σ o m s i 1 n o p b s i o s i μ o m s 2 σ o m b 0 i 1 n o p b b i o b 0 i μ o m b 0 2 σ o m b 2 5 i 1 n o p b b i o b 2 5 i μ o m b 2 5 2 where σ o m s σ o m b 0 and σ o m b 2 5 are standard deviations of the oil outflow of the tanks from the side damage and bottom damage for 0 m and 2 5 m tide condition respectively these values can be aggregated and normalized by the similar method for the expected values as below 19 σ o 0 6 c d b i 0 7 σ o m b 0 0 3 σ o m b 2 5 0 4 c 3 σ o m s c where σ o is the non dimensional standard deviation of oil outflow for the oil tanker 4 robust based optimization problem the robust based approach is applied to introduce uncertainty into the deterministic problem however the reliability based is also described because of the similarity of the methods of constraint translation in the robust based and reliability based approaches the minimization of the expected value μf and standard deviation σ f of the objective functions result in the robust optimum solution the formulation 20 find to minimize subject to x f μ f x σ f x g x 0 x l x x u o r μ f x a n d σ f x presents the two alternative general forms of robust based optimization for a multi objective and multi constraints problem 4 1 formulation of objective functions the objective functions can be defined by two common approaches the vector of expected values μ f and standard deviations σ f of original functions are replaced to the original objectives as the separate functions thus even a single objective problem become a multi objective problem which deals with the trade off between the expected value and standard deviation of the original function diez and peri 2010b a vector function f is replaced to the original objective function s which is formulated by linear aggregation of expected value and standard deviation of the original objective functions by a proper coefficient β as below 21 f μ f x σ f x μ f β σ f the 3 sigma β 3 and 6 sigma β 6 are the most applied methods in the mentioned formulation for the robust optimization pyzdek 2003 the latter approach has an advantage relative to the former one because the aggregation of expected value and standard deviation of the original objective functions leads to a decrease in the number of objective functions thus the process of decision making for the design selection would be simplified thus the approach with 3 sigma method was considered for the robust objectives of sagging f 1 and hogging f 2 as below 22 f 1 μ s a g 3 σ s a g f 2 μ h o g 3 σ h o g the third objective function f 3 is considered by the maximization of the cargo capacity similar to the deterministic optimization problem 23 f 3 m a x c a r g o c a p a c i t y full load condition 4 2 formulation of the constraints the constraint of the robust based optimization can be defined in the same way as the constraint of the deterministic optimization though a comprehensive robust design can be achieved by conversion of all the aspects of the deterministic framework to the robust based because the robust based design aims to provide a design that is insensitive to the variation of the system these variations not only include the changes of the objective functions but also include the changes of the constraints parkinson et al 1993 the approaches of translating the constraints from deterministic based to rdo or rbdo are depended on the type of constraints i e equality or inequality forms rangavajhala et al 2009 the constraints 1 to 10 remain the same as the deterministic optimization thus the method for converting the equality constraints are not applicable moreover those constraints are originally non equality constraints thus the following methods can be applied for converting them in the event of introducing the uncertainty in the problem for the mentioned equality constraints considering that the g x are the inequality constraints of the deterministic problem 24 g x 0 then the confidence level of the constraint s satisfaction can be improved by definition of tolerance in the equations as below 25 g x δ 0 where the δ can be obtained by four widely used methods of worst case analysis parkinson et al 1993 corner space evaluation sundaresan et al 1993 variation patterns formulation yu and ishii 1998 moment matching method du and chen 2000 fig 7 presents a schematic view of the constraint handling by two methods of corner space and variation pattern tolerance is defined as the distance between the solutions and the constraints the constraint 11 is translated from deterministic optimization to the robust base by a similar method of moment matching method generally in the moment matching method it is assumed that the probabilistic model of constraints follows a normal distribution thus the probability of satisfaction of the constraints is equal to the cumulative normal distribution function φ as below 26 p g x 0 φ μ g σ g μ g σ g k where k φ 1 p g x 0 and therefore the k 0 and finally the constraint is translated as below 27 μ g k σ g 0 the expected value and standard deviation of the constraint can be calculated by the first order second moment method in this work the expected value and standard deviation of oil outflow are obtained directly by measuring the oil outflow due to probability distributions functions of the damages then the constraint 11 was replaced by the following equation 28 constraint 11 μ o 3 σ o k where 3 sigma defines a tolerance between the solutions and the original constraints 5 optimization procedure the optimization procedure is shown in fig 8 which includes updating the model according to the design parameters applying the predefined loading conditions and damage scenarios to the model performing the intact and damage stability analysis updating the uncertainty model evaluating the objective and constraints checking the criteria running the optimization algorithm repeating the above stages until reaching the stopping criteria a parametric model of the internal layout is developed to generate different configurations based on the set of design variables the model can also check the constraints and automatic evaluation of the objectives more details of the parametric model can be found in jafaryeganeh et al 2016 and jafaryeganeh et al 2018 the combination of caeses friendship systems 2019 and maxsurf bentley systems 2018 are used to build the framework a set of loading conditions are defined by the filling percentage of the oil and ballast tanks where the definitions are based on the common operational conditions by applying those loading conditions the stability solver calculates the equilibrium condition for each load case the maximum cargo capacity is calculated by the deadweight of the full load case max swbms of hogging and sagging are obtained from the maximum value of the whole set of load cases consequently the uncertainty model is updated and the robust based objectives are calculated additionally the probability of the side and bottom damage breaching is predicted according to the internal layout of the design so the robust based constraint for the oil outflow is calculated on the other hand a set of damaged scenarios are defined by considering the critical cases the combination of each damage scenario and loading condition is evaluated for each design to assess the damage stability criteria the evaluated functions are introduced to an optimization algorithm the multi objective genetic algorithm moga is used for approaching the optimum solutions using the dakota software adams et al 2017 the moga is a proper gradient free approach for the multi objective and multi constraint problem of internal layout dimensions because the objectives and constraint functions cannot be defined in the explicit forms the moga is also adapted for the discrete real variables to be compatible with the frame spacing of the ship structure the stopping criterion is defined by reaching the maximum number of generations the optimization process is continued until reaching the specified stopping criteria the maximum number of generations is specified by trials and repeating the process until no significant improvement is achieved in the objective functions 6 reference design a shuttle tanker is selected as a case study and its main particulars are listed in table 1 in the reference design the main subdivision consists of eight transverse bulkheads and a central longitudinal bulkhead fig 9 shows the initial general arrangement of the taker in the reference design the engine room is located forward 7 results and discussion moga can be started by a random initial population or a set of predetermined solutions however an initial population consisting of feasible solutions is introduced to the multi objective genetic algorithm to speed up the convergence process to the pareto frontier the initial population includes 264 solutions that pass the criteria these individuals are obtained based on introducing a random initial population in the previous trials jafaryeganeh et al 2019 a total of 3815 individuals are produced including feasible and non feasible designs the evaluation functions are calculated completely for 1639 individuals that pass the initial criteria checking a total of 20 populations are generated which results in 616 feasible solutions from these 84 number of feasible solutions are recognized as the non dominated solutions the process was run on pc with intel r core tm i7 8800k cpu 3 2 ghz and 32 00 gb memory time taken for running the process was approximately 68 h 3 days approximately 7 1 feasible solutions and pareto frontier for the convenience of interpretation of the results the objectives of f 1 and f 2 were presented with the relevant values of the maximum hogging and sagging swbm for each design fig 10 presents space scatter plot of feasible solutions and pareto front members two dimensional scatter plots are more comprehensible visually because the paired comparison of the objectives can conveniently measure the performance of one objective against the other one miettinen 2014 fig 11 presents the two dimensional scatter diagram of maximum sagging swbm against the cargo capacity the evolution direction of the obtained solutions can be recognized toward the pareto solutions where included the higher value of cargo capacity and smaller values of maximum sagging swbm the reference design is approximately in the middle range of the objective s values for the obtained solutions globally plenty of solutions had better values of the mentioned objectives relative to the reference design even locally the reference design can be improved from the aspect of the cargo capacity and maximum sagging swbm fig 12 shows the scatter diagram of maximum hogging swbm against the cargo capacity in general the pareto solutions with higher cargo capacity result in higher value of induced max swbm in hogging conditions plenty of feasible solutions have better values of the maximum hogging swbm than the reference design however a relatively smaller number of solutions have better values of cargo capacity fig 13 shows the scatter diagram of maximum hogging and sagging swbm a few non dominated solutions were observed for these two objectives however the pareto solutions have more diversity considering the defined three objectives the reference design can be improved considerably in the aspect of the induced max swbm fig 14 shows the robust constraint of the oil outflow against the cargo capacity for feasible solutions the constraint values are at an acceptable level relative to the allowable oil outflow parameter for the designs the marginal distance of each design relative to the allowable value is depended on the uncertainty term the distance increased for those solutions that have a higher standard deviation of oil outflow fig 15 shows the scatter diagram of the expected value of oil outflow against its standard deviation for all the obtained solutions that pass the robust criteria a considerable distance is observed between the expected values of the oil outflow of the solutions relative to the allowable value 21 10 3 even those solutions that had the highest value of expected oil outflow are at an acceptable level of reliability 7 2 decision making for final design selection the final optimal solution can be selected by a trade off between conflicting objective functions thus the selection of final designs can be defined as a multi attribute decision making madm problem boulougouris and papanikolaou 2008 because the madm aims to rank the alternatives to find the best satisfaction of the given criteria which are not necessarily in the same agreeable direction so the pareto solutions can be judged by the madm methods and the superior design can be identified among the available alternatives more discussion about the effective modules of madm methods for design selection from a pareto set can be found in jafaryeganeh et al 2020a and jafaryeganeh et al 2020 here the well known method of technique for order preferences by similarity to an ideal solution topsis is applied to compare the selected alternative designs from the obtained pareto set the concept of the topsis method is based on choosing a compromise solution by measuring the distance relative to the best and worst ideal solution so the best solution is as close as possible to the positive ideal solution and at the same time is as far as possible from the negative ideal solution an euclidean norm measures the distance between each solution with the positive and negative ideal ones hwang and yoon 1973 the degree of importance of objectives is specified by assigning a weight to each objective function table 2 presents two alternative scenarios the equal importance of objectives was defined in scenario 1 while the objective of cargo capacity had the highest degree of importance in scenario 2 the obtained solutions were ranked by the topsis method the results of the top ten selected designs for scenarios 1 and scenario 2 are shown in fig 16 fig 17 shows the cargo capacity for alternatives of scenario 1 and scenario 2 the cargo capacity is a benefit criterion thus the top selected designs due to scenario 2 have a higher average value of cargo capacity relative to the selected designs due to scenario 1 max swbms are cost criteria so the desired values are the lower ones the top selected designs due to scenario 1 have a lower average value of max swbm relative to the selected designs due to scenario 2 as it is shown in fig 18 and fig 19 because the alternative scenario 1 defines more degree of importance for hogging and sagging bending moment relative to the alternative scenario 2 the alternative scenario 1 results in the selection of a design that has better performance in aspect of safety while the alternative scenario 2 results in the selection of a design that has better performance with respect to economic functionality the properties of the final selections are compared in table 3 also the schematic layouts of the alternative designs are compared with the reference design in fig 20 both selected designs have a high degree of confidence in the prevention of environmental pollution because they have a large distance to the upper limit of the oil outflow the constraint values are compared with the allowable value in table 4 8 conclusions a multi objective optimization problem is developed for the internal layout of the oil tankers the procedure is implemented to introduce the uncertainty of the oil outflow based on the probability distribution of the regulations in this regard the formulation of the obligatory regulatory framework is developed to predict the standard deviation of the evaluated mean oil outflow for the oil tankers also the uncertainty of the imposed loads to the ship hull is incorporated then the robust based method is applied to reformulate the optimization problem the multi objective genetic algorithm is used to approach the optimum designs finally a method of madm is used to rank the obtained pareto solutions the interest functions are improved for the obtained solutions based on a robust based method besides the solutions are limited to the designs that are in the reliable region of criteria limits the reference design can have a considerable improvement in the induced loads to the ship structure even if the cargo capacity remains unchanged the obtained solutions provide a wide range of diversities for the designer to have free hand about design selections the approach of optimization under uncertainty results in a more realistic definition of the design optimization problem because the presented approach not only includes the uncertainty of imposed load to the ship hull during the lifecycle of the ship but also includes the uncertainty of the probable damage accidents in the early stage of the design although the approach is built based on the probability distribution functions of the enforced regulation of pollution preventions the introduced process can be used for other damage consequences in future developments thus the survivability indications also can be used for risk based design with the introduced approaches of optimization under uncertainty credit authorship contribution statement h jafaryeganeh methodology formal analysis visualization writing original draft m ventura writing review editing supervision c guedes soares writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was performed within the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uidb uidp 00134 2020 
21467,this work deals with the optimization of the internal layout oil tankers under uncertainties aiming at the robustness of ship safety and the improvement of economical functionality in the domain of environmental pollution prevention the design variables are the positions of watertight members in the internal layout and the original merit functions are the maximization of cargo capacity and minimization of the longitudinal bending moment in sagging and hogging conditions the constraints are the regulatory limits and the essential requirement of a proper design the uncertainties of the prediction of bending moment and accidental consequences are incorporated into the objectives and constraints of the defined problem by a robust based approach a multi objective genetic algorithm is applied to the converted problem under uncertainty to approach the pareto solutions finally the selection of final design among the pareto frontier is defined as a post optimization process by using a method of multi criteria decision making the discussion of the final design is provided by a comparative study keywords internal layout of tankers pareto solutions multi objective optimization uncertainty modelling robust based optimization multi criteria decision making 1 introduction the ship design can be formulated as an optimization problem to provide the ship with the desired functionalities so the design problem requires to identify the design variables objectives constraints strategies for achieving the objectives and a model that quantifies the relationship between the design variables and merit functions in the domain of constraints nowacki 2010 the majority of ship optimization problems have assumed that the design variables objectives and constraints are deterministic parameters and these assumptions lead to the definition of a deterministic optimization problem however those parameters and functions include uncertainty in the real life which need to be contributed in the optimization problem priftis et al 2018 introducing the uncertainties to the definition of optimization problem requires methods for analysing the optimization problem under uncertainty the defined optimization problem under uncertainty is mostly focused to incorporate the uncertain parameters in the design of ship hull properties for the conceptual design of a bulk carrier ship hannapel and vlahopoulos 2010 introduced uncertainties to the prediction model of the main dimensions of the vessel the prediction model was a set of empirical equations that are generated by regression analysis the approach of robust based was applied to define the objectives and a reliability based approach was used to convert the constraints from the deterministic base a similar optimization problem was defined for the conceptual design of a bulk carrier by diez and peri 2010a the robust based approach was used for optimizing the main dimensions of the ship under the uncertainty of the prediction model in a different approach for solving the same problem diez and peri 2010b applied stochastic programming to convert the deterministic optimization to optimization under uncertainty targeting the design of ship body lines hou et al 2018 defined the optimization problem to minimize eedi by limiting the ship volume and resistance to an acceptable level the uncertainties were introduced into design variables of waterline length and breadth and hull control factors the reliability based approach was applied to convert the deterministic problem to optimization under uncertainty to improve the lifecycle performance safety efficiency and economic functions nikolopoulos and boulougouris 2018 defined the optimization problem by considering uncertainty due to various sources the design variables included the parameters that control the main dimensions of the ship and a few parameters that control the internal layout dimensions of a container ship the source of uncertainties were the regression models that provided for prediction the environmental conditions and economic functions from the collected big data regarding the design of the internal layout of ships the size and location of the internal spaces are established in the early stage of ship design for the oil tankers the internal hull layout design can be defined as an optimization problem to improve ship performance during the life cycle guan et al 2018 however no research is identified with a specific focus on the determination of internal dimensions of oil tankers with the approach of optimization under uncertainty the internal layout of oil tankers can be optimized targeting the improvement of the economic returns and the safety and prevention of environmental pollution the prominent indications of these objectives are identified as the cargo capacity induced bending moment to the ship hull and oil outflow performance for a fixed hull ship jafaryeganeh et al 2019 in this regard papanikolaou et al 2010 applied a deterministic optimization procedure for the arrangement of the cargo area of an aframax class tanker to minimize the accidental oil outflow and improvement of economic competitiveness however the uncertainty of the oil outflow due to the accidents was not discussed the oil outflow is a consequence of damage of oil tanks a prediction model of damages is recommended by imo 2003 using the probabilistic distributions the applied probability density functions pdfs are based on the statistics of damage accidents which include 52 collisions and 63 groundings this type of statistics has been used in specific studies on the consequences of collision and grounding pedersen 2010 prestileo et al 2013 the statistics can be updated by the availability of new data and the uncertainty of the predicted value of oil outflow needs to be treated during the optimization process the minimization of still water bending moment swbm also was used as a safety objective to optimize the internal dimensions of oil tankers in chen et al 2010 yu and lin 2013 yu et al 2015 and su et al 2019 however none of them considered the uncertainty of the prediction of induced loads during the optimization procedure in this regard guedes soares and moan 1988 presented a statistical model for prediction of the swbm variability for the different type of the ships they collected recorded data from the on board load distribution equipment normalized by the minimum requirement of swbm that is recommended by the classification societies rules the variability of swbm was modelled by a normal distribution where the expected value and standard deviation depends on the length of the ship and the average non dimensional deadweight this model reflects the real operational conditions of ships and is better than using the cases in the loading manual as this is a design document and often the operations are different for double hull tankers hørte et al 2007 proposed a stochastic model to predict the variability of the sagging swbm in full load condition the sagging bending moment was statistically analysed from loading manual data which was the only one available for the sample tankers the model presented the normal distribution for sagging bending moment where the expected value and standard deviation of the distribution are 70 and 20 of maximum sagging bending moment in the loading manual respectively later teixeira et al 2013 applied a similar approach to predict a model of swbm for the two main load condition of the full ballast and full load in the oil tankers similar to sagging swbm the model presents the normal distribution for hogging swbm with the expected value and standard deviation of 70 and 20 of maximum hogging bending moment in the loading manual respectively once the design variables objective functions and constraints are defined for an optimization problem the uncertainties need to be incorporated in the problem in general the optimization problems under uncertainties include five main steps identify the uncertainty types quantify the uncertainties uncertainty propagation define the optimization problem and analyse the results messac 2015 a variety of methods have been implemented to perform the tasks in each step fig 1 the steps one to three are dedicated to the identification and modelling the source of uncertainties and method of introducing the effect of uncertainties on the interest functions more detail of the applied methods in these topics can be found in canavero 2019 step four deals with the development of an optimization problem under uncertainties based on the defined problem in step five the developed problems under uncertainty can be solved using the common optimization algorithm which is applied to deterministic problems to explore the trade off between the solutions deb et al 2015 the widely used methods for handling the optimization under uncertainty are robust based design optimization rdo or rbo reliability based design optimization rbdo robust and reliability based design optimization r2bdo or rbrdo and stochastic programming birge and louveaux 2011 in the present work the focus is on the robust based approach however the concept of the reliability based approach needs to be elaborated due to a common method for constraint translation with the robust based a robust based design intends to approach the design with lower sensitivity to the variables fig 2 shows the difference between deterministic and robust optimum for a sample of a single variable single objective optimization problem with a constraint yao et al 2011 where x 1 is the solution for the minimum value of the objective function and x 2 is the solution of the same problem in the framework of robust design the variation of the objective function at the deterministic solution relative to the change of the design variable is larger than the variation of the robust solution a reliability based design intends to approach the design with higher confidence in the system operation without failure i e the reliable design intends to decrease the failure probability in a determined period fig 3 shows the difference between deterministic and reliable optimum for a sample of a two variable single objective optimization problem with two constraints yao et al 2011 where x 1 is the vector solution for the minimum value of the objective function and x 2 is the vector solution of the same problem in the framework of reliability based design the reliability of the solution is provided by considering a marginal distance from the boundaries between the feasible and infeasible solutions thus the reliability optimization aims not only to the improvement of objective functions but also aims to increase the assurance level of satisfying the constraints it should be noted that methods of converting the constraints from the determinist framework to robust based are similar to the methods that are applied to the reliability based definition thus the form of robust based problems that include robust constraints handling become similar to the robust and reliability based design optimization du and chen 2000 for inequality constraints the approaches are based on the definition of a margin relative to the original constraint and then the solutions can be limited to a domain of feasible solutions that has a distance from the infeasible domain the concept is depicted in fig 4 by a shift of constraints toward the original feasible domain this work deals with the improvement of the design of the internal layout of oil tankers targeting safety and economic feedback considering the incorporated uncertainty thus the work is presented in the five steps 1 definition of the design of the internal hull layout of the oil tankers as a deterministic framework of the optimization problem 2 presentation of the applied method for uncertainties modelling in the objective functions and constraints 3 introducing the robust based method for incorporating uncertainties into the optimization problem 4 applying the methodology for a case study and approaching to the pareto solutions for the designs 5 selection of final design among the obtained non dominated solutions by a multi attribute decision making method 2 deterministic optimization problem the following formulation presents a general form of the multi objective multi constraint deterministic optimization problem where all the variables including the design parameters objective functions and constraints are deterministic 1 find x to minimize f x subject to g x 0 x l x x u where x is the vector of design variables with the vectors of lower and higher bounds of x l and x u respectively f is the vector of objective functions and g is the vector of the general form of constraints including the equality and non equality limitations the subdivision design of the oil tanker is adopted with the general form of deterministic optimization problems by identifications of the design variables constraints and objective functions 2 1 design parameters in this work the ship hull is assumed to be fixed so the overall dimensions of the available space of the internal layout of the ship do not change during the variations in the optimization process however the dedicated space for the tanks and compartment can be defined by alternative designs similarly the topology of the arranged tanks and compartments are assumed to be fixed because the typical arrangement of the layout is similar for each type of ship on the other hand the number of watertight bulkheads wtb is depended on the specified limits in the damage stability regulation for the tankers iacs 2017 i e there is no direct recommendation for the number of wtb of oil tankers once the damage stability calculation resulted in a minimum number of wtb for a reference ship with a fixed hull shape the optimum number is achieved the variation in the number of wtb can only be possible by increasing the number therefore the main challenge of the problem is defined by the determination of the dimensions of the internal compartments and tanks to approach the optimum of the interest functions the design variables of the problem are defined below the positions of the transverse bulkheads alongside the ship l i i 1 n t 1 the longitudinal positions of inclination of wing tank l s1 and l s2 the position of the collision bulkhead l cbd the widths of the wing tanks for each longitudinal subdivision w i i 1 n t the heights of double bottom tanks for each longitudinal subdivision h i i 1 n t where n t is the number of wtb l i is a discrete real parameter due to the following the distances of frame spacing it should be noted that these parameters define a generic framework for producing different configurations such as parallel or inclined walls of the wing tank fig 5 shows the adapted set of variables for a case of an oil tanker where unique values are assumed for the minimum widths of wing tanks and the heights of double bottom 2 2 constraints the majority of constraints are non equality type due to regulations however they can be translated to equality constraints for instance intact stability criteria include non equality limitations for transverse and longitudinal stabilities eventually all those constraints can be translated to an equality constraint of intact stability regulations with two options of pass equal to 1 or not pass not equal to 1 a combination of the two approaches was applied to constraints to simplify the categorization of the limits especially the approach is helpful during the identification of the priorities for constraint conversion to robust based approach the constraint 1 to 6 define limits for the design variables and constraint 7 to 11 are implemented on the evaluation functions constraint 1 limitation for the collision bulkhead according to solas imo 2012 as below 2 min 0 05l 10 0 m l cbd max 0 05l 3 0 08l where l is the length of the ship constraint 2 the minimum requirement for protective spaces in wall side according to marpol imo 2006 regulation 19 3 w min w i w min min 0 5 dwt 2000 2 0 m where dwt is the deadweight of the ship constraint 3 the minimum requirement for protective spaces in bottom side according to marpol imo 2006 regulation 19 4 h min h i h min min b 15 2 0 m where b is the breadth of the ship constraint 4 the limit between two consecutive bulkheads 5 l db l i l afl i 1 6 where l afl is the minimum allowable length according to the floodable length calculation and l db is the maximum extent of damage according to marpol regulation 28 this constraint leads to removing some infeasible solutions at the beginning of the evaluations thus there is no need to continue with the damage stability calculations for those solutions constraint 5 the minimum requirement of capacity for the slop and fuel tanks 6 l slop l fuel l 7 where the l slop is the slop tank length that is calculated by the minimum required volume l fuel is the length of the fuel tank that is assumed to be constant l 7 is the design variable that controls the length of the 6th oil tank in addition to the slop and fuel tank constraint 6 the minimum required volume for engine room and propulsion room 7 v eng v prop v req where v eng and v prop are the volumes of the engine room and the propulsion room respectively v req is the minimum required volume for engine and propulsion room constraint 7 an equality constraint to pass all the requirement for segregated ballast tank according to marpol imo 2006 regulation 18 as listed below d m 2 0 0 02l 8 t s 0 015l d a d i where d m and d a are the draught of amidships and aft respectively d i is the minimum draught for full immersion of the propeller s t s is trim by stern constraint 8 the maximum allowable draft as below 9 d m d max where d max is the maximum allowable draft at amidships according to the international convention on load lines imo 1966 constraint 9 an equality constraint to pass all the requirement for intact stability criteria according to marpol imo 2006 regulation 27 as listed below 10 g m 0 0 15 m a g z curve 0 30 0 055 m r a d a g z curve 0 40 0 09 m r a d a g z curve 30 40 0 03 m r a d g z 0 02 m θ 30 where gm 0 is the initial metacentric height gz is the righting lever θ is the angle of heel θ m a x g z is the maximum of the righting arm a g z curve presents the area under the righting lever curve gz curve relative to the heeling angle so a g z curve 0 30 a g z curve 0 40 and a g z curve 30 40 are the areas up to 30 up to 40 and between 30 and 40 heeling angles respectively constraint 10 an equality constraint to pass all the requirement for damage stability criteria according to marpol imo 2006 regulation 28 as listed below 11 wl f m θ f 25 or θ f no deck immersion 30 θ r 20 g z r 0 1 m a g z curve θ f θ r 0 0175 m r a d where wl f is the final waterline after each scenario of damage the m is the specified marginal distance due to definition of the ship margin line θ f is the angle of the heel due to flooding θ r is the range of positive stability after flooding due to each damage scenario gz r is the maximum residual righting lever and a g z curve θ f θ r is the area under the righting lever curve gz curve between θ f and θ r heeling angles constraint 11 the maximum value for the accidental oil outflow according to marpol imo 2006 regulation 23 as below 12 o m k where o m is the mean oil outflow parameter and k is 0 021 when the cargo volume is less than 100 000 m3 at 98 tank filling 2 3 objective functions the main aims of the optimization problem are defined to increase safety and economic functions thus the following objectives are defined for the optimization problem 1 maximization of the cargo capacity the major financial return of oil tankers depends on the available capacity of loading cargo oil due to fixed dimensions of hull increasing the cargo capacity may not be in the same direction of improving safety and environmental protection for instance a ship with a larger capacity of cargo oil is exposed to a higher risk of oil outflow in the event of accidents so improving the economic functionality together with safety and pollution prevention is a challenging task 2 minimization of the maximum hogging still water bending moment 3 minimization of the maximum sagging still water bending moment the still water loads are induced on the ship hull due to the difference between the weight and buoyancy distributions the vertical still water loads are the most investigated component of the induced loads because of the high values of the imposed loads relative to the other variables thus these loads have a significant effect for the design of the ship s structure and are consequently more effective on the safety of the ship hull the vertical bending moment is a significant indication of the imposed load to the ship hull among the components of induced loads due to the still water the maximum still water bending moment swbm is induced to this ship hull in the hogging condition however the sagging has a more important effect on the safety and environment protection objectives because the sagging extreme values are in the full load condition while the extreme values of hogging are usually happening in the full ballast conditions thus the minimization of maximum sagging and hogging loading was defined as two separate objectives fig 6 shows the dependency of the three objectives 3 uncertainty modelling the uncertainty was only modelled for the objective functions of swbm the other objective function cargo capacity is assumed to be a deterministic value because the tankers normally operate in two load conditions of full load and ballast in the full load conditions usually the maximum allowable cargo capacity is used and in the full ballast condition no cargo would be carried by the oil tankers for the constraints the uncertainty was only modelled for the accidental oil outflow because pollution prevention is one of the major concerns of oil tankers in the event of accidents the tankers are usually in the safe side of stability criteria thus increasing the reliability margin relative to constraints of intact and damage stability criteria are more interesting in the other type of the ships such as containers ship 3 1 uncertainty modelling of swbm as the objective function the swbm is a function of two variables of weight and buoyancy distributions however the weight distribution except traverse bulkheads can be considered as an independent variable especially in the present study because the hull was assumed to be fixed during the design process the buoyancy is dependent on the weight distribution of the designs the weight includes the lightship and deadweight the lightship weight is assumed to be constant in an operational ship during her lifetime the deadweight is affected by the variation of the cargo during the loading and unloading in the ports exchange of water ballast for environmental protection and the changes of the consumables during the voyage the impact of consumables changes is more important for the voyages with a long duration therefore these variations introduced an uncertainty on the predicted values and distributions of swbm in the ship operation guedes soares 1990 the uncertainty of these values is modelled by normal distributions the expected values and standard deviations of the distributions were evaluated by the following equations teixeira et al 2013 13 μ s a g 0 7 m a x s w b m i s a g i 1 n σ s a g 0 2 m a x s w b m i s a g i 1 n μ h o g 0 7 m a x s w b m i h o g i 1 n σ h o g 0 2 m a x s w b m i h o g i 1 n where μ s a g and μ h o g are the expected values of the sagging and hogging σ s a g and σ h o g are the standard deviation of sagging and hogging respectively n is the number of load cases in the loading manual 3 2 uncertainty modelling of oil outflow as constraint the simplified method of prediction of damage probabilities of oil tankers is applied to calculate the expected value of oil outflow similarly the standard deviation of the predicted value was evaluated to be used for uncertainty prediction imo 2003 assign the probabilities of damage scenarios using the location and extent of penetration for side or bottom damage cases the damage shape is assumed to be a rectangular parallelepiped to simulate the location and extent of penetration the dimensions of the damage box are determined by the longitudinal transversal and height of the damaged compartments for each damage case thus the probability of happening a damage case is equal to the cumulative probability of the breaching from the side and bottom for the assumed dimension of the damage box as below 14 g l s x l y l z l 0 l 0 b 0 h f s 2 f s 3 f s 4 d z d y d x p b s 0 x l 0 z l g l s d z d x where f s2 is a function for the longitudinal extent of penetration f s3 is a function for the transverse penetration f s4 is a function for the vertical extent and p bs is the cumulative probability of breaching from the side at the location of x l y l z l with the dimensions of l b and h 15 g l b x l y l z l 0 l 0 h 0 b f b 2 f b 3 f b 4 d y d z d x p b b 0 x l 0 y l g l b d y d x where f b2 is a function for the longitudinal extent f b3 is a function for the vertical penetration f b4 is a function for the transverse extent and p bb is the cumulative probability of breaching from the bottom at the location of x l y l z l with the dimensions of l b and h later imo simplified the implementation of probability distributions functions by adapting the location and dimensions of the damage boxes to a set of tables and simple equations this application is more suitable for evaluating the probabilities of the predefined damage scenarios because the probability can be specified by coordinates of the planes that surround the damaged compartments or tanks in a damage case thus the simplified approach is used in this work for calculating the probability of breaching of compartments from the side and bottom more detail of the applied approach can be found in imo 2004 hereafter the formulation of imo 2004 was adapted with the common symbols of uncertainty modelling such as μ for expected value and σ for standard deviations when probability of breaching of compartments from the side p b s i and bottom p b b i is calculated the expected value of oil outflow due to side and bottom damage can be calculated as below 16 μ o m s i 1 n o p b s i o s i μ o m b 0 i 1 n o p b b i o b 0 i μ o m b 2 5 i 1 n o p b b i o b 2 5 i where o s i o b 0 i and o b 2 5 i are oil outflow for ith oil tank from the side damage and bottom damage for 0 m and 2 5 m tide condition respectively these values are calculated based on pressure balance principles n o is the number of oil tanks μ o m s μ o m b 0 and μ o m b 2 5 are expected values of the oil outflow of the tanks due to the side damage and bottom damage for 0 m and 2 5 m tide condition respectively these values are aggregated and normalized by the following equation according to the regulation 23 of marpol imo 2006 17 μ o 0 6 c d b 0 7 μ o m b 0 0 3 μ o m b 2 5 0 4 c 3 μ o m s c where μ o is non dimensional expected value of oil outflow for the oil tanker c is the total volume of cargo oil at 98 tank filling in m 3 c 3 is 1 for the arrangement of oil tanks that include longitudinal bulkheads inside the cargo tanks and c db is 0 6 for cargo tanks that bounded from below by non oil compartments although the regulations only introduced the expected value for the prediction of mean oil outflow by a non dimension index this work developed the application of the regulations for calculating the standard deviation of the predicted oil outflow thus following the similar approach for expected values of oil outflow the standard deviation of oil outflow was calculated in below 18 σ o m s i 1 n o p b s i o s i μ o m s 2 σ o m b 0 i 1 n o p b b i o b 0 i μ o m b 0 2 σ o m b 2 5 i 1 n o p b b i o b 2 5 i μ o m b 2 5 2 where σ o m s σ o m b 0 and σ o m b 2 5 are standard deviations of the oil outflow of the tanks from the side damage and bottom damage for 0 m and 2 5 m tide condition respectively these values can be aggregated and normalized by the similar method for the expected values as below 19 σ o 0 6 c d b i 0 7 σ o m b 0 0 3 σ o m b 2 5 0 4 c 3 σ o m s c where σ o is the non dimensional standard deviation of oil outflow for the oil tanker 4 robust based optimization problem the robust based approach is applied to introduce uncertainty into the deterministic problem however the reliability based is also described because of the similarity of the methods of constraint translation in the robust based and reliability based approaches the minimization of the expected value μf and standard deviation σ f of the objective functions result in the robust optimum solution the formulation 20 find to minimize subject to x f μ f x σ f x g x 0 x l x x u o r μ f x a n d σ f x presents the two alternative general forms of robust based optimization for a multi objective and multi constraints problem 4 1 formulation of objective functions the objective functions can be defined by two common approaches the vector of expected values μ f and standard deviations σ f of original functions are replaced to the original objectives as the separate functions thus even a single objective problem become a multi objective problem which deals with the trade off between the expected value and standard deviation of the original function diez and peri 2010b a vector function f is replaced to the original objective function s which is formulated by linear aggregation of expected value and standard deviation of the original objective functions by a proper coefficient β as below 21 f μ f x σ f x μ f β σ f the 3 sigma β 3 and 6 sigma β 6 are the most applied methods in the mentioned formulation for the robust optimization pyzdek 2003 the latter approach has an advantage relative to the former one because the aggregation of expected value and standard deviation of the original objective functions leads to a decrease in the number of objective functions thus the process of decision making for the design selection would be simplified thus the approach with 3 sigma method was considered for the robust objectives of sagging f 1 and hogging f 2 as below 22 f 1 μ s a g 3 σ s a g f 2 μ h o g 3 σ h o g the third objective function f 3 is considered by the maximization of the cargo capacity similar to the deterministic optimization problem 23 f 3 m a x c a r g o c a p a c i t y full load condition 4 2 formulation of the constraints the constraint of the robust based optimization can be defined in the same way as the constraint of the deterministic optimization though a comprehensive robust design can be achieved by conversion of all the aspects of the deterministic framework to the robust based because the robust based design aims to provide a design that is insensitive to the variation of the system these variations not only include the changes of the objective functions but also include the changes of the constraints parkinson et al 1993 the approaches of translating the constraints from deterministic based to rdo or rbdo are depended on the type of constraints i e equality or inequality forms rangavajhala et al 2009 the constraints 1 to 10 remain the same as the deterministic optimization thus the method for converting the equality constraints are not applicable moreover those constraints are originally non equality constraints thus the following methods can be applied for converting them in the event of introducing the uncertainty in the problem for the mentioned equality constraints considering that the g x are the inequality constraints of the deterministic problem 24 g x 0 then the confidence level of the constraint s satisfaction can be improved by definition of tolerance in the equations as below 25 g x δ 0 where the δ can be obtained by four widely used methods of worst case analysis parkinson et al 1993 corner space evaluation sundaresan et al 1993 variation patterns formulation yu and ishii 1998 moment matching method du and chen 2000 fig 7 presents a schematic view of the constraint handling by two methods of corner space and variation pattern tolerance is defined as the distance between the solutions and the constraints the constraint 11 is translated from deterministic optimization to the robust base by a similar method of moment matching method generally in the moment matching method it is assumed that the probabilistic model of constraints follows a normal distribution thus the probability of satisfaction of the constraints is equal to the cumulative normal distribution function φ as below 26 p g x 0 φ μ g σ g μ g σ g k where k φ 1 p g x 0 and therefore the k 0 and finally the constraint is translated as below 27 μ g k σ g 0 the expected value and standard deviation of the constraint can be calculated by the first order second moment method in this work the expected value and standard deviation of oil outflow are obtained directly by measuring the oil outflow due to probability distributions functions of the damages then the constraint 11 was replaced by the following equation 28 constraint 11 μ o 3 σ o k where 3 sigma defines a tolerance between the solutions and the original constraints 5 optimization procedure the optimization procedure is shown in fig 8 which includes updating the model according to the design parameters applying the predefined loading conditions and damage scenarios to the model performing the intact and damage stability analysis updating the uncertainty model evaluating the objective and constraints checking the criteria running the optimization algorithm repeating the above stages until reaching the stopping criteria a parametric model of the internal layout is developed to generate different configurations based on the set of design variables the model can also check the constraints and automatic evaluation of the objectives more details of the parametric model can be found in jafaryeganeh et al 2016 and jafaryeganeh et al 2018 the combination of caeses friendship systems 2019 and maxsurf bentley systems 2018 are used to build the framework a set of loading conditions are defined by the filling percentage of the oil and ballast tanks where the definitions are based on the common operational conditions by applying those loading conditions the stability solver calculates the equilibrium condition for each load case the maximum cargo capacity is calculated by the deadweight of the full load case max swbms of hogging and sagging are obtained from the maximum value of the whole set of load cases consequently the uncertainty model is updated and the robust based objectives are calculated additionally the probability of the side and bottom damage breaching is predicted according to the internal layout of the design so the robust based constraint for the oil outflow is calculated on the other hand a set of damaged scenarios are defined by considering the critical cases the combination of each damage scenario and loading condition is evaluated for each design to assess the damage stability criteria the evaluated functions are introduced to an optimization algorithm the multi objective genetic algorithm moga is used for approaching the optimum solutions using the dakota software adams et al 2017 the moga is a proper gradient free approach for the multi objective and multi constraint problem of internal layout dimensions because the objectives and constraint functions cannot be defined in the explicit forms the moga is also adapted for the discrete real variables to be compatible with the frame spacing of the ship structure the stopping criterion is defined by reaching the maximum number of generations the optimization process is continued until reaching the specified stopping criteria the maximum number of generations is specified by trials and repeating the process until no significant improvement is achieved in the objective functions 6 reference design a shuttle tanker is selected as a case study and its main particulars are listed in table 1 in the reference design the main subdivision consists of eight transverse bulkheads and a central longitudinal bulkhead fig 9 shows the initial general arrangement of the taker in the reference design the engine room is located forward 7 results and discussion moga can be started by a random initial population or a set of predetermined solutions however an initial population consisting of feasible solutions is introduced to the multi objective genetic algorithm to speed up the convergence process to the pareto frontier the initial population includes 264 solutions that pass the criteria these individuals are obtained based on introducing a random initial population in the previous trials jafaryeganeh et al 2019 a total of 3815 individuals are produced including feasible and non feasible designs the evaluation functions are calculated completely for 1639 individuals that pass the initial criteria checking a total of 20 populations are generated which results in 616 feasible solutions from these 84 number of feasible solutions are recognized as the non dominated solutions the process was run on pc with intel r core tm i7 8800k cpu 3 2 ghz and 32 00 gb memory time taken for running the process was approximately 68 h 3 days approximately 7 1 feasible solutions and pareto frontier for the convenience of interpretation of the results the objectives of f 1 and f 2 were presented with the relevant values of the maximum hogging and sagging swbm for each design fig 10 presents space scatter plot of feasible solutions and pareto front members two dimensional scatter plots are more comprehensible visually because the paired comparison of the objectives can conveniently measure the performance of one objective against the other one miettinen 2014 fig 11 presents the two dimensional scatter diagram of maximum sagging swbm against the cargo capacity the evolution direction of the obtained solutions can be recognized toward the pareto solutions where included the higher value of cargo capacity and smaller values of maximum sagging swbm the reference design is approximately in the middle range of the objective s values for the obtained solutions globally plenty of solutions had better values of the mentioned objectives relative to the reference design even locally the reference design can be improved from the aspect of the cargo capacity and maximum sagging swbm fig 12 shows the scatter diagram of maximum hogging swbm against the cargo capacity in general the pareto solutions with higher cargo capacity result in higher value of induced max swbm in hogging conditions plenty of feasible solutions have better values of the maximum hogging swbm than the reference design however a relatively smaller number of solutions have better values of cargo capacity fig 13 shows the scatter diagram of maximum hogging and sagging swbm a few non dominated solutions were observed for these two objectives however the pareto solutions have more diversity considering the defined three objectives the reference design can be improved considerably in the aspect of the induced max swbm fig 14 shows the robust constraint of the oil outflow against the cargo capacity for feasible solutions the constraint values are at an acceptable level relative to the allowable oil outflow parameter for the designs the marginal distance of each design relative to the allowable value is depended on the uncertainty term the distance increased for those solutions that have a higher standard deviation of oil outflow fig 15 shows the scatter diagram of the expected value of oil outflow against its standard deviation for all the obtained solutions that pass the robust criteria a considerable distance is observed between the expected values of the oil outflow of the solutions relative to the allowable value 21 10 3 even those solutions that had the highest value of expected oil outflow are at an acceptable level of reliability 7 2 decision making for final design selection the final optimal solution can be selected by a trade off between conflicting objective functions thus the selection of final designs can be defined as a multi attribute decision making madm problem boulougouris and papanikolaou 2008 because the madm aims to rank the alternatives to find the best satisfaction of the given criteria which are not necessarily in the same agreeable direction so the pareto solutions can be judged by the madm methods and the superior design can be identified among the available alternatives more discussion about the effective modules of madm methods for design selection from a pareto set can be found in jafaryeganeh et al 2020a and jafaryeganeh et al 2020 here the well known method of technique for order preferences by similarity to an ideal solution topsis is applied to compare the selected alternative designs from the obtained pareto set the concept of the topsis method is based on choosing a compromise solution by measuring the distance relative to the best and worst ideal solution so the best solution is as close as possible to the positive ideal solution and at the same time is as far as possible from the negative ideal solution an euclidean norm measures the distance between each solution with the positive and negative ideal ones hwang and yoon 1973 the degree of importance of objectives is specified by assigning a weight to each objective function table 2 presents two alternative scenarios the equal importance of objectives was defined in scenario 1 while the objective of cargo capacity had the highest degree of importance in scenario 2 the obtained solutions were ranked by the topsis method the results of the top ten selected designs for scenarios 1 and scenario 2 are shown in fig 16 fig 17 shows the cargo capacity for alternatives of scenario 1 and scenario 2 the cargo capacity is a benefit criterion thus the top selected designs due to scenario 2 have a higher average value of cargo capacity relative to the selected designs due to scenario 1 max swbms are cost criteria so the desired values are the lower ones the top selected designs due to scenario 1 have a lower average value of max swbm relative to the selected designs due to scenario 2 as it is shown in fig 18 and fig 19 because the alternative scenario 1 defines more degree of importance for hogging and sagging bending moment relative to the alternative scenario 2 the alternative scenario 1 results in the selection of a design that has better performance in aspect of safety while the alternative scenario 2 results in the selection of a design that has better performance with respect to economic functionality the properties of the final selections are compared in table 3 also the schematic layouts of the alternative designs are compared with the reference design in fig 20 both selected designs have a high degree of confidence in the prevention of environmental pollution because they have a large distance to the upper limit of the oil outflow the constraint values are compared with the allowable value in table 4 8 conclusions a multi objective optimization problem is developed for the internal layout of the oil tankers the procedure is implemented to introduce the uncertainty of the oil outflow based on the probability distribution of the regulations in this regard the formulation of the obligatory regulatory framework is developed to predict the standard deviation of the evaluated mean oil outflow for the oil tankers also the uncertainty of the imposed loads to the ship hull is incorporated then the robust based method is applied to reformulate the optimization problem the multi objective genetic algorithm is used to approach the optimum designs finally a method of madm is used to rank the obtained pareto solutions the interest functions are improved for the obtained solutions based on a robust based method besides the solutions are limited to the designs that are in the reliable region of criteria limits the reference design can have a considerable improvement in the induced loads to the ship structure even if the cargo capacity remains unchanged the obtained solutions provide a wide range of diversities for the designer to have free hand about design selections the approach of optimization under uncertainty results in a more realistic definition of the design optimization problem because the presented approach not only includes the uncertainty of imposed load to the ship hull during the lifecycle of the ship but also includes the uncertainty of the probable damage accidents in the early stage of the design although the approach is built based on the probability distribution functions of the enforced regulation of pollution preventions the introduced process can be used for other damage consequences in future developments thus the survivability indications also can be used for risk based design with the introduced approaches of optimization under uncertainty credit authorship contribution statement h jafaryeganeh methodology formal analysis visualization writing original draft m ventura writing review editing supervision c guedes soares writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was performed within the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uidb uidp 00134 2020 
21468,transfer matrix method for multibody systems mstmm has high precision and it is easy to formulate systematic to apply simple to code and the matrices are low order which contributes to higher computational efficiency than ordinary dynamics methods it is applied widely in the field of engineering and the significant effects gained based on the mstmm advantages the linear and nonlinear hydroelastic models of a full scale sail mounted hydroplanes system using rigid flexible coupling multibody system coupled with a theodorsen fluid theory are presented in this paper the model is validated using data available from literature and simulation results from commercial software this work provides an engineering reference for an efficient linear and nonlinear fluid structure interaction fsi modeling and simulation of other rigid flexible coupling multibody system keywords hydroelastic modeling transfer matrix method multibody systems theodorsen s method fluid structure interaction 1 introduction fluid structure interaction fsi problems are among the most challenging one in computational mechanics fsi computations often require costly numerical simulations including cpu computing power memory and storage moreover the simulation can take very long time and the current fsi numerical simulation methods are not fully mature to include all complex fluid structure interactions practitioners are often faced with the difficulty of performing high fidelity computations of fsi problems and are unable to generate simulation results when calculating fsi problems including high degree of structure or fluid nonlinearity yan et al 2016 owen et al 2018 dongyang et al 2017 and eventually have to resource to low cost simulations due to the requirement of fast computation and analysis it is of great significance to establish efficient mathematical model capable of addressing fsi engineering problems in the field of aerospace and ocean engineering speed and maneuverability of surface and underwater s vehicles are increasing with increasing speed flow induced vibration can lead to kinematic and hydroelastic acoustic instabilities divergence flutter and limit cycle oscillations lco hoseini and hodges 2019 al mashhadani et al 2017 xie et al 2019 akhavan and ribeiro 2019 li et al 2017 2018 harwood et al 2020 hence fsi analysis should be performed during the design process the purpose of this paper is to take a rigid flexible coupling multibody system that is a sail mounted hydroplanes system of an underwater vehicle and introduce an efficient modeling method to perform linear and nonlinear hydroelastic simulations as integral part of the modeling effort the accurate vibration characteristics of the rigid flexible coupling multibody system represented by the natural frequencies and modes should be assessed firstly william 1992 there are many methods to solve the dynamics of multibody system finite element method fem and boundary element method bem are two widely used and there exist of the shelf powerful tool for solving the dynamic problems of complex structures nastran ansys abaqus and adina just to name but a few wang and ye 2016 çelik and duman 2017 in the study of complex system dynamics the following issues need to be considered 1 it is necessary to establish the overall dynamic equation of the system and identify their solution methodology if the topology of the structure changes the overall dynamic equation must be modified accordingly 2 the matrix of a complex system is high order greater than the number of system degrees of freedom and as a result the computation speed slows down rapidly with the increase of system dimensions 3 with the increase of systems complexity the total matrix of the full system should not be ill conditioned wang et al 2019a 2019b the transfer matrix method for multibody systems mstmm is a highly accurate easy to formulate systematic to apply and simple to code method the method does not need the explicit form of the global dynamic equations of the system rui et al 2016 2018 2019a rui et al 2020 and elegantly model systems which can include both discrete and continuous elements by transforming differential equations to algebraic equations all system information is summarized in an overall system of linear equations which are independent of the degrees of freedom bestle et al 2014 the method can be used to calculate the vibration characteristics and dynamic responses of the multibody systems and since the matrices involved are low order the computational efficiency is relatively high when compared with ordinary dynamics methods chen et al 2016 miao et al 2019 abbas et al 2013 2017 bestle et al 2014 he et al 2012 large systems made by many subsystems and rigid flexible structures can be modeled efficiently by mstmm as a result in recent years it is being more widely applied in a number of engineering fields a full scale hydroplanes system was modeled by mstmm and a comparison with the fem solution in ansys workbench was provided in chen et al 2017 2018 the modal analysis results of the two methods were in good agreement in dongyang et al 2017 the system was simplified as a two dimensional 2d hydrofoil model and the influence of the structure parameters such as center of gravity position and elastic axis position on the hydroelasticity of the 2d hydrofoil was studied some guiding conclusions on the structural design of the hydroplanes system were offered however it should be noted that the full three dimensional system was simplified to a two dimensional one and some structure details were not considered researchers usually deal the full hydroplane system as one hydroplane plus a torsional spring and simplify the control system as a torsional spring this approach however cannot consider the influence of the structure parameters such as mass bending stiffness torsion stiffness of each component and the presence of free play nonlinearity which is due to long term use and wear between components on the dynamic response of the full scale hydroplanes system given the mstmm advantages in the present work the full scale three dimensional 3d system is described by the mstmm coupled with theodorsen s unsteady fluid dynamic model and the linear flutter and nonlinear time domain response of the full scale hydroplanes system with free play are presented along with a more detailed representation of the dynamic model 2 problem definition fig 1 a shows the underwater vehicle sail mounted hydroplanes which are used for pitching and to control its depth the graphical representation of the typical sail mounted hydroplanes system of submarine is shown in fig 1 b it is a complex multi rigid flexible body system this system includes 1 hydroplanes 2 tiller 3 shaft 4 tie rod 5 guiding device 6 driving rod 7 sealing device 8 steering engine a piston and spring b ball joint c column hinge and d double bearing the hydroplane skin has distributed holes so that water can come in during underwater operations the equivalent stiffness of the hydraulic pressure of the steering engine is tested experimentally and is replaced by a translational spring during structural modeling the boundary conditions of the bearing guiding device sealing device and steering engine are fixed supports since are fixed on the submarine s hull which is considered a large rigid body the ball joint allows the up and down movement of the tie and guiding rod to drive the tiller to rotate and the tiller and shaft are fixed together as to drive the shaft to rotate a positioning ring device is installed between the two ends of the bearing and the hydroplanes to ensure that the shaft cannot move side by side when the underwater vehicle moves at a certain speed in the ocean environment the two hydroplanes of the system might undergo fsi vibration under the action of a fluid current the structural parameters of each component of the full scale hydroplanes system and the nonlinear free play between components may have an impact on the natural vibration characteristics and dynamic response of the full system the aim of this work is to establish an efficient model which can be used to study the linear and nonlinear hydroelastic problems of a rigid flexible coupling multibody system and to provide reference for the rapid modeling and simulation of similar fsi engineering problems 3 mathematical model 3 1 fundamental theory of mstmm the mstmm theorem and strategy in the context of free vibration characteristics are explained in chen et al 2017 while the equations of motion for a body element and overall system is introduced in rui et al 2018 the equations of motion of the complete system can be easily obtained by orderly arranging the equation of motion of the individual bodies that is 1 m v t t k v f where m and k are the augmented operators of the multibody system v is a column matrix of displacement v t t is the second order derivative of v with respect to time t and f is the force respectively the augmented eigenvector of the multibody system is written as v k k 1 2 3 the superscript k denotes the modal order let 2 v k 1 n v k q k where q k is the generalized coordinate substituting eq 2 into eq 1 3 k 1 n m v k q k t k 1 n k v k q k t f 4 m v k v p δ k p m p k v k v p δ k p k p taking the inner product in the both sides of eq 3 with v p p 1 2 3 and using the orthogonality for multibody system of eq 4 then the generalized coordinate equations of the system can be obtained from eq 3 as 5 q p t ω p 2 q p t f v p m p assuming that the initial conditions of the multibody system are 6 v t t 0 v 0 v t t t 0 v the nature frequency ω p and the mode shapes v p p 1 2 3 can be determined from the modal analysis based on mstmm rui et al 2018 the dynamic response of the system can be acquired from the simulation results of eq 5 it should be noted that eq 5 is suitable for the dynamics which decoupled if the dynamic system is not decoupled with v v 1 v 2 v 3 v n the system has n orders mode shapes such that 7 v v q where q q 1 q 2 q n t q being the generalized coordinate matrix substituting eq 7 into eq 1 8 m v q k v q f the orthogonality for multibody system in mstmm is already proved thus 9 v t m v q v t k v q v t f 10 m q k q v t f where 11 m v t m v k v t k v here m and k are the modal mass and stiffness matrices respectively 3 2 dynamic modeling and vibration characteristics of the hydroplanes system the corresponding mstmm topology of the more detailed system is depicted in fig 2 it should be noted that the following assumptions are made for the modeling of the hydroplanes system of the underwater vehicle 1 the boundary conditions of the bearing guiding device sealing device and steering engine are fixed supports 2 the water inside the hydroplane is assumed to be additional mass 3 ignoring the structural damping of the hydroplanes system only the hydrodynamic damping caused by the hydroplane system vibration is considered 4 the strain of hydroplane are quite small and the stress strain relationship is linear 5 only the first several mode shapes of the hydroplanes system are used for the fsi simulation higher modes are discarded the higher modes include the local modes of the hydroplanes skin and are not considered in fig 2 the hydroplane is treated as a 7 segment bending torsion coupling beam elements 1 7 19 25 with different structural parameters considering axial direction vibration the column hinge element 26 is treated as a hinge element the shafts elements 10 and 16 are treated as uncoupled beams which can consider transverse axial and torsional directions vibrations the contact stiffness between the bearing and the bearing sleeve and the contact stiffness between the locating ring and the hydroplanes are represented by spring hinges elements 9 11 15 17 the tie rod is treated as an uncoupled beam element 27 which can consider the x axis and axial directions vibration the driving rod can only move up and down in the sealing device so it is treated as a rod element element 29 the tiller is treated as a rigid body element 13 the steering engine is treated as a spring hinge element 30 this dynamic model is a tree system with more than two branches which can be easily handled by mstmm the system is comprised of 30 elements with 7 boundaries z 1 z 27 z 28 z 29 z 30 z 36 the tips and z 26 the root the system state vectors svs are given as z i x y θ z m z q y θ x m x i t i 1 30 where the small displacement small angle are x y θ x θ z or kinetics and the forces moments are q x q y m x m z respectively according to the definition of the topological structure of the system by mstmm rui et al 2018 the transfer equations te of the entire system are derived to simplify the mstmm and following the chain topology the te of the left and right hydroplanes are written in condensed form as follows 12 z 26 u 25 u 24 u 23 u 22 u 21 u 20 u 19 z 19 u pla r z 19 z 8 u 7 u 6 u 5 u 4 u 3 u 2 u 1 z 1 u pla l z 1 following all transfer directions represented in fig 2 the main te can be obtained as 13 z 26 u pla r z 19 u pla r u 18 i 1 z 17 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 z 16 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 z 14 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 z 13 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 z 11 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 z 10 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 z 27 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 2 u 11 z 28 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u pla r u 18 i 1 u 16 u 14 i 2 u 15 z 29 u pla r u 18 i 2 u 17 z 30 or 14 z 26 t 1 z 1 t 2 z 27 t 3 z 28 t 4 z 36 t 5 z 29 t 6 z 30 where 15 t 1 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l t 2 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 t 3 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 2 u 11 t 4 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 t 5 u pla r u 18 i 1 u 16 u 14 i 2 u 15 t 6 u pla r u 18 i 2 u 17 the transfer matrices of bending torsion coupled beams with axial direction vibration u 1 u 2 u 3 u 4 u 5 u 6 u 7 u 19 u 20 u 21 u 22 u 23 u 24 u 25 spring hinge u 11 u 15 u 30 u 9 u 17 column hinge u 26 ball joint u 28 planar rigid body u 13 i 1 u 13 i 2 driving rod u 29 tie rod u 27 and dummy rigid body u 8 i 1 u 12 i 1 u 14 i 1 u 18 i 1 u 8 i 2 u 12 i 2 u 14 i 2 u 18 i 2 are shown in appendix a for elements 8 12 13 14 and 18 the geometry equations ges are obtained by eq 16 through 20 16 h 8 i 1 z 8 h 8 i 2 z 9 0 h 8 i 1 u p l a l z 1 h 8 i 2 u 9 z 27 0 17 h 12 i 1 z 11 h 12 i 2 z 12 0 h 12 i 1 u 10 z 10 h 12 i 2 u 11 z 28 0 h 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 h 12 i 2 u 11 z 28 0 h 12 i 1 u 10 u 8 i 1 u pla l z 1 h 12 i 1 u 10 u 8 i 2 u 9 z 27 h 12 i 2 u 11 z 28 0 18 h 13 i 1 z 13 h 13 i 2 z 31 0 h 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 u 12 i 2 u 11 z 28 h 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 0 h 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 h 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 z 27 h 13 i 1 u 12 i 2 u 11 z 28 h 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 0 19 h 14 i 1 z 14 h 14 i 2 z 15 0 h 14 i 1 u 13 i 1 z 13 u 13 i 2 z 31 h 14 i 2 u 15 z 29 0 h 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 h 14 i 2 u 15 z 29 0 h 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 h 14 i 1 u 13 i 1 u 10 u 8 i 2 u 9 z 27 h 14 i 1 u 13 i 1 u 12 i 2 u 11 z 28 h 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 h 14 i 2 u 15 z 29 0 20 h 18 i 1 z 17 h 18 i 2 z 18 0 h 18 i 1 u 16 z 16 h 18 i 2 u 17 z 30 0 h 18 i 1 u 16 u 14 i 1 z 14 u 14 i 2 u 15 z 29 h 18 i 2 u 17 z 30 0 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 h 18 i 2 u 17 z 30 0 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 z 27 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 2 u 11 z 28 h 18 i 1 u 16 u 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 h 18 i 1 u 16 u 14 i 2 u 15 z 29 h 18 i 2 u 17 z 30 0 equation 16 through 20 can be written as 21 g 1 z 1 g 2 z 27 0 22 g 3 z 1 g 4 z 27 g 5 z 28 0 23 g 6 z 1 g 7 z 27 g 8 z 28 g 9 z 36 0 24 g 10 z 1 g 11 z 27 g 12 z 28 g 13 z 36 g 14 z 29 0 25 g 15 z 1 g 16 z 27 g 17 z 28 g 18 z 36 g 19 z 29 g 20 z 30 0 where 26 g 1 h 8 i 1 u p l a l g 2 h 8 i 2 u 9 g 3 h 12 i 1 u 10 u 8 i 1 u pla l g 4 h 12 i 1 u 10 u 8 i 2 u 9 g 5 h 12 i 2 u 11 g 6 h 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l g 7 h 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 g 8 h 13 i 1 u 12 i 2 u 11 g 9 h 13 i 2 u 26 u 27 u 28 u 29 u 30 g 10 h 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l g 11 h 14 i 1 u 13 i 1 u 10 u 8 i 2 u 9 g 12 h 14 i 1 u 13 i 1 u 12 i 2 u 11 g 13 h 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 g 14 h 14 i 2 u 15 g 15 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l g 16 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 g 17 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 2 u 11 g 18 h 18 i 1 u 16 u 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 g 19 h 18 i 1 u 16 u 14 i 2 u 15 g 20 h 18 i 2 u 17 in eq 16 through 20 h 8 i 1 h 8 i 2 h 12 i 1 h 12 i 2 h 14 i 1 h 14 i 2 h 18 i 1 h 18 i 2 h 13 i 1 and h 13 i 2 are the geometric matrices of the dummy rigid body and planar rigid body with two input end single output end presented in appendix b finally by combining eq 14 through 26 the overall te of the entire system shown in fig 2 can be written as 27 u all 28 56 z all 56 1 0 where 28 u all t 1 8 8 t 2 8 8 t 3 8 8 t 4 8 8 t 5 8 8 t 6 8 8 i 8 8 g 1 4 8 g 2 4 8 o 4 8 o 4 8 o 4 8 o 4 8 o 4 8 g 3 4 8 g 4 4 8 g 5 4 8 o 4 8 o 4 8 o 4 8 o 4 8 g 6 4 8 g 7 4 8 g 8 4 8 g 9 4 8 o 4 8 o 4 8 o 4 8 g 10 4 8 g 11 4 8 g 12 4 8 g 13 4 8 g 14 4 8 o 4 8 o 4 8 g 15 4 8 g 16 4 8 g 17 4 8 g 18 4 8 g 19 4 8 g 20 4 8 o 4 8 z a l l t z 1 t z 27 t z 28 t z 36 t z 29 t z 30 t z 26 t t herein i 8 8 is a 8 8 identity matrix it should be noted that this overall te involves only the boundary svs whereas svs of internal connection points are eliminated the boundary conditions are 29 z 1 x y θ z 0 0 0 θ x 0 t z 27 0 0 0 m z q x q y θ x 0 t z 28 x 0 θ z 0 0 q y θ x 0 t z 36 0 0 0 m z q x q y 0 m x t z 29 x 0 θ z 0 0 q y θ x 0 t z 30 0 0 0 m z q x q y θ x 0 t z 26 x y θ z 0 0 0 θ x 0 t applying the boundary conditions reported in fig 2 eq 27 reduces to u a l l 28 28 ω z a l l 28 1 0 the eigenvalue search on the 28 28 matrix u a l l is performed using method on search interval bestle et al 2014 ω 1 500 rad sec with grid size n x 0 5000 and tolerance ε 10 10 once the required band of the natural frequencies ω of the full scale hydroplanes system is determined the related mode shapes v can be generated by singular value decomposition svd chen et al 2017 abbas et al 2015 then the dynamic equations 1 10 can then be solved to obtain the dynamic responses of the hydroplanes system 3 3 linear and nonlinear hydroelastic modeling of the full scale hydroplanes system theodorsen s theory represents the lift and pitching moment for an airfoil hydrofoil undergoing small harmonic oscillations in incompressible flow according to theodorsen s theory and assume the structure is harmonic vibrations the hydro loads of this problem can be written as mccormick and luca 2004 30 l π ρ b 2 h u α b a α 2 π ρ u b c k u α h b 1 2 a α 31 t α π ρ b 2 b a h u b 1 2 a α b 2 1 8 a 2 α 2 π ρ u b 2 a 1 2 c k v α h b 1 2 a α where l and t α are the hydrodynamic lift and moment per unit span of the two hydroplanes respectively in eqs 30 and 31 ρ u b and π denote the fluid density velocity semi chord and lift curve slope of each section of the hydroplane respectively in addition h and α are the displacement along y axis positive up and the rotational displacement θ about x axis positive nose up of the hydroplane respectively furthermore a is the non dimensional distances as a fraction of b from the elastic axis to the mid chord position theodorsen s function c k is a complex valued transfer function which depends on the reduced frequency k ω b u where ω represents the circular frequency of the hydroplanes system motion the time domain hydrodynamic model is based on the theodorsen s theory and wagner s function φ ω the lift l and pitching moment t α are expressed as dongyang et al 2017 chen et al 2018 fung 1995 32 l π ρ b 2 h u α b a α 2 π ρ u b q 3 4 0 φ ω τ ˆ 0 τ ˆ d q 3 4 σ d σ φ ω τ ˆ σ d σ 33 t α π ρ b 2 b a h u b 1 2 a α b 2 1 8 a 2 α 2 π ρ u b 2 a 1 2 q 3 4 0 φ ω τ ˆ 0 τ ˆ d q 3 4 σ d σ φ ω τ ˆ σ d σ where 34 q 3 4 τ ˆ u α h b 1 2 a α φ ω τ ˆ 1 a a e b 1 τ ˆ a b e b 2 τ ˆ τ ˆ u t b a a 0 165 a b 0 335 b 1 0 0455 b 2 0 3 a linear frequency domain flutter model of the full system the equations of motion of the overall system are shown in eq 1 let 35 v v s e i ω t then 36 f l t α t b v b v s e i ω t h y h s e i ω t α θ α s e i ω t l π ρ b 2 ω 2 h s i ω u α s ω 2 b a α s 2 π ρ u b c k u α s i ω h s i ω b 1 2 a α s e i ω t t α π ρ b 2 b a ω 2 h s i ω u b 1 2 a α s ω 2 b 2 1 8 a 2 α s 2 π ρ u b 2 a 1 2 c k u α s i ω h s i ω b 1 2 a α s e i ω t substituting eq 35 into eq 1 37 ω 2 m v s k v s b v s mstmm is qualified to compute the mode shapes v the right side of eq 37 may not be decoupled let v v 1 v 2 v 3 v n and 38 v s v q substituting eq 38 into eq 37 39 ω 2 m v q k v q b v q in the view of orthogonality in mstmm 40 ω 2 v t m v q v t k v q v t b v q according to u g velocity artificial structure damping method dongyang et al 2017 mccormick and luca 2004 the dissipative damping force of the structure can be cast as 41 d d s e i ω t i g k v s e i ω t where g is the artificial damping which is added to the right side of eq 37 as 42 1 i g ω 2 k q v t b ω 2 v m q where 43 m v t m v k v t k v the linear flutter speed calculation process is converted to that of a complex eigenvalue problem and its eigenvalue is 44 λ 1 i g ω 2 λ re i λ im thus 45 ω 1 λ re g λ im λ re u b k λ re where k ω b u at the critical flutter speed u f l u t t e r the oscillations are neutrally stable and g 0 b nonlinear time domain flutter model of the complete system free play nonlinearity may occurred in the actuator steering engine or the links of the mechanism or support mechanism of hydroplanes system due to friction by long term working conditions it may induce limit cycle oscillations lco phenomenon abbas et al 2008 li et al 2012 shin et al 2007 and although it will not lead to structure catastrophic failure it could significantly contribute to increase the noise signature and reduced the concealment of an underwater vehicle the time domain model of the full scale hydroplanes system is also established based on mstmm the right side of eq 1 includes the hydrodynamic loads which are not decoupled thus let v v 1 v 2 v 3 v n the hydroplanes system have n orders mode shapes which are obtained based on mstmm using eqs 1 7 32 and 33 46 m q c q k q v t f v q v q v q f n o n l i n e a r herein 47 m v t m v c v t c v k v t k v where c k 1 m k 2 k k 1 and k 2 are proportional damping coefficients for sake of simplicity knowing that will lead to conservative results it will be assumed an undamped system that is c 0 the nonlinear model with initial free play nonlinearity are considered in up and down h s and torsion α s directions respectively as shown in fig 3 according to the characteristics of this hydroplanes system normally only the h s need to be considered the nonlinear function f n o n l i n e a r is the matrix includes the restoring force and moment one element in f n o n l i n e a r matrix can be written as follows bartels 2008 48 f n o n l i n e a r f h k h h s h h s k h h h s h h s k h h s h h s f α k α α s α α s k α α α s α α s k α α s α α s the linear and the torsional spring stiffnesses column hinge or ball joint in the dynamic model fig 3 are represented by k h and k α respectively the hydrodynamics model is an integral differential equation there is an integral term in eqs 32 and 33 hence the direct numerical integration is very cumbersome thus the new state variation is introduced as follows 49 ω 1 0 t e b 1 u b t σ α σ d σ ω 2 0 t e b 2 u b t σ α σ d σ ω 3 0 t e b 1 u b t σ h σ d σ ω 4 0 t e b 2 u b t σ h σ d σ the physical coordinates in f are transformed into modal coordinates and moved to the left side of the eq 46 the time dependent function f t remain on the right side of the eq 46 and new mass matrix m n e w stiffness matrix k n e w and damping matrix d n e w are derived equation 49 is used to extend eqs 32 and 33 and to remove the integral terms the integrals derivative formulae are written as follows 50 f y x 1 y x 2 y f x y d x d f y d y x 1 y x 2 y f y x y d x f x 2 y y d x 2 y d y f x 1 y y d x 1 y d y and using eqs 49 and 50 one can cast the equation as 51 m n e w q d n e w q k n e w q g ω v t f t f n o n l i n e a r where 52 γ i t ω 1 t ω 2 t ω 3 t ω 4 t γ i t ω 1 t ω 2 t ω 3 t ω 4 t t t ω t e ω ω t e q v q t 53 e ω e ω 0 0 0 o 0 0 0 e ω e q e q 0 0 0 o 0 0 0 e q 54 e ω b 1 0 0 0 0 b 2 0 0 0 0 b 1 0 0 0 0 b 2 e q 0 1 0 1 1 0 1 0 and g is a coefficient matrix in state space form the nonlinear hydroelastic equations of the full scale hydroplanes system with free play are as follows 55 q t q t ω t 0 i 0 m n e w 1 k n e w m n e w 1 d n e w m n e w 1 g e q v 0 e ω q t q t ω t 0 m n e w 1 v t f t f n o n l i n e a r 0 the dynamic responses of the hydroplanes system are simulated using modal superposition equation 55 can be solved by ordinary differential equations ode 45 time marching scheme small angle of attack α of the hydroplane is selected as the initial condition other variables all are set to 0 in addition the selected time step is 0 001s which is decided by t reference length u 10 to 100 4 model validation 4 1 linear flutter speed calculation of goland wing validation is conducted using the goland wing beran et al 2004 which structural parameters are given in beran et al 2004 the natural circular frequencies depicted in fig 4 a and the associated mode shapes in fig 4 b of the 3d goland wing are calculated by mstmm first the first mode is mainly bending and the second mode is mainly torsion equation 45 is used to calculate the flutter boundary of the cantilevered 3d goland wing and the simulation results are illustrated in fig 5 a and b it should be noted that a quasi steady aerodynamic formulation obtained with c k 1 in eqs 30 and 31 is used throughout this example it is shown that the flutter speed of goland wing is 55 65 m s 182 ft s which is very close to the simulation result 180 ft s in beran et al 2004 the flutter frequency for the goland wing is 3 68 hz which agree well with the published data for this wing given the very good agreement with the model in beran et al 2004 the accuracy of the 3d mstmm theodorsen linear flutter model is verified 4 2 time simulation of a flat plate the commercial software nastran is used to calculate the flutter speed of a cantilevered 3d flat plate nastran 2004 flightloads 2006 the modal analysis is carried out by commercial software nastran for verification firstly the flat plate is meshed by 200 quad elements edge length 0 025 m the right side of the flat plate is a fixed support the nastran simulation results are in good agreement with flightloads 2006 as shown in table 1 then in nastran flutter analysis module an aerodynamic model using a doublet lattice method dlm is constructed for aeroelastic analysis aerodynamic surface is divided into 200 aero boxed structural and aerodynamic models are connected by using the finite plate splines fps method the flutter speed u 53 m s and flutter frequency ω 11 3 hz are obtained by nastran and are illustrated in fig 6 the results are in good agreement with flightloads 2006 using the method of chen et al 2017 parameters such as the position of elastic axis the distribution of bending stiffness and torsion stiffness of the flat plate are computed then running mstmm free vibration code based on these parameters the first two circular frequencies are determined see fig 7 a the comparison of predictions by mstmm fem by nastran and flightloads 2006 is tabulated in table 2 good agreement has been achieved as well as the mode shapes comparison between mstmm and nastran see fig 7 b it should be noted that the natural vibration modes calculated by nastran software are the modes after mass normalization in order to compare with the fem nastran results the mass normalization of the natural vibration mode calculated by mstmm is carried out the purpose of normalization is to unify the evaluation results on different scales into one scale so that they can be compared the process of mass normalization is to normalize the mass matrix m to be unit matrix i it is assumed that the mode shape before mass normalization is v o and after mass normalization is v such that v o t m v o m d where m d is the mass matrix after modal transformation the mass matrix m is normalized to unity by pre and post multiplication by v that is v t m v i therefore the mode shapes after mass normalization are v v o v o t m v o the linear time domain hydroelastic model obtained by removing the nonlinear terms from the nonlinear time domain flutter model is used to calculate the dynamic response of the flat plate fig 8 shows that the responses of the generalized coordinates q1 q2 and its derivatives d q1 d q2 tends to converge when the inflow speed is 40 m s while the responses tends to diverge when the inflow speed is 55 m s for an inflow speed of 51 m s the responses continuously oscillate with equal amplitude i e linear flutter occurs compared with the fem nastran results the difference between the two methods is about 3 8 and the error is quite small which verifies the accuracy of linear time domain simulation based on the proposed mstmm model on the basis of the presented flat plate model the influence of the free play on the flutter characteristics of the flat plate is further analyzed a torsional spring k α 1000 n m r a d is added to the left end of the plate and the left end of the torsional spring is fixed constraint the first two circular frequencies of the flat plate with torsional spring are determined by mstmm this is illustrated in fig 9 once the natural frequencies and modes are determined the nonlinear time domain flutter analysis based on mstmm including the fluid dynamic model of theodorsen can be carried out to compute the dynamic responses of the flat plate with a torsional spring and free play in torsion the displacement and rotation angle displacement time histories and the phase diagrams of the flat plate torsional spring system are depicted in fig 10 it is noted that the right end of the plat plate is determined as the monitor point for a free play of 0 rad with inflow speed equal to 15 20 and 25 m s the dynamic response converges the convergence rate slows down with the increase of the inflow speed when the inflow speed is 26 98 m s equal amplitude oscillation occurs this is the onset of flutter if the critical velocity is exceeded the response will diverge which will lead to the system s structural damage nonlinear simulations are performed to determine the dynamic response of the flat plate torsional spring system when the free play is 0 001 rad as shown in fig 11 when the inflow speed is 15 m s the response converges while at 20 m s and 25 m s limit cycle oscillations lco occur furthermore fig 11 b and c show that when the velocity increases the lco amplitudes increases it is well known that limit cycle vibration in this case associated with the plate spring system and caused by the free play does not lead to the sudden catastrophic structural damage and failure of the system but it will lead to fatigue damage indeed when the inflow velocity is 26 98 m s that is the critical flutter velocity of the linear model is reached the response of the nonlinear system including the free play is diverging which will cause structural damage this is consistent with the bulk of literature studying the aeroelastic behavior of aircraft where it is concluded that in presence of free play lco often occurs below the linear flutter critical speed abbas et al 2008 tang et al 2003 candon et al 2019 tang and dowell 2006 this is in accordance with the simulations result presented here providing further validation to this proposed model 5 numerical results and discussion the modal analysis of this underwater sail mounted hydroplanes system is carried out by fem with the commercial software ansys chen et al 2017 the fe mesh was created in ansys workbench shell 181 solid186 and solid187 elements are selected to model the system the boundary conditions of the bearing guiding device sealing device and steering engine are fixed supports bonded contact option is used for the connection between the shaft two hydroplanes and the shaft tiller no separation contact option is used for the connection between all other parts on the other hand in the process of modeling and computing the more detailed hydroplane system using mstmm very large contact stiffness between the components of the system and very small torsional stiffness of the joints are used the contact stiffness is assumed to be 1e10 n m and the torsional stiffness is assumed to be 1 n m r a d that is k x k y 1e10 n m and k x k z 1 n m r a d respectively the mstmm solution of the characteristic equation provides the circular frequency of the hydroplanes system hydraulic spring stiffness of the steering engine is k h 4 10 8 n m as shown in fig 12 mode shape and natural frequency of the hydroplanes system based on mstmm are shown in table 3 in order to describe the mode shape the mode shape display of the system is divided into two parts hydroplane shaft tiller shaft hydroplane and piston spring driving rod ball joint tie rod column hinge moreover the vibration modes are shown in x y and θ x directions respectively the mstmm results are very close to the fem ansys results mode shapes are reported in chen et al 2017 providing further validation to the proposed model it should be noted that the mstmm model from chen et al 2017 has no x direction vibration and no element to describe the bearing moreover the shaft is only allows torsion motion which is not real in engineering the spring stiffness values in x direction of element 9 and 17 in this paper s mstmm model are 1 e10 n m they are so large values that lead to the x direction mode shape s value all are 0 moreover consider more details in the model to make the model more robust and can be did more research in the future based on this model ansys computation of the hydroplanes system modes takes about 28 5 min using single core cpu computer while the mstmm computation only takes about 0 35 min with great computational cost saving the simulation results show that the first four modes of the hydroplanes system have no vibration in x direction it shows symmetric modes 1 and 3 and anti symmetric modes 2 and 4 modes in y and θ x directions the latter one are local modes that is modes 2 and 4 are contributing to the local behavior of the structure only hydroplane shaft tiller shaft hydroplane have modes while piston spring driving rod ball joint tie rod column hinge no modes values and do not participate to the global dynamics which is the problem being assessed in this paper for the structural dynamic behavior and response analysis the influence of these local modes can be safely neglected the linear flutter simulation of the entire system is performed using the structure parameters from chen et al 2017 the flutter u g and u f curves are presented in fig 13 which show that for an investigated range of u 0 20 m s there is no flutter occurrence the dynamic responses of the full scale hydroplanes system without free play are simulated using the same structure parameters fig 14 depicts time histories and phase portraits and show that the responses tends to converge when the speed is within u 1 to 20 m s and the larger the inflow velocity is the faster the dynamic response converges it can be concluded that when the structural parameters of this hydroplanes system are used the linear flutter phenomenon will not occur it is also possible to illustrate that by weakening some of the structural parameters of the hydroplanes system linear flutter may occur the dynamic responses of the hydroplanes system with free play between the components are calculated when the inflow velocity is 1 20 m s the free play between the column hinge ball joint and steering engine all are 0 001 m it can be seen from fig 15 that the greater the inflow speed is the faster the response convergence is and the response convergence tends to a stable value that is the static deformation of the hydroplanes system caused by the free play between the components of the system in contrast when the complete system has no free play the static deformation values of the hydroplanes system all are 0 see fig 14 the response of the complete system converges very slowly and a sustained small amplitude vibration occurs only when the inflow velocity is low to further assess this the vibration response of the system is computed when the inflow velocity is 1 m s and selected free plays in the components are considered as expected the vibration response of the system consider the tip of the hydroplane as a monitor point with only bearing s free play is slightly larger than that without a free play this can be seen in fig 16 if the bearing s free play increase in magnitude three times the vibration response of the system remains almost unchanged thus the bearing s free play is not the main reason for the increase of fsi vibration amplitude with a ball joint s free play and or a steering engine s free play without bearing s free play both vibration amplitudes in y and torsional directions increase significantly see fig 17 in order to further verify the coupling relationship between bearing s free play and the ball joint s free play or steering engine s free play additional simulation results is provided in fig 18 when compared with the earlier results depicted in fig 17 one can see that the added bearing s free play does not have a significant contribution to the vibration response therefore the hydroplanes system is more likely to generate water noise at low speed and the free plays in the piston spring driving rod ball joint tie rod column hinge have a greater impact on the response of the system at low speed on the other hand the free play will lead to a static deformation of the system at a relatively large speed 6 conclusions the hydroplanes system s vibration characteristics and their fluid structure interaction response under uniform inflow conditions are studied it is shown that linear flutter will not occur for this specific hydroplanes system in the range of navigation speed however with a presence of a free play in the piston spring driving rod ball joint tie rod column hinge chain sustained vibration will occur which may induced water noise and some long term structural fatigue issues it is also evidenced that after the relative increase of the velocity the free play will lead to the static deformation of the hydroplanes system while a full set of design recommendations will be desirable the proposed work illustrates how linear flutter behavior and the nonlinear time domain response of a rigid flexible coupling multibody system can be efficiently predicted furthermore the proposed method can be adopted when performing fsi modeling and simulations of multibody system and as a reference in a number of engineering disciplines credit authorship contribution statement chen dongyang conceptualization funding acquisition formal analysis writing original draft i have made substantial contributions to the conception or design of the work or the acquisition analysis or interpretation of data for the work and i have drafted the work or revised it critically for important intellectual content and i have approved the final version to be published and i agree to be accountable for all aspects of the work in ensuring that questions related to the accuracy or integrity of any part of the work are appropriately investigated and resolved pier marzocca all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named if the manuscript does not include acknowledgments it is because the authors have not received substantial contributions from nonauthors wang jinlong all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named if the manuscript does not include acknowledgments it is because the authors have not received substantial contributions from nonauthors xiao qing all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named if the manuscript does not include acknowledgments it is because the authors have not received substantial contributions from nonauthors zhan zhihuan all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named if the manuscript does not include acknowledgments it is because the authors have not received substantial contributions from nonauthors ma lei all persons who have made substantial contribution declaration of competing interest the authors declare that they have no known competing interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research work is supported by the natural science foundation of jiangsu province of china gant no bk20190871 national natural science foundation of china gant no 11672261 the authors would like to dedicate the work to late professor laith k abbas of the nanjing university of science and technology nanjing njust appendix a the transfer matrix of bending torsion coupled beam d c b is derived in chen et al 2017 a1 d c b b 1 b 1 0 where b 0 1 0 1 0 1 0 0 α l 0 β l 0 γ l e i l 2 α 2 0 e i l 2 β 2 0 e i l 2 γ 2 0 0 e i l 3 α 3 0 e i l 3 β 3 0 e i l 3 γ 3 k α 0 k β 0 k γ 0 0 g j l k α α 0 g j l k β β 0 g j l k γ γ b 1 cosh α sinh α cos β sin β cos γ sin γ α sinh α l α cosh α l a 3 β sin β l β cos β l γ sin γ l γ cos γ l e i l 2 α 2 cosh α e i l 3 α 3 sinh α e i l 2 α 2 sinh α e i l 2 β 2 cos β e i l 2 β 2 sin β e i l 2 γ 2 cos γ e i l 2 γ 2 sin γ e i l 3 α 3 sinh α e i l 3 α 3 sinh α e i l 3 α 3 cosh α e i l 3 β 3 sin β e i l 3 β 3 cos β e i l 3 γ 3 sin γ e i l 3 γ 3 cos γ k α cosh α k α sinh α k β cos β k β sin β k γ cos γ k γ sin γ g j l k α α sinh α g j l k α α cosh α g j l k β β sin β g j l k β β cos β g j l k γ γ sin γ g j l k γ γ cos γ therefore the transfer matrix of bending torsion coupled beam with axial direction vibration according to mstmm is a2 u c b cos β l 0 0 0 sin β l β e a 0 0 0 0 d 11 c b d 12 c b d 13 c b 0 d 14 c b d 15 c b d 16 c b 0 d 21 c b d 22 c b d 23 c b 0 d 24 c b d 25 c b d 26 c b 0 d 31 c b d 32 c b d 33 c b 0 d 34 c b d 35 c b d 36 c b β e a sin β l 0 0 0 cos β l 0 0 0 0 d 41 c b d 42 c b d 43 c b 0 d 44 c b d 45 c b d 46 c b 0 d 51 c b d 52 c b d 53 c b 0 d 54 c b d 55 c b d 56 c b 0 d 61 c b d 62 c b d 63 c b 0 d 64 c b d 65 c b d 66 c b where β ρ ω 2 e l and a are the length and sectional area of each segment of the hydroplane thus a3 u 1 u 2 u 3 u 4 u 5 u 6 u 7 u 19 u 20 u 21 u 22 u 23 u 24 u 25 u c b the transfer matrices of spring hinge column hinge and ball joint are respectively a4 u 11 u 15 u 30 1 0 0 0 0 0 0 0 0 1 0 0 0 1 k y 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 u 9 u 17 1 0 0 0 1 k x 0 0 0 0 1 0 0 0 1 k y 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 a5 u 26 1 0 0 0 0 0 0 0 0 1 0 0 0 1 k y 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 1 k x 0 0 0 0 0 0 0 1 u 28 1 0 0 0 1 k x 0 0 0 0 1 0 0 0 1 k y 0 0 0 0 1 1 k z 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 1 k x 0 0 0 0 0 0 0 1 the transfer matrices of planar rigid body driving rod tie rod and dummy rigid body are respectively a6 u 13 i 1 1 0 0 0 0 0 0 0 0 1 b 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 m ω 2 b 1 c 1 m ω 2 b 1 c 1 ω 2 j z z 1 0 b 1 m ω 2 b 1 c 3 0 m ω 2 0 0 0 1 0 0 0 0 m ω 2 m ω 2 c 1 0 0 1 m ω 2 c 3 0 0 0 0 0 0 0 1 0 0 m ω 2 c 3 0 0 0 0 ω 2 j x x 1 a7 u 13 i 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 b 1 a 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 a 3 0 1 where j x x j z z are the mass moment of inertia of the rigid body c 1 0 c 3 is the coordinate of mass center the first input end is located at the origin 0 0 0 and a 1 0 a 3 is the coordinate of the second input end and b 1 0 0 are the coordinates of the output end the transfer matrix of plane vibration beam considering axial and transverse vibration is as follows a8 u 1 cos β l 0 0 0 sin β l β e a 0 0 s λ l t λ l λ u λ l e i λ 2 0 v λ l e i λ 3 0 λ v λ l s λ l t λ l e i λ 0 u λ l e i λ 2 0 e i λ 2 u λ l e i λ v λ l s λ l 0 t λ l λ β e a sin β l 0 0 0 cos β l 0 0 e i λ 3 t λ l e i λ 2 u λ l λ v λ l 0 s λ l using transformation matrix to rotate the plane vibrating beam 90 the transformation matrix is a9 r 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 1 0 the transfer matrix of the transformed plane vibration beam is u 2 r t u 1 r the transfer matrix of the tie rod is a10 u 27 u 11 2 u 12 2 u 13 2 u 14 2 u 15 2 u 16 2 0 0 u 21 2 u 22 2 u 23 2 u 24 2 u 25 2 u 26 2 0 0 u 31 2 u 32 2 u 33 2 u 34 2 u 35 2 u 36 2 0 0 u 41 2 u 42 2 u 43 2 u 44 2 u 45 2 u 46 2 0 0 u 51 2 u 52 2 u 53 2 u 54 2 u 55 2 u 56 2 0 0 u 61 2 u 62 2 u 63 2 u 64 2 u 65 2 u 66 2 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 while the one of the driving rod is a11 u 29 1 0 0 0 0 0 0 0 0 cos β l 0 0 0 sin β l β e a 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 β e a sin β l 0 0 0 cos β l 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 and the one of the dummy rigid body are a12 u 8 i 1 u 12 i 1 u 14 i 1 u 18 i 1 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 a13 u 8 i 2 u 12 i 2 u 14 i 2 u 18 i 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 appendix b the geometric matrix of the dummy body rigid body and the planar rigid body with two input ends and single output end is b1 h j i 1 4 8 z j i 1 8 1 h j i 2 4 8 z j i 2 8 1 where h j i 1 h j i 2 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 and j is element number herein b2 h 8 i 1 h 8 i 2 h 12 i 1 h 12 i 2 h 14 i 1 h 14 i 2 h 18 i 1 h 18 i 2 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 b3 h 13 i 1 1 0 0 0 0 0 0 0 0 1 a 1 0 0 0 a 3 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 a n d h 13 i 2 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 
21468,transfer matrix method for multibody systems mstmm has high precision and it is easy to formulate systematic to apply simple to code and the matrices are low order which contributes to higher computational efficiency than ordinary dynamics methods it is applied widely in the field of engineering and the significant effects gained based on the mstmm advantages the linear and nonlinear hydroelastic models of a full scale sail mounted hydroplanes system using rigid flexible coupling multibody system coupled with a theodorsen fluid theory are presented in this paper the model is validated using data available from literature and simulation results from commercial software this work provides an engineering reference for an efficient linear and nonlinear fluid structure interaction fsi modeling and simulation of other rigid flexible coupling multibody system keywords hydroelastic modeling transfer matrix method multibody systems theodorsen s method fluid structure interaction 1 introduction fluid structure interaction fsi problems are among the most challenging one in computational mechanics fsi computations often require costly numerical simulations including cpu computing power memory and storage moreover the simulation can take very long time and the current fsi numerical simulation methods are not fully mature to include all complex fluid structure interactions practitioners are often faced with the difficulty of performing high fidelity computations of fsi problems and are unable to generate simulation results when calculating fsi problems including high degree of structure or fluid nonlinearity yan et al 2016 owen et al 2018 dongyang et al 2017 and eventually have to resource to low cost simulations due to the requirement of fast computation and analysis it is of great significance to establish efficient mathematical model capable of addressing fsi engineering problems in the field of aerospace and ocean engineering speed and maneuverability of surface and underwater s vehicles are increasing with increasing speed flow induced vibration can lead to kinematic and hydroelastic acoustic instabilities divergence flutter and limit cycle oscillations lco hoseini and hodges 2019 al mashhadani et al 2017 xie et al 2019 akhavan and ribeiro 2019 li et al 2017 2018 harwood et al 2020 hence fsi analysis should be performed during the design process the purpose of this paper is to take a rigid flexible coupling multibody system that is a sail mounted hydroplanes system of an underwater vehicle and introduce an efficient modeling method to perform linear and nonlinear hydroelastic simulations as integral part of the modeling effort the accurate vibration characteristics of the rigid flexible coupling multibody system represented by the natural frequencies and modes should be assessed firstly william 1992 there are many methods to solve the dynamics of multibody system finite element method fem and boundary element method bem are two widely used and there exist of the shelf powerful tool for solving the dynamic problems of complex structures nastran ansys abaqus and adina just to name but a few wang and ye 2016 çelik and duman 2017 in the study of complex system dynamics the following issues need to be considered 1 it is necessary to establish the overall dynamic equation of the system and identify their solution methodology if the topology of the structure changes the overall dynamic equation must be modified accordingly 2 the matrix of a complex system is high order greater than the number of system degrees of freedom and as a result the computation speed slows down rapidly with the increase of system dimensions 3 with the increase of systems complexity the total matrix of the full system should not be ill conditioned wang et al 2019a 2019b the transfer matrix method for multibody systems mstmm is a highly accurate easy to formulate systematic to apply and simple to code method the method does not need the explicit form of the global dynamic equations of the system rui et al 2016 2018 2019a rui et al 2020 and elegantly model systems which can include both discrete and continuous elements by transforming differential equations to algebraic equations all system information is summarized in an overall system of linear equations which are independent of the degrees of freedom bestle et al 2014 the method can be used to calculate the vibration characteristics and dynamic responses of the multibody systems and since the matrices involved are low order the computational efficiency is relatively high when compared with ordinary dynamics methods chen et al 2016 miao et al 2019 abbas et al 2013 2017 bestle et al 2014 he et al 2012 large systems made by many subsystems and rigid flexible structures can be modeled efficiently by mstmm as a result in recent years it is being more widely applied in a number of engineering fields a full scale hydroplanes system was modeled by mstmm and a comparison with the fem solution in ansys workbench was provided in chen et al 2017 2018 the modal analysis results of the two methods were in good agreement in dongyang et al 2017 the system was simplified as a two dimensional 2d hydrofoil model and the influence of the structure parameters such as center of gravity position and elastic axis position on the hydroelasticity of the 2d hydrofoil was studied some guiding conclusions on the structural design of the hydroplanes system were offered however it should be noted that the full three dimensional system was simplified to a two dimensional one and some structure details were not considered researchers usually deal the full hydroplane system as one hydroplane plus a torsional spring and simplify the control system as a torsional spring this approach however cannot consider the influence of the structure parameters such as mass bending stiffness torsion stiffness of each component and the presence of free play nonlinearity which is due to long term use and wear between components on the dynamic response of the full scale hydroplanes system given the mstmm advantages in the present work the full scale three dimensional 3d system is described by the mstmm coupled with theodorsen s unsteady fluid dynamic model and the linear flutter and nonlinear time domain response of the full scale hydroplanes system with free play are presented along with a more detailed representation of the dynamic model 2 problem definition fig 1 a shows the underwater vehicle sail mounted hydroplanes which are used for pitching and to control its depth the graphical representation of the typical sail mounted hydroplanes system of submarine is shown in fig 1 b it is a complex multi rigid flexible body system this system includes 1 hydroplanes 2 tiller 3 shaft 4 tie rod 5 guiding device 6 driving rod 7 sealing device 8 steering engine a piston and spring b ball joint c column hinge and d double bearing the hydroplane skin has distributed holes so that water can come in during underwater operations the equivalent stiffness of the hydraulic pressure of the steering engine is tested experimentally and is replaced by a translational spring during structural modeling the boundary conditions of the bearing guiding device sealing device and steering engine are fixed supports since are fixed on the submarine s hull which is considered a large rigid body the ball joint allows the up and down movement of the tie and guiding rod to drive the tiller to rotate and the tiller and shaft are fixed together as to drive the shaft to rotate a positioning ring device is installed between the two ends of the bearing and the hydroplanes to ensure that the shaft cannot move side by side when the underwater vehicle moves at a certain speed in the ocean environment the two hydroplanes of the system might undergo fsi vibration under the action of a fluid current the structural parameters of each component of the full scale hydroplanes system and the nonlinear free play between components may have an impact on the natural vibration characteristics and dynamic response of the full system the aim of this work is to establish an efficient model which can be used to study the linear and nonlinear hydroelastic problems of a rigid flexible coupling multibody system and to provide reference for the rapid modeling and simulation of similar fsi engineering problems 3 mathematical model 3 1 fundamental theory of mstmm the mstmm theorem and strategy in the context of free vibration characteristics are explained in chen et al 2017 while the equations of motion for a body element and overall system is introduced in rui et al 2018 the equations of motion of the complete system can be easily obtained by orderly arranging the equation of motion of the individual bodies that is 1 m v t t k v f where m and k are the augmented operators of the multibody system v is a column matrix of displacement v t t is the second order derivative of v with respect to time t and f is the force respectively the augmented eigenvector of the multibody system is written as v k k 1 2 3 the superscript k denotes the modal order let 2 v k 1 n v k q k where q k is the generalized coordinate substituting eq 2 into eq 1 3 k 1 n m v k q k t k 1 n k v k q k t f 4 m v k v p δ k p m p k v k v p δ k p k p taking the inner product in the both sides of eq 3 with v p p 1 2 3 and using the orthogonality for multibody system of eq 4 then the generalized coordinate equations of the system can be obtained from eq 3 as 5 q p t ω p 2 q p t f v p m p assuming that the initial conditions of the multibody system are 6 v t t 0 v 0 v t t t 0 v the nature frequency ω p and the mode shapes v p p 1 2 3 can be determined from the modal analysis based on mstmm rui et al 2018 the dynamic response of the system can be acquired from the simulation results of eq 5 it should be noted that eq 5 is suitable for the dynamics which decoupled if the dynamic system is not decoupled with v v 1 v 2 v 3 v n the system has n orders mode shapes such that 7 v v q where q q 1 q 2 q n t q being the generalized coordinate matrix substituting eq 7 into eq 1 8 m v q k v q f the orthogonality for multibody system in mstmm is already proved thus 9 v t m v q v t k v q v t f 10 m q k q v t f where 11 m v t m v k v t k v here m and k are the modal mass and stiffness matrices respectively 3 2 dynamic modeling and vibration characteristics of the hydroplanes system the corresponding mstmm topology of the more detailed system is depicted in fig 2 it should be noted that the following assumptions are made for the modeling of the hydroplanes system of the underwater vehicle 1 the boundary conditions of the bearing guiding device sealing device and steering engine are fixed supports 2 the water inside the hydroplane is assumed to be additional mass 3 ignoring the structural damping of the hydroplanes system only the hydrodynamic damping caused by the hydroplane system vibration is considered 4 the strain of hydroplane are quite small and the stress strain relationship is linear 5 only the first several mode shapes of the hydroplanes system are used for the fsi simulation higher modes are discarded the higher modes include the local modes of the hydroplanes skin and are not considered in fig 2 the hydroplane is treated as a 7 segment bending torsion coupling beam elements 1 7 19 25 with different structural parameters considering axial direction vibration the column hinge element 26 is treated as a hinge element the shafts elements 10 and 16 are treated as uncoupled beams which can consider transverse axial and torsional directions vibrations the contact stiffness between the bearing and the bearing sleeve and the contact stiffness between the locating ring and the hydroplanes are represented by spring hinges elements 9 11 15 17 the tie rod is treated as an uncoupled beam element 27 which can consider the x axis and axial directions vibration the driving rod can only move up and down in the sealing device so it is treated as a rod element element 29 the tiller is treated as a rigid body element 13 the steering engine is treated as a spring hinge element 30 this dynamic model is a tree system with more than two branches which can be easily handled by mstmm the system is comprised of 30 elements with 7 boundaries z 1 z 27 z 28 z 29 z 30 z 36 the tips and z 26 the root the system state vectors svs are given as z i x y θ z m z q y θ x m x i t i 1 30 where the small displacement small angle are x y θ x θ z or kinetics and the forces moments are q x q y m x m z respectively according to the definition of the topological structure of the system by mstmm rui et al 2018 the transfer equations te of the entire system are derived to simplify the mstmm and following the chain topology the te of the left and right hydroplanes are written in condensed form as follows 12 z 26 u 25 u 24 u 23 u 22 u 21 u 20 u 19 z 19 u pla r z 19 z 8 u 7 u 6 u 5 u 4 u 3 u 2 u 1 z 1 u pla l z 1 following all transfer directions represented in fig 2 the main te can be obtained as 13 z 26 u pla r z 19 u pla r u 18 i 1 z 17 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 z 16 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 z 14 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 z 13 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 z 11 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 z 10 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 u 18 i 2 u 17 z 30 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 z 27 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 2 u 11 z 28 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u pla r u 18 i 1 u 16 u 14 i 2 u 15 z 29 u pla r u 18 i 2 u 17 z 30 or 14 z 26 t 1 z 1 t 2 z 27 t 3 z 28 t 4 z 36 t 5 z 29 t 6 z 30 where 15 t 1 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l t 2 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 t 3 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 2 u 11 t 4 u pla r u 18 i 1 u 16 u 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 t 5 u pla r u 18 i 1 u 16 u 14 i 2 u 15 t 6 u pla r u 18 i 2 u 17 the transfer matrices of bending torsion coupled beams with axial direction vibration u 1 u 2 u 3 u 4 u 5 u 6 u 7 u 19 u 20 u 21 u 22 u 23 u 24 u 25 spring hinge u 11 u 15 u 30 u 9 u 17 column hinge u 26 ball joint u 28 planar rigid body u 13 i 1 u 13 i 2 driving rod u 29 tie rod u 27 and dummy rigid body u 8 i 1 u 12 i 1 u 14 i 1 u 18 i 1 u 8 i 2 u 12 i 2 u 14 i 2 u 18 i 2 are shown in appendix a for elements 8 12 13 14 and 18 the geometry equations ges are obtained by eq 16 through 20 16 h 8 i 1 z 8 h 8 i 2 z 9 0 h 8 i 1 u p l a l z 1 h 8 i 2 u 9 z 27 0 17 h 12 i 1 z 11 h 12 i 2 z 12 0 h 12 i 1 u 10 z 10 h 12 i 2 u 11 z 28 0 h 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 h 12 i 2 u 11 z 28 0 h 12 i 1 u 10 u 8 i 1 u pla l z 1 h 12 i 1 u 10 u 8 i 2 u 9 z 27 h 12 i 2 u 11 z 28 0 18 h 13 i 1 z 13 h 13 i 2 z 31 0 h 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 u 12 i 2 u 11 z 28 h 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 0 h 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 h 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 z 27 h 13 i 1 u 12 i 2 u 11 z 28 h 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 0 19 h 14 i 1 z 14 h 14 i 2 z 15 0 h 14 i 1 u 13 i 1 z 13 u 13 i 2 z 31 h 14 i 2 u 15 z 29 0 h 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 h 14 i 2 u 15 z 29 0 h 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 h 14 i 1 u 13 i 1 u 10 u 8 i 2 u 9 z 27 h 14 i 1 u 13 i 1 u 12 i 2 u 11 z 28 h 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 h 14 i 2 u 15 z 29 0 20 h 18 i 1 z 17 h 18 i 2 z 18 0 h 18 i 1 u 16 z 16 h 18 i 2 u 17 z 30 0 h 18 i 1 u 16 u 14 i 1 z 14 u 14 i 2 u 15 z 29 h 18 i 2 u 17 z 30 0 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 u 8 i 2 u 9 z 27 u 12 i 2 u 11 z 28 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 u 14 i 2 u 15 z 29 h 18 i 2 u 17 z 30 0 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l z 1 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 z 27 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 2 u 11 z 28 h 18 i 1 u 16 u 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 z 36 h 18 i 1 u 16 u 14 i 2 u 15 z 29 h 18 i 2 u 17 z 30 0 equation 16 through 20 can be written as 21 g 1 z 1 g 2 z 27 0 22 g 3 z 1 g 4 z 27 g 5 z 28 0 23 g 6 z 1 g 7 z 27 g 8 z 28 g 9 z 36 0 24 g 10 z 1 g 11 z 27 g 12 z 28 g 13 z 36 g 14 z 29 0 25 g 15 z 1 g 16 z 27 g 17 z 28 g 18 z 36 g 19 z 29 g 20 z 30 0 where 26 g 1 h 8 i 1 u p l a l g 2 h 8 i 2 u 9 g 3 h 12 i 1 u 10 u 8 i 1 u pla l g 4 h 12 i 1 u 10 u 8 i 2 u 9 g 5 h 12 i 2 u 11 g 6 h 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l g 7 h 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 g 8 h 13 i 1 u 12 i 2 u 11 g 9 h 13 i 2 u 26 u 27 u 28 u 29 u 30 g 10 h 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l g 11 h 14 i 1 u 13 i 1 u 10 u 8 i 2 u 9 g 12 h 14 i 1 u 13 i 1 u 12 i 2 u 11 g 13 h 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 g 14 h 14 i 2 u 15 g 15 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 1 u pla l g 16 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 1 u 10 u 8 i 2 u 9 g 17 h 18 i 1 u 16 u 14 i 1 u 13 i 1 u 12 i 2 u 11 g 18 h 18 i 1 u 16 u 14 i 1 u 13 i 2 u 26 u 27 u 28 u 29 u 30 g 19 h 18 i 1 u 16 u 14 i 2 u 15 g 20 h 18 i 2 u 17 in eq 16 through 20 h 8 i 1 h 8 i 2 h 12 i 1 h 12 i 2 h 14 i 1 h 14 i 2 h 18 i 1 h 18 i 2 h 13 i 1 and h 13 i 2 are the geometric matrices of the dummy rigid body and planar rigid body with two input end single output end presented in appendix b finally by combining eq 14 through 26 the overall te of the entire system shown in fig 2 can be written as 27 u all 28 56 z all 56 1 0 where 28 u all t 1 8 8 t 2 8 8 t 3 8 8 t 4 8 8 t 5 8 8 t 6 8 8 i 8 8 g 1 4 8 g 2 4 8 o 4 8 o 4 8 o 4 8 o 4 8 o 4 8 g 3 4 8 g 4 4 8 g 5 4 8 o 4 8 o 4 8 o 4 8 o 4 8 g 6 4 8 g 7 4 8 g 8 4 8 g 9 4 8 o 4 8 o 4 8 o 4 8 g 10 4 8 g 11 4 8 g 12 4 8 g 13 4 8 g 14 4 8 o 4 8 o 4 8 g 15 4 8 g 16 4 8 g 17 4 8 g 18 4 8 g 19 4 8 g 20 4 8 o 4 8 z a l l t z 1 t z 27 t z 28 t z 36 t z 29 t z 30 t z 26 t t herein i 8 8 is a 8 8 identity matrix it should be noted that this overall te involves only the boundary svs whereas svs of internal connection points are eliminated the boundary conditions are 29 z 1 x y θ z 0 0 0 θ x 0 t z 27 0 0 0 m z q x q y θ x 0 t z 28 x 0 θ z 0 0 q y θ x 0 t z 36 0 0 0 m z q x q y 0 m x t z 29 x 0 θ z 0 0 q y θ x 0 t z 30 0 0 0 m z q x q y θ x 0 t z 26 x y θ z 0 0 0 θ x 0 t applying the boundary conditions reported in fig 2 eq 27 reduces to u a l l 28 28 ω z a l l 28 1 0 the eigenvalue search on the 28 28 matrix u a l l is performed using method on search interval bestle et al 2014 ω 1 500 rad sec with grid size n x 0 5000 and tolerance ε 10 10 once the required band of the natural frequencies ω of the full scale hydroplanes system is determined the related mode shapes v can be generated by singular value decomposition svd chen et al 2017 abbas et al 2015 then the dynamic equations 1 10 can then be solved to obtain the dynamic responses of the hydroplanes system 3 3 linear and nonlinear hydroelastic modeling of the full scale hydroplanes system theodorsen s theory represents the lift and pitching moment for an airfoil hydrofoil undergoing small harmonic oscillations in incompressible flow according to theodorsen s theory and assume the structure is harmonic vibrations the hydro loads of this problem can be written as mccormick and luca 2004 30 l π ρ b 2 h u α b a α 2 π ρ u b c k u α h b 1 2 a α 31 t α π ρ b 2 b a h u b 1 2 a α b 2 1 8 a 2 α 2 π ρ u b 2 a 1 2 c k v α h b 1 2 a α where l and t α are the hydrodynamic lift and moment per unit span of the two hydroplanes respectively in eqs 30 and 31 ρ u b and π denote the fluid density velocity semi chord and lift curve slope of each section of the hydroplane respectively in addition h and α are the displacement along y axis positive up and the rotational displacement θ about x axis positive nose up of the hydroplane respectively furthermore a is the non dimensional distances as a fraction of b from the elastic axis to the mid chord position theodorsen s function c k is a complex valued transfer function which depends on the reduced frequency k ω b u where ω represents the circular frequency of the hydroplanes system motion the time domain hydrodynamic model is based on the theodorsen s theory and wagner s function φ ω the lift l and pitching moment t α are expressed as dongyang et al 2017 chen et al 2018 fung 1995 32 l π ρ b 2 h u α b a α 2 π ρ u b q 3 4 0 φ ω τ ˆ 0 τ ˆ d q 3 4 σ d σ φ ω τ ˆ σ d σ 33 t α π ρ b 2 b a h u b 1 2 a α b 2 1 8 a 2 α 2 π ρ u b 2 a 1 2 q 3 4 0 φ ω τ ˆ 0 τ ˆ d q 3 4 σ d σ φ ω τ ˆ σ d σ where 34 q 3 4 τ ˆ u α h b 1 2 a α φ ω τ ˆ 1 a a e b 1 τ ˆ a b e b 2 τ ˆ τ ˆ u t b a a 0 165 a b 0 335 b 1 0 0455 b 2 0 3 a linear frequency domain flutter model of the full system the equations of motion of the overall system are shown in eq 1 let 35 v v s e i ω t then 36 f l t α t b v b v s e i ω t h y h s e i ω t α θ α s e i ω t l π ρ b 2 ω 2 h s i ω u α s ω 2 b a α s 2 π ρ u b c k u α s i ω h s i ω b 1 2 a α s e i ω t t α π ρ b 2 b a ω 2 h s i ω u b 1 2 a α s ω 2 b 2 1 8 a 2 α s 2 π ρ u b 2 a 1 2 c k u α s i ω h s i ω b 1 2 a α s e i ω t substituting eq 35 into eq 1 37 ω 2 m v s k v s b v s mstmm is qualified to compute the mode shapes v the right side of eq 37 may not be decoupled let v v 1 v 2 v 3 v n and 38 v s v q substituting eq 38 into eq 37 39 ω 2 m v q k v q b v q in the view of orthogonality in mstmm 40 ω 2 v t m v q v t k v q v t b v q according to u g velocity artificial structure damping method dongyang et al 2017 mccormick and luca 2004 the dissipative damping force of the structure can be cast as 41 d d s e i ω t i g k v s e i ω t where g is the artificial damping which is added to the right side of eq 37 as 42 1 i g ω 2 k q v t b ω 2 v m q where 43 m v t m v k v t k v the linear flutter speed calculation process is converted to that of a complex eigenvalue problem and its eigenvalue is 44 λ 1 i g ω 2 λ re i λ im thus 45 ω 1 λ re g λ im λ re u b k λ re where k ω b u at the critical flutter speed u f l u t t e r the oscillations are neutrally stable and g 0 b nonlinear time domain flutter model of the complete system free play nonlinearity may occurred in the actuator steering engine or the links of the mechanism or support mechanism of hydroplanes system due to friction by long term working conditions it may induce limit cycle oscillations lco phenomenon abbas et al 2008 li et al 2012 shin et al 2007 and although it will not lead to structure catastrophic failure it could significantly contribute to increase the noise signature and reduced the concealment of an underwater vehicle the time domain model of the full scale hydroplanes system is also established based on mstmm the right side of eq 1 includes the hydrodynamic loads which are not decoupled thus let v v 1 v 2 v 3 v n the hydroplanes system have n orders mode shapes which are obtained based on mstmm using eqs 1 7 32 and 33 46 m q c q k q v t f v q v q v q f n o n l i n e a r herein 47 m v t m v c v t c v k v t k v where c k 1 m k 2 k k 1 and k 2 are proportional damping coefficients for sake of simplicity knowing that will lead to conservative results it will be assumed an undamped system that is c 0 the nonlinear model with initial free play nonlinearity are considered in up and down h s and torsion α s directions respectively as shown in fig 3 according to the characteristics of this hydroplanes system normally only the h s need to be considered the nonlinear function f n o n l i n e a r is the matrix includes the restoring force and moment one element in f n o n l i n e a r matrix can be written as follows bartels 2008 48 f n o n l i n e a r f h k h h s h h s k h h h s h h s k h h s h h s f α k α α s α α s k α α α s α α s k α α s α α s the linear and the torsional spring stiffnesses column hinge or ball joint in the dynamic model fig 3 are represented by k h and k α respectively the hydrodynamics model is an integral differential equation there is an integral term in eqs 32 and 33 hence the direct numerical integration is very cumbersome thus the new state variation is introduced as follows 49 ω 1 0 t e b 1 u b t σ α σ d σ ω 2 0 t e b 2 u b t σ α σ d σ ω 3 0 t e b 1 u b t σ h σ d σ ω 4 0 t e b 2 u b t σ h σ d σ the physical coordinates in f are transformed into modal coordinates and moved to the left side of the eq 46 the time dependent function f t remain on the right side of the eq 46 and new mass matrix m n e w stiffness matrix k n e w and damping matrix d n e w are derived equation 49 is used to extend eqs 32 and 33 and to remove the integral terms the integrals derivative formulae are written as follows 50 f y x 1 y x 2 y f x y d x d f y d y x 1 y x 2 y f y x y d x f x 2 y y d x 2 y d y f x 1 y y d x 1 y d y and using eqs 49 and 50 one can cast the equation as 51 m n e w q d n e w q k n e w q g ω v t f t f n o n l i n e a r where 52 γ i t ω 1 t ω 2 t ω 3 t ω 4 t γ i t ω 1 t ω 2 t ω 3 t ω 4 t t t ω t e ω ω t e q v q t 53 e ω e ω 0 0 0 o 0 0 0 e ω e q e q 0 0 0 o 0 0 0 e q 54 e ω b 1 0 0 0 0 b 2 0 0 0 0 b 1 0 0 0 0 b 2 e q 0 1 0 1 1 0 1 0 and g is a coefficient matrix in state space form the nonlinear hydroelastic equations of the full scale hydroplanes system with free play are as follows 55 q t q t ω t 0 i 0 m n e w 1 k n e w m n e w 1 d n e w m n e w 1 g e q v 0 e ω q t q t ω t 0 m n e w 1 v t f t f n o n l i n e a r 0 the dynamic responses of the hydroplanes system are simulated using modal superposition equation 55 can be solved by ordinary differential equations ode 45 time marching scheme small angle of attack α of the hydroplane is selected as the initial condition other variables all are set to 0 in addition the selected time step is 0 001s which is decided by t reference length u 10 to 100 4 model validation 4 1 linear flutter speed calculation of goland wing validation is conducted using the goland wing beran et al 2004 which structural parameters are given in beran et al 2004 the natural circular frequencies depicted in fig 4 a and the associated mode shapes in fig 4 b of the 3d goland wing are calculated by mstmm first the first mode is mainly bending and the second mode is mainly torsion equation 45 is used to calculate the flutter boundary of the cantilevered 3d goland wing and the simulation results are illustrated in fig 5 a and b it should be noted that a quasi steady aerodynamic formulation obtained with c k 1 in eqs 30 and 31 is used throughout this example it is shown that the flutter speed of goland wing is 55 65 m s 182 ft s which is very close to the simulation result 180 ft s in beran et al 2004 the flutter frequency for the goland wing is 3 68 hz which agree well with the published data for this wing given the very good agreement with the model in beran et al 2004 the accuracy of the 3d mstmm theodorsen linear flutter model is verified 4 2 time simulation of a flat plate the commercial software nastran is used to calculate the flutter speed of a cantilevered 3d flat plate nastran 2004 flightloads 2006 the modal analysis is carried out by commercial software nastran for verification firstly the flat plate is meshed by 200 quad elements edge length 0 025 m the right side of the flat plate is a fixed support the nastran simulation results are in good agreement with flightloads 2006 as shown in table 1 then in nastran flutter analysis module an aerodynamic model using a doublet lattice method dlm is constructed for aeroelastic analysis aerodynamic surface is divided into 200 aero boxed structural and aerodynamic models are connected by using the finite plate splines fps method the flutter speed u 53 m s and flutter frequency ω 11 3 hz are obtained by nastran and are illustrated in fig 6 the results are in good agreement with flightloads 2006 using the method of chen et al 2017 parameters such as the position of elastic axis the distribution of bending stiffness and torsion stiffness of the flat plate are computed then running mstmm free vibration code based on these parameters the first two circular frequencies are determined see fig 7 a the comparison of predictions by mstmm fem by nastran and flightloads 2006 is tabulated in table 2 good agreement has been achieved as well as the mode shapes comparison between mstmm and nastran see fig 7 b it should be noted that the natural vibration modes calculated by nastran software are the modes after mass normalization in order to compare with the fem nastran results the mass normalization of the natural vibration mode calculated by mstmm is carried out the purpose of normalization is to unify the evaluation results on different scales into one scale so that they can be compared the process of mass normalization is to normalize the mass matrix m to be unit matrix i it is assumed that the mode shape before mass normalization is v o and after mass normalization is v such that v o t m v o m d where m d is the mass matrix after modal transformation the mass matrix m is normalized to unity by pre and post multiplication by v that is v t m v i therefore the mode shapes after mass normalization are v v o v o t m v o the linear time domain hydroelastic model obtained by removing the nonlinear terms from the nonlinear time domain flutter model is used to calculate the dynamic response of the flat plate fig 8 shows that the responses of the generalized coordinates q1 q2 and its derivatives d q1 d q2 tends to converge when the inflow speed is 40 m s while the responses tends to diverge when the inflow speed is 55 m s for an inflow speed of 51 m s the responses continuously oscillate with equal amplitude i e linear flutter occurs compared with the fem nastran results the difference between the two methods is about 3 8 and the error is quite small which verifies the accuracy of linear time domain simulation based on the proposed mstmm model on the basis of the presented flat plate model the influence of the free play on the flutter characteristics of the flat plate is further analyzed a torsional spring k α 1000 n m r a d is added to the left end of the plate and the left end of the torsional spring is fixed constraint the first two circular frequencies of the flat plate with torsional spring are determined by mstmm this is illustrated in fig 9 once the natural frequencies and modes are determined the nonlinear time domain flutter analysis based on mstmm including the fluid dynamic model of theodorsen can be carried out to compute the dynamic responses of the flat plate with a torsional spring and free play in torsion the displacement and rotation angle displacement time histories and the phase diagrams of the flat plate torsional spring system are depicted in fig 10 it is noted that the right end of the plat plate is determined as the monitor point for a free play of 0 rad with inflow speed equal to 15 20 and 25 m s the dynamic response converges the convergence rate slows down with the increase of the inflow speed when the inflow speed is 26 98 m s equal amplitude oscillation occurs this is the onset of flutter if the critical velocity is exceeded the response will diverge which will lead to the system s structural damage nonlinear simulations are performed to determine the dynamic response of the flat plate torsional spring system when the free play is 0 001 rad as shown in fig 11 when the inflow speed is 15 m s the response converges while at 20 m s and 25 m s limit cycle oscillations lco occur furthermore fig 11 b and c show that when the velocity increases the lco amplitudes increases it is well known that limit cycle vibration in this case associated with the plate spring system and caused by the free play does not lead to the sudden catastrophic structural damage and failure of the system but it will lead to fatigue damage indeed when the inflow velocity is 26 98 m s that is the critical flutter velocity of the linear model is reached the response of the nonlinear system including the free play is diverging which will cause structural damage this is consistent with the bulk of literature studying the aeroelastic behavior of aircraft where it is concluded that in presence of free play lco often occurs below the linear flutter critical speed abbas et al 2008 tang et al 2003 candon et al 2019 tang and dowell 2006 this is in accordance with the simulations result presented here providing further validation to this proposed model 5 numerical results and discussion the modal analysis of this underwater sail mounted hydroplanes system is carried out by fem with the commercial software ansys chen et al 2017 the fe mesh was created in ansys workbench shell 181 solid186 and solid187 elements are selected to model the system the boundary conditions of the bearing guiding device sealing device and steering engine are fixed supports bonded contact option is used for the connection between the shaft two hydroplanes and the shaft tiller no separation contact option is used for the connection between all other parts on the other hand in the process of modeling and computing the more detailed hydroplane system using mstmm very large contact stiffness between the components of the system and very small torsional stiffness of the joints are used the contact stiffness is assumed to be 1e10 n m and the torsional stiffness is assumed to be 1 n m r a d that is k x k y 1e10 n m and k x k z 1 n m r a d respectively the mstmm solution of the characteristic equation provides the circular frequency of the hydroplanes system hydraulic spring stiffness of the steering engine is k h 4 10 8 n m as shown in fig 12 mode shape and natural frequency of the hydroplanes system based on mstmm are shown in table 3 in order to describe the mode shape the mode shape display of the system is divided into two parts hydroplane shaft tiller shaft hydroplane and piston spring driving rod ball joint tie rod column hinge moreover the vibration modes are shown in x y and θ x directions respectively the mstmm results are very close to the fem ansys results mode shapes are reported in chen et al 2017 providing further validation to the proposed model it should be noted that the mstmm model from chen et al 2017 has no x direction vibration and no element to describe the bearing moreover the shaft is only allows torsion motion which is not real in engineering the spring stiffness values in x direction of element 9 and 17 in this paper s mstmm model are 1 e10 n m they are so large values that lead to the x direction mode shape s value all are 0 moreover consider more details in the model to make the model more robust and can be did more research in the future based on this model ansys computation of the hydroplanes system modes takes about 28 5 min using single core cpu computer while the mstmm computation only takes about 0 35 min with great computational cost saving the simulation results show that the first four modes of the hydroplanes system have no vibration in x direction it shows symmetric modes 1 and 3 and anti symmetric modes 2 and 4 modes in y and θ x directions the latter one are local modes that is modes 2 and 4 are contributing to the local behavior of the structure only hydroplane shaft tiller shaft hydroplane have modes while piston spring driving rod ball joint tie rod column hinge no modes values and do not participate to the global dynamics which is the problem being assessed in this paper for the structural dynamic behavior and response analysis the influence of these local modes can be safely neglected the linear flutter simulation of the entire system is performed using the structure parameters from chen et al 2017 the flutter u g and u f curves are presented in fig 13 which show that for an investigated range of u 0 20 m s there is no flutter occurrence the dynamic responses of the full scale hydroplanes system without free play are simulated using the same structure parameters fig 14 depicts time histories and phase portraits and show that the responses tends to converge when the speed is within u 1 to 20 m s and the larger the inflow velocity is the faster the dynamic response converges it can be concluded that when the structural parameters of this hydroplanes system are used the linear flutter phenomenon will not occur it is also possible to illustrate that by weakening some of the structural parameters of the hydroplanes system linear flutter may occur the dynamic responses of the hydroplanes system with free play between the components are calculated when the inflow velocity is 1 20 m s the free play between the column hinge ball joint and steering engine all are 0 001 m it can be seen from fig 15 that the greater the inflow speed is the faster the response convergence is and the response convergence tends to a stable value that is the static deformation of the hydroplanes system caused by the free play between the components of the system in contrast when the complete system has no free play the static deformation values of the hydroplanes system all are 0 see fig 14 the response of the complete system converges very slowly and a sustained small amplitude vibration occurs only when the inflow velocity is low to further assess this the vibration response of the system is computed when the inflow velocity is 1 m s and selected free plays in the components are considered as expected the vibration response of the system consider the tip of the hydroplane as a monitor point with only bearing s free play is slightly larger than that without a free play this can be seen in fig 16 if the bearing s free play increase in magnitude three times the vibration response of the system remains almost unchanged thus the bearing s free play is not the main reason for the increase of fsi vibration amplitude with a ball joint s free play and or a steering engine s free play without bearing s free play both vibration amplitudes in y and torsional directions increase significantly see fig 17 in order to further verify the coupling relationship between bearing s free play and the ball joint s free play or steering engine s free play additional simulation results is provided in fig 18 when compared with the earlier results depicted in fig 17 one can see that the added bearing s free play does not have a significant contribution to the vibration response therefore the hydroplanes system is more likely to generate water noise at low speed and the free plays in the piston spring driving rod ball joint tie rod column hinge have a greater impact on the response of the system at low speed on the other hand the free play will lead to a static deformation of the system at a relatively large speed 6 conclusions the hydroplanes system s vibration characteristics and their fluid structure interaction response under uniform inflow conditions are studied it is shown that linear flutter will not occur for this specific hydroplanes system in the range of navigation speed however with a presence of a free play in the piston spring driving rod ball joint tie rod column hinge chain sustained vibration will occur which may induced water noise and some long term structural fatigue issues it is also evidenced that after the relative increase of the velocity the free play will lead to the static deformation of the hydroplanes system while a full set of design recommendations will be desirable the proposed work illustrates how linear flutter behavior and the nonlinear time domain response of a rigid flexible coupling multibody system can be efficiently predicted furthermore the proposed method can be adopted when performing fsi modeling and simulations of multibody system and as a reference in a number of engineering disciplines credit authorship contribution statement chen dongyang conceptualization funding acquisition formal analysis writing original draft i have made substantial contributions to the conception or design of the work or the acquisition analysis or interpretation of data for the work and i have drafted the work or revised it critically for important intellectual content and i have approved the final version to be published and i agree to be accountable for all aspects of the work in ensuring that questions related to the accuracy or integrity of any part of the work are appropriately investigated and resolved pier marzocca all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named if the manuscript does not include acknowledgments it is because the authors have not received substantial contributions from nonauthors wang jinlong all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named if the manuscript does not include acknowledgments it is because the authors have not received substantial contributions from nonauthors xiao qing all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named if the manuscript does not include acknowledgments it is because the authors have not received substantial contributions from nonauthors zhan zhihuan all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named if the manuscript does not include acknowledgments it is because the authors have not received substantial contributions from nonauthors ma lei all persons who have made substantial contribution declaration of competing interest the authors declare that they have no known competing interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research work is supported by the natural science foundation of jiangsu province of china gant no bk20190871 national natural science foundation of china gant no 11672261 the authors would like to dedicate the work to late professor laith k abbas of the nanjing university of science and technology nanjing njust appendix a the transfer matrix of bending torsion coupled beam d c b is derived in chen et al 2017 a1 d c b b 1 b 1 0 where b 0 1 0 1 0 1 0 0 α l 0 β l 0 γ l e i l 2 α 2 0 e i l 2 β 2 0 e i l 2 γ 2 0 0 e i l 3 α 3 0 e i l 3 β 3 0 e i l 3 γ 3 k α 0 k β 0 k γ 0 0 g j l k α α 0 g j l k β β 0 g j l k γ γ b 1 cosh α sinh α cos β sin β cos γ sin γ α sinh α l α cosh α l a 3 β sin β l β cos β l γ sin γ l γ cos γ l e i l 2 α 2 cosh α e i l 3 α 3 sinh α e i l 2 α 2 sinh α e i l 2 β 2 cos β e i l 2 β 2 sin β e i l 2 γ 2 cos γ e i l 2 γ 2 sin γ e i l 3 α 3 sinh α e i l 3 α 3 sinh α e i l 3 α 3 cosh α e i l 3 β 3 sin β e i l 3 β 3 cos β e i l 3 γ 3 sin γ e i l 3 γ 3 cos γ k α cosh α k α sinh α k β cos β k β sin β k γ cos γ k γ sin γ g j l k α α sinh α g j l k α α cosh α g j l k β β sin β g j l k β β cos β g j l k γ γ sin γ g j l k γ γ cos γ therefore the transfer matrix of bending torsion coupled beam with axial direction vibration according to mstmm is a2 u c b cos β l 0 0 0 sin β l β e a 0 0 0 0 d 11 c b d 12 c b d 13 c b 0 d 14 c b d 15 c b d 16 c b 0 d 21 c b d 22 c b d 23 c b 0 d 24 c b d 25 c b d 26 c b 0 d 31 c b d 32 c b d 33 c b 0 d 34 c b d 35 c b d 36 c b β e a sin β l 0 0 0 cos β l 0 0 0 0 d 41 c b d 42 c b d 43 c b 0 d 44 c b d 45 c b d 46 c b 0 d 51 c b d 52 c b d 53 c b 0 d 54 c b d 55 c b d 56 c b 0 d 61 c b d 62 c b d 63 c b 0 d 64 c b d 65 c b d 66 c b where β ρ ω 2 e l and a are the length and sectional area of each segment of the hydroplane thus a3 u 1 u 2 u 3 u 4 u 5 u 6 u 7 u 19 u 20 u 21 u 22 u 23 u 24 u 25 u c b the transfer matrices of spring hinge column hinge and ball joint are respectively a4 u 11 u 15 u 30 1 0 0 0 0 0 0 0 0 1 0 0 0 1 k y 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 u 9 u 17 1 0 0 0 1 k x 0 0 0 0 1 0 0 0 1 k y 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 a5 u 26 1 0 0 0 0 0 0 0 0 1 0 0 0 1 k y 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 1 k x 0 0 0 0 0 0 0 1 u 28 1 0 0 0 1 k x 0 0 0 0 1 0 0 0 1 k y 0 0 0 0 1 1 k z 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 1 k x 0 0 0 0 0 0 0 1 the transfer matrices of planar rigid body driving rod tie rod and dummy rigid body are respectively a6 u 13 i 1 1 0 0 0 0 0 0 0 0 1 b 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 m ω 2 b 1 c 1 m ω 2 b 1 c 1 ω 2 j z z 1 0 b 1 m ω 2 b 1 c 3 0 m ω 2 0 0 0 1 0 0 0 0 m ω 2 m ω 2 c 1 0 0 1 m ω 2 c 3 0 0 0 0 0 0 0 1 0 0 m ω 2 c 3 0 0 0 0 ω 2 j x x 1 a7 u 13 i 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 b 1 a 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 a 3 0 1 where j x x j z z are the mass moment of inertia of the rigid body c 1 0 c 3 is the coordinate of mass center the first input end is located at the origin 0 0 0 and a 1 0 a 3 is the coordinate of the second input end and b 1 0 0 are the coordinates of the output end the transfer matrix of plane vibration beam considering axial and transverse vibration is as follows a8 u 1 cos β l 0 0 0 sin β l β e a 0 0 s λ l t λ l λ u λ l e i λ 2 0 v λ l e i λ 3 0 λ v λ l s λ l t λ l e i λ 0 u λ l e i λ 2 0 e i λ 2 u λ l e i λ v λ l s λ l 0 t λ l λ β e a sin β l 0 0 0 cos β l 0 0 e i λ 3 t λ l e i λ 2 u λ l λ v λ l 0 s λ l using transformation matrix to rotate the plane vibrating beam 90 the transformation matrix is a9 r 0 1 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 0 0 0 1 0 0 0 0 1 0 the transfer matrix of the transformed plane vibration beam is u 2 r t u 1 r the transfer matrix of the tie rod is a10 u 27 u 11 2 u 12 2 u 13 2 u 14 2 u 15 2 u 16 2 0 0 u 21 2 u 22 2 u 23 2 u 24 2 u 25 2 u 26 2 0 0 u 31 2 u 32 2 u 33 2 u 34 2 u 35 2 u 36 2 0 0 u 41 2 u 42 2 u 43 2 u 44 2 u 45 2 u 46 2 0 0 u 51 2 u 52 2 u 53 2 u 54 2 u 55 2 u 56 2 0 0 u 61 2 u 62 2 u 63 2 u 64 2 u 65 2 u 66 2 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 while the one of the driving rod is a11 u 29 1 0 0 0 0 0 0 0 0 cos β l 0 0 0 sin β l β e a 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 β e a sin β l 0 0 0 cos β l 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 and the one of the dummy rigid body are a12 u 8 i 1 u 12 i 1 u 14 i 1 u 18 i 1 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 a13 u 8 i 2 u 12 i 2 u 14 i 2 u 18 i 2 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 appendix b the geometric matrix of the dummy body rigid body and the planar rigid body with two input ends and single output end is b1 h j i 1 4 8 z j i 1 8 1 h j i 2 4 8 z j i 2 8 1 where h j i 1 h j i 2 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 and j is element number herein b2 h 8 i 1 h 8 i 2 h 12 i 1 h 12 i 2 h 14 i 1 h 14 i 2 h 18 i 1 h 18 i 2 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 b3 h 13 i 1 1 0 0 0 0 0 0 0 0 1 a 1 0 0 0 a 3 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 a n d h 13 i 2 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 1 0 
21469,the numerical approximation of the three dimension translating pulsating 3dtp source green s function is the basis for solving the diffraction radiation problem of marine vessels with forward speed however the highly oscillation of the 3dtp source near the free surface makes the hydrodynamic results unstable the panel source green s function which means the analytical integral of the green s function over panels can ease the numerical instability problem in the present study an analytical expression of havelock form panel source green s function is proposed and the corresponding numerical integral method is presented a coordinate transformation is performed and the triangular panel is mapped into a unit rectangle the space integral is carried out beforehand by an analytical method and the determination of the control factor is elaborated thus the panel source green s function can be expressed as a θ type single integral lobatto rule is adopted to eliminate singularities caused by infinite discontinuity and a fraction polynomial is used to evaluate complex exponential integral therefore the integral respect to θ can be performed by an adaptive iterative integration finally the numerical results of present method is compared with other existing results it shows that the present analytical integral expression is accurate and reliable keywords translating pulsating source panel source havelock form forward speed 1 introduction seakeeping performance evaluation is a critical part in the design process of marine vehicles numerical simulation and experiments are two common ways compared to practical experiments numerical simulation is of high efficiency and relatively cheaper furthermore most numerical simulations of ship hydrodynamics are carried out with in the frame of potential flow theory and the boundary element method bem is adopted according to the difference of green s function used the bem is called the rankine panel method or free surface green s function method fgm in the fgm the free surface green s function has the advantage of an automatic fulfillment of the neumann kelvin linearization free surface condition and radiation conditions consequently no source or dipole is required to be distributed on the free surface which greatly reduces the number of panels and avoids numerical errors due to the truncation of boundaries for the hydrodynamic problems of marine vehicles with forward speed traditionally the numerical model is expressed linearly and formulated in the frequency domain correspondingly the three dimension translating pulsating 3dtp source green s function is used therefore the calculation of 3dtp source green s function with high precision and efficiency is the key to the hydrodynamic problems of ship with forward speed the 3dtp source green s function and its derivatives are complicated mathematical formulations which means the velocity potential of field point produced by the unit translating and pulsating source this green s function has been studied by many scholars over the past years it is in the 1940s that the first mathematical formulation of this green s function was derived by haskind 1946 based on it many other forms of this function such as bessho form bessho 1977 iwashita and ohkusu 1989 du et al 2000 michell form takagi 1992 miao et al 1995 and havelock form wakeling et al 1986 wu and eatock taylor 1987 rahman 1990 xu and dong 2011 have been derived moreover noblesse et al 1995 decomposed this green s function into a local non oscillatory component and a wave component based on it chen and wu 2001 presented the singular and highly oscillaory features of the wave component among the above forms of 3dtp source green s function the bessho form is considered the most suitable for numerical calculations because it is expressed in a single integral form and its integrands are all elementary functions moreover the steepest descent method is used to find numerically the integral path on which the integrands do not oscillate and rapidly approach zero however it is difficult to associate this expression with physical phenomenon by contrast the expression of havelock form has definite physical meaning the integrand consists of four direction wave patterns i e two translating parts and two pulsating parts liu and miao 1986 besides each pattern is divided into a local flow component and a wave component zong and huang 1991 therefore the velocity potential of translating parts and pulsating parts produced by the source can be quantified and the corresponding physical meaning can be revealed additionally the havelock form 3dtp source green s function is expressed in a single integral form which makes the numerical calculation much easier takagi 1992 thus more and more attention is being paid to this form of green s function after years of studies on 3dtp source green s function some rapid algorithms are established du and wu 1998 xu and dong 2011 hong et al 2013 and certain good numerical results of 3dtp source green s function and its derivatives are obtained even so 3dtp source green s function cannot be used directly in practical applications in view of its highly oscillating nature near the free surface it is the integral of 3dtp source over panels and waterline segments rather than itself that generates the diffraction and radiation flow fields numerical quadrature cannot give correct results for a panel and a collocation point close to the free surface guilbaud et al 2001 consequently when it comes to a complicated geometry such as a ship with large flares getting reasonable and stable numerical results by 3dtp source is very difficult in order to ease this numerical instability several techniques are often used such as modification of the geometry near the free surface or putting down the reference points with small distance below the free surface however these techniques rely entirely on experience and inevitably bring in errors nowadays the so called panel source or segment source green s function has attracted increasing attention which means the analytical integrations of 3dtp source green s function over panels or segments iwashita 1992 and maury 2001 proposed an analytical quadrature of bessho s single integral expression over a panel based on it yao and dong 2014 made a further numerical improvement the bessho form analytical integral expressions have been proved to be more accurate than the traditional numerical quadrature and are able to decrease the oscillations of the calculations ten et al 2018 derived an alternative formulation for the 3dtp source green s function suited to the integration over a smooth surface or a closed waterline based on this formulation chen et al 2018 solved the ship motion problem by a hybrid method with a meshless cylinder control surface however to the best of the authors knowledge few studies have been done on the analytical quadrature of havelock form expression over the panel so far only liang et al 2016 made a study on havelock form green s function distributing on a horizontal line segment it should be noted that iwashita 1990 shown an analytical integration of the havelock form 3dtp source green s function over a flat panel however his derivation is not rigorous considering the fact that the complex exponential integral and the control factor of the integrands is not continuous in space in the present study an analytical expression of havelock form panel source green s function is proposed the triangle is chosen as the integral panel in view of the fact that the triangular panel is one of the most versatile and simplest of panel in two dimensions to simplify the derivation of the integral expressions a coordinate transformation is performed and the triangular panel is mapped into a unit rectangle in ξ o η plane since the 3dtp source green s function is expressed as double integrals of θ and k the panel source green s function can be expressed as the integral of a double integral expression over the unit rectangle by changing the integral order the integral of the kernel function over the unit rectangle can be carried out beforehand by an analytical method thus the panel source green s functions can be expressed as double integrals of θ and k furthermore contour integration method is adopted to avoid numerical difficulty if there is singularity on the integral path of k then the integral respect to k can be expressed as the sum of the complex exponential integral and an elementary function thus the panel source green s function can be expressed as a θ type single integral given that this single integral expression is similar in form to the havelock form 3dtp source green s function we call it the havelock form translating pulsating panel source green s function to obtain the numerical results of the present analytical integral expression quickly and accurately a further numerical supplement is made to begin with singularities of the integrands are analyzed systematically k m and the terms related to k m in the integrands are assigned their limits at θ π 2 which will not result in numerical difficulties thus singularities related to k m at θ π 2 is eliminated after that variable substitution is performed and the singularity of the integrands at θ ν can be eliminated by the lobatto rule zong and huang 1991 in addition a fraction polynomial hess and smith 1962 is used to evaluate complex exponential integral with high precision and efficiency at last the integral respect to θ can be performed by an adaptive iterative integration based on simpson s rule davis and rabinowitz 2007 at the end of present work present analytical integral expression is applied to the integral calculation of the 3dtp source green s function and its partial derivatives over a vertical rectangular panel and a horizontal triangular panel for a field point located on the three different axes the excellent agreement with existing numerical results of maury and liang on the vertical rectangular panel and the results of line segment source indicates that the present analytical integral expression is accurate and practical in the integral calculation of the 3dtp source green s function with different brard numbers and froude numbers 2 havelock form translating pulsating panel source green s function 2 1 point source green s function we define the cartesian coordinate system x y z translating with constant velocity u 0 in the x direction the z axis is positive upward with the origin in the plane of the undisturbed free surface the green s function is defined as velocity potential g p q e i ω e t at the field point p x y z generated by the source point q x y z the free surface green s function g should satisfy the following equations 1 2 g x 2 2 g y 2 2 g z 2 δ p q i n z 0 i ω e u 0 x 2 g z g 0 o n z 0 lim z g 0 according to eq 1 point source green s function can be derived and expressed as follow 2 g g s p q g f p q g s 1 r 1 r r x x 2 y y 2 z z 2 r x x 2 y y 2 z z 2 g f g π n 1 2 0 ν d θ 0 d k f n θ k ν π 2 d θ 0 l 1 d k f n θ k π 2 π d θ 0 l 2 d k f n θ k f n θ k k e k p n q n u 0 2 cos 2 θ k k 1 k k 2 p n z i x cos θ 1 n y sin θ q n z i x cos θ 1 n y sin θ ν cos 1 1 4 τ i f 1 4 τ 1 0 i f 1 4 τ 1 τ u 0 ω e g the integral path l 1 and l 2 are shown in fig 1 where k 1 k 2 are zero points of the denominator of f n θ k 3 2 u 0 2 k m g 1 2 τ cos θ 1 m 1 4 τ cos θ cos 2 θ m 1 2 expressions for the derivatives of the froude dependent part g f is given by 4a g f g π n 1 2 0 π d θ 0 i cos θ 1 n 1 i sin θ 1 f n θ k d k 4b f n θ k k 2 e k p n q n u 0 2 cos 2 θ k k 1 k k 2 the typical spacial distribution of the real parts of g f and its x derivatives are shown in fig 2 for a source point at the 0 0 0 0 0 1 and the field point distributing in xoy plane it is indicated that g f and its derivative oscillate violently in space and the derivatives of g f has larger oscillation amplitude this makes it difficult to use numerical method to calculate the integral of g f and its derivatives over panel 2 2 panel source green s function considering the fact that the integral of g s is relatively simple present work only studies the analytic integral of g f over the panel and calls it panel source green s function the triangular panel is one of the most versatile and simplest of panel in two dimensions one can easily represent almost any geometry with triangular panels and without too much trouble furthermore mesh generators for triangular meshes are the most robust i e they tend not to make errors this is a tremendous advantage as a robust automatic mesh generator is essential in the solution of complex problems by boundary element method thus the triangle is chosen as the integral panel 2 2 1 coordinate transformations before deriving the analytical expression of panel source green s function a coordinate transformation is performed and the triangular panel is mapped into a unit rectangle in ξ o η plane as is shown in fig 3 λ 0 is the length of side 23 ab is a line parallel to side 23 q is a point on line ab the length of ab and aq are η λ 0 and ξ a b respectively thus point a b and q can be expressed by ξ η as follows 5 r a r 1 η r 2 r 1 r b r 1 η r 3 r 1 r q r 1 η r 2 r 1 ξ η r 3 r 2 where r l x l y l z l l 1 2 3 is the coordinate of node l of the triangle in the cartesian coordinate system r q x y z thus 0 η 1 0 ξ 1 the integral of function f x y z over triangular panel can be expressed as follows 6 s f t f x y z d s 0 1 0 1 f ξ η j ξ η d η d ξ where j ξ η is the jacobian determinant by simple calculation the jacobian determinant can be expressed as follows 7 j ξ η r q ξ r q η 2 η s 0 where s 0 is the area of the triangular panel thus eq 6 can be expressed as 8 s f t f x y z d s 2 s 0 0 1 η d η 0 1 f ξ η d ξ 2 2 2 analytical expression of havelock form panel source green s function substituting g f into eq 8 the panel source green s function can be expressed as 9 s g f t g f d s q 2 s 0 0 1 η d η 0 1 g f d ξ substituting eq 2 into eq 9 after changing the integral order and carrying on the spatial integral firstly the following expression of panel source green s function can be obtained 10a s g f g π n 1 2 0 π c n θ u 0 2 cos 2 θ d θ 10b c n θ 2 s 0 l d k 0 1 η d η 0 1 k e k p n q n k k 1 k k 2 d ξ similarly the derivatives of panel source green s function can be obtained 11a s g f g π n 1 2 0 π i cos θ 1 n 1 i sin θ 1 c n θ u 0 2 cos 2 θ d θ 11b c n θ 2 s 0 l d k 0 1 η d η 0 1 k 2 e k p n q n k k 1 k k 2 d ξ it can be seen from eqs 10 and 11 that the derivation of analytical expression of the panel source green s function and its derivatives lies on of the calculation of the kernel function c n θ and c n θ moreover only q n in the integrand is the function of ξ and η thus we need to figure out the partial derivatives of q n ξ η with respect to ξ and η from eq 2 q n can be expressed as 12 q n t n r q where t n i cos θ 1 n i sin θ 1 and r q x y z multiply t n on both sides of eq 5 the following the equation below is obtained 13 q n a q n 1 η q n 2 q n 1 q n b q n 1 η q n 3 q n 1 q n q n 1 η q n 2 q n 1 ξ η q n 3 q n 2 q n l z l i x l cos θ 1 n 1 y l sin θ l 1 2 3 where x l y l z l l 1 2 3 is the coordinate of nodes l of the triangle thus we can obtain 14 d q n a d η q n 2 q n 1 d q n b d η q n 3 q n 1 d q n d ξ η q n 3 q n 2 according to whether d q n d ξ is equal to 0 the calculation of c n θ and c n θ is divided into two cases for the lack of space present work only gives the detailed calculation process of c n θ c n θ is calculated in the similar way a d q n d ξ 0 i e q n 3 q n 2 thus q n q n η c n θ can be expressed as 15 c n θ 2 s 0 l k k k 1 k k 2 d k 0 1 η e k p n q n a d η since d q n a d η q n 2 q n 1 the following equation can be obtained 16 c n θ 2 s 0 q n 2 q n 1 l 1 k k 1 k k 2 d k 0 1 η d e k p n q n a 2 s 0 q n 2 q n 1 l 1 k k 1 k k 2 d k η e k p n q n a 0 1 0 1 e k p n q n a d η 2 s 0 q n 2 q n 1 l e k α n 2 k k 1 k k 2 d k 2 s 0 q n 2 q n 1 l d k 0 1 e k p n q n a k k 1 k k 2 d η where α n l p n q n l z z l i x x l cos θ 1 n 1 y y l sin θ l 1 2 3 more details about the evaluation of l e k α n 2 k k 1 k k 2 d k and l d k 0 1 e k p n q n a k k 1 k k 2 d η are available in appendix c n θ can be expressed as 17 c n θ 2 s 0 k 1 k 2 m 1 2 1 m 1 1 q n 2 q n 1 l e k α n 2 k k m d k 1 k m 1 q n 2 q n 1 2 l 1 2 1 l l e α n l k k m d k ln α n l similarly c n θ can be expressed as 18 c n θ 2 s 0 k 1 k 2 m 1 2 1 m 1 k m q n 2 q n 1 l e k α n 2 k k m d k 1 q n 2 q n 1 2 l 1 2 1 l l e k α n l k k m d k b d q n d ξ 0 i e q n 3 q n 2 as is the case with the integral calculations above the following expression of c n θ can be obtained 19 c n θ 2 s 0 q n 3 q n 2 l 1 k k 1 k k 2 d k 0 1 d η 0 1 d e k p n q n 2 s 0 q n 3 q n 2 l d k 0 1 e k p n q n b k k 1 k k 2 d η l d k 0 1 e k p n q n a k k 1 k k 2 d η more details about the evaluation of l d k 0 1 e k p n q n a k k 1 k k 2 d η are available in appendix l d k 0 1 e k p n q n b k k 1 k k 2 d η can be calculated in the same way thus we can obtain 20 c n θ 2 s 0 k 1 k 2 m 1 2 1 m 1 k m l 1 3 l e k α n l k k m d k ln α n l q n l 1 q n l q n l 1 q n l where q n 0 q n 3 and q n 4 q n 1 similarly c n θ can be expressed as 21 c n θ 2 s 0 k 1 k 2 m 1 2 1 m 1 l 1 3 l e k α n l k k m d k q n l 1 q n l q n l 1 q n l it can be seen from eqs 10 11 17 18 20 and 21 that the panel source green s function and its derivatives can be expressed as double integrals of θ and k moreover all the integrals related to k is in the form i m l e k α n k k m d k in the present work the integrals related to k is carried out firstly by the following formula 22 i m l e k α n k k m d k e k m α n e 1 k m α n 2 π i h m n e k m α n where e 1 u u e t t d t is the exponential integral function h m n is the control factor as is shown below 23 h 1 n 1 re k 1 α n 0 im k 1 α n 0 0 e l s e h 2 n 1 re k 2 α n 0 im k 2 α n 0 0 e l s e θ 0 ν h 1 n 1 im k 1 α n 0 0 im k 1 α n 0 h 2 n 1 im k 2 α n 0 0 im k 2 α n 0 θ ν π 2 h 1 n 1 im k 1 α n 0 0 im k 1 α n 0 h 2 n 1 im k 2 α n 0 0 im k 2 α n 0 v θ π 2 π among them the expression of h m n is quoted from xu and dong 2011 when θ ν π more details about the evaluation of h m n when θ 0 ν is available in the chapter below thus the panel source green s function and its derivatives can be expressed as single integrals of θ as is shown below 24 s g f 1 π m n 1 2 0 π 1 m 1 k m n θ 1 4 τ cos θ d θ 25 s g f 1 π m n 1 2 0 π i cos θ 1 n 1 i sin θ 1 1 m 1 k m n θ 1 4 τ cos θ d θ when q n 3 q n 2 integrand k m n θ and k m n θ are 26 k m n θ 2 s 0 e k m α n 2 e 1 k m α n 2 2 π i h m n e k m α n 2 q n 2 q n 1 l 1 2 1 l e k m α n l e 1 k m α n l 2 π i h m n e k m α n l ln α n l k m q n 2 q n 1 2 27 k m n θ 2 s 0 k m e k m α n 2 e 1 k m α n 2 2 π i h m n e k m α n 2 q n 2 q n 1 l 1 2 1 l e k m α n l e 1 k m α n l 2 π i h m n e k m α n l q n 2 q n 1 2 when q n 3 q n 2 integrand k m n θ and k m n θ are 28 k m n θ 2 s 0 k m l 1 3 e k m α n l e 1 k m α n l 2 π i h m n e k m α n l ln α n l q n l 1 q n l q n l 1 q n l 29 k m n θ 2 s 0 l 1 3 e k m α n l e 1 k m α n l 2 π i h m n e k m α n l q n l 1 q n l q n l 1 q n l since these analytical integral expressions is similar in form to the havelock form 3dtp source green s function we call it the havelock form translating pulsating panel source green s function 2 3 calculation of control factor h m n when θ 0 ν in present chapter details about the evaluation of h m n when θ 0 ν is elucidated when θ 0 ν k m c and can be expressed as 30 2 u 2 k m g 1 2 τ cos θ 1 m i 4 τ cos θ 1 cos 2 θ m 1 2 from the above we know that im k 1 0 im k 2 0 which is useful in the following formula derivation let k m k m r i k m i α can be expressed as α α r i α i α r z z 0 thus k m α α r i α i k m r i k m i α r k m r α i k m i i α i k m r α r k m i it can be deduced that k m α 0 that is the real and imaginary parts of k m α can not be equal to 0 at the same time otherwise k m 0 which is contrary to the definition of k m by the change of the variable w k k m α we can obtain 31 i m 0 e k α k k m d k e k m α k m α e w w d w the value of w when k is shown in the table below moreover the calculation of integral function i m 0 e k α k k m d k is divided into the following cases 1 re k m α 0 when k w i no singularity exists in the calculation of the integral function k m α i e w w d w we can obtain 32 i m e k m α k m α e w w d w e k m α e 1 k m α 2 re k m α 0 singularity may occur in the calculation of k m α e w w d w to make it clear six cases are discussed below 2 1 im k m α 0 im α 0 since k m α is located on or above the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in the way of i which corresponds to the way k i in no 2 of table 1 moreover it can be deduced from im k m α 0 and im α 0 that re k m 0 the position of k 1 and k 2 in the complex space of k is shown in fig 4 contour integration method is adopted and integral path γ u c u l is chosen to avoid singularity the following equations can be deduced from the residue theorem 33a i 1 0 e k α k k 1 d k 0 i e k α k k 1 d k e k 1 α k 1 α i e w w d w e k 1 α e 1 k 1 α 33b i 2 0 e k α k k 2 d k 2 π i e k 2 α 0 i e k α k k 2 d k 2 π i e k 2 α e k 2 α k 2 α i e w w d w 2 π i e k 2 α e k 2 α e 1 k 2 α 2 2 im k m α 0 im α 0 it is impossible that im k m α 0 while im α 0 it can be deduced from im k m α 0 and im α 0 that im k m 0 which contradicts the definition of k 2 since k 1 α is located above the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way corresponding to the way k in no 5 of table 1 thus we can obtain 34 i 1 e k 1 α k 1 α i im k 1 α e w w d w e k 1 α e 1 k 1 α 2 3 im k m α 0 im α 0 it can be deduced that im k m 0 which contradicts the definition of k 2 since k 1 α is located on or above the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way of i which corresponds to the way k in no 3 of table 1 thus we can obtain 35 i 1 e k 1 α k 1 α i e w w d w e k 1 α e 1 k 1 α 2 4 im k m α 0 im α 0 it can be deduced that im k m 0 which contradicts the definition of k 1 since k 2 α is located below the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way of i which corresponds to the way k in no 1 of table 1 thus we can obtain 36 i 2 e k 2 α k 2 α i e w w d w e k 2 α e 1 k 2 α 2 5 im k m α 0 im α 0 it can be deduced that im k m 0 which contradicts the definition of k 1 since k 2 α is located below the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way corresponding to the way k in no 5 of table 1 thus we can obtain 37 i 2 e k 2 α k 2 α i im k 2 α e w w d w e k 2 α e 1 k 2 α 2 6 im k m α 0 im α 0 it can be deduced that re k m 0 since k m α is located below the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way of i which corresponds to the way k i in no 4 of table 1 contour integration method is adopted and the integral path γ d c d l is chosen as is shown in fig 3 the following equations can be deduced from the residue theorem 38 i 1 0 e k α k k 1 d k 2 π i e k 1 α 0 i e k α k k 1 d k 2 π i e k 1 α e k 1 α k 1 α i e w w d w 2 π i e k 1 α e k 1 α e 1 k 1 α 39 i 2 0 e k α k k 2 d k 0 i e k α k k 2 d k e k 2 α k 2 α i e w w d w e k 2 α e 1 k 2 α in summary when θ 0 ν control factor h mn is expressed as 40 h 1 n 1 re k 1 α n 0 im k 1 α n 0 0 e l s e h 2 n 1 re k 2 α n 0 im k 2 α n 0 0 e l s e 3 numerical implementation the integration of 3dtp source over panel is outlined and analytically performed as is mentioned above although the panel source green s function and its derivatives are single integrals of θ which is conducive to numerical calculation there are still some integral difficulties and need to be treated skillfully 3 1 singularity related to θ π 2 the wave numbers k 1 and k 2 in eq 3 are associated with the pulsating effect and translating effect respectively they are functions of θ moreover the denominators of k m is equal to zero if θ π 2 which brings singularity typical images of k m are presented in fig 5 for τ 0 25 τ 0 25 and τ 0 25 xu and dong 2011 it is indicated that θ π 2 is a removable discontinuity point of k 1 if k 1 is equal to ω e 2 g at θ π 2 and expressed as follows the singularity of k 1 can be eliminated 41 k 1 4 ω e 2 g 1 1 4 τ cos θ 2 however k 2 trends to infinity at θ π 2 resulting in numerical difficulty according to eqs 26 29 the terms 1 k 2 e k 2 α n k 2 e k 2 α n e k 2 α n e 1 k 2 α n k 2 e k 2 α n e 1 k 2 α n or their combinations are related to k 2 in the panel source green s function among them the first three term trend to zero at θ π 2 yang et al 2019 the last two terms related to k 2 can be written as e z e 1 z and z e z e 1 z if z is set equal to k 2 α n obviously z trends to infinity at θ π 2 the exponential integral function e 1 z have the following asymptotic expansions abramowitz and stegun 1964 42 e 1 z e z z n 0 1 n n z n thus e z e 1 z and z e z e 1 z trend to 0 and 1 respectively at θ π 2 through the above analysis and mathematical treatment the singularity of k m can be eliminated and no difficulties will be introduced into the integral calculation 3 2 singularity related to θ ν if τ 0 25 ν is the zero point of the denominator of integrand in the analytical integral expression of the panel source green s in order to eliminate the singularity the integral interval 0 π is divided into 0 ν ν π by performing t cosθ eq 24 can be converted into the following form 43 s g f 1 π m n 1 2 0 ν ν π 1 m 1 k m n θ 1 4 τ cos θ d θ 1 π m n 1 2 0 ν 1 m 1 k m n θ i 4 τ cos θ μ d θ 1 π m n 1 2 ν π 1 m 1 k m n θ 4 τ μ cos θ d θ t cos θ 1 π m n 1 2 μ 1 1 m 1 k m n cos 1 t i 4 τ 1 t t μ 1 t d t 1 π m n 1 2 1 μ 1 m 1 k m n cos 1 t 4 τ 1 t t 1 μ t d t where μ 1 4 τ it is obviously observed that the formula have the form a b f u u a b u d u according to the lobatto rule xu and dong 2011 the integral of this form can be transformed into 0 π f b a 2 b a 2 cos χ d χ by performing u b a 2 b a 2 cos χ thus the singularity at the end points can be eliminated similarly the singularity of the derivatives of the analytical integral expression eq 25 at θ ν can be eliminated 3 3 calculation of complex exponential integral e 1 z a fraction polynomial hess and smith 1962 is used to evaluate complex exponential integral e z e 1 z 44 e z e 1 z m n d ε z where m 1 m 1 z m 2 z 2 m 3 z 3 m 4 z 4 ln z n γ 0 99999207 n 1 z n 2 z 2 n 3 z 3 n 4 z 4 n 5 z 5 d 1 d 1 z d 2 z 2 d 3 z 3 d 4 z 4 d 5 z 5 d 6 z 6 γ 0 5772156649 is the euler s number ε 7 10 6 and through the above numerical treatments all the singularities in the analytical expression of the panel source green s function can be eliminated and the corresponding integrands can be calculated by elementary functions moreover the integral respect to θ can be performed by an adaptive iterative integration based on simpson s rule davis and rabinowitz 2007 consequently we can obtain the integral of the 3dtp source green s function over the panel m1 0 23721365 n1 1 49545886 d1 0 76273617 m2 0 020654300 n2 0 041806426 d2 0 28388363 m3 0 00076329700 n3 0 03000591 d3 0 066786033 m4 0 0000097687007 n4 0 0019387339 d4 0 012982719 n5 0 00051801555 d5 0 00087008610 d6 0 00029892040 4 numerical results and discussions to validate present analytical expression of havelock form panel source green s function and the corresponding numerical implementation various panel integrals of g f and its partial derivatives are performed a vertical rectangular panel and a horizontal triangular panel are chosen as the integral panel as is show in fig 6 the vertical rectangular panel has a side length of 1 0 and the center of mass is located at 0 0 0 0 0 51 the unit outer normal is directed along the y axis the coordinates of nodes on horizontal triangular panel are q 1 0 2 0 1 0 01 q 2 0 1 0 1 0 01 and q 3 0 1 0 2 0 01 the calculations are performed for a field point p located on the three different axis for the integral of g f over the vertical rectangular panel the rectangular panel is decomposed into two triangles since the numerical treatment of panel source green s function varies with brard number τ 0 28 and f n 0 20 is used for numerical validation in the case of τ 0 25 which is the same calculation condition as maury 2001 τ 0 20 and f n 0 10 is chosen for numerical validation in the case of τ 0 25 just like the numerical calculation made by liang et al 2016 numerical results are illustrated in figs 7 11 for comparison the same panel integrals is performed by the traditional gauss legendre quadrature with various number of gauss points n1 n2 gauss points in the figures indicates that n1 rows of gauss points are distributed in the vertical direction and n2 columns of gauss points are distributed in the horizontal direction for the integral of g f over the horizontal triangular panel τ is set to 0 15 and f n is set to 0 30 numerical results of present panel source green s function are compared with that of gauss legendre quadrature as is illustrated in figs 12 14 before performing the gauss legendre quadrature the triangular panel is mapped into a unit rectangle in ξ o η plane firstly as is shown in fig 3 n1 and n2 in figs 12 14 represent the number of gauss points in the horizontal and vertical directions on the ξ o η plane respectively moreover a in house fortran code of line segment source method liang et al 2016 is developed by our research group the corresponding numerical calculations are performed and the convergent numerical results are added for comparison for the integral of g f over the vertical rectangular panel it is shown that the numerical results of present panel source green s function is identical to the existing results of maury 2001 and liang et al 2016 which means the present method is reliable and feasible in numerical calculation while for the results of gauss legendre quadrature convergence is divided into two categories far from the panel the gauss legendre quadrature induces very low errors with few gauss points nevertheless close to the panel numerical integral with gauss legendre quadrature leads to some errors and even 20 20 gauss point is unable to give accurate results close to y 0 for the integration of the derivatives of g f as is shown in figs 8 and 10 this is because g f and its derivatives are violently oscillating in space and when the field point is close to the source point the oscillation phenomenon is intensified as is shown fig 2 besides figs 9 and 11 indicate that a simple gauss legendre quadrature can t obtain a good accuracy when the field point is close to the free surface only analytical integral method can give correct results in addition the derivatives of g f imply more difficulties to be integrated than g f itself by the numerical quadrature this is because the integrand f n θ k of the partial derivative of g f has one more coefficient k than the integrand f n θ k of g f as shown in eq 2 and 4 if e k p n q n in the integrand f n θ k and f n θ k is regarded as the oscillation function and the remaining part is regarded as the oscillation amplitude the oscillation of f n θ k is much larger than that of f n θ k in the fourier plane when k is large which makes the oscillation of the partial derivative of g f in space is much large that of g f as is shown in fig 2 above this accounts for why the derivatives of g f imply more difficulties to be integrated than g f itself for the integral of g f over the horizontal triangular panel since the triangular panel is very close to the free surface and the field point is on the free surface fig 12 shows that gauss legendre quadrature cannot obtain the convergent numerical results this is consistent with the conclusion that the numerical quadrature cannot give correct results for a panel and a collocation point close to the free surface guilbaud et al 2001 and it is the reason why many scholars develop various forms of panel source green s function by contrast the numerical results of present panel source green s function are in good agreement with that of the line segment source the numerical results obtained by the gauss legendre quadrature of 40 40 gauss points can t be consistent with the numerical results of these two methods this once again proves the reliability and feasibility of the present panel source green s function in addition table 2 shows the total time for g f and its derivatives to be integrated on the horizontal triangle panel above using the numerical quadrature and the present panel source method when the field points are distributed on the x axis y axis and z axis respectively here the havelock form green s function is used as the point source in the numerical quadrature the calculation interval for the field point distributing on x axis is 2 0 0 0 with a step size of 0 001 the calculation interval on the y axis is 0 0 10 0 with a step size of 0 01 the calculation interval on the z axis is 1 0 0 0 with a step size of 0 001 all the calculations are run on a personal computer with an intel core i7 8700 with cpu clock of 3 19 ghz as can be seen from table 2 it takes only an average of milliseconds to complete the numerical calculation of a havelock form translating pulsating panel source green s function which meets the calculation efficiency requirements of the actual project moreover compared with the numerical quadrature the present panel source green s function can significantly improve the calculation efficiency while obtaining higher calculation accuracy when it is used to calculate the integral of g f over panel table 3 shows the total time for g f and its derivatives to be integrated on the vertical rectangular panel above using the present panel source method when the field points are distributed on the x axis y axis and z axis respectively for the case τ 0 28 and f n 0 20 the calculation interval for the field point distributing on x axis is 12 0 6 0 with a step size of 0 01 the calculation interval on the y axis is 0 0 10 0 with a step size of 0 01 the calculation interval on the z axis is 1 0 0 0 with a step size of 0 001 for the case τ 0 20 and f n 0 10 the calculation interval for the field point distributing on y axis is 3 0 3 0 with a step size of 0 01 the calculation interval on the z axis is 1 0 0 0 with a step size of 0 001 5 concluding remarks in the present paper an analytical expression of havelock form panel source green s function and its derivatives are derived and the corresponding numerical implementation is presented detailedly to facilitate the integral calculation the triangular panel is mapped into a unit rectangle the integral of the integrand is performed analytically over the unit rectangle firstly then the integral respect to k is carried out and contour integration method is adopted if necessary after eliminating all the singularities of the integrand the integral respect to θ can be performed by an adaptive iterative integration the conclusions can be drawn as follows 1 the havelock form panel source green s function is proposed and the corresponding numerical implementation method is supplemented in addition the derivation process of the control factor h mn related to the wave component in the havelock form green s function is elucidated in detail 2 compared with the numerical quadrature the panel source green s function can significantly improve the calculation efficiency while obtaining higher calculation accuracy 3 the derivatives of g f oscillates more violently in space than g f itself the numerical results show that the integral results of derivatives of g f improved much more than g f itself by using panel source green s function 4 numerical quadrature cannot give correct results for a panel and a field point close to the free surface even if a large number of point sources are distributed on the panel numerical results prove the accuracy and feasibility of present analytical integral expression nevertheless greater efforts should be made for future improvement for example numerical approximation to the local flow component or wave component of the havelock form panel source green s function can be made thus greatly improving the computational efficiency credit authorship contribution statement shan huang writing original draft writing review editing software validation visualization resources renchuan zhu conceptualization methodology liang hong software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china grant no 51579147 appendix a the calculation of l e k α n 2 k k 1 k k 2 d k since 1 k k 1 k k 2 1 k 1 k 2 m 1 2 1 m 1 1 k k m we can obtain a 1 l e k α n 2 k k 1 k k 2 d k 1 k 1 k 2 m 1 2 1 m 1 l e k α n 2 k k m d k b the calculation of l d k 0 1 e k p n q n a k k 1 k k 2 d η since 1 k k 1 k k 2 1 k 1 k 2 m 1 2 1 m 1 k m k k k m 1 we can obtain a 2 l d k 0 1 e k p n q n a k k 1 k k 2 d η 1 k 1 k 2 m 1 2 1 m 1 k m l d k 0 1 k e k p n q n a k k m d η 0 1 d η l e k p n q n a d k 1 k 1 k 2 m 1 2 1 m 1 k m 1 q n 2 q n 1 l e α n 2 e α n 1 k k m d k 0 1 1 p n q n a d η 1 k 1 k 2 q n 2 q n 1 m 1 2 1 m 1 k m l e α n 2 e α n 1 k k m d k ln α n 2 ln α n 1 1 k 1 k 2 q n 2 q n 1 m 1 2 1 m 1 k m l 1 2 1 l l e α n l k k m d k ln α n l 
21469,the numerical approximation of the three dimension translating pulsating 3dtp source green s function is the basis for solving the diffraction radiation problem of marine vessels with forward speed however the highly oscillation of the 3dtp source near the free surface makes the hydrodynamic results unstable the panel source green s function which means the analytical integral of the green s function over panels can ease the numerical instability problem in the present study an analytical expression of havelock form panel source green s function is proposed and the corresponding numerical integral method is presented a coordinate transformation is performed and the triangular panel is mapped into a unit rectangle the space integral is carried out beforehand by an analytical method and the determination of the control factor is elaborated thus the panel source green s function can be expressed as a θ type single integral lobatto rule is adopted to eliminate singularities caused by infinite discontinuity and a fraction polynomial is used to evaluate complex exponential integral therefore the integral respect to θ can be performed by an adaptive iterative integration finally the numerical results of present method is compared with other existing results it shows that the present analytical integral expression is accurate and reliable keywords translating pulsating source panel source havelock form forward speed 1 introduction seakeeping performance evaluation is a critical part in the design process of marine vehicles numerical simulation and experiments are two common ways compared to practical experiments numerical simulation is of high efficiency and relatively cheaper furthermore most numerical simulations of ship hydrodynamics are carried out with in the frame of potential flow theory and the boundary element method bem is adopted according to the difference of green s function used the bem is called the rankine panel method or free surface green s function method fgm in the fgm the free surface green s function has the advantage of an automatic fulfillment of the neumann kelvin linearization free surface condition and radiation conditions consequently no source or dipole is required to be distributed on the free surface which greatly reduces the number of panels and avoids numerical errors due to the truncation of boundaries for the hydrodynamic problems of marine vehicles with forward speed traditionally the numerical model is expressed linearly and formulated in the frequency domain correspondingly the three dimension translating pulsating 3dtp source green s function is used therefore the calculation of 3dtp source green s function with high precision and efficiency is the key to the hydrodynamic problems of ship with forward speed the 3dtp source green s function and its derivatives are complicated mathematical formulations which means the velocity potential of field point produced by the unit translating and pulsating source this green s function has been studied by many scholars over the past years it is in the 1940s that the first mathematical formulation of this green s function was derived by haskind 1946 based on it many other forms of this function such as bessho form bessho 1977 iwashita and ohkusu 1989 du et al 2000 michell form takagi 1992 miao et al 1995 and havelock form wakeling et al 1986 wu and eatock taylor 1987 rahman 1990 xu and dong 2011 have been derived moreover noblesse et al 1995 decomposed this green s function into a local non oscillatory component and a wave component based on it chen and wu 2001 presented the singular and highly oscillaory features of the wave component among the above forms of 3dtp source green s function the bessho form is considered the most suitable for numerical calculations because it is expressed in a single integral form and its integrands are all elementary functions moreover the steepest descent method is used to find numerically the integral path on which the integrands do not oscillate and rapidly approach zero however it is difficult to associate this expression with physical phenomenon by contrast the expression of havelock form has definite physical meaning the integrand consists of four direction wave patterns i e two translating parts and two pulsating parts liu and miao 1986 besides each pattern is divided into a local flow component and a wave component zong and huang 1991 therefore the velocity potential of translating parts and pulsating parts produced by the source can be quantified and the corresponding physical meaning can be revealed additionally the havelock form 3dtp source green s function is expressed in a single integral form which makes the numerical calculation much easier takagi 1992 thus more and more attention is being paid to this form of green s function after years of studies on 3dtp source green s function some rapid algorithms are established du and wu 1998 xu and dong 2011 hong et al 2013 and certain good numerical results of 3dtp source green s function and its derivatives are obtained even so 3dtp source green s function cannot be used directly in practical applications in view of its highly oscillating nature near the free surface it is the integral of 3dtp source over panels and waterline segments rather than itself that generates the diffraction and radiation flow fields numerical quadrature cannot give correct results for a panel and a collocation point close to the free surface guilbaud et al 2001 consequently when it comes to a complicated geometry such as a ship with large flares getting reasonable and stable numerical results by 3dtp source is very difficult in order to ease this numerical instability several techniques are often used such as modification of the geometry near the free surface or putting down the reference points with small distance below the free surface however these techniques rely entirely on experience and inevitably bring in errors nowadays the so called panel source or segment source green s function has attracted increasing attention which means the analytical integrations of 3dtp source green s function over panels or segments iwashita 1992 and maury 2001 proposed an analytical quadrature of bessho s single integral expression over a panel based on it yao and dong 2014 made a further numerical improvement the bessho form analytical integral expressions have been proved to be more accurate than the traditional numerical quadrature and are able to decrease the oscillations of the calculations ten et al 2018 derived an alternative formulation for the 3dtp source green s function suited to the integration over a smooth surface or a closed waterline based on this formulation chen et al 2018 solved the ship motion problem by a hybrid method with a meshless cylinder control surface however to the best of the authors knowledge few studies have been done on the analytical quadrature of havelock form expression over the panel so far only liang et al 2016 made a study on havelock form green s function distributing on a horizontal line segment it should be noted that iwashita 1990 shown an analytical integration of the havelock form 3dtp source green s function over a flat panel however his derivation is not rigorous considering the fact that the complex exponential integral and the control factor of the integrands is not continuous in space in the present study an analytical expression of havelock form panel source green s function is proposed the triangle is chosen as the integral panel in view of the fact that the triangular panel is one of the most versatile and simplest of panel in two dimensions to simplify the derivation of the integral expressions a coordinate transformation is performed and the triangular panel is mapped into a unit rectangle in ξ o η plane since the 3dtp source green s function is expressed as double integrals of θ and k the panel source green s function can be expressed as the integral of a double integral expression over the unit rectangle by changing the integral order the integral of the kernel function over the unit rectangle can be carried out beforehand by an analytical method thus the panel source green s functions can be expressed as double integrals of θ and k furthermore contour integration method is adopted to avoid numerical difficulty if there is singularity on the integral path of k then the integral respect to k can be expressed as the sum of the complex exponential integral and an elementary function thus the panel source green s function can be expressed as a θ type single integral given that this single integral expression is similar in form to the havelock form 3dtp source green s function we call it the havelock form translating pulsating panel source green s function to obtain the numerical results of the present analytical integral expression quickly and accurately a further numerical supplement is made to begin with singularities of the integrands are analyzed systematically k m and the terms related to k m in the integrands are assigned their limits at θ π 2 which will not result in numerical difficulties thus singularities related to k m at θ π 2 is eliminated after that variable substitution is performed and the singularity of the integrands at θ ν can be eliminated by the lobatto rule zong and huang 1991 in addition a fraction polynomial hess and smith 1962 is used to evaluate complex exponential integral with high precision and efficiency at last the integral respect to θ can be performed by an adaptive iterative integration based on simpson s rule davis and rabinowitz 2007 at the end of present work present analytical integral expression is applied to the integral calculation of the 3dtp source green s function and its partial derivatives over a vertical rectangular panel and a horizontal triangular panel for a field point located on the three different axes the excellent agreement with existing numerical results of maury and liang on the vertical rectangular panel and the results of line segment source indicates that the present analytical integral expression is accurate and practical in the integral calculation of the 3dtp source green s function with different brard numbers and froude numbers 2 havelock form translating pulsating panel source green s function 2 1 point source green s function we define the cartesian coordinate system x y z translating with constant velocity u 0 in the x direction the z axis is positive upward with the origin in the plane of the undisturbed free surface the green s function is defined as velocity potential g p q e i ω e t at the field point p x y z generated by the source point q x y z the free surface green s function g should satisfy the following equations 1 2 g x 2 2 g y 2 2 g z 2 δ p q i n z 0 i ω e u 0 x 2 g z g 0 o n z 0 lim z g 0 according to eq 1 point source green s function can be derived and expressed as follow 2 g g s p q g f p q g s 1 r 1 r r x x 2 y y 2 z z 2 r x x 2 y y 2 z z 2 g f g π n 1 2 0 ν d θ 0 d k f n θ k ν π 2 d θ 0 l 1 d k f n θ k π 2 π d θ 0 l 2 d k f n θ k f n θ k k e k p n q n u 0 2 cos 2 θ k k 1 k k 2 p n z i x cos θ 1 n y sin θ q n z i x cos θ 1 n y sin θ ν cos 1 1 4 τ i f 1 4 τ 1 0 i f 1 4 τ 1 τ u 0 ω e g the integral path l 1 and l 2 are shown in fig 1 where k 1 k 2 are zero points of the denominator of f n θ k 3 2 u 0 2 k m g 1 2 τ cos θ 1 m 1 4 τ cos θ cos 2 θ m 1 2 expressions for the derivatives of the froude dependent part g f is given by 4a g f g π n 1 2 0 π d θ 0 i cos θ 1 n 1 i sin θ 1 f n θ k d k 4b f n θ k k 2 e k p n q n u 0 2 cos 2 θ k k 1 k k 2 the typical spacial distribution of the real parts of g f and its x derivatives are shown in fig 2 for a source point at the 0 0 0 0 0 1 and the field point distributing in xoy plane it is indicated that g f and its derivative oscillate violently in space and the derivatives of g f has larger oscillation amplitude this makes it difficult to use numerical method to calculate the integral of g f and its derivatives over panel 2 2 panel source green s function considering the fact that the integral of g s is relatively simple present work only studies the analytic integral of g f over the panel and calls it panel source green s function the triangular panel is one of the most versatile and simplest of panel in two dimensions one can easily represent almost any geometry with triangular panels and without too much trouble furthermore mesh generators for triangular meshes are the most robust i e they tend not to make errors this is a tremendous advantage as a robust automatic mesh generator is essential in the solution of complex problems by boundary element method thus the triangle is chosen as the integral panel 2 2 1 coordinate transformations before deriving the analytical expression of panel source green s function a coordinate transformation is performed and the triangular panel is mapped into a unit rectangle in ξ o η plane as is shown in fig 3 λ 0 is the length of side 23 ab is a line parallel to side 23 q is a point on line ab the length of ab and aq are η λ 0 and ξ a b respectively thus point a b and q can be expressed by ξ η as follows 5 r a r 1 η r 2 r 1 r b r 1 η r 3 r 1 r q r 1 η r 2 r 1 ξ η r 3 r 2 where r l x l y l z l l 1 2 3 is the coordinate of node l of the triangle in the cartesian coordinate system r q x y z thus 0 η 1 0 ξ 1 the integral of function f x y z over triangular panel can be expressed as follows 6 s f t f x y z d s 0 1 0 1 f ξ η j ξ η d η d ξ where j ξ η is the jacobian determinant by simple calculation the jacobian determinant can be expressed as follows 7 j ξ η r q ξ r q η 2 η s 0 where s 0 is the area of the triangular panel thus eq 6 can be expressed as 8 s f t f x y z d s 2 s 0 0 1 η d η 0 1 f ξ η d ξ 2 2 2 analytical expression of havelock form panel source green s function substituting g f into eq 8 the panel source green s function can be expressed as 9 s g f t g f d s q 2 s 0 0 1 η d η 0 1 g f d ξ substituting eq 2 into eq 9 after changing the integral order and carrying on the spatial integral firstly the following expression of panel source green s function can be obtained 10a s g f g π n 1 2 0 π c n θ u 0 2 cos 2 θ d θ 10b c n θ 2 s 0 l d k 0 1 η d η 0 1 k e k p n q n k k 1 k k 2 d ξ similarly the derivatives of panel source green s function can be obtained 11a s g f g π n 1 2 0 π i cos θ 1 n 1 i sin θ 1 c n θ u 0 2 cos 2 θ d θ 11b c n θ 2 s 0 l d k 0 1 η d η 0 1 k 2 e k p n q n k k 1 k k 2 d ξ it can be seen from eqs 10 and 11 that the derivation of analytical expression of the panel source green s function and its derivatives lies on of the calculation of the kernel function c n θ and c n θ moreover only q n in the integrand is the function of ξ and η thus we need to figure out the partial derivatives of q n ξ η with respect to ξ and η from eq 2 q n can be expressed as 12 q n t n r q where t n i cos θ 1 n i sin θ 1 and r q x y z multiply t n on both sides of eq 5 the following the equation below is obtained 13 q n a q n 1 η q n 2 q n 1 q n b q n 1 η q n 3 q n 1 q n q n 1 η q n 2 q n 1 ξ η q n 3 q n 2 q n l z l i x l cos θ 1 n 1 y l sin θ l 1 2 3 where x l y l z l l 1 2 3 is the coordinate of nodes l of the triangle thus we can obtain 14 d q n a d η q n 2 q n 1 d q n b d η q n 3 q n 1 d q n d ξ η q n 3 q n 2 according to whether d q n d ξ is equal to 0 the calculation of c n θ and c n θ is divided into two cases for the lack of space present work only gives the detailed calculation process of c n θ c n θ is calculated in the similar way a d q n d ξ 0 i e q n 3 q n 2 thus q n q n η c n θ can be expressed as 15 c n θ 2 s 0 l k k k 1 k k 2 d k 0 1 η e k p n q n a d η since d q n a d η q n 2 q n 1 the following equation can be obtained 16 c n θ 2 s 0 q n 2 q n 1 l 1 k k 1 k k 2 d k 0 1 η d e k p n q n a 2 s 0 q n 2 q n 1 l 1 k k 1 k k 2 d k η e k p n q n a 0 1 0 1 e k p n q n a d η 2 s 0 q n 2 q n 1 l e k α n 2 k k 1 k k 2 d k 2 s 0 q n 2 q n 1 l d k 0 1 e k p n q n a k k 1 k k 2 d η where α n l p n q n l z z l i x x l cos θ 1 n 1 y y l sin θ l 1 2 3 more details about the evaluation of l e k α n 2 k k 1 k k 2 d k and l d k 0 1 e k p n q n a k k 1 k k 2 d η are available in appendix c n θ can be expressed as 17 c n θ 2 s 0 k 1 k 2 m 1 2 1 m 1 1 q n 2 q n 1 l e k α n 2 k k m d k 1 k m 1 q n 2 q n 1 2 l 1 2 1 l l e α n l k k m d k ln α n l similarly c n θ can be expressed as 18 c n θ 2 s 0 k 1 k 2 m 1 2 1 m 1 k m q n 2 q n 1 l e k α n 2 k k m d k 1 q n 2 q n 1 2 l 1 2 1 l l e k α n l k k m d k b d q n d ξ 0 i e q n 3 q n 2 as is the case with the integral calculations above the following expression of c n θ can be obtained 19 c n θ 2 s 0 q n 3 q n 2 l 1 k k 1 k k 2 d k 0 1 d η 0 1 d e k p n q n 2 s 0 q n 3 q n 2 l d k 0 1 e k p n q n b k k 1 k k 2 d η l d k 0 1 e k p n q n a k k 1 k k 2 d η more details about the evaluation of l d k 0 1 e k p n q n a k k 1 k k 2 d η are available in appendix l d k 0 1 e k p n q n b k k 1 k k 2 d η can be calculated in the same way thus we can obtain 20 c n θ 2 s 0 k 1 k 2 m 1 2 1 m 1 k m l 1 3 l e k α n l k k m d k ln α n l q n l 1 q n l q n l 1 q n l where q n 0 q n 3 and q n 4 q n 1 similarly c n θ can be expressed as 21 c n θ 2 s 0 k 1 k 2 m 1 2 1 m 1 l 1 3 l e k α n l k k m d k q n l 1 q n l q n l 1 q n l it can be seen from eqs 10 11 17 18 20 and 21 that the panel source green s function and its derivatives can be expressed as double integrals of θ and k moreover all the integrals related to k is in the form i m l e k α n k k m d k in the present work the integrals related to k is carried out firstly by the following formula 22 i m l e k α n k k m d k e k m α n e 1 k m α n 2 π i h m n e k m α n where e 1 u u e t t d t is the exponential integral function h m n is the control factor as is shown below 23 h 1 n 1 re k 1 α n 0 im k 1 α n 0 0 e l s e h 2 n 1 re k 2 α n 0 im k 2 α n 0 0 e l s e θ 0 ν h 1 n 1 im k 1 α n 0 0 im k 1 α n 0 h 2 n 1 im k 2 α n 0 0 im k 2 α n 0 θ ν π 2 h 1 n 1 im k 1 α n 0 0 im k 1 α n 0 h 2 n 1 im k 2 α n 0 0 im k 2 α n 0 v θ π 2 π among them the expression of h m n is quoted from xu and dong 2011 when θ ν π more details about the evaluation of h m n when θ 0 ν is available in the chapter below thus the panel source green s function and its derivatives can be expressed as single integrals of θ as is shown below 24 s g f 1 π m n 1 2 0 π 1 m 1 k m n θ 1 4 τ cos θ d θ 25 s g f 1 π m n 1 2 0 π i cos θ 1 n 1 i sin θ 1 1 m 1 k m n θ 1 4 τ cos θ d θ when q n 3 q n 2 integrand k m n θ and k m n θ are 26 k m n θ 2 s 0 e k m α n 2 e 1 k m α n 2 2 π i h m n e k m α n 2 q n 2 q n 1 l 1 2 1 l e k m α n l e 1 k m α n l 2 π i h m n e k m α n l ln α n l k m q n 2 q n 1 2 27 k m n θ 2 s 0 k m e k m α n 2 e 1 k m α n 2 2 π i h m n e k m α n 2 q n 2 q n 1 l 1 2 1 l e k m α n l e 1 k m α n l 2 π i h m n e k m α n l q n 2 q n 1 2 when q n 3 q n 2 integrand k m n θ and k m n θ are 28 k m n θ 2 s 0 k m l 1 3 e k m α n l e 1 k m α n l 2 π i h m n e k m α n l ln α n l q n l 1 q n l q n l 1 q n l 29 k m n θ 2 s 0 l 1 3 e k m α n l e 1 k m α n l 2 π i h m n e k m α n l q n l 1 q n l q n l 1 q n l since these analytical integral expressions is similar in form to the havelock form 3dtp source green s function we call it the havelock form translating pulsating panel source green s function 2 3 calculation of control factor h m n when θ 0 ν in present chapter details about the evaluation of h m n when θ 0 ν is elucidated when θ 0 ν k m c and can be expressed as 30 2 u 2 k m g 1 2 τ cos θ 1 m i 4 τ cos θ 1 cos 2 θ m 1 2 from the above we know that im k 1 0 im k 2 0 which is useful in the following formula derivation let k m k m r i k m i α can be expressed as α α r i α i α r z z 0 thus k m α α r i α i k m r i k m i α r k m r α i k m i i α i k m r α r k m i it can be deduced that k m α 0 that is the real and imaginary parts of k m α can not be equal to 0 at the same time otherwise k m 0 which is contrary to the definition of k m by the change of the variable w k k m α we can obtain 31 i m 0 e k α k k m d k e k m α k m α e w w d w the value of w when k is shown in the table below moreover the calculation of integral function i m 0 e k α k k m d k is divided into the following cases 1 re k m α 0 when k w i no singularity exists in the calculation of the integral function k m α i e w w d w we can obtain 32 i m e k m α k m α e w w d w e k m α e 1 k m α 2 re k m α 0 singularity may occur in the calculation of k m α e w w d w to make it clear six cases are discussed below 2 1 im k m α 0 im α 0 since k m α is located on or above the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in the way of i which corresponds to the way k i in no 2 of table 1 moreover it can be deduced from im k m α 0 and im α 0 that re k m 0 the position of k 1 and k 2 in the complex space of k is shown in fig 4 contour integration method is adopted and integral path γ u c u l is chosen to avoid singularity the following equations can be deduced from the residue theorem 33a i 1 0 e k α k k 1 d k 0 i e k α k k 1 d k e k 1 α k 1 α i e w w d w e k 1 α e 1 k 1 α 33b i 2 0 e k α k k 2 d k 2 π i e k 2 α 0 i e k α k k 2 d k 2 π i e k 2 α e k 2 α k 2 α i e w w d w 2 π i e k 2 α e k 2 α e 1 k 2 α 2 2 im k m α 0 im α 0 it is impossible that im k m α 0 while im α 0 it can be deduced from im k m α 0 and im α 0 that im k m 0 which contradicts the definition of k 2 since k 1 α is located above the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way corresponding to the way k in no 5 of table 1 thus we can obtain 34 i 1 e k 1 α k 1 α i im k 1 α e w w d w e k 1 α e 1 k 1 α 2 3 im k m α 0 im α 0 it can be deduced that im k m 0 which contradicts the definition of k 2 since k 1 α is located on or above the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way of i which corresponds to the way k in no 3 of table 1 thus we can obtain 35 i 1 e k 1 α k 1 α i e w w d w e k 1 α e 1 k 1 α 2 4 im k m α 0 im α 0 it can be deduced that im k m 0 which contradicts the definition of k 1 since k 2 α is located below the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way of i which corresponds to the way k in no 1 of table 1 thus we can obtain 36 i 2 e k 2 α k 2 α i e w w d w e k 2 α e 1 k 2 α 2 5 im k m α 0 im α 0 it can be deduced that im k m 0 which contradicts the definition of k 1 since k 2 α is located below the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way corresponding to the way k in no 5 of table 1 thus we can obtain 37 i 2 e k 2 α k 2 α i im k 2 α e w w d w e k 2 α e 1 k 2 α 2 6 im k m α 0 im α 0 it can be deduced that re k m 0 since k m α is located below the negative real axis in the complex space of w no singularity will exist in the calculation of k m α e w w d w if w tends to infinity in a way of i which corresponds to the way k i in no 4 of table 1 contour integration method is adopted and the integral path γ d c d l is chosen as is shown in fig 3 the following equations can be deduced from the residue theorem 38 i 1 0 e k α k k 1 d k 2 π i e k 1 α 0 i e k α k k 1 d k 2 π i e k 1 α e k 1 α k 1 α i e w w d w 2 π i e k 1 α e k 1 α e 1 k 1 α 39 i 2 0 e k α k k 2 d k 0 i e k α k k 2 d k e k 2 α k 2 α i e w w d w e k 2 α e 1 k 2 α in summary when θ 0 ν control factor h mn is expressed as 40 h 1 n 1 re k 1 α n 0 im k 1 α n 0 0 e l s e h 2 n 1 re k 2 α n 0 im k 2 α n 0 0 e l s e 3 numerical implementation the integration of 3dtp source over panel is outlined and analytically performed as is mentioned above although the panel source green s function and its derivatives are single integrals of θ which is conducive to numerical calculation there are still some integral difficulties and need to be treated skillfully 3 1 singularity related to θ π 2 the wave numbers k 1 and k 2 in eq 3 are associated with the pulsating effect and translating effect respectively they are functions of θ moreover the denominators of k m is equal to zero if θ π 2 which brings singularity typical images of k m are presented in fig 5 for τ 0 25 τ 0 25 and τ 0 25 xu and dong 2011 it is indicated that θ π 2 is a removable discontinuity point of k 1 if k 1 is equal to ω e 2 g at θ π 2 and expressed as follows the singularity of k 1 can be eliminated 41 k 1 4 ω e 2 g 1 1 4 τ cos θ 2 however k 2 trends to infinity at θ π 2 resulting in numerical difficulty according to eqs 26 29 the terms 1 k 2 e k 2 α n k 2 e k 2 α n e k 2 α n e 1 k 2 α n k 2 e k 2 α n e 1 k 2 α n or their combinations are related to k 2 in the panel source green s function among them the first three term trend to zero at θ π 2 yang et al 2019 the last two terms related to k 2 can be written as e z e 1 z and z e z e 1 z if z is set equal to k 2 α n obviously z trends to infinity at θ π 2 the exponential integral function e 1 z have the following asymptotic expansions abramowitz and stegun 1964 42 e 1 z e z z n 0 1 n n z n thus e z e 1 z and z e z e 1 z trend to 0 and 1 respectively at θ π 2 through the above analysis and mathematical treatment the singularity of k m can be eliminated and no difficulties will be introduced into the integral calculation 3 2 singularity related to θ ν if τ 0 25 ν is the zero point of the denominator of integrand in the analytical integral expression of the panel source green s in order to eliminate the singularity the integral interval 0 π is divided into 0 ν ν π by performing t cosθ eq 24 can be converted into the following form 43 s g f 1 π m n 1 2 0 ν ν π 1 m 1 k m n θ 1 4 τ cos θ d θ 1 π m n 1 2 0 ν 1 m 1 k m n θ i 4 τ cos θ μ d θ 1 π m n 1 2 ν π 1 m 1 k m n θ 4 τ μ cos θ d θ t cos θ 1 π m n 1 2 μ 1 1 m 1 k m n cos 1 t i 4 τ 1 t t μ 1 t d t 1 π m n 1 2 1 μ 1 m 1 k m n cos 1 t 4 τ 1 t t 1 μ t d t where μ 1 4 τ it is obviously observed that the formula have the form a b f u u a b u d u according to the lobatto rule xu and dong 2011 the integral of this form can be transformed into 0 π f b a 2 b a 2 cos χ d χ by performing u b a 2 b a 2 cos χ thus the singularity at the end points can be eliminated similarly the singularity of the derivatives of the analytical integral expression eq 25 at θ ν can be eliminated 3 3 calculation of complex exponential integral e 1 z a fraction polynomial hess and smith 1962 is used to evaluate complex exponential integral e z e 1 z 44 e z e 1 z m n d ε z where m 1 m 1 z m 2 z 2 m 3 z 3 m 4 z 4 ln z n γ 0 99999207 n 1 z n 2 z 2 n 3 z 3 n 4 z 4 n 5 z 5 d 1 d 1 z d 2 z 2 d 3 z 3 d 4 z 4 d 5 z 5 d 6 z 6 γ 0 5772156649 is the euler s number ε 7 10 6 and through the above numerical treatments all the singularities in the analytical expression of the panel source green s function can be eliminated and the corresponding integrands can be calculated by elementary functions moreover the integral respect to θ can be performed by an adaptive iterative integration based on simpson s rule davis and rabinowitz 2007 consequently we can obtain the integral of the 3dtp source green s function over the panel m1 0 23721365 n1 1 49545886 d1 0 76273617 m2 0 020654300 n2 0 041806426 d2 0 28388363 m3 0 00076329700 n3 0 03000591 d3 0 066786033 m4 0 0000097687007 n4 0 0019387339 d4 0 012982719 n5 0 00051801555 d5 0 00087008610 d6 0 00029892040 4 numerical results and discussions to validate present analytical expression of havelock form panel source green s function and the corresponding numerical implementation various panel integrals of g f and its partial derivatives are performed a vertical rectangular panel and a horizontal triangular panel are chosen as the integral panel as is show in fig 6 the vertical rectangular panel has a side length of 1 0 and the center of mass is located at 0 0 0 0 0 51 the unit outer normal is directed along the y axis the coordinates of nodes on horizontal triangular panel are q 1 0 2 0 1 0 01 q 2 0 1 0 1 0 01 and q 3 0 1 0 2 0 01 the calculations are performed for a field point p located on the three different axis for the integral of g f over the vertical rectangular panel the rectangular panel is decomposed into two triangles since the numerical treatment of panel source green s function varies with brard number τ 0 28 and f n 0 20 is used for numerical validation in the case of τ 0 25 which is the same calculation condition as maury 2001 τ 0 20 and f n 0 10 is chosen for numerical validation in the case of τ 0 25 just like the numerical calculation made by liang et al 2016 numerical results are illustrated in figs 7 11 for comparison the same panel integrals is performed by the traditional gauss legendre quadrature with various number of gauss points n1 n2 gauss points in the figures indicates that n1 rows of gauss points are distributed in the vertical direction and n2 columns of gauss points are distributed in the horizontal direction for the integral of g f over the horizontal triangular panel τ is set to 0 15 and f n is set to 0 30 numerical results of present panel source green s function are compared with that of gauss legendre quadrature as is illustrated in figs 12 14 before performing the gauss legendre quadrature the triangular panel is mapped into a unit rectangle in ξ o η plane firstly as is shown in fig 3 n1 and n2 in figs 12 14 represent the number of gauss points in the horizontal and vertical directions on the ξ o η plane respectively moreover a in house fortran code of line segment source method liang et al 2016 is developed by our research group the corresponding numerical calculations are performed and the convergent numerical results are added for comparison for the integral of g f over the vertical rectangular panel it is shown that the numerical results of present panel source green s function is identical to the existing results of maury 2001 and liang et al 2016 which means the present method is reliable and feasible in numerical calculation while for the results of gauss legendre quadrature convergence is divided into two categories far from the panel the gauss legendre quadrature induces very low errors with few gauss points nevertheless close to the panel numerical integral with gauss legendre quadrature leads to some errors and even 20 20 gauss point is unable to give accurate results close to y 0 for the integration of the derivatives of g f as is shown in figs 8 and 10 this is because g f and its derivatives are violently oscillating in space and when the field point is close to the source point the oscillation phenomenon is intensified as is shown fig 2 besides figs 9 and 11 indicate that a simple gauss legendre quadrature can t obtain a good accuracy when the field point is close to the free surface only analytical integral method can give correct results in addition the derivatives of g f imply more difficulties to be integrated than g f itself by the numerical quadrature this is because the integrand f n θ k of the partial derivative of g f has one more coefficient k than the integrand f n θ k of g f as shown in eq 2 and 4 if e k p n q n in the integrand f n θ k and f n θ k is regarded as the oscillation function and the remaining part is regarded as the oscillation amplitude the oscillation of f n θ k is much larger than that of f n θ k in the fourier plane when k is large which makes the oscillation of the partial derivative of g f in space is much large that of g f as is shown in fig 2 above this accounts for why the derivatives of g f imply more difficulties to be integrated than g f itself for the integral of g f over the horizontal triangular panel since the triangular panel is very close to the free surface and the field point is on the free surface fig 12 shows that gauss legendre quadrature cannot obtain the convergent numerical results this is consistent with the conclusion that the numerical quadrature cannot give correct results for a panel and a collocation point close to the free surface guilbaud et al 2001 and it is the reason why many scholars develop various forms of panel source green s function by contrast the numerical results of present panel source green s function are in good agreement with that of the line segment source the numerical results obtained by the gauss legendre quadrature of 40 40 gauss points can t be consistent with the numerical results of these two methods this once again proves the reliability and feasibility of the present panel source green s function in addition table 2 shows the total time for g f and its derivatives to be integrated on the horizontal triangle panel above using the numerical quadrature and the present panel source method when the field points are distributed on the x axis y axis and z axis respectively here the havelock form green s function is used as the point source in the numerical quadrature the calculation interval for the field point distributing on x axis is 2 0 0 0 with a step size of 0 001 the calculation interval on the y axis is 0 0 10 0 with a step size of 0 01 the calculation interval on the z axis is 1 0 0 0 with a step size of 0 001 all the calculations are run on a personal computer with an intel core i7 8700 with cpu clock of 3 19 ghz as can be seen from table 2 it takes only an average of milliseconds to complete the numerical calculation of a havelock form translating pulsating panel source green s function which meets the calculation efficiency requirements of the actual project moreover compared with the numerical quadrature the present panel source green s function can significantly improve the calculation efficiency while obtaining higher calculation accuracy when it is used to calculate the integral of g f over panel table 3 shows the total time for g f and its derivatives to be integrated on the vertical rectangular panel above using the present panel source method when the field points are distributed on the x axis y axis and z axis respectively for the case τ 0 28 and f n 0 20 the calculation interval for the field point distributing on x axis is 12 0 6 0 with a step size of 0 01 the calculation interval on the y axis is 0 0 10 0 with a step size of 0 01 the calculation interval on the z axis is 1 0 0 0 with a step size of 0 001 for the case τ 0 20 and f n 0 10 the calculation interval for the field point distributing on y axis is 3 0 3 0 with a step size of 0 01 the calculation interval on the z axis is 1 0 0 0 with a step size of 0 001 5 concluding remarks in the present paper an analytical expression of havelock form panel source green s function and its derivatives are derived and the corresponding numerical implementation is presented detailedly to facilitate the integral calculation the triangular panel is mapped into a unit rectangle the integral of the integrand is performed analytically over the unit rectangle firstly then the integral respect to k is carried out and contour integration method is adopted if necessary after eliminating all the singularities of the integrand the integral respect to θ can be performed by an adaptive iterative integration the conclusions can be drawn as follows 1 the havelock form panel source green s function is proposed and the corresponding numerical implementation method is supplemented in addition the derivation process of the control factor h mn related to the wave component in the havelock form green s function is elucidated in detail 2 compared with the numerical quadrature the panel source green s function can significantly improve the calculation efficiency while obtaining higher calculation accuracy 3 the derivatives of g f oscillates more violently in space than g f itself the numerical results show that the integral results of derivatives of g f improved much more than g f itself by using panel source green s function 4 numerical quadrature cannot give correct results for a panel and a field point close to the free surface even if a large number of point sources are distributed on the panel numerical results prove the accuracy and feasibility of present analytical integral expression nevertheless greater efforts should be made for future improvement for example numerical approximation to the local flow component or wave component of the havelock form panel source green s function can be made thus greatly improving the computational efficiency credit authorship contribution statement shan huang writing original draft writing review editing software validation visualization resources renchuan zhu conceptualization methodology liang hong software declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china grant no 51579147 appendix a the calculation of l e k α n 2 k k 1 k k 2 d k since 1 k k 1 k k 2 1 k 1 k 2 m 1 2 1 m 1 1 k k m we can obtain a 1 l e k α n 2 k k 1 k k 2 d k 1 k 1 k 2 m 1 2 1 m 1 l e k α n 2 k k m d k b the calculation of l d k 0 1 e k p n q n a k k 1 k k 2 d η since 1 k k 1 k k 2 1 k 1 k 2 m 1 2 1 m 1 k m k k k m 1 we can obtain a 2 l d k 0 1 e k p n q n a k k 1 k k 2 d η 1 k 1 k 2 m 1 2 1 m 1 k m l d k 0 1 k e k p n q n a k k m d η 0 1 d η l e k p n q n a d k 1 k 1 k 2 m 1 2 1 m 1 k m 1 q n 2 q n 1 l e α n 2 e α n 1 k k m d k 0 1 1 p n q n a d η 1 k 1 k 2 q n 2 q n 1 m 1 2 1 m 1 k m l e α n 2 e α n 1 k k m d k ln α n 2 ln α n 1 1 k 1 k 2 q n 2 q n 1 m 1 2 1 m 1 k m l 1 2 1 l l e α n l k k m d k ln α n l 
