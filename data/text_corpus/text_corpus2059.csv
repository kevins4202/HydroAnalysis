index,text
10295,the generalized effective global optimization ego method based on kriging model can sequentially solve the expensive black box problems however it can only obtain one sampling point in a cycle which will result in more time spent on expensive function evaluations and affect the global convergence to this end a kriging based adaptive global optimization method with generalized expected improvement kago gei is proposed it divides the enhanced generalized expected improvement gei criterion which recursively changes in the iterative process into double objectives and then uses multi objective pso method to optimize the two objectives to produce the pareto frontier further more valuable sampling points from pareto frontier are screened and corrected as the expensive evaluation points for updating kriging model test results on eighteen benchmark functions and crop evapotranspiration calculation example show that the proposed method is superior to other classical optimization methods in terms of convergence and accuracy in most cases keywords kriging surrogate model global optimization generalized ei crop evapotranspiration 1 introduction with the development of science and technology actual problems become more and more complex an engineering experiment such as the calculation of crop evapotranspiration usually takes hours or even days to complete an experimental test in addition the whole experimental process is usually a black box model with unknown expression these expensive models could not be directly realized by traditional optimization algorithm the emergence of surrogate models can effectively solve such problems it uses mathematical expression to approach the expensive and complex real model effectively and uses the potential information in the design problem for rapid evolution so as to complete the approximate global optimization with as few expensive evaluation sample data as possible its main advantage is that it can reduce a lot of time consumption and improve the optimization efficiency and accuracy under the same number of sample data the commonly used surrogate models myers et al 2016 zhang et al 2020 involve polynomial response surface prs hosder et al 2001 radial basis function rbf leonard et al 1992 support vector regression svr awad and khanna 2015 mars multivariate adaptive regression splines lewis and stevens 1991 and kriging stein 2012 martin and simpson 2005 hao et al 2018 2020 prs with high approximation efficiency can directly identify the characteristics of different design factors from the coefficients of standardized regression model but it is only suitable for low dimension engineering problems rbf is an interpolation model which uses weight sum of the kernel function to approximate black box problems it has a simple construction good approximation effect of high dimensional problems and effective processing of discrete data its approximate accuracy is between prs and kriging as an extension of rbf svr can easily choose between expected accuracy and robustness which is more suitable for the problem of historical data intensive mars is a kind of regression method with strong generalization ability and special for high dimensional data however with the expansion of sample space it is difficult for mars to divide space effectively and recursive partition makes the model lack of continuity kriging model can adjust the weight coefficient and variance of each kernel function and its gaussian correlation function has different variance in each dimension direction to adapt to the complexity and scale of different problems this direction difference makes kriging model have higher approximation accuracy in addition kriging can also predict the estimated variance of unknown points to provide a more promising search direction some global optimization algorithms carpio et al 2017 passos et al 2017 pedrielli and ng 2016 li et al 2019 2017 saad et al 2019 li et al 2018 based on kriging model has been developed and applied rapidly however most of the optimization algorithms can only get one candidate point in each iteration cycle for engineering problems that need the same expensive evaluation candidate points they will spend more optimization time than the optimization algorithm that obtains multiple sampling points at a time for example a two dimensional problem needs 60 sampling points if it takes 10 h to get an expensive evaluation for each sampling point the total time consumption is 600 h without considering the optimization algorithm time if each iterative optimization can obtain four sampling points evaluated in parallel the total time is 150 h which saves one quarter of the original time in addition multimodality and high dimensionality of infill sampling criterion may result in low search efficiency and poor convergence performance for single point optimization sampling to overcome these difficulties yang et al 2019 proposed an effective surrogate assisted pso particle swarm optimization algorithm combining local and global kriging models the global kriging mainly predicts the fitness value and improves the search efficiency while the local search mainly finds the predicted local optimal solution to construct the local kriging by extending the generalized ego algorithm and adopting the constant liar strategy a kriging based multi point unconstrained global optimization method li et al 2020 is used to solve the expensive black box problem to obtain multiple update points an adaptive space reduction algorithm akbari and kazerooni 2020 based on kriging is proposed for complex black box constrained optimization according to the flexible decision variables a new measurement method is used to adaptively reduce the design interval centered on the current optimal solution and the multi point optimization sampling is carried out in the design subspace based on the weighted constraint expectation improvement ei criterion by introducing a p ei function to search multiple peaks of ei to obtain multiple sampling points near these peaks and combining with effective design domain simplification technology a global optimization strategy based on kriging and parallel computation xing et al 2020 is proposed for multi point sampling based on multi objective optimization sun et al proposed two different parallel multi objective ego algorithms sun et al 2020 the filling sampling criterion formed by kriging believer and multiple good local optima strategy can realize parallel computing and compromise exploitation and exploration for global optimization a multi objective evolutionary algorithm ma et al 2020 based on kriging and transfer matrix is proposed it uses the transfer matrix to reduce the number of optimization targets thus simplifying the optimization process and uses the fast nondominated sorting and the farthest candidate selection to ensure the diversity of sampling data koziel et al 2018 proposed a cost effective multi objective optimization method and applied it to antenna design it uses auxiliary data driven kriging multi objective evolutionary algorithm of initial pareto frontier recognition design optimized response correction technology and generalized domain segmentation method to complete the purpose of selecting the best sample from pareto frontier edge in kriging based double goal constrained optimization li et al 2019 two optimization objectives are mainly constructed by using prediction objective maximum feasible probability and mean square error generated by kriging model and then pareto optimal frontier is obtained by multi objective solver finally the frontier data is further screened to obtain candidates of expensive evaluation however this method only completes the global optimization through the ei criterion under the condition of ensuring the maximum feasibility and it does not fully consider the possibility of falling into the local optimal region due to the underestimation of the predicted points by ei in addition a multi objective robust spatial fuzzy clustering algorithm zhao et al 2019 based on kriging and reference vector guidance is proposed to reduce the computational complexity of multi objective evolutionary optimization clustering algorithm and successfully applied to image segmentation by using the hyper volume ei of the non dominated solution front and the feasibility probability of new candidates a new infilling sampling criterion in kriging based multi objective constraint optimization martínez frutos and herrero pérez 2016 is proposed to complete optimization sampling however only a few of the above methods can deeply mine kriging s potential estimated information and make full use of their effective combination to decrease expensive evaluation number and improve optimization accuracy and the convergence efficiency in addition the multiple sampling data obtained by these multi point sampling criteria do not contain a large amount of promising information if we do not use some filtering methods or correction methods and directly estimate these sample data and add them to the sample set the final optimization accuracy of the algorithm will be affected to solve this problem a kriging based adaptive global optimization method with generalized expected improvement is proposed the generalized expectation improvement ei criterion which is changed recursively in the iterative process is divided into an objective function with a probability normal distribution and an objective with a probability density the objectives will be maximized by multi objective pso algorithm to obtain the pareto frontier pareto frontier has a lot of data points to balance these two optimization objectives and all of them do not necessarily meet the requirements of optimization design therefore the sampling points from pareto frontier are further screened and corrected as more promising expensive evaluation points for updating kriging model finally test results on eighteen benchmark functions and crop evapotranspiration application example show that the kago gei method is superior to other classical optimization algorithms in terms of efficiency and convergence in most cases the structure of this paper can be summarized as follows section 2 mainly describes the characteristics of kriging surrogate model the proposed method in detail is shown in section 3 the fourth section tests and analyzes the benchmark function and application example finally the conclusion is given 2 kriging model kriging model composed of trend function e ω and random process z x simpson et al 2001 is written as 1 y x e ω z x where matrix e is composed of regression function e i x j i 1 p j 1 m the vector ω is formed by the coefficients on regression functions when e ω is equal to 0 μ and i 1 p ω i e i x they correspond to simple kriging ordinary kriging and standard kriging respectively the function z x is the realization of a stochastic process with zero mean and nonnegative covariance of 2 c o v z x i z x j σ 2 r θ x i x j the parameter θ and σ 2 are respectively correlation coefficient vector and process variance for n dimensional problem the spatial correlation function r θ x i x j expressing a correlation between point x i and point x j is shown as eq 3 the n represents the dimension of the optimization problem and k is a scalar from 1 to n 3 r θ x i x j k 1 n r k θ k x k i x k j the regression term e ω y based on the unbiased estimator has a generalized least squares solution and maximum likelihood estimation of variance see eq 4 4 ω ˆ e t r 1 e 1 e t r 1 y σ ˆ 2 1 m y e ω ˆ t r 1 y e ω ˆ the matrix r m m is composed of r θ x i x j i j 1 m the predicted objective and mse ju et al 2006 for kriging at any point x is shown as eq 5 and eq 6 respectively 5 y ˆ x e ω ˆ r t x γ ˆ 6 s ˆ 2 x mse y x σ ˆ 2 1 e x t r x t 0 e t e r e x r x where r t x r θ x x 1 r θ x x m γ ˆ r 1 y e ω ˆ 3 kago gei method 3 1 enhanced gei criterion the ego jones et al 1998 method can explore a global approximate optimal solution by maximizing infill sampling criterion ei the reasonable selection of ei expression plays an important role in the optimization process the key parts of ei criterion mainly include the objective and standard error of kriging model for unknown point in the iteration process for the objective y x at an unknown point x the improvement for y min a minimum function value in sampled data is formed as 7 i x max 0 y min y and then the ei is expressed by 8 e i x y min y min y ϕ y d y in this formula function ϕ representing uncertainty on y is the normal probability density function kriging model usually adopts gaussian stochastic process to express uncertainty for kriging objective estimation y ˆ eq 5 standard deviation prediction s ˆ eq 6 of any point and the normal cumulative distribution function φ the ei in formula 8 can be further organized as 9 e i x y min y ˆ φ y min y ˆ s ˆ s ˆ ϕ y min y ˆ s ˆ when s ˆ 0 0 when s ˆ 0 ego has been widely used and researched the design point corresponding to a larger ei is usually expected to locate in an under sampling area or a better area near the current optimal solution however balancing exploitation and exploration has always been a concern ego relies on the standard deviation predicted by kriging model to make the method return and explore areas where the sampling points are sparse however ego regards kriging s estimated standard deviation as an accurate prediction which is not the case after all the samples used to build the kriging model may be extremely deceptive which generally underestimates the kriging prediction error for some complex multi peak or high dimensional problems this may cause optimization performance to decrease with the increase of iteration number the multimodality of the ei and the kriging model itself will rapidly increase the optimization time to overcome these challenges it is necessary to further study the broad ei criterion in most black box approximation problems the standard error of kriging s prediction of unknown points is usually slightly lower than its true error value unless the uncertainty of the current region becomes very low this lower estimate will result in more exploration time in the sampling process of the locally optimized region which is easy to ignore the global development of other unknown regions in order to improve such situation combining with the integer quality factor g generalized improvement schonlau et al 1998 sasena et al 2002 as shown in eq 10 is introduced 10 i g max 0 y min y g then the corresponding generalized ei gei can be stated as 11 e i g s ˆ g k 0 g 1 k g k g k y min y ˆ s ˆ g k t k when k 2 t 0 φ y min y ˆ s ˆ and t 1 ϕ y min y ˆ s ˆ or else the parameter t k can be recursively calculated by 12 t k y min y ˆ s ˆ k 1 ϕ y min y ˆ s ˆ k 1 t k 2 although eq 12 seems more complex it is easy to calculate in addition kriging model is an interpolation model the standard deviation of any known sampling point is zero and it has a large error value far away from all known sampling points therefore the constant change of the factor g can adaptively compromise exploration and exploitation in general exploration usually makes small gei have large probability while exploitation usually makes large gei have small probability when the parameter g keeps increasing the large gei can make the search direction more global even if it has a small probability on the contrary a small g tends to make the search direction get into a local region if the parameter g can change continuously according to the change of kriging model parameters then the search direction of generalized ego method will be adaptively selected according to the quality factor 13 slice f x 1 x 2 x 3 x 1 e x 1 2 x 2 2 x 3 2 x 1 x 2 x 3 2 2 dixon price14 f x x 1 1 2 i 2 14 i 2 x i 2 x i 1 2 x i 2 2 1 i 1 10 10 to this end taking the slice function and dixon price14 function in eq 13 as examples we study the relation between the quality factor g and relevant parameter θ twelve and forty two initial points are respectively sampled then one sampling point is added at a time by the method of maximizing mse finally kriging models are re established by all sampling points to obtain different relevant parameters the 2 norm change processes of relevant parameter θ are shown in fig 1 the part enclosed by the ellipse in fig 1 b is enlarged to clearly see its changing trend the abscissa represents the number of sampling points and the ordinate represents the 2 norm of relevant parameter θ as can be seen from the two figures the changes of the objective in the initial stage of the optimization sampling are extremely fierce which shows that the optimization process needs to constantly jump out of the current optimization area and go to some more promising areas for optimization however with the increasing number of new sample data although the relevant parameters θ have few jumping the overall change tends to be stable which shows that the optimization problem has entered a better basin region or kriging model accuracy has reached a certain requirement so the 2 norm change of relevant parameter θ and the quality factor g have a good similarity to a certain extent therefore it may be reasonable to take the 2 norm of the parameter vector θ of kriging model as parameter g in reference li et al 2020 the equation g round θ i 2 is used to generate parameter g when the i th sampling point is added however it is greater complex or multimodal for higher dimensional optimization problems which requires the infilling sampling criterion to have greater globality during spatial search in view of this a magnification coefficient ζ being equal to the dimension and the 2 norm of correlation vector are used together to further improve g the description is shown in eq 14 14 g 1 ζ round θ i 2 the larger the parameter ζ the larger the value of g 1 it will offer the optimized search algorithm more opportunities to focus on the unexplored areas thereby improving the global search capability however when theta value becomes smaller even if there is a larger ζ more attention will be paid to a local optimal region therefore the purpose of using the parameter g is to better balance the global and local search capabilities to a certain degree however when the dimensionality of the optimization problem is relatively high too large parameter ζ may cause the parameter g 1 to become larger in this case blindly considering the global search may weaken the local search ability to ensure that parameter g is not too large to make it impossible to search for a local area it is restricted to the interval 0 15 through the related analysis of reference sasena et al 2002 and specific expression is shown in eq 15 15 g 15 g 1 min g 1 max g 1 min g 1 where max g 1 and min g 1 is respectively the maximum value and minimum value of the range of g 1 for a 16 dimensional problem we use the default interval 0 1 20 of each element in the theta variable given by the dace toolbox then the 2 norm range of theta is 0 80 the corresponding interval range of g 1 becomes 0 16 80 i e max g 1 16 80 min g 1 0 the definition of formula 15 limits the value range of g value to 0 15 it can effectively avoid the situation where ζ is large and the g value becomes large it can effectively avoid the appearance of excessive g value 3 2 construction of optimization objectives set v y min y ˆ s ˆ when g is equal to 1 2 3 formula 11 can be expressed as 16 e i 1 s ˆ v φ v s ˆ ϕ v e i 2 s ˆ 2 v 2 1 φ v s ˆ 2 v ϕ v e i 3 s ˆ 3 v 3 3 v φ v s ˆ 3 v 2 2 ϕ v the first term of eq 16 is the difference between the current real minimum value and the estimated value multiplied by the probability that the estimated value is less than the minimum value and when the estimated value is less than the minimum value there is a greater probability the second term is related to global search which usually helps to find sparse areas with high uncertainty especially when the predicted value itself has a large uncertainty the latter term will become very large through the above analysis it is appropriate to optimize these two items for multi objective optimization for the sake of generality the general expression of gei eq 17 can be obtained by recursively deriving eq 16 17 e i g s ˆ g k 0 g 2 g 2 k v g 2 k 2 k 1 2 k 3 1 φ v g 1 s ˆ g k 0 g 1 2 g 2 k 1 v g 2 k 1 v 2 k 2 k v 2 k 2 2 k 2 k 2 2 v 0 k 1 g 2 g 2 k v g 2 k v 2 k 1 2 k 1 v 2 k 3 2 k 1 2 k 3 3 v 1 ϕ v the symbol in eq 17 represents the largest integer that does not exceed the parameter the first term in gei is represented by g 1 and the remaining term is represented by g 2 then this multi objective optimization problem can be expressed by formula 18 as an optimization toolbox multi objective pso method is used to optimize the two objectives and generate sample data from the pareto frontier 18 max g 1 g 2 3 3 further selection of pareto frontier data although the multi objective pso algorithm can obtain the pareto frontier sets of balanced g1 and g2 not all data points are suitable for adding to the sample as new expensive evaluation points the main reason can be explained from two aspects ⅰ if the distance between two sampling points in the pareto frontier is too close the correlation matrix r eq 4 of the kriging model is singular which makes the construction of the kriging model fail ⅱ the optimization based on the kriging model hopes to achieve higher precision convergence with as few expensive evaluation points as possible which requires each expensive evaluation sampling point to have as much potential information as possible therefore further selection of pareto frontier data is necessary the next two steps will complete the specific screening and adjustment process step 1 as shown in fig 2 three point screening correction method are used to select candidate points which will be obtained through the following two sub steps step 1 1 as is well known the real purpose of maximizing ei criterion in eq 9 is to find a sampling point that has both a small objective function value and a large standard deviation therefore ei as a depth screening criterion can further enrich the amount of information contained in each sampling point based on the above analysis we will calculate the ei value of each sampling point and then select the sample with maximum ei values as the first point a in fig 2 a at the same time the first point a is also the first candidate point for expensive evaluation step 1 2 generate other two promising candidate points when the two limit points point b and c in fig 2 a from pareto frontier have no potential information they may be selected for calibration for a two dimensional problem we take point b as an example to explain the selection process of candidate points in detail as shown in fig 2 b we assume that the coordinate value of the limit point b of the maximum target g2 is x 1 x 2 next we will break away from the pareto frontier and consider g2 alone firstly let x 2 be a design variable while keep x 1 unchanged i e x 1 is a constant then pso algorithm is used to maximize g2 x 2 to get the new sampling point b1 x 1 x 21 similarly let x 1 be a design variable and keep x 2 unchanged another sampling point b2 x 11 x 2 is also obtained finally formula 9 is used to calculate the ei values of the points b b1 and b2 and the one being largest ei value in these three points will be eventually selected the selection of the third candidate is the same as that of the second candidate point step 2 determine whether the untried sample point x i among the three candidate points is reserved as an expensive evaluation point the sign x l and x u are the lower and upper bounds of the current function boundary constraints respectively x j j 1 m is any known sampling point then the distance screening criterion can be expressed by formula 19 19 x i x j x u x l 0 001 d m e a n where d m e a n d max d min 2 parameter d max and d min represent the maximum distance and minimum distance between all existing sampling points respectively when the candidate point x i satisfies the formula 19 the x i will be accepted as an expensive evaluation point otherwise it means the distance between x i and x j is very close which may result in the correlation matrix to be ill conditioned and the failure construction of kriging model in this respect the candidate point x i will be discarded 3 4 implementation kago gei method for kago gei method sections 3 1 3 2 and 3 3 introduce the improved gei criterion the construction process of two optimization objectives and further selection of pareto frontier data but a complete algorithm still requires many auxiliary parts such as the initial sampling design multi objective optimization method algorithm stopping criterion etc therefore this section mainly describes the specific implementation of the proposed algorithm in detail the basic flow of the kago gei method is shown in fig 3 to ensure the smooth operation of the algorithm flow in fig 3 table 1 sets or assigns input and output parameters in addition according to fig 3 the specific steps of the proposed method will be described in detail in the following steps step 1 initial design use latin hypercube sampling method to generate 2 d 1 initial sampling points and then perform real objective function evaluations i e expensive black box function evaluations on these sample and finally these sampling points and estimation results are stored in the sample sets x and y so as to prepare for the construction of kriging surrogate model in addition the current optimal solution needs to be found from the sample sets x and y and assigned to x best and y best respectively step 2 update sample data set x and y for the initial sampling points obtained directly by latin hypercube sampling we can directly use the x and y given in step 1 to establish the kriging model however the kago gei optimization is a cyclic process of increasing sampling points which also needs to constantly update the sample data x and y to improve the accuracy of global optimization using the kriging model in this condition all the updated sample data will be used to build a new kriging model step 3 whether the algorithm is terminated in order to facilitate the comparison with the optimization performance of other algorithms the kago gei algorithm will use the optimization stop criterion with maximum expensive evaluation number nmax in table 1 when the total number of expensive valuations including the initial latin hypercube sampling reaches nmax the optimization process will be terminated otherwise the next cycle will be re entered step 4 construct kriging model combining the gaussian correlation kernel function the relevant parameter θ θ i 0 1 20 and the latest sample data x and y the kriging model can be established using the dace toolbox step 5 iterative process sampling it is the core part of the kago gei method and mainly includes the following four sub steps step 5 1 use kriging s correlation vectors and parameter estimates to build enhanced gei according to formula 15 the magnification coefficient and the relevant parameter vector θ can be used to adaptively change the quality factor g during the iterative optimization process its variability is effectively combined with the gei in formula 11 to form an enhanced gei criterion which maximizing can better balance the overall situation and report search behavior for more detailed construction process please refer to section 3 1 step 5 2 construct two optimization objectives g1 and g2 according to this gei criterion combining with formula 17 we can divide the improved gei obtained in step 5 1 into two optimization objectives g1 and g2 containing cumulative distribution function and probability density function respectively for detailed description and expression please refer to section 3 2 step 5 3 optimizing g1 and g2 by multi objective pso algorithm to produce pareto frontier set the two objectives generated by step 5 2 will be optimized by the multi objective particle swarm algorithm zhang et al 2018 and generate a pareto frontier set step 5 4 use the given criteria to further select the data from the pareto frontier use three point screening correction method and the distance screening criterion to further filter the data from the pareto frontier to obtain the expensive valuation point s with the best potential value see section 3 3 for details step 6 real objective function evaluation at new sampling points the selected sample data obtained through the screening in step 5 4 will be evaluated by expensive real objective function and they will be stored in the sample data sets x and y and then turning to step 2 4 experimental studies in order to illustrate the optimization performance of the kago gei method it can be compared with other similar optimization methods the ei in ego jones et al 1998 is an attractive criterion that has been proven to provide a balance between local search and global search however the underestimation of the standard deviation by kriging model will cause the ei based optimization method to have a slower convergence rate by considering the performance and mathematical completeness of ei criterion and compensate for the error underestimation of kriging a multi objective optimization method based on ei pareto frontier criterion and kriging mo ek li et al 2017 was proposed to improve global optimization performance in view of this we compare the proposed method with the ego and mo ek algorithms all tests were performed in matlab2017a by a dell machine equipped with an i7 4790 3 6 ghz cpu and 16 gb ram 4 1 numerical test the basic information of eighteen benchmark mathematical functions is listed in table 2 their specific expressions are referred by the literature jamil et al 2013 bernal e et al 2017 for d dimensional test optimization problem 2 d 2 initial sample data should be generated by lhs to construct initial kriging model the optimization result of an algorithm is not only related to the dimension of the problem but also to its complexity in view of this the test problems are classified into five types many local minima bukin crossintray drop wave eggholder griewank holdertable schaffer and ackley5 bowl shaped trid9 plate shaped zakharov valley shaped rosenbrock10 and other branin hartman3 shekel4 hartman6 styblinskitang7 and f16 the key problem that the global optimization algorithm needs to solve is how to jump out of this area and turn to a more promising area to explore new unknown points when falling into a local optimal area therefore the relative part of the test problem we choose has many local optimal solutions to clearly show the optimization performance of the kago gei method we take the branin function as an example to illustrate in detail fig 4 shows the pareto frontiers at three different stages initial sampling 30 sampling points and final pareto frontier and final optimization results in the pareto frontier formed in the initial sampling stage fig 4 a the absolute values of g1 and g2 are large and all g1 values are greater than zero which means that although there is currently no one smaller than the initial minimum the optimization search performed after the initial sampling will have a greater probability of obtaining a more promising approximate optimal solution when the total number of sampling points increases to 30 the absolute values of the two optimization objectives in the obtained pareto frontier fig 4 b are continuously decreasing which shows that the probability of obtaining a better solution is constantly decreasing in the coordinate direction of g1 it appears multiple negative values which indicates that multiple sampling points with smaller objective values have been found it also reflects the algorithm s strong global search capability for the pareto frontier fig 4 c formed in the final iteration the absolute value of the two targets has become very small and the formed graph has become irregular this not only shows that the probability of finding a better solution is very slim but also shows that the algorithm may have found a global approximate optimal solution that meets certain requirements as we expected from the distribution fig 4 d of 60 sample points it shows that the optimal solution found by the proposed method is very close to the real optimal solution which also shows that the kago gei has better global exploration performance to verify the effect of this method on other test problems the iterative processes ip of the approximate optimal solutions ip aos for all functions are shown in figs 5 22 for each of these 2 dimensional problems there are 6 initial sampling points an initial optimal solution is chosen from these six initial points as the first iteration point there are 54 points 30 d 6 left to sample therefore there a total of 55 sampling points in each of the figures in addition the abscissa represents evaluation of real function and the ordinate represents the currently found global approximate optimal solution the red dotted line representing the actual optimal solution of each test function can more clearly express the difference between the optimal solution obtained by the proposed method and the true optimal solution in figs 5 22 all the optimal solution iteration graphs are descending in steps which shows that the approximate optimal solution is constantly getting smaller in addition the change trend is relatively sharp in the initial stage and becomes more moderate in the later stage which shows that it is easier to obtain more promising sampling points in the early stage and it is relatively difficult to obtain the optimal sampling points in the later stage however this is not always the case when the correction sampling fig 2 finds valuable sampling points there will be some drastic changes in the later stage such as levy8 and f16 functions no matter what type of two dimensional problem a sampling point close to the real optimal solution can be found under the condition of a certain number of actual function valuations especially for any one of the branin crossintray eggholder holder table and schaffer functions the approximate optimal solution found is basically not much different from the actual optimal solution for multi dimensional problems hartman3 shekel4 and hartman6 can basically find a satisfactory approximate optimal solution the quality of these optimal solutions found are not only related to the function dimensions but also closely related to the complexity multimodality and size of the design interval as the dimensionality increases the difficulty of finding sampling points close to real optimal solution will continue to increase but the approximate optimal solution found by most functions can still meet certain design requirements if we add a certain number of sampling points it believed that the proposed method can perform better to further illustrate the superiority of the kago gei method it was tested 40 times with the ego and mo ek methods the three methods are compared in some optimization performance and the results are shown in table 3 in addition to comparing the upper lower and average values of the approximate global optimal solution we also performed the average relative error are or average absolute error aae between the actual optimal solution and the approximate optimal solution and the average actual evaluation times aet when the error is less than 0 01 for the first time to avoid the situation that the relative error is negative because of y min 0 the relative error expression is set as 20 r e y ˆ y min y min when y min 0 the relative error cannot be calculated we may replace the relative error with absolute error in this situation the error formula can be stated as 21 a e y ˆ y min the meanings of the special marks in table 3 are as follows when 40 tests are performed the 40 results of actual function evaluation times will be obtained and then their average value is taken as aet when we are unable to make the error less than 0 01 under the given function evaluation times we will offer a special mark such as 60 when the actual evaluation times required to reach 0 01 error are far greater than the given evaluation times we may mark with except the faster convergence of ego in the initial stage of the test process the kago gei method is significantly better than the ego method in many aspects the main reason is that the first point selected by kago gei method is the point with the largest ei from this point of view the proposed method is similar to ego to some extent however on this basis kago gei method adds two more valuable correction points their addition is the direct reason why the proposed method is better than ego further the proposed method is also superior to the mo ek method in most cases the main reason is that the improved gei criterion can adaptively change the two optimization objectives so that the optimization search direction can be explored towards a more promising area in addition it can be seen from table 3 that the kago gei method always has the smallest aet value this shows that the kago gei method can achieve the requirement of an error less than 0 01 with the least evaluation number it also shows that the method kago gei method takes less time in general the characteristics of the kago gei method can be summarized into the following three points 1 multi objective optimization of the two goals constructed by the enhanced gei criterion can provide a lot of equilibrium points and the further screening and correction of these equilibrium points effectively improve the convergence accuracy of the proposed algorithm this has been reflected in the test results of many benchmark functions 2 in test problems with dimensions not greater than 7 dimensions the quality of the global optimal solution mainly depends on the complexity or multimodality when the dimensions are 7 dimensions and above in addition to being affected by these conditions it also has a greater relationship with the size of the dimension 3 in the iterative optimization process the kago gei method can effectively balance the global and local search behavior in most cases 4 2 example on crop evapotranspiration water is an indispensable basic condition for our human survival and development although the total amount of freshwater resources in our country china currently ranks among the top in the world most of the freshwater resources cannot be obtained from flood runoff or groundwater scattered in remote areas so the actual available freshwater resources are few about a quarter of the world average it is one of the water shortage countries in the world with social development and population growth the water resources on which we depend for survival have become increasingly scarce if it is allowed to develop and does not focus on water conservation then our country is likely to be close to the internationally recognized warning line of severe water shortage in the future in addition our country is a big agricultural country agriculture is the primary industry and it is also a major water user agricultural water accounts for more than 60 of total water consumption therefore the key to ensuring the sustainable use of water resources is to reduce agricultural water use in today s extremely scarce water resources developing water saving agriculture and improving the efficiency of agricultural water use have undoubtedly become safeguard measures to alleviate my country s water crisis in the 21st century and it is also the only way to ensure the sustainable development of my country s agriculture crop evapotranspiration ce is the most important consumption way of agricultural water and it is also the main part of farmland water consumption it is not only the basis for determining crop irrigation systems and regional irrigation water consumption but also an important data for watershed planning water resources utilization management and crop planting zoning layout therefore the study of ce problems has become an important topic of common concern in agronomy hydrology and other related disciplines and fields almost all studies of agriculture and water resources are inseparable from the calculation and analysis of evapotranspiration accurate estimation of crop evapotranspiration has important practical significance for reducing water consumption during crop growth period improving water use efficiency and developing water saving agriculture there have been many researches on the crop evapotranspiration pereira et al 2015 tabari 2010 and there have been many theories and calculation formulas based on the principle of energy balance and the development is relatively mature and complete the principle of energy balance regards crop evapotranspiration as a kind of energy consumption and calculates the evapotranspiration consumption by balancing energy and then converts the energy into water among them the fao penman monteith formula ahmad and choi 2018 mao et al 2002 considering aerodynamics and radiation terms can be expressed as 22 c e 0 0 408 δ r n g γ 900 t 273 u 2 e s e a δ γ 1 0 34 u 2 the meaning of all parameters is stated by table 4 some parameters are directly or indirectly defined in formulas 23 to 27 it is noted that the soil heat flux g is used to increase the amount of heat in the soil temperature usually in days or ten days since the soil heat flux under the cultivation layer of the reference crop calculated in days or ten days is very small it is often ignored as zero 23 δ 4096 0 6108 exp 17 27 t t 273 3 t 273 3 2 24 γ 0 665 10 3 p 0 665 10 3 101 3 293 0 0065 z 293 5 25 25 e 0 t 0 6108 exp 17 27 t t 273 3 26 e s e 0 t max e 0 t min 2 27 e a e 0 t min r h max 100 e 0 t max r h min 100 substituting all parameters into formula 22 the crop evapotranspiration can be expressed as 28 c e 0 1020 75 exp a x 2 273 3 2 x 1 60 3 x 2 273 x 3 0 6108 exp b 0 6108 exp c 2 0 6108 exp c x 6 100 0 6108 exp b x 7 100 2502 exp a x 2 273 3 2 0 067 1 0 34 x 3 where a 17 27 x 2 x 2 273 3 b 17 27 x 4 x 4 273 3 c 17 27 x 5 x 5 273 3 in this work the crop evapotranspiration is used to show that the proposed optimization method can guide or predict design variables key factors in the crop living environment so that the evapotranspiration can get a better solution under a certain environment with the continuous update of the kriging approximation model and the continuous advancement of the iterative optimization process we can also deeply understand the relationship between evapotranspiration and these design variables and find some key factors that affect evapotranspiration by selecting seven key parameters in table 4 as design variables to construct crop evapotranspiration eq 28 a mathematical expression formula that meets certain requirements is established and its optimal solution is found then based on kago gei method the initial sampling points are obtained through lhs the kriging model of approximate evapotranspiration function is established and the decomposed gei is optimized through the pso algorithm to obtain the predicted approximate optimal ce 0 and compare with the actual optimal solution to illustrate the feasibility and stability of the proposed method thus a new forecasting method is provided for crop irrigation water and water resources management according to the execution process of section 3 4 16 initial sampling points are produced by lhs and optimization process will be terminated when the total number of samples reaches 210 the iterative process of the approximate optimal ce 0 is shown in fig 23 and the trend of each design variable is shown in figs 24 30 it can be seen from figs 23 to 30 that the kago gei method can find an appropriate minimum evapotranspiration for the given design variables for x 1 the initial data changes drastically as the iteration point increases it gradually tends to a stable smaller value obviously reducing the amount of solar radiation on the ground can effectively reduce the evaporation of soil water vapor the x 2 x 4 and x 5 are all temperature related design variables as the surface temperature increases soil evaporation increases significantly there is a linear positive correlation between the daily average soil evaporation and the daily average surface temperature when the temperature rises the water molecules in the soil absorb more heat and the movement intensifies causing more water molecules to break free of the gravitational forces between molecules and leave the soil among them the reason for the drastic changes in x 2 and x 5 may be explained as follows 1 the variable range may be too narrow if i expand the variation range of the variables the variable change in a certain area is relatively stable take the variable x 5 as an example if the variable range is set to 10 40 and it only fluctuates between 20 and 30 a suitable temperature for plant growth this may indicate that x 5 is stable or convergent 2 the variables x 2 and x 5 are the average temperature and the minimal temperature respectively too low or too high temperature will have certain side effects on the growth of crops in addition the change of crop evapotranspiration is affected by the joint action of other seven variables so the evapotranspiration optimization within a certain suitable temperature range is also in line with the actual situation therefore the stability of the variables in a certain interval also explains their convergence when x 4 is at the highest temperature the crop evapotranspiration will be greatly increased therefore x 4 basically changes relatively smoothly between 22 and 24 degrees celsius which shows that choosing a suitable temperature is more conducive to reasonable evapotranspiration of crops from the variable x 3 average wind speed at 2 m height it can be seen that low wind speed can effectively reduce crop evapotranspiration and it has an insignificant positive correlation with wind speed it can be seen from the change trend of x 6 and x 7 which are insignificantly negatively correlated with ce 0 that the maximum relative humidity has a significantly higher impact on plant evapotranspiration than the minimum relative humidity according to fig 23 the approximate optimal solution obtained by kago gei method is 3 1960 and the corresponding design variable is 5 65 25 4 0 734 27 24 78 62 according to this design variable a data test was carried out at the corn experimental platform and the actual evapotranspiration obtained was 3 3352 although there is a certain error between the predicted and the actual values this is acceptable within a certain range it illustrates the guiding value and practical significance of the proposed method from another aspect based on the above analysis the following conclusions can be drawn 1 the proposed algorithm only completes the global optimization in a given design domain and the optimal evapotranspiration is only suitable within this boundary constraint however the optimized results show that the kago gei has good convergence and has certain theoretical guiding significance for the evapotranspiration of actual crops 2 judging from the variation range of the seven design variables x 2 x 5 x 6 and x 7 have a greater impact on crop evapotranspiration and are the dominant factors in the design variables which can make crop growers pay more attention to these factors 3 the actual evapotranspiration obtained from the experiment based on the design variables of the approximate optimum also shows that the proposed method has certain practical application significance 5 conclusions to improve the convergence accuracy based on kriging model through multi point sampling a kriging based adaptive global optimization method with generalized expected improvement kago gei is proposed it will recursively change the enhanced generalized expected improvement gei criterion in the iterative process and divide the criterion into two optimization goals then the multi objective pso algorithm is used to optimize the two objectives and obtain the pareto front furthermore the more valuable sampling points from the pareto front are selected through screening correction method and they are used as new and expensive evaluation points for updating the kriging model finally some benchmark functions and crop evapotranspiration calculation examples have been tested the results show that the method is superior to other classic global optimization algorithms in terms of convergence in most cases future research can focus more on the following two aspects one is to adapt the kriging model based optimization to higher dimensional design problems by changing the function expression of the kriging model the other is to establish effective multi point filling sampling criteria based on the kriging model s own correlation estimation target prediction variance and other information to complete the optimization of more complex multi dimensional and multi peak problems declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china no 51775472 and the national mathematics tian yuan special foundation grant no 11926408 scientific and technological innovation talent support in henan province grant no 21hastit027 and the henan excellent youth fund project grant no 202300410346 
10295,the generalized effective global optimization ego method based on kriging model can sequentially solve the expensive black box problems however it can only obtain one sampling point in a cycle which will result in more time spent on expensive function evaluations and affect the global convergence to this end a kriging based adaptive global optimization method with generalized expected improvement kago gei is proposed it divides the enhanced generalized expected improvement gei criterion which recursively changes in the iterative process into double objectives and then uses multi objective pso method to optimize the two objectives to produce the pareto frontier further more valuable sampling points from pareto frontier are screened and corrected as the expensive evaluation points for updating kriging model test results on eighteen benchmark functions and crop evapotranspiration calculation example show that the proposed method is superior to other classical optimization methods in terms of convergence and accuracy in most cases keywords kriging surrogate model global optimization generalized ei crop evapotranspiration 1 introduction with the development of science and technology actual problems become more and more complex an engineering experiment such as the calculation of crop evapotranspiration usually takes hours or even days to complete an experimental test in addition the whole experimental process is usually a black box model with unknown expression these expensive models could not be directly realized by traditional optimization algorithm the emergence of surrogate models can effectively solve such problems it uses mathematical expression to approach the expensive and complex real model effectively and uses the potential information in the design problem for rapid evolution so as to complete the approximate global optimization with as few expensive evaluation sample data as possible its main advantage is that it can reduce a lot of time consumption and improve the optimization efficiency and accuracy under the same number of sample data the commonly used surrogate models myers et al 2016 zhang et al 2020 involve polynomial response surface prs hosder et al 2001 radial basis function rbf leonard et al 1992 support vector regression svr awad and khanna 2015 mars multivariate adaptive regression splines lewis and stevens 1991 and kriging stein 2012 martin and simpson 2005 hao et al 2018 2020 prs with high approximation efficiency can directly identify the characteristics of different design factors from the coefficients of standardized regression model but it is only suitable for low dimension engineering problems rbf is an interpolation model which uses weight sum of the kernel function to approximate black box problems it has a simple construction good approximation effect of high dimensional problems and effective processing of discrete data its approximate accuracy is between prs and kriging as an extension of rbf svr can easily choose between expected accuracy and robustness which is more suitable for the problem of historical data intensive mars is a kind of regression method with strong generalization ability and special for high dimensional data however with the expansion of sample space it is difficult for mars to divide space effectively and recursive partition makes the model lack of continuity kriging model can adjust the weight coefficient and variance of each kernel function and its gaussian correlation function has different variance in each dimension direction to adapt to the complexity and scale of different problems this direction difference makes kriging model have higher approximation accuracy in addition kriging can also predict the estimated variance of unknown points to provide a more promising search direction some global optimization algorithms carpio et al 2017 passos et al 2017 pedrielli and ng 2016 li et al 2019 2017 saad et al 2019 li et al 2018 based on kriging model has been developed and applied rapidly however most of the optimization algorithms can only get one candidate point in each iteration cycle for engineering problems that need the same expensive evaluation candidate points they will spend more optimization time than the optimization algorithm that obtains multiple sampling points at a time for example a two dimensional problem needs 60 sampling points if it takes 10 h to get an expensive evaluation for each sampling point the total time consumption is 600 h without considering the optimization algorithm time if each iterative optimization can obtain four sampling points evaluated in parallel the total time is 150 h which saves one quarter of the original time in addition multimodality and high dimensionality of infill sampling criterion may result in low search efficiency and poor convergence performance for single point optimization sampling to overcome these difficulties yang et al 2019 proposed an effective surrogate assisted pso particle swarm optimization algorithm combining local and global kriging models the global kriging mainly predicts the fitness value and improves the search efficiency while the local search mainly finds the predicted local optimal solution to construct the local kriging by extending the generalized ego algorithm and adopting the constant liar strategy a kriging based multi point unconstrained global optimization method li et al 2020 is used to solve the expensive black box problem to obtain multiple update points an adaptive space reduction algorithm akbari and kazerooni 2020 based on kriging is proposed for complex black box constrained optimization according to the flexible decision variables a new measurement method is used to adaptively reduce the design interval centered on the current optimal solution and the multi point optimization sampling is carried out in the design subspace based on the weighted constraint expectation improvement ei criterion by introducing a p ei function to search multiple peaks of ei to obtain multiple sampling points near these peaks and combining with effective design domain simplification technology a global optimization strategy based on kriging and parallel computation xing et al 2020 is proposed for multi point sampling based on multi objective optimization sun et al proposed two different parallel multi objective ego algorithms sun et al 2020 the filling sampling criterion formed by kriging believer and multiple good local optima strategy can realize parallel computing and compromise exploitation and exploration for global optimization a multi objective evolutionary algorithm ma et al 2020 based on kriging and transfer matrix is proposed it uses the transfer matrix to reduce the number of optimization targets thus simplifying the optimization process and uses the fast nondominated sorting and the farthest candidate selection to ensure the diversity of sampling data koziel et al 2018 proposed a cost effective multi objective optimization method and applied it to antenna design it uses auxiliary data driven kriging multi objective evolutionary algorithm of initial pareto frontier recognition design optimized response correction technology and generalized domain segmentation method to complete the purpose of selecting the best sample from pareto frontier edge in kriging based double goal constrained optimization li et al 2019 two optimization objectives are mainly constructed by using prediction objective maximum feasible probability and mean square error generated by kriging model and then pareto optimal frontier is obtained by multi objective solver finally the frontier data is further screened to obtain candidates of expensive evaluation however this method only completes the global optimization through the ei criterion under the condition of ensuring the maximum feasibility and it does not fully consider the possibility of falling into the local optimal region due to the underestimation of the predicted points by ei in addition a multi objective robust spatial fuzzy clustering algorithm zhao et al 2019 based on kriging and reference vector guidance is proposed to reduce the computational complexity of multi objective evolutionary optimization clustering algorithm and successfully applied to image segmentation by using the hyper volume ei of the non dominated solution front and the feasibility probability of new candidates a new infilling sampling criterion in kriging based multi objective constraint optimization martínez frutos and herrero pérez 2016 is proposed to complete optimization sampling however only a few of the above methods can deeply mine kriging s potential estimated information and make full use of their effective combination to decrease expensive evaluation number and improve optimization accuracy and the convergence efficiency in addition the multiple sampling data obtained by these multi point sampling criteria do not contain a large amount of promising information if we do not use some filtering methods or correction methods and directly estimate these sample data and add them to the sample set the final optimization accuracy of the algorithm will be affected to solve this problem a kriging based adaptive global optimization method with generalized expected improvement is proposed the generalized expectation improvement ei criterion which is changed recursively in the iterative process is divided into an objective function with a probability normal distribution and an objective with a probability density the objectives will be maximized by multi objective pso algorithm to obtain the pareto frontier pareto frontier has a lot of data points to balance these two optimization objectives and all of them do not necessarily meet the requirements of optimization design therefore the sampling points from pareto frontier are further screened and corrected as more promising expensive evaluation points for updating kriging model finally test results on eighteen benchmark functions and crop evapotranspiration application example show that the kago gei method is superior to other classical optimization algorithms in terms of efficiency and convergence in most cases the structure of this paper can be summarized as follows section 2 mainly describes the characteristics of kriging surrogate model the proposed method in detail is shown in section 3 the fourth section tests and analyzes the benchmark function and application example finally the conclusion is given 2 kriging model kriging model composed of trend function e ω and random process z x simpson et al 2001 is written as 1 y x e ω z x where matrix e is composed of regression function e i x j i 1 p j 1 m the vector ω is formed by the coefficients on regression functions when e ω is equal to 0 μ and i 1 p ω i e i x they correspond to simple kriging ordinary kriging and standard kriging respectively the function z x is the realization of a stochastic process with zero mean and nonnegative covariance of 2 c o v z x i z x j σ 2 r θ x i x j the parameter θ and σ 2 are respectively correlation coefficient vector and process variance for n dimensional problem the spatial correlation function r θ x i x j expressing a correlation between point x i and point x j is shown as eq 3 the n represents the dimension of the optimization problem and k is a scalar from 1 to n 3 r θ x i x j k 1 n r k θ k x k i x k j the regression term e ω y based on the unbiased estimator has a generalized least squares solution and maximum likelihood estimation of variance see eq 4 4 ω ˆ e t r 1 e 1 e t r 1 y σ ˆ 2 1 m y e ω ˆ t r 1 y e ω ˆ the matrix r m m is composed of r θ x i x j i j 1 m the predicted objective and mse ju et al 2006 for kriging at any point x is shown as eq 5 and eq 6 respectively 5 y ˆ x e ω ˆ r t x γ ˆ 6 s ˆ 2 x mse y x σ ˆ 2 1 e x t r x t 0 e t e r e x r x where r t x r θ x x 1 r θ x x m γ ˆ r 1 y e ω ˆ 3 kago gei method 3 1 enhanced gei criterion the ego jones et al 1998 method can explore a global approximate optimal solution by maximizing infill sampling criterion ei the reasonable selection of ei expression plays an important role in the optimization process the key parts of ei criterion mainly include the objective and standard error of kriging model for unknown point in the iteration process for the objective y x at an unknown point x the improvement for y min a minimum function value in sampled data is formed as 7 i x max 0 y min y and then the ei is expressed by 8 e i x y min y min y ϕ y d y in this formula function ϕ representing uncertainty on y is the normal probability density function kriging model usually adopts gaussian stochastic process to express uncertainty for kriging objective estimation y ˆ eq 5 standard deviation prediction s ˆ eq 6 of any point and the normal cumulative distribution function φ the ei in formula 8 can be further organized as 9 e i x y min y ˆ φ y min y ˆ s ˆ s ˆ ϕ y min y ˆ s ˆ when s ˆ 0 0 when s ˆ 0 ego has been widely used and researched the design point corresponding to a larger ei is usually expected to locate in an under sampling area or a better area near the current optimal solution however balancing exploitation and exploration has always been a concern ego relies on the standard deviation predicted by kriging model to make the method return and explore areas where the sampling points are sparse however ego regards kriging s estimated standard deviation as an accurate prediction which is not the case after all the samples used to build the kriging model may be extremely deceptive which generally underestimates the kriging prediction error for some complex multi peak or high dimensional problems this may cause optimization performance to decrease with the increase of iteration number the multimodality of the ei and the kriging model itself will rapidly increase the optimization time to overcome these challenges it is necessary to further study the broad ei criterion in most black box approximation problems the standard error of kriging s prediction of unknown points is usually slightly lower than its true error value unless the uncertainty of the current region becomes very low this lower estimate will result in more exploration time in the sampling process of the locally optimized region which is easy to ignore the global development of other unknown regions in order to improve such situation combining with the integer quality factor g generalized improvement schonlau et al 1998 sasena et al 2002 as shown in eq 10 is introduced 10 i g max 0 y min y g then the corresponding generalized ei gei can be stated as 11 e i g s ˆ g k 0 g 1 k g k g k y min y ˆ s ˆ g k t k when k 2 t 0 φ y min y ˆ s ˆ and t 1 ϕ y min y ˆ s ˆ or else the parameter t k can be recursively calculated by 12 t k y min y ˆ s ˆ k 1 ϕ y min y ˆ s ˆ k 1 t k 2 although eq 12 seems more complex it is easy to calculate in addition kriging model is an interpolation model the standard deviation of any known sampling point is zero and it has a large error value far away from all known sampling points therefore the constant change of the factor g can adaptively compromise exploration and exploitation in general exploration usually makes small gei have large probability while exploitation usually makes large gei have small probability when the parameter g keeps increasing the large gei can make the search direction more global even if it has a small probability on the contrary a small g tends to make the search direction get into a local region if the parameter g can change continuously according to the change of kriging model parameters then the search direction of generalized ego method will be adaptively selected according to the quality factor 13 slice f x 1 x 2 x 3 x 1 e x 1 2 x 2 2 x 3 2 x 1 x 2 x 3 2 2 dixon price14 f x x 1 1 2 i 2 14 i 2 x i 2 x i 1 2 x i 2 2 1 i 1 10 10 to this end taking the slice function and dixon price14 function in eq 13 as examples we study the relation between the quality factor g and relevant parameter θ twelve and forty two initial points are respectively sampled then one sampling point is added at a time by the method of maximizing mse finally kriging models are re established by all sampling points to obtain different relevant parameters the 2 norm change processes of relevant parameter θ are shown in fig 1 the part enclosed by the ellipse in fig 1 b is enlarged to clearly see its changing trend the abscissa represents the number of sampling points and the ordinate represents the 2 norm of relevant parameter θ as can be seen from the two figures the changes of the objective in the initial stage of the optimization sampling are extremely fierce which shows that the optimization process needs to constantly jump out of the current optimization area and go to some more promising areas for optimization however with the increasing number of new sample data although the relevant parameters θ have few jumping the overall change tends to be stable which shows that the optimization problem has entered a better basin region or kriging model accuracy has reached a certain requirement so the 2 norm change of relevant parameter θ and the quality factor g have a good similarity to a certain extent therefore it may be reasonable to take the 2 norm of the parameter vector θ of kriging model as parameter g in reference li et al 2020 the equation g round θ i 2 is used to generate parameter g when the i th sampling point is added however it is greater complex or multimodal for higher dimensional optimization problems which requires the infilling sampling criterion to have greater globality during spatial search in view of this a magnification coefficient ζ being equal to the dimension and the 2 norm of correlation vector are used together to further improve g the description is shown in eq 14 14 g 1 ζ round θ i 2 the larger the parameter ζ the larger the value of g 1 it will offer the optimized search algorithm more opportunities to focus on the unexplored areas thereby improving the global search capability however when theta value becomes smaller even if there is a larger ζ more attention will be paid to a local optimal region therefore the purpose of using the parameter g is to better balance the global and local search capabilities to a certain degree however when the dimensionality of the optimization problem is relatively high too large parameter ζ may cause the parameter g 1 to become larger in this case blindly considering the global search may weaken the local search ability to ensure that parameter g is not too large to make it impossible to search for a local area it is restricted to the interval 0 15 through the related analysis of reference sasena et al 2002 and specific expression is shown in eq 15 15 g 15 g 1 min g 1 max g 1 min g 1 where max g 1 and min g 1 is respectively the maximum value and minimum value of the range of g 1 for a 16 dimensional problem we use the default interval 0 1 20 of each element in the theta variable given by the dace toolbox then the 2 norm range of theta is 0 80 the corresponding interval range of g 1 becomes 0 16 80 i e max g 1 16 80 min g 1 0 the definition of formula 15 limits the value range of g value to 0 15 it can effectively avoid the situation where ζ is large and the g value becomes large it can effectively avoid the appearance of excessive g value 3 2 construction of optimization objectives set v y min y ˆ s ˆ when g is equal to 1 2 3 formula 11 can be expressed as 16 e i 1 s ˆ v φ v s ˆ ϕ v e i 2 s ˆ 2 v 2 1 φ v s ˆ 2 v ϕ v e i 3 s ˆ 3 v 3 3 v φ v s ˆ 3 v 2 2 ϕ v the first term of eq 16 is the difference between the current real minimum value and the estimated value multiplied by the probability that the estimated value is less than the minimum value and when the estimated value is less than the minimum value there is a greater probability the second term is related to global search which usually helps to find sparse areas with high uncertainty especially when the predicted value itself has a large uncertainty the latter term will become very large through the above analysis it is appropriate to optimize these two items for multi objective optimization for the sake of generality the general expression of gei eq 17 can be obtained by recursively deriving eq 16 17 e i g s ˆ g k 0 g 2 g 2 k v g 2 k 2 k 1 2 k 3 1 φ v g 1 s ˆ g k 0 g 1 2 g 2 k 1 v g 2 k 1 v 2 k 2 k v 2 k 2 2 k 2 k 2 2 v 0 k 1 g 2 g 2 k v g 2 k v 2 k 1 2 k 1 v 2 k 3 2 k 1 2 k 3 3 v 1 ϕ v the symbol in eq 17 represents the largest integer that does not exceed the parameter the first term in gei is represented by g 1 and the remaining term is represented by g 2 then this multi objective optimization problem can be expressed by formula 18 as an optimization toolbox multi objective pso method is used to optimize the two objectives and generate sample data from the pareto frontier 18 max g 1 g 2 3 3 further selection of pareto frontier data although the multi objective pso algorithm can obtain the pareto frontier sets of balanced g1 and g2 not all data points are suitable for adding to the sample as new expensive evaluation points the main reason can be explained from two aspects ⅰ if the distance between two sampling points in the pareto frontier is too close the correlation matrix r eq 4 of the kriging model is singular which makes the construction of the kriging model fail ⅱ the optimization based on the kriging model hopes to achieve higher precision convergence with as few expensive evaluation points as possible which requires each expensive evaluation sampling point to have as much potential information as possible therefore further selection of pareto frontier data is necessary the next two steps will complete the specific screening and adjustment process step 1 as shown in fig 2 three point screening correction method are used to select candidate points which will be obtained through the following two sub steps step 1 1 as is well known the real purpose of maximizing ei criterion in eq 9 is to find a sampling point that has both a small objective function value and a large standard deviation therefore ei as a depth screening criterion can further enrich the amount of information contained in each sampling point based on the above analysis we will calculate the ei value of each sampling point and then select the sample with maximum ei values as the first point a in fig 2 a at the same time the first point a is also the first candidate point for expensive evaluation step 1 2 generate other two promising candidate points when the two limit points point b and c in fig 2 a from pareto frontier have no potential information they may be selected for calibration for a two dimensional problem we take point b as an example to explain the selection process of candidate points in detail as shown in fig 2 b we assume that the coordinate value of the limit point b of the maximum target g2 is x 1 x 2 next we will break away from the pareto frontier and consider g2 alone firstly let x 2 be a design variable while keep x 1 unchanged i e x 1 is a constant then pso algorithm is used to maximize g2 x 2 to get the new sampling point b1 x 1 x 21 similarly let x 1 be a design variable and keep x 2 unchanged another sampling point b2 x 11 x 2 is also obtained finally formula 9 is used to calculate the ei values of the points b b1 and b2 and the one being largest ei value in these three points will be eventually selected the selection of the third candidate is the same as that of the second candidate point step 2 determine whether the untried sample point x i among the three candidate points is reserved as an expensive evaluation point the sign x l and x u are the lower and upper bounds of the current function boundary constraints respectively x j j 1 m is any known sampling point then the distance screening criterion can be expressed by formula 19 19 x i x j x u x l 0 001 d m e a n where d m e a n d max d min 2 parameter d max and d min represent the maximum distance and minimum distance between all existing sampling points respectively when the candidate point x i satisfies the formula 19 the x i will be accepted as an expensive evaluation point otherwise it means the distance between x i and x j is very close which may result in the correlation matrix to be ill conditioned and the failure construction of kriging model in this respect the candidate point x i will be discarded 3 4 implementation kago gei method for kago gei method sections 3 1 3 2 and 3 3 introduce the improved gei criterion the construction process of two optimization objectives and further selection of pareto frontier data but a complete algorithm still requires many auxiliary parts such as the initial sampling design multi objective optimization method algorithm stopping criterion etc therefore this section mainly describes the specific implementation of the proposed algorithm in detail the basic flow of the kago gei method is shown in fig 3 to ensure the smooth operation of the algorithm flow in fig 3 table 1 sets or assigns input and output parameters in addition according to fig 3 the specific steps of the proposed method will be described in detail in the following steps step 1 initial design use latin hypercube sampling method to generate 2 d 1 initial sampling points and then perform real objective function evaluations i e expensive black box function evaluations on these sample and finally these sampling points and estimation results are stored in the sample sets x and y so as to prepare for the construction of kriging surrogate model in addition the current optimal solution needs to be found from the sample sets x and y and assigned to x best and y best respectively step 2 update sample data set x and y for the initial sampling points obtained directly by latin hypercube sampling we can directly use the x and y given in step 1 to establish the kriging model however the kago gei optimization is a cyclic process of increasing sampling points which also needs to constantly update the sample data x and y to improve the accuracy of global optimization using the kriging model in this condition all the updated sample data will be used to build a new kriging model step 3 whether the algorithm is terminated in order to facilitate the comparison with the optimization performance of other algorithms the kago gei algorithm will use the optimization stop criterion with maximum expensive evaluation number nmax in table 1 when the total number of expensive valuations including the initial latin hypercube sampling reaches nmax the optimization process will be terminated otherwise the next cycle will be re entered step 4 construct kriging model combining the gaussian correlation kernel function the relevant parameter θ θ i 0 1 20 and the latest sample data x and y the kriging model can be established using the dace toolbox step 5 iterative process sampling it is the core part of the kago gei method and mainly includes the following four sub steps step 5 1 use kriging s correlation vectors and parameter estimates to build enhanced gei according to formula 15 the magnification coefficient and the relevant parameter vector θ can be used to adaptively change the quality factor g during the iterative optimization process its variability is effectively combined with the gei in formula 11 to form an enhanced gei criterion which maximizing can better balance the overall situation and report search behavior for more detailed construction process please refer to section 3 1 step 5 2 construct two optimization objectives g1 and g2 according to this gei criterion combining with formula 17 we can divide the improved gei obtained in step 5 1 into two optimization objectives g1 and g2 containing cumulative distribution function and probability density function respectively for detailed description and expression please refer to section 3 2 step 5 3 optimizing g1 and g2 by multi objective pso algorithm to produce pareto frontier set the two objectives generated by step 5 2 will be optimized by the multi objective particle swarm algorithm zhang et al 2018 and generate a pareto frontier set step 5 4 use the given criteria to further select the data from the pareto frontier use three point screening correction method and the distance screening criterion to further filter the data from the pareto frontier to obtain the expensive valuation point s with the best potential value see section 3 3 for details step 6 real objective function evaluation at new sampling points the selected sample data obtained through the screening in step 5 4 will be evaluated by expensive real objective function and they will be stored in the sample data sets x and y and then turning to step 2 4 experimental studies in order to illustrate the optimization performance of the kago gei method it can be compared with other similar optimization methods the ei in ego jones et al 1998 is an attractive criterion that has been proven to provide a balance between local search and global search however the underestimation of the standard deviation by kriging model will cause the ei based optimization method to have a slower convergence rate by considering the performance and mathematical completeness of ei criterion and compensate for the error underestimation of kriging a multi objective optimization method based on ei pareto frontier criterion and kriging mo ek li et al 2017 was proposed to improve global optimization performance in view of this we compare the proposed method with the ego and mo ek algorithms all tests were performed in matlab2017a by a dell machine equipped with an i7 4790 3 6 ghz cpu and 16 gb ram 4 1 numerical test the basic information of eighteen benchmark mathematical functions is listed in table 2 their specific expressions are referred by the literature jamil et al 2013 bernal e et al 2017 for d dimensional test optimization problem 2 d 2 initial sample data should be generated by lhs to construct initial kriging model the optimization result of an algorithm is not only related to the dimension of the problem but also to its complexity in view of this the test problems are classified into five types many local minima bukin crossintray drop wave eggholder griewank holdertable schaffer and ackley5 bowl shaped trid9 plate shaped zakharov valley shaped rosenbrock10 and other branin hartman3 shekel4 hartman6 styblinskitang7 and f16 the key problem that the global optimization algorithm needs to solve is how to jump out of this area and turn to a more promising area to explore new unknown points when falling into a local optimal area therefore the relative part of the test problem we choose has many local optimal solutions to clearly show the optimization performance of the kago gei method we take the branin function as an example to illustrate in detail fig 4 shows the pareto frontiers at three different stages initial sampling 30 sampling points and final pareto frontier and final optimization results in the pareto frontier formed in the initial sampling stage fig 4 a the absolute values of g1 and g2 are large and all g1 values are greater than zero which means that although there is currently no one smaller than the initial minimum the optimization search performed after the initial sampling will have a greater probability of obtaining a more promising approximate optimal solution when the total number of sampling points increases to 30 the absolute values of the two optimization objectives in the obtained pareto frontier fig 4 b are continuously decreasing which shows that the probability of obtaining a better solution is constantly decreasing in the coordinate direction of g1 it appears multiple negative values which indicates that multiple sampling points with smaller objective values have been found it also reflects the algorithm s strong global search capability for the pareto frontier fig 4 c formed in the final iteration the absolute value of the two targets has become very small and the formed graph has become irregular this not only shows that the probability of finding a better solution is very slim but also shows that the algorithm may have found a global approximate optimal solution that meets certain requirements as we expected from the distribution fig 4 d of 60 sample points it shows that the optimal solution found by the proposed method is very close to the real optimal solution which also shows that the kago gei has better global exploration performance to verify the effect of this method on other test problems the iterative processes ip of the approximate optimal solutions ip aos for all functions are shown in figs 5 22 for each of these 2 dimensional problems there are 6 initial sampling points an initial optimal solution is chosen from these six initial points as the first iteration point there are 54 points 30 d 6 left to sample therefore there a total of 55 sampling points in each of the figures in addition the abscissa represents evaluation of real function and the ordinate represents the currently found global approximate optimal solution the red dotted line representing the actual optimal solution of each test function can more clearly express the difference between the optimal solution obtained by the proposed method and the true optimal solution in figs 5 22 all the optimal solution iteration graphs are descending in steps which shows that the approximate optimal solution is constantly getting smaller in addition the change trend is relatively sharp in the initial stage and becomes more moderate in the later stage which shows that it is easier to obtain more promising sampling points in the early stage and it is relatively difficult to obtain the optimal sampling points in the later stage however this is not always the case when the correction sampling fig 2 finds valuable sampling points there will be some drastic changes in the later stage such as levy8 and f16 functions no matter what type of two dimensional problem a sampling point close to the real optimal solution can be found under the condition of a certain number of actual function valuations especially for any one of the branin crossintray eggholder holder table and schaffer functions the approximate optimal solution found is basically not much different from the actual optimal solution for multi dimensional problems hartman3 shekel4 and hartman6 can basically find a satisfactory approximate optimal solution the quality of these optimal solutions found are not only related to the function dimensions but also closely related to the complexity multimodality and size of the design interval as the dimensionality increases the difficulty of finding sampling points close to real optimal solution will continue to increase but the approximate optimal solution found by most functions can still meet certain design requirements if we add a certain number of sampling points it believed that the proposed method can perform better to further illustrate the superiority of the kago gei method it was tested 40 times with the ego and mo ek methods the three methods are compared in some optimization performance and the results are shown in table 3 in addition to comparing the upper lower and average values of the approximate global optimal solution we also performed the average relative error are or average absolute error aae between the actual optimal solution and the approximate optimal solution and the average actual evaluation times aet when the error is less than 0 01 for the first time to avoid the situation that the relative error is negative because of y min 0 the relative error expression is set as 20 r e y ˆ y min y min when y min 0 the relative error cannot be calculated we may replace the relative error with absolute error in this situation the error formula can be stated as 21 a e y ˆ y min the meanings of the special marks in table 3 are as follows when 40 tests are performed the 40 results of actual function evaluation times will be obtained and then their average value is taken as aet when we are unable to make the error less than 0 01 under the given function evaluation times we will offer a special mark such as 60 when the actual evaluation times required to reach 0 01 error are far greater than the given evaluation times we may mark with except the faster convergence of ego in the initial stage of the test process the kago gei method is significantly better than the ego method in many aspects the main reason is that the first point selected by kago gei method is the point with the largest ei from this point of view the proposed method is similar to ego to some extent however on this basis kago gei method adds two more valuable correction points their addition is the direct reason why the proposed method is better than ego further the proposed method is also superior to the mo ek method in most cases the main reason is that the improved gei criterion can adaptively change the two optimization objectives so that the optimization search direction can be explored towards a more promising area in addition it can be seen from table 3 that the kago gei method always has the smallest aet value this shows that the kago gei method can achieve the requirement of an error less than 0 01 with the least evaluation number it also shows that the method kago gei method takes less time in general the characteristics of the kago gei method can be summarized into the following three points 1 multi objective optimization of the two goals constructed by the enhanced gei criterion can provide a lot of equilibrium points and the further screening and correction of these equilibrium points effectively improve the convergence accuracy of the proposed algorithm this has been reflected in the test results of many benchmark functions 2 in test problems with dimensions not greater than 7 dimensions the quality of the global optimal solution mainly depends on the complexity or multimodality when the dimensions are 7 dimensions and above in addition to being affected by these conditions it also has a greater relationship with the size of the dimension 3 in the iterative optimization process the kago gei method can effectively balance the global and local search behavior in most cases 4 2 example on crop evapotranspiration water is an indispensable basic condition for our human survival and development although the total amount of freshwater resources in our country china currently ranks among the top in the world most of the freshwater resources cannot be obtained from flood runoff or groundwater scattered in remote areas so the actual available freshwater resources are few about a quarter of the world average it is one of the water shortage countries in the world with social development and population growth the water resources on which we depend for survival have become increasingly scarce if it is allowed to develop and does not focus on water conservation then our country is likely to be close to the internationally recognized warning line of severe water shortage in the future in addition our country is a big agricultural country agriculture is the primary industry and it is also a major water user agricultural water accounts for more than 60 of total water consumption therefore the key to ensuring the sustainable use of water resources is to reduce agricultural water use in today s extremely scarce water resources developing water saving agriculture and improving the efficiency of agricultural water use have undoubtedly become safeguard measures to alleviate my country s water crisis in the 21st century and it is also the only way to ensure the sustainable development of my country s agriculture crop evapotranspiration ce is the most important consumption way of agricultural water and it is also the main part of farmland water consumption it is not only the basis for determining crop irrigation systems and regional irrigation water consumption but also an important data for watershed planning water resources utilization management and crop planting zoning layout therefore the study of ce problems has become an important topic of common concern in agronomy hydrology and other related disciplines and fields almost all studies of agriculture and water resources are inseparable from the calculation and analysis of evapotranspiration accurate estimation of crop evapotranspiration has important practical significance for reducing water consumption during crop growth period improving water use efficiency and developing water saving agriculture there have been many researches on the crop evapotranspiration pereira et al 2015 tabari 2010 and there have been many theories and calculation formulas based on the principle of energy balance and the development is relatively mature and complete the principle of energy balance regards crop evapotranspiration as a kind of energy consumption and calculates the evapotranspiration consumption by balancing energy and then converts the energy into water among them the fao penman monteith formula ahmad and choi 2018 mao et al 2002 considering aerodynamics and radiation terms can be expressed as 22 c e 0 0 408 δ r n g γ 900 t 273 u 2 e s e a δ γ 1 0 34 u 2 the meaning of all parameters is stated by table 4 some parameters are directly or indirectly defined in formulas 23 to 27 it is noted that the soil heat flux g is used to increase the amount of heat in the soil temperature usually in days or ten days since the soil heat flux under the cultivation layer of the reference crop calculated in days or ten days is very small it is often ignored as zero 23 δ 4096 0 6108 exp 17 27 t t 273 3 t 273 3 2 24 γ 0 665 10 3 p 0 665 10 3 101 3 293 0 0065 z 293 5 25 25 e 0 t 0 6108 exp 17 27 t t 273 3 26 e s e 0 t max e 0 t min 2 27 e a e 0 t min r h max 100 e 0 t max r h min 100 substituting all parameters into formula 22 the crop evapotranspiration can be expressed as 28 c e 0 1020 75 exp a x 2 273 3 2 x 1 60 3 x 2 273 x 3 0 6108 exp b 0 6108 exp c 2 0 6108 exp c x 6 100 0 6108 exp b x 7 100 2502 exp a x 2 273 3 2 0 067 1 0 34 x 3 where a 17 27 x 2 x 2 273 3 b 17 27 x 4 x 4 273 3 c 17 27 x 5 x 5 273 3 in this work the crop evapotranspiration is used to show that the proposed optimization method can guide or predict design variables key factors in the crop living environment so that the evapotranspiration can get a better solution under a certain environment with the continuous update of the kriging approximation model and the continuous advancement of the iterative optimization process we can also deeply understand the relationship between evapotranspiration and these design variables and find some key factors that affect evapotranspiration by selecting seven key parameters in table 4 as design variables to construct crop evapotranspiration eq 28 a mathematical expression formula that meets certain requirements is established and its optimal solution is found then based on kago gei method the initial sampling points are obtained through lhs the kriging model of approximate evapotranspiration function is established and the decomposed gei is optimized through the pso algorithm to obtain the predicted approximate optimal ce 0 and compare with the actual optimal solution to illustrate the feasibility and stability of the proposed method thus a new forecasting method is provided for crop irrigation water and water resources management according to the execution process of section 3 4 16 initial sampling points are produced by lhs and optimization process will be terminated when the total number of samples reaches 210 the iterative process of the approximate optimal ce 0 is shown in fig 23 and the trend of each design variable is shown in figs 24 30 it can be seen from figs 23 to 30 that the kago gei method can find an appropriate minimum evapotranspiration for the given design variables for x 1 the initial data changes drastically as the iteration point increases it gradually tends to a stable smaller value obviously reducing the amount of solar radiation on the ground can effectively reduce the evaporation of soil water vapor the x 2 x 4 and x 5 are all temperature related design variables as the surface temperature increases soil evaporation increases significantly there is a linear positive correlation between the daily average soil evaporation and the daily average surface temperature when the temperature rises the water molecules in the soil absorb more heat and the movement intensifies causing more water molecules to break free of the gravitational forces between molecules and leave the soil among them the reason for the drastic changes in x 2 and x 5 may be explained as follows 1 the variable range may be too narrow if i expand the variation range of the variables the variable change in a certain area is relatively stable take the variable x 5 as an example if the variable range is set to 10 40 and it only fluctuates between 20 and 30 a suitable temperature for plant growth this may indicate that x 5 is stable or convergent 2 the variables x 2 and x 5 are the average temperature and the minimal temperature respectively too low or too high temperature will have certain side effects on the growth of crops in addition the change of crop evapotranspiration is affected by the joint action of other seven variables so the evapotranspiration optimization within a certain suitable temperature range is also in line with the actual situation therefore the stability of the variables in a certain interval also explains their convergence when x 4 is at the highest temperature the crop evapotranspiration will be greatly increased therefore x 4 basically changes relatively smoothly between 22 and 24 degrees celsius which shows that choosing a suitable temperature is more conducive to reasonable evapotranspiration of crops from the variable x 3 average wind speed at 2 m height it can be seen that low wind speed can effectively reduce crop evapotranspiration and it has an insignificant positive correlation with wind speed it can be seen from the change trend of x 6 and x 7 which are insignificantly negatively correlated with ce 0 that the maximum relative humidity has a significantly higher impact on plant evapotranspiration than the minimum relative humidity according to fig 23 the approximate optimal solution obtained by kago gei method is 3 1960 and the corresponding design variable is 5 65 25 4 0 734 27 24 78 62 according to this design variable a data test was carried out at the corn experimental platform and the actual evapotranspiration obtained was 3 3352 although there is a certain error between the predicted and the actual values this is acceptable within a certain range it illustrates the guiding value and practical significance of the proposed method from another aspect based on the above analysis the following conclusions can be drawn 1 the proposed algorithm only completes the global optimization in a given design domain and the optimal evapotranspiration is only suitable within this boundary constraint however the optimized results show that the kago gei has good convergence and has certain theoretical guiding significance for the evapotranspiration of actual crops 2 judging from the variation range of the seven design variables x 2 x 5 x 6 and x 7 have a greater impact on crop evapotranspiration and are the dominant factors in the design variables which can make crop growers pay more attention to these factors 3 the actual evapotranspiration obtained from the experiment based on the design variables of the approximate optimum also shows that the proposed method has certain practical application significance 5 conclusions to improve the convergence accuracy based on kriging model through multi point sampling a kriging based adaptive global optimization method with generalized expected improvement kago gei is proposed it will recursively change the enhanced generalized expected improvement gei criterion in the iterative process and divide the criterion into two optimization goals then the multi objective pso algorithm is used to optimize the two objectives and obtain the pareto front furthermore the more valuable sampling points from the pareto front are selected through screening correction method and they are used as new and expensive evaluation points for updating the kriging model finally some benchmark functions and crop evapotranspiration calculation examples have been tested the results show that the method is superior to other classic global optimization algorithms in terms of convergence in most cases future research can focus more on the following two aspects one is to adapt the kriging model based optimization to higher dimensional design problems by changing the function expression of the kriging model the other is to establish effective multi point filling sampling criteria based on the kriging model s own correlation estimation target prediction variance and other information to complete the optimization of more complex multi dimensional and multi peak problems declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china no 51775472 and the national mathematics tian yuan special foundation grant no 11926408 scientific and technological innovation talent support in henan province grant no 21hastit027 and the henan excellent youth fund project grant no 202300410346 
10296,accurate and fast estimation of reference evapotranspiration et0 is important in determining crop water requirements designing irrigation schedule planning and managing agricultural water resources especially when limited meteorological data are available this study proposed a novel kernel extreme learning machine model coupled with the k means clustering and firefly algorithms kmeans ffa kelm with 5 10 15 20 25 30 and 40 data subsets for estimating monthly mean daily et0 in parallel computation in the poyang lake basin of south china with pooled temperature data from 26 weather stations two input combinations i e 1 mean temperature tavg and extraterrestrial radiation ra 2 maximum and minimum temperatures tmax and tmin and ra were considered meteorological data during 1966 2000 were used to train the models while those for the period 2001 2015 were used for model testing the results showed that the prediction accuracy of selected machine learning models with tmax tmin and ra was improved by 7 0 15 5 in terms of rmse compared to that with tavg and ra during testing the ffa kelm model slightly outperformed the adaptive network based fuzzy inference system anfis model both of which were superior to the random forest rf and m5 prime model tree m5p models followed by the hargreaves and thornthwaite models the rmse values of kmeans ffa kelm models with more than 20 subsets were decreased by 0 7 3 5 compared with those of the ffa kelm models the kmeans ffa kelm model with 25 subsets ffa kelm 25 outperformed the ffa kelm model in summer and in the count of absolute errors greater than 0 9 mm d 1 the computational time of kmeans ffa kelm models first decreased and then increased with the increase of the subset number the parallel ffa kelm 25 model 0 5 0 7 s significantly reduced the computational time which was 10 13 times faster than the sequential kmeans ffa kelm model 7 0 7 4 s and 1185 1603 times faster than the ffa kelm model 802 2 830 0 s this study provides a new and fast modeling method for processing large datasets in agricultural and water resources studies on a regional scale keywords machine learning kernel extreme learning machine firefly algorithm k means clustering parallel computation poyang lake basin 1 introduction reference evapotranspiration et0 is defined as the evapotranspiration amount of a hypothesized reference crop which has a height of 0 12 m a surface resistance of 70 s m 1 and an albedo of 0 23 allen et al 1998 accurate information of et0 magnitude is of crucial significance for determining crop water requirements designing irrigation schedule planning and managing water resources in agricultural and hydrological studies fan et al 2015 kisi 2016 zhang et al 2018 various meteorological variables such as solar radiation air temperature relative humidity and wind speed can interactively influence et0 therefore many attempts have been made so far to derive mathematical or regression based relationships between et0 and its driving factors the standard fao 56 penman monteith fao 56 pm equation is a semi empirical and semi physical model for calculating et0 from meteorological variables which has been acknowledged as a benchmark model for the calibration of other empirical et0 models allen et al 1998 feng et al 2016 wang et al 2019a 2019b chen et al 2020 yu et al 2019 however the fao 56 pm model requires the complete data of air temperature solar radiation wind speed and relative humidity for future scenarios it is not always realistic to obtain complete and high quality meteorological data especially in high resolution regional studies and long term studies thus empirical models with fewer input parameters have been developed and validated around the world among them empirical models based on air temperature data have been extensively studied due to its advantages of low data requirement and simple structure the thornthwaite model thornthwaite 1948 estimates monthly et0 by using only average temperature data which is favored worldwide pelton et al 1960 especially for calculating the drought index van der schrier et al 2011 chang et al 2019 introduced a modified daily thornthwaite equation to estimate daily et0 in different regions of china based on temperature forecasts trajkovic et al 2019 modified the thornthwaite model by replacing the average temperature with the effective temperature and found that the accuracy of the modified thornthwaite model was significantly higher than that of the original model for et0 estimation in northern serbia in addition to the thornthwaite model the hargreaves model hargreaves 1956 is also a well received empirical et0 model around the world inspired by the radiation based empirical model of continuous multiplication the model uses the daily temperature range and extraterrestrial radiation ra to estimate solar radiation and further multiplies the mean temperature to calculate et0 martí et al 2015a 2015b this model produces excellent performance in arid and semi arid regions but underestimated or overestimated et0 in humid regions quej et al 2019 wu et al 2019a 2019b feng et al 2017 calibrated the parameters of the hargreaves model in the sichuan basin of china and found that the calibrated hargreaves model decreased mae from 0 959 to 0 433 mm d 1 almorox and grieser 2016 suggested using climate class specific coefficients for improving the correlation between the long term monthly average et0 of the hargreaves and fao 56 pm models tang et al 2019 modified the temperature constants of the hargreaves model with altitude factors to improve its performance in tibet china zhang et al 2018 predicted the short term daily et0 using the hargreaves model and public weather forecast data paredes et al 2018 evaluated the performance of the hargreaves model in a humid environment of the azores island portugal the results indicated that the prediction accuracy of the hargreaves model was close to that of the temperature based pm model over the past few years machine learning models have become a better alternative to empirical models and they have been widely used for estimating et0 saggi and jain 2019 liu et al 2020 yan et al 2021 a great deal of efforts has been engaged in how to better forecast predict et0 using machine learning models these studies include but are not limited to different climate types nandagiri and kovoor 2006 fan et al 2018 modeling of meteorological factors feng et al 2017a jiang et al 2019 training testing methods shiri et al 2019a 2019b regional modeling methods wang et al 2019a 2019b comparison of various machine learning models wu and fan 2019 shiri et al 2019a 2019b fan et al 2019 coupling of various technologies tikhamarine et al 2019 tao et al 2018 sanikhani et al 2019 etc kisi 2016 evaluated the performances of the least square support vector machines lssvm multivariate adaptive regression splines mars and m5 prime model tree m5p models for et0 estimation in the presence or absence of local data it was found that the m5p model performed better when lack of local data while the lssvm model was more accurate in the local applications however wu et al 2019a 2019b found that the mars model was superior to the support vector machine svm model in the humid region of china mohammadrezapour et al 2019 compared the capability of svm gene expression programming gep and adaptive network based fuzzy inference system anfis models in et0 prediction in four cities of iran they found that the svm model with average temperature relative humidity wind speed and sunshine hour from the current and previous months yielded the best et0 estimates fan et al 2019 proposed a light gradient boosting machine lightgbm model for estimation of daily et0 in south china the lightgbm model was found to outperform the m5p random forests rf and empirical models under both local and external application scenarios wu and fan 2019 evaluated the performances of eight machine learning models for daily et0 estimation in different climate regions of china they found that models with only temperature data yielded acceptable accuracy and an inclusion of precipitation data further decreased the average rmse by 7 6 in china in recent years the extreme leaning machine elm model has attracted a wide range of scholars interests for its light and simple structure high efficiency and stability it has been applied in simulating many kinds of natural phenomena yaseen et al 2018 deo et al 2016 including et0 gocic et al 2016 fan et al 2018 kumar et al 2016 feng et al 2016 2017b abdullah et al 2015 firstly introduced the elm model for estimating et0 gocic et al 2016 verified the excellent performance of the elm model in nis and belgrade of serbia patil and deka 2016 assessed the suitability of the elm artificial neutral networks ann and empirical models under three input combinations in the thar desert india they found that the elm model was superior to the ann and empirical models in addition the elm model also achieved appropriate accuracy in southeastern brazil reis et al 2019 and in the sichuan province of china feng et al 2017a when only temperature data were available recently an improved elm model i e kernel extreme leaning machine kelm has been proposed for estimating monthly evaporation sebbar et al 2020 it was found that the kelm was useful for establishing more robust tools and improved the available machine learning models furthermore scholars have tried to couple machine learning models with various technologies to improve the model reliability accuracy or efficiency e g k means clustering ferreira et al 2019 wavelet decomposition kisi and alizamir 2018 and meta heuristic optimization algorithms khosravi et al 2019 han et al 2019 ehteram et al 2019 fan et al 2020 the wavelet decomposition method has proven to be a very powerful method of noise reduction kisi and alizamir 2018 moreover meta heuristic optimization algorithms have also been integrated with machine learning models wu et al 2020 fan et al 2020 among which the firefly algorithm ffa is an efficient biological simulation algorithm that can converge quickly tao et al 2018 confirmed that the ffa algorithm was able to ameliorate the accuracy of the anfis model in addition wu et al 2019a 2019b hybridized the elm model with four meta heuristic optimization algorithms for perdition of daily et0 in different climates of china it was found that the flower pollination algorithm fpa and cuckoo search algorithm csa were superior to the genetic algorithm ga and ant colony optimization aco in improving the elm model performance the kelm model has also been coupled with the firefly optimization algorithm ffa kelm for image classification and time series predictions su et al 2016 sannasi chakravarthy and rajaguru 2020 sui et al 2018 besides clustering analysis is a research hotspot in the field of data mining dhanachandra et al 2015 clustering is the process of classifying objects data in the same cluster are similar while data objects in different clusters are quite different therefore important information hidden behind the data can be found k means clustering is a hard clustering algorithm based on partition with the minimum error sum of squares as the objective function independent and compact clusters are formed due to its fast running speed and applicability to high dimensional data it has been widely used in simulation of natural phenomenon including but not limited to clustering of similar weather stations ferreira et al 2019 solar radiation benmouiza and cheknane 2013 storm identification and forecast lakshmanan et al 2003 wind speed ozkan and karagoz 2015 and rainfall runoff zahmatkesh et al 2015 the main disadvantage of the kelm model and many other conventional machine learning models is that they are very time consuming especially when there are large amounts of data this would become even worse when these models are integrated with the meta heuristic optimization algorithms with the accumulation of observation data and the refinement of research area traditional site specific models are no longer able to meet et0 research on a watershed scale therefore the purposes of this study were to 1 propose a novel parallel model that introducing both the k means clustering and firefly algorithms into the kelm model for more accurate and faster estimation of monthly et0 in the poyang lake basin of china with only temperature data 2 compare the prediction accuracy and computational efficiency of the proposed parallel kmeans ffa kelm model with the commonly used machine learning models e g m5p anfis rf and ffa kelm 2 material and methods 2 1 study area and data acquisition this study was conducted in the poyang lake basin of south china which is an important sub basin of the yangtze river basin the basin covers 166 2 thousand km2 and includes china s largest freshwater lake the area is mainly planted with double cropping rice and the drought is most severe in august and september when the rice needs to be irrigated in this region annual water consumption has exceeded 14 billion m3 the water situation in this area has changed in recent years with more frequent droughts and floods which has become one of the most prominent water resource conflicts in china in 2019 the poyang lake basin suffered from severe drought and the lake area reached its smallest value over the past 50 years in this study 26 meteorological stations were selected in poyang lake basin fig 1 the monthly meteorological data of average maximum and minimum air temperatures tave tmax and tmin wind speed relative humidity and sunshine duration were collected from https data cma cn all data from the 26 stations were pooled to estimate monthly mean daily et0 on a regional scale the dataset was divided into two parts for model training 1966 2000 and testing 2001 2015 the temperature data were divided into two groups i tave ii tmax and tmin and then combined with the extraterrestrial radiation ra as the input dataset of the machine learning models to meet the requirements of machine learning models raw weather data were normalized to 0 1 prior to training and testing using the following formula 1 z n z i z min z max z min where zn and zi are the normalized and raw values of the data zmax and zmin represent the maximum and minimum values of the raw data 2 2 standard fao 56 penman monteith equation for calculating reference evapotranspiration since the experimental et0 data were not available the standard fao 56 penman monteith fao 56 pm equation recommended by allen et al 1998 was applied to calculate et0 which provided the reference data to test the empirical and machine learning models 2 e t 0 0 408 r n g γ 900 t a 273 u e s e a δ γ 1 0 34 u where rn is the net radiation at the crop surface which is usually calculated by global solar radiation rs g is the soil heat flux density ta is the mean daily air temperature at 2 m height calculated as the mean of tmax and tmin u is the wind speed at 2 m height e s and e a are the saturation and actual vapor pressure δ is the slope of vapor pressure curve γ is the air psychrometric constant the details of the fao 56 pm model can be found in allen et al 1998 2 3 empirical models for estimating reference evapotranspiration 2 3 1 hargreaves model a method of estimating solar radiation based on the temperature difference was proposed by hargreaves 1956 and integrated into an empirical et0 model 3 e t 0 h 0 0023 r a t a 17 8 t max t min this model will cause underestimation of et0 in this region without parameter calibration wu et al 2019a 2019b in this study the model is modified as follows 4 e t 0 h s a r a t a b t max t min c where a b and c are empirical coefficients which are 0 000717 0 59 and 10 4 in the present study respectively 2 3 2 thornthwaite model the thornthwaite model thornthwaite 1948 only requires the average temperature to estimate et0 using the equation below 5 e t 0 t h 0 0 t a v e 16 10 t a v e i a 0 t a v e 26 5 c 0 43 t a v e 2 32 24 t a v e 415 85 t a v e 26 5 c 6 i k 1 12 0 2 t k 1 514 7 a 0 000000675 i 3 0 0000771 i 2 0 01792 i 0 49239 where i is the thermal index imposed by the local normal climatic temperature regime and a is a function of i 2 4 machine learning models for estimating reference evapotranspiration in this study the rf m5p anfis ffa kelm and kmeans ffa kelm models were developed to estimate monthly mean daily et0 the details of the conventional rf m5p and anfis models can be found in liaw and wiener 2002 wang and witten 1996 and jang 1993 respectively the ffa kelm and kmeans ffa kelm models are introduced in details as follows 2 4 1 k means clustering algorithm clustering is a number of ways which can divide a dataset into a certain number of subsets one of the popular clustering methods is the k means clustering algorithm developed by hartigan and wong 1979 this algorithm divides the dataset into k data groups by the geometric distance it classifies a given set of data into k independent clusters the k means clustering algorithm consists of two independent stages it computes k centers in the first phase and brings each piece of data to the closest cluster of centers in the second phase euclidean distance method is one of the most commonly used methods after the clustering is completed the new center of each cluster is recalculated based on this center the new euclidean distance between each center and each data point is calculated and the point with the minimum euclidean distance of the cluster is allocated the center of each cluster is the point where the sum of the distances to all objects in the cluster is the smallest k means clustering is thus an iterative algorithm in which it minimizes the sum of the distances from each object in the cluster to its core in this study the two input combinations have similar clustering patterns taking the input combination of tmax tmin and ra as an example monthly tmax and tmin were used as one piece of data since ra is only related to geographical factors this was written as t x1 x2 and used for clustering to k different groups ck the detailed algorithm for k means clustering is as follows 1 set the number k of clusters and determine the center ck 2 for each monthly input data calculate their euclidean distance d from the center 8 d t x 1 x 2 c k 3 assign all monthly input data to the nearest center based on distance d 4 after all data sets are allocated recalculate new location of the center using the relationship given as follow 9 c k 1 k x 1 c k x 2 c k t x 1 x 2 5 repeat the process 2 to 4 until it satisfies the tolerance or error value 6 divide the original dataset into k subsets according to the clustering although the k means clustering algorithm has the advantage of easy implementation it also has a disadvantages the quality of clustering results largely depends on the arbitrary selection of the initial center therefore if the initial center is randomly selected different results will be obtained for different initial centers the initial center has thus to be carefully selected for the two temperature based input combinations different k values will be used to distinguish them and evaluate the impact of different k values on the results this can reduce the deviation caused by the selection of the center 2 4 2 firefly algorithm ffa the ffa algorithm is based on the flash behavior of fireflies in the ffa algorithm a group of fireflies are randomly assigned to the solution space and each firefly represents an initial solution according to the target function of each firefly the fitness score is calculated and assigned as light intensity fireflies with low light intensity will be attracted by fireflies with strong light nearby as defined below 10 x i t 1 x i t β 0 e γ r i j 2 x j t x i t α t ε t where i and j represent fireflies with different light intensity respectively while x i t and x j t represent the current positions of fireflies i and j in the t th iteration respectively parameter β0 is the initial attraction γ is the light absorption coefficient and rij is the distance between firefly i and j the main advantage of the ffa algorithm is its attraction mechanism the attractivity based movement makes the firefly swarm automatically subdivide into subgroups and each group gathers around a global or local optimal solution when the population size is large enough to exceed the number of local optimal solutions in principle the segmentation ability of fa can find all the optimal values at the same time so as to obtain the global optimal value this ability of automatic subdivision enables the ffa algorithm to handle optimization problems with high nonlinearity and multiple modes 2 4 3 kernel extreme learning machine kelm huang et al 2006 first proposed the extreme learning machine elm model of single hidden layer feedforward neural networks and then considered it as the generalized slfns without tuning parameters in the hidden layer fig 2 the elm output function of the generalized slfns is expressed as follows 11 f l x i 1 l β i h i x h x β where β β 1 β 2 β l t indicates the vector of the output weights between the hidden layer of l nodes and the output node the output vector of the hidden layer with respect to input x is defined as 12 h x h 1 x h 2 x h l x then according to h x the dataset is mapped from d dimension input space to l dimension hidden layer feature space h that is h x is a feature map according to bartlett s 1998 theory the smaller the training error of feedforward neural network the smaller the norm of weight and the better the generalization performance of the network the elm model tends to minimize both the training error and output weight norm written as 13 min h β t 2 and β the h representation of the former is the output matrix of the hidden layer 14 h h x 1 h x 2 h x 3 h 1 x 1 h l x 1 h 1 x n h l x n actual meaning of minimizing the norm of the output weights β is to maximize the distance of the separating margins of different classes in the elm feature space the minimal normal least square method is also used in the elm model 15 β h t to reduce the time in determing the elm space dimensionality and overcome the defect of randomly assigning the weights the kernel extreme learning machine kelm has been recently proposed huang et al 2011 in the kelm method the hidden layer feature mapping is defined using the kernel functions 16 ω e l m h h t ω e l m i j h x i h x j k x i x j 17 f x h β h x h i c h h 1 t k x x 1 k x x n t i c ω e l m 1 t the radial basis function is set in the hidden layer in the form below 18 k x x i exp γ x x i 2 there are two important parameters in this method which are the regularization coefficient c and the width of kernel function γ there is no theoretical basis for these two parameters and it is thus necessary to obtain the optimal parameter combination through model tuning 2 4 4 hybrid ffa kelm and kmeans ffa kelm models the parameters of the kelm model were first optimized by the ffa algorithm fig 3 the k means clustering algorithm was then used to decompose the training dataset into multiple subsets and then build various sub models using the hybrid ffa kelm model finally sub models were merged into a new model named the kmeans ffa kelm model in this study the training and testing datasets under the two input combinations were divided into subsets of 5 10 15 20 25 30 and 40 folds the proposed machine learning models were implemented in the r program on a computer with intel core i7 4700 cpu and 16 gb of ram memory fig 4 2 5 statistical evaluation the performances of the empirical and machine learning models for estimating et0were evaluated by coefficient of determination r2 root mean square error rmse mean absolute error mae scatter index si and nash sutcliffe efficiency nse which can be expressed as 19 r 2 i 1 n e t i m e t i m e t i e e t i e 2 i 1 n e t i m e t i m 2 i 1 n e t i e e t i e 2 20 r m s e 1 n i 1 n e t 0 i m e t 0 i e 2 21 m a e 1 n i 1 n e t 0 i m e t 0 i e 22 s i 1 n i 1 n e t 0 i m e t 0 i e 2 e t 0 i m 100 23 n s e 1 σ i 1 n e t 0 i m e t 0 i e 2 σ i 1 n e t 0 i m e t 0 i m 2 where et0i m et0i e e t 0 i m and e t 0 i e are the calculated et0 by the standard fao 56 pm equation estimated et0 by the empirical or machine learning model mean of calculated et0 and mean of estimated et0 respectively n is the number of observations higher r2 and nse values indicate better model performance and data fitting conversely lower values of rmse mae and si suggest better prediction accuracy 3 results 3 1 performances of empirical and machine learning models for estimating monthly et0 the statistical indices of the thornthwaite hargreaves and four machine learning models e g m5p rf anfis and ffa elm models for estimating monthly mean daily et0 under the two input combinations during training and testing are given in table 1 as shown in the table when the model inputs were tave and ra the anfis and ffa kelm models gave comparable et0 estimates during testing both of which were superior to the other three models the m5p model was slightly better than the rf model the thornthwaite model performed worst among the models with r2 0 8981 rmse 1 2786 mm d 1 mae 1 0521 mm d 1 si 0 5185 and nse 0 2401 fig 5 shows the scatter plots of monthly mean daily et0 calculated by the fao 56 pm model and by the two empirical and four machine learning models with tmean and ra as inputs as seen from fig 5 the fitting lines between the fao 56 pm et0 and predicted values by the machine learning models were very close to the 1 1 line the data points of the m5p and rf models were more scattered while those of the anfis and ffa kelm models were more evenly distributed on both sides of the 1 1 line the fitting lines between the fao 56 pm et0 and predicted values by the thornthwaite model deviated greatly from the 1 1 line which underestimated et0 when the fao 56 pm et0 was less than 2 0 mm d 1 and seriously overestimated et0 when the fao 56 pm et0 was greater than 3 0 mm d 1 when the model inputs were tmax tmin and ra the anfis and ffa kelm models were still superior to the other models table 1 in addition the m5p and rf models performed similar to each other for predicting monthly et0 with slight better performance by the rf model the empirical hargreaves model was also inferior to the four machine learning models fig 6 shows the scatter plots of monthly mean daily et0 calculated by the fao 56 pm model and by the two empirical and four machine learning models with tmax tmin and ra as inputs in general the data points of the four machine learning models were more closely distributed around the 1 1 line compared to those with tmean and ra as inputs for the m5p model the model error was relatively larger when the value of fao 56 pm et0 was greater than 5 0 mm d 1 the rf anfis and ffa elm models were very close to each other the computational time of the m5p rf anfis and ffa kelm models under the two input combinations were also compared table 1 under the input combination of tavg and ra it is worth mentioning that the time required to run the hybrid ffa kelm model for one time was considered here still the ffa kelm model showed the longest running time taking more than 800 s in one run the rf and anfis models were also very time consuming reaching 51 1 s and 57 1 s respectively the m5p model was well known for its simple structure and minimal time which took the shortest running time of 12 8 s under the input combination of tmax tmin and ra the ffa kelm was also most time consuming which was 30 s slower than the corresponding model with tavg and ra the anfis model was also 50 slower than that with tavg and ra reaching nearly 100 s the m5p model was about two times slower 38 7 s than that under the first combination this can be due to that the increase of dimensions which made the single decision tree more complex and required the establishment of regression models at more nodes thereby leading to a more non linear growth however the computational time of the rf model 56 7 s did not increase much mainly because the depth of the tree and the number of trees did not change significantly under the two input combinations overall among the two empirical models the hargreaves model performed much better than the thornthwaite model the ffa kelm performed slightly better than the anfis model both of which outperformed the m5p rf and empirical models the prediction accuracy of the m5p rf anfis and ffa kelm models was improved by 7 0 15 5 in terms of rmse during testing when more temperature information tmax and tmin was included compared with that with only tavg however when maximum and minimum temperatures are not available in some circumstances such as remote sensing images and global climate models it is recommended to use average temperature and ra as model inputs from the perspective of time consumption the ffa kelm model needs to be greatly improved 3 2 performances of sub models based on kmeans ffa kelm model for estimating monthly et0 as mentioned above the ffa kelm model yielded better accuracy but much slower speed when estimating monthly et0 therefore the k means clustering algorithm was further applied to improve the computational efficiency of the ffa kelm model the statistical results and computational time of the novel kmeans ffa kelm model and the ffa kelm model during testing are presented in table 2 and fig 7 respectively it can be seen from the table that the number of subsets dividing the dataset can affect the accuracy of the model when the dataset was divided into more than 20 subsets the model accuracy was slightly improved the rmse of the novel kmeans ffa kelm model was decreased by 0 7 3 5 compared with that of the ffa kelm model under the two input combinations during testing in addition the computational time of the kmeans ffa kelm model was significantly reduced compared with that of the ffa kelm model under the two input combinations fig 7 the computational time first decreased and then increased with the increase in the number of subsets in both sequential and parallel computations as shown in fig 7 the ffa kelm 25 model obtained the shortest computational time in sequential computation 7 0 s and 7 4 s under the two input combinations respectively this indicated that after splitting the dataset the model efficiency was enhanced by up to 113 times compared to that of the ffa kelm model 802 2 s and 830 0 s respectively after dividing subsets it means that the model can be also run in the parallel mode the trend of the parallel results was similar to that of the sequential results fig 7 however the computational time of parallel kmeans ffa kelm 0 5 s and 0 7 s under the two input combinations respectively was 10 13 times shorter than that in the sequential model it can also be seen that the ffa kelm 25 model of parallel computation was 25 54 times faster than the m5p model and 1185 1603 times faster than the ffa kelm model under the two input combinations et0 is characterized by significant seasonal variations and the water demand and agricultural water consumption are usually at their peak in summer therefore it is necessary to evaluate whether the statistical errors in different months are within the appropriate range fig 8 presents the rmse values of the ffa kelm and ffa kelm 25 models in different months it can be seen that the maximum monthly rmse of the two models was no more than 5 5 mm d 1 the ffa kelm 25 model generally performed better than the ffa kelm model in summer under the two input conditions fig 9 shows the distribution of absolute error ae greater than 0 6 mm d 1 of the ffa kelm and ffa kelm 25 models for estimation of monthly et0 it can be seen that the ffa kelm 25 model outperformed the ffa kelm model in the number of extreme errors especially the number of ae greater than 0 9 mm d 1 had a significant decline which further proved that the k means clustering algirothm was applicable to decompose the model dataset and improve the prediction accuracy of the ffa kelm model 4 discussion according to allen 1998 the hargreaves model trended to overestimate et0 in humid regions studies have also shown that when rs was underestimated and the annual temperature daily range was small the hargreaves model would underestimate et0 in the humid area this phenomenon has been demonstrated in coastal areas with sub humid climates such as yucatan peninsula mexico and spain quej et al 2019 gavilán et al 2006 however the hargreaves model underestimated monthly et0 to some extent when fao 56 pm et0 was greater than 5 0 mm d 1 in this study in the development of machine learning models some models share the idea of weak learning and combined several weak learning models to form a strong learning for instance the m5p model integrates multiple linear models into one model through the decision tree and these linear models are distributed in different subspaces on the basis of decision tree the rf model also borrows this idea from the tree model to multiple trees models among the kernel based models including kelm all dimensional data are mapped to a hyperplane however how to map the data into multiple hyperplanes is a big issue in this study the k means clustering algorithm was used to divide the dataset into multiple subsets and establish hyperplanes in different subsets which was equivalent to integrating multiple kelm sub models the newly developed kelm sub models have obvious advantages over the original kelm model in terms of computational efficiency which can be explained by the time complexity the time complexity of the kernel based elm model is o n3 fan et al 2018 when the dataset is divided into 10 sub models the number of samples for each sub model is reduced to 10 o n 10 3 o n 3 100 obviously this is a huge improvement in computational speed in order to obtain a stable simulation effect the sample size of the training dataset is usually not less than that of the testing dataset kisi and heddam 2019 shiri et al 2013 petković et al 2015 the advantage of this is that the training dataset and the testing dataset have very close data distribution rules and upper and lower limits when the data volume is large this results in a large size of the training dataset thereby occupying a large amount of memory and slowing down the model the advantage of splitting the dataset using the k means clustering algorithm is that there is no need to worry about whether the subset and the original dataset have similar data distribution rules and there are no overlapping subsets particularly multiple sub models make it easier to run the kmeans ffa kelm model in parallel computation parallel running does not affect the accuracy of the model and the improvement in model efficiency is specific to the hardware level it is thus clear that more cores in cpus are suitable for more subsets of parallel computation however when the dataset is very small and there are many sub models the stability of the model will be affected in addition the speed improvement of the sub model will become marginal in this study it was recommended to split the dataset into 25 folds which not only improved the prediction accuracy but also saved computational time in addition the proposed method in this study also has the potential of distributed computation that is when a dataset is too large to realize the computing power of a single computer distributed multiple computers can be used to for calculation together however equal spacing was used to set the number of k means in the present study which may miss the optimal number besides when the data volume is larger how to select the appropriate number of classification efficiently remains a problem martí et al 2015b found that conclusions might be not sound or even false when only with calculated fao 56 pm et0 targets in machine learning models despite it is a common practice therefore the proposed kmeans ffa kelm model needs to be further tested with lysimetric et0 targets 5 conclusions this study proposed a novel parallel kernel extreme learning machine model with the k means clustering and firefly algorithms kmeans ffa kelm for estimating et0 in the poyang lake watershed of south china which were also compared with the hargreaves thornthwaite m5p anfis rf and ffa kelm models in terms of prediction accuracy and computational efficiency the main conclusions are as follows 1 the performances of the selected machine learning models under the input combination of tmax tmin and ra were improved by 7 0 15 5 in terms of rmse compared to that under the input combination of tavg and ra during testing 2 the hargreaves model performed much better than the thornthwaite model the ffa kelm model slightly outperformed the anfis model both of which were superior to the rf m5p and the two empirical models 3 the kffa kelm 25 model outperformed the ffa kelm model in summer and in the count of absolute errors greater than 0 9 mm d 1 4 the ffa kelm 25 model of parallel computation 0 5 0 7 s significantly reduced the computational time which was 10 13 times faster than the kmeans ffa kelm model of sequential computation 7 0 7 4 s and 1185 1603 times faster than the ffa kelm model 802 2 830 0 s declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by the national natural science foundation of china no 51709143 the nova program of shaanxi province of china 2020kjxx 019 the youth talent cultivation program of northwest a f university no 2452020010 and the natural science foundation of jiangxi province of china 20192bab216037 thanks to the national meteorological information center of china meteorological administration for offering the meteorological data 
10296,accurate and fast estimation of reference evapotranspiration et0 is important in determining crop water requirements designing irrigation schedule planning and managing agricultural water resources especially when limited meteorological data are available this study proposed a novel kernel extreme learning machine model coupled with the k means clustering and firefly algorithms kmeans ffa kelm with 5 10 15 20 25 30 and 40 data subsets for estimating monthly mean daily et0 in parallel computation in the poyang lake basin of south china with pooled temperature data from 26 weather stations two input combinations i e 1 mean temperature tavg and extraterrestrial radiation ra 2 maximum and minimum temperatures tmax and tmin and ra were considered meteorological data during 1966 2000 were used to train the models while those for the period 2001 2015 were used for model testing the results showed that the prediction accuracy of selected machine learning models with tmax tmin and ra was improved by 7 0 15 5 in terms of rmse compared to that with tavg and ra during testing the ffa kelm model slightly outperformed the adaptive network based fuzzy inference system anfis model both of which were superior to the random forest rf and m5 prime model tree m5p models followed by the hargreaves and thornthwaite models the rmse values of kmeans ffa kelm models with more than 20 subsets were decreased by 0 7 3 5 compared with those of the ffa kelm models the kmeans ffa kelm model with 25 subsets ffa kelm 25 outperformed the ffa kelm model in summer and in the count of absolute errors greater than 0 9 mm d 1 the computational time of kmeans ffa kelm models first decreased and then increased with the increase of the subset number the parallel ffa kelm 25 model 0 5 0 7 s significantly reduced the computational time which was 10 13 times faster than the sequential kmeans ffa kelm model 7 0 7 4 s and 1185 1603 times faster than the ffa kelm model 802 2 830 0 s this study provides a new and fast modeling method for processing large datasets in agricultural and water resources studies on a regional scale keywords machine learning kernel extreme learning machine firefly algorithm k means clustering parallel computation poyang lake basin 1 introduction reference evapotranspiration et0 is defined as the evapotranspiration amount of a hypothesized reference crop which has a height of 0 12 m a surface resistance of 70 s m 1 and an albedo of 0 23 allen et al 1998 accurate information of et0 magnitude is of crucial significance for determining crop water requirements designing irrigation schedule planning and managing water resources in agricultural and hydrological studies fan et al 2015 kisi 2016 zhang et al 2018 various meteorological variables such as solar radiation air temperature relative humidity and wind speed can interactively influence et0 therefore many attempts have been made so far to derive mathematical or regression based relationships between et0 and its driving factors the standard fao 56 penman monteith fao 56 pm equation is a semi empirical and semi physical model for calculating et0 from meteorological variables which has been acknowledged as a benchmark model for the calibration of other empirical et0 models allen et al 1998 feng et al 2016 wang et al 2019a 2019b chen et al 2020 yu et al 2019 however the fao 56 pm model requires the complete data of air temperature solar radiation wind speed and relative humidity for future scenarios it is not always realistic to obtain complete and high quality meteorological data especially in high resolution regional studies and long term studies thus empirical models with fewer input parameters have been developed and validated around the world among them empirical models based on air temperature data have been extensively studied due to its advantages of low data requirement and simple structure the thornthwaite model thornthwaite 1948 estimates monthly et0 by using only average temperature data which is favored worldwide pelton et al 1960 especially for calculating the drought index van der schrier et al 2011 chang et al 2019 introduced a modified daily thornthwaite equation to estimate daily et0 in different regions of china based on temperature forecasts trajkovic et al 2019 modified the thornthwaite model by replacing the average temperature with the effective temperature and found that the accuracy of the modified thornthwaite model was significantly higher than that of the original model for et0 estimation in northern serbia in addition to the thornthwaite model the hargreaves model hargreaves 1956 is also a well received empirical et0 model around the world inspired by the radiation based empirical model of continuous multiplication the model uses the daily temperature range and extraterrestrial radiation ra to estimate solar radiation and further multiplies the mean temperature to calculate et0 martí et al 2015a 2015b this model produces excellent performance in arid and semi arid regions but underestimated or overestimated et0 in humid regions quej et al 2019 wu et al 2019a 2019b feng et al 2017 calibrated the parameters of the hargreaves model in the sichuan basin of china and found that the calibrated hargreaves model decreased mae from 0 959 to 0 433 mm d 1 almorox and grieser 2016 suggested using climate class specific coefficients for improving the correlation between the long term monthly average et0 of the hargreaves and fao 56 pm models tang et al 2019 modified the temperature constants of the hargreaves model with altitude factors to improve its performance in tibet china zhang et al 2018 predicted the short term daily et0 using the hargreaves model and public weather forecast data paredes et al 2018 evaluated the performance of the hargreaves model in a humid environment of the azores island portugal the results indicated that the prediction accuracy of the hargreaves model was close to that of the temperature based pm model over the past few years machine learning models have become a better alternative to empirical models and they have been widely used for estimating et0 saggi and jain 2019 liu et al 2020 yan et al 2021 a great deal of efforts has been engaged in how to better forecast predict et0 using machine learning models these studies include but are not limited to different climate types nandagiri and kovoor 2006 fan et al 2018 modeling of meteorological factors feng et al 2017a jiang et al 2019 training testing methods shiri et al 2019a 2019b regional modeling methods wang et al 2019a 2019b comparison of various machine learning models wu and fan 2019 shiri et al 2019a 2019b fan et al 2019 coupling of various technologies tikhamarine et al 2019 tao et al 2018 sanikhani et al 2019 etc kisi 2016 evaluated the performances of the least square support vector machines lssvm multivariate adaptive regression splines mars and m5 prime model tree m5p models for et0 estimation in the presence or absence of local data it was found that the m5p model performed better when lack of local data while the lssvm model was more accurate in the local applications however wu et al 2019a 2019b found that the mars model was superior to the support vector machine svm model in the humid region of china mohammadrezapour et al 2019 compared the capability of svm gene expression programming gep and adaptive network based fuzzy inference system anfis models in et0 prediction in four cities of iran they found that the svm model with average temperature relative humidity wind speed and sunshine hour from the current and previous months yielded the best et0 estimates fan et al 2019 proposed a light gradient boosting machine lightgbm model for estimation of daily et0 in south china the lightgbm model was found to outperform the m5p random forests rf and empirical models under both local and external application scenarios wu and fan 2019 evaluated the performances of eight machine learning models for daily et0 estimation in different climate regions of china they found that models with only temperature data yielded acceptable accuracy and an inclusion of precipitation data further decreased the average rmse by 7 6 in china in recent years the extreme leaning machine elm model has attracted a wide range of scholars interests for its light and simple structure high efficiency and stability it has been applied in simulating many kinds of natural phenomena yaseen et al 2018 deo et al 2016 including et0 gocic et al 2016 fan et al 2018 kumar et al 2016 feng et al 2016 2017b abdullah et al 2015 firstly introduced the elm model for estimating et0 gocic et al 2016 verified the excellent performance of the elm model in nis and belgrade of serbia patil and deka 2016 assessed the suitability of the elm artificial neutral networks ann and empirical models under three input combinations in the thar desert india they found that the elm model was superior to the ann and empirical models in addition the elm model also achieved appropriate accuracy in southeastern brazil reis et al 2019 and in the sichuan province of china feng et al 2017a when only temperature data were available recently an improved elm model i e kernel extreme leaning machine kelm has been proposed for estimating monthly evaporation sebbar et al 2020 it was found that the kelm was useful for establishing more robust tools and improved the available machine learning models furthermore scholars have tried to couple machine learning models with various technologies to improve the model reliability accuracy or efficiency e g k means clustering ferreira et al 2019 wavelet decomposition kisi and alizamir 2018 and meta heuristic optimization algorithms khosravi et al 2019 han et al 2019 ehteram et al 2019 fan et al 2020 the wavelet decomposition method has proven to be a very powerful method of noise reduction kisi and alizamir 2018 moreover meta heuristic optimization algorithms have also been integrated with machine learning models wu et al 2020 fan et al 2020 among which the firefly algorithm ffa is an efficient biological simulation algorithm that can converge quickly tao et al 2018 confirmed that the ffa algorithm was able to ameliorate the accuracy of the anfis model in addition wu et al 2019a 2019b hybridized the elm model with four meta heuristic optimization algorithms for perdition of daily et0 in different climates of china it was found that the flower pollination algorithm fpa and cuckoo search algorithm csa were superior to the genetic algorithm ga and ant colony optimization aco in improving the elm model performance the kelm model has also been coupled with the firefly optimization algorithm ffa kelm for image classification and time series predictions su et al 2016 sannasi chakravarthy and rajaguru 2020 sui et al 2018 besides clustering analysis is a research hotspot in the field of data mining dhanachandra et al 2015 clustering is the process of classifying objects data in the same cluster are similar while data objects in different clusters are quite different therefore important information hidden behind the data can be found k means clustering is a hard clustering algorithm based on partition with the minimum error sum of squares as the objective function independent and compact clusters are formed due to its fast running speed and applicability to high dimensional data it has been widely used in simulation of natural phenomenon including but not limited to clustering of similar weather stations ferreira et al 2019 solar radiation benmouiza and cheknane 2013 storm identification and forecast lakshmanan et al 2003 wind speed ozkan and karagoz 2015 and rainfall runoff zahmatkesh et al 2015 the main disadvantage of the kelm model and many other conventional machine learning models is that they are very time consuming especially when there are large amounts of data this would become even worse when these models are integrated with the meta heuristic optimization algorithms with the accumulation of observation data and the refinement of research area traditional site specific models are no longer able to meet et0 research on a watershed scale therefore the purposes of this study were to 1 propose a novel parallel model that introducing both the k means clustering and firefly algorithms into the kelm model for more accurate and faster estimation of monthly et0 in the poyang lake basin of china with only temperature data 2 compare the prediction accuracy and computational efficiency of the proposed parallel kmeans ffa kelm model with the commonly used machine learning models e g m5p anfis rf and ffa kelm 2 material and methods 2 1 study area and data acquisition this study was conducted in the poyang lake basin of south china which is an important sub basin of the yangtze river basin the basin covers 166 2 thousand km2 and includes china s largest freshwater lake the area is mainly planted with double cropping rice and the drought is most severe in august and september when the rice needs to be irrigated in this region annual water consumption has exceeded 14 billion m3 the water situation in this area has changed in recent years with more frequent droughts and floods which has become one of the most prominent water resource conflicts in china in 2019 the poyang lake basin suffered from severe drought and the lake area reached its smallest value over the past 50 years in this study 26 meteorological stations were selected in poyang lake basin fig 1 the monthly meteorological data of average maximum and minimum air temperatures tave tmax and tmin wind speed relative humidity and sunshine duration were collected from https data cma cn all data from the 26 stations were pooled to estimate monthly mean daily et0 on a regional scale the dataset was divided into two parts for model training 1966 2000 and testing 2001 2015 the temperature data were divided into two groups i tave ii tmax and tmin and then combined with the extraterrestrial radiation ra as the input dataset of the machine learning models to meet the requirements of machine learning models raw weather data were normalized to 0 1 prior to training and testing using the following formula 1 z n z i z min z max z min where zn and zi are the normalized and raw values of the data zmax and zmin represent the maximum and minimum values of the raw data 2 2 standard fao 56 penman monteith equation for calculating reference evapotranspiration since the experimental et0 data were not available the standard fao 56 penman monteith fao 56 pm equation recommended by allen et al 1998 was applied to calculate et0 which provided the reference data to test the empirical and machine learning models 2 e t 0 0 408 r n g γ 900 t a 273 u e s e a δ γ 1 0 34 u where rn is the net radiation at the crop surface which is usually calculated by global solar radiation rs g is the soil heat flux density ta is the mean daily air temperature at 2 m height calculated as the mean of tmax and tmin u is the wind speed at 2 m height e s and e a are the saturation and actual vapor pressure δ is the slope of vapor pressure curve γ is the air psychrometric constant the details of the fao 56 pm model can be found in allen et al 1998 2 3 empirical models for estimating reference evapotranspiration 2 3 1 hargreaves model a method of estimating solar radiation based on the temperature difference was proposed by hargreaves 1956 and integrated into an empirical et0 model 3 e t 0 h 0 0023 r a t a 17 8 t max t min this model will cause underestimation of et0 in this region without parameter calibration wu et al 2019a 2019b in this study the model is modified as follows 4 e t 0 h s a r a t a b t max t min c where a b and c are empirical coefficients which are 0 000717 0 59 and 10 4 in the present study respectively 2 3 2 thornthwaite model the thornthwaite model thornthwaite 1948 only requires the average temperature to estimate et0 using the equation below 5 e t 0 t h 0 0 t a v e 16 10 t a v e i a 0 t a v e 26 5 c 0 43 t a v e 2 32 24 t a v e 415 85 t a v e 26 5 c 6 i k 1 12 0 2 t k 1 514 7 a 0 000000675 i 3 0 0000771 i 2 0 01792 i 0 49239 where i is the thermal index imposed by the local normal climatic temperature regime and a is a function of i 2 4 machine learning models for estimating reference evapotranspiration in this study the rf m5p anfis ffa kelm and kmeans ffa kelm models were developed to estimate monthly mean daily et0 the details of the conventional rf m5p and anfis models can be found in liaw and wiener 2002 wang and witten 1996 and jang 1993 respectively the ffa kelm and kmeans ffa kelm models are introduced in details as follows 2 4 1 k means clustering algorithm clustering is a number of ways which can divide a dataset into a certain number of subsets one of the popular clustering methods is the k means clustering algorithm developed by hartigan and wong 1979 this algorithm divides the dataset into k data groups by the geometric distance it classifies a given set of data into k independent clusters the k means clustering algorithm consists of two independent stages it computes k centers in the first phase and brings each piece of data to the closest cluster of centers in the second phase euclidean distance method is one of the most commonly used methods after the clustering is completed the new center of each cluster is recalculated based on this center the new euclidean distance between each center and each data point is calculated and the point with the minimum euclidean distance of the cluster is allocated the center of each cluster is the point where the sum of the distances to all objects in the cluster is the smallest k means clustering is thus an iterative algorithm in which it minimizes the sum of the distances from each object in the cluster to its core in this study the two input combinations have similar clustering patterns taking the input combination of tmax tmin and ra as an example monthly tmax and tmin were used as one piece of data since ra is only related to geographical factors this was written as t x1 x2 and used for clustering to k different groups ck the detailed algorithm for k means clustering is as follows 1 set the number k of clusters and determine the center ck 2 for each monthly input data calculate their euclidean distance d from the center 8 d t x 1 x 2 c k 3 assign all monthly input data to the nearest center based on distance d 4 after all data sets are allocated recalculate new location of the center using the relationship given as follow 9 c k 1 k x 1 c k x 2 c k t x 1 x 2 5 repeat the process 2 to 4 until it satisfies the tolerance or error value 6 divide the original dataset into k subsets according to the clustering although the k means clustering algorithm has the advantage of easy implementation it also has a disadvantages the quality of clustering results largely depends on the arbitrary selection of the initial center therefore if the initial center is randomly selected different results will be obtained for different initial centers the initial center has thus to be carefully selected for the two temperature based input combinations different k values will be used to distinguish them and evaluate the impact of different k values on the results this can reduce the deviation caused by the selection of the center 2 4 2 firefly algorithm ffa the ffa algorithm is based on the flash behavior of fireflies in the ffa algorithm a group of fireflies are randomly assigned to the solution space and each firefly represents an initial solution according to the target function of each firefly the fitness score is calculated and assigned as light intensity fireflies with low light intensity will be attracted by fireflies with strong light nearby as defined below 10 x i t 1 x i t β 0 e γ r i j 2 x j t x i t α t ε t where i and j represent fireflies with different light intensity respectively while x i t and x j t represent the current positions of fireflies i and j in the t th iteration respectively parameter β0 is the initial attraction γ is the light absorption coefficient and rij is the distance between firefly i and j the main advantage of the ffa algorithm is its attraction mechanism the attractivity based movement makes the firefly swarm automatically subdivide into subgroups and each group gathers around a global or local optimal solution when the population size is large enough to exceed the number of local optimal solutions in principle the segmentation ability of fa can find all the optimal values at the same time so as to obtain the global optimal value this ability of automatic subdivision enables the ffa algorithm to handle optimization problems with high nonlinearity and multiple modes 2 4 3 kernel extreme learning machine kelm huang et al 2006 first proposed the extreme learning machine elm model of single hidden layer feedforward neural networks and then considered it as the generalized slfns without tuning parameters in the hidden layer fig 2 the elm output function of the generalized slfns is expressed as follows 11 f l x i 1 l β i h i x h x β where β β 1 β 2 β l t indicates the vector of the output weights between the hidden layer of l nodes and the output node the output vector of the hidden layer with respect to input x is defined as 12 h x h 1 x h 2 x h l x then according to h x the dataset is mapped from d dimension input space to l dimension hidden layer feature space h that is h x is a feature map according to bartlett s 1998 theory the smaller the training error of feedforward neural network the smaller the norm of weight and the better the generalization performance of the network the elm model tends to minimize both the training error and output weight norm written as 13 min h β t 2 and β the h representation of the former is the output matrix of the hidden layer 14 h h x 1 h x 2 h x 3 h 1 x 1 h l x 1 h 1 x n h l x n actual meaning of minimizing the norm of the output weights β is to maximize the distance of the separating margins of different classes in the elm feature space the minimal normal least square method is also used in the elm model 15 β h t to reduce the time in determing the elm space dimensionality and overcome the defect of randomly assigning the weights the kernel extreme learning machine kelm has been recently proposed huang et al 2011 in the kelm method the hidden layer feature mapping is defined using the kernel functions 16 ω e l m h h t ω e l m i j h x i h x j k x i x j 17 f x h β h x h i c h h 1 t k x x 1 k x x n t i c ω e l m 1 t the radial basis function is set in the hidden layer in the form below 18 k x x i exp γ x x i 2 there are two important parameters in this method which are the regularization coefficient c and the width of kernel function γ there is no theoretical basis for these two parameters and it is thus necessary to obtain the optimal parameter combination through model tuning 2 4 4 hybrid ffa kelm and kmeans ffa kelm models the parameters of the kelm model were first optimized by the ffa algorithm fig 3 the k means clustering algorithm was then used to decompose the training dataset into multiple subsets and then build various sub models using the hybrid ffa kelm model finally sub models were merged into a new model named the kmeans ffa kelm model in this study the training and testing datasets under the two input combinations were divided into subsets of 5 10 15 20 25 30 and 40 folds the proposed machine learning models were implemented in the r program on a computer with intel core i7 4700 cpu and 16 gb of ram memory fig 4 2 5 statistical evaluation the performances of the empirical and machine learning models for estimating et0were evaluated by coefficient of determination r2 root mean square error rmse mean absolute error mae scatter index si and nash sutcliffe efficiency nse which can be expressed as 19 r 2 i 1 n e t i m e t i m e t i e e t i e 2 i 1 n e t i m e t i m 2 i 1 n e t i e e t i e 2 20 r m s e 1 n i 1 n e t 0 i m e t 0 i e 2 21 m a e 1 n i 1 n e t 0 i m e t 0 i e 22 s i 1 n i 1 n e t 0 i m e t 0 i e 2 e t 0 i m 100 23 n s e 1 σ i 1 n e t 0 i m e t 0 i e 2 σ i 1 n e t 0 i m e t 0 i m 2 where et0i m et0i e e t 0 i m and e t 0 i e are the calculated et0 by the standard fao 56 pm equation estimated et0 by the empirical or machine learning model mean of calculated et0 and mean of estimated et0 respectively n is the number of observations higher r2 and nse values indicate better model performance and data fitting conversely lower values of rmse mae and si suggest better prediction accuracy 3 results 3 1 performances of empirical and machine learning models for estimating monthly et0 the statistical indices of the thornthwaite hargreaves and four machine learning models e g m5p rf anfis and ffa elm models for estimating monthly mean daily et0 under the two input combinations during training and testing are given in table 1 as shown in the table when the model inputs were tave and ra the anfis and ffa kelm models gave comparable et0 estimates during testing both of which were superior to the other three models the m5p model was slightly better than the rf model the thornthwaite model performed worst among the models with r2 0 8981 rmse 1 2786 mm d 1 mae 1 0521 mm d 1 si 0 5185 and nse 0 2401 fig 5 shows the scatter plots of monthly mean daily et0 calculated by the fao 56 pm model and by the two empirical and four machine learning models with tmean and ra as inputs as seen from fig 5 the fitting lines between the fao 56 pm et0 and predicted values by the machine learning models were very close to the 1 1 line the data points of the m5p and rf models were more scattered while those of the anfis and ffa kelm models were more evenly distributed on both sides of the 1 1 line the fitting lines between the fao 56 pm et0 and predicted values by the thornthwaite model deviated greatly from the 1 1 line which underestimated et0 when the fao 56 pm et0 was less than 2 0 mm d 1 and seriously overestimated et0 when the fao 56 pm et0 was greater than 3 0 mm d 1 when the model inputs were tmax tmin and ra the anfis and ffa kelm models were still superior to the other models table 1 in addition the m5p and rf models performed similar to each other for predicting monthly et0 with slight better performance by the rf model the empirical hargreaves model was also inferior to the four machine learning models fig 6 shows the scatter plots of monthly mean daily et0 calculated by the fao 56 pm model and by the two empirical and four machine learning models with tmax tmin and ra as inputs in general the data points of the four machine learning models were more closely distributed around the 1 1 line compared to those with tmean and ra as inputs for the m5p model the model error was relatively larger when the value of fao 56 pm et0 was greater than 5 0 mm d 1 the rf anfis and ffa elm models were very close to each other the computational time of the m5p rf anfis and ffa kelm models under the two input combinations were also compared table 1 under the input combination of tavg and ra it is worth mentioning that the time required to run the hybrid ffa kelm model for one time was considered here still the ffa kelm model showed the longest running time taking more than 800 s in one run the rf and anfis models were also very time consuming reaching 51 1 s and 57 1 s respectively the m5p model was well known for its simple structure and minimal time which took the shortest running time of 12 8 s under the input combination of tmax tmin and ra the ffa kelm was also most time consuming which was 30 s slower than the corresponding model with tavg and ra the anfis model was also 50 slower than that with tavg and ra reaching nearly 100 s the m5p model was about two times slower 38 7 s than that under the first combination this can be due to that the increase of dimensions which made the single decision tree more complex and required the establishment of regression models at more nodes thereby leading to a more non linear growth however the computational time of the rf model 56 7 s did not increase much mainly because the depth of the tree and the number of trees did not change significantly under the two input combinations overall among the two empirical models the hargreaves model performed much better than the thornthwaite model the ffa kelm performed slightly better than the anfis model both of which outperformed the m5p rf and empirical models the prediction accuracy of the m5p rf anfis and ffa kelm models was improved by 7 0 15 5 in terms of rmse during testing when more temperature information tmax and tmin was included compared with that with only tavg however when maximum and minimum temperatures are not available in some circumstances such as remote sensing images and global climate models it is recommended to use average temperature and ra as model inputs from the perspective of time consumption the ffa kelm model needs to be greatly improved 3 2 performances of sub models based on kmeans ffa kelm model for estimating monthly et0 as mentioned above the ffa kelm model yielded better accuracy but much slower speed when estimating monthly et0 therefore the k means clustering algorithm was further applied to improve the computational efficiency of the ffa kelm model the statistical results and computational time of the novel kmeans ffa kelm model and the ffa kelm model during testing are presented in table 2 and fig 7 respectively it can be seen from the table that the number of subsets dividing the dataset can affect the accuracy of the model when the dataset was divided into more than 20 subsets the model accuracy was slightly improved the rmse of the novel kmeans ffa kelm model was decreased by 0 7 3 5 compared with that of the ffa kelm model under the two input combinations during testing in addition the computational time of the kmeans ffa kelm model was significantly reduced compared with that of the ffa kelm model under the two input combinations fig 7 the computational time first decreased and then increased with the increase in the number of subsets in both sequential and parallel computations as shown in fig 7 the ffa kelm 25 model obtained the shortest computational time in sequential computation 7 0 s and 7 4 s under the two input combinations respectively this indicated that after splitting the dataset the model efficiency was enhanced by up to 113 times compared to that of the ffa kelm model 802 2 s and 830 0 s respectively after dividing subsets it means that the model can be also run in the parallel mode the trend of the parallel results was similar to that of the sequential results fig 7 however the computational time of parallel kmeans ffa kelm 0 5 s and 0 7 s under the two input combinations respectively was 10 13 times shorter than that in the sequential model it can also be seen that the ffa kelm 25 model of parallel computation was 25 54 times faster than the m5p model and 1185 1603 times faster than the ffa kelm model under the two input combinations et0 is characterized by significant seasonal variations and the water demand and agricultural water consumption are usually at their peak in summer therefore it is necessary to evaluate whether the statistical errors in different months are within the appropriate range fig 8 presents the rmse values of the ffa kelm and ffa kelm 25 models in different months it can be seen that the maximum monthly rmse of the two models was no more than 5 5 mm d 1 the ffa kelm 25 model generally performed better than the ffa kelm model in summer under the two input conditions fig 9 shows the distribution of absolute error ae greater than 0 6 mm d 1 of the ffa kelm and ffa kelm 25 models for estimation of monthly et0 it can be seen that the ffa kelm 25 model outperformed the ffa kelm model in the number of extreme errors especially the number of ae greater than 0 9 mm d 1 had a significant decline which further proved that the k means clustering algirothm was applicable to decompose the model dataset and improve the prediction accuracy of the ffa kelm model 4 discussion according to allen 1998 the hargreaves model trended to overestimate et0 in humid regions studies have also shown that when rs was underestimated and the annual temperature daily range was small the hargreaves model would underestimate et0 in the humid area this phenomenon has been demonstrated in coastal areas with sub humid climates such as yucatan peninsula mexico and spain quej et al 2019 gavilán et al 2006 however the hargreaves model underestimated monthly et0 to some extent when fao 56 pm et0 was greater than 5 0 mm d 1 in this study in the development of machine learning models some models share the idea of weak learning and combined several weak learning models to form a strong learning for instance the m5p model integrates multiple linear models into one model through the decision tree and these linear models are distributed in different subspaces on the basis of decision tree the rf model also borrows this idea from the tree model to multiple trees models among the kernel based models including kelm all dimensional data are mapped to a hyperplane however how to map the data into multiple hyperplanes is a big issue in this study the k means clustering algorithm was used to divide the dataset into multiple subsets and establish hyperplanes in different subsets which was equivalent to integrating multiple kelm sub models the newly developed kelm sub models have obvious advantages over the original kelm model in terms of computational efficiency which can be explained by the time complexity the time complexity of the kernel based elm model is o n3 fan et al 2018 when the dataset is divided into 10 sub models the number of samples for each sub model is reduced to 10 o n 10 3 o n 3 100 obviously this is a huge improvement in computational speed in order to obtain a stable simulation effect the sample size of the training dataset is usually not less than that of the testing dataset kisi and heddam 2019 shiri et al 2013 petković et al 2015 the advantage of this is that the training dataset and the testing dataset have very close data distribution rules and upper and lower limits when the data volume is large this results in a large size of the training dataset thereby occupying a large amount of memory and slowing down the model the advantage of splitting the dataset using the k means clustering algorithm is that there is no need to worry about whether the subset and the original dataset have similar data distribution rules and there are no overlapping subsets particularly multiple sub models make it easier to run the kmeans ffa kelm model in parallel computation parallel running does not affect the accuracy of the model and the improvement in model efficiency is specific to the hardware level it is thus clear that more cores in cpus are suitable for more subsets of parallel computation however when the dataset is very small and there are many sub models the stability of the model will be affected in addition the speed improvement of the sub model will become marginal in this study it was recommended to split the dataset into 25 folds which not only improved the prediction accuracy but also saved computational time in addition the proposed method in this study also has the potential of distributed computation that is when a dataset is too large to realize the computing power of a single computer distributed multiple computers can be used to for calculation together however equal spacing was used to set the number of k means in the present study which may miss the optimal number besides when the data volume is larger how to select the appropriate number of classification efficiently remains a problem martí et al 2015b found that conclusions might be not sound or even false when only with calculated fao 56 pm et0 targets in machine learning models despite it is a common practice therefore the proposed kmeans ffa kelm model needs to be further tested with lysimetric et0 targets 5 conclusions this study proposed a novel parallel kernel extreme learning machine model with the k means clustering and firefly algorithms kmeans ffa kelm for estimating et0 in the poyang lake watershed of south china which were also compared with the hargreaves thornthwaite m5p anfis rf and ffa kelm models in terms of prediction accuracy and computational efficiency the main conclusions are as follows 1 the performances of the selected machine learning models under the input combination of tmax tmin and ra were improved by 7 0 15 5 in terms of rmse compared to that under the input combination of tavg and ra during testing 2 the hargreaves model performed much better than the thornthwaite model the ffa kelm model slightly outperformed the anfis model both of which were superior to the rf m5p and the two empirical models 3 the kffa kelm 25 model outperformed the ffa kelm model in summer and in the count of absolute errors greater than 0 9 mm d 1 4 the ffa kelm 25 model of parallel computation 0 5 0 7 s significantly reduced the computational time which was 10 13 times faster than the kmeans ffa kelm model of sequential computation 7 0 7 4 s and 1185 1603 times faster than the ffa kelm model 802 2 830 0 s declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was supported by the national natural science foundation of china no 51709143 the nova program of shaanxi province of china 2020kjxx 019 the youth talent cultivation program of northwest a f university no 2452020010 and the natural science foundation of jiangxi province of china 20192bab216037 thanks to the national meteorological information center of china meteorological administration for offering the meteorological data 
10297,using conventional methods to evaluate the irrigation water quality is usually expensive and laborious for the farmers particularly in developing countries however the applications of artificial intelligence models can overcome this issue through forecasting and evaluating the irrigation water quality indexes of aquifer systems using physical parameters as features this paper aims forecasting the total dissolved solid tds potential salinity ps sodium adsorption ratio sar exchangeable sodium percentage esp magnesium adsorption ratio mar and the residual sodium carbonate rsc parameters through electrical conductivity ec temperature t and ph as inputs to achieve this purpose we developed and evaluated adaptive boosting adaboost random forest rf artificial neural network ann and support vector regression svr models using 520 samples of data related to fourteen groundwater quality parameters in berrechid aquifer morocco the results revealed that the overall prediction performances of adaboost and rf models are higher than those of svr and ann however the generalization ability and sensitivity to the inputs analyses show that the ann and svr models are more generalizable and less sensitive to input variables than adaboost and rf globally the developed models are valuable in forecasting the irrigation water quality parameters and could help the farmers and decision makers in managing the irrigation water strategies the developed approaches in this study have been revealed promising in low cost and real time forecast of groundwater quality through the use of physical parameters as input variables graphical abstract ga1 keywords machine learning berrechid aquifer irrigation water quality sensitivity uncertainty prediction performance 1 introduction groundwater resources are considered among the main natural resources which support the socio economic development of countries however agriculture is the main sector that consumes groundwater in the world siebert et al 2010 these natural resources are confronting different issues that threaten their sustainability such as climate change effects anthropogenic activities and natural processes alabjah et al 2018 baghvand et al 2010 burri et al 2019 el asri et al 2019 houéménou et al 2020 mountadar et al 2018 generally these problems deteriorate the chemical composition of water and make it unsuitable for drinking and or irrigation purposes however monitoring and evaluating innovative approaches may be valuable to manage water quality and reduce pollution and health risks chowdury et al 2019 krupková et al 2019 sakai et al 2018 zhu et al 2019 for this purpose many methods and approaches have been applied and have demonstrated good results in evaluating the groundwater quality mapping pollution risk and assessing the health risk these methods include the index based approaches statistical and the geographic information system based methods that are frequently used in assessing and mapping the groundwater quality adimalla et al 2019 adimalla and taloor 2020 das et al 2020 el mountassir et al 2020 gao et al 2020 heiß et al 2020 jahin et al 2020 jamaa et al 2020 taloor et al 2020 tyagi and sharma 2014 wu et al 2020 to serve agricultural purposes the irrigation water quality iwq is commonly evaluated based on many indexes and parameters adopted by fao guidelines 29 ayers and westcot 1994 indeed to reduce subjectivity in evaluating the suitability of the water for irrigation purposes several studies have investigated the index based and statistical approaches recently singh et al 2018 have used saaty s analytic hierarchy process sahp to develop the irrigation water quality index iwqi jahin et al 2020 have developed an iwqi for surface water in egypt using the multivariate analysis ewaid et al 2019 have developed the irrigation water quality guide software to determine the water suitability for irrigation purposes based on the fao guidelines ayers and westcot 1994 and meireles et al 2010 iwqi although the results of all these studies have stated that using conventional approaches is rapid and cheap while evaluating and controlling processes they also required a large amount of datasets to be involved therefore using conventional methods in evaluating irrigation water quality could be laborious and expensive for farmers particularly in developing countries their high cost can be one of the plausible reasons for the poor water quality assessment amado et al 2019 nowadays sustainable management plans addressed to groundwater need innovative and smart methods with a reasonable cost in evaluating and forecasting the groundwater quality for this purpose the prediction based approaches may be valuable in overcoming this challenge in groundwater planning and management during the last two decades the application of artificial intelligence ai techniques has increased in many fields for instance in hydrological forecasting fields machine learning ml models have proved to be highly accurate in predicting the river flow yaseen et al 2019 for the groundwater modeling ai techniques have started to be satisfactory robust using various ml model in forecasting the groundwater level rajaee et al 2019 concerning the water quality prediction several studies have been carried out using ai techniques as reviewed by tiyasha and yaseen 2020 lu and ma 2020 applied extreme gradient boosting and random forest rf models to predict six water quality indicators in the river tualatin castrillo and garcía 2020 used linear and rf models to estimate the high frequent nutrient concentrations in the river thames meyers et al 2017 used artificial neural network ann support vector machine svm and rf models to predict the water turbidity of a trunk network in united kingdom chou et al 2018 determined the carlson s 1977 trophic state index ctsi of twenty reservoirs in taiwan using ml models el bilali et al 2020 used ann models to predict the chemical groundwater quality for drinking purposes fijani et al 2019 designed and implemented ai methods to support the reservoir water quality monitoring in real time di et al 2019 applied classification ml models to evaluate water quality in the yangtze river in china wagh et al 2016 used the ann model to determine the groundwater suitability for irrigation purposes and showed perfect performances using 13 physic chemical parameters as features importantly all these studies demonstrated that the ml models are highly accurate in predicting and evaluating water quality however the ml model efficiency does not only depend on prediction accuracy but also on the nature and number of the used predictors in this regard increasing input variables evaluated in the laboratory decreases the efficiency of ml models and their field application the literature review shows that most predictors of the applied models must be ideally evaluated in the laboratory besides the generalization ability and the sensitivity of the ml models to input variables are not analyzed enough even though they are a crucial issue in the practical implication interestingly using physical parameters such as electrical conductivity ph and temperature that can be measured by sensor technologies as predictors could significantly improve machine learning efficiency ayadi et al 2020 chowdury et al 2019 therefore it encourages decision makers to implement ai technologies for water quality planning and management it is vital to investigate the machine learning models for forecasting the iwq parameters using only the physical parameters as input variables without relying on reducing the performance of the models using archived data consequently in this study we attempt to contribute to overcoming the conventional method limitations using ml models to forecast groundwater quality for irrigation purposes under extensive salinization in morocco continuous decline in groundwater levels 0 5 2 m per year due to overexploitation and climate change impacts has become a serious challenge in planning and management water resources hssaisoune et al 2020 however the water quality of the most aquifer systems in the country is deteriorating and experiencing an extensive salinization due to the seawater intrusion climate change effects and anthropogenic activities alabjah et al 2018 fadili et al 2015 2016 fakir et al 2002 gamar et al 2018 lamrani alaoui et al 2008 molle and tanouti 2017 mountadar et al 2018 moyé et al 2017 seif ennasr et al 2016 this is a major problem in the agricultural sector that threats the national food and water security consequently irrigation water quality indexes iwqi must be predicted to evaluate and manage water suitability for irrigation uses and to ensure agricultural sustainability the main aims of this study are 1 to evaluate the capability of ml models in predicting the irrigation water quality parameters such as the potential salinity ps the sodium adsorption ratio sar the exchangeable sodium percentage of esp and the magnesium adsorption ratio mar in berrechid aquifer in morocco using the physical parameters as input variables 2 compare the performances of four models such as random forest support vector regression svr ann and adaptive boosting adaboost and selecting the best suitable models and 3 analyze the uncertainty and the sensitivity of the models 2 irrigation water quality parameters evaluation of water suitability for irrigation purposes relies on several parameters and indexes that are suggested by many organizations and agencies in this study we focus on the tds sar esp ps rsc and the mar parameters that are calculated as follow the tds is the sum of ion concentrations in the water as given by the 1 1 sorensen 1977 1 tds cations anions the potential salinity ps in meq l 1 is defined as the chloride concentration plus half of the sulfate concentration and is given by 2 2 doneen 1964 2 ps cl so 4 2 2 the sodium adsorption ratio sar in meq0 5 l 0 5 is calculated by 3 3 richards 1954 the high sar value reduces the hydraulic conductivity of the soil texture and therefore decreases the irrigation efficiency water is considered unsuitable for irrigation purposes if the sar value is more than 10 meq0 5 l 0 5 according to the fao guideline 3 sar na mg 2 ca 2 2 the exchangeable sodium percentage esp in parameter assesses the effect of the sodium on soil texture it is calculated by the 4 4 kopittke et al 2006 4 e s p n a c a 2 m g 2 n a k 100 the residual sodium carbonate rsc meq l 1 is calculated as follow 5 r s c c o 3 2 h c o 3 c a 2 m g 2 the magnesium absorption ratio is calculated by the 6 6 6 m a r m g 2 m g 2 c a 2 100 the ionic concentrations are given in meq l 1 except for tds parameter that is given in mg l 1 3 materials and methods 3 1 study area berrechid aquifer is located in the north west of morocco between the settat and the casablanca cities and covers a surface of about 15 000 km2 fig 1 this area is a semi arid region with an annual rainfall that ranges from 280 to 320 mm and more 90 of the precipitation is occurs during the rainy seasons between october to april while the temperature ranges from 6 5 c january to 38 c august geologically this site is part of the marine area of the western moroccan meseta the study area has been investigated for over six decades el houssine et al 2014 el mansouri 1992 1993 hazan and moullard 1962 lyazidi et al 2003 ruhard 1975 indeed various geological formations were deposited in the form of a large broth under semi arid climatic contexts combined with the old subsidence and sedimentations that range from the primary to the recent deposits however the litho stratigraphic sequence of these formations is as follows 1 primary the bedrock comprises of shale intercalated with the quartzite and sandstone layers wherein the outcrops with 150 m thick are silurian devonian and green acadian along the southeast and the northwest respectively el mansouri et al 1992 2 triassic these sediments are featured by saliferous red clays and siliciclastic intercalated by evaporate and basalt they are spread in the east part of the aquifer bensalah et al 2011 3 infra cenomanian comprises detrital red clays with a total thickness of about 40 m these depots are rich in gypsum with some layers of conglomerate followed by limestone and white to yellow marl layers 4 cenomanian these consist of dolomitic limestone and yellow marls with the intercalation of the greenish marl for a thickness of about 120 m ruhard 1975 5 pliocene form the system of the aquifer berrechid and consist of sandstones sands sandy limestone and minor conglomerate with a total thickness that ranges from 5 to 40 m droubi et al 2008 lyazidi et al 2003 6 quaternary these deposits are the dominant facies and essentially consist of silt and conglomerate series followed by red silty clays and then pebbles and gravel with a thickness of 0 50 m regarding the water quality this aquifer is characterized by three hydro geochemical facies na cl na mg ca cl and ca mg hco3 cl el ghali et al 2020 this area is characterized by fertile soil and productive groundwater that lead to the groundwater depletion and water quality deterioration as today it is unsuitable for drinking purposes el bouqdaoui et al 2010 el ghali et al 2020 elfarrak et al 2014 meanwhile the water is mainly used by the farmers for vegetable carrot and livestock productions ouassissou et al 2019 however the water quality is monitored by the river basin agency of bouregreg and chaouia through fourteen monitoring stations 3 2 machine learning models the used models are the adaptive boosting support vector regression svr random forest rf and artificial neural network ann approaches however extensive details on machine learning algorithms used and data mining can be found in aggarwal 2015 bishop 2006 bonaccorso 2018 freund and schapire 1997 1996 hastie et al 2009 and kubat 2017 3 2 1 adaptive boosting adaboost adaboost is a boosting algorithm introduced by freund and schapire 1997 it can be used for classification and regression tasks for a dataset s x i y i i 1 2 3 n where each x i is in some instance x and each y i is in some label y and for a series of round m the algorithm initializes the distribution d or weight as follow 7 d i 1 1 n f o r i 1 n then for j 1 to m adaboost algorithm builds weak models h j from the training dataset using d that minimizes ε j and satisfies ε j 0 5 conditions ε j is a weighted error of the j th model and is given by 8 8 8 ε j i h j x i y i d i j the weight confidence α j of the j th model is calculated by the 9 9 9 α j 1 2 ln 1 ε j ε j the distributions for next iteration were updated as follow 10 d i j 1 e y i h j x i α j d i j 11 d i j 1 d i j 1 i 1 n d i j 1 the prediction for new dataset is conducted by combining weighted majority vote of the models h j 12 h x s i g n j m α j h j x 3 2 2 support vector machine svm support vector machine svm is a discriminative method applied to both the classification and regression svr tasks based on the construction of a hyper plane to minimize errors vapnik 1995 for modeling system s with observation dataset ds d s x i y i i 1 n xi represents the inputs and y i the outputs with a linear function as shown in 7 7 13 f x ω x b the optimal function is the minimization of the function 14 subject to 15 15 hence the loss functions such as ϵ insensitive quadratic and hubber methods can be used 14 min ω b ξ ξ 1 2 ω 2 c i 1 n ξ i ξ i 15 s t y i ω t x b ε ξ i y i ω t x b ε ξ i ξ i ξ i 0 i 1 2 n with x is a kernel function k such as polynomial radial basis and linear functions ω and b represent weigh and basis vectors and c is a pre specified value to penalize the training error while ξ i and ξ i are the lower and upper constraints on the output this study adopted the radial basis function rbf given by the 16 16 as kernel function ghosh 2010 16 k x i x j e x p γ x i x j 2 3 2 3 random forest random forest rf is an ensemble of ml model based on decision trees breiman 2001 regression and classification are conducted by aggregating a technique that operates by constructing an ensemble of decision trees in training by swapping and changing the covariates to improve the prediction performance the target is achieved by weighted average of tree outputs executing this model requires a number of trained trees and an amount of the variable used in each tree liaw and wiener 2002 these parameters play an important role in the stability of the model and therefore in prediction performances oshiro et al 2012 in this study we determine the model parameters by trial error method 3 2 4 artificial neural network ann is commonly used as ml model in groundwater modeling rajaee et al 2019 ann model is composed of three layers namely input layer hidden layers and output layer these layers are interconnected through the neurons that are characterized by weight and bias the variables weighted summed with the bias of the layer are transformed from the layer j th to the j 1th layer through an activation function f and so on until the target layer dawson and wilby 1998 the training process is iteratively repeated by changing the weights and the biases of the layers until good preliminary performance coefficient of correlation to simplify this approach we take the models with three mlp layers and the outputs y k are given by the flowing equation schalkoff 1997 17 y k f k i 1 m w j k f j i 1 n x i w i j w 0 with n is the feature numbers m is the neuron numbers in the hidden layer and p is the neuron numbers of the target layers w 0 is the bias w jk and w ij are the weights between the j th neuron and the k th target neuron and between the i th neuron and j th neuron respectively whereas f k and f j are the transfer functions of the neurons k and j of the output and hidden layers respectively 3 3 data processing and model performance evaluation methods 3 3 1 data collection and analysis five hundred and twenty samples of groundwater quality from berrechid aquifer have been considered in this study all samples were provided by river basin agency of bouregreg and chaouia and were collected from the fourteen monitoring stations illustrated in fig 1 indeed the depth of the wells ranges from 40 m to 140 m the sampling protocol was carried out during the pumping for irrigation purposes two times during spring and the summer for the period from 2009 to 2019 these samples include the measurements of the parameters the electrical conductivity ec ph temperature cl so4 2 co3 2 hco3 no3 no2 nh4 na k ca2 and mg2 concentrations the physical parameters were measured in situ during the sampling meanwhile the other parameters were analyzed in the laboratory using the flame photometer for na and k uv spectrophotometer for the nitrate and sulfate concentrations and volumetric titration method for the other ion concentrations fig 2 summarizes the distribution of the parameter values by sample all ion concentrations are in mg l 1 temperature is in c and ec is in µs cm 1 it can be seen that there are some outlier values on almost all parameters consequently it is necessary to analyze these data before their input moreover in ml models development the exploration and cleaning of the data are important steps to have accurate and reliable models in this study data pre processing was conducted following five steps 1 data reliability checking this operation was carried out through the calculation of the absolute value of the charge balance error cbe as given by 17 17 of the groundwater samples and those which have more than 5 in absolute value were rejected freeze and cherry 1979 moreover the outlier value detections of physical parameters were conducted using the boxplots 18 c b e c a t i o n s a n i o n s c a t i o n s a n i o n s 100 2 calculation of the iwq parameters and data analysis statistical analysis of data was carried out descriptive statistic characteristic of iwq parameters are summarized and plotted as boxplot to detect the outlier values the correlation matrix was plotted and analyzed using pearson method 3 data normalization from 0 to 1 to reduce the dimensionality influence of the variables on the model performances and to improve the model generalization 4 model training and validation processes 5 uncertainty and sensitivity analysis of the ml model 3 3 2 metric evaluation models the model performances are evaluated using three statistical criterions coefficient of correlation r root mean square error rmse and the relative bias rbias the coefficient of correlation r was calculated by 18 18 the coefficient of correlation 1 show the best correlation between the observed and predicted values but it does not indicate the best model meanwhile the lower value of r indicates a worse fit model 19 r i 1 n x o i x o x p i x p i 1 n x o i x o 2 i 1 n x p i x p 2 0 5 the rmse is the square root of the variance of the residual errors the lower value of the rmse compared to the output ranges indicates the better fit of the model 20 r m s e x p i x o i 2 n the rbias was used to state if the model tended to underestimate rbias 0 or overestimate rbias 0 the target magnitude and was calculated by 20 20 if the rbias equals 0 the model is perfect while higher absolute value of rbias indicates that the model is biased 21 r b i a s i 1 n x o i x p i i 1 n x o i xo xp and x o are observed and the model predicted mean of observed values respectively in developing of ml models the great challenge is to guarantee the generalization ability ga of the models yoon et al 2011 defined the ga in predicting the groundwater level by the 21 21 ga values are unity indicate the ml model is perfect if the ga is less than unity the models are under trained while higher than unity the models are over trained 22 g a r m s e d u r i n g t h e v a l i d a t i o n p h a s e r m s e d u r i n g t h e t r a i n i n g p h a s e however the total uncertainty of the fitted models was evaluated through comparing the observed and simulated values and calculating of the standard error and the confidence bound as follow 23 ei x o i x p i 24 s d i 1 n e i e 2 n 1 25 cb z sd n with ei is the error z is z score of confidence level for 95 is about 1 96 and e is the mean prediction error ie is the interval prediction error and n number of the observations used furthermore sensitivity analysis of the models was evaluated to determine the input variables that influence significantly the model predictions of the water irrigation parameters this was carried out using one factor at time ofat method here the rmse values of the model performances were evaluated with one input variable omitted a time by generating randomly the uncertainties using the monte carlo method while the other variables were held constants then the impact of each input on the rmse value was evaluated by calculating the absolute value of the difference in rmse δrmse accordingly the model sensitivity to an input increases with increasing δrmse 4 results and discussion 4 1 data pre processing 4 1 1 data cleaning checking data reliability by 17 17 shows that 38 samples have cbe more than 5 in absolute value and they are considered unsuitable in this study fig 3 illustrates the scatterplot of sum cations vs sum anions this figure demonstrates a good reliability of samples since cbe is less than 5 in absolute value fig 4 presents the boxplots of irrigation water quality parameters and studied variables this figure demonstrates that most parameters have some outlier values tds ph and temperature parameters have 5 outlier values while the rsc ps temperature and sar parameters have 16 11 8 and 2 outlier values respectively wang et al 2020 demonstrated that removing outlier values does not improve the prediction accuracy of ml models however some outliers of physical parameters cannot be acceptable i e ph 0 75 and temperature 41 5 c and therefore we removed their corresponded samples six samples overall 476 samples were retained as suitable data in terms of reliability for this study to reduce dimensionality impacts on model performances the data were normalized in range from 0 to 1 table 1 presents basic statistical characteristics mean minimum maximum ith quartile qi and the standard deviation sd of irrigation water quality indexes calculated based on the 476 of the retained samples this table shows that more than 50 of samples have ec and tds values considered high according to ayers and westcot 1994 salinity restrictions meanwhile for the other parameters except for the extreme values the restrictions are moderate to none for irrigation purposes 4 1 2 exploratory data analysis for further exploration of the variable a matrix correlation analysis and the importance evaluation of input variables have been carried out fig 5 presents the matrix correlation fig 5a and variable ranks fig 5b the results show that the electrical conductivity ec has strong correlations with tds r 0 96 ps r 0 95 sar r 0 78 and rsc r 0 79 parameters and it has a moderate correlations with the esp r 0 50 and mar r 0 41 parameters the ph has weak correlations with all parameters meanwhile the temperature has the lowest correlations with all parameters such results reflect that the electrical conductivity is more correlated input variable with the predicted parameters than the ph and temperature however strong correlations do not imply causality as the complex combinations of the features can have influences on the target variable meanwhile the lower correlations between the t ph and ec demonstrate that these parameters are separable and not redundant input variables and therefore are useful to improve the prediction accuracy of the ml models kuhn and johnson 2019 besides the importance of the input variables was evaluated using relief algorithm kira and rendell 1992 fig 5b presents the ranks of the ec temperature and ph variables for predicting the iwq parameters globally it was observed that there is no significant difference between the variables importance consequently we adopted the three parameters as features of the ml models 4 2 model training results before the training phase the selected data are organized in csv files and were divided into two datasets 300 samples were used for the training testing process and 176 samples were used for validations phase then the ml models were built in jupyter using anaconda platform tools www anaconda com products individual to avoid the over fitting of the models we used the k fold cross validation method k 5 during the training process arlot and celisse 2010 the optimal architectures functions and hyper parameters of each model were determined through a trial and error analysis by their changing during the training phase table 2 presents optimal parameters and functions selected table 3 represents the rmse r and the rbias values of the models during the training process these results show that the svr model has significant values of rbias and rmse compared to other models in predicting the tds and rsc parameters ann rf and adaboost models demonstrated high accuracy in predicting the tds parameter during the training process with r 0 95 rmse 457 mg l 1 for data ranging from 2000 to 9400 mg l 1 and rbias 1 in average for the ps parameter all models had excellent performances with average coefficients of correlations 0 93 rbias less than 3 in absolute value and average rmses of about 7 9 meq l 1 for ps values range from 0 5 to 150 meq l 1 regarding the sodium hazard prediction all models have satisfactory performance in predicting the sodium adsorption ratio sar and exchangeable sodium percentage esp parameters coefficients of correlations ranged from 0 75 to 0 82 rmse less than 3 meq0 5 l 0 5 and rbiass ranged from 0 33 to 5 63 for sar parameter meanwhile for the esp parameter the coefficients of correlations ranged from 0 59 to 0 65 and rbias was less than 3 in predicting the mar parameter all models gave relatively good performances with rbias less than 2 in absolute value however the coefficients of correlations are weak except for the adaboost model which has r 0 64 as for the rsc parameter all other models have significant performances average of r is about 0 75 and rbias less than 4 comparing these models the adaboost shows excellent to good performances for predicting all parameters followed by random forest and artificial neural network models which failed to predict the mar parameters interestingly the svr model also shows significantly worse performances for predicting the tds and mar parameters during the training phase importantly during the training process it was observed that there is no significant superiority observed between the ensemble models adaboost and random forest and ann however the validation process generalization ability evaluation the sensitivity and uncertainty analysis are important issues in the application of ml in groundwater resource planning and management 4 3 validation and generalization ability results after the training process all models were used for simulating 176 samples to evaluate their validation and generalization table 4 presents the rmse r and rbias values of the models during the validations process compared to ann and svr models rf and adaboost models showed remarkably high performances for predicting the tds ps sar esp and rsc parameters with r values ranging from 0 65 to 0 99 and rbias less than 1 in absolute value additionally the adaboost and rf have performances more excellent than those evaluated during the training phase for predicting all parameters meanwhile ann and svr models present prediction accuracy closer to that during the training phase compared to the performances presented in table 3 table 4 shows that svr model still has unacceptable performances for simulating tds and mar parameters with high values of rmse 1270 68 mg l 1 and rbias 15 37 for tds parameter low coefficient of correlation r 0 51 and high rmse 14 74 for mar parameter similarly the ann and rf models failed to predict the mar parameter during the validation process due to the high rmse and low coefficient of correlation fig 6 shows the scatterplots of the observed and simulated values by the models during the validation process the accuracy of the models is satisfactory when the values are distributed over or evenly on both slides the line x y showing that the errors obey the gaussian distribution this figure reflects that the predicted values by the ensemble models rf and adaboost are distributed over the x y line better than those of the ann and svr models furthermore the adaboost showed better performances where the predicted values are very closer to the observed values and for the random forest model except for the mar parameter the predicted values are quite evenly distributed over the x y line concerning the svr and ann models they showed fairly good value distributions over the x y line for three ps sar and rsc and four tds ps sar and rsc parameters respectively importantly the svr and ann models failed to reproduce the esp parameter as the predicted vales are far away from the y x line and they have rmse more than 10 even when they showed relatively good performances during the training phase such results demonstrate the superiority of the adaboost and random forest models compared to the ann and svr models in predicting the studied irrigation water quality parameters by comparing the performances presented in table 4 it can be concluded that 1 the adaboost model has better performances in predicting all parameters followed by 2 random forest in predicting the tds ps sar esp rsc parameters by 3 the ann in predicting the tds ps sar and the rsc parameters then by 4 the svr model in predicting the ps sar and rsc parameter except for the svr in predicting the rsc parameter all other models have rbias values less than 5 in absolute value indicating that the fitted models are unbiased these results showed that the bagging and boosting learning models rf and adaboost are superior to traditional ann and svr models in terms of accuracy similarly zhao et al 2013 found that the adaboost is more accurate than the svm and ann models in predicting the short term ionospheric saghafi and arabloo 2017 demonstrated that the adaboost model provided high prediction accuracy for modelling the co2 solubility compared to the ann and svm models walker and jiang 2019 applied adaboost model for prediction of demand driven acquisition and found that it is higher accurate than the regression based model regarding to the rf model castrillo and garcía 2020 showed a high prediction accuracy of the rf model compared to the multiple linear regression approach besides there is a further agreement with previously published studies in classification tasks ahmed et al 2019 chen et al 2020b however forecasting iwq parameters in real time requires accurate generalizable and stable models some models have a high sensitivity to the input variables that could be unsuitable for forecasting purposes even they good overall performances besides the noisy data related to input variables caused by sensor technologies are very likely particularly during real time for example if a small fluctuation 1 5 c in temperature significantly influences prediction accuracy the model is considered unsuitable for forecasting the water quality in real times therefore the stability of the ml models in the forecasting of the iwq parameters in real time is critical particularly when the maker decision and the farmers have strategies to develop this approach in managing the saline water for irrigation purposes in this study we extend the exploration analysis of the applied ml models by discussing the generalization ability and the sensitivity to different input variables the generalization ability ga indices of the models were calculated by the 21 21 and presented in table 5 this table shows except for the ann model in predicting the tds all other models have ga values less than 1 indicating that they do not concentrate on training the given data rather than a more general system and the models were undertrained chen et al 2020a yoon et al 2011 although the ann and svr models have prediction performances not good than those of adaboost and rf models their overall generalization abilities are more perfect than those of the rf and adaboost models in this study area 4 4 uncertainty analysis results the problem of uncertainty of the conceptual based models in water quality modeling is inevitable and has been discussed in many studies kardos and obropta 2011 moreno rodenas et al 2019 radwan et al 2004 shojaei et al 2015 in this study we analyzed the total uncertainty of the fitted ml models table 6 presents the mean prediction error e and the 95 confidence band in predicting the tds ps sar esp mar and rsc parameters for 176 samples used during the validation process based on the uncertainty analysis results the adaboost model has a smaller 95 confidence band values followed by rf ann and svr models respectively 4 5 model sensitivity analyses the prediction accuracy and the ga analysis show that the ml models are suitable for forecasting the iwq parameters using the temperature ph and ec as input variables however the sensitivity analysis of the applied models to the inputs variables is required as a high sensitivity of a model to noisy data can dramatically distort the forecasting results and therefore the field application of this model is questionable therefore in this study the sensitivity analysis of the fitted models was carried out by adding randomly gaussian noises to the input variables and then re simulation of the 176 samples 2 c for the temperature 0 3 ph unity and 100 µs cm 1 for the ec the sensitivity analysis results of the models for forecasting irrigation water quality parameters are presented in table 7 it was observed that the model sensitivities to each input variable were uneven for forecasting the tds parameter the models are sensitive to the ec followed by temperature and ph with average values of δrmse about 59 90 56 16 and 38 3 mg l respectively these values are acceptable compared to the range of the tds parameter the models are more sensitive to the ec than to ph and temperature for forecasting the ps parameter the ph is the most important input variable in predicting the esp and rsc parameters however it can be seen that the model sensitivities to the features vary from one input to another from one parameter to another and from one model to another for all parameters the largest values of δrmse were obtained for the adaboost and rf models such results indicate that these models are more sensitive to the features than the ann and svr models however overall sensitivity analysis results demonstrate that the models are fairly stable in forecasting the iwq parameters 4 6 field practical implication in agricultural water management and future works the water scarcity issue is leading several countries to increase the use of the brackish water in their agricultural sector to ensure food security particularly in the arid and semi arid regions bortolini et al 2018 gosling and arnell 2016 however to reduce the impacts of the salinity and the water sodicity on the soil and the yield productivity managing saline water for irrigation purposes based on two main methods namely blending fresh and saline water and using gypsum filho et al 2020 kan and rapaport rom 2012 yaduvanshi and swarup 2005 zaman et al 2018 these processes require assessing the iwq parameters of the saline water coastal aquifer low water quality that increases the cost related to the laboratory analysis when using the conventional method particularly for the small farmers in our study we trained and validated the ml models for forecasting the iwq parameters using only physical parameters as predictors in accordance with the results of this study ml models appeared being accurate and robust tools in forecasting the tds ps sar esp mar and rsc parameters besides we analyzed the uncertainty and the sensitivity of these models to input variables these analyses show highlight that the overall generalization abilities of ann and svr models are higher than those of the rf and adaboost models also the two last models are more sensitive to the input variables than the ann and svr ones however selecting the ml models for forecasting the tds ps sar esp mar and rsc parameters should take into account the sensitivity of these models indeed applying sensitive models requires a high precision of sensor technologies to measure the input variables overall the performances and sensitivity of the models are acceptable for forecasting the studied iwq parameters and therefore will help the farmers to manage the saline water by measurement only the physical parameters as input variables at low cost specifically predicting the iwq parameters of the saline water in real time allows the optimization of the blending of the fresh and saline water process and the gypsum quantity considering that the electrical conductivity temperature and ph parameters are measured in quasi real time by river basin agency of bouregreg and chaouia through its automatic hydrological information system therefore using the applied ml models is efficient in forecasting the groundwater quality parameters also nowadays smart technologies based on the internet of thing iot are innovative methods for monitoring and analyzing data chowdury et al 2019 liu et al 2019 therefore implementing of the developed ml models and mapping the prediction results in a monitoring platform will help the farmers to manage the saline water and to improve yield productivity in this area alternatively integration of the ml models in web or mobile applications that could be available for the farmers improves the field applicability of these models in water quality management in the agriculture however the management of the saline water can integrate two components the soil types and the crop s tolerance in this study the applied ml models are powerful tools to forecast the iwq parameter rather than to evaluate the water suitability for irrigation purposes according to the tolerance restrictions and the soil types importantly using the classification ml models and embedding the soil types and the salinity tolerance of crops could be fruitful tools to manage the saline water with the aim to ensure sustainability agriculture therefore the integration of these aspects can be considered an emerging topic for future research 5 conclusion the main aims of this study were to evaluate whether the ml models are valuable tools to forecast the iwq parameters using physical parameters as features and to analyze their sensitivity to the input variables therefore the adaptive boosting random forest ann and svr models were developed and evaluated in predicting the tds ps sar esp mar and rsc parameters using the physical parameters as features through this study the major findings are as follow 1 adaboost model is suitable for forecasting all parameters followed by rf model in forecasting 5 parameters except mar parameter the ann and svr models have good performances for forecasting 4 tds ps sar and rsc parameters and 3 ps sar and rsc parameters of 6 parameters respectively 2 the ensemble models adaboost and random forest had prediction performances better than the traditional ann and svr models during the validation performance 3 the svr and ann models presented higher generalization ability than those of the adaboost and rf models 4 overall the sensitivity analysis shows that the developed models had minor sensitivities to the input variables used compared to the range of each forecast parameter ml models relying on physical parameters as features are efficient tools and should be recommended for forecasting the iwq parameters to manage the saline water they will improve groundwater quality monitoring for irrigation purposes in real time at a low cost declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by river basin agency of bouregreg and chaouia abhbc by providing further data required authors thank the teams of the abhbc for their great assistance 
10297,using conventional methods to evaluate the irrigation water quality is usually expensive and laborious for the farmers particularly in developing countries however the applications of artificial intelligence models can overcome this issue through forecasting and evaluating the irrigation water quality indexes of aquifer systems using physical parameters as features this paper aims forecasting the total dissolved solid tds potential salinity ps sodium adsorption ratio sar exchangeable sodium percentage esp magnesium adsorption ratio mar and the residual sodium carbonate rsc parameters through electrical conductivity ec temperature t and ph as inputs to achieve this purpose we developed and evaluated adaptive boosting adaboost random forest rf artificial neural network ann and support vector regression svr models using 520 samples of data related to fourteen groundwater quality parameters in berrechid aquifer morocco the results revealed that the overall prediction performances of adaboost and rf models are higher than those of svr and ann however the generalization ability and sensitivity to the inputs analyses show that the ann and svr models are more generalizable and less sensitive to input variables than adaboost and rf globally the developed models are valuable in forecasting the irrigation water quality parameters and could help the farmers and decision makers in managing the irrigation water strategies the developed approaches in this study have been revealed promising in low cost and real time forecast of groundwater quality through the use of physical parameters as input variables graphical abstract ga1 keywords machine learning berrechid aquifer irrigation water quality sensitivity uncertainty prediction performance 1 introduction groundwater resources are considered among the main natural resources which support the socio economic development of countries however agriculture is the main sector that consumes groundwater in the world siebert et al 2010 these natural resources are confronting different issues that threaten their sustainability such as climate change effects anthropogenic activities and natural processes alabjah et al 2018 baghvand et al 2010 burri et al 2019 el asri et al 2019 houéménou et al 2020 mountadar et al 2018 generally these problems deteriorate the chemical composition of water and make it unsuitable for drinking and or irrigation purposes however monitoring and evaluating innovative approaches may be valuable to manage water quality and reduce pollution and health risks chowdury et al 2019 krupková et al 2019 sakai et al 2018 zhu et al 2019 for this purpose many methods and approaches have been applied and have demonstrated good results in evaluating the groundwater quality mapping pollution risk and assessing the health risk these methods include the index based approaches statistical and the geographic information system based methods that are frequently used in assessing and mapping the groundwater quality adimalla et al 2019 adimalla and taloor 2020 das et al 2020 el mountassir et al 2020 gao et al 2020 heiß et al 2020 jahin et al 2020 jamaa et al 2020 taloor et al 2020 tyagi and sharma 2014 wu et al 2020 to serve agricultural purposes the irrigation water quality iwq is commonly evaluated based on many indexes and parameters adopted by fao guidelines 29 ayers and westcot 1994 indeed to reduce subjectivity in evaluating the suitability of the water for irrigation purposes several studies have investigated the index based and statistical approaches recently singh et al 2018 have used saaty s analytic hierarchy process sahp to develop the irrigation water quality index iwqi jahin et al 2020 have developed an iwqi for surface water in egypt using the multivariate analysis ewaid et al 2019 have developed the irrigation water quality guide software to determine the water suitability for irrigation purposes based on the fao guidelines ayers and westcot 1994 and meireles et al 2010 iwqi although the results of all these studies have stated that using conventional approaches is rapid and cheap while evaluating and controlling processes they also required a large amount of datasets to be involved therefore using conventional methods in evaluating irrigation water quality could be laborious and expensive for farmers particularly in developing countries their high cost can be one of the plausible reasons for the poor water quality assessment amado et al 2019 nowadays sustainable management plans addressed to groundwater need innovative and smart methods with a reasonable cost in evaluating and forecasting the groundwater quality for this purpose the prediction based approaches may be valuable in overcoming this challenge in groundwater planning and management during the last two decades the application of artificial intelligence ai techniques has increased in many fields for instance in hydrological forecasting fields machine learning ml models have proved to be highly accurate in predicting the river flow yaseen et al 2019 for the groundwater modeling ai techniques have started to be satisfactory robust using various ml model in forecasting the groundwater level rajaee et al 2019 concerning the water quality prediction several studies have been carried out using ai techniques as reviewed by tiyasha and yaseen 2020 lu and ma 2020 applied extreme gradient boosting and random forest rf models to predict six water quality indicators in the river tualatin castrillo and garcía 2020 used linear and rf models to estimate the high frequent nutrient concentrations in the river thames meyers et al 2017 used artificial neural network ann support vector machine svm and rf models to predict the water turbidity of a trunk network in united kingdom chou et al 2018 determined the carlson s 1977 trophic state index ctsi of twenty reservoirs in taiwan using ml models el bilali et al 2020 used ann models to predict the chemical groundwater quality for drinking purposes fijani et al 2019 designed and implemented ai methods to support the reservoir water quality monitoring in real time di et al 2019 applied classification ml models to evaluate water quality in the yangtze river in china wagh et al 2016 used the ann model to determine the groundwater suitability for irrigation purposes and showed perfect performances using 13 physic chemical parameters as features importantly all these studies demonstrated that the ml models are highly accurate in predicting and evaluating water quality however the ml model efficiency does not only depend on prediction accuracy but also on the nature and number of the used predictors in this regard increasing input variables evaluated in the laboratory decreases the efficiency of ml models and their field application the literature review shows that most predictors of the applied models must be ideally evaluated in the laboratory besides the generalization ability and the sensitivity of the ml models to input variables are not analyzed enough even though they are a crucial issue in the practical implication interestingly using physical parameters such as electrical conductivity ph and temperature that can be measured by sensor technologies as predictors could significantly improve machine learning efficiency ayadi et al 2020 chowdury et al 2019 therefore it encourages decision makers to implement ai technologies for water quality planning and management it is vital to investigate the machine learning models for forecasting the iwq parameters using only the physical parameters as input variables without relying on reducing the performance of the models using archived data consequently in this study we attempt to contribute to overcoming the conventional method limitations using ml models to forecast groundwater quality for irrigation purposes under extensive salinization in morocco continuous decline in groundwater levels 0 5 2 m per year due to overexploitation and climate change impacts has become a serious challenge in planning and management water resources hssaisoune et al 2020 however the water quality of the most aquifer systems in the country is deteriorating and experiencing an extensive salinization due to the seawater intrusion climate change effects and anthropogenic activities alabjah et al 2018 fadili et al 2015 2016 fakir et al 2002 gamar et al 2018 lamrani alaoui et al 2008 molle and tanouti 2017 mountadar et al 2018 moyé et al 2017 seif ennasr et al 2016 this is a major problem in the agricultural sector that threats the national food and water security consequently irrigation water quality indexes iwqi must be predicted to evaluate and manage water suitability for irrigation uses and to ensure agricultural sustainability the main aims of this study are 1 to evaluate the capability of ml models in predicting the irrigation water quality parameters such as the potential salinity ps the sodium adsorption ratio sar the exchangeable sodium percentage of esp and the magnesium adsorption ratio mar in berrechid aquifer in morocco using the physical parameters as input variables 2 compare the performances of four models such as random forest support vector regression svr ann and adaptive boosting adaboost and selecting the best suitable models and 3 analyze the uncertainty and the sensitivity of the models 2 irrigation water quality parameters evaluation of water suitability for irrigation purposes relies on several parameters and indexes that are suggested by many organizations and agencies in this study we focus on the tds sar esp ps rsc and the mar parameters that are calculated as follow the tds is the sum of ion concentrations in the water as given by the 1 1 sorensen 1977 1 tds cations anions the potential salinity ps in meq l 1 is defined as the chloride concentration plus half of the sulfate concentration and is given by 2 2 doneen 1964 2 ps cl so 4 2 2 the sodium adsorption ratio sar in meq0 5 l 0 5 is calculated by 3 3 richards 1954 the high sar value reduces the hydraulic conductivity of the soil texture and therefore decreases the irrigation efficiency water is considered unsuitable for irrigation purposes if the sar value is more than 10 meq0 5 l 0 5 according to the fao guideline 3 sar na mg 2 ca 2 2 the exchangeable sodium percentage esp in parameter assesses the effect of the sodium on soil texture it is calculated by the 4 4 kopittke et al 2006 4 e s p n a c a 2 m g 2 n a k 100 the residual sodium carbonate rsc meq l 1 is calculated as follow 5 r s c c o 3 2 h c o 3 c a 2 m g 2 the magnesium absorption ratio is calculated by the 6 6 6 m a r m g 2 m g 2 c a 2 100 the ionic concentrations are given in meq l 1 except for tds parameter that is given in mg l 1 3 materials and methods 3 1 study area berrechid aquifer is located in the north west of morocco between the settat and the casablanca cities and covers a surface of about 15 000 km2 fig 1 this area is a semi arid region with an annual rainfall that ranges from 280 to 320 mm and more 90 of the precipitation is occurs during the rainy seasons between october to april while the temperature ranges from 6 5 c january to 38 c august geologically this site is part of the marine area of the western moroccan meseta the study area has been investigated for over six decades el houssine et al 2014 el mansouri 1992 1993 hazan and moullard 1962 lyazidi et al 2003 ruhard 1975 indeed various geological formations were deposited in the form of a large broth under semi arid climatic contexts combined with the old subsidence and sedimentations that range from the primary to the recent deposits however the litho stratigraphic sequence of these formations is as follows 1 primary the bedrock comprises of shale intercalated with the quartzite and sandstone layers wherein the outcrops with 150 m thick are silurian devonian and green acadian along the southeast and the northwest respectively el mansouri et al 1992 2 triassic these sediments are featured by saliferous red clays and siliciclastic intercalated by evaporate and basalt they are spread in the east part of the aquifer bensalah et al 2011 3 infra cenomanian comprises detrital red clays with a total thickness of about 40 m these depots are rich in gypsum with some layers of conglomerate followed by limestone and white to yellow marl layers 4 cenomanian these consist of dolomitic limestone and yellow marls with the intercalation of the greenish marl for a thickness of about 120 m ruhard 1975 5 pliocene form the system of the aquifer berrechid and consist of sandstones sands sandy limestone and minor conglomerate with a total thickness that ranges from 5 to 40 m droubi et al 2008 lyazidi et al 2003 6 quaternary these deposits are the dominant facies and essentially consist of silt and conglomerate series followed by red silty clays and then pebbles and gravel with a thickness of 0 50 m regarding the water quality this aquifer is characterized by three hydro geochemical facies na cl na mg ca cl and ca mg hco3 cl el ghali et al 2020 this area is characterized by fertile soil and productive groundwater that lead to the groundwater depletion and water quality deterioration as today it is unsuitable for drinking purposes el bouqdaoui et al 2010 el ghali et al 2020 elfarrak et al 2014 meanwhile the water is mainly used by the farmers for vegetable carrot and livestock productions ouassissou et al 2019 however the water quality is monitored by the river basin agency of bouregreg and chaouia through fourteen monitoring stations 3 2 machine learning models the used models are the adaptive boosting support vector regression svr random forest rf and artificial neural network ann approaches however extensive details on machine learning algorithms used and data mining can be found in aggarwal 2015 bishop 2006 bonaccorso 2018 freund and schapire 1997 1996 hastie et al 2009 and kubat 2017 3 2 1 adaptive boosting adaboost adaboost is a boosting algorithm introduced by freund and schapire 1997 it can be used for classification and regression tasks for a dataset s x i y i i 1 2 3 n where each x i is in some instance x and each y i is in some label y and for a series of round m the algorithm initializes the distribution d or weight as follow 7 d i 1 1 n f o r i 1 n then for j 1 to m adaboost algorithm builds weak models h j from the training dataset using d that minimizes ε j and satisfies ε j 0 5 conditions ε j is a weighted error of the j th model and is given by 8 8 8 ε j i h j x i y i d i j the weight confidence α j of the j th model is calculated by the 9 9 9 α j 1 2 ln 1 ε j ε j the distributions for next iteration were updated as follow 10 d i j 1 e y i h j x i α j d i j 11 d i j 1 d i j 1 i 1 n d i j 1 the prediction for new dataset is conducted by combining weighted majority vote of the models h j 12 h x s i g n j m α j h j x 3 2 2 support vector machine svm support vector machine svm is a discriminative method applied to both the classification and regression svr tasks based on the construction of a hyper plane to minimize errors vapnik 1995 for modeling system s with observation dataset ds d s x i y i i 1 n xi represents the inputs and y i the outputs with a linear function as shown in 7 7 13 f x ω x b the optimal function is the minimization of the function 14 subject to 15 15 hence the loss functions such as ϵ insensitive quadratic and hubber methods can be used 14 min ω b ξ ξ 1 2 ω 2 c i 1 n ξ i ξ i 15 s t y i ω t x b ε ξ i y i ω t x b ε ξ i ξ i ξ i 0 i 1 2 n with x is a kernel function k such as polynomial radial basis and linear functions ω and b represent weigh and basis vectors and c is a pre specified value to penalize the training error while ξ i and ξ i are the lower and upper constraints on the output this study adopted the radial basis function rbf given by the 16 16 as kernel function ghosh 2010 16 k x i x j e x p γ x i x j 2 3 2 3 random forest random forest rf is an ensemble of ml model based on decision trees breiman 2001 regression and classification are conducted by aggregating a technique that operates by constructing an ensemble of decision trees in training by swapping and changing the covariates to improve the prediction performance the target is achieved by weighted average of tree outputs executing this model requires a number of trained trees and an amount of the variable used in each tree liaw and wiener 2002 these parameters play an important role in the stability of the model and therefore in prediction performances oshiro et al 2012 in this study we determine the model parameters by trial error method 3 2 4 artificial neural network ann is commonly used as ml model in groundwater modeling rajaee et al 2019 ann model is composed of three layers namely input layer hidden layers and output layer these layers are interconnected through the neurons that are characterized by weight and bias the variables weighted summed with the bias of the layer are transformed from the layer j th to the j 1th layer through an activation function f and so on until the target layer dawson and wilby 1998 the training process is iteratively repeated by changing the weights and the biases of the layers until good preliminary performance coefficient of correlation to simplify this approach we take the models with three mlp layers and the outputs y k are given by the flowing equation schalkoff 1997 17 y k f k i 1 m w j k f j i 1 n x i w i j w 0 with n is the feature numbers m is the neuron numbers in the hidden layer and p is the neuron numbers of the target layers w 0 is the bias w jk and w ij are the weights between the j th neuron and the k th target neuron and between the i th neuron and j th neuron respectively whereas f k and f j are the transfer functions of the neurons k and j of the output and hidden layers respectively 3 3 data processing and model performance evaluation methods 3 3 1 data collection and analysis five hundred and twenty samples of groundwater quality from berrechid aquifer have been considered in this study all samples were provided by river basin agency of bouregreg and chaouia and were collected from the fourteen monitoring stations illustrated in fig 1 indeed the depth of the wells ranges from 40 m to 140 m the sampling protocol was carried out during the pumping for irrigation purposes two times during spring and the summer for the period from 2009 to 2019 these samples include the measurements of the parameters the electrical conductivity ec ph temperature cl so4 2 co3 2 hco3 no3 no2 nh4 na k ca2 and mg2 concentrations the physical parameters were measured in situ during the sampling meanwhile the other parameters were analyzed in the laboratory using the flame photometer for na and k uv spectrophotometer for the nitrate and sulfate concentrations and volumetric titration method for the other ion concentrations fig 2 summarizes the distribution of the parameter values by sample all ion concentrations are in mg l 1 temperature is in c and ec is in µs cm 1 it can be seen that there are some outlier values on almost all parameters consequently it is necessary to analyze these data before their input moreover in ml models development the exploration and cleaning of the data are important steps to have accurate and reliable models in this study data pre processing was conducted following five steps 1 data reliability checking this operation was carried out through the calculation of the absolute value of the charge balance error cbe as given by 17 17 of the groundwater samples and those which have more than 5 in absolute value were rejected freeze and cherry 1979 moreover the outlier value detections of physical parameters were conducted using the boxplots 18 c b e c a t i o n s a n i o n s c a t i o n s a n i o n s 100 2 calculation of the iwq parameters and data analysis statistical analysis of data was carried out descriptive statistic characteristic of iwq parameters are summarized and plotted as boxplot to detect the outlier values the correlation matrix was plotted and analyzed using pearson method 3 data normalization from 0 to 1 to reduce the dimensionality influence of the variables on the model performances and to improve the model generalization 4 model training and validation processes 5 uncertainty and sensitivity analysis of the ml model 3 3 2 metric evaluation models the model performances are evaluated using three statistical criterions coefficient of correlation r root mean square error rmse and the relative bias rbias the coefficient of correlation r was calculated by 18 18 the coefficient of correlation 1 show the best correlation between the observed and predicted values but it does not indicate the best model meanwhile the lower value of r indicates a worse fit model 19 r i 1 n x o i x o x p i x p i 1 n x o i x o 2 i 1 n x p i x p 2 0 5 the rmse is the square root of the variance of the residual errors the lower value of the rmse compared to the output ranges indicates the better fit of the model 20 r m s e x p i x o i 2 n the rbias was used to state if the model tended to underestimate rbias 0 or overestimate rbias 0 the target magnitude and was calculated by 20 20 if the rbias equals 0 the model is perfect while higher absolute value of rbias indicates that the model is biased 21 r b i a s i 1 n x o i x p i i 1 n x o i xo xp and x o are observed and the model predicted mean of observed values respectively in developing of ml models the great challenge is to guarantee the generalization ability ga of the models yoon et al 2011 defined the ga in predicting the groundwater level by the 21 21 ga values are unity indicate the ml model is perfect if the ga is less than unity the models are under trained while higher than unity the models are over trained 22 g a r m s e d u r i n g t h e v a l i d a t i o n p h a s e r m s e d u r i n g t h e t r a i n i n g p h a s e however the total uncertainty of the fitted models was evaluated through comparing the observed and simulated values and calculating of the standard error and the confidence bound as follow 23 ei x o i x p i 24 s d i 1 n e i e 2 n 1 25 cb z sd n with ei is the error z is z score of confidence level for 95 is about 1 96 and e is the mean prediction error ie is the interval prediction error and n number of the observations used furthermore sensitivity analysis of the models was evaluated to determine the input variables that influence significantly the model predictions of the water irrigation parameters this was carried out using one factor at time ofat method here the rmse values of the model performances were evaluated with one input variable omitted a time by generating randomly the uncertainties using the monte carlo method while the other variables were held constants then the impact of each input on the rmse value was evaluated by calculating the absolute value of the difference in rmse δrmse accordingly the model sensitivity to an input increases with increasing δrmse 4 results and discussion 4 1 data pre processing 4 1 1 data cleaning checking data reliability by 17 17 shows that 38 samples have cbe more than 5 in absolute value and they are considered unsuitable in this study fig 3 illustrates the scatterplot of sum cations vs sum anions this figure demonstrates a good reliability of samples since cbe is less than 5 in absolute value fig 4 presents the boxplots of irrigation water quality parameters and studied variables this figure demonstrates that most parameters have some outlier values tds ph and temperature parameters have 5 outlier values while the rsc ps temperature and sar parameters have 16 11 8 and 2 outlier values respectively wang et al 2020 demonstrated that removing outlier values does not improve the prediction accuracy of ml models however some outliers of physical parameters cannot be acceptable i e ph 0 75 and temperature 41 5 c and therefore we removed their corresponded samples six samples overall 476 samples were retained as suitable data in terms of reliability for this study to reduce dimensionality impacts on model performances the data were normalized in range from 0 to 1 table 1 presents basic statistical characteristics mean minimum maximum ith quartile qi and the standard deviation sd of irrigation water quality indexes calculated based on the 476 of the retained samples this table shows that more than 50 of samples have ec and tds values considered high according to ayers and westcot 1994 salinity restrictions meanwhile for the other parameters except for the extreme values the restrictions are moderate to none for irrigation purposes 4 1 2 exploratory data analysis for further exploration of the variable a matrix correlation analysis and the importance evaluation of input variables have been carried out fig 5 presents the matrix correlation fig 5a and variable ranks fig 5b the results show that the electrical conductivity ec has strong correlations with tds r 0 96 ps r 0 95 sar r 0 78 and rsc r 0 79 parameters and it has a moderate correlations with the esp r 0 50 and mar r 0 41 parameters the ph has weak correlations with all parameters meanwhile the temperature has the lowest correlations with all parameters such results reflect that the electrical conductivity is more correlated input variable with the predicted parameters than the ph and temperature however strong correlations do not imply causality as the complex combinations of the features can have influences on the target variable meanwhile the lower correlations between the t ph and ec demonstrate that these parameters are separable and not redundant input variables and therefore are useful to improve the prediction accuracy of the ml models kuhn and johnson 2019 besides the importance of the input variables was evaluated using relief algorithm kira and rendell 1992 fig 5b presents the ranks of the ec temperature and ph variables for predicting the iwq parameters globally it was observed that there is no significant difference between the variables importance consequently we adopted the three parameters as features of the ml models 4 2 model training results before the training phase the selected data are organized in csv files and were divided into two datasets 300 samples were used for the training testing process and 176 samples were used for validations phase then the ml models were built in jupyter using anaconda platform tools www anaconda com products individual to avoid the over fitting of the models we used the k fold cross validation method k 5 during the training process arlot and celisse 2010 the optimal architectures functions and hyper parameters of each model were determined through a trial and error analysis by their changing during the training phase table 2 presents optimal parameters and functions selected table 3 represents the rmse r and the rbias values of the models during the training process these results show that the svr model has significant values of rbias and rmse compared to other models in predicting the tds and rsc parameters ann rf and adaboost models demonstrated high accuracy in predicting the tds parameter during the training process with r 0 95 rmse 457 mg l 1 for data ranging from 2000 to 9400 mg l 1 and rbias 1 in average for the ps parameter all models had excellent performances with average coefficients of correlations 0 93 rbias less than 3 in absolute value and average rmses of about 7 9 meq l 1 for ps values range from 0 5 to 150 meq l 1 regarding the sodium hazard prediction all models have satisfactory performance in predicting the sodium adsorption ratio sar and exchangeable sodium percentage esp parameters coefficients of correlations ranged from 0 75 to 0 82 rmse less than 3 meq0 5 l 0 5 and rbiass ranged from 0 33 to 5 63 for sar parameter meanwhile for the esp parameter the coefficients of correlations ranged from 0 59 to 0 65 and rbias was less than 3 in predicting the mar parameter all models gave relatively good performances with rbias less than 2 in absolute value however the coefficients of correlations are weak except for the adaboost model which has r 0 64 as for the rsc parameter all other models have significant performances average of r is about 0 75 and rbias less than 4 comparing these models the adaboost shows excellent to good performances for predicting all parameters followed by random forest and artificial neural network models which failed to predict the mar parameters interestingly the svr model also shows significantly worse performances for predicting the tds and mar parameters during the training phase importantly during the training process it was observed that there is no significant superiority observed between the ensemble models adaboost and random forest and ann however the validation process generalization ability evaluation the sensitivity and uncertainty analysis are important issues in the application of ml in groundwater resource planning and management 4 3 validation and generalization ability results after the training process all models were used for simulating 176 samples to evaluate their validation and generalization table 4 presents the rmse r and rbias values of the models during the validations process compared to ann and svr models rf and adaboost models showed remarkably high performances for predicting the tds ps sar esp and rsc parameters with r values ranging from 0 65 to 0 99 and rbias less than 1 in absolute value additionally the adaboost and rf have performances more excellent than those evaluated during the training phase for predicting all parameters meanwhile ann and svr models present prediction accuracy closer to that during the training phase compared to the performances presented in table 3 table 4 shows that svr model still has unacceptable performances for simulating tds and mar parameters with high values of rmse 1270 68 mg l 1 and rbias 15 37 for tds parameter low coefficient of correlation r 0 51 and high rmse 14 74 for mar parameter similarly the ann and rf models failed to predict the mar parameter during the validation process due to the high rmse and low coefficient of correlation fig 6 shows the scatterplots of the observed and simulated values by the models during the validation process the accuracy of the models is satisfactory when the values are distributed over or evenly on both slides the line x y showing that the errors obey the gaussian distribution this figure reflects that the predicted values by the ensemble models rf and adaboost are distributed over the x y line better than those of the ann and svr models furthermore the adaboost showed better performances where the predicted values are very closer to the observed values and for the random forest model except for the mar parameter the predicted values are quite evenly distributed over the x y line concerning the svr and ann models they showed fairly good value distributions over the x y line for three ps sar and rsc and four tds ps sar and rsc parameters respectively importantly the svr and ann models failed to reproduce the esp parameter as the predicted vales are far away from the y x line and they have rmse more than 10 even when they showed relatively good performances during the training phase such results demonstrate the superiority of the adaboost and random forest models compared to the ann and svr models in predicting the studied irrigation water quality parameters by comparing the performances presented in table 4 it can be concluded that 1 the adaboost model has better performances in predicting all parameters followed by 2 random forest in predicting the tds ps sar esp rsc parameters by 3 the ann in predicting the tds ps sar and the rsc parameters then by 4 the svr model in predicting the ps sar and rsc parameter except for the svr in predicting the rsc parameter all other models have rbias values less than 5 in absolute value indicating that the fitted models are unbiased these results showed that the bagging and boosting learning models rf and adaboost are superior to traditional ann and svr models in terms of accuracy similarly zhao et al 2013 found that the adaboost is more accurate than the svm and ann models in predicting the short term ionospheric saghafi and arabloo 2017 demonstrated that the adaboost model provided high prediction accuracy for modelling the co2 solubility compared to the ann and svm models walker and jiang 2019 applied adaboost model for prediction of demand driven acquisition and found that it is higher accurate than the regression based model regarding to the rf model castrillo and garcía 2020 showed a high prediction accuracy of the rf model compared to the multiple linear regression approach besides there is a further agreement with previously published studies in classification tasks ahmed et al 2019 chen et al 2020b however forecasting iwq parameters in real time requires accurate generalizable and stable models some models have a high sensitivity to the input variables that could be unsuitable for forecasting purposes even they good overall performances besides the noisy data related to input variables caused by sensor technologies are very likely particularly during real time for example if a small fluctuation 1 5 c in temperature significantly influences prediction accuracy the model is considered unsuitable for forecasting the water quality in real times therefore the stability of the ml models in the forecasting of the iwq parameters in real time is critical particularly when the maker decision and the farmers have strategies to develop this approach in managing the saline water for irrigation purposes in this study we extend the exploration analysis of the applied ml models by discussing the generalization ability and the sensitivity to different input variables the generalization ability ga indices of the models were calculated by the 21 21 and presented in table 5 this table shows except for the ann model in predicting the tds all other models have ga values less than 1 indicating that they do not concentrate on training the given data rather than a more general system and the models were undertrained chen et al 2020a yoon et al 2011 although the ann and svr models have prediction performances not good than those of adaboost and rf models their overall generalization abilities are more perfect than those of the rf and adaboost models in this study area 4 4 uncertainty analysis results the problem of uncertainty of the conceptual based models in water quality modeling is inevitable and has been discussed in many studies kardos and obropta 2011 moreno rodenas et al 2019 radwan et al 2004 shojaei et al 2015 in this study we analyzed the total uncertainty of the fitted ml models table 6 presents the mean prediction error e and the 95 confidence band in predicting the tds ps sar esp mar and rsc parameters for 176 samples used during the validation process based on the uncertainty analysis results the adaboost model has a smaller 95 confidence band values followed by rf ann and svr models respectively 4 5 model sensitivity analyses the prediction accuracy and the ga analysis show that the ml models are suitable for forecasting the iwq parameters using the temperature ph and ec as input variables however the sensitivity analysis of the applied models to the inputs variables is required as a high sensitivity of a model to noisy data can dramatically distort the forecasting results and therefore the field application of this model is questionable therefore in this study the sensitivity analysis of the fitted models was carried out by adding randomly gaussian noises to the input variables and then re simulation of the 176 samples 2 c for the temperature 0 3 ph unity and 100 µs cm 1 for the ec the sensitivity analysis results of the models for forecasting irrigation water quality parameters are presented in table 7 it was observed that the model sensitivities to each input variable were uneven for forecasting the tds parameter the models are sensitive to the ec followed by temperature and ph with average values of δrmse about 59 90 56 16 and 38 3 mg l respectively these values are acceptable compared to the range of the tds parameter the models are more sensitive to the ec than to ph and temperature for forecasting the ps parameter the ph is the most important input variable in predicting the esp and rsc parameters however it can be seen that the model sensitivities to the features vary from one input to another from one parameter to another and from one model to another for all parameters the largest values of δrmse were obtained for the adaboost and rf models such results indicate that these models are more sensitive to the features than the ann and svr models however overall sensitivity analysis results demonstrate that the models are fairly stable in forecasting the iwq parameters 4 6 field practical implication in agricultural water management and future works the water scarcity issue is leading several countries to increase the use of the brackish water in their agricultural sector to ensure food security particularly in the arid and semi arid regions bortolini et al 2018 gosling and arnell 2016 however to reduce the impacts of the salinity and the water sodicity on the soil and the yield productivity managing saline water for irrigation purposes based on two main methods namely blending fresh and saline water and using gypsum filho et al 2020 kan and rapaport rom 2012 yaduvanshi and swarup 2005 zaman et al 2018 these processes require assessing the iwq parameters of the saline water coastal aquifer low water quality that increases the cost related to the laboratory analysis when using the conventional method particularly for the small farmers in our study we trained and validated the ml models for forecasting the iwq parameters using only physical parameters as predictors in accordance with the results of this study ml models appeared being accurate and robust tools in forecasting the tds ps sar esp mar and rsc parameters besides we analyzed the uncertainty and the sensitivity of these models to input variables these analyses show highlight that the overall generalization abilities of ann and svr models are higher than those of the rf and adaboost models also the two last models are more sensitive to the input variables than the ann and svr ones however selecting the ml models for forecasting the tds ps sar esp mar and rsc parameters should take into account the sensitivity of these models indeed applying sensitive models requires a high precision of sensor technologies to measure the input variables overall the performances and sensitivity of the models are acceptable for forecasting the studied iwq parameters and therefore will help the farmers to manage the saline water by measurement only the physical parameters as input variables at low cost specifically predicting the iwq parameters of the saline water in real time allows the optimization of the blending of the fresh and saline water process and the gypsum quantity considering that the electrical conductivity temperature and ph parameters are measured in quasi real time by river basin agency of bouregreg and chaouia through its automatic hydrological information system therefore using the applied ml models is efficient in forecasting the groundwater quality parameters also nowadays smart technologies based on the internet of thing iot are innovative methods for monitoring and analyzing data chowdury et al 2019 liu et al 2019 therefore implementing of the developed ml models and mapping the prediction results in a monitoring platform will help the farmers to manage the saline water and to improve yield productivity in this area alternatively integration of the ml models in web or mobile applications that could be available for the farmers improves the field applicability of these models in water quality management in the agriculture however the management of the saline water can integrate two components the soil types and the crop s tolerance in this study the applied ml models are powerful tools to forecast the iwq parameter rather than to evaluate the water suitability for irrigation purposes according to the tolerance restrictions and the soil types importantly using the classification ml models and embedding the soil types and the salinity tolerance of crops could be fruitful tools to manage the saline water with the aim to ensure sustainability agriculture therefore the integration of these aspects can be considered an emerging topic for future research 5 conclusion the main aims of this study were to evaluate whether the ml models are valuable tools to forecast the iwq parameters using physical parameters as features and to analyze their sensitivity to the input variables therefore the adaptive boosting random forest ann and svr models were developed and evaluated in predicting the tds ps sar esp mar and rsc parameters using the physical parameters as features through this study the major findings are as follow 1 adaboost model is suitable for forecasting all parameters followed by rf model in forecasting 5 parameters except mar parameter the ann and svr models have good performances for forecasting 4 tds ps sar and rsc parameters and 3 ps sar and rsc parameters of 6 parameters respectively 2 the ensemble models adaboost and random forest had prediction performances better than the traditional ann and svr models during the validation performance 3 the svr and ann models presented higher generalization ability than those of the adaboost and rf models 4 overall the sensitivity analysis shows that the developed models had minor sensitivities to the input variables used compared to the range of each forecast parameter ml models relying on physical parameters as features are efficient tools and should be recommended for forecasting the iwq parameters to manage the saline water they will improve groundwater quality monitoring for irrigation purposes in real time at a low cost declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work is supported by river basin agency of bouregreg and chaouia abhbc by providing further data required authors thank the teams of the abhbc for their great assistance 
10298,the annual double cropping of winter wheat and summer maize plays an important role in ensuring the food supply in the north china plain ncp with the intensifying water shortage a deficit irrigation strategy has been gradually applied to this cropping system the limited irrigation water supply generally results in a dry root zone soil profile at winter wheat harvesting which further negatively affects the grain production of its following crop summer maize field studies from 2016 to 2019 at a typical site in the ncp luancheng agro experimental station were undertaken to examine the effects of different irrigation schedules during the winter wheat season on summer maize production and water conservation techniques that might benefit maize production under a limited water supply the results indicated that soil water contents at maize sowing played an important role in deciding the final maize yield under the recommended winter wheat deficit irrigation schedule for this region the yield of maize would be reduced by 22 32 compared to the maize following the full irrigation schedule water deficits mainly occurred during the earlier growth stage of maize before the rainfall season reducing water consumption during the earlier growth stages of maize was important for prolonging the soil water availability for crop growth from the irrigation at maize sowing due to the smaller canopy cover at the earlier maize growth stages using straw from the winter wheat to fully cover the soil surface was an active measure to preserve soil moisture and the maize yield under mulch was increased by 10 25 while the water use efficiency wue was increased by 5 25 under a limited water supply reducing planting density by 11 over the normal density could reduce crop water use during the vegetative stage and increase crop water use during the reproductive stage which increased grain production and water productivity the reduced density also decreased the production cost these results indicate that measures to preserve soil water during the vegetative growth stages of maize would benefit grain production under limited water supply conditions in the ncp keywords summer maize limited water supply straw mulching plant density pre sowing soil water conditions 1 introduction the north china plain ncp is one of the most important agricultural regions in china and provides more than 50 and 33 of the nation s wheat and maize production respectively sun et al 2015 liang et al 2011 winter wheat and summer maize form the annual double cropping rotation and have been dominant for the past three decades the double cropping system consumes approximately 800 mm of water which significantly exceeds the amount of annual rainfall of 473 mm sun et al 2015 farmers in this region generally irrigate winter wheat three or four times and irrigate summer maize one to three times each season to obtain high grain yields zhang et al 2016 however the groundwater table level has declined rapidly which threatens the development of sustainable agriculture due to over pumping sun et al 2010 thus it is essential to develop the best irrigation water management to save groundwater and obtain higher crop yields recently limited or deficit irrigation and supplemental irrigation have been widely studied in the ncp to understand the influence of reducing irrigation applications on winter wheat zhang et al 2013 rashid et al 2019 however few studies have focused on the effects of limited irrigation on its following crop summer maize zhang et al 2006 and sun et al 2014 suggested a minimum irrigation strategy mi for use with the double cropping system to maintain the groundwater level the mi involves only irrigate winter wheat and summer maize at sowing to promote crop germination without further irrigating afterwards this method can effectively conserve groundwater resources but yield reduction for winter wheat can reach up to 20 and for summer maize it can reach up to 14 under limited irrigation the available soil water at planting would play an important role for crop production zhang et al 2017 peake et al 2016 lawes et al 2009 for the winter wheat and maize rotation due to winter wheat having a prolific and deep root system soil water depletion by winter wheat is usually very high resulting in a very dry soil profile at maize sowing which would aggravate the negative effects of deficit irrigation on maize grain production feng et al 2018 in addition the rainfall and its distribution during the growing season are also important factors influencing crop production under a limited water supply jägermeyr and frieler 2018 li et al 2019 zipper et al 2016 mushore et al 2017 wang et al 2020 indicated that maize yield would decrease when the seasonal rainfall was less than 300 mm sun et al 2016 found that in the ncp the rainfall decreased by 0 79 mm year and the temperature increased by 0 022 c year during the maize growing season for the past 50 years the trend in future rainfall change will negatively influence maize yield under limited water supply conditions omoyo et al 2015 sun et al 2014 under a climate change background large seasonal weather fluctuations would also affect maize production gao et al 2018 indicated that low temperatures during the late growth stage reduced the grain filling rate and kernel weight of summer maize the forecasted increase in temperature might benefit the summer maize production under full irrigation in the ncp fang et al 2019 however under dry conditions high temperatures would aggravate water stress on crop performance and decrease crop yield shaw et al 2014 grassini et al 2009 therefore it is important to take some measures to eliminate the negative influence of weather factors on maize yield under limited water supply conditions mulching techniques have proven to be an effective measure to improve maize yield under dry conditions boillat et al 2019 ali et al 2016 with the use of combines to harvest wheat straw mulch could be readily applied to summer maize in the ncp studies have shown that straw mulch reduced soil evaporation by 40 50 mm during the summer maize growing season zhang et al 2005 2016 and increased soil water storage hu et al 2019 yan et al 2017 showed that maize roots absorb shallow soil water better after mulching treatments li et al 2018a demonstrated that compared to conditions without mulch straw mulch increased the summer maize yield by 9 29 and water use efficiency wue by 10 33 increasing the population density of plants is another agronomical practice to increase the maize yield in many regions milander et al 2016 mastrodomenico et al 2018 sun et al 2016 indicated that the optimal plant density of maize was approximately 8 6 plants m2 under full irrigation in the ncp testa et al 2016 showed that the planting density of 10 5 plants m2 obtained higher grain yield under irrigation conditions in italy chen et al 2019 showed that crop water use increased with increases in plant density plant density from 6 to 9 plants m2 a high plant density did not always improve the maize yield under drought prone environments tokatlidis 2012 for example magaia et al 2017 showed that a medium plant density 4 2 plants m2 achieved the highest grain yield in a semi arid region when the seasonal rainfall was less than 400 mm however dias et al 2019 indicated that the optimum plant population was 7 8 plants m2 in a rain fed condition in brazil when the seasonal rainfall was 931 6 mm these studies indicate that the soil moisture status and weather conditions should be considered when determining the optimal plant density with the widespread application of limited irrigation schedules and climate change in this water shortage area it is important to examine the effects of reducing irrigation during the winter wheat season on its following crop summer maize and the possible practices to reduce the negative influence of water stress and weather factors on maize production under limited water supply conditions thus the objectives of this research were to 1 examine the effects of initial soil water conditions on maize yield and yield components under limited water supply condition and 2 examine measures to conserve soil water and mitigate soil water deficit to improve the yield and water productivity of summer maize the results from this study should provide some references for the better management of crops for higher production under limited water supplies in the ncp and other regions with similar conditions 2 material and methods 2 1 study site field experiments were conducted at the luancheng ago eco experimental station 37 53 n 114 40 e 50 m above sea level of the chinese academy of sciences the station is located in the northern part of the ncp at the base of mt taihang this region has a typical monsoon climatic zone winter wheat and summer maize are the two main crops forming the annual double cropping system in this continuous cropping system winter wheat is sown around the 10th of october and harvested around the 15th of june the following year and summer maize is sown immediately after winter wheat and harvested around the end of september the average annual rainfall was approximately 473 mm with 70 falling in the growing season of summer maize from july to september the soil is loam with an average water holding capacity of 35 9 v v and wilting point of 13 2 v v for the top 2 m soil profile the organic matter content was 18 g kg total n was 1 2 g kg available n was 92 mg kg available p was 21 mg kg and available k was 80 mg kg for the top tillage layer 0 20 cm 2 2 experimental design the major experiment of this study was to examine the effects of soil water contents at sowing on of summer maize under limited irrigation from 2016 to 2019 soil water contents before sowing summer maize were different following different irrigation numbers and amounts from the previous winter wheat season treatment i0 i1 i2 i3 and i5 for summer maize indicated that there was no irrigation one two three and five irrigations to winter wheat respectively the i1 treatment was the usual irrigation practice for winter wheat under a limited water supply and the i3 and i5 treatments were the irrigation practices for achieving the highest yield of winter wheat depending on the seasonal rainfall for the summer maize pre sowing irrigation was applied to all treatments for seedling establishment no other irrigation was applied during the growing season irrigation amounts per application were approximately 70 80 mm each treatment had four replicates and the plots arranged randomly with an area of 40 m2 5 m by 8 m plots were separated by a 2 m wide zone without irrigation to minimize the mutual effects of the two adjacent plots the planting density of maize was 6 7 m2 with a row distance of 60 cm this density is the normal planting density used locally for summer maize for reduced water deficit effects on maize production two extra experiments were conducted supplemental experiment one se1 examined the effects of mulch on soil water conservation using the straw from winter wheat summer maize cultivar zhengdan 958 with a planting density of 6 7 m2 the row spacing was 60 cm was used in this experiment in 2018 and 2019 twenty small field plots were used with a 4 m2 area 2 m by 2 m each and the plots was separated from each other by 10 cm concrete waterproof walls to a depth of 1 2 m to prevent water exchange wheat straw was applied to 10 of the plots after sowing resulting in a 2 3 cm thick cover approximately 6000 kg ha of straw applied which was defined as mulching treatment another 10 plots did not have straw applied and served as controls se2 examined if reduced planting density could favor the final production of maize due to a smaller canopy during the early growth stages of maize using less water to extend the water supply period of irrigation water applied at sowing se2 was conducted under straw mulch summer maize cultivar zhengdan 958 with different planting densities was studied in this experiment in 2017 2018 and 2019 the five planting densities were 5 2 plants m2 d1 6 0 plants m2 d2 6 7 plants m2 d3 7 5 plants m2 d4 and 8 2 plants m2 d5 row spacing was set at 60 cm d1 d2 d3 d4 and d5 were studied in 2017 and 2019 d1 d3 and d5 were studied in 2018 each plant density was arranged in a completely randomized design with four replicates the plot area was 40 m2 8 m by 5 m for se1 and se2 the previous crop winter wheat was only irrigated once at the jointing stage i1 and maize was irrigated at sowing with irrigation amounts of 70 80 mm table 1 lists the practices examined in this study for improving the yield of summer maize under water deficit conditions 2 3 field management for all experiments summer maize was sown manually directly after harvesting the winter wheat without tillage immediately after sowing 70 80 mm of irrigation was applied to each plot and no other irrigation was applied during the growing season irrigation was conducted with a plastic hose connected to the outlet of a low pressure water transportation system that obtained water from a well a water meter was installed in the system to control the water applied to each plot nitrogen was applied at the ninth leaf stage with a rainfall event at a rate of 175 kg n ha diammonium phosphate dap at 300 kg ha urea at 150 kg ha and potassium chloride at 150 kg ha were applied in combination with soil cultivation at the sowing of winter wheat an additional 150 kg ha of urea was the top dressing at the jointing stage of winter wheat all the p and k fertilizers were incorporated into the soil with cultivation as base fertilizers for the annual double cropping system before sowing winter wheat pesticides and herbicides were applied as necessary to ensure that the growth of maize was free of pests and weeds 2 4 measurements 2 4 1 weather conditions daily weather factors including average temperature ave t relative humidity wind speed sunshine duration shr and rainfall were collected from a national standard weather station approximately 50 m away from the experimental site daily reference evapotranspiration et0 was calculated with the crop water program developed with the fao penman monteith equation which represented the definition of a grass reference albedo 0 23 height 0 12 m surface resistance 70 s m allen et al 1998 2 4 2 soil water content soil water content was monitored every 10 15 days in 20 cm increments to a depth of 2 m using the neutron meter 503 dr cpn international inc usa with access tubes installed in the center of the plots four plots for each treatment were regularly monitored for each soil water condition using the neutron meter method the topsoil soil water contents 0 20 cm were monitored using the soil auger method 2 4 3 phenology grain yield yield components and harvest index hi the seven leaf stage v7 tasseling stage vt blister stage r2 and maturity stage r6 for different cultivars were based on the developmental scales of ritchie et al 1986 at harvesting every plot was harvested separately all the ears were collected manually the grain was weighed after being air dried to a constant weight 13 water contents and the 1000 kernel weight was measured prior to harvest ear numbers per plot were counted with samples of 10 ears from each plot being collected to determine kernel numbers per ear in addition before harvesting four plants from each plot were randomly selected and cut at the soil surface to separately measure the total dry biomass and grain weight to determine the harvest index hi hi was calculated by the grain weight divided by the total dry biomass 2 4 4 crop water consumption and water use efficiency wue crop water consumption et for a certain period or for the entire season was calculated based on the water balance equation zhang et al 2008 1 et p i swd r d cr where et is the water use over a period or over an entire growing season mm p is the precipitation mm i is the irrigation mm swd is the soil water depilation soil water content at the start minus soil water content at the end of the period mm r is the runoff mm d is the drainage from the root zone and cr is the capillary rise to the root zone because of less rainfall and a deep groundwater table 40 m below soil surface r and cr were taken to be zero wue is defined as the final grain yield divided by the seasonal crop water use 2 4 5 crop water requirements etp and percentage of available soil water pasw potential crop water requirements etp at the different growing stages of summer maize were calculated by multiplying the et0 by the crop coefficient kc according to liu et al 2002 the percentage of available soil water was calculated based on the following equation 2 pasw θ θ wp θ hc θ wp 100 where pasw is the percentage of available soil water θ is the volumetric soil water content v v θ wc is the water holding capacity θ wp is the wilting point 2 5 statistical analysis one way anova was conducted to compare the effects of different treatments on maize yield yield components and crop water use under the same season the analysis was conducted using spss version 19 0 spss for windows ibm armonk new york usa and excel software 3 results 3 1 soil water conditions at winter wheat harvesting due to the high water use and low rainfall during the growing season of winter wheat even under the more frequent irrigation treatments the soil water content in the topsoil layers at winter wheat harvesting was quite dry and close to the wilting point especially under the i0 i1 and i2 treatments fig 1 table 2 shows the percentage of the available soil water pasw at winter wheat harvesting during the four seasons the pasw of the 0 1 m and 0 2 m soil layers decreased with a decrease in irrigation numbers during the winter wheat season the results indicate that winter wheat can effectively absorb soil water with a deep root system under limited irrigation conditions which results in low soil moisture before sowing summer maize the irrigation at sowing maize is important for seedling establishment 3 2 influence of differences in initial soil water availability on maize yield due to the variation in soil water contents that are caused by different irrigation numbers during the previous winter wheat season and rainfall the maize yield fluctuated greatly fig 2 shows the maize yield under different treatments during the 2016 2019 seasons the highest grain yield was achieved in 2016 among the four seasons due to the large amount of rainfall which increased kernel numbers per ear 1000 kernel weight and the harvest index table 3 in 2016 and 2017 no yield difference was found between treatments i0 and i1 the yield under i0 was 8 0 and 6 6 lower than that under i2 during the two seasons respectively in 2018 and 2019 the yield under i0 was 22 1 and 32 1 lower than that under treatment i3 and i5 respectively these results show that maize yield was greatly affected by the initial soil water condition at sowing which was related to the previous crop s irrigation management the variation in grain production was related to the three yield components table 3 specifically the average ear numbers kernel numbers and kernel weight under i0 was 2 4 8 0 and 9 8 which was 4 3 12 9 and 14 7 lower than that under i3 and i5 respectively the rainfall from sowing to the seven leaf stage was only 21 6 and 25 1 mm respectively after maize planting and until the earlier vegetative stage the crop growth depended on soil water due to low rainfall the lower soil water contents under i0 was not favorable for maize seedling establishment and final ear numbers in addition from blister stage to maturity the rainfall was only 14 2 and 30 6 mm respectively lower soil moisture under i0 aggravated water stress during the grain filling stage which reduced seed formation 3 3 conserving soil water during the earlier growth stage of maize under limited irrigation crop water requirements etp were calculated by multiplying the et0 by the crop coefficient kc according to liu et al 2002 table 4 shows the accumulated rainfall etp and the percentage of rainfall to etp for the 2016 2019 and 1987 2019 summer maize seasons the crop water requirements of summer maize were much greater than the rainfall over the entire growing seasons indicating that rainfall could not meet the crop water requirements the high crop water requirements and low rainfall had a negative influence on maize production although irrigation has been applied at sowing summer maize the crop water requirements before the coming rainfall season were relatively high if the irrigation water could not be effectively preserved and utilized drought could easily affect maize yield especially drought occurring at the blister stage to maturity there was a significant increasing trend of etp with time from sowing to the seven leaf stage fig 3 although there was no significant trend in rainfall from 1987 to 2019 the variation in rainfall was larger between years and a decreasing trend in the rainfall was found for the recent eight years the increasing trend in etp and declining trend in rainfall in the future may have adverse effects on the grain yield of maize under limited water supply conditions taking some measures to conserve the soil water from the only irrigation at the sowing of maize and to prolong its availability to the crop will be necessary to reduce the negative effects of water stress on maize production 3 3 1 straw mulching after the initial irrigation at maize sowing under the wet soil surface with was no crop canopy condition soil evaporation was greater which would reduce the soil water available to the crop straw mulch could be an effective method to reduce this amount of water consumption fig 4 shows the changes in soil water contents for the top 1800 cm soil profile with and without mulching treatments during the 2018 and 2019 seasons the soil water content with mulching was higher than that without mulching during the whole growth stage the higher soil water contents during sowing to the seven leaf stage was beneficial for the establishment of maize and a higher soil water content during the reproductive stage was beneficial for seed formation the grain yield under mulching treatment was 9 7 and 25 1 higher and the wue was 5 3 and 25 0 higher than that under the non mulching treatment during 2018 and 2019 respectively table 5 fig 5 shows the crop water consumption from sowing to tasseling vegetative stage tasseling to maturity reproductive stage and sowing to maturity whole growth stage there was no significant difference between the two treatments when considering the total crop water consumption during the whole growth stages however straw mulching changed the water consumption during the vegetative and reproductive stages as shown in fig 5 during the 2018 and 2019 seasons compared to the non mulching treatment straw mulching reduced crop water consumption from the sowing to tasseling stage by 6 0 and 19 7 and increased crop water consumption from the tasseling stage to maturity by 10 1 and 18 9 respectively increased crop water use during the reproductive stage was beneficial for the formation of kernel numbers per ear and 1000 kernel weight in the 2018 and 2019 seasons the kernel number per ear under mulching was 7 8 and 17 9 higher and 1000 kernel weight was 1 6 and 4 3 higher than that under without mulching respectively 3 3 2 plant density under a limited water supply the optimized maize density might be different from that under a full irrigation water supply fig 6 shows the soil water contents of different plant densities during the 2017 2019 seasons higher plant densities decreased the soil water contents over the whole growth stage the low soil water contents had a negative influence on maize yield table 6 shows the grain yield and yield components of different plant density treatments during 2017 2019 the grain yield ranged from 6432 7 d5 to 9058 1 d2 kg ha from 5738 9 d5 to 6397 3 d1 kg ha and from 6129 1 d5 to 6846 0 d4 kg ha among different densities for 2017 2018 and 2019 respectively the highest yield may be because of the good sunshine and water conditions during the grain filling stage which improved the 1000 kernel weight weather factors influence maize responses to changes in plant density the largest yield difference between densities occurred in 2017 which was 2625 5 kg ha the results show that the seasons with higher grain yield tended to have higher yield difference among densities than seasons with lower yield on average over the three seasons d2 showed the highest maize yield and the yield of maize was 8 2 10 8 10 5 and 26 9 greater than that in d1 d3 d4 and d5 respectively these results show that higher plant densities are not necessary for obtaining greater maize production under limited irrigation conditions the increase in grain yield under low plant density also benefitted wue although there was no significant difference in et among the different treatments tables 6 and 7 ear numbers per area kernel numbers per ear and 1000 kernel weight determine the final maize yield table 6 shows that the ear numbers per area increased with increases in plant densities however the final ear numbers per area was 6 2 6 1 15 1 20 8 and 23 0 lower than the target ear numbers per area under d1 d2 d3 d4 and d5 respectively etp was 156 6 132 1 and 140 8 mm at the seeding stage from sowing to seven leaf stage however the rainfall was only 50 6 21 6 and 25 1 mm during the three maize seasons respectively the rainfall only met 32 2 16 4 and 17 8 of the crop water requirements table 4 these results indicate that higher sowing densities such as d4 and d5 could not achieve higher final harvest ear numbers due to water stress table 7 shows the crop water consumption at different growth stages under d1 d3 d4 and d5 during the 2017 2018 and 2019 seasons d3 d4 and d5 consumed more soil water than d1 at the vegetative stage however at the reproductive stage soil water consumption under d1 was greater than that under d5 d5 and d4 for the 2017 2018 and 2019 seasons respectively the more soil water used from the tasseling stage to maturity was beneficial for the formation of kernels and kernel weight for the three seasons the kernel numbers per ear in d1 was 17 6 16 4 and 39 7 higher than that in d5 and 1000 kernel weight in d1 was 3 2 12 3 and 7 2 higher than that in d5 the increase in kernel numbers per ear was more than the increase in 1000 kernel weight with decreasing plant density in addition the interannual variation in 1000 kernel weight was 20 8 this difference was much higher than the variation in densities these results indicate that kernel numbers per ear was more easily influenced by soil water content during the reproductive stage and 1000 kernel weight was mainly controlled by weather factors the results in this study also show that the increase in ear numbers per area could not offset the decrease in kernel numbers per ear and 1000 kernel weight with the increase in plant density due to a water deficit and maintaining suitable plant density was necessary to achieve high grain yield under limited water supply conditions 4 discussion 4 1 effects of the initial soil water contents on maize production the soil moisture at maize sowing plays an important role in crop germination seedling emergence and rooting which was affected by irrigation and rainfall during the winter wheat season and influenced by total water use by winter wheat helms et al 1997 paolo and rinaldi 2008 feng et al 2018 some studies have shown that soil water consumption increase with decreasing winter wheat irrigation zhang et al 2008 2013 similarly in the present study compared to i3 or i5 the soil water content after harvesting winter wheat decreased under i0 the reason was that winter wheat could fully take up soil water under limited irrigation with a deep rooting system which can reach up to 2 m zhang et al 2009 the available soil water was very low before sowing summer maize especially under limited irrigation conditions table 2 although there was 70 80 mm of water irrigated at maize sowing the irrigation was only replenishing the top 0 60 cm soil layer yan et al 2017 the rainfall from sowing to the seven leaf stage was lower than the crop water requirements table 4 and the seedling stage was easily influenced by the water deficit xu et al 2020 in the present study the increasing trend in etp during the early stages fig 3 would aggravate the negative influence of low soil moisture on crop growth under limited water supply conditions some studies have shown that soil drought significantly decreases the leaf area index leaf chlorophyll content and leaf photosynthesis and accelerates leaf senescence ultimately limiting dry matter accumulation and grain yield li et al 2020 sade et al 2018 ali and ashraf 2011 in the present study compared to i3 and i5 kernel numbers per ear 1000 kernel weight and hi decreased under i0 low soil water contents under i0 reduced the ability of plants to transport carbohydrate products from the source to sink organs and influenced seed formation li et al 2018c reduced soil water use during the vegetative stage and maintaining a higher soil water content during the reproductive stage was necessary to achieve higher grain yield chen et al 2010 used apsim to show that maize yield decreased with stored soil water at a sowing rate of 0 03 t ha mm under rain fed condition in the present study the average grain yield under i0 was 22 1 and 32 1 lower than that under i3 and i5 respectively the lower yield under i0 is not only related to the soil moisture at maize sowing but also related to soil water contents over the whole growth stage which was affected by the rainfall amount and distribution previous studies showed that under greater and more stable rainfall during the maize growing season deficit irrigation achieves a similar grain yield as full irrigation sun et al 2014 2010 fang et al 2019 however with decreasing rainfall the soil water would be continuously consumed by the winter wheat and summer maize low soil water contents had a largely adverse influence on maize yield under the climate change background specifically from sowing to the seven leaf stage the crop mainly depends on the soil water for crop growth due to the decreased rainfall in the dry season lu et al 2017 the pre sowing irrigation was important for maize seeding growth and this period determined the crop production capacity sun et al 2014 however due to low rainfall and increasing etp it is necessary to take some measures to conserve the soil water from the only irrigation at maize sowing and to prolong its availability to the crop to reduce the negative effects of water stress on maize production under a limited irrigation supply 4 2 conserving soil moisture to increase the water available to crops previous studies have shown that straw mulching can prevent the soil surface from receiving direct sunlight reduce the absorption of radiation and modify the thermal regime of soil dahiya et al 2007 sharratt et al 1998 akhtar et al 2019 chen et al 2017 kader et al 2017a indicated that the temperature at soil depth of 0 0 5 m of mulching treatment was 2 c lower than that without mulching treatment rashid et al 2019 showed that straw mulching reduced the soil surface temperature 0 8 1 5 c during march which reduced the crop growth and grain yield of winter wheat a cool region study also reported that a low temperature in the early growth stage under straw mulching treatment decreased spring sown maize yield especially in wet years lu et al 2015 however in some sub humid drought prone regions some researchers showed that straw mulching benefitted summer maize growth due to the inhibition of an excessive rise in soil temperature by preventing the exchange of water and heat between the soil and the atmosphere kar and kumar 2007 hu et al 2019 in our study the grain yield under the straw mulching treatment was higher than that without mulching indicating that straw mulching was more favorable for summer maize in this study area which is a warm and semi arid region deficit irrigation has a negative influence on maize growth especially under low rainfall situations ali and ashraf 2011 some studies have shown that straw mulching is an efficient measure to overcome water deficit and improve grain yield through increasing the leaf area index photosynthetic capacity and biomass accumulation yin et al 2020 zhang et al 2019 in the current study we found that straw mulching increased the yield of summer maize by 9 7 25 1 under the limited water supply conditions in the ncp this finding is similar to the results of a previous research study by li et al 2018a which showed that the increase in summer maize yield was 9 29 for straw mulching treatment in a warm and semi humid region even so pre sowing irrigation was also necessary for seedling establishment of summer maize due to the low soil water conditions after winter wheat harvesting fig 1 yan et al 2017 indicated that the grain yield of summer maize under straw mulching coupled with 70 mm pre sowing irrigation was higher than that under 100 mm pre sowing irrigation without mulching treatment this finding indicated that 40 mm of water resources may be saved through straw mulching under deficit irrigation conditions some studies have shown that more soil water was lost from non mulched treatment because of intense soil surface evaporation by direct solar radiation in the early growth stage li et al 2018a ibrahim et al 2020 compared with the non mulched treatment straw mulching could reduce soil evaporation by 40 50 mm in this study area zhang et al 2005 in our study the soil water content under mulching treatment was higher than that under without mulching treatment which may be due to straw mulching reducing soil evaporation over the whole growth stage rainfall from the tasseling stage to maturity in 2019 was only 50 5 mm the improved soil water contents during the reproductive stage has the benefit of alleviating water stress on maize growth zhang et al 2011 studies showed that although the rainfall distribution was uneven mulching could help crops avoid seasonal droughts and better capture water our studies found that the difference in et over the whole growth stage between mulching and without mulching conditions was small similarly hu et al 2019 reported that mulched and bare soil treatments produced similar et suggesting that straw mulching could not reduce water consumption by summer maize however mulching treatment decreased crop water use during the vegetative stage and increased crop water use during the reproductive stage fig 5 which was beneficial to the formation of kernel numbers and kernel weight similar results were reported by yan et al 2017 some studies showed that higher plant transpiration in mulching treatment improved maize growth increased leaf area index and biomass and water utilization tolk et al 1999 daryanto et al 2017 chen et al 2019 soil mulching converts more water from unproductive soil evaporation to plant transpiration and this maybe one of the reasons for the increase in maize yield and wue under straw mulching treatment zheng et al 2019 in addition thidar et al 2020 showed that straw mulching improved root growth in the top 30 cm soil layers which also benefits water uptake and increase grain yield under rain fed conditions straw mulching not only increases the soil moisture content but also improves soil fertility and enzyme activities akhtar et al 2018 furthermore straw materials are inexpensive convenient and friendly to the environment kader et al 2017b in the future the application of straw mulching will be an effective measure to increase summer maize yield under the limited water supply of semi arid regions 4 3 group vs individual plant yields under water stress many studies showed that the maize grain yield response to an increasing plant population often follows a quadratic model and the optimum plant population achieving the highest yield for maize is dependent on field management and environmental factors magaia et al 2017 xu et al 2017 ross et al 2020 for example li et al 2015 indicated that the planting density of 10 5 plants m2 produced the maximum maize yield under irrigated conditions no water stress in xinjiang china however in a rain fed condition water stress the optimal plant densities varied from 4 8 to 5 1 plant m2 on the loess plateau china zhang et al 2019 the maize density in rain fed conditions was lower than that in irrigated conditions due to water deficiency liu et al 2014 in this study we found that the lower plant density of 6 0 plants m2 low plant density achieved the highest grain yield over the three experiment years under pre sowing irrigation conditions deficit irrigation with seasonal rainfall of less than 225 mm water scarcity is an essential limiting factor for crop production in some semi arid regions especially the ncp where the groundwater table level is below 50 m deficit irrigation or rain fed would significantly decrease the summer maize yield hernández et al 2020 zou et al 2021 indicated that water deficits between the nine leaf and tasseling stage decreased the kernel setting and weight the reduction in plant density increases the ability of the crop to tolerate drought stress increases grain yield stability and saves water resources under limited water supply conditions tokatlidis 2012 jia et al 2018 ross et al 2020 canopy and soil temperature as well as light distribution was affected by plant density and deficit irrigation temperature is one of the major factors that drives leaf area development expansion which further influences leaf biomass growth sandhu and irmak 2020 a plant closes its stomata to reduce transpiration under deficit irrigation resulting in an increase in canopy temperature khorsand et al 2020 niu et al 2020 studies indicated that a higher plant density reduced the transpiration rate as well as the photosynthetic rate under dry conditions the higher soil water contents under low plant density fig 6 were conducive to increasing the transpiration rate and decreasing the canopy temperature as well as delaying leaf senescence the improved soil water conditions were also beneficial for decreasing soil temperature some studies showed that the fraction of radiation intercepted under high plant density 8 2 plants m2 was 6 8 higher than that under low plant density 5 2 plants m2 under full irrigation conditions shi et al 2016 however if the planting density is too high it will reduce the ability of light to penetrate the lower canopy which result in senescence of the lower leaves antonietta et al 2014 moreover a higher plant density may not be necessary because the higher leaf area index would lead to higher crop water use during the early stages and result in water deficits during the reproductive stage under limited water supply conditions zhang et al 2019 tokatlidis et al 2011 also reported that maize hybrids were less dependent on high plant densities and had improved resource use efficiency under drought prone environments the selection of maize cultivars affects the determination of optimum density more upright leaf cultivars could increase the photosynthetically active radiation in the middle and lower portions of the plant population which is beneficial to decreasing leaf senescence and increasing radiation use efficiency huang et al 2017 therefore the optimal plant density would be further increased by choosing better performing cultivars which improve the microenvironment and delay leaf senescence under deficit irrigation conditions in the present study the final ear numbers were 6 2 23 3 lower than the target ear numbers under different plant densities nafziger 1996 showed that approximately 5 15 of sown seeds normally fail to produce plants in the field however in our study the missing plants at high plant density 7 2 and 8 2 plants m2 were more than this value with 10 missing plants the yield reduction was 5 3 8 1 nafziger 1996 the missing plants and the reduction rate in maize yield should increase with the increase in plant density the unevenness in plant emergence increased plant to plant variability which would decrease resource use efficiency and grain yield especially under a limited water supply tokatlidis and koutroubas 2004 lu et al 2017 showed that from sowing to the seven leaf stage rainfall less than 50 mm would cause water stress in maize and affect seedling establishment in the present study the low rainfall during the seedling stage the rainfall was 50 6 21 6 and 25 1 mm in 2017 2018 and 2019 respectively cannot support a high plant population tokatlidis 2012 song and jin 2020 also showed that water stress during the seedling stage damaged the photosynthetic membrane and reduced the chlorophyll content in the leaf in contrast a lower plant density could improve the crop stand uniformity and efficiency in resource use as well as increase stress tolerance at a crop level while also saving the cost of purchasing maize seeds ross et al 2020 tokatlidis 2012 2017 our study showed that kernel numbers and kernel weight increased with a decrease in planting density this has been reported in a similar study by tokatlidis 2017 the reason for this phenomenon was that the lower plant density consumed less soil water during the vegetative stage and had increased soil water use during the reproductive stage mansouri far et al 2010 indicted that water deficits during the reproductive stage resulted in more yield reduction than that during the vegetative stage and 1000 kernel weight was more sensitive to limited irrigation water deficits constrain the crop growth rate during the critical period for kernel set and haves a negative influence on maize yield hernández et al 2020 in the present study 6 0 plants m2 obtained a higher grain yield implying that the increase in ear numbers could not offset the decrease in kernel numbers and kernel weight with the increase in planting density due to water stress in addition the high density treatment exacerbated root senescence compared with the low density treatment in the later stages of maize growth under deficit irrigation conditions jia et al 2018 root senescence had a negative influence on root water uptake however li et al 2018b showed that the highest plant density of 8 0 plants m2 achieved the maximum grain yield although the kernel numbers and kernel weight decreased under high plant density with no irrigation conditions the reason for this was that the film mulching system improved the temperature and water conditions then increased the spike numbers the final ear numbers was close to the sowing plant density therefore plant density maybe increased if combined with mulching measures our studies showed that kernel numbers per area was more influenced by plant density or low soil water content and kernel weight was more affected by weather factors similarly liu et al 2014 indicated that kernel number decreased with plant density ranging from 6 5 to 8 5 plants m2 while kernel weight varied across seasons the kernel weight was more susceptible to weather factors mainly due to the short grain fill duration for the summer maize in the ncp fang et al 2019 in our study the rainfall was lower than the long term average which was 302 1 mm as density increases resource allocation at the plant scale decreases and plant to plant competition increases which limits the yield potential assefa et al 2016 in addition higher plant populations would increase soil water use in early stage and lead to a water deficit in the flowering and grain filling stages magaia et al 2017 lindsey and thomison 2016 considering the three yield components and crop water use the lower plant density of 6 0 plants m2 should be recommended under limited water supply conditions in the ncp 5 conclusion the difference in the initial soil water content related to the different irrigation management conditions of the previous crop significantly affected maize production under a limited water supply the decrease in grain yield was largely related to the low soil water contents which decreased the kernel numbers per ear and 1000 kernel weight conserving the soil water that was applied at maize sowing to prolong its availability to maize growth would reduce the negative effects of water stress the results from this study indicated that there were two effective methods one was straw mulching to reduce the soil evaporation after the irrigation at maize sowing and another method was to reduce the planting density to maintain individual plant performance this study proved the two methods were effective in improving the crop performance of grain production and water use efficiency their contribution to increasing or maintaining grain production was largely due to the improved crop growth during the reproductive stage which was due to the reduced water use during the vegetative growth period and more soil water availability during reproductive period straw mulch significantly reduced soil water evaporation when the canopy size was smaller reduced plant density also reduced the canopy size and crop water use both methods conserved soil moisture to increase the duration of soil water availability to the crop therefore under limited water supply conditions measures that reduce water use during the vegetative growth stage to allow more water use during reproductive stage would be preferred declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the authors declare that they have no conﬂict of interest acknowledgments this study was supported by the special project from most of china 2017yfd0300903 02 and sts project of the chinese academy of sciences 
10298,the annual double cropping of winter wheat and summer maize plays an important role in ensuring the food supply in the north china plain ncp with the intensifying water shortage a deficit irrigation strategy has been gradually applied to this cropping system the limited irrigation water supply generally results in a dry root zone soil profile at winter wheat harvesting which further negatively affects the grain production of its following crop summer maize field studies from 2016 to 2019 at a typical site in the ncp luancheng agro experimental station were undertaken to examine the effects of different irrigation schedules during the winter wheat season on summer maize production and water conservation techniques that might benefit maize production under a limited water supply the results indicated that soil water contents at maize sowing played an important role in deciding the final maize yield under the recommended winter wheat deficit irrigation schedule for this region the yield of maize would be reduced by 22 32 compared to the maize following the full irrigation schedule water deficits mainly occurred during the earlier growth stage of maize before the rainfall season reducing water consumption during the earlier growth stages of maize was important for prolonging the soil water availability for crop growth from the irrigation at maize sowing due to the smaller canopy cover at the earlier maize growth stages using straw from the winter wheat to fully cover the soil surface was an active measure to preserve soil moisture and the maize yield under mulch was increased by 10 25 while the water use efficiency wue was increased by 5 25 under a limited water supply reducing planting density by 11 over the normal density could reduce crop water use during the vegetative stage and increase crop water use during the reproductive stage which increased grain production and water productivity the reduced density also decreased the production cost these results indicate that measures to preserve soil water during the vegetative growth stages of maize would benefit grain production under limited water supply conditions in the ncp keywords summer maize limited water supply straw mulching plant density pre sowing soil water conditions 1 introduction the north china plain ncp is one of the most important agricultural regions in china and provides more than 50 and 33 of the nation s wheat and maize production respectively sun et al 2015 liang et al 2011 winter wheat and summer maize form the annual double cropping rotation and have been dominant for the past three decades the double cropping system consumes approximately 800 mm of water which significantly exceeds the amount of annual rainfall of 473 mm sun et al 2015 farmers in this region generally irrigate winter wheat three or four times and irrigate summer maize one to three times each season to obtain high grain yields zhang et al 2016 however the groundwater table level has declined rapidly which threatens the development of sustainable agriculture due to over pumping sun et al 2010 thus it is essential to develop the best irrigation water management to save groundwater and obtain higher crop yields recently limited or deficit irrigation and supplemental irrigation have been widely studied in the ncp to understand the influence of reducing irrigation applications on winter wheat zhang et al 2013 rashid et al 2019 however few studies have focused on the effects of limited irrigation on its following crop summer maize zhang et al 2006 and sun et al 2014 suggested a minimum irrigation strategy mi for use with the double cropping system to maintain the groundwater level the mi involves only irrigate winter wheat and summer maize at sowing to promote crop germination without further irrigating afterwards this method can effectively conserve groundwater resources but yield reduction for winter wheat can reach up to 20 and for summer maize it can reach up to 14 under limited irrigation the available soil water at planting would play an important role for crop production zhang et al 2017 peake et al 2016 lawes et al 2009 for the winter wheat and maize rotation due to winter wheat having a prolific and deep root system soil water depletion by winter wheat is usually very high resulting in a very dry soil profile at maize sowing which would aggravate the negative effects of deficit irrigation on maize grain production feng et al 2018 in addition the rainfall and its distribution during the growing season are also important factors influencing crop production under a limited water supply jägermeyr and frieler 2018 li et al 2019 zipper et al 2016 mushore et al 2017 wang et al 2020 indicated that maize yield would decrease when the seasonal rainfall was less than 300 mm sun et al 2016 found that in the ncp the rainfall decreased by 0 79 mm year and the temperature increased by 0 022 c year during the maize growing season for the past 50 years the trend in future rainfall change will negatively influence maize yield under limited water supply conditions omoyo et al 2015 sun et al 2014 under a climate change background large seasonal weather fluctuations would also affect maize production gao et al 2018 indicated that low temperatures during the late growth stage reduced the grain filling rate and kernel weight of summer maize the forecasted increase in temperature might benefit the summer maize production under full irrigation in the ncp fang et al 2019 however under dry conditions high temperatures would aggravate water stress on crop performance and decrease crop yield shaw et al 2014 grassini et al 2009 therefore it is important to take some measures to eliminate the negative influence of weather factors on maize yield under limited water supply conditions mulching techniques have proven to be an effective measure to improve maize yield under dry conditions boillat et al 2019 ali et al 2016 with the use of combines to harvest wheat straw mulch could be readily applied to summer maize in the ncp studies have shown that straw mulch reduced soil evaporation by 40 50 mm during the summer maize growing season zhang et al 2005 2016 and increased soil water storage hu et al 2019 yan et al 2017 showed that maize roots absorb shallow soil water better after mulching treatments li et al 2018a demonstrated that compared to conditions without mulch straw mulch increased the summer maize yield by 9 29 and water use efficiency wue by 10 33 increasing the population density of plants is another agronomical practice to increase the maize yield in many regions milander et al 2016 mastrodomenico et al 2018 sun et al 2016 indicated that the optimal plant density of maize was approximately 8 6 plants m2 under full irrigation in the ncp testa et al 2016 showed that the planting density of 10 5 plants m2 obtained higher grain yield under irrigation conditions in italy chen et al 2019 showed that crop water use increased with increases in plant density plant density from 6 to 9 plants m2 a high plant density did not always improve the maize yield under drought prone environments tokatlidis 2012 for example magaia et al 2017 showed that a medium plant density 4 2 plants m2 achieved the highest grain yield in a semi arid region when the seasonal rainfall was less than 400 mm however dias et al 2019 indicated that the optimum plant population was 7 8 plants m2 in a rain fed condition in brazil when the seasonal rainfall was 931 6 mm these studies indicate that the soil moisture status and weather conditions should be considered when determining the optimal plant density with the widespread application of limited irrigation schedules and climate change in this water shortage area it is important to examine the effects of reducing irrigation during the winter wheat season on its following crop summer maize and the possible practices to reduce the negative influence of water stress and weather factors on maize production under limited water supply conditions thus the objectives of this research were to 1 examine the effects of initial soil water conditions on maize yield and yield components under limited water supply condition and 2 examine measures to conserve soil water and mitigate soil water deficit to improve the yield and water productivity of summer maize the results from this study should provide some references for the better management of crops for higher production under limited water supplies in the ncp and other regions with similar conditions 2 material and methods 2 1 study site field experiments were conducted at the luancheng ago eco experimental station 37 53 n 114 40 e 50 m above sea level of the chinese academy of sciences the station is located in the northern part of the ncp at the base of mt taihang this region has a typical monsoon climatic zone winter wheat and summer maize are the two main crops forming the annual double cropping system in this continuous cropping system winter wheat is sown around the 10th of october and harvested around the 15th of june the following year and summer maize is sown immediately after winter wheat and harvested around the end of september the average annual rainfall was approximately 473 mm with 70 falling in the growing season of summer maize from july to september the soil is loam with an average water holding capacity of 35 9 v v and wilting point of 13 2 v v for the top 2 m soil profile the organic matter content was 18 g kg total n was 1 2 g kg available n was 92 mg kg available p was 21 mg kg and available k was 80 mg kg for the top tillage layer 0 20 cm 2 2 experimental design the major experiment of this study was to examine the effects of soil water contents at sowing on of summer maize under limited irrigation from 2016 to 2019 soil water contents before sowing summer maize were different following different irrigation numbers and amounts from the previous winter wheat season treatment i0 i1 i2 i3 and i5 for summer maize indicated that there was no irrigation one two three and five irrigations to winter wheat respectively the i1 treatment was the usual irrigation practice for winter wheat under a limited water supply and the i3 and i5 treatments were the irrigation practices for achieving the highest yield of winter wheat depending on the seasonal rainfall for the summer maize pre sowing irrigation was applied to all treatments for seedling establishment no other irrigation was applied during the growing season irrigation amounts per application were approximately 70 80 mm each treatment had four replicates and the plots arranged randomly with an area of 40 m2 5 m by 8 m plots were separated by a 2 m wide zone without irrigation to minimize the mutual effects of the two adjacent plots the planting density of maize was 6 7 m2 with a row distance of 60 cm this density is the normal planting density used locally for summer maize for reduced water deficit effects on maize production two extra experiments were conducted supplemental experiment one se1 examined the effects of mulch on soil water conservation using the straw from winter wheat summer maize cultivar zhengdan 958 with a planting density of 6 7 m2 the row spacing was 60 cm was used in this experiment in 2018 and 2019 twenty small field plots were used with a 4 m2 area 2 m by 2 m each and the plots was separated from each other by 10 cm concrete waterproof walls to a depth of 1 2 m to prevent water exchange wheat straw was applied to 10 of the plots after sowing resulting in a 2 3 cm thick cover approximately 6000 kg ha of straw applied which was defined as mulching treatment another 10 plots did not have straw applied and served as controls se2 examined if reduced planting density could favor the final production of maize due to a smaller canopy during the early growth stages of maize using less water to extend the water supply period of irrigation water applied at sowing se2 was conducted under straw mulch summer maize cultivar zhengdan 958 with different planting densities was studied in this experiment in 2017 2018 and 2019 the five planting densities were 5 2 plants m2 d1 6 0 plants m2 d2 6 7 plants m2 d3 7 5 plants m2 d4 and 8 2 plants m2 d5 row spacing was set at 60 cm d1 d2 d3 d4 and d5 were studied in 2017 and 2019 d1 d3 and d5 were studied in 2018 each plant density was arranged in a completely randomized design with four replicates the plot area was 40 m2 8 m by 5 m for se1 and se2 the previous crop winter wheat was only irrigated once at the jointing stage i1 and maize was irrigated at sowing with irrigation amounts of 70 80 mm table 1 lists the practices examined in this study for improving the yield of summer maize under water deficit conditions 2 3 field management for all experiments summer maize was sown manually directly after harvesting the winter wheat without tillage immediately after sowing 70 80 mm of irrigation was applied to each plot and no other irrigation was applied during the growing season irrigation was conducted with a plastic hose connected to the outlet of a low pressure water transportation system that obtained water from a well a water meter was installed in the system to control the water applied to each plot nitrogen was applied at the ninth leaf stage with a rainfall event at a rate of 175 kg n ha diammonium phosphate dap at 300 kg ha urea at 150 kg ha and potassium chloride at 150 kg ha were applied in combination with soil cultivation at the sowing of winter wheat an additional 150 kg ha of urea was the top dressing at the jointing stage of winter wheat all the p and k fertilizers were incorporated into the soil with cultivation as base fertilizers for the annual double cropping system before sowing winter wheat pesticides and herbicides were applied as necessary to ensure that the growth of maize was free of pests and weeds 2 4 measurements 2 4 1 weather conditions daily weather factors including average temperature ave t relative humidity wind speed sunshine duration shr and rainfall were collected from a national standard weather station approximately 50 m away from the experimental site daily reference evapotranspiration et0 was calculated with the crop water program developed with the fao penman monteith equation which represented the definition of a grass reference albedo 0 23 height 0 12 m surface resistance 70 s m allen et al 1998 2 4 2 soil water content soil water content was monitored every 10 15 days in 20 cm increments to a depth of 2 m using the neutron meter 503 dr cpn international inc usa with access tubes installed in the center of the plots four plots for each treatment were regularly monitored for each soil water condition using the neutron meter method the topsoil soil water contents 0 20 cm were monitored using the soil auger method 2 4 3 phenology grain yield yield components and harvest index hi the seven leaf stage v7 tasseling stage vt blister stage r2 and maturity stage r6 for different cultivars were based on the developmental scales of ritchie et al 1986 at harvesting every plot was harvested separately all the ears were collected manually the grain was weighed after being air dried to a constant weight 13 water contents and the 1000 kernel weight was measured prior to harvest ear numbers per plot were counted with samples of 10 ears from each plot being collected to determine kernel numbers per ear in addition before harvesting four plants from each plot were randomly selected and cut at the soil surface to separately measure the total dry biomass and grain weight to determine the harvest index hi hi was calculated by the grain weight divided by the total dry biomass 2 4 4 crop water consumption and water use efficiency wue crop water consumption et for a certain period or for the entire season was calculated based on the water balance equation zhang et al 2008 1 et p i swd r d cr where et is the water use over a period or over an entire growing season mm p is the precipitation mm i is the irrigation mm swd is the soil water depilation soil water content at the start minus soil water content at the end of the period mm r is the runoff mm d is the drainage from the root zone and cr is the capillary rise to the root zone because of less rainfall and a deep groundwater table 40 m below soil surface r and cr were taken to be zero wue is defined as the final grain yield divided by the seasonal crop water use 2 4 5 crop water requirements etp and percentage of available soil water pasw potential crop water requirements etp at the different growing stages of summer maize were calculated by multiplying the et0 by the crop coefficient kc according to liu et al 2002 the percentage of available soil water was calculated based on the following equation 2 pasw θ θ wp θ hc θ wp 100 where pasw is the percentage of available soil water θ is the volumetric soil water content v v θ wc is the water holding capacity θ wp is the wilting point 2 5 statistical analysis one way anova was conducted to compare the effects of different treatments on maize yield yield components and crop water use under the same season the analysis was conducted using spss version 19 0 spss for windows ibm armonk new york usa and excel software 3 results 3 1 soil water conditions at winter wheat harvesting due to the high water use and low rainfall during the growing season of winter wheat even under the more frequent irrigation treatments the soil water content in the topsoil layers at winter wheat harvesting was quite dry and close to the wilting point especially under the i0 i1 and i2 treatments fig 1 table 2 shows the percentage of the available soil water pasw at winter wheat harvesting during the four seasons the pasw of the 0 1 m and 0 2 m soil layers decreased with a decrease in irrigation numbers during the winter wheat season the results indicate that winter wheat can effectively absorb soil water with a deep root system under limited irrigation conditions which results in low soil moisture before sowing summer maize the irrigation at sowing maize is important for seedling establishment 3 2 influence of differences in initial soil water availability on maize yield due to the variation in soil water contents that are caused by different irrigation numbers during the previous winter wheat season and rainfall the maize yield fluctuated greatly fig 2 shows the maize yield under different treatments during the 2016 2019 seasons the highest grain yield was achieved in 2016 among the four seasons due to the large amount of rainfall which increased kernel numbers per ear 1000 kernel weight and the harvest index table 3 in 2016 and 2017 no yield difference was found between treatments i0 and i1 the yield under i0 was 8 0 and 6 6 lower than that under i2 during the two seasons respectively in 2018 and 2019 the yield under i0 was 22 1 and 32 1 lower than that under treatment i3 and i5 respectively these results show that maize yield was greatly affected by the initial soil water condition at sowing which was related to the previous crop s irrigation management the variation in grain production was related to the three yield components table 3 specifically the average ear numbers kernel numbers and kernel weight under i0 was 2 4 8 0 and 9 8 which was 4 3 12 9 and 14 7 lower than that under i3 and i5 respectively the rainfall from sowing to the seven leaf stage was only 21 6 and 25 1 mm respectively after maize planting and until the earlier vegetative stage the crop growth depended on soil water due to low rainfall the lower soil water contents under i0 was not favorable for maize seedling establishment and final ear numbers in addition from blister stage to maturity the rainfall was only 14 2 and 30 6 mm respectively lower soil moisture under i0 aggravated water stress during the grain filling stage which reduced seed formation 3 3 conserving soil water during the earlier growth stage of maize under limited irrigation crop water requirements etp were calculated by multiplying the et0 by the crop coefficient kc according to liu et al 2002 table 4 shows the accumulated rainfall etp and the percentage of rainfall to etp for the 2016 2019 and 1987 2019 summer maize seasons the crop water requirements of summer maize were much greater than the rainfall over the entire growing seasons indicating that rainfall could not meet the crop water requirements the high crop water requirements and low rainfall had a negative influence on maize production although irrigation has been applied at sowing summer maize the crop water requirements before the coming rainfall season were relatively high if the irrigation water could not be effectively preserved and utilized drought could easily affect maize yield especially drought occurring at the blister stage to maturity there was a significant increasing trend of etp with time from sowing to the seven leaf stage fig 3 although there was no significant trend in rainfall from 1987 to 2019 the variation in rainfall was larger between years and a decreasing trend in the rainfall was found for the recent eight years the increasing trend in etp and declining trend in rainfall in the future may have adverse effects on the grain yield of maize under limited water supply conditions taking some measures to conserve the soil water from the only irrigation at the sowing of maize and to prolong its availability to the crop will be necessary to reduce the negative effects of water stress on maize production 3 3 1 straw mulching after the initial irrigation at maize sowing under the wet soil surface with was no crop canopy condition soil evaporation was greater which would reduce the soil water available to the crop straw mulch could be an effective method to reduce this amount of water consumption fig 4 shows the changes in soil water contents for the top 1800 cm soil profile with and without mulching treatments during the 2018 and 2019 seasons the soil water content with mulching was higher than that without mulching during the whole growth stage the higher soil water contents during sowing to the seven leaf stage was beneficial for the establishment of maize and a higher soil water content during the reproductive stage was beneficial for seed formation the grain yield under mulching treatment was 9 7 and 25 1 higher and the wue was 5 3 and 25 0 higher than that under the non mulching treatment during 2018 and 2019 respectively table 5 fig 5 shows the crop water consumption from sowing to tasseling vegetative stage tasseling to maturity reproductive stage and sowing to maturity whole growth stage there was no significant difference between the two treatments when considering the total crop water consumption during the whole growth stages however straw mulching changed the water consumption during the vegetative and reproductive stages as shown in fig 5 during the 2018 and 2019 seasons compared to the non mulching treatment straw mulching reduced crop water consumption from the sowing to tasseling stage by 6 0 and 19 7 and increased crop water consumption from the tasseling stage to maturity by 10 1 and 18 9 respectively increased crop water use during the reproductive stage was beneficial for the formation of kernel numbers per ear and 1000 kernel weight in the 2018 and 2019 seasons the kernel number per ear under mulching was 7 8 and 17 9 higher and 1000 kernel weight was 1 6 and 4 3 higher than that under without mulching respectively 3 3 2 plant density under a limited water supply the optimized maize density might be different from that under a full irrigation water supply fig 6 shows the soil water contents of different plant densities during the 2017 2019 seasons higher plant densities decreased the soil water contents over the whole growth stage the low soil water contents had a negative influence on maize yield table 6 shows the grain yield and yield components of different plant density treatments during 2017 2019 the grain yield ranged from 6432 7 d5 to 9058 1 d2 kg ha from 5738 9 d5 to 6397 3 d1 kg ha and from 6129 1 d5 to 6846 0 d4 kg ha among different densities for 2017 2018 and 2019 respectively the highest yield may be because of the good sunshine and water conditions during the grain filling stage which improved the 1000 kernel weight weather factors influence maize responses to changes in plant density the largest yield difference between densities occurred in 2017 which was 2625 5 kg ha the results show that the seasons with higher grain yield tended to have higher yield difference among densities than seasons with lower yield on average over the three seasons d2 showed the highest maize yield and the yield of maize was 8 2 10 8 10 5 and 26 9 greater than that in d1 d3 d4 and d5 respectively these results show that higher plant densities are not necessary for obtaining greater maize production under limited irrigation conditions the increase in grain yield under low plant density also benefitted wue although there was no significant difference in et among the different treatments tables 6 and 7 ear numbers per area kernel numbers per ear and 1000 kernel weight determine the final maize yield table 6 shows that the ear numbers per area increased with increases in plant densities however the final ear numbers per area was 6 2 6 1 15 1 20 8 and 23 0 lower than the target ear numbers per area under d1 d2 d3 d4 and d5 respectively etp was 156 6 132 1 and 140 8 mm at the seeding stage from sowing to seven leaf stage however the rainfall was only 50 6 21 6 and 25 1 mm during the three maize seasons respectively the rainfall only met 32 2 16 4 and 17 8 of the crop water requirements table 4 these results indicate that higher sowing densities such as d4 and d5 could not achieve higher final harvest ear numbers due to water stress table 7 shows the crop water consumption at different growth stages under d1 d3 d4 and d5 during the 2017 2018 and 2019 seasons d3 d4 and d5 consumed more soil water than d1 at the vegetative stage however at the reproductive stage soil water consumption under d1 was greater than that under d5 d5 and d4 for the 2017 2018 and 2019 seasons respectively the more soil water used from the tasseling stage to maturity was beneficial for the formation of kernels and kernel weight for the three seasons the kernel numbers per ear in d1 was 17 6 16 4 and 39 7 higher than that in d5 and 1000 kernel weight in d1 was 3 2 12 3 and 7 2 higher than that in d5 the increase in kernel numbers per ear was more than the increase in 1000 kernel weight with decreasing plant density in addition the interannual variation in 1000 kernel weight was 20 8 this difference was much higher than the variation in densities these results indicate that kernel numbers per ear was more easily influenced by soil water content during the reproductive stage and 1000 kernel weight was mainly controlled by weather factors the results in this study also show that the increase in ear numbers per area could not offset the decrease in kernel numbers per ear and 1000 kernel weight with the increase in plant density due to a water deficit and maintaining suitable plant density was necessary to achieve high grain yield under limited water supply conditions 4 discussion 4 1 effects of the initial soil water contents on maize production the soil moisture at maize sowing plays an important role in crop germination seedling emergence and rooting which was affected by irrigation and rainfall during the winter wheat season and influenced by total water use by winter wheat helms et al 1997 paolo and rinaldi 2008 feng et al 2018 some studies have shown that soil water consumption increase with decreasing winter wheat irrigation zhang et al 2008 2013 similarly in the present study compared to i3 or i5 the soil water content after harvesting winter wheat decreased under i0 the reason was that winter wheat could fully take up soil water under limited irrigation with a deep rooting system which can reach up to 2 m zhang et al 2009 the available soil water was very low before sowing summer maize especially under limited irrigation conditions table 2 although there was 70 80 mm of water irrigated at maize sowing the irrigation was only replenishing the top 0 60 cm soil layer yan et al 2017 the rainfall from sowing to the seven leaf stage was lower than the crop water requirements table 4 and the seedling stage was easily influenced by the water deficit xu et al 2020 in the present study the increasing trend in etp during the early stages fig 3 would aggravate the negative influence of low soil moisture on crop growth under limited water supply conditions some studies have shown that soil drought significantly decreases the leaf area index leaf chlorophyll content and leaf photosynthesis and accelerates leaf senescence ultimately limiting dry matter accumulation and grain yield li et al 2020 sade et al 2018 ali and ashraf 2011 in the present study compared to i3 and i5 kernel numbers per ear 1000 kernel weight and hi decreased under i0 low soil water contents under i0 reduced the ability of plants to transport carbohydrate products from the source to sink organs and influenced seed formation li et al 2018c reduced soil water use during the vegetative stage and maintaining a higher soil water content during the reproductive stage was necessary to achieve higher grain yield chen et al 2010 used apsim to show that maize yield decreased with stored soil water at a sowing rate of 0 03 t ha mm under rain fed condition in the present study the average grain yield under i0 was 22 1 and 32 1 lower than that under i3 and i5 respectively the lower yield under i0 is not only related to the soil moisture at maize sowing but also related to soil water contents over the whole growth stage which was affected by the rainfall amount and distribution previous studies showed that under greater and more stable rainfall during the maize growing season deficit irrigation achieves a similar grain yield as full irrigation sun et al 2014 2010 fang et al 2019 however with decreasing rainfall the soil water would be continuously consumed by the winter wheat and summer maize low soil water contents had a largely adverse influence on maize yield under the climate change background specifically from sowing to the seven leaf stage the crop mainly depends on the soil water for crop growth due to the decreased rainfall in the dry season lu et al 2017 the pre sowing irrigation was important for maize seeding growth and this period determined the crop production capacity sun et al 2014 however due to low rainfall and increasing etp it is necessary to take some measures to conserve the soil water from the only irrigation at maize sowing and to prolong its availability to the crop to reduce the negative effects of water stress on maize production under a limited irrigation supply 4 2 conserving soil moisture to increase the water available to crops previous studies have shown that straw mulching can prevent the soil surface from receiving direct sunlight reduce the absorption of radiation and modify the thermal regime of soil dahiya et al 2007 sharratt et al 1998 akhtar et al 2019 chen et al 2017 kader et al 2017a indicated that the temperature at soil depth of 0 0 5 m of mulching treatment was 2 c lower than that without mulching treatment rashid et al 2019 showed that straw mulching reduced the soil surface temperature 0 8 1 5 c during march which reduced the crop growth and grain yield of winter wheat a cool region study also reported that a low temperature in the early growth stage under straw mulching treatment decreased spring sown maize yield especially in wet years lu et al 2015 however in some sub humid drought prone regions some researchers showed that straw mulching benefitted summer maize growth due to the inhibition of an excessive rise in soil temperature by preventing the exchange of water and heat between the soil and the atmosphere kar and kumar 2007 hu et al 2019 in our study the grain yield under the straw mulching treatment was higher than that without mulching indicating that straw mulching was more favorable for summer maize in this study area which is a warm and semi arid region deficit irrigation has a negative influence on maize growth especially under low rainfall situations ali and ashraf 2011 some studies have shown that straw mulching is an efficient measure to overcome water deficit and improve grain yield through increasing the leaf area index photosynthetic capacity and biomass accumulation yin et al 2020 zhang et al 2019 in the current study we found that straw mulching increased the yield of summer maize by 9 7 25 1 under the limited water supply conditions in the ncp this finding is similar to the results of a previous research study by li et al 2018a which showed that the increase in summer maize yield was 9 29 for straw mulching treatment in a warm and semi humid region even so pre sowing irrigation was also necessary for seedling establishment of summer maize due to the low soil water conditions after winter wheat harvesting fig 1 yan et al 2017 indicated that the grain yield of summer maize under straw mulching coupled with 70 mm pre sowing irrigation was higher than that under 100 mm pre sowing irrigation without mulching treatment this finding indicated that 40 mm of water resources may be saved through straw mulching under deficit irrigation conditions some studies have shown that more soil water was lost from non mulched treatment because of intense soil surface evaporation by direct solar radiation in the early growth stage li et al 2018a ibrahim et al 2020 compared with the non mulched treatment straw mulching could reduce soil evaporation by 40 50 mm in this study area zhang et al 2005 in our study the soil water content under mulching treatment was higher than that under without mulching treatment which may be due to straw mulching reducing soil evaporation over the whole growth stage rainfall from the tasseling stage to maturity in 2019 was only 50 5 mm the improved soil water contents during the reproductive stage has the benefit of alleviating water stress on maize growth zhang et al 2011 studies showed that although the rainfall distribution was uneven mulching could help crops avoid seasonal droughts and better capture water our studies found that the difference in et over the whole growth stage between mulching and without mulching conditions was small similarly hu et al 2019 reported that mulched and bare soil treatments produced similar et suggesting that straw mulching could not reduce water consumption by summer maize however mulching treatment decreased crop water use during the vegetative stage and increased crop water use during the reproductive stage fig 5 which was beneficial to the formation of kernel numbers and kernel weight similar results were reported by yan et al 2017 some studies showed that higher plant transpiration in mulching treatment improved maize growth increased leaf area index and biomass and water utilization tolk et al 1999 daryanto et al 2017 chen et al 2019 soil mulching converts more water from unproductive soil evaporation to plant transpiration and this maybe one of the reasons for the increase in maize yield and wue under straw mulching treatment zheng et al 2019 in addition thidar et al 2020 showed that straw mulching improved root growth in the top 30 cm soil layers which also benefits water uptake and increase grain yield under rain fed conditions straw mulching not only increases the soil moisture content but also improves soil fertility and enzyme activities akhtar et al 2018 furthermore straw materials are inexpensive convenient and friendly to the environment kader et al 2017b in the future the application of straw mulching will be an effective measure to increase summer maize yield under the limited water supply of semi arid regions 4 3 group vs individual plant yields under water stress many studies showed that the maize grain yield response to an increasing plant population often follows a quadratic model and the optimum plant population achieving the highest yield for maize is dependent on field management and environmental factors magaia et al 2017 xu et al 2017 ross et al 2020 for example li et al 2015 indicated that the planting density of 10 5 plants m2 produced the maximum maize yield under irrigated conditions no water stress in xinjiang china however in a rain fed condition water stress the optimal plant densities varied from 4 8 to 5 1 plant m2 on the loess plateau china zhang et al 2019 the maize density in rain fed conditions was lower than that in irrigated conditions due to water deficiency liu et al 2014 in this study we found that the lower plant density of 6 0 plants m2 low plant density achieved the highest grain yield over the three experiment years under pre sowing irrigation conditions deficit irrigation with seasonal rainfall of less than 225 mm water scarcity is an essential limiting factor for crop production in some semi arid regions especially the ncp where the groundwater table level is below 50 m deficit irrigation or rain fed would significantly decrease the summer maize yield hernández et al 2020 zou et al 2021 indicated that water deficits between the nine leaf and tasseling stage decreased the kernel setting and weight the reduction in plant density increases the ability of the crop to tolerate drought stress increases grain yield stability and saves water resources under limited water supply conditions tokatlidis 2012 jia et al 2018 ross et al 2020 canopy and soil temperature as well as light distribution was affected by plant density and deficit irrigation temperature is one of the major factors that drives leaf area development expansion which further influences leaf biomass growth sandhu and irmak 2020 a plant closes its stomata to reduce transpiration under deficit irrigation resulting in an increase in canopy temperature khorsand et al 2020 niu et al 2020 studies indicated that a higher plant density reduced the transpiration rate as well as the photosynthetic rate under dry conditions the higher soil water contents under low plant density fig 6 were conducive to increasing the transpiration rate and decreasing the canopy temperature as well as delaying leaf senescence the improved soil water conditions were also beneficial for decreasing soil temperature some studies showed that the fraction of radiation intercepted under high plant density 8 2 plants m2 was 6 8 higher than that under low plant density 5 2 plants m2 under full irrigation conditions shi et al 2016 however if the planting density is too high it will reduce the ability of light to penetrate the lower canopy which result in senescence of the lower leaves antonietta et al 2014 moreover a higher plant density may not be necessary because the higher leaf area index would lead to higher crop water use during the early stages and result in water deficits during the reproductive stage under limited water supply conditions zhang et al 2019 tokatlidis et al 2011 also reported that maize hybrids were less dependent on high plant densities and had improved resource use efficiency under drought prone environments the selection of maize cultivars affects the determination of optimum density more upright leaf cultivars could increase the photosynthetically active radiation in the middle and lower portions of the plant population which is beneficial to decreasing leaf senescence and increasing radiation use efficiency huang et al 2017 therefore the optimal plant density would be further increased by choosing better performing cultivars which improve the microenvironment and delay leaf senescence under deficit irrigation conditions in the present study the final ear numbers were 6 2 23 3 lower than the target ear numbers under different plant densities nafziger 1996 showed that approximately 5 15 of sown seeds normally fail to produce plants in the field however in our study the missing plants at high plant density 7 2 and 8 2 plants m2 were more than this value with 10 missing plants the yield reduction was 5 3 8 1 nafziger 1996 the missing plants and the reduction rate in maize yield should increase with the increase in plant density the unevenness in plant emergence increased plant to plant variability which would decrease resource use efficiency and grain yield especially under a limited water supply tokatlidis and koutroubas 2004 lu et al 2017 showed that from sowing to the seven leaf stage rainfall less than 50 mm would cause water stress in maize and affect seedling establishment in the present study the low rainfall during the seedling stage the rainfall was 50 6 21 6 and 25 1 mm in 2017 2018 and 2019 respectively cannot support a high plant population tokatlidis 2012 song and jin 2020 also showed that water stress during the seedling stage damaged the photosynthetic membrane and reduced the chlorophyll content in the leaf in contrast a lower plant density could improve the crop stand uniformity and efficiency in resource use as well as increase stress tolerance at a crop level while also saving the cost of purchasing maize seeds ross et al 2020 tokatlidis 2012 2017 our study showed that kernel numbers and kernel weight increased with a decrease in planting density this has been reported in a similar study by tokatlidis 2017 the reason for this phenomenon was that the lower plant density consumed less soil water during the vegetative stage and had increased soil water use during the reproductive stage mansouri far et al 2010 indicted that water deficits during the reproductive stage resulted in more yield reduction than that during the vegetative stage and 1000 kernel weight was more sensitive to limited irrigation water deficits constrain the crop growth rate during the critical period for kernel set and haves a negative influence on maize yield hernández et al 2020 in the present study 6 0 plants m2 obtained a higher grain yield implying that the increase in ear numbers could not offset the decrease in kernel numbers and kernel weight with the increase in planting density due to water stress in addition the high density treatment exacerbated root senescence compared with the low density treatment in the later stages of maize growth under deficit irrigation conditions jia et al 2018 root senescence had a negative influence on root water uptake however li et al 2018b showed that the highest plant density of 8 0 plants m2 achieved the maximum grain yield although the kernel numbers and kernel weight decreased under high plant density with no irrigation conditions the reason for this was that the film mulching system improved the temperature and water conditions then increased the spike numbers the final ear numbers was close to the sowing plant density therefore plant density maybe increased if combined with mulching measures our studies showed that kernel numbers per area was more influenced by plant density or low soil water content and kernel weight was more affected by weather factors similarly liu et al 2014 indicated that kernel number decreased with plant density ranging from 6 5 to 8 5 plants m2 while kernel weight varied across seasons the kernel weight was more susceptible to weather factors mainly due to the short grain fill duration for the summer maize in the ncp fang et al 2019 in our study the rainfall was lower than the long term average which was 302 1 mm as density increases resource allocation at the plant scale decreases and plant to plant competition increases which limits the yield potential assefa et al 2016 in addition higher plant populations would increase soil water use in early stage and lead to a water deficit in the flowering and grain filling stages magaia et al 2017 lindsey and thomison 2016 considering the three yield components and crop water use the lower plant density of 6 0 plants m2 should be recommended under limited water supply conditions in the ncp 5 conclusion the difference in the initial soil water content related to the different irrigation management conditions of the previous crop significantly affected maize production under a limited water supply the decrease in grain yield was largely related to the low soil water contents which decreased the kernel numbers per ear and 1000 kernel weight conserving the soil water that was applied at maize sowing to prolong its availability to maize growth would reduce the negative effects of water stress the results from this study indicated that there were two effective methods one was straw mulching to reduce the soil evaporation after the irrigation at maize sowing and another method was to reduce the planting density to maintain individual plant performance this study proved the two methods were effective in improving the crop performance of grain production and water use efficiency their contribution to increasing or maintaining grain production was largely due to the improved crop growth during the reproductive stage which was due to the reduced water use during the vegetative growth period and more soil water availability during reproductive period straw mulch significantly reduced soil water evaporation when the canopy size was smaller reduced plant density also reduced the canopy size and crop water use both methods conserved soil moisture to increase the duration of soil water availability to the crop therefore under limited water supply conditions measures that reduce water use during the vegetative growth stage to allow more water use during reproductive stage would be preferred declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the authors declare that they have no conﬂict of interest acknowledgments this study was supported by the special project from most of china 2017yfd0300903 02 and sts project of the chinese academy of sciences 
10299,irrigation water scarcity has now become one of the main constraints that influences global crop production the potential reduction in egypt s nile share and the current degree of deterioration of surface and ground water will certainly increase the severity of the water shortage problem in egypt raised bed planting systems under deficit irrigation could be a partial solution to compensate for the negative effect of water stress on wheat plants two field experiments were managed successively in 2016 17 and 2017 18 to study the influence of irrigation water levels at 100 di0 80 di20 and 60 di40 crop evapotranspiration etc and three different plantation systems flat planting ps1 60 cm raised beds ps2 and 120 cm raised beds ps3 on growth photosynthetic efficiency yield and irrigation crop water productivity i wp of wheat plants the results revealed that yield reduction caused by deficit irrigation can be remunerated by the raised bed planting method when averaged over both seasons the highest grain and straw yield of wheat plants was recorded under ps2 and ps3 compared with ps1 while there were no significant differences between ps2 and ps3 raised beds ps2 and ps3 combined with di0 followed by di20 significantly increased growth characteristics leaf chlorophyll contents and their efficiency stomatal conductance yield and its components compared with ps1 combined with di40 the highest value of i wp 1 61 and 1 54 kg m 3 was obtained under di20 combined with ps2 and ps3 respectively therefore under both land and water limiting conditions such as in the current egyptian situation raised beds could be considered a potential planting technique for improving the growth and productivity of wheat under deficit irrigation di20 by conserving 20 1050 m3 ha 1 of the water needed for wheat production keywords deficit irrigation growth and productivity photosynthetic efficiency raised beds wheat irrigation water use efficiency 1 introduction wheat is one of the world s three most meaningful cereal crops after maize and rice and occupies approximately 218 5 million hectares which is approximately 4 of the global area allocated for crop production with an average yield of 3 26 t ha 1 fao 2017 the crop is primarily grown for its grain which is consumed as human food and hay in animal food kiliç 2010 wheat is the first important cereal grain used as a staple food for millions of people in egypt where 1 35 million hectares were cultivated with total production of 8 8 million tons during 2016 17 fao 2017 wheat requirement is expected to increase by several folds during the next few decades thus the situation demands a sustainable increase in crop yield per unit area with scarce water resources water availability per unit irrigated area in mediterranean regions is declining because of water scarcity inefficient irrigation system poor maintenance and low crop water productivity abd el mageed et al 2017 badal et al 2013 el marsafawy et al 2018 deficit irrigation di is a type of irrigation management strategy in which water is applied below full crop water requirements abd el mageed et al 2016a fereres and soriano 2007 semida et al 2017 sun et al 2013 and it is a vital tool for enhancing water use efficiency in closely spaced crops such as wheat without causing severe yield reduction agami et al 2018 zhang et al 2005 according to pereira et al 2002 there is only a 13 reduction in wheat yield in response to water application up to 40 less than full potential crop water requirement wheat yield reduction through di can be alleviated by adopting different management techniques such as drought stress cultivars keyvan 2010 suitable sowing methods abbas et al 2009 maintaining fertility status sarma et al 2007 as well as mulching alamin et al 2017 the raised bed planting method is suitable for wheat cultivation and has proven to be one of the available options for saving water through attaining high water use efficiency sayre and hobbs 2004 raised bed cultivation is responsible for increasing wheat yield by 14 21 with 13 45 higher crop water productivity than traditional flatbed cultivation akbar et al 2009 raised bed wheat plantations improve yield increase fertilizer use efficiency reduce herbicide use and save seed as well hobbs et al 2002 deficit irrigation coupled with appropriate sowing methods can be a good option to save water scientists have experimentally tested these technologies individually kiliç 2010 liu et al 2005 soomro et al 2009 and combined el hadidi et al 2015 razaq et al 2019 zaman et al 2018 the objectives of the current experiments were i to determine if wheat planted on raised beds 60 and or 120 cm under deficit water will yield higher than flat planting and ii to determine if six rows seeded on raised beds 120 cm raised beds will yield more than three rows seeded 60 cm raised beds versus the same configurations 20 cm row to row distance in flat planting 2 methodology 2 1 experimental layout and growth conditions in two successive seasons 2016 17 si and 2017 18 sii trials were conducted at the experimental farm of the faculty of agriculture fayoum university 29 17 n 30 53 e southeast fayoum egypt data on the experimental area climate during si and sii seasons indicate that daily minimum temperatures ranged from 8 5 to 15 7 c in si and 8 5 15 5 c in sii while maximum temperatures ranged from 20 5 to 28 c in si and 20 5 28 3 c in sii wind speed ranged from 1 55 to 2 15 ms 1 in si and 1 65 2 21 ms 1 in sii the winter season had an evapotranspiration ranging between 1 5 and 4 0 mm d 1 in both seasons and rates of evaporation agree with temperatures i e the lowest evaporation rate 1 5 mm day 1 was documented in december and january and the highest value 4 mm day 1 was noted in march in both seasons table 1 total annual rainfalls are approx 7 5 mm year 1 mostly concentrated between december and march data from egyptian meteorological authority department 2017 abd elmabod et al 2019 healthy wheat grains triticum aestivum l cv misr 1 were carefully selected and sown on 18 and 25 november of the 2016 17 and 2017 18 seasons and harvested on 15 and 21 april of the 2016 17 and 2017 18 seasons respectively the experiments were conducted in a randomized complete block design split plot in three replicates using a surface irrigation system 3 irrigation water levels 100 di0 80 di20 and 60 di40 of crop evapotranspiration etc were applied and allocated to the main plots and three different plantation systems flat planting ps1 60 cm raised beds ps2 and 120 cm raised beds ps3 allocated to sub plots raised beds were installed parallel to one another using ridgers with a tractor for both 60 and 120 cm raised beds grains were planted manually in rows in both raised beds and by the conventional method for raised beds grains were planted in three and six rows according to the treatments on different width beds 60 and 120 cm respectively for the conventional method row to row distance was 20 cm as shown in fig 1 the total experimental area specified for each year was 594 m2 divided into 27 experimental plots of 20 m2 for each to protect against irrigation treatments effects 2 m was utilized to isolate the experimental units according to recommendations of the ministry of agriculture and land reclamation in egypt the investigated soil was supplemented with 62 kg p2o5 ha 1 400 kg calcium super phosphate 15 5 p2o5 200 kg n ha 1 600 kg ammonium nitrate 33 5 n and 72 kg k2o ha 1 150 kg potassium sulphate 48 k2o the etc mm d 1 was estimated according to the equation of allen et al 1998a 1998b etc kc epan kpan where kc crop coefficient the wheat crop coefficients of the initial mid and end stages were 0 30 1 15 and 0 4 respectively allen et al 1998a 1998b epan evaporation from the class a pan mm d 1 and kpan the pan evaporation coefficient 0 81 using one plastic pipe spile with a 2 inch diameter for each plot the applied volume of water was organized and conveyed to cover the whole plot to calculate the volume of water transferred through each pipe the equation of israelsen and hansen 1962 was used q ca 2 gh 10 3 where q is the discharge ls 1 c is the coefficient of discharge a is the area of pipe cm2 g is gravity acceleration cm s 2 and h is the effective head of water cm all other recommended agricultural disease and pest management practices were followed according to the recommendations of the ministry of agriculture and land reclamation 2 2 analyses of soil physico chemical properties were estimated by klute and dirksen 1986 and page et al 1982 and data are shown in table 2 physical and chemical characteristics of the soil as average for 0 60 cm depth were soil texture is sandy loam bulk density 1 48 kg m 3 hydraulic conductivity 2 04 cm h 1 water content at field capacity and wilting point 21 8 and 9 1 ph 7 60 1 2 5 soil water extract electrical conductivity soil paste extract 4 6 ds m 1 total carbonate 65 4 g kg 1 and organic c 6 7 g kg 1 according to the soil classification of dahnke and whitney 1988 the tested soil fell under the class of moderately saline 2 3 measurements of growth traits from each experimental plot 10 12 week old plants were randomly selected and carefully removed to measure plant height cm with a metre scale and to count numbers of tillers plant 1 and numbers of leaves plant 1 the shoot fresh weight fw of each plant was weighed and then dried at 70 c by an electric oven and the dry weight dw was recorded 2 4 assessments of leaf chlorophyll content chlorophyll a fluorescence stomatal conductance gs eight weeks after sowing 6 fully expanded leaves per treatment were randomly selected and carefully removed to measure leaf chlorophyll content and chlorophyll a fluorescence spad 502 minolta japan chlorophyll metre was used to assess leaf relative chlorophyll content on the 2 upper fully expanded leaves by using a portable handy pea fluorometer hansatech instruments ltd kings lynn uk chlorophyll fluorescence was determined on two different sunny days the maximum quantum yield of ps ii fv fm was described by maxwell and johnson 2000 fv f 0 reflects the efficiency of electron donation to the psii rcs and the rate of photosynthetic quantum conversion at psii rcs spoustová et al 2013 based on the similar absorption photosynthesis performance index pi was measured according to clark et al 2000 stomatal conductance gs was measured n 6 by a leaf porometer decagon devices inc pullman wa usa 2 5 yield characteristics and i wp at harvest 10 plants plot 1 were randomly selected and carefully removed to determine yield and its components number of spikes plant 1 number of grains spike 1 grains weight spike 1 g 1000 grains weight g and number of spikes m 2 were estimated in one square metre from each plot all plants of each plot were removed to estimate biological yield t ha 1 straw yield t ha 1 and grain yield t ha 1 and i wp kg m 3 as mentioned by fernández et al 2020 of the wheat crop was calculated after harvest jensen 1983 i wp grain yield kg ha 1 water applied m 3 ha 1 2 6 statistical analysis combined analysis of variance appropriate to the split plot in randomized complete block design rcbd was carried out using the genstat statistical package version 12 vsn international ltd oxford uk differences between means were compared using duncan s multiple range test at the 5 level p 0 05 3 results and discussion 3 1 growth characteristics as shown in table 3 growth characteristics e g plant height number of tillers plant 1 number of leaves plant 1 shoot fresh and dry weight plant 1 g were significantly affected by deficit irrigation di planting system ps and their interaction the simple effect of seasons was statistically significant only for shoot fresh and dry weight plant 1 shoot fresh and dry weights plant 1 were 39 33 and 17 32 respectively and were higher in the second season than the first season di substantially inhibited the growth of wheat plants as evaluated by plant height tillers and leaves number plant 1 shoot fresh and dry weight plant 1 table 3 plants grown under di0 showed enhanced growth characteristics over both seasons by 23 6 17 5 29 2 39 1 and 27 5 when compared to di40 respectively many earlier studies abd el mageed et al 2017 leach 1980 rady et al 2020a 2020b semida et al 2020 have shown that the total resistance at the soil plant system increases with diminishing soil water potential which causes a shortage of photosynthesis and growth the data clearly showed that raised bed planting systems ps2 and ps3 significantly improved different growth traits relative to flat planting ps1 however there were no significant differences between ps2 and ps3 for plant height shoot fresh and dry weight plant 1 ps3 significantly increased the above growth characteristics by 6 4 79 1 83 5 73 1 and 35 3 for the average of both seasons compared to ps1 these increases in growth parameters under ps2 and ps3 might be due to the improvement of water distribution and efficiency handling nutrients controlling weeds and other pests easily and increased light infiltrating the canopy all which resulted in stronger plants hobbs et al 2002 sayre and hobbs 2004 for combined treatments maximum values of plant height leaves number plant 1 and shoot fresh weight plant 1 were obtained with di0 under ps3 and maximum values of tillers number plant 1 and shoot dry weight plant 1 were obtained with di0 under ps2 on the other hand a sharp reduction in all growth characteristics was found under the combination of di40 x ps1 except the lowest number of tillers plant 1 was found under the combination of di20 x ps1 as shown in table 3 this might be due to the raised bed planting system which contributes significantly to the improvement of water distribution and efficiency additionally raised beds decreased the occurrence of some wheat diseases and this was interpreted as the reduction in canopy humidity is helpful to reducing disease stress and promoting healthy wheat growth sayre and hobbs 2004 shah et al 2013 3 2 photosynthetic efficiency and stomatal conductance average values over both seasons of photosynthetic efficiency determination i e fv fm and fv f 0 pi spad value and gs were affected significantly p 0 05 or insignificantly by di ps and their interaction as presented in table 4 di40 showed decreases in fv fm fv f 0 pi spad value and gs measurements plants under di40 decreased fv fm by 2 5 fv f 0 by 7 5 pi by 19 5 spad values by 24 8 and gs by 63 7 compared to di0 this lowering can be attributed to the drought induced limitation of photosynthesis owing to the exposure of plants to excess energy which if not dissipated safely can be harmful to psii due to over reaction centres abd el mageed et al 2018a 2018b abd el mageed and semida 2015a 2015b demmig adams and adams 1992 and improved production of reactive oxygen species in the chloroplasts smirnoff 1993 additionally water shortage during growth stage causes accelerated leaf senescence oxidative damage to photo assimilatory machinery and assimilates translocation which leads to a deficiency of photosynthetic efficiency and stomatal conductance plants under ps2 and ps3 give maximum photosynthetic efficiency values i e fv fm fv f0 and pi spad values and gs compared to ps1 these findings are in agreement with those obtained by who reported that higher chlorophyll contents in leaves were observed in raised beds than in flat planting due to greater n uptake and use efficiency however there were no significant differences between ps2 and ps3 for spad values fv fm and pi for the interaction between di and ps treatments the highest values of fv fm and fv f 0 were obtained with di20 combined with ps3 while the highest values of spad were obtained under di0 combined with ps3 and the highest values of pi and gs were found under di0 combined with ps2 sharp reductions in photosynthetic efficiency and stomatal conductance were recorded under the combination of di40 x ps1 as presented in table 4 these results are consistent with the findings of ali et al 2007 who reported that water shortage during the critical growth stages flowering and grain filling stage of wheat can be alleviated by raised bed sowing systems to improve growth parameters photosynthetic efficiency and water use efficiency 3 3 yield attributes the effect of seasons was statistically insignificant in all yield attributes except 1000 grains weight the 1000 grains weight was significantly higher in the first season 45 79 g than that in second season 43 81 g table 5 all yield attributes e g number of spikes plant 1 number of grain spike 1 weight of grain spike 1 1000 grains weight and number of spikes m 2 were significantly affected by di ps and their interaction by decreasing the irrigation regime from d10 to di40 the average of number of spikes plant 1 number of grains spike 1 weight of grain spike 1 1000 grains weight and number of spikes m3 were reduced by 13 0 30 3 25 6 19 7 and 29 8 respectively the reason might be better seed germination under favourable moisture conditions less water stress and higher water use efficiency achieved at di0 and di20 these results are in agreement with kiliç 2010 lower wheat yield components under water stress conditions were observed due to strong water potential where plants require more energy for taking water from low moisture soil waraich et al 2010 data clearly showed that ps2 and ps3 significantly improved different yield attributes of wheat relative to flat planting ps1 ps3 increased these traits by 67 0 for number of spikes plant 1 20 0 for number of grains spike 1 24 5 for weight of grains spike 1 11 2 for 1000 grains weight and 30 8 for number of spikes m2 compared to those of ps1 on the average of both seasons respectively however there were no significant differences between ps2 and ps3 for yield attributes except for number of grains spike 1 this might be due to better sunlight penetration good environmental conditions for seed germination and higher water use efficiency under raised beds these results are consistent with the findings of özberk et al 2009 mollah et al 2009 tripathi et al 2005 alam et al 2007 who reported that bed planting showed significantly higher grain spikes than the flat planting method also reported that bed planting reduced plant height lodging and some disease incidences while increasing the grains per spike and grain weight additionally shah et al 2013 reported higher yield components of wheat in raised beds the interaction between di and ps shows a significant effect on yield attributes e g number of spikes plant 1 number of grains spike 1 weight of grains spike 1 1000 grains weight and number of spikes m2 maximum values of all yield attributes were obtained with di0 combined with ps3 expect 1000 grains weight was obtained under di0 combined with ps2 while sharp reductions in all yield attributes were observed under di40 combined with ps1 as shown in table 5 3 4 productivity the effects of di ps and their interaction on biological yield grain yield and straw yield of wheat were significant for the average of both seasons table 6 by increasing the irrigation regime from di0 to di40 the average of biological yield t ha 1 grain yield t ha 1 and straw yield t ha 1 were reduced by 62 0 49 9 and 55 8 respectively this reduction is a natural result of the decreases in growth characteristics e g leaves and tillers number plant 1 shoot dry weight plant 1 photosynthetic efficiency and stomatal conductance gs and yield attributes e g number of spikes plant 1 grain weight spike 1 and 1000 grains weight under di40 these results were in agreement with ali et al 2007 who found that the highest grain yield was obtained with no deficit treatment similar results were also found by tari 2016 who observed that water deficit irrigation significantly decreased the wheat yield the heaviest averages of biological yield grain yield and straw yield were obtained by ps2 and ps3 ps3 increased biological yield by 26 4 grain yield by 29 1 and straw yield by 29 9 compared to ps1 however there were no significant differences between ps2 and ps3 for biological yield grain yield and straw yield as well as i wp these increases in wheat yield under raised bed planting might be due to the deposition of more fertile topsoil on raised beds in a raised bed planting system weeds were concentrated the most in furrows due to the shortage of crop cover there which facilitates the control of weeds additionally the raised bed planting system changed the land configuration which causes higher moisture content which in turn causes increased growth characteristics and yield components of wheat raised bed planting also reduced the soil surface uncovered due to flooding eliminating surface soil crusting on the upper bed where wheat was planted in bed planting the microclimate at the open field was also changed by orientation of the wheat plants in rows on top of the raised beds and created favourable soil conditions for mineralization of native as well as applied nutrients majeed et al 2015 the same findings were observed by mollah et al 2009 and hossain et al 2004 who found that planting of wheat on beds increased grain yield up to 21 over flat planting in the same trend majeed et al 2015 found that raised bed planting of wheat not only saves water but improves grain yield by 15 relative to flat planting significant differences were observed for the interaction between di and ps treatments averaged over both seasons highest values of biological yield 22 56 t ha 1 grain yield 7 40 t ha 1 and straw yield 15 0 t ha 1 were obtained with di0 combined with ps3 while sharp reductions in all previous traits were caused by di40 combined with ps1 as shown in table 6 3 5 irrigation crop water productivity i wp the effects of di ps and their interaction on i wp were significant for the average of two seasons table 6 data clearly showed that di significantly affected i wp the value of i wp for di20 treatment was higher than those for di40 and di0 treatments by 2 1 and 21 8 respectively table 6 these results are in agreement with those of abd el mageed et al 2016b abd el mageed and semida 2015a 2015b rady et al 2020a 2020b semida et al 2017 in general according to the results of various investigations lower water application provides higher i wp values abd el mageed et al 2020 rady et al 2020a 2020b li et al 2001 showed that limited irrigation in wheat during the growing season could significantly increase i wp abd el mageed et al 2018a 2018b and agami et al 2018 noted that the highest values of i wp for sorghum and wheat were recorded via low moisture conditions 60 of class a pan evaporation semida et al 2017 reported that the i wp of drip irrigated onion with lower water amounts 60 of etc crop was higher than for those irrigated with higher water amounts 120 100 and 80 of etc crop for planting systems the data clearly showed that ps2 and ps3 significantly improved i wp relative to flat planting ps1 ps2 and ps3 treatments increased i wp by 38 3 and 27 6 compared to that of ps1 respectively 4 conclusions in summary the results reported here confirmed that raised beds could be considered a potential planting system for improving wheat growth and productivity under water shortage a larger increase in photosynthetic efficiency stomatal conductance and consequently productivity was found under 60 cm raised beds and or 120 cm raised beds when compared to flat planting on average 120 cm raised beds under di20 saved 20 1050 m3 ha 1 water and resulted in 14 higher i wp compared to flat planting however further research is recommended to understand how raised beds under deficit irrigation would affect physico chemical properties and water productivity with various soil types declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the authors declare that they have no conﬂict of interest 
10299,irrigation water scarcity has now become one of the main constraints that influences global crop production the potential reduction in egypt s nile share and the current degree of deterioration of surface and ground water will certainly increase the severity of the water shortage problem in egypt raised bed planting systems under deficit irrigation could be a partial solution to compensate for the negative effect of water stress on wheat plants two field experiments were managed successively in 2016 17 and 2017 18 to study the influence of irrigation water levels at 100 di0 80 di20 and 60 di40 crop evapotranspiration etc and three different plantation systems flat planting ps1 60 cm raised beds ps2 and 120 cm raised beds ps3 on growth photosynthetic efficiency yield and irrigation crop water productivity i wp of wheat plants the results revealed that yield reduction caused by deficit irrigation can be remunerated by the raised bed planting method when averaged over both seasons the highest grain and straw yield of wheat plants was recorded under ps2 and ps3 compared with ps1 while there were no significant differences between ps2 and ps3 raised beds ps2 and ps3 combined with di0 followed by di20 significantly increased growth characteristics leaf chlorophyll contents and their efficiency stomatal conductance yield and its components compared with ps1 combined with di40 the highest value of i wp 1 61 and 1 54 kg m 3 was obtained under di20 combined with ps2 and ps3 respectively therefore under both land and water limiting conditions such as in the current egyptian situation raised beds could be considered a potential planting technique for improving the growth and productivity of wheat under deficit irrigation di20 by conserving 20 1050 m3 ha 1 of the water needed for wheat production keywords deficit irrigation growth and productivity photosynthetic efficiency raised beds wheat irrigation water use efficiency 1 introduction wheat is one of the world s three most meaningful cereal crops after maize and rice and occupies approximately 218 5 million hectares which is approximately 4 of the global area allocated for crop production with an average yield of 3 26 t ha 1 fao 2017 the crop is primarily grown for its grain which is consumed as human food and hay in animal food kiliç 2010 wheat is the first important cereal grain used as a staple food for millions of people in egypt where 1 35 million hectares were cultivated with total production of 8 8 million tons during 2016 17 fao 2017 wheat requirement is expected to increase by several folds during the next few decades thus the situation demands a sustainable increase in crop yield per unit area with scarce water resources water availability per unit irrigated area in mediterranean regions is declining because of water scarcity inefficient irrigation system poor maintenance and low crop water productivity abd el mageed et al 2017 badal et al 2013 el marsafawy et al 2018 deficit irrigation di is a type of irrigation management strategy in which water is applied below full crop water requirements abd el mageed et al 2016a fereres and soriano 2007 semida et al 2017 sun et al 2013 and it is a vital tool for enhancing water use efficiency in closely spaced crops such as wheat without causing severe yield reduction agami et al 2018 zhang et al 2005 according to pereira et al 2002 there is only a 13 reduction in wheat yield in response to water application up to 40 less than full potential crop water requirement wheat yield reduction through di can be alleviated by adopting different management techniques such as drought stress cultivars keyvan 2010 suitable sowing methods abbas et al 2009 maintaining fertility status sarma et al 2007 as well as mulching alamin et al 2017 the raised bed planting method is suitable for wheat cultivation and has proven to be one of the available options for saving water through attaining high water use efficiency sayre and hobbs 2004 raised bed cultivation is responsible for increasing wheat yield by 14 21 with 13 45 higher crop water productivity than traditional flatbed cultivation akbar et al 2009 raised bed wheat plantations improve yield increase fertilizer use efficiency reduce herbicide use and save seed as well hobbs et al 2002 deficit irrigation coupled with appropriate sowing methods can be a good option to save water scientists have experimentally tested these technologies individually kiliç 2010 liu et al 2005 soomro et al 2009 and combined el hadidi et al 2015 razaq et al 2019 zaman et al 2018 the objectives of the current experiments were i to determine if wheat planted on raised beds 60 and or 120 cm under deficit water will yield higher than flat planting and ii to determine if six rows seeded on raised beds 120 cm raised beds will yield more than three rows seeded 60 cm raised beds versus the same configurations 20 cm row to row distance in flat planting 2 methodology 2 1 experimental layout and growth conditions in two successive seasons 2016 17 si and 2017 18 sii trials were conducted at the experimental farm of the faculty of agriculture fayoum university 29 17 n 30 53 e southeast fayoum egypt data on the experimental area climate during si and sii seasons indicate that daily minimum temperatures ranged from 8 5 to 15 7 c in si and 8 5 15 5 c in sii while maximum temperatures ranged from 20 5 to 28 c in si and 20 5 28 3 c in sii wind speed ranged from 1 55 to 2 15 ms 1 in si and 1 65 2 21 ms 1 in sii the winter season had an evapotranspiration ranging between 1 5 and 4 0 mm d 1 in both seasons and rates of evaporation agree with temperatures i e the lowest evaporation rate 1 5 mm day 1 was documented in december and january and the highest value 4 mm day 1 was noted in march in both seasons table 1 total annual rainfalls are approx 7 5 mm year 1 mostly concentrated between december and march data from egyptian meteorological authority department 2017 abd elmabod et al 2019 healthy wheat grains triticum aestivum l cv misr 1 were carefully selected and sown on 18 and 25 november of the 2016 17 and 2017 18 seasons and harvested on 15 and 21 april of the 2016 17 and 2017 18 seasons respectively the experiments were conducted in a randomized complete block design split plot in three replicates using a surface irrigation system 3 irrigation water levels 100 di0 80 di20 and 60 di40 of crop evapotranspiration etc were applied and allocated to the main plots and three different plantation systems flat planting ps1 60 cm raised beds ps2 and 120 cm raised beds ps3 allocated to sub plots raised beds were installed parallel to one another using ridgers with a tractor for both 60 and 120 cm raised beds grains were planted manually in rows in both raised beds and by the conventional method for raised beds grains were planted in three and six rows according to the treatments on different width beds 60 and 120 cm respectively for the conventional method row to row distance was 20 cm as shown in fig 1 the total experimental area specified for each year was 594 m2 divided into 27 experimental plots of 20 m2 for each to protect against irrigation treatments effects 2 m was utilized to isolate the experimental units according to recommendations of the ministry of agriculture and land reclamation in egypt the investigated soil was supplemented with 62 kg p2o5 ha 1 400 kg calcium super phosphate 15 5 p2o5 200 kg n ha 1 600 kg ammonium nitrate 33 5 n and 72 kg k2o ha 1 150 kg potassium sulphate 48 k2o the etc mm d 1 was estimated according to the equation of allen et al 1998a 1998b etc kc epan kpan where kc crop coefficient the wheat crop coefficients of the initial mid and end stages were 0 30 1 15 and 0 4 respectively allen et al 1998a 1998b epan evaporation from the class a pan mm d 1 and kpan the pan evaporation coefficient 0 81 using one plastic pipe spile with a 2 inch diameter for each plot the applied volume of water was organized and conveyed to cover the whole plot to calculate the volume of water transferred through each pipe the equation of israelsen and hansen 1962 was used q ca 2 gh 10 3 where q is the discharge ls 1 c is the coefficient of discharge a is the area of pipe cm2 g is gravity acceleration cm s 2 and h is the effective head of water cm all other recommended agricultural disease and pest management practices were followed according to the recommendations of the ministry of agriculture and land reclamation 2 2 analyses of soil physico chemical properties were estimated by klute and dirksen 1986 and page et al 1982 and data are shown in table 2 physical and chemical characteristics of the soil as average for 0 60 cm depth were soil texture is sandy loam bulk density 1 48 kg m 3 hydraulic conductivity 2 04 cm h 1 water content at field capacity and wilting point 21 8 and 9 1 ph 7 60 1 2 5 soil water extract electrical conductivity soil paste extract 4 6 ds m 1 total carbonate 65 4 g kg 1 and organic c 6 7 g kg 1 according to the soil classification of dahnke and whitney 1988 the tested soil fell under the class of moderately saline 2 3 measurements of growth traits from each experimental plot 10 12 week old plants were randomly selected and carefully removed to measure plant height cm with a metre scale and to count numbers of tillers plant 1 and numbers of leaves plant 1 the shoot fresh weight fw of each plant was weighed and then dried at 70 c by an electric oven and the dry weight dw was recorded 2 4 assessments of leaf chlorophyll content chlorophyll a fluorescence stomatal conductance gs eight weeks after sowing 6 fully expanded leaves per treatment were randomly selected and carefully removed to measure leaf chlorophyll content and chlorophyll a fluorescence spad 502 minolta japan chlorophyll metre was used to assess leaf relative chlorophyll content on the 2 upper fully expanded leaves by using a portable handy pea fluorometer hansatech instruments ltd kings lynn uk chlorophyll fluorescence was determined on two different sunny days the maximum quantum yield of ps ii fv fm was described by maxwell and johnson 2000 fv f 0 reflects the efficiency of electron donation to the psii rcs and the rate of photosynthetic quantum conversion at psii rcs spoustová et al 2013 based on the similar absorption photosynthesis performance index pi was measured according to clark et al 2000 stomatal conductance gs was measured n 6 by a leaf porometer decagon devices inc pullman wa usa 2 5 yield characteristics and i wp at harvest 10 plants plot 1 were randomly selected and carefully removed to determine yield and its components number of spikes plant 1 number of grains spike 1 grains weight spike 1 g 1000 grains weight g and number of spikes m 2 were estimated in one square metre from each plot all plants of each plot were removed to estimate biological yield t ha 1 straw yield t ha 1 and grain yield t ha 1 and i wp kg m 3 as mentioned by fernández et al 2020 of the wheat crop was calculated after harvest jensen 1983 i wp grain yield kg ha 1 water applied m 3 ha 1 2 6 statistical analysis combined analysis of variance appropriate to the split plot in randomized complete block design rcbd was carried out using the genstat statistical package version 12 vsn international ltd oxford uk differences between means were compared using duncan s multiple range test at the 5 level p 0 05 3 results and discussion 3 1 growth characteristics as shown in table 3 growth characteristics e g plant height number of tillers plant 1 number of leaves plant 1 shoot fresh and dry weight plant 1 g were significantly affected by deficit irrigation di planting system ps and their interaction the simple effect of seasons was statistically significant only for shoot fresh and dry weight plant 1 shoot fresh and dry weights plant 1 were 39 33 and 17 32 respectively and were higher in the second season than the first season di substantially inhibited the growth of wheat plants as evaluated by plant height tillers and leaves number plant 1 shoot fresh and dry weight plant 1 table 3 plants grown under di0 showed enhanced growth characteristics over both seasons by 23 6 17 5 29 2 39 1 and 27 5 when compared to di40 respectively many earlier studies abd el mageed et al 2017 leach 1980 rady et al 2020a 2020b semida et al 2020 have shown that the total resistance at the soil plant system increases with diminishing soil water potential which causes a shortage of photosynthesis and growth the data clearly showed that raised bed planting systems ps2 and ps3 significantly improved different growth traits relative to flat planting ps1 however there were no significant differences between ps2 and ps3 for plant height shoot fresh and dry weight plant 1 ps3 significantly increased the above growth characteristics by 6 4 79 1 83 5 73 1 and 35 3 for the average of both seasons compared to ps1 these increases in growth parameters under ps2 and ps3 might be due to the improvement of water distribution and efficiency handling nutrients controlling weeds and other pests easily and increased light infiltrating the canopy all which resulted in stronger plants hobbs et al 2002 sayre and hobbs 2004 for combined treatments maximum values of plant height leaves number plant 1 and shoot fresh weight plant 1 were obtained with di0 under ps3 and maximum values of tillers number plant 1 and shoot dry weight plant 1 were obtained with di0 under ps2 on the other hand a sharp reduction in all growth characteristics was found under the combination of di40 x ps1 except the lowest number of tillers plant 1 was found under the combination of di20 x ps1 as shown in table 3 this might be due to the raised bed planting system which contributes significantly to the improvement of water distribution and efficiency additionally raised beds decreased the occurrence of some wheat diseases and this was interpreted as the reduction in canopy humidity is helpful to reducing disease stress and promoting healthy wheat growth sayre and hobbs 2004 shah et al 2013 3 2 photosynthetic efficiency and stomatal conductance average values over both seasons of photosynthetic efficiency determination i e fv fm and fv f 0 pi spad value and gs were affected significantly p 0 05 or insignificantly by di ps and their interaction as presented in table 4 di40 showed decreases in fv fm fv f 0 pi spad value and gs measurements plants under di40 decreased fv fm by 2 5 fv f 0 by 7 5 pi by 19 5 spad values by 24 8 and gs by 63 7 compared to di0 this lowering can be attributed to the drought induced limitation of photosynthesis owing to the exposure of plants to excess energy which if not dissipated safely can be harmful to psii due to over reaction centres abd el mageed et al 2018a 2018b abd el mageed and semida 2015a 2015b demmig adams and adams 1992 and improved production of reactive oxygen species in the chloroplasts smirnoff 1993 additionally water shortage during growth stage causes accelerated leaf senescence oxidative damage to photo assimilatory machinery and assimilates translocation which leads to a deficiency of photosynthetic efficiency and stomatal conductance plants under ps2 and ps3 give maximum photosynthetic efficiency values i e fv fm fv f0 and pi spad values and gs compared to ps1 these findings are in agreement with those obtained by who reported that higher chlorophyll contents in leaves were observed in raised beds than in flat planting due to greater n uptake and use efficiency however there were no significant differences between ps2 and ps3 for spad values fv fm and pi for the interaction between di and ps treatments the highest values of fv fm and fv f 0 were obtained with di20 combined with ps3 while the highest values of spad were obtained under di0 combined with ps3 and the highest values of pi and gs were found under di0 combined with ps2 sharp reductions in photosynthetic efficiency and stomatal conductance were recorded under the combination of di40 x ps1 as presented in table 4 these results are consistent with the findings of ali et al 2007 who reported that water shortage during the critical growth stages flowering and grain filling stage of wheat can be alleviated by raised bed sowing systems to improve growth parameters photosynthetic efficiency and water use efficiency 3 3 yield attributes the effect of seasons was statistically insignificant in all yield attributes except 1000 grains weight the 1000 grains weight was significantly higher in the first season 45 79 g than that in second season 43 81 g table 5 all yield attributes e g number of spikes plant 1 number of grain spike 1 weight of grain spike 1 1000 grains weight and number of spikes m 2 were significantly affected by di ps and their interaction by decreasing the irrigation regime from d10 to di40 the average of number of spikes plant 1 number of grains spike 1 weight of grain spike 1 1000 grains weight and number of spikes m3 were reduced by 13 0 30 3 25 6 19 7 and 29 8 respectively the reason might be better seed germination under favourable moisture conditions less water stress and higher water use efficiency achieved at di0 and di20 these results are in agreement with kiliç 2010 lower wheat yield components under water stress conditions were observed due to strong water potential where plants require more energy for taking water from low moisture soil waraich et al 2010 data clearly showed that ps2 and ps3 significantly improved different yield attributes of wheat relative to flat planting ps1 ps3 increased these traits by 67 0 for number of spikes plant 1 20 0 for number of grains spike 1 24 5 for weight of grains spike 1 11 2 for 1000 grains weight and 30 8 for number of spikes m2 compared to those of ps1 on the average of both seasons respectively however there were no significant differences between ps2 and ps3 for yield attributes except for number of grains spike 1 this might be due to better sunlight penetration good environmental conditions for seed germination and higher water use efficiency under raised beds these results are consistent with the findings of özberk et al 2009 mollah et al 2009 tripathi et al 2005 alam et al 2007 who reported that bed planting showed significantly higher grain spikes than the flat planting method also reported that bed planting reduced plant height lodging and some disease incidences while increasing the grains per spike and grain weight additionally shah et al 2013 reported higher yield components of wheat in raised beds the interaction between di and ps shows a significant effect on yield attributes e g number of spikes plant 1 number of grains spike 1 weight of grains spike 1 1000 grains weight and number of spikes m2 maximum values of all yield attributes were obtained with di0 combined with ps3 expect 1000 grains weight was obtained under di0 combined with ps2 while sharp reductions in all yield attributes were observed under di40 combined with ps1 as shown in table 5 3 4 productivity the effects of di ps and their interaction on biological yield grain yield and straw yield of wheat were significant for the average of both seasons table 6 by increasing the irrigation regime from di0 to di40 the average of biological yield t ha 1 grain yield t ha 1 and straw yield t ha 1 were reduced by 62 0 49 9 and 55 8 respectively this reduction is a natural result of the decreases in growth characteristics e g leaves and tillers number plant 1 shoot dry weight plant 1 photosynthetic efficiency and stomatal conductance gs and yield attributes e g number of spikes plant 1 grain weight spike 1 and 1000 grains weight under di40 these results were in agreement with ali et al 2007 who found that the highest grain yield was obtained with no deficit treatment similar results were also found by tari 2016 who observed that water deficit irrigation significantly decreased the wheat yield the heaviest averages of biological yield grain yield and straw yield were obtained by ps2 and ps3 ps3 increased biological yield by 26 4 grain yield by 29 1 and straw yield by 29 9 compared to ps1 however there were no significant differences between ps2 and ps3 for biological yield grain yield and straw yield as well as i wp these increases in wheat yield under raised bed planting might be due to the deposition of more fertile topsoil on raised beds in a raised bed planting system weeds were concentrated the most in furrows due to the shortage of crop cover there which facilitates the control of weeds additionally the raised bed planting system changed the land configuration which causes higher moisture content which in turn causes increased growth characteristics and yield components of wheat raised bed planting also reduced the soil surface uncovered due to flooding eliminating surface soil crusting on the upper bed where wheat was planted in bed planting the microclimate at the open field was also changed by orientation of the wheat plants in rows on top of the raised beds and created favourable soil conditions for mineralization of native as well as applied nutrients majeed et al 2015 the same findings were observed by mollah et al 2009 and hossain et al 2004 who found that planting of wheat on beds increased grain yield up to 21 over flat planting in the same trend majeed et al 2015 found that raised bed planting of wheat not only saves water but improves grain yield by 15 relative to flat planting significant differences were observed for the interaction between di and ps treatments averaged over both seasons highest values of biological yield 22 56 t ha 1 grain yield 7 40 t ha 1 and straw yield 15 0 t ha 1 were obtained with di0 combined with ps3 while sharp reductions in all previous traits were caused by di40 combined with ps1 as shown in table 6 3 5 irrigation crop water productivity i wp the effects of di ps and their interaction on i wp were significant for the average of two seasons table 6 data clearly showed that di significantly affected i wp the value of i wp for di20 treatment was higher than those for di40 and di0 treatments by 2 1 and 21 8 respectively table 6 these results are in agreement with those of abd el mageed et al 2016b abd el mageed and semida 2015a 2015b rady et al 2020a 2020b semida et al 2017 in general according to the results of various investigations lower water application provides higher i wp values abd el mageed et al 2020 rady et al 2020a 2020b li et al 2001 showed that limited irrigation in wheat during the growing season could significantly increase i wp abd el mageed et al 2018a 2018b and agami et al 2018 noted that the highest values of i wp for sorghum and wheat were recorded via low moisture conditions 60 of class a pan evaporation semida et al 2017 reported that the i wp of drip irrigated onion with lower water amounts 60 of etc crop was higher than for those irrigated with higher water amounts 120 100 and 80 of etc crop for planting systems the data clearly showed that ps2 and ps3 significantly improved i wp relative to flat planting ps1 ps2 and ps3 treatments increased i wp by 38 3 and 27 6 compared to that of ps1 respectively 4 conclusions in summary the results reported here confirmed that raised beds could be considered a potential planting system for improving wheat growth and productivity under water shortage a larger increase in photosynthetic efficiency stomatal conductance and consequently productivity was found under 60 cm raised beds and or 120 cm raised beds when compared to flat planting on average 120 cm raised beds under di20 saved 20 1050 m3 ha 1 water and resulted in 14 higher i wp compared to flat planting however further research is recommended to understand how raised beds under deficit irrigation would affect physico chemical properties and water productivity with various soil types declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper the authors declare that they have no conﬂict of interest 
