index,text
22515,given the growing availability of directional spectra of ocean waves we explore two different statistical approaches to mine large spectra databases spectral partitions statistics sps and self organizing maps som the first method is not new in the literature while the second one is for the first time here applied to directional wave spectra the main goal is to improve the characterization of the directional wave climate at a site providing a more complete and consistent description than that obtained from traditional statistical methods based on integral spectral parameters e g h s t m θ m indeed while the use of integral parameters allows a direct application of standard techniques for statistical analysis important information related to the physics of the processes may be overlooked e g the presence of multiple wave systems for instance locally and remotely generated the two proposed methods do not exclude integral parameters analysis but they further allow accounting for different events e g with different genesis independently although sps and som are equally valid for both numerical model and observational data we illustrate their potential using a 37 year long 1979 2015 model dataset of directional wave spectra at a study site in the western mediterranean sea we show that standard integral parameters fail to show the complex and even multimodal conditions at this site that are otherwise revealed by the directional spectra statistical analysis although the processing pathways and the resulting indicators of both sps and som are substantially different we observe that their results are mutually consistent and provide a better insight into the physical processes at work keywords ocean waves directional spectrum spectral partitioning self organizing maps wave statistical analysis 1 introduction the description of ocean waves by integral spectral parameters is the standard for most engineering and scientific applications the main reason is historical as waves have been described from the onset by their basic although stochastic parameters like significant wave height mean period and mean direction which are typically analyzed using standard statistical methods some of these methods have been adapted from other fields of science like hydrology or meteorology examples are time series analysis extreme value theory and wind roses to characterize wind vectors see for instance ochi 1978 ochi 2005 and holthuijsen 2007 however even from a single look at the sea surface it is evident that its behavior is not one dimensional 1d time but actually three dimensional 3d space time the first numerical wave prediction models were 1d simply because the necessary tools were not yet developed it was the concept of the wave spectrum pierson and marks 1952 particularly in the frequency direction domain which allowed to move towards the directional description of waves then incorporated in numerical prediction models and progressively but more slowly the development of measuring techniques to estimate the directional spectrum e g wave poles three axis accelerometers radar mapping sar and stereo imagery the advantage of spectral analysis over the ones based on average integral parameters is that the wave spectrum contains a very rich amount of information as it represents the full energy distribution over the frequency direction domain for instance the principle of wave superposition inherent to the spectrum allows us to visualize different wave trains and to say something about their origin e g portilla yandún et al 2015 in the last two decades thanks to the developments in computing technology meteorological centers apart from their standard forecasting services have started to produce long historical databases of wave spectral data e g the era interim and era 5 datasets by the european centre for medium range weather forecasts dee et al 2011 copernicus climate change service c3s 2017 in addition measuring techniques to estimate the directional spectrum have also become more reliable and accessible and in the last decade the number of directional measuring buoys has increased significantly in number and coverage see e g jcomm 2019 another massive source of wave spectral data is provided by satellites in particular the synthetic aperture radars on board the ers1 ers2 envisat sentinel cfosat missions ardhuin et al 2015 all these new technologies require the parallel development of new approaches and techniques for the statistical description of the directional wave spectra this is relevant for practical and scientific applications because it relates to the accuracy of estimates and projections e g in engineering design navigation climate analysis integral parameters do provide a good description of wave characteristics but only under basic unimodal conditions i e single peaked spectrum however in general the wave spectrum is made of two or more wave systems reflecting the dynamical behavior of the atmospheric forcing appearing as wind sea and swell in these conditions integral parameters start to lose significantly their meaning and whereas the significant wave height is not a very sensitive parameter others like the mean period and mean direction can be heavily affected the reason is that period and direction correspond to vector means related to the two coordinate variables of the directional wave spectrum namely frequency and direction in this paper we explore the applicability of two methods for the statistical analysis of directional wave spectra spectral partitions statistics sps and self organizing maps som the first one involves the physical identification of main wave features followed by their statistical characterization this methodology has already been presented and applied in other studies portilla et al 2009 portilla yandún et al 2015 2016 the second one derives from and it is based on neural network techniques kohonen 2001 this methodology has been previously applied in wave climate studies using spatial data based on integral parameters barbariol et al 2016 camus et al 2011a but it is here applied for the first time for directional wave spectra processing in the present paper the aim is to contribute to the statistical analysis of ocean waves based upon the frequency direction spectrum considering that this is the modern standard variable for statistical wave description including numerical modeling and observations we present the outcome of these two techniques highlighting their strengths and advantages with respect to standard types of analyses based on integral parameters our scope here is to illustrate the benefit of different types of spectral analysis which may open the door to a better understanding of the wave physical processes and contribute to several marine related applications e g structural design operations planning coastal engineering the paper is structured as follows in section 2 we first introduce the working dataset and give a brief overview of the climate conditions at the study site we then specify the methodology starting with the typical representation of waves according to standard statistical analysis based on integral parameters in this section we also present the theoretical basis of both sps and som in section 3 we present the main results from the two approaches separately since the pathways and output formats of them are significantly different in section 4 we take advantage of some of their features that allow making a comparative analysis we assess for instance cross sea conditions and the time evolution of storms from the spectral point of view we summarize our results and conclusions in section 5 finally specific technical details of som are included in the appendix 2 materials and methods 2 1 dataset and study site to demonstrate the applicability of the proposed methodologies we use data from the era interim database henceforth ei from the european centre for medium range weather forecasts ecmwf 2011 model data has been favored here in order to facilitate the illustration because these spectra are homogeneous in format and continuous in time with long enough records for a robust statistical analysis nevertheless we point out that the methodologies presented here can be equally applied to observations including in situ or remotely sensed data the ei reanalysis comes from fully coupled atmosphere ocean wave land system covering the period from 1979 until 2019 see dee et al 2011 for details ei contains several atmospheric and oceanic parameters including directional wave spectral data which are derived from the wam model komen et al 1994 although not specifically at spectral level ei data have been extensively quality controlled and verified dee et al 2011 stopa and cheung 2014 the main limitation of ei is related to its spatial resolution about 1 from which not all the details of the atmospheric circulation affected by the local orography are expected to be captured nevertheless the meso scale phenomena driving the regional climate patterns are relatively well accounted for stopa and cheung 2014 the wave spectrum in ei is discretized in 30 frequencies ranging from 0 035 to 0 55 hz in geometric sequence and 24 equally spaced directions the time resolution is 6 h making a total of 54056 spectra per grid point in the period considered for the study 1979 2015 as a practical example a specific site in the western mediterranean sea has been chosen this site is interesting because the local wave conditions are significantly more complex than what is expected for an inner sea due to its geographical location within the mid latitude convective cells i e ferrel and hadley cells the mediterranean marks the limit between the southern warm and dry tropical conditions in africa and the relatively temperate and stormier zone of europe in addition the azores high pressure center in the atlantic strongly affects the dominant west to east atmospheric circulation driving the regional weather at synoptic scale the wave climate of the mediterranean sea has been the subject of extensive previous analyses e g ardhuin et al 2007 bertotti and cavaleri 2009 cavaleri et al 1991 so that a wealth of information is available for reference and comparison in terms of waves being an enclosed sea this area is in principle relatively simple with waves generated locally and excluding the possibility of remotely generated swells in such conditions the potential of spectral approaches can be better appreciated showing more details than the traditional approach based on integral parameters one example is the not so evident but possible occurrence of multiple wave systems the general meteorological conditions of the area are presented in fig 1 the left panel shows the reference area and study point in the right panel local wind statistics is provided in the form of a wind rose the convention used along this document for all directional data wind and waves is oceanographic i e showing flow direction as it can be seen the predominant winds are towards 120 and 150 corresponding to the so called mistral wind since waves are a direct effect of winds one may anticipate a similar condition for waves 2 2 standard statistical wave analysis the common description of waves is generally done using few integral parameters that account for their main properties e g significant wave height mean wave period and mean wave direction h s t m and θ m respectively for example fig 2 shows typical bi variate distributions the left panel shows a wave rose plot in which the emphasis is on the directional distribution of waves in combination with their energy h s θ m with the radial axis indicating the empirical frequency of occurrence consistent with the wind distribution fig 1 right panel waves in the se quadrant dominate the climate 52 of total occurrence these contain also the most severe sea states h s 4 m confined within the 120 150 sector se accounting for 35 of the total the other three sectors i e ne nw and sw account for the 19 17 and 12 respectively there too with severe sea states h s 3 m especially in the sw sector it should be noted that the details of the less recurrent hence apparently less relevant waves get shadowed in this representation in favor of the more recurrent ones as it will be shown later one of the advantages of the statistical analysis of directional spectra is the more insightful view of the wave conditions in all the directional sectors since for most applications not only the magnitude and direction of waves are important but also their period the right panel of fig 2 shows another typically used bi variate distribution combining h s and t m this representation is informative of the local relationship between these two parameters e g the wave steepness in this particular case we observe that the most frequent wave conditions are concentrated in the range t m 3 4 s and h s 0 5 1 0 m however heavy conditions with t m 9 s and h s 7 m can also be found for each wave period the upper limit of the distribution in the right panel is related to the physical limit of wave growth due to breaking determined by the wave steepness see e g holthuijsen 2007 the representation of waves by integral parameters provides a good level of understanding about the local wave conditions but shortcomings arise in many practical applications the most common are related to multi modal sea states users are often confronted with simultaneous wave systems with different characteristic frequency and direction and such situations are critical in harbor operations offshore engineering navigation structural design among others e g hegermiller et al 2017 kjeldsen 1991 whereas information about the presence of multi modal states is actually present in the wave spectrum by the computation of integral wave parameters that information is lost and cannot be recovered because the whole spectral distribution originally available has been encapsulated into these parameters therefore any insight related to the spectral structure e g multi modality requires returning to the original raw data however in practice this step is generally not trivial because most processing techniques and systems in place are designed to provide only integral parameters therefore new approaches and methodologies have to be implemented in order to facilitate the exploitation of the information contained in the wave spectrum 2 3 spectral partitions statistics sps a method for deriving spectral statistics using partitioning is described in portilla yandún et al 2015 this method is based on the principle of linear superposition of different wave trains inherent in the wave spectrum this is possible because a spectral partition is physically understood as a self consistent cluster of energy bins that represents an independent wave event with particular characteristics and meteorological genesis in general the wave spectrum may contain one wind driven wave system and as many swell partitions as the complexity of the local conditions allow in turn the wind sea condition may correspond to different stages of development e g young or old wind seas integral parameters of the individual clusters are much more meaningful than those calculated for the whole spectrum because the loss of consistency of total integral parameters e g h s t m θ m in multi modal spectra arises from the fact that these correspond to vector means of the energy components an important advantage of partitioning is that a substantial data reduction takes place while the essence of the spectral information is preserved the purpose of partitioning is thus to identify all the possible energy clusters within the spectrum in practice partitions can be found making an analogy of the wave spectrum with an image or alternatively with a 3d topographic relief both schemes have advantages and can also be combined for the partitioning step as such we rely here on the so called mountaineer scheme hasselmann et al 1996 this algorithm uses the analogy with a topographic relief in which the steepest ascent energy path from every point of the spectrum is followed and traced until a local peak is reached the collection of all the points associated to the same local peak constitutes a partition this scheme is described in detail in portilla et al 2009 in principle the solution for a real spectrum e g signed non planar non zero is unique however spectra can be subject to natural variability specially observed ones or other types of spurious features which cannot necessarily be considered as significant wave systems therefore a post processing step is usually needed to automatically assess what are the relevant features this is achieved through image processing tools using a filtering and thresholding sequence based on a smoothing filter see specific details in portilla yandún 2018a b once the whole spectral time series are decomposed in partitions these can be characterized by their specific attributes e g h s t m θ m in turn these attributes can be used to derive related spectral statistics the main purpose is to identify the most relevant long term spectral wave features therefore for a skillful descriptor we use the empirical distribution of partitions obtained as the collection of the peak coordinates f p θ p of each partition of the whole series this is simply an occurrence distribution in the original bivariate f θ domain see portilla yandún et al 2015 for details and the results of section 3 1 the long term wave systems are defined from the clusters of this occurrence distribution of partitions in practice this is carried out using the same partitioning algorithm as for a single energy spectrum in turn the physical interpretation is that waves with similar generation conditions correspond to similar spectral characteristics an advantage of this descriptor is the capability to reveal distinctly the different wave spectral features recently with the release of massive spectral data from the ei archive a global atlas containing wave spectral statistical indicators has been produced gloswac https www modemat epn edu ec nereo see portilla yandún 2018a for details the sps analysis presented here is derived from the output of this atlas 2 4 self organizing maps som the second approach is based on the so called self organizing maps som technique which is a neural network technique typically used for data mining purposes e g the classification of data vector quantization and projection the som technique kohonen 2001 has been applied in different fields of science including oceanography falcieri et al 2013 liu et al 2006 solidoro et al 2007 in previous wave studies som has been used to characterize ocean waves at specific locations at integral parameters level barbariol et al 2016 camus et al 2011a reguero et al 2013 typical local features emerge from the som outputs allowing portraying the wave climate originally represented by a huge number of h s t m θ m triplets from them som generates a reduced number of prototypes that represent classes of sea states with similar characteristics in addition the visualization capabilities of som allow displaying multiple integral peak parameters on a 2d lattice camus et al 2011a called map this is a feature that enables to project a multivariate dataset onto a lower dimensional space generally 2d which can be seen as a proxy of the original dataset the 2d som lattice is made of several elements called units and has a much smaller size than the input dataset a disadvantage of som relative to other clustering algorithms e g the maximum dissimilarity algorithm is the limitation for representing the boundaries of the original dataset i e extremes because the classification makes emphasis on the more recurrent conditions nevertheless other strategies can be applied to overcome this deficiency see barbariol et al 2016 camus et al 2011b data compression and classification in som is carried out by means of a competitive cooperative learning technique at each iteration the som units compete among themselves to be the best matching unit bmu i e the closest to the input data according to a prescribed metric competitive stage and they organize themselves due to lateral inhibition connections cooperative stage the classification metric is based on squared euclidean distances d i j between the input data s t i c and the som unit s u i c defined as d i j k 1 n s t i c k s u j c k 2 where t i refers to the i th spectrum c k to the vectorized spectral position f θ and u j to the j th map unit in general inputs have to be normalized to make them homogeneous and then de normalized to obtain the output the number of output bmus is chosen arbitrarily generally as a trade off between an accurate representation of the input dataset and a significant data reduction factor the more the bmus i e the smaller the reduction factor the better the representation the lateral inhibition among the map units is based upon the map topology using a neighboring function that expresses how much a bmu relates to its neighbors at each step of the learning process in this study the som technique is applied for the first time to directional wave spectra for this we make use of the open source som toolbox for matlab vesanto et al 2000 vatanen et al 2015 this toolbox encompasses several functions for pre processing som classification and post processing the som has been chosen as a 10 10 square lattice 100 prototypical spectra which after a preliminary analysis revealed as a good compromise between significant data compression and a fair representation of the input dataset the data reduction factor is about 540 the som lattice quality is typically assessed as the goodness of the map in representing the original dataset and in preserving the topology of the input dataset this is evaluated by means of error metrics see kohonen 2001 kohonen et al 2009 like the mean quantization error mqe the average euclidean data to bmu distance and the topographic error te the percentage of data that do not have first and second bmus adjacent in the map as there is not a consensus on the benchmark against which these error metrics have to be assessed e g mqe is case dependent varying with the normalization of data the dimension of the map and other factors here we have also used other metrics routinely used in geophysical sciences e g the 2d cross correlation coefficient and normalized root mean square error specific details about the som implementation and its quality assessment are included in the appendix 3 results in this section we present the results from the individual perspective of each of the proposed methodologies sps and som pointing out their advantages and limitations 3 1 spectral partitions statistics sps fig 3 shows the typical output of sps for representing the wave climate at a study site in this case at the mediterranean sea location of fig 1 the left panel shows the occurrence frequency distribution of all partitions found in the time series conveniently this distribution is derived and presented in the same spectral domain f θ as the input data the color scale third dimension indicates the number of partitions registered in every specific spectral bin as it can be observed partitions do not occur evenly over the whole spectral domain but tend to cluster naturally in specific sectors moreover these clusters are very well defined suggesting a strong relationship with the physical conditions at the reference site e g meteorological geographical therefore this distribution can be associated to the possible wave systems physically existing at the reference point a direct visual inspection suggests the presence of four clusters namely one in each quadrant in practice as mentioned before this detection is carried out automatically by applying the partitioning algorithm to this distribution black contours in fig 3 as it was a single spectrum following the oceanographic convention for the directions the wave system 1 sps1 flows to about 140 with characteristic frequencies from 0 1 to 0 2 hz sps2 flows to 330 sps3 flows to 40 with a secondary lobe at about 90 sps4 flows to 220 table 1 summarizes the situation including the traditional names of their corresponding driving winds this solution is probably not very intuitive at first look especially considering the expectations build from integral parameters right panel of fig 1 and left panel of fig 2 which suggest the dominance of the mistral condition se it is important to note that the identification of these systems simplifies enormously the analysis of spectral data because it implies that at the reference location wave conditions can be classified only in one of these four groups this principle traverses the concept of the sea state wind sea or swell which can be simply seen as one of the many attributes of a specific wave system indeed the specification of these four long term wave systems allows their individual characterization using for instance their respective typical integral parameters i e h s t m and θ m in fact these last two are already available in the occurrence distribution of fig 3 left panel and any other parameter can be readily obtained by processing the partitions time series since the significant wave height is usually a parameter of immediate interest for a comprehensive view of the local wave conditions fig 3 right panel includes the individual distributions of h s for each component and for the total spectra for the sake of conciseness this is given in a box plot format note that the total energy e and not h s corresponds to the sum of its components i e h s 4 e quite in agreement with the information provided by total integral parameters fig 1 in fig 3 right panel we observe that the mistral condition sps1 is the dominant system both in terms of mean values and also for extremes nevertheless the other wave systems particularly sps3 and sps4 can also have significant magnitudes from the meteorological perspective it is interesting to note that these four conditions are relatively well known having indeed ancient associated names sps1 mistral sps2 sirocco sps3 libeccio and sps4 grecale see table 1 as said before many characteristics of these wave systems can be determined from the original time series including their seasonal and inter annual variability however the scope here is to evaluate the skills of spectral statistical methods 3 2 self organizing maps som the main result of som is the classification of the sea states at the study site represented by a reduced number of the most typical conditions and presented in the form of a map in this case the map was defined as a 10 10 square grid comprising therefore 100 typical states however since such a large number of spectra cannot be easily displayed for an overview we have represented them in fig 4 through their main integral h s t m θ m and peak t p θ p parameters in that figure the inner color of each grid element indicates the magnitude of the significant wave height whose scale is displayed on the right the gradual change in magnitude color is a direct result of the principle of minimum distance inherent to som similar spectra are assigned to the same class bmu and similar classes are placed next to each other the outer color shows the frequency of occurrence scale on the left of each prototype with respect to the total in this representation the map contains information of the empirical probability distribution of the spectral parameters in addition each grid element includes four arrows each displayed with a different color gray black blue and green arrow direction represents respectively the mean direction and the peak direction of the primary secondary and tertiary wave systems the length of the arrows is proportional to the wave period the peaks of the prototypes have been detected using the algorithm of aguilera 2016 two thresholds have been set to keep only the most energetic peaks the secondary tertiary peak should have at least 10 the energy of the first second and should be clearly separated in direction at least 30 difference in order to compare the som results with the previous results left panels of figs 2 and 3 the conditions corresponding to each cartesian quadrant have been indicated in the map black line in fig 4 the mistral condition se appears here also as the dominant one taking 64 out of the 100 bmus and including the highest h s values also consistent with the sps results the grecale condition sw is the second most important followed by libeccio ne and then the sirocco condition nw with lower magnitudes and recurrence it is interesting to note that the map derived from 2d spectra fig 4 is different from the corresponding map derived from integral parameters e g h s t m θ m see for instance barbariol et al 2016 their fig 4 working with 2d spectra offers also the possibility of accounting for multi modal sea states which are directly visible in the map as grid elements with secondary and tertiary peaks arrows this will be discussed in more details in the next section further on a detailed inspection of fig 4 suggests that some of the prototypes of the map are redundant to some extent the mistral condition for instance contains several entries with similar characteristics that can be eventually regrouped and represented by a smaller number of prototypes note that this reduction cannot be done directly by imposing a smaller grid size of the map because this would eliminate the less recurrent but relevant conditions in favor of the more recurrent therefore this reduction has to be carried out in a post processing step to this end a maximum dissimilarity algorithm mda kennard and stone 1969 has been applied to the 100 prototypes initially found mda uses the same principles of som based on squared euclidean distances to detect the most dissimilar conditions this results in the 8 prototypes shown in fig 5 which is a very compact representation of the 54056 original spectra to improve visualization the spectra shown in fig 5 have been normalized with respect to their peaks in addition the 1d spectra shown in fig 5 projected onto frequency and direction respectively contain information about how the prototypes relate to the represented spectra the blue lines correspond to the prototypes while the black lines correspond to the mean of the represented spectra with the gray regions showing the standard deviation in general there is a fair agreement particularly in the directional distributions on the other hand there are significant differences between the 1d frequency spectra this is mainly related to the inclusion of the calm conditions h s 1 0 m in the processing it is worth noting that within the 8 prototypes we can observe 4 unimodal conditions upper panels in fig 5 one for each quadrant in agreement with the results obtained from sps fig 3 as expected the most common and energetic condition is mistral with 30 6 of the cases and representative average h s 2 10 m libeccio ne represents 13 9 of the cases with h s 1 20 m grecale contains 4 4 frequency of the cases with h s 1 64 m sirocco nw is relatively recurrent 11 7 albeit with mild values h s 0 85 m in addition we detect 4 bimodal conditions lower panels in fig 5 of which the combination mistral libeccio is relatively recurrent 22 5 albeit with relatively low magnitudes h s 0 48 m other combinations are less frequent with relatively mild magnitudes h s about 1 m therefore the som approach directly indicates the existence of waves in all quadrants of the spectral domain including bi modal states these results are qualitatively consistent with those obtained with sps both providing a better insight into the spectral structure in any case the spectral and standard approaches lead to consistent results indeed comparing fig 2 with figs 3 and 4 it is clear that all the methods agree in some parameters for instance the dominant wave propagation direction is se with recurrence of about 52 according to std and sps and 50 for som for the three methods this is also the quadrant where the most severe sea states occur this consistency of som with std and sps is visible also in the other quadrants ne 16 vs 19 sw 8 vs 12 nw 26 vs 17 4 analysis in the previous section the main overall results of the two spectral methods have been outlined independently in general both methods offer a deeper understanding of the spectral wave conditions from different perspectives showing an overall qualitative consistency in this section we show that these methodologies can be further exploited depending on the specific application of interest in addition we note that due to the different steps of these methodologies and their output formats sps and som cannot be always directly compared but whenever a comparison is possible their consistency is confirmed for a comparative analysis we explore here two possible applications the first is related to the assessment of cross sea conditions section 4 1 and the second to the time evolution of complicated multi modal stormy situations section 4 2 4 1 cross sea conditions although not affected by long distance incoming swells as in the oceans still the strong and often rapid variations of the mediterranean weather may lead to locally complicated wave spectra involving cross seas these are notoriously dangerous to navigation with a large number of accidents reported in these conditions apart from the manoeuvring difficulties cross seas may be associated to a higher probability of rogue wave occurrence under certain conditions e g cavaleri et al 2012 for planning purposes avoiding navigation under such conditions is a matter of a cost and risk balance using integral parameters only this estimation becomes intricate and to some extent subjective because some metrics need to be defined among others in terms of the crossing angle and the magnitude of the individual events e g cavaleri et al 2012 li 2016 however only recently wave forecasting systems started providing related information but a long term statistics is hardly available in these cases there is advantage in using spectral approaches as seen in the previous section in som cross sea conditions result from the classification of the spectra and are readily visible from both the map and from the prototypes after mda indeed in fig 4 cross sea states can be identified by the presence of multiple arrows related to significant first secondary and tertiary peaks these are generally located in the transition zones between the different quadrants the map shows significant bi modality between mistral and grecale and between mistral and libeccio from fig 5 the prototypical cross sea spectra can be readily obtained in turn cross sea conditions are not standard output in sps but granted the availability of the individual series of the spectral wave components the crossing probability among them can be estimated from their joint occurrence probability given for instance their individual h s time series e g x and y p x y p y x p x where p y x is the conditional exceedance probability of y given x and p x is the marginal exceedance probability of x such equation can be applied to any pair of wave systems and for any h s threshold value for illustration we derive here the crossing probabilities of every pair of the sps components sps1 sps2 sps3 sps4 based on a threshold of 1 m the results obtained are presented in fig 6 in this figure both the horizontal and vertical axes indicate the wave system number the upper part of the grid diagonal indicates the probability in color while its corresponding numeric value can be read in the lower part as can be seen the largest value 0 88 corresponds to the pair sps1 sps4 mistral and grecale this accounts roughly for about 13 events per year the combination sps1 sps3 mistral and libeccio is also relatively frequent 0 66 followed by lower percentages of the other combinations this is qualitative consistent with the som results fig 4 we quantitatively compare these results with those from som in fig 5 this comparison requires however some previous considerations by default som looks for the most recurrent conditions and those naturally include calm conditions in turn the joint probability p x y derived from sps is based on a threshold e g 1 m for instance the combination sps1 sps4 mistral grecale results in 0 88 crossing fig 6 in som this combination is associated to the prototypes 7 and 8 fig 5 with together total recurrence of 12 8 and characteristic h s of 0 61 and 0 83 m a more equitable comparison is possible by post processing the som output via the mda algorithm for that we take only the sea states with total h s 1 41 m corresponding to two components with partial h s 1 0 m after this post processing the crossing level of mistral grecale becomes 0 68 thus very consistent with sps similarly the mistral libeccio pair produces a crossing level of 0 66 in sps sps1 sps3 this is related to prototype 6 in som fig 5 with recurrence of 22 5 and representative h s 0 48 m which after post processing becomes 0 68 and grecale sirocco prototype 5 at 4 0 with h s 0 97m becomes 0 59 while this corresponds to 0 22 in sps sps2 sps4 further insights in these crossing conditions can be derived for instance from fig 6 we observe that the cumulative crossing probability of any pair of wave systems at the given threshold h s 1 0 m is about 2 or 8 days per year on the other hand looking also at the time series we observe that the bimodal mistral grecale condition occurs mainly during the months of december and january accounting for about 50 of their total occurrence this shows that this condition is mainly active during a relatively narrow winter period similarly from som we estimate that about 39 of the total spectra are bimodal at any level this implies a high level of superposition including of course the lower magnitudes 4 2 insight into the storm evolution from wave spectra while a detailed analysis of the local meteorological conditions is out of the scope here it is instructive to analyze some specific events this will illustrate the possible complex conditions in the mediterranean sea showing that a comprehensive directional analysis is mandatory to understand the evolution of a wave field in this section we provide a compact description of three severe storms using the results of the standard statistics based on integral parameters and of the two proposed approaches based on directional wave spectra which are therefore inter compared note that for the sequence of storms we follow the principle of increasing complexity of the spectra for each storm to introduce the event we show first the meteorological evolution and then the wave evolution according to the different statistics however we could have done the opposite as well using the meteo fields to verify the results because as we will show the temporal meteorological evolution at a location is stored at least in the short to mid term scale in the directional wave spectra that we analyse using sps and som 4 2 1 storm of march 1993 a storm with mistral and grecale conditions sps1 sps4 occurred in march 1993 over the mediterranean sea region the evolution of the meteorological situation is shown in fig 7 a strong northerly mistral energetic wind reached the alps fig 7a on march 25th at 00 ut henceforth we will omit ut still intending ut time the wind field shows a slight anticyclonic behavior turning clockwise in the alboran sea twelve hours later at 12 fig 7b the air flow covers the alps and the appennines leading to a strong grecale wind in the ligurian sea north of corsica the storm condition is fully established on march 26th at 00 figs 7c and 12 fig 7d the wave evolution is framed in fig 8 summarizing the results of the three approaches 1 standard statistics based on integral parameters std 2 sps and 3 som the left panel upper plot displays the evolution of the total and partial h s and the evolution of the wave period and direction lower plot the right panel shows the instantaneous spectrum on march 26th at 12 from std it is only possible to infer a change in direction from mistral to grecale followed by a return to the original mistral contrarily sps and som give a much more detailed account mistral dominates the first part of the storm with a subsequent superposition of gracale this bimodal condition lasts for about two days imposing a very broad directional spectrum right panel 4 2 2 storm of january 1987 this is one of the most severe storms that affected the western mediterranean sea region leading to extensive damages all along the south westerly coasts of italy a detailed analysis is given in cavaleri et al 1991 on january 10th at 12 a deep low pressure system not shown entered the mediterranean sea through the gibraltar strait the associated and rapidly moving front leads to a sustained libeccio wind in most of the western mediterranean sea fig 9 a on january 10th at 18 panel b the front moves east and it is enhanced by a vigorous mistral which covers the whole western mediterranean sea on january 11th at 06 panel c at 18 panel d the mistral is still very strong moving progressively eastwards in fig 10 std shows that libeccio waves get quickly substituted by mistral waves at the peak of the storm see spectrum in fig 11 right panel in turn sps shows that a bimodal mistral libeccio condition develops see spectrum in fig 11 left panel with libeccio waves prevailing after a few more days the skill of som in this case is similar to that of integral parameter statistics with a rather abrupt transition between the two systems the growing stage of the storm until january 11th at 00 original spectrum in fig 11 left panel is represented by unimodal libeccio prototypes while the peak of the storm original spectrum in fig 11 right panel is represented by unimodal mistral prototypes this abrupt change is consistent with the two prototype clusters being very distant in the som lattice hence very different it is also worth noting that the peak of the storm is represented by prototype spectra significantly smaller than the actual one h s 5 53 m 4 2 3 storm of december 1979 the storm of december 1979 is also well known because it gave rise to the second historical flood of venice italy on december 21st at 12 fig 12a an energetic grecale wind is concentrated on most of the western part of the mediterranean sea this was part of a more general strong northerly flow disrupted by the complicated orography of the north side of the basin an atmospheric pressure minimum not shown develops over the mediterranean sea with a consequent sirocco wind west of sardinia on december 22nd at 00 panel b the minimum is fully developed leading to a very complicated situation involving cyclogenesis the minimum moves progressively to north east december 22nd at 06 panel c and finally at 18 panel d gets out of the reference area followed by a mild west to east flow fig 13 left panel shows that the time evolution and the complex wave conditions are well represented especially by sps the right panel shows the multi modal spectrum on december 22nd at 06 5 summary and conclusions in this paper we have presented two approaches for the statistical analysis of long time series of directional wave spectra namely spectral partitions statistics sps and self organizing maps som we have applied these methodologies to a 37 year long dataset of directional wave spectra derived from the era interim reanalysis the reference location in the mediterranean sea was chosen to show that even in enclosed seas complex wave conditions can be found therefore spectral methods are relevant even in supposedly simple basins naturally in the open ocean granted the presence of multiple swell systems we may say that spectral approaches are mandatory we can itemize our results as follows 1 given a dataset of directional spectra at a given location or in a specific area using sps and som it is possible to provide related extensive and exhaustive statistics which are consistent with the standard statistics based on integral parameters but much more informative as they explicitly operate in the frequency direction domain 2 the long term statistics produced by sps enable the identification of wave systems at a spot and their characterization using partial integral parameters at the study site in the mediterranean sea this has revealed regimes with 4 wave systems mistral libeccio grecale sirocco more complex than the one provided by the standard integral parameters which suggests the dominance of a single mistral wave system moreover we have shown that sps can help quantifying cross sea conditions for a given partial h s threshold and a very detailed interpretation of the storm evolution consistent with the analysis of the meteorological situation see for instance fig 13 left panel 3 the prototypical spectra produced by som enable the long term classification of the directional spectra at a spot this has allowed identifying both unimodal and multimodal spectra at the study site thus giving also indications about the occurrence of cross seas in particular som has the advantage of providing the spectral shape for the typical conditions also useful for a more detailed interpretation of storm evolution as well as for other applications that need directional spectrum as input e g coastal engineering analysis however we have shown that som might under represent the peaks as it is actually not designed to represent extremes but this limitation may be overcome by adopting ad hoc strategies to adapt it for the representation of extremes see for instance barbariol et al 2016 4 granted that sps and som provide by default different outputs i e formats and metrics we have shown that whenever their results can be directly or indirectly compared they are fully consistent this is even more the case when as possible one is adapted to specify the same kind of results as the other 5 while here we have demonstrated only some of the advantages and application of statistical analysis of directional spectra both sps and som can be used to provide statistics for other different applications these can concern e g growing sea conditions prolonged storms and extreme statistics acknowledgements j portilla acknowledges funding from project epn pij 1503 f barbariol was partially supported by the flagship project ritmare the italian research for the sea coordinated by the italian national research council and funded by the italian ministry of education university and research and by funds from the italian ministry of environment for the implementation of the marine strategy framework directive in italian waters convention 2015 in actuation of the d lgs 190 2010 the authors gratefully acknowledge francesco marcello falcieri for the fruitful discussions luciana bertotti has provided the graphics of the three storms appendix self organizing maps in this appendix we provide further details of the som implementation related to data pre processing and quality assessment data preparation before applying som directional spectra have to be pre processed to comply with the requirements of the som toolbox for matlab vesanto et al 2000 first too low energy spectra are rejected hs 5 cm this is about 0 1 of the total input spectra then the 30 24 spectral matrix is reshaped into a 720 1 array and all time series are collected into a single matrix that makes the som input normalization of the input data is not needed in this case as spectral components are homogeneous variables som setup som has been set up in order to project the 720 variate input dataset onto a 2d sheet map cylindrical and toroidal options are also available with rectangular lattice thus allowing each map node except those on the map boundaries to be connected to 4 other nodes the batch learning algorithm coupled with the linear initialization has been chosen to ensure repeatability i e the repetition of learning with same dataset and parameters leads to the same map kohonen et al 2009 the number of iterations has been set to 1000 som quality assessment quality of the map is related to its goodness in representing the input dataset this can be assessed by means of typical error metrics like the mean quantization error mqe given by the average squared euclidean distance data to bmu the topographic error te computed as the percentage of data which do not have adjacent first and second bmus in the map 2d cross correlation coefficient c c i m n s i f m θ n s s f m θ n s m n s i f m θ n s 2 m n s f m θ n s 2 where s m n s i f m θ n m n s m n s f m θ n m n m 1 m n 1 n root mean square difference n r m s d i m n s i f m θ n s f m θ n 2 m n s i f m θ n 100 expressed as a percentage hence normalized of the total spectral variance density for the map in fig 4 we obtained mqe 2 21 m2 s rad 1 and te 18 the mean values of cc i and nrmsd i are 0 79 and 0 34 respectively pointing out to a globally fair representation by the bmus their standard deviations 0 20 and 0 61 respectively indicate however a variation of the som original dataset agreement over the dataset in order to assess how this agreement varies over the map that is how well each prototype resembles the dataset spectra assigned to it we have also computed these error metrics for each j th bmu of the map fig 4 mean and standard deviation for each som unit are shown in fig a1 the best agreement is found for moderate severe unimodal mistral spectra mean cc above 0 9 mean nrmsd between 0 1 and 0 2 bottom part of the map in fig a1 which are recurrent and have well defined and simple spectral shapes the worst agreement is found for calm sea states mean cc around 0 4 0 8 mean nrmsd in the 0 3 1 1 range rows 1 2 column 3 5 in fig a1 which despite being very frequent states might have complex shapes calms also show the largest variance in cc and nrmsd in addition som tends to better represent frequent and moderate sea states with respect to extremes see for instance barbariol et al 2016 therefore the representation of calms which can be interpreted as lower bound extremes might be consequently affected fig a1 som quality assessment cc left panel and nrmsd right panel between the prototype spectra bmus and the spectra assigned to the bmus the color of the square represents the mean value of cc and nrmsd respectively the color of the inner circle represents their standard deviation fig a1 the agreement between the map and the original dataset can also be made in terms of integral parameters comparing the time series of the bmu integral parameters h s t m θ m with those of the original dataset h s t m θ m the statistical indicators in table a1 show that globally h s and t m are very precisely reproduced with cc close to 1 0 99 for h s 0 94 for t m small rmsd 0 17 m for h s 0 4 s for t m and no bias θ m is in general agreement with directional variance of residuals i e θ m θ m of 0 2 and directional bias of 1 1 the circular cc of 0 71 indicates that when applied to directional spectra som is less skillful in representing the evolution of directional spectral features this is probably related to the limitation of som in representing extremes for the same reason locally the highest h s and t m are represented by smaller values as demonstrated by the errors on the 99th percentiles in table a1 4 6 for h s and 0 9 for t m similarly the lowest h s and t m are represented by larger values with errors of 15 8 and 2 8 on the 10th percentiles of h s and t m respectively on the contrary errors on the 50th percentiles are significantly smaller 0 4 h s and 0 1 t m as θ is a circular variable directions close to 0 or 360 are interpreted as extreme values in the spectral space hence poorly represented luckily at the study site sea states propagating towards the north are also quite rare and mild therefore when relevant conditions are placed in the 0 sector a rotation should be applied table a1 som quality assessment statistical indicators of the agreement of map and original dataset in terms of integral parameters pearson s correlation coefficient cc root mean square difference rmsd bias and error on p th percentile δ x p x p x p x p 100 for h s and t m time series circular correlation coefficient ccc directional variance of residuals i e θ m θ m and directional bias for θ m time series directional variance of residuals ranges from 0 meaning no variation of residuals to 1 table a1 cc rmsd bias δx 10 δx 50 δx 99 h s 0 99 0 17 m 0 00 m 15 8 0 4 4 6 t m 0 94 0 4 s 0 0 s 2 8 0 1 0 9 ccc directional variance of residuals directional bias θ m 0 71 0 2 1 1 as a further check since the som prototypes are not necessarily spectra of the original dataset but correspond to subset centroids we have verified their consistency by assessing the high frequency tail of these omni directional centroid spectra we found that the high frequency tails of the som bmus generally follow a f 4 decay in the equilibrium range and f 5 at the highest frequencies in agreement with era i spectra and numerical model studies e g ardhuin et al 2010 som mda the maximum dissimilarity algorithm mda has been applied to the 100 som bmus to further isolate the 8 most dissimilar ones in terms of their spectral shape and according to maximum squared euclidean distance criterion see section 3 2 the result is shown in fig 5 the remaining 92 bmus have been assigned to the selected 8 prototypes on the basis of minimum euclidean distance criterion as shown in fig a2 unimodal bmus have been mostly assigned to unimodal prototypes 1 to 4 in fig 5 while bimodal bmus that are placed in between unimodal ones in fig 4 have been mostly assigned to bimodal prototypes 5 to 8 fig a2 som mda quality assessment map bmus assignment after mda the prototype number refers to the prototypes in fig 5 fig a2 
22515,given the growing availability of directional spectra of ocean waves we explore two different statistical approaches to mine large spectra databases spectral partitions statistics sps and self organizing maps som the first method is not new in the literature while the second one is for the first time here applied to directional wave spectra the main goal is to improve the characterization of the directional wave climate at a site providing a more complete and consistent description than that obtained from traditional statistical methods based on integral spectral parameters e g h s t m θ m indeed while the use of integral parameters allows a direct application of standard techniques for statistical analysis important information related to the physics of the processes may be overlooked e g the presence of multiple wave systems for instance locally and remotely generated the two proposed methods do not exclude integral parameters analysis but they further allow accounting for different events e g with different genesis independently although sps and som are equally valid for both numerical model and observational data we illustrate their potential using a 37 year long 1979 2015 model dataset of directional wave spectra at a study site in the western mediterranean sea we show that standard integral parameters fail to show the complex and even multimodal conditions at this site that are otherwise revealed by the directional spectra statistical analysis although the processing pathways and the resulting indicators of both sps and som are substantially different we observe that their results are mutually consistent and provide a better insight into the physical processes at work keywords ocean waves directional spectrum spectral partitioning self organizing maps wave statistical analysis 1 introduction the description of ocean waves by integral spectral parameters is the standard for most engineering and scientific applications the main reason is historical as waves have been described from the onset by their basic although stochastic parameters like significant wave height mean period and mean direction which are typically analyzed using standard statistical methods some of these methods have been adapted from other fields of science like hydrology or meteorology examples are time series analysis extreme value theory and wind roses to characterize wind vectors see for instance ochi 1978 ochi 2005 and holthuijsen 2007 however even from a single look at the sea surface it is evident that its behavior is not one dimensional 1d time but actually three dimensional 3d space time the first numerical wave prediction models were 1d simply because the necessary tools were not yet developed it was the concept of the wave spectrum pierson and marks 1952 particularly in the frequency direction domain which allowed to move towards the directional description of waves then incorporated in numerical prediction models and progressively but more slowly the development of measuring techniques to estimate the directional spectrum e g wave poles three axis accelerometers radar mapping sar and stereo imagery the advantage of spectral analysis over the ones based on average integral parameters is that the wave spectrum contains a very rich amount of information as it represents the full energy distribution over the frequency direction domain for instance the principle of wave superposition inherent to the spectrum allows us to visualize different wave trains and to say something about their origin e g portilla yandún et al 2015 in the last two decades thanks to the developments in computing technology meteorological centers apart from their standard forecasting services have started to produce long historical databases of wave spectral data e g the era interim and era 5 datasets by the european centre for medium range weather forecasts dee et al 2011 copernicus climate change service c3s 2017 in addition measuring techniques to estimate the directional spectrum have also become more reliable and accessible and in the last decade the number of directional measuring buoys has increased significantly in number and coverage see e g jcomm 2019 another massive source of wave spectral data is provided by satellites in particular the synthetic aperture radars on board the ers1 ers2 envisat sentinel cfosat missions ardhuin et al 2015 all these new technologies require the parallel development of new approaches and techniques for the statistical description of the directional wave spectra this is relevant for practical and scientific applications because it relates to the accuracy of estimates and projections e g in engineering design navigation climate analysis integral parameters do provide a good description of wave characteristics but only under basic unimodal conditions i e single peaked spectrum however in general the wave spectrum is made of two or more wave systems reflecting the dynamical behavior of the atmospheric forcing appearing as wind sea and swell in these conditions integral parameters start to lose significantly their meaning and whereas the significant wave height is not a very sensitive parameter others like the mean period and mean direction can be heavily affected the reason is that period and direction correspond to vector means related to the two coordinate variables of the directional wave spectrum namely frequency and direction in this paper we explore the applicability of two methods for the statistical analysis of directional wave spectra spectral partitions statistics sps and self organizing maps som the first one involves the physical identification of main wave features followed by their statistical characterization this methodology has already been presented and applied in other studies portilla et al 2009 portilla yandún et al 2015 2016 the second one derives from and it is based on neural network techniques kohonen 2001 this methodology has been previously applied in wave climate studies using spatial data based on integral parameters barbariol et al 2016 camus et al 2011a but it is here applied for the first time for directional wave spectra processing in the present paper the aim is to contribute to the statistical analysis of ocean waves based upon the frequency direction spectrum considering that this is the modern standard variable for statistical wave description including numerical modeling and observations we present the outcome of these two techniques highlighting their strengths and advantages with respect to standard types of analyses based on integral parameters our scope here is to illustrate the benefit of different types of spectral analysis which may open the door to a better understanding of the wave physical processes and contribute to several marine related applications e g structural design operations planning coastal engineering the paper is structured as follows in section 2 we first introduce the working dataset and give a brief overview of the climate conditions at the study site we then specify the methodology starting with the typical representation of waves according to standard statistical analysis based on integral parameters in this section we also present the theoretical basis of both sps and som in section 3 we present the main results from the two approaches separately since the pathways and output formats of them are significantly different in section 4 we take advantage of some of their features that allow making a comparative analysis we assess for instance cross sea conditions and the time evolution of storms from the spectral point of view we summarize our results and conclusions in section 5 finally specific technical details of som are included in the appendix 2 materials and methods 2 1 dataset and study site to demonstrate the applicability of the proposed methodologies we use data from the era interim database henceforth ei from the european centre for medium range weather forecasts ecmwf 2011 model data has been favored here in order to facilitate the illustration because these spectra are homogeneous in format and continuous in time with long enough records for a robust statistical analysis nevertheless we point out that the methodologies presented here can be equally applied to observations including in situ or remotely sensed data the ei reanalysis comes from fully coupled atmosphere ocean wave land system covering the period from 1979 until 2019 see dee et al 2011 for details ei contains several atmospheric and oceanic parameters including directional wave spectral data which are derived from the wam model komen et al 1994 although not specifically at spectral level ei data have been extensively quality controlled and verified dee et al 2011 stopa and cheung 2014 the main limitation of ei is related to its spatial resolution about 1 from which not all the details of the atmospheric circulation affected by the local orography are expected to be captured nevertheless the meso scale phenomena driving the regional climate patterns are relatively well accounted for stopa and cheung 2014 the wave spectrum in ei is discretized in 30 frequencies ranging from 0 035 to 0 55 hz in geometric sequence and 24 equally spaced directions the time resolution is 6 h making a total of 54056 spectra per grid point in the period considered for the study 1979 2015 as a practical example a specific site in the western mediterranean sea has been chosen this site is interesting because the local wave conditions are significantly more complex than what is expected for an inner sea due to its geographical location within the mid latitude convective cells i e ferrel and hadley cells the mediterranean marks the limit between the southern warm and dry tropical conditions in africa and the relatively temperate and stormier zone of europe in addition the azores high pressure center in the atlantic strongly affects the dominant west to east atmospheric circulation driving the regional weather at synoptic scale the wave climate of the mediterranean sea has been the subject of extensive previous analyses e g ardhuin et al 2007 bertotti and cavaleri 2009 cavaleri et al 1991 so that a wealth of information is available for reference and comparison in terms of waves being an enclosed sea this area is in principle relatively simple with waves generated locally and excluding the possibility of remotely generated swells in such conditions the potential of spectral approaches can be better appreciated showing more details than the traditional approach based on integral parameters one example is the not so evident but possible occurrence of multiple wave systems the general meteorological conditions of the area are presented in fig 1 the left panel shows the reference area and study point in the right panel local wind statistics is provided in the form of a wind rose the convention used along this document for all directional data wind and waves is oceanographic i e showing flow direction as it can be seen the predominant winds are towards 120 and 150 corresponding to the so called mistral wind since waves are a direct effect of winds one may anticipate a similar condition for waves 2 2 standard statistical wave analysis the common description of waves is generally done using few integral parameters that account for their main properties e g significant wave height mean wave period and mean wave direction h s t m and θ m respectively for example fig 2 shows typical bi variate distributions the left panel shows a wave rose plot in which the emphasis is on the directional distribution of waves in combination with their energy h s θ m with the radial axis indicating the empirical frequency of occurrence consistent with the wind distribution fig 1 right panel waves in the se quadrant dominate the climate 52 of total occurrence these contain also the most severe sea states h s 4 m confined within the 120 150 sector se accounting for 35 of the total the other three sectors i e ne nw and sw account for the 19 17 and 12 respectively there too with severe sea states h s 3 m especially in the sw sector it should be noted that the details of the less recurrent hence apparently less relevant waves get shadowed in this representation in favor of the more recurrent ones as it will be shown later one of the advantages of the statistical analysis of directional spectra is the more insightful view of the wave conditions in all the directional sectors since for most applications not only the magnitude and direction of waves are important but also their period the right panel of fig 2 shows another typically used bi variate distribution combining h s and t m this representation is informative of the local relationship between these two parameters e g the wave steepness in this particular case we observe that the most frequent wave conditions are concentrated in the range t m 3 4 s and h s 0 5 1 0 m however heavy conditions with t m 9 s and h s 7 m can also be found for each wave period the upper limit of the distribution in the right panel is related to the physical limit of wave growth due to breaking determined by the wave steepness see e g holthuijsen 2007 the representation of waves by integral parameters provides a good level of understanding about the local wave conditions but shortcomings arise in many practical applications the most common are related to multi modal sea states users are often confronted with simultaneous wave systems with different characteristic frequency and direction and such situations are critical in harbor operations offshore engineering navigation structural design among others e g hegermiller et al 2017 kjeldsen 1991 whereas information about the presence of multi modal states is actually present in the wave spectrum by the computation of integral wave parameters that information is lost and cannot be recovered because the whole spectral distribution originally available has been encapsulated into these parameters therefore any insight related to the spectral structure e g multi modality requires returning to the original raw data however in practice this step is generally not trivial because most processing techniques and systems in place are designed to provide only integral parameters therefore new approaches and methodologies have to be implemented in order to facilitate the exploitation of the information contained in the wave spectrum 2 3 spectral partitions statistics sps a method for deriving spectral statistics using partitioning is described in portilla yandún et al 2015 this method is based on the principle of linear superposition of different wave trains inherent in the wave spectrum this is possible because a spectral partition is physically understood as a self consistent cluster of energy bins that represents an independent wave event with particular characteristics and meteorological genesis in general the wave spectrum may contain one wind driven wave system and as many swell partitions as the complexity of the local conditions allow in turn the wind sea condition may correspond to different stages of development e g young or old wind seas integral parameters of the individual clusters are much more meaningful than those calculated for the whole spectrum because the loss of consistency of total integral parameters e g h s t m θ m in multi modal spectra arises from the fact that these correspond to vector means of the energy components an important advantage of partitioning is that a substantial data reduction takes place while the essence of the spectral information is preserved the purpose of partitioning is thus to identify all the possible energy clusters within the spectrum in practice partitions can be found making an analogy of the wave spectrum with an image or alternatively with a 3d topographic relief both schemes have advantages and can also be combined for the partitioning step as such we rely here on the so called mountaineer scheme hasselmann et al 1996 this algorithm uses the analogy with a topographic relief in which the steepest ascent energy path from every point of the spectrum is followed and traced until a local peak is reached the collection of all the points associated to the same local peak constitutes a partition this scheme is described in detail in portilla et al 2009 in principle the solution for a real spectrum e g signed non planar non zero is unique however spectra can be subject to natural variability specially observed ones or other types of spurious features which cannot necessarily be considered as significant wave systems therefore a post processing step is usually needed to automatically assess what are the relevant features this is achieved through image processing tools using a filtering and thresholding sequence based on a smoothing filter see specific details in portilla yandún 2018a b once the whole spectral time series are decomposed in partitions these can be characterized by their specific attributes e g h s t m θ m in turn these attributes can be used to derive related spectral statistics the main purpose is to identify the most relevant long term spectral wave features therefore for a skillful descriptor we use the empirical distribution of partitions obtained as the collection of the peak coordinates f p θ p of each partition of the whole series this is simply an occurrence distribution in the original bivariate f θ domain see portilla yandún et al 2015 for details and the results of section 3 1 the long term wave systems are defined from the clusters of this occurrence distribution of partitions in practice this is carried out using the same partitioning algorithm as for a single energy spectrum in turn the physical interpretation is that waves with similar generation conditions correspond to similar spectral characteristics an advantage of this descriptor is the capability to reveal distinctly the different wave spectral features recently with the release of massive spectral data from the ei archive a global atlas containing wave spectral statistical indicators has been produced gloswac https www modemat epn edu ec nereo see portilla yandún 2018a for details the sps analysis presented here is derived from the output of this atlas 2 4 self organizing maps som the second approach is based on the so called self organizing maps som technique which is a neural network technique typically used for data mining purposes e g the classification of data vector quantization and projection the som technique kohonen 2001 has been applied in different fields of science including oceanography falcieri et al 2013 liu et al 2006 solidoro et al 2007 in previous wave studies som has been used to characterize ocean waves at specific locations at integral parameters level barbariol et al 2016 camus et al 2011a reguero et al 2013 typical local features emerge from the som outputs allowing portraying the wave climate originally represented by a huge number of h s t m θ m triplets from them som generates a reduced number of prototypes that represent classes of sea states with similar characteristics in addition the visualization capabilities of som allow displaying multiple integral peak parameters on a 2d lattice camus et al 2011a called map this is a feature that enables to project a multivariate dataset onto a lower dimensional space generally 2d which can be seen as a proxy of the original dataset the 2d som lattice is made of several elements called units and has a much smaller size than the input dataset a disadvantage of som relative to other clustering algorithms e g the maximum dissimilarity algorithm is the limitation for representing the boundaries of the original dataset i e extremes because the classification makes emphasis on the more recurrent conditions nevertheless other strategies can be applied to overcome this deficiency see barbariol et al 2016 camus et al 2011b data compression and classification in som is carried out by means of a competitive cooperative learning technique at each iteration the som units compete among themselves to be the best matching unit bmu i e the closest to the input data according to a prescribed metric competitive stage and they organize themselves due to lateral inhibition connections cooperative stage the classification metric is based on squared euclidean distances d i j between the input data s t i c and the som unit s u i c defined as d i j k 1 n s t i c k s u j c k 2 where t i refers to the i th spectrum c k to the vectorized spectral position f θ and u j to the j th map unit in general inputs have to be normalized to make them homogeneous and then de normalized to obtain the output the number of output bmus is chosen arbitrarily generally as a trade off between an accurate representation of the input dataset and a significant data reduction factor the more the bmus i e the smaller the reduction factor the better the representation the lateral inhibition among the map units is based upon the map topology using a neighboring function that expresses how much a bmu relates to its neighbors at each step of the learning process in this study the som technique is applied for the first time to directional wave spectra for this we make use of the open source som toolbox for matlab vesanto et al 2000 vatanen et al 2015 this toolbox encompasses several functions for pre processing som classification and post processing the som has been chosen as a 10 10 square lattice 100 prototypical spectra which after a preliminary analysis revealed as a good compromise between significant data compression and a fair representation of the input dataset the data reduction factor is about 540 the som lattice quality is typically assessed as the goodness of the map in representing the original dataset and in preserving the topology of the input dataset this is evaluated by means of error metrics see kohonen 2001 kohonen et al 2009 like the mean quantization error mqe the average euclidean data to bmu distance and the topographic error te the percentage of data that do not have first and second bmus adjacent in the map as there is not a consensus on the benchmark against which these error metrics have to be assessed e g mqe is case dependent varying with the normalization of data the dimension of the map and other factors here we have also used other metrics routinely used in geophysical sciences e g the 2d cross correlation coefficient and normalized root mean square error specific details about the som implementation and its quality assessment are included in the appendix 3 results in this section we present the results from the individual perspective of each of the proposed methodologies sps and som pointing out their advantages and limitations 3 1 spectral partitions statistics sps fig 3 shows the typical output of sps for representing the wave climate at a study site in this case at the mediterranean sea location of fig 1 the left panel shows the occurrence frequency distribution of all partitions found in the time series conveniently this distribution is derived and presented in the same spectral domain f θ as the input data the color scale third dimension indicates the number of partitions registered in every specific spectral bin as it can be observed partitions do not occur evenly over the whole spectral domain but tend to cluster naturally in specific sectors moreover these clusters are very well defined suggesting a strong relationship with the physical conditions at the reference site e g meteorological geographical therefore this distribution can be associated to the possible wave systems physically existing at the reference point a direct visual inspection suggests the presence of four clusters namely one in each quadrant in practice as mentioned before this detection is carried out automatically by applying the partitioning algorithm to this distribution black contours in fig 3 as it was a single spectrum following the oceanographic convention for the directions the wave system 1 sps1 flows to about 140 with characteristic frequencies from 0 1 to 0 2 hz sps2 flows to 330 sps3 flows to 40 with a secondary lobe at about 90 sps4 flows to 220 table 1 summarizes the situation including the traditional names of their corresponding driving winds this solution is probably not very intuitive at first look especially considering the expectations build from integral parameters right panel of fig 1 and left panel of fig 2 which suggest the dominance of the mistral condition se it is important to note that the identification of these systems simplifies enormously the analysis of spectral data because it implies that at the reference location wave conditions can be classified only in one of these four groups this principle traverses the concept of the sea state wind sea or swell which can be simply seen as one of the many attributes of a specific wave system indeed the specification of these four long term wave systems allows their individual characterization using for instance their respective typical integral parameters i e h s t m and θ m in fact these last two are already available in the occurrence distribution of fig 3 left panel and any other parameter can be readily obtained by processing the partitions time series since the significant wave height is usually a parameter of immediate interest for a comprehensive view of the local wave conditions fig 3 right panel includes the individual distributions of h s for each component and for the total spectra for the sake of conciseness this is given in a box plot format note that the total energy e and not h s corresponds to the sum of its components i e h s 4 e quite in agreement with the information provided by total integral parameters fig 1 in fig 3 right panel we observe that the mistral condition sps1 is the dominant system both in terms of mean values and also for extremes nevertheless the other wave systems particularly sps3 and sps4 can also have significant magnitudes from the meteorological perspective it is interesting to note that these four conditions are relatively well known having indeed ancient associated names sps1 mistral sps2 sirocco sps3 libeccio and sps4 grecale see table 1 as said before many characteristics of these wave systems can be determined from the original time series including their seasonal and inter annual variability however the scope here is to evaluate the skills of spectral statistical methods 3 2 self organizing maps som the main result of som is the classification of the sea states at the study site represented by a reduced number of the most typical conditions and presented in the form of a map in this case the map was defined as a 10 10 square grid comprising therefore 100 typical states however since such a large number of spectra cannot be easily displayed for an overview we have represented them in fig 4 through their main integral h s t m θ m and peak t p θ p parameters in that figure the inner color of each grid element indicates the magnitude of the significant wave height whose scale is displayed on the right the gradual change in magnitude color is a direct result of the principle of minimum distance inherent to som similar spectra are assigned to the same class bmu and similar classes are placed next to each other the outer color shows the frequency of occurrence scale on the left of each prototype with respect to the total in this representation the map contains information of the empirical probability distribution of the spectral parameters in addition each grid element includes four arrows each displayed with a different color gray black blue and green arrow direction represents respectively the mean direction and the peak direction of the primary secondary and tertiary wave systems the length of the arrows is proportional to the wave period the peaks of the prototypes have been detected using the algorithm of aguilera 2016 two thresholds have been set to keep only the most energetic peaks the secondary tertiary peak should have at least 10 the energy of the first second and should be clearly separated in direction at least 30 difference in order to compare the som results with the previous results left panels of figs 2 and 3 the conditions corresponding to each cartesian quadrant have been indicated in the map black line in fig 4 the mistral condition se appears here also as the dominant one taking 64 out of the 100 bmus and including the highest h s values also consistent with the sps results the grecale condition sw is the second most important followed by libeccio ne and then the sirocco condition nw with lower magnitudes and recurrence it is interesting to note that the map derived from 2d spectra fig 4 is different from the corresponding map derived from integral parameters e g h s t m θ m see for instance barbariol et al 2016 their fig 4 working with 2d spectra offers also the possibility of accounting for multi modal sea states which are directly visible in the map as grid elements with secondary and tertiary peaks arrows this will be discussed in more details in the next section further on a detailed inspection of fig 4 suggests that some of the prototypes of the map are redundant to some extent the mistral condition for instance contains several entries with similar characteristics that can be eventually regrouped and represented by a smaller number of prototypes note that this reduction cannot be done directly by imposing a smaller grid size of the map because this would eliminate the less recurrent but relevant conditions in favor of the more recurrent therefore this reduction has to be carried out in a post processing step to this end a maximum dissimilarity algorithm mda kennard and stone 1969 has been applied to the 100 prototypes initially found mda uses the same principles of som based on squared euclidean distances to detect the most dissimilar conditions this results in the 8 prototypes shown in fig 5 which is a very compact representation of the 54056 original spectra to improve visualization the spectra shown in fig 5 have been normalized with respect to their peaks in addition the 1d spectra shown in fig 5 projected onto frequency and direction respectively contain information about how the prototypes relate to the represented spectra the blue lines correspond to the prototypes while the black lines correspond to the mean of the represented spectra with the gray regions showing the standard deviation in general there is a fair agreement particularly in the directional distributions on the other hand there are significant differences between the 1d frequency spectra this is mainly related to the inclusion of the calm conditions h s 1 0 m in the processing it is worth noting that within the 8 prototypes we can observe 4 unimodal conditions upper panels in fig 5 one for each quadrant in agreement with the results obtained from sps fig 3 as expected the most common and energetic condition is mistral with 30 6 of the cases and representative average h s 2 10 m libeccio ne represents 13 9 of the cases with h s 1 20 m grecale contains 4 4 frequency of the cases with h s 1 64 m sirocco nw is relatively recurrent 11 7 albeit with mild values h s 0 85 m in addition we detect 4 bimodal conditions lower panels in fig 5 of which the combination mistral libeccio is relatively recurrent 22 5 albeit with relatively low magnitudes h s 0 48 m other combinations are less frequent with relatively mild magnitudes h s about 1 m therefore the som approach directly indicates the existence of waves in all quadrants of the spectral domain including bi modal states these results are qualitatively consistent with those obtained with sps both providing a better insight into the spectral structure in any case the spectral and standard approaches lead to consistent results indeed comparing fig 2 with figs 3 and 4 it is clear that all the methods agree in some parameters for instance the dominant wave propagation direction is se with recurrence of about 52 according to std and sps and 50 for som for the three methods this is also the quadrant where the most severe sea states occur this consistency of som with std and sps is visible also in the other quadrants ne 16 vs 19 sw 8 vs 12 nw 26 vs 17 4 analysis in the previous section the main overall results of the two spectral methods have been outlined independently in general both methods offer a deeper understanding of the spectral wave conditions from different perspectives showing an overall qualitative consistency in this section we show that these methodologies can be further exploited depending on the specific application of interest in addition we note that due to the different steps of these methodologies and their output formats sps and som cannot be always directly compared but whenever a comparison is possible their consistency is confirmed for a comparative analysis we explore here two possible applications the first is related to the assessment of cross sea conditions section 4 1 and the second to the time evolution of complicated multi modal stormy situations section 4 2 4 1 cross sea conditions although not affected by long distance incoming swells as in the oceans still the strong and often rapid variations of the mediterranean weather may lead to locally complicated wave spectra involving cross seas these are notoriously dangerous to navigation with a large number of accidents reported in these conditions apart from the manoeuvring difficulties cross seas may be associated to a higher probability of rogue wave occurrence under certain conditions e g cavaleri et al 2012 for planning purposes avoiding navigation under such conditions is a matter of a cost and risk balance using integral parameters only this estimation becomes intricate and to some extent subjective because some metrics need to be defined among others in terms of the crossing angle and the magnitude of the individual events e g cavaleri et al 2012 li 2016 however only recently wave forecasting systems started providing related information but a long term statistics is hardly available in these cases there is advantage in using spectral approaches as seen in the previous section in som cross sea conditions result from the classification of the spectra and are readily visible from both the map and from the prototypes after mda indeed in fig 4 cross sea states can be identified by the presence of multiple arrows related to significant first secondary and tertiary peaks these are generally located in the transition zones between the different quadrants the map shows significant bi modality between mistral and grecale and between mistral and libeccio from fig 5 the prototypical cross sea spectra can be readily obtained in turn cross sea conditions are not standard output in sps but granted the availability of the individual series of the spectral wave components the crossing probability among them can be estimated from their joint occurrence probability given for instance their individual h s time series e g x and y p x y p y x p x where p y x is the conditional exceedance probability of y given x and p x is the marginal exceedance probability of x such equation can be applied to any pair of wave systems and for any h s threshold value for illustration we derive here the crossing probabilities of every pair of the sps components sps1 sps2 sps3 sps4 based on a threshold of 1 m the results obtained are presented in fig 6 in this figure both the horizontal and vertical axes indicate the wave system number the upper part of the grid diagonal indicates the probability in color while its corresponding numeric value can be read in the lower part as can be seen the largest value 0 88 corresponds to the pair sps1 sps4 mistral and grecale this accounts roughly for about 13 events per year the combination sps1 sps3 mistral and libeccio is also relatively frequent 0 66 followed by lower percentages of the other combinations this is qualitative consistent with the som results fig 4 we quantitatively compare these results with those from som in fig 5 this comparison requires however some previous considerations by default som looks for the most recurrent conditions and those naturally include calm conditions in turn the joint probability p x y derived from sps is based on a threshold e g 1 m for instance the combination sps1 sps4 mistral grecale results in 0 88 crossing fig 6 in som this combination is associated to the prototypes 7 and 8 fig 5 with together total recurrence of 12 8 and characteristic h s of 0 61 and 0 83 m a more equitable comparison is possible by post processing the som output via the mda algorithm for that we take only the sea states with total h s 1 41 m corresponding to two components with partial h s 1 0 m after this post processing the crossing level of mistral grecale becomes 0 68 thus very consistent with sps similarly the mistral libeccio pair produces a crossing level of 0 66 in sps sps1 sps3 this is related to prototype 6 in som fig 5 with recurrence of 22 5 and representative h s 0 48 m which after post processing becomes 0 68 and grecale sirocco prototype 5 at 4 0 with h s 0 97m becomes 0 59 while this corresponds to 0 22 in sps sps2 sps4 further insights in these crossing conditions can be derived for instance from fig 6 we observe that the cumulative crossing probability of any pair of wave systems at the given threshold h s 1 0 m is about 2 or 8 days per year on the other hand looking also at the time series we observe that the bimodal mistral grecale condition occurs mainly during the months of december and january accounting for about 50 of their total occurrence this shows that this condition is mainly active during a relatively narrow winter period similarly from som we estimate that about 39 of the total spectra are bimodal at any level this implies a high level of superposition including of course the lower magnitudes 4 2 insight into the storm evolution from wave spectra while a detailed analysis of the local meteorological conditions is out of the scope here it is instructive to analyze some specific events this will illustrate the possible complex conditions in the mediterranean sea showing that a comprehensive directional analysis is mandatory to understand the evolution of a wave field in this section we provide a compact description of three severe storms using the results of the standard statistics based on integral parameters and of the two proposed approaches based on directional wave spectra which are therefore inter compared note that for the sequence of storms we follow the principle of increasing complexity of the spectra for each storm to introduce the event we show first the meteorological evolution and then the wave evolution according to the different statistics however we could have done the opposite as well using the meteo fields to verify the results because as we will show the temporal meteorological evolution at a location is stored at least in the short to mid term scale in the directional wave spectra that we analyse using sps and som 4 2 1 storm of march 1993 a storm with mistral and grecale conditions sps1 sps4 occurred in march 1993 over the mediterranean sea region the evolution of the meteorological situation is shown in fig 7 a strong northerly mistral energetic wind reached the alps fig 7a on march 25th at 00 ut henceforth we will omit ut still intending ut time the wind field shows a slight anticyclonic behavior turning clockwise in the alboran sea twelve hours later at 12 fig 7b the air flow covers the alps and the appennines leading to a strong grecale wind in the ligurian sea north of corsica the storm condition is fully established on march 26th at 00 figs 7c and 12 fig 7d the wave evolution is framed in fig 8 summarizing the results of the three approaches 1 standard statistics based on integral parameters std 2 sps and 3 som the left panel upper plot displays the evolution of the total and partial h s and the evolution of the wave period and direction lower plot the right panel shows the instantaneous spectrum on march 26th at 12 from std it is only possible to infer a change in direction from mistral to grecale followed by a return to the original mistral contrarily sps and som give a much more detailed account mistral dominates the first part of the storm with a subsequent superposition of gracale this bimodal condition lasts for about two days imposing a very broad directional spectrum right panel 4 2 2 storm of january 1987 this is one of the most severe storms that affected the western mediterranean sea region leading to extensive damages all along the south westerly coasts of italy a detailed analysis is given in cavaleri et al 1991 on january 10th at 12 a deep low pressure system not shown entered the mediterranean sea through the gibraltar strait the associated and rapidly moving front leads to a sustained libeccio wind in most of the western mediterranean sea fig 9 a on january 10th at 18 panel b the front moves east and it is enhanced by a vigorous mistral which covers the whole western mediterranean sea on january 11th at 06 panel c at 18 panel d the mistral is still very strong moving progressively eastwards in fig 10 std shows that libeccio waves get quickly substituted by mistral waves at the peak of the storm see spectrum in fig 11 right panel in turn sps shows that a bimodal mistral libeccio condition develops see spectrum in fig 11 left panel with libeccio waves prevailing after a few more days the skill of som in this case is similar to that of integral parameter statistics with a rather abrupt transition between the two systems the growing stage of the storm until january 11th at 00 original spectrum in fig 11 left panel is represented by unimodal libeccio prototypes while the peak of the storm original spectrum in fig 11 right panel is represented by unimodal mistral prototypes this abrupt change is consistent with the two prototype clusters being very distant in the som lattice hence very different it is also worth noting that the peak of the storm is represented by prototype spectra significantly smaller than the actual one h s 5 53 m 4 2 3 storm of december 1979 the storm of december 1979 is also well known because it gave rise to the second historical flood of venice italy on december 21st at 12 fig 12a an energetic grecale wind is concentrated on most of the western part of the mediterranean sea this was part of a more general strong northerly flow disrupted by the complicated orography of the north side of the basin an atmospheric pressure minimum not shown develops over the mediterranean sea with a consequent sirocco wind west of sardinia on december 22nd at 00 panel b the minimum is fully developed leading to a very complicated situation involving cyclogenesis the minimum moves progressively to north east december 22nd at 06 panel c and finally at 18 panel d gets out of the reference area followed by a mild west to east flow fig 13 left panel shows that the time evolution and the complex wave conditions are well represented especially by sps the right panel shows the multi modal spectrum on december 22nd at 06 5 summary and conclusions in this paper we have presented two approaches for the statistical analysis of long time series of directional wave spectra namely spectral partitions statistics sps and self organizing maps som we have applied these methodologies to a 37 year long dataset of directional wave spectra derived from the era interim reanalysis the reference location in the mediterranean sea was chosen to show that even in enclosed seas complex wave conditions can be found therefore spectral methods are relevant even in supposedly simple basins naturally in the open ocean granted the presence of multiple swell systems we may say that spectral approaches are mandatory we can itemize our results as follows 1 given a dataset of directional spectra at a given location or in a specific area using sps and som it is possible to provide related extensive and exhaustive statistics which are consistent with the standard statistics based on integral parameters but much more informative as they explicitly operate in the frequency direction domain 2 the long term statistics produced by sps enable the identification of wave systems at a spot and their characterization using partial integral parameters at the study site in the mediterranean sea this has revealed regimes with 4 wave systems mistral libeccio grecale sirocco more complex than the one provided by the standard integral parameters which suggests the dominance of a single mistral wave system moreover we have shown that sps can help quantifying cross sea conditions for a given partial h s threshold and a very detailed interpretation of the storm evolution consistent with the analysis of the meteorological situation see for instance fig 13 left panel 3 the prototypical spectra produced by som enable the long term classification of the directional spectra at a spot this has allowed identifying both unimodal and multimodal spectra at the study site thus giving also indications about the occurrence of cross seas in particular som has the advantage of providing the spectral shape for the typical conditions also useful for a more detailed interpretation of storm evolution as well as for other applications that need directional spectrum as input e g coastal engineering analysis however we have shown that som might under represent the peaks as it is actually not designed to represent extremes but this limitation may be overcome by adopting ad hoc strategies to adapt it for the representation of extremes see for instance barbariol et al 2016 4 granted that sps and som provide by default different outputs i e formats and metrics we have shown that whenever their results can be directly or indirectly compared they are fully consistent this is even more the case when as possible one is adapted to specify the same kind of results as the other 5 while here we have demonstrated only some of the advantages and application of statistical analysis of directional spectra both sps and som can be used to provide statistics for other different applications these can concern e g growing sea conditions prolonged storms and extreme statistics acknowledgements j portilla acknowledges funding from project epn pij 1503 f barbariol was partially supported by the flagship project ritmare the italian research for the sea coordinated by the italian national research council and funded by the italian ministry of education university and research and by funds from the italian ministry of environment for the implementation of the marine strategy framework directive in italian waters convention 2015 in actuation of the d lgs 190 2010 the authors gratefully acknowledge francesco marcello falcieri for the fruitful discussions luciana bertotti has provided the graphics of the three storms appendix self organizing maps in this appendix we provide further details of the som implementation related to data pre processing and quality assessment data preparation before applying som directional spectra have to be pre processed to comply with the requirements of the som toolbox for matlab vesanto et al 2000 first too low energy spectra are rejected hs 5 cm this is about 0 1 of the total input spectra then the 30 24 spectral matrix is reshaped into a 720 1 array and all time series are collected into a single matrix that makes the som input normalization of the input data is not needed in this case as spectral components are homogeneous variables som setup som has been set up in order to project the 720 variate input dataset onto a 2d sheet map cylindrical and toroidal options are also available with rectangular lattice thus allowing each map node except those on the map boundaries to be connected to 4 other nodes the batch learning algorithm coupled with the linear initialization has been chosen to ensure repeatability i e the repetition of learning with same dataset and parameters leads to the same map kohonen et al 2009 the number of iterations has been set to 1000 som quality assessment quality of the map is related to its goodness in representing the input dataset this can be assessed by means of typical error metrics like the mean quantization error mqe given by the average squared euclidean distance data to bmu the topographic error te computed as the percentage of data which do not have adjacent first and second bmus in the map 2d cross correlation coefficient c c i m n s i f m θ n s s f m θ n s m n s i f m θ n s 2 m n s f m θ n s 2 where s m n s i f m θ n m n s m n s f m θ n m n m 1 m n 1 n root mean square difference n r m s d i m n s i f m θ n s f m θ n 2 m n s i f m θ n 100 expressed as a percentage hence normalized of the total spectral variance density for the map in fig 4 we obtained mqe 2 21 m2 s rad 1 and te 18 the mean values of cc i and nrmsd i are 0 79 and 0 34 respectively pointing out to a globally fair representation by the bmus their standard deviations 0 20 and 0 61 respectively indicate however a variation of the som original dataset agreement over the dataset in order to assess how this agreement varies over the map that is how well each prototype resembles the dataset spectra assigned to it we have also computed these error metrics for each j th bmu of the map fig 4 mean and standard deviation for each som unit are shown in fig a1 the best agreement is found for moderate severe unimodal mistral spectra mean cc above 0 9 mean nrmsd between 0 1 and 0 2 bottom part of the map in fig a1 which are recurrent and have well defined and simple spectral shapes the worst agreement is found for calm sea states mean cc around 0 4 0 8 mean nrmsd in the 0 3 1 1 range rows 1 2 column 3 5 in fig a1 which despite being very frequent states might have complex shapes calms also show the largest variance in cc and nrmsd in addition som tends to better represent frequent and moderate sea states with respect to extremes see for instance barbariol et al 2016 therefore the representation of calms which can be interpreted as lower bound extremes might be consequently affected fig a1 som quality assessment cc left panel and nrmsd right panel between the prototype spectra bmus and the spectra assigned to the bmus the color of the square represents the mean value of cc and nrmsd respectively the color of the inner circle represents their standard deviation fig a1 the agreement between the map and the original dataset can also be made in terms of integral parameters comparing the time series of the bmu integral parameters h s t m θ m with those of the original dataset h s t m θ m the statistical indicators in table a1 show that globally h s and t m are very precisely reproduced with cc close to 1 0 99 for h s 0 94 for t m small rmsd 0 17 m for h s 0 4 s for t m and no bias θ m is in general agreement with directional variance of residuals i e θ m θ m of 0 2 and directional bias of 1 1 the circular cc of 0 71 indicates that when applied to directional spectra som is less skillful in representing the evolution of directional spectral features this is probably related to the limitation of som in representing extremes for the same reason locally the highest h s and t m are represented by smaller values as demonstrated by the errors on the 99th percentiles in table a1 4 6 for h s and 0 9 for t m similarly the lowest h s and t m are represented by larger values with errors of 15 8 and 2 8 on the 10th percentiles of h s and t m respectively on the contrary errors on the 50th percentiles are significantly smaller 0 4 h s and 0 1 t m as θ is a circular variable directions close to 0 or 360 are interpreted as extreme values in the spectral space hence poorly represented luckily at the study site sea states propagating towards the north are also quite rare and mild therefore when relevant conditions are placed in the 0 sector a rotation should be applied table a1 som quality assessment statistical indicators of the agreement of map and original dataset in terms of integral parameters pearson s correlation coefficient cc root mean square difference rmsd bias and error on p th percentile δ x p x p x p x p 100 for h s and t m time series circular correlation coefficient ccc directional variance of residuals i e θ m θ m and directional bias for θ m time series directional variance of residuals ranges from 0 meaning no variation of residuals to 1 table a1 cc rmsd bias δx 10 δx 50 δx 99 h s 0 99 0 17 m 0 00 m 15 8 0 4 4 6 t m 0 94 0 4 s 0 0 s 2 8 0 1 0 9 ccc directional variance of residuals directional bias θ m 0 71 0 2 1 1 as a further check since the som prototypes are not necessarily spectra of the original dataset but correspond to subset centroids we have verified their consistency by assessing the high frequency tail of these omni directional centroid spectra we found that the high frequency tails of the som bmus generally follow a f 4 decay in the equilibrium range and f 5 at the highest frequencies in agreement with era i spectra and numerical model studies e g ardhuin et al 2010 som mda the maximum dissimilarity algorithm mda has been applied to the 100 som bmus to further isolate the 8 most dissimilar ones in terms of their spectral shape and according to maximum squared euclidean distance criterion see section 3 2 the result is shown in fig 5 the remaining 92 bmus have been assigned to the selected 8 prototypes on the basis of minimum euclidean distance criterion as shown in fig a2 unimodal bmus have been mostly assigned to unimodal prototypes 1 to 4 in fig 5 while bimodal bmus that are placed in between unimodal ones in fig 4 have been mostly assigned to bimodal prototypes 5 to 8 fig a2 som mda quality assessment map bmus assignment after mda the prototype number refers to the prototypes in fig 5 fig a2 
22516,under marine environment reinforced concrete structures are suffering from serious deterioration problems the sea water contains abundant contents of ion species including chlorides and the carbon dioxide exists in the air which could be exclusively high under industrial polluted condition both the chloride transport and carbonation could happen intrude through the concrete protection layer and trigger corrosion for the inside rebar during this process the mechanism of synergetic work of carbon dioxide chloride ions and moisture are investigated in the present study the carbonation process impacts the chloride transport by debounding while the pore structure will also change so that the transport characters vary for both the effects of crucial environmental parameters the temperature the relative humidity and the carbon dioxide concentration on the interaction of carbonation and chloride transport process are also scrutinized considering the existence of liquid in the pore phase this work principally examined the influence of unsaturated environment on the binary ingress process of chloride and carbonation keywords chloride penetration carbonation marine exposed concrete structure unsaturated 1 introduction under marine environment the concrete structures are exposed to complicated conditions as a porous material concrete faces the chloride transport coming from the sea and simultaneously the changing climate including temperature humidity and carbon dioxide chen and ho 2013 da silva et al 2009 jiang et al 2018 liu et al 2017a šavija et al 2013 song et al 2008 the chloride transport may cause problems for the durability of concrete structures leading to the corrosion of the rebar inside concrete feng et al 2016 liu et al 2018a she et al 2018a yan and lin 2008 yan et al 2009 this process is predictable and could be prevented according to existed research data kim et al 2016b liu et al 2014 mao et al 2019 during the transport process there is a significant phenomenon that the chloride ions adsorbed by the cement e g c3a forming the friedle s salt thus the further chloride transport could be retarded and this process is chloride binding arya et al 1990 chang et al 2019 jiang et al 2019 luping and nilsson 1993 yuan et al 2009 in the meantime the carbonation process is specially cared as once the carbonation front reaches the rebar the concrete internal alkalinity decreases greatly and the rebar will corrodes so that the reinforced concrete structure may fail šavija and luković 2016 carbon dioxide is unavoidable as it is everywhere in the air and as the climate change become more serious the content of carbon dioxide in the air is rising in the carbonation process the carbon dioide from the atmosphere could intrude into the concrete through the gas part of the pores together with the air differing with other gases carbon dioxide will react with some of the solid parts of cement and its hydration products e g ch c s h enlarging the solid phase chang and chen 2006 hou et al 2017 2018 2019 she et al 2018b wang et al 2017a 2017c yan et al 2016 yu et al 2017 with deeper intrusion the carbonation keeps happening and the speed of this intrusion is proved to be reducing because of the clogging caused by the increasing solid parts the concept of carbonation rate has been introduced to evaluate the corrosion depth of carbon dioxide geng et al 2016 it is noticeable however that the carbonation process has enormous impact on chloride transport as it may strengthen the ability of preventing chloride transport by decreasing the void volume or encourage the transport of chloride ions by releasing the bound chlorides from fridel s salt geng et al 2016 li et al 2018 the carbonation process could also be influenced by multiple influence of the environment bertolini et al 2013 iqbal et al 2020 it is worth to mention that the real porous concrete structure is encountering the unsaturated condition by seashore which will cause influence to the transport of both chlorides and carbon dioxide zhang et al 2012 from the environmental perspective the concrete facilities are constructed by the sea or half buried in the sea and the most critical point for avoiding corrosion is at the boundry between the air and the water that is the sea surface the pores of concrete could thus be filled with amalgation of gas and liquid from the angle of interior the hydration of cement and other chemical reactions keep working so that the water could be used or released during the reactions auroy et al 2015 bary et al 2014 bary and sellier 2004 liu et al 2015b saetta et al 1995 šavija and luković 2016 she et al 2018c zeng et al 2012 zhang et al 2017a 2017b the saturation degree could be adapted to describe the proportion of water volume to the whole pore volume and it is believed that there is a relationship between saturation degree and the humidity inside the concrete bary and mügler 2011 this will definitely influence the transport process for both chlorides and carbon dioxide as the pore structure is composed by liquid and gaseous phase while offering the transport paths for them the proportion of liquid and gaseous phase is affected by the saturation degree in the meantime the temperature by the seashore could be changeable as the temperature changes due to diurnal behavior as well as seasonal variation it may differ form around 0 c 50 c higher temperature may instigate reaction activities so as to influence the carbonation process and also the chloride transport process castro et al 2000 da silva et al 2009 poyet et al 2011 rimmelé et al 2008 the study on porous materials could be on multi scales liu et al 2015a ukrainczyk and koenders 2014 see fig 1 it explains the seashore concrete deterioration mechenism for the combination of carbonation and chloride ingress in different scales the macroscopic seashore concrete structure is facing the intrusion of chlorides and carbon dioxde both of which could cause the destruction of the oxidation passivating coating on the rebar surface and lead to the corrosion of the rebar the transport mechenism of chlorides and carbon dioxde and their interplays are strudied from meso and micro scale respectively the unsaturated pore structure is shown both the liquid and gaseous transport paths could be seen and will be explained in detail later in this work there are lots of studies about concrete carbonation under unsaturated circumstances or about chloride transport under unsaturated pore situations seperately the research about moisture transport and pore structure studies are also included it is noticed that lots of studies about chloride transportation is based on drying and wetting cycles which is one of the causing reasons of unsaturation in concrete pores chang et al 2018 gao et al 2013 li et al 2009 meijers et al 2005 ye et al 2012 li et al studied about the transport of moisture within the originally saturated concrete and gave some numerical modelings finding that the drying wetting equilibrium depth can reach the magnitude of centimeters on cover thickness of concrete in the meantime they worked on the porosity pore structuals and gas permeability by both experimental and numerical methods e g mip vgm li et al 2009 the influence of carbonation on pore structures of hydrated cement pastes were studied by ngala et al ngala and page 1997 zanden et al did the modeling of both water and chloride transport in concrete and found that when water leaves the concrete sample and chloride stays inside the pores the chloride concentration at the surface can rise considerably van der zanden et al 2015 kim et al gave a comparison of empirical and physical models of chloride transport in marine exposed concrete kim et al 2016a pack et al predicted the chloride transport time under marine environment by researching 11 marine exposed bridges and establishing the prediction model pack et al 2010 what s more bary et al estabalished the model for carbonation in unsaturated concrete and also considerred the water transport and calcium ingress bary and mügler 2011 in recent studies experts investigated the influence of carbonation on chloride transport and also the impact inverse li et al observed the influence of carbonation on chloride diffusivity did the experiments about chloride ingress in carbonated concretes and analysed the chloride sorption abilities li et al 2018 li also gave the additional thickness of concrete cover due to the impact of carbonation could be 8 mm for the design use of a certain application of a marine slab wang et al studied the combine effect of carbonation and chloride ingress on the ingress and redistribution of chloride and investigated both the circumstances of chlorides before carbonation and after carbonation in three different types of concretes the occurance sequence of carbonation and chloride ingress have various influences wang et al 2017d 2019 liu et al studied the interacted mechanism between carboantion and chloride attack both the phenomonon has effects on each other liu et al 2017b the sem and mip about the microscopic properties of coupled influenced concerte were also done geng et al specially investigeated the influence of carbonation on chloride binding effect both the experimental and numerical work were developed showing that debounding effect of carbonation on chloride binding geng et al 2016 more recently shen et al adopted the concept of carbonation rate to theoretically elaborate the coupling effect between carbonation and chloride transport considering about the environmental influences while the unsaturation condition was not clearly discussed shen et al 2019 these existing studies all have there own emphasis of certain circumstance either the carbonation or the chloride transport is solely considered under unsaturated condition the combined penetration of both carbon dioxide and chlorides are also studied but very few of them precisely focused on the unsaturation condition in order to make clear about the mechanism of the combination of carbonation and chloride transport in porous concrete under unsaturate environment the theoretical analysis is carried out in the present article both the phenomena influence each other and the process is also under the control of the environmental change especially under the unsaturated situation the carbonation process is simulated as the synthetical effect of temperature relative humidity and concentration of carbon dioxide in the air the transport of carbon dioxide and chloride are influenced by these parameters together with the saturation degree and changing structures of the pores 2 carbonation rate under comprehensive environmental condition the carbonation process under unsaturated situation is controlled by different environmental parameters including temperature relative humidity and the concentration of carbon dioxide saetta et al 1995 also the transport process is also influenced by the saturation of the concrete pores the concept of saturation degree is introduced here to indicate the moisture content in the void part of concrete 1 c t φ α f 1 h f 2 t f 3 g f 4 c where c t indicates the time depending carbonation rate the equation considers all the parameters that may influence the carbonation rate by the mean of functions f 1 h f 2 t f 3 g f 4 c respectively they represent the influence of moisture carbon dioxide degree of carbonation and temperature and are explained in detail in later equations except for those ingredients α is the adjustment parameter for carbonation rate which depends on the characteristics of the concrete besides the ingress of carbonation rate is reduced by the saturation degree φ which is influenced by the environment the relative humidity influence is illustrated as follows 2 f 1 h 0 0 h 0 5 5 2 h 0 5 0 5 h 0 9 1 0 9 h 1 where h is the relative humidity this equation depends on the moisture status in the concrete pores to explain this equation the carbonation reaction only happens under the presence of water thus when h is lower than 0 5 the concrete is almost dry and the influential function is equal to 0 when h is near 1 the concrete is almost saturated leading the function as 1 hence in between when h is in the range of 0 5 0 9 the function results f 1 h range from 0 to 1 linearly the temperature impact is showed as follows 3 f 2 t a e e 0 r t where f 2 t is the temperature depending function which shows the reaction rate constant of the carbonation process according to arrhenius equation e 0 is the activation energy needed and r is the gas constant the t value is depending on the environmental temperature the concentration of carbon dioxide influence is demonstrated as follows 4 f 3 g g g m a x where g is the concentration of carbon dioxide in carbonated area function f 3 g is equal to 1 indicating that the concentration of carbon dioxide reaches to its maximum and in non carbonated area the parameter is equal to 0 hence in between the influential function f 3 g linearly increases as the concentration grows the carbonation rate effect is added as follows 5 f 4 c 1 c c m a x m in eq 5 c is the carbonation rate and the relationship between c and the parameter is showed c c m a x refers to the ratio of calcium carbonate contents to its maximum contents m is taken as 1 according to experiences ranging from 0 to 1 the influential function f 4 c indicates the influence of carbonation itself and decreases as the degree gets bigger the relationship between the saturation degree and the relative humidity is implemented as following equation 6 φ 0 0643 e 2 7876 h the equation shows the exponential relationship between the saturation degree φ and the relative humidity h inside the concrete bary and mügler 2011 bary and sellier 2004 3 carbonation influenced chloride transport under unsaturated condition the carbonation process and the chloride transport process is combined together for the influence of carbonation on chloride transport it may decrease the concrete porosity or destroy the binding process in the meantime the influence of chloride transport on carbonation are mainly proved that the chlorine salt crystal may form near the intrusion surface which reduce the ingress concentration of carbon dioxide the following equations sufficiently incorporated the relationship between free chloride concentration and bound chloride concentration and the free chloride ions continue to diffuse after debounding the binding process is expressed as the mass conservation equation in eq 3 during this the carbonation effect has its impact on the binding and diffusion process acting as the concept of reduction function due to carbonation in eq 4 which shows the release and absorption of bound chlorides 7 c f t c b t d c l 2 c f x 2 8 c b t k b c b 1 k r c α c f 1 β c f where c f represents the concentration of free chloride ions c b is the concentration of bound chloride langmuir isotherm is used here to indicate the relationship of bound and free chlorides α and β are the chloride binding constants which depend on the binder type and water binder ratio based on experiment data li and page 2000 liu et al 2018b wang et al 2017b t is the time and x is the distance from the surface of the concrete k b is the rate constant for the reaction of binding process c is the so called relative carbonation rate which ranges from 0 to 1 represents the synergetic action of environmental parameters as mentioned in eq 1 k r is the influence coefficient of debounding degree which shows the threshold of the dissolution of bound chloride and is adapted as 1 in the present paper as the bound chloride are released completely after carbonation chang 2017 here the diffusion coefficient is influenced by several ingredients 9 d c l φ d c l 0 1 ξ c e t t 0 r t t 0 here φ is the saturation degree the carbonation process is also influenced by both the chloride intrude and the carbonation while the crystalloid salt could form and the reaction of carbon dioxide with hydration products could enlarge the solid phase ξ is the influence coefficient of both carbonation and chloride diffusion on porosity adapted as 0 3 c is the carbonation rate t0 represents the initial temperature while t is the value of environmental temperature the influence of temperature on chloride transport is emphasized yuan et al 2009a in the equation the chloride diffusion coefficient is influenced by carbonation effect chloride diffusion effect on concrete porosity relative humidity and temperature 4 verification of modeling accuracy in order to prove the accuracy of this model it is benchmarked with yoon s accelerate chloride penetration and accelerate carbonation experiment yoon 2007 the background and basic information imported inside are as follows the water cement ratio is 0 5 with opc the contamination order is chloride contaminated first then carbonated while under the initial carbon dioxide concentration of 5 the environment temperature as 20 c and the initial relative humidity of 65 the diffusivity of chloride transport in accelerated experiment is set as 5 10 12 m2 s and the moisture diffusion is set as 3 10 10 m2 s the carbon dioxide diffusivity is set as 3 10 8 m2 s the duration time is 4 months 120 days set in the model fig 2 elaborated the comparison between yoon s experiment and the present model it can be observed that the verification result is fairly ideal the result of the present model for the chloride content can properly fit the experimental results of accelerated chloride and carbonation penetration tests after 120 days the carbonation front reaches around 16 mm and the free chloride content has the tendency of decline when it goes deeper the initial chloride content inside the concrete exists and the free chloride content is higher in the carbonated zone only due to the released bound chlorides after the verification with yoon s experiment under accelerated condition the prediction of chloride distribution is benchmarked with zhu s work zhu et al 2016a 2016b the model zhu et al gives the parameter conditions as very practical data that is when w c ratio is equal to 0 45 boundary relative humidity as 0 75 temperature as 15 c initial carbon dioxide concentration as 0 03 their model considered carbonation chloride binding and the corrosion of rebar the carbonation process in their model is composed by the transport of carbon dioxide mass balance of dissolved ca oh 2 dissolution of solid ca oh 2 in pore solution and also the reaction of carbon dioxide with csh the present model is set under the same environment conditions to meet the condition of zhu s which is of 0 75 initial relative humidity 15 c temperature and 0 03 carbon dioxide concentration the comparison is showed in fig 3 in the form of free chloride content to time at the depth of 40 mm of the concrete specimen it is observed that the general tendency of the present model fits the trend of zhu s model and the free chloride content equal to the control model when after 22 years carbonation before that the content is lower than the control line and after that is slightly higher than the control line this may due to that the carbonation impact is directly considered as the influence on chloride diffusivity in zhu s model while it is considered as under synergetic environmental effects in the present model 5 results and discussion 5 1 overview to observe the behavior of carbonation rate and chloride concentration a certain environment condition is settled this condition is implemented as the boundary initial relative humidity is 0 8 the temperature is 20 c the boundary initial concentration of carbon dioxide is 0 035 the carbonation ingress is directly illustrated in fig 4 the left part is the illustrated model that represent the section of a marine exposed concrete specimen the concrete specimen is assumed as in square which is 100 100 mm and the circles represent the aggregates of the concrete the initial free chloride content is 200 mol m3 and initial bound chloride content is 300 mol m3 while the intrusion of carbon dioxide only starts from the up side of this specimen while the other sides of the square is sealed the result is made up as four half piece of concrete specimen which is deliberately reput together respectively showing the carbonation front at 0 20 40 and 60 years it is clearly seen that the specimen is divided into two parts by the colorful lines and this boundary is known as the carbonation front the upper part is the carbonated part and the lower part is the non carbonated part as time passes by the carbonation front moves inside the specimen however the moving speed is decreasing when it goes into the deeper part of the concrete and this fits the common sense that carbonation process will get slower and slower when intruding from concrete surface the carbonation process is deterred because of the accumulating of the increasement of the solid phase in the end at 60 years the carbonation front reaches around 35 mm in this model in the meantime the distribution of free chlorides and bound chlorides are also worth noticing under the certain environment condition mentioned above the distribution is made along the depth to the marine exposed surface of the concrete specimen and the duration time is from t 0 60 years with the 10 years gap in between see fig 5 the bound chlorides distribution differs a lot from the surface part of the specimen to the bottom it is mainly divided into three parts which is the fully carbonated part where the bound chlorides are almost 0 the carbonating part where there are giant jumps of bound chlorides from 0 to around 380 mol m3 the non carbonated part where the bound chlorides are higher than initial values but decease in deeper place the first part phenomenon is mainly for the reason that the bound chlorides are released fully because of carbonation the second part shows the transition from fully carbonated part to non carbonated part and the carbonation change is fairly obvious and aggregated in this place while the third part has higher bound chlorides as the bound chlorides released before transported further to this deeper position it is observed that as time passes the carbonation front or the carbonating part moves deeper in fig 5 the free chlorides distribution shows the tendency of decreasing from the surface of the concrete specimen to the bottom they are higher than initial free chloride concentration mainly because that the bound chlorides are released due to carbonation it is seen that as time goes the decreasing tendency of free chlorides moves behind as more and more bound chlorides are released and transformed into free chlorides it is observed that when t 10 years the free chlorides near the surface of the concrete is very close to when it is 20 years it could be caused by the unstable relative humidity inside the concrete near the surface in the surface part the alternating between outside environmental humidity and inside humidity is still active so that more bound chlorides are released except for the carbonation rate and chloride concentration some other parameters are also detected e g carbon dioxide concentration relative humidity those parameters are set at the surface boundary as initial values and after the intrusion they have the changing distributions along the depth of the concrete specimen the temperature is also set as initial values but it transports so quickly that its changing distributions inside concrete are not that obviously proved in this yearly scale simulation the distributions of carbon dioxide concentration from 0 to 60years are illustrated in fig 6 the value of concentration of carbon dioxide at 0 035 is around 0 0155 mol m3 so that the initial values are the same at the surface as time goes the carbon dioxide transport into the concrete and goes deeper but the intrusion speed reduced the distribution of the carbon dioxide concentration at certain time seems very reasonable and smooth after 60 years it s intrusion depth is around 40 mm as the model is set under unsaturated condition the distribution of relative humidity attracts lots of attentions as the initial boundary values are set as 0 8 the surface values are the same for different time nodes distributions and the internal value of relative humidity is set as 0 99 as the hydration process that happens inside the concrete the distribution of relative humidity can be treated as a reversed transport process and as time goes the transport influenced into the deeper part of the specimen the concept of the model is introduced in this overview part and at the most common environment condition when relative humidity is 0 8 temperature is 20 c and concentration of carbon dioxide is 0 035 the influence of carbonation on chloride transport is illustrated and the parameter distributions are shown however how does the environmental parameters influence the combine ingress of both the phenomena inside the concrete under unsaturated condition haven t been explained yet and will be done in the next section 5 2 environmental parameter analysis 5 2 1 relative humidity the environmental relative humidity may influence the chloride binding by affecting the drying speed of inner pore humidity of the specimen in this model the initial relative humidity inside the concrete is set as 0 99 the model is given different boudary relative humidity to obtain the change of bound chlorides which is set as 0 7 0 8 and 0 9 temprature 20 c initial co2 concentration 0 035 the time node picked is at 30 years after carbonation fig 7 shows how the carbonation rate changes as the relative humidity gets larger as mentioned in the overview part the bound chlorides changes are divided into three parts and here the carbonation rate distribution shows the corresponding to this law the first part is the carbonated part so that the carbonation rate is equal to 1 the second part is the carbonating part which has a giant change while the last part is non carbonated part where the carbonation hasn t happened so the rate is 0 the carbonation front penetrates as the time goes on and as the initial relative humidity increases the carbonation speed diminution becomes more obvious and happens earlier the increasing of the initial boundary relative humidity leads to the retardance of the carbonation penetration in order to observe the change of diffusion coefficient under the impact of carbonation and the environment the parameter d f d is introduced here it is the ratio of the diffusivity of free chlorides to the initial settled reference diffusivity of chloride transport fig 8 shows the changing distribution results of d f d and is tested when its initial relative humidity is 0 7 0 8 and 0 9 the result is shown in smooth changing lines take the 0 8 relative humidity for example the distribution of this parameter is seen the initial ratio is lower than 1 which shows the influence of unsaturation on the chloride diffusivity in deeper places the transport is clogged and become slower while near the 80 mm depth there is a relatively obvious jump of the diffusivity it is relating to both the free chloride concentration distribution and the distribution of relative humidity inside the concrete pores as in deeper part of the concrete the humidity is higher leading to higher saturation degree however the concentration of free chloride is still low here so the diffusivity of free chlorides is comprehensively in decreasing tendency comparing the results under different relative humidities it is demonstrated that as the humidity gets higher the ratio is higher in any depth point of the specimen and declines slower in addition the concentration of bound chlorides and free chlorides are also illustrated in fig 9 the parallel change of carbonation rate and concentration of bound chloride indicates the influence of carbonation on chloride binding effect as the initial boundary relative humidity increases the bound chlorides releasing subjected to carbonation is slower it is observed that when the initial humidity is 0 9 at around 20 mm depth the distribution of bound chlorides has a sudden change which was already explained in above part but there is a small fluctuation at its boundary between the carbonating part and the non carbonated part one assumptive explanation for these phenomena is that either higher or lower relative humidity will prevent the release of bound chlorides due to carbonation which will be further learned in section 6 when the humidity is too high the carbon dioxide intrusion is limited so that the debounding process is also retarded and at the near surface part the humidity is not stable the distribution for free chloride is also shown here the figure for each humidity level nearly parallels with others and as it goes deeper into the concrete the free chloride concentration is lower the concentration of free chlorides gets lower when the initial humidity gets higher because the carbonation process is retarded and less free chlorides could be released the line for free chloride distribution seem to be flat and this may due to that the released bound chlorides also intrude into the deeper part when become the free chlorides according to the figure it is observed that although with higher humidity less free chlorides are released it intrudes into deeper concrete more quickly so that the flat trend is more apparent however when the humidity is lower the chloride transport is slower so that the released chloride is higher but the line has a more evident decline tendency 5 2 2 temperature temperature in the environment is a pivotal influential parameter to both carbonation and chloride transport in marine exposed environment the temperature may vary between days and nights though its difference is less obvious than it is in inland situation under t 10 c 20 c 30 c and 40 c initial boundary rh 0 8 intial co2 concentration 0 035 is manipulated and the influence of temperature on carbonation rate is plotted and compared first the time node picked is at 30years after carbonation see fig 10 at the time of 30 years carbonation as the temperature increases from 10 c to 40 c the carbonation front goes deeper distinctly from approximately 25 mm 50 mm as the temperature gets higher the distance between carbonation fronts gets larger the distribution results of parameter d f d is also illustrated in fig 11 the whole tendancy of the distribution is the same as the relative humidity as temperature gets higher the ratio from the initial value to the bottom value gets lower also the ratio decrease earlier when the temperature is higher the initial value of d f d ratio is more stable for higher temperatures these phenomena seem to be unreasonable as higher temperature always means more active reaction and the chloride diffusivity should be faster however the concentration of bound and free chlorides the carboantion rate and the humidity distribution change in the internal concrete so the results are the synergetic ones which means that the temperature influence on this ratio distribution are not that obvious compared to others the bound and free chlorides depth relationship after 30 years carbonation are solely plotted see fig 12 it is obviously acquired that as the temperature goes up the debounding caused by carbonation goes deeper when the temperature increasing is in equal difference as plotted in the diagram when t is set as 10 20 30 and 40 c the differences between the concentration fronts becomes bigger which indicates that as temperature rises the debounding speed is also increasing as a result the chlorides released into the pore solution raise so that the differences between the highest concentrations of bound chlorides which are accumulated in non carbonated regions also increase in hassan s study as the temperature rises chloride binding effect is firstly reduced in the first week and then increased at three months and as this model is based on long term effect the increasing law tallies with hassan s experiment zibara 2001 the free chloride distribution is comparatively smooth but there is still a decrease for the concentration as it gets deeper inside the concrete and as the temperature gets higher the free chloride concentration is higher 5 2 3 concentration of carbon dioxide one more parameter that worths study is the initial concentration of carbon dioxide since the greenhouse effect is known people become aware of the potential detriment from the increasing carbon dioxide content in the air the carbon dioxide content in the air for now is around 0 035 and will reach higher in industrial places in order to learn the influence of the concentration of carbon dioxide on carbonation and chloride transport the study about it when carbon dioxide concentration g of 0 025 0 035 0 055 is investigated initial relative humidity 0 8 temperature 20 c the time node picked is at 30 years after carbonation it is seen from fig 13 that the carbonation rate obeys the fundamental law of distribution but varies very little when the initial concentration of carbon dioxide changes compared with other parameters at the same time after 30years carbonation when the initial carbon dioxide concentration gets larger the carbonation front moves deeper and the distance in between is very small which is only around 1 mm here the distribution results of parameter d f d is also displayed in fig 14 the changing tendancy of the ratio is still the same here as the initial carbon dioxide gets bigger the ratio seems to decline less and is higher this may caused because that as the concentration of carbon dioxide gets higher the carbonation happens faster so that more free chlorides are released and the transport of free chlorides is speeded up to check the influence of initial carbon dioxide concentration on bound and free chlorides distribution fig 15 is shown as expected the small changing of carbon dioxide concentration we set makes the results very close to each other while their influence in real life could be enormous as the carbon dioxide concentration gets higher the releasing of bound chlorides gets quicker so that the further transport is also faster for the free chlorides distribution the higher carbon dioxide concentration leads to higher free chlorides because of faster releasing of bound chlorides the tendency of free chlorides distribution is still decreasing when it gets deeper in the concrete and is very smooth 5 3 influence of unsaturated condition in order to investigate the influence of unsaturation on both chloride transport and carbonation the concrete is given exaggerated initial saturation degree and boundary relative humidity the saturation degrees are selected as from 0 1 to 0 9 while the boundary relative humidity is coordinated with the saturation degree which is not all fit with the real circumstances in environment the temperature is set as 20 c and the initial carbon dioxide concentration is 0 035 the 20 year s results are introduced the saturated condition when φ 1 is not included as the carbon dioxide could be very hard to intrude inside the concrete surface as no gas path is available the carbonation rate distribution of different saturation is illustrated in fig 16 it is learned from fig 16 that when the initial saturation degree is set under 0 3 the relative humidity is under 0 4 and the carbonation rate does not make any progress when it goes deeper inside the concrete it fits with the knowledge that when the humidity is relatively low not enough moisture is contained inside the concrete the reaction between carbon dioxide and hydration products could be difficult to happen when lacking the medium of h2o the ca included in the hydrated products of cement could not dissolve in the pore solution which is also responsible for the intermission of the release of the bound chlorides when the saturation degree reaches 0 3 the carbonation process happens and the carbon dioxide ingresses into the concrete according to the modeling results as the saturation degree gets higher the carbonation front intrudes slower it is explained that as the saturation degree gets higher the gas path gets narrower so the opportunity for the reaction of carbon dioxide and the solid phase become lower and the carbonation process is delayed it is also noticeable that before the saturation degree reaches 0 8 as it becomes larger the carbonation speed retention is more obvious however after the saturation degree reaches 0 8 the intrude of carbonation seems to be harder the very high relative humidity leads to the acceleration of the blogging for carbonation it is proved that process and the influencing profile fits with silva s study da silva et al 2009 the chloride binding effects could have the same tendency with the profile of the carbonation rate so it is not elaborated again here to understand the effect of unsaturation better the mechanisms are particularized herein fig 17 gives the micro phase of the inside pore structure of concrete the mortar the water phase and gas phase the ions and gases are demonstrated it is easily understood that the former picture shows the saturated pore structure that is filled with moisture where only ions are easily transporting inside the latter picture shows the unsaturated condition that the pore structure is divided into moisture phase and gas phase and both the gas including carbon dioxide and the ions dissolved in the moisture could transport in their own paths lower saturation degree offers broader path for carbon dioxide while the medium h2o for carbonation reaction is limited 6 conclusions this work established the model for the combined phenomena of carbonation and chloride transport in marine exposed unsaturated concrete in order to learn about the influence of environment on both of the ingress and transport process the impacts of the parameters including humidity temperature and concentration of carbon dioxide on them are investigated and the following laws are concluded the carbonation rate evaluates the carbonation degree of the specific position of the concrete and has different tendency when with different parameters after a certain carbonation time the carbonation front moves deeper when the relative humidity is lower or when the temperature is higher and when the concentration of carbon dioxide is higher the parameter of d f d indicating the ratio of free chloride diffusivity to initial reference diffusivity is also analysed the tendency for this parameter is always decreasing along the concrete specimen depth higher relative humidity lower temperature and higher concentration of carbon dioxide will lead to less decline of the free chloride diffusivity compared with the initial diffusivity the bound and free chloride distributions are also illustrated the bound chlorides are released faster when the relative humidity is lower the temperature is higher and the concentration of carbon dioxide is higher the distribution of free chloride is very smooth and is also higher when the relative humidity is lower the temperature is higher and the concentration of carbon dioxide is higher the influence profile of unsaturated condition on carbonation is elucidated according to the modeling results either higher or lower saturation degree will reduce the ingress depth of carbonation front the chloride binding effects has the same tendency with the profile of the carbonation rate this work focuses on unsaturate situation when the relative humidity varies which was not clearly studied in the existing studies and used the relationship between humidity and porosity saturation degree in concrete pores both the carbonation process and the chloride transport phenonmena and their interactions under the unsturated situations are dicussed as the two most serious deterioration problem for the marine exposed concrete structures the exploration of coupling effects between chloride transport and carbonation is very important especially when the environmental change is unavoidable and also considered into the influence ingredients for them in the following works the model could be improved and ultilised for some other further works as well e g the improvement of recycled concrete using carbonation acknowledgements this work was funded by the natural science foundation of china 51978396 and the shanghai rising star program china 19qa1404700 the authors also would like to thank the supports from the young elite scientists sponsorship program by cast 2018qnrc001 the state key laboratory of high performance civil engineering materials 2018cem006 and the state key laboratory of structural analysis for industrial equipment gz18119 
22516,under marine environment reinforced concrete structures are suffering from serious deterioration problems the sea water contains abundant contents of ion species including chlorides and the carbon dioxide exists in the air which could be exclusively high under industrial polluted condition both the chloride transport and carbonation could happen intrude through the concrete protection layer and trigger corrosion for the inside rebar during this process the mechanism of synergetic work of carbon dioxide chloride ions and moisture are investigated in the present study the carbonation process impacts the chloride transport by debounding while the pore structure will also change so that the transport characters vary for both the effects of crucial environmental parameters the temperature the relative humidity and the carbon dioxide concentration on the interaction of carbonation and chloride transport process are also scrutinized considering the existence of liquid in the pore phase this work principally examined the influence of unsaturated environment on the binary ingress process of chloride and carbonation keywords chloride penetration carbonation marine exposed concrete structure unsaturated 1 introduction under marine environment the concrete structures are exposed to complicated conditions as a porous material concrete faces the chloride transport coming from the sea and simultaneously the changing climate including temperature humidity and carbon dioxide chen and ho 2013 da silva et al 2009 jiang et al 2018 liu et al 2017a šavija et al 2013 song et al 2008 the chloride transport may cause problems for the durability of concrete structures leading to the corrosion of the rebar inside concrete feng et al 2016 liu et al 2018a she et al 2018a yan and lin 2008 yan et al 2009 this process is predictable and could be prevented according to existed research data kim et al 2016b liu et al 2014 mao et al 2019 during the transport process there is a significant phenomenon that the chloride ions adsorbed by the cement e g c3a forming the friedle s salt thus the further chloride transport could be retarded and this process is chloride binding arya et al 1990 chang et al 2019 jiang et al 2019 luping and nilsson 1993 yuan et al 2009 in the meantime the carbonation process is specially cared as once the carbonation front reaches the rebar the concrete internal alkalinity decreases greatly and the rebar will corrodes so that the reinforced concrete structure may fail šavija and luković 2016 carbon dioxide is unavoidable as it is everywhere in the air and as the climate change become more serious the content of carbon dioxide in the air is rising in the carbonation process the carbon dioide from the atmosphere could intrude into the concrete through the gas part of the pores together with the air differing with other gases carbon dioxide will react with some of the solid parts of cement and its hydration products e g ch c s h enlarging the solid phase chang and chen 2006 hou et al 2017 2018 2019 she et al 2018b wang et al 2017a 2017c yan et al 2016 yu et al 2017 with deeper intrusion the carbonation keeps happening and the speed of this intrusion is proved to be reducing because of the clogging caused by the increasing solid parts the concept of carbonation rate has been introduced to evaluate the corrosion depth of carbon dioxide geng et al 2016 it is noticeable however that the carbonation process has enormous impact on chloride transport as it may strengthen the ability of preventing chloride transport by decreasing the void volume or encourage the transport of chloride ions by releasing the bound chlorides from fridel s salt geng et al 2016 li et al 2018 the carbonation process could also be influenced by multiple influence of the environment bertolini et al 2013 iqbal et al 2020 it is worth to mention that the real porous concrete structure is encountering the unsaturated condition by seashore which will cause influence to the transport of both chlorides and carbon dioxide zhang et al 2012 from the environmental perspective the concrete facilities are constructed by the sea or half buried in the sea and the most critical point for avoiding corrosion is at the boundry between the air and the water that is the sea surface the pores of concrete could thus be filled with amalgation of gas and liquid from the angle of interior the hydration of cement and other chemical reactions keep working so that the water could be used or released during the reactions auroy et al 2015 bary et al 2014 bary and sellier 2004 liu et al 2015b saetta et al 1995 šavija and luković 2016 she et al 2018c zeng et al 2012 zhang et al 2017a 2017b the saturation degree could be adapted to describe the proportion of water volume to the whole pore volume and it is believed that there is a relationship between saturation degree and the humidity inside the concrete bary and mügler 2011 this will definitely influence the transport process for both chlorides and carbon dioxide as the pore structure is composed by liquid and gaseous phase while offering the transport paths for them the proportion of liquid and gaseous phase is affected by the saturation degree in the meantime the temperature by the seashore could be changeable as the temperature changes due to diurnal behavior as well as seasonal variation it may differ form around 0 c 50 c higher temperature may instigate reaction activities so as to influence the carbonation process and also the chloride transport process castro et al 2000 da silva et al 2009 poyet et al 2011 rimmelé et al 2008 the study on porous materials could be on multi scales liu et al 2015a ukrainczyk and koenders 2014 see fig 1 it explains the seashore concrete deterioration mechenism for the combination of carbonation and chloride ingress in different scales the macroscopic seashore concrete structure is facing the intrusion of chlorides and carbon dioxde both of which could cause the destruction of the oxidation passivating coating on the rebar surface and lead to the corrosion of the rebar the transport mechenism of chlorides and carbon dioxde and their interplays are strudied from meso and micro scale respectively the unsaturated pore structure is shown both the liquid and gaseous transport paths could be seen and will be explained in detail later in this work there are lots of studies about concrete carbonation under unsaturated circumstances or about chloride transport under unsaturated pore situations seperately the research about moisture transport and pore structure studies are also included it is noticed that lots of studies about chloride transportation is based on drying and wetting cycles which is one of the causing reasons of unsaturation in concrete pores chang et al 2018 gao et al 2013 li et al 2009 meijers et al 2005 ye et al 2012 li et al studied about the transport of moisture within the originally saturated concrete and gave some numerical modelings finding that the drying wetting equilibrium depth can reach the magnitude of centimeters on cover thickness of concrete in the meantime they worked on the porosity pore structuals and gas permeability by both experimental and numerical methods e g mip vgm li et al 2009 the influence of carbonation on pore structures of hydrated cement pastes were studied by ngala et al ngala and page 1997 zanden et al did the modeling of both water and chloride transport in concrete and found that when water leaves the concrete sample and chloride stays inside the pores the chloride concentration at the surface can rise considerably van der zanden et al 2015 kim et al gave a comparison of empirical and physical models of chloride transport in marine exposed concrete kim et al 2016a pack et al predicted the chloride transport time under marine environment by researching 11 marine exposed bridges and establishing the prediction model pack et al 2010 what s more bary et al estabalished the model for carbonation in unsaturated concrete and also considerred the water transport and calcium ingress bary and mügler 2011 in recent studies experts investigated the influence of carbonation on chloride transport and also the impact inverse li et al observed the influence of carbonation on chloride diffusivity did the experiments about chloride ingress in carbonated concretes and analysed the chloride sorption abilities li et al 2018 li also gave the additional thickness of concrete cover due to the impact of carbonation could be 8 mm for the design use of a certain application of a marine slab wang et al studied the combine effect of carbonation and chloride ingress on the ingress and redistribution of chloride and investigated both the circumstances of chlorides before carbonation and after carbonation in three different types of concretes the occurance sequence of carbonation and chloride ingress have various influences wang et al 2017d 2019 liu et al studied the interacted mechanism between carboantion and chloride attack both the phenomonon has effects on each other liu et al 2017b the sem and mip about the microscopic properties of coupled influenced concerte were also done geng et al specially investigeated the influence of carbonation on chloride binding effect both the experimental and numerical work were developed showing that debounding effect of carbonation on chloride binding geng et al 2016 more recently shen et al adopted the concept of carbonation rate to theoretically elaborate the coupling effect between carbonation and chloride transport considering about the environmental influences while the unsaturation condition was not clearly discussed shen et al 2019 these existing studies all have there own emphasis of certain circumstance either the carbonation or the chloride transport is solely considered under unsaturated condition the combined penetration of both carbon dioxide and chlorides are also studied but very few of them precisely focused on the unsaturation condition in order to make clear about the mechanism of the combination of carbonation and chloride transport in porous concrete under unsaturate environment the theoretical analysis is carried out in the present article both the phenomena influence each other and the process is also under the control of the environmental change especially under the unsaturated situation the carbonation process is simulated as the synthetical effect of temperature relative humidity and concentration of carbon dioxide in the air the transport of carbon dioxide and chloride are influenced by these parameters together with the saturation degree and changing structures of the pores 2 carbonation rate under comprehensive environmental condition the carbonation process under unsaturated situation is controlled by different environmental parameters including temperature relative humidity and the concentration of carbon dioxide saetta et al 1995 also the transport process is also influenced by the saturation of the concrete pores the concept of saturation degree is introduced here to indicate the moisture content in the void part of concrete 1 c t φ α f 1 h f 2 t f 3 g f 4 c where c t indicates the time depending carbonation rate the equation considers all the parameters that may influence the carbonation rate by the mean of functions f 1 h f 2 t f 3 g f 4 c respectively they represent the influence of moisture carbon dioxide degree of carbonation and temperature and are explained in detail in later equations except for those ingredients α is the adjustment parameter for carbonation rate which depends on the characteristics of the concrete besides the ingress of carbonation rate is reduced by the saturation degree φ which is influenced by the environment the relative humidity influence is illustrated as follows 2 f 1 h 0 0 h 0 5 5 2 h 0 5 0 5 h 0 9 1 0 9 h 1 where h is the relative humidity this equation depends on the moisture status in the concrete pores to explain this equation the carbonation reaction only happens under the presence of water thus when h is lower than 0 5 the concrete is almost dry and the influential function is equal to 0 when h is near 1 the concrete is almost saturated leading the function as 1 hence in between when h is in the range of 0 5 0 9 the function results f 1 h range from 0 to 1 linearly the temperature impact is showed as follows 3 f 2 t a e e 0 r t where f 2 t is the temperature depending function which shows the reaction rate constant of the carbonation process according to arrhenius equation e 0 is the activation energy needed and r is the gas constant the t value is depending on the environmental temperature the concentration of carbon dioxide influence is demonstrated as follows 4 f 3 g g g m a x where g is the concentration of carbon dioxide in carbonated area function f 3 g is equal to 1 indicating that the concentration of carbon dioxide reaches to its maximum and in non carbonated area the parameter is equal to 0 hence in between the influential function f 3 g linearly increases as the concentration grows the carbonation rate effect is added as follows 5 f 4 c 1 c c m a x m in eq 5 c is the carbonation rate and the relationship between c and the parameter is showed c c m a x refers to the ratio of calcium carbonate contents to its maximum contents m is taken as 1 according to experiences ranging from 0 to 1 the influential function f 4 c indicates the influence of carbonation itself and decreases as the degree gets bigger the relationship between the saturation degree and the relative humidity is implemented as following equation 6 φ 0 0643 e 2 7876 h the equation shows the exponential relationship between the saturation degree φ and the relative humidity h inside the concrete bary and mügler 2011 bary and sellier 2004 3 carbonation influenced chloride transport under unsaturated condition the carbonation process and the chloride transport process is combined together for the influence of carbonation on chloride transport it may decrease the concrete porosity or destroy the binding process in the meantime the influence of chloride transport on carbonation are mainly proved that the chlorine salt crystal may form near the intrusion surface which reduce the ingress concentration of carbon dioxide the following equations sufficiently incorporated the relationship between free chloride concentration and bound chloride concentration and the free chloride ions continue to diffuse after debounding the binding process is expressed as the mass conservation equation in eq 3 during this the carbonation effect has its impact on the binding and diffusion process acting as the concept of reduction function due to carbonation in eq 4 which shows the release and absorption of bound chlorides 7 c f t c b t d c l 2 c f x 2 8 c b t k b c b 1 k r c α c f 1 β c f where c f represents the concentration of free chloride ions c b is the concentration of bound chloride langmuir isotherm is used here to indicate the relationship of bound and free chlorides α and β are the chloride binding constants which depend on the binder type and water binder ratio based on experiment data li and page 2000 liu et al 2018b wang et al 2017b t is the time and x is the distance from the surface of the concrete k b is the rate constant for the reaction of binding process c is the so called relative carbonation rate which ranges from 0 to 1 represents the synergetic action of environmental parameters as mentioned in eq 1 k r is the influence coefficient of debounding degree which shows the threshold of the dissolution of bound chloride and is adapted as 1 in the present paper as the bound chloride are released completely after carbonation chang 2017 here the diffusion coefficient is influenced by several ingredients 9 d c l φ d c l 0 1 ξ c e t t 0 r t t 0 here φ is the saturation degree the carbonation process is also influenced by both the chloride intrude and the carbonation while the crystalloid salt could form and the reaction of carbon dioxide with hydration products could enlarge the solid phase ξ is the influence coefficient of both carbonation and chloride diffusion on porosity adapted as 0 3 c is the carbonation rate t0 represents the initial temperature while t is the value of environmental temperature the influence of temperature on chloride transport is emphasized yuan et al 2009a in the equation the chloride diffusion coefficient is influenced by carbonation effect chloride diffusion effect on concrete porosity relative humidity and temperature 4 verification of modeling accuracy in order to prove the accuracy of this model it is benchmarked with yoon s accelerate chloride penetration and accelerate carbonation experiment yoon 2007 the background and basic information imported inside are as follows the water cement ratio is 0 5 with opc the contamination order is chloride contaminated first then carbonated while under the initial carbon dioxide concentration of 5 the environment temperature as 20 c and the initial relative humidity of 65 the diffusivity of chloride transport in accelerated experiment is set as 5 10 12 m2 s and the moisture diffusion is set as 3 10 10 m2 s the carbon dioxide diffusivity is set as 3 10 8 m2 s the duration time is 4 months 120 days set in the model fig 2 elaborated the comparison between yoon s experiment and the present model it can be observed that the verification result is fairly ideal the result of the present model for the chloride content can properly fit the experimental results of accelerated chloride and carbonation penetration tests after 120 days the carbonation front reaches around 16 mm and the free chloride content has the tendency of decline when it goes deeper the initial chloride content inside the concrete exists and the free chloride content is higher in the carbonated zone only due to the released bound chlorides after the verification with yoon s experiment under accelerated condition the prediction of chloride distribution is benchmarked with zhu s work zhu et al 2016a 2016b the model zhu et al gives the parameter conditions as very practical data that is when w c ratio is equal to 0 45 boundary relative humidity as 0 75 temperature as 15 c initial carbon dioxide concentration as 0 03 their model considered carbonation chloride binding and the corrosion of rebar the carbonation process in their model is composed by the transport of carbon dioxide mass balance of dissolved ca oh 2 dissolution of solid ca oh 2 in pore solution and also the reaction of carbon dioxide with csh the present model is set under the same environment conditions to meet the condition of zhu s which is of 0 75 initial relative humidity 15 c temperature and 0 03 carbon dioxide concentration the comparison is showed in fig 3 in the form of free chloride content to time at the depth of 40 mm of the concrete specimen it is observed that the general tendency of the present model fits the trend of zhu s model and the free chloride content equal to the control model when after 22 years carbonation before that the content is lower than the control line and after that is slightly higher than the control line this may due to that the carbonation impact is directly considered as the influence on chloride diffusivity in zhu s model while it is considered as under synergetic environmental effects in the present model 5 results and discussion 5 1 overview to observe the behavior of carbonation rate and chloride concentration a certain environment condition is settled this condition is implemented as the boundary initial relative humidity is 0 8 the temperature is 20 c the boundary initial concentration of carbon dioxide is 0 035 the carbonation ingress is directly illustrated in fig 4 the left part is the illustrated model that represent the section of a marine exposed concrete specimen the concrete specimen is assumed as in square which is 100 100 mm and the circles represent the aggregates of the concrete the initial free chloride content is 200 mol m3 and initial bound chloride content is 300 mol m3 while the intrusion of carbon dioxide only starts from the up side of this specimen while the other sides of the square is sealed the result is made up as four half piece of concrete specimen which is deliberately reput together respectively showing the carbonation front at 0 20 40 and 60 years it is clearly seen that the specimen is divided into two parts by the colorful lines and this boundary is known as the carbonation front the upper part is the carbonated part and the lower part is the non carbonated part as time passes by the carbonation front moves inside the specimen however the moving speed is decreasing when it goes into the deeper part of the concrete and this fits the common sense that carbonation process will get slower and slower when intruding from concrete surface the carbonation process is deterred because of the accumulating of the increasement of the solid phase in the end at 60 years the carbonation front reaches around 35 mm in this model in the meantime the distribution of free chlorides and bound chlorides are also worth noticing under the certain environment condition mentioned above the distribution is made along the depth to the marine exposed surface of the concrete specimen and the duration time is from t 0 60 years with the 10 years gap in between see fig 5 the bound chlorides distribution differs a lot from the surface part of the specimen to the bottom it is mainly divided into three parts which is the fully carbonated part where the bound chlorides are almost 0 the carbonating part where there are giant jumps of bound chlorides from 0 to around 380 mol m3 the non carbonated part where the bound chlorides are higher than initial values but decease in deeper place the first part phenomenon is mainly for the reason that the bound chlorides are released fully because of carbonation the second part shows the transition from fully carbonated part to non carbonated part and the carbonation change is fairly obvious and aggregated in this place while the third part has higher bound chlorides as the bound chlorides released before transported further to this deeper position it is observed that as time passes the carbonation front or the carbonating part moves deeper in fig 5 the free chlorides distribution shows the tendency of decreasing from the surface of the concrete specimen to the bottom they are higher than initial free chloride concentration mainly because that the bound chlorides are released due to carbonation it is seen that as time goes the decreasing tendency of free chlorides moves behind as more and more bound chlorides are released and transformed into free chlorides it is observed that when t 10 years the free chlorides near the surface of the concrete is very close to when it is 20 years it could be caused by the unstable relative humidity inside the concrete near the surface in the surface part the alternating between outside environmental humidity and inside humidity is still active so that more bound chlorides are released except for the carbonation rate and chloride concentration some other parameters are also detected e g carbon dioxide concentration relative humidity those parameters are set at the surface boundary as initial values and after the intrusion they have the changing distributions along the depth of the concrete specimen the temperature is also set as initial values but it transports so quickly that its changing distributions inside concrete are not that obviously proved in this yearly scale simulation the distributions of carbon dioxide concentration from 0 to 60years are illustrated in fig 6 the value of concentration of carbon dioxide at 0 035 is around 0 0155 mol m3 so that the initial values are the same at the surface as time goes the carbon dioxide transport into the concrete and goes deeper but the intrusion speed reduced the distribution of the carbon dioxide concentration at certain time seems very reasonable and smooth after 60 years it s intrusion depth is around 40 mm as the model is set under unsaturated condition the distribution of relative humidity attracts lots of attentions as the initial boundary values are set as 0 8 the surface values are the same for different time nodes distributions and the internal value of relative humidity is set as 0 99 as the hydration process that happens inside the concrete the distribution of relative humidity can be treated as a reversed transport process and as time goes the transport influenced into the deeper part of the specimen the concept of the model is introduced in this overview part and at the most common environment condition when relative humidity is 0 8 temperature is 20 c and concentration of carbon dioxide is 0 035 the influence of carbonation on chloride transport is illustrated and the parameter distributions are shown however how does the environmental parameters influence the combine ingress of both the phenomena inside the concrete under unsaturated condition haven t been explained yet and will be done in the next section 5 2 environmental parameter analysis 5 2 1 relative humidity the environmental relative humidity may influence the chloride binding by affecting the drying speed of inner pore humidity of the specimen in this model the initial relative humidity inside the concrete is set as 0 99 the model is given different boudary relative humidity to obtain the change of bound chlorides which is set as 0 7 0 8 and 0 9 temprature 20 c initial co2 concentration 0 035 the time node picked is at 30 years after carbonation fig 7 shows how the carbonation rate changes as the relative humidity gets larger as mentioned in the overview part the bound chlorides changes are divided into three parts and here the carbonation rate distribution shows the corresponding to this law the first part is the carbonated part so that the carbonation rate is equal to 1 the second part is the carbonating part which has a giant change while the last part is non carbonated part where the carbonation hasn t happened so the rate is 0 the carbonation front penetrates as the time goes on and as the initial relative humidity increases the carbonation speed diminution becomes more obvious and happens earlier the increasing of the initial boundary relative humidity leads to the retardance of the carbonation penetration in order to observe the change of diffusion coefficient under the impact of carbonation and the environment the parameter d f d is introduced here it is the ratio of the diffusivity of free chlorides to the initial settled reference diffusivity of chloride transport fig 8 shows the changing distribution results of d f d and is tested when its initial relative humidity is 0 7 0 8 and 0 9 the result is shown in smooth changing lines take the 0 8 relative humidity for example the distribution of this parameter is seen the initial ratio is lower than 1 which shows the influence of unsaturation on the chloride diffusivity in deeper places the transport is clogged and become slower while near the 80 mm depth there is a relatively obvious jump of the diffusivity it is relating to both the free chloride concentration distribution and the distribution of relative humidity inside the concrete pores as in deeper part of the concrete the humidity is higher leading to higher saturation degree however the concentration of free chloride is still low here so the diffusivity of free chlorides is comprehensively in decreasing tendency comparing the results under different relative humidities it is demonstrated that as the humidity gets higher the ratio is higher in any depth point of the specimen and declines slower in addition the concentration of bound chlorides and free chlorides are also illustrated in fig 9 the parallel change of carbonation rate and concentration of bound chloride indicates the influence of carbonation on chloride binding effect as the initial boundary relative humidity increases the bound chlorides releasing subjected to carbonation is slower it is observed that when the initial humidity is 0 9 at around 20 mm depth the distribution of bound chlorides has a sudden change which was already explained in above part but there is a small fluctuation at its boundary between the carbonating part and the non carbonated part one assumptive explanation for these phenomena is that either higher or lower relative humidity will prevent the release of bound chlorides due to carbonation which will be further learned in section 6 when the humidity is too high the carbon dioxide intrusion is limited so that the debounding process is also retarded and at the near surface part the humidity is not stable the distribution for free chloride is also shown here the figure for each humidity level nearly parallels with others and as it goes deeper into the concrete the free chloride concentration is lower the concentration of free chlorides gets lower when the initial humidity gets higher because the carbonation process is retarded and less free chlorides could be released the line for free chloride distribution seem to be flat and this may due to that the released bound chlorides also intrude into the deeper part when become the free chlorides according to the figure it is observed that although with higher humidity less free chlorides are released it intrudes into deeper concrete more quickly so that the flat trend is more apparent however when the humidity is lower the chloride transport is slower so that the released chloride is higher but the line has a more evident decline tendency 5 2 2 temperature temperature in the environment is a pivotal influential parameter to both carbonation and chloride transport in marine exposed environment the temperature may vary between days and nights though its difference is less obvious than it is in inland situation under t 10 c 20 c 30 c and 40 c initial boundary rh 0 8 intial co2 concentration 0 035 is manipulated and the influence of temperature on carbonation rate is plotted and compared first the time node picked is at 30years after carbonation see fig 10 at the time of 30 years carbonation as the temperature increases from 10 c to 40 c the carbonation front goes deeper distinctly from approximately 25 mm 50 mm as the temperature gets higher the distance between carbonation fronts gets larger the distribution results of parameter d f d is also illustrated in fig 11 the whole tendancy of the distribution is the same as the relative humidity as temperature gets higher the ratio from the initial value to the bottom value gets lower also the ratio decrease earlier when the temperature is higher the initial value of d f d ratio is more stable for higher temperatures these phenomena seem to be unreasonable as higher temperature always means more active reaction and the chloride diffusivity should be faster however the concentration of bound and free chlorides the carboantion rate and the humidity distribution change in the internal concrete so the results are the synergetic ones which means that the temperature influence on this ratio distribution are not that obvious compared to others the bound and free chlorides depth relationship after 30 years carbonation are solely plotted see fig 12 it is obviously acquired that as the temperature goes up the debounding caused by carbonation goes deeper when the temperature increasing is in equal difference as plotted in the diagram when t is set as 10 20 30 and 40 c the differences between the concentration fronts becomes bigger which indicates that as temperature rises the debounding speed is also increasing as a result the chlorides released into the pore solution raise so that the differences between the highest concentrations of bound chlorides which are accumulated in non carbonated regions also increase in hassan s study as the temperature rises chloride binding effect is firstly reduced in the first week and then increased at three months and as this model is based on long term effect the increasing law tallies with hassan s experiment zibara 2001 the free chloride distribution is comparatively smooth but there is still a decrease for the concentration as it gets deeper inside the concrete and as the temperature gets higher the free chloride concentration is higher 5 2 3 concentration of carbon dioxide one more parameter that worths study is the initial concentration of carbon dioxide since the greenhouse effect is known people become aware of the potential detriment from the increasing carbon dioxide content in the air the carbon dioxide content in the air for now is around 0 035 and will reach higher in industrial places in order to learn the influence of the concentration of carbon dioxide on carbonation and chloride transport the study about it when carbon dioxide concentration g of 0 025 0 035 0 055 is investigated initial relative humidity 0 8 temperature 20 c the time node picked is at 30 years after carbonation it is seen from fig 13 that the carbonation rate obeys the fundamental law of distribution but varies very little when the initial concentration of carbon dioxide changes compared with other parameters at the same time after 30years carbonation when the initial carbon dioxide concentration gets larger the carbonation front moves deeper and the distance in between is very small which is only around 1 mm here the distribution results of parameter d f d is also displayed in fig 14 the changing tendancy of the ratio is still the same here as the initial carbon dioxide gets bigger the ratio seems to decline less and is higher this may caused because that as the concentration of carbon dioxide gets higher the carbonation happens faster so that more free chlorides are released and the transport of free chlorides is speeded up to check the influence of initial carbon dioxide concentration on bound and free chlorides distribution fig 15 is shown as expected the small changing of carbon dioxide concentration we set makes the results very close to each other while their influence in real life could be enormous as the carbon dioxide concentration gets higher the releasing of bound chlorides gets quicker so that the further transport is also faster for the free chlorides distribution the higher carbon dioxide concentration leads to higher free chlorides because of faster releasing of bound chlorides the tendency of free chlorides distribution is still decreasing when it gets deeper in the concrete and is very smooth 5 3 influence of unsaturated condition in order to investigate the influence of unsaturation on both chloride transport and carbonation the concrete is given exaggerated initial saturation degree and boundary relative humidity the saturation degrees are selected as from 0 1 to 0 9 while the boundary relative humidity is coordinated with the saturation degree which is not all fit with the real circumstances in environment the temperature is set as 20 c and the initial carbon dioxide concentration is 0 035 the 20 year s results are introduced the saturated condition when φ 1 is not included as the carbon dioxide could be very hard to intrude inside the concrete surface as no gas path is available the carbonation rate distribution of different saturation is illustrated in fig 16 it is learned from fig 16 that when the initial saturation degree is set under 0 3 the relative humidity is under 0 4 and the carbonation rate does not make any progress when it goes deeper inside the concrete it fits with the knowledge that when the humidity is relatively low not enough moisture is contained inside the concrete the reaction between carbon dioxide and hydration products could be difficult to happen when lacking the medium of h2o the ca included in the hydrated products of cement could not dissolve in the pore solution which is also responsible for the intermission of the release of the bound chlorides when the saturation degree reaches 0 3 the carbonation process happens and the carbon dioxide ingresses into the concrete according to the modeling results as the saturation degree gets higher the carbonation front intrudes slower it is explained that as the saturation degree gets higher the gas path gets narrower so the opportunity for the reaction of carbon dioxide and the solid phase become lower and the carbonation process is delayed it is also noticeable that before the saturation degree reaches 0 8 as it becomes larger the carbonation speed retention is more obvious however after the saturation degree reaches 0 8 the intrude of carbonation seems to be harder the very high relative humidity leads to the acceleration of the blogging for carbonation it is proved that process and the influencing profile fits with silva s study da silva et al 2009 the chloride binding effects could have the same tendency with the profile of the carbonation rate so it is not elaborated again here to understand the effect of unsaturation better the mechanisms are particularized herein fig 17 gives the micro phase of the inside pore structure of concrete the mortar the water phase and gas phase the ions and gases are demonstrated it is easily understood that the former picture shows the saturated pore structure that is filled with moisture where only ions are easily transporting inside the latter picture shows the unsaturated condition that the pore structure is divided into moisture phase and gas phase and both the gas including carbon dioxide and the ions dissolved in the moisture could transport in their own paths lower saturation degree offers broader path for carbon dioxide while the medium h2o for carbonation reaction is limited 6 conclusions this work established the model for the combined phenomena of carbonation and chloride transport in marine exposed unsaturated concrete in order to learn about the influence of environment on both of the ingress and transport process the impacts of the parameters including humidity temperature and concentration of carbon dioxide on them are investigated and the following laws are concluded the carbonation rate evaluates the carbonation degree of the specific position of the concrete and has different tendency when with different parameters after a certain carbonation time the carbonation front moves deeper when the relative humidity is lower or when the temperature is higher and when the concentration of carbon dioxide is higher the parameter of d f d indicating the ratio of free chloride diffusivity to initial reference diffusivity is also analysed the tendency for this parameter is always decreasing along the concrete specimen depth higher relative humidity lower temperature and higher concentration of carbon dioxide will lead to less decline of the free chloride diffusivity compared with the initial diffusivity the bound and free chloride distributions are also illustrated the bound chlorides are released faster when the relative humidity is lower the temperature is higher and the concentration of carbon dioxide is higher the distribution of free chloride is very smooth and is also higher when the relative humidity is lower the temperature is higher and the concentration of carbon dioxide is higher the influence profile of unsaturated condition on carbonation is elucidated according to the modeling results either higher or lower saturation degree will reduce the ingress depth of carbonation front the chloride binding effects has the same tendency with the profile of the carbonation rate this work focuses on unsaturate situation when the relative humidity varies which was not clearly studied in the existing studies and used the relationship between humidity and porosity saturation degree in concrete pores both the carbonation process and the chloride transport phenonmena and their interactions under the unsturated situations are dicussed as the two most serious deterioration problem for the marine exposed concrete structures the exploration of coupling effects between chloride transport and carbonation is very important especially when the environmental change is unavoidable and also considered into the influence ingredients for them in the following works the model could be improved and ultilised for some other further works as well e g the improvement of recycled concrete using carbonation acknowledgements this work was funded by the natural science foundation of china 51978396 and the shanghai rising star program china 19qa1404700 the authors also would like to thank the supports from the young elite scientists sponsorship program by cast 2018qnrc001 the state key laboratory of high performance civil engineering materials 2018cem006 and the state key laboratory of structural analysis for industrial equipment gz18119 
22517,this paper addresses shallow water ship model testing and the determination of water depth effects on ship resistance it is shown how effects of water depth towing tank width and the scaling of viscous resistance interact and are of large importance for ship performance prediction a new method to correct model tests for tank width effects is briefly described for a set of shallow water model test data it is shown how tank width effects apparently double the water depth influence also the model to ship extrapolation strongly affects the predicted water depth effect for the ship easily leading to an overestimation the procedure to be used with a depth dependent form factor is proposed a new procedure to correct ship speed trials for water depth effects is introduced and validations are shown with full scale trial data with the same set of model test data and with the full scale predictions based on these keywords ship resistance shallow water tank width scale effect trial correction squat nomenclature a m midship sectional area of ship m2 b width of model basin or channel m c t total resistance coefficient c ts c tm total resistance coefficient for ship and model c w wave resistance coefficient c v viscous resistance coefficient c f0 flat plate friction coefficient fr h depth froude number h water depth m re reynolds number r m model total resistance n r t total resistance n r w wave resistance n t ship draft m u longitudinal flow velocity m s v m model speed m s zs dynamic sinkage m 1 k form factor β blockage a m bh γ overspeed ratio δ ship displacement m3 δγ additional overspeed ratio in channel η d propulsive efficiency ν kinematic viscosity m2 s ρ density of water kg m3 1 introduction shallow water normally increases a ship s resistance required power and squat for estimating the performance of a ship in shallow water model tests are frequently done but also available empirical estimation methods for shallow water effects are largely based on model test data examples of such methods are schlichting 1934 lackenby 1963 jiang 2001 however shallow water model tests are affected by the limited width of the model basin far more than deep water model tests in the present paper it is demonstrated to what extent the model basin width can affect the apparent water depth influence and how it can easily lead to wrong conclusions a new approximate method to correct model test data for this tank width effect was recently published raven 2018 and is outlined and demonstrated below it is pointed out that it is essential to distinguish 3 different physical effects often occurring simultaneously 1 effect of limited depth on viscous resistance 2 effect of limited depth on wave resistance and squat 3 effect of limited width on resistance and squat as for a given model basin width effect 3 increases with decreasing water depth ignoring it yields wrong results for 1 and 2 separate computational studies have been done on effects 1 and 2 raven 2012 2016 these respond to different water depth parameters therefore it is important to deal with them separately for model and ship there is a different relative importance of viscous and wave resistance and thereby also a different dependence of the total resistance on water depth it is shown that the model to ship extrapolation method used has a large influence on the assumed water depth effect for the ship at full scale which is another aspect apparently neglected so far a naïve application of usual methods yields a much stronger shallow water effect on resistance for the ship than for the model the paper is set up as follows in section 2 the effect of model basin or channel width is discussed and the correction method is described in section 3 it is applied to model test data for a ferry in shallow water demonstrating the large effect on the apparent water depth influence section 4 addresses the model to ship extrapolation of the measured data a computational study on the scaling of the viscous resistance and its shallow water effect is discussed in section 5 and the required model to ship extrapolation approach is indicated in section 6 the related development of a correction procedure for small shallow water effects in ship speed trials is considered and some validations with full scale and model scale data are shown thus the paper summarises synthesises and illustrates some of the research on shallow water hydrodynamics done in recent years at marin 2 finite width effects on ship resistance and flow 2 1 general in ship model testing usually the measurements should lead to a prediction for infinite waterway width the finite width of the model basin then is a disturbing factor in particular in shallow water the magnitude of this disturbance is considered a ship model in a towing tank of width b and depth h is considered the flow is described in a coordinate system moving with the model so there is an incoming flow with velocity v m from ahead the flow speed next to the model must be larger than v m to let all water pass the larger the blockage β ratio of model cross section to tank cross section the larger this overspeed also called return flow but the increased flow speed causes a drop of the water level next to the model which also results in an increased dynamic sinkage of the ship both lead to a further reduction of the tank cross section and a resulting further increase of the flow speed kreitner 1934 proposed a simple estimation for these effects by assuming that the flow speed is uniformly distributed over the channel cross section which is a good approximation for a ship with a long parallel midbody in a narrow channel consistently he assumed the sinkage of the ship to be equal to the drop of the water level which in turn follows from the bernoulli equation the resulting expression for the overspeed ratio γ u v m with u the longitudinal component of the flow velocity next to the ship is 1 γ 1 β 1 2 f r h 2 1 γ 2 1 where the depth froude number f r h v g h in practical applications for ships with a not so long parallel midbody the overspeed is not uniformly distributed but kreitner s formula still provides a useful estimate of the mean overspeed over the channel section at the midship position however this is not what is needed for estimating finite width effects the objective is to compare the overspeed in a model basin of restricted width and that in infinitely wide water of equal depth but for the latter there is zero blockage and kreitner s formula yields zero overspeed just as for an infinite depth case essentially kreitner yields the difference with a case of infinite width and infinite depth not equal depth the use of a virtual tank width has sometimes been proposed in order to get an overspeed value for infinite width but as that virtual width should depend on the depth froude number again this seems an unpromising approach useful other methods to deal with just the finite width effect tank wall effect seemed not to be available 2 2 a correction method for tank wall effects in raven 2018 a new method to correct resistance and squat measurements for the effect of the finite tank width has been proposed the first step is to estimate the difference in overspeed along the hull between the situations of finite and infinite width at equal water depth to study this flow computations have been made for ships in various water depths and channel widths the free surface potential flow code rapid raven 1996 has been used for this it computes the inviscid flow along a ship hull in restricted or unrestricted water using a panel method source panels are distributed over the ship hull surface and a surrounding part of the water surface an iterative solution is required as the free surface boundary conditions are nonlinear and the dynamic trim and sinkage need to be incorporated this method is in continuous use for ship design at marin and elsewhere since 1994 some of the required adjustments for application to ships in narrow channels are described in raven 2018 fig 1 shows the computed distribution of the longitudinal flow velocity at the water surface next to the midship section of a given model the ship hull is at the left of the figure y 0 is the centreplane and the lines start at the ship s waterline the lower line is for deep water of infinite width there is just a little overspeed next to the model plus a disturbance where a diverging bow wave passes also seen in all other lines the line just above it is for shallow water h t 1 54 of infinite width the overspeed is a lot larger here and extends to much larger distances as a result of the more two dimensional situation the other 3 lines are for the same ship at the same speed in the same water depth but in channels of different widths the channel walls further increase the overspeed and the mean overspeed is fairly well indicated by kreitner s formula however the pure tank wall effect is just the difference between the overspeed in a shallow channel and that in shallow water of infinite width and that is a much smaller quantity e g for the channel with b l 1 31 kreitner predicts 11 3 overspeed but the actual channel wall contribution is just some 5 remarkably this additional overspeed caused by the tank walls is quite constantly distributed over the channel section the line for shallow water seems just shifted upward by a small amount as discussed in raven 2018 this can be understood from the similar streamline curvature in the different cases the new estimation method now is built on this assumption of a uniformly distributed additional overspeed note that this is a different assumption than kreitner s who assumed the entire overspeed to be constant over the channel cross section which clearly is not the case here as derived in raven 2018 the additional overspeed as a fraction of ship speed δ γ u c h a n n e l u s h a l l o w v can be solved from the following equation 2 δ γ 1 β 1 2 f r h 2 1 3 γ 2 3 γ δ γ δ γ 2 q o u t v a c in which γ is the overspeed ratio in shallow water of infinite width averaged over the width of the channel the equation is clearly similar to kreitner s but provides the additional overspeed the upward shift of the lines for the channels in fig 1 like kreitner s formula it predicts a quick increase of the additional overspeed when the speed approaches the critical channel speed the term at the right hand side is explained in fig 2 a sketch with the same setup as fig 1 if a comparison is made between the overspeed for the ship in a shallow channel and in shallow water of infinite width in the latter case there is still an overspeed occurring outside the location of the channel wall indicated by the blue area this overspeed carries an excess volume flux q out but in the channel case that excess flux has to be accommodated inside the channel walls it is this additional volume flux q out that determines the increase of the overspeed due to the channel walls as indicated by the yellow area while the flux is equal the areas in this graph are not since due to the additional drop of the water level the overspeed increase is relatively large to actually calculate the overspeed increase for a given ship in a shallow channel a single free surface potential flow computation for the same case in water of unlimited width and equal depth is made from this the nondimensional flux q out v a c the mean overspeed ratio over a part of the water surface γ and the mean overspeed ratio along the ship s waterline in shallow water of infinite width γ w l u w l v are deduced it is noted that the integration for q out would need to be extended to infinity but a way to evaluate it from the finite domain potential flow computation is described in raven 2018 to good approximation these quantities can subsequently be used for a range of speeds and channel widths after substitution in eq 2 the overspeed increase is obtained immediately an increase of the dynamic sinkage z s caused by the tank walls is also obtained as 3 z s c h a n n e l z s s h a l l o w 1 2 f r h 2 h 2 γ w l δ γ δ γ 2 as shown in the reference this method provides a good estimation of the overspeed increase δ γ caused by the limited channel width for the same case as in figs 1 and 3 illustrates this the estimated lines are found by adding δ γ from eq 2 to the computed overspeed distribution in shallow water of unlimited width the agreement with the lines directly computed is quite good the main deviation is due to the fact that for narrower channels an inward shift of the peaks related with the diverging bow wave occurs which is not caught by a constant δ γ this shift indicates an increasing divergence angle of the bow wave here primarily caused by refraction effects due to the accelerating flow an interesting detail but not our concern here now that the overspeed increase can be estimated an assumption is still needed to estimate its effect on the ship s resistance one can resort to a simplification made in most earlier blockage correctors that the effect on resistance corresponds with that of a model speed increase equal to the relative increase of the flow speed along the hull caused by the additional overspeed 4 v m s h a l l o w v m t a n k 1 δ γ γ w l r t s h a l l o w v m s h a l l o w r t t a n k v m t a n k this amounts to a shift of the points of the resistance curve measured in the towing tank to a slightly higher speed this correction is made prior to the further processing of the model test data besides the measured dynamic sinkage values are corrected using eq 3 while the procedure may seem complicated in practice it is straightforward from the result of the potential flow computation a postprocessor evaluates the required coefficients and solves eq 2 for all input model speeds the corrected model speeds and sinkage corrections are output immediately the method is used for all shallow water resistance tests at marin since several years validations raven 2018 garenaux et al 2019 have shown that the additional overspeed is estimated quite well and that the resulting estimate of the effect on resistance appears to be valid as long as the correction is not too large e g a speed correction up to 5 therefore use of the method is limited to cases not too close to critical channel speed the sinkage correction was found to be accurate for not too large corrections but tends to overestimate for stronger effects in passing an alternative use of the correction can be mentioned for predicting the speed loss of a ship in channels of various widths from the known speed in shallow water of infinite width 3 effect of water depth on resistance of a ferry model as an illustration a set of older model test data for a ferry of 150 m length 28 m beam and 6 m draft is considered model scale was 20 5 the basin width was 2 16 times the model length almost 12 times the model beam five water depths were tested from 13 1 to 22 5 m the dashed lines in fig 4 are the measured model resistance curves for 3 water depths with decreasing water depth the resistance increases significantly and the steep part of the curve shifts to lower speeds for the smallest water depth the critical shallow water speed fr h 1 corresponds with 22 kn beyond the range of the measurements but the blockage β 0 0386 so the highest speed of 17 kn ship scale is near critical channel speed so serious effects of the towing tank width are present if the tank width correction is applied one gets the corresponding curves shown as solid lines the smaller the water depth and the higher the speed the larger is the correction towards the higher speeds the lines become significantly less steep and the difference between the curves for different water depths is reduced for the highest speeds in the two smaller water depths though one cannot precisely trust the correction as it is larger than what the simple assumptions permit to determine the effect of water depth on model resistance the lines in fig 4 are intersected at constant speeds of 15 and 16 5 kn and fig 5 is obtained there is a large difference of the apparent water depth effect between the uncorrected and corrected model measurements the uncorrected data suggest a depth influence on resistance twice as large as the corrected data much of this actually is a towing tank width effect one is largely looking at the wrong physics fig 6 shows the increase of the dynamic sinkage squat for decreasing water depth at 16 5 kn speed here the tank width correction is even more important and is still significant for the largest water depth while not always as accurate this correction at least can be considered as indicative it is concluded that in model testing in shallow water it is essential to apply a correction for the finite width of the model basin otherwise misleading results may be obtained with a far too strong apparent water depth effect it seems likely that similar errors have affected data underlying empirical estimation methods for the water depth effect both for resistance and for squat unless tank width or blockage has been taken into account explicitly the different tank widths used possibly explain the large mutual discrepancy of empirical squat formulas 4 scaling of shallow water model test data 4 1 model to ship extrapolation so far model test results corrected for the effect of the finite width of the model basin have been derived to predict the resistance of the ship at full scale from these model to ship extrapolation techniques are to be applied see e g larsson and raven 2010 ch 8 model resistance tests are done at equal length froude number as the ship and according to froude s hypothesis a part of the resistance essentially associated with wave making can then be directly scaled up by multiplication with model scale to the third power the other part related with the viscous flow depends on the reynolds number re which differs much between model and ship therefore this part needs to be scaled up differently the simplification is 5 c t f r r e c w f r c v re such that 6 c t s f r r e s c t m f r r e m c v re m c v re s here the resistance coefficients are defined as c t r t 1 2 ρ v 2 s where s is the wetted surface different assumptions can be made for this difference of the viscous resistance coefficients at ship and model reynolds number in the classical froude extrapolation method the viscous resistance coefficient is simply taken equal to the frictional resistance coefficient of a flat plate at equal reynolds number c f0 re the remaining part consisting of wave resistance and some viscous components is called residuary resistance instead of flat plate friction coefficients often a somewhat adjusted expression is used the so called ittc 57 model ship correlation line alternatively the viscous resistance coefficient of the ship as a function of the reynolds number is supposed to be proportional to the flat plate friction coefficient or ittc 57 coefficient c v r e 1 k c f 0 r e the proportionality constant 1 k is called the form factor it depends on the hull form increasing with the fullness of the hull normal values lying between 1 1 and 1 4 its value can either be found from low speed resistance tests or from empirical relations expressed in geometric properties of the hull form while in essence these methods lead to different full scale resistance predictions much of the difference is compensated by empirical correlation allowances that are ultimately added deduced from experimental full scale trial data these allowances are specific for each extrapolation method and on average bring all of them to the level measured in full scale trials 4 2 application to shallow water model tests applying different model to ship extrapolation methods to shallow water tests however may cause very large differences consider the same ferry model data for speed 16 5 kn without correcting for the tank width effect the increase of the resistance for decreasing water depth is exaggerated as seen before in water depth 13 1 m the measured model resistance is 41 5 higher than for depth 22 5 m if now the froude model to ship extrapolation is applied flat plate friction remains flat plate friction and all this resistance increase is absorbed in the remainder the residuary resistance coefficient which is supposed equal for model and ship but the frictional resistance coefficient of the ship at full scale is roughly half of that of the model the residuary resistance and thereby the shallow water resistance increase thus counts more strongly for the ship in the prediction for the ship the resistance in 13 1 m water depth now comes out as 56 higher than that for 22 5 m water depth if as advocated first the model data are corrected for the tank width effect the shallow water resistance increase at model scale becomes 18 that at full scale 24 still an appreciable difference for this vessel the form factor in deep water has been found as 1 k 1 22 using that form factor in the extrapolation the shallow water resistance increase is still absorbed in the wave resistance part and supposed equal for the ship which yields again a 24 difference between both water depths thus it appears that both model to ship extrapolation methods as naively applied here lead to the conclusion that the shallow water effect on resistance is significantly larger for the ship than for the model but this critically depends on how the viscous resistance is affected by shallow water this is considered in the next section 5 effect of water depth on ship viscous resistance 5 1 a computational study the effect of water depth on the flow around the hull is a lot more specific than that of the tank width while tank walls are always fairly remote and were shown to cause a rather constant overspeed increase the bottom can be quite close and can lead to a more horizontal flow past the hull larger streamline curvature larger pressure gradients earlier flow separation it is likely that the viscous resistance increases by this a study has been done on this effect raven 2012 using viscous flow computations by a rans code to obtain a pure viscous resistance double body flow computations have been made i e computations in which wave making is omitted and the still water surface is modelled as a symmetry plane the ratio of the resulting viscous resistance coefficient to the ittc 57 friction coefficient is the form factor 1 k which then normally is assumed to be independent of the reynolds number however computations have been made for model and ship reynolds numbers to verify the equality of the form factor in shallow water one particular issue in such computations is again to avoid channel effects in many rans codes at the side boundaries of the domain either a free slip boundary condition can be imposed or some sort of constant pressure condition both are inadequate for shallow water cases and would act more or less as a channel flow introducing the same false water depth effects as were discussed before in the study done computations have been made using the parnassos code hoekstra 1999 which has a particular treatment of the boundary conditions on the lateral boundaries of the domain adequately simulating an infinite domain width in raven 2012 4 ships of very different type are considered each in several water depths the overall conclusion was that the viscous resistance increases strongly with decreasing water depth fig 8 moreover the relative increase of the viscous resistance was found to be very similar for model and full scale at least for not too shallow situations t h 0 5 this was confirmed later for other cases for the model to ship extrapolation this means the following the relative increase of the viscous resistance in shallow water by a factor c v c vdeep is supposed equal for model and ship as was found in the study the assumption for the viscous resistance thus becomes c v r e h c v c v d e e p t h 1 k c f 0 r e the shallow water form factor 1 k c v c v d e e p t h 1 k can be found from low speed tests in the water depth considered or alternatively c v c vdeep can be estimated from a general relation thus a large part of the resistance increase in shallow water is correctly interpreted as viscous resistance not as an increase of the wave or residuary resistance this part decreases from model to ship consequently the resulting full scale resistance prediction in shallow water comes out as lower 5 2 application to ferry model the ferry model is reconsidered from the measurements form factors in shallow water could be estimated for water depth 22 5 m 1 k 1 27 for water depth 13 1 m 1 k 1 39 so the viscous resistance has increased by 14 compared with the deep water value 1 k 1 22 for 16 5 kn half of the resistance increase from depth 22 5 m to depth 13 1 m is a viscous resistance increase then extrapolating to full scale a total resistance difference between both water depths of 19 is found actually very close to the percentage resistance increase at model scale note that 56 and 24 were obtained before fig 7 shows the complete ship resistance coefficient curves against speed obtained with different extrapolation methods the froude extrapolation of the model data uncorrected for tank wall effect dotted lines suggests a very large shallow water effect and high level of the resistance the dashed lines were found by froude extrapolation of the data corrected for tank wall effects the solid lines are found by using a depth dependent form factor 1 k in the extrapolation of the data corrected for tank wall effects our recommended method the effect of the tank width corrections is dominant for the higher speeds the model to ship extrapolation method has more influence at lower speeds the joint effect on the full scale prediction is very large therefore also the model to ship extrapolation method used is of critical importance for predicting ship performance in shallow water 6 a shallow water correction for ship speed trials 6 1 lackenby s correction a related development but distinct from model testing concerned a new correction method for ship speed trials raven 2016 usually in the delivery of a new ship from yard to owner speed trials are performed to check compliance with the building contract in most cases the required speed is prescribed for deep water however for practical reasons frequently trials are done in a slightly limited water depth resulting in incipient shallow water effects that reduce the speed achieved a speed correction may then be made supposing a deep water speed slightly higher than what was actually measured until recently the single recommended correction method was lackenby s formula lackenby 1963 which gives a speed correction by 7 v v 0 1242 a m h 2 0 05 1 tanh g h v 2 several objections to this formula have been discussed in raven 2012 2016 based on what was discussed in the previous sections the following remarks are made shallow water effects on viscous and wave resistance depend on different parameters lackenby proposes a formula that contains both parameters but is applied to the total resistance curve the relative magnitude of viscous and wave resistance differs for different vessels and for model and full scale any shallow water correction meant to cover a variety of cases should correct separately for these two resistance components lackenby s formula is based on the method of schlichting 1934 recast in a different form schlichting postulated a depth effect on the wave resistance and derived an additional correction for frictional resistance from the remaining effect in his model data those data were just for 3 very slender ships at high speed the frictional resistance correction thus lacks a sound physical basis but happens to be the dominant part in most practical applications in practice it has been frequently found that the lackenby correction led to too large corrections and improvement was desired 6 2 a new correction procedure a new correction procedure has been developed partly based on the study discussed in section 5 1 this procedure has actually been accepted under the name raven shallow water correction by the international towing tank conference ittc 2017a as an alternative next to the classical lackenby method in order to have other institutes validate it it is noted that in this application there are just incipient shallow water effects which simplifies the problem from the study on water depth effects on viscous resistance the relative increase for model and ship has been found to be very similar for not too shallow cases also for a substantial collection of ships and models the increase of the form factor for decreasing water depth was well approximated by the mean line fig 8 8 c v c v d e e p 1 0 57 t h 1 79 valid for t h 0 5 beyond that value specifics of the ship become more important and disturb the uniform trend as this relation essentially applies to the form factor the increase of the dynamic sinkage in shallow water is not yet incorporated here for wave resistance a computational study has been done for various ships water depths and speeds leading to fig 9 here again computations were done for fixed sinkage and trim as this was found to give a clearer more uniform water depth dependence than with free trim and sinkage from the figure it is noted that the determining parameter is the depth froude number that unless for large t h little uniform trend is visible until fr h 0 7 0 75 with sometimes a little increase or decrease and that wave resistance increases very quickly at higher fr h for the present purpose no change of wave resistance is assumed as long as fr h 0 7 for both resistance components corrections have thus been derived for the effect of shallow water but still disregarding the increase of the dynamic sinkage this is equivalent to the hypothetical case of a ship in shallow water that is too light such that it has unchanged sinkage an additional contribution is therefore needed the effect of the increase of displacement to its true value for this one can resort to an accepted approximation already used in speed trial analysis for the effect of a draft change on resistance it supposes that the total resistance is proportional to δ2 3 in which δ is the ship s displacement to estimate the change of δ a relation has been derived for the increase of the dynamic sinkage caused by shallow water based on a relation from tuck 1966 details are given in raven 2016 thus both resistance components are addressed separately however it requires that the magnitude of the viscous and wave resistance contributions in deep water is known such that corrections to each can be made while in the reference this relative magnitude was an input quantity to be derived from available model tests or just estimated this was considered undesired for a standard procedure for speed trial analysis the procedure has now been adapted to be self contained and is described in ittc 2017b the following steps are made starting from a trial measurement of speed and shaft power estimate additional sinkage in shallow water calculate corresponding displacement increase and reduce measured power by assuming proportionality with δ2 3 estimate viscous resistance in deep water r vdeep calculate c f0 from ittc 57 line estimate form factor 1 k from empirical relation by gross and watanabe increase viscous resistance coefficient by a roughness allowance from townsin s formula apply correction for water depth effect on viscous resistance using the mean line 8 this yields a resistance reduction δr v r vdeep 0 57 t h 1 79 reduce power by δr v v η d where η d is the estimated propulsive efficiency subject to the limitations fn h 0 70 t h 0 5 and displacement change due to sinkage 5 the procedure adjusts the measured power at the trial speed measured 6 3 validation 6 3 1 experimental validation at full scale the easiest way to validate the procedure would be by model tests and this will be shown in section 6 3 b however proper corrections for the limited tank width and a correct model to ship extrapolation are essential for determining the shallow water influence for the ship while for both adequate methods have been proposed sections 2 2 and 5 1 for an indisputable validation of the trial corrections we have essentially resorted to full scale testing even while the less well controlled conditions will cause larger errors and scatter dedicated trials in various water depths have been done for three different ships an inland tanker a dredger and a naval academy vessel the measurements and validations for the first two are discussed in raven 2016 here just the final graphs are shown fig 10 comparing the speed loss in shallow water actually measured and the predicted speed loss the picture is consistent for these ships lackenby s correction overestimates the speed loss the new method is much closer in particular for the not too small water depths in most cases its trend seems correct although some deviations still occur it does remain an approximate procedure based on just very little input of the ship validation for a fourth vessel an lng carrier is shown in ittc 2017a with largely similar outcome 6 3 2 application to model test data let us now apply this shallow water correction to the model test data for the ferry considered before computations for this ship were included in figs 8 and 9 so while now just experimental data are used it may not be a completely independent test but an interesting illustration all the same a range of water depths had been tested but no deep water resistance values are available when the shallow water correction procedure is now applied to the measurements for each depth does one get every time the same deep water curve an important point needs to be made first in speed trials the speed and shaft power are measured not the resistance the present shallow water correction procedure predicts a correction for the resistance at equal speed and the correction for the power follows from the assumption of an unchanged propulsive efficiency so it is the same percentage in lackenby s method however the correction is a speed shift and as power is proportional to resistance speed there is an essential difference between applying the lackenby correction to the resistance curve or to the power curve for the purpose of ship trial analysis the intended way is application to the power curve but as lackenby s formula was derived from schlichting s method which corrected resistance curves one wonders whether lackenby noticed this difference for a proper comparison the curves for effective power pe r t v are compared again assuming that η d is not affected the model test data corrected for tank width effect are used and the shallow water correction is applied to obtain a deep water power curve actually some of the points lie outside the prescribed range of application of the shallow water corrections in particular for the sinkage increase still fig 11 shows that the deep water power curves deduced from the measured data in 3 water depths coincide perfectly until near fr h 0 75 16 5 kn for h 13 1 m 19 3 kn for h 17 8 m the wave resistance starts changing and also the sinkage change exceeds the bounds therefore up to that speed the shallow water correction completely represents the substantial shallow water effects present in these model tests instead lackenby s correction is again too large and the lowest deep water curve is obtained from the measurements in the smallest water depth as a final step the model test data are extrapolated to full scale in the recommended way i e using a water depth dependent form factor obtaining the solid lines in fig 7 next the shallow water correction is applied to the full scale pe curves so found fig 12 shows that again the deep water curves corrected from the predictions for the largest and smallest water depth coincide well for the shallow water correction proposed but not for lackenby s method therefore there is complete consistency between the assumptions in the model to ship extrapolation and the new shallow water correction such that the latter represents the water depth effect both at model and at full scale these results suggest that now we understand precisely what is going on in these model tests with tank wall effects change of the viscous resistance increased dynamic sinkage effects and ultimately an increase of the wave resistance an understanding that was missing 30 years ago when these measurements were done together with the insights gained on the scaling a more solid basis has been given to model testing in shallow water 7 conclusions the main conclusions can be summarised as follows the limited width of a model basin significantly influences the resistance and squat of a model in shallow water it may easily double the apparent water depth effect on the resistance similar effects can occur in rans computations due to limited domain width an approximate method to correct for tank width effects has been proposed it predicts the additional overspeed very well the increase of the resistance and sinkage well as long as these are not too large the model to ship extrapolation of the measurements needs to take into account the increase of the viscous resistance in shallow water and its scaling otherwise the water depth effect on the resistance of the ship is overestimated a form factor extrapolation method with a form factor determined for the actual water depth has been found to be an adequate method a simple model for incipient effects of shallow water on the resistance has been derived and has been accepted as a possible correction procedure for ship speed trials by the ittc this shallow water correction procedure agrees very well with the water depth influence in the example model test data and equally well with the water depth influence in the full scale predictions derived from the model test data by the extrapolation method advocated it is considered the steps made in this research thus have given a more solid basis to model testing in shallow water and to the prediction of ship performance based on it acknowledgement the research leading to this paper has been largely funded by the dutch ministry of economic affairs the full scale validation in section 6 has been supported by the sea trial analysis sta group and by nederland maritiem land in the shoals power project grant ic miip230913 216 this support is gratefully acknowledged 
22517,this paper addresses shallow water ship model testing and the determination of water depth effects on ship resistance it is shown how effects of water depth towing tank width and the scaling of viscous resistance interact and are of large importance for ship performance prediction a new method to correct model tests for tank width effects is briefly described for a set of shallow water model test data it is shown how tank width effects apparently double the water depth influence also the model to ship extrapolation strongly affects the predicted water depth effect for the ship easily leading to an overestimation the procedure to be used with a depth dependent form factor is proposed a new procedure to correct ship speed trials for water depth effects is introduced and validations are shown with full scale trial data with the same set of model test data and with the full scale predictions based on these keywords ship resistance shallow water tank width scale effect trial correction squat nomenclature a m midship sectional area of ship m2 b width of model basin or channel m c t total resistance coefficient c ts c tm total resistance coefficient for ship and model c w wave resistance coefficient c v viscous resistance coefficient c f0 flat plate friction coefficient fr h depth froude number h water depth m re reynolds number r m model total resistance n r t total resistance n r w wave resistance n t ship draft m u longitudinal flow velocity m s v m model speed m s zs dynamic sinkage m 1 k form factor β blockage a m bh γ overspeed ratio δ ship displacement m3 δγ additional overspeed ratio in channel η d propulsive efficiency ν kinematic viscosity m2 s ρ density of water kg m3 1 introduction shallow water normally increases a ship s resistance required power and squat for estimating the performance of a ship in shallow water model tests are frequently done but also available empirical estimation methods for shallow water effects are largely based on model test data examples of such methods are schlichting 1934 lackenby 1963 jiang 2001 however shallow water model tests are affected by the limited width of the model basin far more than deep water model tests in the present paper it is demonstrated to what extent the model basin width can affect the apparent water depth influence and how it can easily lead to wrong conclusions a new approximate method to correct model test data for this tank width effect was recently published raven 2018 and is outlined and demonstrated below it is pointed out that it is essential to distinguish 3 different physical effects often occurring simultaneously 1 effect of limited depth on viscous resistance 2 effect of limited depth on wave resistance and squat 3 effect of limited width on resistance and squat as for a given model basin width effect 3 increases with decreasing water depth ignoring it yields wrong results for 1 and 2 separate computational studies have been done on effects 1 and 2 raven 2012 2016 these respond to different water depth parameters therefore it is important to deal with them separately for model and ship there is a different relative importance of viscous and wave resistance and thereby also a different dependence of the total resistance on water depth it is shown that the model to ship extrapolation method used has a large influence on the assumed water depth effect for the ship at full scale which is another aspect apparently neglected so far a naïve application of usual methods yields a much stronger shallow water effect on resistance for the ship than for the model the paper is set up as follows in section 2 the effect of model basin or channel width is discussed and the correction method is described in section 3 it is applied to model test data for a ferry in shallow water demonstrating the large effect on the apparent water depth influence section 4 addresses the model to ship extrapolation of the measured data a computational study on the scaling of the viscous resistance and its shallow water effect is discussed in section 5 and the required model to ship extrapolation approach is indicated in section 6 the related development of a correction procedure for small shallow water effects in ship speed trials is considered and some validations with full scale and model scale data are shown thus the paper summarises synthesises and illustrates some of the research on shallow water hydrodynamics done in recent years at marin 2 finite width effects on ship resistance and flow 2 1 general in ship model testing usually the measurements should lead to a prediction for infinite waterway width the finite width of the model basin then is a disturbing factor in particular in shallow water the magnitude of this disturbance is considered a ship model in a towing tank of width b and depth h is considered the flow is described in a coordinate system moving with the model so there is an incoming flow with velocity v m from ahead the flow speed next to the model must be larger than v m to let all water pass the larger the blockage β ratio of model cross section to tank cross section the larger this overspeed also called return flow but the increased flow speed causes a drop of the water level next to the model which also results in an increased dynamic sinkage of the ship both lead to a further reduction of the tank cross section and a resulting further increase of the flow speed kreitner 1934 proposed a simple estimation for these effects by assuming that the flow speed is uniformly distributed over the channel cross section which is a good approximation for a ship with a long parallel midbody in a narrow channel consistently he assumed the sinkage of the ship to be equal to the drop of the water level which in turn follows from the bernoulli equation the resulting expression for the overspeed ratio γ u v m with u the longitudinal component of the flow velocity next to the ship is 1 γ 1 β 1 2 f r h 2 1 γ 2 1 where the depth froude number f r h v g h in practical applications for ships with a not so long parallel midbody the overspeed is not uniformly distributed but kreitner s formula still provides a useful estimate of the mean overspeed over the channel section at the midship position however this is not what is needed for estimating finite width effects the objective is to compare the overspeed in a model basin of restricted width and that in infinitely wide water of equal depth but for the latter there is zero blockage and kreitner s formula yields zero overspeed just as for an infinite depth case essentially kreitner yields the difference with a case of infinite width and infinite depth not equal depth the use of a virtual tank width has sometimes been proposed in order to get an overspeed value for infinite width but as that virtual width should depend on the depth froude number again this seems an unpromising approach useful other methods to deal with just the finite width effect tank wall effect seemed not to be available 2 2 a correction method for tank wall effects in raven 2018 a new method to correct resistance and squat measurements for the effect of the finite tank width has been proposed the first step is to estimate the difference in overspeed along the hull between the situations of finite and infinite width at equal water depth to study this flow computations have been made for ships in various water depths and channel widths the free surface potential flow code rapid raven 1996 has been used for this it computes the inviscid flow along a ship hull in restricted or unrestricted water using a panel method source panels are distributed over the ship hull surface and a surrounding part of the water surface an iterative solution is required as the free surface boundary conditions are nonlinear and the dynamic trim and sinkage need to be incorporated this method is in continuous use for ship design at marin and elsewhere since 1994 some of the required adjustments for application to ships in narrow channels are described in raven 2018 fig 1 shows the computed distribution of the longitudinal flow velocity at the water surface next to the midship section of a given model the ship hull is at the left of the figure y 0 is the centreplane and the lines start at the ship s waterline the lower line is for deep water of infinite width there is just a little overspeed next to the model plus a disturbance where a diverging bow wave passes also seen in all other lines the line just above it is for shallow water h t 1 54 of infinite width the overspeed is a lot larger here and extends to much larger distances as a result of the more two dimensional situation the other 3 lines are for the same ship at the same speed in the same water depth but in channels of different widths the channel walls further increase the overspeed and the mean overspeed is fairly well indicated by kreitner s formula however the pure tank wall effect is just the difference between the overspeed in a shallow channel and that in shallow water of infinite width and that is a much smaller quantity e g for the channel with b l 1 31 kreitner predicts 11 3 overspeed but the actual channel wall contribution is just some 5 remarkably this additional overspeed caused by the tank walls is quite constantly distributed over the channel section the line for shallow water seems just shifted upward by a small amount as discussed in raven 2018 this can be understood from the similar streamline curvature in the different cases the new estimation method now is built on this assumption of a uniformly distributed additional overspeed note that this is a different assumption than kreitner s who assumed the entire overspeed to be constant over the channel cross section which clearly is not the case here as derived in raven 2018 the additional overspeed as a fraction of ship speed δ γ u c h a n n e l u s h a l l o w v can be solved from the following equation 2 δ γ 1 β 1 2 f r h 2 1 3 γ 2 3 γ δ γ δ γ 2 q o u t v a c in which γ is the overspeed ratio in shallow water of infinite width averaged over the width of the channel the equation is clearly similar to kreitner s but provides the additional overspeed the upward shift of the lines for the channels in fig 1 like kreitner s formula it predicts a quick increase of the additional overspeed when the speed approaches the critical channel speed the term at the right hand side is explained in fig 2 a sketch with the same setup as fig 1 if a comparison is made between the overspeed for the ship in a shallow channel and in shallow water of infinite width in the latter case there is still an overspeed occurring outside the location of the channel wall indicated by the blue area this overspeed carries an excess volume flux q out but in the channel case that excess flux has to be accommodated inside the channel walls it is this additional volume flux q out that determines the increase of the overspeed due to the channel walls as indicated by the yellow area while the flux is equal the areas in this graph are not since due to the additional drop of the water level the overspeed increase is relatively large to actually calculate the overspeed increase for a given ship in a shallow channel a single free surface potential flow computation for the same case in water of unlimited width and equal depth is made from this the nondimensional flux q out v a c the mean overspeed ratio over a part of the water surface γ and the mean overspeed ratio along the ship s waterline in shallow water of infinite width γ w l u w l v are deduced it is noted that the integration for q out would need to be extended to infinity but a way to evaluate it from the finite domain potential flow computation is described in raven 2018 to good approximation these quantities can subsequently be used for a range of speeds and channel widths after substitution in eq 2 the overspeed increase is obtained immediately an increase of the dynamic sinkage z s caused by the tank walls is also obtained as 3 z s c h a n n e l z s s h a l l o w 1 2 f r h 2 h 2 γ w l δ γ δ γ 2 as shown in the reference this method provides a good estimation of the overspeed increase δ γ caused by the limited channel width for the same case as in figs 1 and 3 illustrates this the estimated lines are found by adding δ γ from eq 2 to the computed overspeed distribution in shallow water of unlimited width the agreement with the lines directly computed is quite good the main deviation is due to the fact that for narrower channels an inward shift of the peaks related with the diverging bow wave occurs which is not caught by a constant δ γ this shift indicates an increasing divergence angle of the bow wave here primarily caused by refraction effects due to the accelerating flow an interesting detail but not our concern here now that the overspeed increase can be estimated an assumption is still needed to estimate its effect on the ship s resistance one can resort to a simplification made in most earlier blockage correctors that the effect on resistance corresponds with that of a model speed increase equal to the relative increase of the flow speed along the hull caused by the additional overspeed 4 v m s h a l l o w v m t a n k 1 δ γ γ w l r t s h a l l o w v m s h a l l o w r t t a n k v m t a n k this amounts to a shift of the points of the resistance curve measured in the towing tank to a slightly higher speed this correction is made prior to the further processing of the model test data besides the measured dynamic sinkage values are corrected using eq 3 while the procedure may seem complicated in practice it is straightforward from the result of the potential flow computation a postprocessor evaluates the required coefficients and solves eq 2 for all input model speeds the corrected model speeds and sinkage corrections are output immediately the method is used for all shallow water resistance tests at marin since several years validations raven 2018 garenaux et al 2019 have shown that the additional overspeed is estimated quite well and that the resulting estimate of the effect on resistance appears to be valid as long as the correction is not too large e g a speed correction up to 5 therefore use of the method is limited to cases not too close to critical channel speed the sinkage correction was found to be accurate for not too large corrections but tends to overestimate for stronger effects in passing an alternative use of the correction can be mentioned for predicting the speed loss of a ship in channels of various widths from the known speed in shallow water of infinite width 3 effect of water depth on resistance of a ferry model as an illustration a set of older model test data for a ferry of 150 m length 28 m beam and 6 m draft is considered model scale was 20 5 the basin width was 2 16 times the model length almost 12 times the model beam five water depths were tested from 13 1 to 22 5 m the dashed lines in fig 4 are the measured model resistance curves for 3 water depths with decreasing water depth the resistance increases significantly and the steep part of the curve shifts to lower speeds for the smallest water depth the critical shallow water speed fr h 1 corresponds with 22 kn beyond the range of the measurements but the blockage β 0 0386 so the highest speed of 17 kn ship scale is near critical channel speed so serious effects of the towing tank width are present if the tank width correction is applied one gets the corresponding curves shown as solid lines the smaller the water depth and the higher the speed the larger is the correction towards the higher speeds the lines become significantly less steep and the difference between the curves for different water depths is reduced for the highest speeds in the two smaller water depths though one cannot precisely trust the correction as it is larger than what the simple assumptions permit to determine the effect of water depth on model resistance the lines in fig 4 are intersected at constant speeds of 15 and 16 5 kn and fig 5 is obtained there is a large difference of the apparent water depth effect between the uncorrected and corrected model measurements the uncorrected data suggest a depth influence on resistance twice as large as the corrected data much of this actually is a towing tank width effect one is largely looking at the wrong physics fig 6 shows the increase of the dynamic sinkage squat for decreasing water depth at 16 5 kn speed here the tank width correction is even more important and is still significant for the largest water depth while not always as accurate this correction at least can be considered as indicative it is concluded that in model testing in shallow water it is essential to apply a correction for the finite width of the model basin otherwise misleading results may be obtained with a far too strong apparent water depth effect it seems likely that similar errors have affected data underlying empirical estimation methods for the water depth effect both for resistance and for squat unless tank width or blockage has been taken into account explicitly the different tank widths used possibly explain the large mutual discrepancy of empirical squat formulas 4 scaling of shallow water model test data 4 1 model to ship extrapolation so far model test results corrected for the effect of the finite width of the model basin have been derived to predict the resistance of the ship at full scale from these model to ship extrapolation techniques are to be applied see e g larsson and raven 2010 ch 8 model resistance tests are done at equal length froude number as the ship and according to froude s hypothesis a part of the resistance essentially associated with wave making can then be directly scaled up by multiplication with model scale to the third power the other part related with the viscous flow depends on the reynolds number re which differs much between model and ship therefore this part needs to be scaled up differently the simplification is 5 c t f r r e c w f r c v re such that 6 c t s f r r e s c t m f r r e m c v re m c v re s here the resistance coefficients are defined as c t r t 1 2 ρ v 2 s where s is the wetted surface different assumptions can be made for this difference of the viscous resistance coefficients at ship and model reynolds number in the classical froude extrapolation method the viscous resistance coefficient is simply taken equal to the frictional resistance coefficient of a flat plate at equal reynolds number c f0 re the remaining part consisting of wave resistance and some viscous components is called residuary resistance instead of flat plate friction coefficients often a somewhat adjusted expression is used the so called ittc 57 model ship correlation line alternatively the viscous resistance coefficient of the ship as a function of the reynolds number is supposed to be proportional to the flat plate friction coefficient or ittc 57 coefficient c v r e 1 k c f 0 r e the proportionality constant 1 k is called the form factor it depends on the hull form increasing with the fullness of the hull normal values lying between 1 1 and 1 4 its value can either be found from low speed resistance tests or from empirical relations expressed in geometric properties of the hull form while in essence these methods lead to different full scale resistance predictions much of the difference is compensated by empirical correlation allowances that are ultimately added deduced from experimental full scale trial data these allowances are specific for each extrapolation method and on average bring all of them to the level measured in full scale trials 4 2 application to shallow water model tests applying different model to ship extrapolation methods to shallow water tests however may cause very large differences consider the same ferry model data for speed 16 5 kn without correcting for the tank width effect the increase of the resistance for decreasing water depth is exaggerated as seen before in water depth 13 1 m the measured model resistance is 41 5 higher than for depth 22 5 m if now the froude model to ship extrapolation is applied flat plate friction remains flat plate friction and all this resistance increase is absorbed in the remainder the residuary resistance coefficient which is supposed equal for model and ship but the frictional resistance coefficient of the ship at full scale is roughly half of that of the model the residuary resistance and thereby the shallow water resistance increase thus counts more strongly for the ship in the prediction for the ship the resistance in 13 1 m water depth now comes out as 56 higher than that for 22 5 m water depth if as advocated first the model data are corrected for the tank width effect the shallow water resistance increase at model scale becomes 18 that at full scale 24 still an appreciable difference for this vessel the form factor in deep water has been found as 1 k 1 22 using that form factor in the extrapolation the shallow water resistance increase is still absorbed in the wave resistance part and supposed equal for the ship which yields again a 24 difference between both water depths thus it appears that both model to ship extrapolation methods as naively applied here lead to the conclusion that the shallow water effect on resistance is significantly larger for the ship than for the model but this critically depends on how the viscous resistance is affected by shallow water this is considered in the next section 5 effect of water depth on ship viscous resistance 5 1 a computational study the effect of water depth on the flow around the hull is a lot more specific than that of the tank width while tank walls are always fairly remote and were shown to cause a rather constant overspeed increase the bottom can be quite close and can lead to a more horizontal flow past the hull larger streamline curvature larger pressure gradients earlier flow separation it is likely that the viscous resistance increases by this a study has been done on this effect raven 2012 using viscous flow computations by a rans code to obtain a pure viscous resistance double body flow computations have been made i e computations in which wave making is omitted and the still water surface is modelled as a symmetry plane the ratio of the resulting viscous resistance coefficient to the ittc 57 friction coefficient is the form factor 1 k which then normally is assumed to be independent of the reynolds number however computations have been made for model and ship reynolds numbers to verify the equality of the form factor in shallow water one particular issue in such computations is again to avoid channel effects in many rans codes at the side boundaries of the domain either a free slip boundary condition can be imposed or some sort of constant pressure condition both are inadequate for shallow water cases and would act more or less as a channel flow introducing the same false water depth effects as were discussed before in the study done computations have been made using the parnassos code hoekstra 1999 which has a particular treatment of the boundary conditions on the lateral boundaries of the domain adequately simulating an infinite domain width in raven 2012 4 ships of very different type are considered each in several water depths the overall conclusion was that the viscous resistance increases strongly with decreasing water depth fig 8 moreover the relative increase of the viscous resistance was found to be very similar for model and full scale at least for not too shallow situations t h 0 5 this was confirmed later for other cases for the model to ship extrapolation this means the following the relative increase of the viscous resistance in shallow water by a factor c v c vdeep is supposed equal for model and ship as was found in the study the assumption for the viscous resistance thus becomes c v r e h c v c v d e e p t h 1 k c f 0 r e the shallow water form factor 1 k c v c v d e e p t h 1 k can be found from low speed tests in the water depth considered or alternatively c v c vdeep can be estimated from a general relation thus a large part of the resistance increase in shallow water is correctly interpreted as viscous resistance not as an increase of the wave or residuary resistance this part decreases from model to ship consequently the resulting full scale resistance prediction in shallow water comes out as lower 5 2 application to ferry model the ferry model is reconsidered from the measurements form factors in shallow water could be estimated for water depth 22 5 m 1 k 1 27 for water depth 13 1 m 1 k 1 39 so the viscous resistance has increased by 14 compared with the deep water value 1 k 1 22 for 16 5 kn half of the resistance increase from depth 22 5 m to depth 13 1 m is a viscous resistance increase then extrapolating to full scale a total resistance difference between both water depths of 19 is found actually very close to the percentage resistance increase at model scale note that 56 and 24 were obtained before fig 7 shows the complete ship resistance coefficient curves against speed obtained with different extrapolation methods the froude extrapolation of the model data uncorrected for tank wall effect dotted lines suggests a very large shallow water effect and high level of the resistance the dashed lines were found by froude extrapolation of the data corrected for tank wall effects the solid lines are found by using a depth dependent form factor 1 k in the extrapolation of the data corrected for tank wall effects our recommended method the effect of the tank width corrections is dominant for the higher speeds the model to ship extrapolation method has more influence at lower speeds the joint effect on the full scale prediction is very large therefore also the model to ship extrapolation method used is of critical importance for predicting ship performance in shallow water 6 a shallow water correction for ship speed trials 6 1 lackenby s correction a related development but distinct from model testing concerned a new correction method for ship speed trials raven 2016 usually in the delivery of a new ship from yard to owner speed trials are performed to check compliance with the building contract in most cases the required speed is prescribed for deep water however for practical reasons frequently trials are done in a slightly limited water depth resulting in incipient shallow water effects that reduce the speed achieved a speed correction may then be made supposing a deep water speed slightly higher than what was actually measured until recently the single recommended correction method was lackenby s formula lackenby 1963 which gives a speed correction by 7 v v 0 1242 a m h 2 0 05 1 tanh g h v 2 several objections to this formula have been discussed in raven 2012 2016 based on what was discussed in the previous sections the following remarks are made shallow water effects on viscous and wave resistance depend on different parameters lackenby proposes a formula that contains both parameters but is applied to the total resistance curve the relative magnitude of viscous and wave resistance differs for different vessels and for model and full scale any shallow water correction meant to cover a variety of cases should correct separately for these two resistance components lackenby s formula is based on the method of schlichting 1934 recast in a different form schlichting postulated a depth effect on the wave resistance and derived an additional correction for frictional resistance from the remaining effect in his model data those data were just for 3 very slender ships at high speed the frictional resistance correction thus lacks a sound physical basis but happens to be the dominant part in most practical applications in practice it has been frequently found that the lackenby correction led to too large corrections and improvement was desired 6 2 a new correction procedure a new correction procedure has been developed partly based on the study discussed in section 5 1 this procedure has actually been accepted under the name raven shallow water correction by the international towing tank conference ittc 2017a as an alternative next to the classical lackenby method in order to have other institutes validate it it is noted that in this application there are just incipient shallow water effects which simplifies the problem from the study on water depth effects on viscous resistance the relative increase for model and ship has been found to be very similar for not too shallow cases also for a substantial collection of ships and models the increase of the form factor for decreasing water depth was well approximated by the mean line fig 8 8 c v c v d e e p 1 0 57 t h 1 79 valid for t h 0 5 beyond that value specifics of the ship become more important and disturb the uniform trend as this relation essentially applies to the form factor the increase of the dynamic sinkage in shallow water is not yet incorporated here for wave resistance a computational study has been done for various ships water depths and speeds leading to fig 9 here again computations were done for fixed sinkage and trim as this was found to give a clearer more uniform water depth dependence than with free trim and sinkage from the figure it is noted that the determining parameter is the depth froude number that unless for large t h little uniform trend is visible until fr h 0 7 0 75 with sometimes a little increase or decrease and that wave resistance increases very quickly at higher fr h for the present purpose no change of wave resistance is assumed as long as fr h 0 7 for both resistance components corrections have thus been derived for the effect of shallow water but still disregarding the increase of the dynamic sinkage this is equivalent to the hypothetical case of a ship in shallow water that is too light such that it has unchanged sinkage an additional contribution is therefore needed the effect of the increase of displacement to its true value for this one can resort to an accepted approximation already used in speed trial analysis for the effect of a draft change on resistance it supposes that the total resistance is proportional to δ2 3 in which δ is the ship s displacement to estimate the change of δ a relation has been derived for the increase of the dynamic sinkage caused by shallow water based on a relation from tuck 1966 details are given in raven 2016 thus both resistance components are addressed separately however it requires that the magnitude of the viscous and wave resistance contributions in deep water is known such that corrections to each can be made while in the reference this relative magnitude was an input quantity to be derived from available model tests or just estimated this was considered undesired for a standard procedure for speed trial analysis the procedure has now been adapted to be self contained and is described in ittc 2017b the following steps are made starting from a trial measurement of speed and shaft power estimate additional sinkage in shallow water calculate corresponding displacement increase and reduce measured power by assuming proportionality with δ2 3 estimate viscous resistance in deep water r vdeep calculate c f0 from ittc 57 line estimate form factor 1 k from empirical relation by gross and watanabe increase viscous resistance coefficient by a roughness allowance from townsin s formula apply correction for water depth effect on viscous resistance using the mean line 8 this yields a resistance reduction δr v r vdeep 0 57 t h 1 79 reduce power by δr v v η d where η d is the estimated propulsive efficiency subject to the limitations fn h 0 70 t h 0 5 and displacement change due to sinkage 5 the procedure adjusts the measured power at the trial speed measured 6 3 validation 6 3 1 experimental validation at full scale the easiest way to validate the procedure would be by model tests and this will be shown in section 6 3 b however proper corrections for the limited tank width and a correct model to ship extrapolation are essential for determining the shallow water influence for the ship while for both adequate methods have been proposed sections 2 2 and 5 1 for an indisputable validation of the trial corrections we have essentially resorted to full scale testing even while the less well controlled conditions will cause larger errors and scatter dedicated trials in various water depths have been done for three different ships an inland tanker a dredger and a naval academy vessel the measurements and validations for the first two are discussed in raven 2016 here just the final graphs are shown fig 10 comparing the speed loss in shallow water actually measured and the predicted speed loss the picture is consistent for these ships lackenby s correction overestimates the speed loss the new method is much closer in particular for the not too small water depths in most cases its trend seems correct although some deviations still occur it does remain an approximate procedure based on just very little input of the ship validation for a fourth vessel an lng carrier is shown in ittc 2017a with largely similar outcome 6 3 2 application to model test data let us now apply this shallow water correction to the model test data for the ferry considered before computations for this ship were included in figs 8 and 9 so while now just experimental data are used it may not be a completely independent test but an interesting illustration all the same a range of water depths had been tested but no deep water resistance values are available when the shallow water correction procedure is now applied to the measurements for each depth does one get every time the same deep water curve an important point needs to be made first in speed trials the speed and shaft power are measured not the resistance the present shallow water correction procedure predicts a correction for the resistance at equal speed and the correction for the power follows from the assumption of an unchanged propulsive efficiency so it is the same percentage in lackenby s method however the correction is a speed shift and as power is proportional to resistance speed there is an essential difference between applying the lackenby correction to the resistance curve or to the power curve for the purpose of ship trial analysis the intended way is application to the power curve but as lackenby s formula was derived from schlichting s method which corrected resistance curves one wonders whether lackenby noticed this difference for a proper comparison the curves for effective power pe r t v are compared again assuming that η d is not affected the model test data corrected for tank width effect are used and the shallow water correction is applied to obtain a deep water power curve actually some of the points lie outside the prescribed range of application of the shallow water corrections in particular for the sinkage increase still fig 11 shows that the deep water power curves deduced from the measured data in 3 water depths coincide perfectly until near fr h 0 75 16 5 kn for h 13 1 m 19 3 kn for h 17 8 m the wave resistance starts changing and also the sinkage change exceeds the bounds therefore up to that speed the shallow water correction completely represents the substantial shallow water effects present in these model tests instead lackenby s correction is again too large and the lowest deep water curve is obtained from the measurements in the smallest water depth as a final step the model test data are extrapolated to full scale in the recommended way i e using a water depth dependent form factor obtaining the solid lines in fig 7 next the shallow water correction is applied to the full scale pe curves so found fig 12 shows that again the deep water curves corrected from the predictions for the largest and smallest water depth coincide well for the shallow water correction proposed but not for lackenby s method therefore there is complete consistency between the assumptions in the model to ship extrapolation and the new shallow water correction such that the latter represents the water depth effect both at model and at full scale these results suggest that now we understand precisely what is going on in these model tests with tank wall effects change of the viscous resistance increased dynamic sinkage effects and ultimately an increase of the wave resistance an understanding that was missing 30 years ago when these measurements were done together with the insights gained on the scaling a more solid basis has been given to model testing in shallow water 7 conclusions the main conclusions can be summarised as follows the limited width of a model basin significantly influences the resistance and squat of a model in shallow water it may easily double the apparent water depth effect on the resistance similar effects can occur in rans computations due to limited domain width an approximate method to correct for tank width effects has been proposed it predicts the additional overspeed very well the increase of the resistance and sinkage well as long as these are not too large the model to ship extrapolation of the measurements needs to take into account the increase of the viscous resistance in shallow water and its scaling otherwise the water depth effect on the resistance of the ship is overestimated a form factor extrapolation method with a form factor determined for the actual water depth has been found to be an adequate method a simple model for incipient effects of shallow water on the resistance has been derived and has been accepted as a possible correction procedure for ship speed trials by the ittc this shallow water correction procedure agrees very well with the water depth influence in the example model test data and equally well with the water depth influence in the full scale predictions derived from the model test data by the extrapolation method advocated it is considered the steps made in this research thus have given a more solid basis to model testing in shallow water and to the prediction of ship performance based on it acknowledgement the research leading to this paper has been largely funded by the dutch ministry of economic affairs the full scale validation in section 6 has been supported by the sea trial analysis sta group and by nederland maritiem land in the shoals power project grant ic miip230913 216 this support is gratefully acknowledged 
22518,the ocean bottom flying node obfn belongs to autonomous underwater vehicle auv designed for detecting seabed resources when considering model uncertainties external disturbances and thruster faults by applying the nonsingular fast terminal sliding mode technique a distributed finite time fault tolerant error constraint containment control method for multiple obfn systems is proposed under directed communication topology besides only a part of follower obfns can get the information of leader obfns first the error constraint strategy is considered to improve the system performance while the defined error variable of containment control was converted into a suitable form then by choosing the appropriate nonsingular fast terminal sliding surface the systems states can reach the sliding surface in finite time such that the follower obfns could converge to the convex hull formed by the leader obfns in finite time neural network nn is employed to estimate and compensate the general disturbances consisting of model uncertainties external disturbances and thruster faults an adaptive law is designed to compensate the upper bound of the estimation errors the finite time stability of the systems and the boundedness of containment errors are proved by utilizing graph theory finite time theory and lyapunov technique numerical simulations under different types of thruster faults are given to show the effectiveness of the proposed methods keywords multiple auv systems obfn systems distributed containment control error constraint fault tolerant control finite time control 1 introduction cooperative control of multiple auv systems have attracted great attention in recent years the application of multi auv collaborative control technology is also highly diversified such as ocean survey and mapping military surveillance and defense search and rescue and resource detection compared with single auv the multiple auv systems have better adaptability and stability since the ocean resources detection is more and more important it is more reasonable and reliable to apply cooperative control technology for multiple auv systems resource detection is usually completed through detecting the information of submarine earthquake in order to complete a detection system for submarine earthquake wave with a capacity of large scale autonomous placement and recover we design a group of obfns compared with the seabed resource detection system which have been developed the multiple obfn systems have higher applicability and lower economic cost fabiani et al 2018 in reality obfn is a kind of auv for the problem of coordinated control for multiple auv systems many methods have been proposed in the early studies there are two main control types for this problem which are centralized control and distributed control for centralized control systems the control signals of all auvs need to be transmitted by the operators or a specific auv in the systems compared with centralized systems each auv only needs to obtain the information of neighbor auvs in the distributed systems yamchi and esfanjani 2017 ni et al 2018 thus distributed control systems have higher efficiency extensibility and stability and much wider application in engineering in order to solve the problem of coordinated path following for multiple auv systems wang et al 2018 improved the global information of the reference speed through proposing a distributed speed estimator then path following control algorithms were designed to ensure all auvs could move to the desired position while nn shojaei 2016 zhao and jia 2016 hua et al 2017 ma et al 2017 was used to estimate the general system uncertainties under obstacle free and obstacle rich environments sahu and subudhi 2017 held the whole systems connected in a group by estimating a flocking center for tracking a target in presence of varying velocities yan et al 2018 designed distributed cooperative target tracking control algorithms in two cases for distributed control systems the communication topology describes the information transfer relationships among the auvs generally it can be divided into two categories that is undirected communication topology and directed communication topology the methods proposed by wang et al 2018 sahu and subudhi 2017 and yan et al 2018 were investigated based on undirected communication topologies which had a high demand for communication systems since the information transfer was bidirectional besides when there exist communication errors in the systems the distributed control approaches based on undirected communication topology may be useless on the contrary the distributed control based on directed communication topology can be realized only if a directed spanning tree is contained in the graph therefore the control approaches based on directed communication topology are more valuable for further research based on directed communication topology yuan et al 2018 investigated the problem of formation learning control for multiple auv systems in presence of heterogeneous nonlinear uncertain dynamics in order to improve the guidance signal with velocity constraint and minimize the instantaneous control torque peng et al 2018 generated an optimal guidance signal by employing an optimization based command governor and the distributed maneuvering problem of multiple surface vehicles was researched based on directed topology for multiple auv systems when the position and orientation informations were transmitted in a discrete time sequence the coordinated control for multiple auv systems was investigated under directed topology by ma and zeng 2015 for the problem of coordinated control for multiple auv systems according to the number of leaders it can be divided into distributed consensus control without leaders distributed tracking control with one leader and distributed containment control with multiple leaders however the researches in ma and zeng 2015 peng et al 2018 and yuan et al 2018 were investigated without leaders the control strategies proposed are not applicable to the problem of tracking control with one leader thus further researches are needed when considering the input saturation uncertainties and external disturbances by employing sliding mode technique and consensus theorem zhang et al 2017 proposed an adaptive synchronization control method to enable all the auvs to track the desired attitude cooperatively the problem of cooperative dynamic positioning control for multiple vessels was investigated by peng et al 2016 the authors proposed distributed control approaches based on output feedback and state feedback respectively when only the position information was measured enayat and khorasani 2017 designed nonlinear semi decentralized or distributed coordinated control algorithms for multiple auv systems based on the dynamic surface control approach however the control algorithms proposed in peng et al 2016 enayat and khorasani 2017 and zhang et al 2017 could not solve the problem of containment control with multiple leaders by using containment control approach for multiple obfn systems the follower obfns can move in a convex hull formed by leader obfns and the cost of equipments could reduce since the systems can move to the target area together when only leader obfns obtain the information from the surface mother ship that is to say only the leaders take the equipments to communicate with the surface mother ship over long distances while the followers only need the equipments to communicate with the neighbor obfns in the field of ocean vehicles the problem of containment control has been studied by some researchers when the dynamics and disturbances of each auv were assumed to be smooth klotz et al 2016 proposed a distributed control method then the states of every follower could asymptotically converge to the convex hull formed by a random number of leaders with time varying states peng et al 2015 put forward a novel predictor based neural dynamic surface control strategy to design the adaptive containment control strategy the authors also constructed iterative neural updating laws based on prediction errors which were used to identify exactly the unknown dynamics of every vehicle based on directed topology yoo and park 2017 assumed that the position information of leaders was transmitted to a part of followers and the distributed containment control for multiple underactuated surface vessels was achieved the local control approaches were designed for all followers by utilizing the predefined performance design method while the auxiliary variables were proposed to handle underactuated constraints in the design framework of predefined performance when only a small part of followers could receive the velocity update information of predetermined paths peng et al 2017 investigated the containment control for multiple surface vessels and proposed an adaptive control design approach with the ability to modularize the estimator and the control law then a filtering update system and a maneuvering error feedback were used to design two path update laws respectively it should be noted that the results in peng et al 2015 klotz et al 2016 peng et al 2017 and yoo and park 2017 could only achieve asymptotic convergence of the systems but cannot meet the requirement of convergence speed in some cases by using finite time control approach convergence can be accomplished in finite time thus the system performance will be optimized fu and wang 2016 presented an observer based distributed control protocol for followers through utilizing the sliding mode control technique and the problem of finite time containment control was solved under directed topology only based on local information the problem of distributed finite time event triggered consensus control was investigated by zhang et al 2016 by using the global finite time stability theory of the discontinuous homogeneous systems liu et al 2017 proposed a new finite time discontinuous disturbance observer when taking into account the nonuniform gradient gains a common convex constraint set and the finite time convergence requirement lin et al 2017 investigated the problem of distributed optimization with differentiable convex objective functions however fault tolerant control was not considered in fu and wang 2016 zhang et al 2016 lin et al 2017 and liu et al 2017 if the thruster faults occur during the navigation the tasks may not be completed successfully when the multiple obfn systems sail in the ocean thrusters can easily have faults because of the complexity of the environment therefore the fault tolerant performance of the systems is crucial to accomplish tasks by using the information of nearest agent gallehdari et al 2016 ensured the team consensus and designed the on line distributed control reconfiguration methods the distributed hamilton jacobi bellman functions were derived for the fault agents and new reconfigured control laws were proposed through solving the above functions to guarantee fault accommodation of the systems under leaderless and leader follower cases chen and ho 2016 addressed two new fault tolerant consensus control protocols and emphasized the distributed control methods to solve the information transmission faults for multiple auv systems for the distributed formation control problem of multiple auv systems li and zhu 2018 developed an adaptive self organizing map nn strategy to ensure the systems can move into an expected formation shape each auv was treated as the leader and the followers thus fault tolerance and adaption were achieved davoodi et al 2016 designed distributed detection filters by utilizing only relative output information among the agents and all the agents reached either a model reference consensus or a state consensus while the faults in the systems were detected by the agents cooperatively however chen and ho 2016 davoodi et al 2016 gallehdari et al 2016 and li and zhu 2018 did not investigate the problem of error constraint the error can increase due to the existence of thruster faults thus it is necessary to constrain the errors to optimize the performance of the multiple obfn systems in presence of position tracking error constraint won et al 2015 designed a high gain disturbance observer in order to ensure the system had the position tracking error constraint the authors presented a backstepping control method through applying the barrier lyapunov function li et al 2018 investigated the problem of finite time consensus tracking with error constraints by utilizing the barrier lyapunov function the error constrained control problem was investigated and a novel distributed finite time consensus algorithm was designed when considering tracking error constraints tong et al 2017 established a fuzzy adaptive observer to approximate the unmeasured states based on dynamic surface backstepping recursive design approach the authors presented a partial fuzzy output feedback control strategy by converting the tracking errors into novel virtual error variables when considering the error constraint and input saturation zheng and xie 2017 handled the error constraints of attitude and position through merging a tan type barrier lyapunov function into attitude and guidance control methods based on the researches above under directed commination topology this paper investigates the problem of distributed finite time fault tolerant error constraint containment control for multiple obfn systems in presence of model uncertainties external disturbances and thruster faults the information of leaders can be achieved by a part of followers compared with previous studies the advantages of this research are listed as follows a in presence of thruster faults a distributed finite time fault tolerant error constraint containment control protocol for multiple obfn systems is designed by applying nonsingular fast terminal sliding mode technique the thruster fault is considered together with model uncertainties and external disturbances to reduce the analysis complexity b for the multiple obfn systems an error constraint controller is proposed the convergence speed and overshoot phenomenon of the systems are optimized by considering the error constraint c the model uncertainties external disturbances and thruster faults are approximated by using nn strategy and the ability of fault tolerant and error constraint for the multiple obfn systems is not influenced by this handling method the remainder of this paper is organized as follows some preliminary information and problem statement are given in section 2 in section 3 we consider the error constraint to optimize the control performance of systems a distributed finite time fault tolerant error constraint containment control protocol for multiple obfn systems is proposed and the general disturbances are compensated by applying nn based on graph theory finite time theory and lyapunov method it is demonstrated that the follower obfns can reach the convex hull formed by the leaders in finite time in section 4 numerical simulations are presented followed by conclusion in section 5 2 preliminaries and problem formulation the multiple obfn systems are developed based on the ocean bottom node obn systems which have been proposed to detect ocean resources however the rov is necessary to place and recover the obns which is inefficient moreover a lot of time and cost are wasted compared with the obn systems the multiple obfn systems can place and recover autonomically and stay at the seabed for a long time to record the data of earthquake wave therefore all the advantages of obns are preserved in the obfn systems while the efficiency and reliability are better by using containment control for the multiple obfn systems the follower obfns can move with the leader obfns in a convex hull which is formed by leaders therefore it is acceptable that only the leaders should have the equipments which have the ability to exchange information with the surface mother ship over a long distance while the followers take the equipments to communicate with neighbor obfns thus this control approach will reduce the cost fig 1 is the obfn model fig 2 shows the placement and recovery of the multiple obfn systems from the surface mother ship some basic symbols are defined in table 1 meanwhile we define that sig x α x α sign x for the diagonal matrix x diag x 1 x 2 x n we define x k diag x 1 k x 2 k x n k where k is a positive constant we consider the multiple obfn systems include m leaders and n followers let v l n 1 n m represents the set of leaders v f 1 n represents the set of followers a directed graph is expressed as g v ε while v denotes the set of all nodes and ε v v denotes the set of all edges for the obfn i and j v i v j ε represents that obfn j can receive the information from obfn i it is defined that the neighbors of node v i is the set which is represented as n i v j v j v i ε a a i j is the weighted adjacent matrix of g while every element of a satisfies that if v j v i ε then a i j 1 and otherwise a i j 0 generally it is assumed that a i i 0 which represents the self edges are forbidden a finite sequence of the nodes v i 1 v i s expresses the path of g which satisfy v i k v i k 1 ε a directed path of g is an ordered sequence of nodes so that any two sequential nodes in the ordered sequence are an edge of g if every node of a directed graph has and only has one parent node except the root node and there exists a directional path from the root node to others the directed graph will be called a directed tree when all the nodes of a directed graph are contained in a directed tree the directed tree can be called a directed spanning tree one can say that a directed graph contains a directed spanning tree while a subgraph is contained in the directed graph and the subgraph is a directed spanning tree the laplacian matrix l l i j of a directed graph is defined as l i i j v j i a i j and l i j a i j i j if there exist multiple leader obfns the laplacian matrix can be rewritten into a block matrix as l l 1 l 2 0 m n 0 m m where l 1 ℝ n n and l 2 ℝ n m if b l i j v l a i j j v f b l diag b l 1 b l n d i j v f j i a i j j v f d diag d 1 d n a 0 a 12 a 1 n a 21 0 a n 1 1 0 a n 1 n a n 1 a n n 1 0 then l 1 d b l a the dynamics and kinematics equations of follower obfns can be described as fossen 2011 1 η i j i η i v i m η i η i c r b η i η i c a η i η r i d η i η r i g η i τ i where m η i m i j i 1 c r b η i c r b i v i m i j i 1 j i j i 1 c a η i c a i v r i j i 1 d η i d i v r i j i 1 g η i g i η i η r i j i η i v r i the position and orientation vector in the inertial reference frame are represented as η i x i y i z i ϕ i θ i ψ i t the velocity vector in the body fixed frame is expressed as ν i u i v i w i p i q i r i t j i denotes the transformation matrix between the inertial reference frame and body fixed frame v c i is the velocity of ocean current in the body fixed frame v r i is the velocity of obfn relative to ocean current and v r i v i v c i m i represents the inertia matrix while considering the added mass c r b i is the matrix of coriolis and centripental and c a i is the matrix of added coriolis and centripental d i denotes the drag coefficient matrix g i η i is the vector of restoring force moment produced by gravitational and buoyancy forces and τ i denotes the control force and moment which act on the barycenter of the i th obfn assumption 1 for leader obfns i e i v l there are no disturbances the dynamics and kinematics equations of leaders are expressed as 2 η i j i η i v i m η i η i c r b η i η i c a η i η i d η i η i g η i τ l i definition 1 c is a subset of the real vector space s ℝ n if 1 t x t y c holds for any x y c c is called the convex set the convex hull c o x constituted by all points in x x 1 x n s is the minimal convex set which contains all points of x especially c o x i 1 n α i x i x i x α i 0 i 1 n α i 1 assumption 2 there exists at least one leader for every follower obfn which has a directed path to the follower lemma 1 if assumption 2 holds each element of matrix l 1 1 l 2 is nonnegative while the sum of every row is equal to 1 i e l 1 1 l 2 1 m 1 n mei et al 2012 lemma 2 consider the system x f x f 0 0 x ℝ n if there exist a positive definite continuous function v x u ℝ real constants c 0 γ 0 1 and an open neighborhood u o u which is near the origin and v x c v x γ 0 x u 0 holds then the function v x will converge to zero in finite time t 1 which satisfies bhat and bernstein 2000 3 t 1 v x 0 1 γ c 1 γ lemma 3 a nonsingular fast sliding surface s t x t β 1 x t α 1 sign x t β 2 x t α 2 sign x t is chosen where x t ℝ β 1 1 β 2 0 1 α 1 2 and α 1 α 2 the equilibrium x 0 is globally stable in finite time all states of the system will converge to zero in finite time t 2 for any initial value x 0 x 0 t 2 satisfies yang and yang 2011 4 t 2 α 1 β 1 1 α 1 α 1 1 x 0 1 1 α 1 f 1 α 1 α 1 1 α 1 α 2 1 α 1 α 2 1 α 1 α 2 1 β 2 x 0 α 2 1 where f means the gaussian hypergeometric function remark 1 the physical meaning of sliding mode surface is that sliding mode variable changes with the change of state first we consider the linear sliding surface s k x where x is the trajectory error of this system and k is a constant it is found that when the sliding surface converges to zero the trajectory error can also converge to zero however the convergence rate is slow in order to accelerate convergence the finite time problem is considered notice the sliding mode surface in lemma 3 which contains terms similar to x α sign x if 0 α 1 the system converges slowly when the states are far away from the origin and converges more rapidly near the origin if α 1 it has a higher rate of convergence at a distance from the origin and it offers a slower rate of convergence when it is near the origin thus the sliding surface has the property of finite time convergence and the trajectory error and velocity error will converge after the sliding surface converges to zero thruster fault is a common problem during the navigation of the multiple obfn systems the change of the thrust allocation matrix is defined as b which is used to describe the effect of thruster faults thus the real control force and moment acting on the obfns are changed from τ to τ τ 5 τ τ b z k b u b z b u where b z represents the nominal value of thrust allocation matrix u denotes the control input value of thrusters k is a diagonal matrix that consists of element k i i 0 1 which means the fault level of the corresponding thruster from 5 we rewrite 1 as 6 η i m η z i 1 b z i u i c r b η z i η i c a η z i η i d η z i η i g η z i f i where subscript z indicates the nominal values f i denotes the general system uncertainties represented as 7 f i δ m η i η i b i u i δ c r b η i η i δ c a η i η i δ d η i η i δ g η i c a η i η i r d η i η i r where c a η i η i r d η i η i r denotes the effect of external disturbances δ represents the uncertainties due to the performance of nn for approximating the nonlinear functions is excellent it is utilized to estimate the general disturbances if the nonlinear term f is estimated by nn it can be expressed as 8 f w t φ ϑ where w means the ideal weight matrix φ indicates the activation function which is usually chosen as gaussian function hyperbolic tangent function or sigmoid function ϑ represents the bounded estimation error the approximated value of f is 9 f ˆ w ˆ t φ where w ˆ represents the estimation of w in this research in order to estimate the general disturbances of the multiple obfn systems radial basis function neural network rbfnn is introduced and the gaussian function is selected as the activation function of rbfnn which is expressed as 10 φ j exp x c j 2 2 b j 2 j 1 2 m where x x 1 x 2 x n t means an n dimensional input vector c j indicates the center of the j th neuron b j indicates the width of the j th neuron the output of the rbfnn is expressed as 11 through denoting φ φ 1 φ 2 φ n t 11 y m w 1 φ 1 w 2 φ 2 w m φ m remark 2 when the nn is used to estimate general disturbances if the ideal weight matrix is obtained through off line training a huge amount of data about external environment model uncertainty and thruster fault are necessary then the nn is trained to estimate general disturbances however the technique used in this research is online real time adaptive approximation which does not require a large number of data for training during the actual motion of the systems data related to the environment and thrusters will be collected for online real time training although the required data is not as much as off line training it is not a local estimate of the disturbance but a global estimate therefore the estimation for disturbance is still correct which will not limit the actual implementation of the algorithm under directed communication topology this study aims to solve the problem of distributed finite time fault tolerant containment control with error constraint for multiple obfn systems 1 and 2 finite time stability is ensured through utilizing nonsingular fast sliding mode technique i e the system can converge in finite time rbfnn is used to make efficiency estimation and compensation for the general disturbances moreover the error variables are transformed into new forms to handle error constraint and enhance the stead and transient state performance of the systems besides the containment error is proved to be bounded through lyapunov theory 3 distributed finite time fault tolerant error constraint containment control protocol design in this section we present a distributed finite time fault tolerant error constraint containment control scheme for multiple obfn systems based on directed graph considering the thruster faults a suitable nonsingular fast sliding surface is chosen and it is demonstrated that the systems states will converge to the sliding surface in finite time by lyapunov theorem meanwhile the error constraint method considered in this paper can improve the steady and transient state performance in addition the general disturbances are approximated in real time by using nn the containment error variables are the differences between the actual trajectory and the desired trajectory of the i th follower which are defined as chen et al 2019 12 e i η η i j v f a i j η j j v l a i j η j j v f a i j j v l a i j where j v f a i j η j j v l a i j η j j v f a i j j v l a i j is related to positions of neighbors at the time t which means the desired trajectory of i th follower 13 e i η η i j v f a i j η j j v l a i j η j j v f a i j j v l a i j combining 6 with 13 we can have 14 e i η η i j v f a i j η j j v l a i j η j j v f a i j j v l a i j m η z i 1 b z i u i c r b η z i η i c a η z i η i d η z i η i g η z i f i j v f a i j η j j v l a i j η j j v f a i j j v l a i j the error constraint function is 15 k a i t e i η k b i t where k a i and k b i are the time varying lower and upper bounds respectively and k a i j t k b i j t j 1 n holds n means the degree of freedom k a i j and k b i j represent the magnitude of j th degree of freedom of k a i and k b i respectively transform the error variables to 16 ξ a i t k a i 1 t e i η ξ b i t k b i 1 t e i η where k a i t diag k a i 1 t k a i n t and k b i t diag k b i 1 t k b i n t define q m i x j 1 x j 0 0 x j 0 j 1 n and q m x diag q m x 1 q m x n let q m i q m e i η one has 17 ξ i q m i ξ b i e n q m i ξ a i taking the derivative of 17 we can obtain 18 ξ i q m i k b i 1 e i η k b i 1 k b i e i η e n q m i k a i 1 e i η k a i 1 k a i e i η where k a i t diag k a i 1 t k a i n t k b i t diag k b i 1 t k b i n t 19 ξ i q m i k b i 1 e i η k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η where k a i t diag k a i 1 t k a i n t k b i t diag k b i 1 t k b i n t from lemma 3 we chose the nonsingular fast terminal sliding surface as 20 s i ξ i β 1 sig ξ i α 1 β 2 sig ξ i α 2 where 1 α 1 2 α 1 q 1 q 2 q 1 q 2 are positive odd integers α 2 α 1 β 1 1 β 2 0 due to ξ i ξ i 1 ξ i 2 ξ i n t and ξ i ξ i 1 ξ i 2 ξ i n t we denote ξ i diag ξ i 1 ξ i 2 ξ i n and ξ i diag ξ i 1 ξ i 2 ξ i n taking the derivative of 20 and combining with 19 one has 21 s i α 1 β 1 ξ i α 1 1 q m i k b i 1 e i η k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η α 2 β 2 ξ i α 2 1 e n ξ i the distributed finite time fault tolerant error constraint containment control protocol is designed as 22 u i u i 1 u i 2 23 u i 1 b z i 1 c r b η z i η i c a η z i η i d η z i η i g η z i m η z i j v f a i j η j j v l a i j η j j v f a i j j v l a i j k m η z i ξ a i sign s i m η z i q m i k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η 1 α 1 β 1 m η z i ξ a i α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 where ξ a i diag e i 1 η ξ i 1 e i n η ξ i n 24 u i 2 b z i 1 w ˆ i t φ i ϕ ˆ i sign m η z i t s i where u i 2 is utilized to compensate the general disturbances f i let m η z i 1 α 1 β 1 ξ i α 1 1 q m i k b i 1 e n q m i k a i 1 m η z i 1 the estimation law is designed as 25 w ˆ i λ i φ i s i t m η z i 1 where λ i is a positive constant an adaptive law ϕ ˆ i is proposed to estimate the upper bound of nn estimation error which is designed as 26 ϕ i δ i m η z i 1 s i 1 where δ i is a positive constant and θ i θ i theorem 1 for the multiple obfn systems the model uncertainties external disturbances and thruster faults are considered only a part of follower obfns can obtain the information of leaders if assumptions 1 2 hold the states will converge to sliding surface 20 in finite time by using the designed control protocol 22 and the nn adaptive laws 25 and 26 that is to say all the follower obfns will move to the convex hull formed by leaders in finite time distributed finite time fault tolerant error constraint containment control is achieved and the requirement for error constraint 15 is satisfied by designing error variable 12 besides the containment errors are bounded proof step 1 consider the lyapunov function 27 v 1 1 2 i 1 n s i t s i 1 2 i 1 n tr w i t λ i 1 w i 1 2 i 1 n δ i 1 ϕ i 2 where w i w i w ˆ i ϕ i θ i ϕ ˆ i taking the derivative of 27 we can obtain 28 v 1 i 1 n s i t s i i 1 n tr w i t λ i 1 w ˆ i i 1 n δ i 1 ϕ i ϕ ˆ i substituting 21 25 26 into 28 we can have 29 v 1 i 1 n s i t α 1 β 1 ξ i α 1 1 q m i k b i 1 e i η k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η α 2 β 2 ξ i α 2 1 e n ξ i i 1 n tr w i t φ i s i t m η z i 1 i 1 n ϕ i m η z i 1 s i 1 according to 13 and 22 24 one has 30 e i η k ξ a i sign s i q m i k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η 1 α 1 β 1 ξ a i α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 m η z i 1 w ˆ i t φ i m η z i 1 ϕ ˆ i sign m η z i t s i m η z i 1 w i t φ i m η z i 1 θ i substituting 30 into 29 we obtain 31 v 1 i 1 n s i t α 1 β 1 ξ i α 1 1 q m i k b i 1 k ξ a i sign s i e n q m i k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η 1 α 1 β 1 ξ a i α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 m η z i 1 w i t φ i m η z i 1 ϕ ˆ i sign m η z i t s i m η z i 1 θ i e n q m i k a i 1 k ξ a i sign s i q m i k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η 1 α 1 β 1 ξ a i α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 m η z i 1 w i t φ i m η z i 1 ϕ ˆ i sign m η z i t s i m η z i 1 θ i α 2 β 2 ξ i α 2 1 e n ξ i tr w i t φ i s i t m η z i 1 ϕ i m η z i 1 s i 1 from 16 and 17 one has 32 ξ i q m i k b i 1 t e i η e n q m i k a i 1 t e i η therefore 33 ξ a i 1 diag ξ i 1 e i 1 η ξ i n e i n η q m i k b i 1 t e n q m i k a i 1 t then equation 31 can be simplified by 33 to 34 v 1 i 1 n s i t α 1 β 1 ξ i α 1 1 k sign s i 1 α 1 β 1 α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 ξ a i 1 m η z i 1 w i t φ i m η z i 1 ϕ ˆ i sign m η z i t s i m η z i 1 θ i q m i e n q m i k b i 1 k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η q m i e n q m i k a i 1 k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η α 2 β 2 ξ i α 2 1 e n ξ i tr w i t φ i s i t m η z i 1 ϕ i m η z i 1 s i 1 due to q m i e n q m i 0 and defining k k α 1 β 1 ξ i α 1 1 we obtain 35 v 1 i 1 n s i t k sign s i i 1 n s i t m η z i 1 w i t φ i tr w i t φ i s i t m η z i 1 i 1 n s i t m η z i 1 θ i ϕ ˆ i sign m η z i t s i i 1 n ϕ i m η z i 1 s i 1 i 1 n s i t k sign s i i 1 n s i t m η z i 1 θ i i 1 n s i t m η z i 1 1 ϕ ˆ i i 1 n ϕ i m η z i 1 s i 1 i 1 n s i t k sign s i i 1 n s i t m η z i 1 1 θ i ϕ ˆ i i 1 n m η z i 1 s i 1 ϕ i from θ i ϕ ˆ i ϕ i one has 36 v 1 i 1 n s i t k sign s i it is obvious that v 1 0 therefore according to 31 we can obtain the variable θ i m η z i 1 f i w ˆ i t φ i ϕ ˆ i sign m η z i t s i is bounded let θ i θ i where θ i is a positive constant step 2 select the lyapunov function as follow 37 v 2 1 2 i 1 n s i t s i taking the derivative of 37 one has 38 v 2 i 1 n s i t α 1 β 1 ξ i α 1 1 q m i k b i 1 e i η k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η α 2 β 2 ξ i α 2 1 e n ξ i i 1 n s i t k sign s i i 1 n s i t m η z i 1 f i w ˆ i t φ i ϕ ˆ i sign m η z i t s i i 1 n s i t k sign s i i 1 n s i θ i when ξ i j δ j 1 n where δ is a small positive constant which will be discussed in detail later letting k λ min k we have 39 v 2 i 1 n s i k θ i if k is chosen suitably we can obtain k θ i for any i v f therefore letting k k θ i 0 we can obtain 40 v 2 i 1 n k s i 2 k v 2 1 2 from lemma 2 the states of the multiple obfn systems will converge to sliding surface s i 0 n in finite time whe n ξ i j δ as δ is a small positive constant it is acceptable to consider that ξ i j 0 further we consider the situation of ξ i 0 n then from 14 19 and 33 we obtain 41 ξ i ξ a i 1 m η z i 1 b i u i 1 u i 2 c r b η z i η i c a η z i η i d η z i η i g η z i f i j v f a i j η j j v l a i j η j j v f a i j j v l a i j q m i k b i 1 k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η it is reasonable to assume b u i 2 f i 0 there exist three reasons first u i 2 is usually smaller than u i 1 second since δ is a small positive constant and region ii in fig 1 is very narrow thus the overall performance of the multiple obfn systems is not impacted too much finally u i 2 is proposed to estimate the general disturbance term f i therefore the assumption is reasonable according to the three reasons simplifying 41 based on the analysis above we have 42 ξ i ξ a i 1 m η z i 1 b i u i 1 c r b η z i η i c a η z i η i d η z i η i g η z i j v f a i j η j j v l a i j η j j v f a i j j v l a i j q m i k b i 1 k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η substituting 23 into 42 one has 43 ξ i k sign s i as ξ i ξ i 1 ξ i 2 ξ i n t and s i η s i 1 η s i 2 η s i n η t we obtain ξ i j k sign s i j j 1 2 n in fact based on the form of controller 23 one has that ξ i k sign s i in the case of ξ i j δ and ξ i 0 n for some j 1 n when s i j 0 and s i j 0 we have ξ i j k and ξ i j k from 43 which represents that ξ i j 0 is not an attractor therefore in the region which is a neighborhood ξ i j δ of ξ i j 0 one has ξ i j k and ξ i j k so that the states will cross the region ξ i j δ in finite time when ξ i j δ from 40 and lemma 2 the states of the multiple obfn systems can move to the sliding surface in finite time hence in any case the states of the multiple obfn systems will converge to sliding surface s i 0 n in finite time fig 3 gives the phase trajectory according to lemma 3 after each state reaches the terminal sliding surface s i 0 n they can converge to the origin in finite time i e e i η 0 n therefore ξ a i and ξ b i will also converge to ξ a i 0 n and ξ b i 0 n in finite time respectively by selecting the suitable lower and upper bounds k a i and k b i it is ensured that ξ a i 1 ξ a i n 1 and ξ b i 1 ξ b i n 1 hold at the beginning thus in the entire process the error constraint equation 15 holds in other words the error variable 12 does not exceed the designed limit remark 3 consider the problem of finite time adaptive synchronization for multiple obfn systems for any initial conditions to prove that every related variable can reach the origin in finite time is needed in this research we adopt the nonsingular terminal sliding mode technique thus it is necessary to prove the origin is the only attractor for the sliding surface a lot of studies have been done to solve this problem xu et al 2015 yao et al 2018 they show that it is reasonable to assume ξ i j 0 when ξ i j δ when e i η 0 n from error variable 12 we have that 44 j v f j i a i j j v l a i j η i j v f j i a i j η j j v l a i j η j according to 44 we can obtain 45 0 j v f j i a i j η j η i j v l a i j η j η i transforming 45 into a column vector one has 46 l 1 e n η 1 η n l 2 e n η n 1 η n m since l 1 is irreducible then 47 η 1 η n l 1 1 l 2 e n η n 1 η n m based on definition 1 and lemma 1 one has that l 1 1 l 2 e n η n 1 η n m means the convex hull formed by leader obfns according to 47 under the control strategy 22 in presence of thruster faults and error constraint distributed finite time fault tolerant error constraint containment control for multiple obfn systems is achieved the follower obfns will reach the convex hull formed by leader obfns in finite time remark 4 the adaptive law 26 is available to the case of s 0 however for the real sliding mode control as the nonlinear and switching terms exist in the systems s cannot converge to zero in finite time exactly then the adaptive parameter ϕ ˆ i will increase infinitely to avoid this problem we adopt the dead zone function to develop the adaptive law 26 48 ϕ ˆ i δ i m η z i 1 s i 1 s ς 0 s ς where ς is a constant 4 numerical simulations the numerical simulations are given in this section we consider the systems consisting of eight follower obfns no 1 8 and five leader obfns no 9 13 the dynamics and kinematics equations of follower obfns can be expressed as η i j i η i v i m η i η i c r b η i η i c a η i η r i d η i η r i g η i τ i i 1 8 the dynamics and kinematics equations of leader obfns can be expressed as η i j i η i v i m η i η i c r b η i η i c a η i η i d η i η i g η i τ l i i 9 13 the communication topology among the leaders and followers is shown in fig 4 for the model uncertainties we take 30 nominal values as model error which is handled as a part of general disturbances in this section a first order gauss markov process is adopted to simulate the disturbances of ocean current v c μ v c ω where v c means the velocity of ocean current in inertial reference frame ω represents a gaussian white noise which mean is 1 and variance is 1 and μ is 3 for thruster faults we assume the thruster t1 will have fault and we consider two kinds of thruster faults that is the abrupt and the incipient thruster fault cases which are expressed as 49 and 50 49 k 11 0 t 30 0 9 t 30 50 k 11 0 t 30 0 9 1 exp t 30 5 t 30 choose the control parameters as α 1 1 9 β 1 0 1 α 2 2 β 2 1 and k 175 the activation function of nn is selected as φ i z i φ i 1 z i φ i 11 z i t i 1 8 where φ i j z i means the gaussian function φ i j z i exp z i c i j 2 2 b i j 2 j 1 2 11 where z i η i t η i t ℝ 12 it is assumed that the activation functions are same for all the follower obfns the center of the neuron c i j is distributed evenly over the area 0 1 0 1 6 choose the width of gaussian function b i j 60 other parameters are selected as λ 1 λ 2 λ 3 λ 4 λ 5 λ 6 λ 7 λ 8 800 δ 1 δ 2 δ 3 δ 4 δ 5 δ 6 δ 7 δ 8 800 ς 0 3 we set the lower and upper bounds of the error constraint as 51 k a i j t 1 5 e 0 3 t 0 04 k b i j t 1 5 e 0 3 t 0 04 initial states of follower obfns are given in tables 2 and 3 the model parameters of obfns are given in tables 4 and 5 the position and angle trajectories of leader obfns are given in table 6 case 1 abrupt thruster fault under the abrupt thruster fault 49 the control effects of distributed control law 22 are shown in figs 5 7 without loss of generality follower obfn5 is chosen as an example to show the control forces and torques of the systems figs 8 and 9 show the simulation results meanwhile we also select follower obfn5 as an example to show the impact of error constraint figs 10 15 show the changes of the error variables where e 5 i j i 1 2 j 1 6 means the error variable of j th degree of freedom under the i th case i 1 means the case with error constraint and i 2 means the case without error constraint according to figs 5 and 6 we can find that the trajectories of follower obfns could reach the convex hull formed by leader obfns in finite time under the control protocol 22 when t 0s 20s 50s and 80s fig 7 gives the change of relative positions among the systems at t 0s we can find that all followers are outside the convex hull however they already move in the convex hull when t 20s and the followers could remain in the convex hull at t 50s and t 80s figs 8 and 9 show that follower obfn5 need large force and torque at the beginning period however after 10s the amplitudes of control force and torque reduce to 60 n and 100 nm the thruster t1 influences the surge and yaw of follower obfns thus according to the first picture in fig 5 and the third picture in fig 6 one can find that the leaders are followed by follower obfns and the yaw angles already reach zero before 30s after 30s follower obfns are still following the leaders and the yaw angles change but the amplitudes of curves are small so that the influence of change on the overall performance is small what s more from figs 10 and 15 which are about the surge and yaw we can find the errors increase after the thruster faults however after careful observation of figs 10 15 we can obtain that error variables are limited to the range represented in 51 by using the error constraint 22 therefore the transient and steady state performance of the multiple obfn systems are improved from those analyses in the presence of abrupt thruster faults the problem of distributed finite time fault tolerant error constraint containment control for multiple obfn systems is solved by using the distributed control method 22 case 2 incipient thruster fault similarly to case 1 figs 16 18 show the control effects of control method 22 in case 2 besides follower obfn5 is also chosen as an example the simulation results of the control inputs are shown in figs 19 and 20 and the change of error variables of six degrees of freedom are shown in figs 21 26 the simulation results are shown in figs 16 26 which are similar to those of figs 5 15 thus are omitted therefore similarly to case 1 under the distributed control protocol 22 the distributed finite time fault tolerant error constraint containment control could also be achieved in the incipient thruster fault case remark 5 for the error bounds the range of error constraint in the simulation is small however in practical applications since the multiple obfn systems will sail in the ocean the acceptable error range is relatively large what s more the multiple obfn systems for simulation are also the objects which we need to control in practice results of simulation can show that this algorithm is feasible in theory although parameters related to error bounds need to be adjusted when it is applied to practical projects they will not change a lot these parameters will still have a lead effect to sum up error range is relatively large and can refer to the parameters in simulation therefore the task of setting time varying bounds in advance is not a hard work it will not make the proposed control technique hardly implementable on real applications remark 6 for the multiple obfn systems we can divide the parameters used in the simulation into two categories the first category is the parameters related to obfn model obtained through hydrodynamic experiments which cannot be changed the remaining parameters fall into the second category which are determined by constantly tuning after determining the first category parameters related to the obfn model the simulation results are optimized by adjusting the second type of parameters finally the parameters related to the control strategy can be obtained remark 7 in practical engineering when the obfn systems move to the target area we plan to keep all obfns moving on the same horizontal plane so as to reduce the overall resistance and save energy during the simulation all obfns are arranged on the same horizontal plane which can also better and more vividly show the containment effect of the proposed algorithm 5 conclusion in presence of thruster faults and error constraint when the leader obfns can only be measured by a part of follower obfns this paper investigates distributed finite time fault tolerant error constraint containment control algorithm for multiple obfn systems under directed communication topology the external disturbances and model uncertainties are also considered by introducing a new form of error variable to replace the original error variable selecting a nonsingular fast terminal sliding surface and utilizing the nn to approximate the general disturbances the problem of distributed finite time fault tolerant error constraint containment control is solved based on graph theory and finite time theory it is proved that containment control can be realized in finite time and the containment errors are bounded through numerical simulations it is obtained the follower obfns can move in the convex hull formed by leaders in finite time the error variables are limited to the range of error and the systems can still move steadily after the occurrence of thruster faults which are considered under two cases conflicts of interest the authors declare that they have no conflict of interest acknowledgements this work was supported by national natural science foundation of china under grant nos 51939003 and 61803119 and the research fund from science and technology on underwater vehicle technology under grant no 6142215180208 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106341 
22518,the ocean bottom flying node obfn belongs to autonomous underwater vehicle auv designed for detecting seabed resources when considering model uncertainties external disturbances and thruster faults by applying the nonsingular fast terminal sliding mode technique a distributed finite time fault tolerant error constraint containment control method for multiple obfn systems is proposed under directed communication topology besides only a part of follower obfns can get the information of leader obfns first the error constraint strategy is considered to improve the system performance while the defined error variable of containment control was converted into a suitable form then by choosing the appropriate nonsingular fast terminal sliding surface the systems states can reach the sliding surface in finite time such that the follower obfns could converge to the convex hull formed by the leader obfns in finite time neural network nn is employed to estimate and compensate the general disturbances consisting of model uncertainties external disturbances and thruster faults an adaptive law is designed to compensate the upper bound of the estimation errors the finite time stability of the systems and the boundedness of containment errors are proved by utilizing graph theory finite time theory and lyapunov technique numerical simulations under different types of thruster faults are given to show the effectiveness of the proposed methods keywords multiple auv systems obfn systems distributed containment control error constraint fault tolerant control finite time control 1 introduction cooperative control of multiple auv systems have attracted great attention in recent years the application of multi auv collaborative control technology is also highly diversified such as ocean survey and mapping military surveillance and defense search and rescue and resource detection compared with single auv the multiple auv systems have better adaptability and stability since the ocean resources detection is more and more important it is more reasonable and reliable to apply cooperative control technology for multiple auv systems resource detection is usually completed through detecting the information of submarine earthquake in order to complete a detection system for submarine earthquake wave with a capacity of large scale autonomous placement and recover we design a group of obfns compared with the seabed resource detection system which have been developed the multiple obfn systems have higher applicability and lower economic cost fabiani et al 2018 in reality obfn is a kind of auv for the problem of coordinated control for multiple auv systems many methods have been proposed in the early studies there are two main control types for this problem which are centralized control and distributed control for centralized control systems the control signals of all auvs need to be transmitted by the operators or a specific auv in the systems compared with centralized systems each auv only needs to obtain the information of neighbor auvs in the distributed systems yamchi and esfanjani 2017 ni et al 2018 thus distributed control systems have higher efficiency extensibility and stability and much wider application in engineering in order to solve the problem of coordinated path following for multiple auv systems wang et al 2018 improved the global information of the reference speed through proposing a distributed speed estimator then path following control algorithms were designed to ensure all auvs could move to the desired position while nn shojaei 2016 zhao and jia 2016 hua et al 2017 ma et al 2017 was used to estimate the general system uncertainties under obstacle free and obstacle rich environments sahu and subudhi 2017 held the whole systems connected in a group by estimating a flocking center for tracking a target in presence of varying velocities yan et al 2018 designed distributed cooperative target tracking control algorithms in two cases for distributed control systems the communication topology describes the information transfer relationships among the auvs generally it can be divided into two categories that is undirected communication topology and directed communication topology the methods proposed by wang et al 2018 sahu and subudhi 2017 and yan et al 2018 were investigated based on undirected communication topologies which had a high demand for communication systems since the information transfer was bidirectional besides when there exist communication errors in the systems the distributed control approaches based on undirected communication topology may be useless on the contrary the distributed control based on directed communication topology can be realized only if a directed spanning tree is contained in the graph therefore the control approaches based on directed communication topology are more valuable for further research based on directed communication topology yuan et al 2018 investigated the problem of formation learning control for multiple auv systems in presence of heterogeneous nonlinear uncertain dynamics in order to improve the guidance signal with velocity constraint and minimize the instantaneous control torque peng et al 2018 generated an optimal guidance signal by employing an optimization based command governor and the distributed maneuvering problem of multiple surface vehicles was researched based on directed topology for multiple auv systems when the position and orientation informations were transmitted in a discrete time sequence the coordinated control for multiple auv systems was investigated under directed topology by ma and zeng 2015 for the problem of coordinated control for multiple auv systems according to the number of leaders it can be divided into distributed consensus control without leaders distributed tracking control with one leader and distributed containment control with multiple leaders however the researches in ma and zeng 2015 peng et al 2018 and yuan et al 2018 were investigated without leaders the control strategies proposed are not applicable to the problem of tracking control with one leader thus further researches are needed when considering the input saturation uncertainties and external disturbances by employing sliding mode technique and consensus theorem zhang et al 2017 proposed an adaptive synchronization control method to enable all the auvs to track the desired attitude cooperatively the problem of cooperative dynamic positioning control for multiple vessels was investigated by peng et al 2016 the authors proposed distributed control approaches based on output feedback and state feedback respectively when only the position information was measured enayat and khorasani 2017 designed nonlinear semi decentralized or distributed coordinated control algorithms for multiple auv systems based on the dynamic surface control approach however the control algorithms proposed in peng et al 2016 enayat and khorasani 2017 and zhang et al 2017 could not solve the problem of containment control with multiple leaders by using containment control approach for multiple obfn systems the follower obfns can move in a convex hull formed by leader obfns and the cost of equipments could reduce since the systems can move to the target area together when only leader obfns obtain the information from the surface mother ship that is to say only the leaders take the equipments to communicate with the surface mother ship over long distances while the followers only need the equipments to communicate with the neighbor obfns in the field of ocean vehicles the problem of containment control has been studied by some researchers when the dynamics and disturbances of each auv were assumed to be smooth klotz et al 2016 proposed a distributed control method then the states of every follower could asymptotically converge to the convex hull formed by a random number of leaders with time varying states peng et al 2015 put forward a novel predictor based neural dynamic surface control strategy to design the adaptive containment control strategy the authors also constructed iterative neural updating laws based on prediction errors which were used to identify exactly the unknown dynamics of every vehicle based on directed topology yoo and park 2017 assumed that the position information of leaders was transmitted to a part of followers and the distributed containment control for multiple underactuated surface vessels was achieved the local control approaches were designed for all followers by utilizing the predefined performance design method while the auxiliary variables were proposed to handle underactuated constraints in the design framework of predefined performance when only a small part of followers could receive the velocity update information of predetermined paths peng et al 2017 investigated the containment control for multiple surface vessels and proposed an adaptive control design approach with the ability to modularize the estimator and the control law then a filtering update system and a maneuvering error feedback were used to design two path update laws respectively it should be noted that the results in peng et al 2015 klotz et al 2016 peng et al 2017 and yoo and park 2017 could only achieve asymptotic convergence of the systems but cannot meet the requirement of convergence speed in some cases by using finite time control approach convergence can be accomplished in finite time thus the system performance will be optimized fu and wang 2016 presented an observer based distributed control protocol for followers through utilizing the sliding mode control technique and the problem of finite time containment control was solved under directed topology only based on local information the problem of distributed finite time event triggered consensus control was investigated by zhang et al 2016 by using the global finite time stability theory of the discontinuous homogeneous systems liu et al 2017 proposed a new finite time discontinuous disturbance observer when taking into account the nonuniform gradient gains a common convex constraint set and the finite time convergence requirement lin et al 2017 investigated the problem of distributed optimization with differentiable convex objective functions however fault tolerant control was not considered in fu and wang 2016 zhang et al 2016 lin et al 2017 and liu et al 2017 if the thruster faults occur during the navigation the tasks may not be completed successfully when the multiple obfn systems sail in the ocean thrusters can easily have faults because of the complexity of the environment therefore the fault tolerant performance of the systems is crucial to accomplish tasks by using the information of nearest agent gallehdari et al 2016 ensured the team consensus and designed the on line distributed control reconfiguration methods the distributed hamilton jacobi bellman functions were derived for the fault agents and new reconfigured control laws were proposed through solving the above functions to guarantee fault accommodation of the systems under leaderless and leader follower cases chen and ho 2016 addressed two new fault tolerant consensus control protocols and emphasized the distributed control methods to solve the information transmission faults for multiple auv systems for the distributed formation control problem of multiple auv systems li and zhu 2018 developed an adaptive self organizing map nn strategy to ensure the systems can move into an expected formation shape each auv was treated as the leader and the followers thus fault tolerance and adaption were achieved davoodi et al 2016 designed distributed detection filters by utilizing only relative output information among the agents and all the agents reached either a model reference consensus or a state consensus while the faults in the systems were detected by the agents cooperatively however chen and ho 2016 davoodi et al 2016 gallehdari et al 2016 and li and zhu 2018 did not investigate the problem of error constraint the error can increase due to the existence of thruster faults thus it is necessary to constrain the errors to optimize the performance of the multiple obfn systems in presence of position tracking error constraint won et al 2015 designed a high gain disturbance observer in order to ensure the system had the position tracking error constraint the authors presented a backstepping control method through applying the barrier lyapunov function li et al 2018 investigated the problem of finite time consensus tracking with error constraints by utilizing the barrier lyapunov function the error constrained control problem was investigated and a novel distributed finite time consensus algorithm was designed when considering tracking error constraints tong et al 2017 established a fuzzy adaptive observer to approximate the unmeasured states based on dynamic surface backstepping recursive design approach the authors presented a partial fuzzy output feedback control strategy by converting the tracking errors into novel virtual error variables when considering the error constraint and input saturation zheng and xie 2017 handled the error constraints of attitude and position through merging a tan type barrier lyapunov function into attitude and guidance control methods based on the researches above under directed commination topology this paper investigates the problem of distributed finite time fault tolerant error constraint containment control for multiple obfn systems in presence of model uncertainties external disturbances and thruster faults the information of leaders can be achieved by a part of followers compared with previous studies the advantages of this research are listed as follows a in presence of thruster faults a distributed finite time fault tolerant error constraint containment control protocol for multiple obfn systems is designed by applying nonsingular fast terminal sliding mode technique the thruster fault is considered together with model uncertainties and external disturbances to reduce the analysis complexity b for the multiple obfn systems an error constraint controller is proposed the convergence speed and overshoot phenomenon of the systems are optimized by considering the error constraint c the model uncertainties external disturbances and thruster faults are approximated by using nn strategy and the ability of fault tolerant and error constraint for the multiple obfn systems is not influenced by this handling method the remainder of this paper is organized as follows some preliminary information and problem statement are given in section 2 in section 3 we consider the error constraint to optimize the control performance of systems a distributed finite time fault tolerant error constraint containment control protocol for multiple obfn systems is proposed and the general disturbances are compensated by applying nn based on graph theory finite time theory and lyapunov method it is demonstrated that the follower obfns can reach the convex hull formed by the leaders in finite time in section 4 numerical simulations are presented followed by conclusion in section 5 2 preliminaries and problem formulation the multiple obfn systems are developed based on the ocean bottom node obn systems which have been proposed to detect ocean resources however the rov is necessary to place and recover the obns which is inefficient moreover a lot of time and cost are wasted compared with the obn systems the multiple obfn systems can place and recover autonomically and stay at the seabed for a long time to record the data of earthquake wave therefore all the advantages of obns are preserved in the obfn systems while the efficiency and reliability are better by using containment control for the multiple obfn systems the follower obfns can move with the leader obfns in a convex hull which is formed by leaders therefore it is acceptable that only the leaders should have the equipments which have the ability to exchange information with the surface mother ship over a long distance while the followers take the equipments to communicate with neighbor obfns thus this control approach will reduce the cost fig 1 is the obfn model fig 2 shows the placement and recovery of the multiple obfn systems from the surface mother ship some basic symbols are defined in table 1 meanwhile we define that sig x α x α sign x for the diagonal matrix x diag x 1 x 2 x n we define x k diag x 1 k x 2 k x n k where k is a positive constant we consider the multiple obfn systems include m leaders and n followers let v l n 1 n m represents the set of leaders v f 1 n represents the set of followers a directed graph is expressed as g v ε while v denotes the set of all nodes and ε v v denotes the set of all edges for the obfn i and j v i v j ε represents that obfn j can receive the information from obfn i it is defined that the neighbors of node v i is the set which is represented as n i v j v j v i ε a a i j is the weighted adjacent matrix of g while every element of a satisfies that if v j v i ε then a i j 1 and otherwise a i j 0 generally it is assumed that a i i 0 which represents the self edges are forbidden a finite sequence of the nodes v i 1 v i s expresses the path of g which satisfy v i k v i k 1 ε a directed path of g is an ordered sequence of nodes so that any two sequential nodes in the ordered sequence are an edge of g if every node of a directed graph has and only has one parent node except the root node and there exists a directional path from the root node to others the directed graph will be called a directed tree when all the nodes of a directed graph are contained in a directed tree the directed tree can be called a directed spanning tree one can say that a directed graph contains a directed spanning tree while a subgraph is contained in the directed graph and the subgraph is a directed spanning tree the laplacian matrix l l i j of a directed graph is defined as l i i j v j i a i j and l i j a i j i j if there exist multiple leader obfns the laplacian matrix can be rewritten into a block matrix as l l 1 l 2 0 m n 0 m m where l 1 ℝ n n and l 2 ℝ n m if b l i j v l a i j j v f b l diag b l 1 b l n d i j v f j i a i j j v f d diag d 1 d n a 0 a 12 a 1 n a 21 0 a n 1 1 0 a n 1 n a n 1 a n n 1 0 then l 1 d b l a the dynamics and kinematics equations of follower obfns can be described as fossen 2011 1 η i j i η i v i m η i η i c r b η i η i c a η i η r i d η i η r i g η i τ i where m η i m i j i 1 c r b η i c r b i v i m i j i 1 j i j i 1 c a η i c a i v r i j i 1 d η i d i v r i j i 1 g η i g i η i η r i j i η i v r i the position and orientation vector in the inertial reference frame are represented as η i x i y i z i ϕ i θ i ψ i t the velocity vector in the body fixed frame is expressed as ν i u i v i w i p i q i r i t j i denotes the transformation matrix between the inertial reference frame and body fixed frame v c i is the velocity of ocean current in the body fixed frame v r i is the velocity of obfn relative to ocean current and v r i v i v c i m i represents the inertia matrix while considering the added mass c r b i is the matrix of coriolis and centripental and c a i is the matrix of added coriolis and centripental d i denotes the drag coefficient matrix g i η i is the vector of restoring force moment produced by gravitational and buoyancy forces and τ i denotes the control force and moment which act on the barycenter of the i th obfn assumption 1 for leader obfns i e i v l there are no disturbances the dynamics and kinematics equations of leaders are expressed as 2 η i j i η i v i m η i η i c r b η i η i c a η i η i d η i η i g η i τ l i definition 1 c is a subset of the real vector space s ℝ n if 1 t x t y c holds for any x y c c is called the convex set the convex hull c o x constituted by all points in x x 1 x n s is the minimal convex set which contains all points of x especially c o x i 1 n α i x i x i x α i 0 i 1 n α i 1 assumption 2 there exists at least one leader for every follower obfn which has a directed path to the follower lemma 1 if assumption 2 holds each element of matrix l 1 1 l 2 is nonnegative while the sum of every row is equal to 1 i e l 1 1 l 2 1 m 1 n mei et al 2012 lemma 2 consider the system x f x f 0 0 x ℝ n if there exist a positive definite continuous function v x u ℝ real constants c 0 γ 0 1 and an open neighborhood u o u which is near the origin and v x c v x γ 0 x u 0 holds then the function v x will converge to zero in finite time t 1 which satisfies bhat and bernstein 2000 3 t 1 v x 0 1 γ c 1 γ lemma 3 a nonsingular fast sliding surface s t x t β 1 x t α 1 sign x t β 2 x t α 2 sign x t is chosen where x t ℝ β 1 1 β 2 0 1 α 1 2 and α 1 α 2 the equilibrium x 0 is globally stable in finite time all states of the system will converge to zero in finite time t 2 for any initial value x 0 x 0 t 2 satisfies yang and yang 2011 4 t 2 α 1 β 1 1 α 1 α 1 1 x 0 1 1 α 1 f 1 α 1 α 1 1 α 1 α 2 1 α 1 α 2 1 α 1 α 2 1 β 2 x 0 α 2 1 where f means the gaussian hypergeometric function remark 1 the physical meaning of sliding mode surface is that sliding mode variable changes with the change of state first we consider the linear sliding surface s k x where x is the trajectory error of this system and k is a constant it is found that when the sliding surface converges to zero the trajectory error can also converge to zero however the convergence rate is slow in order to accelerate convergence the finite time problem is considered notice the sliding mode surface in lemma 3 which contains terms similar to x α sign x if 0 α 1 the system converges slowly when the states are far away from the origin and converges more rapidly near the origin if α 1 it has a higher rate of convergence at a distance from the origin and it offers a slower rate of convergence when it is near the origin thus the sliding surface has the property of finite time convergence and the trajectory error and velocity error will converge after the sliding surface converges to zero thruster fault is a common problem during the navigation of the multiple obfn systems the change of the thrust allocation matrix is defined as b which is used to describe the effect of thruster faults thus the real control force and moment acting on the obfns are changed from τ to τ τ 5 τ τ b z k b u b z b u where b z represents the nominal value of thrust allocation matrix u denotes the control input value of thrusters k is a diagonal matrix that consists of element k i i 0 1 which means the fault level of the corresponding thruster from 5 we rewrite 1 as 6 η i m η z i 1 b z i u i c r b η z i η i c a η z i η i d η z i η i g η z i f i where subscript z indicates the nominal values f i denotes the general system uncertainties represented as 7 f i δ m η i η i b i u i δ c r b η i η i δ c a η i η i δ d η i η i δ g η i c a η i η i r d η i η i r where c a η i η i r d η i η i r denotes the effect of external disturbances δ represents the uncertainties due to the performance of nn for approximating the nonlinear functions is excellent it is utilized to estimate the general disturbances if the nonlinear term f is estimated by nn it can be expressed as 8 f w t φ ϑ where w means the ideal weight matrix φ indicates the activation function which is usually chosen as gaussian function hyperbolic tangent function or sigmoid function ϑ represents the bounded estimation error the approximated value of f is 9 f ˆ w ˆ t φ where w ˆ represents the estimation of w in this research in order to estimate the general disturbances of the multiple obfn systems radial basis function neural network rbfnn is introduced and the gaussian function is selected as the activation function of rbfnn which is expressed as 10 φ j exp x c j 2 2 b j 2 j 1 2 m where x x 1 x 2 x n t means an n dimensional input vector c j indicates the center of the j th neuron b j indicates the width of the j th neuron the output of the rbfnn is expressed as 11 through denoting φ φ 1 φ 2 φ n t 11 y m w 1 φ 1 w 2 φ 2 w m φ m remark 2 when the nn is used to estimate general disturbances if the ideal weight matrix is obtained through off line training a huge amount of data about external environment model uncertainty and thruster fault are necessary then the nn is trained to estimate general disturbances however the technique used in this research is online real time adaptive approximation which does not require a large number of data for training during the actual motion of the systems data related to the environment and thrusters will be collected for online real time training although the required data is not as much as off line training it is not a local estimate of the disturbance but a global estimate therefore the estimation for disturbance is still correct which will not limit the actual implementation of the algorithm under directed communication topology this study aims to solve the problem of distributed finite time fault tolerant containment control with error constraint for multiple obfn systems 1 and 2 finite time stability is ensured through utilizing nonsingular fast sliding mode technique i e the system can converge in finite time rbfnn is used to make efficiency estimation and compensation for the general disturbances moreover the error variables are transformed into new forms to handle error constraint and enhance the stead and transient state performance of the systems besides the containment error is proved to be bounded through lyapunov theory 3 distributed finite time fault tolerant error constraint containment control protocol design in this section we present a distributed finite time fault tolerant error constraint containment control scheme for multiple obfn systems based on directed graph considering the thruster faults a suitable nonsingular fast sliding surface is chosen and it is demonstrated that the systems states will converge to the sliding surface in finite time by lyapunov theorem meanwhile the error constraint method considered in this paper can improve the steady and transient state performance in addition the general disturbances are approximated in real time by using nn the containment error variables are the differences between the actual trajectory and the desired trajectory of the i th follower which are defined as chen et al 2019 12 e i η η i j v f a i j η j j v l a i j η j j v f a i j j v l a i j where j v f a i j η j j v l a i j η j j v f a i j j v l a i j is related to positions of neighbors at the time t which means the desired trajectory of i th follower 13 e i η η i j v f a i j η j j v l a i j η j j v f a i j j v l a i j combining 6 with 13 we can have 14 e i η η i j v f a i j η j j v l a i j η j j v f a i j j v l a i j m η z i 1 b z i u i c r b η z i η i c a η z i η i d η z i η i g η z i f i j v f a i j η j j v l a i j η j j v f a i j j v l a i j the error constraint function is 15 k a i t e i η k b i t where k a i and k b i are the time varying lower and upper bounds respectively and k a i j t k b i j t j 1 n holds n means the degree of freedom k a i j and k b i j represent the magnitude of j th degree of freedom of k a i and k b i respectively transform the error variables to 16 ξ a i t k a i 1 t e i η ξ b i t k b i 1 t e i η where k a i t diag k a i 1 t k a i n t and k b i t diag k b i 1 t k b i n t define q m i x j 1 x j 0 0 x j 0 j 1 n and q m x diag q m x 1 q m x n let q m i q m e i η one has 17 ξ i q m i ξ b i e n q m i ξ a i taking the derivative of 17 we can obtain 18 ξ i q m i k b i 1 e i η k b i 1 k b i e i η e n q m i k a i 1 e i η k a i 1 k a i e i η where k a i t diag k a i 1 t k a i n t k b i t diag k b i 1 t k b i n t 19 ξ i q m i k b i 1 e i η k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η where k a i t diag k a i 1 t k a i n t k b i t diag k b i 1 t k b i n t from lemma 3 we chose the nonsingular fast terminal sliding surface as 20 s i ξ i β 1 sig ξ i α 1 β 2 sig ξ i α 2 where 1 α 1 2 α 1 q 1 q 2 q 1 q 2 are positive odd integers α 2 α 1 β 1 1 β 2 0 due to ξ i ξ i 1 ξ i 2 ξ i n t and ξ i ξ i 1 ξ i 2 ξ i n t we denote ξ i diag ξ i 1 ξ i 2 ξ i n and ξ i diag ξ i 1 ξ i 2 ξ i n taking the derivative of 20 and combining with 19 one has 21 s i α 1 β 1 ξ i α 1 1 q m i k b i 1 e i η k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η α 2 β 2 ξ i α 2 1 e n ξ i the distributed finite time fault tolerant error constraint containment control protocol is designed as 22 u i u i 1 u i 2 23 u i 1 b z i 1 c r b η z i η i c a η z i η i d η z i η i g η z i m η z i j v f a i j η j j v l a i j η j j v f a i j j v l a i j k m η z i ξ a i sign s i m η z i q m i k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η 1 α 1 β 1 m η z i ξ a i α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 where ξ a i diag e i 1 η ξ i 1 e i n η ξ i n 24 u i 2 b z i 1 w ˆ i t φ i ϕ ˆ i sign m η z i t s i where u i 2 is utilized to compensate the general disturbances f i let m η z i 1 α 1 β 1 ξ i α 1 1 q m i k b i 1 e n q m i k a i 1 m η z i 1 the estimation law is designed as 25 w ˆ i λ i φ i s i t m η z i 1 where λ i is a positive constant an adaptive law ϕ ˆ i is proposed to estimate the upper bound of nn estimation error which is designed as 26 ϕ i δ i m η z i 1 s i 1 where δ i is a positive constant and θ i θ i theorem 1 for the multiple obfn systems the model uncertainties external disturbances and thruster faults are considered only a part of follower obfns can obtain the information of leaders if assumptions 1 2 hold the states will converge to sliding surface 20 in finite time by using the designed control protocol 22 and the nn adaptive laws 25 and 26 that is to say all the follower obfns will move to the convex hull formed by leaders in finite time distributed finite time fault tolerant error constraint containment control is achieved and the requirement for error constraint 15 is satisfied by designing error variable 12 besides the containment errors are bounded proof step 1 consider the lyapunov function 27 v 1 1 2 i 1 n s i t s i 1 2 i 1 n tr w i t λ i 1 w i 1 2 i 1 n δ i 1 ϕ i 2 where w i w i w ˆ i ϕ i θ i ϕ ˆ i taking the derivative of 27 we can obtain 28 v 1 i 1 n s i t s i i 1 n tr w i t λ i 1 w ˆ i i 1 n δ i 1 ϕ i ϕ ˆ i substituting 21 25 26 into 28 we can have 29 v 1 i 1 n s i t α 1 β 1 ξ i α 1 1 q m i k b i 1 e i η k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η α 2 β 2 ξ i α 2 1 e n ξ i i 1 n tr w i t φ i s i t m η z i 1 i 1 n ϕ i m η z i 1 s i 1 according to 13 and 22 24 one has 30 e i η k ξ a i sign s i q m i k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η 1 α 1 β 1 ξ a i α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 m η z i 1 w ˆ i t φ i m η z i 1 ϕ ˆ i sign m η z i t s i m η z i 1 w i t φ i m η z i 1 θ i substituting 30 into 29 we obtain 31 v 1 i 1 n s i t α 1 β 1 ξ i α 1 1 q m i k b i 1 k ξ a i sign s i e n q m i k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η 1 α 1 β 1 ξ a i α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 m η z i 1 w i t φ i m η z i 1 ϕ ˆ i sign m η z i t s i m η z i 1 θ i e n q m i k a i 1 k ξ a i sign s i q m i k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η 1 α 1 β 1 ξ a i α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 m η z i 1 w i t φ i m η z i 1 ϕ ˆ i sign m η z i t s i m η z i 1 θ i α 2 β 2 ξ i α 2 1 e n ξ i tr w i t φ i s i t m η z i 1 ϕ i m η z i 1 s i 1 from 16 and 17 one has 32 ξ i q m i k b i 1 t e i η e n q m i k a i 1 t e i η therefore 33 ξ a i 1 diag ξ i 1 e i 1 η ξ i n e i n η q m i k b i 1 t e n q m i k a i 1 t then equation 31 can be simplified by 33 to 34 v 1 i 1 n s i t α 1 β 1 ξ i α 1 1 k sign s i 1 α 1 β 1 α 2 β 2 ξ i α 2 1 e n sig ξ i 2 α 1 ξ a i 1 m η z i 1 w i t φ i m η z i 1 ϕ ˆ i sign m η z i t s i m η z i 1 θ i q m i e n q m i k b i 1 k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η q m i e n q m i k a i 1 k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η α 2 β 2 ξ i α 2 1 e n ξ i tr w i t φ i s i t m η z i 1 ϕ i m η z i 1 s i 1 due to q m i e n q m i 0 and defining k k α 1 β 1 ξ i α 1 1 we obtain 35 v 1 i 1 n s i t k sign s i i 1 n s i t m η z i 1 w i t φ i tr w i t φ i s i t m η z i 1 i 1 n s i t m η z i 1 θ i ϕ ˆ i sign m η z i t s i i 1 n ϕ i m η z i 1 s i 1 i 1 n s i t k sign s i i 1 n s i t m η z i 1 θ i i 1 n s i t m η z i 1 1 ϕ ˆ i i 1 n ϕ i m η z i 1 s i 1 i 1 n s i t k sign s i i 1 n s i t m η z i 1 1 θ i ϕ ˆ i i 1 n m η z i 1 s i 1 ϕ i from θ i ϕ ˆ i ϕ i one has 36 v 1 i 1 n s i t k sign s i it is obvious that v 1 0 therefore according to 31 we can obtain the variable θ i m η z i 1 f i w ˆ i t φ i ϕ ˆ i sign m η z i t s i is bounded let θ i θ i where θ i is a positive constant step 2 select the lyapunov function as follow 37 v 2 1 2 i 1 n s i t s i taking the derivative of 37 one has 38 v 2 i 1 n s i t α 1 β 1 ξ i α 1 1 q m i k b i 1 e i η k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 e i η k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η α 2 β 2 ξ i α 2 1 e n ξ i i 1 n s i t k sign s i i 1 n s i t m η z i 1 f i w ˆ i t φ i ϕ ˆ i sign m η z i t s i i 1 n s i t k sign s i i 1 n s i θ i when ξ i j δ j 1 n where δ is a small positive constant which will be discussed in detail later letting k λ min k we have 39 v 2 i 1 n s i k θ i if k is chosen suitably we can obtain k θ i for any i v f therefore letting k k θ i 0 we can obtain 40 v 2 i 1 n k s i 2 k v 2 1 2 from lemma 2 the states of the multiple obfn systems will converge to sliding surface s i 0 n in finite time whe n ξ i j δ as δ is a small positive constant it is acceptable to consider that ξ i j 0 further we consider the situation of ξ i 0 n then from 14 19 and 33 we obtain 41 ξ i ξ a i 1 m η z i 1 b i u i 1 u i 2 c r b η z i η i c a η z i η i d η z i η i g η z i f i j v f a i j η j j v l a i j η j j v f a i j j v l a i j q m i k b i 1 k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η it is reasonable to assume b u i 2 f i 0 there exist three reasons first u i 2 is usually smaller than u i 1 second since δ is a small positive constant and region ii in fig 1 is very narrow thus the overall performance of the multiple obfn systems is not impacted too much finally u i 2 is proposed to estimate the general disturbance term f i therefore the assumption is reasonable according to the three reasons simplifying 41 based on the analysis above we have 42 ξ i ξ a i 1 m η z i 1 b i u i 1 c r b η z i η i c a η z i η i d η z i η i g η z i j v f a i j η j j v l a i j η j j v f a i j j v l a i j q m i k b i 1 k b i 1 k b i e i η 2 k b i 1 k b i e i η 2 k b i 1 k b i 2 e i η e n q m i k a i 1 k a i 1 k a i e i η 2 k a i 1 k a i e i η 2 k a i 1 k a i 2 e i η substituting 23 into 42 one has 43 ξ i k sign s i as ξ i ξ i 1 ξ i 2 ξ i n t and s i η s i 1 η s i 2 η s i n η t we obtain ξ i j k sign s i j j 1 2 n in fact based on the form of controller 23 one has that ξ i k sign s i in the case of ξ i j δ and ξ i 0 n for some j 1 n when s i j 0 and s i j 0 we have ξ i j k and ξ i j k from 43 which represents that ξ i j 0 is not an attractor therefore in the region which is a neighborhood ξ i j δ of ξ i j 0 one has ξ i j k and ξ i j k so that the states will cross the region ξ i j δ in finite time when ξ i j δ from 40 and lemma 2 the states of the multiple obfn systems can move to the sliding surface in finite time hence in any case the states of the multiple obfn systems will converge to sliding surface s i 0 n in finite time fig 3 gives the phase trajectory according to lemma 3 after each state reaches the terminal sliding surface s i 0 n they can converge to the origin in finite time i e e i η 0 n therefore ξ a i and ξ b i will also converge to ξ a i 0 n and ξ b i 0 n in finite time respectively by selecting the suitable lower and upper bounds k a i and k b i it is ensured that ξ a i 1 ξ a i n 1 and ξ b i 1 ξ b i n 1 hold at the beginning thus in the entire process the error constraint equation 15 holds in other words the error variable 12 does not exceed the designed limit remark 3 consider the problem of finite time adaptive synchronization for multiple obfn systems for any initial conditions to prove that every related variable can reach the origin in finite time is needed in this research we adopt the nonsingular terminal sliding mode technique thus it is necessary to prove the origin is the only attractor for the sliding surface a lot of studies have been done to solve this problem xu et al 2015 yao et al 2018 they show that it is reasonable to assume ξ i j 0 when ξ i j δ when e i η 0 n from error variable 12 we have that 44 j v f j i a i j j v l a i j η i j v f j i a i j η j j v l a i j η j according to 44 we can obtain 45 0 j v f j i a i j η j η i j v l a i j η j η i transforming 45 into a column vector one has 46 l 1 e n η 1 η n l 2 e n η n 1 η n m since l 1 is irreducible then 47 η 1 η n l 1 1 l 2 e n η n 1 η n m based on definition 1 and lemma 1 one has that l 1 1 l 2 e n η n 1 η n m means the convex hull formed by leader obfns according to 47 under the control strategy 22 in presence of thruster faults and error constraint distributed finite time fault tolerant error constraint containment control for multiple obfn systems is achieved the follower obfns will reach the convex hull formed by leader obfns in finite time remark 4 the adaptive law 26 is available to the case of s 0 however for the real sliding mode control as the nonlinear and switching terms exist in the systems s cannot converge to zero in finite time exactly then the adaptive parameter ϕ ˆ i will increase infinitely to avoid this problem we adopt the dead zone function to develop the adaptive law 26 48 ϕ ˆ i δ i m η z i 1 s i 1 s ς 0 s ς where ς is a constant 4 numerical simulations the numerical simulations are given in this section we consider the systems consisting of eight follower obfns no 1 8 and five leader obfns no 9 13 the dynamics and kinematics equations of follower obfns can be expressed as η i j i η i v i m η i η i c r b η i η i c a η i η r i d η i η r i g η i τ i i 1 8 the dynamics and kinematics equations of leader obfns can be expressed as η i j i η i v i m η i η i c r b η i η i c a η i η i d η i η i g η i τ l i i 9 13 the communication topology among the leaders and followers is shown in fig 4 for the model uncertainties we take 30 nominal values as model error which is handled as a part of general disturbances in this section a first order gauss markov process is adopted to simulate the disturbances of ocean current v c μ v c ω where v c means the velocity of ocean current in inertial reference frame ω represents a gaussian white noise which mean is 1 and variance is 1 and μ is 3 for thruster faults we assume the thruster t1 will have fault and we consider two kinds of thruster faults that is the abrupt and the incipient thruster fault cases which are expressed as 49 and 50 49 k 11 0 t 30 0 9 t 30 50 k 11 0 t 30 0 9 1 exp t 30 5 t 30 choose the control parameters as α 1 1 9 β 1 0 1 α 2 2 β 2 1 and k 175 the activation function of nn is selected as φ i z i φ i 1 z i φ i 11 z i t i 1 8 where φ i j z i means the gaussian function φ i j z i exp z i c i j 2 2 b i j 2 j 1 2 11 where z i η i t η i t ℝ 12 it is assumed that the activation functions are same for all the follower obfns the center of the neuron c i j is distributed evenly over the area 0 1 0 1 6 choose the width of gaussian function b i j 60 other parameters are selected as λ 1 λ 2 λ 3 λ 4 λ 5 λ 6 λ 7 λ 8 800 δ 1 δ 2 δ 3 δ 4 δ 5 δ 6 δ 7 δ 8 800 ς 0 3 we set the lower and upper bounds of the error constraint as 51 k a i j t 1 5 e 0 3 t 0 04 k b i j t 1 5 e 0 3 t 0 04 initial states of follower obfns are given in tables 2 and 3 the model parameters of obfns are given in tables 4 and 5 the position and angle trajectories of leader obfns are given in table 6 case 1 abrupt thruster fault under the abrupt thruster fault 49 the control effects of distributed control law 22 are shown in figs 5 7 without loss of generality follower obfn5 is chosen as an example to show the control forces and torques of the systems figs 8 and 9 show the simulation results meanwhile we also select follower obfn5 as an example to show the impact of error constraint figs 10 15 show the changes of the error variables where e 5 i j i 1 2 j 1 6 means the error variable of j th degree of freedom under the i th case i 1 means the case with error constraint and i 2 means the case without error constraint according to figs 5 and 6 we can find that the trajectories of follower obfns could reach the convex hull formed by leader obfns in finite time under the control protocol 22 when t 0s 20s 50s and 80s fig 7 gives the change of relative positions among the systems at t 0s we can find that all followers are outside the convex hull however they already move in the convex hull when t 20s and the followers could remain in the convex hull at t 50s and t 80s figs 8 and 9 show that follower obfn5 need large force and torque at the beginning period however after 10s the amplitudes of control force and torque reduce to 60 n and 100 nm the thruster t1 influences the surge and yaw of follower obfns thus according to the first picture in fig 5 and the third picture in fig 6 one can find that the leaders are followed by follower obfns and the yaw angles already reach zero before 30s after 30s follower obfns are still following the leaders and the yaw angles change but the amplitudes of curves are small so that the influence of change on the overall performance is small what s more from figs 10 and 15 which are about the surge and yaw we can find the errors increase after the thruster faults however after careful observation of figs 10 15 we can obtain that error variables are limited to the range represented in 51 by using the error constraint 22 therefore the transient and steady state performance of the multiple obfn systems are improved from those analyses in the presence of abrupt thruster faults the problem of distributed finite time fault tolerant error constraint containment control for multiple obfn systems is solved by using the distributed control method 22 case 2 incipient thruster fault similarly to case 1 figs 16 18 show the control effects of control method 22 in case 2 besides follower obfn5 is also chosen as an example the simulation results of the control inputs are shown in figs 19 and 20 and the change of error variables of six degrees of freedom are shown in figs 21 26 the simulation results are shown in figs 16 26 which are similar to those of figs 5 15 thus are omitted therefore similarly to case 1 under the distributed control protocol 22 the distributed finite time fault tolerant error constraint containment control could also be achieved in the incipient thruster fault case remark 5 for the error bounds the range of error constraint in the simulation is small however in practical applications since the multiple obfn systems will sail in the ocean the acceptable error range is relatively large what s more the multiple obfn systems for simulation are also the objects which we need to control in practice results of simulation can show that this algorithm is feasible in theory although parameters related to error bounds need to be adjusted when it is applied to practical projects they will not change a lot these parameters will still have a lead effect to sum up error range is relatively large and can refer to the parameters in simulation therefore the task of setting time varying bounds in advance is not a hard work it will not make the proposed control technique hardly implementable on real applications remark 6 for the multiple obfn systems we can divide the parameters used in the simulation into two categories the first category is the parameters related to obfn model obtained through hydrodynamic experiments which cannot be changed the remaining parameters fall into the second category which are determined by constantly tuning after determining the first category parameters related to the obfn model the simulation results are optimized by adjusting the second type of parameters finally the parameters related to the control strategy can be obtained remark 7 in practical engineering when the obfn systems move to the target area we plan to keep all obfns moving on the same horizontal plane so as to reduce the overall resistance and save energy during the simulation all obfns are arranged on the same horizontal plane which can also better and more vividly show the containment effect of the proposed algorithm 5 conclusion in presence of thruster faults and error constraint when the leader obfns can only be measured by a part of follower obfns this paper investigates distributed finite time fault tolerant error constraint containment control algorithm for multiple obfn systems under directed communication topology the external disturbances and model uncertainties are also considered by introducing a new form of error variable to replace the original error variable selecting a nonsingular fast terminal sliding surface and utilizing the nn to approximate the general disturbances the problem of distributed finite time fault tolerant error constraint containment control is solved based on graph theory and finite time theory it is proved that containment control can be realized in finite time and the containment errors are bounded through numerical simulations it is obtained the follower obfns can move in the convex hull formed by leaders in finite time the error variables are limited to the range of error and the systems can still move steadily after the occurrence of thruster faults which are considered under two cases conflicts of interest the authors declare that they have no conflict of interest acknowledgements this work was supported by national natural science foundation of china under grant nos 51939003 and 61803119 and the research fund from science and technology on underwater vehicle technology under grant no 6142215180208 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 106341 
22519,a two dimensional numerical study was performed to investigate wake structures and fluid forces on a circular cylinder with prescribed vibrations in the in line direction reynolds number was fixed at 500 and the sst k w model was used to simulate turbulence in the flow a wake map for in line vibrations which includes six wake patterns named as ss s as s 2po s p s and s 2p is drawn in the plane of non dimensional frequency from 0 2 to 0 9 and an amplitude ratio from 0 01 to 0 275 the s 2po mode is a newly discovered wake pattern that consists of two pairs of symmetric vortex shedding per cycle the s p s mode and s 2p mode follow similar wake patterns as the p s mode and the 2p mode for cross flow vibrations and it takes two in line cycles to complete one s p s or s 2p vortex shedding cycle extensive numerical investigations show that similar wake structures can be produced if the maximum and minimum values of relative velocity between the flow and the vibrating cylinder are kept the same regardless of the motion directions one positive excitation coefficient region is observed for the non dimensional frequency ranging from 0 38 to 0 43 and the peak amplitude ratio of the zero contour line for the excitation coefficient reaches 0 056 the changing sign of energy transfer between flow and structure is not necessarily caused by the change of wake modes but it results from the changing time of vortex shedding typical figure eight profiles are captured for simultaneous values of lift and drag forces within the positive excitation region keywords in line vortex induced vibrations wake structures computational fluid dynamics 1 introduction vortex induced vibrations viv have attracted attention in the last two decades because these responses can cause large fatigue damage in engineering structures such as bridges chimneys marine risers and pipelines progressive achievements in the fundamental viv mechanism and industry applications are summarized in the review papers by sarpkaya 2004 williamson and govardhan 2004 2008 lie and larsen 2006 dalton 2010 bearman 2011 and wu et al 2012 two different classes of experiments have been used to understand the fundamental mechanism of viv one is called free vibrations and the other is called prescribed or forced vibrations in free vibrations the motion of the structure is driven by the hydrodynamic forces caused by vortex shedding the classic experiments on free vibrations can be found in the papers by vikestad 1998 khalak and williamson 1996 1999 govardhan and williamson 2000 2002 and raghavan and bernitsas 2011 however in forced vibrations the movements of the structure are defined by prescribed trajectories that can result in energy transfer from fluid to structure or from structure to fluid one of the experiments on forced vibrations refers to williamson and roshko 1998 in which the wake structures of a vibrating circular cylinder were carefully examined for reynolds numbers ranging from 300 to 1000 later known as the w r wake map the w r wake map was produced in the plane of the amplitude ratio a d and wavelength λ d and it is divided into several regions referring to different wake patterns such as the 2s p s and 2p modes in the 2s mode two single vortices shed per cycle p s indicates one pair and one single vortex per cycle and 2p indicates two pairs of vortices per cycle another classic controlled vibration experiment was carried out by gopalkrishon 1993 and the experimental results on hydrodynamic forces are widely applied in the prediction of the viv responses of flexible structures because computing technology has developed in recent years many numerical analyses have been carried out to study the basic mechanics of viv in the field of computational fluid dynamics cfd research from such studies can be found in blackburn and henderson 1999 lu and turan 2000 blackburn et al 2001 guilmineau and queuty 2004 pan et al 2007 and later by ji et al 2011 zhao et al 2012 and du et al 2014 wanderley s research group has conducted a series of simulations on cross flow vibrations and the publications include wanderley et al 2007 2008 2009 wanderley et al 2008 presented a remarkable agreement in response branches and wake structures between their numerical results and data measured by khalak and williamson 1996 the research work mentioned above focuses on cross flow cf vibrations in line il vibrations have so far been regarded as less important because these amplitudes are much smaller than the cf component however there is an increasing interest in il vibrations because they can contribute significantly to fatigue accumulation for the following reasons the il response frequency is twice that of the cf frequency and the il response will therefore appear at higher mode orders than cf and may hence give higher stresses even if the amplitudes are smaller the number of il stress cycles is twice that of cf cycles and the il response could become dominant at current velocities lower than the onset velocity for cf response hence fatigue damage from il may exceed cf which in fact is demonstrated in a study on il and cf fatigue damage is reported in baarholm et al 2006 srinil and zanganeh 2012 applied double duffing van der pol oscillators to study the coupled cf il viv of a spring mounted circular cylinder wu et al 2016 studied the interactions between il and cf vibrations and claimed that the phase angle is one of the key parameters to be included in the empirical viv predictions in order to model il and cf response of a riser ezeonwumelu et al 2017 compared the fatigue damage to vertical rigid risers vrr caused by inline and cross flow viv and it is found that the fatigue damage due to in line viv is vital from the touch down point to most parts of the unstraked region on the vrr irrespective of the wave spectra not much research on il vibrations has been published in recent decades earlier experiments include wootton et al 1972 and king and johns 1973 wootton et al 1972 used free il vibrations at a subcritical reynolds number and the il response appeared in two regions with a maximum amplitude ratio close to 0 14 for the first region and 0 13 for the second region a streamwise symmetry wake pattern ss mode was observed in the first region and an anti symmetry wake pattern as mode was observed in the second region griffin and ramberg 1976 measured the wake structures behind a controlled vibrating circular cylinder at re 190 and two wake patterns of s mode a single vortex per cycle and 2s mode were observed in their experiments aronsen 2007 tested a set of motion controlled il vibrations at a reynolds number of 24000 and the excitation coefficient was found in the plane of non dimensional frequency and amplitude ratio the zero contour for the excitation coefficient thick line shows two regions with a peak amplitude ratio of 0 13 for the first region and 0 123 for the second region however several questions related to il vibrations remain unanswered what are the wake structures for the il vibrations with high response amplitude are there any new wake patterns are there any connections between the wake patterns for pure il and pure cf vibrations an understanding of the hydrodynamic forces on the cylinder would be useful to evaluate the fatigue damage for slender structures caused by il vibrations at low reynolds numbers inspired by the questions mentioned above the present work is an attempt to resolve some of the issues related to wake structures and hydrodynamic forces for forced il vibrations the numerical simulations are carried out at re 500 and the circular cylinder is forced to move in a harmonic way at a given amplitude ratio ranging from 0 01 to 0 275 and a non dimensional frequency from 0 2 to 0 9 the wake structures produced during il vibrations are extensively studied and the fluid forces corresponding to each wake mode are reported in details 2 numerical method 2 1 fluid modelling the two dimensional incompressible reynolds averaged navier stokes equations can be written as follows 1 u i x i 0 2 t ρ f u i x j ρ f u i u j p x i x j 2 μ s i j ρ f u j u i u i is the time averaged velocity tensor and p is the time averaged pressure μ is the molecular viscosity and ρ f is the density of the fluid s i j is the stress tensor s i j 1 2 u i x j u j x i u i in eqn 2 represents the fluctuating part of the flow velocity and u j u i represents the time averaged value of u j u i which should not be found explicitly but rather modeled as a function of the time averaged velocity u i 3 ρ f u j u i μ t u i x j u j x i 2 3 ρ f k δ i j where μ t is the eddy viscosity which varies in the time domain and k 1 2 u i u i is the kinetic energy per unit mass here the shear stress transports sst k ω turbulence model is used to close the equations with two transport equations for the turbulence kinetic energy k and the specific dissipation rate ω further detailed information on the sst k ω turbulence model are given by menter 1994 and wilcox 2006 the computational fluid dynamic software ansys fluent is used as a tool for the turbulence modelling the implicit first order scheme was used for the unsteady term and the simpec algorithm for the pressure velocity coupling equations a second order scheme was applied for the k and ω transport equations and for the convection and diffusion terms 2 2 forced cylinder motion the cylinder is forced to oscillate in the il direction following a sinusoidal function 4 x t a i l sin 2 π f o s c i l t where a i l is the il oscillating amplitude and f o s c i l is the oscillating frequency the non dimensional frequency and amplitude ratios are defined as 5 f i l f o s c i l d u f 6 a i l a i l d d is the diameter of the circular cylinder and u f is the ambient flow velocity in the present simulations the diameter of the circular cylinder d 0 01 m and the flow velocity u f 0 05 m s the flow domain has a size of 55 d 40 d in the x and y directions respectively and the circular cylinder is located at a distance of 20 d away from the velocity inlet boundary in the front a moving grid around circular cylinder is regarded as a rigid body and it follows the movement of the cylinder the outside grid can be stretched or compressed according to the position of the moving grid the fine mesh around the cylinder surface is shown in fig 1 as the flow goes from left to right the pressure outlet is used for the right end and there are symmetric boundaries for the top and the bottom the no slip boundary condition is applied on the cylinder surface a grid convergence study has been performed for flow over a stationary cylinder at re 500 see table 1 a the maximum deviation of hydrodynamic quantity between two meshes is less than 3 the test b mesh with 19353 grids gives a sufficient numerical accuracy and the predicted hydrodynamic quantities drag coefficient oscillating value of drag coefficient lift coefficient strouhal number and base pressure coefficient are in good agreement with published results reported by blackburn and henderson 1999 and labbe and wilson 2007 to authors knowledge there are no available published hydrodynamic results for the flow over an in line vibrating cylinder at re 500 in the open literature therefore it is very important to ensure that the verification study convergence study is performed properly a grid convergence study based on the comparison of hydrodynamic quantities drag coefficient excitation coefficient added mass coefficient and phase angle between velocity and acceleration has been performed as shown in table 1 b and it is found that the test b mesh with 19353 grids give a sufficient numerical accuracy the conclusion of the grid convergence study is that the test b mesh should be used for all simulations and analyses in the present study 3 results and discussion 3 1 wake structures a map of wake patterns found from a total of 320 analyses consisting of 20 il amplitudes from a i l 0 01 to 0 275 combined with 16 frequencies from f i l 0 2 to 0 9 is shown in fig 2 the il wake map can be divided into six regions consisting of the s as ss s p s s 2p as and s 2po modes here s as indicates an anti symmetry vortex shedding every two il cycles s p s represents one pair plus one single vortex and s 2p indicates two pairs of vortices shed every two il cycles the s 2po mode is a new wake pattern and is defined as two pairs of symmetric vortices shed every il cycle the energy of one vortex in the pair is however much higher than that of the other the ss and as modes are defined in the previous introduction section one should note that for combined il and cf viv and there will be two il cycles for each cf cycles this is the reason that the notation s is used for the il wake modes to distinguish them from those observed for the cf vibrations to illustrate the vortex shedding process for each wake mode eight instantaneous wake contours within two il vibrating cycles are presented from figs 3 9 the movements of the cylinder can be seen from the marked numbers in the time records of displacements the as mode indicates that two anti symmetric vortices are shed per cycle and the pattern is close to the von karman vortex street see fig 3 a clockwise vortex is developed and shed from the top of the cylinder as it moves from positions 1 to 4 while an anti clockwise vortex is shed from the bottom of the cylinder from positions 5 to 8 one cycle of lift forces and two cycles of drag forces are generated corresponding to one il oscillating cycle because the vortices are shed alternately from the top and bottom of the cylinder the non dimensional lift force and drag force vary regularly see fig 3 b the s as mode is found at relatively high non dimensional frequencies and it follows similar wake patterns as the as mode the s as mode was also found in the experiment by griffin and ramberg 1976 defined as the s mode however the s as mode takes two il oscillation cycles to complete one shedding cycle whereas only one il oscillation cycle is needed for the as mode to compare the as and s as mode directly the instaneous wake contours were taken from the same amplitude as those in the as mode see fig 4 one should note that the oscillation amplitude remains unchanged while the non dimensional frequency is increased from f 0 22 to f 0 5 it is clear that only one clockwise vortice is shed from the top of the cylinder and that half cycle lift forces are produced within one il oscillation cycle from position 1 to 8 the magnitude of the lift force however is less affected by the switch of the wake pattern from as to s as mode fig 5 presents the ss mode which is normally observed in pure il vibrations as the vortices become symmetric in the wake the magnitude of the lift force approaches zero see fig 5 nevertheless there is large variation in the drag forces and even negative drag forces are produced for some of the forced motion cases actually the ss mode becomes unstable and it turns to alternate vortex shedding after a certain distance in the wake the ss modes at the same non dimensional frequency f 0 556 with increasing amplitudes from 0 11 to 0 15 are presented in fig 6 it is seen that the symmetric wake structures are replaced by alternate vortex shedding after a certain distance in the wake whereas the length of the symmetry structures increases with increasing response amplitudes a new wake pattern s 2po is discovered in the high non dimensional frequency region with high response amplitudes as shown in fig 7 differing from the 2po mode which was found in the cf vibrations by morse and williamson 2009 the two pairs of vortices in the present s 2po mode are symmetrically shed into the wake and the weak vortex in the upper pair is placed on top of the strong vortex in addition the strong vortex in the pair becomes even stronger as it moves downstream while the weak vortex finally disappears in the far wake the top and bottom vortex streets are separated by the center line of the cylinder with a growing gap distance in the wake the lift force is small because of the symmetrical vortex shedding and the drag force amplitudes are more intense than those in the other il wake modes the s p s and s 2p modes shown in figs 8 and 9 respectively follow similar wake structures to the p s and 2p modes that are observed in the cf vibrations the vorticity strength of one vortex in the pair of the s p s mode is much less than that of the other one and the net energy of the vortex within one shedding cycle is close to zero the two vortices in the pair of the s 2p mode are of almost equal energy the magnitudes of the drag and lift forces produced by the s p s and s 2p modes are similar to each other and high order lift forces are clearly observed see figs 8 and 9 it is well known that the p s and 2p modes are usually observed in cf vibrations but similar wake structures are found in pure il vibrations here however it is not understood how il and cf vibrations produce similar wake structures even though the cylinder vibrates in completely different directions the answer could be related to the relative velocity between the flow and the vibrating cylinder the velocity of the vibrating cylinder can be deduced from eqn 4 7 u s i l t x t 2 π f o s c i l a i l cos 2 π f o s c i l t for a given il vibration at a fixed reynolds number we can easily find the relative velocity between the flow and the cylinder at every time step the maximum and minimum values of the relative velocity can then be defined as 8 u max u f u s i l t u min u f u s i l t where u f is the flow velocity and u s i l t is the amplitude of the vibrating velocity in the same way there also exist maximum and minimum values of the relative velocity in cf vibrations even though the cylinder vibrates in different directions with different oscillating frequencies and response amplitudes the minimum and maximum values of the relative velocity could match each other and this could be the reason for the similar wake structures produced in the il and cf vibrations it is also possible that similar wake structures can be produced for different cases of il vibrations if the maximum and minimum values of relative velocity are close to each other to confirm the above statements a set of analyses has been conducted the idea has been to obtain the same amplitudes of relative velocity by various combinations of il and cf amplitudes and time varying flow velocities and to compare the wake structure found from these cases fig 10 a illustrates how pure il forced motions can be represented by a time varying flow velocities the original case with constant current u f and maximum il motion velocity u s is equivalent to a fixed cylinder exposed to a time varying flow with mean value u f and amplitude u s see fig 11 the same situation can also be reconstructed by constant flow velocity u f u s combined with a cross flow forced motion for which the velocity is given by 9 u s c f t y t 2 π f o s c c f a c f cos 2 π f o s c c f t where f o s c c f is the oscillating frequency in the cf direction it follows that f o s c c f f o s c i l 2 because the il frequency is normally twice that of cf actually the magnitudes of the flow velocity and the cf vibrating velocity on the right side can be adjusted to match the maximum and minimum values of relative velocity on the left side the flow velocity is first fixed to the minimum relative velocity and then the magnitude of the vibrating velocity of the cylinder can be deduced 10 u f u f u s i l t 11 u s c f t 2 u max 2 u f 2 the wake modes as s 2p ss and s 2po observed for pure il vibrations were tested under the extreme boundary conditions i e the circular cylinder was fixed but the wanted history of the relative velocity was modeled as a prescribed velocity at the inlet boundary the main parameters for the original and transformed velocities are listed in table 2 and the wake structures observed from the new velocity conditions are presented in fig 13 it appears that even when the cylinder is set to be stationary similar wake structures can be reproduced with the new boundary conditions when the maximum and minimum values of the relative velocity are kept unchanged the velocity conditions of the s p s mode from the il vibration were transformed into equivalent cf vibration profiles as listed in table 2 eight instantaneous wake contours within one cf vibrating cycle are presented in fig 12 difference on the near wake structures exists between the s p s and p s modes because the cylinder is vibrating in different directions however the p s mode which has a wake pattern similar to that of the s p s mode is clearly observed a single vortex is shed on the top of the cylinder as it moves from positions 1 to 4 and one pair of vortices is shed at the bottom of the cylinder from positions 5 to 8 the transverse distance between the single vortex and the pair of vortices in the p s mode is wider than it is in the s p s mode the fluid forces obtained in the p s mode are significantly different from those observed in the s p s mode see fig 12 b the mean drag force and lift force are increased for cf vibration compared with forces found for il vibration the 2p wake structures following the similar patterns as the s p s mode in the il vibrations were also observed in the transformed cf vibrations but are not shown here 3 2 hydrodynamic forces the excitation force coefficient c e i l is related to the fluid force in phase with the velocity cf eqs a3 and a5in the appendix the contour plot of the excitation coefficient from the forced il vibrations discussed here is presented in fig 13 the thick line shows the zero contour of excitation coefficient one region with positive value of c e i l is observed for non dimensional frequencies f i l from 0 38 to 0 43 however there is a tendency for a second positive excitation region to occur between non dimensional frequencies f i l 0 5 and 0 6 according to aronsen 2007 that this region will be fully developed for high reynolds number the peak amplitude ratio of the zero contour excitation coefficient is a i l 0 056 while aronsen 2007 found a i l 0 13 as the maximum value for the zero contour line the discrepancy is most likely to be caused by different reynolds number for the experiments and the computations the present simulations applied re 500 while reynolds number was fixed to 24000 in aronsen s experiments fig 13 b presents the contour plot of added mass which is defined as the fluid forces in phase with acceleration cf eqs a4 and a6 the contour curves are close to vertical lines for a i l 0 08 and f i l 0 4 which indicates that the added mass is less affected by the amplitude ratio than non dimensional frequency in this region when the contour of excitation coefficients is mapped onto the il wake structure map it is found that the change of sign of c e i l from positive to negative does not follow any change in the wake modes fig 14 shows pictures of the wake structure for f i l 0 408 with an oscillating amplitude varying from a i l 0 04 to 0 07 the direction of energy transfer or the sign of c e i l switches at a i l 0 053 whereas the wake structures at a i l 0 05 and a i l 0 06 are both observed as the as mode however the phase between motion and vortex shedding changes between a i l 0 05 and a i l 0 06 i e an anti clockwise vortex is shed from the bottom of the cylinder in fig 14 a and b but becomes a clockwise vortex shedding from the top of the cylinder in fig 14 c d the changing time for vortex shedding can also be inferred from the time history of the drag forces as shown in the right column of fig 14 for the amplitude ratio at a i l 0 04 and a i l 0 05 a negative drag force is observed at points a1 and b1 corresponding to the negative vibrating velocity at points a0 and b0 it becomes a positive drag force at points a1 and b1 for a i l 0 06 and a i l 0 07 but the corresponding vibrating velocity of the cylinder is still negative the changing time of the vortex shedding phenomenon was also observed and discussed in lu and dalton 1996 and leontini et al 2006 fig 15 presents the contours for the drag coefficient and the r m s value of the fluctuating drag force cf eq a7 in appendix it is found that the drag coefficient corresponding to the s 2p mode region is larger than those generated from other il wake modes whereas the drag coefficients obtained from the ss and s 2po modes are less affected by the non dimensional frequency and amplitude ratio the r m s value of the fluctuating drag force increases with increasing amplitude ratio and non dimensional frequency the simultatious values of the lift and drag forces corresponding to three response amplitudes at a non dimensional frequency f 0 408 are presented in fig 16 the results for drag force and il displacement are also plotted in the second row a typical figure eight profile is clearly shown between the lift and drag forces at an amplitude ratio a i l 0 03 which is located in the positive excitation region the figure eight is stretched with sharp corners at a i l 0 12 due to the high order harmonic lift forces produced by the s p s mode an irregular profile is observed at a i l 0 25 because the lift force is close to zero as a result of the symmetric s 2po wake mode however the profiles of the drag force and il displacement have similar shapes as shown in the second row fig 17 presents the profiles for lift and drag forces at the non dimensioanl frequency f 0 312 which is outside the positive excitation region the profile at amplitude ratio a i l 0 03 is irregular and shows some drift of the solution periodic profiles but with intricate traces are observed at amplitude ratios a i l 0 12 and a i l 0 25 4 conclusions forced il vibrations of a circular cylinder in a uniform flow are numerically studied at a reynolds number of 500 an il wake map consisting of six wake regions is produced and a new wake mode s 2po is found the typical il wake modes ss and as are also captured it is exciting to find that similar wake structures between il vibrations s p s and s 2p modes and cf vibrations p s and 2p modes exist because the maximum and minimum values of the relative velocity between the flow and the vibrating cylinder overlap the fluid forces on the cylinder corresponding to each wake mode are reported and the contour plots of the excitation coefficient added mass and drag coefficient are presented in the plane of non dimensional frequency and amplitude ratio compared with the results for the excitation coefficient at high reynolds numbers a more narrow positive excitation region is observed at the low reynolds number and the peak amplitude ratio of the zero contour of the excitation coefficient is 0 056 in contrast to 0 13 for the higher reynolds number at 24000 the s 2p mode can produce larger drag forces than the other modes while the r m s value of the fluctuating drag forces is increased with increasing amplitude ratio and non dimensional frequency the curves for simultaneous values of lift and drag forces present figure eight patterns and skewed elliptical patterns are observed between drag forces and in line displacements within the positive excitation region acknowledgement the present simulations were supported by the research council of norway through a grant of computing time appendix data processing the definitions of the main parameters calculated in the present simulation are listed as follows the force components fil t and fcf t were found by direct integration of the pressure on the cylinder surface during the fluid simulation hence we could calculate the hydrodynamic coefficients as follows the drag coefficient related to the mean value of the in line force is given by a1 c d 1 n t t t n t f i l t 1 2 ρ l d u 0 2 d t the lift coefficient related to the mean value of the cf force is given by a2 c l 1 n t t t n t f c f t 1 2 ρ l d u 0 2 d t the amplitude of the il force component in phase with the il velocity is a3 f e 0 i l 2 n t x 0 ω t t n t f i l t x t d t the amplitude of the cf force component in phase with the cf acceleration is a4 f a 0 i l 2 n t x 0 ω 2 t t n t f i l t x t d t the excitation force coefficient in the il direction is a5 c e i l f e 0 i l 1 2 ρ d l u 0 2 the added mass coefficient in the il direction is a6 c a i l f a 0 i l 1 4 ρ π d 2 l x 0 2 ω 2 it may also be convenient to calculate a coefficient that can describe the variability of the total il and cf forces often referred to as an r m s coefficient this coefficient is defined by a7 c r m s i l 2 n t t t n t f i l t f i l 2 d t 1 2 ρ d l u 0 2 where f i l is the mean value of f i l t the r m s coefficient c r m s i l denotes the magnitude of the oscillating force in the il direction 
22519,a two dimensional numerical study was performed to investigate wake structures and fluid forces on a circular cylinder with prescribed vibrations in the in line direction reynolds number was fixed at 500 and the sst k w model was used to simulate turbulence in the flow a wake map for in line vibrations which includes six wake patterns named as ss s as s 2po s p s and s 2p is drawn in the plane of non dimensional frequency from 0 2 to 0 9 and an amplitude ratio from 0 01 to 0 275 the s 2po mode is a newly discovered wake pattern that consists of two pairs of symmetric vortex shedding per cycle the s p s mode and s 2p mode follow similar wake patterns as the p s mode and the 2p mode for cross flow vibrations and it takes two in line cycles to complete one s p s or s 2p vortex shedding cycle extensive numerical investigations show that similar wake structures can be produced if the maximum and minimum values of relative velocity between the flow and the vibrating cylinder are kept the same regardless of the motion directions one positive excitation coefficient region is observed for the non dimensional frequency ranging from 0 38 to 0 43 and the peak amplitude ratio of the zero contour line for the excitation coefficient reaches 0 056 the changing sign of energy transfer between flow and structure is not necessarily caused by the change of wake modes but it results from the changing time of vortex shedding typical figure eight profiles are captured for simultaneous values of lift and drag forces within the positive excitation region keywords in line vortex induced vibrations wake structures computational fluid dynamics 1 introduction vortex induced vibrations viv have attracted attention in the last two decades because these responses can cause large fatigue damage in engineering structures such as bridges chimneys marine risers and pipelines progressive achievements in the fundamental viv mechanism and industry applications are summarized in the review papers by sarpkaya 2004 williamson and govardhan 2004 2008 lie and larsen 2006 dalton 2010 bearman 2011 and wu et al 2012 two different classes of experiments have been used to understand the fundamental mechanism of viv one is called free vibrations and the other is called prescribed or forced vibrations in free vibrations the motion of the structure is driven by the hydrodynamic forces caused by vortex shedding the classic experiments on free vibrations can be found in the papers by vikestad 1998 khalak and williamson 1996 1999 govardhan and williamson 2000 2002 and raghavan and bernitsas 2011 however in forced vibrations the movements of the structure are defined by prescribed trajectories that can result in energy transfer from fluid to structure or from structure to fluid one of the experiments on forced vibrations refers to williamson and roshko 1998 in which the wake structures of a vibrating circular cylinder were carefully examined for reynolds numbers ranging from 300 to 1000 later known as the w r wake map the w r wake map was produced in the plane of the amplitude ratio a d and wavelength λ d and it is divided into several regions referring to different wake patterns such as the 2s p s and 2p modes in the 2s mode two single vortices shed per cycle p s indicates one pair and one single vortex per cycle and 2p indicates two pairs of vortices per cycle another classic controlled vibration experiment was carried out by gopalkrishon 1993 and the experimental results on hydrodynamic forces are widely applied in the prediction of the viv responses of flexible structures because computing technology has developed in recent years many numerical analyses have been carried out to study the basic mechanics of viv in the field of computational fluid dynamics cfd research from such studies can be found in blackburn and henderson 1999 lu and turan 2000 blackburn et al 2001 guilmineau and queuty 2004 pan et al 2007 and later by ji et al 2011 zhao et al 2012 and du et al 2014 wanderley s research group has conducted a series of simulations on cross flow vibrations and the publications include wanderley et al 2007 2008 2009 wanderley et al 2008 presented a remarkable agreement in response branches and wake structures between their numerical results and data measured by khalak and williamson 1996 the research work mentioned above focuses on cross flow cf vibrations in line il vibrations have so far been regarded as less important because these amplitudes are much smaller than the cf component however there is an increasing interest in il vibrations because they can contribute significantly to fatigue accumulation for the following reasons the il response frequency is twice that of the cf frequency and the il response will therefore appear at higher mode orders than cf and may hence give higher stresses even if the amplitudes are smaller the number of il stress cycles is twice that of cf cycles and the il response could become dominant at current velocities lower than the onset velocity for cf response hence fatigue damage from il may exceed cf which in fact is demonstrated in a study on il and cf fatigue damage is reported in baarholm et al 2006 srinil and zanganeh 2012 applied double duffing van der pol oscillators to study the coupled cf il viv of a spring mounted circular cylinder wu et al 2016 studied the interactions between il and cf vibrations and claimed that the phase angle is one of the key parameters to be included in the empirical viv predictions in order to model il and cf response of a riser ezeonwumelu et al 2017 compared the fatigue damage to vertical rigid risers vrr caused by inline and cross flow viv and it is found that the fatigue damage due to in line viv is vital from the touch down point to most parts of the unstraked region on the vrr irrespective of the wave spectra not much research on il vibrations has been published in recent decades earlier experiments include wootton et al 1972 and king and johns 1973 wootton et al 1972 used free il vibrations at a subcritical reynolds number and the il response appeared in two regions with a maximum amplitude ratio close to 0 14 for the first region and 0 13 for the second region a streamwise symmetry wake pattern ss mode was observed in the first region and an anti symmetry wake pattern as mode was observed in the second region griffin and ramberg 1976 measured the wake structures behind a controlled vibrating circular cylinder at re 190 and two wake patterns of s mode a single vortex per cycle and 2s mode were observed in their experiments aronsen 2007 tested a set of motion controlled il vibrations at a reynolds number of 24000 and the excitation coefficient was found in the plane of non dimensional frequency and amplitude ratio the zero contour for the excitation coefficient thick line shows two regions with a peak amplitude ratio of 0 13 for the first region and 0 123 for the second region however several questions related to il vibrations remain unanswered what are the wake structures for the il vibrations with high response amplitude are there any new wake patterns are there any connections between the wake patterns for pure il and pure cf vibrations an understanding of the hydrodynamic forces on the cylinder would be useful to evaluate the fatigue damage for slender structures caused by il vibrations at low reynolds numbers inspired by the questions mentioned above the present work is an attempt to resolve some of the issues related to wake structures and hydrodynamic forces for forced il vibrations the numerical simulations are carried out at re 500 and the circular cylinder is forced to move in a harmonic way at a given amplitude ratio ranging from 0 01 to 0 275 and a non dimensional frequency from 0 2 to 0 9 the wake structures produced during il vibrations are extensively studied and the fluid forces corresponding to each wake mode are reported in details 2 numerical method 2 1 fluid modelling the two dimensional incompressible reynolds averaged navier stokes equations can be written as follows 1 u i x i 0 2 t ρ f u i x j ρ f u i u j p x i x j 2 μ s i j ρ f u j u i u i is the time averaged velocity tensor and p is the time averaged pressure μ is the molecular viscosity and ρ f is the density of the fluid s i j is the stress tensor s i j 1 2 u i x j u j x i u i in eqn 2 represents the fluctuating part of the flow velocity and u j u i represents the time averaged value of u j u i which should not be found explicitly but rather modeled as a function of the time averaged velocity u i 3 ρ f u j u i μ t u i x j u j x i 2 3 ρ f k δ i j where μ t is the eddy viscosity which varies in the time domain and k 1 2 u i u i is the kinetic energy per unit mass here the shear stress transports sst k ω turbulence model is used to close the equations with two transport equations for the turbulence kinetic energy k and the specific dissipation rate ω further detailed information on the sst k ω turbulence model are given by menter 1994 and wilcox 2006 the computational fluid dynamic software ansys fluent is used as a tool for the turbulence modelling the implicit first order scheme was used for the unsteady term and the simpec algorithm for the pressure velocity coupling equations a second order scheme was applied for the k and ω transport equations and for the convection and diffusion terms 2 2 forced cylinder motion the cylinder is forced to oscillate in the il direction following a sinusoidal function 4 x t a i l sin 2 π f o s c i l t where a i l is the il oscillating amplitude and f o s c i l is the oscillating frequency the non dimensional frequency and amplitude ratios are defined as 5 f i l f o s c i l d u f 6 a i l a i l d d is the diameter of the circular cylinder and u f is the ambient flow velocity in the present simulations the diameter of the circular cylinder d 0 01 m and the flow velocity u f 0 05 m s the flow domain has a size of 55 d 40 d in the x and y directions respectively and the circular cylinder is located at a distance of 20 d away from the velocity inlet boundary in the front a moving grid around circular cylinder is regarded as a rigid body and it follows the movement of the cylinder the outside grid can be stretched or compressed according to the position of the moving grid the fine mesh around the cylinder surface is shown in fig 1 as the flow goes from left to right the pressure outlet is used for the right end and there are symmetric boundaries for the top and the bottom the no slip boundary condition is applied on the cylinder surface a grid convergence study has been performed for flow over a stationary cylinder at re 500 see table 1 a the maximum deviation of hydrodynamic quantity between two meshes is less than 3 the test b mesh with 19353 grids gives a sufficient numerical accuracy and the predicted hydrodynamic quantities drag coefficient oscillating value of drag coefficient lift coefficient strouhal number and base pressure coefficient are in good agreement with published results reported by blackburn and henderson 1999 and labbe and wilson 2007 to authors knowledge there are no available published hydrodynamic results for the flow over an in line vibrating cylinder at re 500 in the open literature therefore it is very important to ensure that the verification study convergence study is performed properly a grid convergence study based on the comparison of hydrodynamic quantities drag coefficient excitation coefficient added mass coefficient and phase angle between velocity and acceleration has been performed as shown in table 1 b and it is found that the test b mesh with 19353 grids give a sufficient numerical accuracy the conclusion of the grid convergence study is that the test b mesh should be used for all simulations and analyses in the present study 3 results and discussion 3 1 wake structures a map of wake patterns found from a total of 320 analyses consisting of 20 il amplitudes from a i l 0 01 to 0 275 combined with 16 frequencies from f i l 0 2 to 0 9 is shown in fig 2 the il wake map can be divided into six regions consisting of the s as ss s p s s 2p as and s 2po modes here s as indicates an anti symmetry vortex shedding every two il cycles s p s represents one pair plus one single vortex and s 2p indicates two pairs of vortices shed every two il cycles the s 2po mode is a new wake pattern and is defined as two pairs of symmetric vortices shed every il cycle the energy of one vortex in the pair is however much higher than that of the other the ss and as modes are defined in the previous introduction section one should note that for combined il and cf viv and there will be two il cycles for each cf cycles this is the reason that the notation s is used for the il wake modes to distinguish them from those observed for the cf vibrations to illustrate the vortex shedding process for each wake mode eight instantaneous wake contours within two il vibrating cycles are presented from figs 3 9 the movements of the cylinder can be seen from the marked numbers in the time records of displacements the as mode indicates that two anti symmetric vortices are shed per cycle and the pattern is close to the von karman vortex street see fig 3 a clockwise vortex is developed and shed from the top of the cylinder as it moves from positions 1 to 4 while an anti clockwise vortex is shed from the bottom of the cylinder from positions 5 to 8 one cycle of lift forces and two cycles of drag forces are generated corresponding to one il oscillating cycle because the vortices are shed alternately from the top and bottom of the cylinder the non dimensional lift force and drag force vary regularly see fig 3 b the s as mode is found at relatively high non dimensional frequencies and it follows similar wake patterns as the as mode the s as mode was also found in the experiment by griffin and ramberg 1976 defined as the s mode however the s as mode takes two il oscillation cycles to complete one shedding cycle whereas only one il oscillation cycle is needed for the as mode to compare the as and s as mode directly the instaneous wake contours were taken from the same amplitude as those in the as mode see fig 4 one should note that the oscillation amplitude remains unchanged while the non dimensional frequency is increased from f 0 22 to f 0 5 it is clear that only one clockwise vortice is shed from the top of the cylinder and that half cycle lift forces are produced within one il oscillation cycle from position 1 to 8 the magnitude of the lift force however is less affected by the switch of the wake pattern from as to s as mode fig 5 presents the ss mode which is normally observed in pure il vibrations as the vortices become symmetric in the wake the magnitude of the lift force approaches zero see fig 5 nevertheless there is large variation in the drag forces and even negative drag forces are produced for some of the forced motion cases actually the ss mode becomes unstable and it turns to alternate vortex shedding after a certain distance in the wake the ss modes at the same non dimensional frequency f 0 556 with increasing amplitudes from 0 11 to 0 15 are presented in fig 6 it is seen that the symmetric wake structures are replaced by alternate vortex shedding after a certain distance in the wake whereas the length of the symmetry structures increases with increasing response amplitudes a new wake pattern s 2po is discovered in the high non dimensional frequency region with high response amplitudes as shown in fig 7 differing from the 2po mode which was found in the cf vibrations by morse and williamson 2009 the two pairs of vortices in the present s 2po mode are symmetrically shed into the wake and the weak vortex in the upper pair is placed on top of the strong vortex in addition the strong vortex in the pair becomes even stronger as it moves downstream while the weak vortex finally disappears in the far wake the top and bottom vortex streets are separated by the center line of the cylinder with a growing gap distance in the wake the lift force is small because of the symmetrical vortex shedding and the drag force amplitudes are more intense than those in the other il wake modes the s p s and s 2p modes shown in figs 8 and 9 respectively follow similar wake structures to the p s and 2p modes that are observed in the cf vibrations the vorticity strength of one vortex in the pair of the s p s mode is much less than that of the other one and the net energy of the vortex within one shedding cycle is close to zero the two vortices in the pair of the s 2p mode are of almost equal energy the magnitudes of the drag and lift forces produced by the s p s and s 2p modes are similar to each other and high order lift forces are clearly observed see figs 8 and 9 it is well known that the p s and 2p modes are usually observed in cf vibrations but similar wake structures are found in pure il vibrations here however it is not understood how il and cf vibrations produce similar wake structures even though the cylinder vibrates in completely different directions the answer could be related to the relative velocity between the flow and the vibrating cylinder the velocity of the vibrating cylinder can be deduced from eqn 4 7 u s i l t x t 2 π f o s c i l a i l cos 2 π f o s c i l t for a given il vibration at a fixed reynolds number we can easily find the relative velocity between the flow and the cylinder at every time step the maximum and minimum values of the relative velocity can then be defined as 8 u max u f u s i l t u min u f u s i l t where u f is the flow velocity and u s i l t is the amplitude of the vibrating velocity in the same way there also exist maximum and minimum values of the relative velocity in cf vibrations even though the cylinder vibrates in different directions with different oscillating frequencies and response amplitudes the minimum and maximum values of the relative velocity could match each other and this could be the reason for the similar wake structures produced in the il and cf vibrations it is also possible that similar wake structures can be produced for different cases of il vibrations if the maximum and minimum values of relative velocity are close to each other to confirm the above statements a set of analyses has been conducted the idea has been to obtain the same amplitudes of relative velocity by various combinations of il and cf amplitudes and time varying flow velocities and to compare the wake structure found from these cases fig 10 a illustrates how pure il forced motions can be represented by a time varying flow velocities the original case with constant current u f and maximum il motion velocity u s is equivalent to a fixed cylinder exposed to a time varying flow with mean value u f and amplitude u s see fig 11 the same situation can also be reconstructed by constant flow velocity u f u s combined with a cross flow forced motion for which the velocity is given by 9 u s c f t y t 2 π f o s c c f a c f cos 2 π f o s c c f t where f o s c c f is the oscillating frequency in the cf direction it follows that f o s c c f f o s c i l 2 because the il frequency is normally twice that of cf actually the magnitudes of the flow velocity and the cf vibrating velocity on the right side can be adjusted to match the maximum and minimum values of relative velocity on the left side the flow velocity is first fixed to the minimum relative velocity and then the magnitude of the vibrating velocity of the cylinder can be deduced 10 u f u f u s i l t 11 u s c f t 2 u max 2 u f 2 the wake modes as s 2p ss and s 2po observed for pure il vibrations were tested under the extreme boundary conditions i e the circular cylinder was fixed but the wanted history of the relative velocity was modeled as a prescribed velocity at the inlet boundary the main parameters for the original and transformed velocities are listed in table 2 and the wake structures observed from the new velocity conditions are presented in fig 13 it appears that even when the cylinder is set to be stationary similar wake structures can be reproduced with the new boundary conditions when the maximum and minimum values of the relative velocity are kept unchanged the velocity conditions of the s p s mode from the il vibration were transformed into equivalent cf vibration profiles as listed in table 2 eight instantaneous wake contours within one cf vibrating cycle are presented in fig 12 difference on the near wake structures exists between the s p s and p s modes because the cylinder is vibrating in different directions however the p s mode which has a wake pattern similar to that of the s p s mode is clearly observed a single vortex is shed on the top of the cylinder as it moves from positions 1 to 4 and one pair of vortices is shed at the bottom of the cylinder from positions 5 to 8 the transverse distance between the single vortex and the pair of vortices in the p s mode is wider than it is in the s p s mode the fluid forces obtained in the p s mode are significantly different from those observed in the s p s mode see fig 12 b the mean drag force and lift force are increased for cf vibration compared with forces found for il vibration the 2p wake structures following the similar patterns as the s p s mode in the il vibrations were also observed in the transformed cf vibrations but are not shown here 3 2 hydrodynamic forces the excitation force coefficient c e i l is related to the fluid force in phase with the velocity cf eqs a3 and a5in the appendix the contour plot of the excitation coefficient from the forced il vibrations discussed here is presented in fig 13 the thick line shows the zero contour of excitation coefficient one region with positive value of c e i l is observed for non dimensional frequencies f i l from 0 38 to 0 43 however there is a tendency for a second positive excitation region to occur between non dimensional frequencies f i l 0 5 and 0 6 according to aronsen 2007 that this region will be fully developed for high reynolds number the peak amplitude ratio of the zero contour excitation coefficient is a i l 0 056 while aronsen 2007 found a i l 0 13 as the maximum value for the zero contour line the discrepancy is most likely to be caused by different reynolds number for the experiments and the computations the present simulations applied re 500 while reynolds number was fixed to 24000 in aronsen s experiments fig 13 b presents the contour plot of added mass which is defined as the fluid forces in phase with acceleration cf eqs a4 and a6 the contour curves are close to vertical lines for a i l 0 08 and f i l 0 4 which indicates that the added mass is less affected by the amplitude ratio than non dimensional frequency in this region when the contour of excitation coefficients is mapped onto the il wake structure map it is found that the change of sign of c e i l from positive to negative does not follow any change in the wake modes fig 14 shows pictures of the wake structure for f i l 0 408 with an oscillating amplitude varying from a i l 0 04 to 0 07 the direction of energy transfer or the sign of c e i l switches at a i l 0 053 whereas the wake structures at a i l 0 05 and a i l 0 06 are both observed as the as mode however the phase between motion and vortex shedding changes between a i l 0 05 and a i l 0 06 i e an anti clockwise vortex is shed from the bottom of the cylinder in fig 14 a and b but becomes a clockwise vortex shedding from the top of the cylinder in fig 14 c d the changing time for vortex shedding can also be inferred from the time history of the drag forces as shown in the right column of fig 14 for the amplitude ratio at a i l 0 04 and a i l 0 05 a negative drag force is observed at points a1 and b1 corresponding to the negative vibrating velocity at points a0 and b0 it becomes a positive drag force at points a1 and b1 for a i l 0 06 and a i l 0 07 but the corresponding vibrating velocity of the cylinder is still negative the changing time of the vortex shedding phenomenon was also observed and discussed in lu and dalton 1996 and leontini et al 2006 fig 15 presents the contours for the drag coefficient and the r m s value of the fluctuating drag force cf eq a7 in appendix it is found that the drag coefficient corresponding to the s 2p mode region is larger than those generated from other il wake modes whereas the drag coefficients obtained from the ss and s 2po modes are less affected by the non dimensional frequency and amplitude ratio the r m s value of the fluctuating drag force increases with increasing amplitude ratio and non dimensional frequency the simultatious values of the lift and drag forces corresponding to three response amplitudes at a non dimensional frequency f 0 408 are presented in fig 16 the results for drag force and il displacement are also plotted in the second row a typical figure eight profile is clearly shown between the lift and drag forces at an amplitude ratio a i l 0 03 which is located in the positive excitation region the figure eight is stretched with sharp corners at a i l 0 12 due to the high order harmonic lift forces produced by the s p s mode an irregular profile is observed at a i l 0 25 because the lift force is close to zero as a result of the symmetric s 2po wake mode however the profiles of the drag force and il displacement have similar shapes as shown in the second row fig 17 presents the profiles for lift and drag forces at the non dimensioanl frequency f 0 312 which is outside the positive excitation region the profile at amplitude ratio a i l 0 03 is irregular and shows some drift of the solution periodic profiles but with intricate traces are observed at amplitude ratios a i l 0 12 and a i l 0 25 4 conclusions forced il vibrations of a circular cylinder in a uniform flow are numerically studied at a reynolds number of 500 an il wake map consisting of six wake regions is produced and a new wake mode s 2po is found the typical il wake modes ss and as are also captured it is exciting to find that similar wake structures between il vibrations s p s and s 2p modes and cf vibrations p s and 2p modes exist because the maximum and minimum values of the relative velocity between the flow and the vibrating cylinder overlap the fluid forces on the cylinder corresponding to each wake mode are reported and the contour plots of the excitation coefficient added mass and drag coefficient are presented in the plane of non dimensional frequency and amplitude ratio compared with the results for the excitation coefficient at high reynolds numbers a more narrow positive excitation region is observed at the low reynolds number and the peak amplitude ratio of the zero contour of the excitation coefficient is 0 056 in contrast to 0 13 for the higher reynolds number at 24000 the s 2p mode can produce larger drag forces than the other modes while the r m s value of the fluctuating drag forces is increased with increasing amplitude ratio and non dimensional frequency the curves for simultaneous values of lift and drag forces present figure eight patterns and skewed elliptical patterns are observed between drag forces and in line displacements within the positive excitation region acknowledgement the present simulations were supported by the research council of norway through a grant of computing time appendix data processing the definitions of the main parameters calculated in the present simulation are listed as follows the force components fil t and fcf t were found by direct integration of the pressure on the cylinder surface during the fluid simulation hence we could calculate the hydrodynamic coefficients as follows the drag coefficient related to the mean value of the in line force is given by a1 c d 1 n t t t n t f i l t 1 2 ρ l d u 0 2 d t the lift coefficient related to the mean value of the cf force is given by a2 c l 1 n t t t n t f c f t 1 2 ρ l d u 0 2 d t the amplitude of the il force component in phase with the il velocity is a3 f e 0 i l 2 n t x 0 ω t t n t f i l t x t d t the amplitude of the cf force component in phase with the cf acceleration is a4 f a 0 i l 2 n t x 0 ω 2 t t n t f i l t x t d t the excitation force coefficient in the il direction is a5 c e i l f e 0 i l 1 2 ρ d l u 0 2 the added mass coefficient in the il direction is a6 c a i l f a 0 i l 1 4 ρ π d 2 l x 0 2 ω 2 it may also be convenient to calculate a coefficient that can describe the variability of the total il and cf forces often referred to as an r m s coefficient this coefficient is defined by a7 c r m s i l 2 n t t t n t f i l t f i l 2 d t 1 2 ρ d l u 0 2 where f i l is the mean value of f i l t the r m s coefficient c r m s i l denotes the magnitude of the oscillating force in the il direction 
