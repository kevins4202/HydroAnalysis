index,text
22960,in this paper numerous aero hydro servo elastic coupled simulations are carried out in time domain to observe the performance of the real time thrust acting on the rotor of the oc3 hywind offshore floating wind turbine and the studying focuses on investigating the correlation between inputs surge motion pitch motion wind conditions etc and the targeted output rotor thrust in the time domain besides artificial intelligence ai techniques are used to estimate a prediction model of real time thrust based on the data from simulations to predict the thrust data for four comparative coupled environmental conditions are considered by which the effect of turbulence and wave spectrum on the thrust force is also investigated moreover a series of simulations of frequency increasing regular wave conditions and speed increasing wind conditions are carried out to observe their effect on the real time rotor thrust additionally the impact of the pitch and surge raos of the floating foundation and the wind velocity are quantitatively studied it reveals that the high frequency response of thrust is dominated by wave change whereas low frequency response is dominated by wind change besides one simulation model of the thrust acting on the rotor is estimated regarding high frequency and low frequency response separately to account the dominating influence keywords fully coupled simulation oc3 hywind real time thrust prediction artificial neural network impact analyses on the real time thrust 1 introduction during recent few years the development of grid connected floating wind turbines has flourished it is claimed that the more into the sea there is more wind energy since the increase of wind velocity kaldellis and kapsali 2013 it is exciting that we have seen a few social achievements especially the deployment of the hywind floating wind farm in scotland in 2017 which is the first floating wind farm in the world power 2017 indeed this spar type floating wind turbine has experienced sufficient research as shown in fig 1 si et al 2013 deals with the modelling and parameter tuning oc3 hywind floating wind turbine with a tuned mass damper tmd installed in the nacelle the seakeeping performance of the oc3 hywind platform is investigated in ahn and shin 2019 by both numerical solution and model test method moreover a series of model test researches have been performed at the same time shin 2011 shin et al 2013 jonkman 2010a different from fixed bottom wind turbines the floating platform naturally responds to wave loadings which are froude scaled while the turbine forcessss react to aerodynamic loads which are reynolds scaled commonly froude scaling is used in tank tests however using froude scaling also for the wind turbine rotor will lead to wrong aerodynamic loads compared to the full scale turbine it is essential to model the aerodynamic loads for fowts correctly one possible method of shaping a floating wind turbine in the laboratory environment is to employ a working rotor in a wind field generated by a series of fans experimental studies with a wind field generated by a set of fans in a tank are usually used to examine the hydrodynamic or aerodynamic performance of a floating wind model for example martin et al tried to account for reynolds effects by appropriate distortion of the rotor geometry martin et al 2014 however it is incredibly challenging to construct and operate a working scale rotor due to the large size not to mention the very lightweight and sophisticated control requirements see references goupee et al 2014 jeon et al 2014 quallen et al 2013 coulling et al 2013 moreover examples are given by chujo et al for a spar owt in chujo et al 2011 by k muller et al for a semi submersible owt in müller et al 2014 and by goupee et al for the spar semi submersible and tlp types in koo et al 2014 the experiments study are usually focused on a scaled model in the region of 1 50 1 100 however both froude similitude and reynolds similitude cannot be satisfied simultaneously in the small scale model tests of ships and offshore structures and some common difficulties are concluded such as lack of wind generation in a hydrodynamic laboratory issues of simulation of spread moorings or issues of the similarity between the model and full scale prototype in n notably the simulation of wind loading for tank testing of floating wind turbines presents a variety of severe challenges particularly challenges concerning the wind generation therefore many people turn to numerical tools for example liu et al 2017 develope a cfd simulation tool for the fully coupled model of floating wind turbines godine kok et al chan et al 2015 develope a hydrodynamic computer module to evaluate the linear and nonlinear loads on floating wind turbines using a new fluid impulse formulation for coupling with the fast program for more details see reference bazilevs et al 2011 however physical experiments are still needed in spite of the difficulty in correctly modelling the aerodynamic loads with the proper hydrodynamic influence taken into account a few recent articles review the approaches of simulating wind loading on floating wind turbines in wave tanks for example fowler et al use a high speed fan located on the model in line with the rotor drivetrain is to generate the thrust component of the wind load fowler et al 2013 bayati et al proposed a six degree of freedom platform to simulate the motions of the platform of the floating wind turbine bayati et al 2014 additionally the six degree of freedom platform is used to carry out tests to measure the movements and the aero dynamic thrust related to the instantaneous position moreover the velocity of the platform is calibrated in real time using a modified version of the fast aero hydro servo elastic simulation code which proves it possible to use the thrust calculated from fast to generate the equivalent thrust in the model test more before chujo et al attach a lightweight line at the rotor hub and tension day et al 2017 however that approach can only be justified for rough preliminary estimation of the maximum mooring offset kraskowski et al 2012 use a fan rotating at a constant speed in stationary air generating a predefined thrust to represent the mean rotor thrust which and allows for easy adjustment of the mean wind load and simulation of mean mooring offsets therefore inspired by those researches the idea of software in the loop simulation sil approach is formed motivated by the problems mentioned above and research potentials the authors aim at proposing a new approach to utilise the idea of software in the loop in which we use an active control system inserted with ai model to handle the inputs from experiments and give out a proper thrust command to drive a fan in real time in fig 2 by thus to enable the accurate tank test of a floating wind turbine and overcomes the various limitations labs are facing to simulate or predict actuated forces correctly acting on the model ai models simulation model and prediction model can simulate and predict the rotor thrust in real time with an acceptable degree of accuracy are required for this purpose the fully coupled calculation code of floating wind turbines fast is used to run a number of simulations and the data are thoroughly analysed to obtain a reasonable control structure a series of simulations of frequency increasing regular wave conditions and speed increasing wind conditions are carried out to observe their effect on the real time rotor thrust additionally the effect of the pitch and surge raos of the floating foundation and the wind velocity are quantitatively studied it reveals that the high frequency response of thrust is dominated by wave change whereas low frequency response is dominated by wind change therefore one simulation model of the thrust acting on the rotor is estimated regarding high frequency and low frequency response separately to account the dominating influences to predict the thrust in more complexed environmental conditions data for four comparative coupled environmental conditions are considered they are respectively the irregular wave condition demonstrated by jonswap spectrum combined with turbulent wind or the corresponding steady wind the pierson moskowitz coupled with the same turbulent or steady wind conditions by which the effect of turbulence and wave spectrum on the thrust force is also investigated the derived control structures are trained by system identification or artificial neural network techniques to achieve a simulation model and a prediction model separately the paper is structured as follows in section 2 the classic model used to undertake the aero hydro servo elastic coupled simulations are described section 3 lists the environmental conditions used to conduct the aero hydro servo elastic coupled simulations in section 4 the methodology regarding the mathematical expression of the fully coupled six motions of the platform hydrodynamic calculation aerodynamic calculation mooring modelling control and electrical drive are described in details the analyses of the simulation result in various coupled wave and wind conditions calculated by fast as well as the process of how to obtain the two models are presented and discussed in section 5 section 6 summarises the conclusions from the study 2 model description the spar buoy concept hywind floating wind turbine is initially developed by statoil of norway then by nrel aspects of the original data are adjusted slightly to make the platform appropriate for supporting the nrel 5 mw baseline turbine to differ from statoil s original hywind concept it is referred to as oc3 hywind the oc3 hywind floating wind turbine concept is considered as the model in this study we use the turbine specifications of the national renewable energy laboratory nrel offshore 5 mw baseline wind turbine as given in reference jonkman 2010a jonkman et al 2009 moreover fig 1 presents a model built from the data reflecting the floating system properties documented in jonkman 2010a seen in fig 3 a spar type platform is used to carry the wind table 1 lists the specification details of the model as shown in fig 4 the tower base overlaps with the top of the platform and is located 10 m above the static water level swl although the top of the tower protrudes with the yaw bearing it is situated at 87 6m above swl the distribution characteristics of the tower are based on the base diameter of 6 5m which is matched with the top width of the platform moreover the base thickness of the tower is 0 027m top diameter 3 87m thickness 0 019m the tower is 10 m above the swl and cantilever to the top of the floating platform which is considered rigid a 3 leg catenary moors the model and the mooring system is spread with a delta connection however in the calculation the delta connection is eliminated and the mooring system is modified with a yaw spring to meet the proper general yaw stiffness 3 load cases table 2 lists all the load cases used in the simulation in order to observe the effect of the waves on thrust lc 1 consists of 35 separate simulations in regular wave conditions of different wave frequency likewise to investigate the effect of wind speed on thrust lc 2 is selected to further observe the performance of thrust in the sophisticated natural environment lc 3 is considered to investigated the influence the turbulence and wave spectrum has on real time thrust lc4 lc are included as comparative load cases for each simulation it runs 600s to get an observation of the steady effect however only the data of 300s 500 s is selected for statistic calculation and analyses in section 5 1 and 5 2 to get rid of the transient effect arising in the initial simulation stage to simulate the natural environment the sea states at the proposed site is characterised by the jonswap spectrum which is described as follow in a lecture of mit opencoursware design of ocean 2011 1 s ω α g 2 ω 5 exp 1 25 ω p ω 4 γ exp 0 5 ω ω p σ ω p 2 where α 5 061 ω p 2 π 4 h s 2 1 0 287 log γ σ 0 07 for ω ω p and σ 0 09 for ω ω p ω p 2 π t p h s is the significant wave frequency ω p is the peak frequency γ is the peak enhance coefficient moreover for the wind field with a turbulent inflow the iec kaimal spectral turbulent model is used to characterise the wind conditions when the atmospheric stability is aero the spectra for the three wind components k u v w u is horizontal wind speed are as follow jonkman et al 2014 2 s f 4 σ k 2 l k u h u b 1 6 f l k u h u b 5 3 where f is the cyclic frequency and l k is an integral scale parameter which is defined as l k 8 10 λ u k u 2 70 λ u k v 0 66 λ u k w according to iec 61400 3 code the turbulence scale parameter λ u 0 7 min 60 m h h u b however because h h u b 90 m then λ u 42 the relationships between the standard deviations are established to be σ v 0 8 σ u σ w 0 5 σ u σ u t i 100 u h u b t i is the turbulence intensity u h u b is the mean total wind speed at the reference height then the wind spectrum of lc 3 and lc 4 is as shown in fig 5 4 the methodology of the simulations to predict the sophisticated dynamics of the spar type floating wind turbine a coupled aero servo hydro elastic model which integrates wind inflow the turbine control system servo hydrodynamic and structural dynamic elastic models is adapted to run the simulations 4 1 fully coupled six motions when the fully dynamic coupling between the floating foundation and the wind turbine is taken into consideration the coupled motions of the floating foundation in the time domain is expressed as follow jonkman 2010b 3 m i j q u t q j f i q q u t where q is the input of the six dofs heave sway surge roll pitch and yaw u is the control inputs m i j is the component of the inertia mass matrix q j is the acceleration of dof q is the velocity input of the dofs f i is the force applied on dof i because of the balance of forces for the system the total force applied to the system should be as follow 4 f i f i 0 where f i f i h u b f i n a c e l l e f i t o w e r f i f l o a t e r f i b l a d e s f i f i a e r o f i h y d r o f i g r a v i t y f i e l a s t i c f i d r i v e t f i m o o r i n g 4 2 hydrodynamic methodology in this study both regular waves and irregular jonswap spectrum waves are generated to form the coupled load conditions airy wave theory is adopted to model the wave kinematics including both regular and irregular waves for regular waves the wave elevation ζ is represented as a sinusoid with a single amplitude wave height and frequency irregular is expressed as a summation or superposition of multiple wave components as described by an appropriate wave spectrum jonkman et al 2014 5 ζ t 1 2 π w ω 2 π s ζ 2 s i d e d ω e j ω t d ω where w ω is the fourier transform of a realisation of a white gaussian noise time series process with zero mean and unit variance this equation represents the wave elevation as an inverse fourier transform of the desired two sided power spectral density s ζ 2 s i d e d where j is an imaginary number and ω is an individual wave frequency potential flow theory and strip theory via morison s equation are used to model the hydrodynamic loads the forces acting on the floater floating foundation consist of diffraction radiation and hydrostatic forces as well as the restoring forces from the mooring lines and the added inertia of the fully coupled turbine therefore the total external load acting on the floating foundation f i f l o a t o r is described as follow 6 f i f l o a t o r a i j q j f i h y d r o f i m o o r i n g where a i j is the component of the added mass matrix f i h y d r o is the i th component of the applied hydrodynamic load on the floating foundation f i m o o r i n g is the i th component of the load on the floating foundation from the mooring lines however f i h y d r o consists of three parts radiation diffraction and hydrostatic hence f i h y d r o f i e x c i t a t i o n f i h y d r o s t a t i c f i r a d i a t i o n where f i e x c i t a t i o n is the total excitation load from incident waves which is the result of the undisturbed pressure field froude krylov and wave scattering diffraction loads f i h y d r o s t a t i c is the restoring forces of a freely moving body f i r a d i a t i o n is steady state hydrodynamic forces and moments thus we get 7 f i h y d r o s t a t i c ρ g v δ i 3 c i j h y d r o s t a t i c q 8 f i r a d i a t i o n 0 t k i j t τ q j τ d τ 9 f i h y d r o f i e x c i t a t i o n ρ g v δ i 3 c i j h y d r o s t a t i c q j 0 t k i j t τ q j τ d τ where ρ g v δ i 3 is the buoyancy force from archimedes principle thereof δ i 3 is the i 3 component of the kronecker delta function c i j h y d r o s t a t i c q j is the hydrostatic and torque variations resulting from the effects of the water plane area and the cob thereof c i j h y d r o s t a t i c is the component of the linear hydrostatic restoring matrix k i j is the wave radiation retardation kernel the impulse response function of the radiation problem t is the simulation time τ is the user variable time 4 3 aerodynamic methodology in this study both steady wind fields and turbulent wind fields are generated to couple with different wave conditions for the convenience of describing the wind field it is assumed that the inflow wind direction is horizontal as shown in fig 6 power law wind profile is used to determine the mean u component velocity at each height in the wind filed as discussed in section 3 fig 5 displays the spectrum of turbulent wind moreover fig 7 plots the history of wind speed as shown in fig 7 the slow slow varying component forms the turbulence however in the natural world not only the amplitude of the wind speed varies but also the speed direction is time dependent for analysis purposes coherent structures have been defined regarding coherent turbulent kinetic energy ctke and the turbulent kinetic energy tke is used to model the power spectrum as shown in fig 8 4 4 mooring modelling for mooring modelling the closed form solution irvine and irvine 1981 of the classic single line is reformulated into a piecewise multi segmented system as shown in fig 9 where r i is the node position vector x i z i is a local frame x y z is the global coordinate system this piecewise system is composed of a collection of nodes and elements the mean forces in the mooring system including elasticity weight in fluid and geometric nonlinearities are accounted the solution process begins with the evaluation of the two continuous analysis catenary equations of each element based on the horizontal and vertical orifice offsets obtained through the nodal displacement relationship the element is defined as a component that connects two adjacent nodes evaluating the force balance equation for each node as follow f x j i 1 n h i cos α i f x j e x t 0 f y j i 1 n h i sin α i f y j e x t 0 12 f z j i 1 n v i f z j e x t m j g ρ g b j 0 where h is the horizontal fairlead force v is the vertical fairlead force n 1 2 is the elements at the node j f e x t is the external force in the global coordinate system once the element fairlead h v and anchor h a v a values are known at the element level their contribution at each element s anchor and fairlead are obtained by equation 13 4 5 control and electrical drive modelling a conventional variable speed variable blade pitch to feather control modelling strategy is usually used for onshore nrel 5 mw turbines and an example of the steady state behaviour of onshore nrel 5 mw turbine under operational control is given in fig 10 where rotspeed is for rotor speed bldpitch1 is for the pitch angle for blade 1 gentq is for generator torque and tsr is for tip speed ratio however the conventional pitch to feather control usually results in a reduction of the steady state rotor thrust when increase wind speed above rated when applied on a floating wind turbine as discussed by nielsen et al in nielsen et al 2006 skaare et al 2007 therefore in this research two modifications are adapted as listed in table 3 and a time step is added for the bladed style dll controllers which is independent of the servodyn time step moreover a linear ramp and first order low pass filter are applied to the blade pitch command from the bladed style dll 5 results this section provides the analyses of data from simulations and proposes two models the simulation model of the thrust acting on the rotor is obtained by the data from lc1 and lc 2 the simulation model is estimated by system identification techniques regarding high frequency and low frequency response separately to account the dominating influence the prediction model is obtained by artificial neural network method to train a black box by the data from simulations of lc 3 lc 6 5 1 rotor thrust prediction under lc 1 in this section the wind speed of uniform wind field is 8 m s and 35 frequencies of 0 1 3 5 rad s of regular waves with a constant wave height of 2m are used to run the simulations the outputs of one standard simulation are shown in fig 11 as pointed out in goupee et al 2017 hall et al 2018 the same phenomenon is observed from the series simulation that for numerous environmental condition the significant response is the surge and pitch motions moreover thrust is fundamentally due to the relative wind speed experienced by the turbine blades for example if the platform is fixed then the relative wind speed experienced by the edges will be the same as the actual wind speed however for a floating wind turbine the platform is moving back and forward relative to the wind and in this case the turbine blades experience the relative wind speed since we are only looking at wind and wave direction in the x axis then the platform motions are predominately pitched and surge i e roll yaw sway is practically zero as shown in fig 11 when the platform pitches or surges this adds a component to the relative wind speed hence when predicting the thrust for a floating wind turbine the authors would like to use surge pitch which provide the corresponding component of wind and the actual wind speed therefore the surge and pitch motions of the platform are extracted from the outputs to observe their correlation with the aerodynamic thrust in this section to observe the correlation between surge pitch and thrust two 4th order buttherworth filters are designed to separate the thrust surge and pitch signals into two independent components high frequency component and low frequency component respectively the cut off frequency for both high pass filter and low pass filter is 0 01 hz to include all the data of the three signals surge pitch and thrust also the transfer function is expressed regarding b and a as 13 h z b z a z b 1 b 2 z 1 b 3 z 2 b 4 z 3 b 5 z 4 a 1 a 2 z 1 a 3 z 2 a 4 z 3 a 5 z 4 where b and a are the transfer function coefficients of the 4th order filters and b 0 9990 3 9959 5 9938 3 9959 0 9990 a 1 0000 3 9979 5 9938 3 9938 0 9979 for the high pass filter b 2 3759 9 5035 14 2550 9 5035 2 3759 10 14 a 1 0000 3 9979 5 9938 3 9938 0 9979 for the low pass filter once the filters designed the three signals are separated one example when ω 1 9 rad s u 8 m s is given in fig 9 see separation analyses for other cases in the supplementary dataset fig 12 illustrates that the filters are effective to separate the properties of the original signal into two independent parts the static calculation results of the separated components for all simulations included in load cases 1 are shown in fig 13 looking at results it is noticed that low frequency components of the three signals surge low pitch low thrust low tend to be independent on wave frequency however the high frequency components surge high pitch high thrust high tend to be dependent on the wave frequency therefore if surge rao pitch rao and thrust rao are defined as follow 14 s u r g e r a o s u r g e h s 15 p i t c h r a o p i t c h h s 16 t h r u s t r a o t h r u s t 120 where h s is the significant wave height 120 is the introduce scaling coefficient thus the raos are presented in fig 14 it is noticed in fig 14 there might be a linear correlation between thrust high surge high and pitch high when the wave frequency increase then the structure of the mathematical model to predict the high frequency component of the aerodynamic thrust is assumed to be as 17 r a o t h r u s t h i g h k 1 r a o p i t c h h i g h k 2 r a o s u r g e h i g h c ω where k 1 k 2 are model parameters and c ω is a constant modification relative to wind speed see section 5 1 2 which could be identified by using the data of inputs r a o s u r g e h i g h r a o t h r u s t h i g h and outputs t h r u s t r a o h i g h 5 2 rotor thrust under lc 2 as learned from above the high frequency component of the three observed signals are independent of wave frequencies in this section the frequency of regular waves airy is 0 5 rad s and velocities of u 2 4 18 m s of steady wind are used to run the simulations for observing the effect of wind speed on aerodynamic thrust one example of the simulation at ω 0 5 rad s u 12 m s after applying the data through the high pass and low pass filters is shown in fig 15 similarly the static calculation of the separated components for all simulations included in load cases 2 is carried out and the results are listed in fig 15 different from being independent of wave frequencies the low frequency components of the three signals vary dramatically as the wind speed changes as the raos of the three signals are defined above the analyses carried out all based on raos in the section as shown in fig 16 learn from fig 16 a the high frequency components of surge and pitch tend to be steady when the wind speed increase while the high requency thrust component increases slightly which is primarily described by the c u in the structure of the mathematical model so when equation 17 modified with an offset the structure represented by equation 17 can predict the high frequency component when wind speed changes therefore the fabric used to predict the thrust high is modified as 18 r a o t h r u s t h i g h k 1 r a o p i t c h h i g h k 2 r a o s u r g e h i g h c ω c 1 where c 1 is a constant offset related to wind speed additionally it is observed in fig 16 b that there is an apparent linear correlation among surge low pitch low thrust low when the wind speed increase from 2 m s to 8 m s and they all reach the maximum when the wind speed is 12 m s therefore the structure of the mathematical model to predict the low frequency component of aerodynamic thrust is assumed to be as 19 r a o t h r u s t l o w k 3 r a o p i t c h l o w k 4 r a o s u r g e l o w k 5 w i n d s p e e d c 2 where k 3 k 4 k 5 are also model parameters but different from k 1 k 2 and c 2 is an allowable constant offset to make up the uncertainty might result from the linear structure and it will be identified by using the data of inputs r a o s u r g e h i g h r a o t h r u s t h i g h and outputs t h r u s t r a o h i g h as discussed below 5 3 training of the simulation model of rotor thrust as discussed above two structures equation 18 19 are obtained to predict the aerodynamic thrust r a o t h r u s t h i g h k 1 r a o p i t c h h i g h k 2 r a o s u r g e h i g h c ω c 1 r a o t h r u s t l o w k 3 r a o p i t c h l o w k 4 r a o s u r g e l o w k 5 w i n d s p e e d c 2 for the simplicity of scientific discussion r a o p i t c h h i g h r a o s u r g e h i g h are represented as inputs u 1 u 2 and r a o p i t c h l o w r a o s u r g e l o w as inputs u 1 u 2 to differ from r a o p i t c h h i g h r a o s u r g e h i g h similarly the output t h r u s t r a o h i g h will be discussed as y l o w and y h i g h as the model structures and some input and output signals are obtained the values of adjustable parameters in the given model structure could be estimated by minimising the error between the model output and the measured response the output y mod e l of the linear model is provided by y mod e l t g u t where g is the transfer function y mod e l t is the simulated response of the model for a given input u t such as u 1 u 2 u 1 u 2 the principal of determining g is minimising the difference between the model output y mod e l t and the measured output y m e a s t such as y l o w y h i g h the minimisation criterion is a weighted norm of the error v t where v t y m e a s t y mod e l t therefore for equation 18 the output y mod e l t is related to four inputs in total which are r a o p i t c h h i g h r a o s u r g e h i g h ω y h i g h discussed as u 1 u 2 u 3 u 4 then the transfer functions are obtained as follow from u 1 to y mod e l g 1 s 864 9 s 107 4 s 2 1 853 s 2 271 from u 2 to y mod e l g 2 s 266 6 s 90 01 s 2 2 105 s 1 861 from u 3 to y mod e l g 3 s 52 48 s 9 524 s 2 5 725 e 10 s 1 374 from u 4 to y mod e l g 4 s 0 2402 s 1 105 s 2 1 379 s 1 317 fit to estimation data reaches 99 12 the mean square error is 0 0206 when compared to the original signal for equation 19 the output y mod e l t is related to four inputs in total which are r a o p i t c h l o w r a o s u r g e l o w w i n d s p e e d y l o w discussed as u 1 u 2 u 3 u 4 then the transfer functions are obtained as follow from u 1 to y mod e l g 1 s 19 72 s 2 124 s 2 3 86 s 0 1255 from u 2 to y mod e l g 2 s 4 211 s 2 433 s 2 4 208 s 1 718 from u 3 to y mod e l g 3 s 3 712 s 0 2842 s 2 1 407 s 1 009 from u 4 to y mod e l g 4 s 0 1383 s 0 1432 s 2 0 04644 s 0 6857 5 4 rotor thrust under lc 3 6 and the prediction model of rotor thrust real sea states are more sophisticated than regular wave and steady wind conditions for lc3 lc4 jonswap spectrum and ieckai turbulent model are adapted to characterise the environmental conditions and corresponding simulations are undertaken to observe the effect of turbulence inflow on the aerodynamic thrust the identical steady wind cases load cases 4 x are simulated as well the output of some significant response of lc3 is shown in fig 17 it is learned from fig 18 a b that the average thrust force is just slightly varied by the turbulence although the inflow is turbulent the mean wind speed of lc 3 lc 4 is identical to that of the uniform wind field lc 5 lc 6 therefore the mean thrust force acting on the rotor is nearly the same nevertheless the thrust force becomes very unstable in the presence of turbulence fig 18 c compares the thrust forces of identical turbulent inflows but different wave spectrum parameters and it is learned that in the presence of turbulence the influence of wave changes on aerodynamic thrust are ignorable however as shown in fig 18 d which compares the thrust forces of identical steady wind inflow but different wave conditions the changes in parameters of wave spectrum have impacts on the behaviour of the thrust though the mean thrust force is almost the same therefore data of five inputs are included in training a model to predict the thrust force acting on the rotor for sophisticated environmental conditions like lc 3 lc 6 if the model is written in the term of a z y mod e l t b z u t e t the inputs u t includes the pitch u 1 t the velocity of pitch u 2 t the surge u 3 t the velocity of surge and the velocity of wind u 5 t of course y mod e l t is the real time thrust a z and b z are the estimable parameters of the model thus one thrust force prediction model is obtained e t is the noise source the estimable parameters are as follow a z 1 2 191 z 1 1 884 z 2 1 069 z 3 0 5424 z 4 0 3577 z 5 0 2575 z 6 0 08479 z 7 0 001325 z 8 0 04657 z 9 0 02854 z 10 b 1 z 59 61 z 1 330 3 z 5 634 7 z 6 364 z 10 b 2 z 99 66 z 1 158 8 z 3 119 6 z 4 275 7 z 5 584 1 z 7 351 5 z 8 29 44 z 9 b 3 z 51 46 z 1 31 95 z 4 30 17 z 5 10 65 z 10 b 4 z 43 35 z 1 24 39 z 2 27 39 z 3 4 442 z 7 19 42 z 8 50 99 z 9 51 06 z 10 b 5 z 0 1884 z 1 0 3314 z 2 0 214 z 3 0 3012 z 4 0 4324 z 5 0 4156 z 6 0 2558 z 7 0 115 z 8 0 2601 z 9 0 2063 z 10 generally the bigger the dataset is the more accurate model will be obtained and the model will slightly increase when the database reaches a certain level for the model proposed in this paper the size of the dataset is 192000 and the accuracy of fitting to estimate data is 98 88 98 73 99 84 99 69 and the mean square error is 2 396 2 336 0 02436 0 01664 respectively for lc3 lc6 the final prediction error for the above model is 1 194 6 conclusions in this paper numerous simulations based on the classic model of oc3 hywind floating wind turbine have been carried out and the data from simulations has been analysed in great details moreover artificial neural network techniques are used to obtain the structure of the thrust force simulation and prediction models of the real time thrust acting on the rotor of fowts it could be used as a software in the loop application in the experiments to provide real time thrust varying with the input signals like surge surge velocity pitch pitch velocity wind speed wave condition ed appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 01 046 
22960,in this paper numerous aero hydro servo elastic coupled simulations are carried out in time domain to observe the performance of the real time thrust acting on the rotor of the oc3 hywind offshore floating wind turbine and the studying focuses on investigating the correlation between inputs surge motion pitch motion wind conditions etc and the targeted output rotor thrust in the time domain besides artificial intelligence ai techniques are used to estimate a prediction model of real time thrust based on the data from simulations to predict the thrust data for four comparative coupled environmental conditions are considered by which the effect of turbulence and wave spectrum on the thrust force is also investigated moreover a series of simulations of frequency increasing regular wave conditions and speed increasing wind conditions are carried out to observe their effect on the real time rotor thrust additionally the impact of the pitch and surge raos of the floating foundation and the wind velocity are quantitatively studied it reveals that the high frequency response of thrust is dominated by wave change whereas low frequency response is dominated by wind change besides one simulation model of the thrust acting on the rotor is estimated regarding high frequency and low frequency response separately to account the dominating influence keywords fully coupled simulation oc3 hywind real time thrust prediction artificial neural network impact analyses on the real time thrust 1 introduction during recent few years the development of grid connected floating wind turbines has flourished it is claimed that the more into the sea there is more wind energy since the increase of wind velocity kaldellis and kapsali 2013 it is exciting that we have seen a few social achievements especially the deployment of the hywind floating wind farm in scotland in 2017 which is the first floating wind farm in the world power 2017 indeed this spar type floating wind turbine has experienced sufficient research as shown in fig 1 si et al 2013 deals with the modelling and parameter tuning oc3 hywind floating wind turbine with a tuned mass damper tmd installed in the nacelle the seakeeping performance of the oc3 hywind platform is investigated in ahn and shin 2019 by both numerical solution and model test method moreover a series of model test researches have been performed at the same time shin 2011 shin et al 2013 jonkman 2010a different from fixed bottom wind turbines the floating platform naturally responds to wave loadings which are froude scaled while the turbine forcessss react to aerodynamic loads which are reynolds scaled commonly froude scaling is used in tank tests however using froude scaling also for the wind turbine rotor will lead to wrong aerodynamic loads compared to the full scale turbine it is essential to model the aerodynamic loads for fowts correctly one possible method of shaping a floating wind turbine in the laboratory environment is to employ a working rotor in a wind field generated by a series of fans experimental studies with a wind field generated by a set of fans in a tank are usually used to examine the hydrodynamic or aerodynamic performance of a floating wind model for example martin et al tried to account for reynolds effects by appropriate distortion of the rotor geometry martin et al 2014 however it is incredibly challenging to construct and operate a working scale rotor due to the large size not to mention the very lightweight and sophisticated control requirements see references goupee et al 2014 jeon et al 2014 quallen et al 2013 coulling et al 2013 moreover examples are given by chujo et al for a spar owt in chujo et al 2011 by k muller et al for a semi submersible owt in müller et al 2014 and by goupee et al for the spar semi submersible and tlp types in koo et al 2014 the experiments study are usually focused on a scaled model in the region of 1 50 1 100 however both froude similitude and reynolds similitude cannot be satisfied simultaneously in the small scale model tests of ships and offshore structures and some common difficulties are concluded such as lack of wind generation in a hydrodynamic laboratory issues of simulation of spread moorings or issues of the similarity between the model and full scale prototype in n notably the simulation of wind loading for tank testing of floating wind turbines presents a variety of severe challenges particularly challenges concerning the wind generation therefore many people turn to numerical tools for example liu et al 2017 develope a cfd simulation tool for the fully coupled model of floating wind turbines godine kok et al chan et al 2015 develope a hydrodynamic computer module to evaluate the linear and nonlinear loads on floating wind turbines using a new fluid impulse formulation for coupling with the fast program for more details see reference bazilevs et al 2011 however physical experiments are still needed in spite of the difficulty in correctly modelling the aerodynamic loads with the proper hydrodynamic influence taken into account a few recent articles review the approaches of simulating wind loading on floating wind turbines in wave tanks for example fowler et al use a high speed fan located on the model in line with the rotor drivetrain is to generate the thrust component of the wind load fowler et al 2013 bayati et al proposed a six degree of freedom platform to simulate the motions of the platform of the floating wind turbine bayati et al 2014 additionally the six degree of freedom platform is used to carry out tests to measure the movements and the aero dynamic thrust related to the instantaneous position moreover the velocity of the platform is calibrated in real time using a modified version of the fast aero hydro servo elastic simulation code which proves it possible to use the thrust calculated from fast to generate the equivalent thrust in the model test more before chujo et al attach a lightweight line at the rotor hub and tension day et al 2017 however that approach can only be justified for rough preliminary estimation of the maximum mooring offset kraskowski et al 2012 use a fan rotating at a constant speed in stationary air generating a predefined thrust to represent the mean rotor thrust which and allows for easy adjustment of the mean wind load and simulation of mean mooring offsets therefore inspired by those researches the idea of software in the loop simulation sil approach is formed motivated by the problems mentioned above and research potentials the authors aim at proposing a new approach to utilise the idea of software in the loop in which we use an active control system inserted with ai model to handle the inputs from experiments and give out a proper thrust command to drive a fan in real time in fig 2 by thus to enable the accurate tank test of a floating wind turbine and overcomes the various limitations labs are facing to simulate or predict actuated forces correctly acting on the model ai models simulation model and prediction model can simulate and predict the rotor thrust in real time with an acceptable degree of accuracy are required for this purpose the fully coupled calculation code of floating wind turbines fast is used to run a number of simulations and the data are thoroughly analysed to obtain a reasonable control structure a series of simulations of frequency increasing regular wave conditions and speed increasing wind conditions are carried out to observe their effect on the real time rotor thrust additionally the effect of the pitch and surge raos of the floating foundation and the wind velocity are quantitatively studied it reveals that the high frequency response of thrust is dominated by wave change whereas low frequency response is dominated by wind change therefore one simulation model of the thrust acting on the rotor is estimated regarding high frequency and low frequency response separately to account the dominating influences to predict the thrust in more complexed environmental conditions data for four comparative coupled environmental conditions are considered they are respectively the irregular wave condition demonstrated by jonswap spectrum combined with turbulent wind or the corresponding steady wind the pierson moskowitz coupled with the same turbulent or steady wind conditions by which the effect of turbulence and wave spectrum on the thrust force is also investigated the derived control structures are trained by system identification or artificial neural network techniques to achieve a simulation model and a prediction model separately the paper is structured as follows in section 2 the classic model used to undertake the aero hydro servo elastic coupled simulations are described section 3 lists the environmental conditions used to conduct the aero hydro servo elastic coupled simulations in section 4 the methodology regarding the mathematical expression of the fully coupled six motions of the platform hydrodynamic calculation aerodynamic calculation mooring modelling control and electrical drive are described in details the analyses of the simulation result in various coupled wave and wind conditions calculated by fast as well as the process of how to obtain the two models are presented and discussed in section 5 section 6 summarises the conclusions from the study 2 model description the spar buoy concept hywind floating wind turbine is initially developed by statoil of norway then by nrel aspects of the original data are adjusted slightly to make the platform appropriate for supporting the nrel 5 mw baseline turbine to differ from statoil s original hywind concept it is referred to as oc3 hywind the oc3 hywind floating wind turbine concept is considered as the model in this study we use the turbine specifications of the national renewable energy laboratory nrel offshore 5 mw baseline wind turbine as given in reference jonkman 2010a jonkman et al 2009 moreover fig 1 presents a model built from the data reflecting the floating system properties documented in jonkman 2010a seen in fig 3 a spar type platform is used to carry the wind table 1 lists the specification details of the model as shown in fig 4 the tower base overlaps with the top of the platform and is located 10 m above the static water level swl although the top of the tower protrudes with the yaw bearing it is situated at 87 6m above swl the distribution characteristics of the tower are based on the base diameter of 6 5m which is matched with the top width of the platform moreover the base thickness of the tower is 0 027m top diameter 3 87m thickness 0 019m the tower is 10 m above the swl and cantilever to the top of the floating platform which is considered rigid a 3 leg catenary moors the model and the mooring system is spread with a delta connection however in the calculation the delta connection is eliminated and the mooring system is modified with a yaw spring to meet the proper general yaw stiffness 3 load cases table 2 lists all the load cases used in the simulation in order to observe the effect of the waves on thrust lc 1 consists of 35 separate simulations in regular wave conditions of different wave frequency likewise to investigate the effect of wind speed on thrust lc 2 is selected to further observe the performance of thrust in the sophisticated natural environment lc 3 is considered to investigated the influence the turbulence and wave spectrum has on real time thrust lc4 lc are included as comparative load cases for each simulation it runs 600s to get an observation of the steady effect however only the data of 300s 500 s is selected for statistic calculation and analyses in section 5 1 and 5 2 to get rid of the transient effect arising in the initial simulation stage to simulate the natural environment the sea states at the proposed site is characterised by the jonswap spectrum which is described as follow in a lecture of mit opencoursware design of ocean 2011 1 s ω α g 2 ω 5 exp 1 25 ω p ω 4 γ exp 0 5 ω ω p σ ω p 2 where α 5 061 ω p 2 π 4 h s 2 1 0 287 log γ σ 0 07 for ω ω p and σ 0 09 for ω ω p ω p 2 π t p h s is the significant wave frequency ω p is the peak frequency γ is the peak enhance coefficient moreover for the wind field with a turbulent inflow the iec kaimal spectral turbulent model is used to characterise the wind conditions when the atmospheric stability is aero the spectra for the three wind components k u v w u is horizontal wind speed are as follow jonkman et al 2014 2 s f 4 σ k 2 l k u h u b 1 6 f l k u h u b 5 3 where f is the cyclic frequency and l k is an integral scale parameter which is defined as l k 8 10 λ u k u 2 70 λ u k v 0 66 λ u k w according to iec 61400 3 code the turbulence scale parameter λ u 0 7 min 60 m h h u b however because h h u b 90 m then λ u 42 the relationships between the standard deviations are established to be σ v 0 8 σ u σ w 0 5 σ u σ u t i 100 u h u b t i is the turbulence intensity u h u b is the mean total wind speed at the reference height then the wind spectrum of lc 3 and lc 4 is as shown in fig 5 4 the methodology of the simulations to predict the sophisticated dynamics of the spar type floating wind turbine a coupled aero servo hydro elastic model which integrates wind inflow the turbine control system servo hydrodynamic and structural dynamic elastic models is adapted to run the simulations 4 1 fully coupled six motions when the fully dynamic coupling between the floating foundation and the wind turbine is taken into consideration the coupled motions of the floating foundation in the time domain is expressed as follow jonkman 2010b 3 m i j q u t q j f i q q u t where q is the input of the six dofs heave sway surge roll pitch and yaw u is the control inputs m i j is the component of the inertia mass matrix q j is the acceleration of dof q is the velocity input of the dofs f i is the force applied on dof i because of the balance of forces for the system the total force applied to the system should be as follow 4 f i f i 0 where f i f i h u b f i n a c e l l e f i t o w e r f i f l o a t e r f i b l a d e s f i f i a e r o f i h y d r o f i g r a v i t y f i e l a s t i c f i d r i v e t f i m o o r i n g 4 2 hydrodynamic methodology in this study both regular waves and irregular jonswap spectrum waves are generated to form the coupled load conditions airy wave theory is adopted to model the wave kinematics including both regular and irregular waves for regular waves the wave elevation ζ is represented as a sinusoid with a single amplitude wave height and frequency irregular is expressed as a summation or superposition of multiple wave components as described by an appropriate wave spectrum jonkman et al 2014 5 ζ t 1 2 π w ω 2 π s ζ 2 s i d e d ω e j ω t d ω where w ω is the fourier transform of a realisation of a white gaussian noise time series process with zero mean and unit variance this equation represents the wave elevation as an inverse fourier transform of the desired two sided power spectral density s ζ 2 s i d e d where j is an imaginary number and ω is an individual wave frequency potential flow theory and strip theory via morison s equation are used to model the hydrodynamic loads the forces acting on the floater floating foundation consist of diffraction radiation and hydrostatic forces as well as the restoring forces from the mooring lines and the added inertia of the fully coupled turbine therefore the total external load acting on the floating foundation f i f l o a t o r is described as follow 6 f i f l o a t o r a i j q j f i h y d r o f i m o o r i n g where a i j is the component of the added mass matrix f i h y d r o is the i th component of the applied hydrodynamic load on the floating foundation f i m o o r i n g is the i th component of the load on the floating foundation from the mooring lines however f i h y d r o consists of three parts radiation diffraction and hydrostatic hence f i h y d r o f i e x c i t a t i o n f i h y d r o s t a t i c f i r a d i a t i o n where f i e x c i t a t i o n is the total excitation load from incident waves which is the result of the undisturbed pressure field froude krylov and wave scattering diffraction loads f i h y d r o s t a t i c is the restoring forces of a freely moving body f i r a d i a t i o n is steady state hydrodynamic forces and moments thus we get 7 f i h y d r o s t a t i c ρ g v δ i 3 c i j h y d r o s t a t i c q 8 f i r a d i a t i o n 0 t k i j t τ q j τ d τ 9 f i h y d r o f i e x c i t a t i o n ρ g v δ i 3 c i j h y d r o s t a t i c q j 0 t k i j t τ q j τ d τ where ρ g v δ i 3 is the buoyancy force from archimedes principle thereof δ i 3 is the i 3 component of the kronecker delta function c i j h y d r o s t a t i c q j is the hydrostatic and torque variations resulting from the effects of the water plane area and the cob thereof c i j h y d r o s t a t i c is the component of the linear hydrostatic restoring matrix k i j is the wave radiation retardation kernel the impulse response function of the radiation problem t is the simulation time τ is the user variable time 4 3 aerodynamic methodology in this study both steady wind fields and turbulent wind fields are generated to couple with different wave conditions for the convenience of describing the wind field it is assumed that the inflow wind direction is horizontal as shown in fig 6 power law wind profile is used to determine the mean u component velocity at each height in the wind filed as discussed in section 3 fig 5 displays the spectrum of turbulent wind moreover fig 7 plots the history of wind speed as shown in fig 7 the slow slow varying component forms the turbulence however in the natural world not only the amplitude of the wind speed varies but also the speed direction is time dependent for analysis purposes coherent structures have been defined regarding coherent turbulent kinetic energy ctke and the turbulent kinetic energy tke is used to model the power spectrum as shown in fig 8 4 4 mooring modelling for mooring modelling the closed form solution irvine and irvine 1981 of the classic single line is reformulated into a piecewise multi segmented system as shown in fig 9 where r i is the node position vector x i z i is a local frame x y z is the global coordinate system this piecewise system is composed of a collection of nodes and elements the mean forces in the mooring system including elasticity weight in fluid and geometric nonlinearities are accounted the solution process begins with the evaluation of the two continuous analysis catenary equations of each element based on the horizontal and vertical orifice offsets obtained through the nodal displacement relationship the element is defined as a component that connects two adjacent nodes evaluating the force balance equation for each node as follow f x j i 1 n h i cos α i f x j e x t 0 f y j i 1 n h i sin α i f y j e x t 0 12 f z j i 1 n v i f z j e x t m j g ρ g b j 0 where h is the horizontal fairlead force v is the vertical fairlead force n 1 2 is the elements at the node j f e x t is the external force in the global coordinate system once the element fairlead h v and anchor h a v a values are known at the element level their contribution at each element s anchor and fairlead are obtained by equation 13 4 5 control and electrical drive modelling a conventional variable speed variable blade pitch to feather control modelling strategy is usually used for onshore nrel 5 mw turbines and an example of the steady state behaviour of onshore nrel 5 mw turbine under operational control is given in fig 10 where rotspeed is for rotor speed bldpitch1 is for the pitch angle for blade 1 gentq is for generator torque and tsr is for tip speed ratio however the conventional pitch to feather control usually results in a reduction of the steady state rotor thrust when increase wind speed above rated when applied on a floating wind turbine as discussed by nielsen et al in nielsen et al 2006 skaare et al 2007 therefore in this research two modifications are adapted as listed in table 3 and a time step is added for the bladed style dll controllers which is independent of the servodyn time step moreover a linear ramp and first order low pass filter are applied to the blade pitch command from the bladed style dll 5 results this section provides the analyses of data from simulations and proposes two models the simulation model of the thrust acting on the rotor is obtained by the data from lc1 and lc 2 the simulation model is estimated by system identification techniques regarding high frequency and low frequency response separately to account the dominating influence the prediction model is obtained by artificial neural network method to train a black box by the data from simulations of lc 3 lc 6 5 1 rotor thrust prediction under lc 1 in this section the wind speed of uniform wind field is 8 m s and 35 frequencies of 0 1 3 5 rad s of regular waves with a constant wave height of 2m are used to run the simulations the outputs of one standard simulation are shown in fig 11 as pointed out in goupee et al 2017 hall et al 2018 the same phenomenon is observed from the series simulation that for numerous environmental condition the significant response is the surge and pitch motions moreover thrust is fundamentally due to the relative wind speed experienced by the turbine blades for example if the platform is fixed then the relative wind speed experienced by the edges will be the same as the actual wind speed however for a floating wind turbine the platform is moving back and forward relative to the wind and in this case the turbine blades experience the relative wind speed since we are only looking at wind and wave direction in the x axis then the platform motions are predominately pitched and surge i e roll yaw sway is practically zero as shown in fig 11 when the platform pitches or surges this adds a component to the relative wind speed hence when predicting the thrust for a floating wind turbine the authors would like to use surge pitch which provide the corresponding component of wind and the actual wind speed therefore the surge and pitch motions of the platform are extracted from the outputs to observe their correlation with the aerodynamic thrust in this section to observe the correlation between surge pitch and thrust two 4th order buttherworth filters are designed to separate the thrust surge and pitch signals into two independent components high frequency component and low frequency component respectively the cut off frequency for both high pass filter and low pass filter is 0 01 hz to include all the data of the three signals surge pitch and thrust also the transfer function is expressed regarding b and a as 13 h z b z a z b 1 b 2 z 1 b 3 z 2 b 4 z 3 b 5 z 4 a 1 a 2 z 1 a 3 z 2 a 4 z 3 a 5 z 4 where b and a are the transfer function coefficients of the 4th order filters and b 0 9990 3 9959 5 9938 3 9959 0 9990 a 1 0000 3 9979 5 9938 3 9938 0 9979 for the high pass filter b 2 3759 9 5035 14 2550 9 5035 2 3759 10 14 a 1 0000 3 9979 5 9938 3 9938 0 9979 for the low pass filter once the filters designed the three signals are separated one example when ω 1 9 rad s u 8 m s is given in fig 9 see separation analyses for other cases in the supplementary dataset fig 12 illustrates that the filters are effective to separate the properties of the original signal into two independent parts the static calculation results of the separated components for all simulations included in load cases 1 are shown in fig 13 looking at results it is noticed that low frequency components of the three signals surge low pitch low thrust low tend to be independent on wave frequency however the high frequency components surge high pitch high thrust high tend to be dependent on the wave frequency therefore if surge rao pitch rao and thrust rao are defined as follow 14 s u r g e r a o s u r g e h s 15 p i t c h r a o p i t c h h s 16 t h r u s t r a o t h r u s t 120 where h s is the significant wave height 120 is the introduce scaling coefficient thus the raos are presented in fig 14 it is noticed in fig 14 there might be a linear correlation between thrust high surge high and pitch high when the wave frequency increase then the structure of the mathematical model to predict the high frequency component of the aerodynamic thrust is assumed to be as 17 r a o t h r u s t h i g h k 1 r a o p i t c h h i g h k 2 r a o s u r g e h i g h c ω where k 1 k 2 are model parameters and c ω is a constant modification relative to wind speed see section 5 1 2 which could be identified by using the data of inputs r a o s u r g e h i g h r a o t h r u s t h i g h and outputs t h r u s t r a o h i g h 5 2 rotor thrust under lc 2 as learned from above the high frequency component of the three observed signals are independent of wave frequencies in this section the frequency of regular waves airy is 0 5 rad s and velocities of u 2 4 18 m s of steady wind are used to run the simulations for observing the effect of wind speed on aerodynamic thrust one example of the simulation at ω 0 5 rad s u 12 m s after applying the data through the high pass and low pass filters is shown in fig 15 similarly the static calculation of the separated components for all simulations included in load cases 2 is carried out and the results are listed in fig 15 different from being independent of wave frequencies the low frequency components of the three signals vary dramatically as the wind speed changes as the raos of the three signals are defined above the analyses carried out all based on raos in the section as shown in fig 16 learn from fig 16 a the high frequency components of surge and pitch tend to be steady when the wind speed increase while the high requency thrust component increases slightly which is primarily described by the c u in the structure of the mathematical model so when equation 17 modified with an offset the structure represented by equation 17 can predict the high frequency component when wind speed changes therefore the fabric used to predict the thrust high is modified as 18 r a o t h r u s t h i g h k 1 r a o p i t c h h i g h k 2 r a o s u r g e h i g h c ω c 1 where c 1 is a constant offset related to wind speed additionally it is observed in fig 16 b that there is an apparent linear correlation among surge low pitch low thrust low when the wind speed increase from 2 m s to 8 m s and they all reach the maximum when the wind speed is 12 m s therefore the structure of the mathematical model to predict the low frequency component of aerodynamic thrust is assumed to be as 19 r a o t h r u s t l o w k 3 r a o p i t c h l o w k 4 r a o s u r g e l o w k 5 w i n d s p e e d c 2 where k 3 k 4 k 5 are also model parameters but different from k 1 k 2 and c 2 is an allowable constant offset to make up the uncertainty might result from the linear structure and it will be identified by using the data of inputs r a o s u r g e h i g h r a o t h r u s t h i g h and outputs t h r u s t r a o h i g h as discussed below 5 3 training of the simulation model of rotor thrust as discussed above two structures equation 18 19 are obtained to predict the aerodynamic thrust r a o t h r u s t h i g h k 1 r a o p i t c h h i g h k 2 r a o s u r g e h i g h c ω c 1 r a o t h r u s t l o w k 3 r a o p i t c h l o w k 4 r a o s u r g e l o w k 5 w i n d s p e e d c 2 for the simplicity of scientific discussion r a o p i t c h h i g h r a o s u r g e h i g h are represented as inputs u 1 u 2 and r a o p i t c h l o w r a o s u r g e l o w as inputs u 1 u 2 to differ from r a o p i t c h h i g h r a o s u r g e h i g h similarly the output t h r u s t r a o h i g h will be discussed as y l o w and y h i g h as the model structures and some input and output signals are obtained the values of adjustable parameters in the given model structure could be estimated by minimising the error between the model output and the measured response the output y mod e l of the linear model is provided by y mod e l t g u t where g is the transfer function y mod e l t is the simulated response of the model for a given input u t such as u 1 u 2 u 1 u 2 the principal of determining g is minimising the difference between the model output y mod e l t and the measured output y m e a s t such as y l o w y h i g h the minimisation criterion is a weighted norm of the error v t where v t y m e a s t y mod e l t therefore for equation 18 the output y mod e l t is related to four inputs in total which are r a o p i t c h h i g h r a o s u r g e h i g h ω y h i g h discussed as u 1 u 2 u 3 u 4 then the transfer functions are obtained as follow from u 1 to y mod e l g 1 s 864 9 s 107 4 s 2 1 853 s 2 271 from u 2 to y mod e l g 2 s 266 6 s 90 01 s 2 2 105 s 1 861 from u 3 to y mod e l g 3 s 52 48 s 9 524 s 2 5 725 e 10 s 1 374 from u 4 to y mod e l g 4 s 0 2402 s 1 105 s 2 1 379 s 1 317 fit to estimation data reaches 99 12 the mean square error is 0 0206 when compared to the original signal for equation 19 the output y mod e l t is related to four inputs in total which are r a o p i t c h l o w r a o s u r g e l o w w i n d s p e e d y l o w discussed as u 1 u 2 u 3 u 4 then the transfer functions are obtained as follow from u 1 to y mod e l g 1 s 19 72 s 2 124 s 2 3 86 s 0 1255 from u 2 to y mod e l g 2 s 4 211 s 2 433 s 2 4 208 s 1 718 from u 3 to y mod e l g 3 s 3 712 s 0 2842 s 2 1 407 s 1 009 from u 4 to y mod e l g 4 s 0 1383 s 0 1432 s 2 0 04644 s 0 6857 5 4 rotor thrust under lc 3 6 and the prediction model of rotor thrust real sea states are more sophisticated than regular wave and steady wind conditions for lc3 lc4 jonswap spectrum and ieckai turbulent model are adapted to characterise the environmental conditions and corresponding simulations are undertaken to observe the effect of turbulence inflow on the aerodynamic thrust the identical steady wind cases load cases 4 x are simulated as well the output of some significant response of lc3 is shown in fig 17 it is learned from fig 18 a b that the average thrust force is just slightly varied by the turbulence although the inflow is turbulent the mean wind speed of lc 3 lc 4 is identical to that of the uniform wind field lc 5 lc 6 therefore the mean thrust force acting on the rotor is nearly the same nevertheless the thrust force becomes very unstable in the presence of turbulence fig 18 c compares the thrust forces of identical turbulent inflows but different wave spectrum parameters and it is learned that in the presence of turbulence the influence of wave changes on aerodynamic thrust are ignorable however as shown in fig 18 d which compares the thrust forces of identical steady wind inflow but different wave conditions the changes in parameters of wave spectrum have impacts on the behaviour of the thrust though the mean thrust force is almost the same therefore data of five inputs are included in training a model to predict the thrust force acting on the rotor for sophisticated environmental conditions like lc 3 lc 6 if the model is written in the term of a z y mod e l t b z u t e t the inputs u t includes the pitch u 1 t the velocity of pitch u 2 t the surge u 3 t the velocity of surge and the velocity of wind u 5 t of course y mod e l t is the real time thrust a z and b z are the estimable parameters of the model thus one thrust force prediction model is obtained e t is the noise source the estimable parameters are as follow a z 1 2 191 z 1 1 884 z 2 1 069 z 3 0 5424 z 4 0 3577 z 5 0 2575 z 6 0 08479 z 7 0 001325 z 8 0 04657 z 9 0 02854 z 10 b 1 z 59 61 z 1 330 3 z 5 634 7 z 6 364 z 10 b 2 z 99 66 z 1 158 8 z 3 119 6 z 4 275 7 z 5 584 1 z 7 351 5 z 8 29 44 z 9 b 3 z 51 46 z 1 31 95 z 4 30 17 z 5 10 65 z 10 b 4 z 43 35 z 1 24 39 z 2 27 39 z 3 4 442 z 7 19 42 z 8 50 99 z 9 51 06 z 10 b 5 z 0 1884 z 1 0 3314 z 2 0 214 z 3 0 3012 z 4 0 4324 z 5 0 4156 z 6 0 2558 z 7 0 115 z 8 0 2601 z 9 0 2063 z 10 generally the bigger the dataset is the more accurate model will be obtained and the model will slightly increase when the database reaches a certain level for the model proposed in this paper the size of the dataset is 192000 and the accuracy of fitting to estimate data is 98 88 98 73 99 84 99 69 and the mean square error is 2 396 2 336 0 02436 0 01664 respectively for lc3 lc6 the final prediction error for the above model is 1 194 6 conclusions in this paper numerous simulations based on the classic model of oc3 hywind floating wind turbine have been carried out and the data from simulations has been analysed in great details moreover artificial neural network techniques are used to obtain the structure of the thrust force simulation and prediction models of the real time thrust acting on the rotor of fowts it could be used as a software in the loop application in the experiments to provide real time thrust varying with the input signals like surge surge velocity pitch pitch velocity wind speed wave condition ed appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 01 046 
22961,this paper presents a numerical study of two degree of freedom vortex induced vibration of four elastically mounted circular cylinders in a square arrangement at a low reynolds number of re 150 and mass ratio of 2 0 the incident angle α is ranged from 0 to 45 and the reduced velocity v r is ranged from 3 to 14 the effects of incident angle and reduced velocity on the dynamic responses and wake flow patterns behind four cylinders are investigated the results show that the incident angle has a significant effect on the vibration amplitudes and force coefficients of four cylinders especially for the downstream cylinders where the maximum vibration amplitudes and force coefficients are occurred mostly on the downstream cylinder with increasing of the incident angle α the orbital trajectory for each cylinder becomes irregular and complicated especially at high reduced velocities v r 8 corresponding to multiple oscillation frequencies moreover the wake flow patterns behind four cylinders are modified significantly with variations of incident angles accompanied by different vortex shedding modes keywords vortex induced vibration of four cylinders incident angle reduced velocity oscillation response flow pattern 1 introduction investigations on vortex induced vibration viv of multiple cylindrical structures have received a great deal of attention due to their highly undesirable resonance and failure of the offshore and ocean engineering structures such as platform offshore wind turbine foundations risers and pipelines etc in the past several decades the viv of a single elastically mounted circular cylinder has been studied extensively which can be referred to the articles bearman 1984 2011 jauvtis and williamson 2003 gabbai and benaroya 2005 williamson and govardhan 2008 wu et al 2012 han et al 2016 nevertheless when a pair of multiple cylinders placed sufficiently close to each other in a uniform flow undergo viv the dynamic responses of multiple cylinders and vortex shedding patterns are reported to be much more complicated than those of a single cylinder previous studies were mostly concerned with the vortex induced vibrations of two cylinders in tandem side by side and staggered configurations bokaian and geoola 1984 zdravkovich 1985 mittal and kumar 2004 the complex interferences between two circular cylinders undergoing viv have been extensively investigated experimentally assi et al 2010 huera huarte and gharib 2011 huang and herfjord 2013 and numerically prasanth and mittal 2009 carmo et al 2011 chen et al 2015 the vibration amplitudes and flow behaviors of two cylinders are found to be strongly depended on the relative locations and configurations prasanth and mittal 2009 performed numerical simulations of viv of two cylinders in tandem and staggered arrangements in laminar flow using the finite element method compared with an isolated cylinder the dynamic behavior of the downstream cylinder was significantly changed in both arrangements the effects of gap flow between two tandem cylinders on the dynamic responses and flow patterns of downstream cylinder were further verified by carmo et al 2011 chen et al 2015 numerically investigated the viv of two side by side elastically mounted circular cylinders at a low reynolds number of 100 using the immersed boundary method for two side by side cylinders the critical spacing ratio was determined as l d 4 0 where l was the center to center distance between adjacent cylinders and d was the cylinder diameter and beyond that the interaction between the cylinders could be negligible apart from the above studies of the viv of two cylinders the investigations on the flow past four cylinders in a square configuration have drawn considerable attention due to their fundamental offshore and ocean engineering applications in pipe bundles and tube banks however most of the experimental and numerical studies of four cylinders focus on the flow past four stationary cylinders associated with the effects of re l d and α on the wake flow patterns and force coefficients sayers 1988 1990 lam et al 2003 2008 lam and zou 2010 farrant et al 2000 wang et al 2013 tong et al 2014 when the viv occurs on the multiple cylinders with equal or unequal diameters the complexity of dynamics responses and flow interferences have not been yet completely understood zhao and cheng 2012 zhao et al 2016 han et al 2015 zhu and yao 2015 song et al 2017 zhao and cheng 2012 and zhao et al 2016 performed a numerical simulation to study the two degree of freedom viv of four rigidly coupled circular cylinders in a square configuration with different incident angles and spacing ratios for the four rigidly coupled cylinders the incident angle and spacing ratio have significant effects on the responses and vortex shedding modes of the four cylinder system han et al 2015 studied the viv of four cylinders placed in a square arrangement at a constant spacing ratio l d 5 0 and reynolds numbers of 80 and 160 the dual resonance phenomenon was observed indicating the occurrence of synchronization in both streamwise and transverse directions to the authors knowledge although several works have been performed for viv of four cylinders further investigations are still needed to address the combined effects of incident angles and reduced velocities on the oscillation responses and flow pattern modes for four separate elastically mounted cylinders which is of fundamental importance for the understanding of viv behavior behind multiple cylinders vortex induce motion vim is a motion of floating structure in a current driven by the vortex as a result of fluid structure interaction hirabayashi 2016 vim of a multi column floating platform is more complex than that of a single column owing to the complicated wake interactions among the multiple columns similar to that of group of bluff bodies exposed to a cross flow a number of experimental and numerical studies have been carried out to investigate vim of multi columns goncalves et al 2012 liu et al 2015 chen and chen 2016 zhang et al 2017 liang et al 2017 goncalves et al 2012 performed an experimental study on flow around an array of four circular cylinders in the towing tank the results showed that the values of mean drag increased as wake interference decreased liu et al 2015 carried out an experimental investigation on flow characteristics around four square cylinder arrays with different spacing ratios and attack angles at subcritical reynolds numbers they found that being located in the complex wakes of the upstream cylinders the downstream cylinders are usually subjected to smaller mean drag forces than the upstream ones whereas they would experience higher fluctuating forces this main purpose of the present work is to numerically investigate the two degree of freedom vortex induced vibrations of four elastically mounted cylinders in a square arrangement at different incident angles and reduced velocities the effects of incident angle and reduced velocity on the dynamic responses and flow pattern modes for four cylinders are investigated the variations of vibration amplitudes orbital trajectory responses and force coefficients with incident angle and reduced velocity for each cylinder are presented in details the paper is organized as follows in section 2 the details of numerical methods are described the results are presented and analyzed in section 3 finally the conclusions are drawn in section 4 2 numerical method flow past four elastically mounted cylinders is governed by the unsteady two dimensional incompressible navier stokes equations which can be expressed in the cartesian coordinate system as follows 1 u i t μ j u i x j 1 ρ p x i v 2 u i x j x j 2 u i x i 0 here u i or u j is the velocity component in the x i or x j coordinate direction and p is the pressure ρ denotes the fluid density and v is the kinematic viscosity of fluid the equations of streamwise and transverse motions of each elastically mounted cylinder are obtained in the following 3 m x c x k x f d t 4 m y c y k y f l t where m c and k denote the mass damping and stiffness associated with each cylinder respectively x x x and y y y represent the streamwise and transverse displacements velocities and accelerations respectively the incompressible navier stokes equations are solved using a commercial software package ansys fluent 16 0 segregated second order implicit unsteady solver approach together with the simple method is employed to achieve the coupling of pressure and velocity the backward difference scheme of first order accuracy is applied for the time domain and the second order accurate upwind scheme is used for the spatial domain the motion equation of each cylinder is solved using the improved fourth order runge kutta method which is manually written into the user defined functions udf the dynamic mesh model is incorporated into the fluid structure coupling algorithm at each computational time step the fluid force on each cylinder will be obtained from the flow solver the position of each cylinder will be updated and its position at the next time step will be obtained then the mesh domain will be simultaneously updated using the smoothing and local remeshing methods based on the dynamic mesh model at each time step fig 1 shows the schematic diagram and computational mesh of the four circular cylinders in a square arrangement the rectangular computational domain is 55 d 30 d and the coordinate origin 0 0 is set at the center of the four cylinders the inlet boundary is placed 12 5d upstream from the coordinate origin with a uniform flow condition u x u and u y 0 the outlet is placed 42 5d downstream from the coordinate origin and the boundary condition is specified as u x x 0 u y x 0 and a constant pressure of zero the top and bottom boundaries are placed 15d away from the coordinate origin with symmetry conditions a no slip condition is applied on each cylinder surface the computational mesh in the vicinity of four cylinders at α 15 is also presented in fig 1 c and d the total numbers of nodes and elements are 48345 and 28617 respectively each cylinder is uniformly separated by 120 nodes around the circumference of each cylinder the minimum mesh size in the radial direction near each cylinder is 0 005d the non dimensional time step is u δ t d 0 003 in the present numerical simulations the mass ratio of each cylinder is chosen to be m r 2 since it is in the range in which most marine structures are found borazjani and sotiropoulos 2009 fontaine et al 2006 the damping coefficient ξ is assigned to be zero to obtain the most intense vibrations as damping has been shown to decrease the vibration amplitude borazjani and sotiropoulos 2009 fontaine et al 2006 zhou et al 1999 our simulations are carried out at reynolds number re 150 this value of reynolds number is widely considered in the literature for which the wake flow is two dimensional and laminar bao et al 2011 zhao 2013 the center to center spacing ratio l d between each two adjacent cylinders is kept at a constant value of 5 the same as those used in han et al 2015 the reasons are attributed to that this spacing is sufficient for the fully generation of vortices behind the upstream cylinders moreover the displacements and magnitudes of fluid forces are comparatively large and can be obtained to a good accuracy the reduced velocity v r varies in the range of 3 14 with an increment of 1 the incident angle α of the incoming flow is ranged from 0 to 45 in the present study two approaches are performed for the numerical validation firstly in order to ensure that the numerical results are independent of the mesh densities the mesh dependency study is conducted by comparing the results of a single cylinder undergoing the 2 dof two degree of freedom viv obtained from three different meshes secondly to verify the present numerical solver both the numerical simulations of 1 dof one degree of freedom and 2 dof viv of a single circular cylinder are performed and the results are compared with previous numerical results reported in the literature 2 1 mesh dependency study the mesh dependency study is conducted by simulating the 2 dof viv of a single cylinder three different mesh systems are chosen by changing the nodes of the cylinder surface a coarse mesh g1 a medium mesh g2 and a fine mesh g3 the mesh parameters vibration amplitudes and force coefficients for a single cylinder undergoing a 2 dof viv for the case of re 150 with v r 5 0 are presented in table 1 the percentage changes are also given inside the bracket in table 1 as shown in table 1 the vibration amplitudes and force coefficients obtained from the three meshes are varied with the mesh density the differences between the vibration amplitudes from two meshes g1 and g2 in the x and y directions are 2 23 and 2 04 respectively with further increasing of mesh density to mesh g3 the differences between the streamwise and transverse vibration amplitudes from the meshes g2 and g3 are reduced to 0 54 and 0 43 respectively the maximum change of 3 51 occurs in the value of root mean square lift coefficient c l from mesh g1 to g2 increases of mesh density to a fine mesh g3 leads to 1 58 change in c l the comparison between the results indicates that both the vibration amplitude and force coefficients converge to approximate constant values with increasing of mesh density mesh g2 is found to be sufficient to obtain accuracy results for the present simulation a time step independence test is further conducted on mesh 2 with three non dimensional time step sizes uδt d 0 005 0 003 and 0 001 for the same case as used in the mesh dependency study table 2 shows the corresponding results it shows that the maximum difference of root mean square lift coefficient c l between uδt d 0 005 and 0 003 is around 1 61 and it decreases to approximately 0 63 between uδt d 0 003 and 0 001 therefore the non dimensional time step size uδt d 0 003 is adopted for the simulation in this paper 2 2 numerical validation in order to validate the numerical model numerical simulations of the one degree of freedom 1 dof and two degree of freedom 2 dof vortex induced vibration of an elastically mounted cylinder at low reynolds number re 150 mass ratio m r 2 0 damping ratio ξ 0 are performed the results are compared with previous experimental and numerical results reported in the literature fig 2 shows the comparisons of non dimensional transverse vibration amplitude a y d a y y m a x y m i n 2 and force coefficients of a single circular cylinder at different reduced velocities v r with reported numerical results as shown in fig 2 three branches of the vibration amplitudes such as the initial upper and lower branches are observed with reduced velocities the transitions between two different branches are referred as khalak and williamson 1999 and prasanth and mittal 2009 the transition between the initial and upper branch involves hysteresis which occurs at v r 4 at the present study intermittent switching with respect to transition between the upper and lower branch is observed at v r 7 where the phase angle between the lift force and transverse displacement is shifted from 0 to 180 the 1 dof transverse vibration amplitudes in the present study are in good agreement with the results of borazjan et al 2009 bao et al 2012 and zhao 2013 where the difference of the maximum transverse vibration amplitudes 1 dof between the present study and the results of bao et al 2012 and zhao 2013 are 1 44 and 0 55 respectively compare with the 1 dof transverse amplitudes the 2 dof transverse amplitude appear to be increased in the lock in region 4 v r 7 due to the effect of streamwise oscillation in consistent with the results obtained by han et al 2015 the difference of the maximum 2 dof transverse vibration amplitude between the present study and the results of han et al 2015 is 2 28 moreover the calculated mean drag coefficient root mean square drag and lift coefficients are observed to be in good agreement with the results of bao et al 2012 and zhao 2013 it can be seen from the vibration amplitudes and force coefficients that the present viv model is accuracy sufficiently for the viv simulations of four elastically mounted cylinders 3 results and discussion 3 1 response amplitude and frequency of four cylinders numerical simulations on viv of four elastically mounted cylinders in a square configuration are performed at different reduced velocities v r and incident angles α figs 3 and 4 present the variations of the non dimensional streamwise and transverse vibration amplitudes of four cylinders as a function of reduced velocity at different incident angles respectively it can be seen that due to the complex interference between each two neighboring cylinders the variations of the response amplitudes with reduced velocities for four cylinders appear to be more complicated than that of a single cylinder and the incident angle is found to have a significant effect on the response amplitude for each cylinder at α 0 the four cylinders array can be regarded as two parallel rows of two cylinders in tandem configuration the response amplitudes and lock in regimes of the upstream cylinders 1 and 4 are qualitatively similar to that of a single cylinder however similar to the vibrations of two cylinders qin et al 2018 the downstream cylinders 2 and 3 generally exhibit larger response amplitudes in both x and y directions than those of upstream cylinders the non dimensional transverse amplitudes a y d for four cylinders are generally larger than those of streamwise amplitudes a x d at most of the reduced velocities in consistent with the study of han et al 2015 at reduced velocities 4 v r 14 multiple peaks of streamwise amplitudes for downstream cylinders 2 and 3 are observed a possible explanation for this observation is that the incoming flow and wake flow behaviors for the downstream cylinders are much more complicated than the upstream cylinders involved the complex interactions between the shear layers separated from the upstream cylinders and mutual vortices shed from both upstream and downstream cylinders resulting into the large streamwise amplitudes at a wide range of reduced velocities the vortex induced vibrations for the downstream cylinders are more complicated and the vibration amplitudes are higher than those caused by the uniform flows which is also observed in the viv of two tandem cylinders by bao et al 2012 as α increases to 15 the largest streamwise amplitudes at v r 5 for the downstream cylinders 2 and 3 are much larger than those at α 0 both the streamwise and transverse amplitudes of the downstream cylinders 2 and 3 are larger than those of the upstream cylinders 1 and 4 with further increases of α to 30 both the streamwise and transverse response amplitudes of cylinder 2 are larger than other three cylinders at all the examined reduced velocities the streamwise and transverse response amplitudes of cylinder 3 decrease however are still larger than those of cylinders 1 and 4 at large incident angle α 45 drastic changes in the response curves are observed especially for cylinder 2 where the streamwise and transverse amplitudes are kept at large values at high reduced velocities v r 11 due to the symmetrical locations of cylinder 1 and cylinder 3 the variations of streamwise and transverse amplitudes of cylinders 1 and 3 with reduced velocities are almost the same at v r 11 from the above discussions it is worth to be noted that regardless of the incident angles the downstream cylinders generally experience large transverse and streamwise amplitudes for most of the examined reduced velocities interestingly the transverse and streamwise amplitudes for the downstream cylinders remain larger than the upstream cylinders at large reduced velocities this may be caused by the extending of lock in regime for the downstream cylinders and the wake induced vibrations of the downstream cylinders for which the distance between the upstream and downstream cylinders is considered to be sufficient to allow the mature vortices shed from the upstream cylinders and the complex interactions between the mature vortices shed from both upstream and downstream cylinders and the downstream cylinders may result into the high amplitudes similar phenomenon has also been observed in assi et al 2010 huera huarte and bearman 2011 hover and triantafyllou 2001 the variations of vibration frequency in the x and y directions with the reduced velocity at different incident angles are presented in fig 5 the vibration frequencies are determined by the fast fourier transform fft of the transverse and streamwise displacements for the four cylinders the non dimensional frequencies f y and f x is defined as the ratio of the vibration frequency to the structural natural frequency in x and y direction respectively as shown in fig 5 the lock in regime for a single cylinder is in the range of 4 v r 7 for the four cylinder array the lock in regime for the downstream cylinders appear to be generally wider than that of a single cylinder and outside of the lock in regime the vibration frequency increases with reduced velocity at all the examined incident angles it can be seen that the incident angle has little effect on the vibration responses for the upstream cylinders 1 and 4 the lock in regimes of v r are generally kept in the range of 4 v r 7 except for the case of α 45 however two peak frequencies are observed at 8 v r 11 at all the examined incident angles for the downstream cylinder 2 and at α 15 for cylinder 3 one of which is f y f n 1 indicates the synchronization with the natural frequency the lock in regimes of v r for cylinders 2 and 3 are widened to be 4 v r 11 at α 0 and 15 however with increasing of α to 30 and 45 the lock in regime of v r for cylinder 3 is narrowed to be 4 v r 8 in order to further investigate the lock in regime for the large response amplitude the normalized fft spectra of transverse displacements and lift coefficients plotted as functions of both v r and f y at different incident angles for the downstream cylinder 2 are presented in fig 6 it can be seen that the dominant peak response frequencies for the downstream cylinder 2 appear to increase with reduced velocity there is a little difference between the peak frequencies from the spectra of transverse amplitudes and lift coefficients in fig 6 where two peak response frequencies are observed at high reduced velocities in the spectra of transverse displacements however only one dominant peak frequency is observed in the spectra of lift coefficients the difference between the vibration frequency and the primary peak frequency of the force is also observed by zhao and cheng 2012 at α 0 it can be seen from the displacement spectra that at 8 v r 11 the dominant peak response frequency is in the range of 1 3 1 8 outside the lock in region however a secondary small peak response frequency is observed around f y f n 1 which is synchronized with the vibration frequency as α increases to 15 a small peak frequency is observed at f y f n 1 for 8 v r 11 in the spectra of transverse displacements while a broad banded range of peak frequency is observed from the spectra of lift coefficients similar phenomenon is also observed at α 30 and 45 where a small peak frequency is observed around f y f n 1 at high reduced velocities 8 v r 12 in the spectra of transverse displacements 3 2 force coefficients figs 7 and 8 show the variations of the mean drag and lift coefficients c d c l of four cylinders with reduced velocity v r at different incident angles respectively at incident angle α 0 as shown in fig 7 a the variations of c d of the upstream cylinders 1 and 4 are qualitatively similar to that of a single cylinder except for the peak values of c d occurred at v r 4 beyond the range of 6 v r 7 the c d values of the downstream cylinders 2 and 3 appear to be smaller than those of the upstream cylinders but a jump phenoemnon of c d to the peak value is occurred at v r 6 at high reduced velocities v r 8 the c d values of four cylinders are maintained at constant values and the values for the downstream cylinders 2 and 3 are smaller than those for the upstream cylinders 1 and 4 when α increases to 15 different from the case of α 0 the mean drag coefficient c d of cylinder 4 exhibits a peak value at a slight higher reduced velocity v r 5 the discrepancies of c d values between the upstream cylinders and downstream cylinders become smaller than that at α 0 except for 6 v r 8 the c d values of the upstream cylinders 1 and 4 are larger than those of the downstream cylinders 2 and 3 as further increases of α to 30 the variations of c d with reduced velocities for four cylinders approximately follow the same trend where c d of each cylinder reaches the peak value at v r 4 when α increases to 45 the c d values of cylinder 1 at different reduced velocities are approximately coincident with those of cylinder 3 however the variation of c d with v r for cylinder 2 appears to be different where the c d of cylinder 2 reaches the minimum value at v r 4 on the contrary the maximum values of c d for the other three cylinders occur at the same reduced velocity moreover the values of c d for cylinders 1 and 3 are more than five times of that for cylinder 2 at v r 4 it is interesting to note that the incident angle has a significant effect on the variations of the mean drag coefficients on the four cylinders at small incident angles α 0 and 15 the peak values of the mean drag coefficients c d for the upstream cylinders are almost occurred at v r 4 however with further increases of α to 30 all the four cylinders present an amplification of the mean drag coefficients at v r 4 the occurrence of maximum mean drag coefficient at v r 4 is also observed in studies of singh and mittal 2005 and zhao 2013 it is plausible to consider that the occurrence of the peak values of c d at v r 4 is mainly attributed to the viv resonance effect which is in accordance with the results presented by assi 2014 compared to the isolated cylinder the mean lift coefficients c l of four cylinders appear to be different with non zero values both the positive and negative deviations of c l are observed at α 0 the variations of c l with reduced velocities for upper side cylinders 1 and 2 appear to be symmetrical about the axial c l 0 as well as those of cylinders 3 and 4 when α increases to 15 the c l values of cylinders 2 and 3 decrease with v r at v r 5 then increase with v r until v r 7 and remain to be constant values at v r 8 the minimum values of c l for cylinders 2 and 3 occur at v r 5 and the peak value of c l for cylinder 2 occurs at v r 7 with increasing of α to 30 and 45 the c l value of cylinder 2 experiences different trend with v r compared to those of α 0 and 15 the peak value of c l for cylinder 2 is observed at v r 4 for α 30 and v r 6 for α 45 the minimum value of c l for cylinder 3 is observed at v r 5 for most of the incident angles except for α 0 the variations of the root mean square r m s drag and lift coefficients c d c l of four cylinders are plotted as a function of reduced velocity v r in figs 9 and 10 respectively at incident angle α 0 the variations of the values of c d for both the upstream cylinders 1 and 4 with v r follow the same trend with the isolated cylinder and reach the peak values at v r 4 the variation of c d for the downstream cylinder 2 exhibits a peak at v r 4 however a peak value of c d occurs at a relatively higher reduced velocity v r 6 for the downstream cylinder 3 when α increases to 15 the values of c d for the downstream cylinders 2 and 3 appear to be much larger than those for the upstream cylinders 1 and 4 moreover a jump phenomenon of c d occurs at v r 4 for cylinders 1 and 3 and at v r 5 for cylinders 2 and 4 with further increases of α to 30 the jump phenomenon of c d for the four cylinders is observed at v r 4 comparisons of the peak values of c d for the four cylinders with incident angles the c d for the four cylinders reach the maximum values at α 30 and the c d value of cylinder 2 appears to be the laregest at v r 4 however when α 45 different from the other three cylinders the peak value of c d for cylinder 2 is delayed to be occurred at a higher reduced velocity v r 6 similar to the variation trend of c d with v r the r m s lift coefficients c l for the downstream cylinders are much larger than those for the upstream cylinders and approach the peak values at v r 4 for α 15 and 30 as further increases of α to 45 the peak value of c l for the cylinder 2 occurs at the low reduced velocity v r 3 however the peak values of c l for the other three cylinders remains at v r 4 which may be related with the phase lag between the vortex shedding from two tandem cylinders as illustrated in alam 2016 fig 11 shows the variations of correlation coefficient r f l y and phase difference ϕ between the lift force f l and vibration displacement y in the y direction with reduced velocity for each cylinder at different incident angles the definitions of r f l y and ϕ are referred as kim and alam 2015 and qin et al 2017 the phase lag ϕ is calculated from the cross correlations r f l y between f l and y signals 5 r f l y τ y t f l t τ y t 2 1 2 f l t τ 2 1 2 where τ is the time lag and t is the time the correlation coefficient is the maximum when the two signals are in phase as shown in fig 11 the correlation coefficient between the lift force and transverse displacement is about 1 if they are in phase or anti phase with each other and reaches to a minimum value at v r 6 for α 0 and α 45 and at v r 7 for α 15 and α 30 the phase angle ϕ changes from 0 to 180 when the reduced velocity increases to 7 for most of the examined incident angles α 30 at v r 6 the phase angle ϕ for each cylinder is 0 which indicates that the transverse displacement y is in phase with the lift force leading to an increase of y with v r on the contrary at large reduced velocity v r 7 the phase angle ϕ jumps to 180 the y is in anti phase with the lift force resulting into a decrease of y as v r increases at α 15 different from the other three cylinders the phase angle ϕ for cylinder 2 jumps to about 20 at v r 6 as α increases to 30 a larger phase difference for cylinder 2 is also observed at v r 10 and 11 with a further increase of α to 45 the phase angles ϕ with v r for cylinders 1 and 3 are shifted from 0 to 90 at v r 7 and then becomes about 180 as v r 8 for cylinder 3 and v r 9 for cylinder 1 for cylinder 2 different from the other incident angles the phase angle changes to 180 at a larger reduced velocity v r 8 3 3 trajectory responses in order to clarify the impact of the incident angle and reduced velocity on the motion trajectory responses the lissajous figures for the four cylinders at different reduced velocities and incidence angles are presented in figs 12 15 respectively at α 0 as shown in fig 12 the trajectory responses of the four cylinders behave differently with increasing of reduced velocities at low reduced velocity v r 3 a dominant motion trajectory of figure 8 is observed for the four cylinders where the frequency response of the streamwise direction f x is twice of the transverse direction f y at v r 4 and 5 the trajectories of the downstream cylinders 2 and 3 present the crescent shapes in different path directions where the oscillation frequency in the streamwise direction is observed to be approximately the same as the transverse direction with increasing of v r to 6 and 7 due to the co existence of multiple spectral peaks in the streamwise direction the motion trajectories of the four cylinders are the irregular figure 8 however different from the case of v r 3 the motion trajectory is not symmetrical about the y axis compared to the low reduced velocities v r 8 the spectral peaks of the streamwise displacements are occurred at relatively low frequencies at v r 8 leading to the irregular motion trajectories for the downstream cylinders 2 and 3 when α increases to 15 the motion trajectory for each cylinder presents a raindrop shape with the same streamwise and transverse oscillation frequencies at low reduced velocity v r 3 with increasing of v r from 5 to 8 the upstream cylinders 1 and 4 exhibit irregular figure 8 shapes however the downstream cylinders 2 and 3 exhibit different motion trajectories with increasing of v r where the motion trajectories of the downstream cylinders 2 and 3 present a regular oval shape at v r 4 and become irregular at v r 5 then become to figure 8 shape at v r 6 when v r 8 the trajectory motions of the four cylinders become chaotic and irregularly moreover the oscillation amplitude of the cylinders 2 and 3 are larger than those of the cylinders 1 and 4 since cylinders 2 and 3 are located in the near wake of the cylinders 1 and 4 at incident angle α 30 due to the complex interactions among the four cylinders even at the same reduced velocity the motion trajectories of four cylinders are different from each other the motion trajectories of cylinders 1 and 4 show oblique raindrop shapes at v r 3 and crescent shapes at v r 4 irregular figure 8 shape occurs at 5 v r 7 when v r is larger than 7 the motion trajectories of cylinders 1 and 4 become complicated and chaotic the motion trajectory of cylinder 2 behaves complicated and difficult to be described except at v r 3 the cylinder 3 exhibits an oblique figure 8 shape at v r 3 with further increases of v r the motion trajectory of cylinder 3 changes to an inverted raindrop shape at v r 5 and an oblique inverted raindrop shape at v r 6 and 7 the enclosed loops are observed at v r 8 where the irregular motion trajectories may be caused by the multiple frequencies f x with a further increase of α to 45 the four cylinders exhibit different trajectory responses at different reduced velocities especially for cylinder 2 at low reduced velocity v r 3 an oblique figure 8 shape is observed with large vibration amplitude for cylinder 2 at v r 6 the motion trajectory of cylinder 2 is a raindrop shape and changes to a figure 8 shape at v r 7 at v r 8 the motion trajectory of cylinder 2 appears to be very chaotic with irregular shapes moreover due to the symmetrical arrangement of cylinders 1 and 3 the motion trajectories of cylinders 1 and 3 appear to be in opposite directions at the examined reduced velocities for example at v r 5 7 the trajectories with a raindrop and inverted raindrop shapes are observed for cylinder 1 and 3 respectively 3 4 wake flow patterns the instantaneous vorticity contours of four cylinders at different reduced velocities and incident angles are presented in figs 16 19 it can be seen that the incident angles and reduced velocities play important roles in fluid dynamic behaviors the regular von karman vortex shedding is mainly observed behind the upstream cylinders however due to lying in the wake of upstream cylinders the downstream cylinders encounter unsteady inflows at α 0 as shown in fig 16 the four cylinders could be considered as two tandem cylinder arrays different wake flow patterns are observed with variations of the reduced velocities at low reduced velocity v r 3 similar to the case of stationary cylinders two parallel vortex shedding modes symmetrical with respect to the wake centerline y 0 are observed in the wake region of the downstream cylinders resulting into small drag force coefficient and vibration amplitudes at v r 6 and 7 a 2s vortex shedding pattern is observed behind the downstream cylinders compared to that of stationary cylinders the process of the generation growth disappearance of vortices appears closer to the four cylinders when the cylinders undergo vortex induced vibrations in agreement with experiments of kim et al 2018 the vortices shed from the top side cylinders are synchronized with the vortices shed from the bottom side cylinders and the vortices shed from the upstream cylinders always impinge on the downstream cylinders leading to the large vibration amplitudes in the cross flow direction for the downstream cylinders as v r increases to 9 corresponding to the irregular trajectories shown in fig 12 the vibration amplitudes of the upstream cylinders become very small indicating the outside the lock in region the downstream cylinders 2 and 3 still experience large vibration amplitudes due to the synchronization of shed vortices and impingement of the vortices shed from the upstream cylinders at large reduced velocities v r 12 the anti phase vortex shedding mode is observed behind the four cylinders where the vortices from the top side cylinders and bottom side cylinders are shed simultaneously with the opposite signs when α increases to 15 and 30 the vortex shedding patterns appear to be more complex than those at α 0 at α 15 when v r 6 two vortex streets are observed behind each downstream cylinder corresponding to the regular and periodic vibrations shown in fig 13 at v r 9 the vortices shed from the downstream cylinders appear to be elongated due to the impingement of the vortices shed from the upstream cylinders the downstream cylinders exhibit irregular vibrations at α 30 multiple shed vortices with strong interactions are observed behind the downstream cylinders the amalgamation phenomenon of the vortices with the same sign are observed behind the downstream cylinders 2 and 3 the vortices shed from both the upstream cylinders 1 and 4 impinge on the downstream cylinder 2 resulting into the large vibration amplitudes of the downstream cylinder 2 due to the weak interference of the vortices shed from cylinders 1 and 4 on cylinder 3 both the transverse and streamwise vibration amplitudes of cylinder 3 are smaller than those of cylinder 2 with further increases of α to 45 the interferences among the four cylinders become weak the vortices shed from the upstream cylinder 4 are always impinged on the downstream cylinder 2 however the cylinder 3 encounters little influence of the other cylinders corresponding to the reduction of the vibration amplitudes the vortices shed from cylinders 1 and 3 appear to be in in phase mode at most of the reduced velocities and have little effect on the downstream cylinder 2 4 conclusions the two dimensional numerical simulations have been performed to study the two degree of freedom vortex induced vibration of four circular cylinders in a square arrangement the effects of incidence angles and reduced velocities on the dynamic responses and vortex shedding modes of the four cylinders are investigated the conclusions are summarized as follows 1 due to the complex interferences among the four cylinders the variations of the dynamic responses with reduced velocities appear to be more complicated than that of an isolated cylinder the incident angle α is found to have a significant effect on the dynamic responses of the downstream cylinders rather than the upstream cylinders with increasing of α the maximum transverse and streamwise amplitudes of cylinder 2 are approximately to be larger than the other three cylinders 2 at all the examined incident angles the lock in regimes for the downstream cylinders are wider than those of upstream cylinders especially for cylinder 2 two predominant vibration frequencies are observed at 8 v r 11 one of which is synchronized with the natural frequency of the cylinder with increasing of α the lock in regime of v r for cylinder 3 becomes narrowed outside of the lock in regime the vibration frequency increases with reduced velocity for each cylinder 3 for all the examined incident angles α the mean drag coefficients of four cylinders generally increase with reduced velocity and then slightly decrease the mean lift coefficients of four cylinders behave differently with increasing of α especially for v r 8 moreover the variations of the root mean square lift and drag coefficients c d c l of cylinder 2 appear to be more sensitive to the incident angle than the other cylinders 4 the incident angle plays an important role in the motion trajectories and vortex shedding modes for the four cylinders at α 15 and 30 due to the enhanced wake flow interferences the complex vortex structures such as the vortex elongation impingement and vortices amalgamation with the same sign are observed behind the downstream cylinders 2 and 3 with further increases of α to 45 the interactions among the four cylinders become weak resulting into the reduction of the vibration amplitudes for cylinder 3 acknowledgements this research was supported by joint key funds of zhejiang provincial natural science foundation of china and powerchina huadong engineering corporation limited grant no lhz19e090004 national natural science foundation of china grant no 51409231 scientific research foundation for the returned overseas chinese scholars state education ministry no 1685 2014 
22961,this paper presents a numerical study of two degree of freedom vortex induced vibration of four elastically mounted circular cylinders in a square arrangement at a low reynolds number of re 150 and mass ratio of 2 0 the incident angle α is ranged from 0 to 45 and the reduced velocity v r is ranged from 3 to 14 the effects of incident angle and reduced velocity on the dynamic responses and wake flow patterns behind four cylinders are investigated the results show that the incident angle has a significant effect on the vibration amplitudes and force coefficients of four cylinders especially for the downstream cylinders where the maximum vibration amplitudes and force coefficients are occurred mostly on the downstream cylinder with increasing of the incident angle α the orbital trajectory for each cylinder becomes irregular and complicated especially at high reduced velocities v r 8 corresponding to multiple oscillation frequencies moreover the wake flow patterns behind four cylinders are modified significantly with variations of incident angles accompanied by different vortex shedding modes keywords vortex induced vibration of four cylinders incident angle reduced velocity oscillation response flow pattern 1 introduction investigations on vortex induced vibration viv of multiple cylindrical structures have received a great deal of attention due to their highly undesirable resonance and failure of the offshore and ocean engineering structures such as platform offshore wind turbine foundations risers and pipelines etc in the past several decades the viv of a single elastically mounted circular cylinder has been studied extensively which can be referred to the articles bearman 1984 2011 jauvtis and williamson 2003 gabbai and benaroya 2005 williamson and govardhan 2008 wu et al 2012 han et al 2016 nevertheless when a pair of multiple cylinders placed sufficiently close to each other in a uniform flow undergo viv the dynamic responses of multiple cylinders and vortex shedding patterns are reported to be much more complicated than those of a single cylinder previous studies were mostly concerned with the vortex induced vibrations of two cylinders in tandem side by side and staggered configurations bokaian and geoola 1984 zdravkovich 1985 mittal and kumar 2004 the complex interferences between two circular cylinders undergoing viv have been extensively investigated experimentally assi et al 2010 huera huarte and gharib 2011 huang and herfjord 2013 and numerically prasanth and mittal 2009 carmo et al 2011 chen et al 2015 the vibration amplitudes and flow behaviors of two cylinders are found to be strongly depended on the relative locations and configurations prasanth and mittal 2009 performed numerical simulations of viv of two cylinders in tandem and staggered arrangements in laminar flow using the finite element method compared with an isolated cylinder the dynamic behavior of the downstream cylinder was significantly changed in both arrangements the effects of gap flow between two tandem cylinders on the dynamic responses and flow patterns of downstream cylinder were further verified by carmo et al 2011 chen et al 2015 numerically investigated the viv of two side by side elastically mounted circular cylinders at a low reynolds number of 100 using the immersed boundary method for two side by side cylinders the critical spacing ratio was determined as l d 4 0 where l was the center to center distance between adjacent cylinders and d was the cylinder diameter and beyond that the interaction between the cylinders could be negligible apart from the above studies of the viv of two cylinders the investigations on the flow past four cylinders in a square configuration have drawn considerable attention due to their fundamental offshore and ocean engineering applications in pipe bundles and tube banks however most of the experimental and numerical studies of four cylinders focus on the flow past four stationary cylinders associated with the effects of re l d and α on the wake flow patterns and force coefficients sayers 1988 1990 lam et al 2003 2008 lam and zou 2010 farrant et al 2000 wang et al 2013 tong et al 2014 when the viv occurs on the multiple cylinders with equal or unequal diameters the complexity of dynamics responses and flow interferences have not been yet completely understood zhao and cheng 2012 zhao et al 2016 han et al 2015 zhu and yao 2015 song et al 2017 zhao and cheng 2012 and zhao et al 2016 performed a numerical simulation to study the two degree of freedom viv of four rigidly coupled circular cylinders in a square configuration with different incident angles and spacing ratios for the four rigidly coupled cylinders the incident angle and spacing ratio have significant effects on the responses and vortex shedding modes of the four cylinder system han et al 2015 studied the viv of four cylinders placed in a square arrangement at a constant spacing ratio l d 5 0 and reynolds numbers of 80 and 160 the dual resonance phenomenon was observed indicating the occurrence of synchronization in both streamwise and transverse directions to the authors knowledge although several works have been performed for viv of four cylinders further investigations are still needed to address the combined effects of incident angles and reduced velocities on the oscillation responses and flow pattern modes for four separate elastically mounted cylinders which is of fundamental importance for the understanding of viv behavior behind multiple cylinders vortex induce motion vim is a motion of floating structure in a current driven by the vortex as a result of fluid structure interaction hirabayashi 2016 vim of a multi column floating platform is more complex than that of a single column owing to the complicated wake interactions among the multiple columns similar to that of group of bluff bodies exposed to a cross flow a number of experimental and numerical studies have been carried out to investigate vim of multi columns goncalves et al 2012 liu et al 2015 chen and chen 2016 zhang et al 2017 liang et al 2017 goncalves et al 2012 performed an experimental study on flow around an array of four circular cylinders in the towing tank the results showed that the values of mean drag increased as wake interference decreased liu et al 2015 carried out an experimental investigation on flow characteristics around four square cylinder arrays with different spacing ratios and attack angles at subcritical reynolds numbers they found that being located in the complex wakes of the upstream cylinders the downstream cylinders are usually subjected to smaller mean drag forces than the upstream ones whereas they would experience higher fluctuating forces this main purpose of the present work is to numerically investigate the two degree of freedom vortex induced vibrations of four elastically mounted cylinders in a square arrangement at different incident angles and reduced velocities the effects of incident angle and reduced velocity on the dynamic responses and flow pattern modes for four cylinders are investigated the variations of vibration amplitudes orbital trajectory responses and force coefficients with incident angle and reduced velocity for each cylinder are presented in details the paper is organized as follows in section 2 the details of numerical methods are described the results are presented and analyzed in section 3 finally the conclusions are drawn in section 4 2 numerical method flow past four elastically mounted cylinders is governed by the unsteady two dimensional incompressible navier stokes equations which can be expressed in the cartesian coordinate system as follows 1 u i t μ j u i x j 1 ρ p x i v 2 u i x j x j 2 u i x i 0 here u i or u j is the velocity component in the x i or x j coordinate direction and p is the pressure ρ denotes the fluid density and v is the kinematic viscosity of fluid the equations of streamwise and transverse motions of each elastically mounted cylinder are obtained in the following 3 m x c x k x f d t 4 m y c y k y f l t where m c and k denote the mass damping and stiffness associated with each cylinder respectively x x x and y y y represent the streamwise and transverse displacements velocities and accelerations respectively the incompressible navier stokes equations are solved using a commercial software package ansys fluent 16 0 segregated second order implicit unsteady solver approach together with the simple method is employed to achieve the coupling of pressure and velocity the backward difference scheme of first order accuracy is applied for the time domain and the second order accurate upwind scheme is used for the spatial domain the motion equation of each cylinder is solved using the improved fourth order runge kutta method which is manually written into the user defined functions udf the dynamic mesh model is incorporated into the fluid structure coupling algorithm at each computational time step the fluid force on each cylinder will be obtained from the flow solver the position of each cylinder will be updated and its position at the next time step will be obtained then the mesh domain will be simultaneously updated using the smoothing and local remeshing methods based on the dynamic mesh model at each time step fig 1 shows the schematic diagram and computational mesh of the four circular cylinders in a square arrangement the rectangular computational domain is 55 d 30 d and the coordinate origin 0 0 is set at the center of the four cylinders the inlet boundary is placed 12 5d upstream from the coordinate origin with a uniform flow condition u x u and u y 0 the outlet is placed 42 5d downstream from the coordinate origin and the boundary condition is specified as u x x 0 u y x 0 and a constant pressure of zero the top and bottom boundaries are placed 15d away from the coordinate origin with symmetry conditions a no slip condition is applied on each cylinder surface the computational mesh in the vicinity of four cylinders at α 15 is also presented in fig 1 c and d the total numbers of nodes and elements are 48345 and 28617 respectively each cylinder is uniformly separated by 120 nodes around the circumference of each cylinder the minimum mesh size in the radial direction near each cylinder is 0 005d the non dimensional time step is u δ t d 0 003 in the present numerical simulations the mass ratio of each cylinder is chosen to be m r 2 since it is in the range in which most marine structures are found borazjani and sotiropoulos 2009 fontaine et al 2006 the damping coefficient ξ is assigned to be zero to obtain the most intense vibrations as damping has been shown to decrease the vibration amplitude borazjani and sotiropoulos 2009 fontaine et al 2006 zhou et al 1999 our simulations are carried out at reynolds number re 150 this value of reynolds number is widely considered in the literature for which the wake flow is two dimensional and laminar bao et al 2011 zhao 2013 the center to center spacing ratio l d between each two adjacent cylinders is kept at a constant value of 5 the same as those used in han et al 2015 the reasons are attributed to that this spacing is sufficient for the fully generation of vortices behind the upstream cylinders moreover the displacements and magnitudes of fluid forces are comparatively large and can be obtained to a good accuracy the reduced velocity v r varies in the range of 3 14 with an increment of 1 the incident angle α of the incoming flow is ranged from 0 to 45 in the present study two approaches are performed for the numerical validation firstly in order to ensure that the numerical results are independent of the mesh densities the mesh dependency study is conducted by comparing the results of a single cylinder undergoing the 2 dof two degree of freedom viv obtained from three different meshes secondly to verify the present numerical solver both the numerical simulations of 1 dof one degree of freedom and 2 dof viv of a single circular cylinder are performed and the results are compared with previous numerical results reported in the literature 2 1 mesh dependency study the mesh dependency study is conducted by simulating the 2 dof viv of a single cylinder three different mesh systems are chosen by changing the nodes of the cylinder surface a coarse mesh g1 a medium mesh g2 and a fine mesh g3 the mesh parameters vibration amplitudes and force coefficients for a single cylinder undergoing a 2 dof viv for the case of re 150 with v r 5 0 are presented in table 1 the percentage changes are also given inside the bracket in table 1 as shown in table 1 the vibration amplitudes and force coefficients obtained from the three meshes are varied with the mesh density the differences between the vibration amplitudes from two meshes g1 and g2 in the x and y directions are 2 23 and 2 04 respectively with further increasing of mesh density to mesh g3 the differences between the streamwise and transverse vibration amplitudes from the meshes g2 and g3 are reduced to 0 54 and 0 43 respectively the maximum change of 3 51 occurs in the value of root mean square lift coefficient c l from mesh g1 to g2 increases of mesh density to a fine mesh g3 leads to 1 58 change in c l the comparison between the results indicates that both the vibration amplitude and force coefficients converge to approximate constant values with increasing of mesh density mesh g2 is found to be sufficient to obtain accuracy results for the present simulation a time step independence test is further conducted on mesh 2 with three non dimensional time step sizes uδt d 0 005 0 003 and 0 001 for the same case as used in the mesh dependency study table 2 shows the corresponding results it shows that the maximum difference of root mean square lift coefficient c l between uδt d 0 005 and 0 003 is around 1 61 and it decreases to approximately 0 63 between uδt d 0 003 and 0 001 therefore the non dimensional time step size uδt d 0 003 is adopted for the simulation in this paper 2 2 numerical validation in order to validate the numerical model numerical simulations of the one degree of freedom 1 dof and two degree of freedom 2 dof vortex induced vibration of an elastically mounted cylinder at low reynolds number re 150 mass ratio m r 2 0 damping ratio ξ 0 are performed the results are compared with previous experimental and numerical results reported in the literature fig 2 shows the comparisons of non dimensional transverse vibration amplitude a y d a y y m a x y m i n 2 and force coefficients of a single circular cylinder at different reduced velocities v r with reported numerical results as shown in fig 2 three branches of the vibration amplitudes such as the initial upper and lower branches are observed with reduced velocities the transitions between two different branches are referred as khalak and williamson 1999 and prasanth and mittal 2009 the transition between the initial and upper branch involves hysteresis which occurs at v r 4 at the present study intermittent switching with respect to transition between the upper and lower branch is observed at v r 7 where the phase angle between the lift force and transverse displacement is shifted from 0 to 180 the 1 dof transverse vibration amplitudes in the present study are in good agreement with the results of borazjan et al 2009 bao et al 2012 and zhao 2013 where the difference of the maximum transverse vibration amplitudes 1 dof between the present study and the results of bao et al 2012 and zhao 2013 are 1 44 and 0 55 respectively compare with the 1 dof transverse amplitudes the 2 dof transverse amplitude appear to be increased in the lock in region 4 v r 7 due to the effect of streamwise oscillation in consistent with the results obtained by han et al 2015 the difference of the maximum 2 dof transverse vibration amplitude between the present study and the results of han et al 2015 is 2 28 moreover the calculated mean drag coefficient root mean square drag and lift coefficients are observed to be in good agreement with the results of bao et al 2012 and zhao 2013 it can be seen from the vibration amplitudes and force coefficients that the present viv model is accuracy sufficiently for the viv simulations of four elastically mounted cylinders 3 results and discussion 3 1 response amplitude and frequency of four cylinders numerical simulations on viv of four elastically mounted cylinders in a square configuration are performed at different reduced velocities v r and incident angles α figs 3 and 4 present the variations of the non dimensional streamwise and transverse vibration amplitudes of four cylinders as a function of reduced velocity at different incident angles respectively it can be seen that due to the complex interference between each two neighboring cylinders the variations of the response amplitudes with reduced velocities for four cylinders appear to be more complicated than that of a single cylinder and the incident angle is found to have a significant effect on the response amplitude for each cylinder at α 0 the four cylinders array can be regarded as two parallel rows of two cylinders in tandem configuration the response amplitudes and lock in regimes of the upstream cylinders 1 and 4 are qualitatively similar to that of a single cylinder however similar to the vibrations of two cylinders qin et al 2018 the downstream cylinders 2 and 3 generally exhibit larger response amplitudes in both x and y directions than those of upstream cylinders the non dimensional transverse amplitudes a y d for four cylinders are generally larger than those of streamwise amplitudes a x d at most of the reduced velocities in consistent with the study of han et al 2015 at reduced velocities 4 v r 14 multiple peaks of streamwise amplitudes for downstream cylinders 2 and 3 are observed a possible explanation for this observation is that the incoming flow and wake flow behaviors for the downstream cylinders are much more complicated than the upstream cylinders involved the complex interactions between the shear layers separated from the upstream cylinders and mutual vortices shed from both upstream and downstream cylinders resulting into the large streamwise amplitudes at a wide range of reduced velocities the vortex induced vibrations for the downstream cylinders are more complicated and the vibration amplitudes are higher than those caused by the uniform flows which is also observed in the viv of two tandem cylinders by bao et al 2012 as α increases to 15 the largest streamwise amplitudes at v r 5 for the downstream cylinders 2 and 3 are much larger than those at α 0 both the streamwise and transverse amplitudes of the downstream cylinders 2 and 3 are larger than those of the upstream cylinders 1 and 4 with further increases of α to 30 both the streamwise and transverse response amplitudes of cylinder 2 are larger than other three cylinders at all the examined reduced velocities the streamwise and transverse response amplitudes of cylinder 3 decrease however are still larger than those of cylinders 1 and 4 at large incident angle α 45 drastic changes in the response curves are observed especially for cylinder 2 where the streamwise and transverse amplitudes are kept at large values at high reduced velocities v r 11 due to the symmetrical locations of cylinder 1 and cylinder 3 the variations of streamwise and transverse amplitudes of cylinders 1 and 3 with reduced velocities are almost the same at v r 11 from the above discussions it is worth to be noted that regardless of the incident angles the downstream cylinders generally experience large transverse and streamwise amplitudes for most of the examined reduced velocities interestingly the transverse and streamwise amplitudes for the downstream cylinders remain larger than the upstream cylinders at large reduced velocities this may be caused by the extending of lock in regime for the downstream cylinders and the wake induced vibrations of the downstream cylinders for which the distance between the upstream and downstream cylinders is considered to be sufficient to allow the mature vortices shed from the upstream cylinders and the complex interactions between the mature vortices shed from both upstream and downstream cylinders and the downstream cylinders may result into the high amplitudes similar phenomenon has also been observed in assi et al 2010 huera huarte and bearman 2011 hover and triantafyllou 2001 the variations of vibration frequency in the x and y directions with the reduced velocity at different incident angles are presented in fig 5 the vibration frequencies are determined by the fast fourier transform fft of the transverse and streamwise displacements for the four cylinders the non dimensional frequencies f y and f x is defined as the ratio of the vibration frequency to the structural natural frequency in x and y direction respectively as shown in fig 5 the lock in regime for a single cylinder is in the range of 4 v r 7 for the four cylinder array the lock in regime for the downstream cylinders appear to be generally wider than that of a single cylinder and outside of the lock in regime the vibration frequency increases with reduced velocity at all the examined incident angles it can be seen that the incident angle has little effect on the vibration responses for the upstream cylinders 1 and 4 the lock in regimes of v r are generally kept in the range of 4 v r 7 except for the case of α 45 however two peak frequencies are observed at 8 v r 11 at all the examined incident angles for the downstream cylinder 2 and at α 15 for cylinder 3 one of which is f y f n 1 indicates the synchronization with the natural frequency the lock in regimes of v r for cylinders 2 and 3 are widened to be 4 v r 11 at α 0 and 15 however with increasing of α to 30 and 45 the lock in regime of v r for cylinder 3 is narrowed to be 4 v r 8 in order to further investigate the lock in regime for the large response amplitude the normalized fft spectra of transverse displacements and lift coefficients plotted as functions of both v r and f y at different incident angles for the downstream cylinder 2 are presented in fig 6 it can be seen that the dominant peak response frequencies for the downstream cylinder 2 appear to increase with reduced velocity there is a little difference between the peak frequencies from the spectra of transverse amplitudes and lift coefficients in fig 6 where two peak response frequencies are observed at high reduced velocities in the spectra of transverse displacements however only one dominant peak frequency is observed in the spectra of lift coefficients the difference between the vibration frequency and the primary peak frequency of the force is also observed by zhao and cheng 2012 at α 0 it can be seen from the displacement spectra that at 8 v r 11 the dominant peak response frequency is in the range of 1 3 1 8 outside the lock in region however a secondary small peak response frequency is observed around f y f n 1 which is synchronized with the vibration frequency as α increases to 15 a small peak frequency is observed at f y f n 1 for 8 v r 11 in the spectra of transverse displacements while a broad banded range of peak frequency is observed from the spectra of lift coefficients similar phenomenon is also observed at α 30 and 45 where a small peak frequency is observed around f y f n 1 at high reduced velocities 8 v r 12 in the spectra of transverse displacements 3 2 force coefficients figs 7 and 8 show the variations of the mean drag and lift coefficients c d c l of four cylinders with reduced velocity v r at different incident angles respectively at incident angle α 0 as shown in fig 7 a the variations of c d of the upstream cylinders 1 and 4 are qualitatively similar to that of a single cylinder except for the peak values of c d occurred at v r 4 beyond the range of 6 v r 7 the c d values of the downstream cylinders 2 and 3 appear to be smaller than those of the upstream cylinders but a jump phenoemnon of c d to the peak value is occurred at v r 6 at high reduced velocities v r 8 the c d values of four cylinders are maintained at constant values and the values for the downstream cylinders 2 and 3 are smaller than those for the upstream cylinders 1 and 4 when α increases to 15 different from the case of α 0 the mean drag coefficient c d of cylinder 4 exhibits a peak value at a slight higher reduced velocity v r 5 the discrepancies of c d values between the upstream cylinders and downstream cylinders become smaller than that at α 0 except for 6 v r 8 the c d values of the upstream cylinders 1 and 4 are larger than those of the downstream cylinders 2 and 3 as further increases of α to 30 the variations of c d with reduced velocities for four cylinders approximately follow the same trend where c d of each cylinder reaches the peak value at v r 4 when α increases to 45 the c d values of cylinder 1 at different reduced velocities are approximately coincident with those of cylinder 3 however the variation of c d with v r for cylinder 2 appears to be different where the c d of cylinder 2 reaches the minimum value at v r 4 on the contrary the maximum values of c d for the other three cylinders occur at the same reduced velocity moreover the values of c d for cylinders 1 and 3 are more than five times of that for cylinder 2 at v r 4 it is interesting to note that the incident angle has a significant effect on the variations of the mean drag coefficients on the four cylinders at small incident angles α 0 and 15 the peak values of the mean drag coefficients c d for the upstream cylinders are almost occurred at v r 4 however with further increases of α to 30 all the four cylinders present an amplification of the mean drag coefficients at v r 4 the occurrence of maximum mean drag coefficient at v r 4 is also observed in studies of singh and mittal 2005 and zhao 2013 it is plausible to consider that the occurrence of the peak values of c d at v r 4 is mainly attributed to the viv resonance effect which is in accordance with the results presented by assi 2014 compared to the isolated cylinder the mean lift coefficients c l of four cylinders appear to be different with non zero values both the positive and negative deviations of c l are observed at α 0 the variations of c l with reduced velocities for upper side cylinders 1 and 2 appear to be symmetrical about the axial c l 0 as well as those of cylinders 3 and 4 when α increases to 15 the c l values of cylinders 2 and 3 decrease with v r at v r 5 then increase with v r until v r 7 and remain to be constant values at v r 8 the minimum values of c l for cylinders 2 and 3 occur at v r 5 and the peak value of c l for cylinder 2 occurs at v r 7 with increasing of α to 30 and 45 the c l value of cylinder 2 experiences different trend with v r compared to those of α 0 and 15 the peak value of c l for cylinder 2 is observed at v r 4 for α 30 and v r 6 for α 45 the minimum value of c l for cylinder 3 is observed at v r 5 for most of the incident angles except for α 0 the variations of the root mean square r m s drag and lift coefficients c d c l of four cylinders are plotted as a function of reduced velocity v r in figs 9 and 10 respectively at incident angle α 0 the variations of the values of c d for both the upstream cylinders 1 and 4 with v r follow the same trend with the isolated cylinder and reach the peak values at v r 4 the variation of c d for the downstream cylinder 2 exhibits a peak at v r 4 however a peak value of c d occurs at a relatively higher reduced velocity v r 6 for the downstream cylinder 3 when α increases to 15 the values of c d for the downstream cylinders 2 and 3 appear to be much larger than those for the upstream cylinders 1 and 4 moreover a jump phenomenon of c d occurs at v r 4 for cylinders 1 and 3 and at v r 5 for cylinders 2 and 4 with further increases of α to 30 the jump phenomenon of c d for the four cylinders is observed at v r 4 comparisons of the peak values of c d for the four cylinders with incident angles the c d for the four cylinders reach the maximum values at α 30 and the c d value of cylinder 2 appears to be the laregest at v r 4 however when α 45 different from the other three cylinders the peak value of c d for cylinder 2 is delayed to be occurred at a higher reduced velocity v r 6 similar to the variation trend of c d with v r the r m s lift coefficients c l for the downstream cylinders are much larger than those for the upstream cylinders and approach the peak values at v r 4 for α 15 and 30 as further increases of α to 45 the peak value of c l for the cylinder 2 occurs at the low reduced velocity v r 3 however the peak values of c l for the other three cylinders remains at v r 4 which may be related with the phase lag between the vortex shedding from two tandem cylinders as illustrated in alam 2016 fig 11 shows the variations of correlation coefficient r f l y and phase difference ϕ between the lift force f l and vibration displacement y in the y direction with reduced velocity for each cylinder at different incident angles the definitions of r f l y and ϕ are referred as kim and alam 2015 and qin et al 2017 the phase lag ϕ is calculated from the cross correlations r f l y between f l and y signals 5 r f l y τ y t f l t τ y t 2 1 2 f l t τ 2 1 2 where τ is the time lag and t is the time the correlation coefficient is the maximum when the two signals are in phase as shown in fig 11 the correlation coefficient between the lift force and transverse displacement is about 1 if they are in phase or anti phase with each other and reaches to a minimum value at v r 6 for α 0 and α 45 and at v r 7 for α 15 and α 30 the phase angle ϕ changes from 0 to 180 when the reduced velocity increases to 7 for most of the examined incident angles α 30 at v r 6 the phase angle ϕ for each cylinder is 0 which indicates that the transverse displacement y is in phase with the lift force leading to an increase of y with v r on the contrary at large reduced velocity v r 7 the phase angle ϕ jumps to 180 the y is in anti phase with the lift force resulting into a decrease of y as v r increases at α 15 different from the other three cylinders the phase angle ϕ for cylinder 2 jumps to about 20 at v r 6 as α increases to 30 a larger phase difference for cylinder 2 is also observed at v r 10 and 11 with a further increase of α to 45 the phase angles ϕ with v r for cylinders 1 and 3 are shifted from 0 to 90 at v r 7 and then becomes about 180 as v r 8 for cylinder 3 and v r 9 for cylinder 1 for cylinder 2 different from the other incident angles the phase angle changes to 180 at a larger reduced velocity v r 8 3 3 trajectory responses in order to clarify the impact of the incident angle and reduced velocity on the motion trajectory responses the lissajous figures for the four cylinders at different reduced velocities and incidence angles are presented in figs 12 15 respectively at α 0 as shown in fig 12 the trajectory responses of the four cylinders behave differently with increasing of reduced velocities at low reduced velocity v r 3 a dominant motion trajectory of figure 8 is observed for the four cylinders where the frequency response of the streamwise direction f x is twice of the transverse direction f y at v r 4 and 5 the trajectories of the downstream cylinders 2 and 3 present the crescent shapes in different path directions where the oscillation frequency in the streamwise direction is observed to be approximately the same as the transverse direction with increasing of v r to 6 and 7 due to the co existence of multiple spectral peaks in the streamwise direction the motion trajectories of the four cylinders are the irregular figure 8 however different from the case of v r 3 the motion trajectory is not symmetrical about the y axis compared to the low reduced velocities v r 8 the spectral peaks of the streamwise displacements are occurred at relatively low frequencies at v r 8 leading to the irregular motion trajectories for the downstream cylinders 2 and 3 when α increases to 15 the motion trajectory for each cylinder presents a raindrop shape with the same streamwise and transverse oscillation frequencies at low reduced velocity v r 3 with increasing of v r from 5 to 8 the upstream cylinders 1 and 4 exhibit irregular figure 8 shapes however the downstream cylinders 2 and 3 exhibit different motion trajectories with increasing of v r where the motion trajectories of the downstream cylinders 2 and 3 present a regular oval shape at v r 4 and become irregular at v r 5 then become to figure 8 shape at v r 6 when v r 8 the trajectory motions of the four cylinders become chaotic and irregularly moreover the oscillation amplitude of the cylinders 2 and 3 are larger than those of the cylinders 1 and 4 since cylinders 2 and 3 are located in the near wake of the cylinders 1 and 4 at incident angle α 30 due to the complex interactions among the four cylinders even at the same reduced velocity the motion trajectories of four cylinders are different from each other the motion trajectories of cylinders 1 and 4 show oblique raindrop shapes at v r 3 and crescent shapes at v r 4 irregular figure 8 shape occurs at 5 v r 7 when v r is larger than 7 the motion trajectories of cylinders 1 and 4 become complicated and chaotic the motion trajectory of cylinder 2 behaves complicated and difficult to be described except at v r 3 the cylinder 3 exhibits an oblique figure 8 shape at v r 3 with further increases of v r the motion trajectory of cylinder 3 changes to an inverted raindrop shape at v r 5 and an oblique inverted raindrop shape at v r 6 and 7 the enclosed loops are observed at v r 8 where the irregular motion trajectories may be caused by the multiple frequencies f x with a further increase of α to 45 the four cylinders exhibit different trajectory responses at different reduced velocities especially for cylinder 2 at low reduced velocity v r 3 an oblique figure 8 shape is observed with large vibration amplitude for cylinder 2 at v r 6 the motion trajectory of cylinder 2 is a raindrop shape and changes to a figure 8 shape at v r 7 at v r 8 the motion trajectory of cylinder 2 appears to be very chaotic with irregular shapes moreover due to the symmetrical arrangement of cylinders 1 and 3 the motion trajectories of cylinders 1 and 3 appear to be in opposite directions at the examined reduced velocities for example at v r 5 7 the trajectories with a raindrop and inverted raindrop shapes are observed for cylinder 1 and 3 respectively 3 4 wake flow patterns the instantaneous vorticity contours of four cylinders at different reduced velocities and incident angles are presented in figs 16 19 it can be seen that the incident angles and reduced velocities play important roles in fluid dynamic behaviors the regular von karman vortex shedding is mainly observed behind the upstream cylinders however due to lying in the wake of upstream cylinders the downstream cylinders encounter unsteady inflows at α 0 as shown in fig 16 the four cylinders could be considered as two tandem cylinder arrays different wake flow patterns are observed with variations of the reduced velocities at low reduced velocity v r 3 similar to the case of stationary cylinders two parallel vortex shedding modes symmetrical with respect to the wake centerline y 0 are observed in the wake region of the downstream cylinders resulting into small drag force coefficient and vibration amplitudes at v r 6 and 7 a 2s vortex shedding pattern is observed behind the downstream cylinders compared to that of stationary cylinders the process of the generation growth disappearance of vortices appears closer to the four cylinders when the cylinders undergo vortex induced vibrations in agreement with experiments of kim et al 2018 the vortices shed from the top side cylinders are synchronized with the vortices shed from the bottom side cylinders and the vortices shed from the upstream cylinders always impinge on the downstream cylinders leading to the large vibration amplitudes in the cross flow direction for the downstream cylinders as v r increases to 9 corresponding to the irregular trajectories shown in fig 12 the vibration amplitudes of the upstream cylinders become very small indicating the outside the lock in region the downstream cylinders 2 and 3 still experience large vibration amplitudes due to the synchronization of shed vortices and impingement of the vortices shed from the upstream cylinders at large reduced velocities v r 12 the anti phase vortex shedding mode is observed behind the four cylinders where the vortices from the top side cylinders and bottom side cylinders are shed simultaneously with the opposite signs when α increases to 15 and 30 the vortex shedding patterns appear to be more complex than those at α 0 at α 15 when v r 6 two vortex streets are observed behind each downstream cylinder corresponding to the regular and periodic vibrations shown in fig 13 at v r 9 the vortices shed from the downstream cylinders appear to be elongated due to the impingement of the vortices shed from the upstream cylinders the downstream cylinders exhibit irregular vibrations at α 30 multiple shed vortices with strong interactions are observed behind the downstream cylinders the amalgamation phenomenon of the vortices with the same sign are observed behind the downstream cylinders 2 and 3 the vortices shed from both the upstream cylinders 1 and 4 impinge on the downstream cylinder 2 resulting into the large vibration amplitudes of the downstream cylinder 2 due to the weak interference of the vortices shed from cylinders 1 and 4 on cylinder 3 both the transverse and streamwise vibration amplitudes of cylinder 3 are smaller than those of cylinder 2 with further increases of α to 45 the interferences among the four cylinders become weak the vortices shed from the upstream cylinder 4 are always impinged on the downstream cylinder 2 however the cylinder 3 encounters little influence of the other cylinders corresponding to the reduction of the vibration amplitudes the vortices shed from cylinders 1 and 3 appear to be in in phase mode at most of the reduced velocities and have little effect on the downstream cylinder 2 4 conclusions the two dimensional numerical simulations have been performed to study the two degree of freedom vortex induced vibration of four circular cylinders in a square arrangement the effects of incidence angles and reduced velocities on the dynamic responses and vortex shedding modes of the four cylinders are investigated the conclusions are summarized as follows 1 due to the complex interferences among the four cylinders the variations of the dynamic responses with reduced velocities appear to be more complicated than that of an isolated cylinder the incident angle α is found to have a significant effect on the dynamic responses of the downstream cylinders rather than the upstream cylinders with increasing of α the maximum transverse and streamwise amplitudes of cylinder 2 are approximately to be larger than the other three cylinders 2 at all the examined incident angles the lock in regimes for the downstream cylinders are wider than those of upstream cylinders especially for cylinder 2 two predominant vibration frequencies are observed at 8 v r 11 one of which is synchronized with the natural frequency of the cylinder with increasing of α the lock in regime of v r for cylinder 3 becomes narrowed outside of the lock in regime the vibration frequency increases with reduced velocity for each cylinder 3 for all the examined incident angles α the mean drag coefficients of four cylinders generally increase with reduced velocity and then slightly decrease the mean lift coefficients of four cylinders behave differently with increasing of α especially for v r 8 moreover the variations of the root mean square lift and drag coefficients c d c l of cylinder 2 appear to be more sensitive to the incident angle than the other cylinders 4 the incident angle plays an important role in the motion trajectories and vortex shedding modes for the four cylinders at α 15 and 30 due to the enhanced wake flow interferences the complex vortex structures such as the vortex elongation impingement and vortices amalgamation with the same sign are observed behind the downstream cylinders 2 and 3 with further increases of α to 45 the interactions among the four cylinders become weak resulting into the reduction of the vibration amplitudes for cylinder 3 acknowledgements this research was supported by joint key funds of zhejiang provincial natural science foundation of china and powerchina huadong engineering corporation limited grant no lhz19e090004 national natural science foundation of china grant no 51409231 scientific research foundation for the returned overseas chinese scholars state education ministry no 1685 2014 
22962,this paper investigates the trajectory tracking control problem of an underactuated autonomous underwater vehicle in the present of output constraints and environmental disturbances the designed controller can ensure that the output errors will never violate constraint limitations and solve the singularity problem in the design process by employing barrier lyapunov function backstepping algorithm combined with radial basis function neural network for solving external disturbances and the dynamic surface control technique for handling the calculation of explosion problem is introduced to design the control laws then a stability analysis based on lyapunov directly method proves that all signals are bounded and tracking errors converge to a neighborhood of the origin at last simulation results illustrate the effectiveness and feasibility of the proposed controller keywords barrier lyapunov function output constraints underactuated autonomous underwater vehicle trajectory tracking neural networks 1 introduction in recent decades the studies and developments of underwater vehicle especially autonomous underwater vehicle auv have attracted extensive attentions as the marine resources marine environments and marine military missions became the research hotpot and challenge target of scientists the application demand of auv has became more and more significant the marine environment is complex and changeable while auv can replace humans in performing unpredictable and dangerous marine operations auv have important application value in the fields of search rescue surveillance reconnaissance and exploration pipeline construction ocean floor survey marine surveying and mapping geological sampling resource development deep sea archaeology etc xiang et al 2017a in view of this scientists have made great efforts to develop auv to overcome various maritime challenges interested readers can refer to the survey reports zeng et al 2015 zeng et al 2016 yuh 2000 xiang et al 2018 for further information on this topic tracking control problem in the auv cotrol field has been widely researched however owing to uncertain model parameters uncertain nonlinearities and external disturbances caused by the winds waves and other ocean currents it is difficult to design the tracking controller design of auv an adaptive nonlinear control method for auv without any restricting condition on pitch angle was proposed in li and lee 2005 the adaptive method was also applied in sahu and sahu 2014 to solve the uncertain parameters problem in ismail et al 2016 researchers combined adaptive method with sliding mode control method to design the tracking control algorithm which was also applied in cui et al 2016 in addition the interference from external environment on the vehicle is one of the factors that must be considered during the design process of the controller in peng et al 2015a peng et al 2015b and peng et al 2014 the adaptive containment controllers based on predictor dynamic surface and neural networks were designed to solve the tracking problem when the multiple auvs were affected by both model parameters uncertainties and unknown time varying external disturbances and the tracking controller based on backstepping method combined with disturbance observer was designed in ye et al 2017 however the aforementioned works were not designed for underactuated auv in fact the control of underactuated auv is more difficult and complicated due to the lack of independent propellers and rudders in all degrees of freedom hence the tracking control problem of underactuated auv poses considerable challenges to designers scholars have proposed some control schemes for auv tracking problems peng and wang 2018 bechlioulis et al 2017 liu et al 2015 among which the sliding mode method is effective for the design of auv trajectory tracking controller in elmokadem et al 2017 and he ming et al 2012 controller based on terminal sliding mode were proposed to solve the trajectory tracking problem of underactuated auv considering system uncertainties on the basis of sliding mode method academics have improved algorithms to promise the controllers can achieve better performance such as the adaptive second order sliding mode controller zhang et al 2018a xiang et al 2017b and the sliding mode controller combining backstepping technique xu et al 2015 fuzzy control is another effective method to deal with uncertainties in chu et al 2018 researchers developed a novel adaptive fuzzy sliding mode controller for the diving control of auv with input constraint backstepping method is a recursive design method first proposed in 1991 by kanellakopoulos etc it has been widely used in the control field because of its inception including the control field of auv li and lee 2009 yu and xiang 2016 qi and cai 2017 liang et al 2018 liang et al 2016 xiang et al 2015 scholars proposed a leader following formation tracking controller based on filter backstepping for multiple auv in qi and cai 2017 an adaptive tracking controller based on backstepping method for auv with parametric uncertainties was presented in rezazadegan et al 2015 on this basis shojaei and dolatshahi 2017 added neural network technology to cope with external disturbances in ghommam and saad 2014 a new implementable cooperative adaptive backstepping controllers was designed for a group of underactuated auv all those methods were used to design reliable and effective tracking controllers and were popularized because they are easy to be understood and apply however those controller based on backstepping method have to face the singularity problem in fact many algorithms require output errors to satisfy some constraint requirements during the design process to avoid singularity once the constraint conditions are violated the performance of the controller will decrease or even lose efficacy elhaki and shojaei 2018 however those works did not take into account the problem of control in case of output constraints and did t provide a strict theoretical basis to show that these constraints will never be violated on the other hand for security reasons output constraints issue is one of the problems that cannot be ignored in practice zhang et al 1049 zhang et al 2018b when auv works underwater it is inevitable to be limited by output constraints the complicated and changeable marine environment conprises reefs ditches and coral clumps the environmental constraints on auv mean that it cannot act arbitrarily in underwater space when it passes through narrow areas such as reef gaps and ditches its position and displacement are severely restricted by both sides of the channel when the position error is too large it may lead to collision accident of auv in addition the power generated by the actuator is constrained by the limitations of the mechanical system when the angle errors become excessive for one thing the actuator will be damaged due to overload for another the actuator cannot correct the errors quickly so the excessive angle errors lead to increased position error causing auv to deviate from the track this makes it necessary to further study the auv system with output constraints in this paper we consider the tracking problem for underactuated auv with output constraints and uncertainties a backstepping based controller combining dsc and rbfnn technique is designed to promise that output constraints will remain unviolated the main contributions of this paper are expressed as follows firstly the constraint problems on position error pitch angle error and yaw angle error are tackled by using blf based backstepping method then we employ dsc technique to reduce the calculation of explosion problem existing in the traditional backstepping method finally the rbfnn algorithm is proposed to estimate and compensate the environment uncertainties and lyapunov s direct method is applied to analyze the stability of control system it is proved that the tracking errors are uniformly ultimately bounded and converge to a small neighborhood of zero the rest of this paper is organized as follows the problem statement and several useful assumptions and lemmas are presented in next section in section 3 the design process of controller is introduced in detail simulation results and comparisons are provided in section 4 conclusion is given in section 5 2 problem formulation 2 1 underactuated underwater vehicle modeling in this paper we consider 5 degree of freedom dof model of an underactuated auv which is subjected to environmental disturbances do and pan 2009 the frame of auv is shown as fig 1 the mathematical model of auv can be described as 1 x u cos ψ cos θ v sin ψ w sin θ cos ψ y u sin ψ cos θ v cos ψ w sin θ sin ψ z u sin θ w cos θ θ q ψ r cos θ 2 u m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u d u v m 11 m 22 u r d 22 m 22 v d v w m 11 m 33 u q d 33 m 33 w d w q m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 1 m 55 τ q d q r m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r d r where x y z defines the position of auv and θ ψ defines the orientation of vehicle in the inertial reference frame irf u v w q r represents the surge velocity sway velocity heave velocity pitch velocity and yaw velocity respectively the available controls τ u τ q and τ r represent the surge control force pitch control force and yaw control force which are provided by propellers and thrusters d u d v d w d q d r are unknown environmental disturbances caused by wind waves and ocean currents m i i i 1 6 denote the added masses and the inertia of vehicle d i i i 1 6 denote the hydrodynamic parameters ρ g is the buoyancy of auv and g m l is the vertical distance between center of gravity and center of buoyancy fossen 2002 remark 1 the roll motion dynamics have been neglected in system models 1 and 2 actually there exists a metacentric height between centers of gravity and buoyancy which can generate an enough large restoring force to stabilize the roll oscillation so in practice when auv is working at low speed above models are valid do and pan 2009 remark 2 the auv has only three available inputs τ u τ q and τ r it lacks independent control inputs in the velocities w and v directions thus the velocities w and v are uncontrollable and that why we call it underactuated next we define the position and orientation tracking errors in order to facilitate the controller design in next section the position coordinate errors are defined in the body fixed frame bff as follows 3 x e x x d cos θ cos ψ y y d cos θ sin ψ z z d sin θ y e x x d sin ψ y y d cos ψ z e x x d sin θ cos ψ y y d sin θ sin ψ z z d cos θ where x d y d z d is the desired position coordinate generated by desired trajectory differentiating 3 one obtains the first derivative of error variables 4 x e u q z e r y e x d cos θ cos ψ y d cos θ sin ψ z d sin θ y e v r x e z e tan θ x d sin ψ y d cos ψ z e w q x e r y e tan θ x d sin θ cos ψ y d sin θ sin ψ z d cos θ then we define the tracking position error ρ e pitch angle error θ e and yaw angle error ψ e as 5 ρ e x e 2 y e 2 z e 2 θ e arctan 2 z e x e 2 y e 2 ψ e arctan 2 y e x e combining equations 3 and 5 we can obtain the following formula 6 x e ρ e cos θ e cos ψ e y e ρ e cos θ e sin ψ e z e ρ e sin θ e 2 2 rbfnn approximation suppose there exists an unknown continuous function f x r m r and it can be approximated with the following rbfnn 7 f x w t ξ x ε w is defined as follows 8 w arg min w ˆ sup x r m f x w ˆ t ξ x where x r m represents the input vector w r l denotes the optimal weight vector ξ x ξ 1 x ξ l x t r m r l represents the radial basis function vector l is the node number of rbfnn ε is the approximation error w ˆ is the estimation of w the element of ξ x cam be chosen as the gaussian function 9 ξ i x exp x μ i t x μ i σ i 2 l 1 l where μ i is the center of basic function σ i is the width of ξ i x 2 3 lemmas and assumptions then we give some theorems and assumptions which are great helpful to the controller design assumption 1 the sway velocity and heave velocity are passive bounded in the sense that sup t 0 v v m and sup t 0 w w m where v m and w m are unknown constants remark 3 it seems that assumption 1 is too restrictive however as mentioned in shojaei and dolatshahi 2017 fossen 2002 and li et al 2008 it is easy to verify that assumption 1 is always satisfied because the hydrodynamic damping forces are dominant in sway and heave directions in equation 2 these velocities are damped out by such forces thus above assumption is realistic detailed discussions about reality of assumption 1 are shown in above works assumption 2 the reference trajectory is chosen to guarantee that x d x d x d y d y d y d z d z d z d are all bounded assumption 3 all uncertainty signals are bounded such that d i λ i max i u v w q r where λ i max are unknown positive constants assumption 4 the pitch angle θ of auv satisfies θ π 2 remark 4 assumption 3 is not without foundation according to the literature do and pan 2009 and fossen 2002 auv is not likely to come in a neighborhood of θ π 2 in practice because of the existence of metacentric restoring forces lemma 1 kengpeng and sam 2009 for any constants k a 0 k b 0 let z 1 z 1 r k a z 1 k b r and n v r l 1 k a r l v k b r l r l 1 be open sets consider the following system η h t η where η w z 1 t n then we define h r n r l 1 h is piecewise continuous in t locally lipschitz in z and uniformly in t on r n assume that functions u r l r and v 1 z 1 r are continuously differentiable and positive definite in their own domains then we have as z 1 k a or z 1 k b γ 1 w u w γ 2 w where γ 1 and γ 2 are both class k functions denotes the 2 norm of a vector now let v η v 1 z 1 u w and the initial state z 1 0 belongs to the set z 1 k a k b if the following inequality holds v v η h 0 then we can ensure that z 1 t remains in the set z 1 k a k b t 0 lemma 2 tee et al 2011 for all γ γ k γ k γ 0 and any integer σ 0 the following inequality always holds log k γ k γ γ 2 σ γ 2 σ k γ γ 2 σ 2 4 control objective for the smooth reference trajectory x d y d z d the control objective in this paper is to design the input signals τ u τ q and τ r based on blf such that 1 the auv tracks the desired trajectory x d y d z d successfully 2 the tracking errors ρ e θ e and ψ e will never violate the constraints defined by blf and finally converge to a small neighborhood of the zero in the sense of environmental disturbances 3 the uncertainties d i i u v w q r caused by wave wind and ocean currents can be estimated and compensated by rbfnn remark 5 the singularity problem is involved in the design process of the actual control law when cos θ e or cos ψ e is the denominator of the control law and the value is equal to zero the controller is invalidated thus the output constraints need to be taken into consideration the main reason for restraining position error ρ e comes from the consideration of the actual heading situation in order to avoid the auv from hitting the obstacles such as reefs it is necessary to ensure that the position error is within a small range 3 controller design in this section a tracking controller based on blf dsc and rbfnn is designed for auv the surge force τ u pitch torque τ q and yaw torque τ r are available inputs provided by propellers and thrusters so we design the control laws based on backstepping method for τ u τ q and τ r individually to guarantee the closed loop system is uub the design procedures for τ u τ q and τ r will be divided into two stages as follows we design the virtual control laws in the first stage and dsc technique is used instead of differential derivation to avoid the calculation of expansion problem existing in traditional backstepping method in the second stage the actual control laws are designed rbfnn technique is applied to estimate and compensate the uncertainty items finally the stability of closed loop system will be analyzed by using lyapunov s second method 3 1 design of surge motion as mentioned when auv can only pass through narrow channels due to environmental factors it is necessary to constrain the position error ρ e to prevent collision of vehicle choose the following blf candidate as 10 v u e 1 2 log k a 2 k a 2 ρ e 2 where log denotes the natural logarithm of and k a is the constraint on ρ e which means we require ρ e k a it can be shown that v u e is a positive definite function and continuous in the set ρ e k a remark 6 it is obvious that ρ e is non negative according to formula 5 so the constraint ρ e k a is actually equivalent to constraint 0 ρ e k a which means k a is the upper bound on ρ e in order to ensure that our constraint on position error is of practical significance usually the selection of k a cannot be too large differentiating v u e and combining equation 6 we have 11 v u e ρ e ρ e k a 2 ρ e 2 1 k a 2 ρ e 2 x e x e y e y e z e z e ρ e k a 2 ρ e 2 u cos θ e cos ψ e v cos θ e sin ψ e w sin θ e cos θ e cos ψ e x d cos θ cos ψ y d cos θ sin ψ z d sin θ cos θ e sin ψ e x d sin ψ y d cos ψ sin θ e x d sin θ cos ψ y d sin θ sin ψ z d cos θ let u α u u e where α u is the virtual control law for u then we design α u as 12 α u cos θ e cos ψ e 1 k ρ ρ e v cos θ e sin ψ e w sin θ e cos θ e cos ψ e x d cos θ cos ψ y d cos θ sin ψ z d sin θ cos θ e sin ψ e x d sin ψ y d cos ψ sin θ e x d sin θ cos ψ y d sin θ sin ψ z d cos θ where design parameter k ρ is a positive constant remark 7 it is easy to see from equation 12 that α u is invalid when θ e π 2 or ψ e π 2 that is one of the reasons owing to which we limit these errors to θ e k b π 2 and ψ e k c π 2 constraints on θ e and ψ e will be specified later remark 8 equation 12 shows that the derivation of α u is quite complicated for the purpose of reducing the amount of calculation and avoid the complexity of traditional derivation we introduce dsc technology for derivation substituting equation 12 into 11 we have the simplified v u e as 13 v u e 1 k a 2 ρ e 2 k ρ ρ e 2 ρ e u e cos θ e cos ψ e where the coupling term ρ e u e cos θ e cos ψ e will be canceled in subsequent step to avoidthe calculation of expansion problem existing in traditional backstepping algorithm we use dsc method instead of differential derivation in next step the virtual control law α u is passed through a first order filter with time constant κ u 14 κ u α u c α u c α u α u c 0 α u 0 α u c α u α u c κ u where α u c is the filtered virtual control law then we can substitute α u c for α u in following steps since u e has no need to be constrained the quadratic lyapunov function qlf is chosen as follows in next step 15 v u e 2 v u e 1 2 u e 2 1 2 log k a 2 k a 2 ρ e 2 1 2 u e 2 the time derivative of v u e 2 is given by 16 v u e 2 v u e u e u e 1 k a 2 ρ e 2 k p ρ e 2 u e ρ e cos θ e cos ψ e u e u e 1 k a 2 ρ e 2 k p ρ e 2 u e ρ e cos θ e cos ψ e u e α u c u 1 k a 2 ρ e 2 k p ρ e 2 u e ρ e cos θ e cos ψ e u e α u c m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u d u 1 k a 2 ρ e 2 k p ρ e 2 u e ρ e cos θ e cos ψ e u e α u c m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u d u then we can proposed following surge control law 17 τ u k u u e α u c ρ e cos θ e cos ψ e k a 2 ρ e 2 m 22 m 11 v r m 33 m 11 w q d 11 m 11 u w ˆ u t ξ u x u m 11 18 w ˆ u k w u ξ u x u u e k w u k w w ˆ u where x u u v w q r α u c t k u k w u k w are positive design parameters 3 2 design of pitch motion the constraint condition θ e π 2 should never be violated in the design process of virtual control laws otherwise the virtual laws will be fall according to equation 12 it is also necessary to limit θ e in practice based on the previous discussions based on above considerations we choose following blf candidate as 19 v q e 1 2 log k b 2 k b 2 θ e 2 where k b π 2 is the constraint on θ e the derivative of v q e satisfies 20 v q e θ e θ e k b 2 θ e 2 θ e k b 2 θ e 2 q cos ψ e r tan θ sin ψ e cos θ e w x d sin θ cos ψ y d sin θ sin ψ z d cos θ ρ e sin θ e cos ψ e u x d cos θ cos ψ y d cos θ sin ψ z d sin θ ρ e sin θ e sin ψ e v x d sin ψ y d cos ψ ρ e let q α q q e where α q is the virtual control law take the following α q into account for the pitch motion 21 α q cos ψ e 1 k θ θ e r tan θ sin ψ e cos θ e w x d sin θ cos ψ y d sin θ sin ψ z d cos θ ρ e sin θ e cos ψ e u x d cos θ cos ψ y d cos θ sin ψ z d sin θ ρ e sin θ e sin ψ e v x d sin θ cos ψ y d sin θ sin ψ z d cos θ ρ e where design parameter k ρ 0 is a constant it s easy to get simplified v q e by combining equations 20 and 21 as 22 v q e 1 k b 2 θ e 2 k θ θ e 2 q e θ e cos ψ e the virtual control law α q is passed through a first order filter with time constant κ q to prevent the calculation of expansion problem 23 κ q α q c α q c α q α q c 0 α q 0 α q c α q α q c κ q where α q c is the filtered virtual control law and we can substitute α q c for α q then we choose the qlf as follows 24 v q e 2 1 2 log k b 2 k b 2 θ e 2 1 2 q e 2 by differentiating v q e 2 one achieves 25 v q e 2 v q e q e q e 1 k b 2 θ e 2 k θ θ e 2 q e θ e cos ψ e q e α q c q 1 k b 2 θ e 2 k θ θ e 2 q e θ e cos ψ e q e α q c m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 1 m 55 τ q d q 1 k b 2 θ e 2 k θ θ e 2 q e θ e cos ψ e q e α q c m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 1 m 55 τ q d q finally the following pitch control law is proposed 26 τ q k q q e θ e cos ψ e k b 2 θ e 2 α q c m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 w ˆ q t ξ q x q m 55 27 w ˆ q k w q ξ q x q q e k w q k w 2 w ˆ q where x q u w q α q c t k q k w q k w 2 are positive design parameters 3 3 design of yaw motion similar to the design process of pitch motion the design process of yaw motion also requires constraint on ψ e so we choose following blf candidate as 28 v r e 1 2 log k c 2 k c 2 ψ e 2 where k c π 2 is the constraint on ψ e which promises that the limitation ψ e π 2 will never be violated the derivative of v r e is 29 v r e ψ e ψ e k c 2 ψ e 2 ψ e k c 2 ψ e 2 r 1 tan θ tan θ e cos ψ e q tan θ e sin ψ e v x d sin ψ y d cos ψ cos ψ e ρ e cos θ e u x d cos θ cos ψ y d cos θ sin ψ z d sin θ sin ψ e ρ e cos θ e let r α r r e where α r is the virtual control law choose the following α r for the yaw motion 30 α r 1 tan θ tan θ e cos ψ e 1 k ψ ψ e q tan θ e sin ψ e v x d sin ψ y d cos ψ cos ψ e ρ e cos θ e u x d cos θ cos ψ y d cos θ sin ψ z d sin θ sin ψ e ρ e cos θ e where design parameter k ψ 0 is a constant remark 9 in order to prevent possible singularity of the proposed virtual law 30 the condition tan θ tan θ e cos φ e 1 should be satisfied referring to shojaei and dolatshahi 2017 by setting k θ k ρ k ψ k ρ singularity is avoidable the simplified v r e can be obtained as follows 31 v r e 1 k c 2 ψ e 2 k ψ ψ e 2 r e ψ e 1 tan θ tan θ e cos ψ e the virtual control law α r is passed through a first order filter as follows 32 κ r α r c α r c α r α r c 0 α r 0 α r c α r α r c κ r where κ r 0 is the time constant parameter α r c is the filtered virtual control law then the qlf is considered in next step 33 v r e 2 1 2 log k c 2 k c 2 ψ e 2 1 2 r e 2 by differentiating v r e 2 we have 34 v r e 2 v r e r e r e 1 k c 2 ψ e 2 k ψ ψ e 2 r e ψ e 1 tan θ tan θ e cos ψ e r e α r c r 1 k c 2 ψ e 2 k ψ ψ e 2 r e ψ e 1 tan θ tan θ e cos ψ e r e α r c m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r d r 1 k c 2 ψ e 2 k ψ ψ e 2 r e ψ e 1 tan θ tan θ e cos ψ e r e α r c m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r d r finally the yaw torque is designed as 35 τ r k r r e α r c m 11 m 22 m 66 u v d 66 m 66 r ψ e ψ e tan θ tan θ e cos ψ e k c 2 ψ e 2 w ˆ r t ξ r x r m 66 36 w ˆ r k w r ξ r x r r e k w r k w 3 w ˆ r where x r u v r α r c t k r k w r k w 3 are positive design parameters theorem 1 consider the trajectory tracking problem for underactuated auv denoted by 1 and 2 under assumptions 1 4 lemma 1 2 and output constraints requirements if gain parameters satisfy k u 0 25 k p 0 25 k r 0 25 κ u 1 κ q 1 κ r 1 and the initial errors satisfy 0 ρ e k a θ e k b and ψ e k c then the proposed controllers 12 14 17 18 21 23 26 27 30 32 35 and 36 guarantee that all signals in the closed loop system are bounded the constraints 0 ρ e k a θ e k b and ψ e k c will remain unviolated during the whole process and tracking errors are uub and finally converge to an neighborhood of zero proof before beginning the proof we introduce the inequalities w i t w ˆ i c 1 w i f 2 c 2 w i f 2 c 1 1 0 5 ι 2 c 2 0 5 ι 2 and ι 2 2 shojaei and dolatshahi 2017 that will be used later then we define filters output errors as α u α u c α u α q α q c α q α r α r c α r whose derivatives are expressed as follows 37 α i α i c α i α i κ i d α i d t α i κ i b i i u q r where b i i u q r are continuous functions with a maximum applying young s inequality a b λ 2 a 2 4 b 2 λ 2 on equation 37 we have 38 α i α i α i 2 κ i α i d α i d t α i 2 κ i α i b i α i 2 κ i α i 2 b i 2 4 i u q r then choose the lyapunov function expressed as 39 v 1 2 log k a 2 k a 2 ρ e 2 u e 2 log k b 2 k b 2 θ e 2 q e 2 log k c 2 k c 2 ψ e 2 r e 2 α u 2 α q 2 α r 2 w u t w u k w u w q t w q k w q w r t w r k w r where w i w i w ˆ i i u q r denote optimal weight estimation errors the time derivative of 39 is v k ρ ρ e 2 k a 2 ρ e 2 k u u e 2 k θ θ e 2 k b 2 θ e 2 k q q e 2 k ψ ψ e 2 k c 2 ψ e 2 k r r e 2 u e w u t ξ u x u q e w q t ξ q x q r e w r t ξ r x r u e d u q e d q r e d r α u α ˆ u α q α ˆ q α r α ˆ r w u t w ˆ u k w u w q t w ˆ q k w q w r t w ˆ r k w r k ρ ρ e 2 k a 2 ρ e 2 k u u e 2 k θ θ e 2 k b 2 θ e 2 k q q e 2 k ψ ψ e 2 k c 2 ψ e 2 k r r e 2 u e w u t ξ u x u q e w q t ξ q x q r e w r t ξ r x r u e λ u max q e λ q max r e λ r max α u α ˆ u α q α ˆ q α r α ˆ r w u t ξ u x u u e k w w ˆ u w q t ξ q x q q e k w 2 w ˆ q w r t ξ r x r r e k w 3 w ˆ r k ρ ρ e 2 k a 2 ρ e 2 k u u e 2 k θ θ e 2 k b 2 θ e 2 k q q e 2 k ψ ψ e 2 k c 2 ψ e 2 k r r e 2 u e λ u max q e λ q max r e λ r max α u α ˆ u α q α ˆ q α r α ˆ r k w w u t w ˆ u k w 2 w q t w ˆ q k w 3 w r t w ˆ r k ρ ρ e 2 k a 2 ρ e 2 k u u e 2 k θ θ e 2 k b 2 θ e 2 k q q e 2 k ψ ψ e 2 k c 2 ψ e 2 k r r e 2 0 25 u e 2 λ u max 2 0 25 q e 2 λ q max 2 0 25 r e 2 λ r max 2 α u 2 κ u α u 2 0 25 b u α q 2 κ q α q 2 0 25 b q α r 2 κ r α r 2 0 25 b r k w w u t w ˆ u k w 2 w q t w ˆ q k w 3 w r t w ˆ r k ρ log k a 2 k a 2 ρ e 2 k u u e 2 k θ log k b 2 k b 2 θ e 2 k q q e 2 k ψ log k c 2 k c 2 ψ e 2 k r r e 2 0 25 u e 2 λ u max 2 0 25 q e 2 λ q max 2 0 25 r e 2 λ r max 2 α u 2 κ u α u 2 0 25 b u α q 2 κ q α q 2 0 25 b q α r 2 κ r α r 2 0 25 b r k w c 1 w u f 2 c 2 w u f 2 k w 2 c 1 w q f 2 c 2 w q f 2 k w 3 c 1 w r f 2 c 2 w r f 2 k ρ log k a 2 k a 2 ρ e 2 k u 0 25 u e 2 k θ log k b 2 k b 2 θ e 2 k q 0 25 q e 2 k ψ log k c 2 k c 2 ψ e 2 k r 0 25 r e 2 1 κ u 1 α u 2 1 κ q 1 α q 2 1 κ r 1 α r 2 k w c 1 w u f 2 k w 2 c 1 w q f 2 k w 3 c 1 w r f 2 λ u max 2 λ q max 2 λ r max 2 0 25 b u 0 25 b q 0 25 b r 40 k w c 2 w u f 2 k w 2 c 2 w q f 2 k w 3 c 2 w r r 2 then if conditions mentioned in theorem 1 are satisfied we can obtain the following inequality 41 v γ v ζ where γ 0 and ζ 0 satisfy 42 γ min 2 k ρ 2 k θ 2 k ψ 2 k u 0 5 2 k q 0 5 2 k r 0 5 2 1 κ u 1 2 1 κ q 1 2 1 κ r 1 k w u k w c 1 k w q k w 2 c 1 k w r k w 3 c 1 43 ζ λ u max 2 λ q max 2 λ r max 2 0 25 b u 0 25 b q 0 25 b r k w c 2 w u f 2 k w 2 c 2 w q f 2 k w 3 c 2 w r r 2 combining equations 41 to 43 we have 44 0 v t ζ γ v 0 ζ γ e γ t remark 10 from equation 42 we can obtain that when the design parameters k ρ k θ k ψ k u k q k r k w u k w k w q k q k w r k r increase and the parameters κ u κ q κ r decrease γ increases thus causing the convergence rate of the controller to increase therefore after selecting the control parameters that satisfy the requirements shown in theorem 1 better control performance can be achieved by adjusting the control parameters from equation 44 we have v t max v 0 ς γ t 0 and then get x t max v 0 ς γ γ min where γ min min 1 1 k w u 1 k w q 1 k w r inequaties 41 and 44 indicate that v t is negative outside the compact set ω x x t 0 x t max v 0 ς γ γ min this means x t is decreasing gradually when x t is outside the set ω x it implies that all the signals included in equation 39 are uniformly ultimately bounded according to the assumptions and the control laws mentioned above we can make the conclusion that x y z θ ψ u q r w ˆ u w ˆ q w ˆ r τ u τ q τ r are all bounded equation 39 shows that v as ρ e k a or θ e k b or ψ e k c clearly so the position error ρ e remains in the set 0 k a the pitch angle error θ e remains in the set k b k b and the yaw angle error ψ e remains in the set k c k c according to lemma 1 4 simulation results some numerical simulation studies are carried out in this section to demonstrate the performance of proposed control method all simulations are performed in matlab software environment referring to shojaei and dolatshahi 2017 we have the following model parameters 45 m 11 25 k g m 22 17 5 k g m 33 30 k g m 55 22 5 k g m 2 m 66 15 k g m 2 d 11 30 k g s 1 d 22 30 k g s 1 d 33 30 k g s 1 d 55 20 k g m 2 s 1 d 66 20 k g m 2 s 1 ρ g g m l 5 the reference trajectory is designed as 46 x d 5 sin 0 2 t 5 cos 0 1 t y d 5 sin 0 1 t 5 cos 0 2 t z d 10 0 1 t 4 1 comparison with qlf the main contribution of proposed method is that we design a reliable tracking controller considering the position error pitch angle error and yaw angle error constraints in this part we verify the output constraints capability of designed controller through the comparative simulation of blf and qlf in the qlf method when the angle error θ e or ψ e reaches π 2 the controller will fail completely because of triggering the singular point so that the auv cannot continue tracking the reference trajectory therefore we take the constraint constraint as θ e k b π 2 and ψ e k b π 2 in the first part of simulation the desired trajectory is selected as equation 46 design parameters for controller are selected as follows 47 k ρ 0 76 k θ 2 0 k ψ 1 6 k u 3 2 k q 2 5 k r 1 5 k a 15 k b π 2 k c π 2 k u k q k r 0 01 k w u k w q k w r 18 k w 2 k w 3 0 5 choose following qlf for the purpose of comparison 48 v q l f 1 2 ρ e 2 u e 2 θ e 2 q e 2 ψ e 2 r e 2 the initial condition is selected as x 0 y 0 z 0 θ 0 ψ 0 u 0 v 0 w 0 q 0 r 0 10 10 5 π 6 0 0 0 0 0 0 then we obtain the following simulation comparison results fig 2 delineates the tracking effect of proposed method fig 3 illustrates the yaw angle error ψ e fig 4 shows the velocities and fig 5 gives the pitch and position errors it can be seen from the figures that under the control based on qlf method ψ e approaches the constraint boundary π 2 causing the controller to fail and unable to track the trajectory while the limitation ψ e π 2 is never been violated by using blf method which proves that the algorithm proposed in this paper is reliable to restrict the constraint conditions 4 2 blf algorithm effect reliability simulation in order to verify controller s performance of tracking the desired trajectory the following simulation is carried out in this part according to equations 41 44 when the design parameters increase the convergence rate of the controller will increase too therefore we choose two groups of blf based controllers with different design parameters under the same system parameters respectively named blf tracking and blf tracking 2 and make the following simulation meanwhile the qlf based control methods with the same design parameters as blf tracking is selected for reference and comparison equation 46 is selected as the reference trajectory the initial condition is selected as x 0 y 0 z 0 θ 0 ψ 0 u 0 v 0 w 0 q 0 r 0 15 10 5 π 10 π 8 0 0 0 0 0 design parameters for controller are selected as figure 6 remark 11 in the first part of simulation section we restricted the output constraints to θ e π 2 and ψ e π 2 to examine the output constraint performance in practice however it is more practical to impose stricter restrictions on output constraints so we set the constraint condition as θ e π 4 and ψ e π 4 simulation results are illustrated in figs 7 12 above simulations give the comparison of blf method with different designed parameters and the comparison between qlf method and blf method with the same parameters trajectory tracking result is demonstrated by figs 7 and 8 fig 9 shows the pitch angle and yaw angle of auv it can be seen that all three controllers ensure the auv successfully tracks the desired trajectory in the presence of external disturbances fig 10 shows that the blf based controller can also converge all the tracking errors to a small ball around zero asymptotically and effectively and the convergence rate of controller with parameters named blf tracking 2 is slightly fatter than that of controller with parameters named blf tracking the velocities u q and r are plotted in fig 11 actual control inputs τ u τ q and τ r are illustrated in fig 12 5 conclusion in this paper a dynamic surface tracking controller based on blf backstepping method and rbfnn technique is designed for underactuated auv the controller guarantees the auv converge to desired trajectory and all of the signals in the closed loop system are bounded output errors will never violate the constraint limitations which greatly protect the system s security performance and finally tend to neighborhood of zero environmental disturbances are estimated and conpensated by using rbfnn technique dsc technology solves the problem of computational explosion and greatly improves the efficiency of the controller finally simulation results show the controller proposed effectiveness clearly acknowledgements this work was supported by the national natural science foundation of china under grant 61503010 and 61703018 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 023 
22962,this paper investigates the trajectory tracking control problem of an underactuated autonomous underwater vehicle in the present of output constraints and environmental disturbances the designed controller can ensure that the output errors will never violate constraint limitations and solve the singularity problem in the design process by employing barrier lyapunov function backstepping algorithm combined with radial basis function neural network for solving external disturbances and the dynamic surface control technique for handling the calculation of explosion problem is introduced to design the control laws then a stability analysis based on lyapunov directly method proves that all signals are bounded and tracking errors converge to a neighborhood of the origin at last simulation results illustrate the effectiveness and feasibility of the proposed controller keywords barrier lyapunov function output constraints underactuated autonomous underwater vehicle trajectory tracking neural networks 1 introduction in recent decades the studies and developments of underwater vehicle especially autonomous underwater vehicle auv have attracted extensive attentions as the marine resources marine environments and marine military missions became the research hotpot and challenge target of scientists the application demand of auv has became more and more significant the marine environment is complex and changeable while auv can replace humans in performing unpredictable and dangerous marine operations auv have important application value in the fields of search rescue surveillance reconnaissance and exploration pipeline construction ocean floor survey marine surveying and mapping geological sampling resource development deep sea archaeology etc xiang et al 2017a in view of this scientists have made great efforts to develop auv to overcome various maritime challenges interested readers can refer to the survey reports zeng et al 2015 zeng et al 2016 yuh 2000 xiang et al 2018 for further information on this topic tracking control problem in the auv cotrol field has been widely researched however owing to uncertain model parameters uncertain nonlinearities and external disturbances caused by the winds waves and other ocean currents it is difficult to design the tracking controller design of auv an adaptive nonlinear control method for auv without any restricting condition on pitch angle was proposed in li and lee 2005 the adaptive method was also applied in sahu and sahu 2014 to solve the uncertain parameters problem in ismail et al 2016 researchers combined adaptive method with sliding mode control method to design the tracking control algorithm which was also applied in cui et al 2016 in addition the interference from external environment on the vehicle is one of the factors that must be considered during the design process of the controller in peng et al 2015a peng et al 2015b and peng et al 2014 the adaptive containment controllers based on predictor dynamic surface and neural networks were designed to solve the tracking problem when the multiple auvs were affected by both model parameters uncertainties and unknown time varying external disturbances and the tracking controller based on backstepping method combined with disturbance observer was designed in ye et al 2017 however the aforementioned works were not designed for underactuated auv in fact the control of underactuated auv is more difficult and complicated due to the lack of independent propellers and rudders in all degrees of freedom hence the tracking control problem of underactuated auv poses considerable challenges to designers scholars have proposed some control schemes for auv tracking problems peng and wang 2018 bechlioulis et al 2017 liu et al 2015 among which the sliding mode method is effective for the design of auv trajectory tracking controller in elmokadem et al 2017 and he ming et al 2012 controller based on terminal sliding mode were proposed to solve the trajectory tracking problem of underactuated auv considering system uncertainties on the basis of sliding mode method academics have improved algorithms to promise the controllers can achieve better performance such as the adaptive second order sliding mode controller zhang et al 2018a xiang et al 2017b and the sliding mode controller combining backstepping technique xu et al 2015 fuzzy control is another effective method to deal with uncertainties in chu et al 2018 researchers developed a novel adaptive fuzzy sliding mode controller for the diving control of auv with input constraint backstepping method is a recursive design method first proposed in 1991 by kanellakopoulos etc it has been widely used in the control field because of its inception including the control field of auv li and lee 2009 yu and xiang 2016 qi and cai 2017 liang et al 2018 liang et al 2016 xiang et al 2015 scholars proposed a leader following formation tracking controller based on filter backstepping for multiple auv in qi and cai 2017 an adaptive tracking controller based on backstepping method for auv with parametric uncertainties was presented in rezazadegan et al 2015 on this basis shojaei and dolatshahi 2017 added neural network technology to cope with external disturbances in ghommam and saad 2014 a new implementable cooperative adaptive backstepping controllers was designed for a group of underactuated auv all those methods were used to design reliable and effective tracking controllers and were popularized because they are easy to be understood and apply however those controller based on backstepping method have to face the singularity problem in fact many algorithms require output errors to satisfy some constraint requirements during the design process to avoid singularity once the constraint conditions are violated the performance of the controller will decrease or even lose efficacy elhaki and shojaei 2018 however those works did not take into account the problem of control in case of output constraints and did t provide a strict theoretical basis to show that these constraints will never be violated on the other hand for security reasons output constraints issue is one of the problems that cannot be ignored in practice zhang et al 1049 zhang et al 2018b when auv works underwater it is inevitable to be limited by output constraints the complicated and changeable marine environment conprises reefs ditches and coral clumps the environmental constraints on auv mean that it cannot act arbitrarily in underwater space when it passes through narrow areas such as reef gaps and ditches its position and displacement are severely restricted by both sides of the channel when the position error is too large it may lead to collision accident of auv in addition the power generated by the actuator is constrained by the limitations of the mechanical system when the angle errors become excessive for one thing the actuator will be damaged due to overload for another the actuator cannot correct the errors quickly so the excessive angle errors lead to increased position error causing auv to deviate from the track this makes it necessary to further study the auv system with output constraints in this paper we consider the tracking problem for underactuated auv with output constraints and uncertainties a backstepping based controller combining dsc and rbfnn technique is designed to promise that output constraints will remain unviolated the main contributions of this paper are expressed as follows firstly the constraint problems on position error pitch angle error and yaw angle error are tackled by using blf based backstepping method then we employ dsc technique to reduce the calculation of explosion problem existing in the traditional backstepping method finally the rbfnn algorithm is proposed to estimate and compensate the environment uncertainties and lyapunov s direct method is applied to analyze the stability of control system it is proved that the tracking errors are uniformly ultimately bounded and converge to a small neighborhood of zero the rest of this paper is organized as follows the problem statement and several useful assumptions and lemmas are presented in next section in section 3 the design process of controller is introduced in detail simulation results and comparisons are provided in section 4 conclusion is given in section 5 2 problem formulation 2 1 underactuated underwater vehicle modeling in this paper we consider 5 degree of freedom dof model of an underactuated auv which is subjected to environmental disturbances do and pan 2009 the frame of auv is shown as fig 1 the mathematical model of auv can be described as 1 x u cos ψ cos θ v sin ψ w sin θ cos ψ y u sin ψ cos θ v cos ψ w sin θ sin ψ z u sin θ w cos θ θ q ψ r cos θ 2 u m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u d u v m 11 m 22 u r d 22 m 22 v d v w m 11 m 33 u q d 33 m 33 w d w q m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 1 m 55 τ q d q r m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r d r where x y z defines the position of auv and θ ψ defines the orientation of vehicle in the inertial reference frame irf u v w q r represents the surge velocity sway velocity heave velocity pitch velocity and yaw velocity respectively the available controls τ u τ q and τ r represent the surge control force pitch control force and yaw control force which are provided by propellers and thrusters d u d v d w d q d r are unknown environmental disturbances caused by wind waves and ocean currents m i i i 1 6 denote the added masses and the inertia of vehicle d i i i 1 6 denote the hydrodynamic parameters ρ g is the buoyancy of auv and g m l is the vertical distance between center of gravity and center of buoyancy fossen 2002 remark 1 the roll motion dynamics have been neglected in system models 1 and 2 actually there exists a metacentric height between centers of gravity and buoyancy which can generate an enough large restoring force to stabilize the roll oscillation so in practice when auv is working at low speed above models are valid do and pan 2009 remark 2 the auv has only three available inputs τ u τ q and τ r it lacks independent control inputs in the velocities w and v directions thus the velocities w and v are uncontrollable and that why we call it underactuated next we define the position and orientation tracking errors in order to facilitate the controller design in next section the position coordinate errors are defined in the body fixed frame bff as follows 3 x e x x d cos θ cos ψ y y d cos θ sin ψ z z d sin θ y e x x d sin ψ y y d cos ψ z e x x d sin θ cos ψ y y d sin θ sin ψ z z d cos θ where x d y d z d is the desired position coordinate generated by desired trajectory differentiating 3 one obtains the first derivative of error variables 4 x e u q z e r y e x d cos θ cos ψ y d cos θ sin ψ z d sin θ y e v r x e z e tan θ x d sin ψ y d cos ψ z e w q x e r y e tan θ x d sin θ cos ψ y d sin θ sin ψ z d cos θ then we define the tracking position error ρ e pitch angle error θ e and yaw angle error ψ e as 5 ρ e x e 2 y e 2 z e 2 θ e arctan 2 z e x e 2 y e 2 ψ e arctan 2 y e x e combining equations 3 and 5 we can obtain the following formula 6 x e ρ e cos θ e cos ψ e y e ρ e cos θ e sin ψ e z e ρ e sin θ e 2 2 rbfnn approximation suppose there exists an unknown continuous function f x r m r and it can be approximated with the following rbfnn 7 f x w t ξ x ε w is defined as follows 8 w arg min w ˆ sup x r m f x w ˆ t ξ x where x r m represents the input vector w r l denotes the optimal weight vector ξ x ξ 1 x ξ l x t r m r l represents the radial basis function vector l is the node number of rbfnn ε is the approximation error w ˆ is the estimation of w the element of ξ x cam be chosen as the gaussian function 9 ξ i x exp x μ i t x μ i σ i 2 l 1 l where μ i is the center of basic function σ i is the width of ξ i x 2 3 lemmas and assumptions then we give some theorems and assumptions which are great helpful to the controller design assumption 1 the sway velocity and heave velocity are passive bounded in the sense that sup t 0 v v m and sup t 0 w w m where v m and w m are unknown constants remark 3 it seems that assumption 1 is too restrictive however as mentioned in shojaei and dolatshahi 2017 fossen 2002 and li et al 2008 it is easy to verify that assumption 1 is always satisfied because the hydrodynamic damping forces are dominant in sway and heave directions in equation 2 these velocities are damped out by such forces thus above assumption is realistic detailed discussions about reality of assumption 1 are shown in above works assumption 2 the reference trajectory is chosen to guarantee that x d x d x d y d y d y d z d z d z d are all bounded assumption 3 all uncertainty signals are bounded such that d i λ i max i u v w q r where λ i max are unknown positive constants assumption 4 the pitch angle θ of auv satisfies θ π 2 remark 4 assumption 3 is not without foundation according to the literature do and pan 2009 and fossen 2002 auv is not likely to come in a neighborhood of θ π 2 in practice because of the existence of metacentric restoring forces lemma 1 kengpeng and sam 2009 for any constants k a 0 k b 0 let z 1 z 1 r k a z 1 k b r and n v r l 1 k a r l v k b r l r l 1 be open sets consider the following system η h t η where η w z 1 t n then we define h r n r l 1 h is piecewise continuous in t locally lipschitz in z and uniformly in t on r n assume that functions u r l r and v 1 z 1 r are continuously differentiable and positive definite in their own domains then we have as z 1 k a or z 1 k b γ 1 w u w γ 2 w where γ 1 and γ 2 are both class k functions denotes the 2 norm of a vector now let v η v 1 z 1 u w and the initial state z 1 0 belongs to the set z 1 k a k b if the following inequality holds v v η h 0 then we can ensure that z 1 t remains in the set z 1 k a k b t 0 lemma 2 tee et al 2011 for all γ γ k γ k γ 0 and any integer σ 0 the following inequality always holds log k γ k γ γ 2 σ γ 2 σ k γ γ 2 σ 2 4 control objective for the smooth reference trajectory x d y d z d the control objective in this paper is to design the input signals τ u τ q and τ r based on blf such that 1 the auv tracks the desired trajectory x d y d z d successfully 2 the tracking errors ρ e θ e and ψ e will never violate the constraints defined by blf and finally converge to a small neighborhood of the zero in the sense of environmental disturbances 3 the uncertainties d i i u v w q r caused by wave wind and ocean currents can be estimated and compensated by rbfnn remark 5 the singularity problem is involved in the design process of the actual control law when cos θ e or cos ψ e is the denominator of the control law and the value is equal to zero the controller is invalidated thus the output constraints need to be taken into consideration the main reason for restraining position error ρ e comes from the consideration of the actual heading situation in order to avoid the auv from hitting the obstacles such as reefs it is necessary to ensure that the position error is within a small range 3 controller design in this section a tracking controller based on blf dsc and rbfnn is designed for auv the surge force τ u pitch torque τ q and yaw torque τ r are available inputs provided by propellers and thrusters so we design the control laws based on backstepping method for τ u τ q and τ r individually to guarantee the closed loop system is uub the design procedures for τ u τ q and τ r will be divided into two stages as follows we design the virtual control laws in the first stage and dsc technique is used instead of differential derivation to avoid the calculation of expansion problem existing in traditional backstepping method in the second stage the actual control laws are designed rbfnn technique is applied to estimate and compensate the uncertainty items finally the stability of closed loop system will be analyzed by using lyapunov s second method 3 1 design of surge motion as mentioned when auv can only pass through narrow channels due to environmental factors it is necessary to constrain the position error ρ e to prevent collision of vehicle choose the following blf candidate as 10 v u e 1 2 log k a 2 k a 2 ρ e 2 where log denotes the natural logarithm of and k a is the constraint on ρ e which means we require ρ e k a it can be shown that v u e is a positive definite function and continuous in the set ρ e k a remark 6 it is obvious that ρ e is non negative according to formula 5 so the constraint ρ e k a is actually equivalent to constraint 0 ρ e k a which means k a is the upper bound on ρ e in order to ensure that our constraint on position error is of practical significance usually the selection of k a cannot be too large differentiating v u e and combining equation 6 we have 11 v u e ρ e ρ e k a 2 ρ e 2 1 k a 2 ρ e 2 x e x e y e y e z e z e ρ e k a 2 ρ e 2 u cos θ e cos ψ e v cos θ e sin ψ e w sin θ e cos θ e cos ψ e x d cos θ cos ψ y d cos θ sin ψ z d sin θ cos θ e sin ψ e x d sin ψ y d cos ψ sin θ e x d sin θ cos ψ y d sin θ sin ψ z d cos θ let u α u u e where α u is the virtual control law for u then we design α u as 12 α u cos θ e cos ψ e 1 k ρ ρ e v cos θ e sin ψ e w sin θ e cos θ e cos ψ e x d cos θ cos ψ y d cos θ sin ψ z d sin θ cos θ e sin ψ e x d sin ψ y d cos ψ sin θ e x d sin θ cos ψ y d sin θ sin ψ z d cos θ where design parameter k ρ is a positive constant remark 7 it is easy to see from equation 12 that α u is invalid when θ e π 2 or ψ e π 2 that is one of the reasons owing to which we limit these errors to θ e k b π 2 and ψ e k c π 2 constraints on θ e and ψ e will be specified later remark 8 equation 12 shows that the derivation of α u is quite complicated for the purpose of reducing the amount of calculation and avoid the complexity of traditional derivation we introduce dsc technology for derivation substituting equation 12 into 11 we have the simplified v u e as 13 v u e 1 k a 2 ρ e 2 k ρ ρ e 2 ρ e u e cos θ e cos ψ e where the coupling term ρ e u e cos θ e cos ψ e will be canceled in subsequent step to avoidthe calculation of expansion problem existing in traditional backstepping algorithm we use dsc method instead of differential derivation in next step the virtual control law α u is passed through a first order filter with time constant κ u 14 κ u α u c α u c α u α u c 0 α u 0 α u c α u α u c κ u where α u c is the filtered virtual control law then we can substitute α u c for α u in following steps since u e has no need to be constrained the quadratic lyapunov function qlf is chosen as follows in next step 15 v u e 2 v u e 1 2 u e 2 1 2 log k a 2 k a 2 ρ e 2 1 2 u e 2 the time derivative of v u e 2 is given by 16 v u e 2 v u e u e u e 1 k a 2 ρ e 2 k p ρ e 2 u e ρ e cos θ e cos ψ e u e u e 1 k a 2 ρ e 2 k p ρ e 2 u e ρ e cos θ e cos ψ e u e α u c u 1 k a 2 ρ e 2 k p ρ e 2 u e ρ e cos θ e cos ψ e u e α u c m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u d u 1 k a 2 ρ e 2 k p ρ e 2 u e ρ e cos θ e cos ψ e u e α u c m 22 m 11 v r m 33 m 11 w q d 11 m 11 u 1 m 11 τ u d u then we can proposed following surge control law 17 τ u k u u e α u c ρ e cos θ e cos ψ e k a 2 ρ e 2 m 22 m 11 v r m 33 m 11 w q d 11 m 11 u w ˆ u t ξ u x u m 11 18 w ˆ u k w u ξ u x u u e k w u k w w ˆ u where x u u v w q r α u c t k u k w u k w are positive design parameters 3 2 design of pitch motion the constraint condition θ e π 2 should never be violated in the design process of virtual control laws otherwise the virtual laws will be fall according to equation 12 it is also necessary to limit θ e in practice based on the previous discussions based on above considerations we choose following blf candidate as 19 v q e 1 2 log k b 2 k b 2 θ e 2 where k b π 2 is the constraint on θ e the derivative of v q e satisfies 20 v q e θ e θ e k b 2 θ e 2 θ e k b 2 θ e 2 q cos ψ e r tan θ sin ψ e cos θ e w x d sin θ cos ψ y d sin θ sin ψ z d cos θ ρ e sin θ e cos ψ e u x d cos θ cos ψ y d cos θ sin ψ z d sin θ ρ e sin θ e sin ψ e v x d sin ψ y d cos ψ ρ e let q α q q e where α q is the virtual control law take the following α q into account for the pitch motion 21 α q cos ψ e 1 k θ θ e r tan θ sin ψ e cos θ e w x d sin θ cos ψ y d sin θ sin ψ z d cos θ ρ e sin θ e cos ψ e u x d cos θ cos ψ y d cos θ sin ψ z d sin θ ρ e sin θ e sin ψ e v x d sin θ cos ψ y d sin θ sin ψ z d cos θ ρ e where design parameter k ρ 0 is a constant it s easy to get simplified v q e by combining equations 20 and 21 as 22 v q e 1 k b 2 θ e 2 k θ θ e 2 q e θ e cos ψ e the virtual control law α q is passed through a first order filter with time constant κ q to prevent the calculation of expansion problem 23 κ q α q c α q c α q α q c 0 α q 0 α q c α q α q c κ q where α q c is the filtered virtual control law and we can substitute α q c for α q then we choose the qlf as follows 24 v q e 2 1 2 log k b 2 k b 2 θ e 2 1 2 q e 2 by differentiating v q e 2 one achieves 25 v q e 2 v q e q e q e 1 k b 2 θ e 2 k θ θ e 2 q e θ e cos ψ e q e α q c q 1 k b 2 θ e 2 k θ θ e 2 q e θ e cos ψ e q e α q c m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 1 m 55 τ q d q 1 k b 2 θ e 2 k θ θ e 2 q e θ e cos ψ e q e α q c m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 1 m 55 τ q d q finally the following pitch control law is proposed 26 τ q k q q e θ e cos ψ e k b 2 θ e 2 α q c m 33 m 11 m 55 u w d 55 m 55 q ρ g g m l sin θ m 55 w ˆ q t ξ q x q m 55 27 w ˆ q k w q ξ q x q q e k w q k w 2 w ˆ q where x q u w q α q c t k q k w q k w 2 are positive design parameters 3 3 design of yaw motion similar to the design process of pitch motion the design process of yaw motion also requires constraint on ψ e so we choose following blf candidate as 28 v r e 1 2 log k c 2 k c 2 ψ e 2 where k c π 2 is the constraint on ψ e which promises that the limitation ψ e π 2 will never be violated the derivative of v r e is 29 v r e ψ e ψ e k c 2 ψ e 2 ψ e k c 2 ψ e 2 r 1 tan θ tan θ e cos ψ e q tan θ e sin ψ e v x d sin ψ y d cos ψ cos ψ e ρ e cos θ e u x d cos θ cos ψ y d cos θ sin ψ z d sin θ sin ψ e ρ e cos θ e let r α r r e where α r is the virtual control law choose the following α r for the yaw motion 30 α r 1 tan θ tan θ e cos ψ e 1 k ψ ψ e q tan θ e sin ψ e v x d sin ψ y d cos ψ cos ψ e ρ e cos θ e u x d cos θ cos ψ y d cos θ sin ψ z d sin θ sin ψ e ρ e cos θ e where design parameter k ψ 0 is a constant remark 9 in order to prevent possible singularity of the proposed virtual law 30 the condition tan θ tan θ e cos φ e 1 should be satisfied referring to shojaei and dolatshahi 2017 by setting k θ k ρ k ψ k ρ singularity is avoidable the simplified v r e can be obtained as follows 31 v r e 1 k c 2 ψ e 2 k ψ ψ e 2 r e ψ e 1 tan θ tan θ e cos ψ e the virtual control law α r is passed through a first order filter as follows 32 κ r α r c α r c α r α r c 0 α r 0 α r c α r α r c κ r where κ r 0 is the time constant parameter α r c is the filtered virtual control law then the qlf is considered in next step 33 v r e 2 1 2 log k c 2 k c 2 ψ e 2 1 2 r e 2 by differentiating v r e 2 we have 34 v r e 2 v r e r e r e 1 k c 2 ψ e 2 k ψ ψ e 2 r e ψ e 1 tan θ tan θ e cos ψ e r e α r c r 1 k c 2 ψ e 2 k ψ ψ e 2 r e ψ e 1 tan θ tan θ e cos ψ e r e α r c m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r d r 1 k c 2 ψ e 2 k ψ ψ e 2 r e ψ e 1 tan θ tan θ e cos ψ e r e α r c m 11 m 22 m 66 u v d 66 m 66 r 1 m 66 τ r d r finally the yaw torque is designed as 35 τ r k r r e α r c m 11 m 22 m 66 u v d 66 m 66 r ψ e ψ e tan θ tan θ e cos ψ e k c 2 ψ e 2 w ˆ r t ξ r x r m 66 36 w ˆ r k w r ξ r x r r e k w r k w 3 w ˆ r where x r u v r α r c t k r k w r k w 3 are positive design parameters theorem 1 consider the trajectory tracking problem for underactuated auv denoted by 1 and 2 under assumptions 1 4 lemma 1 2 and output constraints requirements if gain parameters satisfy k u 0 25 k p 0 25 k r 0 25 κ u 1 κ q 1 κ r 1 and the initial errors satisfy 0 ρ e k a θ e k b and ψ e k c then the proposed controllers 12 14 17 18 21 23 26 27 30 32 35 and 36 guarantee that all signals in the closed loop system are bounded the constraints 0 ρ e k a θ e k b and ψ e k c will remain unviolated during the whole process and tracking errors are uub and finally converge to an neighborhood of zero proof before beginning the proof we introduce the inequalities w i t w ˆ i c 1 w i f 2 c 2 w i f 2 c 1 1 0 5 ι 2 c 2 0 5 ι 2 and ι 2 2 shojaei and dolatshahi 2017 that will be used later then we define filters output errors as α u α u c α u α q α q c α q α r α r c α r whose derivatives are expressed as follows 37 α i α i c α i α i κ i d α i d t α i κ i b i i u q r where b i i u q r are continuous functions with a maximum applying young s inequality a b λ 2 a 2 4 b 2 λ 2 on equation 37 we have 38 α i α i α i 2 κ i α i d α i d t α i 2 κ i α i b i α i 2 κ i α i 2 b i 2 4 i u q r then choose the lyapunov function expressed as 39 v 1 2 log k a 2 k a 2 ρ e 2 u e 2 log k b 2 k b 2 θ e 2 q e 2 log k c 2 k c 2 ψ e 2 r e 2 α u 2 α q 2 α r 2 w u t w u k w u w q t w q k w q w r t w r k w r where w i w i w ˆ i i u q r denote optimal weight estimation errors the time derivative of 39 is v k ρ ρ e 2 k a 2 ρ e 2 k u u e 2 k θ θ e 2 k b 2 θ e 2 k q q e 2 k ψ ψ e 2 k c 2 ψ e 2 k r r e 2 u e w u t ξ u x u q e w q t ξ q x q r e w r t ξ r x r u e d u q e d q r e d r α u α ˆ u α q α ˆ q α r α ˆ r w u t w ˆ u k w u w q t w ˆ q k w q w r t w ˆ r k w r k ρ ρ e 2 k a 2 ρ e 2 k u u e 2 k θ θ e 2 k b 2 θ e 2 k q q e 2 k ψ ψ e 2 k c 2 ψ e 2 k r r e 2 u e w u t ξ u x u q e w q t ξ q x q r e w r t ξ r x r u e λ u max q e λ q max r e λ r max α u α ˆ u α q α ˆ q α r α ˆ r w u t ξ u x u u e k w w ˆ u w q t ξ q x q q e k w 2 w ˆ q w r t ξ r x r r e k w 3 w ˆ r k ρ ρ e 2 k a 2 ρ e 2 k u u e 2 k θ θ e 2 k b 2 θ e 2 k q q e 2 k ψ ψ e 2 k c 2 ψ e 2 k r r e 2 u e λ u max q e λ q max r e λ r max α u α ˆ u α q α ˆ q α r α ˆ r k w w u t w ˆ u k w 2 w q t w ˆ q k w 3 w r t w ˆ r k ρ ρ e 2 k a 2 ρ e 2 k u u e 2 k θ θ e 2 k b 2 θ e 2 k q q e 2 k ψ ψ e 2 k c 2 ψ e 2 k r r e 2 0 25 u e 2 λ u max 2 0 25 q e 2 λ q max 2 0 25 r e 2 λ r max 2 α u 2 κ u α u 2 0 25 b u α q 2 κ q α q 2 0 25 b q α r 2 κ r α r 2 0 25 b r k w w u t w ˆ u k w 2 w q t w ˆ q k w 3 w r t w ˆ r k ρ log k a 2 k a 2 ρ e 2 k u u e 2 k θ log k b 2 k b 2 θ e 2 k q q e 2 k ψ log k c 2 k c 2 ψ e 2 k r r e 2 0 25 u e 2 λ u max 2 0 25 q e 2 λ q max 2 0 25 r e 2 λ r max 2 α u 2 κ u α u 2 0 25 b u α q 2 κ q α q 2 0 25 b q α r 2 κ r α r 2 0 25 b r k w c 1 w u f 2 c 2 w u f 2 k w 2 c 1 w q f 2 c 2 w q f 2 k w 3 c 1 w r f 2 c 2 w r f 2 k ρ log k a 2 k a 2 ρ e 2 k u 0 25 u e 2 k θ log k b 2 k b 2 θ e 2 k q 0 25 q e 2 k ψ log k c 2 k c 2 ψ e 2 k r 0 25 r e 2 1 κ u 1 α u 2 1 κ q 1 α q 2 1 κ r 1 α r 2 k w c 1 w u f 2 k w 2 c 1 w q f 2 k w 3 c 1 w r f 2 λ u max 2 λ q max 2 λ r max 2 0 25 b u 0 25 b q 0 25 b r 40 k w c 2 w u f 2 k w 2 c 2 w q f 2 k w 3 c 2 w r r 2 then if conditions mentioned in theorem 1 are satisfied we can obtain the following inequality 41 v γ v ζ where γ 0 and ζ 0 satisfy 42 γ min 2 k ρ 2 k θ 2 k ψ 2 k u 0 5 2 k q 0 5 2 k r 0 5 2 1 κ u 1 2 1 κ q 1 2 1 κ r 1 k w u k w c 1 k w q k w 2 c 1 k w r k w 3 c 1 43 ζ λ u max 2 λ q max 2 λ r max 2 0 25 b u 0 25 b q 0 25 b r k w c 2 w u f 2 k w 2 c 2 w q f 2 k w 3 c 2 w r r 2 combining equations 41 to 43 we have 44 0 v t ζ γ v 0 ζ γ e γ t remark 10 from equation 42 we can obtain that when the design parameters k ρ k θ k ψ k u k q k r k w u k w k w q k q k w r k r increase and the parameters κ u κ q κ r decrease γ increases thus causing the convergence rate of the controller to increase therefore after selecting the control parameters that satisfy the requirements shown in theorem 1 better control performance can be achieved by adjusting the control parameters from equation 44 we have v t max v 0 ς γ t 0 and then get x t max v 0 ς γ γ min where γ min min 1 1 k w u 1 k w q 1 k w r inequaties 41 and 44 indicate that v t is negative outside the compact set ω x x t 0 x t max v 0 ς γ γ min this means x t is decreasing gradually when x t is outside the set ω x it implies that all the signals included in equation 39 are uniformly ultimately bounded according to the assumptions and the control laws mentioned above we can make the conclusion that x y z θ ψ u q r w ˆ u w ˆ q w ˆ r τ u τ q τ r are all bounded equation 39 shows that v as ρ e k a or θ e k b or ψ e k c clearly so the position error ρ e remains in the set 0 k a the pitch angle error θ e remains in the set k b k b and the yaw angle error ψ e remains in the set k c k c according to lemma 1 4 simulation results some numerical simulation studies are carried out in this section to demonstrate the performance of proposed control method all simulations are performed in matlab software environment referring to shojaei and dolatshahi 2017 we have the following model parameters 45 m 11 25 k g m 22 17 5 k g m 33 30 k g m 55 22 5 k g m 2 m 66 15 k g m 2 d 11 30 k g s 1 d 22 30 k g s 1 d 33 30 k g s 1 d 55 20 k g m 2 s 1 d 66 20 k g m 2 s 1 ρ g g m l 5 the reference trajectory is designed as 46 x d 5 sin 0 2 t 5 cos 0 1 t y d 5 sin 0 1 t 5 cos 0 2 t z d 10 0 1 t 4 1 comparison with qlf the main contribution of proposed method is that we design a reliable tracking controller considering the position error pitch angle error and yaw angle error constraints in this part we verify the output constraints capability of designed controller through the comparative simulation of blf and qlf in the qlf method when the angle error θ e or ψ e reaches π 2 the controller will fail completely because of triggering the singular point so that the auv cannot continue tracking the reference trajectory therefore we take the constraint constraint as θ e k b π 2 and ψ e k b π 2 in the first part of simulation the desired trajectory is selected as equation 46 design parameters for controller are selected as follows 47 k ρ 0 76 k θ 2 0 k ψ 1 6 k u 3 2 k q 2 5 k r 1 5 k a 15 k b π 2 k c π 2 k u k q k r 0 01 k w u k w q k w r 18 k w 2 k w 3 0 5 choose following qlf for the purpose of comparison 48 v q l f 1 2 ρ e 2 u e 2 θ e 2 q e 2 ψ e 2 r e 2 the initial condition is selected as x 0 y 0 z 0 θ 0 ψ 0 u 0 v 0 w 0 q 0 r 0 10 10 5 π 6 0 0 0 0 0 0 then we obtain the following simulation comparison results fig 2 delineates the tracking effect of proposed method fig 3 illustrates the yaw angle error ψ e fig 4 shows the velocities and fig 5 gives the pitch and position errors it can be seen from the figures that under the control based on qlf method ψ e approaches the constraint boundary π 2 causing the controller to fail and unable to track the trajectory while the limitation ψ e π 2 is never been violated by using blf method which proves that the algorithm proposed in this paper is reliable to restrict the constraint conditions 4 2 blf algorithm effect reliability simulation in order to verify controller s performance of tracking the desired trajectory the following simulation is carried out in this part according to equations 41 44 when the design parameters increase the convergence rate of the controller will increase too therefore we choose two groups of blf based controllers with different design parameters under the same system parameters respectively named blf tracking and blf tracking 2 and make the following simulation meanwhile the qlf based control methods with the same design parameters as blf tracking is selected for reference and comparison equation 46 is selected as the reference trajectory the initial condition is selected as x 0 y 0 z 0 θ 0 ψ 0 u 0 v 0 w 0 q 0 r 0 15 10 5 π 10 π 8 0 0 0 0 0 design parameters for controller are selected as figure 6 remark 11 in the first part of simulation section we restricted the output constraints to θ e π 2 and ψ e π 2 to examine the output constraint performance in practice however it is more practical to impose stricter restrictions on output constraints so we set the constraint condition as θ e π 4 and ψ e π 4 simulation results are illustrated in figs 7 12 above simulations give the comparison of blf method with different designed parameters and the comparison between qlf method and blf method with the same parameters trajectory tracking result is demonstrated by figs 7 and 8 fig 9 shows the pitch angle and yaw angle of auv it can be seen that all three controllers ensure the auv successfully tracks the desired trajectory in the presence of external disturbances fig 10 shows that the blf based controller can also converge all the tracking errors to a small ball around zero asymptotically and effectively and the convergence rate of controller with parameters named blf tracking 2 is slightly fatter than that of controller with parameters named blf tracking the velocities u q and r are plotted in fig 11 actual control inputs τ u τ q and τ r are illustrated in fig 12 5 conclusion in this paper a dynamic surface tracking controller based on blf backstepping method and rbfnn technique is designed for underactuated auv the controller guarantees the auv converge to desired trajectory and all of the signals in the closed loop system are bounded output errors will never violate the constraint limitations which greatly protect the system s security performance and finally tend to neighborhood of zero environmental disturbances are estimated and conpensated by using rbfnn technique dsc technology solves the problem of computational explosion and greatly improves the efficiency of the controller finally simulation results show the controller proposed effectiveness clearly acknowledgements this work was supported by the national natural science foundation of china under grant 61503010 and 61703018 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 023 
22963,hydrofoils with significant camber and thickness can be hydrodynamically advantageous over thin low camber hydrofoils commonly used on boats with surface piercing hydrofoil systems especially at lower speeds when a pronounced drag hump is usually present and cavitation is not yet an issue the main drawback of such high lift hydrofoils is a danger of being ventilated with air that can easily propagate from the atmosphere along the foil suction side resulting in a drop of the foil lift drag ratio the air ventilation is a complex physical process modeling of which remains a challenging task in this study a computational fluid dynamics solver star ccm is applied for simulating air ventilation phenomena on surface piercing hydrofoils a good agreement is obtained with available test data for relevant configurations it is also shown that small fences appropriately placed on the inclined surface piercing hydrofoil can suppress both downward air ventilation and upward water spray resulting in greater performance of high lift hydrofoils at moderate froude numbers keywords hydrofoil air ventilation surface flows numerical simulation nomenclature a characteristic area c hydrofoil chord c d 2 d ρ u 2 a drag coefficient c l 2 l ρ u 2 a lift coefficient d drag force e difference between numerical and experimental results f body force f factor of safety f r u g c froude number g k turbulent production h submergence k turbulent kinetic energy l lift force p pressure p o b observed order of accuracy p t h theoretical order of accuracy r e ρ u c μ reynolds number s modulus of the mean strain rate tensor t time u flow velocity u flow velocity u incident flow velocity u d experimental uncertainty u n s numerical simulation uncertainty u v validation uncertainty x coordinate α angle of attack β volume fraction occupied by air δ r e correction due to richardson extrapolation δ difference between results obtained on different grids ε turbulent dissipation rate θ hydrofoil dihedral μ viscosity μ t turbulent eddy viscosity ρ density ν kinematic viscosity 1 introduction hydrofoil boats are known to have high lift drag ratios when operating in the optimal operational conditions at relatively high speeds in case of common self stabilized surface piercing hydrofoil systems thin low camber foil profiles are often employed fig 1 a however such hydrofoils are ineffective at lower speeds when they do not generate significant lift but create substantial drag in order to improve boat performance at lower speeds and heavier loadings one may try to use thicker more cambered foil sections similar to those used on airplanes fig 1b these profiles have higher maximum lift coefficients and higher lift drag ratios so they could produce larger lift and smaller drag at moderate speeds although such hydrofoils are also less prone to the leading edge ventilation than thinner foils thicker foils could generate more spray and be more susceptible to air ventilation initiated on the suction side away from the leading edge it is known that many hydrodynamic devices producing lifting lateral thrust forces such as hydrofoils rudders and propellers often experience air ventilation when operating close to the water surface the atmospheric air can propagate to low pressure zones on suction surfaces of these devices and degrade their hydrodynamic performance by limiting pressure decrease the air ventilation phenomena may also have complex dynamics resulting in sudden changes of forces or even non unique flow states at the same operational conditions which are usually very undesirable one illustration of the air ventilation process on an inclined surface piercing hydrofoil is shown in fig 2 a the atmospheric air propagates downward along the foil span reducing the foil lifting capabilities at the same time a water jet is formed on the foil portion located above the nominal water surface leading to increased drag both processes reduce hydrodynamic performance of the system one way to counteract them is to place small fences on the foil that will limit both the air ventilated and water jet zones fig 2b numerical modeling of a surface piercing hydrofoil with and without fences is the main subject of this paper the air ventilation processes have been extensively studied since the 1950 s when mass production of hydrofoil boats had commenced ventilation on surface piercing bodies of various shapes was explored by straub and wetzel 1957 nishiyama 1959 carried out tests up to very low submergences of 2d hydrofoils which demonstrated air ventilation a small scale ventilated v shaped hydrofoil crossing was tested by fridsma 1963 and some data from that study are used here for validation a number of previous investigations addressed vertical struts that can be also thought of as hydrofoils generating a lift force in the lateral direction for example breslin and skalak 1959 and swales et al 1974 looked at the different types of ventilation onset on struts including initiation of the ventilated cavity at the leading and trailing edges via a vortex formed behind the submerged foil tip and upon cavitation inception it can be noted that air ventilation in many cases resembles developed cavitation where the water rupture is caused by evaporation of water at low pressure instead of incoming air both ventilated and developed cavitating flows are often analyzed with similar mathematical tools such as the potential flow theory ivanov 1980 kinnas and young 2003 matveev 2011 a thesis of rothblum 1977 discussed a variety of methods for suppressing ventilation on surface piercing struts including variable taper camber fences blowing suction and other means among recent tests with ventilated hydrofoils an experimental program by harwood et al 2016 should be noted and their results are also utilized here for validation purposes for a comprehensive review of air ventilation phenomena on lifting objects the readers are referred to a recent paper by young et al 2017 there are also other situations when hydrofoil ventilation is important for example karn et al 2015 investigated aeration of hydrofoils with a purpose to increase oxygen content in the discharge of hydroturbines modeling of air ventilation is a challenging task due to complicated nature of multi phase and surface flows which may exhibit strong unsteadiness and history dependent phenomena the potential flow theory has been used for approximate modeling of air ventilated flows in relatively simple geometries e g by ivanov 1980 vinayan and kinnas 2010 and harwood et al 2016 inclusion of viscous effects and consideration of more complex practical configurations can be accomplished with modern computational fluid dynamics cfd solvers in recent years several cfd studies addressed hydrodynamics of surface piercing hydrofoils including regimes with air ventilation brizzolara and villa 2012 harwood et al 2014 keller et al 2016 califano and steen 2009 studied propeller ventilation using rans approach ji et al 2010 considered a three component model for simulating both cavitation and ventilation with application to underwater vehicles wang et al 2015 applied both experimental and numerical methods to study air leakage from ventilated cavities yang et al 2018 recently analyzed a ventilated 2d hydrofoil with different turbulence modeling methods an effect of fences on hydrofoil ventilation at extreme beyond typical practical range attack angles and without any validation was reported by andrun et al 2016 the authors of the present paper have recently conducted a validation study of a ventilated strut in a broad range of yaw angles and demonstrated a capability of cfd to predict non unique flow states hysteresis that can exist at the same nominal conditions matveev et al 2018 the main objectives of the present study are to show validation of a rans based cfd approach with modest numerical cell counts for air ventilated foils to model hydrodynamic forces and flow regimes on an inclined surface piercing hydrofoil with a high lift soft stall section e603 fig 1b at moderate froude numbers when chord based f r is roughly between 2 and 5 and to demonstrate how small fences can limit the extent of ventilation and improve hydrodynamic performance the far field features of the flow are not modeled in the present study due to adopted here economical computational approach with limited mesh refinement zones 2 computational approach the computational fluid dynamics cfd program employed in this work was star ccm of version 12 04 011 the finite volume segregated flow solver utilizes simple solution algorithm and the second order upwind convection scheme details of which are elaborated by ferziger and peric 1999 the unsteady approach is based on the second order implicit stepping in time for most cases reported in this paper only steady state results are presented they correspond to the states when the time averaged flow properties are no longer evolving as the air ventilation phenomena include both air and water and the eulerian multiphase approach with constant density fluids is applied here for their modeling to capture the air water interface the volume of fluid vof method is employed hirt and nichols 1981 a surface tension model and gravity are also included the reynolds averaged governing equations for incompressible fluids include the continuity momentum and volume fraction transport equations 1 u j x j 0 2 ρ u i t ρ u i u j x j p x i x j μ u i x j u j x i ρ u i u j ρ f i 3 β t β u i x i 0 where u i are the reynolds averaged velocity components ρ is the mixture density f is the body force such as gravity ρ u i u j is the reynolds stresses and β represents the volume fraction occupied by air so that the effective fluid density ρ and viscosity μ are calculated as ρ ρ a i r β ρ w a t e r 1 β and μ μ a i r β μ w a t e r 1 β the reynolds stresses are modeled with the boussinesq hypothesis which for incompressible fluids results in the following expression 4 ρ u i u j μ t u i x j u j x i 2 3 ρ k δ i j where μ t is the turbulent eddy viscosity and k is the turbulent kinetic energy in almost all cases studied in this work the realizable two layer k epsilon model shih et al 1995 rodi 1991 was utilized although the k omega model was also tried for one validation case discussed in the next section the transport equations for the turbulent kinetic energy k and the turbulent dissipation rate ε in the realizable k epsilon model are given as follows 5 ρ k t ρ k u j x j x j μ μ t σ k k x j g k ρ ε 6 ρ ε t ρ ε u j x j x j μ μ t σ ε ε x j ρ c ε 1 s ε ρ c ε 2 ε 2 k ν ε where g k is the generation of turbulent kinetic energy due to the mean velocity gradients s 2 s i j s i j is the scalar invariant of the strain rate tensor s i j 1 2 u i x j u j x i ν is the kinematic viscosity c ε 1 and c ε 2 are the model coefficients and σk and σε are the turbulent prandtl numbers for k and ε respectively the turbulent eddy viscosity is expressed as follows 7 μ t ρ c μ k 2 ε where c μ depends on both the mean flow and turbulence properties e g mulvany et al 2004 more sophisticated models for the turbulent eddy viscosity are available in the literature that have additional coefficients explicitly accounting for the volume fractions coutier delgosha et al 2003 but they have not been tried in this study because of our goal to use a modest cell count due to limited computational resources we relied on the wall functions with average y values for the near wall cells of around 50 which is in the range suggested for the wall function approach e g wilcox 2006 salim and cheah 2009 the time step on the fine mesh was selected as c 200 u in accordance with ittc recommendations ittc 2011 where c is the hydrofoil chord and u is the velocity of the incoming flow ten inner iterations were performed to ensure adequate convergence at each time step besides the hydrofoil geometry and attitude the important non dimensional parameters characterizing flow regimes are froude and reynolds numbers 8 f r u g c 9 r e ρ w a t e r u c μ w a t e r where the foil chord c is used as the characteristic length for all cases considered in this paper the non dimensional force parameters of hydrofoils are the lift and drag coefficients 10 c l 2 l ρ w a t e r u 2 a 11 c d 2 d ρ w a t e r u 2 a where the characteristic area a corresponds to the hydrofoil planform area for a horizontally oriented completely submerged hydrofoil for vertical hydrofoils crossing the water surface only the part of the planform area below the nominal undisturbed water surface is accounted for in case of inclined hydrofoils the characteristic area is usually the area projected on a horizontal plane by the hydrofoil portion submerged under the nominal water surface 3 verification and validation for validation purposes three configurations with available test data were selected in this study the first is a ventilated vertical strut in turbulent flow at moderate froude numbers harwood 2016 the second is a small scale v shaped hydrofoil operated in wetted and ventilated regimes fridsma 1963 and the third is a two dimensional airfoil with e603 section in single phase flow lasauskas and naujokaitis 2009 the complete verification and validation procedure is described in details below for the first case since experimental uncertainties were well defined and reynolds and froude numbers were relatively close to the hydrofoil setup investigated later in this study the second case has a geometric orientation similar to that of an inclined hydrofoil although the foil section and reynolds number are rather different in the third case for e603 foil profile used later in simulations with an inclined hydrofoil the experimentally measured lift coefficient in a single phase fluid is available in a broad range of attack angles including the stall regime 3 1 vertical surface piercing strut a cross section of the vertical surface piercing strut used in the first validation study is shown in fig 3 along with surrounding numerical mesh the strut had a rounded nose and was yawed at angle of 25⁰ with respect to the incident flow direction the constructed numerical flow domain and the trimmed mesh with mainly hexahedral cells are shown in figs 3 5 a prism layer was generated near the strut surface to resolve the boundary layer a block with finer mesh is formed around the strut and in the near wake region another grid refinement is implemented along the free surface fig 3 the simulated condition corresponds to the submergence h of the strut bottom tip that was equal to the strut chord c 27 94 cm see fig 5 the no slip boundary condition is applied on the strut surface whereas all external boundaries of the domain besides the downstream surface are treated as the velocity inlets and the downstream boundary is the pressure outlet the damping zones of 1 5 c long into the domain are placed near the side and downstream borders in the initial state the uniform water and air flows were assigned throughout the domain the chord froude and reynolds numbers based on water properties were about 3 5 and 1 6 106 respectively similar to the corresponding experimental conditions harwood et al 2016 following xing and stern 2010 a formal numerical verification procedure has been applied here to evaluate the numerical uncertainty of the steady state solutions and compare them with experimental data three numerical grids with coarse medium and fine mesh were generated so that the cell dimensions were refined with a factor of two between the coarse and medium grids and between the medium and fine grids the overall cell counts of these grids were about 0 18 0 45 and 1 62 million for physical characteristics of the numerical convergence study the lift and drag coefficients of the strut c l and c d were used the drag force is exerted along the x axis while the lift or side force is defined in the negative y direction these axes are shown in figs 3 5 the steady state force coefficients found with three grids are plotted in fig 6 the air water interface obtained on the fine mesh and defined as the isosurface with the water fraction threshold of 0 5 is illustrated in fig 7 showing air ventilation of the suction side and significant water spray at and behind the pressure side of the strut additional images comparing snapshots from experimental videos and numerical simulations are shown in fig 8 one can notice two artificial features in the simulation image in fig 7 the aerated length of the tip vortex is rather short and the pressure side water spray exhibits a sudden end in the vertical direction these abrupt transitions occur at boundaries of the mesh refinement zone since the volume fraction of a less dominant fluid becomes smaller inside larger cells and falls below the chosen interface threshold if one is interested in accurately modeling flow beyond the immediate vicinity of the foil e g to access hydrodynamic influence on system elements located behind this foil then the refinement zones will need to be extended and this will also make simulations more computationally expensive the main results of the numerical uncertainty calculations and validation results are summarized in table 1 first using monotonically converging solution results on three grids fig 6 the richardson extrapolation was performed to determine the expected corrections δ r e to the fine mesh solution ferziger and peric 1999 12 δ r e δ 21 2 p o b 1 where δ 21 is the difference between fine and medium mesh solutions and p o b is the observed order of accuracy then the factors of safety xing and stern 2010 were applied to these corrections in order to find the grid based numerical simulation uncertainties u n s 13 u n s f δ r e where the factor of safety is determined as follows 14 f 2 45 0 85 p o b p t h if p o b p t h 1 15 f 16 4 p o b p t h 14 8 if p o b p t h 1 when comparing computational results and experimental data the total validation uncertainties u v that combine the numerical and test uncertainties need to be determined 16 u v u d 2 u n s 2 the experimental errors u d were specified by harwood et al 2016 as 12 5 of the measured mean values for the considered condition as shown in table 1 the differences between the computed and experimental force coefficients e are smaller than the validation uncertainties u v therefore it can be concluded that the present numerical approach has been validated in the subsequent simulations in this study the solver settings and mesh characteristics similar to this case with fine grid were employed 3 2 surface piercing v foil in the second validation case a v shaped hydrofoil with a wedge section was modeled fig 9 a this configuration was previously tested by fridsma 1963 the foil span was 60 2 cm dihedral was 30⁰ and the foil apex submergence was 10 2 cm due to a small chord 5 08 cm of the tested foil reynolds numbers were only about 1 6 105 at the moderate froude number of about 4 35 of interest to this study nevertheless experiments with this hydrofoil at the specified speed and submergence demonstrated the fully ventilated flow at trim angles of 10⁰ and above and the fully wetted flow could exist up to 9 5⁰ in the range between 7⁰ and 9 5⁰ partially ventilated states were also possible depending on history or disturbances for simulations of the fully ventilated flow in this study the trim of 14⁰ was selected while the 7⁰ trim was chosen to imitate the wetted state starting from the undisturbed condition the experimental setup was modeled here with the solver settings similar to the previous case but the laminar flow model was employed due to low reynolds numbers additionally due to the foil symmetry only a half of the numerical domain was considered and a symmetry boundary condition was imposed along the vertical centerplane similar to the tests the simulations showed that the foil surfaces were wet at smaller trim while at the larger trim the upper foil surface was ventilated the modeled water surface elevations in the wetted and ventilated regimes are illustrated in fig 9b and c the experimental and numerical lift and drag coefficients of the v foil for these two conditions are compared in fig 10 although no experimental uncertainties were given by fridsma 1963 typical scatter of test data were around 10 15 of the mean values given a reasonable correspondence of test and numerical results in fig 10 it can be concluded that the present approach is capable of adequately modeling the considered v shaped hydrofoil in both the wetted and ventilated regimes 3 3 two dimensional airfoil in single phase fluid the third validation case focuses on the two dimensional airfoil profile e603 fig 1b that can achieve high lift coefficients in a single phase fluid and is characterized by soft stall behavior eppler 1990 the experimental lift coefficients in the broad range of attack angles including the post stall regime were given by lasauskas and naujokaitis 2009 for a chord based reynolds number of one million the numerical simulations for this case involved the same computational settings as described above but were completed in two dimensions and for a single phase fluid a comparison of the numerical and experimental results for the lift coefficients as functions of attack angles is shown in fig 11 calculations based on the realizable k epsilon model demonstrate a very good agreement with test data prior to the stall and a relatively small overprediction of c l in the post stall regime it should be noted that experimental uncertainties were not reported for the test data the k omega model was found to work well at small to moderate attack angles fig 11 but its predictions in the stall zone were less consistent the solutions of the k omega model produced time averaged values of c l with larger deviations from the test data fig 11 hence the realizable k epsilon model was adopted for subsequent simulations of a high lift hydrofoil 4 results for inclined surface piercing hydrofoil in this section a surface piercing hydrofoil is analyzed to demonstrate performance degrading air ventilation effects as well as means for suppressing ventilation in order to achieve higher lift coefficients and lift drag ratios a hydrofoil is selected to have wing section e603 fig 1b total span to chord ratio of seven and a dihedral angle of 30⁰ as illustrated in fig 12 when reporting force coefficients the effective planform areas of surface piercing hydrofoils are usually defined using the horizontal projection of the foil portion located under the nominal undisturbed water surface for the inclined foil with the bottom tip submergence of h chord c and dihedral θ the corresponding effective aspect ratio is λ h c tan θ the effective aspect ratio based on this area is chosen in this study as four and this corresponds to the hydrofoil bottom tip submergence h of about 2 3 c all simulations presented in this section are conducted with the absolute value for the foil chord of c 0 5 m the main motivation for this study is to determine whether such surface piercing hydrofoils can produce high lift coefficients e g above one at relatively low froude numbers however as discussed above this hydrodynamic setup is likely to experience the air ventilation which may prevent achieving high c l one of the methods to constrain the ventilation process and to improve hydrodynamic performance is to employ small barriers on the foil surface that can restrict spanwise flow near the nominal water level fig 2b the barrier configuration selected in this study consists of two fences fig 12b each fence has thickness of 1 of the chord and elliptical sections with the main axis diameter of 1 2 c and the minor axis diameter of 0 4 c fig 12d and e the lower and upper fences are placed at distances 4 1 c and 5 6 c respectively along the span from the foil bottom tip fig 12c since the main purpose of the lower fence is to stop the air coming from the top on the foil suction side this fence is shifted slightly upward with respect to the foil chord line on the other hand the upper fence is shifted slightly downward since its main purpose is to restrict the water spray that is more pronounced on the foil pressure side the numerical mesh built for computational simulations follows the same approach as in validation cases considered above similar to the grid damping technique peric and abdel maksoud 2015 an additional block with coarsened mesh and damping was added near the downstream boundary to avoid numerical divergence that can be caused by highly confused nonlinear flow rooster tail near the downstream boundary at some conditions a fine grid for the surface piercing hydrofoil is illustrated in figs 13 and 14 due to higher aspect ratio of this foil the domain size became larger and the overall cell count reached about 3 7 million the default operational condition aiming at achieving high c l at reasonably low c d is selected here with the foil attack angle α 15 about the spanwise axis and chord based froude number f r u g c 3 5 additional simulations were carried out at several other angles of attack with fixed f r 3 5 and at two other froude numbers with fixed α 15 the corresponding chord based reynolds numbers were in the range of 2 2 5 5 106 the same turbulence model and other solver settings as in the main validation case described above were employed for simulating the surface piercing inclined hydrofoil the steady state numerical results for the lift and drag coefficients obtained with the clean and fenced hydrofoils at variable angles of attack are presented in fig 15 whereas images of water surfaces in several conditions are given in figs 16 20 at the attack angle α 15 the fenced hydrofoil produces nearly 50 higher c l and its lift drag ratio of 6 8 is about 25 higher than that of the clean foil the clean hydrofoil exhibits pronounced ventilation on the suction side fig 16a the air propagates from the atmosphere along the span and covers a substantial portion of the foil submerged surface thus not allowing it to generate a high lift force at the same time the water spray on the clean foil pressure side covers the entire foil surface above the water fig 16b in contrast the application of the fences limits the foil surface areas affected by ventilation and spray fig 17 the fences essentially block the downward propagation of the air on the suction side and upward water motion on the pressure side it should be kept in mind that the plotted water surfaces are isosurfaces with the water fraction of 0 5 some water exists but not shown above these surfaces whereas some air is present below them so these images would differ from experimental photographs illustrations of numerical interfaces at different threshold levels were previously presented by matveev et al 2018 to illustrate several interesting features of a wave pattern behind a surface piercing hydrofoil a top view on the water surface is given in fig 18 an upper portion of the hydrofoil is visible and two pronounced sprays formed on both pressure and suction sides of the foil propagate in the downstream direction similar to observations with ventilated surface piercing struts young et al 2017 between these sprays one can see a depression in the water caused by the air ventilated cavity which is located on the foil suction side under the nominal water surface at about 3 8 chords downstream of the submerged foil part a wave hollow is present which is typical for shallow hydrofoils its shape becomes important when selecting a favorable position for the rear foil in tandem hydrofoil systems matveev and matveev 2001 at lower attack angle of 10⁰ the difference between the clean and fenced versions becomes smaller fig 15 and it almost disappears at 5⁰ both ventilation and spray recede and the submerged part of a hydrofoil transitions into regular wetted state similar to vertical struts at small yaw angles harwood et al 2016 the fences no longer play a significant role at low flow incidence at higher attack angle of 20⁰ however the difference in hydrodynamic characteristics of the clean and fenced hydrofoils increases fig 15 the lift coefficient of the clean foil drops further down to the value similar to observation at α 5 while the fenced foil c l continues to increase showing a saturation tendency the drag coefficient of the fenced foil is only slightly higher than that of the clean foil fig 15b the lift drag ratios monotonically decrease for both hydrofoils with increasing the angle of attack in the entire range studied at high attack angles 15 20⁰ the lift drag ratio of the fenced foil is substantially larger than that of the clean foil the air water interfaces on hydrofoils operating in the extreme setup with α 20 are shown in figs 19 and 20 the suction on the upper surface of the clean hydrofoil is now sufficient to bring air down close to the bottom tip so most part of the upper surface is ventilated with air fig 19a resulting in a drop of the lift force fig 15a the water spray above the nominal water level is even more pronounced than in the previous case fig 19b fences on the modified hydrofoil still help limit air ventilation on the suction side and reduce spray on the pressure side fig 20 however the pressure near the foil leading edge drops below the vapor pressure leading to the cavitation inception fig 20a in order to simulate this early stage cavitation a cavitation module was activated in the flow solver that uses schnerr sauer cavitation model sauer 2000 while the water vapor was treated with properties of a real steam even the fenced hydrofoil version becomes not that efficient at α 20 when its lift drag ratio drops down to 5 2 from 6 8 at 15 hence this regime is not recommended for practical operations the intentional increase of the attack angle up to 20 would only make sense for brief time periods when the maximum lift is needed and only if there is enough thrust available to overcome additional drag another important operational parameter for hydrofoils is froude number the sensitivity of the clean and fenced hydrofoils to the chord based froude number f r u g c was investigated here at one attack angle of 15⁰ keeping other conditions the same the results for lift and drag coefficients are plotted in fig 21 as one can notice c l of the fenced hydrofoil is more stable which is beneficial for practical applications while the clean foil c l drops drastically with increasing speed at the lowest froude number f r 2 the water surface deformations including those caused by air ventilation are relatively small and the usage of fences results only in a minor increase of the lift coefficient fig 21a the case with f r 3 5 was discussed above and illustrated in figs 16 and 17 the air ventilation becomes important at this speed at the highest f r 5 ventilation on the clean foil increases further and both hydrofoils exhibit early stage of cavitation near the leading edge on the upper surface similar to the case with α 20 and f r 3 5 fig 20a the lift coefficient of the fenced foil remains much higher than that of the clean foil fig 21a the drag coefficient of the clean foil decreases more rapidly fig 21b so the lift drag ratios of both foils move closer to each other at f r 5 the thick high lift foils such as considered in this study are certainly not good candidates for high speed regimes at high attack angles when cavitation onset is expected at the same time high lift coefficients may not be needed at faster speeds since the lift force scales with the velocity squared and hence the same lift can be produced at smaller c l hence reducing attack angles may help extend a practical speed range for these foils 5 conclusions the air ventilation of surface piercing hydrofoils and one method for suppressing ventilation have been modeled in this work with a computational fluid dynamics cfd solver an economical setting of the computational tool was utilized including modest cell counts rans approach and reliance on the wall functions successful validation of several air ventilated configurations with this method was demonstrated suggesting that relatively inexpensive simulations can be used for determining basic features of air ventilated flows such as force coefficients of hydrofoils and prediction of wetted and ventilated flow states hydrodynamic characteristics of a simple inclined surface piercing hydrofoil with a high lift airfoil profile were shown to degrade at high attack angles and high froude numbers due to air ventilation the application of small fences placed on the hydrofoil surface near the nominal water level led to effective limitation of air ventilation which resulted in significant enhancement of the lift coefficient and in some cases of the lift drag ratio hence it is suggested that high lift hydrofoils with fences can be considered for application on foil assisted boats intended for moderate froude numbers acknowledgements this material is based upon research supported in part by the u s office of naval research under award no n00014 17 1 2553 and in part by the national science foundation under grant no 1800135 
22963,hydrofoils with significant camber and thickness can be hydrodynamically advantageous over thin low camber hydrofoils commonly used on boats with surface piercing hydrofoil systems especially at lower speeds when a pronounced drag hump is usually present and cavitation is not yet an issue the main drawback of such high lift hydrofoils is a danger of being ventilated with air that can easily propagate from the atmosphere along the foil suction side resulting in a drop of the foil lift drag ratio the air ventilation is a complex physical process modeling of which remains a challenging task in this study a computational fluid dynamics solver star ccm is applied for simulating air ventilation phenomena on surface piercing hydrofoils a good agreement is obtained with available test data for relevant configurations it is also shown that small fences appropriately placed on the inclined surface piercing hydrofoil can suppress both downward air ventilation and upward water spray resulting in greater performance of high lift hydrofoils at moderate froude numbers keywords hydrofoil air ventilation surface flows numerical simulation nomenclature a characteristic area c hydrofoil chord c d 2 d ρ u 2 a drag coefficient c l 2 l ρ u 2 a lift coefficient d drag force e difference between numerical and experimental results f body force f factor of safety f r u g c froude number g k turbulent production h submergence k turbulent kinetic energy l lift force p pressure p o b observed order of accuracy p t h theoretical order of accuracy r e ρ u c μ reynolds number s modulus of the mean strain rate tensor t time u flow velocity u flow velocity u incident flow velocity u d experimental uncertainty u n s numerical simulation uncertainty u v validation uncertainty x coordinate α angle of attack β volume fraction occupied by air δ r e correction due to richardson extrapolation δ difference between results obtained on different grids ε turbulent dissipation rate θ hydrofoil dihedral μ viscosity μ t turbulent eddy viscosity ρ density ν kinematic viscosity 1 introduction hydrofoil boats are known to have high lift drag ratios when operating in the optimal operational conditions at relatively high speeds in case of common self stabilized surface piercing hydrofoil systems thin low camber foil profiles are often employed fig 1 a however such hydrofoils are ineffective at lower speeds when they do not generate significant lift but create substantial drag in order to improve boat performance at lower speeds and heavier loadings one may try to use thicker more cambered foil sections similar to those used on airplanes fig 1b these profiles have higher maximum lift coefficients and higher lift drag ratios so they could produce larger lift and smaller drag at moderate speeds although such hydrofoils are also less prone to the leading edge ventilation than thinner foils thicker foils could generate more spray and be more susceptible to air ventilation initiated on the suction side away from the leading edge it is known that many hydrodynamic devices producing lifting lateral thrust forces such as hydrofoils rudders and propellers often experience air ventilation when operating close to the water surface the atmospheric air can propagate to low pressure zones on suction surfaces of these devices and degrade their hydrodynamic performance by limiting pressure decrease the air ventilation phenomena may also have complex dynamics resulting in sudden changes of forces or even non unique flow states at the same operational conditions which are usually very undesirable one illustration of the air ventilation process on an inclined surface piercing hydrofoil is shown in fig 2 a the atmospheric air propagates downward along the foil span reducing the foil lifting capabilities at the same time a water jet is formed on the foil portion located above the nominal water surface leading to increased drag both processes reduce hydrodynamic performance of the system one way to counteract them is to place small fences on the foil that will limit both the air ventilated and water jet zones fig 2b numerical modeling of a surface piercing hydrofoil with and without fences is the main subject of this paper the air ventilation processes have been extensively studied since the 1950 s when mass production of hydrofoil boats had commenced ventilation on surface piercing bodies of various shapes was explored by straub and wetzel 1957 nishiyama 1959 carried out tests up to very low submergences of 2d hydrofoils which demonstrated air ventilation a small scale ventilated v shaped hydrofoil crossing was tested by fridsma 1963 and some data from that study are used here for validation a number of previous investigations addressed vertical struts that can be also thought of as hydrofoils generating a lift force in the lateral direction for example breslin and skalak 1959 and swales et al 1974 looked at the different types of ventilation onset on struts including initiation of the ventilated cavity at the leading and trailing edges via a vortex formed behind the submerged foil tip and upon cavitation inception it can be noted that air ventilation in many cases resembles developed cavitation where the water rupture is caused by evaporation of water at low pressure instead of incoming air both ventilated and developed cavitating flows are often analyzed with similar mathematical tools such as the potential flow theory ivanov 1980 kinnas and young 2003 matveev 2011 a thesis of rothblum 1977 discussed a variety of methods for suppressing ventilation on surface piercing struts including variable taper camber fences blowing suction and other means among recent tests with ventilated hydrofoils an experimental program by harwood et al 2016 should be noted and their results are also utilized here for validation purposes for a comprehensive review of air ventilation phenomena on lifting objects the readers are referred to a recent paper by young et al 2017 there are also other situations when hydrofoil ventilation is important for example karn et al 2015 investigated aeration of hydrofoils with a purpose to increase oxygen content in the discharge of hydroturbines modeling of air ventilation is a challenging task due to complicated nature of multi phase and surface flows which may exhibit strong unsteadiness and history dependent phenomena the potential flow theory has been used for approximate modeling of air ventilated flows in relatively simple geometries e g by ivanov 1980 vinayan and kinnas 2010 and harwood et al 2016 inclusion of viscous effects and consideration of more complex practical configurations can be accomplished with modern computational fluid dynamics cfd solvers in recent years several cfd studies addressed hydrodynamics of surface piercing hydrofoils including regimes with air ventilation brizzolara and villa 2012 harwood et al 2014 keller et al 2016 califano and steen 2009 studied propeller ventilation using rans approach ji et al 2010 considered a three component model for simulating both cavitation and ventilation with application to underwater vehicles wang et al 2015 applied both experimental and numerical methods to study air leakage from ventilated cavities yang et al 2018 recently analyzed a ventilated 2d hydrofoil with different turbulence modeling methods an effect of fences on hydrofoil ventilation at extreme beyond typical practical range attack angles and without any validation was reported by andrun et al 2016 the authors of the present paper have recently conducted a validation study of a ventilated strut in a broad range of yaw angles and demonstrated a capability of cfd to predict non unique flow states hysteresis that can exist at the same nominal conditions matveev et al 2018 the main objectives of the present study are to show validation of a rans based cfd approach with modest numerical cell counts for air ventilated foils to model hydrodynamic forces and flow regimes on an inclined surface piercing hydrofoil with a high lift soft stall section e603 fig 1b at moderate froude numbers when chord based f r is roughly between 2 and 5 and to demonstrate how small fences can limit the extent of ventilation and improve hydrodynamic performance the far field features of the flow are not modeled in the present study due to adopted here economical computational approach with limited mesh refinement zones 2 computational approach the computational fluid dynamics cfd program employed in this work was star ccm of version 12 04 011 the finite volume segregated flow solver utilizes simple solution algorithm and the second order upwind convection scheme details of which are elaborated by ferziger and peric 1999 the unsteady approach is based on the second order implicit stepping in time for most cases reported in this paper only steady state results are presented they correspond to the states when the time averaged flow properties are no longer evolving as the air ventilation phenomena include both air and water and the eulerian multiphase approach with constant density fluids is applied here for their modeling to capture the air water interface the volume of fluid vof method is employed hirt and nichols 1981 a surface tension model and gravity are also included the reynolds averaged governing equations for incompressible fluids include the continuity momentum and volume fraction transport equations 1 u j x j 0 2 ρ u i t ρ u i u j x j p x i x j μ u i x j u j x i ρ u i u j ρ f i 3 β t β u i x i 0 where u i are the reynolds averaged velocity components ρ is the mixture density f is the body force such as gravity ρ u i u j is the reynolds stresses and β represents the volume fraction occupied by air so that the effective fluid density ρ and viscosity μ are calculated as ρ ρ a i r β ρ w a t e r 1 β and μ μ a i r β μ w a t e r 1 β the reynolds stresses are modeled with the boussinesq hypothesis which for incompressible fluids results in the following expression 4 ρ u i u j μ t u i x j u j x i 2 3 ρ k δ i j where μ t is the turbulent eddy viscosity and k is the turbulent kinetic energy in almost all cases studied in this work the realizable two layer k epsilon model shih et al 1995 rodi 1991 was utilized although the k omega model was also tried for one validation case discussed in the next section the transport equations for the turbulent kinetic energy k and the turbulent dissipation rate ε in the realizable k epsilon model are given as follows 5 ρ k t ρ k u j x j x j μ μ t σ k k x j g k ρ ε 6 ρ ε t ρ ε u j x j x j μ μ t σ ε ε x j ρ c ε 1 s ε ρ c ε 2 ε 2 k ν ε where g k is the generation of turbulent kinetic energy due to the mean velocity gradients s 2 s i j s i j is the scalar invariant of the strain rate tensor s i j 1 2 u i x j u j x i ν is the kinematic viscosity c ε 1 and c ε 2 are the model coefficients and σk and σε are the turbulent prandtl numbers for k and ε respectively the turbulent eddy viscosity is expressed as follows 7 μ t ρ c μ k 2 ε where c μ depends on both the mean flow and turbulence properties e g mulvany et al 2004 more sophisticated models for the turbulent eddy viscosity are available in the literature that have additional coefficients explicitly accounting for the volume fractions coutier delgosha et al 2003 but they have not been tried in this study because of our goal to use a modest cell count due to limited computational resources we relied on the wall functions with average y values for the near wall cells of around 50 which is in the range suggested for the wall function approach e g wilcox 2006 salim and cheah 2009 the time step on the fine mesh was selected as c 200 u in accordance with ittc recommendations ittc 2011 where c is the hydrofoil chord and u is the velocity of the incoming flow ten inner iterations were performed to ensure adequate convergence at each time step besides the hydrofoil geometry and attitude the important non dimensional parameters characterizing flow regimes are froude and reynolds numbers 8 f r u g c 9 r e ρ w a t e r u c μ w a t e r where the foil chord c is used as the characteristic length for all cases considered in this paper the non dimensional force parameters of hydrofoils are the lift and drag coefficients 10 c l 2 l ρ w a t e r u 2 a 11 c d 2 d ρ w a t e r u 2 a where the characteristic area a corresponds to the hydrofoil planform area for a horizontally oriented completely submerged hydrofoil for vertical hydrofoils crossing the water surface only the part of the planform area below the nominal undisturbed water surface is accounted for in case of inclined hydrofoils the characteristic area is usually the area projected on a horizontal plane by the hydrofoil portion submerged under the nominal water surface 3 verification and validation for validation purposes three configurations with available test data were selected in this study the first is a ventilated vertical strut in turbulent flow at moderate froude numbers harwood 2016 the second is a small scale v shaped hydrofoil operated in wetted and ventilated regimes fridsma 1963 and the third is a two dimensional airfoil with e603 section in single phase flow lasauskas and naujokaitis 2009 the complete verification and validation procedure is described in details below for the first case since experimental uncertainties were well defined and reynolds and froude numbers were relatively close to the hydrofoil setup investigated later in this study the second case has a geometric orientation similar to that of an inclined hydrofoil although the foil section and reynolds number are rather different in the third case for e603 foil profile used later in simulations with an inclined hydrofoil the experimentally measured lift coefficient in a single phase fluid is available in a broad range of attack angles including the stall regime 3 1 vertical surface piercing strut a cross section of the vertical surface piercing strut used in the first validation study is shown in fig 3 along with surrounding numerical mesh the strut had a rounded nose and was yawed at angle of 25⁰ with respect to the incident flow direction the constructed numerical flow domain and the trimmed mesh with mainly hexahedral cells are shown in figs 3 5 a prism layer was generated near the strut surface to resolve the boundary layer a block with finer mesh is formed around the strut and in the near wake region another grid refinement is implemented along the free surface fig 3 the simulated condition corresponds to the submergence h of the strut bottom tip that was equal to the strut chord c 27 94 cm see fig 5 the no slip boundary condition is applied on the strut surface whereas all external boundaries of the domain besides the downstream surface are treated as the velocity inlets and the downstream boundary is the pressure outlet the damping zones of 1 5 c long into the domain are placed near the side and downstream borders in the initial state the uniform water and air flows were assigned throughout the domain the chord froude and reynolds numbers based on water properties were about 3 5 and 1 6 106 respectively similar to the corresponding experimental conditions harwood et al 2016 following xing and stern 2010 a formal numerical verification procedure has been applied here to evaluate the numerical uncertainty of the steady state solutions and compare them with experimental data three numerical grids with coarse medium and fine mesh were generated so that the cell dimensions were refined with a factor of two between the coarse and medium grids and between the medium and fine grids the overall cell counts of these grids were about 0 18 0 45 and 1 62 million for physical characteristics of the numerical convergence study the lift and drag coefficients of the strut c l and c d were used the drag force is exerted along the x axis while the lift or side force is defined in the negative y direction these axes are shown in figs 3 5 the steady state force coefficients found with three grids are plotted in fig 6 the air water interface obtained on the fine mesh and defined as the isosurface with the water fraction threshold of 0 5 is illustrated in fig 7 showing air ventilation of the suction side and significant water spray at and behind the pressure side of the strut additional images comparing snapshots from experimental videos and numerical simulations are shown in fig 8 one can notice two artificial features in the simulation image in fig 7 the aerated length of the tip vortex is rather short and the pressure side water spray exhibits a sudden end in the vertical direction these abrupt transitions occur at boundaries of the mesh refinement zone since the volume fraction of a less dominant fluid becomes smaller inside larger cells and falls below the chosen interface threshold if one is interested in accurately modeling flow beyond the immediate vicinity of the foil e g to access hydrodynamic influence on system elements located behind this foil then the refinement zones will need to be extended and this will also make simulations more computationally expensive the main results of the numerical uncertainty calculations and validation results are summarized in table 1 first using monotonically converging solution results on three grids fig 6 the richardson extrapolation was performed to determine the expected corrections δ r e to the fine mesh solution ferziger and peric 1999 12 δ r e δ 21 2 p o b 1 where δ 21 is the difference between fine and medium mesh solutions and p o b is the observed order of accuracy then the factors of safety xing and stern 2010 were applied to these corrections in order to find the grid based numerical simulation uncertainties u n s 13 u n s f δ r e where the factor of safety is determined as follows 14 f 2 45 0 85 p o b p t h if p o b p t h 1 15 f 16 4 p o b p t h 14 8 if p o b p t h 1 when comparing computational results and experimental data the total validation uncertainties u v that combine the numerical and test uncertainties need to be determined 16 u v u d 2 u n s 2 the experimental errors u d were specified by harwood et al 2016 as 12 5 of the measured mean values for the considered condition as shown in table 1 the differences between the computed and experimental force coefficients e are smaller than the validation uncertainties u v therefore it can be concluded that the present numerical approach has been validated in the subsequent simulations in this study the solver settings and mesh characteristics similar to this case with fine grid were employed 3 2 surface piercing v foil in the second validation case a v shaped hydrofoil with a wedge section was modeled fig 9 a this configuration was previously tested by fridsma 1963 the foil span was 60 2 cm dihedral was 30⁰ and the foil apex submergence was 10 2 cm due to a small chord 5 08 cm of the tested foil reynolds numbers were only about 1 6 105 at the moderate froude number of about 4 35 of interest to this study nevertheless experiments with this hydrofoil at the specified speed and submergence demonstrated the fully ventilated flow at trim angles of 10⁰ and above and the fully wetted flow could exist up to 9 5⁰ in the range between 7⁰ and 9 5⁰ partially ventilated states were also possible depending on history or disturbances for simulations of the fully ventilated flow in this study the trim of 14⁰ was selected while the 7⁰ trim was chosen to imitate the wetted state starting from the undisturbed condition the experimental setup was modeled here with the solver settings similar to the previous case but the laminar flow model was employed due to low reynolds numbers additionally due to the foil symmetry only a half of the numerical domain was considered and a symmetry boundary condition was imposed along the vertical centerplane similar to the tests the simulations showed that the foil surfaces were wet at smaller trim while at the larger trim the upper foil surface was ventilated the modeled water surface elevations in the wetted and ventilated regimes are illustrated in fig 9b and c the experimental and numerical lift and drag coefficients of the v foil for these two conditions are compared in fig 10 although no experimental uncertainties were given by fridsma 1963 typical scatter of test data were around 10 15 of the mean values given a reasonable correspondence of test and numerical results in fig 10 it can be concluded that the present approach is capable of adequately modeling the considered v shaped hydrofoil in both the wetted and ventilated regimes 3 3 two dimensional airfoil in single phase fluid the third validation case focuses on the two dimensional airfoil profile e603 fig 1b that can achieve high lift coefficients in a single phase fluid and is characterized by soft stall behavior eppler 1990 the experimental lift coefficients in the broad range of attack angles including the post stall regime were given by lasauskas and naujokaitis 2009 for a chord based reynolds number of one million the numerical simulations for this case involved the same computational settings as described above but were completed in two dimensions and for a single phase fluid a comparison of the numerical and experimental results for the lift coefficients as functions of attack angles is shown in fig 11 calculations based on the realizable k epsilon model demonstrate a very good agreement with test data prior to the stall and a relatively small overprediction of c l in the post stall regime it should be noted that experimental uncertainties were not reported for the test data the k omega model was found to work well at small to moderate attack angles fig 11 but its predictions in the stall zone were less consistent the solutions of the k omega model produced time averaged values of c l with larger deviations from the test data fig 11 hence the realizable k epsilon model was adopted for subsequent simulations of a high lift hydrofoil 4 results for inclined surface piercing hydrofoil in this section a surface piercing hydrofoil is analyzed to demonstrate performance degrading air ventilation effects as well as means for suppressing ventilation in order to achieve higher lift coefficients and lift drag ratios a hydrofoil is selected to have wing section e603 fig 1b total span to chord ratio of seven and a dihedral angle of 30⁰ as illustrated in fig 12 when reporting force coefficients the effective planform areas of surface piercing hydrofoils are usually defined using the horizontal projection of the foil portion located under the nominal undisturbed water surface for the inclined foil with the bottom tip submergence of h chord c and dihedral θ the corresponding effective aspect ratio is λ h c tan θ the effective aspect ratio based on this area is chosen in this study as four and this corresponds to the hydrofoil bottom tip submergence h of about 2 3 c all simulations presented in this section are conducted with the absolute value for the foil chord of c 0 5 m the main motivation for this study is to determine whether such surface piercing hydrofoils can produce high lift coefficients e g above one at relatively low froude numbers however as discussed above this hydrodynamic setup is likely to experience the air ventilation which may prevent achieving high c l one of the methods to constrain the ventilation process and to improve hydrodynamic performance is to employ small barriers on the foil surface that can restrict spanwise flow near the nominal water level fig 2b the barrier configuration selected in this study consists of two fences fig 12b each fence has thickness of 1 of the chord and elliptical sections with the main axis diameter of 1 2 c and the minor axis diameter of 0 4 c fig 12d and e the lower and upper fences are placed at distances 4 1 c and 5 6 c respectively along the span from the foil bottom tip fig 12c since the main purpose of the lower fence is to stop the air coming from the top on the foil suction side this fence is shifted slightly upward with respect to the foil chord line on the other hand the upper fence is shifted slightly downward since its main purpose is to restrict the water spray that is more pronounced on the foil pressure side the numerical mesh built for computational simulations follows the same approach as in validation cases considered above similar to the grid damping technique peric and abdel maksoud 2015 an additional block with coarsened mesh and damping was added near the downstream boundary to avoid numerical divergence that can be caused by highly confused nonlinear flow rooster tail near the downstream boundary at some conditions a fine grid for the surface piercing hydrofoil is illustrated in figs 13 and 14 due to higher aspect ratio of this foil the domain size became larger and the overall cell count reached about 3 7 million the default operational condition aiming at achieving high c l at reasonably low c d is selected here with the foil attack angle α 15 about the spanwise axis and chord based froude number f r u g c 3 5 additional simulations were carried out at several other angles of attack with fixed f r 3 5 and at two other froude numbers with fixed α 15 the corresponding chord based reynolds numbers were in the range of 2 2 5 5 106 the same turbulence model and other solver settings as in the main validation case described above were employed for simulating the surface piercing inclined hydrofoil the steady state numerical results for the lift and drag coefficients obtained with the clean and fenced hydrofoils at variable angles of attack are presented in fig 15 whereas images of water surfaces in several conditions are given in figs 16 20 at the attack angle α 15 the fenced hydrofoil produces nearly 50 higher c l and its lift drag ratio of 6 8 is about 25 higher than that of the clean foil the clean hydrofoil exhibits pronounced ventilation on the suction side fig 16a the air propagates from the atmosphere along the span and covers a substantial portion of the foil submerged surface thus not allowing it to generate a high lift force at the same time the water spray on the clean foil pressure side covers the entire foil surface above the water fig 16b in contrast the application of the fences limits the foil surface areas affected by ventilation and spray fig 17 the fences essentially block the downward propagation of the air on the suction side and upward water motion on the pressure side it should be kept in mind that the plotted water surfaces are isosurfaces with the water fraction of 0 5 some water exists but not shown above these surfaces whereas some air is present below them so these images would differ from experimental photographs illustrations of numerical interfaces at different threshold levels were previously presented by matveev et al 2018 to illustrate several interesting features of a wave pattern behind a surface piercing hydrofoil a top view on the water surface is given in fig 18 an upper portion of the hydrofoil is visible and two pronounced sprays formed on both pressure and suction sides of the foil propagate in the downstream direction similar to observations with ventilated surface piercing struts young et al 2017 between these sprays one can see a depression in the water caused by the air ventilated cavity which is located on the foil suction side under the nominal water surface at about 3 8 chords downstream of the submerged foil part a wave hollow is present which is typical for shallow hydrofoils its shape becomes important when selecting a favorable position for the rear foil in tandem hydrofoil systems matveev and matveev 2001 at lower attack angle of 10⁰ the difference between the clean and fenced versions becomes smaller fig 15 and it almost disappears at 5⁰ both ventilation and spray recede and the submerged part of a hydrofoil transitions into regular wetted state similar to vertical struts at small yaw angles harwood et al 2016 the fences no longer play a significant role at low flow incidence at higher attack angle of 20⁰ however the difference in hydrodynamic characteristics of the clean and fenced hydrofoils increases fig 15 the lift coefficient of the clean foil drops further down to the value similar to observation at α 5 while the fenced foil c l continues to increase showing a saturation tendency the drag coefficient of the fenced foil is only slightly higher than that of the clean foil fig 15b the lift drag ratios monotonically decrease for both hydrofoils with increasing the angle of attack in the entire range studied at high attack angles 15 20⁰ the lift drag ratio of the fenced foil is substantially larger than that of the clean foil the air water interfaces on hydrofoils operating in the extreme setup with α 20 are shown in figs 19 and 20 the suction on the upper surface of the clean hydrofoil is now sufficient to bring air down close to the bottom tip so most part of the upper surface is ventilated with air fig 19a resulting in a drop of the lift force fig 15a the water spray above the nominal water level is even more pronounced than in the previous case fig 19b fences on the modified hydrofoil still help limit air ventilation on the suction side and reduce spray on the pressure side fig 20 however the pressure near the foil leading edge drops below the vapor pressure leading to the cavitation inception fig 20a in order to simulate this early stage cavitation a cavitation module was activated in the flow solver that uses schnerr sauer cavitation model sauer 2000 while the water vapor was treated with properties of a real steam even the fenced hydrofoil version becomes not that efficient at α 20 when its lift drag ratio drops down to 5 2 from 6 8 at 15 hence this regime is not recommended for practical operations the intentional increase of the attack angle up to 20 would only make sense for brief time periods when the maximum lift is needed and only if there is enough thrust available to overcome additional drag another important operational parameter for hydrofoils is froude number the sensitivity of the clean and fenced hydrofoils to the chord based froude number f r u g c was investigated here at one attack angle of 15⁰ keeping other conditions the same the results for lift and drag coefficients are plotted in fig 21 as one can notice c l of the fenced hydrofoil is more stable which is beneficial for practical applications while the clean foil c l drops drastically with increasing speed at the lowest froude number f r 2 the water surface deformations including those caused by air ventilation are relatively small and the usage of fences results only in a minor increase of the lift coefficient fig 21a the case with f r 3 5 was discussed above and illustrated in figs 16 and 17 the air ventilation becomes important at this speed at the highest f r 5 ventilation on the clean foil increases further and both hydrofoils exhibit early stage of cavitation near the leading edge on the upper surface similar to the case with α 20 and f r 3 5 fig 20a the lift coefficient of the fenced foil remains much higher than that of the clean foil fig 21a the drag coefficient of the clean foil decreases more rapidly fig 21b so the lift drag ratios of both foils move closer to each other at f r 5 the thick high lift foils such as considered in this study are certainly not good candidates for high speed regimes at high attack angles when cavitation onset is expected at the same time high lift coefficients may not be needed at faster speeds since the lift force scales with the velocity squared and hence the same lift can be produced at smaller c l hence reducing attack angles may help extend a practical speed range for these foils 5 conclusions the air ventilation of surface piercing hydrofoils and one method for suppressing ventilation have been modeled in this work with a computational fluid dynamics cfd solver an economical setting of the computational tool was utilized including modest cell counts rans approach and reliance on the wall functions successful validation of several air ventilated configurations with this method was demonstrated suggesting that relatively inexpensive simulations can be used for determining basic features of air ventilated flows such as force coefficients of hydrofoils and prediction of wetted and ventilated flow states hydrodynamic characteristics of a simple inclined surface piercing hydrofoil with a high lift airfoil profile were shown to degrade at high attack angles and high froude numbers due to air ventilation the application of small fences placed on the hydrofoil surface near the nominal water level led to effective limitation of air ventilation which resulted in significant enhancement of the lift coefficient and in some cases of the lift drag ratio hence it is suggested that high lift hydrofoils with fences can be considered for application on foil assisted boats intended for moderate froude numbers acknowledgements this material is based upon research supported in part by the u s office of naval research under award no n00014 17 1 2553 and in part by the national science foundation under grant no 1800135 
22964,parametric roll is an important stability failure mode in the second generation intact stability criteria which are currently under development by international maritime organization imo the roll restoring arm which is one of the dominating factors for the prediction of parametric roll should be calculated preciously in this paper firstly the effects of the radiation and diffraction forces on the roll restoring arm gz r d under different heeling angles and wave amplitudes are studied based on the body exact method in which all the hydrodynamic forces are calculated by integrating wave pressure up to the wave surface secondly the effects of radiation and diffraction forces on parametric roll are studied by the direct simulation using a coupled heave roll pitch model based on the three dimensional mixed source method finally by taking one passenger ship as an example the calculation accuracy of the body exact method is compared with the commonly used body linear method the results show that the effect of radiation and diffraction forces on righting arm variation has nonlinear relationships with heeling angles and wave amplitudes and the body exact method can provide more accurate prediction results for parametric roll in head waves than the body linear method therefore the nonlinear effects of instantaneous roll angles and wave amplitudes on gz r d variation in waves should be considered for the prediction of parametric roll in head waves keywords body exact method second generation intact stability three dimensional time domain panel method roll restoring arm variation 1 introduction the second generation intact stability criteria including the calculating methods and standard values for parametric roll stability failure mode are under development by international maritime organization imo multi tiered criterion is used to make sure that the complex numerical stability assessment is only applied when the relatively simple vulnerability is not passed kobylinski 2012 level 1 and level 2 vulnerability criteria are basically deterministic while level 3 direct stability assessment is supposed to predict the occurrence of this phenomenon in high accuracy the prediction of parametric roll has been carried out by many researchers the basic mathematical models and requirements of the numerical simulation methods for parametric roll have been developed the influencing factors such as the coupling effects of other motions added resistance roll damping et al have been numerically investigated and validated by free running or captive model tests e g belenky et al 2003 france et al 2003 bulian et al 2003 taguchi 2006 spanos and papanikolaou 2007 umeda et al 2008 ogawa 2009 shigunov et al 2009 lee et al 2016 liu and papanikolaou 2016 lu et al 2017 the parametric roll may occur when the encounter wave frequency is approximately two times of the ship roll natural frequency and the roll damping of ship is insufficient to dissipate additional energy the roll restoring variation in waves is also one of the dominating factors for the occurrence of parametric roll and the occurrence of parametric roll is very sensitive to the change of gz in waves the effects of different forces moments on parametric roll can be regarded as the contribution of different components on the roll restoring arm for comparison purposes the different parts of forces moments acting on the ship are converted into a similar form to righting arm variation the component induced by froude krylov and hydrostatic forces is usually calculated by integrating the incident wave pressure around the instantaneously wetted hull surface and this components is considered in most of the prediction methods paulling 2006 however it is still uncertain whether to take the hydrodynamic effect into consideration which consists of radiation and diffraction forces acting on a heeled ship among the work which take them into account the calculations are normally based on either initial average wetted hull surface or instantaneous average submersed hull surface hashimoto and umeda 2004 found that the froude krylov prediction overestimate the amplitude of the change of the roll restoring moment in longitudinal seas by comparing numerical simulation results with captive experimental model results umeda et al 2005 further studied the prediction of roll restoring moments for a post panamax containership based on the linear theory the results demonstrate that prediction accuracy is improved when radiation and diffraction forces are taken into consideration hashimoto 2007 studied the parametric roll of one pctc car carrier using 1dof roll model the contribution of radiation and diffraction forces is taken into account under the assumption of the linear relationship between hydrodynamic moment and roll angle and the dynamic effect was obtained under the condition of 10 degrees of heel the results showed that the component of radiation and diffraction forces could improves the prediction accuracy of parametric roll based on this assumption lu et al 2011 also found that the prediction accuracy of parametric roll is improved for one containership they calculated the radiation and diffraction components acting on a heeled hull as linear components with respect to wave height ogawa 2009 also found that it is practical for the prediction of righting arm variation of heeled hull in waves when the radiation and diffraction forces of the instantaneous wetted surface of the hull is taken into account in our previous works bu et al 2014 lu et al 2017 we found an improvement in the prediction of parametric roll by considering the radiation and diffraction forces which is extrapolated nonlinearly with regard to the roll angle the hydrodynamic forces were calculated for the average hull surface determined by the hull instantaneous positions the nonlinear froude krylov and hydrostatic component was calculated by integrating the wave pressure up to the waterline while heave and pitch motions was obtained by a linear strip method from the above researches we can see that the contribution of radiation and diffraction forces does have an effect on the prediction of parametric roll however it should be mentioned that the calculation based on either the average immersed instantaneous hull surface or the initial average immersed hull surface might yield to certain discrepancies with the true values of radiation and diffraction forces exact immersed hull surface varying with time is thus interesting to take into account for the calculation conventionally it is difficult to consider the fully three dimensional nonlinear interactions between free surface and body zhou and gu 1990 and the prediction methods for ship motion are usually simplified depending on the different levels of approximations hirdaris et al 2014 previous researches show that the body exact method considering the exact immersed hull surface varying with time can capture the nonlinearities of the scattered potential beck and magee 1990 lin and yue 1990 magee 1994 zhang and beck 2006 2007 lin et al 2007 kim et al 2011 zhang et al 2010 qiu and peng 2013 in this work the body exact method is also used to capture the exact immersed hull surface varying with time the effects of radiation and diffraction forces on the prediction of parametric roll are investigated by calculating the radiation and diffraction component with the instantaneous boundary conditions based on a three dimensional panel method in regular head waves firstly the effects of radiation and diffraction forces on the prediction of roll restoring variation in waves are studied and the influencing rules are analyzed then the effects of radiation and diffraction forces on the prediction of parametric roll are investigated 2 theoretical method 2 1 hydrodynamic problem three coordinate systems are used in the simulation as shown in fig 1 the first one is the earth fixed coordinate system o xyz the o xy plane locates at the undisturbed free surface and z axis is positive up the second one is the reference coordinate system o x y z the origin o is located at the mean free surface just above or below the center of gravity this coordinate system coincides with the earth fixed coordinate system at initial time and moves with ship at forward speed u along ox the third one is the ship fixed coordinate system g xyz the origin g is fixed on the center of ship gravity where x axis is positive toward the bow and z axis is positive up the hydrodynamic problem is solved based on the potential theory with the assumption that the water is inviscid incompressible and the flow is non rotational velocity potential φ is defined in the earth fixed coordinate system oxyz 1 φ p t φ t p t φ w p t where φ t p t is the total disturbance potential which includes the radiation and diffraction of the incident wave by the hull φ w p t is the incident velocity potential which is explicitly known from current wave theory a mixed source method using both transient green functions and rankine sources has been used for the calculation of velocity potentials zhang et al 1998 liu and papanikolaou 2011 the fluid field is split into two regions as shown in fig 2 the disturbance velocity potential in inner fluid field i is solved by rankine sources within the domain enclosed by the wetted body surfaces sb one part of the free surface sf near the body sf1 and an outer control surface sc the control surface sc is about 5 times draught below the waterline the transient green functions are used in the outer fluid field ii which are distributed over control surface where s is the imaginary surface at infinity and w τ is the interaction between s and the free surface in the inner fluid field the disturbance velocity potential satisfy the following conditions 2 2 φ i 0 inner fluid field 2 φ i 2 t g φ i z 0 on s f 1 t 0 φ i n v n φ w n on s b t t 0 φ i φ i t 0 at t 0 then the boundary integral equation in terms of the rankine sources is expressed as liu and papanikolaou 2011 3 2 π φ i p t s b s f 1 s c φ i g n q φ i n q g d s q 0 where φ i is the disturbance velocity potential v the instantaneous velocity of hull surface g 1 r p q the green function p x y z the field point q ξ η ζ the source point in the outer fluid field the disturbance velocity potential satisfies the following conditions 4 2 φ ii 0 outer fluid field 2 φ ii 2 t g φ ii z 0 on s f 2 t 0 φ ii 0 on s φ ii φ ii t 0 at t 0 then boundary integral equation in terms of the transient green s function is written as 5 2 π φ ii p t s c φ ii q t n q 1 r p q 1 r p q 1 r p q 1 r p q φ ii n q d s q 0 t d τ s c g φ ii n q φ ii g n q d s q 1 g w τ v n g φ ii τ φ ii g τ d l q where φ ii is the disturbance velocity potential in fluid field ii w τ the water line of the control surface v n is the outward normal velocity of w τ if ship moves in steady forward ship u then v u i g is the transient green s function and can be written as 6 g 2 0 g k sin g k t τ e k z ζ j 0 k r d k p q t τ where j 0 is bessel function on the control surface sc the disturbance velocity potentials and their normal derivatives in the inner fluid field and outer fluid field are continuous 7 φ i φ ii φ i n φ ii n on s c when the incident wave is known the hull free surface and control surface are divided into n elements and equations 3 5 and 7 are discretized in the earth fixed coordinate system to solve the disturbance velocity potential once the total disturbance potential on the hull surface is obtained the total pressure can be calculated by bernoulli equation 8 p p t ρ φ t 1 2 φ φ g z equation 8 describes the pressure of point p at the earth fixed coordinate system hence the pressure should be transferred to the point at the ship fixed coordinate system since the equations of motion are solved in the ship fixed coordinate system sen 2002 liu and papanikolaou 2011 9 φ t d φ t φ v x y z where v x y z is the velocity of point x y z in the ship fixed coordinated system then the forces and moments on the body are obtained by integrating the above equation over the instantaneous or average submerged hull 10 f f x f y f z s b p r t n d s m m x m y m z s b r n p r t d s where r and n are radius vector and the hull surface normal vector respectively both of the vectors are defined in the ship fixed coordinate system therefore the forces and moments in equation 10 are calculated in the ship fixed coordinate system however they can be easily transformed to the earth fixed coordinate system and the reference coordinate system generally the forces moments consist of three different parts 1 froude krylov forces moments f fk 2 hydrostatic forces moments f h 3 hydrodynamic forces moments which can further divided into radiation forces moments f r and diffraction forces moments f d in this way the forces moments in the ship fixed coordinate system can be written as 11 f f f fk f h f d f r considering that the roll restoring variation in waves is one of the main reasons for the occurrence of parametric roll gz caused by different parts of forces moments can represent the effects of forces moments on parametric roll then we classified the forces and moments into two categories the first class includes froude krylov forces and hydrostatic forces which only depend on the shape of the wave and the instantaneous position of the wave acting on the ship the gz f h caused by froude krylov forces and hydrostatic forces can be described as equation 12 the second class includes radiation and diffraction forces which are closely related to the solution of velocity potential the gz r d caused by radiation and diffraction forces can be described as equation 13 12 m g g z f h f f fk f h 13 m g g z r d f f d f r for the calculation of parametric roll the nonlinear froude krylov and hydrostatic forces moment for heave roll pitch motions should be calculated by integrating wave pressure along the instantaneous wet surface of the hull up to wave surface the diagram is shown in fig 3 2 2 body boundary conditions the calculation of radiation and diffraction forces is related to the solution method of body boundary conditions generally there are three methods dealing with the body boundary conditions singh and sen 2007 1 linear method the hydrodynamic forces are calculated based on the initial averaged submerged hull as shown in fig 4 a 2 body nonlinear method the hydrodynamic forces are calculated based on the instantaneous average hull surface as shown in fig 4 b 3 body exact method the hydrodynamic forces are computed over the instantaneous hull surface below the incident wave surface shown as fig 4 c this method has been also described as weak scatter method in which the disturbed waves are assumed to be small compared with incident waves lin et al 1994 in this paper the radiation and diffraction forces are calculated with two different boundary conditions 1 boundary condition 1 initial mean wetted hull surface body linear method the velocity potential is solved based on the initial mean wetted hull surface s that is s s b 0 fig 4 a thus the radiation and diffraction forces are linear 2 boundary condition 2 instantaneous wetted surface body exact method here we assume that the diffracted waves are small compared to the incident waves and the linear free surface condition is still used the radiation and diffraction forces are calculated for an instantaneous submerged hull fig 4 c by considering a time dependent position and wave height and the forces for heave and pitch motions are also calculated based on instantaneously hull surface in this method the ship geometry is split every time according to the instantaneous wave profile and the disturbance velocity is solved at every step the calculation of gz caused by radiation and diffraction forces can also be approximated under the assumption that it has the linear relationship with the roll angle according to the seakeeping theory this dynamic effect component can be calculated based on 10 degrees of heel condition hashimoto 2007 therefore we also study the applicability of this linear relationship 14 g z r d g z r d 10 10 ϕ where g z r d is the component of gz caused by radiation and diffraction forces g z r d 10 is the component of gz at constant heeling angles 10 2 3 mathematical model the coupled heave roll pitch mathematical model expressed as formula 15 is used to for the calculation of parametric roll 15 m a 33 ζ b 33 ζ a 34 ϕ b 34 ϕ a 35 θ b 35 θ f 3 f k h f 3 d f i x x a 44 ϕ n 1 ϕ n 3 ϕ 3 a 43 ζ b 43 ζ a 45 θ b 45 θ f 4 f k h f 4 d f i y y a 55 θ b 55 θ a 53 ζ b 53 ζ a 54 ϕ b 54 ϕ f 5 f k h f 5 d f where m ship mass i xx the inertia of roll moment i yy the inertia of pitch moment a ij and b ij added mass added moment of inertia and damping coefficient ζ heave displacement θ pitch angle ϕ roll angle n 1 n 3 the linear and cubic roll damping moments which can be calculated according to equation 16 f fk h the fk forces and hydrostatic forces calculated by integrating the incident wave pressure around the instantaneous wetted hull surface f df diffraction forces calculated the same as radiation forces 16 2 α n 1 i x x a 44 γ n 3 i x x a 44 where α and γ are linear and cubic roll damping coefficients and can be calculated using the well known energy relationship equation 17 17 α ω ϕ π a γ 4 3 π 2 2 π ω ϕ 180 π 2 c where coefficients a and c can be inferred from model tests or experience formulas in this paper the coefficients are obtained by fitting the free roll decay curves using linear and cubic terms for the study of the effects of radiation and diffraction forces on roll restoring variation and parametric roll gz r d in roll direction can be written as 18 g z r d f 4 d f a 43 ζ b 43 ζ a 45 θ b 45 θ m g 3 experiments the free running model tests with a 1 34 85 scaled model of a passenger ship were conducted the principal particulars of the ship are listed in table 1 the measuring system has been developed and validated by the international standard model c11 containership provided by imo for the research of parametric roll bu et al 2014 lu et al 2017 the free running model test of the passenger ship with and without bilge keel were conducted in the seakeeping basin length 69 m breadth 46 m depth 4 m of china ship scientific research center which is equipped with flap wave makers at two adjacent sides of the basin the ship model was driven by a propeller in regular head seas in the free running experiment as shown in fig 5 the pitch and roll amplitudes were measured by a micro electro mechanical system mems based gyroscope placed on the ship model the wave elevation was measured by a servo needle wave height sensor attached to the towing carriage before performing free running model test for parametric roll the free roll decay tests in calm water were carried out and the free roll decay curves are shown in fig 6 then the linear and cubic roll damping coefficients can be obtained by the fitting of extinction curves as shown in fig 7 4 simulation model in the simulation the hull geometry is shown in fig 8 and the panels are shown in fig 9 900 panels on geometry and 1200 panels on the free surface are used the boundaries of the inner fluid domain are enclosed by the control surface with the length and width of 1 5l pp and 3 5b respectively the ship main section is located at the center of the inner fluid domain 5 results and discussions 5 1 effects of radiation and diffraction forces on the roll restoring arm in waves the gz component induced by radiation and diffraction moments gz r d are calculated at different constant heeling angles ϕ c 4 8 12 20 under different froude numbers as shown in fig 10 a the amplitude of gz r d shows an increasing trend with the increase of heeling angles variations of gz r d at three different forward speeds under a constant heeling angle 10 are depicted in fig 10 b the amplitude of gz r d becomes larger with the increase of the froude number it needs to be noticed that the relationships between gz r d and the heeling angle or fn both represent a nonlinear growth the proportion of the gz r d in gz is further studied under the condition λ l pp 1 0 h λ 0 04 at constant heeling angle ϕ c 10 as shown in fig 11 the gz r d does have an effect on the overall composition of gz even though it accounts for a small proportion yet the impact become larger with the increase of ship speed fig 12 displays the amplitudes of different gz components by fft when fn 0 1 it can be seen from the results that the phenomenon of the superposition of multi frequencies is very obvious the component of gz r d cannot be ignored compared with gz f h at the first harmonic frequency moreover gz r d is much larger than gz f h at the second resonance frequency this indicates that the component of gz r d should not be ignored since even a small difference of restoring arm variation could result in a large difference of the roll amplitude in prediction of parametric roll hashimoto 2007 in other words gz r d may have some non negligible effects on the roll motion the radiation and diffraction moments are always calculated based on the linear assumption in the seakeeping theory six constant heeling angles are chosen including three small angles 4 8 and 12 and three large angles 14 18 and 20 to investigate the applicability of this hypothesis as shown in fig 13 gz r d calculated based on linear assumption are almost the same with that calculated by body exact method at small heeling angles which means gz r d has a linear relationship with small heeling angles however linear approximation method overestimate the gz r d values at large heeling angles this indicates that it is necessary to consider the instantaneous exact immersed hull surface for the calculation of gz r d at large heeling angles fig 14 displays the fft comparisons of gz r d calculated by directly integration and linear approximation under constant heeling angles of 20 and 30 we can see that calculation results by the approximate method gives much larger values of the amplitudes of gz r d than those calculated by the body exact method this overestimation reveals that the hydrodynamic restoring variation component should be modeled nonlinearly which is consistent with our previous research results of container ships lu et al 2017 in addition to the linear assumption about the radiation and diffraction moments with heeling angles the radiation and diffraction moments also have a linear relationship with wave amplitude according to the seakeeping theory this assumption is based on the average hull wetted surface on which the pressure increases proportionately with wave amplitudes in fact the instantaneous relative position of ship wave is distinctly different from the average wetted surface when the wave height increases and the nonlinear effect will become obvious in view of this we compare the results calculated by a direct simulation and a linear approximation at two wave amplitudes with different ship forward speeds as shown in fig 15 gz r d calculated by the exact body surface are obviously larger than that calculated by the linear approximate method at high wave amplitudes the discrepancy at the small amplitude is even appreciable when there is a speed let alone the condition of high waves fig 16 displays the fft comparisons of gz r d a large discrepancy between the two methods can be observed the linear approximate method can only predict a small portion of gz indicating a remarkable nonlinearities of gz r d this may be due to the fact that the instantaneous elevations calculated by direct integration of the wave surface are larger than that calculated by linear approximation which can be validated by comparing the change of elevations with time calculated by different methods the time records of instantaneous elevations at different constant points under the condition fn 0 1 ζ a wave amplitude 4 m are shown in fig 17 four fixed points located on the free surface near the ship body are chosen and the coordinate positions of the four points are 0 2 12 6 0 15 0 12 1 0 26 10 8 0 and 9 8 12 1 0 respectively the nonlinear characteristic of the elevations calculated by the body exact method are more pronounced than that calculated by linear approximation based on unit wave amplitude it can be seen from the above analysis that the linear relationship between the moments of radiation diffraction and the heeling angles is not applicable for large roll motions and the nonlinear relationship should be taken into account for the prediction of large roll motion further studies and improvements are required to calculate the radiation and diffraction component of the dynamic restoring force in real time according to the rolling angle it can be also seen that the assumption that radiation and diffraction forces are linearly related to the wave amplitude is not valid for high waves therefore the change of the roll restoring arm caused by the radiation and the diffraction forces should also be taken into account for the prediction of large roll motion especially the phenomenon of parametric roll 5 2 effects of radiation and diffraction forces on parametric roll considering that gz r d represents the nonlinear change trends with the heeling angle and the wave amplitude two methods are used to calculate the effects of gz r d on the roll prediction one is the body linear method in which froude krylov and hydrostatic forces are calculated along the instantaneous wetted surface and the radiation and diffraction forces are calculated on the average wetted surface with an upright hull although this method considers the radiation and diffraction forces in roll direction yet the values in regular head waves with an upright symmetric hull are near zero and thus can be ignored the other is the body exact method in which all forces are integrated along the instantaneous hull surface the calculation results in the time domain and in the frequency domain using fft are compared with experimental results taking one condition as an example as shown in fig 18 the current two methods can both predict parametric roll well but the results of roll amplitudes predicted by body exact method show a better agreement with experimental results than that by the body linear method the roll amplitudes of parametric roll with different wave steepness h λ when the wave length equals to ship length with and without bilge keel at zero speed are further compared with experimental results as shown in fig 19 the body exact method gives closer values to experimental results showing a slight improvement in the accuracy than the body linear method except for the lower steepness this can be attributed to the fact that gz r d accounts for a certain proportion of gz resulting in a difference in the calculated roll amplitudes consequently then the parametric roll with a wave steepness of h λ 0 08 is investigated the comparison results of roll motion is shown in fig 20 three typical times in one period are chosen to compare the differences between these two methods the roll amplitudes calculated by the body linear method and the body exact method at t 0 83 62s are 26 0 and 30 09 respectively at t 1 86 76s the calculated roll amplitudes are 0 16 and 0 81 respectively at t 2 91 74s the roll amplitudes change to 26 04 and 30 08 respectively the difference in maximum roll amplitudes calculated by two methods is perceived to be around 4 fig 21 displays the instantaneous locations of the hull with respect to the wave under different time steps it can be seen that the instantaneous hull surface is used in the body exact method while the constant initial mean free surface is used in body linear method obviously the body linear method cannot describe the wave profile well and this is the main reason for the difference of the prediction results by these two methods fig 22 displays the differences of hull surface used for the calculation of froude krylov and hydrostatic forces and the instantaneous hull surface are used in both methods we further compare the results with a larger wave steepness of h λ 0 09 as shown in fig 23 the difference of roll amplitudes between two methods is almost 6 the difference in roll amplitudes could also be explained by the difference in the radiation and diffraction roll moments calculated by these two methods as depicted in fig 24 a in which an appreciable difference between these two methods is observed in addition a small difference in the calculated hydrostatic and fk forces is also perceived as shown in fig 24 b this is easy to understand because the calculated instantaneous hull position would be different as a consequence of the difference in the stable roll amplitudes caused by radiation and diffraction moments in order to investigate the influence of radiation and diffraction forces under the conditions of other waver lengths the wave length equals to 0 8 times of the ship length is further chosen and the roll amplitudes under different wave steepness are shown in fig 25 it is observed that roll amplitudes calculated by both methods increase with the wave steepness the body exact method yield a lower value under all investigated wave steepness the discrepancy between these two methods under a large wave steepness tends to be widened the above analysis reveals that the ship speed is also an influencing factor for the radiation and diffraction forces thus another case with a speed of fn 0 05 under the wave condition λ l pp 1 0 χ 180 ζ a 2 1 m was further investigated the comparison of roll motion is displayed in fig 26 the body linear method yields a relatively larger stable roll amplitude over that calculated by the body exact method the difference between two methods in roll amplitude is almost 4 5 similarly the difference can also be found by fft analysis as depicted in fig 27 a further checking the radiation and diffraction forces calculated by these two methods allows us to explain the difference in roll motion as show in fig 27 b there is a remarkable difference in the radiation and diffraction forces by fft we can also see that the nonlinear feature caused by the hull surface is very clear in the body exact method 6 conclusions this paper aims to investigate the effects of radiation and diffraction moments on the prediction of parametric roll based on a three dimensional time domain panel method from the analysis the following remarks can be obtained 1 the hydrodynamic component including radiation and diffraction moments has a nonlinear relationship with roll angles especially for large roll amplitudes therefore the instantaneous roll angles should be considered in the calculation of radiation and diffraction moments 2 the hydrodynamic component including radiation and diffraction moments has a nonlinear relationship with the wave amplitude especially for high waves the nonlinear characteristics become more pronounced with the increase of the ship speed therefore the linear seakeeping theory should be improved for the calculation of large roll amplitude at high wave steepness by considering the real wave amplitude 3 radiation and diffraction moments do have an influence on the prediction of parametric roll in head waves a slight improvement is achieved by taking the effects into account although the effects of radiation and diffraction moments on parametric roll were found to have a mild influence on parametric roll the influence could be enhanced under certain conditions e g a ship sensitive to parametric roll sailing under critical conditions future research could focus on this topic acknowledgements part of the research was conducted in the institute of fluid dynamic and ship theory during the first author s study in hamburg university of technology this work was supported by ministry of industry and information technology of china no 2016 184 2017 614 the authors sincerely thank the above organization 
22964,parametric roll is an important stability failure mode in the second generation intact stability criteria which are currently under development by international maritime organization imo the roll restoring arm which is one of the dominating factors for the prediction of parametric roll should be calculated preciously in this paper firstly the effects of the radiation and diffraction forces on the roll restoring arm gz r d under different heeling angles and wave amplitudes are studied based on the body exact method in which all the hydrodynamic forces are calculated by integrating wave pressure up to the wave surface secondly the effects of radiation and diffraction forces on parametric roll are studied by the direct simulation using a coupled heave roll pitch model based on the three dimensional mixed source method finally by taking one passenger ship as an example the calculation accuracy of the body exact method is compared with the commonly used body linear method the results show that the effect of radiation and diffraction forces on righting arm variation has nonlinear relationships with heeling angles and wave amplitudes and the body exact method can provide more accurate prediction results for parametric roll in head waves than the body linear method therefore the nonlinear effects of instantaneous roll angles and wave amplitudes on gz r d variation in waves should be considered for the prediction of parametric roll in head waves keywords body exact method second generation intact stability three dimensional time domain panel method roll restoring arm variation 1 introduction the second generation intact stability criteria including the calculating methods and standard values for parametric roll stability failure mode are under development by international maritime organization imo multi tiered criterion is used to make sure that the complex numerical stability assessment is only applied when the relatively simple vulnerability is not passed kobylinski 2012 level 1 and level 2 vulnerability criteria are basically deterministic while level 3 direct stability assessment is supposed to predict the occurrence of this phenomenon in high accuracy the prediction of parametric roll has been carried out by many researchers the basic mathematical models and requirements of the numerical simulation methods for parametric roll have been developed the influencing factors such as the coupling effects of other motions added resistance roll damping et al have been numerically investigated and validated by free running or captive model tests e g belenky et al 2003 france et al 2003 bulian et al 2003 taguchi 2006 spanos and papanikolaou 2007 umeda et al 2008 ogawa 2009 shigunov et al 2009 lee et al 2016 liu and papanikolaou 2016 lu et al 2017 the parametric roll may occur when the encounter wave frequency is approximately two times of the ship roll natural frequency and the roll damping of ship is insufficient to dissipate additional energy the roll restoring variation in waves is also one of the dominating factors for the occurrence of parametric roll and the occurrence of parametric roll is very sensitive to the change of gz in waves the effects of different forces moments on parametric roll can be regarded as the contribution of different components on the roll restoring arm for comparison purposes the different parts of forces moments acting on the ship are converted into a similar form to righting arm variation the component induced by froude krylov and hydrostatic forces is usually calculated by integrating the incident wave pressure around the instantaneously wetted hull surface and this components is considered in most of the prediction methods paulling 2006 however it is still uncertain whether to take the hydrodynamic effect into consideration which consists of radiation and diffraction forces acting on a heeled ship among the work which take them into account the calculations are normally based on either initial average wetted hull surface or instantaneous average submersed hull surface hashimoto and umeda 2004 found that the froude krylov prediction overestimate the amplitude of the change of the roll restoring moment in longitudinal seas by comparing numerical simulation results with captive experimental model results umeda et al 2005 further studied the prediction of roll restoring moments for a post panamax containership based on the linear theory the results demonstrate that prediction accuracy is improved when radiation and diffraction forces are taken into consideration hashimoto 2007 studied the parametric roll of one pctc car carrier using 1dof roll model the contribution of radiation and diffraction forces is taken into account under the assumption of the linear relationship between hydrodynamic moment and roll angle and the dynamic effect was obtained under the condition of 10 degrees of heel the results showed that the component of radiation and diffraction forces could improves the prediction accuracy of parametric roll based on this assumption lu et al 2011 also found that the prediction accuracy of parametric roll is improved for one containership they calculated the radiation and diffraction components acting on a heeled hull as linear components with respect to wave height ogawa 2009 also found that it is practical for the prediction of righting arm variation of heeled hull in waves when the radiation and diffraction forces of the instantaneous wetted surface of the hull is taken into account in our previous works bu et al 2014 lu et al 2017 we found an improvement in the prediction of parametric roll by considering the radiation and diffraction forces which is extrapolated nonlinearly with regard to the roll angle the hydrodynamic forces were calculated for the average hull surface determined by the hull instantaneous positions the nonlinear froude krylov and hydrostatic component was calculated by integrating the wave pressure up to the waterline while heave and pitch motions was obtained by a linear strip method from the above researches we can see that the contribution of radiation and diffraction forces does have an effect on the prediction of parametric roll however it should be mentioned that the calculation based on either the average immersed instantaneous hull surface or the initial average immersed hull surface might yield to certain discrepancies with the true values of radiation and diffraction forces exact immersed hull surface varying with time is thus interesting to take into account for the calculation conventionally it is difficult to consider the fully three dimensional nonlinear interactions between free surface and body zhou and gu 1990 and the prediction methods for ship motion are usually simplified depending on the different levels of approximations hirdaris et al 2014 previous researches show that the body exact method considering the exact immersed hull surface varying with time can capture the nonlinearities of the scattered potential beck and magee 1990 lin and yue 1990 magee 1994 zhang and beck 2006 2007 lin et al 2007 kim et al 2011 zhang et al 2010 qiu and peng 2013 in this work the body exact method is also used to capture the exact immersed hull surface varying with time the effects of radiation and diffraction forces on the prediction of parametric roll are investigated by calculating the radiation and diffraction component with the instantaneous boundary conditions based on a three dimensional panel method in regular head waves firstly the effects of radiation and diffraction forces on the prediction of roll restoring variation in waves are studied and the influencing rules are analyzed then the effects of radiation and diffraction forces on the prediction of parametric roll are investigated 2 theoretical method 2 1 hydrodynamic problem three coordinate systems are used in the simulation as shown in fig 1 the first one is the earth fixed coordinate system o xyz the o xy plane locates at the undisturbed free surface and z axis is positive up the second one is the reference coordinate system o x y z the origin o is located at the mean free surface just above or below the center of gravity this coordinate system coincides with the earth fixed coordinate system at initial time and moves with ship at forward speed u along ox the third one is the ship fixed coordinate system g xyz the origin g is fixed on the center of ship gravity where x axis is positive toward the bow and z axis is positive up the hydrodynamic problem is solved based on the potential theory with the assumption that the water is inviscid incompressible and the flow is non rotational velocity potential φ is defined in the earth fixed coordinate system oxyz 1 φ p t φ t p t φ w p t where φ t p t is the total disturbance potential which includes the radiation and diffraction of the incident wave by the hull φ w p t is the incident velocity potential which is explicitly known from current wave theory a mixed source method using both transient green functions and rankine sources has been used for the calculation of velocity potentials zhang et al 1998 liu and papanikolaou 2011 the fluid field is split into two regions as shown in fig 2 the disturbance velocity potential in inner fluid field i is solved by rankine sources within the domain enclosed by the wetted body surfaces sb one part of the free surface sf near the body sf1 and an outer control surface sc the control surface sc is about 5 times draught below the waterline the transient green functions are used in the outer fluid field ii which are distributed over control surface where s is the imaginary surface at infinity and w τ is the interaction between s and the free surface in the inner fluid field the disturbance velocity potential satisfy the following conditions 2 2 φ i 0 inner fluid field 2 φ i 2 t g φ i z 0 on s f 1 t 0 φ i n v n φ w n on s b t t 0 φ i φ i t 0 at t 0 then the boundary integral equation in terms of the rankine sources is expressed as liu and papanikolaou 2011 3 2 π φ i p t s b s f 1 s c φ i g n q φ i n q g d s q 0 where φ i is the disturbance velocity potential v the instantaneous velocity of hull surface g 1 r p q the green function p x y z the field point q ξ η ζ the source point in the outer fluid field the disturbance velocity potential satisfies the following conditions 4 2 φ ii 0 outer fluid field 2 φ ii 2 t g φ ii z 0 on s f 2 t 0 φ ii 0 on s φ ii φ ii t 0 at t 0 then boundary integral equation in terms of the transient green s function is written as 5 2 π φ ii p t s c φ ii q t n q 1 r p q 1 r p q 1 r p q 1 r p q φ ii n q d s q 0 t d τ s c g φ ii n q φ ii g n q d s q 1 g w τ v n g φ ii τ φ ii g τ d l q where φ ii is the disturbance velocity potential in fluid field ii w τ the water line of the control surface v n is the outward normal velocity of w τ if ship moves in steady forward ship u then v u i g is the transient green s function and can be written as 6 g 2 0 g k sin g k t τ e k z ζ j 0 k r d k p q t τ where j 0 is bessel function on the control surface sc the disturbance velocity potentials and their normal derivatives in the inner fluid field and outer fluid field are continuous 7 φ i φ ii φ i n φ ii n on s c when the incident wave is known the hull free surface and control surface are divided into n elements and equations 3 5 and 7 are discretized in the earth fixed coordinate system to solve the disturbance velocity potential once the total disturbance potential on the hull surface is obtained the total pressure can be calculated by bernoulli equation 8 p p t ρ φ t 1 2 φ φ g z equation 8 describes the pressure of point p at the earth fixed coordinate system hence the pressure should be transferred to the point at the ship fixed coordinate system since the equations of motion are solved in the ship fixed coordinate system sen 2002 liu and papanikolaou 2011 9 φ t d φ t φ v x y z where v x y z is the velocity of point x y z in the ship fixed coordinated system then the forces and moments on the body are obtained by integrating the above equation over the instantaneous or average submerged hull 10 f f x f y f z s b p r t n d s m m x m y m z s b r n p r t d s where r and n are radius vector and the hull surface normal vector respectively both of the vectors are defined in the ship fixed coordinate system therefore the forces and moments in equation 10 are calculated in the ship fixed coordinate system however they can be easily transformed to the earth fixed coordinate system and the reference coordinate system generally the forces moments consist of three different parts 1 froude krylov forces moments f fk 2 hydrostatic forces moments f h 3 hydrodynamic forces moments which can further divided into radiation forces moments f r and diffraction forces moments f d in this way the forces moments in the ship fixed coordinate system can be written as 11 f f f fk f h f d f r considering that the roll restoring variation in waves is one of the main reasons for the occurrence of parametric roll gz caused by different parts of forces moments can represent the effects of forces moments on parametric roll then we classified the forces and moments into two categories the first class includes froude krylov forces and hydrostatic forces which only depend on the shape of the wave and the instantaneous position of the wave acting on the ship the gz f h caused by froude krylov forces and hydrostatic forces can be described as equation 12 the second class includes radiation and diffraction forces which are closely related to the solution of velocity potential the gz r d caused by radiation and diffraction forces can be described as equation 13 12 m g g z f h f f fk f h 13 m g g z r d f f d f r for the calculation of parametric roll the nonlinear froude krylov and hydrostatic forces moment for heave roll pitch motions should be calculated by integrating wave pressure along the instantaneous wet surface of the hull up to wave surface the diagram is shown in fig 3 2 2 body boundary conditions the calculation of radiation and diffraction forces is related to the solution method of body boundary conditions generally there are three methods dealing with the body boundary conditions singh and sen 2007 1 linear method the hydrodynamic forces are calculated based on the initial averaged submerged hull as shown in fig 4 a 2 body nonlinear method the hydrodynamic forces are calculated based on the instantaneous average hull surface as shown in fig 4 b 3 body exact method the hydrodynamic forces are computed over the instantaneous hull surface below the incident wave surface shown as fig 4 c this method has been also described as weak scatter method in which the disturbed waves are assumed to be small compared with incident waves lin et al 1994 in this paper the radiation and diffraction forces are calculated with two different boundary conditions 1 boundary condition 1 initial mean wetted hull surface body linear method the velocity potential is solved based on the initial mean wetted hull surface s that is s s b 0 fig 4 a thus the radiation and diffraction forces are linear 2 boundary condition 2 instantaneous wetted surface body exact method here we assume that the diffracted waves are small compared to the incident waves and the linear free surface condition is still used the radiation and diffraction forces are calculated for an instantaneous submerged hull fig 4 c by considering a time dependent position and wave height and the forces for heave and pitch motions are also calculated based on instantaneously hull surface in this method the ship geometry is split every time according to the instantaneous wave profile and the disturbance velocity is solved at every step the calculation of gz caused by radiation and diffraction forces can also be approximated under the assumption that it has the linear relationship with the roll angle according to the seakeeping theory this dynamic effect component can be calculated based on 10 degrees of heel condition hashimoto 2007 therefore we also study the applicability of this linear relationship 14 g z r d g z r d 10 10 ϕ where g z r d is the component of gz caused by radiation and diffraction forces g z r d 10 is the component of gz at constant heeling angles 10 2 3 mathematical model the coupled heave roll pitch mathematical model expressed as formula 15 is used to for the calculation of parametric roll 15 m a 33 ζ b 33 ζ a 34 ϕ b 34 ϕ a 35 θ b 35 θ f 3 f k h f 3 d f i x x a 44 ϕ n 1 ϕ n 3 ϕ 3 a 43 ζ b 43 ζ a 45 θ b 45 θ f 4 f k h f 4 d f i y y a 55 θ b 55 θ a 53 ζ b 53 ζ a 54 ϕ b 54 ϕ f 5 f k h f 5 d f where m ship mass i xx the inertia of roll moment i yy the inertia of pitch moment a ij and b ij added mass added moment of inertia and damping coefficient ζ heave displacement θ pitch angle ϕ roll angle n 1 n 3 the linear and cubic roll damping moments which can be calculated according to equation 16 f fk h the fk forces and hydrostatic forces calculated by integrating the incident wave pressure around the instantaneous wetted hull surface f df diffraction forces calculated the same as radiation forces 16 2 α n 1 i x x a 44 γ n 3 i x x a 44 where α and γ are linear and cubic roll damping coefficients and can be calculated using the well known energy relationship equation 17 17 α ω ϕ π a γ 4 3 π 2 2 π ω ϕ 180 π 2 c where coefficients a and c can be inferred from model tests or experience formulas in this paper the coefficients are obtained by fitting the free roll decay curves using linear and cubic terms for the study of the effects of radiation and diffraction forces on roll restoring variation and parametric roll gz r d in roll direction can be written as 18 g z r d f 4 d f a 43 ζ b 43 ζ a 45 θ b 45 θ m g 3 experiments the free running model tests with a 1 34 85 scaled model of a passenger ship were conducted the principal particulars of the ship are listed in table 1 the measuring system has been developed and validated by the international standard model c11 containership provided by imo for the research of parametric roll bu et al 2014 lu et al 2017 the free running model test of the passenger ship with and without bilge keel were conducted in the seakeeping basin length 69 m breadth 46 m depth 4 m of china ship scientific research center which is equipped with flap wave makers at two adjacent sides of the basin the ship model was driven by a propeller in regular head seas in the free running experiment as shown in fig 5 the pitch and roll amplitudes were measured by a micro electro mechanical system mems based gyroscope placed on the ship model the wave elevation was measured by a servo needle wave height sensor attached to the towing carriage before performing free running model test for parametric roll the free roll decay tests in calm water were carried out and the free roll decay curves are shown in fig 6 then the linear and cubic roll damping coefficients can be obtained by the fitting of extinction curves as shown in fig 7 4 simulation model in the simulation the hull geometry is shown in fig 8 and the panels are shown in fig 9 900 panels on geometry and 1200 panels on the free surface are used the boundaries of the inner fluid domain are enclosed by the control surface with the length and width of 1 5l pp and 3 5b respectively the ship main section is located at the center of the inner fluid domain 5 results and discussions 5 1 effects of radiation and diffraction forces on the roll restoring arm in waves the gz component induced by radiation and diffraction moments gz r d are calculated at different constant heeling angles ϕ c 4 8 12 20 under different froude numbers as shown in fig 10 a the amplitude of gz r d shows an increasing trend with the increase of heeling angles variations of gz r d at three different forward speeds under a constant heeling angle 10 are depicted in fig 10 b the amplitude of gz r d becomes larger with the increase of the froude number it needs to be noticed that the relationships between gz r d and the heeling angle or fn both represent a nonlinear growth the proportion of the gz r d in gz is further studied under the condition λ l pp 1 0 h λ 0 04 at constant heeling angle ϕ c 10 as shown in fig 11 the gz r d does have an effect on the overall composition of gz even though it accounts for a small proportion yet the impact become larger with the increase of ship speed fig 12 displays the amplitudes of different gz components by fft when fn 0 1 it can be seen from the results that the phenomenon of the superposition of multi frequencies is very obvious the component of gz r d cannot be ignored compared with gz f h at the first harmonic frequency moreover gz r d is much larger than gz f h at the second resonance frequency this indicates that the component of gz r d should not be ignored since even a small difference of restoring arm variation could result in a large difference of the roll amplitude in prediction of parametric roll hashimoto 2007 in other words gz r d may have some non negligible effects on the roll motion the radiation and diffraction moments are always calculated based on the linear assumption in the seakeeping theory six constant heeling angles are chosen including three small angles 4 8 and 12 and three large angles 14 18 and 20 to investigate the applicability of this hypothesis as shown in fig 13 gz r d calculated based on linear assumption are almost the same with that calculated by body exact method at small heeling angles which means gz r d has a linear relationship with small heeling angles however linear approximation method overestimate the gz r d values at large heeling angles this indicates that it is necessary to consider the instantaneous exact immersed hull surface for the calculation of gz r d at large heeling angles fig 14 displays the fft comparisons of gz r d calculated by directly integration and linear approximation under constant heeling angles of 20 and 30 we can see that calculation results by the approximate method gives much larger values of the amplitudes of gz r d than those calculated by the body exact method this overestimation reveals that the hydrodynamic restoring variation component should be modeled nonlinearly which is consistent with our previous research results of container ships lu et al 2017 in addition to the linear assumption about the radiation and diffraction moments with heeling angles the radiation and diffraction moments also have a linear relationship with wave amplitude according to the seakeeping theory this assumption is based on the average hull wetted surface on which the pressure increases proportionately with wave amplitudes in fact the instantaneous relative position of ship wave is distinctly different from the average wetted surface when the wave height increases and the nonlinear effect will become obvious in view of this we compare the results calculated by a direct simulation and a linear approximation at two wave amplitudes with different ship forward speeds as shown in fig 15 gz r d calculated by the exact body surface are obviously larger than that calculated by the linear approximate method at high wave amplitudes the discrepancy at the small amplitude is even appreciable when there is a speed let alone the condition of high waves fig 16 displays the fft comparisons of gz r d a large discrepancy between the two methods can be observed the linear approximate method can only predict a small portion of gz indicating a remarkable nonlinearities of gz r d this may be due to the fact that the instantaneous elevations calculated by direct integration of the wave surface are larger than that calculated by linear approximation which can be validated by comparing the change of elevations with time calculated by different methods the time records of instantaneous elevations at different constant points under the condition fn 0 1 ζ a wave amplitude 4 m are shown in fig 17 four fixed points located on the free surface near the ship body are chosen and the coordinate positions of the four points are 0 2 12 6 0 15 0 12 1 0 26 10 8 0 and 9 8 12 1 0 respectively the nonlinear characteristic of the elevations calculated by the body exact method are more pronounced than that calculated by linear approximation based on unit wave amplitude it can be seen from the above analysis that the linear relationship between the moments of radiation diffraction and the heeling angles is not applicable for large roll motions and the nonlinear relationship should be taken into account for the prediction of large roll motion further studies and improvements are required to calculate the radiation and diffraction component of the dynamic restoring force in real time according to the rolling angle it can be also seen that the assumption that radiation and diffraction forces are linearly related to the wave amplitude is not valid for high waves therefore the change of the roll restoring arm caused by the radiation and the diffraction forces should also be taken into account for the prediction of large roll motion especially the phenomenon of parametric roll 5 2 effects of radiation and diffraction forces on parametric roll considering that gz r d represents the nonlinear change trends with the heeling angle and the wave amplitude two methods are used to calculate the effects of gz r d on the roll prediction one is the body linear method in which froude krylov and hydrostatic forces are calculated along the instantaneous wetted surface and the radiation and diffraction forces are calculated on the average wetted surface with an upright hull although this method considers the radiation and diffraction forces in roll direction yet the values in regular head waves with an upright symmetric hull are near zero and thus can be ignored the other is the body exact method in which all forces are integrated along the instantaneous hull surface the calculation results in the time domain and in the frequency domain using fft are compared with experimental results taking one condition as an example as shown in fig 18 the current two methods can both predict parametric roll well but the results of roll amplitudes predicted by body exact method show a better agreement with experimental results than that by the body linear method the roll amplitudes of parametric roll with different wave steepness h λ when the wave length equals to ship length with and without bilge keel at zero speed are further compared with experimental results as shown in fig 19 the body exact method gives closer values to experimental results showing a slight improvement in the accuracy than the body linear method except for the lower steepness this can be attributed to the fact that gz r d accounts for a certain proportion of gz resulting in a difference in the calculated roll amplitudes consequently then the parametric roll with a wave steepness of h λ 0 08 is investigated the comparison results of roll motion is shown in fig 20 three typical times in one period are chosen to compare the differences between these two methods the roll amplitudes calculated by the body linear method and the body exact method at t 0 83 62s are 26 0 and 30 09 respectively at t 1 86 76s the calculated roll amplitudes are 0 16 and 0 81 respectively at t 2 91 74s the roll amplitudes change to 26 04 and 30 08 respectively the difference in maximum roll amplitudes calculated by two methods is perceived to be around 4 fig 21 displays the instantaneous locations of the hull with respect to the wave under different time steps it can be seen that the instantaneous hull surface is used in the body exact method while the constant initial mean free surface is used in body linear method obviously the body linear method cannot describe the wave profile well and this is the main reason for the difference of the prediction results by these two methods fig 22 displays the differences of hull surface used for the calculation of froude krylov and hydrostatic forces and the instantaneous hull surface are used in both methods we further compare the results with a larger wave steepness of h λ 0 09 as shown in fig 23 the difference of roll amplitudes between two methods is almost 6 the difference in roll amplitudes could also be explained by the difference in the radiation and diffraction roll moments calculated by these two methods as depicted in fig 24 a in which an appreciable difference between these two methods is observed in addition a small difference in the calculated hydrostatic and fk forces is also perceived as shown in fig 24 b this is easy to understand because the calculated instantaneous hull position would be different as a consequence of the difference in the stable roll amplitudes caused by radiation and diffraction moments in order to investigate the influence of radiation and diffraction forces under the conditions of other waver lengths the wave length equals to 0 8 times of the ship length is further chosen and the roll amplitudes under different wave steepness are shown in fig 25 it is observed that roll amplitudes calculated by both methods increase with the wave steepness the body exact method yield a lower value under all investigated wave steepness the discrepancy between these two methods under a large wave steepness tends to be widened the above analysis reveals that the ship speed is also an influencing factor for the radiation and diffraction forces thus another case with a speed of fn 0 05 under the wave condition λ l pp 1 0 χ 180 ζ a 2 1 m was further investigated the comparison of roll motion is displayed in fig 26 the body linear method yields a relatively larger stable roll amplitude over that calculated by the body exact method the difference between two methods in roll amplitude is almost 4 5 similarly the difference can also be found by fft analysis as depicted in fig 27 a further checking the radiation and diffraction forces calculated by these two methods allows us to explain the difference in roll motion as show in fig 27 b there is a remarkable difference in the radiation and diffraction forces by fft we can also see that the nonlinear feature caused by the hull surface is very clear in the body exact method 6 conclusions this paper aims to investigate the effects of radiation and diffraction moments on the prediction of parametric roll based on a three dimensional time domain panel method from the analysis the following remarks can be obtained 1 the hydrodynamic component including radiation and diffraction moments has a nonlinear relationship with roll angles especially for large roll amplitudes therefore the instantaneous roll angles should be considered in the calculation of radiation and diffraction moments 2 the hydrodynamic component including radiation and diffraction moments has a nonlinear relationship with the wave amplitude especially for high waves the nonlinear characteristics become more pronounced with the increase of the ship speed therefore the linear seakeeping theory should be improved for the calculation of large roll amplitude at high wave steepness by considering the real wave amplitude 3 radiation and diffraction moments do have an influence on the prediction of parametric roll in head waves a slight improvement is achieved by taking the effects into account although the effects of radiation and diffraction moments on parametric roll were found to have a mild influence on parametric roll the influence could be enhanced under certain conditions e g a ship sensitive to parametric roll sailing under critical conditions future research could focus on this topic acknowledgements part of the research was conducted in the institute of fluid dynamic and ship theory during the first author s study in hamburg university of technology this work was supported by ministry of industry and information technology of china no 2016 184 2017 614 the authors sincerely thank the above organization 
