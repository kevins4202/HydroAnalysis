index,text
3450,land subsidence ls due to the sea level rise slr and over pumping was observed in many groundwater aquifers worldwide the geotechnical properties and numerical simulation are considered a new integrative approach to investigate the ls hazard this study investigates the environmental hazards related to ls in the quaternary sediments using laboratory and numerical modeling in the coastal aquifer of nile delta egypt due to slr and over pumping therefore the geotechnical tests are conducted for the aquifer cap and classify the surficial soil as silty clay with moderately complex dispersive characteristics in addition hydraulic conductivity and one dimensional consolidation of silty clay samples were analyzed to estimate the long term settlement consequently the groundwater head and drawdown were simulated for the current situation three proposed future scenarios are slr and increased abstraction using the seawat code the results show that groundwater heads increased to 5 65 14 50 and 26 70 cm for 2020 2040 and 2060 respectively moreover the estimated ls under the over pumping scenario reached 7 60 32 40 and 52 70 cm with a maximum drawdown of 2 10 9 70 and 15 10 m slr and over pumping induce more inundation in the northern part due to slr the shoreline moves inland with a drawdown to 2 9 50 and 14 80 m integration of measured and groundwater simulation settlements would provide appropriate information about the potential environmental hazards moreover the future ls scenarios help stakeholders to make the right decision in developing effective measures in coastal aquifers to minimize the adverse impacts of ls on infrastructure waterways and human life keywords drawdown groundwater land subsidence over pumping settlement sea level rise notations bcm billion cubic meter bh boreholes gwl groundwater level gerd grand ethiopian renaissance dam ls land subsidence mt3d modular transport three dimensional mt3dms modular transport three dimensional multi species msl mean sea level nrms normalized root mean rms is the root mean squared error slr sea level rise seawat three dimensional variable density groundwater flow ss split spoon sample st undisturbed tube sample tds total dissolved solids wnda western nile delta aquifer 1 introduction worldwide groundwater resources are the primary source of coastal regions and represent about 22 polar ice 77 while rivers and lakes 0 30 from the earth freshwater population growth increases water demands and leads to over pump from the aquifers bear et al 1999 combined with pumping and slr the water shortage problem becomes more severe it requires fast and effective solutions in which the shoreline will shift further inland about 85 of total groundwater abstractions in egypt are exploited from egypt s nile delta aquifer el nahry and doluschitz 2010 climate change and over pumping due to population growth impact coastal aquifers water resources abd elaty et al 2019 the coastal aquifers and low land areas along egypt s mediterranean coast are perceived as vulnerable to climate change due to slr saltwater intrusion on freshwater resources agricultural resources tourism and human settlement an slr between 18 and 58 cm is expected that by 2100 about 95 of coastal areas worldwide will be affected by slr pearce et al 2014 it also increases the risk of inundation in internal land and coastal aquifers salinity ågren and svensson 2007 climate change and rising sea levels are critical parameters affecting coastal aquifers rates and degrees abd elhamid et al 2016 according to satellite altimetry the present average slr is about 3 3 mm yr 1 with an acceleration of 0 1 mmyr 2 langevin 2009 mabrouk et al mabrouk et al 2013 was investigated the influence of slr on the northeastern part of the nile delta they found an increasing salinity of groundwater and extraction rates for brackish water coastal zones represent a densely populated area with over 70 of the world s population the growth in the global population has increased water demands and pumping from aquifers bear 2012 the aquifer salinity and inversion are observed from the sea to inland because of saltwater intrusion clay soils are distributed worldwide and this soil classification has a high priority challenge consequently clayey soils are considered one of the main problematic soil in the north western part of the nile delta which may cause damages in constructions because of swelling or long term settlement el shinawi 2017 sadeghi et al 2019 tunar özcan et al 2020 the clay materials are exposed to complex suction stress paths causing many disorders in structures built on their surfaces kramarenko et al 2016 naymushina et al 2010 nowamooz and masrouri 2010 additionally a fall in groundwater level was detected in some areas because of over pumping bear et al 1999 excessive pumping may lead to groundwater depletion gogu et al 2001 consequently slr and other human induced stressors including the growing population in the nile delta the subsequent operation of the gerd grand ethiopian renaissance dam and the various forms of desertification processes currently observed aboel ghar et al 2004 these problems will increase groundwater abstraction the risk for groundwater levels salinity and management of reclaimed lands abd elaty et al 2019 abd elhamid et al 2019 furthermore over pumping in coastal areas increases groundwater contamination abd elaty et al 2020 the nile delta subsidence rate in the coastal region is 8 mm yr 1 with a relatively lower 4 to 6 mm yr 1 around the manzala lagoon becker and sultan 2009 abd elaty et al abd elaty et al 2019 estimated the slr by 5 67 14 51 and 26 72 cm corresponding to 2020 2040 and 2060 also abd elaty et al abd elaty et al 2019 investigated the water resources management in the nile delta aquifer egypt using different wells systems subsidence is the compaction or compression of unconsolidated and partly consolidated sediments consequently it damages the roads railways bridges and pipelines putting them at risk for structural failure subsidence reduces channel and canal flow capacity and freeboard increases flooding el shinawi 2017 gravity dams require raising to maintain hydraulics natural hazards include collapsing roads broken pipes utilities damaged canals and cracked foundations separation abd elaty et al 2021a masoud 2014 furthermore groundwater over pumping impacts degrading groundwater quality and increased salinity i e coastal and delta areas potentially increase contamination thus this study concerned 1 the geotechnical properties groundwater levels and drawdown for the expected slr and over pumping rates 2 the long term settlement as a new integrative approach for predicting future scenarios in the years 2020 and 2060 in coastal aquifers of the nile delta egypt specifically this study investigates the environmental hazards of land subsidence in coastal aquifers under the possible impact of different future scenarios of slr by 2020 2040 and 2060 due to climate changes and well abstraction rates due to overpopulation in coastal aquifers of the nile delta egypt the simulation model was developed using actual and integrated recent geotechnical and hydrologic parameters additionally the risk maps for groundwater drawdown and land subsidence were produced in this study for future scenarios which helps the decision makers consider the future strategy for planning and design of infrastructure thus this study s main novelty consists of estimating future land subsidence considering different factors separately and combined therefore this study is useful for monitoring and assessing land subsidence in similar high impact areas in addition the future management of subsidence hazards is considered by slr and well sampling regulations to mitigate its negative impact therefore possible remedial measures could reduce groundwater pumping in the study area the rest of the manuscript is organized as follows section 2 gives brief information about the study site analyzed dataset and the applied methodology section 3 shows the main results and their interpretation section 4 discusses the relevance of our findings and the main contribution of this study finally the main conclusions drawn from this study are presented in section 5 2 materials and method 2 1 study site the study area is located in the north western part of the nile delta between latitudes 30 00 and 31 45 n and longitudes 29 30 and 32 30 e fig 1 the surface slope is very gently northward by an average value ranging from 1 m to 10 km saleh 1980 the temperature ranges from 9 c to 30 c along the mediterranean while only 200 mm 8 in rainfall per year in alexandria the quaternary sediments pleistocene and holocene covered the study area kashef 1983 said 1993 samuel et al 2003 in the western part the pleistocene sediments are exposed simultaneously they are overlain by the holocene nile silt clay and rest on the pliocene clay fig 1 they are composed of sand gravel intercalated with clay lenses the pleistocene sediments have a variable thickness range up to 300 m in the eastern part the holocene silty clay is present in the northeastern part their thickness ranges from 0 to 25 m the base slope is 4 m for 1 km about 40 times the average slope ground surface el osta et al 2010 the quaternary sediments are composed of mit ghamr and bilqas formation in the upper parts coutellier and stanley 1987 the lower parts represent the pleistocene sediments they consist of sand gravel and occasional thin clay intercalations the upper parts are composed of semi permeable layers of clayey sand and silt with varying thicknesses xu et al 2009 2 2 soil investigation the reliable subsurface data from seven boreholes were investigated in depths from 10 to 15 m fig 2 the undisturbed and disturbed 61 samples were taken through the boreholes and their sampling depths are shown in table 1 field observations and laboratory works performed at the first step soil classification i e type and gradation of soil samples the soil type was performed according to visual classification astmd 2009 secondly the physical properties such as bulk unit weight dry unit weight and specific gravity determine the porosity of different soil samples additionally the grain size analyses were performed astmd422 2007 and all samples were classified astmd4318 2017 then the hydraulic conductivity was calculated using hazen s formula 1 k c d 10 2 k is the saturated hydraulic conductivity expressed in cm s 1 and c is hazen s empirical coefficient with an average value of 1 0 at the same time d10 is the diameter mm such that 10 of all soil particles are finer with weight at the third step a one dimensional consolidation test of silty clay samples was performed for silty clay samples astmd 2004 the samples from bh i at 6 m and bh ii at 7 5 m fig 1 for boreholes location these tests were conducted under pressures from 0 5 to 16 kg cm2 in each stress stage the effective pressure was increased twice the stress applied in the prior stage 0 5 1 2 4 8 16 kg cm 2 propose the long term settlement for fine grained soils a load of 0 25 kg cm 2 is usually adequate to prevent swelling before and after the test the void ratio was computed from the recorded data once final stress conditions were established the relationship between void ratio and vertical stress for soils was established to estimate the compressibility coefficient mv and determine the storage capacity astmd 2020 the results were analyzed to estimate the long term settlements a load of 0 25 kgcm 2 is usually sufficient to prevent swelling for fine grained soils the following loading schedule considered satisfactory for routine tests 0 25 0 5 1 0 2 0 4 0 8 0 and 16 0 kgcm 2 the load should be sufficient to plot the void ratio pressure curve then the dial reading and the corresponding elapsed time were plotted on a logarithmic curve the readings of the dial indicator were taken when removing each decrement the final load in the rebound cycle should be 0 1 kgcm 2 or less the load was applied for 24 h to reduce the final water content determination error caused by swelling to a tolerable amount moreover void ratio e compression pressure log p curves of clayey samples were depicted in the ranges of their consolidation parameters such as void ratio and primary compression index cc coefficient of consolidation cv in addition the coefficient compressibility mv and all of these parameters will be used as input parameters in modeling to detect future scenarios for long term settlements 2 3 numerical simulation the miscible variable density process is governed by the equations coupled system of flow and transport using the finite difference of seawat v4 software langevin et al 2008 the code simulated the current groundwater flow and salt transport in the current study area also future scenarios of slr and over pumping from the coastal aquifer of the nile delta were predicted guo and bennett guo and bennett 1998 developed the first version of seawat which combines modflow 88 mcdonald and harbaugh 1988 and mt3d96 zheng 1996 guo and langevin 2002 developed the second version of seawat and improved mt3d to mt3dms zheng and wang 1999 langevin et al langevin et al 2003 developed the third version seawat by seawat 2000 which combines modflow 2000 halford and hanson 2002 and mt3dms zheng and wang 1999 zheng and wang 1999 langevin et al langevin et al 2008 developed seawat 2000 by seawat v4 which a coupled with modflow halford and hanson 2002 and mt3dms zheng and wang 1999 zheng and wang 1999 zong et al 2021 the governing equation for the variable density flow process vdf in terms of the freshwater head as used in seawat expressed by langevin et al 2003 as the following 2 ρ μ o μ h 0 ρ ρ o ρ o z ρ s ss 0 h o t θ ρ c c t ρ s q s the integrated mt3dms transport imt process solves the following form of the advection dispersion equation zheng and wang 1999 zheng and wang 1999 zheng and wang 1999 as the following 3 1 ρ b k d k θ θ c k t θ d m k α q θ c k q c k q s c s k where ρ0 fluid density ml 3 k0 hydraulic conductivity lt 1 h0 hydraulic head l μ dynamic viscosity ml 1 t 1 ss 0 specific storage l 1 t time t c salt concentration ml 3 θ porosity q s a source or sink t 1 ρb bulk density ml 3 ck concentration of species k ml 3 kd k distribution coefficient of species k l3 m 1 q specific discharge lt 1 d hydrodynamic dispersion coefficient tensor l2t 1 and cs k source or sink concentration ml 3 of species k 2 3 1 geometry and digitalization the finite model differences of seawat v4 were conceded for the west nile delta aquifer wnda using 94 rows and 98 columns for active and inactive cells using square cell dimensions 1 km2 fig 3 a to delineate the study area the vertical section in y direction fig 3b and in x direction fig 3c are presented the aquifer thickness from the north the mediterranean sea to the south and from the east to the west 2 3 2 hydrological conditions the model boundary conditions and hydrological systems were assigned to the model of the wnda the north boundary is zero levels by constant head along the mediterranean sea shoreline above mean sea level msl directly connected with the salty lake the south eastern is rosetta branch of river nile is started by the head of 6 90 m at the south to 0 50 m at the north the southwestern by el nubaria canal is started by 6 90 at the south to 0 50 at the north the solute transport model uses a constant concentration of 40 000 ppm saltwater total dissolved solids tds along the mediterranean sea s coastal line to study the effect of variable density on the hydraulic head of the study area for the base case and the future scenarios the concentration of groundwater was set to zero ppm 2 3 3 hydraulic parameters based on the current soil investigation and the field measurements the obtained data were used as initial input values for the model the calibrated input values of hydraulic parameters for aquitard and aquifer are presented in table 2 these parameters include hydraulic conductivity porosity storability specific yield and effective porosity however another field hydraulic parameters data were estimated by el arabi el arabi 2007 in wnda the recharge occurs during rainfall events reaching an average value of 25 mmyear 1 the seepage from an irrigation canal and excess water from the irrigation process ranging from 0 25 to 0 80 mm day 1 inter aquifer flow to groundwater the recharge s net input value ranged between 0 10 and 0 60 mm day 1 masoud 2014 morsy 2009 abstraction wells carry out the aquifer discharge for irrigation available production drinking water the total abstraction well rate was 1 36 m3 year 1 mcm year 1 in 2008 morsy 2009 the longitudinal dispersivity αl lateral dispersivity αt vertical dispersivity αv and the diffusion coefficient d were used in the model with values of 100 m 10 m 1 m and 10 4 m2 day 1 respectively sherif et al 1988 2 3 4 model calibration the calibration was performed by trial and error for the aquifer parameters to show the difference in head between the calculated by the model and the measured in the field during the 2008 field campaign fig 4 a is presented for the groundwater flow and the distribution of observation well in the study the model of wnda results was given a good match between the calculated by the current simulation and the observed heads from field data fig 4b the miscible variable density model was taken 500 years to reach steady state condition after this period the model was run under transit state to predict the future scenarios the simulated model results for wnda showed the residual range between 0 283 and 0 01 m at the same time the maximum and minimum difference between the calculated results xcal and the observed results xobs with root mean square rms is 0 16 m the normalization root means square is 4 003 the following equation is used in the estimation of the calibration process r i x cal x obs rms 1 n i 1 n r i 2 nrms rms x obs max x cal min where ri is the residual rms is the root mean squared error nrms normalized root mean squared xobs is the observed point results xcal is the calculated point results and n num of data points fig 4c presents the groundwater head in the study the heads ranged from zero level at the shoreline of the mediterranean sea to 5 m at the south of wnda in which the groundwater flows from the south to the north 2 3 5 modelling future scenarios three scenarios are considered in the current study to investigate the land subsidence in the high water stress region of the western nile delta aquifer for the effect of slr due to climate changes and over pumping due to overpopulation the first considers an increase in sea level by 5 67 14 51 and 26 72 cm respectively the second considers increasing the abstraction rates by 1 88 2 70 and 3 50 bcm for the years 2020 2040 2060 respectively the third scenario is a combination of the two scenarios above 2 3 6 analytical solution for land subsidence the compaction in a single soil layer due to change in stress is in confined aquifer expressed by terzaghi et al terzaghi et al 1996 as follows 4 δ i t s si b i δ s i t gambolati and freeze gambolati and freeze 1973 estimated the subsidence by accumulating soil compaction layers 5 δ i t m v h o δ s i t 1 n s si b i δ s i t m v h o 1 n s i δ s i t 6 s si s sk s sw ρ g α n β where δi t the compaction of single soil layer at any time l mv the compressibility coefficient l2 m 1 ho the thickness of clay l ssi the specific storage of porous material l 1 δss t the drawdown of groundwater l t time t bi soil thickness l n the numbers of layers while si aquifer storativity is equal to ssi b ssk the skeletal specific storage related to aquifer matrix compressibility α ssw is the water specific storage related to water compressibility β ρ is the fluid density g is the gravitational acceleration and n is aquifer porosity 3 results 3 1 physical and index soil properties the grain size analyses are distinguished that the samples bh ii and bh iii at depths 13 5 and 15 m respectively consist of 0 gravel 44 32 50 77 sand and 49 23 55 56 fines fig 5 a consequently the silty clay samples mainly consist of silt sized grains with low clay and fine sand content especially in the depth range between 13 5 and 15 m astmd422 2007 furthermore the collected samples are classified as inorganic silty clay astmd 2011 the hydraulic conductivity ranges between 0 009 cm s 1 and 0 012 cm s 1 thus these tests were performed to characterize the other soil physical properties density astmd6683 2019 and specific gravity astmd854 2014 the density is ranged from 1 62 1 94 g cm 3 while the dry density ranges from 1 42 1 45 g cm 3 and specific gravity values of soils are ranged between 2 62 and 2 78 also porosity ranges between 47 46 and 58 95 3 2 compressibility characteristics the samples compression vs square root time curve fig 5b suggests compression shows a slight steady increase after 8 05 min the void ratio e compression pressure log p curves of two silty clay samples are depicted in fig 5c the ranges of their consolidation parameters at pressures 0 5 16 kgcm 2 the initial and primary compression index cc ranges between 0 909 and 0 959 and 0 322 to 0 349 therefore the principal consolidation parameters for the study site table 3 for instance the consolidation coefficient cv ranges between 1 43 10 03 and 6 06 10 04 cm2 s 1 the compression cc and cs index ranges between 0 322 and 0 349 and 0 093 to 0 115 respectively furthermore the compressibility coefficient mv has close values ranging from 0 005 to 0 008 cm2 kg 1 a comparison of soil samples before and after the consolidation test illustrates that the samples become more hardening i e medium to stiff soil simultaneously the density increased water content and void ratio decreased consequently when stress is applied to and causes soil particles pack together more compactly and water is squeezed out of the soil therefore the primary compression is due to excess pore water pressure because of effective stress the silty clay soils are affected with different loads because of the investigated site activities which confirms good compressional fig 5b and 5c hence the soil faintly over consolidated near the surface and generally consolidated at higher depths conversely pockets of organic soil and sand with different hardening degrees expected some differences in a settlement to avoid the problems resulting from this the decline should be reduced as much as possible by reducing new soil stresses 3 3 numerical results 3 3 1 effect of slr in groundwater levels and inundation scenario a the model was applied by increasing sea level by 5 67 14 51 and 26 72 cm the differences between groundwater head for the base case and the proposed scenarios fig 6 a 6b and 6c the results showed groundwater head increased to 5 65 14 50 and 26 70 cm the shoreline moved on the landside for 3 3 2 effect of over pumping on groundwater levels and land subsidence scenario b the nile delta population s high intensity is the main water supply problem for agriculture domestic and industry sectors the abstraction rates from wells are increased and water shortage occurs the abstraction rates in the nile delta fig 7 a from 1980 to 2016 with linear annual rates of 14 60 this study found the annual rates of 1 36 bcm in 2008 while the future is 1 88 2 70 and 3 50 bcm to 2060 with an increase in 1 38 1 98 and 2 58 from the base case the distribution of abstraction wells in the study area is presented in fig 7b this scenario s drawdown results fig 8 a 8b and 8c showed that the drawdown increases due to over pumping the maximum estimated drawdown reached 2 10 9 70 and 15 10 m moreover fig 8d 8e and 8f show the distribution of maximum subsidence results for 2020 2040 and 2060 to be 7 60 32 40 and 52 70 cm respectively the subsidence was detected using the analytical solution by eq 3 the clay cap s compressibility coefficient mv was 0 005 cm2 kg the quaternary layers specific storage was 0 0001 m 1 these values were estimated on the current soil investigation and laboratory analysis 3 3 3 effect of slr and over pumping on groundwater level and subsidence scenario c by combining the increase in sea level by 5 67 14 51 and 26 72 and over pumping rates by 1 38 1 98 and 2 58 from base case to 1 88 2 70 and 3 50 bcm simulated in this scenario the drawdown and land subsidence were estimated in wnda until 2060 fig 9 a 9b and 9c show the maximum drawdown of the expected scenarios for 2020 2040 and 2060 to reach 2 9 50 and 14 80 m also the maximum subsidence reached 7 50 32 and 51 90 cm respectively 4 discussion this study investigates the simulation of coastal aquifers environmental land subsidence hazards under slr and over pumping combined effect the proposed model for the coastal aquifer of the nile delta egypt uses measured geotechnical and hydrologic parameters as input data then several numerical simulations were conducted to investigate the future groundwater heads drawdown and subsidence rates by increasing sea levels and abstraction rates corresponding to 2020 2040 and 2060 the numerical simulation for the groundwater head and drawdown of the analytical solution for land subsidence must be considered with the present situation and networks future design abd elaty et al 2021a abd elaty et al 2021b el shinawi 2017 the irrigation lining canals closed pipe conduct networks open canals drains earth berms and banks are expected to suffer considerable damages and need rehabilitation the retaining walls will be subjected to failure due to sliding furthermore the irrigation structures for crossing works such as bridges culverts siphon and aqueducts the heading up structures including weirs regulators and dams might be subjected to differential settlement affecting these structures stability el nahry and doluschitz 2010 el shinawi 2017 the future design for these waterworks should be used fixable material considering the effect of future land subsidence the estimated land subsidence in 2020 and the future scenarios in 2040 and 2060 increased following increasing sea levels and increasing groundwater abstraction rates at the same time the drawdown fell and inversely proportioned with the slr and abstraction rate in 2020 and the future scenarios fig 10 presents the results of a rise in sea levels by 5 56 14 50 and 26 70 cm in 2020 2040 and 2060 were increased the groundwater head increased to 5 65 14 50 26 70 cm moreover the expected rise in the groundwater abstraction for 2020 2040 and 2060 was fallen the groundwater heads and increased the drawdown to 2 10 9 70 and 15 10 m while the subsidence reached 7 60 32 40 and 52 70 cm respectively the drawdown was also increased to 2 9 50 and 14 80 m and the subsidence was 7 50 32 and 51 90 cm for 2020 2040 and 2060 respectively moreover the subsidence in the southern part decreases and reaches 7 50 32 and 51 90 cm respectively caused by the slr effect in the south part at the expected future scenarios until 2060 from this perspective two hydrological forces for slr and over pumping should be effectively managed to mitigate long term settlement and maintain the coastal aquifer s water quality at a suitable level in which the expected results of groundwater heads consists of published materials by abd elaty et al abd elaty et al 2019 and abd elhamid et al abd elhamid et al 2019 for the combined impact of slr and over pumping in nile delta aquifers also the estimated land subsidence are provided by rateb and abotalib rateb and abotalib 2020 using field data by sentinel 1 satellites and gps between 2015 and 2019 in the north western part of the nile delta to reach between 20 to 16 mm year 1 due to groundwater overexploitation re very useful for the results of the current study accordingly the major effect of land subsidence is the over pumping of groundwater and the sea levels rise in the coastal aquifers there is a reasonable link between the land subsidence rate and the decrease of groundwater head or value piezometric head confirming that the abstraction of the coastal aquifer is responsible for increasing the land subsidence church et al 2013 lixin et al 2011 orhan et al 2021 saber et al 2018 suganthi and elango 2020 from all of the above the main reason for the decline in groundwater quality and land subsidence is groundwater pumping therefore it is important to justify the pumping speed to stop the decrease in groundwater pressure to solve the problem of land subsidence therefore possible remedial measures that can be taken are to reduce the pumping of groundwater in the study area these analyzes may be useful for monitoring and evaluating soil subsidence in similar high impact areas 5 conclusions the model was conducted using geotechnical and hydrologic parameters as input data accordingly the numerical study is simulated to investigate the groundwater levels and the drawdown by increasing sea levels and abstraction rates corresponding to 2060 based on data collection in this study the maximum subsidence was reached 7 60 32 40 and 52 40 cm for increasing the abstraction rates by 1 38 1 98 and 2 58 from the base case the subsidence values were decreased by combining slr and over pumping to 7 50 32 and 51 90 cm for 2020 2040 and 2060 we also conclude that the slr showed that the water table increased while the drawdown increased due to overpumping soil settlement was assessed using analytical solutions during pumping the results of this study are based on the limited amount of borehole data available in the public domain for soil research therefore accurate data are needed to refine the above assumptions accordingly the slr is an upward force that raises the water table and minimizes subsidence due to the downward force however the risk of cpr in the coastal zone arises when the earth s surface sinks at the same time excessive pumping leads to increased soil subsidence finally predicting land subsidence hazard and groundwater head fall will help the decision makers put an applicable strategy for mitigating the negative impact of the future hazard by land subsidence in a coastal aquifer credit authorship contribution statement abdelaziz el shinawi conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources alban kuriqi conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources supervision martina zelenakova conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources zuzana vranayova conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources ismail abd elaty conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are thankful to the department of water and water structures engineering faculty of engineering zagazig university zagazig 44519 egypt for constant support during the study also alban kuriqi acknowledges the portuguese foundation for science and technology fct support through ptdc cta ohr 30561 2017 wintherface we finally thank zagazig university environmental geophysics lab for helping us to perform the soil laboratory testing this work is thankful to be supported by the project of the ministry of education of the slovak republic vega 1 0217 19 research of hybrid blue and green infrastructure as active elements of a sponge city vega1 0308 20 mitigation of hydrological hazards floods and droughts by exploring extreme hydroclimatic phenomena in river basins and the project od slovak research and development agency apvv 18 0360 active hybrid infrastructure towards to sponge city funding this study did not receive any funding availability of data and material upon request code availability upon request ethics approval not applicable consent to participate yes consent for publication yes 
3450,land subsidence ls due to the sea level rise slr and over pumping was observed in many groundwater aquifers worldwide the geotechnical properties and numerical simulation are considered a new integrative approach to investigate the ls hazard this study investigates the environmental hazards related to ls in the quaternary sediments using laboratory and numerical modeling in the coastal aquifer of nile delta egypt due to slr and over pumping therefore the geotechnical tests are conducted for the aquifer cap and classify the surficial soil as silty clay with moderately complex dispersive characteristics in addition hydraulic conductivity and one dimensional consolidation of silty clay samples were analyzed to estimate the long term settlement consequently the groundwater head and drawdown were simulated for the current situation three proposed future scenarios are slr and increased abstraction using the seawat code the results show that groundwater heads increased to 5 65 14 50 and 26 70 cm for 2020 2040 and 2060 respectively moreover the estimated ls under the over pumping scenario reached 7 60 32 40 and 52 70 cm with a maximum drawdown of 2 10 9 70 and 15 10 m slr and over pumping induce more inundation in the northern part due to slr the shoreline moves inland with a drawdown to 2 9 50 and 14 80 m integration of measured and groundwater simulation settlements would provide appropriate information about the potential environmental hazards moreover the future ls scenarios help stakeholders to make the right decision in developing effective measures in coastal aquifers to minimize the adverse impacts of ls on infrastructure waterways and human life keywords drawdown groundwater land subsidence over pumping settlement sea level rise notations bcm billion cubic meter bh boreholes gwl groundwater level gerd grand ethiopian renaissance dam ls land subsidence mt3d modular transport three dimensional mt3dms modular transport three dimensional multi species msl mean sea level nrms normalized root mean rms is the root mean squared error slr sea level rise seawat three dimensional variable density groundwater flow ss split spoon sample st undisturbed tube sample tds total dissolved solids wnda western nile delta aquifer 1 introduction worldwide groundwater resources are the primary source of coastal regions and represent about 22 polar ice 77 while rivers and lakes 0 30 from the earth freshwater population growth increases water demands and leads to over pump from the aquifers bear et al 1999 combined with pumping and slr the water shortage problem becomes more severe it requires fast and effective solutions in which the shoreline will shift further inland about 85 of total groundwater abstractions in egypt are exploited from egypt s nile delta aquifer el nahry and doluschitz 2010 climate change and over pumping due to population growth impact coastal aquifers water resources abd elaty et al 2019 the coastal aquifers and low land areas along egypt s mediterranean coast are perceived as vulnerable to climate change due to slr saltwater intrusion on freshwater resources agricultural resources tourism and human settlement an slr between 18 and 58 cm is expected that by 2100 about 95 of coastal areas worldwide will be affected by slr pearce et al 2014 it also increases the risk of inundation in internal land and coastal aquifers salinity ågren and svensson 2007 climate change and rising sea levels are critical parameters affecting coastal aquifers rates and degrees abd elhamid et al 2016 according to satellite altimetry the present average slr is about 3 3 mm yr 1 with an acceleration of 0 1 mmyr 2 langevin 2009 mabrouk et al mabrouk et al 2013 was investigated the influence of slr on the northeastern part of the nile delta they found an increasing salinity of groundwater and extraction rates for brackish water coastal zones represent a densely populated area with over 70 of the world s population the growth in the global population has increased water demands and pumping from aquifers bear 2012 the aquifer salinity and inversion are observed from the sea to inland because of saltwater intrusion clay soils are distributed worldwide and this soil classification has a high priority challenge consequently clayey soils are considered one of the main problematic soil in the north western part of the nile delta which may cause damages in constructions because of swelling or long term settlement el shinawi 2017 sadeghi et al 2019 tunar özcan et al 2020 the clay materials are exposed to complex suction stress paths causing many disorders in structures built on their surfaces kramarenko et al 2016 naymushina et al 2010 nowamooz and masrouri 2010 additionally a fall in groundwater level was detected in some areas because of over pumping bear et al 1999 excessive pumping may lead to groundwater depletion gogu et al 2001 consequently slr and other human induced stressors including the growing population in the nile delta the subsequent operation of the gerd grand ethiopian renaissance dam and the various forms of desertification processes currently observed aboel ghar et al 2004 these problems will increase groundwater abstraction the risk for groundwater levels salinity and management of reclaimed lands abd elaty et al 2019 abd elhamid et al 2019 furthermore over pumping in coastal areas increases groundwater contamination abd elaty et al 2020 the nile delta subsidence rate in the coastal region is 8 mm yr 1 with a relatively lower 4 to 6 mm yr 1 around the manzala lagoon becker and sultan 2009 abd elaty et al abd elaty et al 2019 estimated the slr by 5 67 14 51 and 26 72 cm corresponding to 2020 2040 and 2060 also abd elaty et al abd elaty et al 2019 investigated the water resources management in the nile delta aquifer egypt using different wells systems subsidence is the compaction or compression of unconsolidated and partly consolidated sediments consequently it damages the roads railways bridges and pipelines putting them at risk for structural failure subsidence reduces channel and canal flow capacity and freeboard increases flooding el shinawi 2017 gravity dams require raising to maintain hydraulics natural hazards include collapsing roads broken pipes utilities damaged canals and cracked foundations separation abd elaty et al 2021a masoud 2014 furthermore groundwater over pumping impacts degrading groundwater quality and increased salinity i e coastal and delta areas potentially increase contamination thus this study concerned 1 the geotechnical properties groundwater levels and drawdown for the expected slr and over pumping rates 2 the long term settlement as a new integrative approach for predicting future scenarios in the years 2020 and 2060 in coastal aquifers of the nile delta egypt specifically this study investigates the environmental hazards of land subsidence in coastal aquifers under the possible impact of different future scenarios of slr by 2020 2040 and 2060 due to climate changes and well abstraction rates due to overpopulation in coastal aquifers of the nile delta egypt the simulation model was developed using actual and integrated recent geotechnical and hydrologic parameters additionally the risk maps for groundwater drawdown and land subsidence were produced in this study for future scenarios which helps the decision makers consider the future strategy for planning and design of infrastructure thus this study s main novelty consists of estimating future land subsidence considering different factors separately and combined therefore this study is useful for monitoring and assessing land subsidence in similar high impact areas in addition the future management of subsidence hazards is considered by slr and well sampling regulations to mitigate its negative impact therefore possible remedial measures could reduce groundwater pumping in the study area the rest of the manuscript is organized as follows section 2 gives brief information about the study site analyzed dataset and the applied methodology section 3 shows the main results and their interpretation section 4 discusses the relevance of our findings and the main contribution of this study finally the main conclusions drawn from this study are presented in section 5 2 materials and method 2 1 study site the study area is located in the north western part of the nile delta between latitudes 30 00 and 31 45 n and longitudes 29 30 and 32 30 e fig 1 the surface slope is very gently northward by an average value ranging from 1 m to 10 km saleh 1980 the temperature ranges from 9 c to 30 c along the mediterranean while only 200 mm 8 in rainfall per year in alexandria the quaternary sediments pleistocene and holocene covered the study area kashef 1983 said 1993 samuel et al 2003 in the western part the pleistocene sediments are exposed simultaneously they are overlain by the holocene nile silt clay and rest on the pliocene clay fig 1 they are composed of sand gravel intercalated with clay lenses the pleistocene sediments have a variable thickness range up to 300 m in the eastern part the holocene silty clay is present in the northeastern part their thickness ranges from 0 to 25 m the base slope is 4 m for 1 km about 40 times the average slope ground surface el osta et al 2010 the quaternary sediments are composed of mit ghamr and bilqas formation in the upper parts coutellier and stanley 1987 the lower parts represent the pleistocene sediments they consist of sand gravel and occasional thin clay intercalations the upper parts are composed of semi permeable layers of clayey sand and silt with varying thicknesses xu et al 2009 2 2 soil investigation the reliable subsurface data from seven boreholes were investigated in depths from 10 to 15 m fig 2 the undisturbed and disturbed 61 samples were taken through the boreholes and their sampling depths are shown in table 1 field observations and laboratory works performed at the first step soil classification i e type and gradation of soil samples the soil type was performed according to visual classification astmd 2009 secondly the physical properties such as bulk unit weight dry unit weight and specific gravity determine the porosity of different soil samples additionally the grain size analyses were performed astmd422 2007 and all samples were classified astmd4318 2017 then the hydraulic conductivity was calculated using hazen s formula 1 k c d 10 2 k is the saturated hydraulic conductivity expressed in cm s 1 and c is hazen s empirical coefficient with an average value of 1 0 at the same time d10 is the diameter mm such that 10 of all soil particles are finer with weight at the third step a one dimensional consolidation test of silty clay samples was performed for silty clay samples astmd 2004 the samples from bh i at 6 m and bh ii at 7 5 m fig 1 for boreholes location these tests were conducted under pressures from 0 5 to 16 kg cm2 in each stress stage the effective pressure was increased twice the stress applied in the prior stage 0 5 1 2 4 8 16 kg cm 2 propose the long term settlement for fine grained soils a load of 0 25 kg cm 2 is usually adequate to prevent swelling before and after the test the void ratio was computed from the recorded data once final stress conditions were established the relationship between void ratio and vertical stress for soils was established to estimate the compressibility coefficient mv and determine the storage capacity astmd 2020 the results were analyzed to estimate the long term settlements a load of 0 25 kgcm 2 is usually sufficient to prevent swelling for fine grained soils the following loading schedule considered satisfactory for routine tests 0 25 0 5 1 0 2 0 4 0 8 0 and 16 0 kgcm 2 the load should be sufficient to plot the void ratio pressure curve then the dial reading and the corresponding elapsed time were plotted on a logarithmic curve the readings of the dial indicator were taken when removing each decrement the final load in the rebound cycle should be 0 1 kgcm 2 or less the load was applied for 24 h to reduce the final water content determination error caused by swelling to a tolerable amount moreover void ratio e compression pressure log p curves of clayey samples were depicted in the ranges of their consolidation parameters such as void ratio and primary compression index cc coefficient of consolidation cv in addition the coefficient compressibility mv and all of these parameters will be used as input parameters in modeling to detect future scenarios for long term settlements 2 3 numerical simulation the miscible variable density process is governed by the equations coupled system of flow and transport using the finite difference of seawat v4 software langevin et al 2008 the code simulated the current groundwater flow and salt transport in the current study area also future scenarios of slr and over pumping from the coastal aquifer of the nile delta were predicted guo and bennett guo and bennett 1998 developed the first version of seawat which combines modflow 88 mcdonald and harbaugh 1988 and mt3d96 zheng 1996 guo and langevin 2002 developed the second version of seawat and improved mt3d to mt3dms zheng and wang 1999 langevin et al langevin et al 2003 developed the third version seawat by seawat 2000 which combines modflow 2000 halford and hanson 2002 and mt3dms zheng and wang 1999 zheng and wang 1999 langevin et al langevin et al 2008 developed seawat 2000 by seawat v4 which a coupled with modflow halford and hanson 2002 and mt3dms zheng and wang 1999 zheng and wang 1999 zong et al 2021 the governing equation for the variable density flow process vdf in terms of the freshwater head as used in seawat expressed by langevin et al 2003 as the following 2 ρ μ o μ h 0 ρ ρ o ρ o z ρ s ss 0 h o t θ ρ c c t ρ s q s the integrated mt3dms transport imt process solves the following form of the advection dispersion equation zheng and wang 1999 zheng and wang 1999 zheng and wang 1999 as the following 3 1 ρ b k d k θ θ c k t θ d m k α q θ c k q c k q s c s k where ρ0 fluid density ml 3 k0 hydraulic conductivity lt 1 h0 hydraulic head l μ dynamic viscosity ml 1 t 1 ss 0 specific storage l 1 t time t c salt concentration ml 3 θ porosity q s a source or sink t 1 ρb bulk density ml 3 ck concentration of species k ml 3 kd k distribution coefficient of species k l3 m 1 q specific discharge lt 1 d hydrodynamic dispersion coefficient tensor l2t 1 and cs k source or sink concentration ml 3 of species k 2 3 1 geometry and digitalization the finite model differences of seawat v4 were conceded for the west nile delta aquifer wnda using 94 rows and 98 columns for active and inactive cells using square cell dimensions 1 km2 fig 3 a to delineate the study area the vertical section in y direction fig 3b and in x direction fig 3c are presented the aquifer thickness from the north the mediterranean sea to the south and from the east to the west 2 3 2 hydrological conditions the model boundary conditions and hydrological systems were assigned to the model of the wnda the north boundary is zero levels by constant head along the mediterranean sea shoreline above mean sea level msl directly connected with the salty lake the south eastern is rosetta branch of river nile is started by the head of 6 90 m at the south to 0 50 m at the north the southwestern by el nubaria canal is started by 6 90 at the south to 0 50 at the north the solute transport model uses a constant concentration of 40 000 ppm saltwater total dissolved solids tds along the mediterranean sea s coastal line to study the effect of variable density on the hydraulic head of the study area for the base case and the future scenarios the concentration of groundwater was set to zero ppm 2 3 3 hydraulic parameters based on the current soil investigation and the field measurements the obtained data were used as initial input values for the model the calibrated input values of hydraulic parameters for aquitard and aquifer are presented in table 2 these parameters include hydraulic conductivity porosity storability specific yield and effective porosity however another field hydraulic parameters data were estimated by el arabi el arabi 2007 in wnda the recharge occurs during rainfall events reaching an average value of 25 mmyear 1 the seepage from an irrigation canal and excess water from the irrigation process ranging from 0 25 to 0 80 mm day 1 inter aquifer flow to groundwater the recharge s net input value ranged between 0 10 and 0 60 mm day 1 masoud 2014 morsy 2009 abstraction wells carry out the aquifer discharge for irrigation available production drinking water the total abstraction well rate was 1 36 m3 year 1 mcm year 1 in 2008 morsy 2009 the longitudinal dispersivity αl lateral dispersivity αt vertical dispersivity αv and the diffusion coefficient d were used in the model with values of 100 m 10 m 1 m and 10 4 m2 day 1 respectively sherif et al 1988 2 3 4 model calibration the calibration was performed by trial and error for the aquifer parameters to show the difference in head between the calculated by the model and the measured in the field during the 2008 field campaign fig 4 a is presented for the groundwater flow and the distribution of observation well in the study the model of wnda results was given a good match between the calculated by the current simulation and the observed heads from field data fig 4b the miscible variable density model was taken 500 years to reach steady state condition after this period the model was run under transit state to predict the future scenarios the simulated model results for wnda showed the residual range between 0 283 and 0 01 m at the same time the maximum and minimum difference between the calculated results xcal and the observed results xobs with root mean square rms is 0 16 m the normalization root means square is 4 003 the following equation is used in the estimation of the calibration process r i x cal x obs rms 1 n i 1 n r i 2 nrms rms x obs max x cal min where ri is the residual rms is the root mean squared error nrms normalized root mean squared xobs is the observed point results xcal is the calculated point results and n num of data points fig 4c presents the groundwater head in the study the heads ranged from zero level at the shoreline of the mediterranean sea to 5 m at the south of wnda in which the groundwater flows from the south to the north 2 3 5 modelling future scenarios three scenarios are considered in the current study to investigate the land subsidence in the high water stress region of the western nile delta aquifer for the effect of slr due to climate changes and over pumping due to overpopulation the first considers an increase in sea level by 5 67 14 51 and 26 72 cm respectively the second considers increasing the abstraction rates by 1 88 2 70 and 3 50 bcm for the years 2020 2040 2060 respectively the third scenario is a combination of the two scenarios above 2 3 6 analytical solution for land subsidence the compaction in a single soil layer due to change in stress is in confined aquifer expressed by terzaghi et al terzaghi et al 1996 as follows 4 δ i t s si b i δ s i t gambolati and freeze gambolati and freeze 1973 estimated the subsidence by accumulating soil compaction layers 5 δ i t m v h o δ s i t 1 n s si b i δ s i t m v h o 1 n s i δ s i t 6 s si s sk s sw ρ g α n β where δi t the compaction of single soil layer at any time l mv the compressibility coefficient l2 m 1 ho the thickness of clay l ssi the specific storage of porous material l 1 δss t the drawdown of groundwater l t time t bi soil thickness l n the numbers of layers while si aquifer storativity is equal to ssi b ssk the skeletal specific storage related to aquifer matrix compressibility α ssw is the water specific storage related to water compressibility β ρ is the fluid density g is the gravitational acceleration and n is aquifer porosity 3 results 3 1 physical and index soil properties the grain size analyses are distinguished that the samples bh ii and bh iii at depths 13 5 and 15 m respectively consist of 0 gravel 44 32 50 77 sand and 49 23 55 56 fines fig 5 a consequently the silty clay samples mainly consist of silt sized grains with low clay and fine sand content especially in the depth range between 13 5 and 15 m astmd422 2007 furthermore the collected samples are classified as inorganic silty clay astmd 2011 the hydraulic conductivity ranges between 0 009 cm s 1 and 0 012 cm s 1 thus these tests were performed to characterize the other soil physical properties density astmd6683 2019 and specific gravity astmd854 2014 the density is ranged from 1 62 1 94 g cm 3 while the dry density ranges from 1 42 1 45 g cm 3 and specific gravity values of soils are ranged between 2 62 and 2 78 also porosity ranges between 47 46 and 58 95 3 2 compressibility characteristics the samples compression vs square root time curve fig 5b suggests compression shows a slight steady increase after 8 05 min the void ratio e compression pressure log p curves of two silty clay samples are depicted in fig 5c the ranges of their consolidation parameters at pressures 0 5 16 kgcm 2 the initial and primary compression index cc ranges between 0 909 and 0 959 and 0 322 to 0 349 therefore the principal consolidation parameters for the study site table 3 for instance the consolidation coefficient cv ranges between 1 43 10 03 and 6 06 10 04 cm2 s 1 the compression cc and cs index ranges between 0 322 and 0 349 and 0 093 to 0 115 respectively furthermore the compressibility coefficient mv has close values ranging from 0 005 to 0 008 cm2 kg 1 a comparison of soil samples before and after the consolidation test illustrates that the samples become more hardening i e medium to stiff soil simultaneously the density increased water content and void ratio decreased consequently when stress is applied to and causes soil particles pack together more compactly and water is squeezed out of the soil therefore the primary compression is due to excess pore water pressure because of effective stress the silty clay soils are affected with different loads because of the investigated site activities which confirms good compressional fig 5b and 5c hence the soil faintly over consolidated near the surface and generally consolidated at higher depths conversely pockets of organic soil and sand with different hardening degrees expected some differences in a settlement to avoid the problems resulting from this the decline should be reduced as much as possible by reducing new soil stresses 3 3 numerical results 3 3 1 effect of slr in groundwater levels and inundation scenario a the model was applied by increasing sea level by 5 67 14 51 and 26 72 cm the differences between groundwater head for the base case and the proposed scenarios fig 6 a 6b and 6c the results showed groundwater head increased to 5 65 14 50 and 26 70 cm the shoreline moved on the landside for 3 3 2 effect of over pumping on groundwater levels and land subsidence scenario b the nile delta population s high intensity is the main water supply problem for agriculture domestic and industry sectors the abstraction rates from wells are increased and water shortage occurs the abstraction rates in the nile delta fig 7 a from 1980 to 2016 with linear annual rates of 14 60 this study found the annual rates of 1 36 bcm in 2008 while the future is 1 88 2 70 and 3 50 bcm to 2060 with an increase in 1 38 1 98 and 2 58 from the base case the distribution of abstraction wells in the study area is presented in fig 7b this scenario s drawdown results fig 8 a 8b and 8c showed that the drawdown increases due to over pumping the maximum estimated drawdown reached 2 10 9 70 and 15 10 m moreover fig 8d 8e and 8f show the distribution of maximum subsidence results for 2020 2040 and 2060 to be 7 60 32 40 and 52 70 cm respectively the subsidence was detected using the analytical solution by eq 3 the clay cap s compressibility coefficient mv was 0 005 cm2 kg the quaternary layers specific storage was 0 0001 m 1 these values were estimated on the current soil investigation and laboratory analysis 3 3 3 effect of slr and over pumping on groundwater level and subsidence scenario c by combining the increase in sea level by 5 67 14 51 and 26 72 and over pumping rates by 1 38 1 98 and 2 58 from base case to 1 88 2 70 and 3 50 bcm simulated in this scenario the drawdown and land subsidence were estimated in wnda until 2060 fig 9 a 9b and 9c show the maximum drawdown of the expected scenarios for 2020 2040 and 2060 to reach 2 9 50 and 14 80 m also the maximum subsidence reached 7 50 32 and 51 90 cm respectively 4 discussion this study investigates the simulation of coastal aquifers environmental land subsidence hazards under slr and over pumping combined effect the proposed model for the coastal aquifer of the nile delta egypt uses measured geotechnical and hydrologic parameters as input data then several numerical simulations were conducted to investigate the future groundwater heads drawdown and subsidence rates by increasing sea levels and abstraction rates corresponding to 2020 2040 and 2060 the numerical simulation for the groundwater head and drawdown of the analytical solution for land subsidence must be considered with the present situation and networks future design abd elaty et al 2021a abd elaty et al 2021b el shinawi 2017 the irrigation lining canals closed pipe conduct networks open canals drains earth berms and banks are expected to suffer considerable damages and need rehabilitation the retaining walls will be subjected to failure due to sliding furthermore the irrigation structures for crossing works such as bridges culverts siphon and aqueducts the heading up structures including weirs regulators and dams might be subjected to differential settlement affecting these structures stability el nahry and doluschitz 2010 el shinawi 2017 the future design for these waterworks should be used fixable material considering the effect of future land subsidence the estimated land subsidence in 2020 and the future scenarios in 2040 and 2060 increased following increasing sea levels and increasing groundwater abstraction rates at the same time the drawdown fell and inversely proportioned with the slr and abstraction rate in 2020 and the future scenarios fig 10 presents the results of a rise in sea levels by 5 56 14 50 and 26 70 cm in 2020 2040 and 2060 were increased the groundwater head increased to 5 65 14 50 26 70 cm moreover the expected rise in the groundwater abstraction for 2020 2040 and 2060 was fallen the groundwater heads and increased the drawdown to 2 10 9 70 and 15 10 m while the subsidence reached 7 60 32 40 and 52 70 cm respectively the drawdown was also increased to 2 9 50 and 14 80 m and the subsidence was 7 50 32 and 51 90 cm for 2020 2040 and 2060 respectively moreover the subsidence in the southern part decreases and reaches 7 50 32 and 51 90 cm respectively caused by the slr effect in the south part at the expected future scenarios until 2060 from this perspective two hydrological forces for slr and over pumping should be effectively managed to mitigate long term settlement and maintain the coastal aquifer s water quality at a suitable level in which the expected results of groundwater heads consists of published materials by abd elaty et al abd elaty et al 2019 and abd elhamid et al abd elhamid et al 2019 for the combined impact of slr and over pumping in nile delta aquifers also the estimated land subsidence are provided by rateb and abotalib rateb and abotalib 2020 using field data by sentinel 1 satellites and gps between 2015 and 2019 in the north western part of the nile delta to reach between 20 to 16 mm year 1 due to groundwater overexploitation re very useful for the results of the current study accordingly the major effect of land subsidence is the over pumping of groundwater and the sea levels rise in the coastal aquifers there is a reasonable link between the land subsidence rate and the decrease of groundwater head or value piezometric head confirming that the abstraction of the coastal aquifer is responsible for increasing the land subsidence church et al 2013 lixin et al 2011 orhan et al 2021 saber et al 2018 suganthi and elango 2020 from all of the above the main reason for the decline in groundwater quality and land subsidence is groundwater pumping therefore it is important to justify the pumping speed to stop the decrease in groundwater pressure to solve the problem of land subsidence therefore possible remedial measures that can be taken are to reduce the pumping of groundwater in the study area these analyzes may be useful for monitoring and evaluating soil subsidence in similar high impact areas 5 conclusions the model was conducted using geotechnical and hydrologic parameters as input data accordingly the numerical study is simulated to investigate the groundwater levels and the drawdown by increasing sea levels and abstraction rates corresponding to 2060 based on data collection in this study the maximum subsidence was reached 7 60 32 40 and 52 40 cm for increasing the abstraction rates by 1 38 1 98 and 2 58 from the base case the subsidence values were decreased by combining slr and over pumping to 7 50 32 and 51 90 cm for 2020 2040 and 2060 we also conclude that the slr showed that the water table increased while the drawdown increased due to overpumping soil settlement was assessed using analytical solutions during pumping the results of this study are based on the limited amount of borehole data available in the public domain for soil research therefore accurate data are needed to refine the above assumptions accordingly the slr is an upward force that raises the water table and minimizes subsidence due to the downward force however the risk of cpr in the coastal zone arises when the earth s surface sinks at the same time excessive pumping leads to increased soil subsidence finally predicting land subsidence hazard and groundwater head fall will help the decision makers put an applicable strategy for mitigating the negative impact of the future hazard by land subsidence in a coastal aquifer credit authorship contribution statement abdelaziz el shinawi conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources alban kuriqi conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources supervision martina zelenakova conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources zuzana vranayova conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources ismail abd elaty conceptualization methodology investigation formal analysis data curation visualization writing original draft writing review editing resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors are thankful to the department of water and water structures engineering faculty of engineering zagazig university zagazig 44519 egypt for constant support during the study also alban kuriqi acknowledges the portuguese foundation for science and technology fct support through ptdc cta ohr 30561 2017 wintherface we finally thank zagazig university environmental geophysics lab for helping us to perform the soil laboratory testing this work is thankful to be supported by the project of the ministry of education of the slovak republic vega 1 0217 19 research of hybrid blue and green infrastructure as active elements of a sponge city vega1 0308 20 mitigation of hydrological hazards floods and droughts by exploring extreme hydroclimatic phenomena in river basins and the project od slovak research and development agency apvv 18 0360 active hybrid infrastructure towards to sponge city funding this study did not receive any funding availability of data and material upon request code availability upon request ethics approval not applicable consent to participate yes consent for publication yes 
3451,due to the heterogeneity and nonlinear process in the unsaturated soil zone it is challenging to represent the analytical mechanism and actual in situ water content in the soil layer with this in mind this study provides a novel approach to discern the water content in the shallow quaternary gravel layer at various depths using temporal sunlight and air temperature observation it demonstrates significant components in spectral density to evaluate the crucial importance concerning the time dependent soil water content sunlight quantum and air temperature it shows that the soil water content at 10 cm depth can distinguish the fluctuated manner of light quantum at the time lag of about 6 6 and 5 1 h for diurnal and semidiurnal processes respectively the time progress of soil water contents at 30 cm depth is less relevant to 10 cm depth but the phase at 60 and 120 cm depth is nearly in phase due to heterogeneity in the shallow layer the temporal changes of soil water content below 10 cm depth have varying coherence degrees thus using spectral analysis practically estimating the coherence and time lag between light quantum air temperature and soil water content becomes feasible and achievable keywords soil water content soil moisture sunlight quantum air temperature spectral analysis stochastic process 1 introduction heterogeneity in the soil layer usually controls the fate of groundwater flow in aquifers chemical contaminants entering the soil environment are often complicated when dealing with decontamination of the accidental operation of industrial facilities to discern the water content distributing in vertical profile may play an important role in remediation usually the soil water content is significantly affected by weather such as sunlight or rainfall during rainfall water can accumulate briefly resulting in a rapid movement from shallow soils or unsaturated layers into saturated aquifers therefore it needs to estimate the movement characteristics of water more accurately in time during the solarization period after rainfall water stagnates or moves more slowly through the soil layer making it difficult to estimate the timing wu et al 2002 found that soil moisture processes present temporal variability due to variations in meteorological forcing and spatial heterogeneity of soil properties interactions between soil moisture and temperature have gotten attention in the climate modeling community e g brabson et al 2005 clark et al 2006 zhang et al 2009 ramírez beltran et al 2008 used a feedforward artificial neural network training to estimate soil moisture at 5 10 50 and 100 cm depth it representsa root mean squared error rmse of 2 31 volumetric water content le bourgeois et al 2016 found the saturated hydraulic conductivity of the bedrock layer is low less than 5 mm h 1 and implied that the schist bedrock is poorly weathered and can produce a saturated zone above that depth as observed verrier 2020 provided a statistical description of soil moisture variability from nine in situ stations and found depths greater than 5 cm it shows more heterogeneity across stations qin et al 2018 performed the wavelet decomposition of soil water content near the surface to improve modeling by segregating features at different temporal scales and projecting them to the subsurface ehrhardt et al 2021 used wavelet coherency analysis for soil water contents and pressure heads to identify the relevant periods of the subsurface flow mechanism the results from the previous studies such as artificial neural network skills might be significantly affected by anthropogenic operations or subjective judgments fundamental descriptive statistics for soil moisture study can not catch the property of temporal evolution therefore it is imperative to seek a process to explore the significant transmission of each factor in the soil water system that can base on the naturally occurring data shih et al 2013 found that groundwater can be fluctuated by various disturbances such as seismic activity inducing the dilatation of earth can disturb groundwater level fluctuation as observed in groundwater wells using spectral analysis in the time frequency domain they deduced the relationship between groundwater fluctuations and ground motions caused by seismic activity therefore spectral analysis can explore the coherence for many relevant or correlated factors transferring time to the frequency domain to explore unseen events related to a leakage associated with radionuclides released in the environment or other subsurface contamination in the future a hypothetical and hybrid studied site hhs was built for the planned mission undergoing a long time for nuclear research it necessitates acting procedures to assess any remedial controls taken in response to the leakage the water content of the surface soil usually plays a critical role in the release of radionuclides however when the soil layer is directly affected by external influences sunlight and air temperature may be vital in natural environmental conditions thus exploring phase and time lag between sunlight quantum after this referred to as light quantum air temperature and soil water content at various depths steps for future remediation control 2 method and material the essential processes in the subsurface flow are infiltration of surface water into the soil become soil moisture after this referred to as soil water content unsaturated flow through soil or saturated flow through soil or rock strata in the unsaturated zone the capillary fringe starts from the water table it extends up to the limit of capillary rise of water dependent on the soil texture and its hydraulic conductivity in addition to water and solid material it has an additional air phase in the unsaturated zone hence the soil water property in a few tens centimeters scale at shallow surface soil is more unexpected than the saturated zone the richards equation represents water movement in unsaturated soils richards 1931 it is a nonlinear partial differential equation that is difficult to solve since it is not easy to have a closed form analytical solution the transient state richards equation in the vertical direction is 1 ϕ t z k h z 1 where k is the hydraulic conductivity and k k ϕ h is the water head induced by capillary action z is the elevation above a vertical datum ϕ is the volumetric water content and t is time moreover it drives the soil water diffusivity with suction head the form is 2 ϕ t z d h z k where d is the soil water diffusivity k ξ ϕ ξ is the suction head the total head is the sum of the suction and gravity head i e h ξ z in the unsaturated zone hydraulic conductivity in the richards equation represents a dependent variable with the soil water content variation and vertical position and the soil water content is also simultaneously time dependent it is difficult to determine the time dependent soil water content since hydraulic conductivity soil water diffusivity and suction head in vertical profile are not easy to obtain in the real world due to the heterogeneity and nonlinear process in the unsaturated zone it is challenging to represent the analytical mechanism of water in the soil for the spatial domain instead this study uses spectral analysis a stochastic process in time and frequency that can present the coherence of the external sources and soil water content in time and frequency patterns how to understand the change of soil moisture in the time frequency domain is based on which indicator is selected e g light quantum or air temperature in this study it likes using a black box system to investigate a transfer process with the input and output the soil water content in different depths is the output when it uses light quantum or air temperature as the input indicators the light quantum is a representative indicator of solar heat energy that is not interrupted by other measurable atmosphere factors the air near the ground surface even though many factors are affecting the environment the air temperature has directly reflected the resultant thermal state therefore air temperature is a valid indicator of the in situ external heat source s contact with the surface soil it is easy to measure the air temperature but soil temperature in deeper depth is not generally it is necessary to open holes to install soil temperature measuring equipment backfill the soil and leave it for a long time to make it return to its natural state cary 1967 observed that evaporation presents a significant relationship between soil temperature and water vapor pressure in the air rossabi and falta 2002 concluded that the pressure and flow through a vadose zone well can be accurately modeled based on measured atmospheric pressure however it is relatively insensitive to values of porosity tsang and pruess 1989 studied the ambient gas and moisture movements at yucca mountain they indicated that all estimates of the downward liquid flux in the partially saturated zone remain indirect and fraught with uncertainty barometric pressure changes caused by diurnal fluctuations and weather events are propagated through the subsurface with attenuation and delay induced by stratum permeability changes and depth riha 2005 changes in barometric pressure temperature induced density differences wind effects and topography might drive the airflow or gas a mixture of air and water vapor movement through the unsaturated zone wu et al 2006 thus the barometric effect changes soil moisture in the soil matrix will be an in depth problem other parameters such as wind velocity and solar radiation might have collinearity with air temperature and light quantum it therefore can use light quantum and air temperature instead of solar radiation heat and wind velocity as the input factors based on the above this study conceived the idea of recording photons generated from the sun and received at ground level in the time domain during solar irradiation as the primary control factor for soil water content and interpreting the time dependent observation sequence as the spectral density in the frequency domain since soil water content in the time domain may also contain components caused by other environmental factors it needs to evaluate the significant spectral density for light quantum air temperature and soil water content then further analyze the period and time lag between them finally this research addresses the coherence between light quantum air temperature and soil water content in the frequency domain to highlight the significance the studied site was designed and designated as a studied area with reliable protection committed to researching and developing nuclear energy technologies it locates near the north of taiwan fig 1 the site s surface is wild grass and there is a fixed time for maintenance to keep its length at about 10 cm the site is recent alluvium with local thin sediments and lateritic terrace gravel with clay formed in the quaternary from the surface down to the bedrock the gravel bed thickness is about 24 m the water table is approximately 16 17 m below the surface the sandstone bed is distributed nearly on the bottom of the gravel layer therefore it is essential to analyze in situ soil water conditions under sun exposure addressing radioactive release around the hhs regarding the hydrological environment this study collects hourly data of light quantum air temperature and soil water content at 10 30 60 and 120 cm depth in the surface of the hhs site using rainless cases table 1 the sketch illustrates a conceptual design of the layout of the sensors for this study fig 2 a crystalline type panel measures the light quantum while a thermistor type and volumetric moisture type sensor detect air temperature and soil water content respectively the changes of light quantum air temperature and soil water content are approximately 1800 μmol 15 c and 5 respectively fig 3 the range of soil water content at 60 and 120 cm depth is only about 3 it reveals that the periodic cycle is distinct in the time series presented in fig 3 the observed time series is a synthetic wave with hidden periodic fluctuation components spectral analysis still needs to be further analyzed to determine the significant part of the fluctuation 3 spectral analysis spectral analysis converts a time sequence into the power spectral density in the frequency domain given a random variable in the time domain φ φ t it defines the complex components of fourier transform as 3 φ f φ t e 2 π i f t d t where φ is a time dependent random variable φ is the complex fourier components in the frequency domain i is 1 t is the elapsed time and f is the frequency let the finite time sequence t be in eq 3 it rewrites as 4 φ f t 0 t φ t e 2 π i f t d t the component φ is the finite time length but also a function of frequency eq 4 cannot satisfy a small time range due to a lack of statistical significance if the signals are too short the fluctuated properties are discarded for a stationary time series φ t of a length of t it divides into n d contiguous segments with each segment length of t s it estimates the two sided auto spectral density for each part by 5 s φ φ 1 t s φ f t s 2 averaging each of the resultant component obtains a final smooth auto spectral density and satisfies the statistical significance given δ t as the sampling rate in time it defines the discrete frequency as 6 f k k t s k n δ t k 0 1 n 1 where n denotes the length of segments the smoothed one sided auto spectral density expresses as 7 g φ φ f 2 n d n δ t i 1 n d φ i f k 2 k 0 1 n 2 it calculates the raw estimate cross spectral density for each sub record for two different time series for example φ t and ψ t through fourier components φ f k and ψ f k utilizing 8 g φ ψ f 2 n d n δ t i 1 n d φ i f k ψ i f k k 0 1 n 2 where φ i f k is the complex conjugate of φ i f k and k 0 1 n 2 the smooth estimate of cross spectra and associated quantity are 9 g φ ψ f k c φ ψ f k q φ ψ f k g φ ψ f k φ i θ φ ψ f k 10 θ φ ψ f k t a n 1 q φ ψ f k c φ ψ f k 11 r φ ψ 2 f k g φ ψ f k 2 g φ φ f k g ψ ψ f k where c φ ψ f k q φ ψ f k θ φ ψ f k r φ ψ 2 f k are co spectra quadrature spectra phase angle and squared coherence for k 0 1 n 2 respectively it gives a 95 confidence interval ci of the auto spectra as bendat and piersol 2000 12 n g γ γ f k χ n 0 05 2 2 g γ γ f k n g γ γ f k χ n 1 0 05 2 2 where χ n α 2 is the chi square distribution for a percentage α so that probability χ n 2 χ n α 2 α with degrees of freedom n n 2 n d the coherence with a 95 ci is 13 1 2 2 1 r f k 2 r f k n d r 1 2 2 1 r f k 2 r f k n d shih et al 1999 derived the 95 non zero coherence significance level nzc as 14 r f k r f k n d 32 n d 4 2 4 result this research suggests that spectral analysis using fourier decompositions can identify power spectra in the frequency domain for the periodical fluctuations such as the selected parameters in the time domain fig 3 table 2 reports the descriptive statistics of the light quantum litqum air temperature airtmp and soil water content swc010 swc030 swc060 and swc120 at various depths a higher standard deviation for the soil water content at shallow depths e g 10 and 30 cm has been observed the normality tests identify the normality of the observations using the shapiro wilk and kolmogorov smirnov test it shows that the data changes significantly from the expected pattern assuming the data described from a normal distribution it requires the prior treatment using time blocks smoothing for a stationary spectral estimate the removal of linear trend is adopted on the calculation record using the least square method to suppress unnecessary trend or abnormal variations within the time block also it uses the hanning window to suppress leakage problems for spectral density bloomfield 2004 shih et al 2013 the resolution of frequency is at 3 205 10 3 cycles h 1 cph for a sub record of time length 312 h in a total of 624 h the auto spectra with the 95 confidence interval ci present lower and upper extremes are at 0 359 and 8 257 the non zero coherence level of significance for cross spectra is 0 781 although the cross spectral confidence interval depends on the coherence of each discrete frequency interval it is still reasonable to use the non zero coherence level instead of the confidence interval of cross spectral density to identify the significance of spectral peaks comparing 95 ci of auto spectral density presents the most significant auto spectral density for light quantum air temperature and soil water content at various depths are diurnal and semidiurnal components fig 4 they related to the frequency 4 167 10 2 and 8 333 10 2 cph the corresponding periods are 24 and 12 h respectively table 3 and table 4 compared to the semidiurnal component at 10 30 and 60 cm depth the auto spectral density of soil water content at 120 cm depth is relatively less significant the cross spectral density and coherence are highly relevant in diurnal and semidiurnal components for light quantum and air temperature to the soil water content at 10 cm depth fig 5 fig 6 reveals that the coherence is low between soil water content at a depth of 10 and 30 cm for diurnal and semidiurnal fluctuations while at a depth of 30 60 cm and 60 120 cm is high by checking the phase lag estimate for the diurnal component the correspondent time lag is 6 564 h for light quantum to soil water content at 10 cm depth table 3 a time lag for light quantum to air temperature is 1 662 h for the diurnal table 3 and fig 7 a sudden time lag by phase propagation between 60 and 120 cm is about 7 395 h the 60 and 120 cm depth is almost in phase table 3 for the semidiurnal the time lag of light quantum to air temperature and soil water content at 10 cm depth is 0 405 and 5 149 h respectively table 4 and fig 7 the coherence of soil water content between 10 and 30 cm depth is low but 30 60 and 60 120 cm are high table 4 it shows that soil water content fluctuation between 10 and 30 cm depth is less relevant it observed that coherence of soil water content at 30 60 and 120 cm are high to each other like the diurnal case a more prolonged time lag e g 4 922 h exists between 30 and 60 cm depth table 4 5 discussion in this study the diurnal component in the frequency domain is the most significant for light quantum air temperature and soil water content at various depths furthermore it meets the time lag from the phase pattern using the diurnal and semidiurnal bandpass filter fig 8 it shows that both for the diurnal and semidiurnal time series selected for the significant power spectral density is apparent the time lags are consistent with table 3 except for the soil water content between 30 and 60 cm fig 8 and fig 3 visually present that the diurnal component is more significant than the semidiurnal one due to the higher amplitude notable peaks in auto spectra and cross spectra also have proved this point fig 4 and fig 5 this study observed that light quantum air temperature and soil water contents at various depths exhibit the periodic pattern in the time progress and amplitude it is worth noting that the phase with correspondent time lag exists the soil water content at 10 cm depth discerns the temporal pattern from light quantum and air temperature for the diurnal process quite apparently it reflects the time lag at about 6 564 and 4 826 h respectively table 3 when the sun reaches its maximum amplitude air temperature and soil moisture get only 89 and 23 of their peak amplitude respectively fig 8 for the semidiurnal process the soil water content at 10 cm depth senses the light quantum and air temperature markedly at the time lag of 5 149 and 4 695 h respectively table 4 the air temperature is almost in phase with light quantum while soil water content at 10 cm depth is out of phase fig 8 and table 4 it infers that air temperature follows the time evolution of light quantum in a time lag between 0 4 and 1 7 h at the shallow layer the soil water content at 10 cm depth follows the diurnal and semidiurnal processes at about 5 6 h the coherence between 10 and 30 cm depth is less relevant however for the diurnal and semidiurnal soil water contents at 120 cm depth can directly affect the upper layer the 60 cm depth they are almost in phase both for the diurnal and semidiurnal components the phenomena of low coherence of soil water content between 10 and 30 cm might be related to heterogeneous deposition of soil a significant abrupt inversed phase between 30 and 60 cm could be associated with the heterogeneous layer and non natural substances however whether it is for the diurnal or semidiurnal components the phase difference still exists when the depth is greater than 10 cm and its amount varies with the depth still it has no proportional relationship with the depth therefore possible remediated processes and control can follow derived time lags associated with sunlight changes under the rainless condition 6 conclusion this study explores the spectral coherence phase and time lag between sunlight quantum air temperature and soil water content at various depths to comprehend the temporal evolution of soil water content in the shallow quaternary gravel layer the soil water content at 10 cm depth can recognize the frequency pattern of sunlight quantum and air temperature fluctuation the soil water content represents a more significant variability of time lag for the diurnal and semidiurnal variations e g at the 30 60 cm depth explains that heterogeneous depositions of soil water in sedimenting process or non natural material existed in the studied position in future research the method of this study is also applicable to explore the vertical distribution of soil water in the time and frequency domain due to direct infiltration after rainfall also how the barometric effect changes soil moisture in the soil matrix deserves to explore in depth credit authorship contribution statement david ching fang shih conceptualization methodology analysis writing review editing visualization declaration of competing interest the author declares that he has no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the author thanks the institute of nuclear energy research taiwan roc for supporting the data preparation of the research 
3451,due to the heterogeneity and nonlinear process in the unsaturated soil zone it is challenging to represent the analytical mechanism and actual in situ water content in the soil layer with this in mind this study provides a novel approach to discern the water content in the shallow quaternary gravel layer at various depths using temporal sunlight and air temperature observation it demonstrates significant components in spectral density to evaluate the crucial importance concerning the time dependent soil water content sunlight quantum and air temperature it shows that the soil water content at 10 cm depth can distinguish the fluctuated manner of light quantum at the time lag of about 6 6 and 5 1 h for diurnal and semidiurnal processes respectively the time progress of soil water contents at 30 cm depth is less relevant to 10 cm depth but the phase at 60 and 120 cm depth is nearly in phase due to heterogeneity in the shallow layer the temporal changes of soil water content below 10 cm depth have varying coherence degrees thus using spectral analysis practically estimating the coherence and time lag between light quantum air temperature and soil water content becomes feasible and achievable keywords soil water content soil moisture sunlight quantum air temperature spectral analysis stochastic process 1 introduction heterogeneity in the soil layer usually controls the fate of groundwater flow in aquifers chemical contaminants entering the soil environment are often complicated when dealing with decontamination of the accidental operation of industrial facilities to discern the water content distributing in vertical profile may play an important role in remediation usually the soil water content is significantly affected by weather such as sunlight or rainfall during rainfall water can accumulate briefly resulting in a rapid movement from shallow soils or unsaturated layers into saturated aquifers therefore it needs to estimate the movement characteristics of water more accurately in time during the solarization period after rainfall water stagnates or moves more slowly through the soil layer making it difficult to estimate the timing wu et al 2002 found that soil moisture processes present temporal variability due to variations in meteorological forcing and spatial heterogeneity of soil properties interactions between soil moisture and temperature have gotten attention in the climate modeling community e g brabson et al 2005 clark et al 2006 zhang et al 2009 ramírez beltran et al 2008 used a feedforward artificial neural network training to estimate soil moisture at 5 10 50 and 100 cm depth it representsa root mean squared error rmse of 2 31 volumetric water content le bourgeois et al 2016 found the saturated hydraulic conductivity of the bedrock layer is low less than 5 mm h 1 and implied that the schist bedrock is poorly weathered and can produce a saturated zone above that depth as observed verrier 2020 provided a statistical description of soil moisture variability from nine in situ stations and found depths greater than 5 cm it shows more heterogeneity across stations qin et al 2018 performed the wavelet decomposition of soil water content near the surface to improve modeling by segregating features at different temporal scales and projecting them to the subsurface ehrhardt et al 2021 used wavelet coherency analysis for soil water contents and pressure heads to identify the relevant periods of the subsurface flow mechanism the results from the previous studies such as artificial neural network skills might be significantly affected by anthropogenic operations or subjective judgments fundamental descriptive statistics for soil moisture study can not catch the property of temporal evolution therefore it is imperative to seek a process to explore the significant transmission of each factor in the soil water system that can base on the naturally occurring data shih et al 2013 found that groundwater can be fluctuated by various disturbances such as seismic activity inducing the dilatation of earth can disturb groundwater level fluctuation as observed in groundwater wells using spectral analysis in the time frequency domain they deduced the relationship between groundwater fluctuations and ground motions caused by seismic activity therefore spectral analysis can explore the coherence for many relevant or correlated factors transferring time to the frequency domain to explore unseen events related to a leakage associated with radionuclides released in the environment or other subsurface contamination in the future a hypothetical and hybrid studied site hhs was built for the planned mission undergoing a long time for nuclear research it necessitates acting procedures to assess any remedial controls taken in response to the leakage the water content of the surface soil usually plays a critical role in the release of radionuclides however when the soil layer is directly affected by external influences sunlight and air temperature may be vital in natural environmental conditions thus exploring phase and time lag between sunlight quantum after this referred to as light quantum air temperature and soil water content at various depths steps for future remediation control 2 method and material the essential processes in the subsurface flow are infiltration of surface water into the soil become soil moisture after this referred to as soil water content unsaturated flow through soil or saturated flow through soil or rock strata in the unsaturated zone the capillary fringe starts from the water table it extends up to the limit of capillary rise of water dependent on the soil texture and its hydraulic conductivity in addition to water and solid material it has an additional air phase in the unsaturated zone hence the soil water property in a few tens centimeters scale at shallow surface soil is more unexpected than the saturated zone the richards equation represents water movement in unsaturated soils richards 1931 it is a nonlinear partial differential equation that is difficult to solve since it is not easy to have a closed form analytical solution the transient state richards equation in the vertical direction is 1 ϕ t z k h z 1 where k is the hydraulic conductivity and k k ϕ h is the water head induced by capillary action z is the elevation above a vertical datum ϕ is the volumetric water content and t is time moreover it drives the soil water diffusivity with suction head the form is 2 ϕ t z d h z k where d is the soil water diffusivity k ξ ϕ ξ is the suction head the total head is the sum of the suction and gravity head i e h ξ z in the unsaturated zone hydraulic conductivity in the richards equation represents a dependent variable with the soil water content variation and vertical position and the soil water content is also simultaneously time dependent it is difficult to determine the time dependent soil water content since hydraulic conductivity soil water diffusivity and suction head in vertical profile are not easy to obtain in the real world due to the heterogeneity and nonlinear process in the unsaturated zone it is challenging to represent the analytical mechanism of water in the soil for the spatial domain instead this study uses spectral analysis a stochastic process in time and frequency that can present the coherence of the external sources and soil water content in time and frequency patterns how to understand the change of soil moisture in the time frequency domain is based on which indicator is selected e g light quantum or air temperature in this study it likes using a black box system to investigate a transfer process with the input and output the soil water content in different depths is the output when it uses light quantum or air temperature as the input indicators the light quantum is a representative indicator of solar heat energy that is not interrupted by other measurable atmosphere factors the air near the ground surface even though many factors are affecting the environment the air temperature has directly reflected the resultant thermal state therefore air temperature is a valid indicator of the in situ external heat source s contact with the surface soil it is easy to measure the air temperature but soil temperature in deeper depth is not generally it is necessary to open holes to install soil temperature measuring equipment backfill the soil and leave it for a long time to make it return to its natural state cary 1967 observed that evaporation presents a significant relationship between soil temperature and water vapor pressure in the air rossabi and falta 2002 concluded that the pressure and flow through a vadose zone well can be accurately modeled based on measured atmospheric pressure however it is relatively insensitive to values of porosity tsang and pruess 1989 studied the ambient gas and moisture movements at yucca mountain they indicated that all estimates of the downward liquid flux in the partially saturated zone remain indirect and fraught with uncertainty barometric pressure changes caused by diurnal fluctuations and weather events are propagated through the subsurface with attenuation and delay induced by stratum permeability changes and depth riha 2005 changes in barometric pressure temperature induced density differences wind effects and topography might drive the airflow or gas a mixture of air and water vapor movement through the unsaturated zone wu et al 2006 thus the barometric effect changes soil moisture in the soil matrix will be an in depth problem other parameters such as wind velocity and solar radiation might have collinearity with air temperature and light quantum it therefore can use light quantum and air temperature instead of solar radiation heat and wind velocity as the input factors based on the above this study conceived the idea of recording photons generated from the sun and received at ground level in the time domain during solar irradiation as the primary control factor for soil water content and interpreting the time dependent observation sequence as the spectral density in the frequency domain since soil water content in the time domain may also contain components caused by other environmental factors it needs to evaluate the significant spectral density for light quantum air temperature and soil water content then further analyze the period and time lag between them finally this research addresses the coherence between light quantum air temperature and soil water content in the frequency domain to highlight the significance the studied site was designed and designated as a studied area with reliable protection committed to researching and developing nuclear energy technologies it locates near the north of taiwan fig 1 the site s surface is wild grass and there is a fixed time for maintenance to keep its length at about 10 cm the site is recent alluvium with local thin sediments and lateritic terrace gravel with clay formed in the quaternary from the surface down to the bedrock the gravel bed thickness is about 24 m the water table is approximately 16 17 m below the surface the sandstone bed is distributed nearly on the bottom of the gravel layer therefore it is essential to analyze in situ soil water conditions under sun exposure addressing radioactive release around the hhs regarding the hydrological environment this study collects hourly data of light quantum air temperature and soil water content at 10 30 60 and 120 cm depth in the surface of the hhs site using rainless cases table 1 the sketch illustrates a conceptual design of the layout of the sensors for this study fig 2 a crystalline type panel measures the light quantum while a thermistor type and volumetric moisture type sensor detect air temperature and soil water content respectively the changes of light quantum air temperature and soil water content are approximately 1800 μmol 15 c and 5 respectively fig 3 the range of soil water content at 60 and 120 cm depth is only about 3 it reveals that the periodic cycle is distinct in the time series presented in fig 3 the observed time series is a synthetic wave with hidden periodic fluctuation components spectral analysis still needs to be further analyzed to determine the significant part of the fluctuation 3 spectral analysis spectral analysis converts a time sequence into the power spectral density in the frequency domain given a random variable in the time domain φ φ t it defines the complex components of fourier transform as 3 φ f φ t e 2 π i f t d t where φ is a time dependent random variable φ is the complex fourier components in the frequency domain i is 1 t is the elapsed time and f is the frequency let the finite time sequence t be in eq 3 it rewrites as 4 φ f t 0 t φ t e 2 π i f t d t the component φ is the finite time length but also a function of frequency eq 4 cannot satisfy a small time range due to a lack of statistical significance if the signals are too short the fluctuated properties are discarded for a stationary time series φ t of a length of t it divides into n d contiguous segments with each segment length of t s it estimates the two sided auto spectral density for each part by 5 s φ φ 1 t s φ f t s 2 averaging each of the resultant component obtains a final smooth auto spectral density and satisfies the statistical significance given δ t as the sampling rate in time it defines the discrete frequency as 6 f k k t s k n δ t k 0 1 n 1 where n denotes the length of segments the smoothed one sided auto spectral density expresses as 7 g φ φ f 2 n d n δ t i 1 n d φ i f k 2 k 0 1 n 2 it calculates the raw estimate cross spectral density for each sub record for two different time series for example φ t and ψ t through fourier components φ f k and ψ f k utilizing 8 g φ ψ f 2 n d n δ t i 1 n d φ i f k ψ i f k k 0 1 n 2 where φ i f k is the complex conjugate of φ i f k and k 0 1 n 2 the smooth estimate of cross spectra and associated quantity are 9 g φ ψ f k c φ ψ f k q φ ψ f k g φ ψ f k φ i θ φ ψ f k 10 θ φ ψ f k t a n 1 q φ ψ f k c φ ψ f k 11 r φ ψ 2 f k g φ ψ f k 2 g φ φ f k g ψ ψ f k where c φ ψ f k q φ ψ f k θ φ ψ f k r φ ψ 2 f k are co spectra quadrature spectra phase angle and squared coherence for k 0 1 n 2 respectively it gives a 95 confidence interval ci of the auto spectra as bendat and piersol 2000 12 n g γ γ f k χ n 0 05 2 2 g γ γ f k n g γ γ f k χ n 1 0 05 2 2 where χ n α 2 is the chi square distribution for a percentage α so that probability χ n 2 χ n α 2 α with degrees of freedom n n 2 n d the coherence with a 95 ci is 13 1 2 2 1 r f k 2 r f k n d r 1 2 2 1 r f k 2 r f k n d shih et al 1999 derived the 95 non zero coherence significance level nzc as 14 r f k r f k n d 32 n d 4 2 4 result this research suggests that spectral analysis using fourier decompositions can identify power spectra in the frequency domain for the periodical fluctuations such as the selected parameters in the time domain fig 3 table 2 reports the descriptive statistics of the light quantum litqum air temperature airtmp and soil water content swc010 swc030 swc060 and swc120 at various depths a higher standard deviation for the soil water content at shallow depths e g 10 and 30 cm has been observed the normality tests identify the normality of the observations using the shapiro wilk and kolmogorov smirnov test it shows that the data changes significantly from the expected pattern assuming the data described from a normal distribution it requires the prior treatment using time blocks smoothing for a stationary spectral estimate the removal of linear trend is adopted on the calculation record using the least square method to suppress unnecessary trend or abnormal variations within the time block also it uses the hanning window to suppress leakage problems for spectral density bloomfield 2004 shih et al 2013 the resolution of frequency is at 3 205 10 3 cycles h 1 cph for a sub record of time length 312 h in a total of 624 h the auto spectra with the 95 confidence interval ci present lower and upper extremes are at 0 359 and 8 257 the non zero coherence level of significance for cross spectra is 0 781 although the cross spectral confidence interval depends on the coherence of each discrete frequency interval it is still reasonable to use the non zero coherence level instead of the confidence interval of cross spectral density to identify the significance of spectral peaks comparing 95 ci of auto spectral density presents the most significant auto spectral density for light quantum air temperature and soil water content at various depths are diurnal and semidiurnal components fig 4 they related to the frequency 4 167 10 2 and 8 333 10 2 cph the corresponding periods are 24 and 12 h respectively table 3 and table 4 compared to the semidiurnal component at 10 30 and 60 cm depth the auto spectral density of soil water content at 120 cm depth is relatively less significant the cross spectral density and coherence are highly relevant in diurnal and semidiurnal components for light quantum and air temperature to the soil water content at 10 cm depth fig 5 fig 6 reveals that the coherence is low between soil water content at a depth of 10 and 30 cm for diurnal and semidiurnal fluctuations while at a depth of 30 60 cm and 60 120 cm is high by checking the phase lag estimate for the diurnal component the correspondent time lag is 6 564 h for light quantum to soil water content at 10 cm depth table 3 a time lag for light quantum to air temperature is 1 662 h for the diurnal table 3 and fig 7 a sudden time lag by phase propagation between 60 and 120 cm is about 7 395 h the 60 and 120 cm depth is almost in phase table 3 for the semidiurnal the time lag of light quantum to air temperature and soil water content at 10 cm depth is 0 405 and 5 149 h respectively table 4 and fig 7 the coherence of soil water content between 10 and 30 cm depth is low but 30 60 and 60 120 cm are high table 4 it shows that soil water content fluctuation between 10 and 30 cm depth is less relevant it observed that coherence of soil water content at 30 60 and 120 cm are high to each other like the diurnal case a more prolonged time lag e g 4 922 h exists between 30 and 60 cm depth table 4 5 discussion in this study the diurnal component in the frequency domain is the most significant for light quantum air temperature and soil water content at various depths furthermore it meets the time lag from the phase pattern using the diurnal and semidiurnal bandpass filter fig 8 it shows that both for the diurnal and semidiurnal time series selected for the significant power spectral density is apparent the time lags are consistent with table 3 except for the soil water content between 30 and 60 cm fig 8 and fig 3 visually present that the diurnal component is more significant than the semidiurnal one due to the higher amplitude notable peaks in auto spectra and cross spectra also have proved this point fig 4 and fig 5 this study observed that light quantum air temperature and soil water contents at various depths exhibit the periodic pattern in the time progress and amplitude it is worth noting that the phase with correspondent time lag exists the soil water content at 10 cm depth discerns the temporal pattern from light quantum and air temperature for the diurnal process quite apparently it reflects the time lag at about 6 564 and 4 826 h respectively table 3 when the sun reaches its maximum amplitude air temperature and soil moisture get only 89 and 23 of their peak amplitude respectively fig 8 for the semidiurnal process the soil water content at 10 cm depth senses the light quantum and air temperature markedly at the time lag of 5 149 and 4 695 h respectively table 4 the air temperature is almost in phase with light quantum while soil water content at 10 cm depth is out of phase fig 8 and table 4 it infers that air temperature follows the time evolution of light quantum in a time lag between 0 4 and 1 7 h at the shallow layer the soil water content at 10 cm depth follows the diurnal and semidiurnal processes at about 5 6 h the coherence between 10 and 30 cm depth is less relevant however for the diurnal and semidiurnal soil water contents at 120 cm depth can directly affect the upper layer the 60 cm depth they are almost in phase both for the diurnal and semidiurnal components the phenomena of low coherence of soil water content between 10 and 30 cm might be related to heterogeneous deposition of soil a significant abrupt inversed phase between 30 and 60 cm could be associated with the heterogeneous layer and non natural substances however whether it is for the diurnal or semidiurnal components the phase difference still exists when the depth is greater than 10 cm and its amount varies with the depth still it has no proportional relationship with the depth therefore possible remediated processes and control can follow derived time lags associated with sunlight changes under the rainless condition 6 conclusion this study explores the spectral coherence phase and time lag between sunlight quantum air temperature and soil water content at various depths to comprehend the temporal evolution of soil water content in the shallow quaternary gravel layer the soil water content at 10 cm depth can recognize the frequency pattern of sunlight quantum and air temperature fluctuation the soil water content represents a more significant variability of time lag for the diurnal and semidiurnal variations e g at the 30 60 cm depth explains that heterogeneous depositions of soil water in sedimenting process or non natural material existed in the studied position in future research the method of this study is also applicable to explore the vertical distribution of soil water in the time and frequency domain due to direct infiltration after rainfall also how the barometric effect changes soil moisture in the soil matrix deserves to explore in depth credit authorship contribution statement david ching fang shih conceptualization methodology analysis writing review editing visualization declaration of competing interest the author declares that he has no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the author thanks the institute of nuclear energy research taiwan roc for supporting the data preparation of the research 
3452,assessing the impact of ecological water diversion on oasis restoration is critical for water resources and environmental management in arid inland basins this study proposed a copula incorporated cellular automata ca module for modeling the oasis s spatial distribution driven by ecological water diversion given the effects of groundwater depth and community expansion on oasis evolution a water availability index and a neighbor vegetation index were proposed these two indices were joint using the clayton copula function producing a vegetation suitability index that quantified vegetation growth s habitat quality and provided the ca module s basis to identify cellular categories the ca module was integrated into a previously developed conceptual lumped ecohydrological model clem resulting in an improved ca clem that outputted groundwater depth oasis area oasis ndvi and oasis distribution data the clem provided the oasis area changes for the ca module which specified the spatial distribution of these changes the ca clem had a simple structure low computation cost and good performance indicated by the application in the shiyang river basin in northwest china results show that an ecological water diversion of 30 million m3 with an average groundwater depth of 2 95 m an oasis area of 25 km2 and an oasis ndvi of 0 36 would successfully recover the terminal qingtu oasis in 2020 the oasis distribution and its dynamic evolution processes were irregular because of the spatial heterogeneity of vegetation habitat suitability the present qingtu oasis was fragile and its sustainability relied on ecological water diversion the reduction in water diversion would cause water table decline oasis area shrinkage vegetation degradation and oasis fragmentation the ca clem combined with scenario analysis provides practical and reliable implications for managers and policymakers to improve ecological water diversion strategies keywords cellular automata copula function spatial dynamics ecohydrological simulation ecological water diversion oasis restoration 1 introduction in the lower reaches of arid inland basins typically characterized by desert areas with scarce precipitation and significant evaporation rates natural oasis ecosystems highly depend on groundwater including the portions of groundwater transformed from surface water eamus and froend 2006 significant declines in water tables caused by groundwater over exploitation to satisfy the needs of a growing population have dramatically triggered many environmental problems including vegetation degradation land desertification terminal lake shrinkage and wetland loss resulting in the deterioration of groundwater dependent ecosystems zhu et al 2016 restoring degraded groundwater dependent ecosystems and satisfying their environmental water requirements are critical for sustainable watershed management huang et al 2021a ecological water diversion is a practical and effective method for restoring riparian and terminal oases in arid inland basins huang et al 2020a ecological water diversion projects have successfully recovered and protected the groundwater dependent oases in the heihe river tarim river and shiyang river basins in northwest china du et al 2020 hao and li 2014 huang et al 2020b monitoring and simulating the oasis s ecohydrological responses to ecological water diversion provide the basis for assessing the project s impact and improving the water diversion strategies sustainable watershed management has motivated special efforts in modeling the interactions between hydrological and ecological processes driven by ecological water diversion for example an ecohydrological evolution model synthesized the boussinesq equation and the vegetation colonization and mortality functions liu et al 2012 also a fully distributed ecohydrological model incorporated a vegetation dynamics module into the modified modflow han et al 2015 these models were physically based and spatially distributed resulting in complex model structures and complicated calculations a conceptual lumped ecohydrological model clem was proposed to address this issue by focusing on the overall interactions between hydrological and ecological processes huang et al 2021b the clem integrated the processes of groundwater recharge oasis area change vegetation growth and evapotranspiration it performed well in long term prediction for different scenarios of ecological water diversion huang et al 2021b however both the physically based and lumped ecohydrological models fall short in adequately modeling spatial dynamics during the restoration of the oasis although the physically based models characterized the oasis s spatial distribution they did not facilitate the long term simulation of overall oasis restoration in different water diversion scenarios due to their intrinsic complicated structures the conceptual lumped models simulated the oasis area but ignored the spatial distribution a simplified and more practical model is necessary to simulate the spatial distribution of the oasis recovered by ecological water diversion to improve water use efficiency for ecological restoration and protection of oases it is essential to comprehensively quantify the impacts of ecological water diversion on the recovery of the system given that clem is a practical tool used in ecohydrological process simulation huang et al 2021b this study aimed to further improve clem by integrating a cellular automata ca module to expand modeling capabilities into the spatial domain the spatial complexity of ecosystems can be investigated through ca models consisting of many identical components each simple but capable of complex behavior wolfram 1984 the ca models have been successfully applied to simulate spatial vegetation evolution desert oasis ecotone changes and watershed land use and cover changes aassine and el jaı 2002 sun et al 2021 xue et al 2019 the novelty and improvement of this study were embodied in proposing the copula based vegetation suitability index to develop the ca module and incorporating it into the clem resulting in the improved ca clem the proposed ca clem was applied in the qingtu oasis which is the terminal oasis of the shiyang river basin in the arid region of northwest china the shiyang river basin is a typical arid inland river basin its terminal qingtu lake had been dry for several decades due to water resources overexploitation for irrigation industry and domestic requirements an ecological water diversion project has been implemented since 2010 to address the environmental degradation and restore the dried up qingtu lake to the present qingtu oasis for local interests this application s results provide vital information for managers and policymakers to rationally regulate ecological water diversion and improve water allocation strategies in the shiyang river basin for worldwide interests the module proposed by this study provides an effective tool for environmental impact assessment of the ecological water diversion project which is a vital component of watershed management and environmental preservation policy initiatives 2 case study site and data 2 1 study area the shiyang river system originates in the qilian mountain and ends at qingtu oasis fig 1 detailed introduction of the geography meteorology hydrology and ecology of the shiyang river basin can be found in the literature gu et al 2016 hu et al 2021 huang et al 2021b qiao et al 2020 once there was a natural terminal lake named qingtu lake which had shrunk drastically due to water resources exploitation for agricultural development since the han dynasty 110 bce rapid population growth accompanied by socioeconomic development exacerbated the lake shrinkage to 120 km2 in the early 20th century and to 40 km2 by the 1940s because of the impoundment of the hongyashan reservoir that almost cut off all the inflow to the lake qingtu lake completely dried up in 1959 resulting in the degradation of the surrounding natural oasis and the desertification of the lower shiyang river basin in recent times a general restoration plan was implemented to mitigate the negative impacts of the dried up lake on the stability and sustainability of the shiyang river basin since september 2010 the hongyashan reservoir has supplied ecological water annually through a network of artificial channels that feed the original qingtu lake by the end of 2019 the total volume of water diversion had reached 281 million m3 instead of recovering the natural qingtu lake the objective was to preserve shallow groundwater for building a new oasis termed qingtu oasis the ecological water diversion project has successfully elevated the local water table increased vegetation coverage and expanded the oasis area huang et al 2020b the groundwater depth increases in a gradient from the central oasis to the desert edge correspondingly the vegetation community changes from hygrophytes to xerophytes chunyu et al 2019 local vegetation includes phragmitesaustralis suaedaglauca haloxylonammodendron kalidiumfoliatum and nitrariatangutorum along which phragmitesaustralis a typical hygrophyte and nitrariatangutorum a typical xerophyte the case study of qingtu oasis serves as a good prototype experiment on modeling the spatial distribution of the oasis recovered by ecological water diversion 2 2 hydrological and remote sensing data annual water diversion data from 2010 to 2019 were used for simulating the hydrological and ecological dynamics of qingtu oasis the hongyashan reservoir usually supplied the ecological water in the next half year when less water was necessary for irrigation in viewing that groundwater was mainly recharged by the water diversion of last year the water diversion of a year was used for modeling the ecohydrological processes of the next year for example the water diversion in 2019 was used in the water balance analysis of 2020 groundwater level data were provided by the hydrology bureau of gansu province which manages a hydrometric station located at the northeast edge of qingtu oasis fig 1c annual mean groundwater depth data spanned from 2010 to 2020 providing the basis for assessing the impact of ecological water diversion on groundwater recovery and the corresponding vegetation restoration the ecological water diversion formed seasonally inundated areas where the surface water contributed to local groundwater recharge through deep percolation remote sensing images were analyzed to characterize the temporal and spatial dynamics of the inundated areas the inundated areas were detected using a standard that combined the normalized difference water index ndwi and the normalized difference vegetation index ndvi huang et al 2021d ji et al 2009 pettorelli et al 2005 the ndvi and ndwi values were estimated based on methods commonly found in the literature mcfeeters 1996 rouse et al 1974 the pixels with ndwi 0 and ndvi 0 were identified as the inundated areas because of the stronger water signal than the vegetation signal landsat 8 products of landsat lc08 c01 t1 sr were used to calculate ndwi and ndvi which spanned from 2013 to 2020 the analysis was implemented on the google earth engine platform https code earthengine google com long term ndvi data spanning before and after ecological water diversion were critical for assessing the oasis restoration hu et al 2021 the ndvi products of moderate resolution imaging spectroradiometer modis have been widely used in land cover change analysis of arid inland river basins liu et al 2012 modis terra mod13q1 products https ladsweb modaps eosdis nasa gov provided the ndvi data spanning from 2000 to 2020 among which the pre impact period of 2000 2009 provided a criterion for detecting the ndvi changes during 2010 2020 yearly maximum ndvi data served as vegetation surrogates representing the recovered oasis areas visual inspection was practical and exercisable to identify the restored areas and when a pixel started to recover producing each year s vegetation distribution images of 2010 2020 huang et al 2021b 3 methods because of the ca models simple structure and practicality this study developed a ca module to characterize the oasis s spatial distribution the proposed ca module was synthesized into the clem to yield an improved ca clem model enhancing the original clem s capability to simulate the oasis s spatial distribution driven by ecological water diversion when constructing the ca module a key element was to formulate the transition rules of the lattice this study proposed a vegetation suitability index vsi to determine whether the lattice would recover to vegetation or degrade to bare land the vsi combined the impact of water availability and vegetation dispersion using the copula joint distribution function in viewing its capability in shedding light on the complex coherency between the inter dependent variables the copula joint distribution function could capture the inherent correlation between the two impact variables of water availability and vegetation dispersion ghosh et al 2020 huang et al 2021a table 1 summarizes the abbreviated terms associated with the proposed module 3 1 conceptual lumped ecohydrological model clem provides information for determining transition rules in the ca module which depicts the spatial distribution of the recovered oasis clem has a simplified structure which contains a hydrological module and an ecological module the hydrological and ecological processes are coupled by the dynamics of groundwater carrying capacity given the volume of ecological water diversion as the primary input the clem simulates groundwater depth oasis area and vegetation condition the fundamental three differential equations of clem are as follows 1 d h d t θ δ g a r 2 d a d t β a a gcc a 3 d v d t β v v gcc v where δ g w e 10 3 w g a r 10 3 e t a 10 3 e g a r a δ g denotes the change in groundwater storage in million m3 h is groundwater depth in m t indicates time every one year step w e is the volume of ecological water diversion in million m3 w g denotes local groundwater recharge in mm e t is evapotranspiration of the recovered oasis in mm e g is evaporation from groundwater of bare lands in mm a is oasis area in km2 a r is area in km2 of the region where groundwater is recharged by ecological water diversion the recovered oasis a is embedded in the recharged region a r v is vegetation condition measured by ndvi θ is the coefficient associated with groundwater recharge β a and β v is growth rate of oasis area and vegetation condition respectively unit 1 year and a gcc and v gcc is groundwater carrying capacity gcc of the oasis area and vegetation condition respectively specific introduction and parameters used in clem which has been calibrated using data between 2010 and 2015 and validated with 2016 2019 data can be found in the literature huang et al 2021b the present study used the calibrated and validated clem as the basis for the simulation of the spatial distribution of qingtu oasis with ca 3 2 copula incorporated cellular automata module 3 2 1 ecohydrological assumptions and proposed indices though precipitation is vital for vegetation water uptake it is so scarce at the lower shiyang river basin that it cannot provide adequate water for vegetation growth instead groundwater including the portion supplemented by deep percolation from surface water is the primary water source for vegetation growth therefore groundwater depth is a critical factor influencing landscape changes in qingtu oasis huang et al 2019 ecological water diverted from the hongyashan reservoir to qingtu oasis impounds on low elevated areas where surface water recharges soil moisture and groundwater seasonally the inundated and adjacent areas have relatively lower elevation and smaller groundwater depth resulting in potentially better water conditions for vegetation growth and oasis recovery based on this assumption of correlation between inundation and terrain a water availability index wai calculated using the inundation information is proposed to quantify the impact of groundwater depth on vegetation distribution a higher wai is assumed to indicate a more suitable habitat for vegetation while a smaller wai more probably corresponds to bare land besides water availability the expansion of the vegetation community is another essential factor affecting vegetation distribution a neighbor vegetation index nvi calculated using the vegetation information was developed to quantify the impact of community expansion bare land near vegetated restored areas was assumed more likely to recover than non vegetated areas presumptively a higher nvi implies a higher probability of vegetation recovery and vice versa water availability and community expansion jointly affect the spatial distribution of vegetation the pixels adjacent to the seasonally inundated and vegetated areas are assumed to have more significant potential to restore vegetation a composite index termed vegetation suitability index vsi was constructed to quantify the combined effect of wai and nvi 3 2 2 ca module structure the expansion behavior can be effectively simulated using ca models a ca is a cellular entity that independently varies its state based on its previous state and its immediate neighbors according to specific rules aassine and el jaı 2002 the ca is defined by a quadruplet 4 ca lattice state sets neighborhood transition rules lattice is a raster image deduced from remote sensing data the spatial domain of this study is displayed in fig 1c the lattice of qingtu oasis covered a total of 899 pixels with 31 rows and 29 columns each pixel i e a cellular of the lattice is characterized at a given time t by a state chosen from the state sets ε the state sets contain finite values ε 0 1 describing all the possible states that each cell can take the value 0 indicates the non vegetated state and the value 1 indicates the vegetated state the neighborhood is characterized by the neighboring cells which affect the state of the central pixel in the following neighborhood analysis the moore type neighborhood 3 3 is used to calculate wai nvi and vsi the transition rules determine the state of each cellular from time t to t 1 i e whether the pixel is going to recover or degrade 3 2 3 neighborhood analysis neighborhood analysis aims to quantify the impact of neighboring pixels on the change of the central pixel s state it contains the calculations of wai nvi and vsi providing the statistical foundation for simulating the oasis s spatial dynamics 1 water availability index the inundated pixels were detected using the ndwi and ndvi data from 2013 to 2020 throughout this period the pixels were identified as seasonally inundated ones provided they met the standard of ndwi 0 and ndvi 0 once the seasonally inundated pixels were assigned a value of 1 indicating a relatively lower elevation and better accessibility to groundwater the pixels that never met the standard were classified as non inundated pixels they were assigned a value of 0 indicating a low probability of being vegetated because wai essentially quantifies terrain s impact on vegetation distribution it is presumed to be static during the simulation for the pixel at i th row and j th column wai i j is calculated by summing the element wise product of the score and weight of inundation 5 wai i j sum ε i n i j w i 6 ε i n i j ε i i 1 j 1 ε i i 1 j ε i i 1 j 1 ε i i j 1 ε i i j ε i i j 1 ε i i 1 j 1 ε i i 1 j ε i i 1 j 1 7 w i 0 1 0 1 0 1 0 1 0 2 0 1 0 1 0 1 0 1 where ε i n i j and ε i i j is the inundation score of a neighborhood and a pixel respectively ε i i j 1 indicates inundation while ε i i j 0 indicates non inundation w i is the weight of inundation the central pixel has a higher weight than its neighbors because if the pixel is inundated it has a more significant impact on vegetation restoration the inundation weights of the adjacent pixels are assumed to be equal regardless of the directions 2 neighbor vegetation index unlike the static wai the nvi is updated with each step during the simulation because of the oasis s dynamic restoration processes given the year t for the pixel at i th row and j th column nvi t i j is calculated by summing the element wise product of the score and weight of vegetation 8 nvi t i j sum ε v n t i j w v 9 ε v n t i j ε v t i 1 j 1 ε v t i 1 j ε v t i 1 j 1 ε v t i j 1 ε v t i j ε v t i j 1 ε v t i 1 j 1 ε v t i 1 j ε v t i 1 j 1 10 w v 0 125 0 125 0 125 0 125 0 0 125 0 125 0 125 0 125 where ε v n t i j and ε v t i j is the vegetation score of a neighborhood and a pixel respectively ε v t i j 1 indicates vegetation while ε v t i j 0 indicates non vegetation w v is the weight of vegetation the central pixel has a zero weight because its neighbors status affects whether it is vegetated instead of its own status the vegetation weights of the adjacent pixels are presumed to be equal regardless of the directions 3 vegetation suitability index the vsi synthesizes wai and nvi using the clayton copula function one of the typical archimedean copula functions with simple constructions and stable properties sadegh et al 2017 the archimedean copula functions do not need to have the same marginal distribution and any marginal distribution connected by the copula function can produce a joint distribution wong et al 2010 given the year t for the pixel at i th row and j th column vsi t i j is defined in the clayton copula form 11 vsi t i j f e wai i j f e nvi t i j f e wai i j γ f e nvi t i j γ 1 1 γ where f e wai i j and f e nvi t i j is the empirical frequency of wai i j and nvi t i j respectively the methods for estimating empirical frequencies can refer to the published literature zhang et al 2011 the parameter of the clayton copula function can be estimated using the copulafit function in the software matlab version r2020b or using the multivariate copula analysis toolbox sadegh et al 2017 the performance of parameter estimation is evaluated using root mean square error rmse correlation coefficient r and nash sutcliffe efficiency coefficient nse which are commonly used performance evaluators huang et al 2021c sadegh et al 2017 the vegetation distribution image was compared with next year s image to detect the newly recovered pixels with ε v t 0 and ε v t 1 1 the wai and nvi were calculated for each newly recovered pixel producing the wai and nvi datasets for estimating their empirical frequencies and vsi s parameter considering that clem was calibrated using data from 2010 to 2015 the empirical frequencies of wai and nvi and the parameter of vsi were also estimated using 2010 2015 data huang et al 2021b 3 2 4 state transition rules state transition rules are a component that connects clem and the ca module clem provides the oasis information for designing the state transition rules clem outputs groundwater depth oasis area and oasis ndvi used to determine the changing area and whether the oasis tends to expand or reduce the difference between a t and a t 1 can result in three different case scenarios oasis expansion stability or degradation 1 oasis expansion in the case of a t 1 a t the oasis tends to be further restored the vegetated pixels at the year t are assumed to be no change and only a part of bare land pixels will change to the vegetated pixels the oasis will expand by the area of a t 1 a t which indicates the number of newly vegetated pixels n e the vsi t of all bare land pixels are calculated and sorted descendingly because a larger vsi implies a greater probability of vegetation recovery the first n e pixels will change their states from bare land to vegetation 2 stable oasis in the case of a t 1 a t the oasis area remains stable following the stability of the oasis area it is assumed no change in vegetation distribution occurs 3 oasis degradation in the case of a t 1 a t the oasis tends to degrade the oasis will shrink by the area of a t a t 1 which indicates the number of newly degraded pixels n d the vsi t of all vegetated pixels are calculated and sorted ascendingly because a smaller vsi indicates a relatively worse habitat for vegetation growth the first n d pixels will change their states from vegetation to bare land in a nutshell the clem informs the ca module how many pixels will change their states and the ca module specifies which pixels will change their state producing the vegetation distribution image the incorporation of the ca module into clem makes the ca clem which essentially is a conceptual lumped model but capable of modeling the vegetation s spatial distribution similar to a physically based distributed model 3 2 5 performance evaluation the vsi of qingtu oasis was parameterized using 2010 2015 data which was the same period for calibrating clem the performance of the ca module was evaluated using the data of 2016 2020 clem simulated the overall ecohydrological processes without considering spatial heterogeneity and the ca module added the vegetation distribution the consistency between the observed and simulated vegetation distribution images was quantified using the cohen s kappa coefficient cohen 1960 the kappa coefficient varies in 1 1 representing poor to perfect levels of the agreement between the observed and simulated images a value 0 8 can be considered an almost complete agreement alaibakhsh et al 2017 3 3 scenario analysis for oasis restoration the changes in ecological water diversion impacts on oasis restoration were assessed using the improved ca clem the hongyashan reservoir annually delivered approximately 30 million m3 of ecological water to qingtu oasis during 2010 2020 five scenarios were designed for 2021 to 2030 referring to the practical experience of the past decade a ecological water diversion was restrained to 10 million m3 due to severe water shortage b ecological water diversion was reduced to 20 million m3 due to moderate water shortage c ecological water diversion maintained the status quo of 30 million m3 d stronger efforts were made in oasis restoration by increasing the water diversion to 40 million m3 e much stronger efforts were made and ecological water diversion was further increased to 50 million m3 the ca clem modeled qingtu oasis s ecohydrological response to each water diversion scenario providing implications for the managers and policymakers 4 results and discussion 4 1 ecohydrological response to ecological water diversion the ecological water diversion project significantly promoted the hydrological recovery of qingtu oasis fig 2 a the inundated area fluctuated seasonally due to the water diversion strategy of the hongyashan reservoir fig 2b the surface water area increased when receiving water conveyance and decreased due to evaporation loss and deep percolation the small seasonal ponds recharged soil moisture and local groundwater compared with the depth to water table in 2010 the water table in 2020 rose by about 1 m which was attributed to the effects of ecological water diversion responding to the hydrological recovery of qingtu oasis the oasis area and ndvi increased simultaneously indicating a successful oasis restoration by ecological water diversion fig 3 a the oasis area increased gradually and reached relative stability at about 25 km2 resulting from the regular water diversion in recent years the vegetation distribution during the recovering processes was irregular fig 3b emphasizing the necessity to construct the ca module for spatial simulation besides the oasis expansion the oasis ndvi also increased and came to a relatively stable value of 0 36 in 2020 implying the gradually enhanced vegetation coverage 4 2 module construction and validation fig 4 a and b display the empirical probability of wai and nvi respectively which were computed using 2010 2015 data the clayton copula function was parameterized based on the empirical distributions of wai and nvi resulting in the joint distribution of wai and nvi the goodness of fit test suggested high values of r and nse and a low value of rmse the scatter points were distributed alongside the 1 1 line showing a satisfying match between theoretical and empirical joint probability fig 4c vsi was calculated by the clayton copula function considering the possible combination of wai and nvi fig 4d given the observed vegetation distribution image in 2015 and the oasis area obtained from the clem as inputs for the ca module the spatial vegetation distributions during 2016 2020 were simulated and compared with the observed images fig 5 the simulated images fitted well the measured ones the spatial domain was dominated by the pixels where the simulation matched with the observation the pixels with inconsistency between simulation and observation values were distributed sparsely the kappa coefficients were around 0 9 implying a good agreement between the simulated and observed images fig 5c overall the ca module combined with the clem performed well in modeling the spatial distribution of restored vegetation 4 3 application in scenario analysis the ca clem was applied to predict qingtu oasis dynamics under different ecological water diversion scenarios the actual water diversion data drove the clem modeling during 2010 2020 while the expected water diversion volume was the input for the simulation during 2021 2030 fig 6 the simulated groundwater depth oasis area and oasis ndvi matched well the observed data during 2010 2020 validating the clem s good performance in characterizing the oasis s ecohydrological evolution driven by ecological water diversion qingtu oasis depended on the water diversion from the hongyashan reservoir which satisfied the oasis s environmental water requirement the oasis would retreat in case of water shortage resulting in a lowered water table shrinking of the oasis area and smaller oasis ndvi less water conveyance would cause a severe environmental water deficit and worse oasis ecology fig 6a and b qingtu oasis would reach relative stability if ecological water diversion remained at the status quo of 30 million m3 fig 6c the stronger efforts in ecological restoration by increasing water diversion would not produce significant oasis expansion and ndvi increments fig 6d and e more ecological water inputs would help elevate the water table however the shallower groundwater would result in more evaporation losses and a water cost increase while generating limited ecological benefit huang et al 2021b qingtu oasis would reach different spatial distribution after a decade of evolution in different water diversion scenarios fig 7 when the water diversion volume was 10 20 30 40 and 50 million m3 during 2021 2030 the oasis area in 2030 was 8 24 17 87 25 10 28 39 and 29 59 km2 respectively the oasis distribution in the cases of increased water diversion was similar to the oasis distribution in keeping the current water diversion volume the oasis expansion induced by the water diversion increment was marginal conversely the oasis recession caused by the reduced water diversion in the water shortage scenarios was significant especially when the water volume was constrained to 10 million m3 the oasis area decreased by approximately 17 km2 when the water volume was reduced from 30 to 10 million m3 fig 8 illustrates the oasis recessing processes when the water volume was 10 million m3 the reduction in water diversion dropped water table levels and restrained water availability for vegetation growth impairing the groundwater carrying capacity huang et al 2020a huang et al 2021b as a result the vegetation degenerated due to deteriorating habitat suitability the oasis boundary retreated irregularly and the oasis fragmented because of vsi s spatial heterogeneity 4 4 advantages limitations and future research this study proposed using wai to characterize the impact of terrain on vegetation growth and distribution instead of using field observations of land surface elevation and groundwater depth surface elevation observations are usually affected by the height of vegetation which should be subtracted to get soil surface elevation hu et al 2021 getting the actual height of vegetation required a significant amount of field sampling that was time consuming and laborious spatially distributed groundwater data is usually scarce because developing and maintaining a monitoring network is time consuming and expensive wai uses seasonal inundation information which can be calculated using freely provided and widely used remote sensing data besides the availability of its source data wai has a solid theoretical presumption water impounds on the areas with low soil elevation close to the water table therefore wai was a good proxy for soil surface elevation and groundwater depth nvi uses vegetation information which can also be calculated using freely available and commonly applied remote sensing data vsi synthesized wai and nvi with the clayton copula function broadening how copula functions could be used vsi worked well in quantifying the habitat quality for oasis restoration suggested by the satisfying performance of the ca module the proposed ca module had a simple structure low computation cost and strong capability to model vegetation distribution the incorporation of the ca module into clem produced ca clem an effective tool for modeling the oasis dynamics driven by ecological water diversion generating groundwater depth oasis area oasis ndvi and vegetation distribution the ca clem tool can be available through reaching the correspondence email huangfeng1987 hhu edu cn the integration of the cellular automata with the conceptual lumped model might be a potential supplement for physically based distributed models the successful application of ca clem to simulate ecohydrological process dynamics in qingtu oasis opens the opportunity to explore its applicability in other artificially recovered oases worldwide fig 9 synthesizes ca clem into a general framework for ecohydrological process simulation and application in oasis restoration in arid endorheic basins some of the limitations of this study included image size and parameter uncertainty due to the size of the image the recovered vegetation reached the edge of the image especially when more water was diverted for oasis recovery because of the short period of data observation ca clem was calibrated using 2010 2015 data resulting in model uncertainty and errors given that oasis restoration is a long term task continuous ecological water diversion and data collection in the years to come provide an opportunity for constant re evaluation and refining of the model model re calibration and re validation will help improve the model accuracy and reduce the uncertainty of parameter estimation besides the observational data and model parameters the model uncertainty also comes from the model structure associated with the ecohydrological mechanisms and assumptions engeland et al 2005 liu and gupta 2007 when calculating nvi only the effect of community expansion was considered and the impact of community competition had not been incorporated yet a systematic in situ sampling and monitoring is necessary to improve understanding of the ecohydrological mechanisms behind vegetation distribution and release the presumptions of the ca module further research into the ecohydrological mechanisms behind the spatial features of oasis recovery processes might be helpful to revise the ca s structure and enhance its capability in capturing the spatial dynamics of vegetation expansion and retreat 5 conclusions the case study in the shiyang river basin in northwest china suggested that ecological water diversion was a practical project to restore the groundwater dependent oasis the hongyashan reservoir at the middle reaches supplied about 30 million m3 water annually to the lower reaches and successfully produced a new qingtu oasis in 2020 the annual mean water table at qingtu oasis was elevated by about 1 m with a mean groundwater depth of 2 95 m the hydrological recovery promoted ecological recovery characterized by the expanded oasis area and the enhanced vegetation coverage qingtu oasis area increased gradually responding to water table elevation and reached about 25 km2 in 2020 the oasis ndvi increased to 0 36 the oasis distribution and its dynamic evolution processes were irregular resulting from the spatial heterogeneity of vegetation habitat suitability a copula incorporated ca module was proposed for modeling the oasis s dynamic evolution processes driven by ecological water diversion the grid based wai nvi and vsi were spatially heterogeneous and provided a solid basis for the ca module the clayton copula function showed good performance in connecting wai and nvi to calculate vsi incorporating the ca module into clem made the improved ca clem which outputted groundwater depth oasis area oasis ndvi and oasis distribution information the clem and the ca module cooperated effectively the clem informed the ca module how many oasis areas would recover or degrade and the ca module depicted the distribution of the changed areas the structure of the ca clem was clear and straightforward and the calculation was of low cost combining the cellular automata with the conceptual lumped model can model vegetation s spatial distribution like a physically based distributed model the application of the ca clem in qingtu oasis indicated its simplicity and practicality the ca clem successfully captured the oasis s ecohydrological dynamics including water table depth oasis area and ndvi and vegetation distribution the kappa coefficient results suggested a satisfying agreement between the simulated and observed vegetation distribution images validating the ca module s powerful function in spatial depiction the scenario analysis using the ca clem shed light on qingtu oasis s dependence on ecological water diversion the oasis s ecohydrological dynamics were sensitive to the reduced water diversion scenario in case of water shortage which would lead to a water table decline oasis area shrinkage vegetation degradation and oasis fragmentation the good performance implied that the ca clem would be a practical and reliable tool for managers and policymakers to assess the impact of ecological water diversion on oasis restoration and assess water diversion strategies credit authorship contribution statement feng huang conceptualization data curation formal analysis funding acquisition investigation methodology software validation visualization writing original draft carlos g ochoa methodology resources software supervision validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by the fundamental research funds for the central universities grant number b200202023 
3452,assessing the impact of ecological water diversion on oasis restoration is critical for water resources and environmental management in arid inland basins this study proposed a copula incorporated cellular automata ca module for modeling the oasis s spatial distribution driven by ecological water diversion given the effects of groundwater depth and community expansion on oasis evolution a water availability index and a neighbor vegetation index were proposed these two indices were joint using the clayton copula function producing a vegetation suitability index that quantified vegetation growth s habitat quality and provided the ca module s basis to identify cellular categories the ca module was integrated into a previously developed conceptual lumped ecohydrological model clem resulting in an improved ca clem that outputted groundwater depth oasis area oasis ndvi and oasis distribution data the clem provided the oasis area changes for the ca module which specified the spatial distribution of these changes the ca clem had a simple structure low computation cost and good performance indicated by the application in the shiyang river basin in northwest china results show that an ecological water diversion of 30 million m3 with an average groundwater depth of 2 95 m an oasis area of 25 km2 and an oasis ndvi of 0 36 would successfully recover the terminal qingtu oasis in 2020 the oasis distribution and its dynamic evolution processes were irregular because of the spatial heterogeneity of vegetation habitat suitability the present qingtu oasis was fragile and its sustainability relied on ecological water diversion the reduction in water diversion would cause water table decline oasis area shrinkage vegetation degradation and oasis fragmentation the ca clem combined with scenario analysis provides practical and reliable implications for managers and policymakers to improve ecological water diversion strategies keywords cellular automata copula function spatial dynamics ecohydrological simulation ecological water diversion oasis restoration 1 introduction in the lower reaches of arid inland basins typically characterized by desert areas with scarce precipitation and significant evaporation rates natural oasis ecosystems highly depend on groundwater including the portions of groundwater transformed from surface water eamus and froend 2006 significant declines in water tables caused by groundwater over exploitation to satisfy the needs of a growing population have dramatically triggered many environmental problems including vegetation degradation land desertification terminal lake shrinkage and wetland loss resulting in the deterioration of groundwater dependent ecosystems zhu et al 2016 restoring degraded groundwater dependent ecosystems and satisfying their environmental water requirements are critical for sustainable watershed management huang et al 2021a ecological water diversion is a practical and effective method for restoring riparian and terminal oases in arid inland basins huang et al 2020a ecological water diversion projects have successfully recovered and protected the groundwater dependent oases in the heihe river tarim river and shiyang river basins in northwest china du et al 2020 hao and li 2014 huang et al 2020b monitoring and simulating the oasis s ecohydrological responses to ecological water diversion provide the basis for assessing the project s impact and improving the water diversion strategies sustainable watershed management has motivated special efforts in modeling the interactions between hydrological and ecological processes driven by ecological water diversion for example an ecohydrological evolution model synthesized the boussinesq equation and the vegetation colonization and mortality functions liu et al 2012 also a fully distributed ecohydrological model incorporated a vegetation dynamics module into the modified modflow han et al 2015 these models were physically based and spatially distributed resulting in complex model structures and complicated calculations a conceptual lumped ecohydrological model clem was proposed to address this issue by focusing on the overall interactions between hydrological and ecological processes huang et al 2021b the clem integrated the processes of groundwater recharge oasis area change vegetation growth and evapotranspiration it performed well in long term prediction for different scenarios of ecological water diversion huang et al 2021b however both the physically based and lumped ecohydrological models fall short in adequately modeling spatial dynamics during the restoration of the oasis although the physically based models characterized the oasis s spatial distribution they did not facilitate the long term simulation of overall oasis restoration in different water diversion scenarios due to their intrinsic complicated structures the conceptual lumped models simulated the oasis area but ignored the spatial distribution a simplified and more practical model is necessary to simulate the spatial distribution of the oasis recovered by ecological water diversion to improve water use efficiency for ecological restoration and protection of oases it is essential to comprehensively quantify the impacts of ecological water diversion on the recovery of the system given that clem is a practical tool used in ecohydrological process simulation huang et al 2021b this study aimed to further improve clem by integrating a cellular automata ca module to expand modeling capabilities into the spatial domain the spatial complexity of ecosystems can be investigated through ca models consisting of many identical components each simple but capable of complex behavior wolfram 1984 the ca models have been successfully applied to simulate spatial vegetation evolution desert oasis ecotone changes and watershed land use and cover changes aassine and el jaı 2002 sun et al 2021 xue et al 2019 the novelty and improvement of this study were embodied in proposing the copula based vegetation suitability index to develop the ca module and incorporating it into the clem resulting in the improved ca clem the proposed ca clem was applied in the qingtu oasis which is the terminal oasis of the shiyang river basin in the arid region of northwest china the shiyang river basin is a typical arid inland river basin its terminal qingtu lake had been dry for several decades due to water resources overexploitation for irrigation industry and domestic requirements an ecological water diversion project has been implemented since 2010 to address the environmental degradation and restore the dried up qingtu lake to the present qingtu oasis for local interests this application s results provide vital information for managers and policymakers to rationally regulate ecological water diversion and improve water allocation strategies in the shiyang river basin for worldwide interests the module proposed by this study provides an effective tool for environmental impact assessment of the ecological water diversion project which is a vital component of watershed management and environmental preservation policy initiatives 2 case study site and data 2 1 study area the shiyang river system originates in the qilian mountain and ends at qingtu oasis fig 1 detailed introduction of the geography meteorology hydrology and ecology of the shiyang river basin can be found in the literature gu et al 2016 hu et al 2021 huang et al 2021b qiao et al 2020 once there was a natural terminal lake named qingtu lake which had shrunk drastically due to water resources exploitation for agricultural development since the han dynasty 110 bce rapid population growth accompanied by socioeconomic development exacerbated the lake shrinkage to 120 km2 in the early 20th century and to 40 km2 by the 1940s because of the impoundment of the hongyashan reservoir that almost cut off all the inflow to the lake qingtu lake completely dried up in 1959 resulting in the degradation of the surrounding natural oasis and the desertification of the lower shiyang river basin in recent times a general restoration plan was implemented to mitigate the negative impacts of the dried up lake on the stability and sustainability of the shiyang river basin since september 2010 the hongyashan reservoir has supplied ecological water annually through a network of artificial channels that feed the original qingtu lake by the end of 2019 the total volume of water diversion had reached 281 million m3 instead of recovering the natural qingtu lake the objective was to preserve shallow groundwater for building a new oasis termed qingtu oasis the ecological water diversion project has successfully elevated the local water table increased vegetation coverage and expanded the oasis area huang et al 2020b the groundwater depth increases in a gradient from the central oasis to the desert edge correspondingly the vegetation community changes from hygrophytes to xerophytes chunyu et al 2019 local vegetation includes phragmitesaustralis suaedaglauca haloxylonammodendron kalidiumfoliatum and nitrariatangutorum along which phragmitesaustralis a typical hygrophyte and nitrariatangutorum a typical xerophyte the case study of qingtu oasis serves as a good prototype experiment on modeling the spatial distribution of the oasis recovered by ecological water diversion 2 2 hydrological and remote sensing data annual water diversion data from 2010 to 2019 were used for simulating the hydrological and ecological dynamics of qingtu oasis the hongyashan reservoir usually supplied the ecological water in the next half year when less water was necessary for irrigation in viewing that groundwater was mainly recharged by the water diversion of last year the water diversion of a year was used for modeling the ecohydrological processes of the next year for example the water diversion in 2019 was used in the water balance analysis of 2020 groundwater level data were provided by the hydrology bureau of gansu province which manages a hydrometric station located at the northeast edge of qingtu oasis fig 1c annual mean groundwater depth data spanned from 2010 to 2020 providing the basis for assessing the impact of ecological water diversion on groundwater recovery and the corresponding vegetation restoration the ecological water diversion formed seasonally inundated areas where the surface water contributed to local groundwater recharge through deep percolation remote sensing images were analyzed to characterize the temporal and spatial dynamics of the inundated areas the inundated areas were detected using a standard that combined the normalized difference water index ndwi and the normalized difference vegetation index ndvi huang et al 2021d ji et al 2009 pettorelli et al 2005 the ndvi and ndwi values were estimated based on methods commonly found in the literature mcfeeters 1996 rouse et al 1974 the pixels with ndwi 0 and ndvi 0 were identified as the inundated areas because of the stronger water signal than the vegetation signal landsat 8 products of landsat lc08 c01 t1 sr were used to calculate ndwi and ndvi which spanned from 2013 to 2020 the analysis was implemented on the google earth engine platform https code earthengine google com long term ndvi data spanning before and after ecological water diversion were critical for assessing the oasis restoration hu et al 2021 the ndvi products of moderate resolution imaging spectroradiometer modis have been widely used in land cover change analysis of arid inland river basins liu et al 2012 modis terra mod13q1 products https ladsweb modaps eosdis nasa gov provided the ndvi data spanning from 2000 to 2020 among which the pre impact period of 2000 2009 provided a criterion for detecting the ndvi changes during 2010 2020 yearly maximum ndvi data served as vegetation surrogates representing the recovered oasis areas visual inspection was practical and exercisable to identify the restored areas and when a pixel started to recover producing each year s vegetation distribution images of 2010 2020 huang et al 2021b 3 methods because of the ca models simple structure and practicality this study developed a ca module to characterize the oasis s spatial distribution the proposed ca module was synthesized into the clem to yield an improved ca clem model enhancing the original clem s capability to simulate the oasis s spatial distribution driven by ecological water diversion when constructing the ca module a key element was to formulate the transition rules of the lattice this study proposed a vegetation suitability index vsi to determine whether the lattice would recover to vegetation or degrade to bare land the vsi combined the impact of water availability and vegetation dispersion using the copula joint distribution function in viewing its capability in shedding light on the complex coherency between the inter dependent variables the copula joint distribution function could capture the inherent correlation between the two impact variables of water availability and vegetation dispersion ghosh et al 2020 huang et al 2021a table 1 summarizes the abbreviated terms associated with the proposed module 3 1 conceptual lumped ecohydrological model clem provides information for determining transition rules in the ca module which depicts the spatial distribution of the recovered oasis clem has a simplified structure which contains a hydrological module and an ecological module the hydrological and ecological processes are coupled by the dynamics of groundwater carrying capacity given the volume of ecological water diversion as the primary input the clem simulates groundwater depth oasis area and vegetation condition the fundamental three differential equations of clem are as follows 1 d h d t θ δ g a r 2 d a d t β a a gcc a 3 d v d t β v v gcc v where δ g w e 10 3 w g a r 10 3 e t a 10 3 e g a r a δ g denotes the change in groundwater storage in million m3 h is groundwater depth in m t indicates time every one year step w e is the volume of ecological water diversion in million m3 w g denotes local groundwater recharge in mm e t is evapotranspiration of the recovered oasis in mm e g is evaporation from groundwater of bare lands in mm a is oasis area in km2 a r is area in km2 of the region where groundwater is recharged by ecological water diversion the recovered oasis a is embedded in the recharged region a r v is vegetation condition measured by ndvi θ is the coefficient associated with groundwater recharge β a and β v is growth rate of oasis area and vegetation condition respectively unit 1 year and a gcc and v gcc is groundwater carrying capacity gcc of the oasis area and vegetation condition respectively specific introduction and parameters used in clem which has been calibrated using data between 2010 and 2015 and validated with 2016 2019 data can be found in the literature huang et al 2021b the present study used the calibrated and validated clem as the basis for the simulation of the spatial distribution of qingtu oasis with ca 3 2 copula incorporated cellular automata module 3 2 1 ecohydrological assumptions and proposed indices though precipitation is vital for vegetation water uptake it is so scarce at the lower shiyang river basin that it cannot provide adequate water for vegetation growth instead groundwater including the portion supplemented by deep percolation from surface water is the primary water source for vegetation growth therefore groundwater depth is a critical factor influencing landscape changes in qingtu oasis huang et al 2019 ecological water diverted from the hongyashan reservoir to qingtu oasis impounds on low elevated areas where surface water recharges soil moisture and groundwater seasonally the inundated and adjacent areas have relatively lower elevation and smaller groundwater depth resulting in potentially better water conditions for vegetation growth and oasis recovery based on this assumption of correlation between inundation and terrain a water availability index wai calculated using the inundation information is proposed to quantify the impact of groundwater depth on vegetation distribution a higher wai is assumed to indicate a more suitable habitat for vegetation while a smaller wai more probably corresponds to bare land besides water availability the expansion of the vegetation community is another essential factor affecting vegetation distribution a neighbor vegetation index nvi calculated using the vegetation information was developed to quantify the impact of community expansion bare land near vegetated restored areas was assumed more likely to recover than non vegetated areas presumptively a higher nvi implies a higher probability of vegetation recovery and vice versa water availability and community expansion jointly affect the spatial distribution of vegetation the pixels adjacent to the seasonally inundated and vegetated areas are assumed to have more significant potential to restore vegetation a composite index termed vegetation suitability index vsi was constructed to quantify the combined effect of wai and nvi 3 2 2 ca module structure the expansion behavior can be effectively simulated using ca models a ca is a cellular entity that independently varies its state based on its previous state and its immediate neighbors according to specific rules aassine and el jaı 2002 the ca is defined by a quadruplet 4 ca lattice state sets neighborhood transition rules lattice is a raster image deduced from remote sensing data the spatial domain of this study is displayed in fig 1c the lattice of qingtu oasis covered a total of 899 pixels with 31 rows and 29 columns each pixel i e a cellular of the lattice is characterized at a given time t by a state chosen from the state sets ε the state sets contain finite values ε 0 1 describing all the possible states that each cell can take the value 0 indicates the non vegetated state and the value 1 indicates the vegetated state the neighborhood is characterized by the neighboring cells which affect the state of the central pixel in the following neighborhood analysis the moore type neighborhood 3 3 is used to calculate wai nvi and vsi the transition rules determine the state of each cellular from time t to t 1 i e whether the pixel is going to recover or degrade 3 2 3 neighborhood analysis neighborhood analysis aims to quantify the impact of neighboring pixels on the change of the central pixel s state it contains the calculations of wai nvi and vsi providing the statistical foundation for simulating the oasis s spatial dynamics 1 water availability index the inundated pixels were detected using the ndwi and ndvi data from 2013 to 2020 throughout this period the pixels were identified as seasonally inundated ones provided they met the standard of ndwi 0 and ndvi 0 once the seasonally inundated pixels were assigned a value of 1 indicating a relatively lower elevation and better accessibility to groundwater the pixels that never met the standard were classified as non inundated pixels they were assigned a value of 0 indicating a low probability of being vegetated because wai essentially quantifies terrain s impact on vegetation distribution it is presumed to be static during the simulation for the pixel at i th row and j th column wai i j is calculated by summing the element wise product of the score and weight of inundation 5 wai i j sum ε i n i j w i 6 ε i n i j ε i i 1 j 1 ε i i 1 j ε i i 1 j 1 ε i i j 1 ε i i j ε i i j 1 ε i i 1 j 1 ε i i 1 j ε i i 1 j 1 7 w i 0 1 0 1 0 1 0 1 0 2 0 1 0 1 0 1 0 1 where ε i n i j and ε i i j is the inundation score of a neighborhood and a pixel respectively ε i i j 1 indicates inundation while ε i i j 0 indicates non inundation w i is the weight of inundation the central pixel has a higher weight than its neighbors because if the pixel is inundated it has a more significant impact on vegetation restoration the inundation weights of the adjacent pixels are assumed to be equal regardless of the directions 2 neighbor vegetation index unlike the static wai the nvi is updated with each step during the simulation because of the oasis s dynamic restoration processes given the year t for the pixel at i th row and j th column nvi t i j is calculated by summing the element wise product of the score and weight of vegetation 8 nvi t i j sum ε v n t i j w v 9 ε v n t i j ε v t i 1 j 1 ε v t i 1 j ε v t i 1 j 1 ε v t i j 1 ε v t i j ε v t i j 1 ε v t i 1 j 1 ε v t i 1 j ε v t i 1 j 1 10 w v 0 125 0 125 0 125 0 125 0 0 125 0 125 0 125 0 125 where ε v n t i j and ε v t i j is the vegetation score of a neighborhood and a pixel respectively ε v t i j 1 indicates vegetation while ε v t i j 0 indicates non vegetation w v is the weight of vegetation the central pixel has a zero weight because its neighbors status affects whether it is vegetated instead of its own status the vegetation weights of the adjacent pixels are presumed to be equal regardless of the directions 3 vegetation suitability index the vsi synthesizes wai and nvi using the clayton copula function one of the typical archimedean copula functions with simple constructions and stable properties sadegh et al 2017 the archimedean copula functions do not need to have the same marginal distribution and any marginal distribution connected by the copula function can produce a joint distribution wong et al 2010 given the year t for the pixel at i th row and j th column vsi t i j is defined in the clayton copula form 11 vsi t i j f e wai i j f e nvi t i j f e wai i j γ f e nvi t i j γ 1 1 γ where f e wai i j and f e nvi t i j is the empirical frequency of wai i j and nvi t i j respectively the methods for estimating empirical frequencies can refer to the published literature zhang et al 2011 the parameter of the clayton copula function can be estimated using the copulafit function in the software matlab version r2020b or using the multivariate copula analysis toolbox sadegh et al 2017 the performance of parameter estimation is evaluated using root mean square error rmse correlation coefficient r and nash sutcliffe efficiency coefficient nse which are commonly used performance evaluators huang et al 2021c sadegh et al 2017 the vegetation distribution image was compared with next year s image to detect the newly recovered pixels with ε v t 0 and ε v t 1 1 the wai and nvi were calculated for each newly recovered pixel producing the wai and nvi datasets for estimating their empirical frequencies and vsi s parameter considering that clem was calibrated using data from 2010 to 2015 the empirical frequencies of wai and nvi and the parameter of vsi were also estimated using 2010 2015 data huang et al 2021b 3 2 4 state transition rules state transition rules are a component that connects clem and the ca module clem provides the oasis information for designing the state transition rules clem outputs groundwater depth oasis area and oasis ndvi used to determine the changing area and whether the oasis tends to expand or reduce the difference between a t and a t 1 can result in three different case scenarios oasis expansion stability or degradation 1 oasis expansion in the case of a t 1 a t the oasis tends to be further restored the vegetated pixels at the year t are assumed to be no change and only a part of bare land pixels will change to the vegetated pixels the oasis will expand by the area of a t 1 a t which indicates the number of newly vegetated pixels n e the vsi t of all bare land pixels are calculated and sorted descendingly because a larger vsi implies a greater probability of vegetation recovery the first n e pixels will change their states from bare land to vegetation 2 stable oasis in the case of a t 1 a t the oasis area remains stable following the stability of the oasis area it is assumed no change in vegetation distribution occurs 3 oasis degradation in the case of a t 1 a t the oasis tends to degrade the oasis will shrink by the area of a t a t 1 which indicates the number of newly degraded pixels n d the vsi t of all vegetated pixels are calculated and sorted ascendingly because a smaller vsi indicates a relatively worse habitat for vegetation growth the first n d pixels will change their states from vegetation to bare land in a nutshell the clem informs the ca module how many pixels will change their states and the ca module specifies which pixels will change their state producing the vegetation distribution image the incorporation of the ca module into clem makes the ca clem which essentially is a conceptual lumped model but capable of modeling the vegetation s spatial distribution similar to a physically based distributed model 3 2 5 performance evaluation the vsi of qingtu oasis was parameterized using 2010 2015 data which was the same period for calibrating clem the performance of the ca module was evaluated using the data of 2016 2020 clem simulated the overall ecohydrological processes without considering spatial heterogeneity and the ca module added the vegetation distribution the consistency between the observed and simulated vegetation distribution images was quantified using the cohen s kappa coefficient cohen 1960 the kappa coefficient varies in 1 1 representing poor to perfect levels of the agreement between the observed and simulated images a value 0 8 can be considered an almost complete agreement alaibakhsh et al 2017 3 3 scenario analysis for oasis restoration the changes in ecological water diversion impacts on oasis restoration were assessed using the improved ca clem the hongyashan reservoir annually delivered approximately 30 million m3 of ecological water to qingtu oasis during 2010 2020 five scenarios were designed for 2021 to 2030 referring to the practical experience of the past decade a ecological water diversion was restrained to 10 million m3 due to severe water shortage b ecological water diversion was reduced to 20 million m3 due to moderate water shortage c ecological water diversion maintained the status quo of 30 million m3 d stronger efforts were made in oasis restoration by increasing the water diversion to 40 million m3 e much stronger efforts were made and ecological water diversion was further increased to 50 million m3 the ca clem modeled qingtu oasis s ecohydrological response to each water diversion scenario providing implications for the managers and policymakers 4 results and discussion 4 1 ecohydrological response to ecological water diversion the ecological water diversion project significantly promoted the hydrological recovery of qingtu oasis fig 2 a the inundated area fluctuated seasonally due to the water diversion strategy of the hongyashan reservoir fig 2b the surface water area increased when receiving water conveyance and decreased due to evaporation loss and deep percolation the small seasonal ponds recharged soil moisture and local groundwater compared with the depth to water table in 2010 the water table in 2020 rose by about 1 m which was attributed to the effects of ecological water diversion responding to the hydrological recovery of qingtu oasis the oasis area and ndvi increased simultaneously indicating a successful oasis restoration by ecological water diversion fig 3 a the oasis area increased gradually and reached relative stability at about 25 km2 resulting from the regular water diversion in recent years the vegetation distribution during the recovering processes was irregular fig 3b emphasizing the necessity to construct the ca module for spatial simulation besides the oasis expansion the oasis ndvi also increased and came to a relatively stable value of 0 36 in 2020 implying the gradually enhanced vegetation coverage 4 2 module construction and validation fig 4 a and b display the empirical probability of wai and nvi respectively which were computed using 2010 2015 data the clayton copula function was parameterized based on the empirical distributions of wai and nvi resulting in the joint distribution of wai and nvi the goodness of fit test suggested high values of r and nse and a low value of rmse the scatter points were distributed alongside the 1 1 line showing a satisfying match between theoretical and empirical joint probability fig 4c vsi was calculated by the clayton copula function considering the possible combination of wai and nvi fig 4d given the observed vegetation distribution image in 2015 and the oasis area obtained from the clem as inputs for the ca module the spatial vegetation distributions during 2016 2020 were simulated and compared with the observed images fig 5 the simulated images fitted well the measured ones the spatial domain was dominated by the pixels where the simulation matched with the observation the pixels with inconsistency between simulation and observation values were distributed sparsely the kappa coefficients were around 0 9 implying a good agreement between the simulated and observed images fig 5c overall the ca module combined with the clem performed well in modeling the spatial distribution of restored vegetation 4 3 application in scenario analysis the ca clem was applied to predict qingtu oasis dynamics under different ecological water diversion scenarios the actual water diversion data drove the clem modeling during 2010 2020 while the expected water diversion volume was the input for the simulation during 2021 2030 fig 6 the simulated groundwater depth oasis area and oasis ndvi matched well the observed data during 2010 2020 validating the clem s good performance in characterizing the oasis s ecohydrological evolution driven by ecological water diversion qingtu oasis depended on the water diversion from the hongyashan reservoir which satisfied the oasis s environmental water requirement the oasis would retreat in case of water shortage resulting in a lowered water table shrinking of the oasis area and smaller oasis ndvi less water conveyance would cause a severe environmental water deficit and worse oasis ecology fig 6a and b qingtu oasis would reach relative stability if ecological water diversion remained at the status quo of 30 million m3 fig 6c the stronger efforts in ecological restoration by increasing water diversion would not produce significant oasis expansion and ndvi increments fig 6d and e more ecological water inputs would help elevate the water table however the shallower groundwater would result in more evaporation losses and a water cost increase while generating limited ecological benefit huang et al 2021b qingtu oasis would reach different spatial distribution after a decade of evolution in different water diversion scenarios fig 7 when the water diversion volume was 10 20 30 40 and 50 million m3 during 2021 2030 the oasis area in 2030 was 8 24 17 87 25 10 28 39 and 29 59 km2 respectively the oasis distribution in the cases of increased water diversion was similar to the oasis distribution in keeping the current water diversion volume the oasis expansion induced by the water diversion increment was marginal conversely the oasis recession caused by the reduced water diversion in the water shortage scenarios was significant especially when the water volume was constrained to 10 million m3 the oasis area decreased by approximately 17 km2 when the water volume was reduced from 30 to 10 million m3 fig 8 illustrates the oasis recessing processes when the water volume was 10 million m3 the reduction in water diversion dropped water table levels and restrained water availability for vegetation growth impairing the groundwater carrying capacity huang et al 2020a huang et al 2021b as a result the vegetation degenerated due to deteriorating habitat suitability the oasis boundary retreated irregularly and the oasis fragmented because of vsi s spatial heterogeneity 4 4 advantages limitations and future research this study proposed using wai to characterize the impact of terrain on vegetation growth and distribution instead of using field observations of land surface elevation and groundwater depth surface elevation observations are usually affected by the height of vegetation which should be subtracted to get soil surface elevation hu et al 2021 getting the actual height of vegetation required a significant amount of field sampling that was time consuming and laborious spatially distributed groundwater data is usually scarce because developing and maintaining a monitoring network is time consuming and expensive wai uses seasonal inundation information which can be calculated using freely provided and widely used remote sensing data besides the availability of its source data wai has a solid theoretical presumption water impounds on the areas with low soil elevation close to the water table therefore wai was a good proxy for soil surface elevation and groundwater depth nvi uses vegetation information which can also be calculated using freely available and commonly applied remote sensing data vsi synthesized wai and nvi with the clayton copula function broadening how copula functions could be used vsi worked well in quantifying the habitat quality for oasis restoration suggested by the satisfying performance of the ca module the proposed ca module had a simple structure low computation cost and strong capability to model vegetation distribution the incorporation of the ca module into clem produced ca clem an effective tool for modeling the oasis dynamics driven by ecological water diversion generating groundwater depth oasis area oasis ndvi and vegetation distribution the ca clem tool can be available through reaching the correspondence email huangfeng1987 hhu edu cn the integration of the cellular automata with the conceptual lumped model might be a potential supplement for physically based distributed models the successful application of ca clem to simulate ecohydrological process dynamics in qingtu oasis opens the opportunity to explore its applicability in other artificially recovered oases worldwide fig 9 synthesizes ca clem into a general framework for ecohydrological process simulation and application in oasis restoration in arid endorheic basins some of the limitations of this study included image size and parameter uncertainty due to the size of the image the recovered vegetation reached the edge of the image especially when more water was diverted for oasis recovery because of the short period of data observation ca clem was calibrated using 2010 2015 data resulting in model uncertainty and errors given that oasis restoration is a long term task continuous ecological water diversion and data collection in the years to come provide an opportunity for constant re evaluation and refining of the model model re calibration and re validation will help improve the model accuracy and reduce the uncertainty of parameter estimation besides the observational data and model parameters the model uncertainty also comes from the model structure associated with the ecohydrological mechanisms and assumptions engeland et al 2005 liu and gupta 2007 when calculating nvi only the effect of community expansion was considered and the impact of community competition had not been incorporated yet a systematic in situ sampling and monitoring is necessary to improve understanding of the ecohydrological mechanisms behind vegetation distribution and release the presumptions of the ca module further research into the ecohydrological mechanisms behind the spatial features of oasis recovery processes might be helpful to revise the ca s structure and enhance its capability in capturing the spatial dynamics of vegetation expansion and retreat 5 conclusions the case study in the shiyang river basin in northwest china suggested that ecological water diversion was a practical project to restore the groundwater dependent oasis the hongyashan reservoir at the middle reaches supplied about 30 million m3 water annually to the lower reaches and successfully produced a new qingtu oasis in 2020 the annual mean water table at qingtu oasis was elevated by about 1 m with a mean groundwater depth of 2 95 m the hydrological recovery promoted ecological recovery characterized by the expanded oasis area and the enhanced vegetation coverage qingtu oasis area increased gradually responding to water table elevation and reached about 25 km2 in 2020 the oasis ndvi increased to 0 36 the oasis distribution and its dynamic evolution processes were irregular resulting from the spatial heterogeneity of vegetation habitat suitability a copula incorporated ca module was proposed for modeling the oasis s dynamic evolution processes driven by ecological water diversion the grid based wai nvi and vsi were spatially heterogeneous and provided a solid basis for the ca module the clayton copula function showed good performance in connecting wai and nvi to calculate vsi incorporating the ca module into clem made the improved ca clem which outputted groundwater depth oasis area oasis ndvi and oasis distribution information the clem and the ca module cooperated effectively the clem informed the ca module how many oasis areas would recover or degrade and the ca module depicted the distribution of the changed areas the structure of the ca clem was clear and straightforward and the calculation was of low cost combining the cellular automata with the conceptual lumped model can model vegetation s spatial distribution like a physically based distributed model the application of the ca clem in qingtu oasis indicated its simplicity and practicality the ca clem successfully captured the oasis s ecohydrological dynamics including water table depth oasis area and ndvi and vegetation distribution the kappa coefficient results suggested a satisfying agreement between the simulated and observed vegetation distribution images validating the ca module s powerful function in spatial depiction the scenario analysis using the ca clem shed light on qingtu oasis s dependence on ecological water diversion the oasis s ecohydrological dynamics were sensitive to the reduced water diversion scenario in case of water shortage which would lead to a water table decline oasis area shrinkage vegetation degradation and oasis fragmentation the good performance implied that the ca clem would be a practical and reliable tool for managers and policymakers to assess the impact of ecological water diversion on oasis restoration and assess water diversion strategies credit authorship contribution statement feng huang conceptualization data curation formal analysis funding acquisition investigation methodology software validation visualization writing original draft carlos g ochoa methodology resources software supervision validation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was funded by the fundamental research funds for the central universities grant number b200202023 
3453,coupled water and heat transfer models are widely used to analyze soil water content and temperature dynamics evaluate agricultural management systems and support crop growth modelling in relatively dry soils vapor transfer rather than liquid water flux becomes the main pathway for water redistribution however in some modularized soil simulators e g 2dsoil timlin et al 1996 vapor transfer is not included which may induce errors in soil water and heat modelling directly embedding vapor transfer into existing water and heat transfer modules may violate the modularized architecture of those simulators therefore the objectives of this study are to design a vapor transfer model evaluate its performance and implement it as a separate module in a coupled soil water and heat simulator e g 2dsoil the efficacy of the vapor transfer model is evaluated by comparing the simulated soil water content and temperature before and after including the new vapor transfer model and the soil water content and temperature simulated with the standard philip and de vries 1957 model by implementing vapor transfer as a separate module in 2dsoil modifications to existing water and heat transfer modules can be minimized and the modularized model architecture can be maintained numerical examples of 2dsoil with the new vapor transfer model are presented to illustrate the effects of vapor flux on soil water and temperature redistributions in conclusion the new vapor transfer model provides an effective and easy to use method to account for the effects of vapor transfer on coupled soil water and heat simulations keywords vapor transfer water and heat transfer modularization numerical simulations 2dsoil 1 introduction numerical simulation is an important approach to elucidate water and heat transfer in soil and it supports a wide range of applications in agriculture and civil engineering for model establishment a variety of soil simulators e g the early versions of hydrus such as hydrus 1d or chain 2d simunek and van genuchten 1994 simunek et al 2012 combined the richards equation richards 1931 and a conduction convection heat equation as the governing model to represent the water and heat transfer in soil see eq 1 such a model formulation does not include temperature gradient as a factor in liquid water flux see eq 1a after solving the richards equation i e eq 1a the liquid water flux can be considered as a known quantity when computing the conductive and convective heat transfer see eq 1b where liquid water flux carries sensible heat flux thus given a discretized time step the two equations for soil water transfer and soil heat transfer eq 1a and 1b respectively can be solved one by one using relatively simple and efficient numerical implementations based on that model formulation eq 1 soil water and heat transfer can be programed into two separate modules which can also support a relatively complex but flexible model architecture for example in 2dsoil timlin et al 1996 a modularized simulator of soil physical and chemical processes in 2d soil profiles one horizontal scale and one vertical scale both the water transfer module and the heat transfer module can establish their own connections i e dataflow pathways to soil surface water and heat balance models crop growth models and soil root interaction models additional modules can be linked to the water and heat transfer modules in 2dsoil with minimal or no modifications to the existing modules timlin et al 1996 kim et al 2012 wang et al 2021a wang et al 2021b however vapor transfer which contributes to both water and heat dynamics in soil is not included and that may induce errors in the simulations of soil water content and temperature in relatively dry soils vapor transfer is the predominant means for water redistribution which also contributes to sensible and latent heat fluxes scanlon 1994 scanlon and milly 1994 zeng et al 2009a zeng et al 2009b the reasons are i in relatively dry soils relatively large temperature gradients can serve as a driving force for vapor transfer and ii a relatively large fraction of soil pores are air filled providing pathways for vapor transfer however adding vapor transfer to existing soil water and temperature models may substantially increase the model complexity because i vapor transfer has effects on both water fluxes and heat fluxes and ii phase changes of soil water must be considered for example philip and de vries 1957 and de vries 1958 included the vapor transfer as well as the associated heat fluxes and water phase changes and then the water transfer model and the heat transfer model became fully coupled see eq 2 the philip and de vries 1957 model is widely used in simulating coupled water and heat transfer in porous media and multiple improvements have been proposed for example sophocleous 1979 and milly 1982 reformulated the philip and de vries 1957 model using matric potential to account for the hysteresis and the coupling of matric potential and temperature and nassar and horton 1989 1997 included osmotic potential and developed a coupled heat water and solute transfer model for wettable soils however under the coupled formulation eq 2 the water transfer and heat transfer models cannot be solved one by one within a given discretized time step which causes difficulties in modularization solving the two equations in the philip and de vries 1957 model eq 2 one by one can greatly enhance the computing efficiency and simplify the programming thus multiple studies have investigated alternative formulations that can achieve such a one by one approach for example saito et al 2006 and šimůnek et al 2016 illustrated a commonly used simplification that for each discretized time step first assume soil temperature is constant and solve for soil water content second assume soil water content is constant and solve for soil temperature and repeat those two steps in the following discretized time steps such a simplification method has been adopted in a variety of related studies such as the coupled water and heat transfer in partially frozen soil zheng et al 2021 and the water heat air models with surface evaporation zeng et al 2011a zeng et al 2011b although the governing models in those studies were not exactly the same as the original version of the philip and de vries 1957 model eq 2 but were adapted to their specific application scenarios however for modularized soil simulators with connections to climate soil surface and crop models such as 2dsoil adding the vapor transfer to the water and heat transfer model with such a simplification is still challenging that is because the inclusion of vapor transfer can induce relatively large modifications to both existing water and heat transfer modules as well as the dataflow pathways between water and heat modules and other existing modules therefore there exists a need to design an approach to implement vapor transfer that can be compatible with modularized soil simulators such as 2dsoil where vapor transfer is not originally considered the objectives of this study are i to design a model for vapor transfer as well as the associated sensible and latent heat fluxes and water phase changes and make it compatible with modularized soil simulators ii to evaluate the performance of the new vapor transfer model and iii to implement the vapor transfer model as a separate module in coupled soil water and heat simulators such as 2dsoil following these objectives vapor transfer simulations can be enabled in 2dsoil and modifications to the 2dsoil model architecture the dataflow pathways and the existing water and heat transfer modules should be minimized moreover additional flexibility can be provided by such modularization which allows independent controls on the water transfer in liquid and vapor phases for example the vapor transfer pathway can be artificially activated or deactivated based on user settings if two soil layers are separated by a semi permeable film e g tyvek dupont inc water repellent but permeable to gas flux the semi permeable film can be simply implemented as an impermeable boundary for liquid water flux in the water transfer module while in the vapor transfer module such a semi permeable boundary exerts no effect 2 model establishment 2 1 review of existing models the combination of the richards equation richards 1931 and the conduction convection heat equation is shown in eq 1 within a given discretized time step water and heat transfer can be solved one by one using the two equations in eq 1 because vapor transfer and associated sensible and latent heat fluxes are not included it may produce undesirable simulation results in relatively dry soils in the following sections eq 1 without vapor transfer in soil is referred to as the preliminary formulation m p r e l and it serves as the starting point for our vapor transfer model design which means we will develop a vapor transfer model and insert the vapor transfer model in m p r e l using a modularized manner water equation θ t k h t h q l h t 1 a heat equation c s t t λ t c l ρ l q l t t 0 1 b equation 1a presents the mass conservation of soil liquid water where θ c m 3 c m 3 is the volumetric water content h c m is the soil matric potential k h t c m s 1 is the unsaturated hydraulic conductivity a constitutive relation between θ and h can be provided using the water characteristic function equation 1b presents the conservation of energy where t k is the soil temperature c s j c m 3 k 1 is the soil volumetric heat capacity λ w c m 1 k 1 is the thermal conductivity c l 4 187 j g 1 k 1 and ρ l 1 0 g c m 3 are the specific heat and density of liquid water q l k h h c m s 1 is the darcy flux density t 0 k is a pre specified reference temperature hence c l ρ l q l t t 0 represents the sensible heat flux associated with liquid water flux in contrast to the preliminary formulation m p r e l the philip and de vries 1957 model which fully couples the water and heat transfer in soil and includes water transfer in both liquid and vapor phases is shown in eq 2 water equation c θ θ h t c θ t t t d mv h t h d tv h t t q l h t k h t h d tl h t t q l h t d mv h t k h t h d tv h t d tl h t t 2 a heat equation c t θ h t c tt t t λ t c l ρ l q l t t 0 l 0 ρ l q v c v ρ l q v t t 0 q h h t 2 b c θ θ c m 1 c θ t k 1 c t θ j c m 3 c m 1 and c tt j c m 3 k 1 are capacity coefficients for h and t with respect to the changes in soil water content and temperature in eq 2a d mv h t c m s 1 and d tv h t c m 2 s 1 k 1 are coefficients of vapor transfer under the water potential gradient and temperature gradient respectively therefore q v c m s 1 is the total vapor flux driven by both gradients similarly d tl h t c m 2 s 1 k 1 in eq 2a is the liquid water diffusion coefficient under temperature gradient combined with the darcy flow defined in eq 1a q l h t represents the total liquid water flux in eq 2b l 0 j g 1 is the heat of vaporization of water at t 0 c v 1 864 j g 1 k 1 is the specific heat of vapor hence l 0 ρ l q v c v ρ l q v t t 0 represents the latent and sensible heat fluxes carried by vapor relative to the internal energy of liquid water at t 0 and q h h t becomes the total heat flux in soil the numerical implementation of the philip and de vries 1957 model without the simplifications illustrated in saito et al 2006 has been evaluated with experimental and numerical studies under a variety of initial and boundary conditions e g nassar and horton 1997 heitman et al 2007 heitman et al 2008 and wang et al 2017 thus such a numerical approach of the philip and de vries 1957 model eq 2 is used as a standard reference point in this study and in the following sections it is referred to as the full formulation m f u l l m f u l l also serves as the target in this study which means that after implementing a vapor transfer model in m p r e l recall m p r e l is the starting point of our model design where vapor transfer is not originally included see eq 1 the soil water and temperature simulations should achieve a performance similar to m f u l l the standard derivations of the philip and de vries 1957 model and the computation of capacity hydraulic conductivity and diffusivity coefficients can be found in heitman et al 2008 and wang et al 2017 the soil thermal conductivity λ is adopted from lu et al 2014 and summarized in table 1 the expression of the liquid water diffusion coefficient d tl h t is simplified from groenevelt and kay 1974 and milly 1982 which is provided in appendix a we also note that although both liquid water and water vapor are considered the philip and de vries 1957 model is not a typical 2 phase model but a 1 5 phase model because water potential and thermal equilibrium is assumed at the water vapor interface vanderborght et al 2017 typically within a given time step the full formulation m f u l l assumes that h and t are updated together as one equation system which requires solving a relatively large linear system that contains both h and t values from the computing girds saito et al 2006 and šimůnek et al 2016 illustrated a simplification that can solve the two equations in eq 2 one by one that is within a given discretized time step first assume t is constant and update h and second assume h is constant and update t therefore h and t are updated in two steps a diagram for such a two step process is presented in zheng et al 2021 see fig 1 for the dataflow chart in zheng et al 2021 we note that there exist some variations in the hydrus based models e g one improvement is that zheng et al 2021 repeat the one by one procedure in solving h and t twice within one time step but h and t are still updated in the water flow and heat flow blocks separately however because of the simplification the corresponding governing model was slightly changed from eq 2 to enable the one by one approach the equation system is presented as eq 2 in the following sections we denote the philip and de vries 1957 model with the numerical approach illustrated in saito et al 2006 and šimůnek et al 2016 as the simplified formulation m s i m p because the governing models that use saito et al 2006 and šimůnek et al 2016 simplification vary based on specific application scenarios the formulation of eq 2 may not be exactly the same as the ones in saito et al 2006 šimůnek et al 2016 zeng et al 2011a zeng et al 2011b or zheng et al 2021 water e q u a t i o n c θ θ h t d mv h t k h t h d tv h t d tl h t t t t 0 2 a h e a t e q u a t i o n c tt t t λ t c l ρ l q l t t 0 l 0 ρ l q v c v ρ l q v t t 0 h t 0 2 b 2 2 the vapor transfer model in this study the vapor transfer model is designed as a rebalance of soil water and heat by vapor flux and it should be solved after m p r e l to include the vapor transfer and its effects on heat exchanges recall that m p r e l is treated as the starting point of our model design the vapor transfer model can be simply described in the following two steps first taking the difference between the right hand side of eqs 1 and 2 and assuming d tl h t d tv h t i e the thermally driven liquid water transfer is much smaller than the vapor flux in an agricultural field soil see appendix a for detailed adjustment the vapor fluxes and the sensible and latent heat flux associated with vapor transfer can be extracted second reassemble the extracted vapor fluxes and vapor induced heat fluxes to the left hand side of eq 2 where the left hand side of eq 2 represents the differentiation of total soil water and total soil heat with respect to time then we obtain the governing equation for the vapor transfer model as shown in eq 3 vapor equation c θ θ h t c θ t t t d mv h t h d tv h t t 3 a heat equation c t θ h t c tt t t l 0 ρ l q v c v ρ l q v t t 0 3 b equation 3 can be implemented as a separate module which needs to be solved after m p r e l the initial conditions of eq 3 are the same as the initial conditions of m p r e l and zero water flux and zero heat flux are assumed as the boundary conditions as shown in eq 4 4 d mv h t h n d tv h t t n 0 l 0 ρ l q v c v ρ l q v t t 0 0 where n is the unit outward normal vector along the boundary of a given soil profile in the boundary conditions eq 4 the new vapor transfer model does not contribute to the water and heat fluxes between soil and ambient that is because the water both in liquid and vapor phases and heat exchanges on the boundaries such as evaporation infiltration or solar radiation have been fully expressed in m p r e l as mass fluxes and energy fluxes and solved before eqs 3 and 4 therefore the vapor transfer model can be considered as an internal compensation or rebalance of water and energy redistributions within the soil via vapor fluxes one benefit of using the boundary conditions eq 4 is that the boundary conditions originally employed in m p r e l do not need to be changed due to the inclusion of the vapor transfer model which minimizes the potential changes of existing modules due to the implementation of the new vapor transfer module however the drawback is if the boundary conditions eq 4 are assumed the vapor transfer model must be executed after m p r e l and cannot work on itself because no water and heat exchanges between soil and ambient are established in the new vapor transfer model via its own boundary conditions in the following sections the combination of m p r e l and the new vapor transfer model eqs 3 and 4 is referred to as the combined formulation m c o m b where m c o m b is built on m p r e l and m p r e l becomes a sub process of m c o m b by the end of this subsection we summarize the positions of the four model formulations m p r e l m c o m b m s i m p and m f u l l m p r e l is an existing formulation with limited performance due to the lack of vapor transfer simulation the new vapor transfer model is developed as a separate module and combined with m p r e l to obtain m c o m b m c o m b the new formulation proposed in this study is a modularized soil water and heat simulator that includes vapor transfer we expect m c o m b can achieve similar performance as m f u l l m s i m p is an existing simplified numerical formulation for the philip and de vries 1957 model since the main goal of this study is to combine m p r e l with the new vapor transfer model to obtain m c o m b and evaluate the performance of m c o m b against m f u l l m s i m p does not belong to main target of this study however due to the wide adoption of m s i m p we included it for comparison the four model formulations m p r e l m c o m b m s i m p and m f u l l as well as the corresponding governing equations are also summarized in appendix b in the next section we will demonstrate the performance of m c o m b by comparing m c o m b with m p r e l m s i m p and m f u l l with such comparisons the efficacy of the new vapor transfer model as a component in m c o m b can also be demonstrated 2 3 model demonstration for selected numerical examples in this section 1d illustrative examples implemented with matlab mathwork inc are provided to demonstrate the efficacy of the new vapor transfer model as well as the accuracy of m c o m b in simulating soil water content and temperature the accuracy of m c o m b can be evaluated by comparing the simulation results using m c o m b and the simulation results from m p r e l and m f u l l however for the vapor transfer model its performance is demonstrated through the performance of m c o m b that is the accuracy of m c o m b implies the effectiveness of the vapor transfer model because the vapor transfer model is only one component module in m c o m b rather than a completed water and heat simulator moreover we note that the vapor transfer model is not designed to be executed on itself in m c o m b the vapor transfer model must be executed after m p r e l and pure vapor fluxes without any liquid water involved are rare in natural soil therefore it will be challenging to provide error analyses for the new vapor transfer model on itself with no liquid water flux included thus we cannot use accuracy to quantify the performance of the vapor transfer model in the following section we will only use efficacy to represent the performance of the vapor transfer model and we use the vapor transfer model is effective to indicate that m c o m b with the vapor transfer model can achieve errors smaller than m p r e l i e m c o m b is more accurate than m p r e l with the new vapor transfer model equipped a 50 cm horizontally placed soil column is used in the following numerical examples the soil physical properties are isotropic and listed in table 1 such a setting the selected soil type and the 1d simulation scenario is used because the soil properties have been validated with both experimental and 1d numerical studies based on the philip and de vries 1997 model and some existing applications also utilized the same soil type e g heitmann et al 2008 wang et al 2017 hence the 1d simulation results via m f u l l can be assumed as the reference results the relative accuracy of m p r e l m c o m b and m s i m p with m f u l l as the reference is presented based on the relative mean error rme of soil water content and temperature i e 5 rme k y k y k f u l l k y k f u l l y θ o r t in eq 5 y represents the simulated water content or temperature the summation σ k is taken along the horizontal scale of the soil column where k is the index of the node in a discretized computing grid the subscript f u l l indicates the results obtained using m f u l l the reason to use rme rather than the relative root mean squared error rmse is to reduce the effects from large errors at single nodes in this subsection all the model formulations i e m p r e l m c o m b m s i m p and m f u l l are solved on the same computing grid example 1 model comparisons with a series of steady boundary conditions in this example we compared the simulated water content and temperature in the given 1d soil column for a series of steady boundary conditions i e the boundary conditions do not change with respect to time four selected boundary conditions are shown in table 2 including impermeable water boundaries e g a and b heat and water fluxes e g b and c and constant water content and temperature boundaries e g d those boundary conditions were selected to mimic a range of boundary conditions that may occur in agricultural fields or commonly used in numerical studies natural soils are seldomly adiabatic so we do not include boundary conditions with zero heat fluxes i e q h 0 in this example the boundary conditions are assumed to be steady hence they can serve as constant external forces to drive the water and heat redistributions in soil as t steady water content and temperature can be achieved within the soil column which simplifies the error comparison therefore the goal of this example is to show that m p r e l m c o m b and m s i m p can respond to the boundary conditions similarly to m f u l l the rme values of simulated results with respect to m f u l l are presented in fig 1 the relative error values with respect to m f u l l shown in the vertical axis are calculated from eq 5 although soil water content and temperature are not of the same dimension the relative errors can be plotted together the smaller the errors the better the accuracy for the simulated results the smoother the curves the smaller the numerical oscillations in general rme values of m c o m b and m s i m p are 0 005 indicating that both m c o m b and m s i m p can approximate m f u l l the small sub figures show that when t is sufficiently large the rme values of m c o m b and m s i m p do not approach 0 the reason is the governing equations corresponding to the two formulations m c o m b and m s i m p are not the same as the equations used in m f u l l see appendix b for a summary the rme values of m c o m b are small indicating that ignoring the liquid water diffusion under temperature gradients is a reasonable assumption in a c and d water content simulated with m c o m b has rme values of 0 0001 which are greater than the rme values for m s i m p while in b the simulated water content with m c o m b achieves lower rme values than the simulated water content with m s i m p therefore m c o m b and m s i m p can outperform each other under different simulation scenarios however in all the four selected boundary conditions the rme values of m c o m b simulated temperature are smaller than the rme values of the m s i m p results one reason could be that the interaction between water and temperature transfer is simplified in m s i m p where soil water content and temperature are updated by the two equations in eq 2 one by one however in m c o m b although soil water content and temperature are first updated one by one in liquid water and heat transfer equations i e the same as m p r e l soil water content and temperature are updated together in the vapor transfer model eq 3 therefore some interactions between water and temperature are included relatively large rme values can be observed in the m p r e l results for all four of the selected boundary conditions except for the soil temperature in fig 2 b that is because for all the simulation scenarios temperature within the soil column is not uniformly distributed and ignoring vapor transfer under temperature gradients as well as the sensible and latent heat flux associated with vapor transfer can result in relatively large errors for both soil water and temperature soil temperature rme of the m p r e l results in fig 2b may be an isolated exception due to the certain type of boundary conditions however the corresponding soil water content rme values are still larger than other models therefore we claim m p r e l still underperforms comparing with other formulations example 2 model comparisons for a series of time dependent boundary conditions in this example the boundary conditions vary with respect to time with formulations shown in table 3 the time dependent boundary conditions are obtained by adding oscillation terms to the steady boundary conditions in example 2 some changes are made in the non oscillation parts to restrict soil water content between the residual and saturated water contents as t soil water content and temperature both within the soil profile and on the boundaries are varied periodically following the oscillations in the time dependent boundary conditions model evaluations with time dependent boundary conditions are critical the first reason is that physically soil surface conditions in agricultural fields vary following the weather changes the second reason is that numerically interactions between water content and temperature can be presented in a single time step when solving m f u l l because the two equations in eq 2 are fully coupled and the water content and temperature must be updated together however for m p r e l m c o m b and m s i m p water potential and temperature are solved one by one in a single time step thus water and temperature interactions may need to be involved recursively with multiple time steps which may induce time delays and numerical oscillations therefore the goal of this example is to determine whether m p r e l m c o m b and m s i m p have a delayed response to the time varying boundary conditions compared to m f u l l especially when the temperature and water content increase or decrease rapidly the rme values of simulated results with respect to m f u l l are presented in fig 2 we observe relatively large fluctuations in rme values compared to those in fig 1 especially for m s i m p in a and d for the simulated soil temperature although m s i m p is able to reasonably reproduce the patterns of soil water and temperature solving water content and temperature one by one leads to time delays of minute scale for the soil water and temperature which induce periodic variations in the rme values with a relatively large magnitude under some boundary conditions fig 2a and d we provide an intuitive interpretation for the time delays and numerical oscillations in this example due to the large magnitude of fluctuation in the rme values shown in fig 2a and d given a discrete time step δ t m s i m p will first keep soil temperature constant and update soil water potential where the soil water potential as well as soil water content can be solved using an iterative numerical method such as picard iteration second soil water potential will be kept unchanged and soil temperature will be updated within δ t the model formulation of m s i m p as well as the one by one updates of soil water potential and temperature are presented in fig 1 of zheng et al 2021 within δ t after the soil temperature is updated the solution for the soil water potential and soil water content obtained before the update of soil temperature may not be optimal as it was due to the change of soil temperature however in general m s i m p will not allow solving the soil water potential again within δ t but pushes the whole procedure to the next time step therefore although the speed of convergence within δ t can be improved in m s i m p after completing the computation for δ t there will be a slight error in the soil water potential due to such a one by one approach similarity because of the slight error in the soil water potential soil temperature values solved in δ t may not be optimal either such errors will induce numerical oscillations in the rme values and can only be mitigated iteratively in the following time steps in this study such numerical oscillations are referred to as time delays we note that some realizations of hydrus e g zheng et al 2021 repeat the one by one updates of soil water potential and temperature for finitely many times e g twice within one time step however despite the increase in computing load the convergence of soil water potential and temperature within each time step is still evaluated separately the time delays can be mitigated with such an improvement but may not be totally removed in contrast in m f u l l the convergence of soil water potential and temperature must be evaluated as a whole within each discrete time step see appendix b for additional remarks similar phenomena can also be observed in fig 1 for m s i m p however the magnitude of the rme fluctuations in fig 1 is much smaller than that in fig 2 because the boundary conditions in example 1 are steady so the numerical solution can recursively approach to the steady state of soil water and temperature however in example 2 the boundary conditions are varying therefore when m s i m p strives to reduce the time delays produced in time step δ t using the following time steps the boundary conditions are not the same as it was in δ t hence the m s i m p may not be able to fully catch up with the changing boundary conditions in fig 2 the rme fluctuations for m c o m b are smaller than those for m s i m p the reason is that in m c o m b although the liquid water transfer and conduction convection heat transfer are first solved one by one within δ t via m p r e l recall m p r e l is the first step in m c o m b the vapor transfer model as the next computing step in δ t allows the soil water potential and temperature to be updated together one more time thus the time delays are partially avoided and some interactions between soil water and temperature can be included via the vapor transfer model refer to eqs 3 and 4 hence the rme values for m c o m b are somewhat smoothed for boundary conditions a and d m p r e l seems to outperform m s i m p especially for the simulated soil temperature that is because the periodic boundary conditions a and d only generate temperature variations within a relatively small slice of soil profile near the right boundary where the boundary conditions vary around the initial soil water content and temperature values therefore in those cases m p r e l becomes a rough approximation to m f u l l from an average sense hence m p r e l produces relatively small rme values in examples 1 and 2 although m c o m b and m s i m p alternate on the best performance based on the rme values m c o m b is more robust than m s i m p over all the scenarios because the accuracy of m c o m b implies the effectiveness of the new vapor transfer model the good performance of the vapor transfer model is confirmed executing m c o m b requires solving two differential equation systems eq 1 for m p r e l and eq 3 for vapor transfer therefore the computing load of m c o m b is larger than that for the other models in this study however such a drawback in computing load can be ameliorated by including parallel linear solvers such as the oneapi math kernel library and the pardiso solver intel inc used in 2dsoil 3 implementation of the vapor transfer model in 2dsoil 3 1 implementation of the vapor transfer model numerical implementation of the new vapor transfer model eqs 3 and 4 in 2dsoil is presented in this section the vapor transfer model is incorporated into the 2dsoil and placed after the water and heat transfer modules to satisfy the m c o m b model formulation 2dsoil performs 2d numerical simulations based on a pre generated triangular finite element grid soil water heat and chemical transfer are programs with separate modules but solved on the same finite element grid therefore following the existing water and heat transfer modules numerical solutions of the vapor transfer model can be obtained on the same grid the performance of m c o m b as well as the vapor transfer model used in m c o m b have been validated in section 2 3 so the main goal of section 3 is to implement m c o m b in 2dsoil without strict comparisons with m f u l l another reason for omitting the strict comparisons is that were m f u l l and m s i m p implemented in 2dsoil the modularized architecture in 2dsoil will be lost and dataflow pathways will be substantially changed hence the resulting simulator will operate much differently compared to the original 2dsoil therefore a directly comparison that including m f u l l and m s i m p under the 2dsoil framework cannot be applied for numerical schemes the vapor transfer equation eq 3a can be treated as a diffusive equation and solved by a standard finite element method that is because the vapor advection as well as the liquid islands effects that assist vapor transfer can be included in the diffusive coefficient d tv via a vapor enhancement factor cass et al 1984 however the heat transfer equation eq 3b is a conduction convective equation and should be solved with a conservative numerical scheme one simple way to establish a conservative scheme is to use the temperature from the upwind direction of the vapor flux on the right hand side of eq 3b the upwind temperature t up can be determined for each triangular element in the 2dsoil finite element grid for example consider an element that stays in the horizontal plane under the given coordinates in fig 3 first calculate the vapor flux q v d mv h t h d tv h t t where the water potential gradient h and temperature gradient t are obtained by linear interpolations based on the water potential and temperature values at the grid nodes a b and c then we analyze the vapor flux direction with respect to the three nodes for node a if the triple products z k q v 0 and z q v j 0 i e the upper diagram in fig 3 a uniform vapor flux from node a to edge bc can be assumed to lie within the element and are demarcated by the two dotted red lines since a locates in the upstream direction of the vapor flux the upwind temperature can be approximated by the temperature at a i e t up t a if the triple products z k q v 0 and z q v j 0 i e the lower diagram in fig 3 a uniform vapor flux will occur from edge bc to node a and the upwind temperature is a weighted average of the temperature at b and c i e t up b t c c t b b c where b and c are distances from b and c to q v respectively similar procedures can be performed for nodes b and c to exhaust all the possible directions of the vapor fluxes if the triple product is equal to 0 then the vapor flux is parallel to one of the edges and the determination of the upwind temperature coincides with the method used in 1d upwind schemes substituting the temperature on the right hand side of eq 3b by the upwind temperature t up eq 3b can be discretized with the standard finite element method the diagram in fig 4 presents the position of the vapor transfer model in 2dsoil and indicates how m p r e l and m c o m b are defined in 2dsoil m f u l l and m s i m p are also presented fig 4 indicates that the combination of the liquid water transfer model the heat transfer model and the new vapor transfer model in 2dsoil i e m c o m b performs a function equivalent to m f u l l and m s i m p fig 4 also emphasizes the order of solving liquid water transfer heat transfer and vapor transfer within a given discretized time step δ t for m c o m b in 2dsoil the dataflow pathways among the existing liquid water transfer module heat transfer module and other modules are maintained no additional pathway is added after involving the vapor transfer model hence the modularized architecture in 2dsoil model is retained 3 2 an illustrative example of model applications because the effectiveness of the vapor transfer model and the accuracy of m c o m b have been demonstrated in section 2 3 in this section we provide an example to illustrate the simulation results of 2dsoil with the new vapor transfer model i e m c o m b and without the vapor transfer model i e m p r e l recall that m f u l l and m s i m p cannot be easily supported based on the 2dsoil framework thus we only focus on m p r e l and m c o m b a 60 cm wide and 150 cm deep soil profile is considered with the physical properties presented in table 4 to provide spatial variations in soil water and temperature a ridge is formed on the left 30 cm of the soil surface the ridge has a 15 cm height and the surface topography follows a cosine curve covered by a plastic film the ridge surface becomes impermeable to water flux but not to heat flux the right 30 cm of the soil surface is flat and bare during rainfall events 94 of the precipitation received on the ridge becomes surface runoff flows rightwards along the ridge surface and infiltrates through the bare soil surface this configuration is also referred to as the ridge furrow water harvesting rfwh which is designed to conserve water in relatively deep soil layers wang et al 2015 zhao et al 2018 wang et al 2020 wang et al 2021a uniform initial water content 0 12 c m 3 c m 3 and temperature 10 c are assumed in the soil profile and the simulation is run for a 40 day period doy 100 140 in 2017 to allow the soil profile to fully adapt to the ambient weather conditions the water content and temperature distributions at 12 00p m mid day and 12 00 a m mid night on the final simulation day doy 140 in 2017 are recorded and presented in fig 5 the differences in soil temperature between mid day fig 5e and f and mid night fig 5g and h can be observed during the daytime fig 5e and f the soil surface receives radiation and achieves the highest temperature values the temperature contours are nearly parallel to the soil surface corresponding to an upwards temperature gradient during the nighttime fig 5g and h the soil surface loses heat due to the plastic cover and the additional soil volume for the ridge an area with relatively high temperature t 22 c contour can be observed in the ridge the benefit of including the vapor transfer model can be shown by comparing fig 5e and g with fig 5f and h the vapor flux carries sensible and latent heat flux from the soil surface to subsurface layers and increases the subsurface temperature therefore the t 12 c contour in fig 5e with vapor flux is deeper than the t 12 c contour in fig 5f no vapor flux and the t 12 c and t 13 c contours in fig 5g with vapor flux are deeper than those in fig 5h no vapor flux the effects of vapor transfer on soil water distribution can be observed by comparing fig 5a and c and fig 5b and d with the vapor transfer model invoked during the daytime fig 5a the temperature gradient near the soil surface is relatively large and the soil under the ridge has higher temperature than the soil under the flat surface therefore temperature gradients drive vapor flux from the ridged portion to the flat portion and lead to a small bend of the θ 0 20 c m 3 c m 3 contour in fig 5a near the ridge surface marked with as well as a shrinkage of the θ 0 22 c m 3 c m 3 contour in fig 5a with vapor flux comparing to the θ 0 20 c m 3 c m 3 and θ 0 22 c m 3 c m 3 contours in fig 5b no vapor flux in another words the water vapor is pushed from the ridged portion to the flat portion of the soil profile due to the soil temperature gradient during the nighttime with the vapor transfer considered fig 5c the highest temperature occurs near the t 22 c contour see the position of t 22 c contour in fig 5g so the small bend of the θ 0 20 c m 3 c m 3 contour moves from the soil surface in fig 5a to a location in fig 5c marked as corresponding to the frontiers of the t 22 c and t 21 c contours in fig 5g see the differences of θ 0 20 c m 3 c m 3 contours in fig 5a and c for the changes of the contour shape and position however without considering vapor transfer fig 5b and d neither the small bends of the θ 0 20 c m 3 c m 3 contour or its position changes nor does the shrinkage the decrease of internal area of the θ 0 22 c m 3 c m 3 contour occur see the differences of the θ 0 22 c m 3 c m 3 contours between fig 5a and c and fig 5b and d for the area enclosed within the contours without vapor transfer the water transfer will only depend on the water potential distributions and have very limited response to the diurnal temperature changes hence the water distributions in fig 5b and d are nearly identical therefore the differences between m p r e l and m c o m b in simulating soil water distribution as well as the effects of the new vapor transfer model are illustrated 4 summary in this study we design a numerical process to model the vapor flux and include vapor transfer effects on soil water and temperature simulations when the liquid water transfer and heat transfer in soil are already considered with the new vapor transfer model simulations of liquid water heat and vapor transfer in soil can be implemented as separate modules and solved one by one within a single discretized time step the efficacy of the vapor transfer model as well as the accuracy and stability of the coupled soil water and temperature simulations with the new vapor transfer model are established via numerical experiments the rme values of soil water content and temperature are 0 005 relative to the standard philip and de vries 1957 model an advantage of using the new vapor transfer model is that for a modularized soil simulator where water and heat transfer modules exist but vapor transfer is not included the vapor transfer can be easily added with minimal modifications to the existing modules or the dataflow pathways the model formulation using the new vapor transfer model i e m c o m b has a simple and flexible structure compared to the fully coupled formulation i e m f u l l and achieves stable simulation performance for most of the examples presented in this study in this study we implemented the vapor flow model in 2dsoil and a numerical example is presented to illustrate the effects of vapor transfer on 2d soil water and temperature regimes in conclusion the vapor transfer model proposed in this study provides an effective and easy to use method to include vapor flux in soil water and heat transfer simulations this study focuses on a new way to include vapor transfer into the soil water and heat simulations and related applications such as the vapor flux effects on chemical transfer and root growth can be directions for future studies because adding the vapor transfer module leads to an increase in the computing load the use of high performance computing e g parallel computing or gpu computing within personal computers in soil water heat and vapor transfer simulations is also encouraged and can be another possible direction for future research credit authorship contribution statement zhuangji wang conceptualization formal analysis methodology software writing original draft dennis timlin conceptualization formal analysis methodology software writing review editing supervision david fleisher conceptualization supervision writing review editing wenguang sun methodology software writing review editing sahila beegum methodology software writing review editing sanai li methodology software writing review editing yan chen conceptualization supervision writing review editing vangimalla r reddy conceptualization supervision writing review editing katherine tully conceptualization supervision writing review editing robert horton conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this material is based upon work supported by the department of agriculture agricultural research service under agreement no 58 8042 7 067 national science foundation under grant 2037504 and usda nifa multi state project 4188 the authors also received support from the university of maryland college park university of nebraska lincoln and iowa state university appendix a the liquid water diffusion coefficient under temperature gradient d tl h t is used in model formulations m f u l l and m s i m p in this study we ignored d tl h t in m c o m b based on the assumption that d tl h t d tv h t therefore it is worth discussing that the formulation of d tl h t d tl h t is namely treated as a diffusion coefficient based on the mathematical formulations of the partial differential equation models however physically it should be considered as a phenomenological coefficient depending on the soil type e souza and nogueira 2020 groenevelt and kay 1974 and milly 1982 proposed that liquid water transfer under temperature gradient was based on the variations of water soil adhesion with respect to temperature and modeled it using thermal osmosis and water surface tension which was further simplified by noborio et al 1996 in this study we apply additional simplifications to the model for coupled water and heat simulations suppose the water surface tension σ n c m 1 is a1 σ 7 275 10 4 1 0 002 t 291 we artificially add a negative sign in front of the leading coefficient that is because we assumed the soil is hydrophilic so the negative sign indicates the suction from the soil capillary pores to liquid water i e the strength of water tied to the capillary pores then the temperature induced water potential change can be expressed as a2 δ h δ σ t s a s ρ l g s δ σ t s a ρ l g s a ρ l g σ t t δ t in eq a2 s a c m 2 c m 3 is the volumetric specific surface area of soil and s c m 2 is the area of a given cross sectional surface therefore s a s can be considered approximately as the perimeter of a liquid water film at the given cross sectional surface which is the simplification we proposed then applying eq a2 in darcy s law we have a3 q l k h t h k h t g a s a ρ l g σ t t d tl h t t in eq a3 g a is an empirical gain factor with values ranging from 4 to 8 in general noborio et al 1996 because increasing the temperature can reduce the water soil adhesion and increase the mobility of liquid water the liquid water flux occurs from the regions with relatively high temperature to the regions with relatively low temperature following the expression of d tl h t in eq a3 d tl h t k h t has an order of 10 2 which is of the same scale proposed by prunty 2009 lu et al 2020 studied the transient soil water fluxes under a temperature gradient using a dual probe heat pulse method with uniform initial soil water content and temperature lu et al 2020 reported that under a range of initial soil water content and temperature the liquid water transfer under temperature gradient is negligible which provides additional evidence for the validity of our assumption that ignoring d tl h t in appendix a we presented a simplified approach to compute d tl h t however the model formulations in m f u l l and m s i m p as well as the general theory and numerical method proposed in this study are independent of the detailed empirical or physical expressions for d tl h t appendix b in this appendix we provide a tabular summary for the governing equations corresponding to the model formulations i e m p r e l m c o m b m s i m p and m f u l l mentioned in this study we note that the philip and de vries 1957 model serves as the foundation for all the formulations expect for m p r e l which uses a simpler governing equation system however due to the designs of the model formulations the governing equations that appear in m c o m b m s i m p and m f u l l may be different from the original fully coupled version of philip and de vries 1957 model table b1 core ideas 1 a vapor transfer model is designed and applied for soil water and heat simulations 2 model performance is evaluated by its effects on coupled soil water and heat transfer 3 the vapor transfer model is programed as a separate module in 2dsoil 4 2dsoil performs reasonable simulations with the vapor transfer model declaration 1 the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 2 this paper does not constitute a standard specification regulation or recommendation for the numerical models and field management techniques 3 the computer code of the models included in this paper as well as the input files of the illustrative examples are released with the latest version of maizsim at https github com ars csgcl dt update recursively a stationary executable version of the compute code is also available at https github com cauwzj 
3453,coupled water and heat transfer models are widely used to analyze soil water content and temperature dynamics evaluate agricultural management systems and support crop growth modelling in relatively dry soils vapor transfer rather than liquid water flux becomes the main pathway for water redistribution however in some modularized soil simulators e g 2dsoil timlin et al 1996 vapor transfer is not included which may induce errors in soil water and heat modelling directly embedding vapor transfer into existing water and heat transfer modules may violate the modularized architecture of those simulators therefore the objectives of this study are to design a vapor transfer model evaluate its performance and implement it as a separate module in a coupled soil water and heat simulator e g 2dsoil the efficacy of the vapor transfer model is evaluated by comparing the simulated soil water content and temperature before and after including the new vapor transfer model and the soil water content and temperature simulated with the standard philip and de vries 1957 model by implementing vapor transfer as a separate module in 2dsoil modifications to existing water and heat transfer modules can be minimized and the modularized model architecture can be maintained numerical examples of 2dsoil with the new vapor transfer model are presented to illustrate the effects of vapor flux on soil water and temperature redistributions in conclusion the new vapor transfer model provides an effective and easy to use method to account for the effects of vapor transfer on coupled soil water and heat simulations keywords vapor transfer water and heat transfer modularization numerical simulations 2dsoil 1 introduction numerical simulation is an important approach to elucidate water and heat transfer in soil and it supports a wide range of applications in agriculture and civil engineering for model establishment a variety of soil simulators e g the early versions of hydrus such as hydrus 1d or chain 2d simunek and van genuchten 1994 simunek et al 2012 combined the richards equation richards 1931 and a conduction convection heat equation as the governing model to represent the water and heat transfer in soil see eq 1 such a model formulation does not include temperature gradient as a factor in liquid water flux see eq 1a after solving the richards equation i e eq 1a the liquid water flux can be considered as a known quantity when computing the conductive and convective heat transfer see eq 1b where liquid water flux carries sensible heat flux thus given a discretized time step the two equations for soil water transfer and soil heat transfer eq 1a and 1b respectively can be solved one by one using relatively simple and efficient numerical implementations based on that model formulation eq 1 soil water and heat transfer can be programed into two separate modules which can also support a relatively complex but flexible model architecture for example in 2dsoil timlin et al 1996 a modularized simulator of soil physical and chemical processes in 2d soil profiles one horizontal scale and one vertical scale both the water transfer module and the heat transfer module can establish their own connections i e dataflow pathways to soil surface water and heat balance models crop growth models and soil root interaction models additional modules can be linked to the water and heat transfer modules in 2dsoil with minimal or no modifications to the existing modules timlin et al 1996 kim et al 2012 wang et al 2021a wang et al 2021b however vapor transfer which contributes to both water and heat dynamics in soil is not included and that may induce errors in the simulations of soil water content and temperature in relatively dry soils vapor transfer is the predominant means for water redistribution which also contributes to sensible and latent heat fluxes scanlon 1994 scanlon and milly 1994 zeng et al 2009a zeng et al 2009b the reasons are i in relatively dry soils relatively large temperature gradients can serve as a driving force for vapor transfer and ii a relatively large fraction of soil pores are air filled providing pathways for vapor transfer however adding vapor transfer to existing soil water and temperature models may substantially increase the model complexity because i vapor transfer has effects on both water fluxes and heat fluxes and ii phase changes of soil water must be considered for example philip and de vries 1957 and de vries 1958 included the vapor transfer as well as the associated heat fluxes and water phase changes and then the water transfer model and the heat transfer model became fully coupled see eq 2 the philip and de vries 1957 model is widely used in simulating coupled water and heat transfer in porous media and multiple improvements have been proposed for example sophocleous 1979 and milly 1982 reformulated the philip and de vries 1957 model using matric potential to account for the hysteresis and the coupling of matric potential and temperature and nassar and horton 1989 1997 included osmotic potential and developed a coupled heat water and solute transfer model for wettable soils however under the coupled formulation eq 2 the water transfer and heat transfer models cannot be solved one by one within a given discretized time step which causes difficulties in modularization solving the two equations in the philip and de vries 1957 model eq 2 one by one can greatly enhance the computing efficiency and simplify the programming thus multiple studies have investigated alternative formulations that can achieve such a one by one approach for example saito et al 2006 and šimůnek et al 2016 illustrated a commonly used simplification that for each discretized time step first assume soil temperature is constant and solve for soil water content second assume soil water content is constant and solve for soil temperature and repeat those two steps in the following discretized time steps such a simplification method has been adopted in a variety of related studies such as the coupled water and heat transfer in partially frozen soil zheng et al 2021 and the water heat air models with surface evaporation zeng et al 2011a zeng et al 2011b although the governing models in those studies were not exactly the same as the original version of the philip and de vries 1957 model eq 2 but were adapted to their specific application scenarios however for modularized soil simulators with connections to climate soil surface and crop models such as 2dsoil adding the vapor transfer to the water and heat transfer model with such a simplification is still challenging that is because the inclusion of vapor transfer can induce relatively large modifications to both existing water and heat transfer modules as well as the dataflow pathways between water and heat modules and other existing modules therefore there exists a need to design an approach to implement vapor transfer that can be compatible with modularized soil simulators such as 2dsoil where vapor transfer is not originally considered the objectives of this study are i to design a model for vapor transfer as well as the associated sensible and latent heat fluxes and water phase changes and make it compatible with modularized soil simulators ii to evaluate the performance of the new vapor transfer model and iii to implement the vapor transfer model as a separate module in coupled soil water and heat simulators such as 2dsoil following these objectives vapor transfer simulations can be enabled in 2dsoil and modifications to the 2dsoil model architecture the dataflow pathways and the existing water and heat transfer modules should be minimized moreover additional flexibility can be provided by such modularization which allows independent controls on the water transfer in liquid and vapor phases for example the vapor transfer pathway can be artificially activated or deactivated based on user settings if two soil layers are separated by a semi permeable film e g tyvek dupont inc water repellent but permeable to gas flux the semi permeable film can be simply implemented as an impermeable boundary for liquid water flux in the water transfer module while in the vapor transfer module such a semi permeable boundary exerts no effect 2 model establishment 2 1 review of existing models the combination of the richards equation richards 1931 and the conduction convection heat equation is shown in eq 1 within a given discretized time step water and heat transfer can be solved one by one using the two equations in eq 1 because vapor transfer and associated sensible and latent heat fluxes are not included it may produce undesirable simulation results in relatively dry soils in the following sections eq 1 without vapor transfer in soil is referred to as the preliminary formulation m p r e l and it serves as the starting point for our vapor transfer model design which means we will develop a vapor transfer model and insert the vapor transfer model in m p r e l using a modularized manner water equation θ t k h t h q l h t 1 a heat equation c s t t λ t c l ρ l q l t t 0 1 b equation 1a presents the mass conservation of soil liquid water where θ c m 3 c m 3 is the volumetric water content h c m is the soil matric potential k h t c m s 1 is the unsaturated hydraulic conductivity a constitutive relation between θ and h can be provided using the water characteristic function equation 1b presents the conservation of energy where t k is the soil temperature c s j c m 3 k 1 is the soil volumetric heat capacity λ w c m 1 k 1 is the thermal conductivity c l 4 187 j g 1 k 1 and ρ l 1 0 g c m 3 are the specific heat and density of liquid water q l k h h c m s 1 is the darcy flux density t 0 k is a pre specified reference temperature hence c l ρ l q l t t 0 represents the sensible heat flux associated with liquid water flux in contrast to the preliminary formulation m p r e l the philip and de vries 1957 model which fully couples the water and heat transfer in soil and includes water transfer in both liquid and vapor phases is shown in eq 2 water equation c θ θ h t c θ t t t d mv h t h d tv h t t q l h t k h t h d tl h t t q l h t d mv h t k h t h d tv h t d tl h t t 2 a heat equation c t θ h t c tt t t λ t c l ρ l q l t t 0 l 0 ρ l q v c v ρ l q v t t 0 q h h t 2 b c θ θ c m 1 c θ t k 1 c t θ j c m 3 c m 1 and c tt j c m 3 k 1 are capacity coefficients for h and t with respect to the changes in soil water content and temperature in eq 2a d mv h t c m s 1 and d tv h t c m 2 s 1 k 1 are coefficients of vapor transfer under the water potential gradient and temperature gradient respectively therefore q v c m s 1 is the total vapor flux driven by both gradients similarly d tl h t c m 2 s 1 k 1 in eq 2a is the liquid water diffusion coefficient under temperature gradient combined with the darcy flow defined in eq 1a q l h t represents the total liquid water flux in eq 2b l 0 j g 1 is the heat of vaporization of water at t 0 c v 1 864 j g 1 k 1 is the specific heat of vapor hence l 0 ρ l q v c v ρ l q v t t 0 represents the latent and sensible heat fluxes carried by vapor relative to the internal energy of liquid water at t 0 and q h h t becomes the total heat flux in soil the numerical implementation of the philip and de vries 1957 model without the simplifications illustrated in saito et al 2006 has been evaluated with experimental and numerical studies under a variety of initial and boundary conditions e g nassar and horton 1997 heitman et al 2007 heitman et al 2008 and wang et al 2017 thus such a numerical approach of the philip and de vries 1957 model eq 2 is used as a standard reference point in this study and in the following sections it is referred to as the full formulation m f u l l m f u l l also serves as the target in this study which means that after implementing a vapor transfer model in m p r e l recall m p r e l is the starting point of our model design where vapor transfer is not originally included see eq 1 the soil water and temperature simulations should achieve a performance similar to m f u l l the standard derivations of the philip and de vries 1957 model and the computation of capacity hydraulic conductivity and diffusivity coefficients can be found in heitman et al 2008 and wang et al 2017 the soil thermal conductivity λ is adopted from lu et al 2014 and summarized in table 1 the expression of the liquid water diffusion coefficient d tl h t is simplified from groenevelt and kay 1974 and milly 1982 which is provided in appendix a we also note that although both liquid water and water vapor are considered the philip and de vries 1957 model is not a typical 2 phase model but a 1 5 phase model because water potential and thermal equilibrium is assumed at the water vapor interface vanderborght et al 2017 typically within a given time step the full formulation m f u l l assumes that h and t are updated together as one equation system which requires solving a relatively large linear system that contains both h and t values from the computing girds saito et al 2006 and šimůnek et al 2016 illustrated a simplification that can solve the two equations in eq 2 one by one that is within a given discretized time step first assume t is constant and update h and second assume h is constant and update t therefore h and t are updated in two steps a diagram for such a two step process is presented in zheng et al 2021 see fig 1 for the dataflow chart in zheng et al 2021 we note that there exist some variations in the hydrus based models e g one improvement is that zheng et al 2021 repeat the one by one procedure in solving h and t twice within one time step but h and t are still updated in the water flow and heat flow blocks separately however because of the simplification the corresponding governing model was slightly changed from eq 2 to enable the one by one approach the equation system is presented as eq 2 in the following sections we denote the philip and de vries 1957 model with the numerical approach illustrated in saito et al 2006 and šimůnek et al 2016 as the simplified formulation m s i m p because the governing models that use saito et al 2006 and šimůnek et al 2016 simplification vary based on specific application scenarios the formulation of eq 2 may not be exactly the same as the ones in saito et al 2006 šimůnek et al 2016 zeng et al 2011a zeng et al 2011b or zheng et al 2021 water e q u a t i o n c θ θ h t d mv h t k h t h d tv h t d tl h t t t t 0 2 a h e a t e q u a t i o n c tt t t λ t c l ρ l q l t t 0 l 0 ρ l q v c v ρ l q v t t 0 h t 0 2 b 2 2 the vapor transfer model in this study the vapor transfer model is designed as a rebalance of soil water and heat by vapor flux and it should be solved after m p r e l to include the vapor transfer and its effects on heat exchanges recall that m p r e l is treated as the starting point of our model design the vapor transfer model can be simply described in the following two steps first taking the difference between the right hand side of eqs 1 and 2 and assuming d tl h t d tv h t i e the thermally driven liquid water transfer is much smaller than the vapor flux in an agricultural field soil see appendix a for detailed adjustment the vapor fluxes and the sensible and latent heat flux associated with vapor transfer can be extracted second reassemble the extracted vapor fluxes and vapor induced heat fluxes to the left hand side of eq 2 where the left hand side of eq 2 represents the differentiation of total soil water and total soil heat with respect to time then we obtain the governing equation for the vapor transfer model as shown in eq 3 vapor equation c θ θ h t c θ t t t d mv h t h d tv h t t 3 a heat equation c t θ h t c tt t t l 0 ρ l q v c v ρ l q v t t 0 3 b equation 3 can be implemented as a separate module which needs to be solved after m p r e l the initial conditions of eq 3 are the same as the initial conditions of m p r e l and zero water flux and zero heat flux are assumed as the boundary conditions as shown in eq 4 4 d mv h t h n d tv h t t n 0 l 0 ρ l q v c v ρ l q v t t 0 0 where n is the unit outward normal vector along the boundary of a given soil profile in the boundary conditions eq 4 the new vapor transfer model does not contribute to the water and heat fluxes between soil and ambient that is because the water both in liquid and vapor phases and heat exchanges on the boundaries such as evaporation infiltration or solar radiation have been fully expressed in m p r e l as mass fluxes and energy fluxes and solved before eqs 3 and 4 therefore the vapor transfer model can be considered as an internal compensation or rebalance of water and energy redistributions within the soil via vapor fluxes one benefit of using the boundary conditions eq 4 is that the boundary conditions originally employed in m p r e l do not need to be changed due to the inclusion of the vapor transfer model which minimizes the potential changes of existing modules due to the implementation of the new vapor transfer module however the drawback is if the boundary conditions eq 4 are assumed the vapor transfer model must be executed after m p r e l and cannot work on itself because no water and heat exchanges between soil and ambient are established in the new vapor transfer model via its own boundary conditions in the following sections the combination of m p r e l and the new vapor transfer model eqs 3 and 4 is referred to as the combined formulation m c o m b where m c o m b is built on m p r e l and m p r e l becomes a sub process of m c o m b by the end of this subsection we summarize the positions of the four model formulations m p r e l m c o m b m s i m p and m f u l l m p r e l is an existing formulation with limited performance due to the lack of vapor transfer simulation the new vapor transfer model is developed as a separate module and combined with m p r e l to obtain m c o m b m c o m b the new formulation proposed in this study is a modularized soil water and heat simulator that includes vapor transfer we expect m c o m b can achieve similar performance as m f u l l m s i m p is an existing simplified numerical formulation for the philip and de vries 1957 model since the main goal of this study is to combine m p r e l with the new vapor transfer model to obtain m c o m b and evaluate the performance of m c o m b against m f u l l m s i m p does not belong to main target of this study however due to the wide adoption of m s i m p we included it for comparison the four model formulations m p r e l m c o m b m s i m p and m f u l l as well as the corresponding governing equations are also summarized in appendix b in the next section we will demonstrate the performance of m c o m b by comparing m c o m b with m p r e l m s i m p and m f u l l with such comparisons the efficacy of the new vapor transfer model as a component in m c o m b can also be demonstrated 2 3 model demonstration for selected numerical examples in this section 1d illustrative examples implemented with matlab mathwork inc are provided to demonstrate the efficacy of the new vapor transfer model as well as the accuracy of m c o m b in simulating soil water content and temperature the accuracy of m c o m b can be evaluated by comparing the simulation results using m c o m b and the simulation results from m p r e l and m f u l l however for the vapor transfer model its performance is demonstrated through the performance of m c o m b that is the accuracy of m c o m b implies the effectiveness of the vapor transfer model because the vapor transfer model is only one component module in m c o m b rather than a completed water and heat simulator moreover we note that the vapor transfer model is not designed to be executed on itself in m c o m b the vapor transfer model must be executed after m p r e l and pure vapor fluxes without any liquid water involved are rare in natural soil therefore it will be challenging to provide error analyses for the new vapor transfer model on itself with no liquid water flux included thus we cannot use accuracy to quantify the performance of the vapor transfer model in the following section we will only use efficacy to represent the performance of the vapor transfer model and we use the vapor transfer model is effective to indicate that m c o m b with the vapor transfer model can achieve errors smaller than m p r e l i e m c o m b is more accurate than m p r e l with the new vapor transfer model equipped a 50 cm horizontally placed soil column is used in the following numerical examples the soil physical properties are isotropic and listed in table 1 such a setting the selected soil type and the 1d simulation scenario is used because the soil properties have been validated with both experimental and 1d numerical studies based on the philip and de vries 1997 model and some existing applications also utilized the same soil type e g heitmann et al 2008 wang et al 2017 hence the 1d simulation results via m f u l l can be assumed as the reference results the relative accuracy of m p r e l m c o m b and m s i m p with m f u l l as the reference is presented based on the relative mean error rme of soil water content and temperature i e 5 rme k y k y k f u l l k y k f u l l y θ o r t in eq 5 y represents the simulated water content or temperature the summation σ k is taken along the horizontal scale of the soil column where k is the index of the node in a discretized computing grid the subscript f u l l indicates the results obtained using m f u l l the reason to use rme rather than the relative root mean squared error rmse is to reduce the effects from large errors at single nodes in this subsection all the model formulations i e m p r e l m c o m b m s i m p and m f u l l are solved on the same computing grid example 1 model comparisons with a series of steady boundary conditions in this example we compared the simulated water content and temperature in the given 1d soil column for a series of steady boundary conditions i e the boundary conditions do not change with respect to time four selected boundary conditions are shown in table 2 including impermeable water boundaries e g a and b heat and water fluxes e g b and c and constant water content and temperature boundaries e g d those boundary conditions were selected to mimic a range of boundary conditions that may occur in agricultural fields or commonly used in numerical studies natural soils are seldomly adiabatic so we do not include boundary conditions with zero heat fluxes i e q h 0 in this example the boundary conditions are assumed to be steady hence they can serve as constant external forces to drive the water and heat redistributions in soil as t steady water content and temperature can be achieved within the soil column which simplifies the error comparison therefore the goal of this example is to show that m p r e l m c o m b and m s i m p can respond to the boundary conditions similarly to m f u l l the rme values of simulated results with respect to m f u l l are presented in fig 1 the relative error values with respect to m f u l l shown in the vertical axis are calculated from eq 5 although soil water content and temperature are not of the same dimension the relative errors can be plotted together the smaller the errors the better the accuracy for the simulated results the smoother the curves the smaller the numerical oscillations in general rme values of m c o m b and m s i m p are 0 005 indicating that both m c o m b and m s i m p can approximate m f u l l the small sub figures show that when t is sufficiently large the rme values of m c o m b and m s i m p do not approach 0 the reason is the governing equations corresponding to the two formulations m c o m b and m s i m p are not the same as the equations used in m f u l l see appendix b for a summary the rme values of m c o m b are small indicating that ignoring the liquid water diffusion under temperature gradients is a reasonable assumption in a c and d water content simulated with m c o m b has rme values of 0 0001 which are greater than the rme values for m s i m p while in b the simulated water content with m c o m b achieves lower rme values than the simulated water content with m s i m p therefore m c o m b and m s i m p can outperform each other under different simulation scenarios however in all the four selected boundary conditions the rme values of m c o m b simulated temperature are smaller than the rme values of the m s i m p results one reason could be that the interaction between water and temperature transfer is simplified in m s i m p where soil water content and temperature are updated by the two equations in eq 2 one by one however in m c o m b although soil water content and temperature are first updated one by one in liquid water and heat transfer equations i e the same as m p r e l soil water content and temperature are updated together in the vapor transfer model eq 3 therefore some interactions between water and temperature are included relatively large rme values can be observed in the m p r e l results for all four of the selected boundary conditions except for the soil temperature in fig 2 b that is because for all the simulation scenarios temperature within the soil column is not uniformly distributed and ignoring vapor transfer under temperature gradients as well as the sensible and latent heat flux associated with vapor transfer can result in relatively large errors for both soil water and temperature soil temperature rme of the m p r e l results in fig 2b may be an isolated exception due to the certain type of boundary conditions however the corresponding soil water content rme values are still larger than other models therefore we claim m p r e l still underperforms comparing with other formulations example 2 model comparisons for a series of time dependent boundary conditions in this example the boundary conditions vary with respect to time with formulations shown in table 3 the time dependent boundary conditions are obtained by adding oscillation terms to the steady boundary conditions in example 2 some changes are made in the non oscillation parts to restrict soil water content between the residual and saturated water contents as t soil water content and temperature both within the soil profile and on the boundaries are varied periodically following the oscillations in the time dependent boundary conditions model evaluations with time dependent boundary conditions are critical the first reason is that physically soil surface conditions in agricultural fields vary following the weather changes the second reason is that numerically interactions between water content and temperature can be presented in a single time step when solving m f u l l because the two equations in eq 2 are fully coupled and the water content and temperature must be updated together however for m p r e l m c o m b and m s i m p water potential and temperature are solved one by one in a single time step thus water and temperature interactions may need to be involved recursively with multiple time steps which may induce time delays and numerical oscillations therefore the goal of this example is to determine whether m p r e l m c o m b and m s i m p have a delayed response to the time varying boundary conditions compared to m f u l l especially when the temperature and water content increase or decrease rapidly the rme values of simulated results with respect to m f u l l are presented in fig 2 we observe relatively large fluctuations in rme values compared to those in fig 1 especially for m s i m p in a and d for the simulated soil temperature although m s i m p is able to reasonably reproduce the patterns of soil water and temperature solving water content and temperature one by one leads to time delays of minute scale for the soil water and temperature which induce periodic variations in the rme values with a relatively large magnitude under some boundary conditions fig 2a and d we provide an intuitive interpretation for the time delays and numerical oscillations in this example due to the large magnitude of fluctuation in the rme values shown in fig 2a and d given a discrete time step δ t m s i m p will first keep soil temperature constant and update soil water potential where the soil water potential as well as soil water content can be solved using an iterative numerical method such as picard iteration second soil water potential will be kept unchanged and soil temperature will be updated within δ t the model formulation of m s i m p as well as the one by one updates of soil water potential and temperature are presented in fig 1 of zheng et al 2021 within δ t after the soil temperature is updated the solution for the soil water potential and soil water content obtained before the update of soil temperature may not be optimal as it was due to the change of soil temperature however in general m s i m p will not allow solving the soil water potential again within δ t but pushes the whole procedure to the next time step therefore although the speed of convergence within δ t can be improved in m s i m p after completing the computation for δ t there will be a slight error in the soil water potential due to such a one by one approach similarity because of the slight error in the soil water potential soil temperature values solved in δ t may not be optimal either such errors will induce numerical oscillations in the rme values and can only be mitigated iteratively in the following time steps in this study such numerical oscillations are referred to as time delays we note that some realizations of hydrus e g zheng et al 2021 repeat the one by one updates of soil water potential and temperature for finitely many times e g twice within one time step however despite the increase in computing load the convergence of soil water potential and temperature within each time step is still evaluated separately the time delays can be mitigated with such an improvement but may not be totally removed in contrast in m f u l l the convergence of soil water potential and temperature must be evaluated as a whole within each discrete time step see appendix b for additional remarks similar phenomena can also be observed in fig 1 for m s i m p however the magnitude of the rme fluctuations in fig 1 is much smaller than that in fig 2 because the boundary conditions in example 1 are steady so the numerical solution can recursively approach to the steady state of soil water and temperature however in example 2 the boundary conditions are varying therefore when m s i m p strives to reduce the time delays produced in time step δ t using the following time steps the boundary conditions are not the same as it was in δ t hence the m s i m p may not be able to fully catch up with the changing boundary conditions in fig 2 the rme fluctuations for m c o m b are smaller than those for m s i m p the reason is that in m c o m b although the liquid water transfer and conduction convection heat transfer are first solved one by one within δ t via m p r e l recall m p r e l is the first step in m c o m b the vapor transfer model as the next computing step in δ t allows the soil water potential and temperature to be updated together one more time thus the time delays are partially avoided and some interactions between soil water and temperature can be included via the vapor transfer model refer to eqs 3 and 4 hence the rme values for m c o m b are somewhat smoothed for boundary conditions a and d m p r e l seems to outperform m s i m p especially for the simulated soil temperature that is because the periodic boundary conditions a and d only generate temperature variations within a relatively small slice of soil profile near the right boundary where the boundary conditions vary around the initial soil water content and temperature values therefore in those cases m p r e l becomes a rough approximation to m f u l l from an average sense hence m p r e l produces relatively small rme values in examples 1 and 2 although m c o m b and m s i m p alternate on the best performance based on the rme values m c o m b is more robust than m s i m p over all the scenarios because the accuracy of m c o m b implies the effectiveness of the new vapor transfer model the good performance of the vapor transfer model is confirmed executing m c o m b requires solving two differential equation systems eq 1 for m p r e l and eq 3 for vapor transfer therefore the computing load of m c o m b is larger than that for the other models in this study however such a drawback in computing load can be ameliorated by including parallel linear solvers such as the oneapi math kernel library and the pardiso solver intel inc used in 2dsoil 3 implementation of the vapor transfer model in 2dsoil 3 1 implementation of the vapor transfer model numerical implementation of the new vapor transfer model eqs 3 and 4 in 2dsoil is presented in this section the vapor transfer model is incorporated into the 2dsoil and placed after the water and heat transfer modules to satisfy the m c o m b model formulation 2dsoil performs 2d numerical simulations based on a pre generated triangular finite element grid soil water heat and chemical transfer are programs with separate modules but solved on the same finite element grid therefore following the existing water and heat transfer modules numerical solutions of the vapor transfer model can be obtained on the same grid the performance of m c o m b as well as the vapor transfer model used in m c o m b have been validated in section 2 3 so the main goal of section 3 is to implement m c o m b in 2dsoil without strict comparisons with m f u l l another reason for omitting the strict comparisons is that were m f u l l and m s i m p implemented in 2dsoil the modularized architecture in 2dsoil will be lost and dataflow pathways will be substantially changed hence the resulting simulator will operate much differently compared to the original 2dsoil therefore a directly comparison that including m f u l l and m s i m p under the 2dsoil framework cannot be applied for numerical schemes the vapor transfer equation eq 3a can be treated as a diffusive equation and solved by a standard finite element method that is because the vapor advection as well as the liquid islands effects that assist vapor transfer can be included in the diffusive coefficient d tv via a vapor enhancement factor cass et al 1984 however the heat transfer equation eq 3b is a conduction convective equation and should be solved with a conservative numerical scheme one simple way to establish a conservative scheme is to use the temperature from the upwind direction of the vapor flux on the right hand side of eq 3b the upwind temperature t up can be determined for each triangular element in the 2dsoil finite element grid for example consider an element that stays in the horizontal plane under the given coordinates in fig 3 first calculate the vapor flux q v d mv h t h d tv h t t where the water potential gradient h and temperature gradient t are obtained by linear interpolations based on the water potential and temperature values at the grid nodes a b and c then we analyze the vapor flux direction with respect to the three nodes for node a if the triple products z k q v 0 and z q v j 0 i e the upper diagram in fig 3 a uniform vapor flux from node a to edge bc can be assumed to lie within the element and are demarcated by the two dotted red lines since a locates in the upstream direction of the vapor flux the upwind temperature can be approximated by the temperature at a i e t up t a if the triple products z k q v 0 and z q v j 0 i e the lower diagram in fig 3 a uniform vapor flux will occur from edge bc to node a and the upwind temperature is a weighted average of the temperature at b and c i e t up b t c c t b b c where b and c are distances from b and c to q v respectively similar procedures can be performed for nodes b and c to exhaust all the possible directions of the vapor fluxes if the triple product is equal to 0 then the vapor flux is parallel to one of the edges and the determination of the upwind temperature coincides with the method used in 1d upwind schemes substituting the temperature on the right hand side of eq 3b by the upwind temperature t up eq 3b can be discretized with the standard finite element method the diagram in fig 4 presents the position of the vapor transfer model in 2dsoil and indicates how m p r e l and m c o m b are defined in 2dsoil m f u l l and m s i m p are also presented fig 4 indicates that the combination of the liquid water transfer model the heat transfer model and the new vapor transfer model in 2dsoil i e m c o m b performs a function equivalent to m f u l l and m s i m p fig 4 also emphasizes the order of solving liquid water transfer heat transfer and vapor transfer within a given discretized time step δ t for m c o m b in 2dsoil the dataflow pathways among the existing liquid water transfer module heat transfer module and other modules are maintained no additional pathway is added after involving the vapor transfer model hence the modularized architecture in 2dsoil model is retained 3 2 an illustrative example of model applications because the effectiveness of the vapor transfer model and the accuracy of m c o m b have been demonstrated in section 2 3 in this section we provide an example to illustrate the simulation results of 2dsoil with the new vapor transfer model i e m c o m b and without the vapor transfer model i e m p r e l recall that m f u l l and m s i m p cannot be easily supported based on the 2dsoil framework thus we only focus on m p r e l and m c o m b a 60 cm wide and 150 cm deep soil profile is considered with the physical properties presented in table 4 to provide spatial variations in soil water and temperature a ridge is formed on the left 30 cm of the soil surface the ridge has a 15 cm height and the surface topography follows a cosine curve covered by a plastic film the ridge surface becomes impermeable to water flux but not to heat flux the right 30 cm of the soil surface is flat and bare during rainfall events 94 of the precipitation received on the ridge becomes surface runoff flows rightwards along the ridge surface and infiltrates through the bare soil surface this configuration is also referred to as the ridge furrow water harvesting rfwh which is designed to conserve water in relatively deep soil layers wang et al 2015 zhao et al 2018 wang et al 2020 wang et al 2021a uniform initial water content 0 12 c m 3 c m 3 and temperature 10 c are assumed in the soil profile and the simulation is run for a 40 day period doy 100 140 in 2017 to allow the soil profile to fully adapt to the ambient weather conditions the water content and temperature distributions at 12 00p m mid day and 12 00 a m mid night on the final simulation day doy 140 in 2017 are recorded and presented in fig 5 the differences in soil temperature between mid day fig 5e and f and mid night fig 5g and h can be observed during the daytime fig 5e and f the soil surface receives radiation and achieves the highest temperature values the temperature contours are nearly parallel to the soil surface corresponding to an upwards temperature gradient during the nighttime fig 5g and h the soil surface loses heat due to the plastic cover and the additional soil volume for the ridge an area with relatively high temperature t 22 c contour can be observed in the ridge the benefit of including the vapor transfer model can be shown by comparing fig 5e and g with fig 5f and h the vapor flux carries sensible and latent heat flux from the soil surface to subsurface layers and increases the subsurface temperature therefore the t 12 c contour in fig 5e with vapor flux is deeper than the t 12 c contour in fig 5f no vapor flux and the t 12 c and t 13 c contours in fig 5g with vapor flux are deeper than those in fig 5h no vapor flux the effects of vapor transfer on soil water distribution can be observed by comparing fig 5a and c and fig 5b and d with the vapor transfer model invoked during the daytime fig 5a the temperature gradient near the soil surface is relatively large and the soil under the ridge has higher temperature than the soil under the flat surface therefore temperature gradients drive vapor flux from the ridged portion to the flat portion and lead to a small bend of the θ 0 20 c m 3 c m 3 contour in fig 5a near the ridge surface marked with as well as a shrinkage of the θ 0 22 c m 3 c m 3 contour in fig 5a with vapor flux comparing to the θ 0 20 c m 3 c m 3 and θ 0 22 c m 3 c m 3 contours in fig 5b no vapor flux in another words the water vapor is pushed from the ridged portion to the flat portion of the soil profile due to the soil temperature gradient during the nighttime with the vapor transfer considered fig 5c the highest temperature occurs near the t 22 c contour see the position of t 22 c contour in fig 5g so the small bend of the θ 0 20 c m 3 c m 3 contour moves from the soil surface in fig 5a to a location in fig 5c marked as corresponding to the frontiers of the t 22 c and t 21 c contours in fig 5g see the differences of θ 0 20 c m 3 c m 3 contours in fig 5a and c for the changes of the contour shape and position however without considering vapor transfer fig 5b and d neither the small bends of the θ 0 20 c m 3 c m 3 contour or its position changes nor does the shrinkage the decrease of internal area of the θ 0 22 c m 3 c m 3 contour occur see the differences of the θ 0 22 c m 3 c m 3 contours between fig 5a and c and fig 5b and d for the area enclosed within the contours without vapor transfer the water transfer will only depend on the water potential distributions and have very limited response to the diurnal temperature changes hence the water distributions in fig 5b and d are nearly identical therefore the differences between m p r e l and m c o m b in simulating soil water distribution as well as the effects of the new vapor transfer model are illustrated 4 summary in this study we design a numerical process to model the vapor flux and include vapor transfer effects on soil water and temperature simulations when the liquid water transfer and heat transfer in soil are already considered with the new vapor transfer model simulations of liquid water heat and vapor transfer in soil can be implemented as separate modules and solved one by one within a single discretized time step the efficacy of the vapor transfer model as well as the accuracy and stability of the coupled soil water and temperature simulations with the new vapor transfer model are established via numerical experiments the rme values of soil water content and temperature are 0 005 relative to the standard philip and de vries 1957 model an advantage of using the new vapor transfer model is that for a modularized soil simulator where water and heat transfer modules exist but vapor transfer is not included the vapor transfer can be easily added with minimal modifications to the existing modules or the dataflow pathways the model formulation using the new vapor transfer model i e m c o m b has a simple and flexible structure compared to the fully coupled formulation i e m f u l l and achieves stable simulation performance for most of the examples presented in this study in this study we implemented the vapor flow model in 2dsoil and a numerical example is presented to illustrate the effects of vapor transfer on 2d soil water and temperature regimes in conclusion the vapor transfer model proposed in this study provides an effective and easy to use method to include vapor flux in soil water and heat transfer simulations this study focuses on a new way to include vapor transfer into the soil water and heat simulations and related applications such as the vapor flux effects on chemical transfer and root growth can be directions for future studies because adding the vapor transfer module leads to an increase in the computing load the use of high performance computing e g parallel computing or gpu computing within personal computers in soil water heat and vapor transfer simulations is also encouraged and can be another possible direction for future research credit authorship contribution statement zhuangji wang conceptualization formal analysis methodology software writing original draft dennis timlin conceptualization formal analysis methodology software writing review editing supervision david fleisher conceptualization supervision writing review editing wenguang sun methodology software writing review editing sahila beegum methodology software writing review editing sanai li methodology software writing review editing yan chen conceptualization supervision writing review editing vangimalla r reddy conceptualization supervision writing review editing katherine tully conceptualization supervision writing review editing robert horton conceptualization supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this material is based upon work supported by the department of agriculture agricultural research service under agreement no 58 8042 7 067 national science foundation under grant 2037504 and usda nifa multi state project 4188 the authors also received support from the university of maryland college park university of nebraska lincoln and iowa state university appendix a the liquid water diffusion coefficient under temperature gradient d tl h t is used in model formulations m f u l l and m s i m p in this study we ignored d tl h t in m c o m b based on the assumption that d tl h t d tv h t therefore it is worth discussing that the formulation of d tl h t d tl h t is namely treated as a diffusion coefficient based on the mathematical formulations of the partial differential equation models however physically it should be considered as a phenomenological coefficient depending on the soil type e souza and nogueira 2020 groenevelt and kay 1974 and milly 1982 proposed that liquid water transfer under temperature gradient was based on the variations of water soil adhesion with respect to temperature and modeled it using thermal osmosis and water surface tension which was further simplified by noborio et al 1996 in this study we apply additional simplifications to the model for coupled water and heat simulations suppose the water surface tension σ n c m 1 is a1 σ 7 275 10 4 1 0 002 t 291 we artificially add a negative sign in front of the leading coefficient that is because we assumed the soil is hydrophilic so the negative sign indicates the suction from the soil capillary pores to liquid water i e the strength of water tied to the capillary pores then the temperature induced water potential change can be expressed as a2 δ h δ σ t s a s ρ l g s δ σ t s a ρ l g s a ρ l g σ t t δ t in eq a2 s a c m 2 c m 3 is the volumetric specific surface area of soil and s c m 2 is the area of a given cross sectional surface therefore s a s can be considered approximately as the perimeter of a liquid water film at the given cross sectional surface which is the simplification we proposed then applying eq a2 in darcy s law we have a3 q l k h t h k h t g a s a ρ l g σ t t d tl h t t in eq a3 g a is an empirical gain factor with values ranging from 4 to 8 in general noborio et al 1996 because increasing the temperature can reduce the water soil adhesion and increase the mobility of liquid water the liquid water flux occurs from the regions with relatively high temperature to the regions with relatively low temperature following the expression of d tl h t in eq a3 d tl h t k h t has an order of 10 2 which is of the same scale proposed by prunty 2009 lu et al 2020 studied the transient soil water fluxes under a temperature gradient using a dual probe heat pulse method with uniform initial soil water content and temperature lu et al 2020 reported that under a range of initial soil water content and temperature the liquid water transfer under temperature gradient is negligible which provides additional evidence for the validity of our assumption that ignoring d tl h t in appendix a we presented a simplified approach to compute d tl h t however the model formulations in m f u l l and m s i m p as well as the general theory and numerical method proposed in this study are independent of the detailed empirical or physical expressions for d tl h t appendix b in this appendix we provide a tabular summary for the governing equations corresponding to the model formulations i e m p r e l m c o m b m s i m p and m f u l l mentioned in this study we note that the philip and de vries 1957 model serves as the foundation for all the formulations expect for m p r e l which uses a simpler governing equation system however due to the designs of the model formulations the governing equations that appear in m c o m b m s i m p and m f u l l may be different from the original fully coupled version of philip and de vries 1957 model table b1 core ideas 1 a vapor transfer model is designed and applied for soil water and heat simulations 2 model performance is evaluated by its effects on coupled soil water and heat transfer 3 the vapor transfer model is programed as a separate module in 2dsoil 4 2dsoil performs reasonable simulations with the vapor transfer model declaration 1 the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 2 this paper does not constitute a standard specification regulation or recommendation for the numerical models and field management techniques 3 the computer code of the models included in this paper as well as the input files of the illustrative examples are released with the latest version of maizsim at https github com ars csgcl dt update recursively a stationary executable version of the compute code is also available at https github com cauwzj 
3454,the present study utilizes a moving particle simulation mps method to solve cross sectional averaged shallow water equations applicable for non prismatic open channels the well known maccormack predictor corrector scheme is extended to the lagrangian framework ensuring the second accuracy in time and space for this purpose upwind and downwind mps gradient operators are introduced the total variation diminishing tvd flux limiter scheme is developed to the mps formulation to preserve monotonicity which does not require characteristic speeds of the system in mesh based methods the non conservative form of the momentum equation is problematic in scenarios with discontinuities however the non conservative convective flux term does not exist under the lagrangian framework in preserving the momentum conservation moreover the cross sectional area is computed by the algebraic density ratio equation in the present work since the mass is automatically conserved this advantage is beneficial for open boundary treatment resulting in less computational effort than mesh based methods because the partial differential continuity equation is omitted as a boundary value problem the present high order solver has positivity preserving and well balancing properties without the need for any threshold value for treating the dry bed and friction term additionally it can model free surface flows in prismatic and non prismatic open channels with various open and or closed boundary conditions keywords lagrangian framework second order accuracy well balancing positivity preserving open boundary non prismatic open channel 1 introduction in hydraulic and environmental engineering free surface flows are naturally shallow and unidirectional in many cases these attributes make it feasible to average the three dimensional conservation laws over the cross sectional area to derive the so called de saint venant 1871 equations for simulating free surface unsteady flows in open channels cunge et al 1980 moreover an empirical relationship such as the chezy or manning stands for the energy dissipation yen 1973 the cross sectional averaged shallow water equations swes can then be used to couple systems in studying sediment transport saleh et al 2013 water quality modeling wang et al 2018 and free surface seepage flows sarkhosh et al 2021 the nonlinearity of the convective flux term must be adequately treated to satisfy the conservation laws and remove the numerical oscillation in problems with discontinuous initial conditions and steep gradients cunge et al 1980 toro 2001 in such cases shock capturing schemes are required to achieve an oscillation free numerical scheme leveque 2002 toro 2001 classical first order mesh based methods such as lax friedrich 1954 and godunov upwind 1959 can capture shock at discontinuous solutions using an artificial viscosity and riemann solver respectively furthermore second order godunov type schemes have been developed to decrease the magnitude of numerical diffusion toro 2013 alternatively there are second order mesh based schemes without resorting to the riemann solvers such as lax and wendroff 1960 and maccormack 1969 predictor corrector schemes overall second order schemes are not monotone so that gibbs like oscillations an overshoot appearing at discontinuous domains may still be observed castro orgaz and hager 2019 the traditional method to suppress the gibbs phenomenon is using the artificial viscosity however it does not produce universal results since the viscosity coefficient is case dependent cantero chinchilla et al 2016 furthermore it is often imposed excessively generating smeared results in regions of high gradients leveque 2002 the total variation diminishing tvd method can be utilized as a higher order and monotonicity preserving technique hirsch 1990 garcía navarro et al 1992 pioneered the tvd maccormack scheme by adding a dissipation step computed from the characteristic information liang et al 2006 introduced a tvd maccormack scheme based on the flux limiter method which is free of calculating eigenvalues and eigenvectors while preserving the second order accuracy the modified tvd maccormack scheme has been successfully employed in coupling systems for modeling sediment transport kalita 2020 solute transport liang et al 2010 free surface seepage flow under darcy liang et al 2007a and non darcy kumar and pahar 2020 flow regimes an alternative to eulerian shock capturing schemes mesh free or particle methods have become popular to solve swes in the last two decades one of the pioneering mesh free methods is smoothed particle hydrodynamics sph initially introduced for solving navier stokes equations nses gingold and monaghan 1977 monaghan 1992 the capability of sph to solve swes has been documented for dam break problems chang et al 2011 rapid flows with irregular geometry kao and chang 2012 vacondio et al 2012a flows with open boundaries chang and chang 2013 vacondio et al 2012b weakly non hydrostatic shallow water flows chang et al 2014 spatially varied flows chang et al 2016 debris flows vagnon et al 2019 coupled with advection diffusion equation chang et al 2017 and hybrid swe nse model ni et al 2020 notably they are sph models with hydrostatically well balanced bed slope and pressure flux terms rossi et al 2017 xia et al 2013 chang et al 2021 the moving particle simulation mps is another well known mesh free method pioneered by koshizuka and oka 1996 for modeling free surface incompressible flows the main difference between sph and mps arises from different differential operators mps was extended for simulating turbulence fluctuations gotoh et al 2001 weakly compressible flows shakibaeinia and jin 2009 flow through and over porous media fu and jin 2018 khayyer et al 2018 xu and jin 2019 fluid structure interactions khayyer et al 2021 khayyer et al 2019 khayyer et al 2020 sediment transport fu and jin 2016 harada et al 2019 nodoushan and shakibaeinia 2019 granular flows ke et al 2020 rufai et al 2019 xu and jin 2021 waves generated by landslides fu and jin 2015 guo and jin 2018 li et al 2020 and ice wave dynamics junior et al 2021 sarkhosh and jin 2021 developed a well balanced mps based model to solve one dimensional swes in prismatic open channels with closed boundaries they also derived a calibration free formula referred to as the density ratio equation for computing the cross sectional area the advantages of mesh free swes models can be summarized as follows i integral solutions of swes should be adopted to catch discontinuous solutions cunge et al 1980 both sph and mps methods transfer partial differential equations pdes to integral forms ii the mass is automatically conserved since the particles move with the flow hence the volume summation formula or density ratio equation computes the cross sectional area without the need for solving the partial differential continuity equation iii the nonlinear convective term is eliminated wang and shen 1999 iv there is no need to consider any threshold value for treating the dry bed and friction term chang et al 2016 vacondio et al 2012a v a lower order accurate scheme is required to solve dispersive swe models as compared to the mesh based methods chang et al 2014 despite the benefits described above the kernel function in particle methods is symmetric and cannot produce interparticle repulsive forces khayyer and gotoh 2013 thus numerical treatments including stabilization technique upwinding kernel or riemann solver are required artificial viscosity is the traditional stabilization technique introduced by monaghan 1985 using a fixing parameter ata and soulaïmani 2005 developed a calibration free and less diffusive stabilization technique by improving the typical artificial viscosity later was extended to non prismatic channels by chang and chang 2013 chang et al 2018 used a corrective matrix to fulfill first order consistency in the two dimensional sph swe sarkhosh and jin 2021 developed a case independent stabilization technique based on inelastic collision with unequal masses to ensure first order consistency regarding the kernel treatment chang et al 2017 developed an upwinding kernel function for cross sectional averaged shallow water flows additionally riemann solver based sph swe schemes exist with no excessive numerical dissipation due to intrinsic artificial viscosity rossi et al 2017 vacondio et al 2012a xia et al 2013 the main objective of this study is to introduce a well balanced and positivity preserving mps model with second order accuracy for solving cross sectional averaged swes applicable for non prismatic open channels the popular maccormack predictor corrector is extended to a lagrangian framework without the need for the riemann solvers applied in the previous higher order mesh free swe models the tvd flux limiter method pioneered by liang et al 2006 is applied to the mps integration to remove typical spurious oscillations that occur in high order schemes moreover open boundaries are included in the present model with various flow regimes including subcritical supercritical and transcritical with less computational effort than mesh based methods since only one pde as a boundary value problem exists the present shock capturing solver is then validated using various inviscid and frictional flows hydraulic jump irregular bottom topography prismatic and non prismatic open channels measuring parshall and khafagi flumes and a compound channel with heterogeneous roughness 2 materials and methods 2 1 governing equations saint venant equations incorporate continuity and momentum equations assuming that the flow is unidirectional with its cross sectional averaged velocity the pressure has a hydrostatic distribution and the manning formula represents the resistance force the governing equations for a non prismatic channel are rewritten in the lagrangian forms casulli and stelling 2013 chow 1959 1 da dt a u x 2 du dt g h z x g s f where d dt stands for the total derivative t u x u is the flow velocity m s a the cross sectional area m2 h the water depth m z the bed elevation m g the gravitational acceleration m s2 x m and t s are spatial and temporal independent variables respectively h h z is expressed as the free surface elevation m castro orgaz and hager 2019 sf is the friction slope calculated from the manning formula 3 s f u u n m 2 r h 4 3 where nm is the manning coefficient m 1 3 s rh a p the hydraulic radius m and p the wetted perimeter m the hyperbolic system of eqs 1 and 2 is closed by a relationship between the cross sectional area a and the water depth h as shown in fig 1 the water depth is obtained from a polynomial equation for a trapezoidal shaped cross sectional area i e a x t b x mh x t h x t since the natural channel s cross section can be approximated by a trapezoid chow 1959 notably the mass conservation is automatically satisfied in mesh free methods independent of the solution domain that is smooth or discontinuous accordingly an algebraic formula is utilized to calculate the cross sectional area instead of the continuity equation as described in the following section in the eulerian system eq 2 is recognized as the non conservative form or simply the u type of the momentum equation chaudhry 2008 this name comes from the non conservative product of the convective term considering the expansion of the total derivative which is problematic to satisfy the so called telescopic property pirozzoli 2010 reiss and sesterhenn 2014 and necessitates special treatment casulli and stelling 2013 in contrast the u type of the momentum equation is free from the nonlinear convective term under the lagrangian framework satisfying the conservativeness 2 2 numerical discretization the subsequent sections first present the mps formulation for the spatial integration of cross sectional averaged swes afterward the time discretization is described based on the tvd maccormack predictor corrector finally the initial and boundary conditions are explained where the inflow and outflow boundary treatments corresponding to various flow regimes are introduced 2 2 1 spatial integration using mps formulation in mps pdes are spatially integrated using a weighted average kernel function over a support domain the interaction of each particle referred to as the target particle with its neighboring particle is tracked inside the support domain with a searching radius re koshizuka et al 2018 the searching radius is calculated using the following relationship in meshfree modeling of cross sectional averaged swes chang and chang 2013 4 r e i r e i 0 a i 0 a i where re is the searching radius subscript i and superscript 0 refer to the target particle and initial time respectively the cross sectional area is obtained from the density ratio equation proposed by sarkhosh and jin 2021 as follows 5 a i a i 0 n 0 n i where n is the particle number density which is a function of the searching radius and particle s distance for one dimensional shallow water flows 6 n i j i n w x ij r e i where w is the kernel function subscript j represents the neighboring particles and x ij x j x i since the cross sectional area is a function of the searching radius and vice versa the popular newton raphson iteration is employed in mesh free swes models chang and chang 2013 vacondio et al 2012a the residual of the cross sectional area at the r th iteration will be 7 res i r a i r a i 0 n 0 j i n w x ij r e i r where res stands for the residual the cross sectional area at the new iteration is computed as 8 a i r 1 a i r res i r d res da i r the derivative of the residual in the denominator on the right hand side of eq 8 is calculated as 9 d res da i r 1 a i 0 n 0 j i n d w ij r dr e i r dr e i r d a i r the iteration is processed until the stopping criterion is fulfilled which is 10 res i r a i r ε where ε is the stopping threshold equal to 10 7 and 10 15 for single and double precisions in this study the spiky type kernel function is utilized fredini and limache 2013 sarkhosh and jin 2021 11 w x ij r e i 1 8 r e i 2 x ij r e i 3 if 0 x ij r e i 2 0 if x ij r e i 2 it is worth noting that 1 8rei is the normalization factor to satisfy the unity condition in a one dimensional setting for the spatial integration one dimensional mps divergence and gradient operators are adopted in the following forms respectively koshizuka et al 2018 12 div u i 1 n i j i n u j u i x ij 2 x j x i w x ij r e i 13 f x i 1 n i j i n f j f i x ij 2 x j x i w x ij r e i where f is a scaler and f i is defined as the minimum value among the target and neighboring particles in the support domain to ensure inter particle repulsive forces in the gradient operator koshizuka et al 1998 sarkhosh and jin 2021 reported that the above gradient operator is still unable to preserve the linear momentum conservation at discontinuities and steep gradients in mps modeling of 1d swes to resolve the linear momentum conservation the authors modified the free surface elevation gradient by a case independent stabilizing technique inspired by dynamic stabilization ds developed by tsuruta et al 2013 given as 14 h x i satabilized h x i f ij ds i f ij ds u ij ds g δ t u ij ds 0 0 u ij ds 0 u ij ds u i a i u i n i a j u j n j a i n i a j n j x j x i x j x i where f ij ds is a non dimensional term representing the dynamic stabilizing force imposed from neighboring particles on the target particle herein f ij ds is integrated over a support domain using a scatter interpretation of the mps summation hernquist and katz 1989 since neighboring particles play the dominant role in the dynamic stabilizing force thus stabilized gradient operator is given as 15 h x i 1 n i j i n h j h i x ij 2 x j x i w x ij r e i j i n f ij ds n j w x ij r e i where u ij ds is the dynamic stabilizing velocity after inelastic collision with unequal masses 2 2 2 treatment of the bed topography source term the numerical discretization of the bed topography source term is problematic in the fractional step schemes leveque 1998 accordingly it is recommended to merge the water depth with the bed elevation forming the free surface elevation to preserve hydrostatic well balancing property castro orgaz and hager 2019 liang and borthwick 2009 liang and marche 2009 the free surface elevation can be regarded as the source term or pressure flux term although they are mathematically equivalent the second approach is utilized in this study synergistically with the physical point of view so that the source term equates to zero with the neglection of the bed and friction slopes liang et al 2006 sarkhosh and jin 2021 in contrast the source term has a non zero value in the second method despite considering bed elevation and friction equal to zero the momentum equation as the only pde in this study is therefore expressed in the following 16 de dt f x s where e u is the unknown variable f gh the flux term and s gsf the source term 2 2 3 temporal discretization using tvd maccormack predictor corrector in mesh based methods the maccormack method consists of downwind and upwind schemes for discretizing the flux term employed in predictor and corrector steps respectively 17 predictor step e i p e i k δ t δ x f i 1 k f i k s i k δ t corrector step e i c e i p δ t δ x f i p f i 1 p s i p δ t e i k 1 e i p e i c 2 where k and k 1 refer to previous and present time levels p the predictor step and c the corrector step using the mps stabilized gradient operator eq 17 is transferred into the mps integration as 18 predictor step e i p e i k δ t f x r k s i k δ t corrector step e i c e i p δ t f x l p s i p δ t e i k 1 e i p e i c 2 where r and l stand for downwind and upwind schemes respectively the interaction of the target particle with downstream neighboring particles j i representing the downwind scheme is considered at the prediction step fig 2 in contrast adjacent particles upstream of the target particle j i constitute the upwind scheme adopted at the corrector stage the mps formulation of cross sectional averaged swes using the maccormack predictor and corrector steps is summarized in table 1 the downwind and upwind free surface elevation gradients in table 1 are obtained from eqs 19 and 20 respectively 19 h x r 1 n r j i n h j h i x ij 2 x j x i w x ij r e i f ij ds i 20 h x l 1 n l j i n h i h j x ij 2 x i x j w x ij r e i f ij ds i where n r and n l refers to the downwind and upwind particle number density calculated from eq 6 considering j i and j i respectively the maccormack predictor corrector scheme is second order accurate in time and space and is not oscillation free in zones with steep gradients and discontinuities thus the tvd flux limiter developed by liang et al 2006 is adopted for preserving the monotonicity as the third step 21 u i k 1 u i p u i c 2 t v d i where tvdi is calculated in the following 22 tv d i g r i g r r δ u r k g r i g r l δ u l k where δ u r k and δ u l k are the downwind and upwind velocity variations calculated as follows δ u r k 1 n r k j i n u j k u i k w x ij k r e i k 23 δ u l k 1 n l k j i n u i k u j k w x ij k r e i k other terms of eq 22 are expressed in the following 24 r i δ u l k δ u r k δ u r k δ u r k r i δ u l k δ u r k δ u l k δ u l k g r r 1 n r k j i n g r j w x ij k r e i k 25 g r l 1 n l k j i n g r j w x ij k r e i k the function g is defined as 26 g x 0 5 c 1 ϕ x where ϕ x is the flux limiter function 27 ϕ x max 0 min 2 x 1 where x is the variable of the flux limiter function moreover c in eq 26 is calculated with respect to the courant cr number 28 c cr 1 c r if c r 0 5 0 25 if c r 0 5 since the present solver is an explicit scheme the time step should be computed as a function of cr as follows 29 δ t c r min δ l i c i u i 0 c r 1 where δ l i is the particle length this study sets cr 0 7 to satisfy the courant friedrichs lewy stability condition 2 3 initial and boundary conditions 2 3 1 initial conditions the solution of saint venant equations is distinguished as the initial boundary value problem sarkhosh et al 2020 for this purpose the initial cross sectional area a x 0 and flow velocity u x 0 are established throughout the solution domain at the beginning of the computations moreover the initial searching radius re 0 is a function of the initial particle size dl defined as re 0 αdl where α is the searching radius parameter in mesh free modeling of swes α varies between 1 2 and 1 4 chang et al 2018 chang and chang 2013 ni et al 2016 α 1 4 is applied in the present study 2 3 2 boundary conditions wall boundary treatment the zero gradient neumann boundary condition is imposed using several pre defined ghost particles at wall boundaries in the mps koshizuka et al 2018 first the pressure value and free surface elevation from the adjacent water particle are assigned to the closest ghost particle referred to as the wall particle in the mps modeling of nses and swes respectively koshizuka et al 2018 sarkhosh and jin 2021 afterward this value is given to other ghost particles to obtain the zero gradient boundary condition inflow outflow boundary condition in a supercritical flow regime two boundary conditions should be imposed at the upstream boundary while it is unnecessary to define any condition at the downstream section castro orgaz and hager 2019 on the other hand one flow property is imposed for treating the subcritical boundary condition while the second flow property is obtained from riemann invariants castro orgaz and hager 2019 vacondio et al 2012b characteristics invariants anastasiou and chan 1997 fujihara and borthwick 2000 or the method of specified intervals chang et al 2018 chaudhry 2008 in explicit swes models notably there is no need to consider any supplementary equation for treating subcritical boundary conditions in the present solver since the partial differential continuity equation as a boundary value problem is transferred to an algebraic formula for the cross sectional area computation in this study four sets of inflow and outflow boundaries forming various flow regimes in the entire domain are defined as follows subcritical inflow and subcritical outflow boundaries the velocity is imposed upstream and the cross sectional area is defined downstream subcritical inflow and supercritical outflow boundaries the velocity is only imposed upstream supercritical inflow and supercritical outflow boundaries the velocity and cross sectional area are prescribed upstream supercritical inflow and subcritical outflow boundaries the velocity and cross sectional area are defined upstream and the cross sectional area is imposed downstream two buffer zones representing inflow and outflow zones are defined just outside the solution domain similar to works conducted by vacondio et al 2012b and chang et al 2021 as shown in fig 3 the outflow buffer zone 2 re varies based on the flow condition to ensure the particle deficiency in the proximity of the outflow region does not affect the calculation of the flow properties unlike the inflow boundary in which the buffer zone s size is fixed 2 dl the particle recycling strategy originated from shakibaeinia and jin 2009 is adopted from a computational efficiency standpoint without a large number of particles in this respect the physical properties are removed from the particles leaving the solution domain on the other hand physical properties proportional to the inflow boundary condition are added to the particles when entering the solution domain 3 results and discussion in this section a series of extensive numerical simulations are conducted to validate the proposed solver the model is initially applied to investigate the order of accuracy tvd performance well balancing property and positivity preserving properties subsequently the solver is applied to various prismatic and non prismatic open channels with closed and or open boundary conditions 3 1 order of accuracy there are several analytical solutions for one dimensional swes in the literature but the solutions have yet to be recognized as generic test cases for accuracy xing and shu 2006 2005 due to these shortcomings the numerical accuracy test proposed by qian et al 2018 is applied to determine the suitability of the model for non prismatic channels in this regard the bed topography and cross section are defined as follows 30 z x sin 2 π x b x e sin 2 π x m 0 where b x is the channel width at the bottom and m the side slope as represented in fig 1 the initial conditions are given by 31 a x 0 3 e cos 2 π x b x u x 0 sin cos 2 π x a x 0 x 0 1 using a periodic boundary condition i e an infinite solution domain the test runs up to t 0 1 s since there is no exact solution for this case n 12800 particles is applied as a reference solution where n refers to the number of particles fig 4 illustrates the results of the accuracy test for computed free surface elevation h and discharge q ua using the various number of particles furthermore the l 1 error norms calculated from eqs 32 and 33 and the convergence rates are listed in table 2 32 l 1 h 1 n i 1 n h i mps h i ext h i ext l 1 u 1 n i 1 n u i mps u i ext g h i ext l 1 q 1 n i 1 n q i mps q i ext a i ext g h i ext 33 l h max i 1 n h i mps h i ext h i ext l u max i 1 n u i mps u i ext g h i ext l q max i 1 n q i mps q i ext a i ext g h i ext 3 2 tvd performance to examine the tvd performance an inviscid dam break problem over a wet bed is adopted with the channel length l 9 m upstream water depth h 0 0 25 m downstream water depth hdown 0 1 m channel width b x 1 m constant and no side slope i e m 0 the gate is placed at x 4 65 m and removed immediately the results of the 1d mps swe using 1st order maccormack tvd maccormack schemes are compared to the analytical solutions stoker 1957 as shown in fig 5 the solution experiences the gibbs phenomenon neighboring the shocks in the absence of the tvd method moreover the wavefront and rarefaction wave are more diffusive in the 1st order accurate model the errors of the 1st order and tvd maccormack schemes of the 1d mps swe solver for three particle numbers are summarized in table 3 using eqs 32 and 33 describing that the error decreases with increasing n the tvd maccormack scheme of the 1d mps swe solver demonstrates better agreement with the analytical solution 3 3 lake at rest in the case of no velocity the free surface elevation remains unchanged compared to the initial condition in a well balanced numerical scheme the lake at rest problem in non prismatic channels has been widely adopted balbás and karni 2009 qian et al 2018 in this regard the bottom topography in the domain 0 1 is defined as 34 z x 0 25 1 cos 10 π x 0 5 if 0 4 x 0 6 0 otherwise the cross section is given by 35 b x 1 b 0 1 cos 2 π x x l x r 2 x r x l if x l x x r 1 otherwise m 0 where 1 2b 0 refers to the minimum value of the channel width at xl xr 2 xl and xr are the left and right contraction boundaries in this case b 0 0 2 xl 0 25 and xr 0 75 m the initial condition is defined as 36 a x 0 1 z x b x u x 0 0 the result of the present model for the lake at rest problem at t 0 5 s is shown in fig 6 the l 1 and l error norms are listed in table 4 with consideration of single and double machine precisions the results show that the flow remains static which represents that the model satisfies the well balancing property 3 4 small perturbation considering the numerical simulation from case 3 3 the flow shifts to a quasi steady state condition when a pulse perturbates the steady state known as leveque s 1998 problem leveq s test is completed using the 1st and 2nd order 1d mps swe two experiments are conducted with varying bed topography and cross section defined in eqs 34 and 35 using b 0 0 2 xl 0 15 xr 0 65 m and b 0 0 2 xl 0 35 xr 0 85 m respectively the initial condition is 37 a x 0 1 01 z x b x if 0 1 x 0 2 1 z x b x otherwise u x 0 0 also the periodic boundary condition is adopted fig 7 illustrates the model results using dl 0 002 m compared to the third order discontinuous galerkin solver introduced by qian et al 2018 using δx 0 0005 m as the reference the results show no numerical oscillation subjected to irregular bed topography since the present model is well balanced as well the 1st order model is more diffusive than the 2nd order particularly at t 0 15 and 0 25 s 3 5 reservoir drainage on a non flat bottom for the positivity preserving test reservoir drainage over a non flat bottom is tested in the solver for this purpose a non prismatic channel is considered with the following bed topography and cross section 38 z x 0 48 0 12 x 4 2 if 2 x 6 0 2 0 2 x 8 2 if 7 x 9 0 otherwise 39 b x 0 6 0 025 x 2 2 if 1 x 9 1 otherwise m 0 the initial condition is given by 40 a x 0 0 4801 z x b x if x 8 5 0 otherwise u x 0 0 a zero gradient and free outflow boundary conditions are adopted upstream and downstream respectively using n 200 the present model results are compared to the 2nd order finite volume solver introduced by liu 2020 the reservoir is drained up to it reaches a static state at t 500 s with good agreement with the reference fig 8 additionally water particles are absent at dry zones in the present solver at t 0 0 4 500 s as one of the mesh free swe models features is suitable for flood prediction in general the cross sectional area has no negative value meaning that the present solver satisfies the positivity preserving property 3 6 dam break in a triangular prismatic channel an inviscid dam break problem in a triangular prismatic channel is conducted and compared with the analytical solution proposed by henderson 1966 in this simulation a triangular channel is adopted with 1000 m length b x 0 as there is no base in a triangle m 1 h 0 1 m and downstream dry bed a gate bisects the channel and is removed immediately one of the advantages of mesh free swe models is that there is no need to consider any threshold value representing the dry bed since there is no particle downstream of the gate the present model reveals good agreement with the analytical solution as depicted in fig 9 using n 500 particles 3 7 dam break in a non prismatic channel kocaman et al 2020 conducted extensive experiments to model frictional dam break problems in an open channel with an abrupt cross section variation to study the effect of shock from the channel contraction on the flow behavior wave reflection wave propagation and the development of hydraulic jump fig 10 illustrates the experimental setup along with the parameters it consists of an 8 9 m long flume with an open boundary downstream a trapezoidal shaped contraction a reservoir upstream with the water depth h 0 0 25 m and a length equal to 4 65 m controlled by a gate the flume has no side slope i e m 0 the flood wave propagates downstream as the gate is released immediately at x h 0 0 and t 0 the parameters n 1000 and nm 0 0075 m 1 3 s is applied in the present model and is used to compare to the experimental data and also a 2d 2nd order finite volume swe fvm swe model kocaman et al 2020 using dimensionless water surface profiles at different dimensionless time steps t t g h 0 0 5 fig 11 zero gradient and free outflow boundary conditions are applied upstream and downstream respectively notably 106 800 cells were adopted in the 2d fvm swe model the results were also gathered at the cross section s centerline in the 2d model from fig 11 the hydraulic jump is formed at the initial time when the wavefront approaches the contraction zone as represented by dash lines the wave reflection subsequently develops with time such that at t 31 32 the wave reflection advances up to x h 0 0 in addition the water levels are recorded during the simulation at eight points p1 to p8 fig 10a the results of the comparison between the models described above are depicted in fig 12 in general the present model can predict this problem as accurately as the 2d fvm swe model compared to the experimental data it clearly highlights that the unidirectional flow pattern is dominant over the transverse variation of the flow in the existing literature there is also a q type of momentum equation for solving cross sectional averaged swes in the following lagrangian form chang and chang 2013 41 1 a dq dt q u x g h z x g s f the q type of the momentum equation incorporates a non conservative convective product q u x in other words the momentum equations conservativeness of u and q types are switched under the lagrangian framework which is opposite of the eulerian system however non conservative and conservative forms of swes are mathematically equivalent sturm 2001 french 2007 chaudhry 2008 and the conservativeness of the solution depends on the numerical scheme anderson and wendt 1995 liang et al 2007b thus u and q types of the inertia terms are supposed to produce almost identical results with the exception of some numerical errors regarding the predicted water profiles in fig 11 the inertia terms inside u and q types of the momentum equation are compared for this purpose left hand sides of eqs 2 and 41 in a dimensionless form are illustrated in fig 13 at various non dimensional times notably the 1d mps divergence operator eq 12 is employed to calculate the q type s inertia term fig 13 shows that the inertia terms of u and q types of the momentum equation demonstrate extremely good agreement 3 8 steady flow over a parabolic bump the solver is tested in addressing open boundary conditions using analytical solutions in the following sections goutal and maurel 1997 introduced analytical solutions for steady inviscid flow over a bump which is widely accepted as benchmark test cases for numerical validation in the literature for prismatic aureli et al 2008 ni et al 2016 rogers et al 2003 vacondio et al 2012b and non prismatic channels liu 2020 qian et al 2018 xing 2016 3 8 1 prismatic channel the numerical experiment constitutes a channel in the domain 0 10 with b x 1 m constant m 0 and the following bottom topography 42 z x z 0 1 0 25 x 5 2 if 3 x 7 0 otherwise where z 0 is the maximum height of the bump equal to 0 2 m at x 5 m table 5 lists the parameters for the four different sets of upstream and downstream open boundaries representing sub super and trans critical flow regimes the results of the present solver using dl 0 05 m were compared to the analytical solution and are illustrated in fig 14 the results indicate that the present model and the analytical solution fit very well in addressing a parabolic bump in prismatic channels however a small perturbation of discharge is perceived near the shock in case d this is a numerical shock due to the transition from supercritical to subcritical flow regimes similar findings were also reported in mesh based li et al 2021 zhao et al 2021 and mesh free methods chang et al 2021 ni et al 2016 3 8 2 non prismatic channel the numerical experiment includes a channel in the domain 0 25 the bottom topography defined by eq 42 the channel cross section is given by eq 35 with various parameters b 0 xl and xr the variability of the input parameters for four cases is listed in table 6 representing sub super and trans critical flow regimes using dl 0 1 m the present model is compared to the analytical solution the comparison reveals that the 1d mps swe model shows good agreement with the analytical solution fig 15 3 9 steady flow in a frictional trapezoidal non prismatic channel macdonald 1996 developed a one dimensional analytical solution for steady frictional flow in trapezoidal non prismatic channels the so called pseudo 2d shallow water system delestre et al 2013 the analytical solution consists of a frictional channel with nm 0 03 m 1 3 s and the following cross section 43 b x 10 5 exp 50 x 400 1 3 2 5 exp 50 x 400 2 3 2 m 2 discharge is defined as q 20 m3 s and a variable bed slope s 0 x is determined as 44 s x 1 q 2 b x 2 m h x gh x 3 b x m h x 3 h x x q 2 n m 2 b x 2 h x 1 m 2 4 3 h x 10 3 b x m h x 10 3 q 2 gh x 2 b x m h x 3 b x x the bed elevation is computed as z x x l s 0 x d x where x is the variable of the integration and l 400 m is the channel length two different flow regimes are accounted for 3 9 1 subcritical flow using a subcritical outflow boundary 0 904094 m the analytical solution for the water depth will be 45 h x 0 9 0 3 exp 40 x 400 1 3 2 0 2 exp 35 x 400 2 3 2 the present model is compared to the analytical solution using dl 1 m inflow velocity 2 m s outflow water depth 0 904094 m and the initial conditions as 46 a x 0 10 m 2 u x 0 0 fig 16 illustrates the comparison between the 1d mps swe model to the analytical solution the results indicate an excellent agreement between the present model and the analytical solution 3 9 2 transcritical flow the flow regime becomes transcritical when considering a subcritical outflow boundary equal to 1 2 m in this case the analytical solution for the water depth is represented as 47 h x 0 9 0 25 exp x 40 1 0 25 15 exp x 40 3 10 x 0 120 h x exp 0 09 x 120 i 0 2 k i x 120 l 120 i φ x x 120 400 where k 0 0 183691 k 1 1 519577 k 2 18 234429 and φ is calculated in the following 48 φ x 1 5 exp 0 16 x 400 1 0 3 exp 2 x 400 1 using dl 1 m initial conditions defined in eq 46 with an inflow velocity 2 m s and outflow water depth 1 2 m the present model is compared to the analytical solution fig 16 shows a good agreement was attained between the model and the analytical solution the hydraulic jump is seen in the proximity of x 120 m 3 10 steady flow in measuring flumes 3 10 1 parshall flume the parshall flume incorporates a reduction in the bed elevation and cross section these variations convert the subcritical to the supercritical flow regime which makes it possible to measure the discharge from the recorded critical depth at the transition a parshall flume is used with schematics of the cross section and bed elevation shown in fig 17 a and 17b respectively in the present solver the initial conditions are 49 a x 0 0 1 z x b x u x 0 0 also dl 0 01 m nm 0 005 m 1 3 s the inflow velocity 0 4757 m s and the free outflow boundary is adopted the present model is compared to experimental data collected by ye and mccorquodale 1997 when the steady flow occurs with a discharge q 0 0145 m3 s the 2d fvm swe model ye and mccorquodale 1997 is also applied to the comparison using the averaged free surface elevation versus the bed elevation as shown in fig 17c the present model agrees with the observed data and the 2d fvm swe model the results provide supporting evidence that the flow structure is mainly unidirectional 3 10 2 khafagi flume khafagi 1942 introduced a venturi flume to measure discharge the critical depth is formed at the transition zone with or without the hydraulic jump in the flume fig 18 illustrates a khafagi flume in the present model the initial conditions are given as 50 a x 0 0 1 b x u x 0 0 model input parameters are dl 0 01 m nm 0 009 m 1 3 s and the inflow velocity 0 333 m s in addition to the experimental data collected by khafagi 1942 a 2d fvm swe model introduced by cueto felgueroso et al 2019 was also applied to validate the current model using the centerline data the flow discharge at the steadiness is recorded q 0 01 m3 s first the free outflow boundary is considered as depicted in fig 18b then different water depths are prescribed at the outflow boundary hout 0 088 0 094 0 112 and 0 1305 m from fig 18 the present solver describes the transcritical flow in the khafagi flume compared to the 2d fvm swe model as the tailwater increases the hydraulic jump shifts upstream the solver also accurately represents the experimental data for the different flow regimes and downstream boundary conditions 3 11 unsteady flow in a compound channel with heterogeneous roughness the open boundary cases described above are all under steady state conditions in this section an unsteady state problem is considered moreover a large compound channel with heterogeneous roughness is analyzed which consists of a main river channel and floodplain subsections as shown in fig 19 the base width of the main river channel varies with x which is given by 51 b x 2 b 0 1 cos 2 π x x l x r 2 x r x l if x l x x r 2 otherwise where b 0 0 5 xl 250 and xr 750 m the natural bed slope of the compound channel is s 0 0 0002 a gaussian bump is constructed in the middle of the main river channel with the following property 52 z x 0 5 1 cos 2 π x x l x r 2 x r x l if x l x x r 0 otherwise where xl and xr are similar to eq 51 and zʹ is the bed elevation of the main river channel neglecting the natural bed slope compound channel that is shown by the dashed line in fig 19a thus the actual bed elevation of the main river channel is computed as z zʹ s 0 500 x the initial free surface elevation is 1 2 m with zero flow velocity at the initial time in the present solver dl 4 m is considered and the effective manning coefficient is calculated using the lotter 1933 method as reported fits best in compound channels with heterogeneous roughness easa and han 2019 yang et al 2007 given by 53 n m e p r h 5 3 i 1 3 p i r h i 5 3 n m i 1 where n m e is the effective manning coefficient two numerical experiments considering different open boundary conditions are applied in the following 3 11 1 constant inflow boundary and unchanging downstream flow depth the inflow boundary condition is given by a constant flow velocity equal to 2 1367 m s at x 0 m the propagation of the wave is recorded with time the results of the free surface elevation generated by the present model are compared to the well known hec ras software considering δx 4 m and q 10 m3 s as the inflow boundary although the hec ras model is an implicit based scheme the minimum possible time step δt 1 s is selected to avoid the effect of longer time steps on producing dispersive wavefronts as shown in fig 20 two models fit well at different time levels 3 11 2 unsteady inflow boundary and varying downstream flow depth real world open channel flows incorporate unsteady inflow discharges and outflow water depths herein an unsteady inflow condition at x 0 m is imposed using a stepped inflow hydrograph to investigate the performance of the present solver in dealing with discontinuous transient inflow condition as follows 54 u 0 t 2 1367 i f t 1 t t 2 0 otherwise where t1 1500 and t2 2100 s the downstream water depth at l 1000 m varies with time given by 55 h l t 0 2cos π t t 1 t 2 2 t 1 t 2 3 1 1 fig 21 reveals that the free surface elevations produced by the present solver have good agreement with the hec ras software at different time levels moreover no unphysical oscillations are induced by the discontinuous stepped inflow hydrograph indicating the present model s capability to simulate highly transient flows as can be seen the free surface elevations reduce as a result of no inflow condition and falling downstream flow depth at initial times then the free surface elevation climbs abruptly as the rising stage begins shown at t 28 m afterward the recession period develops that continues until the flow finally becomes stationary at t 60 m 4 conclusion this study presents a second order accurate mps scheme to solve cross sectional averaged shallow water flows the well known maccormack scheme is applied in the lagrangian framework in addition upwind and downwind mps gradient operators are introduced in the one dimensional setting the robust tvd method common in the mesh based techniques is extended to the lagrangian system to maintain a monotonic solution in the present solver the cross sectional area is computed using the algebraic density ratio equation instead of the continuity equation this is advantageous as the higher order accuracy is fulfilled with less computational effort than the mesh based schemes since only one partial differential momentum equation exists in the governing equations moreover the open boundary treatment is easily handled because the boundary value problem is eliminated in the continuity equation notably the momentum conservation encounters difficulties in the u type of the shallow water equations at discontinuities due to the non conservative convective acceleration which requires special treatment to meet the so called telescopic property however the non conservative product of the convective term is eliminated under the lagrangian framework maintaining the conservative property finally the proposed model shows well balancing and positivity preserving properties applicable for prismatic and non prismatic open channels with irregular bottom topography and various open and or closed boundaries it is emphasized that the applicability of the present solver is restricted to problems where the unidirectional flows are dominant nevertheless in case the transverse flow variation and hydrodynamic pressure are of high magnitudes two and three dimensional models are required credit authorship contribution statement payam sarkhosh methodology validation formal analysis investigation writing original draft yee chung jin conceptualization writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors of the present work acknowledge the financial support of the natural sciences and engineering research council of canada nserc funding reference number rgpin 201706397 
3454,the present study utilizes a moving particle simulation mps method to solve cross sectional averaged shallow water equations applicable for non prismatic open channels the well known maccormack predictor corrector scheme is extended to the lagrangian framework ensuring the second accuracy in time and space for this purpose upwind and downwind mps gradient operators are introduced the total variation diminishing tvd flux limiter scheme is developed to the mps formulation to preserve monotonicity which does not require characteristic speeds of the system in mesh based methods the non conservative form of the momentum equation is problematic in scenarios with discontinuities however the non conservative convective flux term does not exist under the lagrangian framework in preserving the momentum conservation moreover the cross sectional area is computed by the algebraic density ratio equation in the present work since the mass is automatically conserved this advantage is beneficial for open boundary treatment resulting in less computational effort than mesh based methods because the partial differential continuity equation is omitted as a boundary value problem the present high order solver has positivity preserving and well balancing properties without the need for any threshold value for treating the dry bed and friction term additionally it can model free surface flows in prismatic and non prismatic open channels with various open and or closed boundary conditions keywords lagrangian framework second order accuracy well balancing positivity preserving open boundary non prismatic open channel 1 introduction in hydraulic and environmental engineering free surface flows are naturally shallow and unidirectional in many cases these attributes make it feasible to average the three dimensional conservation laws over the cross sectional area to derive the so called de saint venant 1871 equations for simulating free surface unsteady flows in open channels cunge et al 1980 moreover an empirical relationship such as the chezy or manning stands for the energy dissipation yen 1973 the cross sectional averaged shallow water equations swes can then be used to couple systems in studying sediment transport saleh et al 2013 water quality modeling wang et al 2018 and free surface seepage flows sarkhosh et al 2021 the nonlinearity of the convective flux term must be adequately treated to satisfy the conservation laws and remove the numerical oscillation in problems with discontinuous initial conditions and steep gradients cunge et al 1980 toro 2001 in such cases shock capturing schemes are required to achieve an oscillation free numerical scheme leveque 2002 toro 2001 classical first order mesh based methods such as lax friedrich 1954 and godunov upwind 1959 can capture shock at discontinuous solutions using an artificial viscosity and riemann solver respectively furthermore second order godunov type schemes have been developed to decrease the magnitude of numerical diffusion toro 2013 alternatively there are second order mesh based schemes without resorting to the riemann solvers such as lax and wendroff 1960 and maccormack 1969 predictor corrector schemes overall second order schemes are not monotone so that gibbs like oscillations an overshoot appearing at discontinuous domains may still be observed castro orgaz and hager 2019 the traditional method to suppress the gibbs phenomenon is using the artificial viscosity however it does not produce universal results since the viscosity coefficient is case dependent cantero chinchilla et al 2016 furthermore it is often imposed excessively generating smeared results in regions of high gradients leveque 2002 the total variation diminishing tvd method can be utilized as a higher order and monotonicity preserving technique hirsch 1990 garcía navarro et al 1992 pioneered the tvd maccormack scheme by adding a dissipation step computed from the characteristic information liang et al 2006 introduced a tvd maccormack scheme based on the flux limiter method which is free of calculating eigenvalues and eigenvectors while preserving the second order accuracy the modified tvd maccormack scheme has been successfully employed in coupling systems for modeling sediment transport kalita 2020 solute transport liang et al 2010 free surface seepage flow under darcy liang et al 2007a and non darcy kumar and pahar 2020 flow regimes an alternative to eulerian shock capturing schemes mesh free or particle methods have become popular to solve swes in the last two decades one of the pioneering mesh free methods is smoothed particle hydrodynamics sph initially introduced for solving navier stokes equations nses gingold and monaghan 1977 monaghan 1992 the capability of sph to solve swes has been documented for dam break problems chang et al 2011 rapid flows with irregular geometry kao and chang 2012 vacondio et al 2012a flows with open boundaries chang and chang 2013 vacondio et al 2012b weakly non hydrostatic shallow water flows chang et al 2014 spatially varied flows chang et al 2016 debris flows vagnon et al 2019 coupled with advection diffusion equation chang et al 2017 and hybrid swe nse model ni et al 2020 notably they are sph models with hydrostatically well balanced bed slope and pressure flux terms rossi et al 2017 xia et al 2013 chang et al 2021 the moving particle simulation mps is another well known mesh free method pioneered by koshizuka and oka 1996 for modeling free surface incompressible flows the main difference between sph and mps arises from different differential operators mps was extended for simulating turbulence fluctuations gotoh et al 2001 weakly compressible flows shakibaeinia and jin 2009 flow through and over porous media fu and jin 2018 khayyer et al 2018 xu and jin 2019 fluid structure interactions khayyer et al 2021 khayyer et al 2019 khayyer et al 2020 sediment transport fu and jin 2016 harada et al 2019 nodoushan and shakibaeinia 2019 granular flows ke et al 2020 rufai et al 2019 xu and jin 2021 waves generated by landslides fu and jin 2015 guo and jin 2018 li et al 2020 and ice wave dynamics junior et al 2021 sarkhosh and jin 2021 developed a well balanced mps based model to solve one dimensional swes in prismatic open channels with closed boundaries they also derived a calibration free formula referred to as the density ratio equation for computing the cross sectional area the advantages of mesh free swes models can be summarized as follows i integral solutions of swes should be adopted to catch discontinuous solutions cunge et al 1980 both sph and mps methods transfer partial differential equations pdes to integral forms ii the mass is automatically conserved since the particles move with the flow hence the volume summation formula or density ratio equation computes the cross sectional area without the need for solving the partial differential continuity equation iii the nonlinear convective term is eliminated wang and shen 1999 iv there is no need to consider any threshold value for treating the dry bed and friction term chang et al 2016 vacondio et al 2012a v a lower order accurate scheme is required to solve dispersive swe models as compared to the mesh based methods chang et al 2014 despite the benefits described above the kernel function in particle methods is symmetric and cannot produce interparticle repulsive forces khayyer and gotoh 2013 thus numerical treatments including stabilization technique upwinding kernel or riemann solver are required artificial viscosity is the traditional stabilization technique introduced by monaghan 1985 using a fixing parameter ata and soulaïmani 2005 developed a calibration free and less diffusive stabilization technique by improving the typical artificial viscosity later was extended to non prismatic channels by chang and chang 2013 chang et al 2018 used a corrective matrix to fulfill first order consistency in the two dimensional sph swe sarkhosh and jin 2021 developed a case independent stabilization technique based on inelastic collision with unequal masses to ensure first order consistency regarding the kernel treatment chang et al 2017 developed an upwinding kernel function for cross sectional averaged shallow water flows additionally riemann solver based sph swe schemes exist with no excessive numerical dissipation due to intrinsic artificial viscosity rossi et al 2017 vacondio et al 2012a xia et al 2013 the main objective of this study is to introduce a well balanced and positivity preserving mps model with second order accuracy for solving cross sectional averaged swes applicable for non prismatic open channels the popular maccormack predictor corrector is extended to a lagrangian framework without the need for the riemann solvers applied in the previous higher order mesh free swe models the tvd flux limiter method pioneered by liang et al 2006 is applied to the mps integration to remove typical spurious oscillations that occur in high order schemes moreover open boundaries are included in the present model with various flow regimes including subcritical supercritical and transcritical with less computational effort than mesh based methods since only one pde as a boundary value problem exists the present shock capturing solver is then validated using various inviscid and frictional flows hydraulic jump irregular bottom topography prismatic and non prismatic open channels measuring parshall and khafagi flumes and a compound channel with heterogeneous roughness 2 materials and methods 2 1 governing equations saint venant equations incorporate continuity and momentum equations assuming that the flow is unidirectional with its cross sectional averaged velocity the pressure has a hydrostatic distribution and the manning formula represents the resistance force the governing equations for a non prismatic channel are rewritten in the lagrangian forms casulli and stelling 2013 chow 1959 1 da dt a u x 2 du dt g h z x g s f where d dt stands for the total derivative t u x u is the flow velocity m s a the cross sectional area m2 h the water depth m z the bed elevation m g the gravitational acceleration m s2 x m and t s are spatial and temporal independent variables respectively h h z is expressed as the free surface elevation m castro orgaz and hager 2019 sf is the friction slope calculated from the manning formula 3 s f u u n m 2 r h 4 3 where nm is the manning coefficient m 1 3 s rh a p the hydraulic radius m and p the wetted perimeter m the hyperbolic system of eqs 1 and 2 is closed by a relationship between the cross sectional area a and the water depth h as shown in fig 1 the water depth is obtained from a polynomial equation for a trapezoidal shaped cross sectional area i e a x t b x mh x t h x t since the natural channel s cross section can be approximated by a trapezoid chow 1959 notably the mass conservation is automatically satisfied in mesh free methods independent of the solution domain that is smooth or discontinuous accordingly an algebraic formula is utilized to calculate the cross sectional area instead of the continuity equation as described in the following section in the eulerian system eq 2 is recognized as the non conservative form or simply the u type of the momentum equation chaudhry 2008 this name comes from the non conservative product of the convective term considering the expansion of the total derivative which is problematic to satisfy the so called telescopic property pirozzoli 2010 reiss and sesterhenn 2014 and necessitates special treatment casulli and stelling 2013 in contrast the u type of the momentum equation is free from the nonlinear convective term under the lagrangian framework satisfying the conservativeness 2 2 numerical discretization the subsequent sections first present the mps formulation for the spatial integration of cross sectional averaged swes afterward the time discretization is described based on the tvd maccormack predictor corrector finally the initial and boundary conditions are explained where the inflow and outflow boundary treatments corresponding to various flow regimes are introduced 2 2 1 spatial integration using mps formulation in mps pdes are spatially integrated using a weighted average kernel function over a support domain the interaction of each particle referred to as the target particle with its neighboring particle is tracked inside the support domain with a searching radius re koshizuka et al 2018 the searching radius is calculated using the following relationship in meshfree modeling of cross sectional averaged swes chang and chang 2013 4 r e i r e i 0 a i 0 a i where re is the searching radius subscript i and superscript 0 refer to the target particle and initial time respectively the cross sectional area is obtained from the density ratio equation proposed by sarkhosh and jin 2021 as follows 5 a i a i 0 n 0 n i where n is the particle number density which is a function of the searching radius and particle s distance for one dimensional shallow water flows 6 n i j i n w x ij r e i where w is the kernel function subscript j represents the neighboring particles and x ij x j x i since the cross sectional area is a function of the searching radius and vice versa the popular newton raphson iteration is employed in mesh free swes models chang and chang 2013 vacondio et al 2012a the residual of the cross sectional area at the r th iteration will be 7 res i r a i r a i 0 n 0 j i n w x ij r e i r where res stands for the residual the cross sectional area at the new iteration is computed as 8 a i r 1 a i r res i r d res da i r the derivative of the residual in the denominator on the right hand side of eq 8 is calculated as 9 d res da i r 1 a i 0 n 0 j i n d w ij r dr e i r dr e i r d a i r the iteration is processed until the stopping criterion is fulfilled which is 10 res i r a i r ε where ε is the stopping threshold equal to 10 7 and 10 15 for single and double precisions in this study the spiky type kernel function is utilized fredini and limache 2013 sarkhosh and jin 2021 11 w x ij r e i 1 8 r e i 2 x ij r e i 3 if 0 x ij r e i 2 0 if x ij r e i 2 it is worth noting that 1 8rei is the normalization factor to satisfy the unity condition in a one dimensional setting for the spatial integration one dimensional mps divergence and gradient operators are adopted in the following forms respectively koshizuka et al 2018 12 div u i 1 n i j i n u j u i x ij 2 x j x i w x ij r e i 13 f x i 1 n i j i n f j f i x ij 2 x j x i w x ij r e i where f is a scaler and f i is defined as the minimum value among the target and neighboring particles in the support domain to ensure inter particle repulsive forces in the gradient operator koshizuka et al 1998 sarkhosh and jin 2021 reported that the above gradient operator is still unable to preserve the linear momentum conservation at discontinuities and steep gradients in mps modeling of 1d swes to resolve the linear momentum conservation the authors modified the free surface elevation gradient by a case independent stabilizing technique inspired by dynamic stabilization ds developed by tsuruta et al 2013 given as 14 h x i satabilized h x i f ij ds i f ij ds u ij ds g δ t u ij ds 0 0 u ij ds 0 u ij ds u i a i u i n i a j u j n j a i n i a j n j x j x i x j x i where f ij ds is a non dimensional term representing the dynamic stabilizing force imposed from neighboring particles on the target particle herein f ij ds is integrated over a support domain using a scatter interpretation of the mps summation hernquist and katz 1989 since neighboring particles play the dominant role in the dynamic stabilizing force thus stabilized gradient operator is given as 15 h x i 1 n i j i n h j h i x ij 2 x j x i w x ij r e i j i n f ij ds n j w x ij r e i where u ij ds is the dynamic stabilizing velocity after inelastic collision with unequal masses 2 2 2 treatment of the bed topography source term the numerical discretization of the bed topography source term is problematic in the fractional step schemes leveque 1998 accordingly it is recommended to merge the water depth with the bed elevation forming the free surface elevation to preserve hydrostatic well balancing property castro orgaz and hager 2019 liang and borthwick 2009 liang and marche 2009 the free surface elevation can be regarded as the source term or pressure flux term although they are mathematically equivalent the second approach is utilized in this study synergistically with the physical point of view so that the source term equates to zero with the neglection of the bed and friction slopes liang et al 2006 sarkhosh and jin 2021 in contrast the source term has a non zero value in the second method despite considering bed elevation and friction equal to zero the momentum equation as the only pde in this study is therefore expressed in the following 16 de dt f x s where e u is the unknown variable f gh the flux term and s gsf the source term 2 2 3 temporal discretization using tvd maccormack predictor corrector in mesh based methods the maccormack method consists of downwind and upwind schemes for discretizing the flux term employed in predictor and corrector steps respectively 17 predictor step e i p e i k δ t δ x f i 1 k f i k s i k δ t corrector step e i c e i p δ t δ x f i p f i 1 p s i p δ t e i k 1 e i p e i c 2 where k and k 1 refer to previous and present time levels p the predictor step and c the corrector step using the mps stabilized gradient operator eq 17 is transferred into the mps integration as 18 predictor step e i p e i k δ t f x r k s i k δ t corrector step e i c e i p δ t f x l p s i p δ t e i k 1 e i p e i c 2 where r and l stand for downwind and upwind schemes respectively the interaction of the target particle with downstream neighboring particles j i representing the downwind scheme is considered at the prediction step fig 2 in contrast adjacent particles upstream of the target particle j i constitute the upwind scheme adopted at the corrector stage the mps formulation of cross sectional averaged swes using the maccormack predictor and corrector steps is summarized in table 1 the downwind and upwind free surface elevation gradients in table 1 are obtained from eqs 19 and 20 respectively 19 h x r 1 n r j i n h j h i x ij 2 x j x i w x ij r e i f ij ds i 20 h x l 1 n l j i n h i h j x ij 2 x i x j w x ij r e i f ij ds i where n r and n l refers to the downwind and upwind particle number density calculated from eq 6 considering j i and j i respectively the maccormack predictor corrector scheme is second order accurate in time and space and is not oscillation free in zones with steep gradients and discontinuities thus the tvd flux limiter developed by liang et al 2006 is adopted for preserving the monotonicity as the third step 21 u i k 1 u i p u i c 2 t v d i where tvdi is calculated in the following 22 tv d i g r i g r r δ u r k g r i g r l δ u l k where δ u r k and δ u l k are the downwind and upwind velocity variations calculated as follows δ u r k 1 n r k j i n u j k u i k w x ij k r e i k 23 δ u l k 1 n l k j i n u i k u j k w x ij k r e i k other terms of eq 22 are expressed in the following 24 r i δ u l k δ u r k δ u r k δ u r k r i δ u l k δ u r k δ u l k δ u l k g r r 1 n r k j i n g r j w x ij k r e i k 25 g r l 1 n l k j i n g r j w x ij k r e i k the function g is defined as 26 g x 0 5 c 1 ϕ x where ϕ x is the flux limiter function 27 ϕ x max 0 min 2 x 1 where x is the variable of the flux limiter function moreover c in eq 26 is calculated with respect to the courant cr number 28 c cr 1 c r if c r 0 5 0 25 if c r 0 5 since the present solver is an explicit scheme the time step should be computed as a function of cr as follows 29 δ t c r min δ l i c i u i 0 c r 1 where δ l i is the particle length this study sets cr 0 7 to satisfy the courant friedrichs lewy stability condition 2 3 initial and boundary conditions 2 3 1 initial conditions the solution of saint venant equations is distinguished as the initial boundary value problem sarkhosh et al 2020 for this purpose the initial cross sectional area a x 0 and flow velocity u x 0 are established throughout the solution domain at the beginning of the computations moreover the initial searching radius re 0 is a function of the initial particle size dl defined as re 0 αdl where α is the searching radius parameter in mesh free modeling of swes α varies between 1 2 and 1 4 chang et al 2018 chang and chang 2013 ni et al 2016 α 1 4 is applied in the present study 2 3 2 boundary conditions wall boundary treatment the zero gradient neumann boundary condition is imposed using several pre defined ghost particles at wall boundaries in the mps koshizuka et al 2018 first the pressure value and free surface elevation from the adjacent water particle are assigned to the closest ghost particle referred to as the wall particle in the mps modeling of nses and swes respectively koshizuka et al 2018 sarkhosh and jin 2021 afterward this value is given to other ghost particles to obtain the zero gradient boundary condition inflow outflow boundary condition in a supercritical flow regime two boundary conditions should be imposed at the upstream boundary while it is unnecessary to define any condition at the downstream section castro orgaz and hager 2019 on the other hand one flow property is imposed for treating the subcritical boundary condition while the second flow property is obtained from riemann invariants castro orgaz and hager 2019 vacondio et al 2012b characteristics invariants anastasiou and chan 1997 fujihara and borthwick 2000 or the method of specified intervals chang et al 2018 chaudhry 2008 in explicit swes models notably there is no need to consider any supplementary equation for treating subcritical boundary conditions in the present solver since the partial differential continuity equation as a boundary value problem is transferred to an algebraic formula for the cross sectional area computation in this study four sets of inflow and outflow boundaries forming various flow regimes in the entire domain are defined as follows subcritical inflow and subcritical outflow boundaries the velocity is imposed upstream and the cross sectional area is defined downstream subcritical inflow and supercritical outflow boundaries the velocity is only imposed upstream supercritical inflow and supercritical outflow boundaries the velocity and cross sectional area are prescribed upstream supercritical inflow and subcritical outflow boundaries the velocity and cross sectional area are defined upstream and the cross sectional area is imposed downstream two buffer zones representing inflow and outflow zones are defined just outside the solution domain similar to works conducted by vacondio et al 2012b and chang et al 2021 as shown in fig 3 the outflow buffer zone 2 re varies based on the flow condition to ensure the particle deficiency in the proximity of the outflow region does not affect the calculation of the flow properties unlike the inflow boundary in which the buffer zone s size is fixed 2 dl the particle recycling strategy originated from shakibaeinia and jin 2009 is adopted from a computational efficiency standpoint without a large number of particles in this respect the physical properties are removed from the particles leaving the solution domain on the other hand physical properties proportional to the inflow boundary condition are added to the particles when entering the solution domain 3 results and discussion in this section a series of extensive numerical simulations are conducted to validate the proposed solver the model is initially applied to investigate the order of accuracy tvd performance well balancing property and positivity preserving properties subsequently the solver is applied to various prismatic and non prismatic open channels with closed and or open boundary conditions 3 1 order of accuracy there are several analytical solutions for one dimensional swes in the literature but the solutions have yet to be recognized as generic test cases for accuracy xing and shu 2006 2005 due to these shortcomings the numerical accuracy test proposed by qian et al 2018 is applied to determine the suitability of the model for non prismatic channels in this regard the bed topography and cross section are defined as follows 30 z x sin 2 π x b x e sin 2 π x m 0 where b x is the channel width at the bottom and m the side slope as represented in fig 1 the initial conditions are given by 31 a x 0 3 e cos 2 π x b x u x 0 sin cos 2 π x a x 0 x 0 1 using a periodic boundary condition i e an infinite solution domain the test runs up to t 0 1 s since there is no exact solution for this case n 12800 particles is applied as a reference solution where n refers to the number of particles fig 4 illustrates the results of the accuracy test for computed free surface elevation h and discharge q ua using the various number of particles furthermore the l 1 error norms calculated from eqs 32 and 33 and the convergence rates are listed in table 2 32 l 1 h 1 n i 1 n h i mps h i ext h i ext l 1 u 1 n i 1 n u i mps u i ext g h i ext l 1 q 1 n i 1 n q i mps q i ext a i ext g h i ext 33 l h max i 1 n h i mps h i ext h i ext l u max i 1 n u i mps u i ext g h i ext l q max i 1 n q i mps q i ext a i ext g h i ext 3 2 tvd performance to examine the tvd performance an inviscid dam break problem over a wet bed is adopted with the channel length l 9 m upstream water depth h 0 0 25 m downstream water depth hdown 0 1 m channel width b x 1 m constant and no side slope i e m 0 the gate is placed at x 4 65 m and removed immediately the results of the 1d mps swe using 1st order maccormack tvd maccormack schemes are compared to the analytical solutions stoker 1957 as shown in fig 5 the solution experiences the gibbs phenomenon neighboring the shocks in the absence of the tvd method moreover the wavefront and rarefaction wave are more diffusive in the 1st order accurate model the errors of the 1st order and tvd maccormack schemes of the 1d mps swe solver for three particle numbers are summarized in table 3 using eqs 32 and 33 describing that the error decreases with increasing n the tvd maccormack scheme of the 1d mps swe solver demonstrates better agreement with the analytical solution 3 3 lake at rest in the case of no velocity the free surface elevation remains unchanged compared to the initial condition in a well balanced numerical scheme the lake at rest problem in non prismatic channels has been widely adopted balbás and karni 2009 qian et al 2018 in this regard the bottom topography in the domain 0 1 is defined as 34 z x 0 25 1 cos 10 π x 0 5 if 0 4 x 0 6 0 otherwise the cross section is given by 35 b x 1 b 0 1 cos 2 π x x l x r 2 x r x l if x l x x r 1 otherwise m 0 where 1 2b 0 refers to the minimum value of the channel width at xl xr 2 xl and xr are the left and right contraction boundaries in this case b 0 0 2 xl 0 25 and xr 0 75 m the initial condition is defined as 36 a x 0 1 z x b x u x 0 0 the result of the present model for the lake at rest problem at t 0 5 s is shown in fig 6 the l 1 and l error norms are listed in table 4 with consideration of single and double machine precisions the results show that the flow remains static which represents that the model satisfies the well balancing property 3 4 small perturbation considering the numerical simulation from case 3 3 the flow shifts to a quasi steady state condition when a pulse perturbates the steady state known as leveque s 1998 problem leveq s test is completed using the 1st and 2nd order 1d mps swe two experiments are conducted with varying bed topography and cross section defined in eqs 34 and 35 using b 0 0 2 xl 0 15 xr 0 65 m and b 0 0 2 xl 0 35 xr 0 85 m respectively the initial condition is 37 a x 0 1 01 z x b x if 0 1 x 0 2 1 z x b x otherwise u x 0 0 also the periodic boundary condition is adopted fig 7 illustrates the model results using dl 0 002 m compared to the third order discontinuous galerkin solver introduced by qian et al 2018 using δx 0 0005 m as the reference the results show no numerical oscillation subjected to irregular bed topography since the present model is well balanced as well the 1st order model is more diffusive than the 2nd order particularly at t 0 15 and 0 25 s 3 5 reservoir drainage on a non flat bottom for the positivity preserving test reservoir drainage over a non flat bottom is tested in the solver for this purpose a non prismatic channel is considered with the following bed topography and cross section 38 z x 0 48 0 12 x 4 2 if 2 x 6 0 2 0 2 x 8 2 if 7 x 9 0 otherwise 39 b x 0 6 0 025 x 2 2 if 1 x 9 1 otherwise m 0 the initial condition is given by 40 a x 0 0 4801 z x b x if x 8 5 0 otherwise u x 0 0 a zero gradient and free outflow boundary conditions are adopted upstream and downstream respectively using n 200 the present model results are compared to the 2nd order finite volume solver introduced by liu 2020 the reservoir is drained up to it reaches a static state at t 500 s with good agreement with the reference fig 8 additionally water particles are absent at dry zones in the present solver at t 0 0 4 500 s as one of the mesh free swe models features is suitable for flood prediction in general the cross sectional area has no negative value meaning that the present solver satisfies the positivity preserving property 3 6 dam break in a triangular prismatic channel an inviscid dam break problem in a triangular prismatic channel is conducted and compared with the analytical solution proposed by henderson 1966 in this simulation a triangular channel is adopted with 1000 m length b x 0 as there is no base in a triangle m 1 h 0 1 m and downstream dry bed a gate bisects the channel and is removed immediately one of the advantages of mesh free swe models is that there is no need to consider any threshold value representing the dry bed since there is no particle downstream of the gate the present model reveals good agreement with the analytical solution as depicted in fig 9 using n 500 particles 3 7 dam break in a non prismatic channel kocaman et al 2020 conducted extensive experiments to model frictional dam break problems in an open channel with an abrupt cross section variation to study the effect of shock from the channel contraction on the flow behavior wave reflection wave propagation and the development of hydraulic jump fig 10 illustrates the experimental setup along with the parameters it consists of an 8 9 m long flume with an open boundary downstream a trapezoidal shaped contraction a reservoir upstream with the water depth h 0 0 25 m and a length equal to 4 65 m controlled by a gate the flume has no side slope i e m 0 the flood wave propagates downstream as the gate is released immediately at x h 0 0 and t 0 the parameters n 1000 and nm 0 0075 m 1 3 s is applied in the present model and is used to compare to the experimental data and also a 2d 2nd order finite volume swe fvm swe model kocaman et al 2020 using dimensionless water surface profiles at different dimensionless time steps t t g h 0 0 5 fig 11 zero gradient and free outflow boundary conditions are applied upstream and downstream respectively notably 106 800 cells were adopted in the 2d fvm swe model the results were also gathered at the cross section s centerline in the 2d model from fig 11 the hydraulic jump is formed at the initial time when the wavefront approaches the contraction zone as represented by dash lines the wave reflection subsequently develops with time such that at t 31 32 the wave reflection advances up to x h 0 0 in addition the water levels are recorded during the simulation at eight points p1 to p8 fig 10a the results of the comparison between the models described above are depicted in fig 12 in general the present model can predict this problem as accurately as the 2d fvm swe model compared to the experimental data it clearly highlights that the unidirectional flow pattern is dominant over the transverse variation of the flow in the existing literature there is also a q type of momentum equation for solving cross sectional averaged swes in the following lagrangian form chang and chang 2013 41 1 a dq dt q u x g h z x g s f the q type of the momentum equation incorporates a non conservative convective product q u x in other words the momentum equations conservativeness of u and q types are switched under the lagrangian framework which is opposite of the eulerian system however non conservative and conservative forms of swes are mathematically equivalent sturm 2001 french 2007 chaudhry 2008 and the conservativeness of the solution depends on the numerical scheme anderson and wendt 1995 liang et al 2007b thus u and q types of the inertia terms are supposed to produce almost identical results with the exception of some numerical errors regarding the predicted water profiles in fig 11 the inertia terms inside u and q types of the momentum equation are compared for this purpose left hand sides of eqs 2 and 41 in a dimensionless form are illustrated in fig 13 at various non dimensional times notably the 1d mps divergence operator eq 12 is employed to calculate the q type s inertia term fig 13 shows that the inertia terms of u and q types of the momentum equation demonstrate extremely good agreement 3 8 steady flow over a parabolic bump the solver is tested in addressing open boundary conditions using analytical solutions in the following sections goutal and maurel 1997 introduced analytical solutions for steady inviscid flow over a bump which is widely accepted as benchmark test cases for numerical validation in the literature for prismatic aureli et al 2008 ni et al 2016 rogers et al 2003 vacondio et al 2012b and non prismatic channels liu 2020 qian et al 2018 xing 2016 3 8 1 prismatic channel the numerical experiment constitutes a channel in the domain 0 10 with b x 1 m constant m 0 and the following bottom topography 42 z x z 0 1 0 25 x 5 2 if 3 x 7 0 otherwise where z 0 is the maximum height of the bump equal to 0 2 m at x 5 m table 5 lists the parameters for the four different sets of upstream and downstream open boundaries representing sub super and trans critical flow regimes the results of the present solver using dl 0 05 m were compared to the analytical solution and are illustrated in fig 14 the results indicate that the present model and the analytical solution fit very well in addressing a parabolic bump in prismatic channels however a small perturbation of discharge is perceived near the shock in case d this is a numerical shock due to the transition from supercritical to subcritical flow regimes similar findings were also reported in mesh based li et al 2021 zhao et al 2021 and mesh free methods chang et al 2021 ni et al 2016 3 8 2 non prismatic channel the numerical experiment includes a channel in the domain 0 25 the bottom topography defined by eq 42 the channel cross section is given by eq 35 with various parameters b 0 xl and xr the variability of the input parameters for four cases is listed in table 6 representing sub super and trans critical flow regimes using dl 0 1 m the present model is compared to the analytical solution the comparison reveals that the 1d mps swe model shows good agreement with the analytical solution fig 15 3 9 steady flow in a frictional trapezoidal non prismatic channel macdonald 1996 developed a one dimensional analytical solution for steady frictional flow in trapezoidal non prismatic channels the so called pseudo 2d shallow water system delestre et al 2013 the analytical solution consists of a frictional channel with nm 0 03 m 1 3 s and the following cross section 43 b x 10 5 exp 50 x 400 1 3 2 5 exp 50 x 400 2 3 2 m 2 discharge is defined as q 20 m3 s and a variable bed slope s 0 x is determined as 44 s x 1 q 2 b x 2 m h x gh x 3 b x m h x 3 h x x q 2 n m 2 b x 2 h x 1 m 2 4 3 h x 10 3 b x m h x 10 3 q 2 gh x 2 b x m h x 3 b x x the bed elevation is computed as z x x l s 0 x d x where x is the variable of the integration and l 400 m is the channel length two different flow regimes are accounted for 3 9 1 subcritical flow using a subcritical outflow boundary 0 904094 m the analytical solution for the water depth will be 45 h x 0 9 0 3 exp 40 x 400 1 3 2 0 2 exp 35 x 400 2 3 2 the present model is compared to the analytical solution using dl 1 m inflow velocity 2 m s outflow water depth 0 904094 m and the initial conditions as 46 a x 0 10 m 2 u x 0 0 fig 16 illustrates the comparison between the 1d mps swe model to the analytical solution the results indicate an excellent agreement between the present model and the analytical solution 3 9 2 transcritical flow the flow regime becomes transcritical when considering a subcritical outflow boundary equal to 1 2 m in this case the analytical solution for the water depth is represented as 47 h x 0 9 0 25 exp x 40 1 0 25 15 exp x 40 3 10 x 0 120 h x exp 0 09 x 120 i 0 2 k i x 120 l 120 i φ x x 120 400 where k 0 0 183691 k 1 1 519577 k 2 18 234429 and φ is calculated in the following 48 φ x 1 5 exp 0 16 x 400 1 0 3 exp 2 x 400 1 using dl 1 m initial conditions defined in eq 46 with an inflow velocity 2 m s and outflow water depth 1 2 m the present model is compared to the analytical solution fig 16 shows a good agreement was attained between the model and the analytical solution the hydraulic jump is seen in the proximity of x 120 m 3 10 steady flow in measuring flumes 3 10 1 parshall flume the parshall flume incorporates a reduction in the bed elevation and cross section these variations convert the subcritical to the supercritical flow regime which makes it possible to measure the discharge from the recorded critical depth at the transition a parshall flume is used with schematics of the cross section and bed elevation shown in fig 17 a and 17b respectively in the present solver the initial conditions are 49 a x 0 0 1 z x b x u x 0 0 also dl 0 01 m nm 0 005 m 1 3 s the inflow velocity 0 4757 m s and the free outflow boundary is adopted the present model is compared to experimental data collected by ye and mccorquodale 1997 when the steady flow occurs with a discharge q 0 0145 m3 s the 2d fvm swe model ye and mccorquodale 1997 is also applied to the comparison using the averaged free surface elevation versus the bed elevation as shown in fig 17c the present model agrees with the observed data and the 2d fvm swe model the results provide supporting evidence that the flow structure is mainly unidirectional 3 10 2 khafagi flume khafagi 1942 introduced a venturi flume to measure discharge the critical depth is formed at the transition zone with or without the hydraulic jump in the flume fig 18 illustrates a khafagi flume in the present model the initial conditions are given as 50 a x 0 0 1 b x u x 0 0 model input parameters are dl 0 01 m nm 0 009 m 1 3 s and the inflow velocity 0 333 m s in addition to the experimental data collected by khafagi 1942 a 2d fvm swe model introduced by cueto felgueroso et al 2019 was also applied to validate the current model using the centerline data the flow discharge at the steadiness is recorded q 0 01 m3 s first the free outflow boundary is considered as depicted in fig 18b then different water depths are prescribed at the outflow boundary hout 0 088 0 094 0 112 and 0 1305 m from fig 18 the present solver describes the transcritical flow in the khafagi flume compared to the 2d fvm swe model as the tailwater increases the hydraulic jump shifts upstream the solver also accurately represents the experimental data for the different flow regimes and downstream boundary conditions 3 11 unsteady flow in a compound channel with heterogeneous roughness the open boundary cases described above are all under steady state conditions in this section an unsteady state problem is considered moreover a large compound channel with heterogeneous roughness is analyzed which consists of a main river channel and floodplain subsections as shown in fig 19 the base width of the main river channel varies with x which is given by 51 b x 2 b 0 1 cos 2 π x x l x r 2 x r x l if x l x x r 2 otherwise where b 0 0 5 xl 250 and xr 750 m the natural bed slope of the compound channel is s 0 0 0002 a gaussian bump is constructed in the middle of the main river channel with the following property 52 z x 0 5 1 cos 2 π x x l x r 2 x r x l if x l x x r 0 otherwise where xl and xr are similar to eq 51 and zʹ is the bed elevation of the main river channel neglecting the natural bed slope compound channel that is shown by the dashed line in fig 19a thus the actual bed elevation of the main river channel is computed as z zʹ s 0 500 x the initial free surface elevation is 1 2 m with zero flow velocity at the initial time in the present solver dl 4 m is considered and the effective manning coefficient is calculated using the lotter 1933 method as reported fits best in compound channels with heterogeneous roughness easa and han 2019 yang et al 2007 given by 53 n m e p r h 5 3 i 1 3 p i r h i 5 3 n m i 1 where n m e is the effective manning coefficient two numerical experiments considering different open boundary conditions are applied in the following 3 11 1 constant inflow boundary and unchanging downstream flow depth the inflow boundary condition is given by a constant flow velocity equal to 2 1367 m s at x 0 m the propagation of the wave is recorded with time the results of the free surface elevation generated by the present model are compared to the well known hec ras software considering δx 4 m and q 10 m3 s as the inflow boundary although the hec ras model is an implicit based scheme the minimum possible time step δt 1 s is selected to avoid the effect of longer time steps on producing dispersive wavefronts as shown in fig 20 two models fit well at different time levels 3 11 2 unsteady inflow boundary and varying downstream flow depth real world open channel flows incorporate unsteady inflow discharges and outflow water depths herein an unsteady inflow condition at x 0 m is imposed using a stepped inflow hydrograph to investigate the performance of the present solver in dealing with discontinuous transient inflow condition as follows 54 u 0 t 2 1367 i f t 1 t t 2 0 otherwise where t1 1500 and t2 2100 s the downstream water depth at l 1000 m varies with time given by 55 h l t 0 2cos π t t 1 t 2 2 t 1 t 2 3 1 1 fig 21 reveals that the free surface elevations produced by the present solver have good agreement with the hec ras software at different time levels moreover no unphysical oscillations are induced by the discontinuous stepped inflow hydrograph indicating the present model s capability to simulate highly transient flows as can be seen the free surface elevations reduce as a result of no inflow condition and falling downstream flow depth at initial times then the free surface elevation climbs abruptly as the rising stage begins shown at t 28 m afterward the recession period develops that continues until the flow finally becomes stationary at t 60 m 4 conclusion this study presents a second order accurate mps scheme to solve cross sectional averaged shallow water flows the well known maccormack scheme is applied in the lagrangian framework in addition upwind and downwind mps gradient operators are introduced in the one dimensional setting the robust tvd method common in the mesh based techniques is extended to the lagrangian system to maintain a monotonic solution in the present solver the cross sectional area is computed using the algebraic density ratio equation instead of the continuity equation this is advantageous as the higher order accuracy is fulfilled with less computational effort than the mesh based schemes since only one partial differential momentum equation exists in the governing equations moreover the open boundary treatment is easily handled because the boundary value problem is eliminated in the continuity equation notably the momentum conservation encounters difficulties in the u type of the shallow water equations at discontinuities due to the non conservative convective acceleration which requires special treatment to meet the so called telescopic property however the non conservative product of the convective term is eliminated under the lagrangian framework maintaining the conservative property finally the proposed model shows well balancing and positivity preserving properties applicable for prismatic and non prismatic open channels with irregular bottom topography and various open and or closed boundaries it is emphasized that the applicability of the present solver is restricted to problems where the unidirectional flows are dominant nevertheless in case the transverse flow variation and hydrodynamic pressure are of high magnitudes two and three dimensional models are required credit authorship contribution statement payam sarkhosh methodology validation formal analysis investigation writing original draft yee chung jin conceptualization writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors of the present work acknowledge the financial support of the natural sciences and engineering research council of canada nserc funding reference number rgpin 201706397 
