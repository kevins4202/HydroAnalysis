index,text
25740,marine ecosystem models mems provide a deeper understanding of marine ecosystem dynamics the united nations decade of ocean science for sustainable development has highlighted the need to deploy these complex mechanistic spatial temporal models to engage policy makers and society into dialogues towards sustainably managed oceans from our shared perspective mems remain underutilized because they still lack formal validation calibration and uncertainty quantifications that undermines their credibility and uptake in policy arenas we explore why these shortcomings exist and how to enable the global modelling community to increase mems usefulness we identify a clear gap between proposed solutions to assess model skills uncertainty and confidence and their actual systematic deployment we attribute this gap to an underlying factor that the ecosystem modelling literature largely ignores technical issues we conclude by proposing a conceptual solution that is cost effective scalable and simple because complex spatial temporal marine ecosystem modelling is already complicated enough keywords opinion spatial temporal marine ecosystem modelling capacity building systematic skill assessments systematic model calibration 1 introduction marine biodiversity is the foundation for marine ecosystem function and processes providing goods and services and bringing substantial health social and economic benefits to coastal communities and beyond worldwide increasing direct and indirect human pressures on marine biodiversity threaten a sustainable future for coupled human nature systems e g halpern et al 2019 a stronger action is needed as marine and coastal ecosystem biodiversity loss is exacerbated by climate change arneth et al 2020 e g smale et al 2019 with the simultaneous declarations of 2021 2030 as the decade of ocean science for sustainable development and the decade for ecosystem restoration the united nations has given the ocean science community a unique opportunity and imperative to work towards sustainable future oceans heymans et al 2020 ryabinin et al 2019 this includes a more extensive use of spatial temporal marine ecosystem modelling a discipline increasingly recognized as an indispensable asset to aid natural resource assessments and marine ecosystem management brotons et al 2016 christensen and maclean 2011 ipcc 2019 link et al 2011 marine ecosystem models help improve our understanding of the impacts of human activities natural phenomena and climate change on marine food webs heymans et al 2020 stow et al 2009 offering the most comprehensive platforms to unify ecological processes with statistical insights and data driven approaches ellis et al 2020 complex mechanistic ecosystem models are increasingly applied in ecological research management advice policy exploration and environmental impact analysis under climate change scenarios borja et al 2020 fulton et al 2015 kytinou et al 2020 link et al 2011 peck et al 2018 serpetti et al 2017 ecosystem modelling integrates a wide range of disciplines fulton 2010 including physical oceanography biochemistry food web dynamics risk analysis decision making economics and the social sciences fig 1 for proper understanding of the interplay between species habitats natural phenomena anthropogenic stressors and management actions models are required that are inherently dynamical and spatially explicit across temporal and spatial scales that can span several orders of magnitude hyder et al 2015 there is an urgent need for ecosystem models to rise to the ocean decade challenges heymans et al 2020 by i making ecosystem modelling more accessible to decision makers and ocean managers ii bridging disciplines to meaningfully communicate marine ecosystem modelling sciences to the audiences that need it and iii ensuring that marine ecosystem models are co created and co designed with stakeholders to enhance their application from our perspectives across various scientific disciplines collected during an euromarine foresight workshop held in barcelona in 2019 we argue that most modellers do not utilize their models to their full capacity consequently in this paper we explore a fourth challenge iv solving the long standing technical problems that prevent robust use of spatial temporally explicit marine ecosystem models and making their outcomes more credible while aspects of this discussion could apply to many of the complex modelling in different scientific fields we focus on marine ecosystem models these models span a broad range of model types and modelling philosophies nevertheless they face common challenges consequently for the sake of brevity and unless explicitly stated all modelling henceforth will refer to the use of complex mechanistic spatially and temporally explicit models that concern the dynamics of marine life and the influence of drivers of change the models themselves will be referred to by their common acronym mem marine ecosystem model lotze et al 2019 this class of models explicitly represent food web and spatial distribution processes that are driven by habitat and other environmental or anthropogenic factors whereas non spatial marine ecosystem models and complex and computationally demanding global circulation models and hydrodynamic models have a long history of model benchmarking christensen and maclean 2011 spatially temporally explicit mems that represent complex energetic pathways have not made significant advances in this realm e g oliveros ramos et al 2017 pethybridge et al 2019 regarding prediction capabilities the quantification of uncertainties and errors in mem output is essential to identify model strengths and limitations which provides the transparency needed to interpret communicate and apply model results bennett et al 2013 hyder et al 2015 stelzenmüller et al 2018 uusitalo et al 2016 this topic is a recurring and persistent concern despite a discussion extending back to the early 1980s hamel and bryant 2017 pennekamp et al 2017 rounsevell et al 2021 even though there is a wide array of suggested methodologies and potential frameworks to improve the use of mems hipsey et al 2020 e g robson et al 2018 their applications is rarely described in the literature pethybridge et al 2019 despite the number of papers calling for comprehensive model validations assessment of the various types of uncertainty and calibration fulton 2011 grüss et al 2017 hipsey et al 2020 rose et al 2010 schuwirth et al 2019 stelzenmüller et al 2018 stow et al 2009 only recently have efforts started appearing to ensure mems are ecologically realistic and can replicate observed spatial and temporal patterns link et al 2020 moullec et al 2019 e g oliveros ramos et al 2017 petrik et al 2020 püts et al 2020 what would be the needed steps to execute systematic assessments such as calibration and validation of a spatial temporal marine ecosystem model and why has it proven so hard to implement widely from our shared perspective we contend that to improve the outcomes and confidence of mems we must address one of the most basic issues that confront marine ecosystem modellers technical limitations that prohibit the systematic mass execution of mems to perform these assessments fig 2 we review the required steps highlighted and occasionally applied in the literature to perform robust ecosystem simulations we explore the technical challenges that complicate the implementation of robust simulations we conclude by proposing a conceptual solution that is cost effective scalable and most importantly simple to facilitate global uptake 2 review 2 1 skill assessments first one needs to be able to quantify how well a mem reproduces relevant historical ecological and socio economic trends using available data this analysis is captured broadly under the term skill assessments where mem skill is appraised by comparing the residuals between model output and observations using quantitative metrics stow et al 2009 the literature provides many suggestions for metrics and their application to assess the skill of models to reproduce observations as reviewed by bennett et al 2013 and hipsey et al 2020 traditional skill metrics encompass univariate and multivariate statistical approaches diele and marangi 2020 matott et al 2009 stow et al 2009 but their focus on quantifying adherence to observations makes statistical approaches less useful to explain ecological behaviour olsen et al 2016 pennekamp et al 2017 therefore to obtain deeper insights into the ecological patterns and processes within mem output system wide metrics should be included which assess emergent properties such as ecological patterns in marine food webs network structures fath et al 2019 and commonly accepted ecological indicators coll and steenbeek 2017 olsen et al 2016 assemblies of skill metrics gupta et al 2012 olsen et al 2016 stow et al 2009 or multi level skill metrics hipsey et al 2020 unify several approaches into information rich skill assessment frameworks the choice of skill metrics is highly dependent on model structure available data ecological understanding the spatial and temporal scales over which modelled processes play out fulton et al 2009 and the purpose for which a given model was built bennett et al 2013 olsen et al 2016 uusitalo et al 2016 in the realm of marine ecosystem modelling skill metrics are extensively used in model validation and time series fitting exercises for non spatial mems in contrast comprehensive skill assessments for spatially explicit mems are mostly absent from the literature 2 2 uncertainty second there is the issue of uncertainty which propagates through the non linear processes and feedbacks in complex models and may overwhelm significant trends in model output fulton et al 2003 link et al 2012 as such uncertainty warrants comprehensive identification quantification and communication for interpreting results and assessing mem skill uusitalo et al 2016 there are four main types of uncertainty in complex deterministic models payne et al 2016 as laid out below in the order of model development and execution these have not been addressed equally with much of the modelling literature focused on parametric uncertainty until fairly recently wang and grant 2019 1 structural uncertainty or model uncertainty derives from the equations used to construct a model and the implicit hypotheses they represent mems are inherently subject to structural uncertainty due to their simplification of complex ecosystem dynamics collie et al 2016 and parameterizations e g anderson et al 2010 insights into the impact of structural uncertainty can be garnered through ensemble modelling approaches lewis et al 2021 lotze et al 2019 flexibility in the coupling between biophysical forcing and ecosystem models tittensor et al 2018 and flexibility in the inclusion of ecological mechanisms within complex models audzijonyte et al 2019 coll et al 2020 hybrid models that adaptively switch the mathematical representations of sub models to best suit the state of an ecosystem gray and wotherspoon 2015 are a promising yet underexplored approach for addressing structural uncertainty 2 initialization and internal variability iiv uncertainty relates to the uncertainty in adequately representing the initial conditions temporal variabilities and numerical sensitivities within complex models that may lead to deterministic chaos anderson et al 2010 promising approaches include adopting a modular design to model construction that allows for bypassing internal computations with the advice from dedicated expert models christensen et al 2014 coll et al 2020 steenbeek et al 2016 climate models quantify iiv uncertainty by starting models at different times with different realizations e g nadiga et al 2019 which is hard to achieve for marine ecosystem models that have much more complex starting states to represent the living components in the system e g skogen et al 2021 this difficulty is exacerbated by the much sparser nature of ecological data which has yet to achieve the precision and coverage of physiochemical ocean properties as such beyond the use of burn in or spin up periods to address the impact of initialization uncertainty lack of explicit discussion in the literature leads us to believe that iiv uncertainty is a largely under explored area in marine ecosystem modelling e g woodworth jefcoats et al 2019 3 parametric uncertainty refers to how perturbations in input parameters or in abstract parameters also called tuning parameters or hyperparameters that bear no direct ecological relevance can influence model outcomes for input parameters this type of uncertainty is commonly explored by varying these parameters according to pre defined plausible ranges and shapes based on in situ measurements and observations or on ecological theory such as species functional responses to environmental drivers austin 2007 while state space models offer potential to calibrate abstract parameters spence et al 2021 full parametric uncertainty assessments are impossible for complex ecosystem models gaichas et al 2012 but comprehensive assessments such as management strategy evaluation mse where the impact of parameters that reflect ecologically viable ecosystem states are explored e g mackinson et al 2017 are mostly confined to non spatial models for more complex models adaptive parameter sensitivity screening pantus 2007 may serve to greatly reduce the number of needed parametric uncertainty iterations uncertainties in observations skogen et al 2021 and driver data coll et al 2020 can be considered as parametric uncertainty too and should be treated as such in uncertainty assessments 4 scenario uncertainty relates to the inability to accurately define future contexts within which the dynamic conditions captured within a mem play out this type of uncertainty can be addressed by conducting scenario analysis i e exploring alternative paths along which the future might unfold van der heijden 2005 and running models for ranges of possible futures this allows for exploration of upper and lower bounds to assumptions regarding socio economic pathways and climate change thus obtaining a bandwidth of predictions for possible futures de mutsert et al 2021 hamon et al 2021 lotze et al 2019 maury et al 2017 closely related is the uncertainty in making ecosystem predictions for future conditions based on present and past conditions it is widely acknowledged that a mem s ability to replicate the past explanatory prediction is by no means a guarantee that it can accurately predict the future anticipatory prediction under combinations of parameter values that have not yet been encountered olsen et al 2016 pennekamp et al 2017 in ecosystem modelling this challenge is typically addressed by partitioning observational data into a historical part for training and forecast portion for testing however pennekamp et al 2017 argue against this approach stating that training data and test data should be independent and that the gold standard of prediction is a transferrable model that can genuinely predict a novel state of a system mems such as atlantis audzijonyte et al 2019 osmose shin and cury 2004 and ecopath with ecosim christensen and walters 2004 strike a balance offering transferrable equations and ecological assumptions to describe generic ecological processes cuddington et al 2013 but requiring location and time specific empirical data to parameterize for a specific ecosystem mem ensemble modelling where multiple mems each with their strengths and weaknesses are forced under shared drivers of change is seen as another gold standard for projecting the magnitude and distribution of the impacts of changing environments and anthropogenic activities ensemble modelling is increasingly applied lotze et al 2019 piroddi et al 2021 e g tittensor et al 2018 and aims to side step uncertainty related issues by obtaining average projections across a range of different ecosystem models an approach that commonly outperforms any single model rougier 2016 however spence et al 2018 argue that using multiple model averages is not a guarantee to provide the best prediction as discrepancies in each of the models are not independent they demonstrate that statistical meta modelling allows focussing on individual models strengths in an ensemble approach drawing benefit from fundamental differences in underlying structures in each of the models with the potential to reduce the impact of structural and parameter uncertainty 2 3 ecological realism third it must be possible to quantify whether an ecosystem model produces results that are based on ecologically plausible parameter sets as correlation between model output and observations does not guarantee a model will adhere to natural processes anderson et al 2010 i e that it is correct for the right reasons these emergent properties of mems are equally important for model credibility as comparing predicted and observed values thus models should adhere to basic expectations about their input parameterization such as mass balancing constraints heymans et al 2016 expectations of the spread of biomasses and vital ratios across trophic levels link 2010 and reproduction of a myriad of observed meta patterns with ecosystems monbet 1992 schwinghamer 1981 e g sheldon et al 1972 more generically multi level skill metrics can quantify the ability of a model to capture relevant processes at the population food web and ecosystem level hipsey et al 2020 lewis et al 2021 with potential applications for machine learning approaches williams et al 2014 assessing ecological realism of state variables within a running mem is much trickier and leaves open the debate whether a model s ability to reproduce observed trends is ecologically realistic or a merely numerical artefact arhonditsis and brett 2004 exacerbated by the general equifinal hipsey et al 2020 and underdetermined anderson et al 2010 nature of ecosystem models safeguarding internal ecological realism can be improved through careful selection of the geometric numerical integrations used within a mem diele and marangi 2020 for mems that are open to code modifications internal state variables for instance related to consumption displacement recruitment niches mortalities etc can be added to the list of model outputs thus enabling independent validation of the internal state of a model while a mem executes ecological validation of spatial temporal models greatly increases data demands bounds for processes for which no empirical data are available can be estimated from literature hamel and bryant 2017 or can be approximated through simpler sub models such as models of intermediate complexity mice plaganyí 2007 non deterministic models mullon et al 2009 planque et al 2014 that focus on specific processes or complex models that focus on sub regional dynamics e g de mutsert et al 2017 2 4 model calibration last there is the crucial issue of how to improve the calibration of a mem calibrating is the process of adjusting input parameters to obtain the best fit between model output and observed values arhonditsis and brett 2004 whereas simple or non spatial ecological models are analysed and optimized regularly with automated tools complex process based spatial temporal ecosystem model calibration is largely a manual effort guided by intuition anderson et al 2010 expert opinion krueger et al 2012 and limited ad hoc analysis anderson et al 2010 pethybridge et al 2019 or brute force monte carlo approaches spence et al 2021 demonstrate that fitting a model to more or longer time series of observations will reduce the uncertainty in abstract parameters but cannot counter the uncertainty in input parameters thus indicating that abstract parameters such as the vulnerability parameter in ecopath with ecosim christensen and walters 2004 may be more suitable targets for model calibration than input parameters adaptive screening pantus 2007 and press perturbations hipsey et al 2020 are comparatively less demanding approaches to identify the most sensitive parameters after which sensitivity tests and ecological realism tests can further identify candidate variables for improving a model fit multivariate comparison methods hipsey et al 2020 and machine learning techniques williams et al 2014 can reveal emergent patterns that may provide further clues to refining a models behaviour 3 challenges naturally assessing spatial temporal models depends on the availability of large amounts of data that may be hard to come by this is a legitimate and often acknowledged modelling challenge however experienced modellers can point to multiple cases where systematic validation does not occur even when more comprehensive datasets exist this experience confirms that data or the lack thereof is not the sole perhaps not even the main bottleneck to the implementation of frameworks that systematically assess validate and improve outputs of mems we rather highlight what is possibly the main hurdle to improving the parameterization of complex mems prohibitive computational cost looking across the literature only a few papers touch on the topic e g fer et al 2018 pethybridge et al 2019 whereas some of the most computationally demanding models such as oceanographic physical biogeochemical models are validated in a systematic way mems are not suggesting that there are additional bottlenecks that prohibit mems from making similar advances here we identify the main technical bottlenecks 3 1 model architecture the ability to access internal state variables flexibility in the use of model assumptions and flexibility in a model s scope are all rooted in how a model software is designed and implemented with implications for the level of control modellers have to assess and improve their model s behaviour steenbeek et al 2016 despite a growing trend of specialization robson 2014 marine ecosystem models are often being initiated by ecologists or mathematicians rather than computer scientists or software engineers mems are mostly slowly developing emergent products of a research team s progressive work on addressing specific research questions with some notable exceptions audzijonyte et al 2019 purves et al 2013 steenbeek et al 2016 the choice of analytical framework programming language operating system and other implementation decisions tend to be dictated by the experiences within a research group consequently mems are still rarely developed according to modern software engineering practices publications that detail marine ecosystem model capabilities focus on equations but rarely mention the design of the underlying software architecture and design principles that can provide invaluable insights in the true potential of a model the lack of transparency is exacerbated by the fact that most mems do not provide access to their source code limiting the ability to evaluate the inner workings and thus to systematically recalibrate such a model jardim et al 2021 e g steenbeek et al 2016 it must be noted that even where significant effort has gone into discussing the implications of particular design decisions the capacity to revisit those decisions over the course of decades is often hampered by academic funding schemes these look to new tools and novel applications and expressly do not support code revision and large scale overhauls of the kind typical in commercial software products moreover the open access motivation of scientific programmers means there is no licencing funds to draw on for such revision work either while some of the global mems may be drawn into earth system modelling stables with support through funding arrangements oriented toward supporting global programs such as ipcc and ipbes it is likely that regional models will remain in this funding scheme for the foreseeable future 3 2 computational costs a major prohibiting factor to executing mems is computational complexity mems incorporate a wide range of deterministic and stochastic approaches to represent discrete and continuous processes which can play out at vastly different temporal and spatial scales this calls for use of a wide range of mathematical approaches that must interlink while a model iterates over time especially when considering the ubiquitous presence of non linear species interdependencies with feedbacks across the food web over space and time while the implementation of individual mathematical solutions can be highly optimized in computer code the need to connect different processes through non linear interactions between species changing environmental conditions and fisheries within a mem means that the computational runtime of most mems can be reduced only to a degree when integrating climate hind and forecasts a running mem requires access to many types of spatial temporal explicit data that describes the relevant environmental changes over time the volumes of required data can be ingested from pre computed time series of maps or through one way or bi directional linkages with expert models in return mems produce volumes of spatial temporal estimates related to species presence densities and inter species interactions that require storage for further analysis file access is one of the slowest aspects of high performance computing harrington et al 2017 which means that a mem can appear computationally slow when in fact access to data storage is the limiting factor this issue can be remedied in several ways but it can be as simple as using different storage devices for reading and writing data or by making technical provisions within a model s code high performance computing hpc is the de facto standard to run complex models on dedicated hardware but from the summary above it is obvious that unless a mem is specifically designed to utilize the benefits of a specific cluster high performance hardware can only offer partial reprieve deploying model software on clusters can be complicated and may require technical assistance and academic institutional access to hpc infrastructures is still limited especially in the developing world moses mwasaga and joy 2020 most commercial hpc facilities allow only execution of software that is written to strict application programming interfaces apis to enforce security and prevent misuse and use pricing models that are beyond academic budgets public scientific distributed computing efforts including volunteer computing frameworks agliamzanov et al 2019 e g anderson et al 2002 scientific clusters such as galileo galileo 2021 and open source projects such as ray moritz et al 2018 allow scientific code to run in their original form but only cater to lightweight processes scalable distributed computing platforms that allow original code to run by packaging them in containers e g ahmed and pierre 2018 are equally suitable only for low processing needs and data volumes while requiring considerable skill and some funding to operate 4 recommendations we thus contend that although hpc offers significant benefits in processing power for running mem validation and fitting frameworks limited availability to academia means that they cannot be the focal platform for hosting a generic solution to solve the immediate challenges that the global mem community faces we pose that the global mem community needs a technical remote execution framework that supports the simultaneous execution of multiple mem simulations where a desktop workflow is simply scaled up to be performed many times on available computers fig 3 with minimal reliance on funding programming skills and hpc access to facilitate global uptake and mem capacity building we suggest that a remote execution framework should have a number of specific characteristics to enable simultaneous perturbation execution and analysis of resource heavy mems and their results these characteristics include generic a framework should support the execution of any scientific software and should not be tied to any specific mem or analytical software in order to facilitate the broadest possible uptake among the scientific community simple a framework must be able to run models and statistical tools as they are i e in their legacy form without substantial adjustment or redevelopment as executed on a single desktop or workstation just scaled up across a larger computing infrastructure and executed simultaneously it is crucial that executed tasks retain their original form to focus on solving scientific problems and do not have to be rewritten to meet specific demands of computing hardware architectures and their code frameworks cross platform a framework must be able to run on and collaborate across different operating systems distributed a framework must be able to dispatch tasks designed on a single computer to multiple computers processors or cluster nodes for simultaneous execution with straightforward means of tracking progress of those tasks self sufficient a framework should be able to synchronize run instructions possibly large amounts of driver data skill assessment diagnostics and model output without any manual intervention it would be sensible to focus on incremental data exchange protocols to distribute run data across participating hardware whether executables should be synchronized with the data needs to careful consideration as this could imply security risks and potential malicious use fast models should run in close proximity to data storages to minimize file access delays and potential bottlenecks like file access latency should be considered in the design of a framework scalable a framework must be flexible to utilize changes in hardware availability modular a framework should be built with unknown future uses in mind adopting an modular architecture that will allow expanding its workings open source the framework should be built on open source software and should be 100 open source itself to provide transparency to its inner workings to facilitate uptake and to facilitate community development low tech in order to simplify its use as little as possible knowledge about computer networking should be required to deploy and run a framework beyond the knowledge required to run the required modelling tasks cost effective it is imperative that a framework can be deployed on any available hardware with minimal specifications to account for the uneven distribution of mem capacity around the globe heymans et al 2020 collaborative ideally the framework construction should also learn from the physical sciences and their large scale collaborations to leverage the enthusiasm and resources of the mem community rather than seeing individual research groups necessarily go at it alone to our best knowledge such a framework does not exist with a physical separation between a remote execution framework and available hardware and scientific applications fig 4 a remote execution framework could be deployed to perform mem validation calibration and uncertainty assessments as follows 4 1 calibration a mem calibration exercise is a centrally controlled iterative process at the framework server given a particular parameterization of a mem informed and optimized parameter perturbations lead to dispatched mem executions across available remote computing capacity on the remote computers perturbed mems are executed and their model skill to replicate observations is assessed under the new set of parameters better fits for the correct reasons are retained by the server which keeps iterating until the calibration process has satisfactory converged a calibration report should be available for the modeller to verify the process fig 5 4 2 validation a mem validation exercise could benefit from available remote computing capacity to execute a mem and assess its skill to replicate independent validation data while adhering to ecological realism a validation summary should be available on the central server for the benefit of the modeller fig 6 4 3 uncertainty assessments in this work we reviewed various types of uncertainty here we hypothesise how the remote execution framework could be used to perform a limited structural uncertainty assessment in this particular example the aim is to find the combination of ecological hypotheses and environmental driver data to best approximate validation data the outcome of this iterative process should be captured in a calibration report for modeller scrutiny fig 7 5 conclusions the field of ecosystem modelling is now making inroads in policy and decision making arenas but the success of ecosystem modelling efforts will ultimately depend on the quality of the models robust understanding of model strengths and weaknesses and rigorous assessments and handling of error are needed in order to communicate and interpret model results with more confidence as we outline in this work the various building blocks to execute the needed assessments to obtain this robustness are readily available however the marine ecosystem modelling community is still lacking the foundation to systematically obtain these robust insights for this we need technical solutions to mass execute resource heavy ecosystem models across available computing hardware to provide the capacity to leverage new methods such as machine learning or methods from other fields and make the process of modelling better a generic framework catered to the execution of resource hungry software such as spatial temporal marine ecosystem models will prove highly useful to the modelling community and potentially other resource hungry processing and can become the foundation to allow ecosystem models to fully live up to the challenges raised by the declaration of the ocean decade heymans et al 2020 with the increasing need to apply ecosystem modelling in digital twins of the oceans nativi et al 2020 and scenario building e g ferrier et al 2016 and the emergent potential for integrating big data artificial intelligence and machine learning approaches into mechanistic ecosystem assessments e g guidi et al 2020 a generic capacity to use mems with more confidence is paramount we contend that this framework must scale up workflows that scientists are familiar with to make using the framework simple and the framework must work with any existing hardware to reduce costs last to lower the technical thresholds to adopting such a framework and to facilitate capacity building in the use of mems around the world the framework should be built on simple technologies that scientists are already familiar with because complex spatial temporal marine ecosystem modelling is already complicated enough accessible information is key to good evidence based decision making while the framework proposed here would not automatically address communication and interpretation it would directly address the need for reliable information sources that i do not require prohibitive resources to generate ii meaningfully bridge disciplines and span socioecological systems and iii allow for participatory modelling and coproduction of ocean solutions steenbeek et al 2021 2020 while it may sound like a fanciful wish list we believe it is possible given the success of github openstack apache spark and a range of other distributed frameworks comprised of predominantly open source approaches that would have been thought impossible until in place we do not doubt the framework will not spring into being full formed but will need to evolve through incremental applications it may well be that expectations and requirements will have to be adjusted throughout iterations of development nonetheless we feel it is important to share our full vision and begin working towards it in order to give mems the critical mass and credibility needed to help deliver the solutions required in addressing the many challenges already facing the world s marine ecosystems we challenge the ecosystem modelling community to construct this framework which will empower the community with the foundation for building the tools to make better use of the outcomes of spatial temporally explicit marine ecosystem models in turn this will see modelling more fully realise its capacity to help communities regional and national bodies to take ownership of their ocean resources and realise the transformational solutions needed to achieve sustainable and equitable ocean based futures author contributions js conceived and lead the study and wrote the ms all other authors participated in the euromarine foresight workshop added perspectives from their respective disciplines and contributed to crafting the final paper funding information mc and js acknowledge funding from the euromarine 2018 call for foresight workshops and working groups proposals js mc and mgp acknowledge the spanish ministry of science and innovation grant agreement n pid2020 118097rb i00 prooceans js mc and yjs acknowledge the european union s horizon 2020 research and innovation programme under grant agreements n 869300 futuremares and n 817578 triatlas adm acknowledges the european union s horizon 2020 research and innovation programme under grant agreements n 869300 futuremares mc acknowledges the severo ochoa centre of excellence accreditation cex2019 000928 s to the institute of marine science gr acknowledges the german federal ministry of education and research bmbf humboldt tipping project 01lc1823d vc acknowledges support through nserc discovery grant rgpin 2019 04901 vc and go acknowledge funding through the nserc mitacs accelerate fellowship it09266 iof ocean leaders fellowship and dfo yjs acknowledges funding support from the biodiversa and belmont forum project sombee biodivscen era net cofund programme anr contract n anr 18 ebi4 0003 01 and the pew marine fellows programme declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this paper is a product of the euromarine foresight workshop modelling for policy advice under a global change context in barcelona in 2019 https tiny one emfws we wish to thank euromarine for providing the opportunity to set this work in motion many thanks to heidi pethybridge and fabio boschetti csiro for their feedback to this manuscript js wishes to acknowledge institutional support of universitat politécnica de catalunya 
25740,marine ecosystem models mems provide a deeper understanding of marine ecosystem dynamics the united nations decade of ocean science for sustainable development has highlighted the need to deploy these complex mechanistic spatial temporal models to engage policy makers and society into dialogues towards sustainably managed oceans from our shared perspective mems remain underutilized because they still lack formal validation calibration and uncertainty quantifications that undermines their credibility and uptake in policy arenas we explore why these shortcomings exist and how to enable the global modelling community to increase mems usefulness we identify a clear gap between proposed solutions to assess model skills uncertainty and confidence and their actual systematic deployment we attribute this gap to an underlying factor that the ecosystem modelling literature largely ignores technical issues we conclude by proposing a conceptual solution that is cost effective scalable and simple because complex spatial temporal marine ecosystem modelling is already complicated enough keywords opinion spatial temporal marine ecosystem modelling capacity building systematic skill assessments systematic model calibration 1 introduction marine biodiversity is the foundation for marine ecosystem function and processes providing goods and services and bringing substantial health social and economic benefits to coastal communities and beyond worldwide increasing direct and indirect human pressures on marine biodiversity threaten a sustainable future for coupled human nature systems e g halpern et al 2019 a stronger action is needed as marine and coastal ecosystem biodiversity loss is exacerbated by climate change arneth et al 2020 e g smale et al 2019 with the simultaneous declarations of 2021 2030 as the decade of ocean science for sustainable development and the decade for ecosystem restoration the united nations has given the ocean science community a unique opportunity and imperative to work towards sustainable future oceans heymans et al 2020 ryabinin et al 2019 this includes a more extensive use of spatial temporal marine ecosystem modelling a discipline increasingly recognized as an indispensable asset to aid natural resource assessments and marine ecosystem management brotons et al 2016 christensen and maclean 2011 ipcc 2019 link et al 2011 marine ecosystem models help improve our understanding of the impacts of human activities natural phenomena and climate change on marine food webs heymans et al 2020 stow et al 2009 offering the most comprehensive platforms to unify ecological processes with statistical insights and data driven approaches ellis et al 2020 complex mechanistic ecosystem models are increasingly applied in ecological research management advice policy exploration and environmental impact analysis under climate change scenarios borja et al 2020 fulton et al 2015 kytinou et al 2020 link et al 2011 peck et al 2018 serpetti et al 2017 ecosystem modelling integrates a wide range of disciplines fulton 2010 including physical oceanography biochemistry food web dynamics risk analysis decision making economics and the social sciences fig 1 for proper understanding of the interplay between species habitats natural phenomena anthropogenic stressors and management actions models are required that are inherently dynamical and spatially explicit across temporal and spatial scales that can span several orders of magnitude hyder et al 2015 there is an urgent need for ecosystem models to rise to the ocean decade challenges heymans et al 2020 by i making ecosystem modelling more accessible to decision makers and ocean managers ii bridging disciplines to meaningfully communicate marine ecosystem modelling sciences to the audiences that need it and iii ensuring that marine ecosystem models are co created and co designed with stakeholders to enhance their application from our perspectives across various scientific disciplines collected during an euromarine foresight workshop held in barcelona in 2019 we argue that most modellers do not utilize their models to their full capacity consequently in this paper we explore a fourth challenge iv solving the long standing technical problems that prevent robust use of spatial temporally explicit marine ecosystem models and making their outcomes more credible while aspects of this discussion could apply to many of the complex modelling in different scientific fields we focus on marine ecosystem models these models span a broad range of model types and modelling philosophies nevertheless they face common challenges consequently for the sake of brevity and unless explicitly stated all modelling henceforth will refer to the use of complex mechanistic spatially and temporally explicit models that concern the dynamics of marine life and the influence of drivers of change the models themselves will be referred to by their common acronym mem marine ecosystem model lotze et al 2019 this class of models explicitly represent food web and spatial distribution processes that are driven by habitat and other environmental or anthropogenic factors whereas non spatial marine ecosystem models and complex and computationally demanding global circulation models and hydrodynamic models have a long history of model benchmarking christensen and maclean 2011 spatially temporally explicit mems that represent complex energetic pathways have not made significant advances in this realm e g oliveros ramos et al 2017 pethybridge et al 2019 regarding prediction capabilities the quantification of uncertainties and errors in mem output is essential to identify model strengths and limitations which provides the transparency needed to interpret communicate and apply model results bennett et al 2013 hyder et al 2015 stelzenmüller et al 2018 uusitalo et al 2016 this topic is a recurring and persistent concern despite a discussion extending back to the early 1980s hamel and bryant 2017 pennekamp et al 2017 rounsevell et al 2021 even though there is a wide array of suggested methodologies and potential frameworks to improve the use of mems hipsey et al 2020 e g robson et al 2018 their applications is rarely described in the literature pethybridge et al 2019 despite the number of papers calling for comprehensive model validations assessment of the various types of uncertainty and calibration fulton 2011 grüss et al 2017 hipsey et al 2020 rose et al 2010 schuwirth et al 2019 stelzenmüller et al 2018 stow et al 2009 only recently have efforts started appearing to ensure mems are ecologically realistic and can replicate observed spatial and temporal patterns link et al 2020 moullec et al 2019 e g oliveros ramos et al 2017 petrik et al 2020 püts et al 2020 what would be the needed steps to execute systematic assessments such as calibration and validation of a spatial temporal marine ecosystem model and why has it proven so hard to implement widely from our shared perspective we contend that to improve the outcomes and confidence of mems we must address one of the most basic issues that confront marine ecosystem modellers technical limitations that prohibit the systematic mass execution of mems to perform these assessments fig 2 we review the required steps highlighted and occasionally applied in the literature to perform robust ecosystem simulations we explore the technical challenges that complicate the implementation of robust simulations we conclude by proposing a conceptual solution that is cost effective scalable and most importantly simple to facilitate global uptake 2 review 2 1 skill assessments first one needs to be able to quantify how well a mem reproduces relevant historical ecological and socio economic trends using available data this analysis is captured broadly under the term skill assessments where mem skill is appraised by comparing the residuals between model output and observations using quantitative metrics stow et al 2009 the literature provides many suggestions for metrics and their application to assess the skill of models to reproduce observations as reviewed by bennett et al 2013 and hipsey et al 2020 traditional skill metrics encompass univariate and multivariate statistical approaches diele and marangi 2020 matott et al 2009 stow et al 2009 but their focus on quantifying adherence to observations makes statistical approaches less useful to explain ecological behaviour olsen et al 2016 pennekamp et al 2017 therefore to obtain deeper insights into the ecological patterns and processes within mem output system wide metrics should be included which assess emergent properties such as ecological patterns in marine food webs network structures fath et al 2019 and commonly accepted ecological indicators coll and steenbeek 2017 olsen et al 2016 assemblies of skill metrics gupta et al 2012 olsen et al 2016 stow et al 2009 or multi level skill metrics hipsey et al 2020 unify several approaches into information rich skill assessment frameworks the choice of skill metrics is highly dependent on model structure available data ecological understanding the spatial and temporal scales over which modelled processes play out fulton et al 2009 and the purpose for which a given model was built bennett et al 2013 olsen et al 2016 uusitalo et al 2016 in the realm of marine ecosystem modelling skill metrics are extensively used in model validation and time series fitting exercises for non spatial mems in contrast comprehensive skill assessments for spatially explicit mems are mostly absent from the literature 2 2 uncertainty second there is the issue of uncertainty which propagates through the non linear processes and feedbacks in complex models and may overwhelm significant trends in model output fulton et al 2003 link et al 2012 as such uncertainty warrants comprehensive identification quantification and communication for interpreting results and assessing mem skill uusitalo et al 2016 there are four main types of uncertainty in complex deterministic models payne et al 2016 as laid out below in the order of model development and execution these have not been addressed equally with much of the modelling literature focused on parametric uncertainty until fairly recently wang and grant 2019 1 structural uncertainty or model uncertainty derives from the equations used to construct a model and the implicit hypotheses they represent mems are inherently subject to structural uncertainty due to their simplification of complex ecosystem dynamics collie et al 2016 and parameterizations e g anderson et al 2010 insights into the impact of structural uncertainty can be garnered through ensemble modelling approaches lewis et al 2021 lotze et al 2019 flexibility in the coupling between biophysical forcing and ecosystem models tittensor et al 2018 and flexibility in the inclusion of ecological mechanisms within complex models audzijonyte et al 2019 coll et al 2020 hybrid models that adaptively switch the mathematical representations of sub models to best suit the state of an ecosystem gray and wotherspoon 2015 are a promising yet underexplored approach for addressing structural uncertainty 2 initialization and internal variability iiv uncertainty relates to the uncertainty in adequately representing the initial conditions temporal variabilities and numerical sensitivities within complex models that may lead to deterministic chaos anderson et al 2010 promising approaches include adopting a modular design to model construction that allows for bypassing internal computations with the advice from dedicated expert models christensen et al 2014 coll et al 2020 steenbeek et al 2016 climate models quantify iiv uncertainty by starting models at different times with different realizations e g nadiga et al 2019 which is hard to achieve for marine ecosystem models that have much more complex starting states to represent the living components in the system e g skogen et al 2021 this difficulty is exacerbated by the much sparser nature of ecological data which has yet to achieve the precision and coverage of physiochemical ocean properties as such beyond the use of burn in or spin up periods to address the impact of initialization uncertainty lack of explicit discussion in the literature leads us to believe that iiv uncertainty is a largely under explored area in marine ecosystem modelling e g woodworth jefcoats et al 2019 3 parametric uncertainty refers to how perturbations in input parameters or in abstract parameters also called tuning parameters or hyperparameters that bear no direct ecological relevance can influence model outcomes for input parameters this type of uncertainty is commonly explored by varying these parameters according to pre defined plausible ranges and shapes based on in situ measurements and observations or on ecological theory such as species functional responses to environmental drivers austin 2007 while state space models offer potential to calibrate abstract parameters spence et al 2021 full parametric uncertainty assessments are impossible for complex ecosystem models gaichas et al 2012 but comprehensive assessments such as management strategy evaluation mse where the impact of parameters that reflect ecologically viable ecosystem states are explored e g mackinson et al 2017 are mostly confined to non spatial models for more complex models adaptive parameter sensitivity screening pantus 2007 may serve to greatly reduce the number of needed parametric uncertainty iterations uncertainties in observations skogen et al 2021 and driver data coll et al 2020 can be considered as parametric uncertainty too and should be treated as such in uncertainty assessments 4 scenario uncertainty relates to the inability to accurately define future contexts within which the dynamic conditions captured within a mem play out this type of uncertainty can be addressed by conducting scenario analysis i e exploring alternative paths along which the future might unfold van der heijden 2005 and running models for ranges of possible futures this allows for exploration of upper and lower bounds to assumptions regarding socio economic pathways and climate change thus obtaining a bandwidth of predictions for possible futures de mutsert et al 2021 hamon et al 2021 lotze et al 2019 maury et al 2017 closely related is the uncertainty in making ecosystem predictions for future conditions based on present and past conditions it is widely acknowledged that a mem s ability to replicate the past explanatory prediction is by no means a guarantee that it can accurately predict the future anticipatory prediction under combinations of parameter values that have not yet been encountered olsen et al 2016 pennekamp et al 2017 in ecosystem modelling this challenge is typically addressed by partitioning observational data into a historical part for training and forecast portion for testing however pennekamp et al 2017 argue against this approach stating that training data and test data should be independent and that the gold standard of prediction is a transferrable model that can genuinely predict a novel state of a system mems such as atlantis audzijonyte et al 2019 osmose shin and cury 2004 and ecopath with ecosim christensen and walters 2004 strike a balance offering transferrable equations and ecological assumptions to describe generic ecological processes cuddington et al 2013 but requiring location and time specific empirical data to parameterize for a specific ecosystem mem ensemble modelling where multiple mems each with their strengths and weaknesses are forced under shared drivers of change is seen as another gold standard for projecting the magnitude and distribution of the impacts of changing environments and anthropogenic activities ensemble modelling is increasingly applied lotze et al 2019 piroddi et al 2021 e g tittensor et al 2018 and aims to side step uncertainty related issues by obtaining average projections across a range of different ecosystem models an approach that commonly outperforms any single model rougier 2016 however spence et al 2018 argue that using multiple model averages is not a guarantee to provide the best prediction as discrepancies in each of the models are not independent they demonstrate that statistical meta modelling allows focussing on individual models strengths in an ensemble approach drawing benefit from fundamental differences in underlying structures in each of the models with the potential to reduce the impact of structural and parameter uncertainty 2 3 ecological realism third it must be possible to quantify whether an ecosystem model produces results that are based on ecologically plausible parameter sets as correlation between model output and observations does not guarantee a model will adhere to natural processes anderson et al 2010 i e that it is correct for the right reasons these emergent properties of mems are equally important for model credibility as comparing predicted and observed values thus models should adhere to basic expectations about their input parameterization such as mass balancing constraints heymans et al 2016 expectations of the spread of biomasses and vital ratios across trophic levels link 2010 and reproduction of a myriad of observed meta patterns with ecosystems monbet 1992 schwinghamer 1981 e g sheldon et al 1972 more generically multi level skill metrics can quantify the ability of a model to capture relevant processes at the population food web and ecosystem level hipsey et al 2020 lewis et al 2021 with potential applications for machine learning approaches williams et al 2014 assessing ecological realism of state variables within a running mem is much trickier and leaves open the debate whether a model s ability to reproduce observed trends is ecologically realistic or a merely numerical artefact arhonditsis and brett 2004 exacerbated by the general equifinal hipsey et al 2020 and underdetermined anderson et al 2010 nature of ecosystem models safeguarding internal ecological realism can be improved through careful selection of the geometric numerical integrations used within a mem diele and marangi 2020 for mems that are open to code modifications internal state variables for instance related to consumption displacement recruitment niches mortalities etc can be added to the list of model outputs thus enabling independent validation of the internal state of a model while a mem executes ecological validation of spatial temporal models greatly increases data demands bounds for processes for which no empirical data are available can be estimated from literature hamel and bryant 2017 or can be approximated through simpler sub models such as models of intermediate complexity mice plaganyí 2007 non deterministic models mullon et al 2009 planque et al 2014 that focus on specific processes or complex models that focus on sub regional dynamics e g de mutsert et al 2017 2 4 model calibration last there is the crucial issue of how to improve the calibration of a mem calibrating is the process of adjusting input parameters to obtain the best fit between model output and observed values arhonditsis and brett 2004 whereas simple or non spatial ecological models are analysed and optimized regularly with automated tools complex process based spatial temporal ecosystem model calibration is largely a manual effort guided by intuition anderson et al 2010 expert opinion krueger et al 2012 and limited ad hoc analysis anderson et al 2010 pethybridge et al 2019 or brute force monte carlo approaches spence et al 2021 demonstrate that fitting a model to more or longer time series of observations will reduce the uncertainty in abstract parameters but cannot counter the uncertainty in input parameters thus indicating that abstract parameters such as the vulnerability parameter in ecopath with ecosim christensen and walters 2004 may be more suitable targets for model calibration than input parameters adaptive screening pantus 2007 and press perturbations hipsey et al 2020 are comparatively less demanding approaches to identify the most sensitive parameters after which sensitivity tests and ecological realism tests can further identify candidate variables for improving a model fit multivariate comparison methods hipsey et al 2020 and machine learning techniques williams et al 2014 can reveal emergent patterns that may provide further clues to refining a models behaviour 3 challenges naturally assessing spatial temporal models depends on the availability of large amounts of data that may be hard to come by this is a legitimate and often acknowledged modelling challenge however experienced modellers can point to multiple cases where systematic validation does not occur even when more comprehensive datasets exist this experience confirms that data or the lack thereof is not the sole perhaps not even the main bottleneck to the implementation of frameworks that systematically assess validate and improve outputs of mems we rather highlight what is possibly the main hurdle to improving the parameterization of complex mems prohibitive computational cost looking across the literature only a few papers touch on the topic e g fer et al 2018 pethybridge et al 2019 whereas some of the most computationally demanding models such as oceanographic physical biogeochemical models are validated in a systematic way mems are not suggesting that there are additional bottlenecks that prohibit mems from making similar advances here we identify the main technical bottlenecks 3 1 model architecture the ability to access internal state variables flexibility in the use of model assumptions and flexibility in a model s scope are all rooted in how a model software is designed and implemented with implications for the level of control modellers have to assess and improve their model s behaviour steenbeek et al 2016 despite a growing trend of specialization robson 2014 marine ecosystem models are often being initiated by ecologists or mathematicians rather than computer scientists or software engineers mems are mostly slowly developing emergent products of a research team s progressive work on addressing specific research questions with some notable exceptions audzijonyte et al 2019 purves et al 2013 steenbeek et al 2016 the choice of analytical framework programming language operating system and other implementation decisions tend to be dictated by the experiences within a research group consequently mems are still rarely developed according to modern software engineering practices publications that detail marine ecosystem model capabilities focus on equations but rarely mention the design of the underlying software architecture and design principles that can provide invaluable insights in the true potential of a model the lack of transparency is exacerbated by the fact that most mems do not provide access to their source code limiting the ability to evaluate the inner workings and thus to systematically recalibrate such a model jardim et al 2021 e g steenbeek et al 2016 it must be noted that even where significant effort has gone into discussing the implications of particular design decisions the capacity to revisit those decisions over the course of decades is often hampered by academic funding schemes these look to new tools and novel applications and expressly do not support code revision and large scale overhauls of the kind typical in commercial software products moreover the open access motivation of scientific programmers means there is no licencing funds to draw on for such revision work either while some of the global mems may be drawn into earth system modelling stables with support through funding arrangements oriented toward supporting global programs such as ipcc and ipbes it is likely that regional models will remain in this funding scheme for the foreseeable future 3 2 computational costs a major prohibiting factor to executing mems is computational complexity mems incorporate a wide range of deterministic and stochastic approaches to represent discrete and continuous processes which can play out at vastly different temporal and spatial scales this calls for use of a wide range of mathematical approaches that must interlink while a model iterates over time especially when considering the ubiquitous presence of non linear species interdependencies with feedbacks across the food web over space and time while the implementation of individual mathematical solutions can be highly optimized in computer code the need to connect different processes through non linear interactions between species changing environmental conditions and fisheries within a mem means that the computational runtime of most mems can be reduced only to a degree when integrating climate hind and forecasts a running mem requires access to many types of spatial temporal explicit data that describes the relevant environmental changes over time the volumes of required data can be ingested from pre computed time series of maps or through one way or bi directional linkages with expert models in return mems produce volumes of spatial temporal estimates related to species presence densities and inter species interactions that require storage for further analysis file access is one of the slowest aspects of high performance computing harrington et al 2017 which means that a mem can appear computationally slow when in fact access to data storage is the limiting factor this issue can be remedied in several ways but it can be as simple as using different storage devices for reading and writing data or by making technical provisions within a model s code high performance computing hpc is the de facto standard to run complex models on dedicated hardware but from the summary above it is obvious that unless a mem is specifically designed to utilize the benefits of a specific cluster high performance hardware can only offer partial reprieve deploying model software on clusters can be complicated and may require technical assistance and academic institutional access to hpc infrastructures is still limited especially in the developing world moses mwasaga and joy 2020 most commercial hpc facilities allow only execution of software that is written to strict application programming interfaces apis to enforce security and prevent misuse and use pricing models that are beyond academic budgets public scientific distributed computing efforts including volunteer computing frameworks agliamzanov et al 2019 e g anderson et al 2002 scientific clusters such as galileo galileo 2021 and open source projects such as ray moritz et al 2018 allow scientific code to run in their original form but only cater to lightweight processes scalable distributed computing platforms that allow original code to run by packaging them in containers e g ahmed and pierre 2018 are equally suitable only for low processing needs and data volumes while requiring considerable skill and some funding to operate 4 recommendations we thus contend that although hpc offers significant benefits in processing power for running mem validation and fitting frameworks limited availability to academia means that they cannot be the focal platform for hosting a generic solution to solve the immediate challenges that the global mem community faces we pose that the global mem community needs a technical remote execution framework that supports the simultaneous execution of multiple mem simulations where a desktop workflow is simply scaled up to be performed many times on available computers fig 3 with minimal reliance on funding programming skills and hpc access to facilitate global uptake and mem capacity building we suggest that a remote execution framework should have a number of specific characteristics to enable simultaneous perturbation execution and analysis of resource heavy mems and their results these characteristics include generic a framework should support the execution of any scientific software and should not be tied to any specific mem or analytical software in order to facilitate the broadest possible uptake among the scientific community simple a framework must be able to run models and statistical tools as they are i e in their legacy form without substantial adjustment or redevelopment as executed on a single desktop or workstation just scaled up across a larger computing infrastructure and executed simultaneously it is crucial that executed tasks retain their original form to focus on solving scientific problems and do not have to be rewritten to meet specific demands of computing hardware architectures and their code frameworks cross platform a framework must be able to run on and collaborate across different operating systems distributed a framework must be able to dispatch tasks designed on a single computer to multiple computers processors or cluster nodes for simultaneous execution with straightforward means of tracking progress of those tasks self sufficient a framework should be able to synchronize run instructions possibly large amounts of driver data skill assessment diagnostics and model output without any manual intervention it would be sensible to focus on incremental data exchange protocols to distribute run data across participating hardware whether executables should be synchronized with the data needs to careful consideration as this could imply security risks and potential malicious use fast models should run in close proximity to data storages to minimize file access delays and potential bottlenecks like file access latency should be considered in the design of a framework scalable a framework must be flexible to utilize changes in hardware availability modular a framework should be built with unknown future uses in mind adopting an modular architecture that will allow expanding its workings open source the framework should be built on open source software and should be 100 open source itself to provide transparency to its inner workings to facilitate uptake and to facilitate community development low tech in order to simplify its use as little as possible knowledge about computer networking should be required to deploy and run a framework beyond the knowledge required to run the required modelling tasks cost effective it is imperative that a framework can be deployed on any available hardware with minimal specifications to account for the uneven distribution of mem capacity around the globe heymans et al 2020 collaborative ideally the framework construction should also learn from the physical sciences and their large scale collaborations to leverage the enthusiasm and resources of the mem community rather than seeing individual research groups necessarily go at it alone to our best knowledge such a framework does not exist with a physical separation between a remote execution framework and available hardware and scientific applications fig 4 a remote execution framework could be deployed to perform mem validation calibration and uncertainty assessments as follows 4 1 calibration a mem calibration exercise is a centrally controlled iterative process at the framework server given a particular parameterization of a mem informed and optimized parameter perturbations lead to dispatched mem executions across available remote computing capacity on the remote computers perturbed mems are executed and their model skill to replicate observations is assessed under the new set of parameters better fits for the correct reasons are retained by the server which keeps iterating until the calibration process has satisfactory converged a calibration report should be available for the modeller to verify the process fig 5 4 2 validation a mem validation exercise could benefit from available remote computing capacity to execute a mem and assess its skill to replicate independent validation data while adhering to ecological realism a validation summary should be available on the central server for the benefit of the modeller fig 6 4 3 uncertainty assessments in this work we reviewed various types of uncertainty here we hypothesise how the remote execution framework could be used to perform a limited structural uncertainty assessment in this particular example the aim is to find the combination of ecological hypotheses and environmental driver data to best approximate validation data the outcome of this iterative process should be captured in a calibration report for modeller scrutiny fig 7 5 conclusions the field of ecosystem modelling is now making inroads in policy and decision making arenas but the success of ecosystem modelling efforts will ultimately depend on the quality of the models robust understanding of model strengths and weaknesses and rigorous assessments and handling of error are needed in order to communicate and interpret model results with more confidence as we outline in this work the various building blocks to execute the needed assessments to obtain this robustness are readily available however the marine ecosystem modelling community is still lacking the foundation to systematically obtain these robust insights for this we need technical solutions to mass execute resource heavy ecosystem models across available computing hardware to provide the capacity to leverage new methods such as machine learning or methods from other fields and make the process of modelling better a generic framework catered to the execution of resource hungry software such as spatial temporal marine ecosystem models will prove highly useful to the modelling community and potentially other resource hungry processing and can become the foundation to allow ecosystem models to fully live up to the challenges raised by the declaration of the ocean decade heymans et al 2020 with the increasing need to apply ecosystem modelling in digital twins of the oceans nativi et al 2020 and scenario building e g ferrier et al 2016 and the emergent potential for integrating big data artificial intelligence and machine learning approaches into mechanistic ecosystem assessments e g guidi et al 2020 a generic capacity to use mems with more confidence is paramount we contend that this framework must scale up workflows that scientists are familiar with to make using the framework simple and the framework must work with any existing hardware to reduce costs last to lower the technical thresholds to adopting such a framework and to facilitate capacity building in the use of mems around the world the framework should be built on simple technologies that scientists are already familiar with because complex spatial temporal marine ecosystem modelling is already complicated enough accessible information is key to good evidence based decision making while the framework proposed here would not automatically address communication and interpretation it would directly address the need for reliable information sources that i do not require prohibitive resources to generate ii meaningfully bridge disciplines and span socioecological systems and iii allow for participatory modelling and coproduction of ocean solutions steenbeek et al 2021 2020 while it may sound like a fanciful wish list we believe it is possible given the success of github openstack apache spark and a range of other distributed frameworks comprised of predominantly open source approaches that would have been thought impossible until in place we do not doubt the framework will not spring into being full formed but will need to evolve through incremental applications it may well be that expectations and requirements will have to be adjusted throughout iterations of development nonetheless we feel it is important to share our full vision and begin working towards it in order to give mems the critical mass and credibility needed to help deliver the solutions required in addressing the many challenges already facing the world s marine ecosystems we challenge the ecosystem modelling community to construct this framework which will empower the community with the foundation for building the tools to make better use of the outcomes of spatial temporally explicit marine ecosystem models in turn this will see modelling more fully realise its capacity to help communities regional and national bodies to take ownership of their ocean resources and realise the transformational solutions needed to achieve sustainable and equitable ocean based futures author contributions js conceived and lead the study and wrote the ms all other authors participated in the euromarine foresight workshop added perspectives from their respective disciplines and contributed to crafting the final paper funding information mc and js acknowledge funding from the euromarine 2018 call for foresight workshops and working groups proposals js mc and mgp acknowledge the spanish ministry of science and innovation grant agreement n pid2020 118097rb i00 prooceans js mc and yjs acknowledge the european union s horizon 2020 research and innovation programme under grant agreements n 869300 futuremares and n 817578 triatlas adm acknowledges the european union s horizon 2020 research and innovation programme under grant agreements n 869300 futuremares mc acknowledges the severo ochoa centre of excellence accreditation cex2019 000928 s to the institute of marine science gr acknowledges the german federal ministry of education and research bmbf humboldt tipping project 01lc1823d vc acknowledges support through nserc discovery grant rgpin 2019 04901 vc and go acknowledge funding through the nserc mitacs accelerate fellowship it09266 iof ocean leaders fellowship and dfo yjs acknowledges funding support from the biodiversa and belmont forum project sombee biodivscen era net cofund programme anr contract n anr 18 ebi4 0003 01 and the pew marine fellows programme declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this paper is a product of the euromarine foresight workshop modelling for policy advice under a global change context in barcelona in 2019 https tiny one emfws we wish to thank euromarine for providing the opportunity to set this work in motion many thanks to heidi pethybridge and fabio boschetti csiro for their feedback to this manuscript js wishes to acknowledge institutional support of universitat politécnica de catalunya 
25741,this paper introduces a probabilistic approach to spatio temporal high resolution meso scale modeling of near surface temperature and applies it to regions of dimension about 150 200 km with 1 km grid spacing and 30 min interval our probabilistic approach based on linear gaussian models and dimensionality reduction can accurately forecast short term temperature fields and serve as a computationally less expensive alternative to physics based models that necessitate high performance computing the probabilistic models here are calibrated from simulations of a physics based model the princeton urban canopy model coupled to the weather research and forecasting model wrf pucm we assess the performance of the calibrated models to forecast short term near surface temperature in various cases in the numerical campaign our models achieve 0 97 1 13 c root mean squared error rmse for 24 hours ahead forecast generating three days of forecast takes between 20 and 170 sec on a single processor intel xeon e5 2690 v4 2 60ghz hence the proposed approach provides predictions at relatively high accuracy and low computational cost graphical abstract image 1 keywords urban heat probabilistic model spatio temporal model latent space state space model kalman filter 1 introduction temperature has a remarkable influence on human society ranging from heat related casualties to economic loss heatwaves are reportedly one of the deadliest weather related hazards in the united states changnon et al 1996 robinson 2001 and killed more than 160 000 people around the globe between 1998 and 2017 including an annual spike of 72 000 deaths in europe in 2003 wallemacq and house 2018 the economic impact of extreme temperature includes extra energy consumption increased water use lost productivity and other additional costs in the built environment santamouris et al 2015 guhathakurta and gober 2007 zuo et al 2015 due to the high population and vulnerability to heat stressors urban areas provide more relevant applications for high resolution surface temperature forecasts by trapping heat within the building canopy and through other physical mechanisms such as reduced evapotranspiration urban areas increase their near surface temperature 4 4 hereafter the term near surface temperature refers to the 2m air temperature which measures ambient air temperature at 2m above the ground we select this quantity because it has more direct influences on human comfort and mortality than the strictly defined surface temperature anderson and bell 2009 voogt and oke 2003 higher than that of their surrounding environment an effect known as urban heat island or uhi uhi has been shown to have a non linear synergy with extreme heatwaves such that an urban area can be exposed to more severe heat stressors under certain circumstances li and bou zeid 2014 numerical weather prediction nwp is the golden standard for weather research and forecast both in research and practice weyn et al 2019 nwp is based on a numerical model that solves partial differential equations for atmospheric fluid dynamics radiation transfer cloud process and other physical processes with the growth of computing power nwp has improved its accuracy and as a result highly reliable weather forecasts have become available routinely the weather research and forecasting model wrf is a representative approach for nwp used by the national weather service and researchers worldwide skamarock et al 2019 for the broad application of the nwp numerous physics models have been developed and coupled to wrf for example princeton urban canopy model pucm modifies the default single layer urban canopy model by considering heterogeneity within urban facets and urban hydrology wang et al 2013 the numerical scheme integrating wrf and pucm wrf pucm has shown high prediction performance with a bias as small as 0 4 1 1 c li and bou zeid 2014 wang et al 2013 li et al 2013 ramamurthy et al 2017 still the main challenge of nwp is its significant computational cost preventing it from being widely used for real time forecasts or analysis at the city scale which requires high spatial and or temporal resolution e g for a grid spacing in the order of 1 km to extend the applicability of nwp there have been attempts to improve the spatial resolution of coarse grid simulation using statistical analysis called statistical downscaling sd methods instead of running additional fine grid simulations sd methods estimate local climate variables using statistical relationships with large scale predictors maraun and widmann 2018 sd covers a wide range of models including regression based models bias correction methods weather pattern based classification weather typing and stochastic weather generating models maraun and widmann 2018 wilby et al 2002 to our knowledge regression based models which discover empirical relationships between regional climate variables predictors and local ones predictands are the most popular method for sd because of their straightforward implementation min et al 2011 according to the discussions in maraun and widmann 2018 lanzante et al 2018 another benefit of sd includes its ability to avoid systematic errors of nwp which are typically caused by limitations in modeling local scale climate especially when sd models are trained on real weather observations many sd methods have been proposed for example authors of rodrigues et al 2018 proposed a downscaling strategy that uses deep convolutional neural networks cnns to attain higher horizontal resolution from nwp output a method based on support vector machine svm was suggested in shin and yi 2019 to downscale urban air temperature in spite of their successful outcomes the methods mentioned above lack a way to increase temporal resolution as a pure data driven approach for weather forecast another cnn based approach was proposed in weyn et al 2019 to predict one or two fundamental meteorological fields at a representative height for the climate status even though the method in weyn et al 2019 showed remarkable potentials of deep learning in weather forecast one still needs a model that enables versatile inference from various types of inputs for example a pre processing technique may be required to the model in weyn et al 2019 as well as sd models if the input has a missing value or irregular shape so that a flexible data assimilation is desired also a neural network is a black box model with intricate structure and parameters it is preferable to adopt a more comprehensible description of the system probabilistic spatio temporal models pstm characterize any complex time evolving process over a spatial domain with probabilistic descriptions although both pstm and sd are based on probability theory pstm models a spatio temporal structure of the process while most classical sd models learn a mapping from regional climate variables to local ones as discussed in the previous paragraph pstm is flexible in its usage it can perform inference even with partially missing inputs in berliner et al 2000 a bayesian hierarchical model is proposed to estimate the tropical pacific sea surface monthly temperature capturing the non linearity in el niño and la niña cressie and wikle 2015 a gaussian process gp model is developed in malings et al 2017 to approximate the urban surface temperature and it is used to optimize the sensing locations over a city via a value of information analysis malings et al 2018 however the gp based approach would need careful application when high heterogeneity is expected within the field of the climate variables for example because of the urban features in this paper we introduce a pstm approach to enable a rapid and efficient forecast of near surface temperature with adequate accuracy as a potential alternative to computationally intensive nwp the proposed method can capture complex spatial temporal patterns of temperature with simple representation when properly trained the calibrated model can leverage intricate patterns to forecast near surface temperature from the input measurements without need of using high performance computing the probabilistic method is a flexible spatio temporal downscaling that assimilates diverse types of inputs the proposed approach is based on a linear markov process with low dimensional latent states being segmented by the time of the day the latent state variables are introduced to generate full scale temperature fields from low dimensional space so the model is suitable for faster data assimilation and probabilistic forecast the model structure also has an advantage in mitigating the risk of overfitting which is high when processing a relatively small dataset of high dimensional variables e g meso scale near surface temperature fields we develop two alternative linear models in the first model the latent state is described by principal components interpreting them as global features of the temperature field principal component analysis model pca model the second model selects a set of optimal locations to predict the rest of the temperature field then the latent state is the temperatures at the selected locations optimal sensing model os model for each model we also propose an appropriate calibration method these two alternative models are investigated to compare the effectiveness of a forecast based on global features as in the pca model with another one based on local features as in the os model we calibrate the models in two meso scale regions 150 km 200 km around new york city nyc and pittsburgh pgh with 1 km grid spacing and 30 min intervals after calibrating the spatio temporal models we integrate them into a kalman filtering smoothing scheme to forecast near surface temperature by processing collected field data and approximated forecasts provided by external sources for example in our numerical test the proposed models downscale 12 km grid spacing data with varying temporal resolutions into 1 km spacing temperature fields with 30 min intervals we then compare the accuracy of the models and assess the prediction performance in several case studies this paper applies a linear gaussian state space model to a spatio temporal downscaling problem calibrating the model parameters of the hidden markov model and then performing kalman filtering smoothing to forecast short term near surface temperature in the context of this application our contributions can be summarized as 1 developing techniques for selecting latent state variables 2 proposing model calibration methods and 3 assessing model performance in several relevant case studies 2 probabilistic spatio temporal model pstm needs an efficient structure to capture dependencies among random variables in this section we provide a probabilistic description for the process of meso scale near surface temperature section 2 1 motivates the model structure and section 2 2 describes a state space representation of the spatio temporal process then section 2 3 presents two alternative models based on global and on local features and section 2 4 provides details on parameter estimation for the proposed models finally section 2 5 provides background for assimilating data collected in the field or received from external sources to forecast the evolution of temperature 2 1 motivation the near surface temperature of an urban region of dimension about 20km 20 km is influenced by the heat transfer in a much larger domain of dimension about 200km 200 km the discretized temperature field in this large domain is described by a high number of variables for example a 150km 150 km squared shape domain discretized with 1 km spacing grids yields p 22 500 degrees of freedom for each timestamp such high dimensional data pose various technical problems when calibrating a statistical model for instance calibrating the full p p transition functions requires a tremendous amount of training data not available in most cases the calibration needs to rely on a relatively small dataset so rank deficiency and overfitting are common issues in this setting to overcome these issues imposing sparsity in the transition matrix is one of the solutions and methods have been recently developed to do so as in chouzenoux and elvira 2020 however imposing sparsity would increase additional computational complexity and we are particularly interested in identifying an efficient model structure that reduces the number of model parameters thus in this paper we propose probabilistic models using a hierarchical architecture as illustrated in fig 1 2 2 state space model state space approaches have been widely adopted as a recursive scheme for estimating the state of a system and when the system is linear they are the base for a variety of kalman filter smoother schemes welch et al 1995 barber 2012 adopting a state space description we relate a vector of temperature field y t at time t of high dimension p 1 to a vector of latent state variables x t of dimension r 1 with r much lower than p the vector y t is decomposed into three additive terms an average temperature field μ τ a linear function of the low dimensional latent states x t and an error term v t 1 y t μ τ φ x t v t where φ p r is an embedding matrix and the average temperature field depends on the time of the day τ discretized into h steps from 00 00 to 24 00 e g for h 48 τ 00 00 00 30 01 00 23 30 τ is defined as τ hod t where hod is a function that returns the time of the day of timestamp t in this hierarchical structure the dynamics of high dimensional temperature fields is approximated by a linear system in low dimension the low dimensional representation reduces the number of parameters and the memory requirements in the inference process both the latent variables and the error term are modeled as gaussian random variables the error term v t is assumed as a set of independent and identically distributed random variables with zero mean and standard deviation σ v the temporal evolution for the process is assumed to follow a linear markov model whose transition matrix depends on the time of the day τ 2 x t f τ x t 1 w t where f τ is the transition matrix related to τ and w t is a zero mean gaussian noise related to the transition between times t 1 and t whose covariance matrix σ w τ is also a function of τ a measurement vector z t is then assumed to be linear combinations of the temperature field y t 3 z t h t y t ϵ t where ϵ t is the observation noise often modeled as a zero mean uncorrelated gaussian random variable with covariance matrix σ ϵ and h t is an observation matrix fig 1 summarizes the overall hierarchical structure of the proposed model 2 3 global and local definition of latent state given the model structure there exist infinite solutions to estimate model parameters barber 2012 the redundancy of solutions can be eliminated by imposing a rule to identify latent variables and the model performance depends on this rule as anticipated above we propose two alternative models that employ different latent variables selection schemes the first model uses principal component analysis pca as a criterion to estimate latent states focusing on global features of the data as in cressie and wikle 2015 hannachi et al 2007 trevor et al 2004 pca identifies a set of linearly transformed coordinates principal components pcs of the original data in order of decreasing variance in this model pcs are interpreted as global features of the temperature field so the model uses pcs as the latent states of the process the alternative optimal sensing model defines the state variables as local measures on the temperature field in this os model we identify optimally sensing locations which provide the most informative measures to interpolate extrapolate the entire temperature field this model uses such local measures as the latent state variables 2 4 parameter estimation in this subsection we provide procedures to calibrate the model parameters i e μ τ φ f τ σ w τ for every τ and σ v by processing data in the calibration phase we assume the access to the full temperature fields y t variable z t is assumed to be a noisy observation on a subset or local average of y t with the known observation matrix h t we also consider the observation matrix h t as a time varying quantity for the flexible applications 2 4 1 mean field the mean field μ τ could be estimated by simply averaging temperatures at time of the day τ but such mean fields would contain high empirical fluctuation therefore we use a moving average scheme to obtain a smoother empirical mean field μ τ 4 μ τ υ θ τ υ μ υ where μ υ 1 n υ t hod t υ y t n υ is the number of recorded timestamps with time of the day υ θ τ υ is a weight coefficient related to the time difference between two times of day τ and υ we adopt a weight that is proportional to an exponentially decaying function with increasing time difference 5 θ τ υ exp δ τ υ λ θ where υ θ τ υ 1 in the previous equation δ τ υ min τ υ t day τ υ and t day is one day λ θ is a hyper parameter that controls decaying rate in eq 5 2 4 2 model 1 principal component analysis pca model the first model uses global features based on pca pca is a feature extraction technique that linearly transforms the original data to pcs in order of preserving the covariance cressie and wikle 2015 hannachi et al 2007 trevor et al 2004 in order to obtain the pcs eigenvalue decomposition is implemented with the regularized empirical covariance matrix σ y 6 σ y 1 n τ t hod t τ δ y t δ y t t η 2 i p eλe t where δ y t y t μ τ n is the total number of timestamps i e n n υ h and the vector δy t is the difference between temperature y t and its corresponding mean field μ τ η is a regularization parameter that has a small value compared to the empirical standard deviation of temperature at each location and i p is the identity matrix of dimension p p the regularization term η 2 i p is introduced to avoid overfitting in higher order pcs orthogonal matrix e and diagonal eigenvalue matrix λ are outcomes of the eigenvalue analysis on σ y we determine the dimension of the state variables r by imposing eq 7 to reach a small reconstruction error σ v that is less than or equal to a target value v tol 7 σ v 2 1 p tr σ y 1 p i 1 r λ i v tol 2 where λ i is i th eigenvalue of the covariance matrix the dimension r is the number of included pcs the left hand side of eq 7 estimates the standard deviation σ v of the error term v t in eq 1 e r is the rectangular matrix of the first r eigenvectors and λ r is the diagonal matrix of the first r eigenvalues then the embedding matrix φ is estimated as eq 8 8 φ e r λ r given the pca based embedding matrix φ the expected vector of lower dimension embeddings x t is estimated from vector y t by solving a least square linear regression problem as x t φ y t where φ is moore penrose pseudo inverse matrix of φ for linear dynamical systems forward backward smoothing and sequential optimization or a sampling based approach is commonly implemented to calibrate the dynamic model e g expectation maximization algorithm or markov chain monte carlo method as in särkkä 2013 barber 2012 however implementing such conventional algorithms is computationally challenging for our problem given the high dimensionality of the observations and the number of latent variables therefore we propose simplified alternative algorithms to calibrate our models appendix a investigates the impact of using our methods instead of the conventional ones the results imply that the different calibration methods result in similar model performance see appendix a for details the matrices f τ could be estimated by minimizing the least squares error function of eq 9 9 l lse 1 2 n τ t hod t τ x t f τ x t 1 l 2 2 where l 2 is the euclidean l 2 norm to avoid the overfitting eq 9 is modified with a regularization term which is a variant of ridge penalization as 10 l pca l lse 1 2 α pca τ f τ d f 2 where f is the frobenius norm and α pca is a regularization parameter which can be selected through n fold cross validation d is a diagonal matrix whose components are the coefficients of uncorrelated uni variate linear regressions d i i th element of the diagonal matrix d is estimated by multiple uni variate linear regressions such that 11 d i t x t i x t 1 i t x t i 2 1 where x t i is i th element of x t table 1 summarizes the steps in parameter estimation for the pca model 2 4 3 model 2 optimal sensing locations os model as discussed in section 2 3 we propose an alternative method for latent variable selection other than pca in the os model the latent variables are defined as the residual temperature at the locations which are most informative to measure temperature in order to interpolate extrapolate the entire field we start appointing the optimal sensing locations by partitioning vector δy t the difference between the temperature field and its correponding mean field into two sub vectors x t and y t ip we define x t as the latent state a vector of residual temperatures at a set of locations a where it maximizes the information to estimate the rest of field y t ip 12 δ y t y t μ τ x t y t ip the selection of locations a is identical to the optimal sensor placement problem for a gaussian random field algorithms have been proposed to select the optimal places based on conditional entropy ce or mutual information mi for arbitrary gps this paper adopts the algorithm based on mi because it tends to place sensors more centrally than ce krause et al 2008 the optimal sensor placement a is obtained by solving the optimization problem of eq 13 13 a argmax a s a r h y t ip h y t ip x t where a is the number of sensors which is the dimension of latent variables r s is a set of locations where sensors can be placed and one can design that set by placing evenly distributed points over the domain h is the entropy or ce of the random variable s within parenthesis and the specific formulas are provided for multivariate gaussian random variables as eq 14a and 14b 14a h y t ip c 1 2 ln σ y ip 14b h y t ip x t c 1 2 ln σ y ip x where c is a constant and σ y ip and σ y ip x are the marginal and conditional covariance matrices of y ip given x respectively is the determinant of the matrix the marginal covariance σ y ip in eq 14a is estimated as eq 15 15 σ y ip 1 n t y t ip y t ip t η 2 i r where η is a regularization parameter as in eq 6 and i r is the identity matrix of dimension p r p r similarly the conditional covariance σ y ip x in eq 14b is estimated using the conditional formula of multivariate gaussian distribution 16 σ y ip x σ y ip σ y ip x σ x 1 σ xy ip where σ x 1 n t x t x t t η 2 i r σ y ip x 1 n t y t ip x t t and σ xy ip σ y ip x t i r is the identity matrix of dimension r r the proposed algorithms in krause et al 2008 perform a greedy optimization adding new places to sense the temperature until we achieve a satisfactory level of accuracy one of the merits in using os model is that the latent variables are directly observable so that no further procedure to estimate latent states is required the latent states x t can be directly estimated from the local measures at the selected sensing locations a the detailed procedure for the optimization in eq 13 follows the algorithm in krause et al 2008 the reconstruction error σ v determines the dimension of latent variables r and it is evaluated as the averaged trace of the empirical conditional covariance σ y ip x 17 σ v 2 1 p r tr σ y ip x v tol 2 after having selected the optimal set a the transition matrix is calibrated similarly to how it is done for the pca model adopting a least squared error lse objective function with a regularization term 18 l os l lse 1 2 α os τ f τ f hm f 2 the regularization term is introduced to identify stable transition matrices f hm is a homogeneous and isotropic transition matrix obtained from a pre training procedure as the solution of the markov gaussian process of eq 19 19 f hm σ x t x t 1 hm σ x t x t hm η hm 2 i r 1 where η hm is a disturbance noise and σ x t x t 1 hm and σ x t x t hm are the covariance matrices constructed using the homogeneous covariance kernel functions as in eq 20a and 20b 20a σ x t x t hm i j σ 2 exp δ i j λ hm 20b σ x t x t 1 hm ρ σ x t x t hm σ x t x t hm i j is element i j of matrix σ x t x t hm σ and ρ are scalar parameters that represent the standard deviation and correlation coefficient respectively λ hm is a parameter of the exponentially decaying function in eq 20a and δ i j is the geometric distance between sites i and j σ ρ and λ hm are calibrated through a pre training procedure by maximizing log likelihood function as 21 σ ρ λ hm argmax l l x t x t 1 σ x t x t hm σ x t x t 1 hm where ll is the log likelihood function of the pair x t x t 1 given homogeneous covariances σ x t x t hm and σ x t x t 1 hm after calibrating the pre training parameters the regularization coefficient α os is then selected through n fold cross validation in the os model we estimate the embedding matrix through linear regression similar to eq 18 linear regression is implemented with the homogeneous regularization scheme the embedding matrix is the optimal solution of the loss function of eq 22 22 l os φ l lse φ 1 2 α os φ φ hm f 2 where 23 l lse φ 1 2 n t δ y t φ x t l 2 2 the hyper parameter α os in eq 22 is set to be equal to that of eq 18 the homogeneous embedding matrix φ hm is defined similarly to the homogeneous transition matrix f hm sharing the parameter λ hm and σ 24 φ hm σ y t x t hm σ x t x t hm η hm 2 i r 1 where σ y t x t hm is a rectangular matrix whose elements are similarly defined as those of σ x t x t hm in eq 20 table 2 summarizes the details in parameter estimation for the os model 2 4 4 noise covariance the process noise is calculated with the estimated parameters in section 2 4 2 pca model or section 2 4 3 os model 25 w t x t 1 f τ x t the moving average scheme in eq 4 is also applied to estimate time dependent covariance matrix σ w τ sharing the parameter θ τ υ and λ θ of eq 4 and eq 5 26 σ w τ υ θ τ υ σ w υ where σ w υ 1 n υ t hod t υ w t w t t in eq 26 σ w τ is the estimated covariance matrix of w t at τ while σ w τ is the empirical covariance matrix 2 4 5 stationary distribution if the calibrated system is stationary the process converges to its stationary distributions as it progresses based on the diurnal cycle the process becomes time invariant with daily equivalent notations as described in eq 27 27 x t f d x t h w t d where f d τ f τ f d is the one day equivalent transition matrix and w t d is the equivalent process noise the cumulative noise covariance σ w d τ of w t d is a function of τ to indicate the time of the day of the stationary distribution the state covariance σ x τ converges to its stationary point with the lyapunov equation as in eq 28 28 σ x τ f d σ x τ f d t σ w d τ we set this stationary distribution of the process as an estimator for the initial distribution of the state when implementing the probabilistic forecast using kalman filter smoother scheme illustrated in section 2 5 2 4 6 stability stationarity and identifiability a discrete linear process x t 1 a x t is called asymptotically stable if all the eigenvalues of the transition matrix a have modulus less than one similarly in our models we have analyzed eigenvalues of the one day equivalent transition matrix f d to confirm that the calibrated process is asymptotically stable according to our analysis presented in section 4 the maximum values of the modulus ranges from 0 66 to 0 78 for one day equivalent processes on the other hand one may impose the stability condition by parameterizing the transition matrix during the model calibration stage as in bird and williams 2019 strictly speaking the proposed model is not stationary at each time of the day but it is stationary over days as the model structure defines a periodic process cyclostationary process for the detailed discussion readers may refer to gardner et al 2006 lastly the proposed models are identifiable and the calibrated model parameters are unique in general a linear dynamical system or linear gaussian state space model cannot guarantee identifiability because of the redundancies in the solution space however by imposing the pca os model to define latent variables the solution space is constrained such that either of the proposed models is identifiable we refer the reader to chapter 24 of barber 2012 for details on this issue 2 5 probabilistic forecast the temperature field y t at t is assumed to have a gaussian prior distribution 29 y t n μ y t σ y t where μ y t and σ y t are the prior mean and covariance of spatial temporal temperature field of the target domain given the linear combination as eq 3 the measurement vector z t also follows gaussian distribution and its mean μ z t and covariance σ z t are 30 z t n μ z t σ z t where μ z t h t μ y t σ z t h t σ y t h t t σ ϵ denoting the observation z 1 t to be a collection of z t for t 1 2 3 t forecasting temperature fields is to infer the field vector y t with the given observations z 1 t 31 y t z 1 t y t 1 t n μ y t 1 t σ y t 1 t where μ y t 1 t and σ y t 1 t are posterior mean and covariance respectively for state space models the inference procedure can be implemented by a recursive gaussian linear smoother also known as a kalman filter smoother following the details described in barber 2012 3 model calibration this section describes how we have collected data and calibrated the proposed models 3 1 weather data high resolution numerical simulations have been increasingly used to study the dynamics in urban scale weather effect and to mitigate related risk grossman clarke et al 2010 li et al 2013 li and bou zeid 2014 the temporal resolution of interest is also related to the urgency of decision framework for policy makers such as air water quality control construction project design and energy groundwater use chow et al 2012 li and bou zeid 2014 in this paper we have designed 1 km grid spacing as the spatial resolution adopting the one way nesting domains as in li and bou zeid 2014 malings et al 2017 the spatial resolution would be computationally affordable for data collection without expecting significant systematic error in local scale physics of the numerical simulator but that resolution would be still challenging for real time computation we also have set 30 min as the reporting intervals considering that this temporal resolution is tolerable for the potential urgency of decision making problems to calibrate the model historical weather data over the target domains are reanalyzed using wrf pucm by downscaling 6 hourly 12km 12 km data of north american meso scale forecast system nam 12 km analysis nam anl research data archive at the national center for atmospheric research and laboratory 2015 to 1km 1 km grid data with 30 min intervals using the dynamically downscaled data we have calibrated the proposed models for both domains around nyc 160km 160 km and pgh 200km 200 km as represented in fig 2 the weather simulation is conducted using a high performance computer cheyenne of university corporation for atmospheric research using 36 cores 72 logical processors of 2 3 ghz intel xeon e5 2697v4 broadwell processors the simulation data of this paper is published in choi et al 2021 3 2 training using wrf pucm a sequence of temperature fields is generated from jun 01 udt 00 00 to aug 31 udt 00 00 with 30 min intervals for three summers from 2016 to 2018 in both nyc and pgh domains 1km 1 km resolution a total of 13 251 stamps of temperature fields are used to calibrate the proposed models illustrated in section 2 table 3 summarizes the dataset that we generated and used for the calibration following the calibration procedures as summarized in table 1 and 2 we have estimated the parameters of the proposed models fig 3 a scatters the collected data and plots the calibrated mean temperature with 95 confidence bounds in a cycle of a day at brooklyn nyc 40 668 n 73 994 w fig 3b represents the histogram of near surface temperature and its fitted probability distribution of the os model at 18 00 for the same location table 4 and table 5 list the hyper parameters and their selected values in the model calibration the tolerance value v tol is differently selected in table 4 because the pca model shows more rapidly decreasing reconstruction error even with fewer latent variables than the os model 4 model validation in this section we conduct a numerical experiment for the calibrated models to forecast short term near surface temperature at relatively low computational cost in section 4 1 we describe three case studies and show the results then the prediction performance is assessed by comparing the accuracy and the evaluation time in section 4 2 4 1 short term forecast the meaning of short term depends on the purpose of the forecast or analysis among the officially operated weather forecasting systems the north american meso scale forecast system non hydrostatic mesoscale model nam nmm is one of the most detailed models which provides 3 hourly 12km 12 km grid weather forecasts for the next 84 hours up to the knowledge of the authors referring to the nam and considering the computational trade off in spatial temporal resolution we assume that a faster forecast predicts the next a few hours to a day at 1km 1 km spatial resolution with tens of minutes to an hourly time intervals in the conducted numerical analysis the calibrated models in section 3 predict the downscaled near surface temperature of wrf pucm from aug 01 2019 to aug 03 2019 which is at least one year apart from the training period we set input data to the calibrated model considering them as noisy signals with zero mean gaussian white noise i e ϵ t in eq 3 and we assume the standard deviation of the noise to be 0 1 c this noise level is set not to excessively disturb the forecast with the input noise we consider the following use cases to implement the fast forecast case 1 we assume availability of local temperature measurements at m locations y t 1 y t 2 y t m that represent virtual weather stations in this case the simulation outcomes of wrf pucm interpreted as collected field measurements are accessible up to the current time step the weather stations are evenly located with 6 km spacing case 2 in addition to inforamtion available in case 1 average temperature over the domain global average is also provided from wrf pucm data with 6 hourly intervals for the test period this case assumes the availability of the broader scale temperature forecast from an external source which has sparse temporal intervals and coarse spatial resolution similarly to the test case of malings et al 2017 case 3 this case provides multiple average temperatures of 12 km 12 km grids as shown in fig 4 d from wrf pucm data it describes a realistic scenario which exploits the most information among the case studies one can consider the multiple zonal averages as a prediction by nwp simulation at coarse and sparse resolution the grid spacing and time intervals are set to be similar to those of nam to assess the performance of the proposed models we set baselines obtained by the gp model developed in malings et al 2017 however because of the high computational complexity of the fully connected gp we must set constraints by limiting the number of accessible data points to attain the temperature forecast with reasonable computing resources baseline 1 this baseline forecasts temperature only using the past measurements as in case 1 but with the limited data we force the model to forecast temperature of individual locations only processing the measurements within a radius of 10 km sub domain at selected times up to the last 24 hours current time 00 00 00 30 01 00 03 00 06 00 09 00 12 00 18 00 24 00 this case is the closest configuration to case 1 under the limited computation budget baseline 2 for the test period we input the 12km 12 km zonal averages only this case is the fastest implementation that feeds overall spatio temporal information to the gp model baseline 3 in addition to baseline 1 baseline 3 uses the 6 hourly 12km 12 km average temperature but each location is allowed to exploit the zonal average where it belongs this baseline is considered as equivalent to case 3 but with constrained computing resources table 6 summarizes the information used in the case studies and the baselines other than spatio temporal models we also consider much simpler ways to forecast near surface temperature we evaluate the following simple quantities to investigate whether the probabilistic models enable improved temperature forecast simple forecast 1 t t 24h the temperature is predicted by the temperature of the previous day at the closest virtual weather station of case 1 simple forecast 2 t avg the temperature is predicted by the mean field temperature of the location at the same hour of the day τ fig 5 a represents the reanalyzed near surface temperature by wrf pucm on aug 02 2019 19 00 utc 15 00 edt for the nyc domain which is assumed as ground truth for this numerical experiment fig 5b illustrates the 24 hours ahead prediction by the baseline 3 for the same time point fig 5c and d are the 24 hours ahead prediction by the proposed state space models similarly fig 6 a represents the reanalyzed near surface temperature by wrf pucm on aug 03 2019 19 30 utc 15 30 edt for the pgh domain and fig 6b c and fig 6d are the 24 hours ahead prediction by the baseline 3 and the use of case 3 with the proposed models the selected time points are when each domain shows the hottest average temperature in fig 6a the dark spots indicating low temperature which do not appear in the forecast of proposed models are areas predicted as cloudy by the nwp model cloud positions have been hard to predict quantities even for nwp models and we do not investigate the exact cloud position as it is out of the scope of the paper still this discussion is still valid as the model performance targets wrf pucm because no cloud effect has been considered in the model the result can be interpreted as a trade off between faithful physical description and fast forecast however the proposed models perform well for the overall regions showing high accuracy as illustrated in section 4 2 fig 7 shows the 3 hours ahead predicted temperature by the os model during the test periods at brooklyn nyc and downtown pgh 4 2 model assessment to assess the performance of the models we conduct two types of validation 1 point wise and 2 probabilistic validation in both cases we compare pairs of observations and forecasts the point wise validation assesses model performance by comparing observation and mean forecast using traditional error metrics e g root mean squared error on the other hand the probabilistic validation compares the observation with the probability distributions of the forecast for example we evaluate the posterior probability of observations as a score for the probabilistic assessment 4 2 1 point wise validation we use the following error metrics 1 the root mean squared error rsme 2 the unnormalized bias b bias 3 the coefficient of variation in the mean absolute error cvmae and 4 the pearson linear correlation coefficient r the last three metrics are adopted from malings et al 2019 denoting the prediction outcomes of the wrf pucm and the proposed models as y i and y i respectively the rsme is defined as eq 32 32 rsme 1 n i 1 n y i y i 2 where n is the number of the target and forecast pairs the forecast bias is assessed by b bias and defined as the average difference between the forecasts and the observed values 33 b bias 1 n i 1 n y i y i cvmae computes the deviation of the forecasted values as the normalized absolute errors against the bias 34 cvmae i 1 n y i b bias y i i 1 n y i lastly the pearson linear correlation coefficient r assesses the linearity of the forecasts respect to the observed values 35 r i 1 n δ y i δ y i i 1 n δ y i 2 i 1 n δ y i 2 where 36 δ y i y i 1 n j 1 n y j 4 2 2 probabilistic validation we consider the continuous ranked probability score crps and the cross entropy ce as error metrics for probabilistic validation crps is defined as eq 37 37 crps f y i y i f y i y i 1 y i y i 2 d y i where f y i is the cumulative density function of the forecast y i and 1 is the indicator function that returns one if the prediction y i is greater than or equal to y i or zero otherwise cprs measures the divergence between the cumulative density functions of probabilistic forecast and its corresponding observation along with crps we also consider ce to measure the divergence between probability densities of two continuous random variables as in eq 38 38 ce f y i f y i f y i x log f y i x d x δ y i x y i log f y i x d x log f y i y i where f y i and f y i are probability density functions of the observation and the corresponding prediction respectively in eq 38 we have replaced f y i with the shifted dirac delta function δ y i x y i since the true distribution of the observation is unknown thus ce is equivalent to the negative log likelihood of the observation to be drawn from the prediction distribution 4 2 3 results for the different settings on the prediction lead time 00 30 01 00 03 00 06 00 09 00 12 00 18 00 24 00 the forecast results are assessed under the case studies fig 8 illustrates rsme versus the prediction lead time and also plots the errors of the simple forecasts in most case studies the proposed models showed forecast errors smaller than the baselines and the simple cases recalled that case 1 and 2 use much less information case 3 shows a considerable capacity to predict the near surface temperature achieving the accuracy around or less than 1 c rsme in both domains according to the results simple forecast 1 t t 24h outperforms several use scenarios of the pstms however this simple forecast never reaches the probabilistic models best performance that leverages the spatio temporal patterns to forecast near surface temperature using the various input information its prediction error 1 67 1 87 c is far above that of the proposed models case 3 0 97 1 13 c the result reveals that simple forecast 2 t avg is not a reliable predictor because although it performs well in the pgh domain it is the worst predictor in the nyc domain this measure does not work well especially when the current weather is quite dissimilar to the average gp s inherent weakness in extrapolation explains the unsatisfactory performance of baseline 1 baselines 1 and 3 reduce their prediction error as the prediction lead time approaches 24 hours except for 24 hours ahead prediction of baseline 1 in nyc this is because the gp model uses a periodic kernel function with a daily cycle in fig 8b as the prediction lead time increases the estimated error of case 1 becomes higher than that of simple forecast 2 t avg and then approaches to it both in pca and os model this behavior represents the typical characteristics of the proposed models given the calibrated one day equivalent transition f d whose absolute eigenvalues are less than 1 a random state of the system will eventually converge to the stationary distribution related to eq 28 in case 2 the prediction is more precise in the pgh domain than the nyc domain the result implies that the global average i e the input of the case study can estimate the latent states well in the pgh region the nyc region requires more detailed information to forecast temperature due to the higher uncertainty this remark is consistent with the higher temperature variance in nyc for example in nyc brooklyn shows a 4 07 c standard deviation at 18 00 utc 14 00 edt having its highest mean temperature 26 49 c while downtown pgh has the highest mean value 28 45 c at 19 30 utc 15 30 edt but a smaller standard deviation of 3 09 c possible reasons for the higher variance of nyc can be the land use i e high urbanization and the influence of the atlantic ocean the nyc domain contains 24 38 of grid cells classified as urban of which the most dominant land use is again urban while 37 17 of the region is covered by water surfaces mostly by the ocean in contrast the pgh domain includes only 3 23 and 0 51 of urban area and water surfaces mostly rivers respectively however a more sophisticated study is required to identify the sources of temperature variability table 7 and table 8 provide the 24 hours ahead forecast rsme for the different land uses gp model is set to forecast the temperature fields excluding water surfaces from the nyc domain due to its homogeneous covariance kernels the gp model may predict land temperature erroneously when it considers the wetland temperature for example because of the homogeneous covariance kernels temeratures at two locations one at land and the other on the ocean having the same distance from a third one would have the same correlation coefficient with the temperature of the third place and this yields erroneous forecasts non urban areas denote grid cells where the most dominant use type is neither urban nor wetland for both nyc and pgh the proposed models show better performance in most cases even though baseline 3 is the best predictor for urban areas around nyc the proposed models also show almost equal performance in case 3 overall prediction performance is better in pgh than in nyc and it might imply more predictable weather patterns in the pgh domain having less variability as discussed in the previous paragraph in comparing urban and non urban areas urban areas tend to hold higher predictability in both domains except baseline 2 possible rationale includes the central location of urban areas in the test domains because the spatial correlation tends to decay with the geometric distance both pca and os models may have learned how to forecast temperature better in the center than at the borders of the domain the wetland temperature in nyc is the most predictable quantity for case 3 while it is the most challenging one for case 2 in the nyc domain the global average may not be an informative input to identify wetland temperature the rsme is significantly reduced only when the proposed models receive more detailed inputs as in case 3 in contrast in the pgh domain wetland temperature shows the highest prediction error for all cases except baseline 1 the calibrated models might under fit this small fraction 0 51 of wetland which still has significant heterogeneity a further investigation on the model performance is conducted with b bias cvmae and correlation coefficient r fig 9 and fig 10 represent the statistical summary of the evaluated error metrics at individual locations fig 9 demonstrates that the proposed linear models produce less biased forecasts at overall locations and for the overall use cases fig 10 shows the statistical summary of cvmae and correlation coefficient r the horizontal and the vertical range represent 25 and 75 percentiles with the mean values of the locations for case 3 the pca model shows 0 036 and 0 035 cvmae having 0 94 and 0 97 r values in nyc and pgh respectively meanwhile the os model shows 0 034 0 035 cvmae and 0 95 0 97 r values for the same case baseline 3 slightly outperforms the pca model in the nyc domain but the difference is negligible the assessment still confirms the ability of the proposed models as a forecasting approach table 9 reports the evaluated rmse crps and ce with additional test periods which were adopted from malings et al 2017 the additional periods were set differently for the nyc and pgh domains from aug 01 to aug 04 in 2019 the gp model reports its crps as 0 80 c and 0 72 c in the nyc and pgh domains respectively while ce is 2 1732 and 1 7222 in terms of crps the proposed models show better performance than the baselines for both domains during the period in comparing ce values the os model outperforms the other two models gp and pca while the other models show very similar performance however we argue that the pca model is still more advantageous because of its computational efficiency as shown in table 10 in table 9 the model performance is consistent for all three test periods which hints at promising applications of the models for further model use periods table 10 summarizes the measured computational times of the proposed models case 3 and baseline 2 to generate the three days forecast we choose baseline 2 for the comparison since it is the fastest case among the baselines baselines 1 and 3 took more than an hour using the same computing resource 12 processors of intel xeon e5 2690 v4 2 60ghz as a result the pca and os models provide qualified forecasts within a shorter evaluation time 20 170sec using one twelfth of the computing resource a single processor of intel xeon e5 2690 v4 2 60ghz such rapid computation has been achieved by the efficient state space representation with the low dimensional embedding the domain size and the different latent dimensions lead to the varying evaluation time of the proposed models for example the nyc domain 150km 150 km shows a shorter evaluation time than that of the pgh domain 200km 200 km also the latent dimension of the os model 135 variables in nyc and 276 variables in pgh is higher than that of the pca model 46 variables in nyc and 91 variables in pgh so the evaluation time is shorter for the pca model in this case study the numerical campaign shows that the forcast performance is similar for pca and os models however from the authors experience the pca model has a technical advantage in choosing the dimension of latent states for example in the model calibration the pca model achieved a smaller reconstruction error with fewer latent variables than the os model the rapidly decaying error of the pca model enables a convenient dimension truncation and a faster computation as reported in table 10 5 conclusion we proposed a probabilistic approach to provide a faster near surface temperature forecast with reasonable accuracy as a potential alternative to physics based numerical weather prediction models the probabilistic spatio temporal modeling has been developed to capture statistical temperature patterns and facilitate them for a faster forecast the method is based on linear markov latent state variables of low dimensionality alleviating the risk of overfitting related to the high dimensionality of the temperature data the latent states account for the spatio temporal evolution of the process also the state space representation substantially reduces computing time during the forecasting stage in this paper we presented two alternative linear models the first model relies on global features using principal component analysis while the second one focuses on local measures at optimally sensing locations these two models showed similar forcast performance but the pca model is technically preferable because of its straightforward implementation we calibrated the proposed models with simulated temperature data using a physical simulator the princeton urban canopy model coupled with weather research and forecasting model wrf pucm for the data collection the physics based model downscaled historical weather data in the regions around new york city and pittsburgh for three months of summer june july august from 2016 to 2018 then the kalman filter smoother scheme integrated sensor data for the faster temperature forecast we assessed the model performance by forecasting a short term temperature for august 1st to 3rd 2019 under the investigated case studies the results confirm that the proposed models produce adequate forecasts at a relatively low computational cost in the numerical analysis our models achieved 0 97 1 13 c in root mean squared error for 24 hours ahead forecast in the case with most information available taking only 20 170 sec to generate three days forecast with a single processor computer intel xeon e5 2690 v4 2 60ghz the result is 14 22 improved accuracy compared to the most accurate case of the baseline model which is based on a gaussian process regression and our models consumed less evaluation time than the fastest case of the baselines using only one twelve computing resource the models can be expanded to be integrated in the heat induced risk analysis ofurban areas for example it can be applied to rapidly downscale the result of an ensemble of numerical weather forecasts to better inform on the probabilistic heat risk for urban residents and allow decision makers to take early and appropriate action data availability the data presented in this paper are available through a mendeley data repository as follows shade 2021 meso scale 2m air temperature around new york city and pittsburgh availability https data mendeley com datasets pr4m594vmf doi 10 17632 pr4m594vmf 2 size 3 11 gb year first available 2021 email byeongsc andrew cmu edu credit authorship contribution statement byeongseong choi methodology software investigation formal analysis writing original draft visualization data curation mario bergés validation formal analysis writing review editing supervision elie bou zeid software investigation resources writing review editing matteo pozzi conceptualization validation formal analysis resources writing review editing supervision funding acquisition project administration declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests mario berges reports financial support was provided by national science foundation elie bou zeid reports financial support was provided by national science foundation matteo pozzi reports financial support was provided by national science foundation acknowledgement this research is supported by the national science foundation under grant no 1664091 and 1664021 the authors thank prof prathap ramamurthy at the city college of new york for the assistance to simulate past climates with wrf pucm also the project upri 0007 computational and information systems laboratory provided the computing resource for the research a appendix a in this section we compare the calibrating procedure proposed in this paper with a widely adopted iterative method the expectation maximization em algorithm with bayes formula the posterior distribution p x y can be decomposed into the prior distribution p x and the likelihood p y x as eq a 1 a 1 p x y p y x p x p y for multidimensional gaussian random variables x and y the posterior distribution follows gaussian distribution and eq a 2 describes the posterior mean as a linear combination of the prior mean μπ and its corresponding likelihood estimator μ l a 2 μ x y σ x y σ x 1 μ π σ x y σ l 1 μ l where σ x y σ x 1 σ l 1 1 or σ x y σ x σ xy σ y 1 σ yx σ x and σ y are the prior covariance of x and y respectively and σ l is the covariance of x that is evaluated from the likelihood function with the given observation y σ x y is the posterior covariance matrix of x conditional to y now we consider the graphical representation of the zero mean state space model as fig a 1a in fig a 1b we define the prior distribution of x t as the conditional distribution of x t with the given input states x t 1 and x t 1 without inclusion of the observation y t red dotted box here the prior distribution is to denote it is prior to observe the emission y t adopting the notations of barber 2012 the mean of p x t x t 1 x t 1 can be represented as eq a 3 due to the linearity between gaussian random variables a 3 μ π a π μ x t x t 1 a π μ x t x t 1 where a π σ π σ x t x t 1 1 a π σ π σ x t x t 1 1 σ π σ x t x t 1 1 σ x t x t 1 1 1 μ x t x t 1 and μ x t x t 1 denote the conditional mean of x t given the dynamic predictors x t 1 and x t 1 respectively similarly σ x t x t 1 and σ x t x t 1 are the conditional covariance given the predictors now we update the prior distribution again with the observation y t which is a variable of dimension much higher than x t figs a 1c and a 1d a 4 μ post b π μ x t x t 1 b π μ x t x t 1 b l μ x t y t where b π σ post σ π 1 a π b π σ post σ π 1 a π b l σ post σ l 1 σ post σ π 1 σ l 1 1 μ x t y t and σ l represent the likelihood estimators for the mean and the covariance of x t with the observed emission y t as a forward and backward smoothing scheme em algorithm iteratively improves the estimation of the state variable x t and the transition matrices a π and a π to analyze the effect of non em implementation we compare the relative magnitude of the forward weight matrix b π and the backward weight matrix b π to the likelihood weight matrix b l using the calibrated parameters in section 3 the defined relative magnitude is the trace of forward or backward weight being normalized by that of the likelihood weight fig a 2 summarizes the result of the numerical test presenting the relative contributions of the dynamic predictors according to the result the contributions of forward and backward priors are relatively small respect to that of the likelihood so the likelihood shows the dominant impact on the states estimation therefore the forward and backward smoothing scheme in em algorithm is not expected to yield much improvement fig a 1 graphical representation of a state space model fig a 1 fig a 2 relative magnitude of prior weights fig a 2 a 1 example city of pittsburgh implementing em algorithm for high dimensional system consumes additional computing resource for the model calibration in this subsection we continue the discussion on em versus non em implementation with a reduced scale model fig a 3 illustrates the map of the model of the city of pittsburgh the mass points represent the locations of interest within the city using em algorithm we calibrate the pca model then show the change of the log likelihood depending on the number of iterations of the algorithm for this city scaled model only 3 principal components are enough to achieve the 0 35 c and 0 36 c reconstruction error for em and non em respectively we calculate the likelihood function for each single em step dividing the term into transition prior and emission likelihood parts fig a 4 shows the convergence of the em algorithm and we scattered the estimated latent variables at the last stage of the iterative algorithm with those of non em implementation fig a 5 as the algorithm progresses the total likelihood increases with small increments but a trade off exists for the transition and the emission terms the numerical investigation confirms that the improvement is not significant especially for the lower order principal components which account for dominant behavior of the system therefore the direct measurement on the emission y t still has the most significant contribution to the latent states inference fig a 3 mass points within pittsburgh fig a 3 fig a 4 convergence diagram fig a 4 fig a 5 estimated latent variables fig a 5 
25741,this paper introduces a probabilistic approach to spatio temporal high resolution meso scale modeling of near surface temperature and applies it to regions of dimension about 150 200 km with 1 km grid spacing and 30 min interval our probabilistic approach based on linear gaussian models and dimensionality reduction can accurately forecast short term temperature fields and serve as a computationally less expensive alternative to physics based models that necessitate high performance computing the probabilistic models here are calibrated from simulations of a physics based model the princeton urban canopy model coupled to the weather research and forecasting model wrf pucm we assess the performance of the calibrated models to forecast short term near surface temperature in various cases in the numerical campaign our models achieve 0 97 1 13 c root mean squared error rmse for 24 hours ahead forecast generating three days of forecast takes between 20 and 170 sec on a single processor intel xeon e5 2690 v4 2 60ghz hence the proposed approach provides predictions at relatively high accuracy and low computational cost graphical abstract image 1 keywords urban heat probabilistic model spatio temporal model latent space state space model kalman filter 1 introduction temperature has a remarkable influence on human society ranging from heat related casualties to economic loss heatwaves are reportedly one of the deadliest weather related hazards in the united states changnon et al 1996 robinson 2001 and killed more than 160 000 people around the globe between 1998 and 2017 including an annual spike of 72 000 deaths in europe in 2003 wallemacq and house 2018 the economic impact of extreme temperature includes extra energy consumption increased water use lost productivity and other additional costs in the built environment santamouris et al 2015 guhathakurta and gober 2007 zuo et al 2015 due to the high population and vulnerability to heat stressors urban areas provide more relevant applications for high resolution surface temperature forecasts by trapping heat within the building canopy and through other physical mechanisms such as reduced evapotranspiration urban areas increase their near surface temperature 4 4 hereafter the term near surface temperature refers to the 2m air temperature which measures ambient air temperature at 2m above the ground we select this quantity because it has more direct influences on human comfort and mortality than the strictly defined surface temperature anderson and bell 2009 voogt and oke 2003 higher than that of their surrounding environment an effect known as urban heat island or uhi uhi has been shown to have a non linear synergy with extreme heatwaves such that an urban area can be exposed to more severe heat stressors under certain circumstances li and bou zeid 2014 numerical weather prediction nwp is the golden standard for weather research and forecast both in research and practice weyn et al 2019 nwp is based on a numerical model that solves partial differential equations for atmospheric fluid dynamics radiation transfer cloud process and other physical processes with the growth of computing power nwp has improved its accuracy and as a result highly reliable weather forecasts have become available routinely the weather research and forecasting model wrf is a representative approach for nwp used by the national weather service and researchers worldwide skamarock et al 2019 for the broad application of the nwp numerous physics models have been developed and coupled to wrf for example princeton urban canopy model pucm modifies the default single layer urban canopy model by considering heterogeneity within urban facets and urban hydrology wang et al 2013 the numerical scheme integrating wrf and pucm wrf pucm has shown high prediction performance with a bias as small as 0 4 1 1 c li and bou zeid 2014 wang et al 2013 li et al 2013 ramamurthy et al 2017 still the main challenge of nwp is its significant computational cost preventing it from being widely used for real time forecasts or analysis at the city scale which requires high spatial and or temporal resolution e g for a grid spacing in the order of 1 km to extend the applicability of nwp there have been attempts to improve the spatial resolution of coarse grid simulation using statistical analysis called statistical downscaling sd methods instead of running additional fine grid simulations sd methods estimate local climate variables using statistical relationships with large scale predictors maraun and widmann 2018 sd covers a wide range of models including regression based models bias correction methods weather pattern based classification weather typing and stochastic weather generating models maraun and widmann 2018 wilby et al 2002 to our knowledge regression based models which discover empirical relationships between regional climate variables predictors and local ones predictands are the most popular method for sd because of their straightforward implementation min et al 2011 according to the discussions in maraun and widmann 2018 lanzante et al 2018 another benefit of sd includes its ability to avoid systematic errors of nwp which are typically caused by limitations in modeling local scale climate especially when sd models are trained on real weather observations many sd methods have been proposed for example authors of rodrigues et al 2018 proposed a downscaling strategy that uses deep convolutional neural networks cnns to attain higher horizontal resolution from nwp output a method based on support vector machine svm was suggested in shin and yi 2019 to downscale urban air temperature in spite of their successful outcomes the methods mentioned above lack a way to increase temporal resolution as a pure data driven approach for weather forecast another cnn based approach was proposed in weyn et al 2019 to predict one or two fundamental meteorological fields at a representative height for the climate status even though the method in weyn et al 2019 showed remarkable potentials of deep learning in weather forecast one still needs a model that enables versatile inference from various types of inputs for example a pre processing technique may be required to the model in weyn et al 2019 as well as sd models if the input has a missing value or irregular shape so that a flexible data assimilation is desired also a neural network is a black box model with intricate structure and parameters it is preferable to adopt a more comprehensible description of the system probabilistic spatio temporal models pstm characterize any complex time evolving process over a spatial domain with probabilistic descriptions although both pstm and sd are based on probability theory pstm models a spatio temporal structure of the process while most classical sd models learn a mapping from regional climate variables to local ones as discussed in the previous paragraph pstm is flexible in its usage it can perform inference even with partially missing inputs in berliner et al 2000 a bayesian hierarchical model is proposed to estimate the tropical pacific sea surface monthly temperature capturing the non linearity in el niño and la niña cressie and wikle 2015 a gaussian process gp model is developed in malings et al 2017 to approximate the urban surface temperature and it is used to optimize the sensing locations over a city via a value of information analysis malings et al 2018 however the gp based approach would need careful application when high heterogeneity is expected within the field of the climate variables for example because of the urban features in this paper we introduce a pstm approach to enable a rapid and efficient forecast of near surface temperature with adequate accuracy as a potential alternative to computationally intensive nwp the proposed method can capture complex spatial temporal patterns of temperature with simple representation when properly trained the calibrated model can leverage intricate patterns to forecast near surface temperature from the input measurements without need of using high performance computing the probabilistic method is a flexible spatio temporal downscaling that assimilates diverse types of inputs the proposed approach is based on a linear markov process with low dimensional latent states being segmented by the time of the day the latent state variables are introduced to generate full scale temperature fields from low dimensional space so the model is suitable for faster data assimilation and probabilistic forecast the model structure also has an advantage in mitigating the risk of overfitting which is high when processing a relatively small dataset of high dimensional variables e g meso scale near surface temperature fields we develop two alternative linear models in the first model the latent state is described by principal components interpreting them as global features of the temperature field principal component analysis model pca model the second model selects a set of optimal locations to predict the rest of the temperature field then the latent state is the temperatures at the selected locations optimal sensing model os model for each model we also propose an appropriate calibration method these two alternative models are investigated to compare the effectiveness of a forecast based on global features as in the pca model with another one based on local features as in the os model we calibrate the models in two meso scale regions 150 km 200 km around new york city nyc and pittsburgh pgh with 1 km grid spacing and 30 min intervals after calibrating the spatio temporal models we integrate them into a kalman filtering smoothing scheme to forecast near surface temperature by processing collected field data and approximated forecasts provided by external sources for example in our numerical test the proposed models downscale 12 km grid spacing data with varying temporal resolutions into 1 km spacing temperature fields with 30 min intervals we then compare the accuracy of the models and assess the prediction performance in several case studies this paper applies a linear gaussian state space model to a spatio temporal downscaling problem calibrating the model parameters of the hidden markov model and then performing kalman filtering smoothing to forecast short term near surface temperature in the context of this application our contributions can be summarized as 1 developing techniques for selecting latent state variables 2 proposing model calibration methods and 3 assessing model performance in several relevant case studies 2 probabilistic spatio temporal model pstm needs an efficient structure to capture dependencies among random variables in this section we provide a probabilistic description for the process of meso scale near surface temperature section 2 1 motivates the model structure and section 2 2 describes a state space representation of the spatio temporal process then section 2 3 presents two alternative models based on global and on local features and section 2 4 provides details on parameter estimation for the proposed models finally section 2 5 provides background for assimilating data collected in the field or received from external sources to forecast the evolution of temperature 2 1 motivation the near surface temperature of an urban region of dimension about 20km 20 km is influenced by the heat transfer in a much larger domain of dimension about 200km 200 km the discretized temperature field in this large domain is described by a high number of variables for example a 150km 150 km squared shape domain discretized with 1 km spacing grids yields p 22 500 degrees of freedom for each timestamp such high dimensional data pose various technical problems when calibrating a statistical model for instance calibrating the full p p transition functions requires a tremendous amount of training data not available in most cases the calibration needs to rely on a relatively small dataset so rank deficiency and overfitting are common issues in this setting to overcome these issues imposing sparsity in the transition matrix is one of the solutions and methods have been recently developed to do so as in chouzenoux and elvira 2020 however imposing sparsity would increase additional computational complexity and we are particularly interested in identifying an efficient model structure that reduces the number of model parameters thus in this paper we propose probabilistic models using a hierarchical architecture as illustrated in fig 1 2 2 state space model state space approaches have been widely adopted as a recursive scheme for estimating the state of a system and when the system is linear they are the base for a variety of kalman filter smoother schemes welch et al 1995 barber 2012 adopting a state space description we relate a vector of temperature field y t at time t of high dimension p 1 to a vector of latent state variables x t of dimension r 1 with r much lower than p the vector y t is decomposed into three additive terms an average temperature field μ τ a linear function of the low dimensional latent states x t and an error term v t 1 y t μ τ φ x t v t where φ p r is an embedding matrix and the average temperature field depends on the time of the day τ discretized into h steps from 00 00 to 24 00 e g for h 48 τ 00 00 00 30 01 00 23 30 τ is defined as τ hod t where hod is a function that returns the time of the day of timestamp t in this hierarchical structure the dynamics of high dimensional temperature fields is approximated by a linear system in low dimension the low dimensional representation reduces the number of parameters and the memory requirements in the inference process both the latent variables and the error term are modeled as gaussian random variables the error term v t is assumed as a set of independent and identically distributed random variables with zero mean and standard deviation σ v the temporal evolution for the process is assumed to follow a linear markov model whose transition matrix depends on the time of the day τ 2 x t f τ x t 1 w t where f τ is the transition matrix related to τ and w t is a zero mean gaussian noise related to the transition between times t 1 and t whose covariance matrix σ w τ is also a function of τ a measurement vector z t is then assumed to be linear combinations of the temperature field y t 3 z t h t y t ϵ t where ϵ t is the observation noise often modeled as a zero mean uncorrelated gaussian random variable with covariance matrix σ ϵ and h t is an observation matrix fig 1 summarizes the overall hierarchical structure of the proposed model 2 3 global and local definition of latent state given the model structure there exist infinite solutions to estimate model parameters barber 2012 the redundancy of solutions can be eliminated by imposing a rule to identify latent variables and the model performance depends on this rule as anticipated above we propose two alternative models that employ different latent variables selection schemes the first model uses principal component analysis pca as a criterion to estimate latent states focusing on global features of the data as in cressie and wikle 2015 hannachi et al 2007 trevor et al 2004 pca identifies a set of linearly transformed coordinates principal components pcs of the original data in order of decreasing variance in this model pcs are interpreted as global features of the temperature field so the model uses pcs as the latent states of the process the alternative optimal sensing model defines the state variables as local measures on the temperature field in this os model we identify optimally sensing locations which provide the most informative measures to interpolate extrapolate the entire temperature field this model uses such local measures as the latent state variables 2 4 parameter estimation in this subsection we provide procedures to calibrate the model parameters i e μ τ φ f τ σ w τ for every τ and σ v by processing data in the calibration phase we assume the access to the full temperature fields y t variable z t is assumed to be a noisy observation on a subset or local average of y t with the known observation matrix h t we also consider the observation matrix h t as a time varying quantity for the flexible applications 2 4 1 mean field the mean field μ τ could be estimated by simply averaging temperatures at time of the day τ but such mean fields would contain high empirical fluctuation therefore we use a moving average scheme to obtain a smoother empirical mean field μ τ 4 μ τ υ θ τ υ μ υ where μ υ 1 n υ t hod t υ y t n υ is the number of recorded timestamps with time of the day υ θ τ υ is a weight coefficient related to the time difference between two times of day τ and υ we adopt a weight that is proportional to an exponentially decaying function with increasing time difference 5 θ τ υ exp δ τ υ λ θ where υ θ τ υ 1 in the previous equation δ τ υ min τ υ t day τ υ and t day is one day λ θ is a hyper parameter that controls decaying rate in eq 5 2 4 2 model 1 principal component analysis pca model the first model uses global features based on pca pca is a feature extraction technique that linearly transforms the original data to pcs in order of preserving the covariance cressie and wikle 2015 hannachi et al 2007 trevor et al 2004 in order to obtain the pcs eigenvalue decomposition is implemented with the regularized empirical covariance matrix σ y 6 σ y 1 n τ t hod t τ δ y t δ y t t η 2 i p eλe t where δ y t y t μ τ n is the total number of timestamps i e n n υ h and the vector δy t is the difference between temperature y t and its corresponding mean field μ τ η is a regularization parameter that has a small value compared to the empirical standard deviation of temperature at each location and i p is the identity matrix of dimension p p the regularization term η 2 i p is introduced to avoid overfitting in higher order pcs orthogonal matrix e and diagonal eigenvalue matrix λ are outcomes of the eigenvalue analysis on σ y we determine the dimension of the state variables r by imposing eq 7 to reach a small reconstruction error σ v that is less than or equal to a target value v tol 7 σ v 2 1 p tr σ y 1 p i 1 r λ i v tol 2 where λ i is i th eigenvalue of the covariance matrix the dimension r is the number of included pcs the left hand side of eq 7 estimates the standard deviation σ v of the error term v t in eq 1 e r is the rectangular matrix of the first r eigenvectors and λ r is the diagonal matrix of the first r eigenvalues then the embedding matrix φ is estimated as eq 8 8 φ e r λ r given the pca based embedding matrix φ the expected vector of lower dimension embeddings x t is estimated from vector y t by solving a least square linear regression problem as x t φ y t where φ is moore penrose pseudo inverse matrix of φ for linear dynamical systems forward backward smoothing and sequential optimization or a sampling based approach is commonly implemented to calibrate the dynamic model e g expectation maximization algorithm or markov chain monte carlo method as in särkkä 2013 barber 2012 however implementing such conventional algorithms is computationally challenging for our problem given the high dimensionality of the observations and the number of latent variables therefore we propose simplified alternative algorithms to calibrate our models appendix a investigates the impact of using our methods instead of the conventional ones the results imply that the different calibration methods result in similar model performance see appendix a for details the matrices f τ could be estimated by minimizing the least squares error function of eq 9 9 l lse 1 2 n τ t hod t τ x t f τ x t 1 l 2 2 where l 2 is the euclidean l 2 norm to avoid the overfitting eq 9 is modified with a regularization term which is a variant of ridge penalization as 10 l pca l lse 1 2 α pca τ f τ d f 2 where f is the frobenius norm and α pca is a regularization parameter which can be selected through n fold cross validation d is a diagonal matrix whose components are the coefficients of uncorrelated uni variate linear regressions d i i th element of the diagonal matrix d is estimated by multiple uni variate linear regressions such that 11 d i t x t i x t 1 i t x t i 2 1 where x t i is i th element of x t table 1 summarizes the steps in parameter estimation for the pca model 2 4 3 model 2 optimal sensing locations os model as discussed in section 2 3 we propose an alternative method for latent variable selection other than pca in the os model the latent variables are defined as the residual temperature at the locations which are most informative to measure temperature in order to interpolate extrapolate the entire field we start appointing the optimal sensing locations by partitioning vector δy t the difference between the temperature field and its correponding mean field into two sub vectors x t and y t ip we define x t as the latent state a vector of residual temperatures at a set of locations a where it maximizes the information to estimate the rest of field y t ip 12 δ y t y t μ τ x t y t ip the selection of locations a is identical to the optimal sensor placement problem for a gaussian random field algorithms have been proposed to select the optimal places based on conditional entropy ce or mutual information mi for arbitrary gps this paper adopts the algorithm based on mi because it tends to place sensors more centrally than ce krause et al 2008 the optimal sensor placement a is obtained by solving the optimization problem of eq 13 13 a argmax a s a r h y t ip h y t ip x t where a is the number of sensors which is the dimension of latent variables r s is a set of locations where sensors can be placed and one can design that set by placing evenly distributed points over the domain h is the entropy or ce of the random variable s within parenthesis and the specific formulas are provided for multivariate gaussian random variables as eq 14a and 14b 14a h y t ip c 1 2 ln σ y ip 14b h y t ip x t c 1 2 ln σ y ip x where c is a constant and σ y ip and σ y ip x are the marginal and conditional covariance matrices of y ip given x respectively is the determinant of the matrix the marginal covariance σ y ip in eq 14a is estimated as eq 15 15 σ y ip 1 n t y t ip y t ip t η 2 i r where η is a regularization parameter as in eq 6 and i r is the identity matrix of dimension p r p r similarly the conditional covariance σ y ip x in eq 14b is estimated using the conditional formula of multivariate gaussian distribution 16 σ y ip x σ y ip σ y ip x σ x 1 σ xy ip where σ x 1 n t x t x t t η 2 i r σ y ip x 1 n t y t ip x t t and σ xy ip σ y ip x t i r is the identity matrix of dimension r r the proposed algorithms in krause et al 2008 perform a greedy optimization adding new places to sense the temperature until we achieve a satisfactory level of accuracy one of the merits in using os model is that the latent variables are directly observable so that no further procedure to estimate latent states is required the latent states x t can be directly estimated from the local measures at the selected sensing locations a the detailed procedure for the optimization in eq 13 follows the algorithm in krause et al 2008 the reconstruction error σ v determines the dimension of latent variables r and it is evaluated as the averaged trace of the empirical conditional covariance σ y ip x 17 σ v 2 1 p r tr σ y ip x v tol 2 after having selected the optimal set a the transition matrix is calibrated similarly to how it is done for the pca model adopting a least squared error lse objective function with a regularization term 18 l os l lse 1 2 α os τ f τ f hm f 2 the regularization term is introduced to identify stable transition matrices f hm is a homogeneous and isotropic transition matrix obtained from a pre training procedure as the solution of the markov gaussian process of eq 19 19 f hm σ x t x t 1 hm σ x t x t hm η hm 2 i r 1 where η hm is a disturbance noise and σ x t x t 1 hm and σ x t x t hm are the covariance matrices constructed using the homogeneous covariance kernel functions as in eq 20a and 20b 20a σ x t x t hm i j σ 2 exp δ i j λ hm 20b σ x t x t 1 hm ρ σ x t x t hm σ x t x t hm i j is element i j of matrix σ x t x t hm σ and ρ are scalar parameters that represent the standard deviation and correlation coefficient respectively λ hm is a parameter of the exponentially decaying function in eq 20a and δ i j is the geometric distance between sites i and j σ ρ and λ hm are calibrated through a pre training procedure by maximizing log likelihood function as 21 σ ρ λ hm argmax l l x t x t 1 σ x t x t hm σ x t x t 1 hm where ll is the log likelihood function of the pair x t x t 1 given homogeneous covariances σ x t x t hm and σ x t x t 1 hm after calibrating the pre training parameters the regularization coefficient α os is then selected through n fold cross validation in the os model we estimate the embedding matrix through linear regression similar to eq 18 linear regression is implemented with the homogeneous regularization scheme the embedding matrix is the optimal solution of the loss function of eq 22 22 l os φ l lse φ 1 2 α os φ φ hm f 2 where 23 l lse φ 1 2 n t δ y t φ x t l 2 2 the hyper parameter α os in eq 22 is set to be equal to that of eq 18 the homogeneous embedding matrix φ hm is defined similarly to the homogeneous transition matrix f hm sharing the parameter λ hm and σ 24 φ hm σ y t x t hm σ x t x t hm η hm 2 i r 1 where σ y t x t hm is a rectangular matrix whose elements are similarly defined as those of σ x t x t hm in eq 20 table 2 summarizes the details in parameter estimation for the os model 2 4 4 noise covariance the process noise is calculated with the estimated parameters in section 2 4 2 pca model or section 2 4 3 os model 25 w t x t 1 f τ x t the moving average scheme in eq 4 is also applied to estimate time dependent covariance matrix σ w τ sharing the parameter θ τ υ and λ θ of eq 4 and eq 5 26 σ w τ υ θ τ υ σ w υ where σ w υ 1 n υ t hod t υ w t w t t in eq 26 σ w τ is the estimated covariance matrix of w t at τ while σ w τ is the empirical covariance matrix 2 4 5 stationary distribution if the calibrated system is stationary the process converges to its stationary distributions as it progresses based on the diurnal cycle the process becomes time invariant with daily equivalent notations as described in eq 27 27 x t f d x t h w t d where f d τ f τ f d is the one day equivalent transition matrix and w t d is the equivalent process noise the cumulative noise covariance σ w d τ of w t d is a function of τ to indicate the time of the day of the stationary distribution the state covariance σ x τ converges to its stationary point with the lyapunov equation as in eq 28 28 σ x τ f d σ x τ f d t σ w d τ we set this stationary distribution of the process as an estimator for the initial distribution of the state when implementing the probabilistic forecast using kalman filter smoother scheme illustrated in section 2 5 2 4 6 stability stationarity and identifiability a discrete linear process x t 1 a x t is called asymptotically stable if all the eigenvalues of the transition matrix a have modulus less than one similarly in our models we have analyzed eigenvalues of the one day equivalent transition matrix f d to confirm that the calibrated process is asymptotically stable according to our analysis presented in section 4 the maximum values of the modulus ranges from 0 66 to 0 78 for one day equivalent processes on the other hand one may impose the stability condition by parameterizing the transition matrix during the model calibration stage as in bird and williams 2019 strictly speaking the proposed model is not stationary at each time of the day but it is stationary over days as the model structure defines a periodic process cyclostationary process for the detailed discussion readers may refer to gardner et al 2006 lastly the proposed models are identifiable and the calibrated model parameters are unique in general a linear dynamical system or linear gaussian state space model cannot guarantee identifiability because of the redundancies in the solution space however by imposing the pca os model to define latent variables the solution space is constrained such that either of the proposed models is identifiable we refer the reader to chapter 24 of barber 2012 for details on this issue 2 5 probabilistic forecast the temperature field y t at t is assumed to have a gaussian prior distribution 29 y t n μ y t σ y t where μ y t and σ y t are the prior mean and covariance of spatial temporal temperature field of the target domain given the linear combination as eq 3 the measurement vector z t also follows gaussian distribution and its mean μ z t and covariance σ z t are 30 z t n μ z t σ z t where μ z t h t μ y t σ z t h t σ y t h t t σ ϵ denoting the observation z 1 t to be a collection of z t for t 1 2 3 t forecasting temperature fields is to infer the field vector y t with the given observations z 1 t 31 y t z 1 t y t 1 t n μ y t 1 t σ y t 1 t where μ y t 1 t and σ y t 1 t are posterior mean and covariance respectively for state space models the inference procedure can be implemented by a recursive gaussian linear smoother also known as a kalman filter smoother following the details described in barber 2012 3 model calibration this section describes how we have collected data and calibrated the proposed models 3 1 weather data high resolution numerical simulations have been increasingly used to study the dynamics in urban scale weather effect and to mitigate related risk grossman clarke et al 2010 li et al 2013 li and bou zeid 2014 the temporal resolution of interest is also related to the urgency of decision framework for policy makers such as air water quality control construction project design and energy groundwater use chow et al 2012 li and bou zeid 2014 in this paper we have designed 1 km grid spacing as the spatial resolution adopting the one way nesting domains as in li and bou zeid 2014 malings et al 2017 the spatial resolution would be computationally affordable for data collection without expecting significant systematic error in local scale physics of the numerical simulator but that resolution would be still challenging for real time computation we also have set 30 min as the reporting intervals considering that this temporal resolution is tolerable for the potential urgency of decision making problems to calibrate the model historical weather data over the target domains are reanalyzed using wrf pucm by downscaling 6 hourly 12km 12 km data of north american meso scale forecast system nam 12 km analysis nam anl research data archive at the national center for atmospheric research and laboratory 2015 to 1km 1 km grid data with 30 min intervals using the dynamically downscaled data we have calibrated the proposed models for both domains around nyc 160km 160 km and pgh 200km 200 km as represented in fig 2 the weather simulation is conducted using a high performance computer cheyenne of university corporation for atmospheric research using 36 cores 72 logical processors of 2 3 ghz intel xeon e5 2697v4 broadwell processors the simulation data of this paper is published in choi et al 2021 3 2 training using wrf pucm a sequence of temperature fields is generated from jun 01 udt 00 00 to aug 31 udt 00 00 with 30 min intervals for three summers from 2016 to 2018 in both nyc and pgh domains 1km 1 km resolution a total of 13 251 stamps of temperature fields are used to calibrate the proposed models illustrated in section 2 table 3 summarizes the dataset that we generated and used for the calibration following the calibration procedures as summarized in table 1 and 2 we have estimated the parameters of the proposed models fig 3 a scatters the collected data and plots the calibrated mean temperature with 95 confidence bounds in a cycle of a day at brooklyn nyc 40 668 n 73 994 w fig 3b represents the histogram of near surface temperature and its fitted probability distribution of the os model at 18 00 for the same location table 4 and table 5 list the hyper parameters and their selected values in the model calibration the tolerance value v tol is differently selected in table 4 because the pca model shows more rapidly decreasing reconstruction error even with fewer latent variables than the os model 4 model validation in this section we conduct a numerical experiment for the calibrated models to forecast short term near surface temperature at relatively low computational cost in section 4 1 we describe three case studies and show the results then the prediction performance is assessed by comparing the accuracy and the evaluation time in section 4 2 4 1 short term forecast the meaning of short term depends on the purpose of the forecast or analysis among the officially operated weather forecasting systems the north american meso scale forecast system non hydrostatic mesoscale model nam nmm is one of the most detailed models which provides 3 hourly 12km 12 km grid weather forecasts for the next 84 hours up to the knowledge of the authors referring to the nam and considering the computational trade off in spatial temporal resolution we assume that a faster forecast predicts the next a few hours to a day at 1km 1 km spatial resolution with tens of minutes to an hourly time intervals in the conducted numerical analysis the calibrated models in section 3 predict the downscaled near surface temperature of wrf pucm from aug 01 2019 to aug 03 2019 which is at least one year apart from the training period we set input data to the calibrated model considering them as noisy signals with zero mean gaussian white noise i e ϵ t in eq 3 and we assume the standard deviation of the noise to be 0 1 c this noise level is set not to excessively disturb the forecast with the input noise we consider the following use cases to implement the fast forecast case 1 we assume availability of local temperature measurements at m locations y t 1 y t 2 y t m that represent virtual weather stations in this case the simulation outcomes of wrf pucm interpreted as collected field measurements are accessible up to the current time step the weather stations are evenly located with 6 km spacing case 2 in addition to inforamtion available in case 1 average temperature over the domain global average is also provided from wrf pucm data with 6 hourly intervals for the test period this case assumes the availability of the broader scale temperature forecast from an external source which has sparse temporal intervals and coarse spatial resolution similarly to the test case of malings et al 2017 case 3 this case provides multiple average temperatures of 12 km 12 km grids as shown in fig 4 d from wrf pucm data it describes a realistic scenario which exploits the most information among the case studies one can consider the multiple zonal averages as a prediction by nwp simulation at coarse and sparse resolution the grid spacing and time intervals are set to be similar to those of nam to assess the performance of the proposed models we set baselines obtained by the gp model developed in malings et al 2017 however because of the high computational complexity of the fully connected gp we must set constraints by limiting the number of accessible data points to attain the temperature forecast with reasonable computing resources baseline 1 this baseline forecasts temperature only using the past measurements as in case 1 but with the limited data we force the model to forecast temperature of individual locations only processing the measurements within a radius of 10 km sub domain at selected times up to the last 24 hours current time 00 00 00 30 01 00 03 00 06 00 09 00 12 00 18 00 24 00 this case is the closest configuration to case 1 under the limited computation budget baseline 2 for the test period we input the 12km 12 km zonal averages only this case is the fastest implementation that feeds overall spatio temporal information to the gp model baseline 3 in addition to baseline 1 baseline 3 uses the 6 hourly 12km 12 km average temperature but each location is allowed to exploit the zonal average where it belongs this baseline is considered as equivalent to case 3 but with constrained computing resources table 6 summarizes the information used in the case studies and the baselines other than spatio temporal models we also consider much simpler ways to forecast near surface temperature we evaluate the following simple quantities to investigate whether the probabilistic models enable improved temperature forecast simple forecast 1 t t 24h the temperature is predicted by the temperature of the previous day at the closest virtual weather station of case 1 simple forecast 2 t avg the temperature is predicted by the mean field temperature of the location at the same hour of the day τ fig 5 a represents the reanalyzed near surface temperature by wrf pucm on aug 02 2019 19 00 utc 15 00 edt for the nyc domain which is assumed as ground truth for this numerical experiment fig 5b illustrates the 24 hours ahead prediction by the baseline 3 for the same time point fig 5c and d are the 24 hours ahead prediction by the proposed state space models similarly fig 6 a represents the reanalyzed near surface temperature by wrf pucm on aug 03 2019 19 30 utc 15 30 edt for the pgh domain and fig 6b c and fig 6d are the 24 hours ahead prediction by the baseline 3 and the use of case 3 with the proposed models the selected time points are when each domain shows the hottest average temperature in fig 6a the dark spots indicating low temperature which do not appear in the forecast of proposed models are areas predicted as cloudy by the nwp model cloud positions have been hard to predict quantities even for nwp models and we do not investigate the exact cloud position as it is out of the scope of the paper still this discussion is still valid as the model performance targets wrf pucm because no cloud effect has been considered in the model the result can be interpreted as a trade off between faithful physical description and fast forecast however the proposed models perform well for the overall regions showing high accuracy as illustrated in section 4 2 fig 7 shows the 3 hours ahead predicted temperature by the os model during the test periods at brooklyn nyc and downtown pgh 4 2 model assessment to assess the performance of the models we conduct two types of validation 1 point wise and 2 probabilistic validation in both cases we compare pairs of observations and forecasts the point wise validation assesses model performance by comparing observation and mean forecast using traditional error metrics e g root mean squared error on the other hand the probabilistic validation compares the observation with the probability distributions of the forecast for example we evaluate the posterior probability of observations as a score for the probabilistic assessment 4 2 1 point wise validation we use the following error metrics 1 the root mean squared error rsme 2 the unnormalized bias b bias 3 the coefficient of variation in the mean absolute error cvmae and 4 the pearson linear correlation coefficient r the last three metrics are adopted from malings et al 2019 denoting the prediction outcomes of the wrf pucm and the proposed models as y i and y i respectively the rsme is defined as eq 32 32 rsme 1 n i 1 n y i y i 2 where n is the number of the target and forecast pairs the forecast bias is assessed by b bias and defined as the average difference between the forecasts and the observed values 33 b bias 1 n i 1 n y i y i cvmae computes the deviation of the forecasted values as the normalized absolute errors against the bias 34 cvmae i 1 n y i b bias y i i 1 n y i lastly the pearson linear correlation coefficient r assesses the linearity of the forecasts respect to the observed values 35 r i 1 n δ y i δ y i i 1 n δ y i 2 i 1 n δ y i 2 where 36 δ y i y i 1 n j 1 n y j 4 2 2 probabilistic validation we consider the continuous ranked probability score crps and the cross entropy ce as error metrics for probabilistic validation crps is defined as eq 37 37 crps f y i y i f y i y i 1 y i y i 2 d y i where f y i is the cumulative density function of the forecast y i and 1 is the indicator function that returns one if the prediction y i is greater than or equal to y i or zero otherwise cprs measures the divergence between the cumulative density functions of probabilistic forecast and its corresponding observation along with crps we also consider ce to measure the divergence between probability densities of two continuous random variables as in eq 38 38 ce f y i f y i f y i x log f y i x d x δ y i x y i log f y i x d x log f y i y i where f y i and f y i are probability density functions of the observation and the corresponding prediction respectively in eq 38 we have replaced f y i with the shifted dirac delta function δ y i x y i since the true distribution of the observation is unknown thus ce is equivalent to the negative log likelihood of the observation to be drawn from the prediction distribution 4 2 3 results for the different settings on the prediction lead time 00 30 01 00 03 00 06 00 09 00 12 00 18 00 24 00 the forecast results are assessed under the case studies fig 8 illustrates rsme versus the prediction lead time and also plots the errors of the simple forecasts in most case studies the proposed models showed forecast errors smaller than the baselines and the simple cases recalled that case 1 and 2 use much less information case 3 shows a considerable capacity to predict the near surface temperature achieving the accuracy around or less than 1 c rsme in both domains according to the results simple forecast 1 t t 24h outperforms several use scenarios of the pstms however this simple forecast never reaches the probabilistic models best performance that leverages the spatio temporal patterns to forecast near surface temperature using the various input information its prediction error 1 67 1 87 c is far above that of the proposed models case 3 0 97 1 13 c the result reveals that simple forecast 2 t avg is not a reliable predictor because although it performs well in the pgh domain it is the worst predictor in the nyc domain this measure does not work well especially when the current weather is quite dissimilar to the average gp s inherent weakness in extrapolation explains the unsatisfactory performance of baseline 1 baselines 1 and 3 reduce their prediction error as the prediction lead time approaches 24 hours except for 24 hours ahead prediction of baseline 1 in nyc this is because the gp model uses a periodic kernel function with a daily cycle in fig 8b as the prediction lead time increases the estimated error of case 1 becomes higher than that of simple forecast 2 t avg and then approaches to it both in pca and os model this behavior represents the typical characteristics of the proposed models given the calibrated one day equivalent transition f d whose absolute eigenvalues are less than 1 a random state of the system will eventually converge to the stationary distribution related to eq 28 in case 2 the prediction is more precise in the pgh domain than the nyc domain the result implies that the global average i e the input of the case study can estimate the latent states well in the pgh region the nyc region requires more detailed information to forecast temperature due to the higher uncertainty this remark is consistent with the higher temperature variance in nyc for example in nyc brooklyn shows a 4 07 c standard deviation at 18 00 utc 14 00 edt having its highest mean temperature 26 49 c while downtown pgh has the highest mean value 28 45 c at 19 30 utc 15 30 edt but a smaller standard deviation of 3 09 c possible reasons for the higher variance of nyc can be the land use i e high urbanization and the influence of the atlantic ocean the nyc domain contains 24 38 of grid cells classified as urban of which the most dominant land use is again urban while 37 17 of the region is covered by water surfaces mostly by the ocean in contrast the pgh domain includes only 3 23 and 0 51 of urban area and water surfaces mostly rivers respectively however a more sophisticated study is required to identify the sources of temperature variability table 7 and table 8 provide the 24 hours ahead forecast rsme for the different land uses gp model is set to forecast the temperature fields excluding water surfaces from the nyc domain due to its homogeneous covariance kernels the gp model may predict land temperature erroneously when it considers the wetland temperature for example because of the homogeneous covariance kernels temeratures at two locations one at land and the other on the ocean having the same distance from a third one would have the same correlation coefficient with the temperature of the third place and this yields erroneous forecasts non urban areas denote grid cells where the most dominant use type is neither urban nor wetland for both nyc and pgh the proposed models show better performance in most cases even though baseline 3 is the best predictor for urban areas around nyc the proposed models also show almost equal performance in case 3 overall prediction performance is better in pgh than in nyc and it might imply more predictable weather patterns in the pgh domain having less variability as discussed in the previous paragraph in comparing urban and non urban areas urban areas tend to hold higher predictability in both domains except baseline 2 possible rationale includes the central location of urban areas in the test domains because the spatial correlation tends to decay with the geometric distance both pca and os models may have learned how to forecast temperature better in the center than at the borders of the domain the wetland temperature in nyc is the most predictable quantity for case 3 while it is the most challenging one for case 2 in the nyc domain the global average may not be an informative input to identify wetland temperature the rsme is significantly reduced only when the proposed models receive more detailed inputs as in case 3 in contrast in the pgh domain wetland temperature shows the highest prediction error for all cases except baseline 1 the calibrated models might under fit this small fraction 0 51 of wetland which still has significant heterogeneity a further investigation on the model performance is conducted with b bias cvmae and correlation coefficient r fig 9 and fig 10 represent the statistical summary of the evaluated error metrics at individual locations fig 9 demonstrates that the proposed linear models produce less biased forecasts at overall locations and for the overall use cases fig 10 shows the statistical summary of cvmae and correlation coefficient r the horizontal and the vertical range represent 25 and 75 percentiles with the mean values of the locations for case 3 the pca model shows 0 036 and 0 035 cvmae having 0 94 and 0 97 r values in nyc and pgh respectively meanwhile the os model shows 0 034 0 035 cvmae and 0 95 0 97 r values for the same case baseline 3 slightly outperforms the pca model in the nyc domain but the difference is negligible the assessment still confirms the ability of the proposed models as a forecasting approach table 9 reports the evaluated rmse crps and ce with additional test periods which were adopted from malings et al 2017 the additional periods were set differently for the nyc and pgh domains from aug 01 to aug 04 in 2019 the gp model reports its crps as 0 80 c and 0 72 c in the nyc and pgh domains respectively while ce is 2 1732 and 1 7222 in terms of crps the proposed models show better performance than the baselines for both domains during the period in comparing ce values the os model outperforms the other two models gp and pca while the other models show very similar performance however we argue that the pca model is still more advantageous because of its computational efficiency as shown in table 10 in table 9 the model performance is consistent for all three test periods which hints at promising applications of the models for further model use periods table 10 summarizes the measured computational times of the proposed models case 3 and baseline 2 to generate the three days forecast we choose baseline 2 for the comparison since it is the fastest case among the baselines baselines 1 and 3 took more than an hour using the same computing resource 12 processors of intel xeon e5 2690 v4 2 60ghz as a result the pca and os models provide qualified forecasts within a shorter evaluation time 20 170sec using one twelfth of the computing resource a single processor of intel xeon e5 2690 v4 2 60ghz such rapid computation has been achieved by the efficient state space representation with the low dimensional embedding the domain size and the different latent dimensions lead to the varying evaluation time of the proposed models for example the nyc domain 150km 150 km shows a shorter evaluation time than that of the pgh domain 200km 200 km also the latent dimension of the os model 135 variables in nyc and 276 variables in pgh is higher than that of the pca model 46 variables in nyc and 91 variables in pgh so the evaluation time is shorter for the pca model in this case study the numerical campaign shows that the forcast performance is similar for pca and os models however from the authors experience the pca model has a technical advantage in choosing the dimension of latent states for example in the model calibration the pca model achieved a smaller reconstruction error with fewer latent variables than the os model the rapidly decaying error of the pca model enables a convenient dimension truncation and a faster computation as reported in table 10 5 conclusion we proposed a probabilistic approach to provide a faster near surface temperature forecast with reasonable accuracy as a potential alternative to physics based numerical weather prediction models the probabilistic spatio temporal modeling has been developed to capture statistical temperature patterns and facilitate them for a faster forecast the method is based on linear markov latent state variables of low dimensionality alleviating the risk of overfitting related to the high dimensionality of the temperature data the latent states account for the spatio temporal evolution of the process also the state space representation substantially reduces computing time during the forecasting stage in this paper we presented two alternative linear models the first model relies on global features using principal component analysis while the second one focuses on local measures at optimally sensing locations these two models showed similar forcast performance but the pca model is technically preferable because of its straightforward implementation we calibrated the proposed models with simulated temperature data using a physical simulator the princeton urban canopy model coupled with weather research and forecasting model wrf pucm for the data collection the physics based model downscaled historical weather data in the regions around new york city and pittsburgh for three months of summer june july august from 2016 to 2018 then the kalman filter smoother scheme integrated sensor data for the faster temperature forecast we assessed the model performance by forecasting a short term temperature for august 1st to 3rd 2019 under the investigated case studies the results confirm that the proposed models produce adequate forecasts at a relatively low computational cost in the numerical analysis our models achieved 0 97 1 13 c in root mean squared error for 24 hours ahead forecast in the case with most information available taking only 20 170 sec to generate three days forecast with a single processor computer intel xeon e5 2690 v4 2 60ghz the result is 14 22 improved accuracy compared to the most accurate case of the baseline model which is based on a gaussian process regression and our models consumed less evaluation time than the fastest case of the baselines using only one twelve computing resource the models can be expanded to be integrated in the heat induced risk analysis ofurban areas for example it can be applied to rapidly downscale the result of an ensemble of numerical weather forecasts to better inform on the probabilistic heat risk for urban residents and allow decision makers to take early and appropriate action data availability the data presented in this paper are available through a mendeley data repository as follows shade 2021 meso scale 2m air temperature around new york city and pittsburgh availability https data mendeley com datasets pr4m594vmf doi 10 17632 pr4m594vmf 2 size 3 11 gb year first available 2021 email byeongsc andrew cmu edu credit authorship contribution statement byeongseong choi methodology software investigation formal analysis writing original draft visualization data curation mario bergés validation formal analysis writing review editing supervision elie bou zeid software investigation resources writing review editing matteo pozzi conceptualization validation formal analysis resources writing review editing supervision funding acquisition project administration declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests mario berges reports financial support was provided by national science foundation elie bou zeid reports financial support was provided by national science foundation matteo pozzi reports financial support was provided by national science foundation acknowledgement this research is supported by the national science foundation under grant no 1664091 and 1664021 the authors thank prof prathap ramamurthy at the city college of new york for the assistance to simulate past climates with wrf pucm also the project upri 0007 computational and information systems laboratory provided the computing resource for the research a appendix a in this section we compare the calibrating procedure proposed in this paper with a widely adopted iterative method the expectation maximization em algorithm with bayes formula the posterior distribution p x y can be decomposed into the prior distribution p x and the likelihood p y x as eq a 1 a 1 p x y p y x p x p y for multidimensional gaussian random variables x and y the posterior distribution follows gaussian distribution and eq a 2 describes the posterior mean as a linear combination of the prior mean μπ and its corresponding likelihood estimator μ l a 2 μ x y σ x y σ x 1 μ π σ x y σ l 1 μ l where σ x y σ x 1 σ l 1 1 or σ x y σ x σ xy σ y 1 σ yx σ x and σ y are the prior covariance of x and y respectively and σ l is the covariance of x that is evaluated from the likelihood function with the given observation y σ x y is the posterior covariance matrix of x conditional to y now we consider the graphical representation of the zero mean state space model as fig a 1a in fig a 1b we define the prior distribution of x t as the conditional distribution of x t with the given input states x t 1 and x t 1 without inclusion of the observation y t red dotted box here the prior distribution is to denote it is prior to observe the emission y t adopting the notations of barber 2012 the mean of p x t x t 1 x t 1 can be represented as eq a 3 due to the linearity between gaussian random variables a 3 μ π a π μ x t x t 1 a π μ x t x t 1 where a π σ π σ x t x t 1 1 a π σ π σ x t x t 1 1 σ π σ x t x t 1 1 σ x t x t 1 1 1 μ x t x t 1 and μ x t x t 1 denote the conditional mean of x t given the dynamic predictors x t 1 and x t 1 respectively similarly σ x t x t 1 and σ x t x t 1 are the conditional covariance given the predictors now we update the prior distribution again with the observation y t which is a variable of dimension much higher than x t figs a 1c and a 1d a 4 μ post b π μ x t x t 1 b π μ x t x t 1 b l μ x t y t where b π σ post σ π 1 a π b π σ post σ π 1 a π b l σ post σ l 1 σ post σ π 1 σ l 1 1 μ x t y t and σ l represent the likelihood estimators for the mean and the covariance of x t with the observed emission y t as a forward and backward smoothing scheme em algorithm iteratively improves the estimation of the state variable x t and the transition matrices a π and a π to analyze the effect of non em implementation we compare the relative magnitude of the forward weight matrix b π and the backward weight matrix b π to the likelihood weight matrix b l using the calibrated parameters in section 3 the defined relative magnitude is the trace of forward or backward weight being normalized by that of the likelihood weight fig a 2 summarizes the result of the numerical test presenting the relative contributions of the dynamic predictors according to the result the contributions of forward and backward priors are relatively small respect to that of the likelihood so the likelihood shows the dominant impact on the states estimation therefore the forward and backward smoothing scheme in em algorithm is not expected to yield much improvement fig a 1 graphical representation of a state space model fig a 1 fig a 2 relative magnitude of prior weights fig a 2 a 1 example city of pittsburgh implementing em algorithm for high dimensional system consumes additional computing resource for the model calibration in this subsection we continue the discussion on em versus non em implementation with a reduced scale model fig a 3 illustrates the map of the model of the city of pittsburgh the mass points represent the locations of interest within the city using em algorithm we calibrate the pca model then show the change of the log likelihood depending on the number of iterations of the algorithm for this city scaled model only 3 principal components are enough to achieve the 0 35 c and 0 36 c reconstruction error for em and non em respectively we calculate the likelihood function for each single em step dividing the term into transition prior and emission likelihood parts fig a 4 shows the convergence of the em algorithm and we scattered the estimated latent variables at the last stage of the iterative algorithm with those of non em implementation fig a 5 as the algorithm progresses the total likelihood increases with small increments but a trade off exists for the transition and the emission terms the numerical investigation confirms that the improvement is not significant especially for the lower order principal components which account for dominant behavior of the system therefore the direct measurement on the emission y t still has the most significant contribution to the latent states inference fig a 3 mass points within pittsburgh fig a 3 fig a 4 convergence diagram fig a 4 fig a 5 estimated latent variables fig a 5 
25742,deterministic models have emerged as a widely accepted tool for investigations in lentic aquatic ecosystems in this study an extensive literature review is provided by an inventory of papers published over the last six years 2015 2020 to explore the recent progress of deterministic models applied to lakes and reservoirs the current trends include the application of well established models across broad ranges of time and spatial scales the integration of lake catchment and climate models in addition to multi model ensemble approaches and the proliferation of high frequency sensors and the usage of remote sensing images for model initialisation forcing data inputs and calibration and validation it is expected that the emerging trends in modelling lakes and reservoirs can be of great use for future research prospects as a source of information for subsequent studies in the field keywords limnology aquatic ecosystem water quality eutrophication hydrodynamics biogeochemistry 1 introduction in the mid twentieth century when eutrophication became the major stressor of lakes and reservoirs worldwide vinçon leite and casenave 2019 the understanding emerged that inland waters are vulnerable to anthropogenic forcing gal et al 2009 preserving the integrity of aquatic ecosystems as opposed to their passive exploitation has been a growing goal as aquatic ecosystems support economic activities such as water supply for agriculture mereu et al 2016 and drinking water jeppesen et al 2015 hydroelectric power generation kobler and schmid 2019 and fishing makler pick et al 2017 in addition they provide ecosystem services for example by providing habitat for aquatic organisms schallenberg et al 2013 to capture the ecosystem s response to anthropogenic stressors and pressures from climate change affecting both developed and emerging countries deterministic models emerged as a potential tool to explore the functioning of aquatic ecosystems at local regional and global scales in an effort to obtain a greater understanding of the system behavior lake models intend to achieve the following principles of 1 generality by applying general equations and assumptions valid in a broad variety of sites requiring few local adjustments 2 accuracy in which they reproduce the observed data with minimal errors and 3 realism in which they attempt to explain the dynamics of the real system in detail ganju et al 2016 deterministic lake models differentiate from statistical models in their capacity to simulate a system in terms of the processes acting on state variables statistical models also called black box models or empirical models are formulated as a direct mathematical relation between forcing and state variables with no causality deterministic models also referred to as mechanistic models or process based models are based on a set of differential equations that describe physical chemical and biological processes i e the water column is represented as a compartment with different representations of boundary fluxes related to air water exchanges sediment water exchanges and inflows and outflows providing the mechanisms underlying aquatic ecosystem processes across thresholds machine learning methods have rapidly overtaken traditional empirical models and have emerged in recent years as a promising tool for improving model skill and ecological inference hanson et al 2020 and also as an alternative approach to physics based models jia et al 2020 deterministic lake models can be classified according to their i variation on time as static or dynamic ii dimensionality from 0d to 3d and iii components of the ecosystem including hydrodynamic module nutrients module and biological module static models are based on a steady state assumption they are suited when a static situation is sufficient to give a proper description of an ecological system relying in a reduced applicability on the other hand dynamic models are based on ordinary or partial differential equations to describe processes over time most of the eutrophication models in the early development stage were static types but rapid development in dynamic modelling has been observed since the 2000s resulting in less than 2 of static models publication in ecological modelling from 2000 to 2006 jørgensen 2008 models vary in spatial dimension according to the water body s features and targeted processes zero dimensional or box models assume a complete mixed water body with no spatial variation being suited for small lakes or ponds one dimensional models simulate the spatial change over a single dimension either horizontally length or vertically depth averaged being able to represent a narrow estuary or a small but well stratified lake respectively two dimensional models which are more rarely used simulate spatial variations in the lateral and longitudinal directions width and length or in vertical and longitudinal directions depth and length they are most suited for large but shallow lakes or deep but narrow lakes three dimensional models simulate changes in all three spatial domains width length and depth being adequate for deep and large lakes and reservoirs 3d models are the most physically realistic representation for a water body providing the most detailed assessment of the studied processes ultimately the selection of a model s dimension must be bound by justifiable simplifications to balance the research question the ecosystem and knowledge not making the model more complex than the data set can support jørgensen 1995 besides the availability of resources such as computing and manpower govern which dimension can be supported for example the simulation of climate change effects on a water body over a 100 year period would be a difficult task using a 3d model in terms of computational costs and time constraints in addition model outputs would have a high level of uncertainty rather a 1d model may perhaps provide just as valuable and as accurate outputs at a lower time and cost e g man et al 2021 according to the objective of the modelling i e the problem to be assessed different components should be represented hydrodynamic models are based on well constrained equations to simulate the physical environment such as the water level water velocity temperature salinity ice and photosynthetically active radiation ecological models generally cover a wide range of components including nutrient cycles oxygen balance and biological communities since the first lake models their development and application have undergone substantial advances with increasingly predictive ability and now they can cover more than 100 state variables janssen et al 2015 lake models found widespread use for a wide range of time and spatial scales trolle et al 2012 and have been applied for several purposes i scientific aiming to advance theory by exploring ideas demonstrating concepts understanding the mechanisms that govern ecosystem functioning and elucidating the relationships between internal processes and external forcing schmolke et al 2010 ii methodological intending to fill gaps in observations by extrapolating the range of historical temporal and spatial measurements janssen et al 2015 and iii decision making to predict the interaction between management actions and ecosystem response and to estimate the effort required to avoid adverse conditions or to restore degraded systems hipsey et al 2015 by synthesizing virtual experiments to manipulate conditions that would be too expensive too time consuming or unethical to do in a real world system peck 2004 owing to the recognition of the contribution given by models to the study of spatio temporal dynamics in lake ecosystems several review articles have evaluated the development and application of models in terms of diversity janssen et al 2015 accuracy robson 2014a uncertainty uusitalo et al 2015 complexity mcdonald and urban 2010 performance bennett et al 2013 validation alexandrov et al 2011 and applicability costa et al 2019 a starting point review was conducted by jørgensen 1995 which discussed the need for additional constraints to better represent the properties of ecosystems the front line problem of modelling in the 1990s more recently overviews assessed the modelling of eutrophication and cyanobacteria harmful blooms in lake ecosystems bhagowati and ahamad 2019 janssen et al 2019 rousso et al 2020 vinçon leite and casenave 2019 and the challenges to model water quality in the anthropocene mooij et al 2019 however most of these reviews were in the context of aquatic ecosystem models applied not only to lakes and reservoirs but also to rivers estuaries wetlands and oceans e g anagnostou et al 2017 brewer et al 2018 costa et al 2019 de goede 2020 robson 2014b also including other modelling approaches such as statistical and empirical models e g voinov et al 2018 considering that few reviews focused specifically on deterministic lake models this paper provides an overview of the current generation of deterministic models applied to lakes and reservoirs by conducting an extensive literature review of papers published over the last six years 2015 2020 the aim of this study was to provide a comprehensive overview and novel insights of the recent progress in lake modelling in face of the rapid developments in the field the in depth analysis of the state of the art is expected to encourage modellers future works and to assist water managers towards a sustainable management of water resources 2 historical trajectory of deterministic lake models historically lake ecosystem models have been developed to address questions concerning water quality degradation mostly related to eutrophication nutrient cycling dissolved oxygen concentration chlorophyll a concentration hipsey et al 2015 and fish habitat by investigating oxygen temperature and later on light chang et al 1992 the first empirical equations that relate loads to concentrations the precursors of lake ecosystem models were developed in the early 1970s to describe eutrophication processes for environmental management purposes based on the scientific insight of the work of vollenweider 1968 that provided algorithms to calculate nutrient retention in lakes from the late 1970s to the mid 1980s models were based upon ecological knowledge and despite their qualitative or semi quantitative prediction capacity they could be used as prognosis tool in limnology being applied to environmental management jørgensen 1995 during the 1990s and 2000s modelling experienced rapid growth determined by the advances in technological and computational progress providing greater processing speed and memory data storage at a lower cost and better graphic properties which ultimately allowed more complexity and greater use of 3d models robson 2014a at that time there was a tendency for each research group to develop their own models instead of applying previously existing models jørgensen 2010 more recently however rather than using independently developed models directed to a specific set of questions investigators are focusing on widely applicable and well established open source models frassl et al 2019 covering a wide range of lake characteristics in terms of morphology geographical location and hydrological features this emerging trend can be seen as an organised effort to avoid reinventing the wheel as suggested by mooij et al 2010 and to go into more depth in terms of development tasks taking advantage of the existing models to modify and combine the strengths of them additionally from the beginning of the 2010s the scientific community organised itself in interdisciplinary collaborative networks in order to accelerate advances in the modelling of lake ecosystems through the sharing of data methods and experiences the collaborative networks together with the increasing resolution and quality of field data boosted the development performance transparency and reliability of models in predicting lake systems on a global scale weathers et al 2013 the representation of lake ecosystems has become more complex after incorporating the concept of environmental integrity which also considers the ability of ecosystems to maintain their ecological function hipsey et al 2015 the models have been increasingly applied to encompass regional or continental aspects resulting in their application in different environmental and geographical conditions janssen et al 2015 3 review of papers published over the last six years the present review performed a compilation of modelling studies written in english over the last six years 2015 2020 the research was conducted on november 2020 in the following databases scopus web of science and google scholar the selection of models was based on the most widely referenced deterministic models in recent years gaudard et al 2019 janssen et al 2015 mooij et al 2010 applied to lakes and reservoirs and currently under use worldwide for example by the inter sectoral impact model intercomparison project isimip they consist on an inventory of seventeen hydrodynamic water quality and ecosystem models 1 aquatic ecodynamics aed hipsey et al 2013 2 arctic lake biogeochemistry model albm tan et al 2017 2015 3 ce qual w2 environmental and hydraulics laboratories 1986 4 computational aquatic ecosystem dynamics model caedym hipsey et al 2005 5 delft3d flow deltares 2021a and or its water quality model delft3d waq deltares 2021b 6 dynamic reservoir simulation model dyresm antenucci and imerito 2000 and or its water quality module dyresm wq 7 ecopath with ecosim ewe christensen et al 2000 8 estuary lake and coastal ocean model elcom hodges and dallimore 2007 9 freshwater lake model flake mironov 2008 10 general lake model glm hipsey et al 2019 2017 2014 11 general ocean turbulence model gotm burchard et al 1999 12 lake stepanenko et al 2016 13 minlake riley and stefan 1988 14 mylake saloranta and andersen 2007 15 pclake janse and van liere 1995 16 phytoplankton responses to environmental change protech elliott et al 2010 and 17 simstrat goudsmit et al 2002 the search term was taken as the exact name of each model resulting in 479 peer reviewed publications from those we selected the ones that simulated at least one of the key variables that represent either the hydrodynamics or the water quality including ji 2007 p 5 water temperature salinity velocity sediment toxics dissolved oxygen and nutrients also only the studies that presented a case study of real lakes or reservoirs were considered in the present study resulting in 328 papers see supplementary material modelling of virtual systems bays lagoons estuaries and ponds were not included as well as thesis and conference papers a full text assessment was conducted to support the discussion of the state of the art of deterministic models regarding the following topics 1 global distribution of model applications 2 temporal and spatial domains 3 state variables 4 stressors of the aquatic ecosystem 5 coupled models 6 ensemble modelling approach 7 frequency of field measurements 8 use of technological devices 9 prediction accuracy 10 methodological procedures and 11 use of open source models 3 1 geographical distribution the most studied lakes during the 1970s and the 1980s were mainly located in north america while in the 1990s modelling works were increasingly carried out on lakes from western europe vinçon leite and casenave 2019 from 2015 to 2020 investigations were conducted in lakes and reservoirs from more than 45 countries fig 1 the regions where lake ecosystem models began to be applied still top the list of study areas indeed the most studied lakes and reservoirs are situated in europe 34 mostly in germany switzerland and italy and north america 23 in the united states and canada however a clear dissemination has been observed beyond the historical temperate countries there was a significant increase in the number of studies carried out in asia 20 in bangladesh india philippines russia singapore south korea taiwan and especially in china and in middle east 9 in iran israel lebanon turkey and turkmenistan indeed 45 studies out of 328 were applied to chinese lakes and reservoirs such as lake taihu for which models were developed to predict and warn against future algal blooms hu 2016 in parallel only 6 of the studies was conducted in central south america brazil chile colombia and mexico 5 in africa congo egypt ethiopia ghana kenya morocco and tunisia and 3 in oceania new zealand and australia in developing countries from central south america and africa the socio economic situation and limited financial resources caused less support for research investigations although progress has been made towards a greater geographic distribution of the places where the studies were conducted additional efforts are still needed for tropical countries as latitude plays a crucial role in hydrodynamics and water quality hence tropical lakes may behave differently from the high latitude ones lewis jr 2000 3 2 expanding temporal and spatial domains typically traditional environmental approaches have focused on understanding processes that operate on a temporal scale convenient for human observation ranging from about an hour to a year or two rose et al 2016a long term studies are expanding observations to decades or longer mostly to assess policy and management issues which are often influenced by environmental factors acting in various temporal scales indeed mid or long term modelling is required for assessing ecosystem evolution in response to local and global changes such as i climate change 104 year in fish lake usa magee et al 2018 57 year in lake chaohu china zhang et al 2020 40 year in lake langtjern norway couture et al 2015 and 34 year of lake nam co china huang et al 2017 ii urbanisation 60 year in lake chaohu china kong et al 2017a and 25 year in lake dianchi china li et al 2019 and iii contamination 60 year in lake chaohu china kong et al 2017b besides over longer time scales models are used to capture long lasting responses to management practices and restoration efforts for instance the simulation of scenarios for reduction of phosphorus load into lake mendota usa over a 37 year period provided the required reduction to alleviate oxythermal stress and the associated economic cost magee et al 2019 this latter is an excellent example of how the temporal expansion has the advantage of testing management strategies in face of long term responses in the 328 published articles simulations covered a period of 191 years from 1911 to 2101 fig 2 most of them were focused on the years from 1990 to 2020 on average each year over this period was assessed by 77 studies aiming at understanding processes such as extreme events and at simulating management strategies for operation optimisation pollution water abstraction and anoxia studies that applied models for hindcasting purposes for the period from the 1910s and 1990s on average each year over this period was assessed by 14 studies were focused mostly on the impacts of human disturbances on the ecosystem especially eutrophication and regime shifts hindcasting studies for the period prior to the 1950s focused mostly on the long term alterations in thermal regimes the projection studies covered the period from the present until 2101 on average each year over this period was assessed by 21 studies aiming at predicting the effects of future climate and land use scenarios on aquatic ecosystems the spatial scale historically focused on single study sites increasingly includes research across many sites indeed 53 over 328 studies 16 covers regional or continental aspects which enables a more contextual understanding of hydrodynamics bruce et al 2018 gas emissions guo et al 2020 response to extreme events woolway et al 2020 and effects of climate change almeida et al 2015 hansen et al 2017 maberly et al 2020 woolway et al 2017 efforts have been made to identify universal descriptors of processes similarity in emergent behaviors and how water quality pathways vary across geomorphologic and climate gradients hipsey et al 2015 for example winslow et al 2017 modeled the response of 10 774 lakes to changing climate drivers to give managers insight on individual lakes similarly rose et al 2016b modeled the thermal characteristics of 1894 temperate lakes in the usa to investigate how water clarity can influence the response of both surface and bottom water temperatures to climate change 3 3 a variety range of variables of interest water temperature was the most studied variable in 71 of the studies table 1 however 50 of these references did not focus on the modelling of temperature only but on the representation of the physical habitat and thermal structure of aquatic systems as a compulsory step for modelling biogeochemical processes the other state variables of the hydrodynamic component were water circulation 7 and salinity 1 total phosphorus 24 total nitrogen 21 and their constituents were largely studied which can be attributed to their role in eutrophication dissolved oxygen was also extensively studied 27 mostly to assess issues concerning hypoxic conditions in deep lakes and reservoirs in addition carbon 6 methane 1 sediments 1 and contaminants 2 including organic compounds hydrocarbons and metal were simulated geochemistry state variables the ecosystem was represented mostly in terms of phytoplankton which was the interest of 125 modelling studies out of 328 38 aiming at a better understanding of phytoplankton dynamics and the processes that control its excessive biomass from those 125 studies 64 of them 51 represented the phytoplankton as multiple functional groups rather than simulating the total biomass which relies on the representation of different morphological physiological and ecological characteristics from 2015 to 2020 phytoplankton community was represented as two cui et al 2016 van der linden et al 2015 zamani et al 2016 three brett et al 2016 brito et al 2018 chen et al 2016 four gray et al 2019 khatun et al 2020 soulignac et al 2019 five dalton et al 2016 tesfaye and wolff 2018 and seven wang et al 2019 zhu et al 2020 taxa among the phytoplankton groups cyanobacteria has gained an increased interest due to the worldwide occurrence of their blooms and the associated public health problems e g fadel et al 2017 silva et al 2019 the functional grouping offers an intuitively approach that accounts for different patterns of specialism considering that the external forcing and the internal environment may profoundly modulate the signals of each group shimoda and arhonditsis 2016 when the objective of the simulation relies on the total concentration of chlorophyll a for example for assessing the trophic status of a water body the simulation of the total biomass as one group is sufficient otherwise when the composition of the biomass the competitive interactions between different groups for resources such as light and nutrients or succession dynamics are important for the ecosystem the simulation of multiple groups is a valuable approach furthermore few studies went into more depth concerning the specialisation and simulated phytoplankton species for example fadel et al 2017 simulated the succession of cyanobacterial blooms of two different species in a hypereutrophic reservoir for early warning systems and management scenarios bracht flyr and fritz 2016 simulated the timing and distribution of two diatom species in crevice lake the usa radbourne et al 2019 assessed the effects of changes in external nutrient loads on the seven most abundant phytoplankton species in rostherne mere lake england and elliott et al 2016 investigated how eight phytoplankton species may adapt in response to potential future changes in air temperature and future load in lough neagh lake ireland zooplankton was also the target variable of some studies 15 mainly focused on the eutrophication and the impact of regime shifts moreover from the 49 studies that have simulated zooplankton 30 of them 61 represented zooplankton by groups for instance three zooplankton groups predatory zooplankton herbivorous zooplankton and micro zooplankton were simulated in lake kinneret israel makler pick et al 2017 two groups herbivores and carnivores were simulated in lake bourget france kerimoglu et al 2017 and also two groups cladocerans and copepods were simulated in lough leane lake ireland dalton et al 2016 the dynamics of macrophytes 8 and fishes 13 were also simulated to represent food web dynamics macrophytes were simulated in a recent investigation that studied how they can affect flow dynamics by increasing flow resistance bulat et al 2019 fish communities were also simulated in an investigation focused on the impact of the total external nutrient load on the dynamics of lake taihu china janssen et al 2017 the models selected for the present review analysis provided a comprehensive overview of the most investigated state variables however as some of the models are not able to simulate zooplankton macrophytes or fishes we recognise that the percentages presented above might be biased and should be interpreted with caution 3 4 modelling the effects of climate change and eutrophication on aquatic ecosystems several threats to the health of aquatic ecosystems were assessed by modelling studies as expected climate change and eutrophication were the major concerns fig 3 covering 29 and 14 of the published studies respectively the impacts of eutrophication and climate change are closely related and therefore some studies 3 have investigated their combined effect different approaches were adopted to investigate the combined effects of both climate change and eutrophication i using regional climate models as input to the lake model to assess the effects of changes in atmospheric forcing variables mainly in air temperature and precipitation on eutrophication causes and symptoms for instance chang et al 2015 have found that the intensified thermal stratification caused by the rising temperature resulted in a higher risk of algal blooms and eutrophication in the hsinshan reservoir taiwan ii coupling lake model with catchment model to account for projected changes in runoff and nutrient loads the study by me et al 2018 indicated that polymictic lakes may be particularly vulnerable to eutrophication associated with climate change due to increased internal nutrient loading while changes in external loads will have lesser relative impact and iii using a sensitivity procedure by applying incremental perturbations in the forcing variables to disentangle the effects of changes in individual physical drivers in a present day simulation gray et al 2019 conducted systematic and independent changes in water temperature and mixed depth in blelham tarn lake england whilst keeping other variables constant revealing that each change result in impacts that can act synergistically on phytoplankton biomass similarly rolighed et al 2016 simulated multiple combinations of increasing air temperatures and reduced external nutrient loads which reveals that in a future warming scenario a nutrient load reduction of as much as 60 would be required to achieve summer chlorophyll a level similar to those of the present day in lake søbygaard denmark considering that the effects of climate change on lakes and reservoirs have great ecological significance because they can affect ecosystem s biogeochemistry and ecology modelling the simultaneous impacts of climate change and eutrophication in a lake system produce model results physically based on climate forcing that can be used as a proxy for future planning this field is currently under development since many physiological attributes of the phytoplankton are likely to be differentially impacted therefore there is still a lack of accurate predictions at a species level and further consequences we might expect with a changing climate burford et al 2020 the interactions between climate change and greenhouse gas emissions via direct temperature effects are also an emerging topic in the field bartosiewicz et al 2019 moreover increasing interest for modelling the impact of other issues was observed related to climate on aquatic ecosystems such as extreme weather events e g chen et al 2020 soares et al 2019 regime shifts e g kong et al 2017a and variations in evaporation rate e g helfer et al 2018 in addition the biomass and spatial distribution of fish populations in face of unsustainable fishery was considerably assessed in previous studies e g bhele et al 2020 clancey et al 2017 goto et al 2020 tesfaye and wolff 2018 some importance was given to the modelling of other threats related to pollution e g eilers et al 2016 including nutrient loads from different land uses e g mueller et al 2019 and erosion e g sadeghian et al 2017 owing to the strong impact on trophic webs and aquatic organisms and the implications for human health the simulation of contaminants including organic compounds e g amirkani et al 2016 and hydrocarbons e g kong et al 2017b has emerged in some investigations finally operational strategies of lakes and reservoirs were assessed e g carr et al 2020 for instance for optimum water abstraction e g lindenschmidt et al 2019 and for hypoxia avoidance e g weber et al 2017 both in terms of quantitative and qualitative impacts on aquatic ecosystems 3 5 coupled models for an interdisciplinary link between catchment lake and climate coupling models i e the output from one model as input for the other enables the assessment of the potential for synergistic or antagonistic interactions between forcing variables and internal processes this approach has gained prominence since the 2000s jørgensen 2010 for predictions of lake ecosystems across a variety of scientific disciplines hydrodynamic models coupled to biogeochemical models have been increasingly applied for example the dyresm was used coupled to the caedym biogeochemical model as well as glm used coupled to the aed biogeochemical model table 2 moreover using catchment models to generate boundary input conditions for lake models has been a tendency to assess the nutrient loadings and to coordinate environmental strategies for instance swat soil and water assessment tool was coupled to ce qual w2 to dyresm caedym and to glm aed and pclake swmm storm water management tool was coupled to dyresm caedym marina model to assess river inputs of nutrients to seas was coupled to pclake simplyp was coupled to mylake and finally inca integrated catchment model was coupled to protech table 2 in addition some tools have been developed to improve the coupling of lake and catchment models such as the plugin swat2lake molina navarro et al 2018 and the water ecosystems tool nielsen et al 2017 some published articles combined climate models and lake models in order to project future climate change impacts on water quality additionally the complex task of coupling climate catchment and lake models was the focus of some studies as climate and land use change drive a suite of stressors that can pose additive antagonistic or synergistic effects birk et al 2020 for instance bucak et al 2018 linked catchment model outputs to two lake models and tested the scenarios of five general circulation models to assess the effects of climatic and land use changes on phytoplankton and water quality of lake beysehir turkey me et al 2018 combined a catchment model with a lake water quality model to simulate future climate projections of the trophic state of lake rotorua new zealand to better understand the potential for synergistic or antagonistic interactions between regional climate change and nutrient load reductions 3 6 multi model ensemble improving robustness and reliability an ensemble modelling approach can be applied either as a multi model ensemble where different models are running on the same study site or as a single model ensemble where the same model runs multiple times applying different parameter combinations or different sets of initial conditions to produce variations of output the advantage of applying independently developed models to a given lake system is that the average of individual model runs can be a more robust predictor than any of the individual model runs the ensemble approach supports the identification of shortcomings and methodological differences between different models allowing the estimation of the inherent uncertainties in the individual model projections moore et al 2021 besides when applying a multi model ensemble approach a large degree of similarity between model outputs increases confidence and reliability in the predictions gal et al 2020 as predicted by janssen et al 2015 multi model ensembles are becoming more common since the first implementation of phytoplankton ensemble modelling revealed a superior prediction accuracy than any of the individual models trolle et al 2014 indeed 19 studies out of 328 6 applied ensemble models to compare different dimensions and pathways for representing processes in order to improve the robustness and to account for structural uncertainty thereby improving the reliability of the outcomes for example kobler and schmid 2019 found that the mean output of the model ensemble of a two dimensional model ce qual w2 and three one dimensional models glm simstrat and mylake was able to better reproduce observed ice thickness and ice cover duration than individual model projections in sihlsee reservoir switzerland mi et al 2019 also adopted an ensemble approach to provide more reliable outputs than individual simulations from ce qual w2 and glm models aiming to elucidate the response of winter stratification to future climate warming combined with different water withdrawal elevations in the rappbode reservoir germany the multi model ensembles applied to a given problem were able to elucidate the strengths and weaknesses of each model which can benefit researchers for model selection and help developers to enhance the models in the future the implementation of ensemble modelling is quite challenging and time consuming to set up and run multiple lake models to facilitate the pre processing of data the numerical framework lakeensemblr has been developed to run five 1d hydrodynamic lake models simultaneously using the same configuration and driver data moore et al 2021 hence the multi model ensemble is revealing to be a promising approach for future studies within the lake modelling community 3 7 using high frequency in situ measurements high frequency sensors monitor the physical chemical or biological environment by collecting in situ data at time intervals between seconds and hours through an autonomous equipment to provide data in real time there has been a major proliferation of their use to undertake observations for i model performance assessment ii model forcing data and iii model calibration and validation indeed from the 328 published studies 63 of them 19 used high frequency sensors for measurements at a time scale from seconds to hours for example water column co2 concentration measurements were performed with a 1 min time resolution in lake kuivajärvi finland kiuru et al 2018 high frequency measurements realistically capture the ecosystem state when a phenomenon occurs at short term scales and also provide more reliable data by calculating time averaged values thus bridging the gap of discrete traditional manual samplings and ultimately enhancing the development of deterministic models while manual water sampling is time consuming costly and often lacks the appropriate sampling frequency marcé et al 2016 high frequency sensors can be used in remote locations and severe conditions where conventional measurements would be complicated limitations are most regard to vulnerability to third party action such as vandalism and robbery incrustation of solids and micro organisms occasional failures in the systems and maintenance issues that causes gaps in time series data a transition from manual sampling to high frequency technologies as a standard tool in water quality monitoring is currently an ongoing trend not only in developed countries indeed although the majority of high frequency studies were undertaken in europe and north america as previously identified by meinson et al 2016 the rapid proliferation of such sensors are currently allowing its widespread use in the middle east south america and africa fig 4 3 8 using remote sensing data remote sensing monitoring relies on optically active constituents of chlorophyll a total suspended solids coloured dissolved organic matter and water clarity at surface of inland waters topp et al 2020 satellite remote sensing is increasingly being used in recent years due to cost efficient data acquisition to complement traditional measurements for calibration and validation purposes remote sensing is a promise tool for bridging the gap of the often poor spatial characterisation of lakes and reservoirs provided by traditional monitoring as satellite images retrieve information from the entire aquatic system surface achieving a large scale spatial resolution including for remote and inaccessible locations limitations of remote sensing data are mainly attributed to the inherent high dependency of image accuracy on weather conditions since cloudiness can impair image visualisation and the large temporal scales with relatively infrequent return periods which make them more suited to detecting long term changes as opposed to daily or weekly variation topp et al 2020 also it is quite difficult to capture coincident field and satellite observations necessary for model applications when in situ monitoring is taken at low frequencies although the use of satellite image requires quite a high level of technical skills voinov et al 2018 new generation of satellites salmaso et al 2018 is helping a broader implementation of satellite image as a data source for modelling applications remote sensing is a contemporary trend in the field from 328 studies 30 of them 9 took advantage of the combining in situ water analysis deterministic modelling and remote sensing for investigating biogeochemical processes or for calibration and validation purposes for example satellite images were applied to characterise physical and biological patterns in surface conditions of lakes and reservoirs in terms of sediments e g sadeghian et al 2017 zhang et al 2015 allocthonous particles e g nouchi et al 2019 inundation area e g zhang et al 2015b surface temperature e g baracchini et al 2020 kirillin et al 2017 lazhu et al 2016 maberly et al 2020 thiery et al 2015 woolway et al 2020 ice albedo cover area and duration e g lang et al 2018 su et al 2019 woolway and merchant 2019 water surface elevation e g ottlé et al 2020 light extinction coefficient e g zolfaghari et al 2017 and chlorophyll a concentration e g soulignac et al 2018 3 9 prediction accuracy the physical structure of the hydrodynamic variables follows well understood physical laws resulting in a relative accurate and precise prediction fig 5 for instance in the studies published from 2015 to 2020 the median coefficient of determination of water temperature and level were 0 94 and 0 99 respectively e g chang et al 2015 clancey et al 2017 hallnan et al 2020 kim et al 2019 mi et al 2020 zhao et al 2020 on the other hand given the inherent complexity of chemical and biological processes which requires more assumptions and simplifications than hydrodynamic models robson 2014a the level of prediction of the chemical and biological state variables is expected to be lower than predictions of the hydrodynamic variables in fact the model performance has reduced considerably moving from physical to biochemical variables the median of the coefficient of determination of the chemical and biological variables varied between 0 30 and 0 61 e g brett et al 2016 bucak et al 2018 crossman and elliott 2018 farrell et al 2020 lodhi et al 2019 in addition the median coefficient of determination of total nitrogen and nitrate r 2 0 61 for both achieved better prediction capacity than ammonium r 2 0 35 e g andersen et al 2020 chen et al 2020 cui et al 2016 snortheim et al 2017 which can be attributed to its more reactive nature since ammonium can be both assimilated and nitrified and is produced by decay or organic matter thereby resulting in a much shorter turnover time in water surprisingly chlorophyll a concentration by groups presented higher median coefficient of determination r 2 0 54 e g cui et al 2016 fadel et al 2017 mi et al 2020 than the total chlorophyll a concentration r 2 0 43 e g couture et al 2018 mack et al 2019 rolighed et al 2016 ward et al 2020 in contrast to previous expectations shimoda and arhonditsis 2016 when simulated as the total concentration it was expected that models exhibited higher accuracy as measured chlorophyll a concentration provides a bulk proxy for phytoplankton biomass with no group or species differentiation otherwise when chlorophyll a is simulated at sub group level model output is compared with chlorophyll a concentration that is estimated from the count of the number of cells pertaining per each group however the chlorophyll a content per cell presents substantial variations depending on several environmental conditions such as season nutrient availability light and cell position in the water column rigosi et al 2010 thus tending to result in poorer performance metrics although in some cases the predictive capacity of chlorophyll a concentration was low the models generally succeeded to capture seasonal and inter annual trends and the pattern of phytoplankton succession current model applications proved that the incorporation of phytoplankton functional groups achieved better predictive capacity than for phytoplankton as total biomass moreover a distinctly higher performance was found when compared to the r 2 0 28 for aggregated phytoplankton and to the median r 2 varying from 0 07 to 0 53 for different functional groups reported by modelling studies from 1980 to 2012 shimoda and arhonditsis 2016 in comparison with r 2 varying from 0 01 to 0 94 in the reviewed literature over the 2015 2020 period given the currently increasing cyanobacteria blooms globally huisman et al 2018 models have focused on modelling the functional characteristics of dominant species hu et al 2019 improvements in cyanobacteria field data acquisition and modelling approaches may explain an overall better accurate prediction ability robustness and reliability in recent studies i in situ fluorescence and pigment analytical analysis to estimate phycocyanin a specific pigment of cyanobacteria which can provide better estimates of biomass biovolume or cell density of this group fadel et al 2017 mi et al 2020 ii the coupling of hydrodynamic ecological lake model cui et al 2016 and iii the combination of an atmospheric land lake modelling approach bucak et al 2018a performance metrics of the prediction accuracy of modelling other levels of biodiversity such as bacteria zooplankton macrophytes and fish are rarely reported which can be attributed to the lack of a detailed knowledge of the aquatic ecology of the study sites and the long term presence of ecological monitoring while the prediction accuracy of aquatic ecosystem models simulating phytoplankton biomass by groups has experienced considerable advance in recent years the overall performance for hydrodynamic and biogeochemical variables presented a negligible evolution when compared to modelling studies over the period from 1990 to 2002 arhonditsis and brett 2004 indeed the median coefficient of determination of water temperature and biogeochemical variables were quite similar between 1990 2002 and 2015 2020 periods table 3 more importantly ammonium phosphate and total phosphorus were poorly simulated in recent years models were unable to obtain satisfactory performance in terms of coefficient of determination revealing that despite huge advances in terms of computational capacity model complexity and data acquisition since the 1990s model performance was not considerably improved and still has a fundamental weak point future research must focus on refinements to mechanistic aspects of nutrients recycling processes to include a more sophisticated geochemical basis although the comparative analysis provides valuable insights regarding the temporal evolution of the predictive capacity of aquatic ecosystem models the metrics cannot be directly compared between periods because the metric over the 1990 2002 period considered not only the simulation of lakes and reservoirs but also included estuary lagoon ocean and sea as study sites which were not included by the present study in addition the coefficient of determination is not the most suited metric for assessing model performance but it was the one that allowed a temporal comparison with previous studies to develop a fair assessment of models capacity to realistically reproduces the system it is necessary to perform a holistic evaluation taking into account the simulation period the model complexity and the spatio temporal scale for developing performance criteria that objectively evaluate the aquatic biogeochemical models 3 10 towards a systematic methodological protocol of good practices recognizing the need to establish good modelling practice was already claimed by different authors arhonditsis et al 2006 hipsey et al 2020 schmolke et al 2010 shimoda and arhonditsis 2016 highlighting the importance of critical methodological steps such as sensitivity analysis calibration validation and assessment of goodness of fit the calibration procedure was implemented in the majority of modelling studies fig 6a some studies did not calibrate the model because the processes and the parameters are well established instead they performed a validation or performance assessment e g cardoso mohedano et al 2019 hamilton et al 2018 soulignac et al 2018 regarding the validation procedure 174 over 328 studies 53 performed this methodological step fig 6b however the present analysis revealed some methodological inconsistency regarding the absent consensus in terms of terminology for instance the terms model evaluation e g couture et al 2015 and validation e g buccola et al 2016 were used for the same procedure there is an increasing portion of the reviewed papers that performed the sensitivity analysis 34 fig 6c compared with the 27 5 identified by shimoda and arhonditsis 2016 sensitivity analysis is an important tool for investigating the role of model components by computing the influence of input factors on model outputs ultimately being useful for scientific discovery dimensionality reduction identification of processes parameters and scales that dominantly control a system and decision support razavi et al 2021 in general the analysis can be referred to as local sensitivity analysis by conducting a one at a time method that assesses the model output change against variations of a single input while keeping all others fixed at their initial values or as global sensitivity analysis taking into account the joint interaction among input factors when they vary simultaneously within their perturbation range producing an overall response on the model outputs koo et al 2020 although the implementation of sensitivity analysis is showing an increasing trend it should be carefully evaluated as the local approach is the most largely used technique ferretti et al 2016 including for complex and non linear models in circumstances where it has been criticised for providing only a limited indication of model behavior saltelli et al 2019 statistics metrics to quantify model performance have been more used than in the 2000s when few studies published the error between simulated and observed values of the variable of interest rigosi et al 2010 indeed 64 of the studies clearly exhibited the statistics metrics of performance to evaluate the goodness of fit table 4 the widely applied metrics were in the descending order of importance 1 root mean squared error rmse 2 mean absolute error mae 3 coefficient of determination r 2 4 bias the average difference between simulation and observation data 5 nash sutcliffe efficiency nse 6 mean error me 7 pearson correlation coefficient r 8 standard error 9 percentage of error 10 spearman s rank correlation coefficient ρ 11 mean absolute percentage error mape 12 model efficiency meff and 13 kling gupta efficiency kge most of the studies applied the combination of at least two metrics fig 6d enhancing a comprehensive evaluation of models by minimizing potential inconsistencies arising from human judgment bennett et al 2013 some studies exhibited solely a visual performance analysis e g abed et al 2019 haddad et al 2015 moridi 2018 which is adequate only for highly complex situations or when data are scarce or unreliable in an effort to make models more transparent future model development should aim to incorporate automatic goodness of fit metrics calculation using software tools as proposed by alexandrov et al 2011 3 11 open source documentation towards transparency the full documentation and free availability of code sources in which the mathematical formulations are available at a level where the model can be re implemented based on the documentation was envisioned by previous studies e g janssen et al 2015 full openness in the code allows scientists to interrogate the nuances of the numerical algorithms adopted to solve the differential equations in which the model is formulated and to evaluate the correctness of the model besides it allows for an easy reimplementation of parts of the model into new models and it ultimately facilitates more rapid advances in model developments and associated applications mooij et al 2010 in recent years most of the published papers 74 applied open source and or free for use models that have the scientific basis publicly available in online repositories which are increasingly popular platforms enabling users to browse code easily track revisions and recover the exact code used to perform simulations this current trend was previously detected as significant progress that has been made over the past few years frassl et al 2019 beyond enhancing model development the storage of model codes in repositories is important for engaging researchers in the modelling process indeed increasing transparency in model code builds community understanding an environment of trust and the opportunity for reproducibility ganju et al 2016 however open source code faces technical challenges that arise from different branches of a model requiring a custodian or overseeing group to decide on whether new or modified algorithms should be incorporated into the parent code frassl et al 2019 4 summary and conclusions deterministic lake models have undergone a continuous refinement since their development triggered by trends in science technology and society to accomplish the difficult task to predict ecosystem behavior there is significant ongoing effort to address the challenges pointed out by previous reviews for instance in terms of better collaboration within the scientific community in an overall conclusion from the literature published over the last six years 1 model applications across broad ranges of time from months to decades and spatial local regional and continental scales covering multiple study sites are an increasing trend over the last few years fig 7 a 2 phytoplankton biomass have been consistently simulated as functional groups or species fig 7b supported by improved prediction accuracy than its simulation as the total biomass which can be considered as the major advance in the past few years 3 novel modelling approaches such as coupling models fig 7c and multi model ensemble fig 7d were envisioned in the past and now are gaining importance to account for structural uncertainty and to improve the reliability of the model outcomes 4 the proliferation of high frequency sensors fig 7e for sub hourly field measurements and the usage of satellite remote images fig 7f overcome the challenge to be used in developing countries and found global application for improving data acquisition for model initialisation forcing data inputs calibration and validation 5 there is a remarked need for further refinements on nutrients recycling processes to overcome the poor predictive capacity of aquatic ecosystem models on simulating ammonium phosphate and total phosphorus since the performance metric is still close to the values found in the 1990s and 6 the use of open source models that have the full documentation of their codes publicly available in online repositories is currently highly valued for achieving model development transparency and engagement declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national council for scientific and technological development cnpq through a ph d scholarship appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2021 105143 
25742,deterministic models have emerged as a widely accepted tool for investigations in lentic aquatic ecosystems in this study an extensive literature review is provided by an inventory of papers published over the last six years 2015 2020 to explore the recent progress of deterministic models applied to lakes and reservoirs the current trends include the application of well established models across broad ranges of time and spatial scales the integration of lake catchment and climate models in addition to multi model ensemble approaches and the proliferation of high frequency sensors and the usage of remote sensing images for model initialisation forcing data inputs and calibration and validation it is expected that the emerging trends in modelling lakes and reservoirs can be of great use for future research prospects as a source of information for subsequent studies in the field keywords limnology aquatic ecosystem water quality eutrophication hydrodynamics biogeochemistry 1 introduction in the mid twentieth century when eutrophication became the major stressor of lakes and reservoirs worldwide vinçon leite and casenave 2019 the understanding emerged that inland waters are vulnerable to anthropogenic forcing gal et al 2009 preserving the integrity of aquatic ecosystems as opposed to their passive exploitation has been a growing goal as aquatic ecosystems support economic activities such as water supply for agriculture mereu et al 2016 and drinking water jeppesen et al 2015 hydroelectric power generation kobler and schmid 2019 and fishing makler pick et al 2017 in addition they provide ecosystem services for example by providing habitat for aquatic organisms schallenberg et al 2013 to capture the ecosystem s response to anthropogenic stressors and pressures from climate change affecting both developed and emerging countries deterministic models emerged as a potential tool to explore the functioning of aquatic ecosystems at local regional and global scales in an effort to obtain a greater understanding of the system behavior lake models intend to achieve the following principles of 1 generality by applying general equations and assumptions valid in a broad variety of sites requiring few local adjustments 2 accuracy in which they reproduce the observed data with minimal errors and 3 realism in which they attempt to explain the dynamics of the real system in detail ganju et al 2016 deterministic lake models differentiate from statistical models in their capacity to simulate a system in terms of the processes acting on state variables statistical models also called black box models or empirical models are formulated as a direct mathematical relation between forcing and state variables with no causality deterministic models also referred to as mechanistic models or process based models are based on a set of differential equations that describe physical chemical and biological processes i e the water column is represented as a compartment with different representations of boundary fluxes related to air water exchanges sediment water exchanges and inflows and outflows providing the mechanisms underlying aquatic ecosystem processes across thresholds machine learning methods have rapidly overtaken traditional empirical models and have emerged in recent years as a promising tool for improving model skill and ecological inference hanson et al 2020 and also as an alternative approach to physics based models jia et al 2020 deterministic lake models can be classified according to their i variation on time as static or dynamic ii dimensionality from 0d to 3d and iii components of the ecosystem including hydrodynamic module nutrients module and biological module static models are based on a steady state assumption they are suited when a static situation is sufficient to give a proper description of an ecological system relying in a reduced applicability on the other hand dynamic models are based on ordinary or partial differential equations to describe processes over time most of the eutrophication models in the early development stage were static types but rapid development in dynamic modelling has been observed since the 2000s resulting in less than 2 of static models publication in ecological modelling from 2000 to 2006 jørgensen 2008 models vary in spatial dimension according to the water body s features and targeted processes zero dimensional or box models assume a complete mixed water body with no spatial variation being suited for small lakes or ponds one dimensional models simulate the spatial change over a single dimension either horizontally length or vertically depth averaged being able to represent a narrow estuary or a small but well stratified lake respectively two dimensional models which are more rarely used simulate spatial variations in the lateral and longitudinal directions width and length or in vertical and longitudinal directions depth and length they are most suited for large but shallow lakes or deep but narrow lakes three dimensional models simulate changes in all three spatial domains width length and depth being adequate for deep and large lakes and reservoirs 3d models are the most physically realistic representation for a water body providing the most detailed assessment of the studied processes ultimately the selection of a model s dimension must be bound by justifiable simplifications to balance the research question the ecosystem and knowledge not making the model more complex than the data set can support jørgensen 1995 besides the availability of resources such as computing and manpower govern which dimension can be supported for example the simulation of climate change effects on a water body over a 100 year period would be a difficult task using a 3d model in terms of computational costs and time constraints in addition model outputs would have a high level of uncertainty rather a 1d model may perhaps provide just as valuable and as accurate outputs at a lower time and cost e g man et al 2021 according to the objective of the modelling i e the problem to be assessed different components should be represented hydrodynamic models are based on well constrained equations to simulate the physical environment such as the water level water velocity temperature salinity ice and photosynthetically active radiation ecological models generally cover a wide range of components including nutrient cycles oxygen balance and biological communities since the first lake models their development and application have undergone substantial advances with increasingly predictive ability and now they can cover more than 100 state variables janssen et al 2015 lake models found widespread use for a wide range of time and spatial scales trolle et al 2012 and have been applied for several purposes i scientific aiming to advance theory by exploring ideas demonstrating concepts understanding the mechanisms that govern ecosystem functioning and elucidating the relationships between internal processes and external forcing schmolke et al 2010 ii methodological intending to fill gaps in observations by extrapolating the range of historical temporal and spatial measurements janssen et al 2015 and iii decision making to predict the interaction between management actions and ecosystem response and to estimate the effort required to avoid adverse conditions or to restore degraded systems hipsey et al 2015 by synthesizing virtual experiments to manipulate conditions that would be too expensive too time consuming or unethical to do in a real world system peck 2004 owing to the recognition of the contribution given by models to the study of spatio temporal dynamics in lake ecosystems several review articles have evaluated the development and application of models in terms of diversity janssen et al 2015 accuracy robson 2014a uncertainty uusitalo et al 2015 complexity mcdonald and urban 2010 performance bennett et al 2013 validation alexandrov et al 2011 and applicability costa et al 2019 a starting point review was conducted by jørgensen 1995 which discussed the need for additional constraints to better represent the properties of ecosystems the front line problem of modelling in the 1990s more recently overviews assessed the modelling of eutrophication and cyanobacteria harmful blooms in lake ecosystems bhagowati and ahamad 2019 janssen et al 2019 rousso et al 2020 vinçon leite and casenave 2019 and the challenges to model water quality in the anthropocene mooij et al 2019 however most of these reviews were in the context of aquatic ecosystem models applied not only to lakes and reservoirs but also to rivers estuaries wetlands and oceans e g anagnostou et al 2017 brewer et al 2018 costa et al 2019 de goede 2020 robson 2014b also including other modelling approaches such as statistical and empirical models e g voinov et al 2018 considering that few reviews focused specifically on deterministic lake models this paper provides an overview of the current generation of deterministic models applied to lakes and reservoirs by conducting an extensive literature review of papers published over the last six years 2015 2020 the aim of this study was to provide a comprehensive overview and novel insights of the recent progress in lake modelling in face of the rapid developments in the field the in depth analysis of the state of the art is expected to encourage modellers future works and to assist water managers towards a sustainable management of water resources 2 historical trajectory of deterministic lake models historically lake ecosystem models have been developed to address questions concerning water quality degradation mostly related to eutrophication nutrient cycling dissolved oxygen concentration chlorophyll a concentration hipsey et al 2015 and fish habitat by investigating oxygen temperature and later on light chang et al 1992 the first empirical equations that relate loads to concentrations the precursors of lake ecosystem models were developed in the early 1970s to describe eutrophication processes for environmental management purposes based on the scientific insight of the work of vollenweider 1968 that provided algorithms to calculate nutrient retention in lakes from the late 1970s to the mid 1980s models were based upon ecological knowledge and despite their qualitative or semi quantitative prediction capacity they could be used as prognosis tool in limnology being applied to environmental management jørgensen 1995 during the 1990s and 2000s modelling experienced rapid growth determined by the advances in technological and computational progress providing greater processing speed and memory data storage at a lower cost and better graphic properties which ultimately allowed more complexity and greater use of 3d models robson 2014a at that time there was a tendency for each research group to develop their own models instead of applying previously existing models jørgensen 2010 more recently however rather than using independently developed models directed to a specific set of questions investigators are focusing on widely applicable and well established open source models frassl et al 2019 covering a wide range of lake characteristics in terms of morphology geographical location and hydrological features this emerging trend can be seen as an organised effort to avoid reinventing the wheel as suggested by mooij et al 2010 and to go into more depth in terms of development tasks taking advantage of the existing models to modify and combine the strengths of them additionally from the beginning of the 2010s the scientific community organised itself in interdisciplinary collaborative networks in order to accelerate advances in the modelling of lake ecosystems through the sharing of data methods and experiences the collaborative networks together with the increasing resolution and quality of field data boosted the development performance transparency and reliability of models in predicting lake systems on a global scale weathers et al 2013 the representation of lake ecosystems has become more complex after incorporating the concept of environmental integrity which also considers the ability of ecosystems to maintain their ecological function hipsey et al 2015 the models have been increasingly applied to encompass regional or continental aspects resulting in their application in different environmental and geographical conditions janssen et al 2015 3 review of papers published over the last six years the present review performed a compilation of modelling studies written in english over the last six years 2015 2020 the research was conducted on november 2020 in the following databases scopus web of science and google scholar the selection of models was based on the most widely referenced deterministic models in recent years gaudard et al 2019 janssen et al 2015 mooij et al 2010 applied to lakes and reservoirs and currently under use worldwide for example by the inter sectoral impact model intercomparison project isimip they consist on an inventory of seventeen hydrodynamic water quality and ecosystem models 1 aquatic ecodynamics aed hipsey et al 2013 2 arctic lake biogeochemistry model albm tan et al 2017 2015 3 ce qual w2 environmental and hydraulics laboratories 1986 4 computational aquatic ecosystem dynamics model caedym hipsey et al 2005 5 delft3d flow deltares 2021a and or its water quality model delft3d waq deltares 2021b 6 dynamic reservoir simulation model dyresm antenucci and imerito 2000 and or its water quality module dyresm wq 7 ecopath with ecosim ewe christensen et al 2000 8 estuary lake and coastal ocean model elcom hodges and dallimore 2007 9 freshwater lake model flake mironov 2008 10 general lake model glm hipsey et al 2019 2017 2014 11 general ocean turbulence model gotm burchard et al 1999 12 lake stepanenko et al 2016 13 minlake riley and stefan 1988 14 mylake saloranta and andersen 2007 15 pclake janse and van liere 1995 16 phytoplankton responses to environmental change protech elliott et al 2010 and 17 simstrat goudsmit et al 2002 the search term was taken as the exact name of each model resulting in 479 peer reviewed publications from those we selected the ones that simulated at least one of the key variables that represent either the hydrodynamics or the water quality including ji 2007 p 5 water temperature salinity velocity sediment toxics dissolved oxygen and nutrients also only the studies that presented a case study of real lakes or reservoirs were considered in the present study resulting in 328 papers see supplementary material modelling of virtual systems bays lagoons estuaries and ponds were not included as well as thesis and conference papers a full text assessment was conducted to support the discussion of the state of the art of deterministic models regarding the following topics 1 global distribution of model applications 2 temporal and spatial domains 3 state variables 4 stressors of the aquatic ecosystem 5 coupled models 6 ensemble modelling approach 7 frequency of field measurements 8 use of technological devices 9 prediction accuracy 10 methodological procedures and 11 use of open source models 3 1 geographical distribution the most studied lakes during the 1970s and the 1980s were mainly located in north america while in the 1990s modelling works were increasingly carried out on lakes from western europe vinçon leite and casenave 2019 from 2015 to 2020 investigations were conducted in lakes and reservoirs from more than 45 countries fig 1 the regions where lake ecosystem models began to be applied still top the list of study areas indeed the most studied lakes and reservoirs are situated in europe 34 mostly in germany switzerland and italy and north america 23 in the united states and canada however a clear dissemination has been observed beyond the historical temperate countries there was a significant increase in the number of studies carried out in asia 20 in bangladesh india philippines russia singapore south korea taiwan and especially in china and in middle east 9 in iran israel lebanon turkey and turkmenistan indeed 45 studies out of 328 were applied to chinese lakes and reservoirs such as lake taihu for which models were developed to predict and warn against future algal blooms hu 2016 in parallel only 6 of the studies was conducted in central south america brazil chile colombia and mexico 5 in africa congo egypt ethiopia ghana kenya morocco and tunisia and 3 in oceania new zealand and australia in developing countries from central south america and africa the socio economic situation and limited financial resources caused less support for research investigations although progress has been made towards a greater geographic distribution of the places where the studies were conducted additional efforts are still needed for tropical countries as latitude plays a crucial role in hydrodynamics and water quality hence tropical lakes may behave differently from the high latitude ones lewis jr 2000 3 2 expanding temporal and spatial domains typically traditional environmental approaches have focused on understanding processes that operate on a temporal scale convenient for human observation ranging from about an hour to a year or two rose et al 2016a long term studies are expanding observations to decades or longer mostly to assess policy and management issues which are often influenced by environmental factors acting in various temporal scales indeed mid or long term modelling is required for assessing ecosystem evolution in response to local and global changes such as i climate change 104 year in fish lake usa magee et al 2018 57 year in lake chaohu china zhang et al 2020 40 year in lake langtjern norway couture et al 2015 and 34 year of lake nam co china huang et al 2017 ii urbanisation 60 year in lake chaohu china kong et al 2017a and 25 year in lake dianchi china li et al 2019 and iii contamination 60 year in lake chaohu china kong et al 2017b besides over longer time scales models are used to capture long lasting responses to management practices and restoration efforts for instance the simulation of scenarios for reduction of phosphorus load into lake mendota usa over a 37 year period provided the required reduction to alleviate oxythermal stress and the associated economic cost magee et al 2019 this latter is an excellent example of how the temporal expansion has the advantage of testing management strategies in face of long term responses in the 328 published articles simulations covered a period of 191 years from 1911 to 2101 fig 2 most of them were focused on the years from 1990 to 2020 on average each year over this period was assessed by 77 studies aiming at understanding processes such as extreme events and at simulating management strategies for operation optimisation pollution water abstraction and anoxia studies that applied models for hindcasting purposes for the period from the 1910s and 1990s on average each year over this period was assessed by 14 studies were focused mostly on the impacts of human disturbances on the ecosystem especially eutrophication and regime shifts hindcasting studies for the period prior to the 1950s focused mostly on the long term alterations in thermal regimes the projection studies covered the period from the present until 2101 on average each year over this period was assessed by 21 studies aiming at predicting the effects of future climate and land use scenarios on aquatic ecosystems the spatial scale historically focused on single study sites increasingly includes research across many sites indeed 53 over 328 studies 16 covers regional or continental aspects which enables a more contextual understanding of hydrodynamics bruce et al 2018 gas emissions guo et al 2020 response to extreme events woolway et al 2020 and effects of climate change almeida et al 2015 hansen et al 2017 maberly et al 2020 woolway et al 2017 efforts have been made to identify universal descriptors of processes similarity in emergent behaviors and how water quality pathways vary across geomorphologic and climate gradients hipsey et al 2015 for example winslow et al 2017 modeled the response of 10 774 lakes to changing climate drivers to give managers insight on individual lakes similarly rose et al 2016b modeled the thermal characteristics of 1894 temperate lakes in the usa to investigate how water clarity can influence the response of both surface and bottom water temperatures to climate change 3 3 a variety range of variables of interest water temperature was the most studied variable in 71 of the studies table 1 however 50 of these references did not focus on the modelling of temperature only but on the representation of the physical habitat and thermal structure of aquatic systems as a compulsory step for modelling biogeochemical processes the other state variables of the hydrodynamic component were water circulation 7 and salinity 1 total phosphorus 24 total nitrogen 21 and their constituents were largely studied which can be attributed to their role in eutrophication dissolved oxygen was also extensively studied 27 mostly to assess issues concerning hypoxic conditions in deep lakes and reservoirs in addition carbon 6 methane 1 sediments 1 and contaminants 2 including organic compounds hydrocarbons and metal were simulated geochemistry state variables the ecosystem was represented mostly in terms of phytoplankton which was the interest of 125 modelling studies out of 328 38 aiming at a better understanding of phytoplankton dynamics and the processes that control its excessive biomass from those 125 studies 64 of them 51 represented the phytoplankton as multiple functional groups rather than simulating the total biomass which relies on the representation of different morphological physiological and ecological characteristics from 2015 to 2020 phytoplankton community was represented as two cui et al 2016 van der linden et al 2015 zamani et al 2016 three brett et al 2016 brito et al 2018 chen et al 2016 four gray et al 2019 khatun et al 2020 soulignac et al 2019 five dalton et al 2016 tesfaye and wolff 2018 and seven wang et al 2019 zhu et al 2020 taxa among the phytoplankton groups cyanobacteria has gained an increased interest due to the worldwide occurrence of their blooms and the associated public health problems e g fadel et al 2017 silva et al 2019 the functional grouping offers an intuitively approach that accounts for different patterns of specialism considering that the external forcing and the internal environment may profoundly modulate the signals of each group shimoda and arhonditsis 2016 when the objective of the simulation relies on the total concentration of chlorophyll a for example for assessing the trophic status of a water body the simulation of the total biomass as one group is sufficient otherwise when the composition of the biomass the competitive interactions between different groups for resources such as light and nutrients or succession dynamics are important for the ecosystem the simulation of multiple groups is a valuable approach furthermore few studies went into more depth concerning the specialisation and simulated phytoplankton species for example fadel et al 2017 simulated the succession of cyanobacterial blooms of two different species in a hypereutrophic reservoir for early warning systems and management scenarios bracht flyr and fritz 2016 simulated the timing and distribution of two diatom species in crevice lake the usa radbourne et al 2019 assessed the effects of changes in external nutrient loads on the seven most abundant phytoplankton species in rostherne mere lake england and elliott et al 2016 investigated how eight phytoplankton species may adapt in response to potential future changes in air temperature and future load in lough neagh lake ireland zooplankton was also the target variable of some studies 15 mainly focused on the eutrophication and the impact of regime shifts moreover from the 49 studies that have simulated zooplankton 30 of them 61 represented zooplankton by groups for instance three zooplankton groups predatory zooplankton herbivorous zooplankton and micro zooplankton were simulated in lake kinneret israel makler pick et al 2017 two groups herbivores and carnivores were simulated in lake bourget france kerimoglu et al 2017 and also two groups cladocerans and copepods were simulated in lough leane lake ireland dalton et al 2016 the dynamics of macrophytes 8 and fishes 13 were also simulated to represent food web dynamics macrophytes were simulated in a recent investigation that studied how they can affect flow dynamics by increasing flow resistance bulat et al 2019 fish communities were also simulated in an investigation focused on the impact of the total external nutrient load on the dynamics of lake taihu china janssen et al 2017 the models selected for the present review analysis provided a comprehensive overview of the most investigated state variables however as some of the models are not able to simulate zooplankton macrophytes or fishes we recognise that the percentages presented above might be biased and should be interpreted with caution 3 4 modelling the effects of climate change and eutrophication on aquatic ecosystems several threats to the health of aquatic ecosystems were assessed by modelling studies as expected climate change and eutrophication were the major concerns fig 3 covering 29 and 14 of the published studies respectively the impacts of eutrophication and climate change are closely related and therefore some studies 3 have investigated their combined effect different approaches were adopted to investigate the combined effects of both climate change and eutrophication i using regional climate models as input to the lake model to assess the effects of changes in atmospheric forcing variables mainly in air temperature and precipitation on eutrophication causes and symptoms for instance chang et al 2015 have found that the intensified thermal stratification caused by the rising temperature resulted in a higher risk of algal blooms and eutrophication in the hsinshan reservoir taiwan ii coupling lake model with catchment model to account for projected changes in runoff and nutrient loads the study by me et al 2018 indicated that polymictic lakes may be particularly vulnerable to eutrophication associated with climate change due to increased internal nutrient loading while changes in external loads will have lesser relative impact and iii using a sensitivity procedure by applying incremental perturbations in the forcing variables to disentangle the effects of changes in individual physical drivers in a present day simulation gray et al 2019 conducted systematic and independent changes in water temperature and mixed depth in blelham tarn lake england whilst keeping other variables constant revealing that each change result in impacts that can act synergistically on phytoplankton biomass similarly rolighed et al 2016 simulated multiple combinations of increasing air temperatures and reduced external nutrient loads which reveals that in a future warming scenario a nutrient load reduction of as much as 60 would be required to achieve summer chlorophyll a level similar to those of the present day in lake søbygaard denmark considering that the effects of climate change on lakes and reservoirs have great ecological significance because they can affect ecosystem s biogeochemistry and ecology modelling the simultaneous impacts of climate change and eutrophication in a lake system produce model results physically based on climate forcing that can be used as a proxy for future planning this field is currently under development since many physiological attributes of the phytoplankton are likely to be differentially impacted therefore there is still a lack of accurate predictions at a species level and further consequences we might expect with a changing climate burford et al 2020 the interactions between climate change and greenhouse gas emissions via direct temperature effects are also an emerging topic in the field bartosiewicz et al 2019 moreover increasing interest for modelling the impact of other issues was observed related to climate on aquatic ecosystems such as extreme weather events e g chen et al 2020 soares et al 2019 regime shifts e g kong et al 2017a and variations in evaporation rate e g helfer et al 2018 in addition the biomass and spatial distribution of fish populations in face of unsustainable fishery was considerably assessed in previous studies e g bhele et al 2020 clancey et al 2017 goto et al 2020 tesfaye and wolff 2018 some importance was given to the modelling of other threats related to pollution e g eilers et al 2016 including nutrient loads from different land uses e g mueller et al 2019 and erosion e g sadeghian et al 2017 owing to the strong impact on trophic webs and aquatic organisms and the implications for human health the simulation of contaminants including organic compounds e g amirkani et al 2016 and hydrocarbons e g kong et al 2017b has emerged in some investigations finally operational strategies of lakes and reservoirs were assessed e g carr et al 2020 for instance for optimum water abstraction e g lindenschmidt et al 2019 and for hypoxia avoidance e g weber et al 2017 both in terms of quantitative and qualitative impacts on aquatic ecosystems 3 5 coupled models for an interdisciplinary link between catchment lake and climate coupling models i e the output from one model as input for the other enables the assessment of the potential for synergistic or antagonistic interactions between forcing variables and internal processes this approach has gained prominence since the 2000s jørgensen 2010 for predictions of lake ecosystems across a variety of scientific disciplines hydrodynamic models coupled to biogeochemical models have been increasingly applied for example the dyresm was used coupled to the caedym biogeochemical model as well as glm used coupled to the aed biogeochemical model table 2 moreover using catchment models to generate boundary input conditions for lake models has been a tendency to assess the nutrient loadings and to coordinate environmental strategies for instance swat soil and water assessment tool was coupled to ce qual w2 to dyresm caedym and to glm aed and pclake swmm storm water management tool was coupled to dyresm caedym marina model to assess river inputs of nutrients to seas was coupled to pclake simplyp was coupled to mylake and finally inca integrated catchment model was coupled to protech table 2 in addition some tools have been developed to improve the coupling of lake and catchment models such as the plugin swat2lake molina navarro et al 2018 and the water ecosystems tool nielsen et al 2017 some published articles combined climate models and lake models in order to project future climate change impacts on water quality additionally the complex task of coupling climate catchment and lake models was the focus of some studies as climate and land use change drive a suite of stressors that can pose additive antagonistic or synergistic effects birk et al 2020 for instance bucak et al 2018 linked catchment model outputs to two lake models and tested the scenarios of five general circulation models to assess the effects of climatic and land use changes on phytoplankton and water quality of lake beysehir turkey me et al 2018 combined a catchment model with a lake water quality model to simulate future climate projections of the trophic state of lake rotorua new zealand to better understand the potential for synergistic or antagonistic interactions between regional climate change and nutrient load reductions 3 6 multi model ensemble improving robustness and reliability an ensemble modelling approach can be applied either as a multi model ensemble where different models are running on the same study site or as a single model ensemble where the same model runs multiple times applying different parameter combinations or different sets of initial conditions to produce variations of output the advantage of applying independently developed models to a given lake system is that the average of individual model runs can be a more robust predictor than any of the individual model runs the ensemble approach supports the identification of shortcomings and methodological differences between different models allowing the estimation of the inherent uncertainties in the individual model projections moore et al 2021 besides when applying a multi model ensemble approach a large degree of similarity between model outputs increases confidence and reliability in the predictions gal et al 2020 as predicted by janssen et al 2015 multi model ensembles are becoming more common since the first implementation of phytoplankton ensemble modelling revealed a superior prediction accuracy than any of the individual models trolle et al 2014 indeed 19 studies out of 328 6 applied ensemble models to compare different dimensions and pathways for representing processes in order to improve the robustness and to account for structural uncertainty thereby improving the reliability of the outcomes for example kobler and schmid 2019 found that the mean output of the model ensemble of a two dimensional model ce qual w2 and three one dimensional models glm simstrat and mylake was able to better reproduce observed ice thickness and ice cover duration than individual model projections in sihlsee reservoir switzerland mi et al 2019 also adopted an ensemble approach to provide more reliable outputs than individual simulations from ce qual w2 and glm models aiming to elucidate the response of winter stratification to future climate warming combined with different water withdrawal elevations in the rappbode reservoir germany the multi model ensembles applied to a given problem were able to elucidate the strengths and weaknesses of each model which can benefit researchers for model selection and help developers to enhance the models in the future the implementation of ensemble modelling is quite challenging and time consuming to set up and run multiple lake models to facilitate the pre processing of data the numerical framework lakeensemblr has been developed to run five 1d hydrodynamic lake models simultaneously using the same configuration and driver data moore et al 2021 hence the multi model ensemble is revealing to be a promising approach for future studies within the lake modelling community 3 7 using high frequency in situ measurements high frequency sensors monitor the physical chemical or biological environment by collecting in situ data at time intervals between seconds and hours through an autonomous equipment to provide data in real time there has been a major proliferation of their use to undertake observations for i model performance assessment ii model forcing data and iii model calibration and validation indeed from the 328 published studies 63 of them 19 used high frequency sensors for measurements at a time scale from seconds to hours for example water column co2 concentration measurements were performed with a 1 min time resolution in lake kuivajärvi finland kiuru et al 2018 high frequency measurements realistically capture the ecosystem state when a phenomenon occurs at short term scales and also provide more reliable data by calculating time averaged values thus bridging the gap of discrete traditional manual samplings and ultimately enhancing the development of deterministic models while manual water sampling is time consuming costly and often lacks the appropriate sampling frequency marcé et al 2016 high frequency sensors can be used in remote locations and severe conditions where conventional measurements would be complicated limitations are most regard to vulnerability to third party action such as vandalism and robbery incrustation of solids and micro organisms occasional failures in the systems and maintenance issues that causes gaps in time series data a transition from manual sampling to high frequency technologies as a standard tool in water quality monitoring is currently an ongoing trend not only in developed countries indeed although the majority of high frequency studies were undertaken in europe and north america as previously identified by meinson et al 2016 the rapid proliferation of such sensors are currently allowing its widespread use in the middle east south america and africa fig 4 3 8 using remote sensing data remote sensing monitoring relies on optically active constituents of chlorophyll a total suspended solids coloured dissolved organic matter and water clarity at surface of inland waters topp et al 2020 satellite remote sensing is increasingly being used in recent years due to cost efficient data acquisition to complement traditional measurements for calibration and validation purposes remote sensing is a promise tool for bridging the gap of the often poor spatial characterisation of lakes and reservoirs provided by traditional monitoring as satellite images retrieve information from the entire aquatic system surface achieving a large scale spatial resolution including for remote and inaccessible locations limitations of remote sensing data are mainly attributed to the inherent high dependency of image accuracy on weather conditions since cloudiness can impair image visualisation and the large temporal scales with relatively infrequent return periods which make them more suited to detecting long term changes as opposed to daily or weekly variation topp et al 2020 also it is quite difficult to capture coincident field and satellite observations necessary for model applications when in situ monitoring is taken at low frequencies although the use of satellite image requires quite a high level of technical skills voinov et al 2018 new generation of satellites salmaso et al 2018 is helping a broader implementation of satellite image as a data source for modelling applications remote sensing is a contemporary trend in the field from 328 studies 30 of them 9 took advantage of the combining in situ water analysis deterministic modelling and remote sensing for investigating biogeochemical processes or for calibration and validation purposes for example satellite images were applied to characterise physical and biological patterns in surface conditions of lakes and reservoirs in terms of sediments e g sadeghian et al 2017 zhang et al 2015 allocthonous particles e g nouchi et al 2019 inundation area e g zhang et al 2015b surface temperature e g baracchini et al 2020 kirillin et al 2017 lazhu et al 2016 maberly et al 2020 thiery et al 2015 woolway et al 2020 ice albedo cover area and duration e g lang et al 2018 su et al 2019 woolway and merchant 2019 water surface elevation e g ottlé et al 2020 light extinction coefficient e g zolfaghari et al 2017 and chlorophyll a concentration e g soulignac et al 2018 3 9 prediction accuracy the physical structure of the hydrodynamic variables follows well understood physical laws resulting in a relative accurate and precise prediction fig 5 for instance in the studies published from 2015 to 2020 the median coefficient of determination of water temperature and level were 0 94 and 0 99 respectively e g chang et al 2015 clancey et al 2017 hallnan et al 2020 kim et al 2019 mi et al 2020 zhao et al 2020 on the other hand given the inherent complexity of chemical and biological processes which requires more assumptions and simplifications than hydrodynamic models robson 2014a the level of prediction of the chemical and biological state variables is expected to be lower than predictions of the hydrodynamic variables in fact the model performance has reduced considerably moving from physical to biochemical variables the median of the coefficient of determination of the chemical and biological variables varied between 0 30 and 0 61 e g brett et al 2016 bucak et al 2018 crossman and elliott 2018 farrell et al 2020 lodhi et al 2019 in addition the median coefficient of determination of total nitrogen and nitrate r 2 0 61 for both achieved better prediction capacity than ammonium r 2 0 35 e g andersen et al 2020 chen et al 2020 cui et al 2016 snortheim et al 2017 which can be attributed to its more reactive nature since ammonium can be both assimilated and nitrified and is produced by decay or organic matter thereby resulting in a much shorter turnover time in water surprisingly chlorophyll a concentration by groups presented higher median coefficient of determination r 2 0 54 e g cui et al 2016 fadel et al 2017 mi et al 2020 than the total chlorophyll a concentration r 2 0 43 e g couture et al 2018 mack et al 2019 rolighed et al 2016 ward et al 2020 in contrast to previous expectations shimoda and arhonditsis 2016 when simulated as the total concentration it was expected that models exhibited higher accuracy as measured chlorophyll a concentration provides a bulk proxy for phytoplankton biomass with no group or species differentiation otherwise when chlorophyll a is simulated at sub group level model output is compared with chlorophyll a concentration that is estimated from the count of the number of cells pertaining per each group however the chlorophyll a content per cell presents substantial variations depending on several environmental conditions such as season nutrient availability light and cell position in the water column rigosi et al 2010 thus tending to result in poorer performance metrics although in some cases the predictive capacity of chlorophyll a concentration was low the models generally succeeded to capture seasonal and inter annual trends and the pattern of phytoplankton succession current model applications proved that the incorporation of phytoplankton functional groups achieved better predictive capacity than for phytoplankton as total biomass moreover a distinctly higher performance was found when compared to the r 2 0 28 for aggregated phytoplankton and to the median r 2 varying from 0 07 to 0 53 for different functional groups reported by modelling studies from 1980 to 2012 shimoda and arhonditsis 2016 in comparison with r 2 varying from 0 01 to 0 94 in the reviewed literature over the 2015 2020 period given the currently increasing cyanobacteria blooms globally huisman et al 2018 models have focused on modelling the functional characteristics of dominant species hu et al 2019 improvements in cyanobacteria field data acquisition and modelling approaches may explain an overall better accurate prediction ability robustness and reliability in recent studies i in situ fluorescence and pigment analytical analysis to estimate phycocyanin a specific pigment of cyanobacteria which can provide better estimates of biomass biovolume or cell density of this group fadel et al 2017 mi et al 2020 ii the coupling of hydrodynamic ecological lake model cui et al 2016 and iii the combination of an atmospheric land lake modelling approach bucak et al 2018a performance metrics of the prediction accuracy of modelling other levels of biodiversity such as bacteria zooplankton macrophytes and fish are rarely reported which can be attributed to the lack of a detailed knowledge of the aquatic ecology of the study sites and the long term presence of ecological monitoring while the prediction accuracy of aquatic ecosystem models simulating phytoplankton biomass by groups has experienced considerable advance in recent years the overall performance for hydrodynamic and biogeochemical variables presented a negligible evolution when compared to modelling studies over the period from 1990 to 2002 arhonditsis and brett 2004 indeed the median coefficient of determination of water temperature and biogeochemical variables were quite similar between 1990 2002 and 2015 2020 periods table 3 more importantly ammonium phosphate and total phosphorus were poorly simulated in recent years models were unable to obtain satisfactory performance in terms of coefficient of determination revealing that despite huge advances in terms of computational capacity model complexity and data acquisition since the 1990s model performance was not considerably improved and still has a fundamental weak point future research must focus on refinements to mechanistic aspects of nutrients recycling processes to include a more sophisticated geochemical basis although the comparative analysis provides valuable insights regarding the temporal evolution of the predictive capacity of aquatic ecosystem models the metrics cannot be directly compared between periods because the metric over the 1990 2002 period considered not only the simulation of lakes and reservoirs but also included estuary lagoon ocean and sea as study sites which were not included by the present study in addition the coefficient of determination is not the most suited metric for assessing model performance but it was the one that allowed a temporal comparison with previous studies to develop a fair assessment of models capacity to realistically reproduces the system it is necessary to perform a holistic evaluation taking into account the simulation period the model complexity and the spatio temporal scale for developing performance criteria that objectively evaluate the aquatic biogeochemical models 3 10 towards a systematic methodological protocol of good practices recognizing the need to establish good modelling practice was already claimed by different authors arhonditsis et al 2006 hipsey et al 2020 schmolke et al 2010 shimoda and arhonditsis 2016 highlighting the importance of critical methodological steps such as sensitivity analysis calibration validation and assessment of goodness of fit the calibration procedure was implemented in the majority of modelling studies fig 6a some studies did not calibrate the model because the processes and the parameters are well established instead they performed a validation or performance assessment e g cardoso mohedano et al 2019 hamilton et al 2018 soulignac et al 2018 regarding the validation procedure 174 over 328 studies 53 performed this methodological step fig 6b however the present analysis revealed some methodological inconsistency regarding the absent consensus in terms of terminology for instance the terms model evaluation e g couture et al 2015 and validation e g buccola et al 2016 were used for the same procedure there is an increasing portion of the reviewed papers that performed the sensitivity analysis 34 fig 6c compared with the 27 5 identified by shimoda and arhonditsis 2016 sensitivity analysis is an important tool for investigating the role of model components by computing the influence of input factors on model outputs ultimately being useful for scientific discovery dimensionality reduction identification of processes parameters and scales that dominantly control a system and decision support razavi et al 2021 in general the analysis can be referred to as local sensitivity analysis by conducting a one at a time method that assesses the model output change against variations of a single input while keeping all others fixed at their initial values or as global sensitivity analysis taking into account the joint interaction among input factors when they vary simultaneously within their perturbation range producing an overall response on the model outputs koo et al 2020 although the implementation of sensitivity analysis is showing an increasing trend it should be carefully evaluated as the local approach is the most largely used technique ferretti et al 2016 including for complex and non linear models in circumstances where it has been criticised for providing only a limited indication of model behavior saltelli et al 2019 statistics metrics to quantify model performance have been more used than in the 2000s when few studies published the error between simulated and observed values of the variable of interest rigosi et al 2010 indeed 64 of the studies clearly exhibited the statistics metrics of performance to evaluate the goodness of fit table 4 the widely applied metrics were in the descending order of importance 1 root mean squared error rmse 2 mean absolute error mae 3 coefficient of determination r 2 4 bias the average difference between simulation and observation data 5 nash sutcliffe efficiency nse 6 mean error me 7 pearson correlation coefficient r 8 standard error 9 percentage of error 10 spearman s rank correlation coefficient ρ 11 mean absolute percentage error mape 12 model efficiency meff and 13 kling gupta efficiency kge most of the studies applied the combination of at least two metrics fig 6d enhancing a comprehensive evaluation of models by minimizing potential inconsistencies arising from human judgment bennett et al 2013 some studies exhibited solely a visual performance analysis e g abed et al 2019 haddad et al 2015 moridi 2018 which is adequate only for highly complex situations or when data are scarce or unreliable in an effort to make models more transparent future model development should aim to incorporate automatic goodness of fit metrics calculation using software tools as proposed by alexandrov et al 2011 3 11 open source documentation towards transparency the full documentation and free availability of code sources in which the mathematical formulations are available at a level where the model can be re implemented based on the documentation was envisioned by previous studies e g janssen et al 2015 full openness in the code allows scientists to interrogate the nuances of the numerical algorithms adopted to solve the differential equations in which the model is formulated and to evaluate the correctness of the model besides it allows for an easy reimplementation of parts of the model into new models and it ultimately facilitates more rapid advances in model developments and associated applications mooij et al 2010 in recent years most of the published papers 74 applied open source and or free for use models that have the scientific basis publicly available in online repositories which are increasingly popular platforms enabling users to browse code easily track revisions and recover the exact code used to perform simulations this current trend was previously detected as significant progress that has been made over the past few years frassl et al 2019 beyond enhancing model development the storage of model codes in repositories is important for engaging researchers in the modelling process indeed increasing transparency in model code builds community understanding an environment of trust and the opportunity for reproducibility ganju et al 2016 however open source code faces technical challenges that arise from different branches of a model requiring a custodian or overseeing group to decide on whether new or modified algorithms should be incorporated into the parent code frassl et al 2019 4 summary and conclusions deterministic lake models have undergone a continuous refinement since their development triggered by trends in science technology and society to accomplish the difficult task to predict ecosystem behavior there is significant ongoing effort to address the challenges pointed out by previous reviews for instance in terms of better collaboration within the scientific community in an overall conclusion from the literature published over the last six years 1 model applications across broad ranges of time from months to decades and spatial local regional and continental scales covering multiple study sites are an increasing trend over the last few years fig 7 a 2 phytoplankton biomass have been consistently simulated as functional groups or species fig 7b supported by improved prediction accuracy than its simulation as the total biomass which can be considered as the major advance in the past few years 3 novel modelling approaches such as coupling models fig 7c and multi model ensemble fig 7d were envisioned in the past and now are gaining importance to account for structural uncertainty and to improve the reliability of the model outcomes 4 the proliferation of high frequency sensors fig 7e for sub hourly field measurements and the usage of satellite remote images fig 7f overcome the challenge to be used in developing countries and found global application for improving data acquisition for model initialisation forcing data inputs calibration and validation 5 there is a remarked need for further refinements on nutrients recycling processes to overcome the poor predictive capacity of aquatic ecosystem models on simulating ammonium phosphate and total phosphorus since the performance metric is still close to the values found in the 1990s and 6 the use of open source models that have the full documentation of their codes publicly available in online repositories is currently highly valued for achieving model development transparency and engagement declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national council for scientific and technological development cnpq through a ph d scholarship appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j envsoft 2021 105143 
25743,the presence of organic pollutants e g contaminants of emerging concern cecs in aquatic environments has been of great concern worldwide for years increasing numbers of different types of cecs detected in the aquatic environment requires action to a detailed understanding of the distribution and transport of these compounds in groundwater to guarantee safe drinking water for people in the future and sustainable development of the environment nowadays progress in software permits the simulation of organic pollutant transport in the soil water system using advanced mathematical models those models can be applied both to simulate contaminant transport or to calculate values of transport parameters by inversion this article summarizes the results of literature research regarding the available software for modeling the migration of organic pollutants in groundwater they were detailed described in terms of their operation applications usefulness advantages and limitations along with an indication of the most useful in this subject keywords groundwater models organic pollutants simulation software transport parameters 1 introduction the presence of organic pollutants in aquatic environments usually found at trace concentrations i e between ng l and μg l or even lower known as micropollutants has been of great concern worldwide for years especially in connection with the quality of the soil groundwater environment among the microorganic pollutants there are those referred to as contaminants of emerging concern cecs cecs are defined as substances that have been detected in the environment but which are currently not included in routine monitoring programs at european union eu level and whose fate behavior and eco toxicological effects are not well understood eu norman network increasing numbers of different types of cecs e g pesticides pharmaceuticals personal care products industrial or endocrine disrupting compounds have been identified and investigated in aqueous environments over recent decades gogoi et al 2018 lapworth et al 2019 morrissey et al 2015 nham et al 2015 pietrzak et al 2019b sousa et al 2019 since groundwater is widely used for drinking water supply it contamination can be a major source of human uptake of organic pollutants therefore it is important to have a detailed understanding of the distribution and transport of these compounds in groundwater to guarantee safe drinking water for people in the future which is the main goal of european union drinking water directive ec 2020 the entry pathways of cecs to the aquatic environment are diverse within urban areas cecs are mainly introduced into the water cycle via sewage systems especially through discharge from wastewater treatment plants wwtps banzhaf and hebig 2016 burke et al 2014 although techniques exist for removing organic micropollutants during wastewater treatment standard wwtps do not usually completely remove all of them accordingly such substances are still continuously released into the aquatic environment and their concentrations are increasing rather than decreasing münze et al 2017 cecs can also enter aquatic environments from livestock farming agricultural activity landfill sites wastewater irrigation of fields leaking sewers and on site water treatment units and septic systems banzhaf and hebig 2016 kmiecik et al 2020 pietrzak et al 2020 because it is usually not feasible to carry out experimental investigations over sufficiently long distances and or time periods the fate of contaminants is tested on a laboratory scale using for example batch or column experiments leiva et al 2017 okońska and pietrewicz 2018 pietrzak et al 2019a zakari et al 2016b the laboratory tests can be further used as an efficient method to provide input data for analytical and numerical modeling of cecs reactive tracers a mathematical model describes the physical processes and boundaries of a groundwater system using one or more governing equations while an analytical model makes simplifying assumptions to enable the solution of a given problem a numerical model divides space and or time into discrete pieces features of the governing equations and boundary conditions e g aquifer geometry hydrogeological properties or sources of solute can be specified as varying over space and time kumar 2015 seyf laye et al 2012 in general the first kind of boundary conditions dirichlet are constant head or constant concentration conditions the second kind neumann is a constant flow or constant mass flux conditions while the third kind robbin or chauchy is leaky conditions karatzas 2017 advances in software and hardware now permit the simulation of organic pollutant transport in the soil water system using advanced mathematical and numerical models those models are often also used to predict solute concentrations before management strategies are implemented nowadays broad application of modeling in environmental sciences is observed trends analysis of keyphrases for 2016 2019 using scival a web based analytics solution provided by scopus showed that in the environmental sciences research area modeling model and modeling keyphrase is now a hot topic with the most relevance fig 1 the computer simulation methods require apart from defining boundary conditions knowledge of flow and transport parameters kania et al 2006 witczak et al 2007 2013 unfortunately it is generally difficult to obtain reliable values for transport parameters such as the pore water velocity the retardation factor the dispersion coefficient and or degradation or production parameters and model predictions depend mainly upon the quality and uncertainty of the input data zuber et al 2011 therefore there is a necessity to test prediction results through among others field monitoring or combining laboratory and modeling data to eliminate or reduce modeling errors groundwater modeling sometimes requires the use of a number of different software types which are further referred to as software environments these include 1 a single model code that solves the equations for groundwater flow and or solute transport sometimes called simulation software or the computational engine e g mt3dms hydrus 1d 2 single family of codes e g modflow and 3 platforms graphical user interface gui that facilitates the preparation of data files for the model code runs the model code and allows visualization and analysis of results e g gms visual and processing modflow groundwater vistas stanmod this paper is a systematic review of available software for modeling the migration of organic pollutants from cecs group in groundwater both commercial and free license software were taken into account the paper aimed to analyze almost 140 scientific papers report documents chapters of books manuals etc published between 1983 and 2019 in terms of selected software operation applications usefulness advantages and limitations to indicate the most popular according to the number of publications or useful for organic pollutants migration modeling 2 methods an exhaustive literature search was conducted using the available sources of scientific research web of science science direct and scopus in three steps the first step was to review existing software that can be used for modeling transport of organic pollutants from cecs group in porous media taking into account the combinations of keywords such as software migration modeling transport organic pollutants pharmaceuticals pesticides personal care products pfas and endocrine disrupting compounds additionally the sections of each article were searched for relevant publications that might not have been detected in the initial search the first search was restricted to articles published during 1990 2019 and resulted in more than 500 scientific papers because a large number of computer software environments for modeling transport of organic pollutants or groundwater flow in porous media using different analytical or numerical solutions were found only the most well known and the most commonly used were selected modflow mt3d individually and incorporated in processing modflow visual modflow gms groundwater vistas feflow hydrus 1d hydrus 2d 3d phreeqc the geochemist s workbench phast which are using numerical solutions and cxtfit individually and incorporated in stanmod which are using analytical solutions the second step was to find examples of software applications for modeling the transport of organic pollutants from cecs group in groundwater from the literature review already found only articles that were relevant to mentioned above software environments were selected and then a second literature review was carried out using the previously used keywords accompanied successively by the names of the software environment this search restricted to articles published during 2000 2019 yielded more than 200 additional articles the articles that did not make explicit reference to the modeling of organic pollutants migration and those focused on other pollutants or programs were discarded again the sections of each article were searched for relevant publications in the third step source publications report documents or chapters of books from all available years were searched in which selected software environments were first presented or introduced by their authors to find their descriptions i e user interface pre and post processing solutions methods of data interpolation different available features and finally the possibility of their use in general additional information was also searched for in the latest manuals and on the websites of the individual program distributors if available finally the above sources were also checked for various types of user support i e documentation discussion forum online tutorials courses blogs videos etc finally 100 scientific papers published between 2000 and 2019 steps 1 and 2 and 37 scientific papers report documents chapters of books manuals published between 1983 and 2017 step 3 were selected to be included in this review fig 2 they contain information on software environments that can be applied for modeling migration of organic pollutants in groundwater with examples of their application all papers were analyzed in terms of selected software operation applications usefulness advantages and limitations to indicate the most useful in this subject 3 software environments for modeling migration of organic pollutants in groundwater software environments for evaluating organic pollutants transport in porous media can be divided into two groups 1 programs to calculate values of transport parameters and 2 programs to simulate contaminant transport 3 1 software environments calculating transport parameters the first group contains programs to calculate values of transport parameters solving a direct or inverse problem based on prescribed parameters direct or observed laboratory or field data obtained from solute displacement experiments inverse according to the miscible displacement theory the movement of a solute in porous media occurs as a result of the combined effects of convection and diffusion the convection dispersion equation cde is the basic equation used in this mechanistic model the one dimensional cde model assuming steady state flow linear adsorption first order degradation and zero order production is given by the following equation parker and vangenuchten 1984 toride et al 1995 1 r δ c δ t d δ 2 c δ x 2 v δ c δ x μ c γ x where c is the solute concentration in the liquid phase m l t is the time t d is the hydrodynamic dispersion coefficient l2t x is the spatial coordinate in the direction of flow l υ is the average pore water velocity l t μ is the first order decay coefficient for degradation of the solute 1 t γ is a zero order production term m l3 t and r dimensionless is the solute retardation factor which represents the effect of the sorption process on solute transport and is defined as 2 r 1 ρ k d θ where ρ is the soil bulk density m l3 k d is the distribution coefficient for adsorption l3 m described by a linear isotherm and θ is the volumetric water content l3 l3 assuming r 1 for non reactive solutes such as cl equilibrium cde is used to estimate hydraulic transport parameters such as pore water velocity υ and dispersion coefficients d d l α l parameter symbols are defined in table 2 for reactive solutes r 0 e g organic pollutants other parameters can be estimated retardation factor dispersion coefficients d d l α l sorption coefficients k d k f and degradation or production parameters λ β ω the most commonly used according to the number of selected publications software environments for organic pollutants migration modeling in groundwater are cxtfit hydrus 1d phreeqc which are a single model code stanmod and the geochemist s workbench which are guis basic information on these software environments including the current version authors website where they can be download or purchase main advantages i e user supports and limitations are summarized in table 1 the references to source publications in which software was first presented or introduced by their authors were also included other details on selected software and the examples of their application in organic pollutants migration modeling are described below and in table 2 3 1 1 cxtfit cxtfit toride et al 1995 is the computer software frequently used to estimate transport parameters in several analytical models for solute transport during steady one dimensional flow this model permits the simulation under equilibrium and non equilibrium conditions by fitting mathematical solutions of theoretical transport models based upon the convection dispersion equation cde eq 1 to the observed laboratory column experiments or field data inverse modeling the inverse problem is solved by minimizing the objective function which consists of the sum of squared differences between observed and fitted concentrations simunek et al 1999b the model may also be used to simulate solute concentrations as a function of time and or leaching depth forward modeling the original fortran version of cxtfit was designed by parker and vangenuchten 1984 toride et al 1995 added solutions for first order decay and zero order production and developed a user friendly interface then nützmann et al 2005 implemented visual cxtfit in microsoft excel with a similar input output structure and functions the current version cxtfit excel 2 1 tang et al 2010 provides flexibility sensitivity and uncertainty analysis functions to improve transport parameter estimation and to facilitate model discrimination for multi tracer experiments on structured soils cxtfit is the most popular computer software for transport parameters estimations of organic pollutants such as pharmaceuticals fan et al 2011 hebig et al 2017 müller et al 2013 unold et al 2009 pesticides kamra et al 2001 marín benito et al 2013 montoya et al 2006 and others bertelkamp et al 2014 table 2 3 1 2 stanmod stanmod studio of analytical models simunek et al 1999a b is a computer software package for evaluating solute transport in porous media using analytical solutions of the convection dispersion solute transport equation eq 1 under an easy to use windows graphical user interface stanmod includes the following models cxtfit cfitm cfitim screen chain 3dade and n3dade which can be divided into four groups 1 simple applications 2 stochastic simulations 3 research applications and 4 parameter estimation feinstein and guo 2004 models for simple application 3dade cfitm chain screen use conventional inputs to perform deterministic calculations of solute movements according to the standard cde with equilibrium partitioning the 3dade code leij and bradford 1994 is for evaluating analytical solutions for two and three dimensional equilibrium solute transport problems assuming equilibrium conditions the cfitm code van genuchten 1980 can be applied for predicting or analyzing measured solute breakthrough data concentration curves versus time in terms of the one dimensional cde while the chain van genuchten 1985 is for analyzing the convective dispersive transport of solutes involved in sequential first order decay reactions finally the behavior assessment model screen jury et al 1983 is to describe the fate and transport of soil applied organic chemicals a modified and updated version of the cxtfit code toride et al 1995 stochastic simulations group allows predictions and analyses of equilibrium and nonequilibrium transport in time and or space including probabilistic analyses of solute transport using stream tube models among the research application group the cfitim code van genuchten 1981 can be used to analyze column effluent data permitting both physical or chemical nonequilibrium transport more advanced code that considers nonequilibrium transport is n3dade leij and toride 1997 which provide solutions for one dimensional advection and two or three dimensional dispersion under conditions of nonequilibrium partitioning stanmod can be used for either forward all codes or inverse cfitm cfitim cxtfit and 3dade modeling problems in solute transport by forward modeling solute concentrations can be predicted for a prescribed set of transport parameters while by inverse analyses selected transport parameters can be estimated from observed concentration distributions versus time and or distance parameter estimation in stanmod is accomplished using a marquardt levenberg type weighted nonlinear least squares optimization approach that minimizes the objective function van genuchten et al 2012 stanmod is in the public domain and can be downloaded freely the software is supported by a discussion forum where users can submit questions or suggestions about the models all projects included within stanmod can also be downloaded separately from the website stanmod has been widely used to estimate transport parameters of pesticides leiva et al 2017 nir et al 2012 rodríguez liébana et al 2018 and pharmaceuticals srinivasan and sarmah 2014 during steady one dimensional flow table 2 3 1 3 hydrus 1d hydrus 1d simunek et al 2005 is a free windows based modeling environment for simulating water heat and solute movement in one dimensional variably saturated media the software package consists of the hydrus computer program and the hydrus1d interactive graphics based user interface this software tool numerically solves the richards equation for variably saturated unsaturated partially saturated or fully saturated water flow and advection dispersion type equations for heat and solute transport the heat transport equation takes into account transport due to conduction and advection with flowing water while the flow equation incorporates a sink term to account for water uptake by plant roots as well as dual porosity type flow with a fraction of water content being mobile and fraction immobile the solute transport equations consider advective dispersive transport in the liquid phase and diffusion in the gaseous phase including among others linear equilibrium or nonlinear nonequilibrium reactions between the liquid and gaseous phases as well as the solid and liquid phases zero order production and two first order degradation reactions in addition physical nonequilibrium solute transport can be accounted for by assuming a two region dual porosity type formulation that partitions the liquid phase into mobile and immobile regions for inverse estimation of selected soil hydraulic solute transport and reaction parameters from measured transient steady state flow and or transport data levenberg marquardt type parameter estimation technique is implemented the procedure permits to estimate several unknown parameters from observed water contents pressure heads concentrations and or instantaneous or cumulative boundary fluxes simunek et al 2005 the free hydrus 1d software package is also commonly used for the determination of transport parameter mostly of pharmaceuticals martínez hernández et al 2017 teijón et al 2014 and other organic pollutants such as pesticides celestino ladu and zhang 2011 leiva et al 2017 and phenols zakari et al 2016b table 2 besides cxtfit stanmod and hydrus 1d other codes software can be found in the literature which are used to determine the migration parameters of organic substances and are not included in this review such as cxtanneal li et al 1999 inverts mcgrail 2001 reactran r package soetaert and meysman 2012 capsim shen et al 2018 cathy gatel et al 2019 sensan test kol descriptors id test kol okońska et al 2019a 2019b 3 1 4 phreeqc phreeqc ph redox equilibrium c programming language parkhurst and appelo 2013 is a computer program written in the c and c programming languages for simulating chemical reactions and transport processes in natural or polluted water in laboratory experiments or industrial processes the program is based on the equilibrium chemistry of aqueous solutions interacting with minerals gases solid solutions exchangers and sorption surfaces phreeqc implements several types of aqueous models two ion association aqueous models the lawrence livermore national laboratory model and wateq4f a pitzer model and the specific ion interaction theory aqueous model using any of these aqueous models phreeqc has capabilities for speciation and saturation index calculations batch reaction and one dimensional 1d transport calculations diffusion advection and dispersion with reversible and irreversible reactions this one dimensional transport includes aqueous mineral gas solid solution surface complexation ion exchange equilibria and specified mole transfers of reactants kinetically controlled reactions mixing of solutions and pressure and temperature changes finally phreeqc is also used for inverse modeling finding sets of mineral and gas mole transfer rates that account for differences in composition between waters within specified compositional uncertainty limits phreeqc evolved from the fortran program phreeqe parkhurst et al 1980 current version 3 of phreeqc extends the previous version with new features based on experience gained while simulating the results from laboratory experiments and field investigations furthermore the code has been generalized into a computer object iphreeqc to facilitate its use by other software programs such as comsol multiphysics wissmeier and barry 2011 that need to calculate chemical reactions or the distribution of chemicals in various phases phreeqc is available as freeware from the u s geological survey and is supported by a discussion forum its numerous options and capabilities make phreeqc useful for simulations that may solve many practical problems in hydrogeochemistry dobrzyński 2009 tomaszewska et al 2018 wątor et al 2020 however in studies on organic pollutants migration phreeqc is mostly used only to determine major hydrochemical processes controlling water quality and the occurrence of pharmaceuticals greskowiak et al 2006 jiang et al 2013 morel et al 2014 wanda et al 2017 xu et al 2017 pesticides kingsbury 2008 paradelo et al 2014 endocrine disrupting compounds patterson et al 2010 dissolved chlorinated solvents carniato et al 2012 and phenols espinoza et al 2007 in groundwater by calculating saturation indices sis ion activity products aqueous speciation and theoretical co2 partial pressure in water some authors also used phreeqc to model sorption behavior of organic micropollutants burke et al 2011 2013 grivé et al 2013 yan et al 2012 but the program is more commonly used in studies on metal pollutants migration chen et al 2018 dobrzyński 2006 li et al 2018 reyes lo et al 2014 yu et al 2018 3 1 5 the geochemist s workbench the geochemist s workbench gwb bethke 1994 is a set of software tools for geochemical modeling gwb designed for personal computers running ms windows is distributed in four packages essentials standard professional and advanced professional these packages contain tools for balancing reactions calculating activity diagrams computing speciation in aqueous solutions plotting the results of these calculations and storing the related data the packages also include programs for modeling reaction processes modeling reactive transport in one and two dimensions and plotting modeling results as well as for constructing phase diagrams finally gwb advanced professional extends the package to include message passing interface mpi versions of the reactive transport models for use on computing clusters the chemplugin self linking software object adapted for cluster computers and other specialized codes bethke et al 2015 the original gwb package was written in 1991 by craig bethke with the assistance of ming kuo lee and jeffrey biesiadecki of the hydrogeology program in the department of geology the university of illinois at urbana champaign gwb is presently developed and supported by aqueous solutions llc and commercially distributed current version 14 of gwb is supported by extensive documentation a discussion forum and online tutorials gwb set the standard especially in geochemical modeling of heavy metals carrillo chávez et al 2014 kossoff et al 2011 magu et al 2016 mohajerin et al 2014 root et al 2009 tabelin et al 2012 in cecs migration studies gwb similar to phreeqc is used for calculating saturation indices sis ion activity products aqueous speciation for example sena et al 2012 used gwb to perform a benchmark analysis of the simulation of aerobic benzene degradation in a shallow and oxidizing aquifer while nariyan et al 2017 make use of gwb during investigations on the removal of pharmaceuticals from the water with an electrocoagulation process besides phreeqc and gwb there are many other speciation models for metals and metalloids such as minteqa2 mineql visual minteq wham ecosat wateqf alchemi chess or eq 3 6 3 2 software environments simulating contaminant transport the second group of software environments for contaminant transport modeling represents programs linking hydrogeochemical modeling with hydrodynamic modeling to simulate single multi component transport such as modflow mt3d a single family of codes and guis processing visual modflow gms groundwater vistas feflow hydrus 2d 3d and phast basic information on these software environments is summarized in table 3 while other details and examples of selected software applications in organic pollutants migration modeling are described below simulation of contaminant transport by hydrodynamic modeling can be divided into two processes 1 development of groundwater flow model and 2 application of that model for a specific purpose e g contaminant transport groundwater models are usually developed in the following sequence model objectives hydrogeological characterization model conceptualization model design and construction input parameters model calibration and sensitivity analysis model testing predictive simulation and final reporting and interpretation kumar 2012 pianosi et al 2016 seyf laye et al 2012 fig 3 each step requires a specific approach and often extensive work because this affects the final correctness of the model and the quality of the results 3 2 1 hydrus 2d 3d hydrus 2d 3d simunek et al 2006 is a software package for simulating water heat and solute movement in two and three dimensional variably saturated media the software package consists of several computational programs and the interactive graphics based user interface hydrus the program numerically solves the richards equation for saturated unsaturated water flow and convection dispersion type equations for heat and solute transport 3 θ t x i k k i j a h x j k i z a s where h is the pressure head l s is a sink term 1 t x i i 1 2 are the spatial coordinates l t is time t k i j a are components of a dimensionless anisotropy tensor k a and k is the unsaturated hydraulic conductivity function l t given by 4 k h x z k s x z k r h x z where k s the saturated hydraulic conductivity a n d k r is the relative hydraulic conductivity l t the flow equation incorporates a sink term to account for water uptake by plant roots the heat transport equation considers movement by conduction as well as convection with flowing water the governing convection dispersion solute transport equations include provisions for nonlinear nonequilibrium reactions between the solid and liquid phases and linear equilibrium reactions between the liquid and gaseous phases hence both adsorbed and volatile solutes such as pesticides can be considered the solute transport equations also incorporate the effects of zero order production first order degradation independent of other solutes and first order decay production reactions that provide the required coupling between the solutes involved in the sequential first order chain the transport models also account for convection and dispersion in the liquid phase as well as for diffusion in the gas phase thus permitting to simulate solute transport simultaneously in both the liquid and gaseous phases the original version of hydrus 2d software package simunek et al 1999a distributed by the international groundwater modeling center was fully replaced with the hydrus 2d 3d software package current version 3 of the hydrus 2d 3d computer software package simunek et al 2018 is commercially distributed in five editions levels enabling two dimensional applications for simple rectangular and general 2d geometries 2d lite and 2d standard editions and three dimensional applications for simple hexahedral layered and general 3d geometries 3d lite 3d standard 3d professional editions for customers available are also specialized add on modules several modules that were recently developed for simulating the movement of water heat and solutes in the subsurface e g wetland 2d hypar slope classic etc an important advantage of the hydrus models is that they are not limited to any particular spatial or temporal scale hydrus 2d 3d can be used for transport domains ranging from 1 m wide to transects of several tens or hundreds of meters wide and for both laboratory and field scale applications however the use of hydrus for very large 3d domains such as entire catchments is not recommended because the highly nonlinear richards equation requires relatively fine spatial discretization otherwise there may be a significant strain on the available computing resources simunek 2008 simunek et al 2016 the types of applications of hydrus 2d 3d are very broad ranging between agricultural problems evaluating different irrigation schemes and the effects of plants on the soil water balance and groundwater recharge to many environmental applications simulating the transport of different solutes and particle like substances as well as evaluating the effects of land use and environmental changes however only a few authors made use of hydrus 2d 3d in studies on organic pollutants table 4 abdel nasser et al 2011 used hydrus 2d to solve numerically the water and contaminant atrazine and malathion transport equation subjected to initial and boundary conditions while boivin et al 2006 simulate with flow and transport processes of bentazone herbicide at three field sites hydrus 2d was also applied to simulate pesticide hexazinone procymidone picloram and triclopyr leaching at a field trial dann et al 2006 to simulate water movement and transport of picloram atrazine and simazine pang et al 2000 and 2 4 d atrazine and terbuthylazine pesticides close et al 2003 in the soil water system 3 2 2 modflow programs modflow mcdonald and harbaugh 1988 is a popular open source groundwater flow model distributed by the u s geological survey to this day numerous modflow versions based on the modflow core version have been developed due to growing interest in surface and groundwater interactions local refinement with nested and unstructured grids karst groundwater flow solute transport and saltwater intrusion modflow variants contain newer specialized or advanced versions for use by experienced modelers modflow nwt modflow usg gsflow and gwm modflow based particle tracking and solute transport moodpath mt3d usgs and seawat parameter estimation and uncertainty analysis pest as well as modflow utilities post processors and graphical user interfaces flopy gridgen gw chart modelmuse modelviews and zonebudget however although these versions are often based on the modflow core there are often incompatibilities that restrict their use with other modflow versions modflow 6 is an object oriented program and underlying framework developed to provide a platform for supporting multiple models and multiple types of models within the same simulation hughes et al 2017 modflow 6 contains two types of hydrologic models the groundwater flow gwf model and the groundwater transport gwt model langevin et al 2017 the gwt model simulates three dimensional transport of a single solute species in flowing groundwater while the gwf model is based on a generalized control volume finite difference cvfd approach in which a cell can be hydraulically connected to any number of surrounding cells the new groundwater flow formulation the xt3d option extends the capabilities of modflow by enabling the simulation of fully three dimensional anisotropy on regular or irregular grids in a way that properly takes into account the full three dimensional hydraulic conductivity tensor langevin et al 2019 modflow 6 is the sixth core version of modflow to be released by the usgs previous core versions were released in 1984 1988 1996 2000 and 2005 the last core version modflow 2005 is still actively maintained and supported modflow 6 is freely distributed and can be copied modified distributed and used even for commercial purposes without special permission modflow code designed for groundwater flow modeling in combination with mt3d mt3dms zheng and wang 1990 1999 mt3d usgs bedekar et al 2016 rt3d clement 1999 and modpath pollock 2016 is crucial in organic contaminants transport mt3d mt3dms is a package used to simulate the transport of single multi species pollutants there is also an updated version of the mt3dms code released by u s geological survey and named mt3d usgs which includes new transport modeling capabilities to accommodate flow terms calculated by modflow packages that were previously unsupported by mt3dms and to provide greater flexibility in the simulation of solute transport and reactive solute transport other new capabilities include unsaturated zone transport and transport within streams and lakes including a solute exchange with connected groundwater bedekar et al 2016 rt3d can be used to simulate the transport of reactive pollutants where only sorption by partitioning coefficient and degradation by decay coefficient processes can occur and there is no dissolution reaction finally modpath is a standard package for forward and backward particle tracking pollock 2016 waterloo hydrogeologic 2015 modflow and mt3d mt3dms models are commonly used to simulate groundwater flow fate and transport of organic pollutants table 4 cho et al 2010 simulated groundwater and pesticide movement with modflow and mt3d in the saturated zone during surface water and groundwater interaction modeling to simulate caffeine and carbamazepine transport in the vadose zone and groundwater dvory et al 2018 used a modified version of the modflow mt3d model groundwater fluxes calculated by modflow were used by shin et al 2011 as input to the mt3dms model to calculate the advective transport of pfoa nham et al 2016 provided a model based modflow mt3dms characterization of the long term transport behavior of five psychoactive compounds meprobamate pyrithyldione primidone phenobarbital and phenylethylmalonamide introduced into groundwater via sewage irrigation modflow mt3d was also used to model the fate of emerging organic micropollutants during riverbank filtration hamann et al 2016 henzler et al 2014 and during soil aquifer treatment nham et al 2015 levy et al 1998 combined modflow and path3d to assess bedrock aquifer susceptibility to contamination and mt3d to investigate the potential impact of long term atrazine use on aquifer water quality finally gaus and casteele 2004 used modflow mt3d solute transport model as a risk assessment tool for five pesticides atrazine simazine bentazone mecoprop and mcpa contaminating a quaternary phreatic aquifer for modflow and other related codes several hosting platforms gui are available such as processing and visual modflow gms and groundwater vistas langevin and bean 2005 which is not included in this review processing modflow chiang and kinzelbach 1998 was originally developed to support the first official release of modflow mcdonald and harbaugh 1988 the newest x version of processing modflow pmx is the result of the rewrite efforts the supported model codes have been consolidated and the modeling process has been streamlined with the ability to display model data and results at the same time processing modflow x comes with the supported models codes and a map based user interface that can display online basemaps and shapefiles along with the grids and results of multiple models the interface enables users to construct calibrate and run models as well as visualize results chiang 2020 processing modflow x is commercially distributed however there is a limited free version allowing only to create models up to 3 layers 5000 cells 2000 cells in a layer and 3 stress periods visual modflow is the most complete modeling environment for practical applications in three dimensional groundwater flow and contaminant transport simulation this fully integrated package combines powerful analytical tools with a logical menu structure easy to use graphical tools allow among others graphic design of the model s grid its properties and boundary conditions visualization of the input parameters of the model in 2d and 3d space groundwater flow analysis flow line determination and pollution transport simulation as well as automatic winpest or manual model calibration waterloo hydrogeologic 2015 originally released in 1994 visual modflow was the first commercially available graphical interface for the open source modflow groundwater modeling engine in 2012 a newer net version of the software was rebranded as visual modflow flex the latest version 6 1 of visual modflow flex is a popular and commonly used hydrogeology modeling program commercially distributed in three levels of program functionality basic professional and premium it provides the user with the opportunity to choose between conceptual modeling creating a real three dimensional model based on available gis data and well borehole data and classic numerical modeling which allows to manually define the parameters of a numerical computational grid based on literature research processing and visual modflow are rather rarely used in modeling the migration of organic pollutants in groundwater table 4 meffe et al 2014 used processing modflow to determine the fate of para toluenesulfonamide p tsa in groundwater under anoxic conditions in turn visual modflow was applied to modeling an accidental spill of chlorobenzene using a 3d model duarte 2008 sharma et al 2015 used visual modflow mt3d for modeling lindane transport in groundwater finally müller et al 2011 simulate using platform visual modflow the groundwater flow processes at bank filtration sites in general and calculate the predicted environmental concentration of pharmaceuticals processing and visual modflow could be also used to develop results from column experiments jaramillo et al 2019 choose the data from the column experiments to feed a pesticide transport model run in a transient state with the code mt3dms which was based on a steady state groundwater flow model development in studies of schaffer et al 2015 the breakthrough curves of 28 organic micropollutants were evaluated with modflow coupled with the solute transport model mt3d and implemented in the processing modflow marciniak et al 2006 used visual modflow to obtain solute transport parameters from column experiments such as αl kd r 3 2 3 gms gms groundwater modeling system owen et al 1996 is a software platform designed for groundwater modeling the program provides tools throughout all aspects of the modeling process some of which include geometric characterization of earth masses geostatistical analysis finite element and finite difference mesh generation model input for specific flow and transport analysis engines as well as complete three dimensional visualization of results the entire gms system consists of a graphical user interface the gms program and several analysis codes modflow mt3dms rt3d pht3d etc owen et al 1996 gms can be fully integrated with arcgis allowing for a seamless transfer in creating conceptual models and producing final figures of modeling results current version 10 3 of gms is developed by aquaveo and is commercially distributed in four editions community free modflow modflow pro and premium only a few studies were found about using gms software in the modeling of emerging pollutants migrations such as pharmaceuticals dvory et al 2018 nitriles şengör and ünlü 2013 and pesticides welch et al 2019 table 4 3 2 4 groundwater vistas groundwater vistas gv rumbaugh and rumbaugh 2020 is a sophisticated windows based graphical user interface for 3 d groundwater flow and transport modeling it combines an advanced water model design system with comprehensive graphical analytical tools this groundwater flow modeling tool enables pre and post process data processing for modflow and other related codes such as modpath mt3d rt3d and pest the model independent calibration software langevin and bean 2005 gv allows to interactively design generic finite difference groundwater flow and contaminant transport models in aquifer systems a finite difference model is constructed by dividing the model domain into square or rectangular regions blocks or cells head drawdown and concentration are computed at discrete points within the model called nodes while the network of cells and nodes is called the grid or mesh there are two main types of finite difference techniques known as block centered and mesh centered gv has an automatic calibration procedure which makes it easy to calibrate an aquifer once the target cells with known heads have been identified rumbaugh and rumbaugh 2020 groundwater vistas has been under development by environmental simulations incorporation esi for over 25 years current version 8 of gv from 2020 is commercially distributed in four editions standard advance professional and premium on esi website groundwater vistas is mostly used for aquifer characterization and groundwater flow modeling ahmed 2009 kiptum et al 2017 lowry and anderson 2006 miljević et al 2012 ofomola et al 2016 as well as a support in optimization processes connected among others with hydraulic barriers wells pumping and changing of groundwater table abdelrhem et al 2008 rashid et al 2015 remonti and mori 2016 only a few studies were found about using gv software in the modeling of emerging pollutants migrations table 4 bozzano et al 2007 used gv with modpath code for flow numerical simulation of an aquifer contaminated by chlorinated solvents in rho italy the software was also applied to simulate fate and transport of n nitrosamines drewes et al 2006 transport of tce in contaminated groundwater in the bernau area of germany using mt3d code spalvins et al 2001 and finally to simulate with mt3d and modpath codes transport of surface active substances in a contaminated aquifer at the incukalns district of latvia spalvins et al 2017 3 2 5 feflow feflow trefry and muffels 2007 is an advanced finite element subsurface flow and transport modeling system with an extensive list of functionalities including variably saturated flow variable fluid density mass and heat transport and multi species reactive transport feflow uses finite element solution techniques to handle a broad variety of physical processes for subsurface flow and transport modeling it can be efficiently used to describe the spatial and temporal distribution and reactions of groundwater contaminants to model geothermal processes to estimate the duration and travel times of chemical species in aquifers to plan and design remediation strategies and interception techniques and to assist in designing alternatives and effective monitoring schemes the program has been under development since 1979 by the institute for water resources planning and systems research inc wasy gmbh of berlin germany which has recently become a part of dhi group trefry and muffels 2007 current version 7 3 of feflow is commercially distributed in three licenses demo essentials and professional regnery et al 2017 used feflow for 2d simulation of the fate and transport of contaminants in a variably saturated synthetic aquifer and for the simulation of breakthrough curves of carbamazepine sulfamethoxazole trimethoprim tris 2 chloroethyl phosphate tcep and diphenhydramine table 4 to quantify the fluxes of pharmaceuticals including endocrine disruptors and fragrances in the environment surface and groundwater reinstorf et al 2009 applied feflow coupled with hydrodynamic river model hec ras feflow was also used as a part of studies for analyzing the reactive transport behavior of 37 trace organic compounds during field scale bank filtration sanz prat et al 2020 for assessing the influence of agricultural activities on pesticides in a shallow aquifer in south eastern norway kværner et al 2014 feflow can be applied in environmental protection studies as well e g for spatial modeling of groundwater vulnerability to pesticide contamination akbar et al 2011 wellhead protection areas lo russo and taddia 2012 and remediation of e g a large soil aquifer treatment site for domestic wastewater rona et al 2018 3 2 6 phast phast phreeqc and hst3d parkhurst et al 2010 is a program for simulating multicomponent reactive solute transport in three dimensional saturated groundwater flow systems phast has also the capabilities to model a wide range of equilibrium and kinetic geochemical reactions the flow and transport calculations are based on a modified version of hst3d that is restricted to constant fluid density and constant temperature the geochemical reactions are simulated with the geochemical model phreeqc which is embedded in phast three data input files are needed in phast flow and transport calculation data chemical reaction calculation data and the thermodynamic database parkhurst et al 2010 phast is applicable to the study of natural and contaminated groundwater systems at a variety of scales ranging from laboratory experiments to local and regional field scales it can be used in studies of migration of nutrients radionuclides inorganic carniato et al 2012 huo et al 2014 malmström et al 2006 and organic contaminants zhang et al 2010 in projects such as aquifer storage and recovery or engineered remediation and in investigations of the natural rock water interactions in aquifers however phast is not appropriate for unsaturated zone flow multiphase flow or density dependent flow parkhurst et al 2010 phast is available as freeware from the u s geological survey and is supported by a discussion forum tutorials and training courses many other software or codes are available for modeling of groundwater flow and contaminant transport which are publicly accessible or commercially distributed they are revised by e g karatzas 2017 kumar 2012 pianosi et al 2016 piggott 1999 zdechlik 2016 however their usage in the modeling of organic pollutant transport is rather scarce 4 conclusions a large number of computer programs exist for modeling the migration of organic pollutants in porous media using different analytical or numerical solutions in general they can be divided into two groups software environments calculating values of transport parameters and software environments linking hydrogeochemical modeling with hydrodynamic modeling to simulate single multi component transport among the first group cxtfit hydrus 1d and stanmod are the most commonly used to obtain contaminants migration parameters such as pore water velocity retardation factor sorption coefficients and degradation or production parameters unfortunately it is generally difficult to obtain reliable values of such parameters because model predictions depend mainly upon the quality and uncertainty of the input data therefore there is a necessity to combine laboratory and modeling data to verify the correctness of the received transport parameters in the second group programs from the modflow mt3d family hydrus 2d 3d and feflow are the most popular in 2d 3d simulation of groundwater flow and transport of organic pollutants although these models may be used as predictive tools they should be viewed as estimates dependent upon the quality and uncertainty of the input data for this reason testing of model predictions through e g field monitoring is crucial for eliminating or reducing modeling errors although it is easy to identify the more or less popular software it is hard to say which one is good or best because the choice of the most suitable software depends on a wide range of different factors beyond suitable software there is primarily the science and art of modeling and the references listed in this paper can be evaluated by readers to see how problems have been approached declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
25743,the presence of organic pollutants e g contaminants of emerging concern cecs in aquatic environments has been of great concern worldwide for years increasing numbers of different types of cecs detected in the aquatic environment requires action to a detailed understanding of the distribution and transport of these compounds in groundwater to guarantee safe drinking water for people in the future and sustainable development of the environment nowadays progress in software permits the simulation of organic pollutant transport in the soil water system using advanced mathematical models those models can be applied both to simulate contaminant transport or to calculate values of transport parameters by inversion this article summarizes the results of literature research regarding the available software for modeling the migration of organic pollutants in groundwater they were detailed described in terms of their operation applications usefulness advantages and limitations along with an indication of the most useful in this subject keywords groundwater models organic pollutants simulation software transport parameters 1 introduction the presence of organic pollutants in aquatic environments usually found at trace concentrations i e between ng l and μg l or even lower known as micropollutants has been of great concern worldwide for years especially in connection with the quality of the soil groundwater environment among the microorganic pollutants there are those referred to as contaminants of emerging concern cecs cecs are defined as substances that have been detected in the environment but which are currently not included in routine monitoring programs at european union eu level and whose fate behavior and eco toxicological effects are not well understood eu norman network increasing numbers of different types of cecs e g pesticides pharmaceuticals personal care products industrial or endocrine disrupting compounds have been identified and investigated in aqueous environments over recent decades gogoi et al 2018 lapworth et al 2019 morrissey et al 2015 nham et al 2015 pietrzak et al 2019b sousa et al 2019 since groundwater is widely used for drinking water supply it contamination can be a major source of human uptake of organic pollutants therefore it is important to have a detailed understanding of the distribution and transport of these compounds in groundwater to guarantee safe drinking water for people in the future which is the main goal of european union drinking water directive ec 2020 the entry pathways of cecs to the aquatic environment are diverse within urban areas cecs are mainly introduced into the water cycle via sewage systems especially through discharge from wastewater treatment plants wwtps banzhaf and hebig 2016 burke et al 2014 although techniques exist for removing organic micropollutants during wastewater treatment standard wwtps do not usually completely remove all of them accordingly such substances are still continuously released into the aquatic environment and their concentrations are increasing rather than decreasing münze et al 2017 cecs can also enter aquatic environments from livestock farming agricultural activity landfill sites wastewater irrigation of fields leaking sewers and on site water treatment units and septic systems banzhaf and hebig 2016 kmiecik et al 2020 pietrzak et al 2020 because it is usually not feasible to carry out experimental investigations over sufficiently long distances and or time periods the fate of contaminants is tested on a laboratory scale using for example batch or column experiments leiva et al 2017 okońska and pietrewicz 2018 pietrzak et al 2019a zakari et al 2016b the laboratory tests can be further used as an efficient method to provide input data for analytical and numerical modeling of cecs reactive tracers a mathematical model describes the physical processes and boundaries of a groundwater system using one or more governing equations while an analytical model makes simplifying assumptions to enable the solution of a given problem a numerical model divides space and or time into discrete pieces features of the governing equations and boundary conditions e g aquifer geometry hydrogeological properties or sources of solute can be specified as varying over space and time kumar 2015 seyf laye et al 2012 in general the first kind of boundary conditions dirichlet are constant head or constant concentration conditions the second kind neumann is a constant flow or constant mass flux conditions while the third kind robbin or chauchy is leaky conditions karatzas 2017 advances in software and hardware now permit the simulation of organic pollutant transport in the soil water system using advanced mathematical and numerical models those models are often also used to predict solute concentrations before management strategies are implemented nowadays broad application of modeling in environmental sciences is observed trends analysis of keyphrases for 2016 2019 using scival a web based analytics solution provided by scopus showed that in the environmental sciences research area modeling model and modeling keyphrase is now a hot topic with the most relevance fig 1 the computer simulation methods require apart from defining boundary conditions knowledge of flow and transport parameters kania et al 2006 witczak et al 2007 2013 unfortunately it is generally difficult to obtain reliable values for transport parameters such as the pore water velocity the retardation factor the dispersion coefficient and or degradation or production parameters and model predictions depend mainly upon the quality and uncertainty of the input data zuber et al 2011 therefore there is a necessity to test prediction results through among others field monitoring or combining laboratory and modeling data to eliminate or reduce modeling errors groundwater modeling sometimes requires the use of a number of different software types which are further referred to as software environments these include 1 a single model code that solves the equations for groundwater flow and or solute transport sometimes called simulation software or the computational engine e g mt3dms hydrus 1d 2 single family of codes e g modflow and 3 platforms graphical user interface gui that facilitates the preparation of data files for the model code runs the model code and allows visualization and analysis of results e g gms visual and processing modflow groundwater vistas stanmod this paper is a systematic review of available software for modeling the migration of organic pollutants from cecs group in groundwater both commercial and free license software were taken into account the paper aimed to analyze almost 140 scientific papers report documents chapters of books manuals etc published between 1983 and 2019 in terms of selected software operation applications usefulness advantages and limitations to indicate the most popular according to the number of publications or useful for organic pollutants migration modeling 2 methods an exhaustive literature search was conducted using the available sources of scientific research web of science science direct and scopus in three steps the first step was to review existing software that can be used for modeling transport of organic pollutants from cecs group in porous media taking into account the combinations of keywords such as software migration modeling transport organic pollutants pharmaceuticals pesticides personal care products pfas and endocrine disrupting compounds additionally the sections of each article were searched for relevant publications that might not have been detected in the initial search the first search was restricted to articles published during 1990 2019 and resulted in more than 500 scientific papers because a large number of computer software environments for modeling transport of organic pollutants or groundwater flow in porous media using different analytical or numerical solutions were found only the most well known and the most commonly used were selected modflow mt3d individually and incorporated in processing modflow visual modflow gms groundwater vistas feflow hydrus 1d hydrus 2d 3d phreeqc the geochemist s workbench phast which are using numerical solutions and cxtfit individually and incorporated in stanmod which are using analytical solutions the second step was to find examples of software applications for modeling the transport of organic pollutants from cecs group in groundwater from the literature review already found only articles that were relevant to mentioned above software environments were selected and then a second literature review was carried out using the previously used keywords accompanied successively by the names of the software environment this search restricted to articles published during 2000 2019 yielded more than 200 additional articles the articles that did not make explicit reference to the modeling of organic pollutants migration and those focused on other pollutants or programs were discarded again the sections of each article were searched for relevant publications in the third step source publications report documents or chapters of books from all available years were searched in which selected software environments were first presented or introduced by their authors to find their descriptions i e user interface pre and post processing solutions methods of data interpolation different available features and finally the possibility of their use in general additional information was also searched for in the latest manuals and on the websites of the individual program distributors if available finally the above sources were also checked for various types of user support i e documentation discussion forum online tutorials courses blogs videos etc finally 100 scientific papers published between 2000 and 2019 steps 1 and 2 and 37 scientific papers report documents chapters of books manuals published between 1983 and 2017 step 3 were selected to be included in this review fig 2 they contain information on software environments that can be applied for modeling migration of organic pollutants in groundwater with examples of their application all papers were analyzed in terms of selected software operation applications usefulness advantages and limitations to indicate the most useful in this subject 3 software environments for modeling migration of organic pollutants in groundwater software environments for evaluating organic pollutants transport in porous media can be divided into two groups 1 programs to calculate values of transport parameters and 2 programs to simulate contaminant transport 3 1 software environments calculating transport parameters the first group contains programs to calculate values of transport parameters solving a direct or inverse problem based on prescribed parameters direct or observed laboratory or field data obtained from solute displacement experiments inverse according to the miscible displacement theory the movement of a solute in porous media occurs as a result of the combined effects of convection and diffusion the convection dispersion equation cde is the basic equation used in this mechanistic model the one dimensional cde model assuming steady state flow linear adsorption first order degradation and zero order production is given by the following equation parker and vangenuchten 1984 toride et al 1995 1 r δ c δ t d δ 2 c δ x 2 v δ c δ x μ c γ x where c is the solute concentration in the liquid phase m l t is the time t d is the hydrodynamic dispersion coefficient l2t x is the spatial coordinate in the direction of flow l υ is the average pore water velocity l t μ is the first order decay coefficient for degradation of the solute 1 t γ is a zero order production term m l3 t and r dimensionless is the solute retardation factor which represents the effect of the sorption process on solute transport and is defined as 2 r 1 ρ k d θ where ρ is the soil bulk density m l3 k d is the distribution coefficient for adsorption l3 m described by a linear isotherm and θ is the volumetric water content l3 l3 assuming r 1 for non reactive solutes such as cl equilibrium cde is used to estimate hydraulic transport parameters such as pore water velocity υ and dispersion coefficients d d l α l parameter symbols are defined in table 2 for reactive solutes r 0 e g organic pollutants other parameters can be estimated retardation factor dispersion coefficients d d l α l sorption coefficients k d k f and degradation or production parameters λ β ω the most commonly used according to the number of selected publications software environments for organic pollutants migration modeling in groundwater are cxtfit hydrus 1d phreeqc which are a single model code stanmod and the geochemist s workbench which are guis basic information on these software environments including the current version authors website where they can be download or purchase main advantages i e user supports and limitations are summarized in table 1 the references to source publications in which software was first presented or introduced by their authors were also included other details on selected software and the examples of their application in organic pollutants migration modeling are described below and in table 2 3 1 1 cxtfit cxtfit toride et al 1995 is the computer software frequently used to estimate transport parameters in several analytical models for solute transport during steady one dimensional flow this model permits the simulation under equilibrium and non equilibrium conditions by fitting mathematical solutions of theoretical transport models based upon the convection dispersion equation cde eq 1 to the observed laboratory column experiments or field data inverse modeling the inverse problem is solved by minimizing the objective function which consists of the sum of squared differences between observed and fitted concentrations simunek et al 1999b the model may also be used to simulate solute concentrations as a function of time and or leaching depth forward modeling the original fortran version of cxtfit was designed by parker and vangenuchten 1984 toride et al 1995 added solutions for first order decay and zero order production and developed a user friendly interface then nützmann et al 2005 implemented visual cxtfit in microsoft excel with a similar input output structure and functions the current version cxtfit excel 2 1 tang et al 2010 provides flexibility sensitivity and uncertainty analysis functions to improve transport parameter estimation and to facilitate model discrimination for multi tracer experiments on structured soils cxtfit is the most popular computer software for transport parameters estimations of organic pollutants such as pharmaceuticals fan et al 2011 hebig et al 2017 müller et al 2013 unold et al 2009 pesticides kamra et al 2001 marín benito et al 2013 montoya et al 2006 and others bertelkamp et al 2014 table 2 3 1 2 stanmod stanmod studio of analytical models simunek et al 1999a b is a computer software package for evaluating solute transport in porous media using analytical solutions of the convection dispersion solute transport equation eq 1 under an easy to use windows graphical user interface stanmod includes the following models cxtfit cfitm cfitim screen chain 3dade and n3dade which can be divided into four groups 1 simple applications 2 stochastic simulations 3 research applications and 4 parameter estimation feinstein and guo 2004 models for simple application 3dade cfitm chain screen use conventional inputs to perform deterministic calculations of solute movements according to the standard cde with equilibrium partitioning the 3dade code leij and bradford 1994 is for evaluating analytical solutions for two and three dimensional equilibrium solute transport problems assuming equilibrium conditions the cfitm code van genuchten 1980 can be applied for predicting or analyzing measured solute breakthrough data concentration curves versus time in terms of the one dimensional cde while the chain van genuchten 1985 is for analyzing the convective dispersive transport of solutes involved in sequential first order decay reactions finally the behavior assessment model screen jury et al 1983 is to describe the fate and transport of soil applied organic chemicals a modified and updated version of the cxtfit code toride et al 1995 stochastic simulations group allows predictions and analyses of equilibrium and nonequilibrium transport in time and or space including probabilistic analyses of solute transport using stream tube models among the research application group the cfitim code van genuchten 1981 can be used to analyze column effluent data permitting both physical or chemical nonequilibrium transport more advanced code that considers nonequilibrium transport is n3dade leij and toride 1997 which provide solutions for one dimensional advection and two or three dimensional dispersion under conditions of nonequilibrium partitioning stanmod can be used for either forward all codes or inverse cfitm cfitim cxtfit and 3dade modeling problems in solute transport by forward modeling solute concentrations can be predicted for a prescribed set of transport parameters while by inverse analyses selected transport parameters can be estimated from observed concentration distributions versus time and or distance parameter estimation in stanmod is accomplished using a marquardt levenberg type weighted nonlinear least squares optimization approach that minimizes the objective function van genuchten et al 2012 stanmod is in the public domain and can be downloaded freely the software is supported by a discussion forum where users can submit questions or suggestions about the models all projects included within stanmod can also be downloaded separately from the website stanmod has been widely used to estimate transport parameters of pesticides leiva et al 2017 nir et al 2012 rodríguez liébana et al 2018 and pharmaceuticals srinivasan and sarmah 2014 during steady one dimensional flow table 2 3 1 3 hydrus 1d hydrus 1d simunek et al 2005 is a free windows based modeling environment for simulating water heat and solute movement in one dimensional variably saturated media the software package consists of the hydrus computer program and the hydrus1d interactive graphics based user interface this software tool numerically solves the richards equation for variably saturated unsaturated partially saturated or fully saturated water flow and advection dispersion type equations for heat and solute transport the heat transport equation takes into account transport due to conduction and advection with flowing water while the flow equation incorporates a sink term to account for water uptake by plant roots as well as dual porosity type flow with a fraction of water content being mobile and fraction immobile the solute transport equations consider advective dispersive transport in the liquid phase and diffusion in the gaseous phase including among others linear equilibrium or nonlinear nonequilibrium reactions between the liquid and gaseous phases as well as the solid and liquid phases zero order production and two first order degradation reactions in addition physical nonequilibrium solute transport can be accounted for by assuming a two region dual porosity type formulation that partitions the liquid phase into mobile and immobile regions for inverse estimation of selected soil hydraulic solute transport and reaction parameters from measured transient steady state flow and or transport data levenberg marquardt type parameter estimation technique is implemented the procedure permits to estimate several unknown parameters from observed water contents pressure heads concentrations and or instantaneous or cumulative boundary fluxes simunek et al 2005 the free hydrus 1d software package is also commonly used for the determination of transport parameter mostly of pharmaceuticals martínez hernández et al 2017 teijón et al 2014 and other organic pollutants such as pesticides celestino ladu and zhang 2011 leiva et al 2017 and phenols zakari et al 2016b table 2 besides cxtfit stanmod and hydrus 1d other codes software can be found in the literature which are used to determine the migration parameters of organic substances and are not included in this review such as cxtanneal li et al 1999 inverts mcgrail 2001 reactran r package soetaert and meysman 2012 capsim shen et al 2018 cathy gatel et al 2019 sensan test kol descriptors id test kol okońska et al 2019a 2019b 3 1 4 phreeqc phreeqc ph redox equilibrium c programming language parkhurst and appelo 2013 is a computer program written in the c and c programming languages for simulating chemical reactions and transport processes in natural or polluted water in laboratory experiments or industrial processes the program is based on the equilibrium chemistry of aqueous solutions interacting with minerals gases solid solutions exchangers and sorption surfaces phreeqc implements several types of aqueous models two ion association aqueous models the lawrence livermore national laboratory model and wateq4f a pitzer model and the specific ion interaction theory aqueous model using any of these aqueous models phreeqc has capabilities for speciation and saturation index calculations batch reaction and one dimensional 1d transport calculations diffusion advection and dispersion with reversible and irreversible reactions this one dimensional transport includes aqueous mineral gas solid solution surface complexation ion exchange equilibria and specified mole transfers of reactants kinetically controlled reactions mixing of solutions and pressure and temperature changes finally phreeqc is also used for inverse modeling finding sets of mineral and gas mole transfer rates that account for differences in composition between waters within specified compositional uncertainty limits phreeqc evolved from the fortran program phreeqe parkhurst et al 1980 current version 3 of phreeqc extends the previous version with new features based on experience gained while simulating the results from laboratory experiments and field investigations furthermore the code has been generalized into a computer object iphreeqc to facilitate its use by other software programs such as comsol multiphysics wissmeier and barry 2011 that need to calculate chemical reactions or the distribution of chemicals in various phases phreeqc is available as freeware from the u s geological survey and is supported by a discussion forum its numerous options and capabilities make phreeqc useful for simulations that may solve many practical problems in hydrogeochemistry dobrzyński 2009 tomaszewska et al 2018 wątor et al 2020 however in studies on organic pollutants migration phreeqc is mostly used only to determine major hydrochemical processes controlling water quality and the occurrence of pharmaceuticals greskowiak et al 2006 jiang et al 2013 morel et al 2014 wanda et al 2017 xu et al 2017 pesticides kingsbury 2008 paradelo et al 2014 endocrine disrupting compounds patterson et al 2010 dissolved chlorinated solvents carniato et al 2012 and phenols espinoza et al 2007 in groundwater by calculating saturation indices sis ion activity products aqueous speciation and theoretical co2 partial pressure in water some authors also used phreeqc to model sorption behavior of organic micropollutants burke et al 2011 2013 grivé et al 2013 yan et al 2012 but the program is more commonly used in studies on metal pollutants migration chen et al 2018 dobrzyński 2006 li et al 2018 reyes lo et al 2014 yu et al 2018 3 1 5 the geochemist s workbench the geochemist s workbench gwb bethke 1994 is a set of software tools for geochemical modeling gwb designed for personal computers running ms windows is distributed in four packages essentials standard professional and advanced professional these packages contain tools for balancing reactions calculating activity diagrams computing speciation in aqueous solutions plotting the results of these calculations and storing the related data the packages also include programs for modeling reaction processes modeling reactive transport in one and two dimensions and plotting modeling results as well as for constructing phase diagrams finally gwb advanced professional extends the package to include message passing interface mpi versions of the reactive transport models for use on computing clusters the chemplugin self linking software object adapted for cluster computers and other specialized codes bethke et al 2015 the original gwb package was written in 1991 by craig bethke with the assistance of ming kuo lee and jeffrey biesiadecki of the hydrogeology program in the department of geology the university of illinois at urbana champaign gwb is presently developed and supported by aqueous solutions llc and commercially distributed current version 14 of gwb is supported by extensive documentation a discussion forum and online tutorials gwb set the standard especially in geochemical modeling of heavy metals carrillo chávez et al 2014 kossoff et al 2011 magu et al 2016 mohajerin et al 2014 root et al 2009 tabelin et al 2012 in cecs migration studies gwb similar to phreeqc is used for calculating saturation indices sis ion activity products aqueous speciation for example sena et al 2012 used gwb to perform a benchmark analysis of the simulation of aerobic benzene degradation in a shallow and oxidizing aquifer while nariyan et al 2017 make use of gwb during investigations on the removal of pharmaceuticals from the water with an electrocoagulation process besides phreeqc and gwb there are many other speciation models for metals and metalloids such as minteqa2 mineql visual minteq wham ecosat wateqf alchemi chess or eq 3 6 3 2 software environments simulating contaminant transport the second group of software environments for contaminant transport modeling represents programs linking hydrogeochemical modeling with hydrodynamic modeling to simulate single multi component transport such as modflow mt3d a single family of codes and guis processing visual modflow gms groundwater vistas feflow hydrus 2d 3d and phast basic information on these software environments is summarized in table 3 while other details and examples of selected software applications in organic pollutants migration modeling are described below simulation of contaminant transport by hydrodynamic modeling can be divided into two processes 1 development of groundwater flow model and 2 application of that model for a specific purpose e g contaminant transport groundwater models are usually developed in the following sequence model objectives hydrogeological characterization model conceptualization model design and construction input parameters model calibration and sensitivity analysis model testing predictive simulation and final reporting and interpretation kumar 2012 pianosi et al 2016 seyf laye et al 2012 fig 3 each step requires a specific approach and often extensive work because this affects the final correctness of the model and the quality of the results 3 2 1 hydrus 2d 3d hydrus 2d 3d simunek et al 2006 is a software package for simulating water heat and solute movement in two and three dimensional variably saturated media the software package consists of several computational programs and the interactive graphics based user interface hydrus the program numerically solves the richards equation for saturated unsaturated water flow and convection dispersion type equations for heat and solute transport 3 θ t x i k k i j a h x j k i z a s where h is the pressure head l s is a sink term 1 t x i i 1 2 are the spatial coordinates l t is time t k i j a are components of a dimensionless anisotropy tensor k a and k is the unsaturated hydraulic conductivity function l t given by 4 k h x z k s x z k r h x z where k s the saturated hydraulic conductivity a n d k r is the relative hydraulic conductivity l t the flow equation incorporates a sink term to account for water uptake by plant roots the heat transport equation considers movement by conduction as well as convection with flowing water the governing convection dispersion solute transport equations include provisions for nonlinear nonequilibrium reactions between the solid and liquid phases and linear equilibrium reactions between the liquid and gaseous phases hence both adsorbed and volatile solutes such as pesticides can be considered the solute transport equations also incorporate the effects of zero order production first order degradation independent of other solutes and first order decay production reactions that provide the required coupling between the solutes involved in the sequential first order chain the transport models also account for convection and dispersion in the liquid phase as well as for diffusion in the gas phase thus permitting to simulate solute transport simultaneously in both the liquid and gaseous phases the original version of hydrus 2d software package simunek et al 1999a distributed by the international groundwater modeling center was fully replaced with the hydrus 2d 3d software package current version 3 of the hydrus 2d 3d computer software package simunek et al 2018 is commercially distributed in five editions levels enabling two dimensional applications for simple rectangular and general 2d geometries 2d lite and 2d standard editions and three dimensional applications for simple hexahedral layered and general 3d geometries 3d lite 3d standard 3d professional editions for customers available are also specialized add on modules several modules that were recently developed for simulating the movement of water heat and solutes in the subsurface e g wetland 2d hypar slope classic etc an important advantage of the hydrus models is that they are not limited to any particular spatial or temporal scale hydrus 2d 3d can be used for transport domains ranging from 1 m wide to transects of several tens or hundreds of meters wide and for both laboratory and field scale applications however the use of hydrus for very large 3d domains such as entire catchments is not recommended because the highly nonlinear richards equation requires relatively fine spatial discretization otherwise there may be a significant strain on the available computing resources simunek 2008 simunek et al 2016 the types of applications of hydrus 2d 3d are very broad ranging between agricultural problems evaluating different irrigation schemes and the effects of plants on the soil water balance and groundwater recharge to many environmental applications simulating the transport of different solutes and particle like substances as well as evaluating the effects of land use and environmental changes however only a few authors made use of hydrus 2d 3d in studies on organic pollutants table 4 abdel nasser et al 2011 used hydrus 2d to solve numerically the water and contaminant atrazine and malathion transport equation subjected to initial and boundary conditions while boivin et al 2006 simulate with flow and transport processes of bentazone herbicide at three field sites hydrus 2d was also applied to simulate pesticide hexazinone procymidone picloram and triclopyr leaching at a field trial dann et al 2006 to simulate water movement and transport of picloram atrazine and simazine pang et al 2000 and 2 4 d atrazine and terbuthylazine pesticides close et al 2003 in the soil water system 3 2 2 modflow programs modflow mcdonald and harbaugh 1988 is a popular open source groundwater flow model distributed by the u s geological survey to this day numerous modflow versions based on the modflow core version have been developed due to growing interest in surface and groundwater interactions local refinement with nested and unstructured grids karst groundwater flow solute transport and saltwater intrusion modflow variants contain newer specialized or advanced versions for use by experienced modelers modflow nwt modflow usg gsflow and gwm modflow based particle tracking and solute transport moodpath mt3d usgs and seawat parameter estimation and uncertainty analysis pest as well as modflow utilities post processors and graphical user interfaces flopy gridgen gw chart modelmuse modelviews and zonebudget however although these versions are often based on the modflow core there are often incompatibilities that restrict their use with other modflow versions modflow 6 is an object oriented program and underlying framework developed to provide a platform for supporting multiple models and multiple types of models within the same simulation hughes et al 2017 modflow 6 contains two types of hydrologic models the groundwater flow gwf model and the groundwater transport gwt model langevin et al 2017 the gwt model simulates three dimensional transport of a single solute species in flowing groundwater while the gwf model is based on a generalized control volume finite difference cvfd approach in which a cell can be hydraulically connected to any number of surrounding cells the new groundwater flow formulation the xt3d option extends the capabilities of modflow by enabling the simulation of fully three dimensional anisotropy on regular or irregular grids in a way that properly takes into account the full three dimensional hydraulic conductivity tensor langevin et al 2019 modflow 6 is the sixth core version of modflow to be released by the usgs previous core versions were released in 1984 1988 1996 2000 and 2005 the last core version modflow 2005 is still actively maintained and supported modflow 6 is freely distributed and can be copied modified distributed and used even for commercial purposes without special permission modflow code designed for groundwater flow modeling in combination with mt3d mt3dms zheng and wang 1990 1999 mt3d usgs bedekar et al 2016 rt3d clement 1999 and modpath pollock 2016 is crucial in organic contaminants transport mt3d mt3dms is a package used to simulate the transport of single multi species pollutants there is also an updated version of the mt3dms code released by u s geological survey and named mt3d usgs which includes new transport modeling capabilities to accommodate flow terms calculated by modflow packages that were previously unsupported by mt3dms and to provide greater flexibility in the simulation of solute transport and reactive solute transport other new capabilities include unsaturated zone transport and transport within streams and lakes including a solute exchange with connected groundwater bedekar et al 2016 rt3d can be used to simulate the transport of reactive pollutants where only sorption by partitioning coefficient and degradation by decay coefficient processes can occur and there is no dissolution reaction finally modpath is a standard package for forward and backward particle tracking pollock 2016 waterloo hydrogeologic 2015 modflow and mt3d mt3dms models are commonly used to simulate groundwater flow fate and transport of organic pollutants table 4 cho et al 2010 simulated groundwater and pesticide movement with modflow and mt3d in the saturated zone during surface water and groundwater interaction modeling to simulate caffeine and carbamazepine transport in the vadose zone and groundwater dvory et al 2018 used a modified version of the modflow mt3d model groundwater fluxes calculated by modflow were used by shin et al 2011 as input to the mt3dms model to calculate the advective transport of pfoa nham et al 2016 provided a model based modflow mt3dms characterization of the long term transport behavior of five psychoactive compounds meprobamate pyrithyldione primidone phenobarbital and phenylethylmalonamide introduced into groundwater via sewage irrigation modflow mt3d was also used to model the fate of emerging organic micropollutants during riverbank filtration hamann et al 2016 henzler et al 2014 and during soil aquifer treatment nham et al 2015 levy et al 1998 combined modflow and path3d to assess bedrock aquifer susceptibility to contamination and mt3d to investigate the potential impact of long term atrazine use on aquifer water quality finally gaus and casteele 2004 used modflow mt3d solute transport model as a risk assessment tool for five pesticides atrazine simazine bentazone mecoprop and mcpa contaminating a quaternary phreatic aquifer for modflow and other related codes several hosting platforms gui are available such as processing and visual modflow gms and groundwater vistas langevin and bean 2005 which is not included in this review processing modflow chiang and kinzelbach 1998 was originally developed to support the first official release of modflow mcdonald and harbaugh 1988 the newest x version of processing modflow pmx is the result of the rewrite efforts the supported model codes have been consolidated and the modeling process has been streamlined with the ability to display model data and results at the same time processing modflow x comes with the supported models codes and a map based user interface that can display online basemaps and shapefiles along with the grids and results of multiple models the interface enables users to construct calibrate and run models as well as visualize results chiang 2020 processing modflow x is commercially distributed however there is a limited free version allowing only to create models up to 3 layers 5000 cells 2000 cells in a layer and 3 stress periods visual modflow is the most complete modeling environment for practical applications in three dimensional groundwater flow and contaminant transport simulation this fully integrated package combines powerful analytical tools with a logical menu structure easy to use graphical tools allow among others graphic design of the model s grid its properties and boundary conditions visualization of the input parameters of the model in 2d and 3d space groundwater flow analysis flow line determination and pollution transport simulation as well as automatic winpest or manual model calibration waterloo hydrogeologic 2015 originally released in 1994 visual modflow was the first commercially available graphical interface for the open source modflow groundwater modeling engine in 2012 a newer net version of the software was rebranded as visual modflow flex the latest version 6 1 of visual modflow flex is a popular and commonly used hydrogeology modeling program commercially distributed in three levels of program functionality basic professional and premium it provides the user with the opportunity to choose between conceptual modeling creating a real three dimensional model based on available gis data and well borehole data and classic numerical modeling which allows to manually define the parameters of a numerical computational grid based on literature research processing and visual modflow are rather rarely used in modeling the migration of organic pollutants in groundwater table 4 meffe et al 2014 used processing modflow to determine the fate of para toluenesulfonamide p tsa in groundwater under anoxic conditions in turn visual modflow was applied to modeling an accidental spill of chlorobenzene using a 3d model duarte 2008 sharma et al 2015 used visual modflow mt3d for modeling lindane transport in groundwater finally müller et al 2011 simulate using platform visual modflow the groundwater flow processes at bank filtration sites in general and calculate the predicted environmental concentration of pharmaceuticals processing and visual modflow could be also used to develop results from column experiments jaramillo et al 2019 choose the data from the column experiments to feed a pesticide transport model run in a transient state with the code mt3dms which was based on a steady state groundwater flow model development in studies of schaffer et al 2015 the breakthrough curves of 28 organic micropollutants were evaluated with modflow coupled with the solute transport model mt3d and implemented in the processing modflow marciniak et al 2006 used visual modflow to obtain solute transport parameters from column experiments such as αl kd r 3 2 3 gms gms groundwater modeling system owen et al 1996 is a software platform designed for groundwater modeling the program provides tools throughout all aspects of the modeling process some of which include geometric characterization of earth masses geostatistical analysis finite element and finite difference mesh generation model input for specific flow and transport analysis engines as well as complete three dimensional visualization of results the entire gms system consists of a graphical user interface the gms program and several analysis codes modflow mt3dms rt3d pht3d etc owen et al 1996 gms can be fully integrated with arcgis allowing for a seamless transfer in creating conceptual models and producing final figures of modeling results current version 10 3 of gms is developed by aquaveo and is commercially distributed in four editions community free modflow modflow pro and premium only a few studies were found about using gms software in the modeling of emerging pollutants migrations such as pharmaceuticals dvory et al 2018 nitriles şengör and ünlü 2013 and pesticides welch et al 2019 table 4 3 2 4 groundwater vistas groundwater vistas gv rumbaugh and rumbaugh 2020 is a sophisticated windows based graphical user interface for 3 d groundwater flow and transport modeling it combines an advanced water model design system with comprehensive graphical analytical tools this groundwater flow modeling tool enables pre and post process data processing for modflow and other related codes such as modpath mt3d rt3d and pest the model independent calibration software langevin and bean 2005 gv allows to interactively design generic finite difference groundwater flow and contaminant transport models in aquifer systems a finite difference model is constructed by dividing the model domain into square or rectangular regions blocks or cells head drawdown and concentration are computed at discrete points within the model called nodes while the network of cells and nodes is called the grid or mesh there are two main types of finite difference techniques known as block centered and mesh centered gv has an automatic calibration procedure which makes it easy to calibrate an aquifer once the target cells with known heads have been identified rumbaugh and rumbaugh 2020 groundwater vistas has been under development by environmental simulations incorporation esi for over 25 years current version 8 of gv from 2020 is commercially distributed in four editions standard advance professional and premium on esi website groundwater vistas is mostly used for aquifer characterization and groundwater flow modeling ahmed 2009 kiptum et al 2017 lowry and anderson 2006 miljević et al 2012 ofomola et al 2016 as well as a support in optimization processes connected among others with hydraulic barriers wells pumping and changing of groundwater table abdelrhem et al 2008 rashid et al 2015 remonti and mori 2016 only a few studies were found about using gv software in the modeling of emerging pollutants migrations table 4 bozzano et al 2007 used gv with modpath code for flow numerical simulation of an aquifer contaminated by chlorinated solvents in rho italy the software was also applied to simulate fate and transport of n nitrosamines drewes et al 2006 transport of tce in contaminated groundwater in the bernau area of germany using mt3d code spalvins et al 2001 and finally to simulate with mt3d and modpath codes transport of surface active substances in a contaminated aquifer at the incukalns district of latvia spalvins et al 2017 3 2 5 feflow feflow trefry and muffels 2007 is an advanced finite element subsurface flow and transport modeling system with an extensive list of functionalities including variably saturated flow variable fluid density mass and heat transport and multi species reactive transport feflow uses finite element solution techniques to handle a broad variety of physical processes for subsurface flow and transport modeling it can be efficiently used to describe the spatial and temporal distribution and reactions of groundwater contaminants to model geothermal processes to estimate the duration and travel times of chemical species in aquifers to plan and design remediation strategies and interception techniques and to assist in designing alternatives and effective monitoring schemes the program has been under development since 1979 by the institute for water resources planning and systems research inc wasy gmbh of berlin germany which has recently become a part of dhi group trefry and muffels 2007 current version 7 3 of feflow is commercially distributed in three licenses demo essentials and professional regnery et al 2017 used feflow for 2d simulation of the fate and transport of contaminants in a variably saturated synthetic aquifer and for the simulation of breakthrough curves of carbamazepine sulfamethoxazole trimethoprim tris 2 chloroethyl phosphate tcep and diphenhydramine table 4 to quantify the fluxes of pharmaceuticals including endocrine disruptors and fragrances in the environment surface and groundwater reinstorf et al 2009 applied feflow coupled with hydrodynamic river model hec ras feflow was also used as a part of studies for analyzing the reactive transport behavior of 37 trace organic compounds during field scale bank filtration sanz prat et al 2020 for assessing the influence of agricultural activities on pesticides in a shallow aquifer in south eastern norway kværner et al 2014 feflow can be applied in environmental protection studies as well e g for spatial modeling of groundwater vulnerability to pesticide contamination akbar et al 2011 wellhead protection areas lo russo and taddia 2012 and remediation of e g a large soil aquifer treatment site for domestic wastewater rona et al 2018 3 2 6 phast phast phreeqc and hst3d parkhurst et al 2010 is a program for simulating multicomponent reactive solute transport in three dimensional saturated groundwater flow systems phast has also the capabilities to model a wide range of equilibrium and kinetic geochemical reactions the flow and transport calculations are based on a modified version of hst3d that is restricted to constant fluid density and constant temperature the geochemical reactions are simulated with the geochemical model phreeqc which is embedded in phast three data input files are needed in phast flow and transport calculation data chemical reaction calculation data and the thermodynamic database parkhurst et al 2010 phast is applicable to the study of natural and contaminated groundwater systems at a variety of scales ranging from laboratory experiments to local and regional field scales it can be used in studies of migration of nutrients radionuclides inorganic carniato et al 2012 huo et al 2014 malmström et al 2006 and organic contaminants zhang et al 2010 in projects such as aquifer storage and recovery or engineered remediation and in investigations of the natural rock water interactions in aquifers however phast is not appropriate for unsaturated zone flow multiphase flow or density dependent flow parkhurst et al 2010 phast is available as freeware from the u s geological survey and is supported by a discussion forum tutorials and training courses many other software or codes are available for modeling of groundwater flow and contaminant transport which are publicly accessible or commercially distributed they are revised by e g karatzas 2017 kumar 2012 pianosi et al 2016 piggott 1999 zdechlik 2016 however their usage in the modeling of organic pollutant transport is rather scarce 4 conclusions a large number of computer programs exist for modeling the migration of organic pollutants in porous media using different analytical or numerical solutions in general they can be divided into two groups software environments calculating values of transport parameters and software environments linking hydrogeochemical modeling with hydrodynamic modeling to simulate single multi component transport among the first group cxtfit hydrus 1d and stanmod are the most commonly used to obtain contaminants migration parameters such as pore water velocity retardation factor sorption coefficients and degradation or production parameters unfortunately it is generally difficult to obtain reliable values of such parameters because model predictions depend mainly upon the quality and uncertainty of the input data therefore there is a necessity to combine laboratory and modeling data to verify the correctness of the received transport parameters in the second group programs from the modflow mt3d family hydrus 2d 3d and feflow are the most popular in 2d 3d simulation of groundwater flow and transport of organic pollutants although these models may be used as predictive tools they should be viewed as estimates dependent upon the quality and uncertainty of the input data for this reason testing of model predictions through e g field monitoring is crucial for eliminating or reducing modeling errors although it is easy to identify the more or less popular software it is hard to say which one is good or best because the choice of the most suitable software depends on a wide range of different factors beyond suitable software there is primarily the science and art of modeling and the references listed in this paper can be evaluated by readers to see how problems have been approached declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
25744,many bioretention models still incorporate simplifications and lumped parameters that do not fully account for fundamental physical processes this review summarizes the representation of hydrologic pathways notable features and applications of bioretention models with the goals of recommending models well suited to bioretention modeling and identifying key research needs as a result hydrus and gifmod were identified as the only models that use richards equation for determining infiltration under variably saturated conditions secondly this study identified limited drainage configurations by most models except drainmod urban thirdly most models were inadequate for considering vegetation and plant water use an area for improvement in future research finally more calibration and validation studies are needed to build confidence in model results this review intends to educate modelers of the processing equations for each water balance component the input requirements in each model and other model characteristics that should be considered in model selection graphical abstract image 1 keywords bioretention hydrologic modeling low impact development 1 introduction 1 1 background urban runoff has been shown to cause a range of environmental problems such as stream channelization deterioration of stream habitat and decreased water quality dietrich et al 2017 liu et al 2014 asleson et al 2009 to combat these problems alternative methods of stormwater management have been developed to reduce the volume and peak flows of urban runoff by increasing infiltration and evapotranspiration et many of these approaches also focus on improving water quality through filtration sedimentation sorption and biological uptake hatt et al 2009 the goal is to return flow and water quality regimes to the natural pre development conditions this concept referred to as low impact development lid or water sensitive urban design wsud is an urban planning technique that focuses on all methods of reducing the effects of urbanization from reducing impervious areas during planning to conserving natural resources and public awareness education kaykhosravi et al 2018 fletcher et al 2014 liu et al 2014 another lid concept is the use of improved ecological engineering structures called green infrastructure gi kaykhosravi et al 2018 liu et al 2014 gi integrates traditional engineering design with natural materials to develop solutions to reduce impact on the environment typical examples of gi include permeable pavement green roofs rain barrels and bioretention cells kaykhosravi et al 2018 dietrich et al 2017 liu et al 2014 davis et al 2009 when describing individual practices gi is often also referred to as lid practices stormwater best management practices bmps stormwater control measures scms or sustainable urban drainage systems suds fletcher et al 2014 bioretention is the predominant choice of lid practices in the u s because it can control the volume rate and quality of stormwater runoff akan 2013 it has also become popular worldwide because it can easily be retrofit into urban areas and offers additional aesthetic and social benefits lucke et al 2017 bioretention cells are systems used to capture and filter stormwater runoff which is exfiltrated into the surrounding soil and eventually groundwater aquifers drained to receiving waters for systems with underdrains and taken up by plants i e et various drainage configurations for the underdrain pipe are possible one common configuration is an upturned elbow which creates an internal water storage zone iws fig 1 internal water storage zones are often used to promote runoff reduction to enhance exfiltration to provide water to vegetation during dry weather conditions and to create anaerobic conditions to increase nitrogen removal brown and hunt 2011 bioretention systems have been widely accepted within the engineering community due to many field and laboratory studies demonstrating substantial volumetric reductions and water quality improvement see appendix a for references yet significantly fewer studies have addressed modeling of bioretention systems modeling of these systems is important to be able to assess the performance of a system before installation to review the applicability of design guidelines to various scenarios and climates and to be able to scale local impacts to the larger watershed due to the overwhelmingly positive reports from the research conducted thus far bioretention systems have been widely adopted often before all the effects of these systems can be researched in field and mesocosm studies process based modeling provides a way to check any anomalies in initial observations or assumptions and to make adjustments while still considering the physical properties of the site heasom et al 2006 therefore there is a need for a comprehensive process based hydrologic model to predict the performance of bioretention cells for design and evaluation purposes meng et al 2014 there are many opportunities for improvement of field and mesocosm studies through the knowledge gained in bioretention modeling bioretention systems are often installed in locations without regional design standards so designers must refer to standards from other regions davis et al 2009 modeling can help adjust design standards to better fit regional climate vegetation and other local characteristics additionally little is known about the long term effects of these bioretention systems many monitoring studies have demonstrated effective performance of bioretention cells as long as 8 16 years johnson and hunt 2016 2019 lucke et al 2017 lucke and nichols 2015 komlos and traver 2012 jenkins et al 2010 long term modeling could identify the limits of a bioretention cell under various climate and design scenarios li and lam 2015 hathaway et al 2014 brown et al 2013 furthermore what are the effects of these systems at the catchment scale many times the installation and location of bioretention systems is opportunistic such as when current infrastructure is failing or a new development is constructed which creates a piecemeal approach to stormwater management national research council 2009 as more scms like bioretention are added to a catchment the cumulative effects must also be understood advances in bioretention modeling could help identify the effects of multiple bioretention cells in a catchment and the optimal locations for bioretention cells lee et al 2012 additionally modeling could serve as a first step to address catchment scale processes prior to field studies however it is imperative that bioretention modeling first be improved at the site scale before modeling can be accomplished at the catchment scale to avoid compounding errors these are all future applications of bioretention modeling but more research is needed to meet these needs 1 2 previous literature reviews three reviews liu et al 2014 roy poirier et al 2010 davis et al 2009 have summarized bioretention research and future needs two of these reviews briefly provided overviews of bioretention modeling but all concisely listed improved bioretention modeling as a future need it should be noted that few models for bioretention were available prior to 2010 therefore two of the three reviews did not cover the bioretention models that have recently become available while liu et al 2014 includes a review of more recent models it is just one section of a larger review of bioretention studies additional reviews have focused specifically on modeling of lid practices but have not been devoted to bioretention alone kaykhosravi et al 2018 jayasooriya and ng 2014 elliott and trowsdale 2007 for example li et al 2017 completed a comprehensive review of catchment scale modeling and monitoring lid studies describing methods and key results however only 12 of the 31 modeling studies mentioned bioretention or rain gardens and only four of those 12 focused on bioretention results instead of lumped lid benefits as one of the most widely used lid practices in the us and globally bioretention warrants its own review of available models and modeling techniques li et al 2017 lucke et al 2017 akan 2013 by concentrating on bioretention a more detailed look at the challenges of modeling the complex soil water interactions of bioretention systems can be addressed additionally none of the previous modeling reviews detailed what input parameters are required for each bioretention model although the number and complexity of input parameters can limit model use the objectives of this review were to give 1 a broad overview of available models for bioretention 2 a detailed examination of the input parameters and hydrologic processes in models best suited for bioretention modeling and 3 identifying areas for future improvement in bioretention modeling by meeting these objectives this review will help researchers develop bioretention modeling studies that further our knowledge of the field 1 3 review process and structure although there are many models being used to address water quality improvement from bioretention this review will describe only models used for bioretention cell hydrology and hydraulics it is important to confront errors in modeling bioretention hydrology before modeling of water quality can be improved because flow volumes peaks and timing of hydrographs will directly affect nutrient loadings plant uptake and microbial behavior furthermore reduction of pollutant loadings is often attributed in significant part to reduced runoff volumes rather than biogeochemical processes alone jefferson et al 2017 wilson et al 2015 davis et al 2009 first 17 models capable of modeling bioretention cell hydrology were identified and summarized in tables 1 and 2 models were split into two categories based on their intended uses planning assessment tools and process based computational models a brief description of all 17 models can be found in appendix b which includes the main objective previous studies general information about hydrologic and hydraulic processes and any other notable features unless otherwise cited all references to model processes in this review can be found in the resources listed under documentation in tables 1 and 2 only process based computational models were selected for further analysis in this study because they use governing equations to describe fundamental hydrologic processes this allows for investigation of hydrologic pathways in a bioretention cell as opposed to lumped parameter models that give generic estimates of runoff reduction potential of these 11 process based bioretention models six models met the hydrologic modeling criteria and more specifically bioretention modeling criteria outlined below fig 2 for this study the hydrologic modeling criteria were based on two attributes simulation type and temporal scale only bioretention models that allow for continuous simulation and a long term temporal scale with sub hourly time steps were considered in this study fig 2 spatial scale was also addressed for each model but was not defined in these criteria because it is largely application driven lastly many hydrologic models meet these two requirements so an additional attribute was added the model must contain processes explicitly developed for bioretention to be considered a model well suited for bioretention in this study the model must meet four out of seven recommended bioretention modeling criteria figs 2 and 3 specifically these attributes were improved infiltration processes using richards equation or soil water retention drainage configurations that represent underdrains and iws zones incorporation of vegetation such as water uptake processes and et calculations and production of output hydrographs fig 3 these attributes were chosen to address model deficiencies identified by previous modeling review and research studies liu et al 2014 meng et al 2014 akan 2013 brown 2011 in the models that meet most of these criteria greater than four drainmod and swat have many attributes that are well suited for bioretention modeling but did not meet the hydrologic modeling criteria of explicit bioretention functions or sub hourly time steps fig 3 drainmod urban is a revised version of drainmod that considers urban hydrology for bioretention fig 3 suggests that swat could also perform well as a bioretention model if it were also adapted to bioretention and urban systems each component of the hydrologic and bioretention modeling criteria is discussed further in the following sections the six models which meet both the hydrologic and bioretention modeling criteria were drainmod urban gifmod hydrus music recarga and swmm these models were evaluated in further detail concerning the hydrologic and hydraulic processes associated with each water balance component next a look at model inputs and outputs gives the user an idea of the complexity and applicability of each model other considerations for model selection and improvements to future bioretention modeling studies are suggested in the following sections 2 hydrologic modeling criteria suitable to bioretention 2 1 simulation type continuous versus event based simulation is a common theme in hydrologic modeling event based simulations provide analysis of natural or simulated storm events of various sizes continuous modeling uses a times series of precipitation data for simulation so that the timing of storms in relation to each other and to other modeled outputs can be assessed the biggest advantage of continuous modeling for bioretention cells is the ability to account for antecedent moisture content in the soil elliott and trowsdale 2007 antecedent moisture content is an important parameter for considering variation in soil moisture in the bioretention cells which affects infiltration and storage capacity especially for small storms low initial moisture content at the start of each storm can lead to increased infiltration due to high soil suction while high initial moisture content can cause reduced infiltration and an increase in overflow the largest disadvantages of continuous simulation are higher computational times and data requirements of a continuous rainfall record which have been largely overcome by modern computing and data availability rossman and huber 2016a continuous simulations can be conducted by all process based models evaluated except for hydrocad which was removed from further analysis in this review event based simulation is primarily used in design storm analysis which is beneficial in preliminary design studies to understand how a system will respond to changes in storm intensity and duration recarga mouse mike urban music and swmm allow for continuous or single event simulations depending on the user inputs for single event simulations recarga requires the user to select from soil conservation service scs hyetographs and provide the 24 h rainfall depth music and swmm allow a user to create a time series for a natural or synthetic event 2 2 temporal scale in all eleven process based models reviewed there is no limit on the length of simulation with user defined continuous rainfall long term simulations are beneficial for understanding a bioretention cell s response to various climate conditions and evaluating bioretention cell performance over its entire life cycle brown et al 2013 several field studies have found little change in performance of infiltration rate and nutrient removal in bioretention systems over eight to 16 year monitoring periods johnson and hunt 2016 2019 lucke et al 2017 lucke and nichols 2015 paus et al 2014 komlos and traver 2012 jenkins et al 2010 but these studies are limited to a few sites and local climate conditions the power of modeling bioretention with long term simulations is that it can address questions about the effect of climate change on infiltration based infrastructure such as the study by hathaway et al 2014 another example is a study that used 10 year precipitation averages in swmm to determine how sensitive site characteristics such as catchment area and hydraulic conductivity were to increases or decreases in precipitation li and lam 2015 when considering long term performance of bioretention cells many design parameters such as soil and vegetative properties have seasonal variations yet for most models discussed in this paper these parameters remain constant nichols et al 2021 tang et al 2015 emerson and traver 2008 for example drainmod urban accounts for root growth over seasons with monthly rooting depths in the soil profile but this only accounts for seasonal changes not continuous growth over time hydrus accounts for the three dimensional spatial distribution of roots when calculating the potential root water uptake but does not allow these parameters to change over time all other models in this review use a static rooting depth allowing for vegetation properties such as root and crop growth or soil properties such as the saturated hydraulic conductivity to be adjusted during the simulation would better represent seasonal variation and could improve model performance for bioretention cells the time step used to evaluate model outputs can have a significant impact on the performance of the bioretention model baffaut et al 2015 models best suited for urban applications such as bioretention employ a sub hourly time step because urban impervious areas decrease the time of concentration of stormwater runoff and cause flashy hydrologic behavior leopold 1968 lisenbee et al 2020 demonstrated this point by recoding drainmod to use time steps as small as 1 min for inputs and outputs in drainmod urban when calibrating drainmod urban to measured drainage hydrographs good performance was achieved with nse 0 60 at a 2 min time step but when the daily volume calibration by winston 2015 was used in drainmod urban at a 2 min time step the nse was reduced to 0 31 the original drainmod and swat were removed from further evaluation in this review for not meeting the criteria of sub hourly time steps necessary for urban hydrologic applications recarga and music are the only continuous simulation models discussed in this review with minimum time steps greater than 1 min recarga disaggregates hourly precipitation inputs into 15 min time steps to calculate the runon to the bioretention cell the soil moisture in each layer the ponding depth and the volumes for each component to the water balance but results are only printed on an hourly and total basis music requires a user specified time step of between 6 min and 24 h six minutes is the minimum time step in music because it corresponds with local precipitation records from the australian bureau of meteorology ewater 2013 swmm uses an adaptive time step that considers longer time steps in dry periods when systems are less dynamic and shorter time steps for wet periods when capturing changes in the system becomes more important this process significantly reduces the total computational time as described for swmm in the hydrology reference manual rossman and huber 2016a similarly drainmod urban uses an hourly time step during dry periods gifmod and hydrus use numerical solutions that employ time discretization based on the number of time steps needed for convergence which automatically adjusts the time step during the convergence process the output time step can be determined by the user down to 1 min 2 3 spatial scale bioretention cells can be considered in a single site scale model that focuses on the flow through the bioretention media and associated drainage storage and exfiltration to surrounding soils bioretention cells can also be incorporated in a catchment model that allows users to visualize drainage areas that generate runoff for bioretention systems and route flows from bioretention cells to other elements downstream site scale models can incorporate user defined inflow hydrographs calculated using another model such as swmm for rainfall runoff calculations in the drainage area however it is easier for both runoff generation and bioretention cell performance to be considered in the same model furthermore catchment models often have good hydraulic processes to route hydrographs from one component to another this incorporates time delays into runoff inflow hydrographs one downside of the site scale is the assumption that conveyance time of runoff from the drainage area to the bioretention cell is negligible atchison et al 2006 this may be true when using models with time steps greater than the small time of concentration found in urban catchments but when using models at very small time steps a delay could be seen in measured versus modeled hydrographs routing routines in catchment models also provide a means to model downstream effects of bioretention cells from drainage and overflow hydrographs while site scale modeling is beneficial to evaluate effects of various design parameters or performance of a specific bioretention cell catchment scale modeling is more useful for planning purposes and broader ecosystem level investigation however catchment scale models for bioretention tend to lump parameters and make simplifications to allow for quick analysis of many contributing factors without cumbersome input requirements to combine the best of these methods it is suggested that site scale models be incorporated as add in tools for larger catchment models drainmod urban and hydrus can only model the processes of a single bioretention cell without any built in runoff generation procedures instead relying on user defined inflow recarga can accept user input inflow or can calculate runon from simple methods without any routing procedures in swmm a common catchment model applied to bioretention the lid modules allow the flow through the bioretention cell to be modeled as a separate subwatershed or as a part of an existing subwatershed this allows flow to be routed to or from the bioretention cell using any of the routing procedures provided by swmm music is another catchment scale model that uses an internal rainfall runoff procedure developed by chiew and mcmahon 1997 to account for bioretention cell inflow and the muskingum cunge routing algorithm between nodes gifmod can model bioretention cells at the site scale by considering each layer to be a separate connector block gifmod also allows the catchment area to be modeled as a single block in its block connector model framework therefore it can be connected to the bioretention cell and flow from one block to another can be simulated with several supplied equations 2 4 bioretention modeling implicit or explicit as computational models for bioretention systems were developed some researchers explored using available hydrologic hydraulic models and adapting the procedures in the model to fit bioretention processes this implicit modeling was often confusing or cumbersome such as the method described by lucas 2010 to model bioretention in hydrocad other models were required to simplify the system to reservoir components such as in hec hms heasom et al 2006 or sinkaway nodes in mike urban dhi 2017 therefore functions developed specifically for bioretention or explicit bioretention modeling was added to many models such as the lid modules created for swmm in 2010 however some modelers prefer to use implicit storage functions to represent bioretention systems in swmm depending on the application lynn et al 2018 the models that explicitly model bioretention include drainmod urban gifmod hydrus mouse mike urban music recarga and swmm 3 bioretention modeling criteria 3 1 water balance components modeling the water balance of a bioretention cell enables users to assess how the bioretention cell performance varies with respect to design parameters alikhani et al 2020 yang and chui 2018 winston et al 2016 meng et al 2014 brown et al 2013 muthanna et al 2008 for example the bioretention media composition or drainage configuration could change the infiltration capacity of a given bioretention cell alikhani et al 2020 meng et al 2014 each model provides its own representation of bioretention processes and although they are all modeling the same flow paths there are many possible approaches the governing equations used to model each water balance component have a large effect on the modeled bioretention cell behavior and more importantly the design recommended for given conditions to distinguish among various governing equations the authors assigned a qualitative ranking high medium and low to each method listed in table 3 which describes the model s capability to represent each water balance component we believe that future modelers need to know the basic governing equations of each model as a starting point to understanding the usefulness of a model for a given application this is information often only found in technical model documentation and therefore this review serves as a resource to compare these processes side by side the swmm model has been used in several comparison studies on modeling bioretention to test the effect of different model processes tu et al 2020 lynn et al 2018 tiveron et al 2018 gülbaz and kazezyılmaz alhan 2017b sun et al 2011 lucas 2010 however more comparison studies are needed across all models mentioned here to validate and quantify the effect different model processes have on the output for each water balance component in a bioretention cell 3 1 1 inflow drainmod urban and hydrus rely solely on user input inflow but in previous studies swmm was used to provide a 1 min inflow hydrograph using the green ampt method lisenbee et al 2020 gao et al 2018 sun et al 2011 similarly runoff generation from the drainage area could be calculated with any rainfall runoff method giving the users more flexibility music has a built in model for rainfall runoff prediction based on the study by chiew and mcmahon 1997 recarga offers a built in process for producing hourly inflow calculated with the scs curve number cn method for pervious sections and an initial abstraction method for impervious sections but can also use user defined inflow similarly gifmod can accept user specified inflow or calculate runoff from a separate block that is directed into the bioretention cell as inflow swmm offers the most comprehensive methods for runoff generation its default method is a nonlinear reservoir model that incorporates manning s equation for overland flow and accounts for depression storage alternative methods include rational method scs cn method unit hydrograph method from natural resource conservation service nrcs and user input values swmm also can account for directly connected impervious areas to distinguish effective imperviousness separate from the total imperviousness this distinction is important in urban hydrologic modeling to improve runoff estimation for catchment models flow routing can be considered between components using the steady flow kinematic wave and dynamic wave methods in swmm and the diffusive wave manning s technique in gifmod this capability not only better calculates the timing of inflow to the bioretention cell but is also useful for investigating effects of bioretention cells on downstream bmps or control features atchison et al 2006 heasom et al 2006 one example is modeling treatment trains that link many lid practices in series music is often used for treatment train applications using the muskingum cunge routing procedures between each stormwater control measure ewater 2013 another application is linking bioretention cells to sewer systems particularly for studying mitigation of csos lucas 2010 3 1 2 infiltration although richards equation is widely considered the most comprehensive infiltration model it requires the unsaturated hydraulic conductivity curve k θ and the soil water characteristic curve swcc which are two soil properties that are not easily measured therefore the green ampt equation a simplification of the richards equation is used in many models to reduce input requirements and computation demand these simplifications require certain assumptions of the green ampt method such as one dimensional vertical flow and total saturation behind a sharp wetting front these assumptions are not always valid in bioretention cells which operate under variably saturated and unsaturated conditions hydrus which was developed as a soil physics model uses richards equation a collection of equations van genuchten mualem modified van genuchten brooks corey and kosugi are proposed to estimate the k θ required in richards equation to populate these equations the soil routine rosetta was used to determine the water retention parameters used in the van genuchten flow equations from easily determined soil textures although this method does not directly measure k θ this built in function makes the model more accessible by reducing the soil input requirements gifmod also offers a suite of relationships to describe interactions between blocks that represent different soil or storage components infiltration can only be calculated with richards equation which is the most comprehensive method but requires complex inputs then percolation through subsurface layers is estimated by the van genuchten mualem unsaturated hydraulic conductivity or darcy flow in saturated conditions drainmod urban uses the green ampt approximation of richards equation for infiltration through all bioretention cell layers but utilizes a user defined swcc to account for soil moisture changes in a bioretention cell especially those with an iws zone when the water table is close to the surface brown et al 2013 emphasized the importance of the soil moisture changes with respect to the internal water level by comparing the water content using the swcc to more common methods of assuming the difference between saturation and field capacity this study highlighted extremely large percent differences of water content 6017 to 14 as the water level rose closer to the surface therefore the swcc is an important parameter to use in determining infiltration through bioretention systems since the water level is often near the surface recarga uses the green ampt equation with ponding for infiltration of runoff into the soil surface then the unsaturated hydraulic conductivity calculated with the van genuchten equation determines the flow through each of the three soil layers root zone storage zone and native soil zone if the underlying layer is saturated the model corrects the infiltration drainage by using the limiting hydraulic conductivity plus underdrain flow if present a model recharge similar to the recarga model but using richards equation was shown to have comparable recharge exfiltration to recarga under varying design parameters indicating that green ampt can still approximate infiltration to a sufficient level dussaillant et al 2003 swmm offers a wide variety infiltration options in subcatchments horton s method the green ampt method and the scs cn method but for the lid module a modified green ampt is used it was adjusted to account for ponding depth which is normally ignored in the green ampt equation but is relevant to bioretention infiltration swmm uses darcy s law to simulate percolation through subsequent soil layers in the bioretention cell this is applied in the same manner as swmm s groundwater routine using the hydraulic conductivity slope hco to describe the exponential decrease in hydraulic conductivity with decreasing moisture content rossman and huber 2016b this hco parameter is generally estimated based on soil texture but guidance in swmm suggests a range much larger than the hco used in other bioretention studies lynn et al 2018 liu and fassman beck 2017 instead of using a soil accounting method like drainmod urban swmm assumes all soil moisture is evenly distributed throughout the soil layer and soil matric forces are ignored such that the entire system acts as a simple storage reservoir rossman and huber 2016b lastly music uses a simple bucket model to develop infiltration equations based on the total available volume in each layer and a mass balance of the fluxes within a bioretention cell the infiltration from the ponded zone into the soil layer is the minimum of the available water inflow ponded water overflow potential infiltration the volume of water leaving the soil layer and soil capacity the volume available in the soil at a given moisture content the infiltration rate within the soil media is simply the change in moisture content times the soil capacity total volume of the soil media times the porosity to consider the fluxes to other components of the bioretention cell the et and seepage to the storage layer are subtracted from this infiltration rate additionally a side flow coefficient was added to account for lateral flow from the soil layer into surrounding soils which improved infiltration predictions browne et al 2013 3 1 3 outflow two important considerations for modeled outflow are underdrain configurations and iws zones the inclusion of these features comes in many forms gifmod models underdrain flow as simple pipe flow from the storage layer using the hazen williams equation hydrus models the underdrain as its own highly permeable soil layer that is constrained by a tile drainage boundary condition although recarga can calculate underdrain flow with an orifice equation the underdrain can only be placed between the root zone and storage zone this configuration does not allow for an iws zone using an upturned elbow in the underdrain nor does it accommodate other restrictions to the underdrain such as valves orifice plates weirs etc music allows users to indicate use of an underdrain and if present an iws zone and its depth for an underdrain music calculates drainage using an orifice equation when the water level in the bioretention cell is greater than the height of the drainpipe similarly drainage with an iws zone is only calculated when the internal water level is above the invert of the elbow outlet swmm includes underdrains as an optional function in the bioretention cell lid control editor swmm models flow through the underdrain with a simple empirical power law weir equation unless the maximum drainage limit is reached the user defines the offset height of the underdrain to allow for a storage layer underneath the pipe although iws zones cannot be modeled in the lid module a recent study suggested a method of using the traditional swmm framework to model a bioretention cell with an iws zone lynn et al 2018 swmm does consider other restrictions on flow with orifice or weir equations defined by the drainage coefficient and drainage exponent set by the user because the original drainmod was developed as an agricultural drainage model drainmod urban is one of the best models for both underdrains and iws configurations drainmod urban uses the hooghoudt drainage equation when the internal water table is below the surface and corrects for convergence of flow near the drains using the moody equations when the soil profile is saturated and there is ponding on the soil surface the kirkham equation is used to calculate the drainage rate drainmod urban is the only model that by default models multiple drainage pipes it also provides a drainage coefficient for flow limited by pipes or outlet structures drainmod urban provides a controlled drainage design option that has been shown to accurately model drawdown as drainmod in a bioretention cell with an iws zone during the growing season but during the dormant season when water tables rise due to reduced et drawdown was slower than predicted rates brown et al 2013 this is one of few studies that has evaluated the model performance for an iws zone 3 1 4 overflow in general all models predict overflow when the ponding depth exceeds the depression storage depth drainmod urban recarga and swmm use a simple surface water balance to account for change in storage of the ponding zone drainmod urban specifically uses the swcc to recalculate the water level in the cell at each time step and determine if the maximum ponding depth has been reached swmm includes a ponding zone denoted berm height in the lid module for bioretention but also includes a vegetation volume fraction to account for the space that vegetation occupies in the ponding zone overflow when the ponding zone is full is modeled with a surface layer water balance as the precipitation and inflow minus infiltration and evapotranspiration at the surface this is calculated in the model as the water level above a maximum freeboard for each given time step hydrus uses a seepage face boundary condition to model water leaving the saturated zone as overland flow in gifmod the ponding zone is modeled as a separate block with a constant head storage relationship runoff from the ponding zone can then be routed to another block as overland flow music uses a simple weir equation to describe flow from the ponding zone after reaching the designated berm height 3 1 5 exfiltration in recarga the underlying soil is considered as an additional soil layer such that exfiltration is quantified in the water balance at each time step using the unsaturated hydraulic conductivity calculated with the van genuchten equation hydrus also uses the unsaturated hydraulic conductivity from the van genuchten mualem modified van genuchten brooks corey or kosugi methods to govern seepage into the surrounding soils drainmod urban uses a vertical seepage function that incorporates darcy s law with the dupuit forchheimer assumptions to describe the flow from the storage layer into the surrounding soil the model inputs include seepage parameters such as piezometric head of the aquifer depth to the impermeable layer and vertical conductivity of the restricting layer which are often used as calibration parameters since they are difficult to measure likewise darcy s law is used in gifmod to simulate flow from the bioretention media into the gravel layer and subsequent native soils in swmm and music the exfiltration from the bottom of the storage layer into the surrounding native soil is simply set to a user supplied saturated hydraulic conductivity of the native soil 3 1 6 evapotranspiration evapotranspiration et is difficult to model and the most accurate equations require a large number measured meteorological parameters consequently methods employed in bioretention models vary widely studies have shown et makes up approximately 5 20 of the bioretention cell water balance with higher et found in bioretention cells with an iws zone winston et al 2016 wadzuk et al 2015 brown et al 2013 li et al 2009 however understanding et dynamics in bioretention cells is important since vegetation is incorporated specifically for increased water storage and removal in addition to water quality benefits in recarga the regional average hourly et was used to calculate the available initial abstraction in the impervious surface runoff for the bioretention cell itself a function of the user input hourly potential evapotranspiration pet and the plant available water was used to calculate et from the rooting zone recarga outputs a synopsis of plant survivability which includes details for each time the rooting zone is saturated or permanent wilting point is reached each time there is ponding and each overflow event the ponding time is included because plant survivability is expected to decrease if ponded over 24 h atchison et al 2006 swmm has many methods constant value monthly averages daily values from external climate file daily values computed from daily temperatures and daily user defined times series available to calculate evaporation for overland flow where plant transpiration is negligible surface et in the lid module is calculated by incorporating a user defined daily pet input and ponding depth over time into a function for the evaporation from the surface in the soil layer the et used is the minimum of the remaining pet and the et calculated by a function of moisture content above wilting point and the water level the et can also be calculated for the storage layer when the soil layer is unsaturated both the soil and storage et are set to zero when surface infiltration is occurring similarly music calculates the et at a daily time step but disaggregated to the user specified time step down to 6 min from the surface and soil layers separately the evaporation at the surface is calculated without considering transpiration from plants this is added to the et from the soil layers which is dependent on soil moisture and water availability when the soil moisture is above wilting point but vegetation still experiences water stress the pet is limited by water availability if the water availability is not limiting the et is set equal to the pet these et equations were based on a column study using the carex appressa plant commonly used in bioretention systems in australia in music plant survivability is considered in relation to the iws zone and nutrient uptake for water quality vegetation is considered to be effective or non effective vegetation in relation to nutrient uptake which is commonly associated with root depth ewater 2013 in drainmod urban the thornthwaite method is the default et method due to its simple input requirements daily maximum and minimum temperatures heat index and latitude monthly adjustment factors can also be applied to better calibrate the et to a specific region additionally a user defined daily pet can be entered to allow flexibility in the pet calculation method daily et is distributed between 6 00 and 18 00 and pet is set to zero during rainfall et occurs in the root zone which is an input parameter for drainmod urban that can be adjusted monthly to account for seasonality in drainmod urban the pet is used to represent the et from the system when the soil water is not limiting if the et is limited by the soil water conditions such as when the soil moisture in the root zone is below the permanent wilting point then et is equal to the upward flux of water as a function of the water table depth which is determined from the swcc soil input when this upward flux is not enough to meet the et demand water is removed from the root zone gifmod has the largest number of programmed options for calculating pet within the model including an aerodynamic model for evaporation priestly taylor penman and user defined methods massoudieh et al 2017 gifmod also has two transpiration models that limit transpiration either by soil moisture or soil matric potential the water uptake from plants can be modeled with the fao 56 model or another model that considers field capacity wilting point and soil suction proposed by li et al 2001 hydrus uses atmospheric boundary conditions to account for release of water through evaporation in the ponding zone the water uptake can be described as function of a critical water stress above which the water uptake in stressed parts of the root zone can be compensated by uptake in other parts of the root zone to find the actual rate of water uptake a water stress response function by feddes et al 1978 or van genuchten 1985 can be used to reduce the potential root water uptake water uptake is assumed to be zero when the soil is saturated and when it is below wilting point in hydrus maximum rooting depth is entered by the user and in hydrus 2d 3d the maximum rooting radius is used to consider lateral spread of roots šejna et al 2014 hydrus also accounts for plant growth in et calculations using the plant height and root depth meng et al 2014 found that et volume increased with plant height 3 2 model inputs outputs as the level of model complexity increases so does the quantity and complexity of inputs an ideal model has a balance of assumptions and simplifications in governing equations and intricate input parameters that require more time and effort from users modelers must be aware of the sensitivity of bioretention models to certain parameters particularly soil inputs as well as the level of detail required for the modeling application for example atchison et al 2006 recommends performing infiltration tests on underlying soils for a detailed final design but for preliminary design applications the soil hydraulic conductivity can be estimated based on soil texture in recarga and swmm default values for soil properties based on soil texture from rawls et al 1998 are provided in the case that measured values are unavailable similarly music provides estimations for soil inputs based on melbourne and brisbane soils imteaz et al 2013 all model inputs and outputs are reported in table c 1 to provide readers with an initial step in model selection based on the availability of required input parameters for a given site and the outputs of interest previous model sensitivity studies have found soil parameters to have a significant impact on model performance fassman beck and saleh 2021 nichols et al 2021 leimgruber et al 2018 avellaneda et al 2017 stewart et al 2017 rosa et al 2015 gagrani et al 2014 dotto et al 2011 sun et al 2011 therefore the soil parameters required in each model will be compared here all models require the saturated hydraulic conductivity ksat and seepage rate as the most simplistic representation of infiltration and outflow from the bioretention cell soil moisture properties are used in the infiltration and percolation equations to determine better estimations of the flow through the bioretention cell see sections 3 1 2 the swcc is the best characterization of soil moisture changes because it provides a curve of soil moisture with respect to soil suction however only the models that use richard s equation gifmod and hydrus and drainmod urban use this method for soil water accounting other models that use green ampt infiltration recarga and swmm require the initial soil moisture and other common soil moisture properties such as porosity field capacity and wilting point these values are often estimated from soil texture as mentioned above recarga hydrus and gifmod offer soil parameter estimation for the k θ from the van genutchen equation hydrus also offers brooks corey kosugi and a modified van genuchten function as options for estimating soil moisture accounting parameters k θ and swcc gifmod has the most unique inputs for soil moisture accounting by calculating soil properties and flow through various block types saturated soil unsaturated soil storage etc with two pre defined soil water relationships head storage and head flow functions in terms of outputs all models reviewed produced hydrographs and summary reports of cumulative volumes for each water balance component in the bioretention cell hydrus music and swmm also describe characteristics of the hydrographs such as time to peak peak flow rate and duration in the result summaries these hydrograph characteristics can be found in time series outputs from drainmod urban and gifmod although hourly flows in recarga can still be used to create hydrographs it may not accurately capture peak flows 4 recommendations for bioretention model selection the previous sections have emphasized the diversity of internal processes among six bioretention models but how does one choose which model is appropriate for a desired application this section highlights some key considerations for selecting a bioretention model including 1 the flexibility of the model structure 2 the flux of greatest concern or interest and 3 the required inputs and the desired outputs for a model flexibility in model structure allows users to adapt the model to better represent the design of a specific bioretention cell such as those with unique drainage systems or the characteristic hydrology of a catchment one study emphasized the level to which three different model structures represent the characteristic hydrologic signature of the catchment using the model music hamel and fletcher 2014b it also validated the assertion by clark et al 2011 that more complex structures in conceptual models often are better at representing the physical features of a system in swmm the catchment that contains lid practices can be represented in many ways providing flexibility to the user but the representation of bioretention through the lid control is still somewhat rigid gifmod was developed such that the user could build a flexible model structure composed of interconnected blocks this flexibility allows users to produce a gifmod model that represents a single bioretention cell or a set of bioretention cells at a catchment scale because the model structure can be represented in multiple forms it can be compared or coupled with a wider variety of bioretention models the modeler should also consider which fluxes are of most importance in a proposed modeling study prior to choosing a model this review showed a significant difference in how bioretention models approach infiltration at the surface and flow through the bioretention media table 3 there are also a wide variety of capabilities regarding drainage configurations and calculations although the water balance components described in section 3 1 above work interdependently some models show greater capability for one flux over another table 3 the model structure and emphasis on specific fluxes can be inferred from the model s initial use for example drainmod urban was first an agricultural drainage model therefore it has much more complex equations for drainage compared to other bioretention models and can be used when underdrain flow is meaningful to the study likewise hydrus was developed as a soil physics model and therefore puts more emphasis on fluxes through the soil column in a bioretention cell this would be beneficial when investigating soil moisture changes within a bioretention cell nichols et al 2021 stewart et al 2017 recarga was built for representing rain gardens specifically which tend to be smaller less engineered systems that promote exfiltration and has been previously used to estimate exfiltration that could lead to groundwater recharge montgomery et al 2010 dussaillant et al 2003 finally model inputs and outputs are discussed in this review section 3 2 and appendix c because they demonstrate the value of practicality in model selection the available field data may determine the model choice based on required inputs outputs or the lack of field data may prioritize a model with good performance when uncalibrated the increase in model complexity introduces more input parameters that not only multiply the effort of model setup but also insert uncertainty in model parameterization the resolution of outputs required by a model varies greatly with application lisenbee et al 2020 for example cso mitigation or treatment train evaluation may require more detailed timing of drainage and overflow fassman beck and saleh 2021 stewart et al 2017 5 assessment of needs for bioretention modeling this review unveiled several improvements to bioretention modeling to be considered in future modeling efforts few models account for aboveground vegetation growth and root growth which can increase et hydrus is the only model evaluated that includes plant growth in its et calculation the only other model that acknowledges aboveground effect of plants is swmm which accounts for the space plants take up in the ponding zone with its vegetation volume fraction however this is a constant rate that does not account for plant growth over the simulation period the rooting depth of plants is incorporated in many models water uptake procedures but this is also often a constant value only hydrus accounts for the spatial extent of the root zone both longitudinally and laterally but that area does not change over time as roots grow drainmod urban can incorporate seasonal root growth with monthly rooting depths but this is repeated for each year in the simulation so that growth from one year to the next is overlooked many field and lab studies have shown effects of vegetation on infiltration through creation of macropores tang et al 2015 meng et al 2014 paus et al 2014 jenkins et al 2010 emerson and traver 2008 vegetation can lead to infiltration rates several orders of magnitude higher than predicted solely by associated soil properties lucas 2010 meng et al 2014 notes that although hydrus incorporates plant growth in the model there is no ability to simulate the effect of plants on soil permeability due to macropores in hydrus 1d however hydrus 2d 3d has a supplemental dual porosity module that could account for macropores although this has yet to be used in a bioretention study nichols et al 2021 while macropores increase infiltration clogging of soil pore space due to fine particle accumulation can decrease infiltration le coustumer et al 2012 li and davis 2008 hsieh et al 2007 swmm is the only model that accounts for clogging with a user specified constant clogging rate infiltration parameters also have been shown to vary seasonally due to plant growth or dormancy temperature changes and snow events nichols et al 2021 emerson and traver 2008 muthanna et al 2008 braga et al 2007 despite this evidence none of the models allow for temporal variation of the ksat and other soil properties soil properties play an important role in the soil moisture dynamics of bioretention cells which affects the infiltration percolation and other hydrologic flow paths drainmod urban gifmod and hydrus require the swcc which provides information on soil moisture properties of the bioretention media other models suggest estimations of soil moisture properties such as porosity field capacity and wilting point based on soil texture from experimental studies such as rawls et al 1998 used in recarga or rawls et al 1983 used in swmm however measured soil attributes have large variability even across similar soil textures due to land cover compaction macropores temperature etc saturated hydraulic conductivity has been shown to vary widely up to three orders of magnitude with associated high skewness from various studies garcia gutierrez et al 2018 papanicolaou et al 2015 gwenzi et al 2011 warrick and nielsen 1980 further study of default values for a given soil textural class and measured values of soil properties in bioretention modeling would provide valuable information on model sensitivity to soil parameters both iws zones and underdrains are oversimplified and underrepresented in most of the models evaluated underdrains are commonly applied in bioretention field studies and some states require iws zones for bioretention north carolina department of enviromental quality 2009 ohio department of natural resources 2006 these configurations must be included in modeling approaches for the model to adequately represent the bioretention hydraulics also most models had simplistic drainage equations and only considered a single underdrain drainmod urban is the only model that accounts for multiple drains using drainage equations commonly applied to poorly drained agricultural soils exfiltration from the bioretention cell to native soils can be improved in some models that assume a constant rate such as the saturated hydraulic conductivity darcy s law is an improvement in some models but considering unsaturated flow is even more advanced also a benefit of the iws zone is to increase the exfiltration into surrounding soils by slowing the flow of water through the underdrain most models are incapable of modeling iws zones and therefore may overestimate drainage and underestimate exfiltration accurate estimation of exfiltration is important for emerging studies on the influence of bioretention on groundwater some studies have tried to adapt models like hydrocad and swmm to account for groundwater recharge and others assume all exfiltration becomes recharge but there is still much to learn about the effects of bioretention and other infiltration devices on groundwater to inform models tu et al 2020 kim et al 2019 bonneau et al 2018 zhang and chui 2017 2018 zhang et al 2018a stewart et al 2017 machusick et al 2011 barbu et al 2009 many models fail to account for the changing hydraulic gradient of the groundwater table and how it affects the seepage rate from the bioretention cell of the models in this paper drainmod urban and hydrus have these capabilities more studies need to be conducted using measured field data for calibration and validation of these models many studies use these models as planning tools but model performance must be validated with field studies to assure that uncalibrated model simulations provide realistic estimations for preliminary designs furthermore models that assess lumped bioretention outflows at the catchment scale could show good performance of total runoff reduction but if the flow dynamics are important to the modeling application outflow hydrographs from individual bioretention cells must also be calibrated fassman beck and saleh 2021 lisenbee et al 2020 water quality features of the models in this review were not evaluated but the assessment of model hydrology is a step toward improved water quality predictions improved modeling of bioretention cell hydrology can lead to improvement in water quality pollutant loadings the contaminant transport nutrient transformation and biological activity within bioretention cells are important to the quality of water reaching downstream catchments and other lid controls but often these processes are secondary to load reductions caused a decrease in runoff volumes nevertheless investigation into the water quality processes of bioretention models is an area for further research 6 conclusions this review served to unveil the black box of hydrologic processes in common bioretention models and identify improvements in the field of bioretention modeling two relatively new models were among the models analyzed drainmod urban 2020 and gifmod 2017 conversely swmm music and recarga have been used in many studies hydrus has been used in fewer studies perhaps due to model complexity all these models meet the first two attributes for hydrologic modeling for bioretention continuous long term simulation and sub hourly time steps as small as 1 min time steps available in all models except recarga and music spatial distribution of the models varies both catchment models and site scale models are represented downsides of the site scale are neglecting conveyance time of runoff from the drainage area to the bioretention cell and inability to route outflows to other catchments sewer systems or lid components downstream richards equation is suggested as the most advanced physical representation of infiltration through the bioretention cell but it is only used in hydrus and gifmod due to difficulty obtaining required input parameters a simplification of richards equation green ampt is used by other models but it makes assumptions that are not always applicable to the variably saturated nature of bioretention cells therefore modified green ampt equations have been used in models such as swmm and recarga that account for the ponding depth drainmod urban uses green ampt but also accounts for variable moisture content in the cell through use of the swcc gifmod hydrus and recarga use the van genuchten approximation for the unsaturated hydraulic conductivity to account for percolation through the subsoil layers despite meticulous percolation procedures these three models still lack the ability to model iws zones in a typical upturned elbow configuration with hydrus and recarga even more limited in underdrain configurations drainmod urban is the most comprehensive drainage model and therefore models both iws and underdrain components well music also explicitly models both underdrains and iws zones some improvements suggested for bioretention modeling based on this review are the incorporation of vegetation growth and root growth over time temporal variation of soil properties the validity of soil parameters estimation and customization of drainage configurations groundwater and water quality analysis are two important topics of investigation regarding bioretention that were not covered in this review but research is ongoing further calibration and validation of the models with measured field data will improve confidence in model performance for bioretention applications quality empirical data of all bioretention fluxes would also be useful in model comparison studies to understand how the different model processes described in this review affect model outputs and ultimately how model performance compares across models catchment scale models must be evaluated on how they represent individual bioretention cells to understand how the flow dynamics will interact with other catchment components these improvements in process based bioretention modeling will lead to better prediction of bioretention behavior author contributions w l literature review conception reviewed literature and designed review process wrote manuscript j h edited manuscript provided guidance on content m b edited manuscript provided guidance on content t f edited manuscript provided guidance on content declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements funding for this research was provided by the national science foundation grant no 1553475 appendices appendix a for bioretention hydrology and water quality studies volumetric reductions brown r a and hunt w f 2011a impacts of media depth on effluent water quality and hydrologic performance of undersized bioretention cells journal of irrigation and drainage engineering 137 3 132 143 https doi org 10 1061 asce ir 1943 4774 0000167 brown r a and hunt w f 2012 improving bioretention biofiltration performance with restorative maintenance water science and technology 65 2 361 367 https doi org 10 2166 wst 2012 860 davis a p 2008 field performance of bioretention hydrology impacts journal of hydrologic engineering 13 2 90 95 https doi org 10 1061 asce 1084 0699 2008 13 2 90 davis a p traver r g hunt w f lee r brown r a and olszewski j m 2012 hydrologic performance of bioretention storm water control measures journal of hydrologic engineering 17 5 604 614 https doi org 10 1061 asce he 1943 5584 0000467 hunt w f jarrett a r smith j t and sharkey l j 2006 evaluating bioretention hydrology and nutrient removal at three field sites in north carolina journal of irrigation and drainage engineering 132 6 600 608 https doi org 10 1061 asce 0733 9437 2006 132 6 600 olszewski j m and davis a p 2013 comparing the hydrologic performance of a bioretention cell with predevelopment values journal of irrigation and drainage engineering 139 2 124 130 https doi org 10 1061 asce ir 1943 4774 0000504 water quality improvement brown r a and hunt w f 2011b underdrain configuration to enhance bioretention exfiltration to reduce pollutant loads journal of environmental engineering asce 137 11 1082 1091 https doi org 10 1061 asce ee 1943 7870 0000437 chapman c and horner r r 2010 performance assessment of a street drainage bioretention system water environment research 82 2 109 119 https doi org 10 2175 106143009x426112 ergas s j sengupta s siege r pandit a yao y f and yuan x 2010 performance of nitrogen removing bioretention systems for control of agricultural runoff journal of environmental engineering asce 136 10 1105 1112 https doi org 10 1061 asce ee 1943 7870 0000243 kluge b markert a facklam m sommer h kaiser m pallasch m and wessolek g 2018 metal accumulation and hydraulic performance of bioretention systems after long term operation journal of soils and sediments 18 2 431 441 https doi org 10 1007 s11368 016 1533 z li h and davis a p 2008a urban particle capture in bioretention media i laboratory and field studies journal of environmental engineering asce 134 6 409 418 https doi org 10 1061 asce 0733 9372 2008 134 6 409 li h and davis a p 2009 water quality improvement through reductions of pollutant loads using bioretention journal of environmental engineering 135 8 567 576 https doi org 10 1061 asce ee 1943 7870 0000026 lucke t dierkes c and boogaard f 2017 investigation into the long term stormwater pollution removal efficiency of bioretention systems water science and technology 76 8 2133 2139 https doi org 10 2166 wst 2017 382 davis a p 2007 field performance of bioretention water quality environmental engineering science 24 8 1048 1064 https doi org 10 1089 ees 2006 0190 hunt w f kannan n jeong j and gassman p w 2009 stormwater best management practices review of current practices and potential incorporation in swat international agricultural engineering journal 18 1 2 73 89 hunt w f smith j t jadlocki s j hathaway j m and eubanks p r 2008 pollutant removal and peak flow mitigation by a bioretention cell in urban charlotte nc journal of environmental engineering asce 134 5 403 408 https doi org 10 1061 asce 0733 9372 2008 134 5 403 wan z x li t and liu y t 2018 effective nitrogen removal during different periods of a field scale bioretention system environmental science and pollution research 25 18 17 855 17861 https doi org 10 1007 s11356 018 1954 x wang j chua l h c and shanahan p 2017 evaluation of pollutant removal efficiency of a bioretention basin and implications for stormwater management in tropical cities environmental science water research technology 3 1 78 91 yang x h mei y he j jiang r li y q and li j q 2014 comprehensive assessment for removing multiple pollutants by plants in bioretention systems chinese science bulletin 59 13 1446 1453 https doi org 10 1007 s11434 014 0200 2 field studies al ameri m hatt b le coustumer s fletcher t payne e and deletic a 2018 accumulation of heavy metals in stormwater bioretention media a field study of temporal and spatial variation journal of hydrology 567 721 731 brown r a birgand f and hunt w f 2013a analysis of consecutive events for nutrient and sediment treatment in field monitored bioretention cells water air and soil pollution 224 6 https doi org artn 158110 1007 s11270 013 1581 6 brown r a and hunt w f 2010 impacts of construction activity on bioretention performance journal of hydrologic engineering 15 6 386 394 https doi org 10 1061 asce he 1943 5584 0000165 brown r a and hunt w f 2011a impacts of media depth on effluent water quality and hydrologic performance of undersized bioretention cells journal of irrigation and drainage engineering 137 3 132 143 https doi org 10 1061 asce ir 1943 4774 0000167 davis a p 2008 field performance of bioretention hydrology impacts journal of hydrologic engineering 13 2 90 95 https doi org 10 1061 asce 1084 0699 2008 13 2 90 hsieh c h and davis a p 2005 multiple event study of bioretention for treatment of urban storm water runoff water science and technology 51 3 4 177 181 go to isi wos 000228827100023 hunt w f jarrett a r smith j t and sharkey l j 2006 evaluating bioretention hydrology and nutrient removal at three field sites in north carolina journal of irrigation and drainage engineering 132 6 600 608 https doi org 10 1061 asce 0733 9437 2006 132 6 600 jiang c b li j k li h e li y j and chen l 2017 field performance of bioretention systems for runoff quantity regulation and pollutant removal water air and soil pollution 228 12 https doi org artn 46810 1007 s11270 017 3636 6 komlos j and traver r g 2012 long term orthophosphate removal in a field scale storm water bioinfiltration rain garden journal of environmental engineering 138 10 991 998 https doi org 10 1061 asce ee 1943 7870 0000566 li h sharkey l j hunt w f and davis a p 2009 mitigation of impervious surface hydrology using bioretention in north carolina and maryland journal of hydrologic engineering 14 4 407 415 https doi org 10 1061 asce 1084 0699 2009 14 4 407 line d e and hunt w f 2009 performance of a bioretention area and a level spreader grass filter strip at two highway sites in north carolina journal of irrigation and drainage engineering 135 2 217 224 https doi org 10 1061 asce 0733 9437 2009 135 2 217 lopez e v lynn t j peterson m ergas s j trotz m a and mihelcic j r 2016 enhanced nutrient management of stormwater through a field demonstration of nitrogen removal in a modified bioretention system world environmental and water resources congress 2016 environmental sustainability groundwater hydraulic fracturing and water distribution systems analysis 60 69 go to isi wos 000389439700007 lucke t and nichols p w b 2015 the pollution removal and stormwater reduction performance of street side bioretention basins after ten years in operation science of the total environment 536 784 792 https doi org 10 1016 j scitotenv 2015 07 142 paus k h morgan j gulliver j s leiknes t and hozalski r m 2014 assessment of the hydraulic and toxic metal removal capacities of bioretention cells after 2 8 years of service water air and soil pollution 225 1 https doi org artn 180310 1007 s11270 013 1803 y wan z x li t and liu y t 2018 effective nitrogen removal during different periods of a field scale bioretention system environmental science and pollution research 25 18 17 855 17861 https doi org 10 1007 s11356 018 1954 x laboratory mesocosm studies goh h w zakaria n a lau t l foo k y chang c k and leow c s 2017 mesocosm study of enhanced bioretention media in treating nutrient rich stormwater for mixed development area urban water journal 14 2 134 142 good j f o sullivan a d wicke d and cochrane t a 2012 contaminant removal and hydraulic conductivity of laboratory rain garden systems for stormwater treatment water science and technology 65 12 2154 2161 https doi org 10 2166 wst 2012 135 hsieh c h davis a p and needelman b a 2007a bioretention column studies of phosphorus removal from urban stormwater runoff water environment research 79 2 177 184 https doi org 10 2175 106143006x111745 hsieh c h davis a p and needelman b a 2007b nitrogen removal from urban stormwater runoff through layered bioretention columns water environment research 79 12 2404 2411 https doi org 10 2175 106143007x183844 li h and davis a p 2008a urban particle capture in bioretention media i laboratory and field studies journal of environmental engineering asce 134 6 409 418 https doi org 10 1061 asce 0733 9372 2008 134 6 409 liu r f and fassman beck e 2017 hydrologic experiments and modeling of two laboratory bioretention systems under different boundary conditions frontiers of environmental science engineering 11 4 https doi org artn 10 101007 s11783 017 0951 5 liu j sample d j owen j s li j l and evanylo g 2014b assessment of selected bioretention blends for nutrient retention using mesocosm experiments journal of environmental quality 43 5 1754 1763 https doi org 10 2134 jeq2014 01 0017 lucas w c and greenway m 2008 nutrient retention in vegetated and nonvegetated bioretention mesocosms journal of irrigation and drainage engineering 134 5 613 623 https doi org 10 1061 asce 0733 9437 2008 134 5 613 lucas w c and greenway m 2011a hydraulic response and nitrogen retention in bioretention mesocosms with regulated outlets part i hydraulic response water environment research 83 8 692 702 https doi org 10 2175 106143010x12780288628697 lucas w c and greenway m 2011b hydraulic response and nitrogen retention in bioretention mesocosms with regulated outlets part ii nitrogen retention water environment research 83 8 703 713 https doi org 10 2175 106143011x12989211840936 lucas w c and greenway m 2011c phosphorus retention by bioretention mesocosms using media formulated for phosphorus sorption response to accelerated loads journal of irrigation and drainage engineering 137 3 144 153 https doi org 10 1061 asce ir 1943 4774 0000243 palmer e t poor c j hinman c and stark j d 2013 nitrate and phosphate removal through enhanced bioretention media mesocosm study water environment research 85 9 823 832 https doi org 10 2175 106143013x13736496908997 payne e g i fletcher t d russell d g grace m r cavagnaro t r evrard v deletic a hatt b e and cook p l m 2014 temporary storage or permanent removal the division of nitrogen between biotic assimilation and denitrification in stormwater biofiltration systems plos one 9 3 https doi org artne90890 10 1371 journal pone 0090 890 ray c bezak b petrey k and shea e 2015 measurement and optimization of permeability in bioretention soil media lid it works in all climates and soils 176 185 go to isi wos 000381031400018 stander e k and borst m 2010 hydraulic test of a bioretention media carbon amendment journal of hydrologic engineering 15 6 531 536 https doi org 10 1061 asce he 1943 5584 0000133 wadzuk b m hickman j m and traver r g 2015 understanding the role of evapotranspiration in bioretention mesocosm study journal of sustainable water in the built environment 1 2 https doi org artn 0401400210 1061 jswbay 0000794 wang m zhang d q li y hou q h yu y y qi j d fu w c dong j w and cheng y n 2018 effect of a submerged zone and carbon source on nutrient and metal removal for stormwater by bioretention cells water 10 11 https doi org artn 162910 3390 w10111629 appendix b model descriptions applications and previous studies b 1 planning assessment tools several models have been created as planning tools for a quick assessment of the effect of bioretention cells in a catchment generally these models require minimal expertise or training by users which makes them popular options for initial assessment of a site these models do not simulate hydrological processes within the bioretention cells but instead use lumped parameters for a general estimation of the runoff reduction potential water quality and cost benefit analysis to support decision making for example the center for neighborhood technology describes the green values national stormwater calculator as a first approximation of the hydrologic and financial conditions for a site green values stormwater calculator methodology 2007 similarly the u s environmental protection agency epa national stormwater management calculator is a simplified version of swmm that only considers overland flow infiltration and evaporation with the main goal of assessing if developers meet certain stormwater retention targets rossman and bernagros 2018 the u s epa also developed the system for urban stormwater treatment and analysis integration sustain for the placement of lid practices within a catchment while also optimizing cost and water quantity and quality performance sustain combined many algorithms from other lid models including swmm but only certain criteria were used in the optimization modules some case studies have demonstrated model setup and calibration in locations across the united states king county wa kansas city mo louisville ky and albuquerque nm and china mao et al 2017 shoemaker et al 2011 2013 lee et al 2012 degasperi 2009 other models that provide quick assessment of hydrology and water quality benefits of lid practices including bioretention are l thia lid long term hydrologic impact analysis developed by purdue university as a web based tool for long term hydrologic assessment lid practices wbm water balance model created as an online tool for scenario comparison and uem urban ecohydrological model which is a lumped parameter model that aggregates all bioretention cells in a watershed to a single parameter to evaluate ecological and stream health associated with bioretention design scenarios water balance model powered by qualhymo technical manual 2019 wright et al 2018 l thia low impact development spreadsheet 2015 lastly some models listed put more emphasis on water quality such as ideal integrated design evaluation and assessment of loadings which was developed to predict water quality improvement from lid ideal can produce detailed outputs of each bioretention cell such as hydrographs sedigraphs chemigraphs and pollutographs alexander et al 2011 winslamm source loading and management model was designed to provide simple pollutant mass discharges and runoff volumes for a variety of stormwater control practices and development scenarios pitt and voorhees 2004 winslamm also has a large focus on water quality because it emphasizes small storm hydrology better for water quality analysis and particulate washoff b 2 process based computational models b 2 1 drainmod drainmod was originally developed as a long term continuous simulation water management model to simulate poorly or artificially drained agricultural soils bioretention cells with high internal water tables during storm events behave similarly to these agricultural fields and drain through porous underdrain pipes like soil tile drains furthermore this model uses the soil water characteristic curve swcc so that the effect of soil moisture in the bioretention cell profile between storm events can be considered in soil water processes that make up the water balance this is also one of few models with the capability to model the iws or submerged zone applied in some bioretention cells brown et al 2013 was the first to apply this model to four bioretention cells in north carolina with good calibration of inflow drainage and overflow nash sutcliffe efficiency nse 0 71 in 2014 the north carolina cells were modeled under changing climate conditions hathaway et al 2014 winston 2015 also tested drainmod on three more bioretention cells in ohio which maintained good agreement with measured volumes for each water balance component nse 0 71 it should be noted that these models were run at a low temporal resolution of daily or hourly time steps with outputs summarized for daily monthly and yearly totals b 2 2 drainmod urban although drainmod was shown to be an effective model for bioretention cells when calculating volumes of water balance components it could only produce daily outputs as the smallest time step therefore drainmod was unable to output hydrographs to examine peak flow rates and allow for integration with other catchment models to better represent the flashy nature of urban hydrology drainmod was updated to accept inputs and produce outputs at as small as 1 min intervals this updated model was termed drainmod urban lisenbee et al 2020 showed that drainmod simulations performed by winston 2015 did not represent measured drainage hydrographs well even if volumes were well calibrated drainmod urban was then calibrated to better represent measured drainage hydrographs results showed good agreement of the model nse 0 60 especially considering the high resolution output 1 min intervals drainmod urban has also been compared to swmm and evaluated using pedotransfer functions to substitute for required soil properties in the model lisenbee 2020 b 2 3 gifmod the gi flexible model gifmod was developed as a continuous process based model that is flexible in that it can be applied to a wide range of gi practices and allows the user to define the structure and complexity of the model the structure is composed of a series of blocks connected by interfaces that represent each component of the gi system soil layer stream segment or storage a water balance is conducted on each of these blocks at a sub hourly time step and the interfaces between blocks are governed by several provided equations the three main mechanisms of this model include hydraulics particle colloid transport and dissolved or particle bound contaminant transport massoudieh and aflak 2017 the hydraulics component can simulate flow through storage layers or structures porous media under saturated and unsaturated conditions pipe flow overland flow and et gifmod allows for user defined head storage and head flow relationships as well as predefined relationships for each block type for soil blocks this function can be populated by default or user input soil parameter values massoudieh et al 2017 describes the model as applied to two bioretention cells connected in series the initial modeling results showed good model agreement for the upper rain garden nse 0 83 but reduced performance in the lower rain garden nse 0 49 however more rigorous calibration with an extended dataset was suggested by massoudieh et al 2017 this was done in a more recent study that applied a 3 year dataset to the same bioretention cells and evaluated gifmod for both hydrologic and water quality performance alikhani et al 2020 the outflow calibration showed slightly improved model performance of nse 0 86 for the upper rain garden and nse 0 68 for the lower rain garden the validation of flow for this study was done using a monte carlo analysis to show that most of the measured data fell within the 95 credible interval b 2 4 hec hms the hydrologic engineering center hydrologic modeling system hec hms was developed in 1998 as hec 1 originally by the u s army corps of engineers usace as a continuous numerical model to simulate hydrologic processes of dendritic watershed systems it is widely used in industry for planning and design in flood forecasting evaluating hydraulic conveyance and controls and erosion and sediment routing studies hydrologic modeling system hec hms user s manual 2018 heasom et al 2006 used hec hms to model the flow through a bioretention cell by replicating it as a reservoir which serves a storage capacity for flow from two sub basins representing pervious and impervious surfaces in the catchment area the reservoir bioretention basin is drained as weir flow hec hms was used to model bioretention cells in this study because it is a common hydrologic model that offers widely accepted methods for infiltration and hydraulic routing also the output hydrographs can easily be compared to measured water levels in bioretention cells however heasom et al 2006 does admit that the setup of the bioretention cell with a diversion element and further post processing of combined outflow is not straightforward another case study khaniya et al 2017 used hec hms to model a rain garden but even these authors admit to limitations of hec hms such as event simulation and limited runoff generation options b 2 5 hydrocad hydrocad is a proprietary hydrological and hydraulic model employed widely in industry lucas 2010 described how to apply hydrocad to routing outflow from many bioretention cells in a catchment to reduce combined sewer overflows cso hydrocad allows for rating curves to be applied to orifices so that the hydraulic grade line can be modeled through the bioretention cell profile lucas 2008 although hydrocad is a design storm model it was compared with a continuous simulation model swmm outflow hydrograph volumes and peak flows were compared with good agreement b 2 6 hydrus hydrus 1d is a long term continuous model that was originally developed to model flow and transport through variably saturated porous media its benefits are flexible flow boundary conditions a small calculation time step and unlimited simulation time meng et al 2014 meng et al 2014 was the first to apply hydrus 1d to two bioretention cells in beijing that had been continuously monitored for 33 artificial rainfall events and five natural rainfall events the measured infiltration rate over time was compared to the outputs of hydrus 1d for model validation following model validation design parameters were optimized with the model to evaluate performance under different conditions li et al 2018 also applied hydrus 1d to three bioretention cells for optimization of parameters such as media characteristics and thickness with good model agreement for water volume nse 0 86 0 90 additionally the two dimensional richards equation model hydrus 2d 3d was applied to a bioretention cell in ohio to calculate a mass balance of outflow evaluate subsurface water dynamics and assess model sensitivity to soil properties stewart et al 2017 this study also addressed bioretention cell effects on csos and groundwater the water levels measured from nearby wells had good agreement with the modeled water levels over the entire three year period rmsd 0 026 0 12 m the most recent study to use hydrus for bioretention modeling to address seasonal effects on rain garden performance nichols et al 2021 two seasons warm and cold were combined with two flow intensities high and low to represent potential flows year round the measured ponding depth and soil moisture in the bioretention cells were compared to those predicted by hydrus to meet the design goals of no overflow for storms smaller than the design storm and drawdown of ponding did not exceed 24 h b 2 7 mouse mike urban the model for urban sewers mouse was developed by danish institute of hydrology in 2002 the model has since been updated to mike urban which can run simulations using the mouse swmm or mike 1d engine in 2016 the newest version of mike urban updated the user interface to incorporate dedicated lid controls including bioretention for lid practices it is noted that only the mike 1d engine is used and most lid practices can be represented by a soakaway node dhi 2017 a case study on application to a rain garden is presented by li and de costa 2016 xie et al 2017 used mike urban to address multiple lid practices in a single catchment and calibrated the model using the water level at a pumping station forebay in the catchment to achieve r2 ranging from 0 87 to 0 98 b 2 8 music music is widely used by urban catchment managers primarily in australia as a model to evaluate alternative stormwater management including hydrology water quality and even economic aspects the model includes bioretention as well as a range of other stormwater control measures and is based on extensive field and laboratory studies wong et al 2002 music uses continuous simulation based on user specified time step of between 6 min and 24 h music has a large emphasis on water quality prediction as its probabilistic water quality analysis has obtained good results ewater 2013 wong et al 2006 the overland flow hydrology in music is adapted from chiew and mcmahon 1997 for smaller temporal scales the bioretention hydrology is represented by a simple bucket model but it incorporates features specific to bioretention that could impact water quality such as effective versus non effective vegetation and internal water storage zones there have been multiple calibration studies that have compared music to measured catchment runoff and water quality in catchments with bioretention or rain gardens gagrani et al 2014 hamel and fletcher 2014a 2014b imteaz et al 2013 the model performed well for runoff at 6 min to hourly intervals using multiple metrics such as the correlation coefficient r2 0 81 and r2 0 82 for calibration and validation respectively by gagrani et al 2014 and nash sutcliffe efficiency nse 0 59 0 64 hamel and fletcher 2014b nse 0 49 0 58 hamel and fletcher 2014a nse 0 49 0 81 dotto et al 2011 however water quality performance suffered in calibration studies imteaz et al 2013 dotto et al 2011 catchment scale studies have investigated model structure and sensitivity for watershed hydrology but less focus has been given to individual bioretention cells hamel and fletcher 2014b burns et al 2012 dotto et al 2011 elliott et al 2009 b 2 9 recarga recarga is a numerical model developed in matlab as a design tool to evaluate performance of bioretention cells rain gardens and infiltration trenches to meet design objectives or to understand flow behavior with varying design components atchison et al 2006 the model reports total and hourly volumes for each water balance component over the continuous or single event time period simulated the first study to use recarga compared it to a similar model recharge which used the richards equation for infiltration instead of the green ampt method recarga was found to produce runoff recharge and ponding depth results analogous to recharge dussaillant et al 2003 it has been used to size bioretention cells investigate systems with and without underdrains and evaluate effects of the bioretention to treatment area ratio on exfiltration into groundwater boancă et al 2018 gao et al 2018 montgomery et al 2010 turney and neilson 2010 muthanna et al 2007 b 2 10 swat the soil water assessment tool swat was developed by the u s department of agriculture agricultural research service usda ars to evaluate the effect of best management practices bmps at a catchment scale although this model is a very detailed water balance model it was developed for agricultural purposes and requires significant modification for urban applications such as adjustment for small catchments and small time scales and updating et and infiltration processes hunt et al 2009 a study by christianson 2003 used swat to model bioretention cells implicitly by considering bioretention cells as ponds however christianson 2003 asserted that swat needed updates to be well suited for urban applications jeong et al 2010 described updated urban bmp algorithms in swat specific lid modules were added to swat for green roofs rain gardens porous pavement and cisterns and tested against an experimental rain garden and green roof her et al 2017 these were used in a later study which reported lumped lid benefits including rain gardens at a watershed scale seo et al 2017 swat has the potential to be beneficial for long term catchment scale modeling of lid practices but more research and modifications are needed b 2 11 swmm the u s epa stormwater management model swmm has become one of the most widely used models for bioretention especially since the release of swmm5 which includes dedicated lid modules rossman 2010 swmm has many applications for catchment hydrology provides several methods for hydrological and hydraulic processes and other input parameters and reports outflow hydrographs and peak flows aad et al 2010 was one of the first to model a rain garden no underdrain present with the swmm lid module while rosa et al 2015 was the first to investigate calibration of lid catchments in swmm swmm has been applied to bioretention in many case studies for lid watersheds avellaneda et al 2017 sun et al 2014 mccutcheon and wride 2013 bosley 2008 swmm has also been used to address specific design elements such as design storms bioretention surface areas soil mixtures and iws zones lynn et al 2018 yang and chui 2018 zhang et al 2018b gülbaz and kazezyılmaz alhan 2017b liu and fassman beck 2017 lynn et al 2018 compared the use of the bioretention lid module added to swmm5 with the traditional swmm framework in the context of capabilities modeling the iws zone more recently swmm has been applied to groundwater interactions with bioretention cells kim et al 2019 zhang et al 2018a other studies attempt to combine swmm with other bioretention models such as hydrus 1d tu et al 2020 lynn et al 2018 winslamm tiveron et al 2018 recarga sun et al 2011 and hydrocad lucas 2010 gulbaz and kazezyilmaz alhan 2017b compare the model hm rwb to swmm and concluded that swmm performed well compared to experimental drainage from column studies r2 0 66 0 76 but the hm rwb performed better r2 0 77 0 85 these studies have proven that swmm is capable of modeling bioretention cells although more studies are needed which focus on hydrologic behavior of individual bioretention cells through calibration and validation of swmm to measured bioretention cell data a couple of recent studies have demonstrated the sensitivity and performance of the flow processes of the lid modules in swmm but so far have been compared to limited measured data fassman beck and saleh 2021 lisenbee 2020 platz et al 2020 appendix c bioretention model inputs and outputs table c 1 input and output components of all evaluated models dark colored boxes indicate an input feature required in the model and output capabilities light colored boxes indicate an optional input feature general input categories catchment properties bioretention cell design climate soil and vegetation table c 1 
25744,many bioretention models still incorporate simplifications and lumped parameters that do not fully account for fundamental physical processes this review summarizes the representation of hydrologic pathways notable features and applications of bioretention models with the goals of recommending models well suited to bioretention modeling and identifying key research needs as a result hydrus and gifmod were identified as the only models that use richards equation for determining infiltration under variably saturated conditions secondly this study identified limited drainage configurations by most models except drainmod urban thirdly most models were inadequate for considering vegetation and plant water use an area for improvement in future research finally more calibration and validation studies are needed to build confidence in model results this review intends to educate modelers of the processing equations for each water balance component the input requirements in each model and other model characteristics that should be considered in model selection graphical abstract image 1 keywords bioretention hydrologic modeling low impact development 1 introduction 1 1 background urban runoff has been shown to cause a range of environmental problems such as stream channelization deterioration of stream habitat and decreased water quality dietrich et al 2017 liu et al 2014 asleson et al 2009 to combat these problems alternative methods of stormwater management have been developed to reduce the volume and peak flows of urban runoff by increasing infiltration and evapotranspiration et many of these approaches also focus on improving water quality through filtration sedimentation sorption and biological uptake hatt et al 2009 the goal is to return flow and water quality regimes to the natural pre development conditions this concept referred to as low impact development lid or water sensitive urban design wsud is an urban planning technique that focuses on all methods of reducing the effects of urbanization from reducing impervious areas during planning to conserving natural resources and public awareness education kaykhosravi et al 2018 fletcher et al 2014 liu et al 2014 another lid concept is the use of improved ecological engineering structures called green infrastructure gi kaykhosravi et al 2018 liu et al 2014 gi integrates traditional engineering design with natural materials to develop solutions to reduce impact on the environment typical examples of gi include permeable pavement green roofs rain barrels and bioretention cells kaykhosravi et al 2018 dietrich et al 2017 liu et al 2014 davis et al 2009 when describing individual practices gi is often also referred to as lid practices stormwater best management practices bmps stormwater control measures scms or sustainable urban drainage systems suds fletcher et al 2014 bioretention is the predominant choice of lid practices in the u s because it can control the volume rate and quality of stormwater runoff akan 2013 it has also become popular worldwide because it can easily be retrofit into urban areas and offers additional aesthetic and social benefits lucke et al 2017 bioretention cells are systems used to capture and filter stormwater runoff which is exfiltrated into the surrounding soil and eventually groundwater aquifers drained to receiving waters for systems with underdrains and taken up by plants i e et various drainage configurations for the underdrain pipe are possible one common configuration is an upturned elbow which creates an internal water storage zone iws fig 1 internal water storage zones are often used to promote runoff reduction to enhance exfiltration to provide water to vegetation during dry weather conditions and to create anaerobic conditions to increase nitrogen removal brown and hunt 2011 bioretention systems have been widely accepted within the engineering community due to many field and laboratory studies demonstrating substantial volumetric reductions and water quality improvement see appendix a for references yet significantly fewer studies have addressed modeling of bioretention systems modeling of these systems is important to be able to assess the performance of a system before installation to review the applicability of design guidelines to various scenarios and climates and to be able to scale local impacts to the larger watershed due to the overwhelmingly positive reports from the research conducted thus far bioretention systems have been widely adopted often before all the effects of these systems can be researched in field and mesocosm studies process based modeling provides a way to check any anomalies in initial observations or assumptions and to make adjustments while still considering the physical properties of the site heasom et al 2006 therefore there is a need for a comprehensive process based hydrologic model to predict the performance of bioretention cells for design and evaluation purposes meng et al 2014 there are many opportunities for improvement of field and mesocosm studies through the knowledge gained in bioretention modeling bioretention systems are often installed in locations without regional design standards so designers must refer to standards from other regions davis et al 2009 modeling can help adjust design standards to better fit regional climate vegetation and other local characteristics additionally little is known about the long term effects of these bioretention systems many monitoring studies have demonstrated effective performance of bioretention cells as long as 8 16 years johnson and hunt 2016 2019 lucke et al 2017 lucke and nichols 2015 komlos and traver 2012 jenkins et al 2010 long term modeling could identify the limits of a bioretention cell under various climate and design scenarios li and lam 2015 hathaway et al 2014 brown et al 2013 furthermore what are the effects of these systems at the catchment scale many times the installation and location of bioretention systems is opportunistic such as when current infrastructure is failing or a new development is constructed which creates a piecemeal approach to stormwater management national research council 2009 as more scms like bioretention are added to a catchment the cumulative effects must also be understood advances in bioretention modeling could help identify the effects of multiple bioretention cells in a catchment and the optimal locations for bioretention cells lee et al 2012 additionally modeling could serve as a first step to address catchment scale processes prior to field studies however it is imperative that bioretention modeling first be improved at the site scale before modeling can be accomplished at the catchment scale to avoid compounding errors these are all future applications of bioretention modeling but more research is needed to meet these needs 1 2 previous literature reviews three reviews liu et al 2014 roy poirier et al 2010 davis et al 2009 have summarized bioretention research and future needs two of these reviews briefly provided overviews of bioretention modeling but all concisely listed improved bioretention modeling as a future need it should be noted that few models for bioretention were available prior to 2010 therefore two of the three reviews did not cover the bioretention models that have recently become available while liu et al 2014 includes a review of more recent models it is just one section of a larger review of bioretention studies additional reviews have focused specifically on modeling of lid practices but have not been devoted to bioretention alone kaykhosravi et al 2018 jayasooriya and ng 2014 elliott and trowsdale 2007 for example li et al 2017 completed a comprehensive review of catchment scale modeling and monitoring lid studies describing methods and key results however only 12 of the 31 modeling studies mentioned bioretention or rain gardens and only four of those 12 focused on bioretention results instead of lumped lid benefits as one of the most widely used lid practices in the us and globally bioretention warrants its own review of available models and modeling techniques li et al 2017 lucke et al 2017 akan 2013 by concentrating on bioretention a more detailed look at the challenges of modeling the complex soil water interactions of bioretention systems can be addressed additionally none of the previous modeling reviews detailed what input parameters are required for each bioretention model although the number and complexity of input parameters can limit model use the objectives of this review were to give 1 a broad overview of available models for bioretention 2 a detailed examination of the input parameters and hydrologic processes in models best suited for bioretention modeling and 3 identifying areas for future improvement in bioretention modeling by meeting these objectives this review will help researchers develop bioretention modeling studies that further our knowledge of the field 1 3 review process and structure although there are many models being used to address water quality improvement from bioretention this review will describe only models used for bioretention cell hydrology and hydraulics it is important to confront errors in modeling bioretention hydrology before modeling of water quality can be improved because flow volumes peaks and timing of hydrographs will directly affect nutrient loadings plant uptake and microbial behavior furthermore reduction of pollutant loadings is often attributed in significant part to reduced runoff volumes rather than biogeochemical processes alone jefferson et al 2017 wilson et al 2015 davis et al 2009 first 17 models capable of modeling bioretention cell hydrology were identified and summarized in tables 1 and 2 models were split into two categories based on their intended uses planning assessment tools and process based computational models a brief description of all 17 models can be found in appendix b which includes the main objective previous studies general information about hydrologic and hydraulic processes and any other notable features unless otherwise cited all references to model processes in this review can be found in the resources listed under documentation in tables 1 and 2 only process based computational models were selected for further analysis in this study because they use governing equations to describe fundamental hydrologic processes this allows for investigation of hydrologic pathways in a bioretention cell as opposed to lumped parameter models that give generic estimates of runoff reduction potential of these 11 process based bioretention models six models met the hydrologic modeling criteria and more specifically bioretention modeling criteria outlined below fig 2 for this study the hydrologic modeling criteria were based on two attributes simulation type and temporal scale only bioretention models that allow for continuous simulation and a long term temporal scale with sub hourly time steps were considered in this study fig 2 spatial scale was also addressed for each model but was not defined in these criteria because it is largely application driven lastly many hydrologic models meet these two requirements so an additional attribute was added the model must contain processes explicitly developed for bioretention to be considered a model well suited for bioretention in this study the model must meet four out of seven recommended bioretention modeling criteria figs 2 and 3 specifically these attributes were improved infiltration processes using richards equation or soil water retention drainage configurations that represent underdrains and iws zones incorporation of vegetation such as water uptake processes and et calculations and production of output hydrographs fig 3 these attributes were chosen to address model deficiencies identified by previous modeling review and research studies liu et al 2014 meng et al 2014 akan 2013 brown 2011 in the models that meet most of these criteria greater than four drainmod and swat have many attributes that are well suited for bioretention modeling but did not meet the hydrologic modeling criteria of explicit bioretention functions or sub hourly time steps fig 3 drainmod urban is a revised version of drainmod that considers urban hydrology for bioretention fig 3 suggests that swat could also perform well as a bioretention model if it were also adapted to bioretention and urban systems each component of the hydrologic and bioretention modeling criteria is discussed further in the following sections the six models which meet both the hydrologic and bioretention modeling criteria were drainmod urban gifmod hydrus music recarga and swmm these models were evaluated in further detail concerning the hydrologic and hydraulic processes associated with each water balance component next a look at model inputs and outputs gives the user an idea of the complexity and applicability of each model other considerations for model selection and improvements to future bioretention modeling studies are suggested in the following sections 2 hydrologic modeling criteria suitable to bioretention 2 1 simulation type continuous versus event based simulation is a common theme in hydrologic modeling event based simulations provide analysis of natural or simulated storm events of various sizes continuous modeling uses a times series of precipitation data for simulation so that the timing of storms in relation to each other and to other modeled outputs can be assessed the biggest advantage of continuous modeling for bioretention cells is the ability to account for antecedent moisture content in the soil elliott and trowsdale 2007 antecedent moisture content is an important parameter for considering variation in soil moisture in the bioretention cells which affects infiltration and storage capacity especially for small storms low initial moisture content at the start of each storm can lead to increased infiltration due to high soil suction while high initial moisture content can cause reduced infiltration and an increase in overflow the largest disadvantages of continuous simulation are higher computational times and data requirements of a continuous rainfall record which have been largely overcome by modern computing and data availability rossman and huber 2016a continuous simulations can be conducted by all process based models evaluated except for hydrocad which was removed from further analysis in this review event based simulation is primarily used in design storm analysis which is beneficial in preliminary design studies to understand how a system will respond to changes in storm intensity and duration recarga mouse mike urban music and swmm allow for continuous or single event simulations depending on the user inputs for single event simulations recarga requires the user to select from soil conservation service scs hyetographs and provide the 24 h rainfall depth music and swmm allow a user to create a time series for a natural or synthetic event 2 2 temporal scale in all eleven process based models reviewed there is no limit on the length of simulation with user defined continuous rainfall long term simulations are beneficial for understanding a bioretention cell s response to various climate conditions and evaluating bioretention cell performance over its entire life cycle brown et al 2013 several field studies have found little change in performance of infiltration rate and nutrient removal in bioretention systems over eight to 16 year monitoring periods johnson and hunt 2016 2019 lucke et al 2017 lucke and nichols 2015 paus et al 2014 komlos and traver 2012 jenkins et al 2010 but these studies are limited to a few sites and local climate conditions the power of modeling bioretention with long term simulations is that it can address questions about the effect of climate change on infiltration based infrastructure such as the study by hathaway et al 2014 another example is a study that used 10 year precipitation averages in swmm to determine how sensitive site characteristics such as catchment area and hydraulic conductivity were to increases or decreases in precipitation li and lam 2015 when considering long term performance of bioretention cells many design parameters such as soil and vegetative properties have seasonal variations yet for most models discussed in this paper these parameters remain constant nichols et al 2021 tang et al 2015 emerson and traver 2008 for example drainmod urban accounts for root growth over seasons with monthly rooting depths in the soil profile but this only accounts for seasonal changes not continuous growth over time hydrus accounts for the three dimensional spatial distribution of roots when calculating the potential root water uptake but does not allow these parameters to change over time all other models in this review use a static rooting depth allowing for vegetation properties such as root and crop growth or soil properties such as the saturated hydraulic conductivity to be adjusted during the simulation would better represent seasonal variation and could improve model performance for bioretention cells the time step used to evaluate model outputs can have a significant impact on the performance of the bioretention model baffaut et al 2015 models best suited for urban applications such as bioretention employ a sub hourly time step because urban impervious areas decrease the time of concentration of stormwater runoff and cause flashy hydrologic behavior leopold 1968 lisenbee et al 2020 demonstrated this point by recoding drainmod to use time steps as small as 1 min for inputs and outputs in drainmod urban when calibrating drainmod urban to measured drainage hydrographs good performance was achieved with nse 0 60 at a 2 min time step but when the daily volume calibration by winston 2015 was used in drainmod urban at a 2 min time step the nse was reduced to 0 31 the original drainmod and swat were removed from further evaluation in this review for not meeting the criteria of sub hourly time steps necessary for urban hydrologic applications recarga and music are the only continuous simulation models discussed in this review with minimum time steps greater than 1 min recarga disaggregates hourly precipitation inputs into 15 min time steps to calculate the runon to the bioretention cell the soil moisture in each layer the ponding depth and the volumes for each component to the water balance but results are only printed on an hourly and total basis music requires a user specified time step of between 6 min and 24 h six minutes is the minimum time step in music because it corresponds with local precipitation records from the australian bureau of meteorology ewater 2013 swmm uses an adaptive time step that considers longer time steps in dry periods when systems are less dynamic and shorter time steps for wet periods when capturing changes in the system becomes more important this process significantly reduces the total computational time as described for swmm in the hydrology reference manual rossman and huber 2016a similarly drainmod urban uses an hourly time step during dry periods gifmod and hydrus use numerical solutions that employ time discretization based on the number of time steps needed for convergence which automatically adjusts the time step during the convergence process the output time step can be determined by the user down to 1 min 2 3 spatial scale bioretention cells can be considered in a single site scale model that focuses on the flow through the bioretention media and associated drainage storage and exfiltration to surrounding soils bioretention cells can also be incorporated in a catchment model that allows users to visualize drainage areas that generate runoff for bioretention systems and route flows from bioretention cells to other elements downstream site scale models can incorporate user defined inflow hydrographs calculated using another model such as swmm for rainfall runoff calculations in the drainage area however it is easier for both runoff generation and bioretention cell performance to be considered in the same model furthermore catchment models often have good hydraulic processes to route hydrographs from one component to another this incorporates time delays into runoff inflow hydrographs one downside of the site scale is the assumption that conveyance time of runoff from the drainage area to the bioretention cell is negligible atchison et al 2006 this may be true when using models with time steps greater than the small time of concentration found in urban catchments but when using models at very small time steps a delay could be seen in measured versus modeled hydrographs routing routines in catchment models also provide a means to model downstream effects of bioretention cells from drainage and overflow hydrographs while site scale modeling is beneficial to evaluate effects of various design parameters or performance of a specific bioretention cell catchment scale modeling is more useful for planning purposes and broader ecosystem level investigation however catchment scale models for bioretention tend to lump parameters and make simplifications to allow for quick analysis of many contributing factors without cumbersome input requirements to combine the best of these methods it is suggested that site scale models be incorporated as add in tools for larger catchment models drainmod urban and hydrus can only model the processes of a single bioretention cell without any built in runoff generation procedures instead relying on user defined inflow recarga can accept user input inflow or can calculate runon from simple methods without any routing procedures in swmm a common catchment model applied to bioretention the lid modules allow the flow through the bioretention cell to be modeled as a separate subwatershed or as a part of an existing subwatershed this allows flow to be routed to or from the bioretention cell using any of the routing procedures provided by swmm music is another catchment scale model that uses an internal rainfall runoff procedure developed by chiew and mcmahon 1997 to account for bioretention cell inflow and the muskingum cunge routing algorithm between nodes gifmod can model bioretention cells at the site scale by considering each layer to be a separate connector block gifmod also allows the catchment area to be modeled as a single block in its block connector model framework therefore it can be connected to the bioretention cell and flow from one block to another can be simulated with several supplied equations 2 4 bioretention modeling implicit or explicit as computational models for bioretention systems were developed some researchers explored using available hydrologic hydraulic models and adapting the procedures in the model to fit bioretention processes this implicit modeling was often confusing or cumbersome such as the method described by lucas 2010 to model bioretention in hydrocad other models were required to simplify the system to reservoir components such as in hec hms heasom et al 2006 or sinkaway nodes in mike urban dhi 2017 therefore functions developed specifically for bioretention or explicit bioretention modeling was added to many models such as the lid modules created for swmm in 2010 however some modelers prefer to use implicit storage functions to represent bioretention systems in swmm depending on the application lynn et al 2018 the models that explicitly model bioretention include drainmod urban gifmod hydrus mouse mike urban music recarga and swmm 3 bioretention modeling criteria 3 1 water balance components modeling the water balance of a bioretention cell enables users to assess how the bioretention cell performance varies with respect to design parameters alikhani et al 2020 yang and chui 2018 winston et al 2016 meng et al 2014 brown et al 2013 muthanna et al 2008 for example the bioretention media composition or drainage configuration could change the infiltration capacity of a given bioretention cell alikhani et al 2020 meng et al 2014 each model provides its own representation of bioretention processes and although they are all modeling the same flow paths there are many possible approaches the governing equations used to model each water balance component have a large effect on the modeled bioretention cell behavior and more importantly the design recommended for given conditions to distinguish among various governing equations the authors assigned a qualitative ranking high medium and low to each method listed in table 3 which describes the model s capability to represent each water balance component we believe that future modelers need to know the basic governing equations of each model as a starting point to understanding the usefulness of a model for a given application this is information often only found in technical model documentation and therefore this review serves as a resource to compare these processes side by side the swmm model has been used in several comparison studies on modeling bioretention to test the effect of different model processes tu et al 2020 lynn et al 2018 tiveron et al 2018 gülbaz and kazezyılmaz alhan 2017b sun et al 2011 lucas 2010 however more comparison studies are needed across all models mentioned here to validate and quantify the effect different model processes have on the output for each water balance component in a bioretention cell 3 1 1 inflow drainmod urban and hydrus rely solely on user input inflow but in previous studies swmm was used to provide a 1 min inflow hydrograph using the green ampt method lisenbee et al 2020 gao et al 2018 sun et al 2011 similarly runoff generation from the drainage area could be calculated with any rainfall runoff method giving the users more flexibility music has a built in model for rainfall runoff prediction based on the study by chiew and mcmahon 1997 recarga offers a built in process for producing hourly inflow calculated with the scs curve number cn method for pervious sections and an initial abstraction method for impervious sections but can also use user defined inflow similarly gifmod can accept user specified inflow or calculate runoff from a separate block that is directed into the bioretention cell as inflow swmm offers the most comprehensive methods for runoff generation its default method is a nonlinear reservoir model that incorporates manning s equation for overland flow and accounts for depression storage alternative methods include rational method scs cn method unit hydrograph method from natural resource conservation service nrcs and user input values swmm also can account for directly connected impervious areas to distinguish effective imperviousness separate from the total imperviousness this distinction is important in urban hydrologic modeling to improve runoff estimation for catchment models flow routing can be considered between components using the steady flow kinematic wave and dynamic wave methods in swmm and the diffusive wave manning s technique in gifmod this capability not only better calculates the timing of inflow to the bioretention cell but is also useful for investigating effects of bioretention cells on downstream bmps or control features atchison et al 2006 heasom et al 2006 one example is modeling treatment trains that link many lid practices in series music is often used for treatment train applications using the muskingum cunge routing procedures between each stormwater control measure ewater 2013 another application is linking bioretention cells to sewer systems particularly for studying mitigation of csos lucas 2010 3 1 2 infiltration although richards equation is widely considered the most comprehensive infiltration model it requires the unsaturated hydraulic conductivity curve k θ and the soil water characteristic curve swcc which are two soil properties that are not easily measured therefore the green ampt equation a simplification of the richards equation is used in many models to reduce input requirements and computation demand these simplifications require certain assumptions of the green ampt method such as one dimensional vertical flow and total saturation behind a sharp wetting front these assumptions are not always valid in bioretention cells which operate under variably saturated and unsaturated conditions hydrus which was developed as a soil physics model uses richards equation a collection of equations van genuchten mualem modified van genuchten brooks corey and kosugi are proposed to estimate the k θ required in richards equation to populate these equations the soil routine rosetta was used to determine the water retention parameters used in the van genuchten flow equations from easily determined soil textures although this method does not directly measure k θ this built in function makes the model more accessible by reducing the soil input requirements gifmod also offers a suite of relationships to describe interactions between blocks that represent different soil or storage components infiltration can only be calculated with richards equation which is the most comprehensive method but requires complex inputs then percolation through subsurface layers is estimated by the van genuchten mualem unsaturated hydraulic conductivity or darcy flow in saturated conditions drainmod urban uses the green ampt approximation of richards equation for infiltration through all bioretention cell layers but utilizes a user defined swcc to account for soil moisture changes in a bioretention cell especially those with an iws zone when the water table is close to the surface brown et al 2013 emphasized the importance of the soil moisture changes with respect to the internal water level by comparing the water content using the swcc to more common methods of assuming the difference between saturation and field capacity this study highlighted extremely large percent differences of water content 6017 to 14 as the water level rose closer to the surface therefore the swcc is an important parameter to use in determining infiltration through bioretention systems since the water level is often near the surface recarga uses the green ampt equation with ponding for infiltration of runoff into the soil surface then the unsaturated hydraulic conductivity calculated with the van genuchten equation determines the flow through each of the three soil layers root zone storage zone and native soil zone if the underlying layer is saturated the model corrects the infiltration drainage by using the limiting hydraulic conductivity plus underdrain flow if present a model recharge similar to the recarga model but using richards equation was shown to have comparable recharge exfiltration to recarga under varying design parameters indicating that green ampt can still approximate infiltration to a sufficient level dussaillant et al 2003 swmm offers a wide variety infiltration options in subcatchments horton s method the green ampt method and the scs cn method but for the lid module a modified green ampt is used it was adjusted to account for ponding depth which is normally ignored in the green ampt equation but is relevant to bioretention infiltration swmm uses darcy s law to simulate percolation through subsequent soil layers in the bioretention cell this is applied in the same manner as swmm s groundwater routine using the hydraulic conductivity slope hco to describe the exponential decrease in hydraulic conductivity with decreasing moisture content rossman and huber 2016b this hco parameter is generally estimated based on soil texture but guidance in swmm suggests a range much larger than the hco used in other bioretention studies lynn et al 2018 liu and fassman beck 2017 instead of using a soil accounting method like drainmod urban swmm assumes all soil moisture is evenly distributed throughout the soil layer and soil matric forces are ignored such that the entire system acts as a simple storage reservoir rossman and huber 2016b lastly music uses a simple bucket model to develop infiltration equations based on the total available volume in each layer and a mass balance of the fluxes within a bioretention cell the infiltration from the ponded zone into the soil layer is the minimum of the available water inflow ponded water overflow potential infiltration the volume of water leaving the soil layer and soil capacity the volume available in the soil at a given moisture content the infiltration rate within the soil media is simply the change in moisture content times the soil capacity total volume of the soil media times the porosity to consider the fluxes to other components of the bioretention cell the et and seepage to the storage layer are subtracted from this infiltration rate additionally a side flow coefficient was added to account for lateral flow from the soil layer into surrounding soils which improved infiltration predictions browne et al 2013 3 1 3 outflow two important considerations for modeled outflow are underdrain configurations and iws zones the inclusion of these features comes in many forms gifmod models underdrain flow as simple pipe flow from the storage layer using the hazen williams equation hydrus models the underdrain as its own highly permeable soil layer that is constrained by a tile drainage boundary condition although recarga can calculate underdrain flow with an orifice equation the underdrain can only be placed between the root zone and storage zone this configuration does not allow for an iws zone using an upturned elbow in the underdrain nor does it accommodate other restrictions to the underdrain such as valves orifice plates weirs etc music allows users to indicate use of an underdrain and if present an iws zone and its depth for an underdrain music calculates drainage using an orifice equation when the water level in the bioretention cell is greater than the height of the drainpipe similarly drainage with an iws zone is only calculated when the internal water level is above the invert of the elbow outlet swmm includes underdrains as an optional function in the bioretention cell lid control editor swmm models flow through the underdrain with a simple empirical power law weir equation unless the maximum drainage limit is reached the user defines the offset height of the underdrain to allow for a storage layer underneath the pipe although iws zones cannot be modeled in the lid module a recent study suggested a method of using the traditional swmm framework to model a bioretention cell with an iws zone lynn et al 2018 swmm does consider other restrictions on flow with orifice or weir equations defined by the drainage coefficient and drainage exponent set by the user because the original drainmod was developed as an agricultural drainage model drainmod urban is one of the best models for both underdrains and iws configurations drainmod urban uses the hooghoudt drainage equation when the internal water table is below the surface and corrects for convergence of flow near the drains using the moody equations when the soil profile is saturated and there is ponding on the soil surface the kirkham equation is used to calculate the drainage rate drainmod urban is the only model that by default models multiple drainage pipes it also provides a drainage coefficient for flow limited by pipes or outlet structures drainmod urban provides a controlled drainage design option that has been shown to accurately model drawdown as drainmod in a bioretention cell with an iws zone during the growing season but during the dormant season when water tables rise due to reduced et drawdown was slower than predicted rates brown et al 2013 this is one of few studies that has evaluated the model performance for an iws zone 3 1 4 overflow in general all models predict overflow when the ponding depth exceeds the depression storage depth drainmod urban recarga and swmm use a simple surface water balance to account for change in storage of the ponding zone drainmod urban specifically uses the swcc to recalculate the water level in the cell at each time step and determine if the maximum ponding depth has been reached swmm includes a ponding zone denoted berm height in the lid module for bioretention but also includes a vegetation volume fraction to account for the space that vegetation occupies in the ponding zone overflow when the ponding zone is full is modeled with a surface layer water balance as the precipitation and inflow minus infiltration and evapotranspiration at the surface this is calculated in the model as the water level above a maximum freeboard for each given time step hydrus uses a seepage face boundary condition to model water leaving the saturated zone as overland flow in gifmod the ponding zone is modeled as a separate block with a constant head storage relationship runoff from the ponding zone can then be routed to another block as overland flow music uses a simple weir equation to describe flow from the ponding zone after reaching the designated berm height 3 1 5 exfiltration in recarga the underlying soil is considered as an additional soil layer such that exfiltration is quantified in the water balance at each time step using the unsaturated hydraulic conductivity calculated with the van genuchten equation hydrus also uses the unsaturated hydraulic conductivity from the van genuchten mualem modified van genuchten brooks corey or kosugi methods to govern seepage into the surrounding soils drainmod urban uses a vertical seepage function that incorporates darcy s law with the dupuit forchheimer assumptions to describe the flow from the storage layer into the surrounding soil the model inputs include seepage parameters such as piezometric head of the aquifer depth to the impermeable layer and vertical conductivity of the restricting layer which are often used as calibration parameters since they are difficult to measure likewise darcy s law is used in gifmod to simulate flow from the bioretention media into the gravel layer and subsequent native soils in swmm and music the exfiltration from the bottom of the storage layer into the surrounding native soil is simply set to a user supplied saturated hydraulic conductivity of the native soil 3 1 6 evapotranspiration evapotranspiration et is difficult to model and the most accurate equations require a large number measured meteorological parameters consequently methods employed in bioretention models vary widely studies have shown et makes up approximately 5 20 of the bioretention cell water balance with higher et found in bioretention cells with an iws zone winston et al 2016 wadzuk et al 2015 brown et al 2013 li et al 2009 however understanding et dynamics in bioretention cells is important since vegetation is incorporated specifically for increased water storage and removal in addition to water quality benefits in recarga the regional average hourly et was used to calculate the available initial abstraction in the impervious surface runoff for the bioretention cell itself a function of the user input hourly potential evapotranspiration pet and the plant available water was used to calculate et from the rooting zone recarga outputs a synopsis of plant survivability which includes details for each time the rooting zone is saturated or permanent wilting point is reached each time there is ponding and each overflow event the ponding time is included because plant survivability is expected to decrease if ponded over 24 h atchison et al 2006 swmm has many methods constant value monthly averages daily values from external climate file daily values computed from daily temperatures and daily user defined times series available to calculate evaporation for overland flow where plant transpiration is negligible surface et in the lid module is calculated by incorporating a user defined daily pet input and ponding depth over time into a function for the evaporation from the surface in the soil layer the et used is the minimum of the remaining pet and the et calculated by a function of moisture content above wilting point and the water level the et can also be calculated for the storage layer when the soil layer is unsaturated both the soil and storage et are set to zero when surface infiltration is occurring similarly music calculates the et at a daily time step but disaggregated to the user specified time step down to 6 min from the surface and soil layers separately the evaporation at the surface is calculated without considering transpiration from plants this is added to the et from the soil layers which is dependent on soil moisture and water availability when the soil moisture is above wilting point but vegetation still experiences water stress the pet is limited by water availability if the water availability is not limiting the et is set equal to the pet these et equations were based on a column study using the carex appressa plant commonly used in bioretention systems in australia in music plant survivability is considered in relation to the iws zone and nutrient uptake for water quality vegetation is considered to be effective or non effective vegetation in relation to nutrient uptake which is commonly associated with root depth ewater 2013 in drainmod urban the thornthwaite method is the default et method due to its simple input requirements daily maximum and minimum temperatures heat index and latitude monthly adjustment factors can also be applied to better calibrate the et to a specific region additionally a user defined daily pet can be entered to allow flexibility in the pet calculation method daily et is distributed between 6 00 and 18 00 and pet is set to zero during rainfall et occurs in the root zone which is an input parameter for drainmod urban that can be adjusted monthly to account for seasonality in drainmod urban the pet is used to represent the et from the system when the soil water is not limiting if the et is limited by the soil water conditions such as when the soil moisture in the root zone is below the permanent wilting point then et is equal to the upward flux of water as a function of the water table depth which is determined from the swcc soil input when this upward flux is not enough to meet the et demand water is removed from the root zone gifmod has the largest number of programmed options for calculating pet within the model including an aerodynamic model for evaporation priestly taylor penman and user defined methods massoudieh et al 2017 gifmod also has two transpiration models that limit transpiration either by soil moisture or soil matric potential the water uptake from plants can be modeled with the fao 56 model or another model that considers field capacity wilting point and soil suction proposed by li et al 2001 hydrus uses atmospheric boundary conditions to account for release of water through evaporation in the ponding zone the water uptake can be described as function of a critical water stress above which the water uptake in stressed parts of the root zone can be compensated by uptake in other parts of the root zone to find the actual rate of water uptake a water stress response function by feddes et al 1978 or van genuchten 1985 can be used to reduce the potential root water uptake water uptake is assumed to be zero when the soil is saturated and when it is below wilting point in hydrus maximum rooting depth is entered by the user and in hydrus 2d 3d the maximum rooting radius is used to consider lateral spread of roots šejna et al 2014 hydrus also accounts for plant growth in et calculations using the plant height and root depth meng et al 2014 found that et volume increased with plant height 3 2 model inputs outputs as the level of model complexity increases so does the quantity and complexity of inputs an ideal model has a balance of assumptions and simplifications in governing equations and intricate input parameters that require more time and effort from users modelers must be aware of the sensitivity of bioretention models to certain parameters particularly soil inputs as well as the level of detail required for the modeling application for example atchison et al 2006 recommends performing infiltration tests on underlying soils for a detailed final design but for preliminary design applications the soil hydraulic conductivity can be estimated based on soil texture in recarga and swmm default values for soil properties based on soil texture from rawls et al 1998 are provided in the case that measured values are unavailable similarly music provides estimations for soil inputs based on melbourne and brisbane soils imteaz et al 2013 all model inputs and outputs are reported in table c 1 to provide readers with an initial step in model selection based on the availability of required input parameters for a given site and the outputs of interest previous model sensitivity studies have found soil parameters to have a significant impact on model performance fassman beck and saleh 2021 nichols et al 2021 leimgruber et al 2018 avellaneda et al 2017 stewart et al 2017 rosa et al 2015 gagrani et al 2014 dotto et al 2011 sun et al 2011 therefore the soil parameters required in each model will be compared here all models require the saturated hydraulic conductivity ksat and seepage rate as the most simplistic representation of infiltration and outflow from the bioretention cell soil moisture properties are used in the infiltration and percolation equations to determine better estimations of the flow through the bioretention cell see sections 3 1 2 the swcc is the best characterization of soil moisture changes because it provides a curve of soil moisture with respect to soil suction however only the models that use richard s equation gifmod and hydrus and drainmod urban use this method for soil water accounting other models that use green ampt infiltration recarga and swmm require the initial soil moisture and other common soil moisture properties such as porosity field capacity and wilting point these values are often estimated from soil texture as mentioned above recarga hydrus and gifmod offer soil parameter estimation for the k θ from the van genutchen equation hydrus also offers brooks corey kosugi and a modified van genuchten function as options for estimating soil moisture accounting parameters k θ and swcc gifmod has the most unique inputs for soil moisture accounting by calculating soil properties and flow through various block types saturated soil unsaturated soil storage etc with two pre defined soil water relationships head storage and head flow functions in terms of outputs all models reviewed produced hydrographs and summary reports of cumulative volumes for each water balance component in the bioretention cell hydrus music and swmm also describe characteristics of the hydrographs such as time to peak peak flow rate and duration in the result summaries these hydrograph characteristics can be found in time series outputs from drainmod urban and gifmod although hourly flows in recarga can still be used to create hydrographs it may not accurately capture peak flows 4 recommendations for bioretention model selection the previous sections have emphasized the diversity of internal processes among six bioretention models but how does one choose which model is appropriate for a desired application this section highlights some key considerations for selecting a bioretention model including 1 the flexibility of the model structure 2 the flux of greatest concern or interest and 3 the required inputs and the desired outputs for a model flexibility in model structure allows users to adapt the model to better represent the design of a specific bioretention cell such as those with unique drainage systems or the characteristic hydrology of a catchment one study emphasized the level to which three different model structures represent the characteristic hydrologic signature of the catchment using the model music hamel and fletcher 2014b it also validated the assertion by clark et al 2011 that more complex structures in conceptual models often are better at representing the physical features of a system in swmm the catchment that contains lid practices can be represented in many ways providing flexibility to the user but the representation of bioretention through the lid control is still somewhat rigid gifmod was developed such that the user could build a flexible model structure composed of interconnected blocks this flexibility allows users to produce a gifmod model that represents a single bioretention cell or a set of bioretention cells at a catchment scale because the model structure can be represented in multiple forms it can be compared or coupled with a wider variety of bioretention models the modeler should also consider which fluxes are of most importance in a proposed modeling study prior to choosing a model this review showed a significant difference in how bioretention models approach infiltration at the surface and flow through the bioretention media table 3 there are also a wide variety of capabilities regarding drainage configurations and calculations although the water balance components described in section 3 1 above work interdependently some models show greater capability for one flux over another table 3 the model structure and emphasis on specific fluxes can be inferred from the model s initial use for example drainmod urban was first an agricultural drainage model therefore it has much more complex equations for drainage compared to other bioretention models and can be used when underdrain flow is meaningful to the study likewise hydrus was developed as a soil physics model and therefore puts more emphasis on fluxes through the soil column in a bioretention cell this would be beneficial when investigating soil moisture changes within a bioretention cell nichols et al 2021 stewart et al 2017 recarga was built for representing rain gardens specifically which tend to be smaller less engineered systems that promote exfiltration and has been previously used to estimate exfiltration that could lead to groundwater recharge montgomery et al 2010 dussaillant et al 2003 finally model inputs and outputs are discussed in this review section 3 2 and appendix c because they demonstrate the value of practicality in model selection the available field data may determine the model choice based on required inputs outputs or the lack of field data may prioritize a model with good performance when uncalibrated the increase in model complexity introduces more input parameters that not only multiply the effort of model setup but also insert uncertainty in model parameterization the resolution of outputs required by a model varies greatly with application lisenbee et al 2020 for example cso mitigation or treatment train evaluation may require more detailed timing of drainage and overflow fassman beck and saleh 2021 stewart et al 2017 5 assessment of needs for bioretention modeling this review unveiled several improvements to bioretention modeling to be considered in future modeling efforts few models account for aboveground vegetation growth and root growth which can increase et hydrus is the only model evaluated that includes plant growth in its et calculation the only other model that acknowledges aboveground effect of plants is swmm which accounts for the space plants take up in the ponding zone with its vegetation volume fraction however this is a constant rate that does not account for plant growth over the simulation period the rooting depth of plants is incorporated in many models water uptake procedures but this is also often a constant value only hydrus accounts for the spatial extent of the root zone both longitudinally and laterally but that area does not change over time as roots grow drainmod urban can incorporate seasonal root growth with monthly rooting depths but this is repeated for each year in the simulation so that growth from one year to the next is overlooked many field and lab studies have shown effects of vegetation on infiltration through creation of macropores tang et al 2015 meng et al 2014 paus et al 2014 jenkins et al 2010 emerson and traver 2008 vegetation can lead to infiltration rates several orders of magnitude higher than predicted solely by associated soil properties lucas 2010 meng et al 2014 notes that although hydrus incorporates plant growth in the model there is no ability to simulate the effect of plants on soil permeability due to macropores in hydrus 1d however hydrus 2d 3d has a supplemental dual porosity module that could account for macropores although this has yet to be used in a bioretention study nichols et al 2021 while macropores increase infiltration clogging of soil pore space due to fine particle accumulation can decrease infiltration le coustumer et al 2012 li and davis 2008 hsieh et al 2007 swmm is the only model that accounts for clogging with a user specified constant clogging rate infiltration parameters also have been shown to vary seasonally due to plant growth or dormancy temperature changes and snow events nichols et al 2021 emerson and traver 2008 muthanna et al 2008 braga et al 2007 despite this evidence none of the models allow for temporal variation of the ksat and other soil properties soil properties play an important role in the soil moisture dynamics of bioretention cells which affects the infiltration percolation and other hydrologic flow paths drainmod urban gifmod and hydrus require the swcc which provides information on soil moisture properties of the bioretention media other models suggest estimations of soil moisture properties such as porosity field capacity and wilting point based on soil texture from experimental studies such as rawls et al 1998 used in recarga or rawls et al 1983 used in swmm however measured soil attributes have large variability even across similar soil textures due to land cover compaction macropores temperature etc saturated hydraulic conductivity has been shown to vary widely up to three orders of magnitude with associated high skewness from various studies garcia gutierrez et al 2018 papanicolaou et al 2015 gwenzi et al 2011 warrick and nielsen 1980 further study of default values for a given soil textural class and measured values of soil properties in bioretention modeling would provide valuable information on model sensitivity to soil parameters both iws zones and underdrains are oversimplified and underrepresented in most of the models evaluated underdrains are commonly applied in bioretention field studies and some states require iws zones for bioretention north carolina department of enviromental quality 2009 ohio department of natural resources 2006 these configurations must be included in modeling approaches for the model to adequately represent the bioretention hydraulics also most models had simplistic drainage equations and only considered a single underdrain drainmod urban is the only model that accounts for multiple drains using drainage equations commonly applied to poorly drained agricultural soils exfiltration from the bioretention cell to native soils can be improved in some models that assume a constant rate such as the saturated hydraulic conductivity darcy s law is an improvement in some models but considering unsaturated flow is even more advanced also a benefit of the iws zone is to increase the exfiltration into surrounding soils by slowing the flow of water through the underdrain most models are incapable of modeling iws zones and therefore may overestimate drainage and underestimate exfiltration accurate estimation of exfiltration is important for emerging studies on the influence of bioretention on groundwater some studies have tried to adapt models like hydrocad and swmm to account for groundwater recharge and others assume all exfiltration becomes recharge but there is still much to learn about the effects of bioretention and other infiltration devices on groundwater to inform models tu et al 2020 kim et al 2019 bonneau et al 2018 zhang and chui 2017 2018 zhang et al 2018a stewart et al 2017 machusick et al 2011 barbu et al 2009 many models fail to account for the changing hydraulic gradient of the groundwater table and how it affects the seepage rate from the bioretention cell of the models in this paper drainmod urban and hydrus have these capabilities more studies need to be conducted using measured field data for calibration and validation of these models many studies use these models as planning tools but model performance must be validated with field studies to assure that uncalibrated model simulations provide realistic estimations for preliminary designs furthermore models that assess lumped bioretention outflows at the catchment scale could show good performance of total runoff reduction but if the flow dynamics are important to the modeling application outflow hydrographs from individual bioretention cells must also be calibrated fassman beck and saleh 2021 lisenbee et al 2020 water quality features of the models in this review were not evaluated but the assessment of model hydrology is a step toward improved water quality predictions improved modeling of bioretention cell hydrology can lead to improvement in water quality pollutant loadings the contaminant transport nutrient transformation and biological activity within bioretention cells are important to the quality of water reaching downstream catchments and other lid controls but often these processes are secondary to load reductions caused a decrease in runoff volumes nevertheless investigation into the water quality processes of bioretention models is an area for further research 6 conclusions this review served to unveil the black box of hydrologic processes in common bioretention models and identify improvements in the field of bioretention modeling two relatively new models were among the models analyzed drainmod urban 2020 and gifmod 2017 conversely swmm music and recarga have been used in many studies hydrus has been used in fewer studies perhaps due to model complexity all these models meet the first two attributes for hydrologic modeling for bioretention continuous long term simulation and sub hourly time steps as small as 1 min time steps available in all models except recarga and music spatial distribution of the models varies both catchment models and site scale models are represented downsides of the site scale are neglecting conveyance time of runoff from the drainage area to the bioretention cell and inability to route outflows to other catchments sewer systems or lid components downstream richards equation is suggested as the most advanced physical representation of infiltration through the bioretention cell but it is only used in hydrus and gifmod due to difficulty obtaining required input parameters a simplification of richards equation green ampt is used by other models but it makes assumptions that are not always applicable to the variably saturated nature of bioretention cells therefore modified green ampt equations have been used in models such as swmm and recarga that account for the ponding depth drainmod urban uses green ampt but also accounts for variable moisture content in the cell through use of the swcc gifmod hydrus and recarga use the van genuchten approximation for the unsaturated hydraulic conductivity to account for percolation through the subsoil layers despite meticulous percolation procedures these three models still lack the ability to model iws zones in a typical upturned elbow configuration with hydrus and recarga even more limited in underdrain configurations drainmod urban is the most comprehensive drainage model and therefore models both iws and underdrain components well music also explicitly models both underdrains and iws zones some improvements suggested for bioretention modeling based on this review are the incorporation of vegetation growth and root growth over time temporal variation of soil properties the validity of soil parameters estimation and customization of drainage configurations groundwater and water quality analysis are two important topics of investigation regarding bioretention that were not covered in this review but research is ongoing further calibration and validation of the models with measured field data will improve confidence in model performance for bioretention applications quality empirical data of all bioretention fluxes would also be useful in model comparison studies to understand how the different model processes described in this review affect model outputs and ultimately how model performance compares across models catchment scale models must be evaluated on how they represent individual bioretention cells to understand how the flow dynamics will interact with other catchment components these improvements in process based bioretention modeling will lead to better prediction of bioretention behavior author contributions w l literature review conception reviewed literature and designed review process wrote manuscript j h edited manuscript provided guidance on content m b edited manuscript provided guidance on content t f edited manuscript provided guidance on content declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements funding for this research was provided by the national science foundation grant no 1553475 appendices appendix a for bioretention hydrology and water quality studies volumetric reductions brown r a and hunt w f 2011a impacts of media depth on effluent water quality and hydrologic performance of undersized bioretention cells journal of irrigation and drainage engineering 137 3 132 143 https doi org 10 1061 asce ir 1943 4774 0000167 brown r a and hunt w f 2012 improving bioretention biofiltration performance with restorative maintenance water science and technology 65 2 361 367 https doi org 10 2166 wst 2012 860 davis a p 2008 field performance of bioretention hydrology impacts journal of hydrologic engineering 13 2 90 95 https doi org 10 1061 asce 1084 0699 2008 13 2 90 davis a p traver r g hunt w f lee r brown r a and olszewski j m 2012 hydrologic performance of bioretention storm water control measures journal of hydrologic engineering 17 5 604 614 https doi org 10 1061 asce he 1943 5584 0000467 hunt w f jarrett a r smith j t and sharkey l j 2006 evaluating bioretention hydrology and nutrient removal at three field sites in north carolina journal of irrigation and drainage engineering 132 6 600 608 https doi org 10 1061 asce 0733 9437 2006 132 6 600 olszewski j m and davis a p 2013 comparing the hydrologic performance of a bioretention cell with predevelopment values journal of irrigation and drainage engineering 139 2 124 130 https doi org 10 1061 asce ir 1943 4774 0000504 water quality improvement brown r a and hunt w f 2011b underdrain configuration to enhance bioretention exfiltration to reduce pollutant loads journal of environmental engineering asce 137 11 1082 1091 https doi org 10 1061 asce ee 1943 7870 0000437 chapman c and horner r r 2010 performance assessment of a street drainage bioretention system water environment research 82 2 109 119 https doi org 10 2175 106143009x426112 ergas s j sengupta s siege r pandit a yao y f and yuan x 2010 performance of nitrogen removing bioretention systems for control of agricultural runoff journal of environmental engineering asce 136 10 1105 1112 https doi org 10 1061 asce ee 1943 7870 0000243 kluge b markert a facklam m sommer h kaiser m pallasch m and wessolek g 2018 metal accumulation and hydraulic performance of bioretention systems after long term operation journal of soils and sediments 18 2 431 441 https doi org 10 1007 s11368 016 1533 z li h and davis a p 2008a urban particle capture in bioretention media i laboratory and field studies journal of environmental engineering asce 134 6 409 418 https doi org 10 1061 asce 0733 9372 2008 134 6 409 li h and davis a p 2009 water quality improvement through reductions of pollutant loads using bioretention journal of environmental engineering 135 8 567 576 https doi org 10 1061 asce ee 1943 7870 0000026 lucke t dierkes c and boogaard f 2017 investigation into the long term stormwater pollution removal efficiency of bioretention systems water science and technology 76 8 2133 2139 https doi org 10 2166 wst 2017 382 davis a p 2007 field performance of bioretention water quality environmental engineering science 24 8 1048 1064 https doi org 10 1089 ees 2006 0190 hunt w f kannan n jeong j and gassman p w 2009 stormwater best management practices review of current practices and potential incorporation in swat international agricultural engineering journal 18 1 2 73 89 hunt w f smith j t jadlocki s j hathaway j m and eubanks p r 2008 pollutant removal and peak flow mitigation by a bioretention cell in urban charlotte nc journal of environmental engineering asce 134 5 403 408 https doi org 10 1061 asce 0733 9372 2008 134 5 403 wan z x li t and liu y t 2018 effective nitrogen removal during different periods of a field scale bioretention system environmental science and pollution research 25 18 17 855 17861 https doi org 10 1007 s11356 018 1954 x wang j chua l h c and shanahan p 2017 evaluation of pollutant removal efficiency of a bioretention basin and implications for stormwater management in tropical cities environmental science water research technology 3 1 78 91 yang x h mei y he j jiang r li y q and li j q 2014 comprehensive assessment for removing multiple pollutants by plants in bioretention systems chinese science bulletin 59 13 1446 1453 https doi org 10 1007 s11434 014 0200 2 field studies al ameri m hatt b le coustumer s fletcher t payne e and deletic a 2018 accumulation of heavy metals in stormwater bioretention media a field study of temporal and spatial variation journal of hydrology 567 721 731 brown r a birgand f and hunt w f 2013a analysis of consecutive events for nutrient and sediment treatment in field monitored bioretention cells water air and soil pollution 224 6 https doi org artn 158110 1007 s11270 013 1581 6 brown r a and hunt w f 2010 impacts of construction activity on bioretention performance journal of hydrologic engineering 15 6 386 394 https doi org 10 1061 asce he 1943 5584 0000165 brown r a and hunt w f 2011a impacts of media depth on effluent water quality and hydrologic performance of undersized bioretention cells journal of irrigation and drainage engineering 137 3 132 143 https doi org 10 1061 asce ir 1943 4774 0000167 davis a p 2008 field performance of bioretention hydrology impacts journal of hydrologic engineering 13 2 90 95 https doi org 10 1061 asce 1084 0699 2008 13 2 90 hsieh c h and davis a p 2005 multiple event study of bioretention for treatment of urban storm water runoff water science and technology 51 3 4 177 181 go to isi wos 000228827100023 hunt w f jarrett a r smith j t and sharkey l j 2006 evaluating bioretention hydrology and nutrient removal at three field sites in north carolina journal of irrigation and drainage engineering 132 6 600 608 https doi org 10 1061 asce 0733 9437 2006 132 6 600 jiang c b li j k li h e li y j and chen l 2017 field performance of bioretention systems for runoff quantity regulation and pollutant removal water air and soil pollution 228 12 https doi org artn 46810 1007 s11270 017 3636 6 komlos j and traver r g 2012 long term orthophosphate removal in a field scale storm water bioinfiltration rain garden journal of environmental engineering 138 10 991 998 https doi org 10 1061 asce ee 1943 7870 0000566 li h sharkey l j hunt w f and davis a p 2009 mitigation of impervious surface hydrology using bioretention in north carolina and maryland journal of hydrologic engineering 14 4 407 415 https doi org 10 1061 asce 1084 0699 2009 14 4 407 line d e and hunt w f 2009 performance of a bioretention area and a level spreader grass filter strip at two highway sites in north carolina journal of irrigation and drainage engineering 135 2 217 224 https doi org 10 1061 asce 0733 9437 2009 135 2 217 lopez e v lynn t j peterson m ergas s j trotz m a and mihelcic j r 2016 enhanced nutrient management of stormwater through a field demonstration of nitrogen removal in a modified bioretention system world environmental and water resources congress 2016 environmental sustainability groundwater hydraulic fracturing and water distribution systems analysis 60 69 go to isi wos 000389439700007 lucke t and nichols p w b 2015 the pollution removal and stormwater reduction performance of street side bioretention basins after ten years in operation science of the total environment 536 784 792 https doi org 10 1016 j scitotenv 2015 07 142 paus k h morgan j gulliver j s leiknes t and hozalski r m 2014 assessment of the hydraulic and toxic metal removal capacities of bioretention cells after 2 8 years of service water air and soil pollution 225 1 https doi org artn 180310 1007 s11270 013 1803 y wan z x li t and liu y t 2018 effective nitrogen removal during different periods of a field scale bioretention system environmental science and pollution research 25 18 17 855 17861 https doi org 10 1007 s11356 018 1954 x laboratory mesocosm studies goh h w zakaria n a lau t l foo k y chang c k and leow c s 2017 mesocosm study of enhanced bioretention media in treating nutrient rich stormwater for mixed development area urban water journal 14 2 134 142 good j f o sullivan a d wicke d and cochrane t a 2012 contaminant removal and hydraulic conductivity of laboratory rain garden systems for stormwater treatment water science and technology 65 12 2154 2161 https doi org 10 2166 wst 2012 135 hsieh c h davis a p and needelman b a 2007a bioretention column studies of phosphorus removal from urban stormwater runoff water environment research 79 2 177 184 https doi org 10 2175 106143006x111745 hsieh c h davis a p and needelman b a 2007b nitrogen removal from urban stormwater runoff through layered bioretention columns water environment research 79 12 2404 2411 https doi org 10 2175 106143007x183844 li h and davis a p 2008a urban particle capture in bioretention media i laboratory and field studies journal of environmental engineering asce 134 6 409 418 https doi org 10 1061 asce 0733 9372 2008 134 6 409 liu r f and fassman beck e 2017 hydrologic experiments and modeling of two laboratory bioretention systems under different boundary conditions frontiers of environmental science engineering 11 4 https doi org artn 10 101007 s11783 017 0951 5 liu j sample d j owen j s li j l and evanylo g 2014b assessment of selected bioretention blends for nutrient retention using mesocosm experiments journal of environmental quality 43 5 1754 1763 https doi org 10 2134 jeq2014 01 0017 lucas w c and greenway m 2008 nutrient retention in vegetated and nonvegetated bioretention mesocosms journal of irrigation and drainage engineering 134 5 613 623 https doi org 10 1061 asce 0733 9437 2008 134 5 613 lucas w c and greenway m 2011a hydraulic response and nitrogen retention in bioretention mesocosms with regulated outlets part i hydraulic response water environment research 83 8 692 702 https doi org 10 2175 106143010x12780288628697 lucas w c and greenway m 2011b hydraulic response and nitrogen retention in bioretention mesocosms with regulated outlets part ii nitrogen retention water environment research 83 8 703 713 https doi org 10 2175 106143011x12989211840936 lucas w c and greenway m 2011c phosphorus retention by bioretention mesocosms using media formulated for phosphorus sorption response to accelerated loads journal of irrigation and drainage engineering 137 3 144 153 https doi org 10 1061 asce ir 1943 4774 0000243 palmer e t poor c j hinman c and stark j d 2013 nitrate and phosphate removal through enhanced bioretention media mesocosm study water environment research 85 9 823 832 https doi org 10 2175 106143013x13736496908997 payne e g i fletcher t d russell d g grace m r cavagnaro t r evrard v deletic a hatt b e and cook p l m 2014 temporary storage or permanent removal the division of nitrogen between biotic assimilation and denitrification in stormwater biofiltration systems plos one 9 3 https doi org artne90890 10 1371 journal pone 0090 890 ray c bezak b petrey k and shea e 2015 measurement and optimization of permeability in bioretention soil media lid it works in all climates and soils 176 185 go to isi wos 000381031400018 stander e k and borst m 2010 hydraulic test of a bioretention media carbon amendment journal of hydrologic engineering 15 6 531 536 https doi org 10 1061 asce he 1943 5584 0000133 wadzuk b m hickman j m and traver r g 2015 understanding the role of evapotranspiration in bioretention mesocosm study journal of sustainable water in the built environment 1 2 https doi org artn 0401400210 1061 jswbay 0000794 wang m zhang d q li y hou q h yu y y qi j d fu w c dong j w and cheng y n 2018 effect of a submerged zone and carbon source on nutrient and metal removal for stormwater by bioretention cells water 10 11 https doi org artn 162910 3390 w10111629 appendix b model descriptions applications and previous studies b 1 planning assessment tools several models have been created as planning tools for a quick assessment of the effect of bioretention cells in a catchment generally these models require minimal expertise or training by users which makes them popular options for initial assessment of a site these models do not simulate hydrological processes within the bioretention cells but instead use lumped parameters for a general estimation of the runoff reduction potential water quality and cost benefit analysis to support decision making for example the center for neighborhood technology describes the green values national stormwater calculator as a first approximation of the hydrologic and financial conditions for a site green values stormwater calculator methodology 2007 similarly the u s environmental protection agency epa national stormwater management calculator is a simplified version of swmm that only considers overland flow infiltration and evaporation with the main goal of assessing if developers meet certain stormwater retention targets rossman and bernagros 2018 the u s epa also developed the system for urban stormwater treatment and analysis integration sustain for the placement of lid practices within a catchment while also optimizing cost and water quantity and quality performance sustain combined many algorithms from other lid models including swmm but only certain criteria were used in the optimization modules some case studies have demonstrated model setup and calibration in locations across the united states king county wa kansas city mo louisville ky and albuquerque nm and china mao et al 2017 shoemaker et al 2011 2013 lee et al 2012 degasperi 2009 other models that provide quick assessment of hydrology and water quality benefits of lid practices including bioretention are l thia lid long term hydrologic impact analysis developed by purdue university as a web based tool for long term hydrologic assessment lid practices wbm water balance model created as an online tool for scenario comparison and uem urban ecohydrological model which is a lumped parameter model that aggregates all bioretention cells in a watershed to a single parameter to evaluate ecological and stream health associated with bioretention design scenarios water balance model powered by qualhymo technical manual 2019 wright et al 2018 l thia low impact development spreadsheet 2015 lastly some models listed put more emphasis on water quality such as ideal integrated design evaluation and assessment of loadings which was developed to predict water quality improvement from lid ideal can produce detailed outputs of each bioretention cell such as hydrographs sedigraphs chemigraphs and pollutographs alexander et al 2011 winslamm source loading and management model was designed to provide simple pollutant mass discharges and runoff volumes for a variety of stormwater control practices and development scenarios pitt and voorhees 2004 winslamm also has a large focus on water quality because it emphasizes small storm hydrology better for water quality analysis and particulate washoff b 2 process based computational models b 2 1 drainmod drainmod was originally developed as a long term continuous simulation water management model to simulate poorly or artificially drained agricultural soils bioretention cells with high internal water tables during storm events behave similarly to these agricultural fields and drain through porous underdrain pipes like soil tile drains furthermore this model uses the soil water characteristic curve swcc so that the effect of soil moisture in the bioretention cell profile between storm events can be considered in soil water processes that make up the water balance this is also one of few models with the capability to model the iws or submerged zone applied in some bioretention cells brown et al 2013 was the first to apply this model to four bioretention cells in north carolina with good calibration of inflow drainage and overflow nash sutcliffe efficiency nse 0 71 in 2014 the north carolina cells were modeled under changing climate conditions hathaway et al 2014 winston 2015 also tested drainmod on three more bioretention cells in ohio which maintained good agreement with measured volumes for each water balance component nse 0 71 it should be noted that these models were run at a low temporal resolution of daily or hourly time steps with outputs summarized for daily monthly and yearly totals b 2 2 drainmod urban although drainmod was shown to be an effective model for bioretention cells when calculating volumes of water balance components it could only produce daily outputs as the smallest time step therefore drainmod was unable to output hydrographs to examine peak flow rates and allow for integration with other catchment models to better represent the flashy nature of urban hydrology drainmod was updated to accept inputs and produce outputs at as small as 1 min intervals this updated model was termed drainmod urban lisenbee et al 2020 showed that drainmod simulations performed by winston 2015 did not represent measured drainage hydrographs well even if volumes were well calibrated drainmod urban was then calibrated to better represent measured drainage hydrographs results showed good agreement of the model nse 0 60 especially considering the high resolution output 1 min intervals drainmod urban has also been compared to swmm and evaluated using pedotransfer functions to substitute for required soil properties in the model lisenbee 2020 b 2 3 gifmod the gi flexible model gifmod was developed as a continuous process based model that is flexible in that it can be applied to a wide range of gi practices and allows the user to define the structure and complexity of the model the structure is composed of a series of blocks connected by interfaces that represent each component of the gi system soil layer stream segment or storage a water balance is conducted on each of these blocks at a sub hourly time step and the interfaces between blocks are governed by several provided equations the three main mechanisms of this model include hydraulics particle colloid transport and dissolved or particle bound contaminant transport massoudieh and aflak 2017 the hydraulics component can simulate flow through storage layers or structures porous media under saturated and unsaturated conditions pipe flow overland flow and et gifmod allows for user defined head storage and head flow relationships as well as predefined relationships for each block type for soil blocks this function can be populated by default or user input soil parameter values massoudieh et al 2017 describes the model as applied to two bioretention cells connected in series the initial modeling results showed good model agreement for the upper rain garden nse 0 83 but reduced performance in the lower rain garden nse 0 49 however more rigorous calibration with an extended dataset was suggested by massoudieh et al 2017 this was done in a more recent study that applied a 3 year dataset to the same bioretention cells and evaluated gifmod for both hydrologic and water quality performance alikhani et al 2020 the outflow calibration showed slightly improved model performance of nse 0 86 for the upper rain garden and nse 0 68 for the lower rain garden the validation of flow for this study was done using a monte carlo analysis to show that most of the measured data fell within the 95 credible interval b 2 4 hec hms the hydrologic engineering center hydrologic modeling system hec hms was developed in 1998 as hec 1 originally by the u s army corps of engineers usace as a continuous numerical model to simulate hydrologic processes of dendritic watershed systems it is widely used in industry for planning and design in flood forecasting evaluating hydraulic conveyance and controls and erosion and sediment routing studies hydrologic modeling system hec hms user s manual 2018 heasom et al 2006 used hec hms to model the flow through a bioretention cell by replicating it as a reservoir which serves a storage capacity for flow from two sub basins representing pervious and impervious surfaces in the catchment area the reservoir bioretention basin is drained as weir flow hec hms was used to model bioretention cells in this study because it is a common hydrologic model that offers widely accepted methods for infiltration and hydraulic routing also the output hydrographs can easily be compared to measured water levels in bioretention cells however heasom et al 2006 does admit that the setup of the bioretention cell with a diversion element and further post processing of combined outflow is not straightforward another case study khaniya et al 2017 used hec hms to model a rain garden but even these authors admit to limitations of hec hms such as event simulation and limited runoff generation options b 2 5 hydrocad hydrocad is a proprietary hydrological and hydraulic model employed widely in industry lucas 2010 described how to apply hydrocad to routing outflow from many bioretention cells in a catchment to reduce combined sewer overflows cso hydrocad allows for rating curves to be applied to orifices so that the hydraulic grade line can be modeled through the bioretention cell profile lucas 2008 although hydrocad is a design storm model it was compared with a continuous simulation model swmm outflow hydrograph volumes and peak flows were compared with good agreement b 2 6 hydrus hydrus 1d is a long term continuous model that was originally developed to model flow and transport through variably saturated porous media its benefits are flexible flow boundary conditions a small calculation time step and unlimited simulation time meng et al 2014 meng et al 2014 was the first to apply hydrus 1d to two bioretention cells in beijing that had been continuously monitored for 33 artificial rainfall events and five natural rainfall events the measured infiltration rate over time was compared to the outputs of hydrus 1d for model validation following model validation design parameters were optimized with the model to evaluate performance under different conditions li et al 2018 also applied hydrus 1d to three bioretention cells for optimization of parameters such as media characteristics and thickness with good model agreement for water volume nse 0 86 0 90 additionally the two dimensional richards equation model hydrus 2d 3d was applied to a bioretention cell in ohio to calculate a mass balance of outflow evaluate subsurface water dynamics and assess model sensitivity to soil properties stewart et al 2017 this study also addressed bioretention cell effects on csos and groundwater the water levels measured from nearby wells had good agreement with the modeled water levels over the entire three year period rmsd 0 026 0 12 m the most recent study to use hydrus for bioretention modeling to address seasonal effects on rain garden performance nichols et al 2021 two seasons warm and cold were combined with two flow intensities high and low to represent potential flows year round the measured ponding depth and soil moisture in the bioretention cells were compared to those predicted by hydrus to meet the design goals of no overflow for storms smaller than the design storm and drawdown of ponding did not exceed 24 h b 2 7 mouse mike urban the model for urban sewers mouse was developed by danish institute of hydrology in 2002 the model has since been updated to mike urban which can run simulations using the mouse swmm or mike 1d engine in 2016 the newest version of mike urban updated the user interface to incorporate dedicated lid controls including bioretention for lid practices it is noted that only the mike 1d engine is used and most lid practices can be represented by a soakaway node dhi 2017 a case study on application to a rain garden is presented by li and de costa 2016 xie et al 2017 used mike urban to address multiple lid practices in a single catchment and calibrated the model using the water level at a pumping station forebay in the catchment to achieve r2 ranging from 0 87 to 0 98 b 2 8 music music is widely used by urban catchment managers primarily in australia as a model to evaluate alternative stormwater management including hydrology water quality and even economic aspects the model includes bioretention as well as a range of other stormwater control measures and is based on extensive field and laboratory studies wong et al 2002 music uses continuous simulation based on user specified time step of between 6 min and 24 h music has a large emphasis on water quality prediction as its probabilistic water quality analysis has obtained good results ewater 2013 wong et al 2006 the overland flow hydrology in music is adapted from chiew and mcmahon 1997 for smaller temporal scales the bioretention hydrology is represented by a simple bucket model but it incorporates features specific to bioretention that could impact water quality such as effective versus non effective vegetation and internal water storage zones there have been multiple calibration studies that have compared music to measured catchment runoff and water quality in catchments with bioretention or rain gardens gagrani et al 2014 hamel and fletcher 2014a 2014b imteaz et al 2013 the model performed well for runoff at 6 min to hourly intervals using multiple metrics such as the correlation coefficient r2 0 81 and r2 0 82 for calibration and validation respectively by gagrani et al 2014 and nash sutcliffe efficiency nse 0 59 0 64 hamel and fletcher 2014b nse 0 49 0 58 hamel and fletcher 2014a nse 0 49 0 81 dotto et al 2011 however water quality performance suffered in calibration studies imteaz et al 2013 dotto et al 2011 catchment scale studies have investigated model structure and sensitivity for watershed hydrology but less focus has been given to individual bioretention cells hamel and fletcher 2014b burns et al 2012 dotto et al 2011 elliott et al 2009 b 2 9 recarga recarga is a numerical model developed in matlab as a design tool to evaluate performance of bioretention cells rain gardens and infiltration trenches to meet design objectives or to understand flow behavior with varying design components atchison et al 2006 the model reports total and hourly volumes for each water balance component over the continuous or single event time period simulated the first study to use recarga compared it to a similar model recharge which used the richards equation for infiltration instead of the green ampt method recarga was found to produce runoff recharge and ponding depth results analogous to recharge dussaillant et al 2003 it has been used to size bioretention cells investigate systems with and without underdrains and evaluate effects of the bioretention to treatment area ratio on exfiltration into groundwater boancă et al 2018 gao et al 2018 montgomery et al 2010 turney and neilson 2010 muthanna et al 2007 b 2 10 swat the soil water assessment tool swat was developed by the u s department of agriculture agricultural research service usda ars to evaluate the effect of best management practices bmps at a catchment scale although this model is a very detailed water balance model it was developed for agricultural purposes and requires significant modification for urban applications such as adjustment for small catchments and small time scales and updating et and infiltration processes hunt et al 2009 a study by christianson 2003 used swat to model bioretention cells implicitly by considering bioretention cells as ponds however christianson 2003 asserted that swat needed updates to be well suited for urban applications jeong et al 2010 described updated urban bmp algorithms in swat specific lid modules were added to swat for green roofs rain gardens porous pavement and cisterns and tested against an experimental rain garden and green roof her et al 2017 these were used in a later study which reported lumped lid benefits including rain gardens at a watershed scale seo et al 2017 swat has the potential to be beneficial for long term catchment scale modeling of lid practices but more research and modifications are needed b 2 11 swmm the u s epa stormwater management model swmm has become one of the most widely used models for bioretention especially since the release of swmm5 which includes dedicated lid modules rossman 2010 swmm has many applications for catchment hydrology provides several methods for hydrological and hydraulic processes and other input parameters and reports outflow hydrographs and peak flows aad et al 2010 was one of the first to model a rain garden no underdrain present with the swmm lid module while rosa et al 2015 was the first to investigate calibration of lid catchments in swmm swmm has been applied to bioretention in many case studies for lid watersheds avellaneda et al 2017 sun et al 2014 mccutcheon and wride 2013 bosley 2008 swmm has also been used to address specific design elements such as design storms bioretention surface areas soil mixtures and iws zones lynn et al 2018 yang and chui 2018 zhang et al 2018b gülbaz and kazezyılmaz alhan 2017b liu and fassman beck 2017 lynn et al 2018 compared the use of the bioretention lid module added to swmm5 with the traditional swmm framework in the context of capabilities modeling the iws zone more recently swmm has been applied to groundwater interactions with bioretention cells kim et al 2019 zhang et al 2018a other studies attempt to combine swmm with other bioretention models such as hydrus 1d tu et al 2020 lynn et al 2018 winslamm tiveron et al 2018 recarga sun et al 2011 and hydrocad lucas 2010 gulbaz and kazezyilmaz alhan 2017b compare the model hm rwb to swmm and concluded that swmm performed well compared to experimental drainage from column studies r2 0 66 0 76 but the hm rwb performed better r2 0 77 0 85 these studies have proven that swmm is capable of modeling bioretention cells although more studies are needed which focus on hydrologic behavior of individual bioretention cells through calibration and validation of swmm to measured bioretention cell data a couple of recent studies have demonstrated the sensitivity and performance of the flow processes of the lid modules in swmm but so far have been compared to limited measured data fassman beck and saleh 2021 lisenbee 2020 platz et al 2020 appendix c bioretention model inputs and outputs table c 1 input and output components of all evaluated models dark colored boxes indicate an input feature required in the model and output capabilities light colored boxes indicate an optional input feature general input categories catchment properties bioretention cell design climate soil and vegetation table c 1 
