index,text
20735,the article presents equations for the estimation of steel motor yacht light displacement based on selected design parameters such as length overall draught and breadth the data of 240 build steel motor yachts from 2000 to 2020 with lengths from 30 m to 86 m were used to develop these equations the complex design equations based on all design parameters were developed through the use of computational intelligence techniques such as random search and artificial neural networks the simple relationships based on only one input design parameter were developed using common linear and non linear regression the study showed that the random search method which utilizes a multiple nonlinear regression model offers good results that are as accurate as those developed through the use of artificial neural networks the developed equations may have practical application for the parametric design of yachts keywords yacht preliminary design artificial neural network regression light displacement 1 introduction calkins et al stated that yacht design is a multistage process a fact echoed by ship design methods presented by papanikolaou 2012 these stages can be described through concept design preliminary design and detail design at the concept and preliminary design stages major design issues are conceptualized such as basic dimensions and hull shape larsson and elaisson 2000 presented a yacht design methodology as an iterative process which is known as a design spiral where main yacht parameters are adjusted in the first spiral turn designing a modern motor yacht is a design challenge due to specific design tasks primarily the main design goal is to develop a hull which is optimal due to its hydrodynamic properties secondly the yacht should be attractive and offer clear aesthetic value for the customer therefore if we take all of these aspects into account the main challenge in yacht design process is hull modelling due to applied design methodology based on a design spiral various hull modelling methods were developed and can be used at the preliminary design stage in particular automatic hull surface modelling methods have been refined rodríguez et al 2012 described this type of method as a new category of cad applications devoted to the definition and parameterization of the hull form known as programmed design in many publications by for example calkins et al 2001 mancuso 2006 pérez et al 2008 ingrassia et al 2017 and shahroz et al 2017 presented various methods of hull shape modelling though the use of computer based methods at the concept or preliminary design stage one particularly interesting method was developed by shahroz et al 2017 in which the hull was divided into three regions entrance middle and run and each region was represented separately through this method a designer is able to offer greater design flexibility and this can lead to greater hull design variations zhang 2008 presented a parametric approach to hull form design which offered the ability to quickly generate and add variations in hull form as well as enabling the hydrodynamic optimization of the hull within the design process hull appearance and client impression is the next task for the designer this research field is known as emotional design and was developed by sharma et al 2016 this design process is aimed towards the creation of certain emotions in customers dogan et al 2017 developed a new method for the selection of hulls which were seen as being especially attractive to clients and utilized artificial neural networks this study suggested an adjective based design concept for yacht hulls where hulls were expressed through adjectives such as strong or speedy these descriptive hull adjectives can serve as a bridging language that can be used simplify the dialogue between yacht designers and their customers larsson and elaisson noted 2000 that the first step in the creation of a spiral design is to select the following characteristics according to the designers requirements for the desired yacht basic dimensions such as overall and waterline length maximum and waterline beam freeboard forward and aft draft light displacement also known as light weight displacement volume prismatic block and midship coefficient the development of a yacht hull is based on the above characteristics in the next design stages during the preliminary design phase it is very important to examine the following buoyancy equation which binds basic yacht dimensions to its light displacement 1 l h b t c b ρ ltd dwt where lh hull length b beam t draft cb block coefficient ltd light displacement dwt deadweight the light displacement of a motor yacht could be subdivided in a number of different ways but the following major approaches are commonly used a weight breakdown system common to merchant ships watson 1998 schneekluth 1998 papanikolaou 2012 2 ltd ws weo wm where ws weight of steel structure weo weight of equipment and outfitting wm weight of machinery a weight breakdown system common to motor yacht developed by benetti yard sugimoto 2012 3 ltd w 1 w2 w3 w4 w5 w6 w7 w8 w9 where w1 weight of hull structure and superstructures w2 weight of insulation and outfitting such as external decks outfitting painting insulation windows and doors w3 weight of auxiliary machinery such as bilge fire fighting fuel fresh water and exhaust gas equipment w4 weight of piping w5 weight of ventilation air conditioning and fridges w6 weight of electric and electronic systems such as main and emergency electric system lighting navigation communication and entertainment w7 weight of machinery such as main propulsion system generators bow thruster and fin stabilizers w8 weight of joinery and partitions such as furniture ceiling and walls w9 weight of liquids such as oil and water for main machinery lubrication oil and fire fighting system to accurately estimate light displacement the most effective method is to sum up the mass of all of the yacht s components though in many cases there is insufficient data to calculate the mass of the light yacht using this method at the parametric design stage this is a particular problem at the parametric design stage therefore the estimation of yacht light displacement is key at this stage of yacht design and is often more important considerations of hull shape at the preliminary design stage the following methods are commonly used to solve this problem the comparison of similar types of yachts the use of statistical methods to estimate the light displacement by using data from yacht databases by using the aforementioned methods and available data it is possible to estimate the weight of selected components such as structure equipment outfitting and machinery or the total lightweight of the yacht in open literature there are no methods for estimating the weight of components that are specifically dedicated to the parametric design of a motor yacht to some degree the weight estimation methods used in ship design theory for a standard merchant ship may be used to estimate the structural weight of smaller or specialized vessels such as motor yachts watson and gilfillan 1976 introduced structural weight estimation in merchant ship design while the method was originally designed for use in the case of standard merchant ships it is being adapted for use in the case of smaller and more specialized vessels the weight of the structure can be estimated using the following equation in the method 4 w s w s 1 1 0 5 c b 0 8 d 0 7 where c b0 8d block coefficient measured at 0 8 d w s1 weight calculated as follows 5 ws1 k e1 36 where k is taken from the table depending on the type of ship for frigates and corvettes k 0 023 e is calculated as follows 6 e l b d 0 85 l d d 0 85 l 1 h 1 0 75 l 2 h 2 where l b d d length breadth depth and draught in general l1 h1 length and height of superstructures l2 h2 length and height of deckhouses other commonly used methods for determining the weight of steel structures that can be used for smaller ships largely depend on the following relationships watson 1998 schneekluth 1998 papanikolaou 2012 7 ws k la bb dc 8 ws k la bb dc cbd d 9 ws k l b d a where cbd block coefficient based on depth k a b c d coefficients coefficients in equations 7 9 can be calculated using regression analysis or similar ship characteristics karayannis et al 1999 proposed a weight prediction method based on watson s method for fast ferries with lengths ranging from 40 to 120 m this approach is based on a corrected formula 6 which takes into account the different specific weights of the hull s underwater and above water parts without superstructures and deckhouses as follows 10 e m l b d 0 85 l d d karayannis et al used linear regression to approximate the e m factor as follows grubisic 2008 11 e m 0 974 l b d 0 365 grubisic 2008 proposed a set of regression equations for estimating small craft weight these regressions were developed using data from 34 vessels ranging in length from 10 to 65 m and with detailed weight breakdowns but only 5 motor yachts were used in the study grubisic developed the following regression equations to estimate structure weight wk by using watson s method as follows 12 wk 0 0112 e s 1 3318 where e s effective surface area propulsion weight w 200 as follows 13 w 200 l b d p b 0 45 31 45 where pb propulsion power electrical machinery weight w 300 as follows 14 w 300 0 036 l b d p e g 0 466 where p eg electrical power electronic equipment weight w400 as follows 15 w 400 0 00053 l 2 254 electronic equipment weight w400 for small vessels as follows 16 w 400 0365 0 015 l b d auxiliary machinery weight w500 as follows 17 w 500 0 000772 l b 1 784 outfitting weight w600 as follows 18 w 600 0 0097 l 2 132 special systems weight w 700 as follows 19 w 700 0 000168 l 2 936 because the grubisic method was developed by the use the data of only 5 motor yachts it should be tested when applied for motor yacht design due to variations in equipment and propulsion well known methods used in ship design theory to estimate equipment outfitting and machinery weight given in watson 1998 schneekluth 1998 and papanikolaou 2012 are inapplicable to motor yacht design there are various estimation methods in open literature that can be used to estimate the total lightweight of typical cargo ships for parametric design piko 1980 kristensen 2013 2014 and papanikolaou 2014 prepared a set of regression analyses and equations for estimation of light ship mass for various types of ships by using statistical methods grubisic developed a lightweight regression model by the use of displacement of 143 different small crafts with lengths ranging from 10 to 55 m in the aforementioned study 2008 however these motor yachts were not included in the data ship collection unfortunately the number of regression functions for yacht light displacement estimation is rather scant in literature only vasconcellos et al 1999 and bortnowska 2014 presented statistical analyses of the light weight and the main characteristics of small motor yachts vasconcellos et al discussed the complexity of small recreational boat building and marketing in the usa and overseas to 1999 the paper presented a statistical analysis of boat dimensions weight and price based on a boatdss database which contained the data of 850 boat designs of up to 23 m in length the following equation was developed by using nonlinear regression in the paper to estimate hull weight on the basis of boat length 20 w h 599 142 exp 0 0796245 l where wh hull weight lb l length ft bortnowska developed a set of regressions which can be applied in the initial design stage to determine the basic dimensions displacement and light displacement of small recreational yachts bortnowska proposed the following regression to estimate yacht light displacement using the length and breadth product 21 ltd 1 35446 0 00673 loa b 1 81182 where ltd light displacement loa length overall b breadth but the database used in the research only contained 31 motor yacht designs built in europe with a length of up to 22 m 2 the aims of this research there is a small number of equations presented in literature to estimate light displacement based on design parameters such as hull length breadth or draft for a motor yacht with a length of over 30 m with this in mind the first aim of this research was to develop a set of single and complex design equations to estimate yacht light displacement ltd in this study the following yacht design parameters were considered to estimate light displacement loa overall length the distance between the extreme points of the hull measured parallel to the waterline of the loaded yacht excluding hull equipment elements b breadth the distance from the inside of the plating on one side to a similar point on the other side measured at the broadest part of the yacht t draught the vertical distance measured amidships from the waterline to the underside of the keel loaxb the product of loa and b relating to the surface area of the yacht deck the single design equation took only one parameter as input the complex design equations based on all these design parameters and their combinations are as follows 22 ltd f loa b d where ltd estimated yacht light displacement f a design formula to calculate light displacement in naval engineering yacht light displacement is estimated by using various design parameters bortnowska 2014 estimated the light displacement of a small motor yacht on the basis of the length and surface area of the deck calculated as product of length and breadth vasconcelos et al estimated the light displacement of a high speed boat on the basis of its length bortnowska 2014 and vasconcelos developed regression equations for small motor yachts it is not known whether the regression equations for large motor yachts could be based on these parameters therefore the second aim of this study was to identify the best worst parameters among all of the above design parameters that offer the most effective estimation of light displacement in this article the data of 240 steel motor yachts with lengths from 30 m to 86 m were used that were built from 2000 to 2020 the data source was sea web ships 2020 the sea web ship database is a collection of yachts including sister yachts that are of matching or similar parameters and dimensions verification was carried out to remove vessels that were identical or had similar characteristics the database was divided into two groups in order to arrive at more efficient results and to minimize the impact of the configuration and materials needed to outfit extremely small and large yachts small yachts ranging in length from 30 to 50 m large yachts ranging in length from 50 to 86 m the range of design parameter values for particular types are shown in table 1 3 research methods computational intelligence commonly defined as soft computing is a set of nature inspired computational methods such as artificial neural networks fuzzy logic evolutionary computation machine learning probabilistic reasoning statistics or regression random search method the common feature of these methods is using a heuristic approach which can lead to a less than optimal solution often in shipbuilding several computational intelligent methods are used to estimate various ship characteristics alkan et al 2004 used several algorithms to calculate fishing vessel stability parameters abramowski 2013 developed a model for the determination of effective ship power through the use of neural networks gurgen et al 2018 applied an artificial neural network to predict the main dimensions of chemical tankers ekinci et al 2011 used several soft computing methods to estimate the main design parameters of oil chemical tankers mao and chen 2018 applied an artificial neural network method to discover ship generated wave characteristics in an inland channel wang et al 2018 applied a radial basis function neural network to design a rudder roll stabilization system the list of articles where intelligent computational methods were used in naval engineering is long the authors usually conclude that these intelligent methods are better than conventional methods such as the regression method in this study the following methods were applied to estimate yacht light displacement common regression methods to develop simple design equations artificial neural networks and the author s method based on random searching to develop the complex design equations for more than one input parameter the third aim of the research was to compare the accuracy of these methods for the estimation of yacht light displacement 3 1 an assessment of estimation accuracy common statistical parameters such as the pearson correlation coefficient r and root mean square error rmse were used in order to assess the accuracy of the developed equations and compare the methods used these statistical parameters were calculated by the use of the following equations 23 r n l t d r l t d l t d r l t d n l t d r 2 l t d r 2 n l t d 2 l t d 2 24 rmse l t d r l t d 2 n where r the pearson correlation coefficient rmse a root mean square error ltdr a light displacement from the yacht database ltd an estimated light displacement n the number of yachts in database 3 2 an assessment of multicollinearity in regression model multicollinearity in statistics is a phenomenon in which one predictor variable in a regression model is linearly correlated with another predictor or predictors there are several methods to handle multicollinearity in the regression in this study variance inflation factor vif was applied to measure and assess multicollinearity vif factor is calculated separately for every predictor i in the regression model as follows 25 v i f i 1 1 r i 2 where vifi variance inflation factor for the predictor i r i 2 multiple correlation coefficient of a given predictor i and other predictors in the regression model a variance inflation factor value may range from 1 upwards there is no formal vif limit value usually when a regression model is only developed for identification purpose a multicollinearity must be considered and a low vif limit of 3 or 4 should be assumed generally for prediction purpose multicollinearity has no destructive effect on the model when the vif limit value does not exceed 10 therefore in this study this value was assumed as a vif limit value for all predictors in the regression model random search method in this study a random search method was used to develop regression models with more than one independent variable this search method is based on a modified multiple nonlinear regression model in which variables and base function are fully randomized a multiple nonlinear regression model was used by adamowski et al in 2010 as follows 26 y a 0 a 1 x i a 2 x j a 3 x i 2 a k x i x j where y dependent variable x independent variables a0 a1 ak regression coefficients k observation number in a common multiple nonlinear regression mnlr model the relationship between the dependent and independent variables are non linear adamowski et al 2010 meng tian yuehong su 2018 but the relation between the independent variables x and coefficients a continue to be linear in this study this mnlr model was modified by using a collection of power functions f1 f2 fk rather than linear and quadratic functions the following modified mnlr model was applied to develop the regression formulas for more than one input design parameter 27 ltd a0 a1 f1 x1 a2 f2 x2 as fk 3 xn 3 fk 2 xn 2 fk 1 xn 1 fk xn where x1 x2 xn input design parameters f1 f2 fk power functions a0 a1 ak regression coefficients the author developed a new algorithm to uncover the best equations through a process of independent variable randomization the general algorithm scheme is shown in fig 1 the most effective combinations of independent variables were randomly searched through all their possible combinations in this algorithm the base functions f1 f2 fk were found through the use of random search in a collection of power functions next a root mean square error rmse and variance inflation factor vif values for each regression model were calculated then the vif maximum value vifmax of all of the regression predictors was selected finally the best functions offering the lowest rmse error and vifmax value less than 10 were selected through a looped search and a list was created the author developed a computer application cepowski 2020 to implement this algorithm this program was applied to develop nonlinear regression equations presented in the article 3 3 artificial neural networks an artificial neural network model was developed through the analysis of a biological nervous structure a mathematical model of a neural network was created by the use of this structure and its signal transmission an artificial neural network is built from an input output and one or more hidden layers that consist of neurons haykin 1994 in an artificial neuron values from previous layers x1 x2 xn are transmitted by the use of bias and weights w0 w1 wn as follows 28 y φ i 0 n w i x i where x i neuron input signal y neuron output signal w i weights w 0 bias φ activation function the sum result value of every neuron was transmitted to the output through the use of an activation function a number of functions are often used as activation functions in the hidden layer and the output layer in this study the following activation functions were used purelin where the neuron activation is passed on directly as the output 29 y x standard logistic function 30 y 1 1 exp x the aim of the training process is to calculate the weight value wi of all neurons in a neural network structure on the basis of input and output data the main problems are the selection of the network structure and the calculation of neuron weight and bias values therefore different types of neural network structure and training methods were used in regression tasks a multilayer perceptron mlp consisting of an input hidden and output layer is often applied most often a backpropagation learning algorithm is utilized to calculate the weight and bias values of the neurons in this network overfitting phenomenon is the main problem in neural networks learning a test set method is usually used to detect and avoid this phenomenon in this method about 50 70 percent of randomly selected data is used for network training the remaining data is used for network validating during training and network testing in this study various types of neural networks were used to estimate light displacement to develop the neural networks the following assumptions were made sum of square function as an error function backpropagation algorithm patterson 1996 haykin 1994 fausett 1994 scaled conjugate and gradient descent and levenberga marquardt bishop 1995 shepherd 1997 as a learning algorithm linear and logistic sigmoid as activation functions training validation and test sets include 50 25 and 25 percent of all cases respectively root mean square error rmse and pearson correlation coefficient r were used to measure the accuracy assessment of the neural networks 4 results and discussion the result of the research was a set of equations for the estimation of yacht light displacement formulas for only one design parameter as an input through the use of linear and nonlinear regression more than one design parameter as inputs by using a random search method and artificial neural networks the result of the research was a set of equations for the estimation of formulas for yacht light displacement only one design parameter as an input by using linear and nonlinear regression more than one design parameters as inputs by using random searching method and artificial neural networks 4 1 simple design formulas utilising the only one design parameter the research shows that the most accurate equations for light displacement estimate for only one design parameter calculated through the use of linear and nonlinear regression are as follows small yachts 31 ltd 0 0372 loa2 4136 32 ltd 0 0585 b4 011 33 ltd 62 36 d1 7744 34 ltd 0 0177 loaxb 1 6607 large yachts 35 ltd 0 0384 loa2 4213 36 ltd 1769 7 243 4 b 37 ltd 27 785 d2 8346 38 ltd 377 98 1 8295 loaxb where ltd light displacement t loa length overall m b breadth m d draught moulded m loaxb product of loa and b m2 the values of the root mean square error and pearson r squared coefficient relating to regressions 31 38 are given in table 2 figs 2 and 3 show the relationship between lbp b d loaxb and ltd and residuals calculated using these regressions the residuals were calculated as the difference between the estimated and observed value of ltd this figure suggests that heteroscedasticity may be present in equation 31 33 and 35 37 in this group of parameters the product of loa and b has the most impact on ltd the use of this parameter offers small rmse error estimation values which are 60 22 t for small yachts 100 7 t for large yachts high pearson correlation coefficient values which are 0 84 for small yachts 0 95 for large yachts the significance of dependencies 34 and 38 is also confirmed by the residuals shown in figs 2 and 3 and low errors ranging from 110 to 100 t for small yachts and from 320 to 230 for large yachts heteroscedasticity is not present in the regression models based on parameter loaxb 4 2 complex design formulas using more than one design parameter developed by the use of random search method table 3 shows a list of 9 complex regression equations developed for small yachts by using the random search method the search was begun from multiple linear model 39 but the d predictor in this model was not statistically significant therefore it was removed the other models did not contain this predictor the author s computer application cepowski 2020 was used to support this search fig 4 shows rmse value changes through the evolution of equations presented in table 3 by the use of random search method root mean square error pearson correlation coefficient r and the vif maximum values of all these equations are presented in table 4 this table shows that equation 47 is the most accurate of all of the equations that were developed using this method this equation is characterised by the lowest rmse value equals 35 3 t the highest pearson correlation coefficient value equals 0 947 and a relatively low vif value calculated as equalling 3 2 an analysis of variance and regression the overall p values of f test and the individual p values presented in tables 5 and 6 show that equation 47 and all of the predictors in this equation are statistically significant the t values presented in table 6 show that the a2 loa 0 44 predictor is statistically the most significant of all predictors of this regression using the method described above the following equation was developed to estimate the light displacement ltd of large yachts 48 ltd 11799 5 0 141 b3 4 8210 16 loa0 1 1 16649 b2 65 d 3 3 loa0 7 equation 48 is characterized by small rmse estimation value which is 74 9 t a high pearson correlation coefficient value which is 0 974 a small vif maximum value of all regression predictors which equals 3 4 figs 5 and 6 show the regression and residuals graphics of equation 47 and 48 these figures indicate the largest portion of data that coincided with a zero error line in the error range from around 25 to 40 tonnes for equation 47 71 do 75 tonnes for equation 48 the residual plots in figs 5 and 6 suggest that heteroscedasticity is not present in equations 47 and 48 4 3 complex design formulas utilising more than one design parameter developed through the use of artificial neural networks in this study artificial neural networks were trained and tested with statistica software tibco 2017 the following neural networks for light displacement regression were found multilayer perceptron mlp generalized regression neural network grnn radial basis function network rbf linear network ln overall length breadth and draught were used as an input layer and light displacement mass was used as the output layer for the neural networks various numbers of neurons in the hidden layer s and training methods were tested in order to acquire the closest output values to the data observed the number of neurons in the first hidden layer was equal to the number of training cases in the grnn neural network tables 7 and 8 show the types and number of neurons in the hidden layers as well as the training methods and rmse errors of the developed neural networks to estimate the light displacement ltd of small and large yachts a network which offers the smallest testing error is usually referred to as the best neural network it can be observed in tables 7 and 8 that from among all of the network types the best solution was obtained while using the mlp neural network with one neuron in the hidden layer the rmse error values of the network to estimate the light displacement ltd of small yachts calculated as 47 1 26 8 and 47 1 tonnes for training validation and test sets respectively large yachts calculated as 75 5 74 and 95 3 tonnes for training validation and test sets respectively these values lead to a small difference between a validation and testing error in relation to rmse error in the training set statistics for the test set are particularly important as the data in this set was only used to test the network not develop it the test set statistic values testify to the ability of this network to generalize new cases the rmse error values for the test data vary slightly from training and validation set statistics as a result these neural networks are probably not overfitted and could offer generalization ability the structure of these neural networks is the same and shown visually in fig 7 figs 8 and 9 show the scattering of points and residuals for training validation and test sets as well as an error histogram for all sets these figures indicate that the largest portion of the data coincided with a zero error line in the error range from about 50 to 50 tonnes to estimate the light displacement of small yachts 100 to 100 tonnes to estimate the light displacement of large yachts the mathematical form of the neural networks to estimate the light displacement ltd of small yachts is shown in the following relations 49 l t d 483 091 2 186 1 e x p v 1 0 89 0 2567 large yachts is shown in the following relations 50 l t d 1213 1 7945 1 e x p v 2 0 3939 0 3751 where ltd the light displacement t v 1 v 2 variables calculated from the following relations 51 v 1 0 41 b 0 3952 2 7668 1 433 d 0 372 0 595 0 82 loa 0 048 1 416 0 864 52 v 2 1 192 b 0 2083 1 875 0 807 d 0 6667 1 8 0 82 loa 0 0307 1 561 1 4723 where b is the breadth m d is the draught m loa is the length over all m tables 7 and 8 show that minimal errors were found in grnn network training sets but a light displacement estimation by the use of these neural networks leads to large increases in rmse error values in the validation and test sets for example rmse error values of grnn network no 8 in table 8 were calculated as 63 9 91 6 and 94 2 tonnes for the training validation and test sets these values led to large difference between a validation and testing error of 43 and 47 in relation to a rmse error in the training set this can result in the phenomenon of overfitting and an inability to generalize the data in this neural network the use of the rbf neural network offered acceptable estimates and was more accurate than the grnn neural network estimations the mlp no 1 networks in tables 7 and 8 deserve special attention due to their simple structure only one neuron in the hidden layer and small differences in rmse error between validation test and training sets as well as relatively small errors in all sets this proves that a neural network with even a small number of neurons in the hidden layer can offer good prediction and generalization capabilities 4 4 a comparison of methods in terms of estimation accuracy table 9 shows the values of root mean square error and pearson correlation coefficient relating to the best models of each method this table shows that equations developed using computational intelligence techniques such as random search and artificial neural networks are much more accurate than equations developed using the standard approach which focus on linear and nonlinear regressions this table also indicates that equations 47 and 48 developed using the random search method are the most accurate 5 conclusions the goals of this research were as follows 1 to develop the most accurate formulas for the estimation of yacht light displacement 2 to indicate the best worst parameters which have the greatest effect on yacht light displacement 3 to compare the application of the artificial neural network and the nonlinear regression method for the estimation of yacht light displacement in this study relatively accurate formulas for the estimation of yacht light displacement were developed separately for small yachts ranging in length from 30 to 50 m large yachts ranging in length from 50 to 86 m this approach meant that to some extent the differences between the design characteristics of extremely large and small yachts such as superstructures or outfitting could be taken into account as a result of this approach yacht light displacement errors were relatively low and depending on the method used only equalled from 35 to 60 tonnes for small yachts from 75 to 101 tonnes for large yachts aside from standard linear and nonlinear regression methods computational intelligence techniques such as artificial neural networks and the author s random search approach were used to develop these equations this is an improvement over previous studies in which design equations were developed using classical statistical methods it was found that the use of computational intelligence techniques was more successful than that of linear and non linear regression methods the random search method proved to be the most effective of these methods and the formulas 47 and 48 developed through the use of this method are the most accurate and offer the lowest root mean square error and highest pearson correlation coefficient values in the simple design equations the product of loa and b has the greatest effect on the light displacement of a small and large motor yacht this was also confirmed in a bortnowska study 2016 which stated that the deck area is an appropriate parameter for the estimation of yacht light displacement in contrast the draught of a large motor yacht has the lowest effect on light displacement in complex design equations length over all loa breadth b and draught d have the greatest effect on the light displacement of a small and large motor yacht the design formulas presented in this article have been developed for the practical use of yacht designers in this respect an important factor is the possibility of using these formulas for the manual calculation by a layman with a basic knowledge of computer techniques taking this into account equations 34 38 47 and 48 developed by the aforementioned regression methods may be implemented easily for example in a spreadsheet these equations are easily applicable to manual calculations without the need additional computer software a yacht designer can easily check basic buoyancy formula 1 using these equations however artificial neural network models are much more difficult to implement by a normal user this is due to the complicated neural network structure the need to normalize inputs and outputs and the activation of neurons the main advantage of the simple regression equation structure is to show the clear relationships between design parameters and light displacement the artificial neural network has a complex mathematical structure with which it is impossible to show these relationships clearly the use of artificial neural networks is required to detect overfitting phenomenon the neural networks developed in this research lost 50 data in total for validation and testing this mean that regression methods allow for a more effective use of data than neural networks as they does not require validation the weight estimation methods proposed in the article are an alternative approach to the methods used by watson and gilfillan 1976 karayannis et al 1999 and grubisic 2008 the formulas proposed in the article have the advantage of being developed primarily for steel motor yachts as a result these equations can take motor yacht characteristics into account to a greater degree than previous approaches the disadvantage of the proposed methods is that they cannot estimate the weight of the yacht s components however because of this simplification the relationships are mathematically clearer and the weight calculation phase is simpler the weight estimation approach presented in this article extends the methods proposed by vasconcellos et al 1999 and bortnowska 2014 and offers an estimated yacht weight to a much greater degree from 30 to 86 m in length it is also novel that the equations presented in the article were developed using database of the latest motor yachts as a result these equations could include the most recent trends in motor yacht development to an extent all of the equations expanded upon in this article can only by applied to steel motor yachts with regards to the min max range values parameter presented in table 1 these equations can only have practical application at the parametric design stage for the estimation of light displacement in the case of conventional motor yachts declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20735,the article presents equations for the estimation of steel motor yacht light displacement based on selected design parameters such as length overall draught and breadth the data of 240 build steel motor yachts from 2000 to 2020 with lengths from 30 m to 86 m were used to develop these equations the complex design equations based on all design parameters were developed through the use of computational intelligence techniques such as random search and artificial neural networks the simple relationships based on only one input design parameter were developed using common linear and non linear regression the study showed that the random search method which utilizes a multiple nonlinear regression model offers good results that are as accurate as those developed through the use of artificial neural networks the developed equations may have practical application for the parametric design of yachts keywords yacht preliminary design artificial neural network regression light displacement 1 introduction calkins et al stated that yacht design is a multistage process a fact echoed by ship design methods presented by papanikolaou 2012 these stages can be described through concept design preliminary design and detail design at the concept and preliminary design stages major design issues are conceptualized such as basic dimensions and hull shape larsson and elaisson 2000 presented a yacht design methodology as an iterative process which is known as a design spiral where main yacht parameters are adjusted in the first spiral turn designing a modern motor yacht is a design challenge due to specific design tasks primarily the main design goal is to develop a hull which is optimal due to its hydrodynamic properties secondly the yacht should be attractive and offer clear aesthetic value for the customer therefore if we take all of these aspects into account the main challenge in yacht design process is hull modelling due to applied design methodology based on a design spiral various hull modelling methods were developed and can be used at the preliminary design stage in particular automatic hull surface modelling methods have been refined rodríguez et al 2012 described this type of method as a new category of cad applications devoted to the definition and parameterization of the hull form known as programmed design in many publications by for example calkins et al 2001 mancuso 2006 pérez et al 2008 ingrassia et al 2017 and shahroz et al 2017 presented various methods of hull shape modelling though the use of computer based methods at the concept or preliminary design stage one particularly interesting method was developed by shahroz et al 2017 in which the hull was divided into three regions entrance middle and run and each region was represented separately through this method a designer is able to offer greater design flexibility and this can lead to greater hull design variations zhang 2008 presented a parametric approach to hull form design which offered the ability to quickly generate and add variations in hull form as well as enabling the hydrodynamic optimization of the hull within the design process hull appearance and client impression is the next task for the designer this research field is known as emotional design and was developed by sharma et al 2016 this design process is aimed towards the creation of certain emotions in customers dogan et al 2017 developed a new method for the selection of hulls which were seen as being especially attractive to clients and utilized artificial neural networks this study suggested an adjective based design concept for yacht hulls where hulls were expressed through adjectives such as strong or speedy these descriptive hull adjectives can serve as a bridging language that can be used simplify the dialogue between yacht designers and their customers larsson and elaisson noted 2000 that the first step in the creation of a spiral design is to select the following characteristics according to the designers requirements for the desired yacht basic dimensions such as overall and waterline length maximum and waterline beam freeboard forward and aft draft light displacement also known as light weight displacement volume prismatic block and midship coefficient the development of a yacht hull is based on the above characteristics in the next design stages during the preliminary design phase it is very important to examine the following buoyancy equation which binds basic yacht dimensions to its light displacement 1 l h b t c b ρ ltd dwt where lh hull length b beam t draft cb block coefficient ltd light displacement dwt deadweight the light displacement of a motor yacht could be subdivided in a number of different ways but the following major approaches are commonly used a weight breakdown system common to merchant ships watson 1998 schneekluth 1998 papanikolaou 2012 2 ltd ws weo wm where ws weight of steel structure weo weight of equipment and outfitting wm weight of machinery a weight breakdown system common to motor yacht developed by benetti yard sugimoto 2012 3 ltd w 1 w2 w3 w4 w5 w6 w7 w8 w9 where w1 weight of hull structure and superstructures w2 weight of insulation and outfitting such as external decks outfitting painting insulation windows and doors w3 weight of auxiliary machinery such as bilge fire fighting fuel fresh water and exhaust gas equipment w4 weight of piping w5 weight of ventilation air conditioning and fridges w6 weight of electric and electronic systems such as main and emergency electric system lighting navigation communication and entertainment w7 weight of machinery such as main propulsion system generators bow thruster and fin stabilizers w8 weight of joinery and partitions such as furniture ceiling and walls w9 weight of liquids such as oil and water for main machinery lubrication oil and fire fighting system to accurately estimate light displacement the most effective method is to sum up the mass of all of the yacht s components though in many cases there is insufficient data to calculate the mass of the light yacht using this method at the parametric design stage this is a particular problem at the parametric design stage therefore the estimation of yacht light displacement is key at this stage of yacht design and is often more important considerations of hull shape at the preliminary design stage the following methods are commonly used to solve this problem the comparison of similar types of yachts the use of statistical methods to estimate the light displacement by using data from yacht databases by using the aforementioned methods and available data it is possible to estimate the weight of selected components such as structure equipment outfitting and machinery or the total lightweight of the yacht in open literature there are no methods for estimating the weight of components that are specifically dedicated to the parametric design of a motor yacht to some degree the weight estimation methods used in ship design theory for a standard merchant ship may be used to estimate the structural weight of smaller or specialized vessels such as motor yachts watson and gilfillan 1976 introduced structural weight estimation in merchant ship design while the method was originally designed for use in the case of standard merchant ships it is being adapted for use in the case of smaller and more specialized vessels the weight of the structure can be estimated using the following equation in the method 4 w s w s 1 1 0 5 c b 0 8 d 0 7 where c b0 8d block coefficient measured at 0 8 d w s1 weight calculated as follows 5 ws1 k e1 36 where k is taken from the table depending on the type of ship for frigates and corvettes k 0 023 e is calculated as follows 6 e l b d 0 85 l d d 0 85 l 1 h 1 0 75 l 2 h 2 where l b d d length breadth depth and draught in general l1 h1 length and height of superstructures l2 h2 length and height of deckhouses other commonly used methods for determining the weight of steel structures that can be used for smaller ships largely depend on the following relationships watson 1998 schneekluth 1998 papanikolaou 2012 7 ws k la bb dc 8 ws k la bb dc cbd d 9 ws k l b d a where cbd block coefficient based on depth k a b c d coefficients coefficients in equations 7 9 can be calculated using regression analysis or similar ship characteristics karayannis et al 1999 proposed a weight prediction method based on watson s method for fast ferries with lengths ranging from 40 to 120 m this approach is based on a corrected formula 6 which takes into account the different specific weights of the hull s underwater and above water parts without superstructures and deckhouses as follows 10 e m l b d 0 85 l d d karayannis et al used linear regression to approximate the e m factor as follows grubisic 2008 11 e m 0 974 l b d 0 365 grubisic 2008 proposed a set of regression equations for estimating small craft weight these regressions were developed using data from 34 vessels ranging in length from 10 to 65 m and with detailed weight breakdowns but only 5 motor yachts were used in the study grubisic developed the following regression equations to estimate structure weight wk by using watson s method as follows 12 wk 0 0112 e s 1 3318 where e s effective surface area propulsion weight w 200 as follows 13 w 200 l b d p b 0 45 31 45 where pb propulsion power electrical machinery weight w 300 as follows 14 w 300 0 036 l b d p e g 0 466 where p eg electrical power electronic equipment weight w400 as follows 15 w 400 0 00053 l 2 254 electronic equipment weight w400 for small vessels as follows 16 w 400 0365 0 015 l b d auxiliary machinery weight w500 as follows 17 w 500 0 000772 l b 1 784 outfitting weight w600 as follows 18 w 600 0 0097 l 2 132 special systems weight w 700 as follows 19 w 700 0 000168 l 2 936 because the grubisic method was developed by the use the data of only 5 motor yachts it should be tested when applied for motor yacht design due to variations in equipment and propulsion well known methods used in ship design theory to estimate equipment outfitting and machinery weight given in watson 1998 schneekluth 1998 and papanikolaou 2012 are inapplicable to motor yacht design there are various estimation methods in open literature that can be used to estimate the total lightweight of typical cargo ships for parametric design piko 1980 kristensen 2013 2014 and papanikolaou 2014 prepared a set of regression analyses and equations for estimation of light ship mass for various types of ships by using statistical methods grubisic developed a lightweight regression model by the use of displacement of 143 different small crafts with lengths ranging from 10 to 55 m in the aforementioned study 2008 however these motor yachts were not included in the data ship collection unfortunately the number of regression functions for yacht light displacement estimation is rather scant in literature only vasconcellos et al 1999 and bortnowska 2014 presented statistical analyses of the light weight and the main characteristics of small motor yachts vasconcellos et al discussed the complexity of small recreational boat building and marketing in the usa and overseas to 1999 the paper presented a statistical analysis of boat dimensions weight and price based on a boatdss database which contained the data of 850 boat designs of up to 23 m in length the following equation was developed by using nonlinear regression in the paper to estimate hull weight on the basis of boat length 20 w h 599 142 exp 0 0796245 l where wh hull weight lb l length ft bortnowska developed a set of regressions which can be applied in the initial design stage to determine the basic dimensions displacement and light displacement of small recreational yachts bortnowska proposed the following regression to estimate yacht light displacement using the length and breadth product 21 ltd 1 35446 0 00673 loa b 1 81182 where ltd light displacement loa length overall b breadth but the database used in the research only contained 31 motor yacht designs built in europe with a length of up to 22 m 2 the aims of this research there is a small number of equations presented in literature to estimate light displacement based on design parameters such as hull length breadth or draft for a motor yacht with a length of over 30 m with this in mind the first aim of this research was to develop a set of single and complex design equations to estimate yacht light displacement ltd in this study the following yacht design parameters were considered to estimate light displacement loa overall length the distance between the extreme points of the hull measured parallel to the waterline of the loaded yacht excluding hull equipment elements b breadth the distance from the inside of the plating on one side to a similar point on the other side measured at the broadest part of the yacht t draught the vertical distance measured amidships from the waterline to the underside of the keel loaxb the product of loa and b relating to the surface area of the yacht deck the single design equation took only one parameter as input the complex design equations based on all these design parameters and their combinations are as follows 22 ltd f loa b d where ltd estimated yacht light displacement f a design formula to calculate light displacement in naval engineering yacht light displacement is estimated by using various design parameters bortnowska 2014 estimated the light displacement of a small motor yacht on the basis of the length and surface area of the deck calculated as product of length and breadth vasconcelos et al estimated the light displacement of a high speed boat on the basis of its length bortnowska 2014 and vasconcelos developed regression equations for small motor yachts it is not known whether the regression equations for large motor yachts could be based on these parameters therefore the second aim of this study was to identify the best worst parameters among all of the above design parameters that offer the most effective estimation of light displacement in this article the data of 240 steel motor yachts with lengths from 30 m to 86 m were used that were built from 2000 to 2020 the data source was sea web ships 2020 the sea web ship database is a collection of yachts including sister yachts that are of matching or similar parameters and dimensions verification was carried out to remove vessels that were identical or had similar characteristics the database was divided into two groups in order to arrive at more efficient results and to minimize the impact of the configuration and materials needed to outfit extremely small and large yachts small yachts ranging in length from 30 to 50 m large yachts ranging in length from 50 to 86 m the range of design parameter values for particular types are shown in table 1 3 research methods computational intelligence commonly defined as soft computing is a set of nature inspired computational methods such as artificial neural networks fuzzy logic evolutionary computation machine learning probabilistic reasoning statistics or regression random search method the common feature of these methods is using a heuristic approach which can lead to a less than optimal solution often in shipbuilding several computational intelligent methods are used to estimate various ship characteristics alkan et al 2004 used several algorithms to calculate fishing vessel stability parameters abramowski 2013 developed a model for the determination of effective ship power through the use of neural networks gurgen et al 2018 applied an artificial neural network to predict the main dimensions of chemical tankers ekinci et al 2011 used several soft computing methods to estimate the main design parameters of oil chemical tankers mao and chen 2018 applied an artificial neural network method to discover ship generated wave characteristics in an inland channel wang et al 2018 applied a radial basis function neural network to design a rudder roll stabilization system the list of articles where intelligent computational methods were used in naval engineering is long the authors usually conclude that these intelligent methods are better than conventional methods such as the regression method in this study the following methods were applied to estimate yacht light displacement common regression methods to develop simple design equations artificial neural networks and the author s method based on random searching to develop the complex design equations for more than one input parameter the third aim of the research was to compare the accuracy of these methods for the estimation of yacht light displacement 3 1 an assessment of estimation accuracy common statistical parameters such as the pearson correlation coefficient r and root mean square error rmse were used in order to assess the accuracy of the developed equations and compare the methods used these statistical parameters were calculated by the use of the following equations 23 r n l t d r l t d l t d r l t d n l t d r 2 l t d r 2 n l t d 2 l t d 2 24 rmse l t d r l t d 2 n where r the pearson correlation coefficient rmse a root mean square error ltdr a light displacement from the yacht database ltd an estimated light displacement n the number of yachts in database 3 2 an assessment of multicollinearity in regression model multicollinearity in statistics is a phenomenon in which one predictor variable in a regression model is linearly correlated with another predictor or predictors there are several methods to handle multicollinearity in the regression in this study variance inflation factor vif was applied to measure and assess multicollinearity vif factor is calculated separately for every predictor i in the regression model as follows 25 v i f i 1 1 r i 2 where vifi variance inflation factor for the predictor i r i 2 multiple correlation coefficient of a given predictor i and other predictors in the regression model a variance inflation factor value may range from 1 upwards there is no formal vif limit value usually when a regression model is only developed for identification purpose a multicollinearity must be considered and a low vif limit of 3 or 4 should be assumed generally for prediction purpose multicollinearity has no destructive effect on the model when the vif limit value does not exceed 10 therefore in this study this value was assumed as a vif limit value for all predictors in the regression model random search method in this study a random search method was used to develop regression models with more than one independent variable this search method is based on a modified multiple nonlinear regression model in which variables and base function are fully randomized a multiple nonlinear regression model was used by adamowski et al in 2010 as follows 26 y a 0 a 1 x i a 2 x j a 3 x i 2 a k x i x j where y dependent variable x independent variables a0 a1 ak regression coefficients k observation number in a common multiple nonlinear regression mnlr model the relationship between the dependent and independent variables are non linear adamowski et al 2010 meng tian yuehong su 2018 but the relation between the independent variables x and coefficients a continue to be linear in this study this mnlr model was modified by using a collection of power functions f1 f2 fk rather than linear and quadratic functions the following modified mnlr model was applied to develop the regression formulas for more than one input design parameter 27 ltd a0 a1 f1 x1 a2 f2 x2 as fk 3 xn 3 fk 2 xn 2 fk 1 xn 1 fk xn where x1 x2 xn input design parameters f1 f2 fk power functions a0 a1 ak regression coefficients the author developed a new algorithm to uncover the best equations through a process of independent variable randomization the general algorithm scheme is shown in fig 1 the most effective combinations of independent variables were randomly searched through all their possible combinations in this algorithm the base functions f1 f2 fk were found through the use of random search in a collection of power functions next a root mean square error rmse and variance inflation factor vif values for each regression model were calculated then the vif maximum value vifmax of all of the regression predictors was selected finally the best functions offering the lowest rmse error and vifmax value less than 10 were selected through a looped search and a list was created the author developed a computer application cepowski 2020 to implement this algorithm this program was applied to develop nonlinear regression equations presented in the article 3 3 artificial neural networks an artificial neural network model was developed through the analysis of a biological nervous structure a mathematical model of a neural network was created by the use of this structure and its signal transmission an artificial neural network is built from an input output and one or more hidden layers that consist of neurons haykin 1994 in an artificial neuron values from previous layers x1 x2 xn are transmitted by the use of bias and weights w0 w1 wn as follows 28 y φ i 0 n w i x i where x i neuron input signal y neuron output signal w i weights w 0 bias φ activation function the sum result value of every neuron was transmitted to the output through the use of an activation function a number of functions are often used as activation functions in the hidden layer and the output layer in this study the following activation functions were used purelin where the neuron activation is passed on directly as the output 29 y x standard logistic function 30 y 1 1 exp x the aim of the training process is to calculate the weight value wi of all neurons in a neural network structure on the basis of input and output data the main problems are the selection of the network structure and the calculation of neuron weight and bias values therefore different types of neural network structure and training methods were used in regression tasks a multilayer perceptron mlp consisting of an input hidden and output layer is often applied most often a backpropagation learning algorithm is utilized to calculate the weight and bias values of the neurons in this network overfitting phenomenon is the main problem in neural networks learning a test set method is usually used to detect and avoid this phenomenon in this method about 50 70 percent of randomly selected data is used for network training the remaining data is used for network validating during training and network testing in this study various types of neural networks were used to estimate light displacement to develop the neural networks the following assumptions were made sum of square function as an error function backpropagation algorithm patterson 1996 haykin 1994 fausett 1994 scaled conjugate and gradient descent and levenberga marquardt bishop 1995 shepherd 1997 as a learning algorithm linear and logistic sigmoid as activation functions training validation and test sets include 50 25 and 25 percent of all cases respectively root mean square error rmse and pearson correlation coefficient r were used to measure the accuracy assessment of the neural networks 4 results and discussion the result of the research was a set of equations for the estimation of yacht light displacement formulas for only one design parameter as an input through the use of linear and nonlinear regression more than one design parameter as inputs by using a random search method and artificial neural networks the result of the research was a set of equations for the estimation of formulas for yacht light displacement only one design parameter as an input by using linear and nonlinear regression more than one design parameters as inputs by using random searching method and artificial neural networks 4 1 simple design formulas utilising the only one design parameter the research shows that the most accurate equations for light displacement estimate for only one design parameter calculated through the use of linear and nonlinear regression are as follows small yachts 31 ltd 0 0372 loa2 4136 32 ltd 0 0585 b4 011 33 ltd 62 36 d1 7744 34 ltd 0 0177 loaxb 1 6607 large yachts 35 ltd 0 0384 loa2 4213 36 ltd 1769 7 243 4 b 37 ltd 27 785 d2 8346 38 ltd 377 98 1 8295 loaxb where ltd light displacement t loa length overall m b breadth m d draught moulded m loaxb product of loa and b m2 the values of the root mean square error and pearson r squared coefficient relating to regressions 31 38 are given in table 2 figs 2 and 3 show the relationship between lbp b d loaxb and ltd and residuals calculated using these regressions the residuals were calculated as the difference between the estimated and observed value of ltd this figure suggests that heteroscedasticity may be present in equation 31 33 and 35 37 in this group of parameters the product of loa and b has the most impact on ltd the use of this parameter offers small rmse error estimation values which are 60 22 t for small yachts 100 7 t for large yachts high pearson correlation coefficient values which are 0 84 for small yachts 0 95 for large yachts the significance of dependencies 34 and 38 is also confirmed by the residuals shown in figs 2 and 3 and low errors ranging from 110 to 100 t for small yachts and from 320 to 230 for large yachts heteroscedasticity is not present in the regression models based on parameter loaxb 4 2 complex design formulas using more than one design parameter developed by the use of random search method table 3 shows a list of 9 complex regression equations developed for small yachts by using the random search method the search was begun from multiple linear model 39 but the d predictor in this model was not statistically significant therefore it was removed the other models did not contain this predictor the author s computer application cepowski 2020 was used to support this search fig 4 shows rmse value changes through the evolution of equations presented in table 3 by the use of random search method root mean square error pearson correlation coefficient r and the vif maximum values of all these equations are presented in table 4 this table shows that equation 47 is the most accurate of all of the equations that were developed using this method this equation is characterised by the lowest rmse value equals 35 3 t the highest pearson correlation coefficient value equals 0 947 and a relatively low vif value calculated as equalling 3 2 an analysis of variance and regression the overall p values of f test and the individual p values presented in tables 5 and 6 show that equation 47 and all of the predictors in this equation are statistically significant the t values presented in table 6 show that the a2 loa 0 44 predictor is statistically the most significant of all predictors of this regression using the method described above the following equation was developed to estimate the light displacement ltd of large yachts 48 ltd 11799 5 0 141 b3 4 8210 16 loa0 1 1 16649 b2 65 d 3 3 loa0 7 equation 48 is characterized by small rmse estimation value which is 74 9 t a high pearson correlation coefficient value which is 0 974 a small vif maximum value of all regression predictors which equals 3 4 figs 5 and 6 show the regression and residuals graphics of equation 47 and 48 these figures indicate the largest portion of data that coincided with a zero error line in the error range from around 25 to 40 tonnes for equation 47 71 do 75 tonnes for equation 48 the residual plots in figs 5 and 6 suggest that heteroscedasticity is not present in equations 47 and 48 4 3 complex design formulas utilising more than one design parameter developed through the use of artificial neural networks in this study artificial neural networks were trained and tested with statistica software tibco 2017 the following neural networks for light displacement regression were found multilayer perceptron mlp generalized regression neural network grnn radial basis function network rbf linear network ln overall length breadth and draught were used as an input layer and light displacement mass was used as the output layer for the neural networks various numbers of neurons in the hidden layer s and training methods were tested in order to acquire the closest output values to the data observed the number of neurons in the first hidden layer was equal to the number of training cases in the grnn neural network tables 7 and 8 show the types and number of neurons in the hidden layers as well as the training methods and rmse errors of the developed neural networks to estimate the light displacement ltd of small and large yachts a network which offers the smallest testing error is usually referred to as the best neural network it can be observed in tables 7 and 8 that from among all of the network types the best solution was obtained while using the mlp neural network with one neuron in the hidden layer the rmse error values of the network to estimate the light displacement ltd of small yachts calculated as 47 1 26 8 and 47 1 tonnes for training validation and test sets respectively large yachts calculated as 75 5 74 and 95 3 tonnes for training validation and test sets respectively these values lead to a small difference between a validation and testing error in relation to rmse error in the training set statistics for the test set are particularly important as the data in this set was only used to test the network not develop it the test set statistic values testify to the ability of this network to generalize new cases the rmse error values for the test data vary slightly from training and validation set statistics as a result these neural networks are probably not overfitted and could offer generalization ability the structure of these neural networks is the same and shown visually in fig 7 figs 8 and 9 show the scattering of points and residuals for training validation and test sets as well as an error histogram for all sets these figures indicate that the largest portion of the data coincided with a zero error line in the error range from about 50 to 50 tonnes to estimate the light displacement of small yachts 100 to 100 tonnes to estimate the light displacement of large yachts the mathematical form of the neural networks to estimate the light displacement ltd of small yachts is shown in the following relations 49 l t d 483 091 2 186 1 e x p v 1 0 89 0 2567 large yachts is shown in the following relations 50 l t d 1213 1 7945 1 e x p v 2 0 3939 0 3751 where ltd the light displacement t v 1 v 2 variables calculated from the following relations 51 v 1 0 41 b 0 3952 2 7668 1 433 d 0 372 0 595 0 82 loa 0 048 1 416 0 864 52 v 2 1 192 b 0 2083 1 875 0 807 d 0 6667 1 8 0 82 loa 0 0307 1 561 1 4723 where b is the breadth m d is the draught m loa is the length over all m tables 7 and 8 show that minimal errors were found in grnn network training sets but a light displacement estimation by the use of these neural networks leads to large increases in rmse error values in the validation and test sets for example rmse error values of grnn network no 8 in table 8 were calculated as 63 9 91 6 and 94 2 tonnes for the training validation and test sets these values led to large difference between a validation and testing error of 43 and 47 in relation to a rmse error in the training set this can result in the phenomenon of overfitting and an inability to generalize the data in this neural network the use of the rbf neural network offered acceptable estimates and was more accurate than the grnn neural network estimations the mlp no 1 networks in tables 7 and 8 deserve special attention due to their simple structure only one neuron in the hidden layer and small differences in rmse error between validation test and training sets as well as relatively small errors in all sets this proves that a neural network with even a small number of neurons in the hidden layer can offer good prediction and generalization capabilities 4 4 a comparison of methods in terms of estimation accuracy table 9 shows the values of root mean square error and pearson correlation coefficient relating to the best models of each method this table shows that equations developed using computational intelligence techniques such as random search and artificial neural networks are much more accurate than equations developed using the standard approach which focus on linear and nonlinear regressions this table also indicates that equations 47 and 48 developed using the random search method are the most accurate 5 conclusions the goals of this research were as follows 1 to develop the most accurate formulas for the estimation of yacht light displacement 2 to indicate the best worst parameters which have the greatest effect on yacht light displacement 3 to compare the application of the artificial neural network and the nonlinear regression method for the estimation of yacht light displacement in this study relatively accurate formulas for the estimation of yacht light displacement were developed separately for small yachts ranging in length from 30 to 50 m large yachts ranging in length from 50 to 86 m this approach meant that to some extent the differences between the design characteristics of extremely large and small yachts such as superstructures or outfitting could be taken into account as a result of this approach yacht light displacement errors were relatively low and depending on the method used only equalled from 35 to 60 tonnes for small yachts from 75 to 101 tonnes for large yachts aside from standard linear and nonlinear regression methods computational intelligence techniques such as artificial neural networks and the author s random search approach were used to develop these equations this is an improvement over previous studies in which design equations were developed using classical statistical methods it was found that the use of computational intelligence techniques was more successful than that of linear and non linear regression methods the random search method proved to be the most effective of these methods and the formulas 47 and 48 developed through the use of this method are the most accurate and offer the lowest root mean square error and highest pearson correlation coefficient values in the simple design equations the product of loa and b has the greatest effect on the light displacement of a small and large motor yacht this was also confirmed in a bortnowska study 2016 which stated that the deck area is an appropriate parameter for the estimation of yacht light displacement in contrast the draught of a large motor yacht has the lowest effect on light displacement in complex design equations length over all loa breadth b and draught d have the greatest effect on the light displacement of a small and large motor yacht the design formulas presented in this article have been developed for the practical use of yacht designers in this respect an important factor is the possibility of using these formulas for the manual calculation by a layman with a basic knowledge of computer techniques taking this into account equations 34 38 47 and 48 developed by the aforementioned regression methods may be implemented easily for example in a spreadsheet these equations are easily applicable to manual calculations without the need additional computer software a yacht designer can easily check basic buoyancy formula 1 using these equations however artificial neural network models are much more difficult to implement by a normal user this is due to the complicated neural network structure the need to normalize inputs and outputs and the activation of neurons the main advantage of the simple regression equation structure is to show the clear relationships between design parameters and light displacement the artificial neural network has a complex mathematical structure with which it is impossible to show these relationships clearly the use of artificial neural networks is required to detect overfitting phenomenon the neural networks developed in this research lost 50 data in total for validation and testing this mean that regression methods allow for a more effective use of data than neural networks as they does not require validation the weight estimation methods proposed in the article are an alternative approach to the methods used by watson and gilfillan 1976 karayannis et al 1999 and grubisic 2008 the formulas proposed in the article have the advantage of being developed primarily for steel motor yachts as a result these equations can take motor yacht characteristics into account to a greater degree than previous approaches the disadvantage of the proposed methods is that they cannot estimate the weight of the yacht s components however because of this simplification the relationships are mathematically clearer and the weight calculation phase is simpler the weight estimation approach presented in this article extends the methods proposed by vasconcellos et al 1999 and bortnowska 2014 and offers an estimated yacht weight to a much greater degree from 30 to 86 m in length it is also novel that the equations presented in the article were developed using database of the latest motor yachts as a result these equations could include the most recent trends in motor yacht development to an extent all of the equations expanded upon in this article can only by applied to steel motor yachts with regards to the min max range values parameter presented in table 1 these equations can only have practical application at the parametric design stage for the estimation of light displacement in the case of conventional motor yachts declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20736,isogeometric analysis iga is an important emerging numerical method that is being studied in various field iga is proposed to seamlessly connect the computer aided engineering cae and the computer aided design cad systems so that the costly mesh generating stage in traditional finite element method fem can be skipped to improve the efficiency of design and analysis in this paper an iga approach is introduced to the hull structural mechanical analysis a reissner mindlin shell element is constructed in the iga framework and the expression of the element stiffness matrix and load vector are derived in detail using the proposed method a typical hull block structure is analyzed under both bending and torsion load the maximum relative error of the displacement results is 1 6 compared to the reference results obtained from ansys 17 0 and the correctness of the proposed method is verified it also proves that the proposed method can be used in engineering practice and can be used to realize the integration of design and analysis keywords isogeometric analysis hull structure reissner mindlin shell b spline surface 1 introduction finite element method fem is the most popular numerical method used in hull structural analysis while in the engineering practice building analysis model based on the geometric model is an extremely complex and laborious process although the auto meshing technology is mature meshing the geometric model is very complex and expensive because of the complexity of the hull structure when the scale of the structure is large and the topology is complex it often causes geometric errors and the loss of topology relationship when exporting the geometric model from computer aided design cad system to computer aided engineering cae system to fix that the following loop become very common in the analysis model building stage fix the geometric errors re specify the connecting relationship and re mesh the structures until the model s geometry and topology are correct however low quality meshes can still emerge if the mesh size and element type are not well chosen it is reported that the analysis model building stage takes up to 90 workload of the whole hull structural analysis process yu et al 2009 however the time consuming meshing process is only a mechanical repetitive inspection connection and correction work without any high tech content if this process can be omitted it will undoubtedly and greatly improve the design and analysis efficiency of designers and reduce their workload isogeometric analysis iga is firstly proposed by hughes et al 2005 to seamlessly connect cad and cae systems similar to the traditional fem iga is based on the discrete galerkin method and the idea of isoparametric element it takes smooth spline functions such as b spline functions non uniform rational b splines nurbs functions and pht spline functions as shape functions to discretize domains the shape functions mentioned before are widely used in current mainstream cad systems to represent geometries by using the same functions to represent the geometries and to discretize domains the gap between cad and cae system is bridged in the iga context iga patches can be directly inherited from the cad model and the control point mesh that represent geometries in cad system is used as analysis mesh without any other further meshing process this enables iga to omit the meshing stage in addition another major advantage of iga over traditional fem lies in the higher order continuity and powerful geometric expression capability of its shape functions which enable it to represent complex geometry with only one patch and to construct high order continuous element very easily and it leads to better accuracy than fem elements that use low order lagrangian interpolation functions as the shape functions bouclier et al 2013 iga has been successfully applied to the fields of solid structures cottrell et al 2006 elguedj et al 2008 bazilevs et al 2010 fluids bazilevs and hughes 2008 akkerman et al 2008 bazilevs and akkerman 2010 etc in the ship engineering field isogeometric boundary element method iga bem is introduced to wave related problems yildizdag et al 2019 belibassakis et al 2013 structural optimization iginnis et al 2013 kostas et al 2015 etc in the hull structural analysis field yu et al 2018 successfully introduced iga into hull structural analysis and proposed a framework to analyze hull structures with iga but their method used only membrane element to analyze the structures which can only be used for overall strength analysis however in many cases analysis results without bending stiffness are unacceptable hull structures are mainly composed of thin plates and stiffeners which are usually t bar and l bar in numerical simulation all components can be simulated with plane shell elements shell elements can be divided into two categories according to the basic theory one is the kirchhoff love shell and the other is the reissner mindlin shell kirchhoff love shell elements require c1 continuity in general which makes it hard to construct in the tradition fem framework in the iga framework thanks to the higher continuity of the shape functions the construction of kirchhoff love shell elements becomes straightforward kiendl et al 2009 however the c1 continuity between elements is still hard to achieve because the rotation angle is expressed implicitly by the first order derivatives of the deflection and this leads to the difficulty in dealing with the dirichlet boundary value problems and interface problems to overcome these problems several methods were proposed such as the bending strip method kiendl et al 2010 the penalty method breitenberger et al 2015 nitsche s method guo and ruess 2015 and mortar methods schuß et al 2019 hirschler et al 2019 these approaches modified the weak form or introduced extra elements and degrees of freedom dofs to impose the dirichlet boundary condition and couple different patches and showed very good performance in simple structure analysis however they also complicate the analysis process and the stability of analyzing large and complex structures is not proved reissner mindlin shell elements take transverse shear during bending into account the deflection and rotation angles are independent and only c0 continuity is required therefore constructing a reissner mindlin shell element is straightforward and the formulation is clear which makes reissner mindlin shell elements widely used in the traditional fem however the reissner mindlin element is troubled by locking problems in the iga context locking problems still exist recent studies show that locking occurs when the shell element is very thin or when the polynomial order of the b spline surface is not high enough quit a few measures were proposed to reduce or eliminate the effect of locking hu et al 2016 kikis et al 2019 zou et al 2020 among these measures increasing the polynomial order is the easiest to apply when the polynomial order of the b spline surface function is bicubic or higher the shear locking phenomenon can be effectively suppressed benson et al 2010 this makes the use of reissner mindlin shell elements even more convenient in the iga context without any need of taking further measures to reduce the shear locking in this paper a reissner mindlin shell element is constructed in the iga framework to perform hull structural analysis and the stiffness matrix and load vector are derived in detail compared with the membrane element with only membrane stiffness the shell element with bending stiffness can be used in more cases this paper is structured with 5 sections section 1 is the introduction and a brief introduction of b spline surface is given in section 2 a reissner mindlin shell element with 6 degrees of freedom dofs per control point is constructed and the expressions of the stiffness matrix and load vector are derived in detail section 3 is the process of applying the proposed shell element in hull structural analysis in the iga framework in section 4 the proposed method is used to analyze a typical hull block structure yu et al 2018 with both bending and torsion loads convergence tests of both cases are performed by comparing the results with those of ansys the correctness and accuracy of the proposed method is verified section 5 is a brief summary of this paper and the issues to be studied in the future 1 1 brief introduction to b spline surface in today s cad cam system b spline curve surface has become the core of geometric modeling and nurbs has become the only mathematical method to define the geometric shape of industrial products in this section a brief introduction of b spline curve surface is given a b spline curve is a non interpolating curve composed of several piecewise polynomials or rational segments a b spline curve is determined by its control points v i i 0 1 2 n 1 knot vector u u 0 u 1 u 2 u m 1 and n piecewise polynomials of order k and m n k 1 given a set of knot vector u u 0 u 1 u 2 u m 1 the b spline basis function can be represented by the cox deboor recurrence formula piegl and tiller 1997 as 1 1 b i 0 u 1 i f u i u u i 1 0 o t h e r w i s e b i k u u u i u i k u i b i k 1 u u i k 1 u u i k 1 u i 1 b i 1 k 1 u k 1 where i is the serial number of the basis function k is the order of the piecewise polynomial and u is the parametric value in the range of the knot vector if a control point is associated with each basis function the sum of all the product of the basis functions and their control points represents a b spline curve a k th order b spline curve with n control points can be expressed as 1 2 c u i 0 n 1 b i k u v i if the basis functions are extended to two dimensions and two dimensional control points are associated with them a k th l th order b spline surface with m n control points is express as 1 3 s u w i 0 m 1 j 0 n 1 b i k u b j l w v i j where u and w are the parametric values m n is the number of control points in the u w direction k l is the order of the piecewise polynomial in the u w direction in this paper bicubic b spline surfaces are taken as shape functions to discretize domains 2 shell formulation in this section a reissner mindlin shell element with 6 dofs per control point is constructed in the iga framework the expression of the stiffness matrix which is composed of membrane stiffness and bending stiffness but no torsional stiffness and the load vector are derived in detail 2 1 the membrane stiffness according to the geometric equation of linear elasticity the strain of the membrane is 2 1 ε x y ε x ε y γ x y u x v y u y v x then the stress can be expressed as 2 2 σ x y σ x σ x τ x y d ε e 1 ν 2 1 ν 0 ν 0 1 0 0 1 ν 2 ε x ε y γ x y where e is young s modulus and v is poisson s ratio the potential energy functional is 2 3 π ω 1 2 σ t ε d f d v where f is the surface force vector and d is the displacements the geometry of a surface can be represented with b spline surface of k th and l th order and m n control points as follow 2 4 x ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η x i j y ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η y i j where x i j y i j and z i j i 0 1 2 m 1 j 0 1 2 n 1 are the coordinates of the control point in the i th row and j th column of the control point mesh and ξ η 1 1 are the coordinates in the parameter space m and n are the numbers of control points in the two directions remark to simplify the numerical integration process knot vectors are unified to the range of 1 1 in this paper the displacements can be discretized with the same b spline surface as follow 2 5 u ξ η i 0 m 1 j 0 n 1 b i k ξ b j l η u i j v ξ η i 0 m 1 j 0 n 1 b i k ξ b j l η v i j the above formulation can be rewritten into matrix form as 2 6 u ξ η v ξ η n m ξ η q m where n m n 0 i n 1 i n p 1 i p m n is the number of control points i is a 2 2 identity matrix n i i 0 1 2 p 1 is the shape function obtained from equation 2 5 and q m q m 0 q m 1 q m p 1 t is the displacement vector at the control points q m i u i v i i 0 1 2 p 1 substituting the shape function equation 2 6 into equation 2 1 and equation 2 2 the discrete strain and stress expression is obtained as 2 7 ε ξ η 1 d e t j j 22 j 12 0 0 0 0 j 21 j 11 j 21 j 11 j 22 j 12 u ξ u η v ξ v η b m q m σ ξ η d b m q m where j x ξ y ξ x η y η j 11 j 12 j 21 j 22 is the well known jacobian matrix detj is the determinant of the jacobian matrix and d e 1 v 2 1 v 0 v 1 0 0 0 1 v 2 is the elasticity matrix substituting equation 2 7 into equation 2 3 and from the principle of minimum potential energy δπ 0 we have 2 8 δ q m t t a b m t d b m d a q m δ q m t t a n m t f d a then the stiffness matrix and load vector of the membrane are obtained 2 9 k m t a b m t d b m d a 2 10 f m t a n m t f d a where t is the thickness of the shell and a is the area 2 2 the bending stiffness according to the well known reissner mindlin assumption the displacement of the middle surface after deformation can be expressed by the rotation angles and deflection as 2 11 u z θ y v z θ x w w where w is the deflection and θ x θ y is the rotation along the x y axis similarly the strain can be obtained from the geometric equation 2 12 ε z ε x ε y γ x y z θ y x θ x y θ y y θ x x γ z γ y z γ z x w y θ x w x θ y then the stress is obtained 2 13 σ z σ x σ y τ x y z d θ y x θ x y θ y y θ x x τ z g γ y z γ z x e 2 1 v w y θ x w x θ y where z is the coordinate in the transverse direction the potential energy functional of the problem is 2 14 π v 1 2 σ t ε τ t γ w f d v the same b spline surface function as equation 2 4 is used to discretize the deflection and rotations as follow 2 15 w ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η w i j θ x ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η θ x i j θ y ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η θ y i j the matrix form of equation 2 15 is 2 16 w θ x θ y n b q b where n b n 0 i n 1 i n p 1 i i is a 3 3 identity matrix n i i 0 1 2 p 1 is the shape functions in equation 2 15 and q b q b 0 q b 1 q b p 1 t is the displacements of the control points q b i w i θ x i θ y i i 0 1 2 p 1 substituting the shape functions into equation 2 12 and equation 2 13 the discrete strain and stress are obtained 2 17 ε z z b b q b γ z b s q b 2 18 σ z z d b b q b τ z g b s q b where b b b b 1 b b 2 b b p b b b s 1 b s 2 b s p b b i 0 0 n i x 0 n i y 0 0 n i x n i y and b s i n i y 0 n i 0 n i x n i according to the principle of minimum potential energy δ π 0 and standard procedure mentioned in section 2 1 the stiffness matrix and load vector can be obtained as follow 2 19 k k b k s f b a n b t f d a where k b a b b t e b b b d a k b a b s t e s b s d a e b t 3 12 d e s e t k s 2 1 v k s is the shear coefficient and k s 5 6 is adopted in this paper note that nothing is done to prevent or reduce the shear locking in the iga context studies show that increasing the polynomial order can reduce the locking effect and when the polynomial order is bicubic or higher the shear locking phenomenon can be greatly alleviated therefore bicubic b spline surfaces are used in this paper and no other measures are taken 2 3 the torsional stiffness there is no stiffness associated with the drilling dof to prevent numerical error a small spring stiffness is associated with the drilling dof the spring stiffness matrix is 2 20 k dri k m a x s n dri t n dri d v where k max is the maximum value along the sub matrix diagonal of the other 5 dofs s is a coefficient to be determined and in this paper s 10 5 n dri is the vector of the shape functions of the drilling dof 3 implementation of iga the element stiffness matrix and load vector are derived in the previous section to analyze hull structures with the proposed reissner mindlin shell element in the iga framework the geometric model needs to be represented with b spline surfaces and in this paper bicubic b spline surfaces are used then the iga patch uses the same b spline surface function to discrete domains and the element stiffness matrices and element load vectors are computed in the local element coordinate systems to obtain the equilibrium equations the element stiffness matrices are assembled into the global stiffness matrix after coordinate transformation and so are the element load vectors after solving the linear system the displacements of the control points are obtained then the stress and strain of elements can be obtained with equations 2 7 2 17 and 2 18 in summary the analysis procedure is as follow 1 create the geometric model of the hull structure with bicubic b spline surfaces for geometric representation duo linear or biquadratic b spline surfaces are sufficient but in the iga context the same b spline surface function is used as the shape function of the iga patch which needs to be bicubic or higher order to reduce the shear locking therefore when building the geometric model bicubic b spline surfaces are used and refinement of the control point mesh is needed if the accuracy doesn t meet the engineering requirement 2 compute the element stiffness matrix of every iga patch according to equations 2 9 2 19 and 2 20 and apply element boundary conditions due to the local support property of b spline functions the element stiffness matrix is a sparse matrix obviously the obtained stiffness matrices are local stiffness matrices and need to be transformed into the global coordinate system 3 compute the load vector of every iga patch according to equations 2 10 and 2 19 also the obtained load vectors need to be transformed into the global coordinate system 4 compute the transformation matrix of every iga patch and transform the element stiffness matrix and load vector into global coordinate system 5 assemble the element stiffness matrices and load vectors into the global stiffness matrix and load vector according to the control point serial number 6 create the equilibrium equations with the obtained global stiffness matrix and global load vector 7 solve the equations and the displacements of the control points are obtained however they are not displacements of the structure b spline functions usually are non interpolation functions therefore the displacement of a material point on the iga patch need to be calculated using the shape function of the iga patch as equations 2 5 and 2 15 8 compute the strain and stress with equations 2 7 2 17 and 2 18 if necessary and post process the flowchart of implementing the proposed element to analyze hull structures is shown below see fig 1 4 numerical example 4 1 problem description in this section a typical hull block yu et al 2018 is taken as example to verify the proposed method the simulations run on the platform with 24 gb ram and intel core i7 4720hq cpu 2 6 ghz as shown in fig 2 the main dimensions of the hull block are length 8000 mm width 10020 mm and height 1590 mm the structure consists of a bottom plate a deck plate three longitudinal girders and three web frames longitudinal stiffeners are placed on the deck plates bottom plates and longitudinal girders and transvers stiffeners are placed on the web frame at the fore end the stiffners on the deck and bottom plate are l bar with specification of l250 90 12 mm and the others are l bar with specification of l125 75 12 mm all the plates have a thickness of 12 mm the whole structure uses the same material whose young s modulus is e 2 06 1011 pa and poisson s ratio is ν 0 3 in the iga model bicubic b spline surfaces are used to represent the geometry and discretize domains 812 patches are used to model the structure in fig 2 every is a bicubic b spline surface with 4 4 control points and the mesh between each connected patch are conforming there are 7494 control points and 44964 dofs in total and it takes 4 3 s to compute stiffness matrices and solve the equation to verify the correctness of the proposed method the results obtained from ansys 17 0 are taken as reference in ansys the 4 node shell element shell181 is used a very refined mesh is used to get the reference result there are 13901 elements with 13655 nodes and 81930 dofs in the ansys model and it takes 3 4 s to compute stiffness matrices and solve the equation two load cases are used to verify the results of iga and the details are shown below and convergence tests are performed for both cases in the convergence tests the meshes are refined with h refinement in the process of mesh refinement we first increase the number of patches after the number of patches reaches 812 the control points mesh is refined by increasing the number of control points of each patch 4 2 bending load as shown in fig 3 the aft end of the hull block is fixed and four concentrated forces of 106 n are applied at the four corners of the web frame at the fore end and two concentrated forces of 5 105 n are applied at the middle longitudinal girder the displacement nephograms of iga and ansys are shown in fig 4 as shown in the figures the deformation patterns of the iga model and the ansys model are very similar to quantify the error the maximum and minimum value of the displacements the displacement in x direction ux the displacement in y direction uy the displacement in z direction uz and the total displacement ud are listed in table 1 the convergence behavior of the bending case is shown in fig 5 in the figure uz is the most deformed displacement in z direction of each mesh case and the reference is obtained from the ansys model mentioned before from the figure iga results converge to the reference value as the mesh is refined 4 3 torsion load as shown in fig 6 two pair of concentrated forces of opposite directions are applied at the four corners of the web frame at the fore end and the value of the forces are 106 n the displacement nephograms of both iga and ansys are shown in fig 7 from the figures the deformation patterns of iga model and ansys model are very similar to quantify the error the maximum and minimum value of the displacements are listed in table 1 the convergence behavior is shown in fig 8 from the figure iga results converge to slightly higher value deviating by roughly 0 5 from the reference solution as the mesh is refined 4 4 analysis the comparison of the results of iga and the reference of both load cases is shown in table 1 from the table the displacements of iga of both load cases are almost the same as those of ansys the maximum difference of displacements is uy of the bending case and the absolute error is 0 008879 mm the relative error is 1 6 which is completely acceptable in engineering this table and the convergence tests verify the correctness and accuracy of the proposed method and proves that the proposed method is applicable for engineering practice 5 discussion in this paper iga is introduced to hull structure mechanical analysis thanks to the features of iga the analysis model can be directly inherited from the geometry model therefore the time consuming meshing stage can be totally omitted which saves a huge amount of workload and overcomes the problem in the traditional fem because of the powerful geometric representing ability of the shape function iga patches have the ability to express the geometry exactly without approximation and the geometric approximation error is eliminated from the source and the high order continuity of the shape function makes the results of iga more accurate than those of the traditional fem using low order lagrange interpolation function a reissner mindlin shell element is constructed in the iga framework and the element stiffness matrix and load vector are derived in detail compared with existing methods the proposed method simulates the hull structures with both membrane and bending stiffness and is suitable for more cases such as local strength analysis a typical hull block structure under bending and torsion loads are used as numerical examples to verify the correctness and accuracy of the proposed method from the results the maximum relative error of the displacement results of iga compared to those of ansys 17 0 is 1 6 convergence test is performed under both load cases and the iga results converge to the reference results as the dofs increase the correctness of the proposed method is verified it also means that the proposed method which realizes the integration of design and analysis is applicable for engineering practice and improve the designers efficiency however there are still problems worth further study 1 the hull structure is composed of stiffened plates although stiffeners can be simulated with shell elements using beam elements can undoubtedly reduce computational cost and maintain acceptable accuracy therefore introducing beam elements into hull structure isogeometric analysis is necessary 2 due to the complexity of the hull structure the geometric errors such as cracks and overlaps often occur when the geometric model is exported from cae system to cad system when that happens it is necessary to carry out complicated measures to fix the problems in traditional fem such as manual geometric repairment mesh alignment segmenting the geometry to fit the meshes but there is a high risk of producing low quality elements in this process which leads to the need of repeating the above process again in the iga context thanks to the higher continuity of shape functions iga patches have the potential to realize high precision non conforming mesh coupling which means the problem mentioned before can be solved without manual operation there have been quite a few studies on non conforming coupling problems kiendl et al 2010 breitenberger et al 2015 guo and ruess 2015 schuß et al 2019 hirschler et al 2019 applications of these methods on the hull structural analysis are worth studying and the stability of using these methods to analyze large and complex structures like hull structures is still need to be studied 3 there are some curved plates in hull structures such as the hull plates at the fore and aft end although the curved plates can be approximated with flat plates just like what we always do in tradition fem this approach does not take advantage of the geometric accuracy feature of iga actually curved surfaces can be exactly represented with b spline nurbs surface functions which means only one iga patch is sufficient to simulate a curved plate and by doing so it will further reduce the difficulty of creating analysis model curvilinear shell elements are usually degenerated shell elements kiendl et al 2009 benson et al 2010 guo and ruess 2015 which need to perform coordinate transformation at every integral point the transformations lead to a huge amount of computational cost and this makes curvilinear shell elements much less efficient in computing stiffness matrices than plane shell elements when analyzing large and complex structures like hull structures the transformation computational cost may become too expensive to be acceptable therefore curvilinear shell elements are worth studying in the hull structural isogeometric analysis framework credit authorship contribution statement yao wang software methodology data curation writing original draft yanyun yu conceptualization writing review editing funding acquisition yan lin supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china grant no 51409042 
20736,isogeometric analysis iga is an important emerging numerical method that is being studied in various field iga is proposed to seamlessly connect the computer aided engineering cae and the computer aided design cad systems so that the costly mesh generating stage in traditional finite element method fem can be skipped to improve the efficiency of design and analysis in this paper an iga approach is introduced to the hull structural mechanical analysis a reissner mindlin shell element is constructed in the iga framework and the expression of the element stiffness matrix and load vector are derived in detail using the proposed method a typical hull block structure is analyzed under both bending and torsion load the maximum relative error of the displacement results is 1 6 compared to the reference results obtained from ansys 17 0 and the correctness of the proposed method is verified it also proves that the proposed method can be used in engineering practice and can be used to realize the integration of design and analysis keywords isogeometric analysis hull structure reissner mindlin shell b spline surface 1 introduction finite element method fem is the most popular numerical method used in hull structural analysis while in the engineering practice building analysis model based on the geometric model is an extremely complex and laborious process although the auto meshing technology is mature meshing the geometric model is very complex and expensive because of the complexity of the hull structure when the scale of the structure is large and the topology is complex it often causes geometric errors and the loss of topology relationship when exporting the geometric model from computer aided design cad system to computer aided engineering cae system to fix that the following loop become very common in the analysis model building stage fix the geometric errors re specify the connecting relationship and re mesh the structures until the model s geometry and topology are correct however low quality meshes can still emerge if the mesh size and element type are not well chosen it is reported that the analysis model building stage takes up to 90 workload of the whole hull structural analysis process yu et al 2009 however the time consuming meshing process is only a mechanical repetitive inspection connection and correction work without any high tech content if this process can be omitted it will undoubtedly and greatly improve the design and analysis efficiency of designers and reduce their workload isogeometric analysis iga is firstly proposed by hughes et al 2005 to seamlessly connect cad and cae systems similar to the traditional fem iga is based on the discrete galerkin method and the idea of isoparametric element it takes smooth spline functions such as b spline functions non uniform rational b splines nurbs functions and pht spline functions as shape functions to discretize domains the shape functions mentioned before are widely used in current mainstream cad systems to represent geometries by using the same functions to represent the geometries and to discretize domains the gap between cad and cae system is bridged in the iga context iga patches can be directly inherited from the cad model and the control point mesh that represent geometries in cad system is used as analysis mesh without any other further meshing process this enables iga to omit the meshing stage in addition another major advantage of iga over traditional fem lies in the higher order continuity and powerful geometric expression capability of its shape functions which enable it to represent complex geometry with only one patch and to construct high order continuous element very easily and it leads to better accuracy than fem elements that use low order lagrangian interpolation functions as the shape functions bouclier et al 2013 iga has been successfully applied to the fields of solid structures cottrell et al 2006 elguedj et al 2008 bazilevs et al 2010 fluids bazilevs and hughes 2008 akkerman et al 2008 bazilevs and akkerman 2010 etc in the ship engineering field isogeometric boundary element method iga bem is introduced to wave related problems yildizdag et al 2019 belibassakis et al 2013 structural optimization iginnis et al 2013 kostas et al 2015 etc in the hull structural analysis field yu et al 2018 successfully introduced iga into hull structural analysis and proposed a framework to analyze hull structures with iga but their method used only membrane element to analyze the structures which can only be used for overall strength analysis however in many cases analysis results without bending stiffness are unacceptable hull structures are mainly composed of thin plates and stiffeners which are usually t bar and l bar in numerical simulation all components can be simulated with plane shell elements shell elements can be divided into two categories according to the basic theory one is the kirchhoff love shell and the other is the reissner mindlin shell kirchhoff love shell elements require c1 continuity in general which makes it hard to construct in the tradition fem framework in the iga framework thanks to the higher continuity of the shape functions the construction of kirchhoff love shell elements becomes straightforward kiendl et al 2009 however the c1 continuity between elements is still hard to achieve because the rotation angle is expressed implicitly by the first order derivatives of the deflection and this leads to the difficulty in dealing with the dirichlet boundary value problems and interface problems to overcome these problems several methods were proposed such as the bending strip method kiendl et al 2010 the penalty method breitenberger et al 2015 nitsche s method guo and ruess 2015 and mortar methods schuß et al 2019 hirschler et al 2019 these approaches modified the weak form or introduced extra elements and degrees of freedom dofs to impose the dirichlet boundary condition and couple different patches and showed very good performance in simple structure analysis however they also complicate the analysis process and the stability of analyzing large and complex structures is not proved reissner mindlin shell elements take transverse shear during bending into account the deflection and rotation angles are independent and only c0 continuity is required therefore constructing a reissner mindlin shell element is straightforward and the formulation is clear which makes reissner mindlin shell elements widely used in the traditional fem however the reissner mindlin element is troubled by locking problems in the iga context locking problems still exist recent studies show that locking occurs when the shell element is very thin or when the polynomial order of the b spline surface is not high enough quit a few measures were proposed to reduce or eliminate the effect of locking hu et al 2016 kikis et al 2019 zou et al 2020 among these measures increasing the polynomial order is the easiest to apply when the polynomial order of the b spline surface function is bicubic or higher the shear locking phenomenon can be effectively suppressed benson et al 2010 this makes the use of reissner mindlin shell elements even more convenient in the iga context without any need of taking further measures to reduce the shear locking in this paper a reissner mindlin shell element is constructed in the iga framework to perform hull structural analysis and the stiffness matrix and load vector are derived in detail compared with the membrane element with only membrane stiffness the shell element with bending stiffness can be used in more cases this paper is structured with 5 sections section 1 is the introduction and a brief introduction of b spline surface is given in section 2 a reissner mindlin shell element with 6 degrees of freedom dofs per control point is constructed and the expressions of the stiffness matrix and load vector are derived in detail section 3 is the process of applying the proposed shell element in hull structural analysis in the iga framework in section 4 the proposed method is used to analyze a typical hull block structure yu et al 2018 with both bending and torsion loads convergence tests of both cases are performed by comparing the results with those of ansys the correctness and accuracy of the proposed method is verified section 5 is a brief summary of this paper and the issues to be studied in the future 1 1 brief introduction to b spline surface in today s cad cam system b spline curve surface has become the core of geometric modeling and nurbs has become the only mathematical method to define the geometric shape of industrial products in this section a brief introduction of b spline curve surface is given a b spline curve is a non interpolating curve composed of several piecewise polynomials or rational segments a b spline curve is determined by its control points v i i 0 1 2 n 1 knot vector u u 0 u 1 u 2 u m 1 and n piecewise polynomials of order k and m n k 1 given a set of knot vector u u 0 u 1 u 2 u m 1 the b spline basis function can be represented by the cox deboor recurrence formula piegl and tiller 1997 as 1 1 b i 0 u 1 i f u i u u i 1 0 o t h e r w i s e b i k u u u i u i k u i b i k 1 u u i k 1 u u i k 1 u i 1 b i 1 k 1 u k 1 where i is the serial number of the basis function k is the order of the piecewise polynomial and u is the parametric value in the range of the knot vector if a control point is associated with each basis function the sum of all the product of the basis functions and their control points represents a b spline curve a k th order b spline curve with n control points can be expressed as 1 2 c u i 0 n 1 b i k u v i if the basis functions are extended to two dimensions and two dimensional control points are associated with them a k th l th order b spline surface with m n control points is express as 1 3 s u w i 0 m 1 j 0 n 1 b i k u b j l w v i j where u and w are the parametric values m n is the number of control points in the u w direction k l is the order of the piecewise polynomial in the u w direction in this paper bicubic b spline surfaces are taken as shape functions to discretize domains 2 shell formulation in this section a reissner mindlin shell element with 6 dofs per control point is constructed in the iga framework the expression of the stiffness matrix which is composed of membrane stiffness and bending stiffness but no torsional stiffness and the load vector are derived in detail 2 1 the membrane stiffness according to the geometric equation of linear elasticity the strain of the membrane is 2 1 ε x y ε x ε y γ x y u x v y u y v x then the stress can be expressed as 2 2 σ x y σ x σ x τ x y d ε e 1 ν 2 1 ν 0 ν 0 1 0 0 1 ν 2 ε x ε y γ x y where e is young s modulus and v is poisson s ratio the potential energy functional is 2 3 π ω 1 2 σ t ε d f d v where f is the surface force vector and d is the displacements the geometry of a surface can be represented with b spline surface of k th and l th order and m n control points as follow 2 4 x ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η x i j y ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η y i j where x i j y i j and z i j i 0 1 2 m 1 j 0 1 2 n 1 are the coordinates of the control point in the i th row and j th column of the control point mesh and ξ η 1 1 are the coordinates in the parameter space m and n are the numbers of control points in the two directions remark to simplify the numerical integration process knot vectors are unified to the range of 1 1 in this paper the displacements can be discretized with the same b spline surface as follow 2 5 u ξ η i 0 m 1 j 0 n 1 b i k ξ b j l η u i j v ξ η i 0 m 1 j 0 n 1 b i k ξ b j l η v i j the above formulation can be rewritten into matrix form as 2 6 u ξ η v ξ η n m ξ η q m where n m n 0 i n 1 i n p 1 i p m n is the number of control points i is a 2 2 identity matrix n i i 0 1 2 p 1 is the shape function obtained from equation 2 5 and q m q m 0 q m 1 q m p 1 t is the displacement vector at the control points q m i u i v i i 0 1 2 p 1 substituting the shape function equation 2 6 into equation 2 1 and equation 2 2 the discrete strain and stress expression is obtained as 2 7 ε ξ η 1 d e t j j 22 j 12 0 0 0 0 j 21 j 11 j 21 j 11 j 22 j 12 u ξ u η v ξ v η b m q m σ ξ η d b m q m where j x ξ y ξ x η y η j 11 j 12 j 21 j 22 is the well known jacobian matrix detj is the determinant of the jacobian matrix and d e 1 v 2 1 v 0 v 1 0 0 0 1 v 2 is the elasticity matrix substituting equation 2 7 into equation 2 3 and from the principle of minimum potential energy δπ 0 we have 2 8 δ q m t t a b m t d b m d a q m δ q m t t a n m t f d a then the stiffness matrix and load vector of the membrane are obtained 2 9 k m t a b m t d b m d a 2 10 f m t a n m t f d a where t is the thickness of the shell and a is the area 2 2 the bending stiffness according to the well known reissner mindlin assumption the displacement of the middle surface after deformation can be expressed by the rotation angles and deflection as 2 11 u z θ y v z θ x w w where w is the deflection and θ x θ y is the rotation along the x y axis similarly the strain can be obtained from the geometric equation 2 12 ε z ε x ε y γ x y z θ y x θ x y θ y y θ x x γ z γ y z γ z x w y θ x w x θ y then the stress is obtained 2 13 σ z σ x σ y τ x y z d θ y x θ x y θ y y θ x x τ z g γ y z γ z x e 2 1 v w y θ x w x θ y where z is the coordinate in the transverse direction the potential energy functional of the problem is 2 14 π v 1 2 σ t ε τ t γ w f d v the same b spline surface function as equation 2 4 is used to discretize the deflection and rotations as follow 2 15 w ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η w i j θ x ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η θ x i j θ y ξ η i 0 m 1 j 0 n 1 b i k ξ η b j l ξ η θ y i j the matrix form of equation 2 15 is 2 16 w θ x θ y n b q b where n b n 0 i n 1 i n p 1 i i is a 3 3 identity matrix n i i 0 1 2 p 1 is the shape functions in equation 2 15 and q b q b 0 q b 1 q b p 1 t is the displacements of the control points q b i w i θ x i θ y i i 0 1 2 p 1 substituting the shape functions into equation 2 12 and equation 2 13 the discrete strain and stress are obtained 2 17 ε z z b b q b γ z b s q b 2 18 σ z z d b b q b τ z g b s q b where b b b b 1 b b 2 b b p b b b s 1 b s 2 b s p b b i 0 0 n i x 0 n i y 0 0 n i x n i y and b s i n i y 0 n i 0 n i x n i according to the principle of minimum potential energy δ π 0 and standard procedure mentioned in section 2 1 the stiffness matrix and load vector can be obtained as follow 2 19 k k b k s f b a n b t f d a where k b a b b t e b b b d a k b a b s t e s b s d a e b t 3 12 d e s e t k s 2 1 v k s is the shear coefficient and k s 5 6 is adopted in this paper note that nothing is done to prevent or reduce the shear locking in the iga context studies show that increasing the polynomial order can reduce the locking effect and when the polynomial order is bicubic or higher the shear locking phenomenon can be greatly alleviated therefore bicubic b spline surfaces are used in this paper and no other measures are taken 2 3 the torsional stiffness there is no stiffness associated with the drilling dof to prevent numerical error a small spring stiffness is associated with the drilling dof the spring stiffness matrix is 2 20 k dri k m a x s n dri t n dri d v where k max is the maximum value along the sub matrix diagonal of the other 5 dofs s is a coefficient to be determined and in this paper s 10 5 n dri is the vector of the shape functions of the drilling dof 3 implementation of iga the element stiffness matrix and load vector are derived in the previous section to analyze hull structures with the proposed reissner mindlin shell element in the iga framework the geometric model needs to be represented with b spline surfaces and in this paper bicubic b spline surfaces are used then the iga patch uses the same b spline surface function to discrete domains and the element stiffness matrices and element load vectors are computed in the local element coordinate systems to obtain the equilibrium equations the element stiffness matrices are assembled into the global stiffness matrix after coordinate transformation and so are the element load vectors after solving the linear system the displacements of the control points are obtained then the stress and strain of elements can be obtained with equations 2 7 2 17 and 2 18 in summary the analysis procedure is as follow 1 create the geometric model of the hull structure with bicubic b spline surfaces for geometric representation duo linear or biquadratic b spline surfaces are sufficient but in the iga context the same b spline surface function is used as the shape function of the iga patch which needs to be bicubic or higher order to reduce the shear locking therefore when building the geometric model bicubic b spline surfaces are used and refinement of the control point mesh is needed if the accuracy doesn t meet the engineering requirement 2 compute the element stiffness matrix of every iga patch according to equations 2 9 2 19 and 2 20 and apply element boundary conditions due to the local support property of b spline functions the element stiffness matrix is a sparse matrix obviously the obtained stiffness matrices are local stiffness matrices and need to be transformed into the global coordinate system 3 compute the load vector of every iga patch according to equations 2 10 and 2 19 also the obtained load vectors need to be transformed into the global coordinate system 4 compute the transformation matrix of every iga patch and transform the element stiffness matrix and load vector into global coordinate system 5 assemble the element stiffness matrices and load vectors into the global stiffness matrix and load vector according to the control point serial number 6 create the equilibrium equations with the obtained global stiffness matrix and global load vector 7 solve the equations and the displacements of the control points are obtained however they are not displacements of the structure b spline functions usually are non interpolation functions therefore the displacement of a material point on the iga patch need to be calculated using the shape function of the iga patch as equations 2 5 and 2 15 8 compute the strain and stress with equations 2 7 2 17 and 2 18 if necessary and post process the flowchart of implementing the proposed element to analyze hull structures is shown below see fig 1 4 numerical example 4 1 problem description in this section a typical hull block yu et al 2018 is taken as example to verify the proposed method the simulations run on the platform with 24 gb ram and intel core i7 4720hq cpu 2 6 ghz as shown in fig 2 the main dimensions of the hull block are length 8000 mm width 10020 mm and height 1590 mm the structure consists of a bottom plate a deck plate three longitudinal girders and three web frames longitudinal stiffeners are placed on the deck plates bottom plates and longitudinal girders and transvers stiffeners are placed on the web frame at the fore end the stiffners on the deck and bottom plate are l bar with specification of l250 90 12 mm and the others are l bar with specification of l125 75 12 mm all the plates have a thickness of 12 mm the whole structure uses the same material whose young s modulus is e 2 06 1011 pa and poisson s ratio is ν 0 3 in the iga model bicubic b spline surfaces are used to represent the geometry and discretize domains 812 patches are used to model the structure in fig 2 every is a bicubic b spline surface with 4 4 control points and the mesh between each connected patch are conforming there are 7494 control points and 44964 dofs in total and it takes 4 3 s to compute stiffness matrices and solve the equation to verify the correctness of the proposed method the results obtained from ansys 17 0 are taken as reference in ansys the 4 node shell element shell181 is used a very refined mesh is used to get the reference result there are 13901 elements with 13655 nodes and 81930 dofs in the ansys model and it takes 3 4 s to compute stiffness matrices and solve the equation two load cases are used to verify the results of iga and the details are shown below and convergence tests are performed for both cases in the convergence tests the meshes are refined with h refinement in the process of mesh refinement we first increase the number of patches after the number of patches reaches 812 the control points mesh is refined by increasing the number of control points of each patch 4 2 bending load as shown in fig 3 the aft end of the hull block is fixed and four concentrated forces of 106 n are applied at the four corners of the web frame at the fore end and two concentrated forces of 5 105 n are applied at the middle longitudinal girder the displacement nephograms of iga and ansys are shown in fig 4 as shown in the figures the deformation patterns of the iga model and the ansys model are very similar to quantify the error the maximum and minimum value of the displacements the displacement in x direction ux the displacement in y direction uy the displacement in z direction uz and the total displacement ud are listed in table 1 the convergence behavior of the bending case is shown in fig 5 in the figure uz is the most deformed displacement in z direction of each mesh case and the reference is obtained from the ansys model mentioned before from the figure iga results converge to the reference value as the mesh is refined 4 3 torsion load as shown in fig 6 two pair of concentrated forces of opposite directions are applied at the four corners of the web frame at the fore end and the value of the forces are 106 n the displacement nephograms of both iga and ansys are shown in fig 7 from the figures the deformation patterns of iga model and ansys model are very similar to quantify the error the maximum and minimum value of the displacements are listed in table 1 the convergence behavior is shown in fig 8 from the figure iga results converge to slightly higher value deviating by roughly 0 5 from the reference solution as the mesh is refined 4 4 analysis the comparison of the results of iga and the reference of both load cases is shown in table 1 from the table the displacements of iga of both load cases are almost the same as those of ansys the maximum difference of displacements is uy of the bending case and the absolute error is 0 008879 mm the relative error is 1 6 which is completely acceptable in engineering this table and the convergence tests verify the correctness and accuracy of the proposed method and proves that the proposed method is applicable for engineering practice 5 discussion in this paper iga is introduced to hull structure mechanical analysis thanks to the features of iga the analysis model can be directly inherited from the geometry model therefore the time consuming meshing stage can be totally omitted which saves a huge amount of workload and overcomes the problem in the traditional fem because of the powerful geometric representing ability of the shape function iga patches have the ability to express the geometry exactly without approximation and the geometric approximation error is eliminated from the source and the high order continuity of the shape function makes the results of iga more accurate than those of the traditional fem using low order lagrange interpolation function a reissner mindlin shell element is constructed in the iga framework and the element stiffness matrix and load vector are derived in detail compared with existing methods the proposed method simulates the hull structures with both membrane and bending stiffness and is suitable for more cases such as local strength analysis a typical hull block structure under bending and torsion loads are used as numerical examples to verify the correctness and accuracy of the proposed method from the results the maximum relative error of the displacement results of iga compared to those of ansys 17 0 is 1 6 convergence test is performed under both load cases and the iga results converge to the reference results as the dofs increase the correctness of the proposed method is verified it also means that the proposed method which realizes the integration of design and analysis is applicable for engineering practice and improve the designers efficiency however there are still problems worth further study 1 the hull structure is composed of stiffened plates although stiffeners can be simulated with shell elements using beam elements can undoubtedly reduce computational cost and maintain acceptable accuracy therefore introducing beam elements into hull structure isogeometric analysis is necessary 2 due to the complexity of the hull structure the geometric errors such as cracks and overlaps often occur when the geometric model is exported from cae system to cad system when that happens it is necessary to carry out complicated measures to fix the problems in traditional fem such as manual geometric repairment mesh alignment segmenting the geometry to fit the meshes but there is a high risk of producing low quality elements in this process which leads to the need of repeating the above process again in the iga context thanks to the higher continuity of shape functions iga patches have the potential to realize high precision non conforming mesh coupling which means the problem mentioned before can be solved without manual operation there have been quite a few studies on non conforming coupling problems kiendl et al 2010 breitenberger et al 2015 guo and ruess 2015 schuß et al 2019 hirschler et al 2019 applications of these methods on the hull structural analysis are worth studying and the stability of using these methods to analyze large and complex structures like hull structures is still need to be studied 3 there are some curved plates in hull structures such as the hull plates at the fore and aft end although the curved plates can be approximated with flat plates just like what we always do in tradition fem this approach does not take advantage of the geometric accuracy feature of iga actually curved surfaces can be exactly represented with b spline nurbs surface functions which means only one iga patch is sufficient to simulate a curved plate and by doing so it will further reduce the difficulty of creating analysis model curvilinear shell elements are usually degenerated shell elements kiendl et al 2009 benson et al 2010 guo and ruess 2015 which need to perform coordinate transformation at every integral point the transformations lead to a huge amount of computational cost and this makes curvilinear shell elements much less efficient in computing stiffness matrices than plane shell elements when analyzing large and complex structures like hull structures the transformation computational cost may become too expensive to be acceptable therefore curvilinear shell elements are worth studying in the hull structural isogeometric analysis framework credit authorship contribution statement yao wang software methodology data curation writing original draft yanyun yu conceptualization writing review editing funding acquisition yan lin supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this work was supported by the national natural science foundation of china grant no 51409042 
20737,in the present paper a novel machine learning assisted rans method is proposed and utilized to investigate the unsteady cavitating flow around a clark y hydrofoil a data driven machine learning model for turbulent eddy viscosity tev is constructed based on high fidelity les results first and then makes a prediction for tev in rans simulation the machine learning predicted tev successfully imitates the tev distribution characteristics of les that there is a concentration around cavities and negative tev in the wake based on the more accurate tev field the machine learning assisted rans method makes more accurate predictions about velocity profile and basic performance parameters of the hydrofoil and gives a better representation of shedding process of sheet cavitation when compared with original rans results finally generalization performance of the machine learning model is assessed by simulating cavitating flows under different inlet velocity conditions the results indicate that cavitation exhibits more periodicity with the decrease of inlet velocity in the range of investigated conditions which may be associated with different tev distribution characteristics keywords cavitation machine learning rans les turbulent eddy viscosity tev 1 introduction reynolds averaged navier stokes rans method has been widely employed to investigate time averaged characteristics of cavitation due to its computational efficiency and acceptable accuracy in terms of statistical characteristics zhang et al 2015 2017 zhao et al 2020 however when it comes to transient behavior such as the evolution of cavitation which is intensely three dimensional and unsteady rans seems incapable of reproducing the development and evolution of cavitation according to huang et al 2013 one of the main reasons is that traditional rans turbulence closure models tend to overpredict the turbulent eddy viscosity tev therefore they proposed a filter based density corrected model fbdcm which reduced tev effectively and thus the predicted cavity patterns and shedding frequency velocity and vorticity distributions agreed well with experimental measurements there is one point to note about the study of huang et al 2013 that is the reduction of tev in their work is based on the local physical characteristics this kind of model modification method places high demands on researchers experience and understanding of physical phenomena consequently very limited progress in the model improvement has been achieved which also imposes heavy burden on the numerical investigation of cavitation thanks to the rapid improvement of computer performance large eddy simulation les has also been widely adopted in the prediction about transient behavior of cavitation cheng et al 2020 2021a 2021b liang et al 2020 pendar et al 2020 wang et al 2017b at the same time as far as tev is concerned the huge amounts of reliable data generated by les provide an alternative solution to modeling tev in rans method that is substituting tev predicted by les for that in rans equations however in the last few decades it is extremely hard to search for valuable information from such large amounts of data and thereby build a suitable model for tev nowadays with the astounding performance of modern computer hardware and the occurrence of various advanced computer algorithms data driven machine learning has become a promising tool to solve such kind of modeling problem in essence machine learning is a process of constantly optimizing the parameters of the selected algorithm to establish a good mapping relationship between inputs and outputs chen et al 2019 rabault et al 2020 zhang et al 2019 then the whole framework can be regarded as a model for the targeted quantity which is just like a black box model and cannot be expressed in a specific formula as in traditional modeling problem in fact there have been a number of researches using machine learning for turbulence modeling in the fluid mechanics community ye et al 2020 zhang et al 2018 specifically the existing research work can be roughly divided into three categories according to the role of machine learning model uncertainty analysis of turbulence model improving turbulence model and replacing turbulence model in terms of uncertainty analysis yarlanki et al 2012 built a data driven model between parameters in rans model and their corresponding deviation and determined the optimal parameters by calculating the minimum of the data driven model singh and duraisamy 2016 combined field inversion and bayesian formalism to quantify functional errors in rans models their results suggested that the field inversion approach materially enhanced the value of computational and experimental data for model improvement by directly addressing the connection between physical data and model discrepancies when it comes to improving turbulence model there are also a number of important studies worth mentioning singh et al 2017 changed the form of governing equations by modifying the generation term in the sa model their modified model could be used for the simulation of separation flow and their numerical results were more consistent with the experimental results wang et al 2017a proposed a data driven physics informed machine learning approach for reconstructing discrepancies in rans modeled reynolds stresses excellent performances of the machine learning model in predicting reynolds stress discrepancies in both fully developed turbulent flows in a square duct and flows with massive separation demonstrated the merits of the machine learning approach furthermore wu et al 2018 presented a comprehensive framework for augmenting turbulence models with physics informed machine learning compared with traditional rans results the machine learning predicted eddy viscosity and velocity distribution both showed better agreement with direct numerical simulation dns data although the modified models in the above mentioned works do improve the accuracy of the original models to a certain extent they bring an extra increase to calculation amount and thus reduce the overall calculation efficiency therefore some researchers focus their attention on directly building mapping relationship between flow field variables and turbulence using machine learning method ling et al 2016 used a novel invariant neural network to learn a model for the reynolds stress anisotropy tensor from high fidelity simulation data their results demonstrated significant improvement on velocity field versus baseline rans linear and nonlinear eddy viscosity models zhu et al 2019 directly reconstructed a mapping function between turbulent eddy viscosity and mean flow variables by neural networks and thus completely replaced the original partial differential equation model their research showed that the data driven turbulence model could be applied to various airfoils and flow states wang et al 2018 utilized data driven machine learning algorithms to establish the subgrid scale sgs model for les their machine learning sgs model provided better predictions than the traditional smagorinsky and dynamic smagorinsky models all these studies share the same idea of using data driven machine learning to establish a model for the quantities of our interest in pursuit of obtaining a more accurate flow field prediction however the employment of machine learning in the investigation of cavitation is rarely reported to date inspired by the previous work we use a classical machine learning algorithm random forest rf to establish a model for tev based on the high fidelity les data then the machine learning predicted tev is propagated to the rans equations to forecast the evolution of cavitation the novelty of the present work mainly lies in two aspects 1 the feasibility of modeling tev in cavitating flow by data driven machine learning technique is verified 2 machine learning is introduced into the investigation of cavitation thereby blazing a potential trail for the application of machine learning in cavitation research 2 cfd setup and mesh study 2 1 cfd setup according to the experiment done by huang et al 2013 the computational domain and boundary conditions are shown in fig 1 the investigated hydrofoil is clark y with chord length c 70 mm span s 0 3c 21 mm and attack angle α 8 the hydrofoil is placed in a channel with length of 10c and cross section of 0 3c 2 7c the velocity at the inlet is set to u 10 m s the static pressure at the outlet is fixed at p out 42300pa which is calculated according to the cavitation number 1 σ p o u t p v 0 5 ρ u 2 0 8 where p v 2300pa is the saturated vapor pressure ρ 1000 kg m3 is the density of water a non slip boundary condition is imposed on the hydrofoil surface the top and the bottom of the channel are both deemed as free slip walls periodic condition is used for the side walls of the channel the calculations in this study were conducted in the open source software openfoam an innate multiphase solver interphase change foam was used to solve the transient cavitating flow in rans calculation the turbulence model is sst k ω in les calculation the wall adapting local eddy viscosity wale model is employed as the subgrid scale model the timestep size is set to 10 5s and 2 10 6s for rans and les calculations respectively the interpolation scheme is linear central differencing for both rans and les calculation for divergence terms of velocity and vapor fraction and turbulence fields first order upwind scheme and second order linear scheme are employed for rans and les calculation respectively the time dependent computations are solved by euler scheme 2 2 mesh study previous studies long et al 2017 2019 on cavitating flow around a clark y hydrofoil indicated that a c type grid with around 3 million nodes was appropriate for les therefore in this study a set of mesh with 2 877 720 nodes is generated for les for rans calculation a similar c type grid is adopted the mesh distribution around the hydrofoil of which is shown in fig 2 to investigate mesh independence three sets of mesh with the same topology structure are generated namely mesh 1 2 and 3 respectively the only difference between them resides in the number of nodes placed on the line marked in red in fig 2 the detailed information about the three sets of mesh is given in table 1 fig 3 presents the time evolution of the normalized cavity area over three flow cycles obtained by experiment huang et al 2013 and simulation the flow cycle predicted by mesh 1 is slightly shorter than the measured cycle moreover the overall range of fluctuation predicted by mesh 1 is much smaller than that measured by experiment in contrast mesh 2 and 3 make better predictions about the flow cycle and the fluctuation the mean cavity area measured by experiment is 0 72s c while that numerically predicted by the three sets of mesh are 0 58s c 0 60s c and 0 62s c respectively where s c is the cross sectional area of the hydrofoil although mesh 3 seems more appropriate in terms of the mean cavity area it performs at about the same level as mesh 2 in the aspect of time evolution of cavity area furthermore the slight improvement in simulation accuracy achieved by mesh 3 is at the cost of more nodes which takes up huger computational resource therefore in view of the better balance between accuracy and computational resource consumption mesh 2 is finally adopted in rans calculation 3 machine learning methodology 3 1 dataset preparation in machine learning terminology the tev modeling problem to be solved in the present paper belongs to supervised learning and regression problem the complete process is usually composed of training phase and test phase the dataset used in each phase has the corresponding name the goal of the training phase is to construct a suitable mapping from the given inputs also termed as features to outputs also termed as labels the constructed model is required to not only fit the training dataset well but also make a precise prediction to the data it has never been exposed to indicating that the model has a good generalization performance this is the objective of the test phase since the machine learning model is constructed based on les results and then employed to improve rans results the training dataset originates from les results while the inputs of test phase derive from rans results in view that we focus on the cavitating flow around the hydrofoil only the results in the region 0 01 m x 0 12 m 0 02 m y 0 03 m on the mid span section 25 256 nodes are fed to the model therefore there are 25 256 rows in the training dataset as already mentioned above machine learning is used to build a model for tev thus naturally tev is the output of the two phases the performance of a machine learning model is closely related to the selection of inputs which should be sufficient to represent the local flow state and thus enable the model to truly extract essential characteristics of different flows even those far away from the training flow ling and templeton 2015 constructed a rich set of 12 features based on a series of raw local flow variables including the gradient vector of pressure and the gradient tensor of velocity in addition in terms of cavitating flow vapor volume fraction reynolds stress and turbulent kinetic energy are also important variables indicative of local flow regime therefore we also include them in the inputs all the 20 inputs for constructing the machine learning model are summarized in table 2 another thing we need to consider is the normalization of all the data through which the range of data can be constrained to 1 1 and the model can exhibit better generalization performance in this work we simply employ maximum division scaling method that is all data in a column of dataset is divided by the maximum of that column 3 2 random forest algorithm a number of advanced machine learning algorithms have emerged in recent years including support vector machine svm decision trees dts random forest rf neural network nn etc ling and templeton 2015 compared the performance of svm adaboost dts and rf in the indication of regions with high rans uncertainty their work showed that rf had the best combination of good performance and easy implementation sikirica et al 2020 used rf to determine the empirical constants in the kunz cavitation model and thus obtained predicted cavitation in excellent agreement with experimental results since so many researches have shown the superiority of rf we also employ rf to establish a model for tev in this work the principle of rf algorithm for building regression functions has been made clear in the work of wang et al 2017a as an ensemble method the number of trees in rf n trees is vitally important for the performance of rf there is no doubt that the larger the number of trees in rf is the better its performance will be however its performance will stop getting significantly improved beyond a critical number of trees additionally it takes longer time to compute with the increase of n trees out of bag oob score is a convenient indicator for assessing the performance of rf which is defined as follows 2 o o b s c o r e 1 i y i t r u e y i p r e d 2 i y i t r u e y 2 where y i t r u e y i p r e d and y are the real value the output of rf and the mean of all the real values respectively the closer oob score is to 1 the better the model is therefore we use this score to determine the value of n trees fig 4 shows the variation of oob score versus the value of n trees it can be seen that when n trees is beyond 20 oob score almost remains unchanged to achieve a good balance between the performance of rf and its computing efficiency n trees is set to 20 in the present paper the implementation of the rf regression model is through the scikit learn library of python 3 3 machine learning assisted workflow the machine learning assisted workflow proposed in the present paper is mainly composed of two parts the machine learning model training and cfd calculation the former is a preliminary work based on les results and produces a satisfying model that is called in each timestep of subsequent formal rans calculation as for cfd calculation an innate tev field abbreviated as tevrans hereafter along with some other informative fields associated with the inputs of rf model can be obtained after each timestep of rans calculation fed with the inputs the rf model makes a prediction of tev denoted by tevrf then we substitute tevrf for tevrans followed with the next timestep of rans calculation fig 5 is a flow chart of the above procedure 4 results and discussions 4 1 rans and les predicted cavitation behavior the comparison of cavitation evolution in a typical period among the experiment rans and les results is shown in fig 6 the quantitative comparison of the time averaged lift coefficient c l drag coefficient c d and cavitation evolution cycle t is given in table 3 it can be seen that les results capture the shedding process of sheet cavitation and agree much better with experimental images when compared with rans results the sheet cavitation predicted by rans simulation is consistently attached to the leading edge of the hydrofoil and does not display the shedding process accordingly the errors of c l c d and t predicted by rans and les are different and the errors of rans are significantly higher than that of les fig 7 compares the distribution of instant and time averaged tev predicted by rans and les respectively it can be seen that there is no significant difference between the instant and time averaged results a huge distinction of tev between rans and les results can be observed les predicted tev is rather in a mess around sheet cavitation and in the wake when compared with rans predicted tev another striking difference is that there are regions with negative tev in les result mainly in the re entrant jet region and in the wake it is known that a non negative tev is presumed in the boussinesq hypothesis however this assumption may not be valid in regions of rapidly changing velocity gradient pope 2000 furthermore ling and templeton 2015 marked the regions of breakdown of non negativity assumption in various turbulent flows using machine learning which were mainly near the boundary layer and in the wake of some flows therefore there is a reasonable prospect that les predicted negative tev is credible and may be closer to the real state of local flow 4 2 machine learning assisted rans results fig 8 displays cavitation evolution in a typical period reproduced by rans method with the assistance of machine learning the five subplots correspond to the five stages in fig 6 compared with the cavitation evolution presented by original rans method see the middle column in fig 6 the effect of machine learning is manifested with the machine learning predicted tev the sheet cavitation exhibits a periodic process of growth and shedding and the shed cavities are more unsteady acting more like cloud cavitation for a more intuitive comparison the basic performance parameters predicted by machine learning assisted rans including the time averaged lift coefficient drag coefficient and cavitation evolution cycle are incorporated into table 3 in terms of the time averaged lift coefficient and drag coefficient there is a slight improvement in accuracy compared with the original rans results while the time averaged cavitation evolution cycle predicted by the machine learning assisted rans agrees perfectly with the experimental data fig 9 compares the time averaged streamwise velocity predicted by rans les and machine learning assisted rans the location of the four different cross sections is schematically shown in the subplot in general the results of machine learning assisted rans fall between that of les and rans and are more consistent with the experimental data in most cases when compared with the original rans results meanwhile the velocity profile on the cross section x 1 0c deserves our attention although rans seems to outperform les and machine learning assisted rans it yields no negative velocity indicating that there is almost no re entrant jet at the time averaged level on the contrary les predicts negative velocity in the region of 8mm y 0 mm while machine learning assisted rans also captures the re entrant jet at the average level of time but with lower intensity and smaller region fig 10 shows the distribution of tev predicted by rf model tevrf at the typical instant t 4 0 825t ref which is in the stage of re entrant jet development and thus is of our interest it can be seen that tevrf is mainly concentrated around cavitation compared with tevrans and tevles in fig 7 tevrf is significantly different from tevrans and similar with tevles to some extent the remarkable differences between tevrf and tevrans are around the cavities and in the wake region where tevrf is distributed more irregularly and is smaller than tevrans respectively note that one of the main effects of fbdcm proposed by huang et al 2013 is exactly reducing tev in the wake region otherwise the rf model yields negative tev near the trailing edge indicative that the local flow might be too complex to conform to the boussinesq hypothesis nevertheless the machine learning assisted rans method still underperforms les which is foreseeable the main reasons are twofold firstly as already mentioned in the subsection dataset preparation the test inputs come from rans results while the rf model is constructed using les results secondly there is training error however it should be noted that the nodes number for rans is an order of magnitude lower than that for les which speeds up the calculation a lot even taking into account the time it takes to invoke the rf model at each timestep of calculation table 4 presents the time consumption for the transient simulation during physical time δt phy 0 01s among the three methods all the simulations were conducted on cpu intel xeon e5 2630 2 4 ghz using a single core on even ground the results further confirm the superiority of the machine learning assisted rans method that it can achieve a satisfying balance between accuracy and time consumption to sum up in the context of modeling tev in the cavitating flow apart from proposing a correction function that can be formulated data driven machine learning is also a promising approach with the machine learning model rans method is able to make more accurate predictions about velocity profile and basic performance parameters of the hydrofoil capture the shedding process of sheet cavitation and better reproduce the unsteadiness of the shed cavities showing remarkable superiority over the original rans method 4 3 generalization performance of the machine learning model many researchers lay special emphasis on generalization performance of a machine learning model as introduced in the subsection dataset preparation generalization performance signifies the machine learning model s predictive ability given the dataset that it has never seen before the machine learning assisted rans method s capability to capture the shedding process discussed in the previous subsection has preliminarily confirmed the rf model s generalization capability however more ideally the unseen dataset should stem from numerical results under the operating condition far away from that used for training here we provide a further qualitative assessment of the rf model s generalization performance by simulating the cavitating flow under conditions u 9 m s and 11 m s with the consideration that different inlet velocities result in different cavitation strength fig 11 displays cavitation evolution under the conditions u 1 9 m s and u 2 11 m s combined with cavitation evolution under condition u 10 m s see fig 8 the small variation in inlet velocity seems to make little difference to cavitation intensity and behavior in general while cavitation evolution is more periodic at a lower inlet velocity fig 12 shows the distribution of machine learning predicted tev at the typical instant t 3 as a comparison the distribution of les predicted tev is also shown in fig 12 under the condition u 1 9 m s both machine learning predicted tev and les predicted one are concentrated around cavitation and in the near downstream on the other hand both are negative in a small and scattered area of the wake under the condition u 2 11 m s tev predicted by the two methods also possesses similar distribution characteristic that is a subtle concentration and negativity however there are still some distinctions between the two results that need to be noted for example the distribution of tev in the wake produced by les is more complicated than that produced by rf in general the fact that machine learning predicted tev and les predicted one under the two different conditions share the similar distribution characteristic proves the generalization performance of the rf model effectively on the other hand in combination with tevrf distribution under condition u 10 m s see fig 10 the concentration of tevrf around cavities seems to diminish with the increase of inlet velocity this concentration of tevrf and overall unevenness of its distribution might be the cause of greater periodicity at a lower inlet velocity 5 conclusions in the present paper the cavitating flow around the clark y hydrofoil is investigated numerically with a machine learning assisted rans method where a data driven machine learning model for tev is constructed based on high fidelity les results the machine learning assisted rans method gives a better representation of the shedding process of sheet cavitation compared with original rans results the main conclusions are as follows 1 a random forest model for tev fed with a rich set of 20 inputs containing essential information about the cavitating flow field is constructed using high fidelity les results the model effectively reproduces the concentration of tev around cavitation and reduces tev in the wake region in rans simulation providing an alternative for improving simulation accuracy of tev 2 with the machine learning predicted tev rans method captures the shedding process of sheet cavitation and better reproduces the unsteadiness of the shed cavities the machine learning assisted rans method makes better predictions about velocity profile and basic performance parameters of the hydrofoil including time averaged lift coefficient drag coefficient and cavitation evolution cycle showing remarkable superiority over the original rans method 3 the generalization capability of the constructed machine learning model is confirmed by simulating cavitating flows under different flow conditions from the training one in the range of investigated inlet velocities cavitation exhibits more periodicity with the decrease of inlet velocity which may be associated with more concentrated tev around cavities and a more irregular tev distribution credit authorship contribution statement mohan xu software validation investigation data curation writing original draft visualization huaiyu cheng conceptualization methodology writing review editing bin ji resources writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the national natural science foundation of china project nos 51822903 11772239 and china postdoctoral science foundation project no 2020m682471 the numerical calculations in this paper were done on the supercomputing system in the supercomputing center of wuhan university 
20737,in the present paper a novel machine learning assisted rans method is proposed and utilized to investigate the unsteady cavitating flow around a clark y hydrofoil a data driven machine learning model for turbulent eddy viscosity tev is constructed based on high fidelity les results first and then makes a prediction for tev in rans simulation the machine learning predicted tev successfully imitates the tev distribution characteristics of les that there is a concentration around cavities and negative tev in the wake based on the more accurate tev field the machine learning assisted rans method makes more accurate predictions about velocity profile and basic performance parameters of the hydrofoil and gives a better representation of shedding process of sheet cavitation when compared with original rans results finally generalization performance of the machine learning model is assessed by simulating cavitating flows under different inlet velocity conditions the results indicate that cavitation exhibits more periodicity with the decrease of inlet velocity in the range of investigated conditions which may be associated with different tev distribution characteristics keywords cavitation machine learning rans les turbulent eddy viscosity tev 1 introduction reynolds averaged navier stokes rans method has been widely employed to investigate time averaged characteristics of cavitation due to its computational efficiency and acceptable accuracy in terms of statistical characteristics zhang et al 2015 2017 zhao et al 2020 however when it comes to transient behavior such as the evolution of cavitation which is intensely three dimensional and unsteady rans seems incapable of reproducing the development and evolution of cavitation according to huang et al 2013 one of the main reasons is that traditional rans turbulence closure models tend to overpredict the turbulent eddy viscosity tev therefore they proposed a filter based density corrected model fbdcm which reduced tev effectively and thus the predicted cavity patterns and shedding frequency velocity and vorticity distributions agreed well with experimental measurements there is one point to note about the study of huang et al 2013 that is the reduction of tev in their work is based on the local physical characteristics this kind of model modification method places high demands on researchers experience and understanding of physical phenomena consequently very limited progress in the model improvement has been achieved which also imposes heavy burden on the numerical investigation of cavitation thanks to the rapid improvement of computer performance large eddy simulation les has also been widely adopted in the prediction about transient behavior of cavitation cheng et al 2020 2021a 2021b liang et al 2020 pendar et al 2020 wang et al 2017b at the same time as far as tev is concerned the huge amounts of reliable data generated by les provide an alternative solution to modeling tev in rans method that is substituting tev predicted by les for that in rans equations however in the last few decades it is extremely hard to search for valuable information from such large amounts of data and thereby build a suitable model for tev nowadays with the astounding performance of modern computer hardware and the occurrence of various advanced computer algorithms data driven machine learning has become a promising tool to solve such kind of modeling problem in essence machine learning is a process of constantly optimizing the parameters of the selected algorithm to establish a good mapping relationship between inputs and outputs chen et al 2019 rabault et al 2020 zhang et al 2019 then the whole framework can be regarded as a model for the targeted quantity which is just like a black box model and cannot be expressed in a specific formula as in traditional modeling problem in fact there have been a number of researches using machine learning for turbulence modeling in the fluid mechanics community ye et al 2020 zhang et al 2018 specifically the existing research work can be roughly divided into three categories according to the role of machine learning model uncertainty analysis of turbulence model improving turbulence model and replacing turbulence model in terms of uncertainty analysis yarlanki et al 2012 built a data driven model between parameters in rans model and their corresponding deviation and determined the optimal parameters by calculating the minimum of the data driven model singh and duraisamy 2016 combined field inversion and bayesian formalism to quantify functional errors in rans models their results suggested that the field inversion approach materially enhanced the value of computational and experimental data for model improvement by directly addressing the connection between physical data and model discrepancies when it comes to improving turbulence model there are also a number of important studies worth mentioning singh et al 2017 changed the form of governing equations by modifying the generation term in the sa model their modified model could be used for the simulation of separation flow and their numerical results were more consistent with the experimental results wang et al 2017a proposed a data driven physics informed machine learning approach for reconstructing discrepancies in rans modeled reynolds stresses excellent performances of the machine learning model in predicting reynolds stress discrepancies in both fully developed turbulent flows in a square duct and flows with massive separation demonstrated the merits of the machine learning approach furthermore wu et al 2018 presented a comprehensive framework for augmenting turbulence models with physics informed machine learning compared with traditional rans results the machine learning predicted eddy viscosity and velocity distribution both showed better agreement with direct numerical simulation dns data although the modified models in the above mentioned works do improve the accuracy of the original models to a certain extent they bring an extra increase to calculation amount and thus reduce the overall calculation efficiency therefore some researchers focus their attention on directly building mapping relationship between flow field variables and turbulence using machine learning method ling et al 2016 used a novel invariant neural network to learn a model for the reynolds stress anisotropy tensor from high fidelity simulation data their results demonstrated significant improvement on velocity field versus baseline rans linear and nonlinear eddy viscosity models zhu et al 2019 directly reconstructed a mapping function between turbulent eddy viscosity and mean flow variables by neural networks and thus completely replaced the original partial differential equation model their research showed that the data driven turbulence model could be applied to various airfoils and flow states wang et al 2018 utilized data driven machine learning algorithms to establish the subgrid scale sgs model for les their machine learning sgs model provided better predictions than the traditional smagorinsky and dynamic smagorinsky models all these studies share the same idea of using data driven machine learning to establish a model for the quantities of our interest in pursuit of obtaining a more accurate flow field prediction however the employment of machine learning in the investigation of cavitation is rarely reported to date inspired by the previous work we use a classical machine learning algorithm random forest rf to establish a model for tev based on the high fidelity les data then the machine learning predicted tev is propagated to the rans equations to forecast the evolution of cavitation the novelty of the present work mainly lies in two aspects 1 the feasibility of modeling tev in cavitating flow by data driven machine learning technique is verified 2 machine learning is introduced into the investigation of cavitation thereby blazing a potential trail for the application of machine learning in cavitation research 2 cfd setup and mesh study 2 1 cfd setup according to the experiment done by huang et al 2013 the computational domain and boundary conditions are shown in fig 1 the investigated hydrofoil is clark y with chord length c 70 mm span s 0 3c 21 mm and attack angle α 8 the hydrofoil is placed in a channel with length of 10c and cross section of 0 3c 2 7c the velocity at the inlet is set to u 10 m s the static pressure at the outlet is fixed at p out 42300pa which is calculated according to the cavitation number 1 σ p o u t p v 0 5 ρ u 2 0 8 where p v 2300pa is the saturated vapor pressure ρ 1000 kg m3 is the density of water a non slip boundary condition is imposed on the hydrofoil surface the top and the bottom of the channel are both deemed as free slip walls periodic condition is used for the side walls of the channel the calculations in this study were conducted in the open source software openfoam an innate multiphase solver interphase change foam was used to solve the transient cavitating flow in rans calculation the turbulence model is sst k ω in les calculation the wall adapting local eddy viscosity wale model is employed as the subgrid scale model the timestep size is set to 10 5s and 2 10 6s for rans and les calculations respectively the interpolation scheme is linear central differencing for both rans and les calculation for divergence terms of velocity and vapor fraction and turbulence fields first order upwind scheme and second order linear scheme are employed for rans and les calculation respectively the time dependent computations are solved by euler scheme 2 2 mesh study previous studies long et al 2017 2019 on cavitating flow around a clark y hydrofoil indicated that a c type grid with around 3 million nodes was appropriate for les therefore in this study a set of mesh with 2 877 720 nodes is generated for les for rans calculation a similar c type grid is adopted the mesh distribution around the hydrofoil of which is shown in fig 2 to investigate mesh independence three sets of mesh with the same topology structure are generated namely mesh 1 2 and 3 respectively the only difference between them resides in the number of nodes placed on the line marked in red in fig 2 the detailed information about the three sets of mesh is given in table 1 fig 3 presents the time evolution of the normalized cavity area over three flow cycles obtained by experiment huang et al 2013 and simulation the flow cycle predicted by mesh 1 is slightly shorter than the measured cycle moreover the overall range of fluctuation predicted by mesh 1 is much smaller than that measured by experiment in contrast mesh 2 and 3 make better predictions about the flow cycle and the fluctuation the mean cavity area measured by experiment is 0 72s c while that numerically predicted by the three sets of mesh are 0 58s c 0 60s c and 0 62s c respectively where s c is the cross sectional area of the hydrofoil although mesh 3 seems more appropriate in terms of the mean cavity area it performs at about the same level as mesh 2 in the aspect of time evolution of cavity area furthermore the slight improvement in simulation accuracy achieved by mesh 3 is at the cost of more nodes which takes up huger computational resource therefore in view of the better balance between accuracy and computational resource consumption mesh 2 is finally adopted in rans calculation 3 machine learning methodology 3 1 dataset preparation in machine learning terminology the tev modeling problem to be solved in the present paper belongs to supervised learning and regression problem the complete process is usually composed of training phase and test phase the dataset used in each phase has the corresponding name the goal of the training phase is to construct a suitable mapping from the given inputs also termed as features to outputs also termed as labels the constructed model is required to not only fit the training dataset well but also make a precise prediction to the data it has never been exposed to indicating that the model has a good generalization performance this is the objective of the test phase since the machine learning model is constructed based on les results and then employed to improve rans results the training dataset originates from les results while the inputs of test phase derive from rans results in view that we focus on the cavitating flow around the hydrofoil only the results in the region 0 01 m x 0 12 m 0 02 m y 0 03 m on the mid span section 25 256 nodes are fed to the model therefore there are 25 256 rows in the training dataset as already mentioned above machine learning is used to build a model for tev thus naturally tev is the output of the two phases the performance of a machine learning model is closely related to the selection of inputs which should be sufficient to represent the local flow state and thus enable the model to truly extract essential characteristics of different flows even those far away from the training flow ling and templeton 2015 constructed a rich set of 12 features based on a series of raw local flow variables including the gradient vector of pressure and the gradient tensor of velocity in addition in terms of cavitating flow vapor volume fraction reynolds stress and turbulent kinetic energy are also important variables indicative of local flow regime therefore we also include them in the inputs all the 20 inputs for constructing the machine learning model are summarized in table 2 another thing we need to consider is the normalization of all the data through which the range of data can be constrained to 1 1 and the model can exhibit better generalization performance in this work we simply employ maximum division scaling method that is all data in a column of dataset is divided by the maximum of that column 3 2 random forest algorithm a number of advanced machine learning algorithms have emerged in recent years including support vector machine svm decision trees dts random forest rf neural network nn etc ling and templeton 2015 compared the performance of svm adaboost dts and rf in the indication of regions with high rans uncertainty their work showed that rf had the best combination of good performance and easy implementation sikirica et al 2020 used rf to determine the empirical constants in the kunz cavitation model and thus obtained predicted cavitation in excellent agreement with experimental results since so many researches have shown the superiority of rf we also employ rf to establish a model for tev in this work the principle of rf algorithm for building regression functions has been made clear in the work of wang et al 2017a as an ensemble method the number of trees in rf n trees is vitally important for the performance of rf there is no doubt that the larger the number of trees in rf is the better its performance will be however its performance will stop getting significantly improved beyond a critical number of trees additionally it takes longer time to compute with the increase of n trees out of bag oob score is a convenient indicator for assessing the performance of rf which is defined as follows 2 o o b s c o r e 1 i y i t r u e y i p r e d 2 i y i t r u e y 2 where y i t r u e y i p r e d and y are the real value the output of rf and the mean of all the real values respectively the closer oob score is to 1 the better the model is therefore we use this score to determine the value of n trees fig 4 shows the variation of oob score versus the value of n trees it can be seen that when n trees is beyond 20 oob score almost remains unchanged to achieve a good balance between the performance of rf and its computing efficiency n trees is set to 20 in the present paper the implementation of the rf regression model is through the scikit learn library of python 3 3 machine learning assisted workflow the machine learning assisted workflow proposed in the present paper is mainly composed of two parts the machine learning model training and cfd calculation the former is a preliminary work based on les results and produces a satisfying model that is called in each timestep of subsequent formal rans calculation as for cfd calculation an innate tev field abbreviated as tevrans hereafter along with some other informative fields associated with the inputs of rf model can be obtained after each timestep of rans calculation fed with the inputs the rf model makes a prediction of tev denoted by tevrf then we substitute tevrf for tevrans followed with the next timestep of rans calculation fig 5 is a flow chart of the above procedure 4 results and discussions 4 1 rans and les predicted cavitation behavior the comparison of cavitation evolution in a typical period among the experiment rans and les results is shown in fig 6 the quantitative comparison of the time averaged lift coefficient c l drag coefficient c d and cavitation evolution cycle t is given in table 3 it can be seen that les results capture the shedding process of sheet cavitation and agree much better with experimental images when compared with rans results the sheet cavitation predicted by rans simulation is consistently attached to the leading edge of the hydrofoil and does not display the shedding process accordingly the errors of c l c d and t predicted by rans and les are different and the errors of rans are significantly higher than that of les fig 7 compares the distribution of instant and time averaged tev predicted by rans and les respectively it can be seen that there is no significant difference between the instant and time averaged results a huge distinction of tev between rans and les results can be observed les predicted tev is rather in a mess around sheet cavitation and in the wake when compared with rans predicted tev another striking difference is that there are regions with negative tev in les result mainly in the re entrant jet region and in the wake it is known that a non negative tev is presumed in the boussinesq hypothesis however this assumption may not be valid in regions of rapidly changing velocity gradient pope 2000 furthermore ling and templeton 2015 marked the regions of breakdown of non negativity assumption in various turbulent flows using machine learning which were mainly near the boundary layer and in the wake of some flows therefore there is a reasonable prospect that les predicted negative tev is credible and may be closer to the real state of local flow 4 2 machine learning assisted rans results fig 8 displays cavitation evolution in a typical period reproduced by rans method with the assistance of machine learning the five subplots correspond to the five stages in fig 6 compared with the cavitation evolution presented by original rans method see the middle column in fig 6 the effect of machine learning is manifested with the machine learning predicted tev the sheet cavitation exhibits a periodic process of growth and shedding and the shed cavities are more unsteady acting more like cloud cavitation for a more intuitive comparison the basic performance parameters predicted by machine learning assisted rans including the time averaged lift coefficient drag coefficient and cavitation evolution cycle are incorporated into table 3 in terms of the time averaged lift coefficient and drag coefficient there is a slight improvement in accuracy compared with the original rans results while the time averaged cavitation evolution cycle predicted by the machine learning assisted rans agrees perfectly with the experimental data fig 9 compares the time averaged streamwise velocity predicted by rans les and machine learning assisted rans the location of the four different cross sections is schematically shown in the subplot in general the results of machine learning assisted rans fall between that of les and rans and are more consistent with the experimental data in most cases when compared with the original rans results meanwhile the velocity profile on the cross section x 1 0c deserves our attention although rans seems to outperform les and machine learning assisted rans it yields no negative velocity indicating that there is almost no re entrant jet at the time averaged level on the contrary les predicts negative velocity in the region of 8mm y 0 mm while machine learning assisted rans also captures the re entrant jet at the average level of time but with lower intensity and smaller region fig 10 shows the distribution of tev predicted by rf model tevrf at the typical instant t 4 0 825t ref which is in the stage of re entrant jet development and thus is of our interest it can be seen that tevrf is mainly concentrated around cavitation compared with tevrans and tevles in fig 7 tevrf is significantly different from tevrans and similar with tevles to some extent the remarkable differences between tevrf and tevrans are around the cavities and in the wake region where tevrf is distributed more irregularly and is smaller than tevrans respectively note that one of the main effects of fbdcm proposed by huang et al 2013 is exactly reducing tev in the wake region otherwise the rf model yields negative tev near the trailing edge indicative that the local flow might be too complex to conform to the boussinesq hypothesis nevertheless the machine learning assisted rans method still underperforms les which is foreseeable the main reasons are twofold firstly as already mentioned in the subsection dataset preparation the test inputs come from rans results while the rf model is constructed using les results secondly there is training error however it should be noted that the nodes number for rans is an order of magnitude lower than that for les which speeds up the calculation a lot even taking into account the time it takes to invoke the rf model at each timestep of calculation table 4 presents the time consumption for the transient simulation during physical time δt phy 0 01s among the three methods all the simulations were conducted on cpu intel xeon e5 2630 2 4 ghz using a single core on even ground the results further confirm the superiority of the machine learning assisted rans method that it can achieve a satisfying balance between accuracy and time consumption to sum up in the context of modeling tev in the cavitating flow apart from proposing a correction function that can be formulated data driven machine learning is also a promising approach with the machine learning model rans method is able to make more accurate predictions about velocity profile and basic performance parameters of the hydrofoil capture the shedding process of sheet cavitation and better reproduce the unsteadiness of the shed cavities showing remarkable superiority over the original rans method 4 3 generalization performance of the machine learning model many researchers lay special emphasis on generalization performance of a machine learning model as introduced in the subsection dataset preparation generalization performance signifies the machine learning model s predictive ability given the dataset that it has never seen before the machine learning assisted rans method s capability to capture the shedding process discussed in the previous subsection has preliminarily confirmed the rf model s generalization capability however more ideally the unseen dataset should stem from numerical results under the operating condition far away from that used for training here we provide a further qualitative assessment of the rf model s generalization performance by simulating the cavitating flow under conditions u 9 m s and 11 m s with the consideration that different inlet velocities result in different cavitation strength fig 11 displays cavitation evolution under the conditions u 1 9 m s and u 2 11 m s combined with cavitation evolution under condition u 10 m s see fig 8 the small variation in inlet velocity seems to make little difference to cavitation intensity and behavior in general while cavitation evolution is more periodic at a lower inlet velocity fig 12 shows the distribution of machine learning predicted tev at the typical instant t 3 as a comparison the distribution of les predicted tev is also shown in fig 12 under the condition u 1 9 m s both machine learning predicted tev and les predicted one are concentrated around cavitation and in the near downstream on the other hand both are negative in a small and scattered area of the wake under the condition u 2 11 m s tev predicted by the two methods also possesses similar distribution characteristic that is a subtle concentration and negativity however there are still some distinctions between the two results that need to be noted for example the distribution of tev in the wake produced by les is more complicated than that produced by rf in general the fact that machine learning predicted tev and les predicted one under the two different conditions share the similar distribution characteristic proves the generalization performance of the rf model effectively on the other hand in combination with tevrf distribution under condition u 10 m s see fig 10 the concentration of tevrf around cavities seems to diminish with the increase of inlet velocity this concentration of tevrf and overall unevenness of its distribution might be the cause of greater periodicity at a lower inlet velocity 5 conclusions in the present paper the cavitating flow around the clark y hydrofoil is investigated numerically with a machine learning assisted rans method where a data driven machine learning model for tev is constructed based on high fidelity les results the machine learning assisted rans method gives a better representation of the shedding process of sheet cavitation compared with original rans results the main conclusions are as follows 1 a random forest model for tev fed with a rich set of 20 inputs containing essential information about the cavitating flow field is constructed using high fidelity les results the model effectively reproduces the concentration of tev around cavitation and reduces tev in the wake region in rans simulation providing an alternative for improving simulation accuracy of tev 2 with the machine learning predicted tev rans method captures the shedding process of sheet cavitation and better reproduces the unsteadiness of the shed cavities the machine learning assisted rans method makes better predictions about velocity profile and basic performance parameters of the hydrofoil including time averaged lift coefficient drag coefficient and cavitation evolution cycle showing remarkable superiority over the original rans method 3 the generalization capability of the constructed machine learning model is confirmed by simulating cavitating flows under different flow conditions from the training one in the range of investigated inlet velocities cavitation exhibits more periodicity with the decrease of inlet velocity which may be associated with more concentrated tev around cavities and a more irregular tev distribution credit authorship contribution statement mohan xu software validation investigation data curation writing original draft visualization huaiyu cheng conceptualization methodology writing review editing bin ji resources writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was financially supported by the national natural science foundation of china project nos 51822903 11772239 and china postdoctoral science foundation project no 2020m682471 the numerical calculations in this paper were done on the supercomputing system in the supercomputing center of wuhan university 
20738,operation maintenance o m costs account for a large portion of total life cycle cost for onshore wind energy and the amount is estimated to be more for offshore wind energy developing a sound opportunistic maintenance strategy is a solution to reduce o m costs and enhance wind energy s competitiveness when the wind farm is located offshore turbines are not only subject to degradation but also the impact from the harsh marine environment however the degradation is mainly regarded as the only cause of the failure in the existing opportunistic maintenance models for the offshore wind energy sector at the same time too frequent preventive dispatch of maintenance teams exists on some occasions this paper proposes a maintenance strategy for offshore wind farms integrating three types of maintenance opportunities in addition to the maintenance opportunities created by degradation failures and incidents an age based opportunity is introduced to improve the trigger of preventive dispatch a numerical example is presented to illustrate the effectiveness of the proposed strategy the comparative analysis shows 2 6 and 1 5 annual cost can be reduced respectively when compared with two traditional opportunistic maintenance strategies in the base scenario graphical abstract image 1 keywords operation maintenance wind energy opportunistic maintenance maintenance optimization nomenclature and acronyms denition k index for turbine i index for component n index for maintenance cycle k total number of turbines in the offshore wind farm i total number of components at the offshore wind turbine m total number of maintenance levels n total number of maintenance cycles c annual annual cost during lifetime s lifetime of offshore wind farm l m mth maintenance level σ i k scale parameter ε i k shape parameter λ k t intensity function p k 1 occurrence probability of critical impact p k 2 occurrence probability of influential impact p k 3 occurrence probability of minor impact b c age increase of component at cth stage due to influential impact u i k age of component i in turbine k v i k failure age of component i in turbine k f i k failure time of component i in turbine k l i k lifetime of component i in turbine k t z period zth time period a min minimum age percentage threshold a max maximum age percentage threshold w k occurrence time of environmental impact on turbine k ζ percentage threshold of number of aged components t n starting time of nth maintenance cycle a y yth age threshold θ l m maintenance quality of mth maintenance level x k tr binary variable for transportation x i k pr binary variable for preventive replacement x i k cr binary variable for failure replacement x i k mr binary variable for major repair x k ei binary variable for environmental impact x k c binary variable for critical impact x i binary variable for incident based opportunity x a binary variable for age based opportunity x f binary variable for failure based opportunity m i k cr cost of failure replacement of component i at turbine k m i k pr cost of preventive replacement of component i at turbine k m i k m mr cost of mth level of major repair of component i at turbine k m f fixed cost to trigger a cycle of maintenance m k tr transportation cost to turbine k m total tr total cost of transportation m total cr total cost of complete replacement m total pr total cost of preventive replacement m total mr total cost of major repair m total total maintenance costs generated in one maintenance cycle 1 introduction the increasing population in recent decades brings a growing global demand for energy resulting in a serious effect on the environment considering the global warming and environmental pollution renewable energy is being investigated as an sustainable and reliable option to replace conventional fossil energy sources in particular wind energy trends to be one of the most widely explored renewable and sustainable energy resources in the future according to the global wind energy council 2019 over 355 gw of new capacity will be added all over the world in the next five years that is approximately 71 gw of new installations each year until 2024 compared with onshore wind energy the power installed offshore is still relatively small however offshore wind is more promising on the long term due to the steadier and faster wind speeds at sea in europe only about 20 gw of offshore wind has been installed nowadays the european commission estimates that an installed capacity of between 230 and 450 gw could be needed by 2050 wind europe 2019 meeting 30 of europe electricity demand in 2050 as wind energy systems are growing both in capacity and complexity there are ongoing efforts to improve reliability availability maintainability and safety aiming to enhance its marketability and competitiveness marugán et al 2018 o m costs account for 12 30 of the total life cycle cost for onshore wind farms izquierdo et al 2020 and the portion is estimated to rise to more than 32 for offshore wind farms martin et al 2016 lin et al 2020 as shown in fig 1 the cost categories of o m with estimated percentages are land rent 18 insurance 13 regular maintenance repair and spare parts 43 administration costs 21 and power from the grid 5 el thalji et al 2009 this means that the maintenance activities account for almost half optimizing the o m strategy especially maintenance activities is thus an effective pattern to reduce o m costs and gain more profits as a strategic decision made by decision makers the determination of the long term maintenance strategy has a straightforward influence on wind farm o m fig 2 demonstrates the decision making process of the farm maintenance the decision maker such as offshore wind farm owner and operator or the independent service provider decides if the maintenance cycle should start according to the state of components turbines in the past decades a large amount of research has focused on the development of the maintenance for wind energy so far corrective maintenance and time based maintenance have been the main maintenance strategies applied in wind power industry nguyen and chou 2018 li jiang polinder and negenborn 2020b condition based maintenance is catching people s attention owing to rapid development of continuous monitoring and inspection techniques márquez et al 2012 relying on the collected signals such as vibration acoustic temperature magnetism and current signals fault diagnosis and prognosis are performed for developing the condition based maintenance strategy merizalde et al 2020 a large scale offshore wind farm is made up of a number of turbines besides as a type of complicated electromechanical system an offshore wind turbine system is composed of hundreds of components and subsystems qiao and lu 2015 the economic dependence among turbines and components applies when the combined maintenance leads to a different cost than repairing separately izquierdo et al 2019 it plays a positive role when travelling to the location where maintenance activities have to be executed is costly keizer et al 2017 simultaneously performing several maintenance activities is more cost effective than repairing turbines respectively the opportunistic maintenance is a type of strategy taking advantage of the economic dependence to reduce maintenance cost the concept of opportunistic maintenance was firstly introduced and applied in a case study of the rocket engine of a hypothetical ballistic missile mccall 1963 radner and jorgenson 1963 there are no norms standards or consensual accepted meanings of opportunistic maintenance thomas et al 2008 it is a systematic research to determine what time to perform maintenance activities for what reason and what components or turbines can be repaired by making use of the opportunities 1 1 previous research in 2009 besnard et al 2009 applied the opportunistic maintenance strategy to offshore wind energy opportunistic occasions appear when power production is unsatisfying because corrective maintenance has to be performed on a wind turbine or the wind speed is low the case study shows taking these opportunities can effectively reduce maintenance costs due to the considerable potential the number of literature focusing on opportunistic maintenance of wind energy sector is increasing in the following years we make a comparative analysis after reviewing the following representative papers as shown in the table 1 1 1 1 degradation and environmental impact ding and tian 2011 proposed an opportunistic maintenance model with two level repair actions for wind turbine systems the failures of the components are caused by the degradation the failure times are modelled as weibull distribution perfect and imperfect maintenance actions are performed depending on component states then ding and tian 2012 introduced different maintenance thresholds in their model to distinguish the failed turbines and working turbines instead of the two level maintenance threshold sarker and faiz 2016 proposed the concept of multi level maintenance in their work degradation results in the component failure the interval between maximum and minimum maintenance thresholds is divided into multiple groups after discussing the relationship between maintenance costs and the number of maintenance levels the optimal number of level is selected to minimize the total costs similarly the failures of the components are also assumed to be caused by degradation processes in the literature abdollahzadeh et al 2016 atashgar and abdollahzadeh 2016 erguido et al 2017 lu et al 2018 zhou and yin 2019 zhang et al 2017 introduced the hybrid hazard rate method into the opportunistic maintenance model the method describes the degradation processes causing the failures where the increase of operation time will accelerate the degradation and weaken the maintenance improvement li et al 2020c used nonhomogeneous continuous time markov process to represent the multi state model of offshore wind turbine subsystems the subsystems transfer from one state to another state as the operation time increases the most cost effective combination of qualified components is selected to reduce the maintenance costs when compared with individual maintenance it is remarkable that in these models the wind turbines only experience the degradation the system deteriorates over time due to wear erosion fatigue corrosion and so on this normal degradation process applies when the operation condition is ideal however the offshore structures suffer from the impact resulting from the harsh marine environment e g sea ice atmospheric icing typhoon sea wave lightning strike sudden change in wind speed or direction the harsher the environment is the random impact will arrive more frequently and the influence will be more serious when the turbine works in the practical environments it is not only subjected to degradation processes but also the random environmental impact throughout the whole service life the presence of these environmental impact on the critical components especially rotor blades has effect on the performance of o m and the overall economics of a wind energy project battisti et al 2006 pastromas et al 2018 only a few paper considered degradation and environmental impact simultaneously when developing opportunistic maintenance for wind energy shafiee finkelstein and bérenguer 2015 proposed an opportunistic condition based maintenance policy for a rotor blade system the multi blade system is subjected to stress corrosion cracking and environmental impact in order to avoid the expensive failure replacement a maintenance team is dispatched to repair critical blade before the failure occurs and other blades are preventively repaired as well the maintenance model considering random environmental shocks has been increasingly concerned in the field of reliability and engineering in the past years many industrial systems operate in the random shock environment and suffer from the damage of these shock which triggers the state transitions of the system the shock models investigated in the literature include cumulative shock model extreme shock model run shock model delta shock model and mixed shock model wang et al 2020 in addition for some complicated systems various dependence exists between the shock and degradation namely shock degradation dependence and degradation shock dependence che et al 2018 when considering the shock degradation dependence the assumptions are made that these impact may result in the abrupt increase of degradation ruiz castro 2016 the increasing degradation rate rafiee et al 2014 or even the sudden incidents when considering the degradation shock dependence many studies assume that the intensity or the magnitude of shock is dependent on the degradation process of the system fan et al 2017 fan et al 2000 che et al 2018 developed a facilitation model where the mutual degradation shock dependence and shock degradation dependence are simultaneously considered a case study of a jet pipe servo valve is presented to demonstrate the established model 1 1 2 maintenance opportunities as the description of the opportunistic maintenance models for wind energy in the table 1 ding and tian 2011 2012 sarker and faiz 2016 li et al 2020c assumed that the occurrence of a component degradation failure can be considered as a type of maintenance opportunity failure based opportunity it is a very common assumption when developing opportunistic maintenance strategy this failure based maintenance opportunity can trigger a maintenance cycle where the maintenance teams are correctively dispatched to simultaneously replace the failed components and perform preventive maintenance on the components needing repair as we know the failure should be avoided as much as possible given the fact that the cost of failure replacement is very expensive therefore it is not necessary to start a maintenance cycle only waiting for the occurrence of the turbine failure in the literature zhang et al 2017 lu et al 2018 zhou and yin 2019 a preventive maintenance threshold is set to determine if the turbine component is in a defective or almost unacceptable state in addition to the maintenance cycle triggered by failure a maintenance cycle can also be triggered if any turbine component in the farm exceeds this preventive maintenance threshold actually this preventive maintenance decision can be regarded as the preventive dispatch of maintenance teams in the literature abdollahzadeh et al 2016 atashgar and abdollahzadeh 2016 erguido et al 2017 the preventive dispatch of maintenance teams is clearly addressed meaning not until the failure occurs the maintenance opportunity can also emerge to dispatch the maintenance teams preventively when a component satisfies the maintenance requirement reach the threshold generally the maintenance opportunity will appear in these two occasions a failure occurs a component reaches the preventive maintenance threshold however although the preventive dispatch of maintenance teams has been introduced in the models this action may not be as cost effective as we expect the maintenance team has to move to the wind site if even the single component reaches the predetermined threshold it may be feasible when the farm is located onshore considering the effort and cost to dispatch the vessels and staff to the remote location away from the shore the execution of preventive dispatch triggered by single component is not economic enough for offshore wind farms these maintenance decisions may induce over frequent but unnecessary maintenance activities furthermore in these existing opportunistic maintenance models for wind energy the consequences of environmental impact have not been considered as discussed in section 1 1 1 for example the critical impact may also result in the incident that the suffering turbine stops operating and requires maintenance which can also provide the opportunity to repair the other turbines in the farm in the table 2 an extensive literature review is made for the opportunistic maintenance with impact of external factors shocks not limited to the area of wind energy cui and li 2006 developed an opportunistic maintenance for a multicomponent cumulative damage shock model when the cumulative damage exceeds the predetermined threshold the component will fail and create a maintenance opportunity for the system zhang 2019 developed a delay time model for an industrial system considering the external shocks the impact of shocks on system may result in the random hazard rate increments shock degradation dependence the developed model is demonstrated on a critical steel convertor plant in a steel mill a series system which consists of two components with multi stage accelerated damage is studied by zhao et al 2019 when the state of components gets worse the shocks with the same magnitude may have more severe influence on the component state a numerical example of a two rolling bearing system is presented to demonstrate the proposed model hu shen and shen 2020 studied the situation that the system consisting of two independent components is subjected to the degradation and external shock the shock rate will increase as the increase of the degradation level of the component degradation shock dependence the maintenance will be carried out when the degradation exceeds the preventive maintenance threshold or a fatal shock occurs a hydraulic system consisting of two valves in series is used as the example to illustrate the proposed maintenance strategy zhang and yang 2020 proposed a state based opportunistic maintenance for industrial assets exposed of environmental impact the impact of environmental stress on system deterioration is various based on the state of the system resulting in the increments on the hazard rates shock degradation dependence the unscheduled events due to several factors including production shortage and desired tasks can also be regarded as the window to perform maintenance besides replacement although these studies considered the influence of environmental impact when developing opportunistic maintenance model the limitations still exist the models considered opportunities existing in a simple system such as a series system consisting of two components not extending the model to multiple systems such as an offshore wind farm every turbine can be regarded as a multi component system the maintenance performed on a component should provide maintenance opportunities for all the turbines in the farm instead of only the located turbine moreover some of the models assume that once one component reaches a preventive maintenance threshold a maintenance cycle will be initiated this maintenance decision may not be reasonable enough when applied to a wind farm as the farm size enlarges and the number of the component increases the maintenance team has to move to the offshore location frequently because the occasion easily happens that one component reaches the threshold as discussed above the problem also exists in the opportunistic maintenance models for wind energy but has not been studied before 1 2 proposed strategy to address the above issues we consider the influence of environmental impact when developing the maintenance model and analyse the trade off between the frequency of preventive dispatch of maintenance teams and maintenance costs the purpose of this paper is to propose an opportunistic maintenance strategy that reduces maintenance costs over an offshore wind farm s service life the attempt is integrating multiple types of maintenance opportunities into the maintenance strategy based on the shock degradation dependence the impact can be generally categorized into three types depending on the severity that is critical impact influential impact and minor impact critical impact is so fatal to induce the occurrence of incidents then the undergoing component fails and the failure replacement is required the influential impact leads to a sudden increase of the degradation the minor impact may cause a negative influence on operation such as the reduction of power generation but the system will recover soon without any failure when the dispatch of maintenance teams is caused by degradation failures or incidents these maintenance opportunities are called the failure based opportunity and incident based opportunity respectively furthermore the maintenance team is dispatched preventively when a portion of components reach the age thresholds which can be called the age base opportunity the simulation technique is used to evaluate the annual maintenance costs during the whole service life a numerical example is provided to illustrate the proposed maintenance model a comparative study with the conventional opportunistic maintenance strategy is used to demonstrate the advantage of the proposed strategy in reducing maintenance cost 1 3 outline the remainder of the paper is listed as follows in section 2 the proposed opportunistic maintenance strategy is formalized the failure of components and turbines as well as the maintenance process are described and analytically derived in section 3 a numerical example is used to illustrate the proposed strategy the optimization results and comparative study are presented finally conclusions and future works are presented in section 4 2 model description in this section a mathematical model is developed to formalize the proposed opportunistic maintenance strategy in the model three types of maintenance opportunities can trigger maintenance cycles where the maintenance team is dispatched to the site to repair or replace the components satisfying the maintenance requirements after finishing the maintenance actions on qualified components the maintenance cycle will end until the maintenance opportunity appears next time the total costs represent the sum of money generated from repair activities during the maintenance cycles 2 1 assumptions in the offshore wind farm we assume that all the turbines are of the same type after a wind farm maintenance decision is made sufficient preparation is done to ensure the execution of maintenance activities is as successful as we expect therefore the following assumptions are made on the offshore wind farm 1 a specific component is of similar nature for all the turbines in the farm the same maintenance activity performed on the specific component spends the same money no matter the component is contained at which turbine 2 the time spent on performing maintenance activities is negligible when compared to the long service time of farms 3 the maintenance resource and capacity including staff tools spare parts transportation means etc are always available to complete all the maintenance tasks in the farm 4 the accessibility to the location of the farm will not be affected by any negative factor such as weather conditions for an individual offshore wind turbine it can be regarded as a series system because the failure of subsystem may result in the entire system break down for the mechanical or electromechanical components in the turbine weibull distribution is appropriate to model the failure times poisson process is a completely random process and each point is stochastically independent of all the other points in the process impact from marine environment arrives randomly with the average rates varying with time so non homogeneous poisson process is suitable to describe this process hence the following assumptions are made on every individual turbine 1 offshore wind turbine system is simplified to a series system of critical components 2 the degradation failure times of components are modelled as a two parameter weibull distribution with scale parameter and shape parameter the arrival times of the environmental impact are modelled as a non homogeneous poisson process 2 2 failure of component suppose that there are k offshore wind turbines consisting of i critical components connected in series the particular type of components in different turbines would undergo the same degradation process if they operate under the same ideal condition this process can be defined as the normal degradation process the environmental impact arriving at the turbines may have an influence on the component degradation or failure considering degradation and environmental impact at the same time can describe the degradation mechanism of components more accurately zhou et al 2016 it is assumed that the arrivals of environmental impact and the deterioration of the system are independent caballé and castro 2017 2 2 1 degradation in the whole lifetime the component gradually degrades as the age increases until failure assuming that the failure time of component i at turbine k is modelled as a weibull distribution with scale parameter σ i k and shape parameter ε i k the component has the probability density function f i k t as 1 f i k t ε i k σ i k t σ i k ε i k 1 e t σ i k ε i k the reliability function can be expressed as 2 r i k t e t σ i k ε i k the degradation degree increases as the time passes the mean time to failure m t t f i k denotes the expected time to failure for the component and can be represented as 3 m t t f i k 0 t f i k t σ i k γ 1 ε i k 1 with γ denoting the gamma function the lifetimes of components are randomly generated by employing the weibull distribution let α i k σ i k ε i k inverse weibull model is used to generate weibull distributed random numbers we could begin with the random number γ which is in the range from 0 to 1 then we can use the following equation to obtain new independent random numbers which have the weibull distribution with the mean and variance depending on shape and scale parameters de gusmao ortega and cordeiro 2011 these random numbers will be assigned to corresponding components to represent their lifetimes tian et al 2011 4 t i k 1 α i k ln 1 γ 1 ε i k the degradation process of components may also be affected by some factors such as environmental impact for example at time point t 1 and t 2 two times of impact arrive resulting in the component degradation increases abruptly with the magnitude of b 1 and b 2 respectively fig 3 2 2 2 environmental impact we assume that the impact arrives somewhat randomly modelled as a non homogeneous poisson process a non homogeneous poisson process n k t t 0 is a counting process where n k t is the number of load arrivals during time 0 t and the intensity function λ k t varying with time is a non negative integrable function satisfying the poisson postulates leonenko et al 2017 the poisson random variable having mean is given by 5 λ k t λ k 0 t 0 t λ k z d z in order to simulate the occurrence times of impact we can use the thinning algorithm to simulate the points in the non homogeneous poisson process kim and singh 2009 xu and dowd 2010 the procedure starts with the determination of the maximum intensity value λ and with the generation of a realization of a homogeneous poisson process with intensity value equal to this maximum intensity value after that the generated points of the homogeneous poisson process at location t are retained and discarded based on the probability λ k t λ lewis and shedler 1979 2 3 failure of offshore wind turbine considering the offshore wind turbine is a series system the system fails once a component failure occurs in other words the component failures caused by degradation and environmental impact will force the turbine where the component is located to stop working immediately not every environmental impact must induce the failure of turbines the impact can be generally categorized into three types depending on the severity that is critical impact influential impact and minor impact the critical impact means the impact is so disastrous that the turbine will break down until the failed component is completely replaced the influential impact will cause an abrupt increase of the degradation the minor impact will not make the turbine break down it may affect the operation or production of wind turbines temporarily so it is not necessary to perform maintenance correspondingly the occurrence probability of critical impact p k 1 0 p k 1 1 is the least because this incident rarely happens the probability of minor impact p k 3 0 p k 3 1 is the most and the probability of influential impact p k 2 0 p k 2 1 is intermediate the sum of p k 1 p k 2 and p k 3 is equal to 1 2 4 opportunistic maintenance model after studying the failure mechanism of turbines in the offshore wind farm the opportunistic maintenance model will be developed to determine what time to activate maintenance activities and how the components will be repaired the money spent on these maintenance related activities will generate the corresponding maintenance costs 2 4 1 maintenance opportunities there are three types of maintenance opportunity in the model namely failure based opportunity age based opportunity and incident based opportunity the maintenance opportunities emerge when the corresponding situations happen every type of maintenance opportunity can initiate a maintenance cycle in the offshore wind farm in fig 4 the detailed flow chart of the proposed opportunistic maintenance strategy is introduced only in the case that no opportunities happen the system is determined to be without maintenance 1 failure based opportunity when the component i at turbine k breaks down because of the degradation the maintenance opportunity will be triggered 2 age based opportunity no component fails but a certain number of components reach the specific age threshold the maintenance opportunity will arrive 3 incident based opportunity if the arriving environmental impact is critical so that the component fails the maintenance opportunity will appear when the offshore wind farm begins to operate all of the components are brand new their ages u i k are certainly 0 the inverse weibull model is adopted to generate the random lifetime l i k of each component the failure age v i k of the component equals its lifetime once the age reaches the failure age this components will break down due to degradation after every period of time t 1 period t 2 period t z period the information of system is updated to determine if maintenance actions are needed during time t z 1 period to t z period the environmental impact is firstly checked for each component subject to the environmental impact the arrival time of impact is w k if t z 1 period w k t z period the turbine k has to endure the environmental impact x k ei 1 considering the impact is critical influential or minor the binomial distribution can present whether the impact can induce the incident if the impact is minor the turbines will maintain in the previous state if the impact is influential an abrupt increase of component age will be caused with the value b c we separate the interval between maximum age percentage threshold a max and minimum age percentage threshold a min into groups of equal lengths a min a y a max if the component is younger than a min there will an age increase with b 1 the age will be updated to u i k 1 b 1 the age of components in the group between a min and a 1 will increase with b 2 and so on the younger component is the age increase will be less because it is in a better state to withstand the impact if the impact is so catastrophic to destroy the turbine x k c 1 the incident based opportunity is generated x i 1 if no incident happens then the failure times f i k are compared with the real time if t z period f i k that means the component won t fail during this period and no failure replacement is needed the binary variable x i k cr is equal to 0 only for all the components the x i k cr 0 the value of x f is 0 otherwise the t z 1 period f i k t z period the degradation failure occurs on one component in this case x i k cr 1 the failure based opportunity appears x f 1 and one maintenance cycle will launch if it is lucky that no failure occurs during this time period the third maintenance opportunity age based opportunity should be estimated for component i at turbine k if its age u i k is more than a specific percentage of failure age v i k the component is regarded as an aged component in other words the component is judged as aged because it exceeds the maximum age threshold a max we assume ζ is the percentage threshold of number of aged components if the total number of aged components in the wind farm is greater than or equal to u u ζ i the age based opportunity is triggered x a 1 if x a x i x f 0 no maintenance is needed during the period the time moves to next period and values of time and age are updated 2 4 2 maintenance actions three maintenance actions are included in one maintenance cycle failure replacement is conducted on the failed component due to degradation or critical impact the failure replacement means the component is completely replaced to a component of similar nature implying the component is brand new with the age reset to zero if the component is to fail because of the degradation it is qualified for a preventive replacement the preventive replacement can also restore the age of component to zero because it is preventively carried out before the failure to avoid potentially serious damages so the cost is less when compared with failure replacement the major repair will be carried out on the components satisfying the requirements between maximum and minimum age threshold the major repair can effectively improve the component health the maintenance actions for components of different stages are illustrated as fig 5 the nth maintenance cycle begins after the maintenance opportunity emerges the starting time of this cycle is t n the component states in the site can be classified into four cases failed aged mature and young 1 failed component as introduced above the failed components no matter due to degradation or critical impact should be completely replaced their corresponding binary variables x i k cr 1 accordingly their ages are reset to 0 as follows 6 u i k new 0 by sampling from weibull distribution the lifetimes of these new components are obtained l i k then their new failure ages equals to the lifetime v i k new is known the next failure times can be obtained as 7 f i k v i k new t n 2 aged component in the maintenance cycle the ages of running components are compared with the predetermined age thresholds we assume two percentages of failure ages as basic thresholds a max and a min if u i k old v i k old a max it is determined as the aged component to be replaced and x i k pr is equal to 1 similar to failed component the age will be restored to 0 after preventive replacement as follows 8 u i k new 0 the new lifetimes l i k and failure ages of these components v i k new are obtained the occurrence time of next failure can be obtained as 9 f i k new v i k new t n 3 mature component for the running components with ages between maximum and minimum thresholds namely v i k old a min u i k old v i k old a max these components are judged as mature components which major repair should be conducted on x i k mr 1 the components in the group between a min and a 1 will undergo the l 1 level maintenance action the l 2 level maintenance action is performed on the components between a 1 and a 2 and so on for the mth maintenance level l m there is a maintenance quality θ l m the maintenance quality means the age of components can be improved to a fixed percentage moghaddam and usher 2010 therefore the ages of component will be updated after major repair as follows 10 u i k new θ l m u i k old the failure age is updated as follows sarker and faiz 2016 11 v i k new v i k old θ l m 1 θ l m l i k the occurrence time of next failure is as follows 12 f i k new v i k new u i k new t n 4 young component for the components younger than the minimum threshold u i k old v i k old a min there is no need to maintain them they are left there to continue operation and no money is spent on them during the maintenance cycle they still retains the previous state so the degradation process and failure age don t change as follows 13 v i k new v i k old after the maintenance cycle their ages are updated as follows 14 u i k new u i k old the occurrence time of next failure is as follows 15 f i k new v i k new u i k new t n 2 4 3 maintenance costs the objective is to reduce the total maintenance costs of offshore wind farm after developing the maintenance model the cost generated in the procedure is calculated to estimate economic the first step is to calculate the money spent on four types of components failed aged mature young in each maintenance cycle for the failed component it should be completely replaced so the total cost of failure replacement of the wind farm m total cr is as follows 16 m total cr k 1 k i 1 i m i k cr x i k cr where m i k cr represents the cost of failure replacement of component i at turbine k and x i k cr is the binary variable to determine whether this component needs to be replaced for the aged components reaching the maximum age threshold they are replaced as well the money spent on activities of preventive replacement m total pr is calculated as 17 m total pr k 1 k i 1 i m i k pr x i k pr where m i k pr represents the cost of preventive replacement of component i at turbine k and x i k cr is the binary variable to check if preventive replacement is required the mature components with ages between the maximum and minimum age thresholds are qualified for major repair in the present work it is commonly assumed that the cost m i k m mr of intermediate maintenance level performed on component is function of the expected value θ l m of the improvement coefficient of l m in addition to the age and the operating state of the component pandey et al 2013 according to literature khatab and aghezzaf 2016 duan et al 2018 the cost of major repair can be obtained as 18 m i k m mr r i k m m i k pr 1 θ l m d i k m η i k m where r i k m and d i k m are the characteristic constants that determine how the improvement coefficient affects the corresponding intermediate maintenance cost variable η i k m represents the stability level of the maintenance quality the d i k m η i k m is smaller then the major repair will be more expensive therefore the total costs of major repair is 19 m total mr m 1 m k 1 k i 1 i m i k m mr x i k mr m 1 m k 1 k i 1 i r i k m m i k pr 1 θ l m d i k m η i k m x i k mr where x i k mr is the binary variable to indicate if major repair is necessary for the young components they aren t maintained in the maintenance cycle consequently no cost is consumed for these components moreover some extra cost exists along with the cost for maintenance tasks when conducting maintenance fixed cost m f is the money used to make some preparation and trigger maintenance activities dalgic et al 2015 martin et al 2016 m k tr is the transportation cost to turbine k in one maintenance cycle thus more turbines are visited and repaired the transportation cost is higher therefore the total transportation cost is 20 m total tr k 1 k m k tr x k tr where x k pr is the binary variable to indicate if the turbine is visited finally the total cost of one maintenance cycle is calculated as follows 21 m total m f m total tr m total pr m total cr m total mr m f k 1 k m k tr x k tr k 1 k i 1 i m i k pr x i k pr k 1 k i 1 i m i k cr x i k cr m 1 m k 1 k i 1 i r i k m m i k pr 1 θ l m d i k m η i k m x i k mr it is assumed that the offshore wind farm operates for s years lifetime which n cycles of maintenance are carried out during we can calculate the total costs during s years and further obtain the annual cost c annual as follows 22 min c annual a min a max ζ n 1 n m total s 1 s n 1 n m f k 1 k m k tr x k tr k 1 k i 1 i m i k pr x i k pr k 1 k i 1 i m i k cr x i k cr m 1 m k 1 k i 1 i r i k m m i k pr 1 θ l m d i k m η i k m x i k mr s t 0 a min a max 1 where a min minimum age percentage threshold a max maximum age percentage threshold and ζ percentage threshold of number of aged components are the decision variables of the proposed model actually the values of a min and a max can be regarded as the criterion to determine whether a component is qualified for the repair if it is older than a min but less than a max a major repair is needed if it is more aged than a max it should be preventively replaced by varying the thresholds the number of components which should be repaired will change accordingly the variable ζ can determine how many aged components can trigger the age based opportunity the objective is to determine the optimal combination of variables which can minimize the annual maintenance cost during the whole lifetime 3 numerical example in order to illustrate the effectiveness of the proposed opportunistic maintenance method a numerical example of the offshore wind farm is used in this section the optimization results of three strategies are represented a comparative study with the conventional opportunistic maintenance strategies under the same parameters demonstrates the advantage of the proposed strategy in reducing the maintenance cost 3 1 scenario set up we assume that there is an offshore wind farm containing 50 offshore wind turbines following a design life of 20 years it is noted that the numerical example is generic instead of a real and specific wind farm operating considering the turbine is a type of complicated electromechanical system containing hundreds of components it is difficult to take every subsystem into account previously published results in peer review journals shafiee and dinmohammadi 2014 arabian hoseynabadi et al 2010 kang et al 2019 zhang et al 2016 kang sun sun andwu 2017 zhou et al 2015 scheu et al 2019 li teixeira and soares 2020a have revealed the criticality ranking of wind turbine components by using the methods such as failure modes and effects analysis fmea failure mode effects and criticality analysis fmeca two stage failure mode and effect analysis etc in our model every turbine is simplified to a multi component series system with five critical subsystem gearbox generator rotor blade pitch system and main bearing due to the extremely low failure rates tower and support structure are not considered in our model the blade is the component more subject to the environmental impact and the influence of critical impact on other components are ignored because of the protection of cabin carroll mcdonald and mcmillan 2016 collected the maintenance information of operational data of 1768 turbines years the data is based on 350 offshore wind turbines which are from between 5 and 10 wind farms throughout europe the ages of turbines are between from 3 to 10 years the capacity is between 2 and 4 mw and the rotor diameter is between 80m and 120m santos teixeira and soares 2015 le and andrews 2016 also collected and estimated the failure distribution and maintenance cost from several studies in the literature focusing on the o m for european wind energy the basis of the input information of the model is mainly estimated from these papers table 3 which represents the properties and parameters of the example of the offshore wind farm the decision moments are assumed to be periodic 20 days the fixed cost m f and transportation cost m k tr are 50k and 10k respectively the intensity function of external factor is assumed to be 2 27 t 27 shafiee et al 2013 2015 the value of p k 1 p k 2 p k 3 is assumed to be 0 001 0 005 and 0 994 three age thresholds maximum threshold a max intermediate threshold a y and minimum threshold a min are considered in the model the maintenance improvement of two levels l 1 and l 2 are 0 5 and 0 7 respectively indicating the maintenance quality will be more significant for older components accordingly the maintenance task of higher quality is more costly the values of b 1 b 2 b 3 and b 4 are 0 025 0 05 0 075 and 0 1 respectively the values of r i k m and η i k m are both 1 and d i k m is 2 3 2 optimization results the possible maintenance optimization techniques include operations research models analytical approaches markov models simulation models petri net models bayesian networks and so on shafiee and sørensen 2019 in recent years increasing attention has been directed towards improving and optimizing maintenance for industrial systems using the simulation method one main reason is that many practical cases are too complicated to be given tractable mathematical formulations the simulation method has the potential to tackle these challenging optimization problems involving nonlinearities combinatorial relationships and uncertainties april et al 2003 in addition it allows experimenting and better understanding of systems with increasing complexity alrabghi and tiwari 2015 this method has been used in many studies about maintenance strategy optimization do et al 2015 in this paper the simulation frame work is established for the maintenance model of the offshore wind farm as shown in fig 6 the simulation algorithm is presented in algorithm 1 the monte carlo simulation method is implemented to evaluate the outcome of the proposed maintenance strategy there have been three strategies nabo strategy sabo strategy and mabo strategy as follows 1 nabo strategy in the first strategy only failure and incident can trigger the maintenance opportunities and the age based opportunity is not considered similar as the model in some papers such as sarker and faiz 2016 this kind of strategy is called as nabo strategy none age based opportunity 2 sabo strategy failure and incident can trigger the maintenance cycle besides if any component age reaches a max the age based opportunity will arise like the model in some papers such as lu et al 2018 the model is called sabo strategy single age based opportunity 3 mabo strategy we call the developed model in the present paper is mabo strategy multiple age based opportunity failure based incident based and age based opportunities exist in the strategy if a predetermined number of components are aged the maintenance decision can also be made to maintain the wind farm image 1 as introduced above the decision variables of the model mabo strategy are a min a max ζ the annual maintenance cost is the function of these decision variables genetic algorithm ga is a metaheuristic proposed according to the evolution of organisms in nature which has been widely used to tackle the maintenance optimization issue compare et al 2015 ga has its advantages when compared with other optimization methods such as avoid being trapped in local optimal solution by searching parallel from a population of points use probabilistic selection rules instead of deterministic ones etc in this paper we adopt ga to find the optimal combination of variables the algorithm was configured with a population size of 40 individuals and a maximum number of generations g of 50 the fitness value of each individual is evalauted by monte carlo simulation with 500 times with this setting the simulation in fig 6 should be run 1 10 6 times which is implemented in matlab software the ga optimization process results are represented in fig 7 the optimal combination of three decision variables is about 0 65 0 94 1 2 with the lowest value 1956k in order to illustrate how the varying variables affect the annual cost we further test various combinations in fig 8 and show the effects of age percentage threshold under mabo strategy when ζ equals 1 2 in fig 9 in fig 8 there exists an optimal combination of the decision variables which can minimize the annual maintenance cost the variable ζ determines the exact number of the multiple in the mabo strategy we select and present four faces ζ 0 8 1 2 2 0 2 8 in the figure where the lowest point is on the yellow face ζ 1 2 the lowest point means the optimal combination of the variables 0 65 0 94 1 2 in fig 9 when changing a min or a max the trend is similar the annual cost gradually drops as the increase of age threshold until the bottom then increases to a high value for the former it can be explained that resulting from the lower threshold more components are determined to be repaired in one maintenance cycle contributing to more money then as the increase of threshold the number of qualified components decreases but the state of wind farm becomes worse due to less frequent repair for the latter the lower threshold indicates more components need to preventively replaced more components are likely to fail due to insufficient preventive maintenance if the threshold is set at a higher percentage of the failure age in fig 10 the comparison among three strategies under different thresholds is illustrated the mabo strategy is the most cost effective strategy after optimization as shown in fig 10 and table 4 in the figure the blue face mabo strategy is the lowest in almost half of the area however we can find that it is not always the most cost effective when varying the maintenance thresholds when a max is very high mabo and sabo both perform better than nabo because the expensive failure replacement can be avoided due to the benefit of age based opportunity when a max begins to decrease it will become gradually easier to trigger the age based opportunity causing the increasing maintenance frequency and cost especially for sabo yellow face in these occasions the nabo strategy has a better performance to reduce costs compared with mabo and sabo the variance of annual cost is relatively stable when changing threshold for nabo strategy as shown in green face because the change of thresholds does not affect the trigger of age based opportunity 3 3 comparative analysis in order to study the differences among three strategies and discuss the reasons all the parameters should be assumed the same and the strategies are applied on the following base scenario a max 0 95 a min 0 5 ζ 1 2 in fig 11 the monte carlo simulation of three strategies is presented where the number of iterations is presented by w the simulation is run independently in each iteration the convergence analysis for the monte carlo simulation is conducted after running the monte carlo simulation for 500 iterations it can be seen that no significant variations of the intermediate mean value are obtained it indicates that the 500 iterations provide a sufficiently accurate statistical analysis of the results the final results at the 500 simulation times are used to estimate the economic of different strategies as shown in table 5 and fig 12 these results suggest that mabo strategy shows the economic advantage compared with other two strategies by introducing the age based opportunity the cost of failure replacement decreases accompanied by a increase in the cost of major repair fixed cost and transportation cost in sabo strategy the triggering condition is set as single component the corresponding result is the offshore wind farm can be maintained to a good state with the lowest costs of replacing failed components however more maintenance cycles and activities make the costs of major repair fixed and transportation cost grow inducing the strategy doesn t perform satisfactorily in the aspect of economic the age based opportunity reduces the occurrence of failure events at the expense of triggering preventive repair more frequently the mabo strategy found a balance to reduce the replacement costs with a slight increase of the major repair fixed and transportation costs overall the proposed mabo opportunistic maintenance strategy can lower the total maintenance costs compared with the other two strategies we further show the effects of following parameters on the mabo strategy percentage threshold of number of aged components ζ the occurrence probability of critical influential and minor impact p k 1 p k 2 p k 3 the size of the offshore wind farm k the value of these parameters will change gradually and all other parameters remain fixed in fig 13 as the increase of percentage threshold ζ the annual cost drops at first until the bottom then gradually grows with slight fluctuation the size of the wind farm is 50 turbines with 250 critical components the range of percentage thresholds from 0 4 to 3 2 indicates the number threshold of aged components is from 1 to 8 when the number is 1 that means once one component is determined to be aged the age based opportunity will make the maintenance cycle start the number is 2 means two or more than two aged components can trigger the maintenance and so on for each set of percentage threshold at the threshold of 0 4 the failure occurrence can be avoided as much as possible but the frequency of maintenance is also the highest resulting from the easily triggered conditions the frequent maintenance results in the highest total cost then as the increase of threshold the negative influence of maintenance frequency weakens but component failure is more likely to occur resulting in the costly repair a balance considering these two factors is find out until the lowest point at 1 2 afterwards the effect of failure occurrence becomes significant causing the rise of annual cost setting of the parameters of the environmental impact presents the harshness of the marine environment in fig 14 it clearly shows that the annual cost rises as the increase of the probability of critical impact and influential impact the value of p k 1 has the most significant influence the higher probability results in more components have to be completely replaced so the cost of failure replacement will increase obviously the influential impact can only accelerate the degradation so its effect is less significant as shown in table 6 we have applied the opportunistic maintenance strategy to the offshore wind farms with different number of turbines when comparing mabo strategy with nabo strategy for the small scale farm the results reveal that the cost saving is the most significant as high as 11 9 however as the expansion of farm the reduction of maintenance costs become less considerable it is largely explained by the more occurrence of failure based opportunities and incident based opportunities with the increase of farm size the number of failure and incidents is less for a small scale farm in this case the age based opportunity is more promising to trigger the preventive maintenance and avoid failure replacement then save more money when the farm gets larger with even 100 turbines the failure because of degradation or environmental impact have provided a number of opportunities to start the maintenance cycles the age based opportunity could make the strategy perform better on this condition but not as substantial as small scale farm when the size is small the cost savings of sabo strategy and mabo strategy is the same because the single component is the best option to trigger preventive dispatch however the execution of sabo strategy becomes more costly as the increase of the farm size even exceeding the nabo strategy more turbines mean the number of aged component is more so the over frequent maintenance activities may result in much unnecessary costs in summary the mabo and sabo strategy can reduce maintenance costs for a small scale offshore wind farm when compared with nabo strategy as the increase of turbine number the mabo strategy is still the best option followed by nabo strategy and sabo strategy in fig 15 we change the number threshold of aged components u under the mabo strategy when the size of wind farm is different the annual cost of nabo strategy is seen as the comparison criterion and the cost saving is presented by q when the threshold is only 1 the maintenance cost is minimized for the 10 turbine and 20 turbine farm the preventive dispatch can significantly avoid the severe failure occurrence and high replacement costs furthermore the case is also difficult to happen that more than 1 components reach the maximum age threshold at the same time for a small scale farm the more thresholds can only make the age based opportunity happen more impossibly and the improvement weaken successively when the number of turbines increase to 50 80 and 100 the optimal number thresholds are obtained as 3 5 and 7 respectively showing that the optimal number of aged components increases as the wind farm enlarge 4 conclusion future research the opportunistic maintenance strategy has been studied for the wind energy sector in recent years a common assumption is made that the failure is mainly caused by degradation ignoring the influence of environmental impact furthermore the preventive dispatch of the maintenance team triggered by the occasion that a single component reaches the predetermined threshold probably induces much excessive cost in this paper an opportunistic maintenance strategy is developed for offshore wind farms the offshore wind turbines operating in the harsh marine environment do not only suffer from degradation but also impact from environment the impact may result in the abrupt increase of degradation or the sudden incidents the failures due to ultimate degradation and critical impact will create maintenance opportunities namely failure based opportunity and incident based opportunity another maintenance opportunity considering the number of aged components age based opportunity is also considered to balance costly failure replacement and over frequent maintenance cycles the simulation method is used to represent the maintenance scenarios and evaluate the average annual maintenance costs in the nabo strategy only failure and incident can create the maintenance opportunities the sabo strategy assumes that if any component becomes aged and requires preventive replacement another maintenance opportunity age based opportunity will also arise the developed strategy in the paper mabo strategy considers the number of aged components the age based opportunity will be created when the number of aged components reaches a predetermined value the comparative analysis under the based scenario shows the mabo and sabo strategies can both reduce about 11 9 cost than nabo strategy for a 10 turbine farm when the scale of the farm enlarges the mabo strategy still has the best performance an economic benefit of 2 6 and 1 5 respectively can be achieved for a 50 turbine farm when compared with sabo and nabo strategy when the number of turbine increases to 100 mabo strategy saves 3 9 and 0 5 costs respectively in comparison to sabo strategy and nabo strategy it is noted that the numerical example is generic instead of a real offshore wind farm in future work if more detailed data can be collected from a real wind farm the calculation results will be more realistic and contributive there are several potential extensions of this study the o m of offshore wind farm is a complicated task involving failure repair spare parts management transportation weather prediction and so on in this paper the assumption is made that the maintenance resource are always sufficient to perform maintenance activities and the accessibility to the location of the turbines will not be affected by any negative factor however the resource limitation and uncertain accessibility are significant problems during o m for wind energy sector the introduction of these factors into opportunistic maintenance model is worth further studying moreover the developed model is based on the assumption that the parameters of the model are certain for instance the failure time of components is modelled as a weibull distribution with parameters we have known even before the operation however these parameters should be uncertain due to the lack of knowledge of the actual use and maintenance of the equipment and inaccurate historic data and records these uncertain parameters will affect the performance of the maintenance strategy it is necessary to further consider uncertainty when improving the o m for offshore wind energy credit authorship contribution statement mingxin li conceptualization methodology software formal analysis investigation writing original draft xiaoli jiang supervision writing review editing rudy r negenborn supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is financially supported by the scholar ship from china scholarship council under grant no 201906680095 
20738,operation maintenance o m costs account for a large portion of total life cycle cost for onshore wind energy and the amount is estimated to be more for offshore wind energy developing a sound opportunistic maintenance strategy is a solution to reduce o m costs and enhance wind energy s competitiveness when the wind farm is located offshore turbines are not only subject to degradation but also the impact from the harsh marine environment however the degradation is mainly regarded as the only cause of the failure in the existing opportunistic maintenance models for the offshore wind energy sector at the same time too frequent preventive dispatch of maintenance teams exists on some occasions this paper proposes a maintenance strategy for offshore wind farms integrating three types of maintenance opportunities in addition to the maintenance opportunities created by degradation failures and incidents an age based opportunity is introduced to improve the trigger of preventive dispatch a numerical example is presented to illustrate the effectiveness of the proposed strategy the comparative analysis shows 2 6 and 1 5 annual cost can be reduced respectively when compared with two traditional opportunistic maintenance strategies in the base scenario graphical abstract image 1 keywords operation maintenance wind energy opportunistic maintenance maintenance optimization nomenclature and acronyms denition k index for turbine i index for component n index for maintenance cycle k total number of turbines in the offshore wind farm i total number of components at the offshore wind turbine m total number of maintenance levels n total number of maintenance cycles c annual annual cost during lifetime s lifetime of offshore wind farm l m mth maintenance level σ i k scale parameter ε i k shape parameter λ k t intensity function p k 1 occurrence probability of critical impact p k 2 occurrence probability of influential impact p k 3 occurrence probability of minor impact b c age increase of component at cth stage due to influential impact u i k age of component i in turbine k v i k failure age of component i in turbine k f i k failure time of component i in turbine k l i k lifetime of component i in turbine k t z period zth time period a min minimum age percentage threshold a max maximum age percentage threshold w k occurrence time of environmental impact on turbine k ζ percentage threshold of number of aged components t n starting time of nth maintenance cycle a y yth age threshold θ l m maintenance quality of mth maintenance level x k tr binary variable for transportation x i k pr binary variable for preventive replacement x i k cr binary variable for failure replacement x i k mr binary variable for major repair x k ei binary variable for environmental impact x k c binary variable for critical impact x i binary variable for incident based opportunity x a binary variable for age based opportunity x f binary variable for failure based opportunity m i k cr cost of failure replacement of component i at turbine k m i k pr cost of preventive replacement of component i at turbine k m i k m mr cost of mth level of major repair of component i at turbine k m f fixed cost to trigger a cycle of maintenance m k tr transportation cost to turbine k m total tr total cost of transportation m total cr total cost of complete replacement m total pr total cost of preventive replacement m total mr total cost of major repair m total total maintenance costs generated in one maintenance cycle 1 introduction the increasing population in recent decades brings a growing global demand for energy resulting in a serious effect on the environment considering the global warming and environmental pollution renewable energy is being investigated as an sustainable and reliable option to replace conventional fossil energy sources in particular wind energy trends to be one of the most widely explored renewable and sustainable energy resources in the future according to the global wind energy council 2019 over 355 gw of new capacity will be added all over the world in the next five years that is approximately 71 gw of new installations each year until 2024 compared with onshore wind energy the power installed offshore is still relatively small however offshore wind is more promising on the long term due to the steadier and faster wind speeds at sea in europe only about 20 gw of offshore wind has been installed nowadays the european commission estimates that an installed capacity of between 230 and 450 gw could be needed by 2050 wind europe 2019 meeting 30 of europe electricity demand in 2050 as wind energy systems are growing both in capacity and complexity there are ongoing efforts to improve reliability availability maintainability and safety aiming to enhance its marketability and competitiveness marugán et al 2018 o m costs account for 12 30 of the total life cycle cost for onshore wind farms izquierdo et al 2020 and the portion is estimated to rise to more than 32 for offshore wind farms martin et al 2016 lin et al 2020 as shown in fig 1 the cost categories of o m with estimated percentages are land rent 18 insurance 13 regular maintenance repair and spare parts 43 administration costs 21 and power from the grid 5 el thalji et al 2009 this means that the maintenance activities account for almost half optimizing the o m strategy especially maintenance activities is thus an effective pattern to reduce o m costs and gain more profits as a strategic decision made by decision makers the determination of the long term maintenance strategy has a straightforward influence on wind farm o m fig 2 demonstrates the decision making process of the farm maintenance the decision maker such as offshore wind farm owner and operator or the independent service provider decides if the maintenance cycle should start according to the state of components turbines in the past decades a large amount of research has focused on the development of the maintenance for wind energy so far corrective maintenance and time based maintenance have been the main maintenance strategies applied in wind power industry nguyen and chou 2018 li jiang polinder and negenborn 2020b condition based maintenance is catching people s attention owing to rapid development of continuous monitoring and inspection techniques márquez et al 2012 relying on the collected signals such as vibration acoustic temperature magnetism and current signals fault diagnosis and prognosis are performed for developing the condition based maintenance strategy merizalde et al 2020 a large scale offshore wind farm is made up of a number of turbines besides as a type of complicated electromechanical system an offshore wind turbine system is composed of hundreds of components and subsystems qiao and lu 2015 the economic dependence among turbines and components applies when the combined maintenance leads to a different cost than repairing separately izquierdo et al 2019 it plays a positive role when travelling to the location where maintenance activities have to be executed is costly keizer et al 2017 simultaneously performing several maintenance activities is more cost effective than repairing turbines respectively the opportunistic maintenance is a type of strategy taking advantage of the economic dependence to reduce maintenance cost the concept of opportunistic maintenance was firstly introduced and applied in a case study of the rocket engine of a hypothetical ballistic missile mccall 1963 radner and jorgenson 1963 there are no norms standards or consensual accepted meanings of opportunistic maintenance thomas et al 2008 it is a systematic research to determine what time to perform maintenance activities for what reason and what components or turbines can be repaired by making use of the opportunities 1 1 previous research in 2009 besnard et al 2009 applied the opportunistic maintenance strategy to offshore wind energy opportunistic occasions appear when power production is unsatisfying because corrective maintenance has to be performed on a wind turbine or the wind speed is low the case study shows taking these opportunities can effectively reduce maintenance costs due to the considerable potential the number of literature focusing on opportunistic maintenance of wind energy sector is increasing in the following years we make a comparative analysis after reviewing the following representative papers as shown in the table 1 1 1 1 degradation and environmental impact ding and tian 2011 proposed an opportunistic maintenance model with two level repair actions for wind turbine systems the failures of the components are caused by the degradation the failure times are modelled as weibull distribution perfect and imperfect maintenance actions are performed depending on component states then ding and tian 2012 introduced different maintenance thresholds in their model to distinguish the failed turbines and working turbines instead of the two level maintenance threshold sarker and faiz 2016 proposed the concept of multi level maintenance in their work degradation results in the component failure the interval between maximum and minimum maintenance thresholds is divided into multiple groups after discussing the relationship between maintenance costs and the number of maintenance levels the optimal number of level is selected to minimize the total costs similarly the failures of the components are also assumed to be caused by degradation processes in the literature abdollahzadeh et al 2016 atashgar and abdollahzadeh 2016 erguido et al 2017 lu et al 2018 zhou and yin 2019 zhang et al 2017 introduced the hybrid hazard rate method into the opportunistic maintenance model the method describes the degradation processes causing the failures where the increase of operation time will accelerate the degradation and weaken the maintenance improvement li et al 2020c used nonhomogeneous continuous time markov process to represent the multi state model of offshore wind turbine subsystems the subsystems transfer from one state to another state as the operation time increases the most cost effective combination of qualified components is selected to reduce the maintenance costs when compared with individual maintenance it is remarkable that in these models the wind turbines only experience the degradation the system deteriorates over time due to wear erosion fatigue corrosion and so on this normal degradation process applies when the operation condition is ideal however the offshore structures suffer from the impact resulting from the harsh marine environment e g sea ice atmospheric icing typhoon sea wave lightning strike sudden change in wind speed or direction the harsher the environment is the random impact will arrive more frequently and the influence will be more serious when the turbine works in the practical environments it is not only subjected to degradation processes but also the random environmental impact throughout the whole service life the presence of these environmental impact on the critical components especially rotor blades has effect on the performance of o m and the overall economics of a wind energy project battisti et al 2006 pastromas et al 2018 only a few paper considered degradation and environmental impact simultaneously when developing opportunistic maintenance for wind energy shafiee finkelstein and bérenguer 2015 proposed an opportunistic condition based maintenance policy for a rotor blade system the multi blade system is subjected to stress corrosion cracking and environmental impact in order to avoid the expensive failure replacement a maintenance team is dispatched to repair critical blade before the failure occurs and other blades are preventively repaired as well the maintenance model considering random environmental shocks has been increasingly concerned in the field of reliability and engineering in the past years many industrial systems operate in the random shock environment and suffer from the damage of these shock which triggers the state transitions of the system the shock models investigated in the literature include cumulative shock model extreme shock model run shock model delta shock model and mixed shock model wang et al 2020 in addition for some complicated systems various dependence exists between the shock and degradation namely shock degradation dependence and degradation shock dependence che et al 2018 when considering the shock degradation dependence the assumptions are made that these impact may result in the abrupt increase of degradation ruiz castro 2016 the increasing degradation rate rafiee et al 2014 or even the sudden incidents when considering the degradation shock dependence many studies assume that the intensity or the magnitude of shock is dependent on the degradation process of the system fan et al 2017 fan et al 2000 che et al 2018 developed a facilitation model where the mutual degradation shock dependence and shock degradation dependence are simultaneously considered a case study of a jet pipe servo valve is presented to demonstrate the established model 1 1 2 maintenance opportunities as the description of the opportunistic maintenance models for wind energy in the table 1 ding and tian 2011 2012 sarker and faiz 2016 li et al 2020c assumed that the occurrence of a component degradation failure can be considered as a type of maintenance opportunity failure based opportunity it is a very common assumption when developing opportunistic maintenance strategy this failure based maintenance opportunity can trigger a maintenance cycle where the maintenance teams are correctively dispatched to simultaneously replace the failed components and perform preventive maintenance on the components needing repair as we know the failure should be avoided as much as possible given the fact that the cost of failure replacement is very expensive therefore it is not necessary to start a maintenance cycle only waiting for the occurrence of the turbine failure in the literature zhang et al 2017 lu et al 2018 zhou and yin 2019 a preventive maintenance threshold is set to determine if the turbine component is in a defective or almost unacceptable state in addition to the maintenance cycle triggered by failure a maintenance cycle can also be triggered if any turbine component in the farm exceeds this preventive maintenance threshold actually this preventive maintenance decision can be regarded as the preventive dispatch of maintenance teams in the literature abdollahzadeh et al 2016 atashgar and abdollahzadeh 2016 erguido et al 2017 the preventive dispatch of maintenance teams is clearly addressed meaning not until the failure occurs the maintenance opportunity can also emerge to dispatch the maintenance teams preventively when a component satisfies the maintenance requirement reach the threshold generally the maintenance opportunity will appear in these two occasions a failure occurs a component reaches the preventive maintenance threshold however although the preventive dispatch of maintenance teams has been introduced in the models this action may not be as cost effective as we expect the maintenance team has to move to the wind site if even the single component reaches the predetermined threshold it may be feasible when the farm is located onshore considering the effort and cost to dispatch the vessels and staff to the remote location away from the shore the execution of preventive dispatch triggered by single component is not economic enough for offshore wind farms these maintenance decisions may induce over frequent but unnecessary maintenance activities furthermore in these existing opportunistic maintenance models for wind energy the consequences of environmental impact have not been considered as discussed in section 1 1 1 for example the critical impact may also result in the incident that the suffering turbine stops operating and requires maintenance which can also provide the opportunity to repair the other turbines in the farm in the table 2 an extensive literature review is made for the opportunistic maintenance with impact of external factors shocks not limited to the area of wind energy cui and li 2006 developed an opportunistic maintenance for a multicomponent cumulative damage shock model when the cumulative damage exceeds the predetermined threshold the component will fail and create a maintenance opportunity for the system zhang 2019 developed a delay time model for an industrial system considering the external shocks the impact of shocks on system may result in the random hazard rate increments shock degradation dependence the developed model is demonstrated on a critical steel convertor plant in a steel mill a series system which consists of two components with multi stage accelerated damage is studied by zhao et al 2019 when the state of components gets worse the shocks with the same magnitude may have more severe influence on the component state a numerical example of a two rolling bearing system is presented to demonstrate the proposed model hu shen and shen 2020 studied the situation that the system consisting of two independent components is subjected to the degradation and external shock the shock rate will increase as the increase of the degradation level of the component degradation shock dependence the maintenance will be carried out when the degradation exceeds the preventive maintenance threshold or a fatal shock occurs a hydraulic system consisting of two valves in series is used as the example to illustrate the proposed maintenance strategy zhang and yang 2020 proposed a state based opportunistic maintenance for industrial assets exposed of environmental impact the impact of environmental stress on system deterioration is various based on the state of the system resulting in the increments on the hazard rates shock degradation dependence the unscheduled events due to several factors including production shortage and desired tasks can also be regarded as the window to perform maintenance besides replacement although these studies considered the influence of environmental impact when developing opportunistic maintenance model the limitations still exist the models considered opportunities existing in a simple system such as a series system consisting of two components not extending the model to multiple systems such as an offshore wind farm every turbine can be regarded as a multi component system the maintenance performed on a component should provide maintenance opportunities for all the turbines in the farm instead of only the located turbine moreover some of the models assume that once one component reaches a preventive maintenance threshold a maintenance cycle will be initiated this maintenance decision may not be reasonable enough when applied to a wind farm as the farm size enlarges and the number of the component increases the maintenance team has to move to the offshore location frequently because the occasion easily happens that one component reaches the threshold as discussed above the problem also exists in the opportunistic maintenance models for wind energy but has not been studied before 1 2 proposed strategy to address the above issues we consider the influence of environmental impact when developing the maintenance model and analyse the trade off between the frequency of preventive dispatch of maintenance teams and maintenance costs the purpose of this paper is to propose an opportunistic maintenance strategy that reduces maintenance costs over an offshore wind farm s service life the attempt is integrating multiple types of maintenance opportunities into the maintenance strategy based on the shock degradation dependence the impact can be generally categorized into three types depending on the severity that is critical impact influential impact and minor impact critical impact is so fatal to induce the occurrence of incidents then the undergoing component fails and the failure replacement is required the influential impact leads to a sudden increase of the degradation the minor impact may cause a negative influence on operation such as the reduction of power generation but the system will recover soon without any failure when the dispatch of maintenance teams is caused by degradation failures or incidents these maintenance opportunities are called the failure based opportunity and incident based opportunity respectively furthermore the maintenance team is dispatched preventively when a portion of components reach the age thresholds which can be called the age base opportunity the simulation technique is used to evaluate the annual maintenance costs during the whole service life a numerical example is provided to illustrate the proposed maintenance model a comparative study with the conventional opportunistic maintenance strategy is used to demonstrate the advantage of the proposed strategy in reducing maintenance cost 1 3 outline the remainder of the paper is listed as follows in section 2 the proposed opportunistic maintenance strategy is formalized the failure of components and turbines as well as the maintenance process are described and analytically derived in section 3 a numerical example is used to illustrate the proposed strategy the optimization results and comparative study are presented finally conclusions and future works are presented in section 4 2 model description in this section a mathematical model is developed to formalize the proposed opportunistic maintenance strategy in the model three types of maintenance opportunities can trigger maintenance cycles where the maintenance team is dispatched to the site to repair or replace the components satisfying the maintenance requirements after finishing the maintenance actions on qualified components the maintenance cycle will end until the maintenance opportunity appears next time the total costs represent the sum of money generated from repair activities during the maintenance cycles 2 1 assumptions in the offshore wind farm we assume that all the turbines are of the same type after a wind farm maintenance decision is made sufficient preparation is done to ensure the execution of maintenance activities is as successful as we expect therefore the following assumptions are made on the offshore wind farm 1 a specific component is of similar nature for all the turbines in the farm the same maintenance activity performed on the specific component spends the same money no matter the component is contained at which turbine 2 the time spent on performing maintenance activities is negligible when compared to the long service time of farms 3 the maintenance resource and capacity including staff tools spare parts transportation means etc are always available to complete all the maintenance tasks in the farm 4 the accessibility to the location of the farm will not be affected by any negative factor such as weather conditions for an individual offshore wind turbine it can be regarded as a series system because the failure of subsystem may result in the entire system break down for the mechanical or electromechanical components in the turbine weibull distribution is appropriate to model the failure times poisson process is a completely random process and each point is stochastically independent of all the other points in the process impact from marine environment arrives randomly with the average rates varying with time so non homogeneous poisson process is suitable to describe this process hence the following assumptions are made on every individual turbine 1 offshore wind turbine system is simplified to a series system of critical components 2 the degradation failure times of components are modelled as a two parameter weibull distribution with scale parameter and shape parameter the arrival times of the environmental impact are modelled as a non homogeneous poisson process 2 2 failure of component suppose that there are k offshore wind turbines consisting of i critical components connected in series the particular type of components in different turbines would undergo the same degradation process if they operate under the same ideal condition this process can be defined as the normal degradation process the environmental impact arriving at the turbines may have an influence on the component degradation or failure considering degradation and environmental impact at the same time can describe the degradation mechanism of components more accurately zhou et al 2016 it is assumed that the arrivals of environmental impact and the deterioration of the system are independent caballé and castro 2017 2 2 1 degradation in the whole lifetime the component gradually degrades as the age increases until failure assuming that the failure time of component i at turbine k is modelled as a weibull distribution with scale parameter σ i k and shape parameter ε i k the component has the probability density function f i k t as 1 f i k t ε i k σ i k t σ i k ε i k 1 e t σ i k ε i k the reliability function can be expressed as 2 r i k t e t σ i k ε i k the degradation degree increases as the time passes the mean time to failure m t t f i k denotes the expected time to failure for the component and can be represented as 3 m t t f i k 0 t f i k t σ i k γ 1 ε i k 1 with γ denoting the gamma function the lifetimes of components are randomly generated by employing the weibull distribution let α i k σ i k ε i k inverse weibull model is used to generate weibull distributed random numbers we could begin with the random number γ which is in the range from 0 to 1 then we can use the following equation to obtain new independent random numbers which have the weibull distribution with the mean and variance depending on shape and scale parameters de gusmao ortega and cordeiro 2011 these random numbers will be assigned to corresponding components to represent their lifetimes tian et al 2011 4 t i k 1 α i k ln 1 γ 1 ε i k the degradation process of components may also be affected by some factors such as environmental impact for example at time point t 1 and t 2 two times of impact arrive resulting in the component degradation increases abruptly with the magnitude of b 1 and b 2 respectively fig 3 2 2 2 environmental impact we assume that the impact arrives somewhat randomly modelled as a non homogeneous poisson process a non homogeneous poisson process n k t t 0 is a counting process where n k t is the number of load arrivals during time 0 t and the intensity function λ k t varying with time is a non negative integrable function satisfying the poisson postulates leonenko et al 2017 the poisson random variable having mean is given by 5 λ k t λ k 0 t 0 t λ k z d z in order to simulate the occurrence times of impact we can use the thinning algorithm to simulate the points in the non homogeneous poisson process kim and singh 2009 xu and dowd 2010 the procedure starts with the determination of the maximum intensity value λ and with the generation of a realization of a homogeneous poisson process with intensity value equal to this maximum intensity value after that the generated points of the homogeneous poisson process at location t are retained and discarded based on the probability λ k t λ lewis and shedler 1979 2 3 failure of offshore wind turbine considering the offshore wind turbine is a series system the system fails once a component failure occurs in other words the component failures caused by degradation and environmental impact will force the turbine where the component is located to stop working immediately not every environmental impact must induce the failure of turbines the impact can be generally categorized into three types depending on the severity that is critical impact influential impact and minor impact the critical impact means the impact is so disastrous that the turbine will break down until the failed component is completely replaced the influential impact will cause an abrupt increase of the degradation the minor impact will not make the turbine break down it may affect the operation or production of wind turbines temporarily so it is not necessary to perform maintenance correspondingly the occurrence probability of critical impact p k 1 0 p k 1 1 is the least because this incident rarely happens the probability of minor impact p k 3 0 p k 3 1 is the most and the probability of influential impact p k 2 0 p k 2 1 is intermediate the sum of p k 1 p k 2 and p k 3 is equal to 1 2 4 opportunistic maintenance model after studying the failure mechanism of turbines in the offshore wind farm the opportunistic maintenance model will be developed to determine what time to activate maintenance activities and how the components will be repaired the money spent on these maintenance related activities will generate the corresponding maintenance costs 2 4 1 maintenance opportunities there are three types of maintenance opportunity in the model namely failure based opportunity age based opportunity and incident based opportunity the maintenance opportunities emerge when the corresponding situations happen every type of maintenance opportunity can initiate a maintenance cycle in the offshore wind farm in fig 4 the detailed flow chart of the proposed opportunistic maintenance strategy is introduced only in the case that no opportunities happen the system is determined to be without maintenance 1 failure based opportunity when the component i at turbine k breaks down because of the degradation the maintenance opportunity will be triggered 2 age based opportunity no component fails but a certain number of components reach the specific age threshold the maintenance opportunity will arrive 3 incident based opportunity if the arriving environmental impact is critical so that the component fails the maintenance opportunity will appear when the offshore wind farm begins to operate all of the components are brand new their ages u i k are certainly 0 the inverse weibull model is adopted to generate the random lifetime l i k of each component the failure age v i k of the component equals its lifetime once the age reaches the failure age this components will break down due to degradation after every period of time t 1 period t 2 period t z period the information of system is updated to determine if maintenance actions are needed during time t z 1 period to t z period the environmental impact is firstly checked for each component subject to the environmental impact the arrival time of impact is w k if t z 1 period w k t z period the turbine k has to endure the environmental impact x k ei 1 considering the impact is critical influential or minor the binomial distribution can present whether the impact can induce the incident if the impact is minor the turbines will maintain in the previous state if the impact is influential an abrupt increase of component age will be caused with the value b c we separate the interval between maximum age percentage threshold a max and minimum age percentage threshold a min into groups of equal lengths a min a y a max if the component is younger than a min there will an age increase with b 1 the age will be updated to u i k 1 b 1 the age of components in the group between a min and a 1 will increase with b 2 and so on the younger component is the age increase will be less because it is in a better state to withstand the impact if the impact is so catastrophic to destroy the turbine x k c 1 the incident based opportunity is generated x i 1 if no incident happens then the failure times f i k are compared with the real time if t z period f i k that means the component won t fail during this period and no failure replacement is needed the binary variable x i k cr is equal to 0 only for all the components the x i k cr 0 the value of x f is 0 otherwise the t z 1 period f i k t z period the degradation failure occurs on one component in this case x i k cr 1 the failure based opportunity appears x f 1 and one maintenance cycle will launch if it is lucky that no failure occurs during this time period the third maintenance opportunity age based opportunity should be estimated for component i at turbine k if its age u i k is more than a specific percentage of failure age v i k the component is regarded as an aged component in other words the component is judged as aged because it exceeds the maximum age threshold a max we assume ζ is the percentage threshold of number of aged components if the total number of aged components in the wind farm is greater than or equal to u u ζ i the age based opportunity is triggered x a 1 if x a x i x f 0 no maintenance is needed during the period the time moves to next period and values of time and age are updated 2 4 2 maintenance actions three maintenance actions are included in one maintenance cycle failure replacement is conducted on the failed component due to degradation or critical impact the failure replacement means the component is completely replaced to a component of similar nature implying the component is brand new with the age reset to zero if the component is to fail because of the degradation it is qualified for a preventive replacement the preventive replacement can also restore the age of component to zero because it is preventively carried out before the failure to avoid potentially serious damages so the cost is less when compared with failure replacement the major repair will be carried out on the components satisfying the requirements between maximum and minimum age threshold the major repair can effectively improve the component health the maintenance actions for components of different stages are illustrated as fig 5 the nth maintenance cycle begins after the maintenance opportunity emerges the starting time of this cycle is t n the component states in the site can be classified into four cases failed aged mature and young 1 failed component as introduced above the failed components no matter due to degradation or critical impact should be completely replaced their corresponding binary variables x i k cr 1 accordingly their ages are reset to 0 as follows 6 u i k new 0 by sampling from weibull distribution the lifetimes of these new components are obtained l i k then their new failure ages equals to the lifetime v i k new is known the next failure times can be obtained as 7 f i k v i k new t n 2 aged component in the maintenance cycle the ages of running components are compared with the predetermined age thresholds we assume two percentages of failure ages as basic thresholds a max and a min if u i k old v i k old a max it is determined as the aged component to be replaced and x i k pr is equal to 1 similar to failed component the age will be restored to 0 after preventive replacement as follows 8 u i k new 0 the new lifetimes l i k and failure ages of these components v i k new are obtained the occurrence time of next failure can be obtained as 9 f i k new v i k new t n 3 mature component for the running components with ages between maximum and minimum thresholds namely v i k old a min u i k old v i k old a max these components are judged as mature components which major repair should be conducted on x i k mr 1 the components in the group between a min and a 1 will undergo the l 1 level maintenance action the l 2 level maintenance action is performed on the components between a 1 and a 2 and so on for the mth maintenance level l m there is a maintenance quality θ l m the maintenance quality means the age of components can be improved to a fixed percentage moghaddam and usher 2010 therefore the ages of component will be updated after major repair as follows 10 u i k new θ l m u i k old the failure age is updated as follows sarker and faiz 2016 11 v i k new v i k old θ l m 1 θ l m l i k the occurrence time of next failure is as follows 12 f i k new v i k new u i k new t n 4 young component for the components younger than the minimum threshold u i k old v i k old a min there is no need to maintain them they are left there to continue operation and no money is spent on them during the maintenance cycle they still retains the previous state so the degradation process and failure age don t change as follows 13 v i k new v i k old after the maintenance cycle their ages are updated as follows 14 u i k new u i k old the occurrence time of next failure is as follows 15 f i k new v i k new u i k new t n 2 4 3 maintenance costs the objective is to reduce the total maintenance costs of offshore wind farm after developing the maintenance model the cost generated in the procedure is calculated to estimate economic the first step is to calculate the money spent on four types of components failed aged mature young in each maintenance cycle for the failed component it should be completely replaced so the total cost of failure replacement of the wind farm m total cr is as follows 16 m total cr k 1 k i 1 i m i k cr x i k cr where m i k cr represents the cost of failure replacement of component i at turbine k and x i k cr is the binary variable to determine whether this component needs to be replaced for the aged components reaching the maximum age threshold they are replaced as well the money spent on activities of preventive replacement m total pr is calculated as 17 m total pr k 1 k i 1 i m i k pr x i k pr where m i k pr represents the cost of preventive replacement of component i at turbine k and x i k cr is the binary variable to check if preventive replacement is required the mature components with ages between the maximum and minimum age thresholds are qualified for major repair in the present work it is commonly assumed that the cost m i k m mr of intermediate maintenance level performed on component is function of the expected value θ l m of the improvement coefficient of l m in addition to the age and the operating state of the component pandey et al 2013 according to literature khatab and aghezzaf 2016 duan et al 2018 the cost of major repair can be obtained as 18 m i k m mr r i k m m i k pr 1 θ l m d i k m η i k m where r i k m and d i k m are the characteristic constants that determine how the improvement coefficient affects the corresponding intermediate maintenance cost variable η i k m represents the stability level of the maintenance quality the d i k m η i k m is smaller then the major repair will be more expensive therefore the total costs of major repair is 19 m total mr m 1 m k 1 k i 1 i m i k m mr x i k mr m 1 m k 1 k i 1 i r i k m m i k pr 1 θ l m d i k m η i k m x i k mr where x i k mr is the binary variable to indicate if major repair is necessary for the young components they aren t maintained in the maintenance cycle consequently no cost is consumed for these components moreover some extra cost exists along with the cost for maintenance tasks when conducting maintenance fixed cost m f is the money used to make some preparation and trigger maintenance activities dalgic et al 2015 martin et al 2016 m k tr is the transportation cost to turbine k in one maintenance cycle thus more turbines are visited and repaired the transportation cost is higher therefore the total transportation cost is 20 m total tr k 1 k m k tr x k tr where x k pr is the binary variable to indicate if the turbine is visited finally the total cost of one maintenance cycle is calculated as follows 21 m total m f m total tr m total pr m total cr m total mr m f k 1 k m k tr x k tr k 1 k i 1 i m i k pr x i k pr k 1 k i 1 i m i k cr x i k cr m 1 m k 1 k i 1 i r i k m m i k pr 1 θ l m d i k m η i k m x i k mr it is assumed that the offshore wind farm operates for s years lifetime which n cycles of maintenance are carried out during we can calculate the total costs during s years and further obtain the annual cost c annual as follows 22 min c annual a min a max ζ n 1 n m total s 1 s n 1 n m f k 1 k m k tr x k tr k 1 k i 1 i m i k pr x i k pr k 1 k i 1 i m i k cr x i k cr m 1 m k 1 k i 1 i r i k m m i k pr 1 θ l m d i k m η i k m x i k mr s t 0 a min a max 1 where a min minimum age percentage threshold a max maximum age percentage threshold and ζ percentage threshold of number of aged components are the decision variables of the proposed model actually the values of a min and a max can be regarded as the criterion to determine whether a component is qualified for the repair if it is older than a min but less than a max a major repair is needed if it is more aged than a max it should be preventively replaced by varying the thresholds the number of components which should be repaired will change accordingly the variable ζ can determine how many aged components can trigger the age based opportunity the objective is to determine the optimal combination of variables which can minimize the annual maintenance cost during the whole lifetime 3 numerical example in order to illustrate the effectiveness of the proposed opportunistic maintenance method a numerical example of the offshore wind farm is used in this section the optimization results of three strategies are represented a comparative study with the conventional opportunistic maintenance strategies under the same parameters demonstrates the advantage of the proposed strategy in reducing the maintenance cost 3 1 scenario set up we assume that there is an offshore wind farm containing 50 offshore wind turbines following a design life of 20 years it is noted that the numerical example is generic instead of a real and specific wind farm operating considering the turbine is a type of complicated electromechanical system containing hundreds of components it is difficult to take every subsystem into account previously published results in peer review journals shafiee and dinmohammadi 2014 arabian hoseynabadi et al 2010 kang et al 2019 zhang et al 2016 kang sun sun andwu 2017 zhou et al 2015 scheu et al 2019 li teixeira and soares 2020a have revealed the criticality ranking of wind turbine components by using the methods such as failure modes and effects analysis fmea failure mode effects and criticality analysis fmeca two stage failure mode and effect analysis etc in our model every turbine is simplified to a multi component series system with five critical subsystem gearbox generator rotor blade pitch system and main bearing due to the extremely low failure rates tower and support structure are not considered in our model the blade is the component more subject to the environmental impact and the influence of critical impact on other components are ignored because of the protection of cabin carroll mcdonald and mcmillan 2016 collected the maintenance information of operational data of 1768 turbines years the data is based on 350 offshore wind turbines which are from between 5 and 10 wind farms throughout europe the ages of turbines are between from 3 to 10 years the capacity is between 2 and 4 mw and the rotor diameter is between 80m and 120m santos teixeira and soares 2015 le and andrews 2016 also collected and estimated the failure distribution and maintenance cost from several studies in the literature focusing on the o m for european wind energy the basis of the input information of the model is mainly estimated from these papers table 3 which represents the properties and parameters of the example of the offshore wind farm the decision moments are assumed to be periodic 20 days the fixed cost m f and transportation cost m k tr are 50k and 10k respectively the intensity function of external factor is assumed to be 2 27 t 27 shafiee et al 2013 2015 the value of p k 1 p k 2 p k 3 is assumed to be 0 001 0 005 and 0 994 three age thresholds maximum threshold a max intermediate threshold a y and minimum threshold a min are considered in the model the maintenance improvement of two levels l 1 and l 2 are 0 5 and 0 7 respectively indicating the maintenance quality will be more significant for older components accordingly the maintenance task of higher quality is more costly the values of b 1 b 2 b 3 and b 4 are 0 025 0 05 0 075 and 0 1 respectively the values of r i k m and η i k m are both 1 and d i k m is 2 3 2 optimization results the possible maintenance optimization techniques include operations research models analytical approaches markov models simulation models petri net models bayesian networks and so on shafiee and sørensen 2019 in recent years increasing attention has been directed towards improving and optimizing maintenance for industrial systems using the simulation method one main reason is that many practical cases are too complicated to be given tractable mathematical formulations the simulation method has the potential to tackle these challenging optimization problems involving nonlinearities combinatorial relationships and uncertainties april et al 2003 in addition it allows experimenting and better understanding of systems with increasing complexity alrabghi and tiwari 2015 this method has been used in many studies about maintenance strategy optimization do et al 2015 in this paper the simulation frame work is established for the maintenance model of the offshore wind farm as shown in fig 6 the simulation algorithm is presented in algorithm 1 the monte carlo simulation method is implemented to evaluate the outcome of the proposed maintenance strategy there have been three strategies nabo strategy sabo strategy and mabo strategy as follows 1 nabo strategy in the first strategy only failure and incident can trigger the maintenance opportunities and the age based opportunity is not considered similar as the model in some papers such as sarker and faiz 2016 this kind of strategy is called as nabo strategy none age based opportunity 2 sabo strategy failure and incident can trigger the maintenance cycle besides if any component age reaches a max the age based opportunity will arise like the model in some papers such as lu et al 2018 the model is called sabo strategy single age based opportunity 3 mabo strategy we call the developed model in the present paper is mabo strategy multiple age based opportunity failure based incident based and age based opportunities exist in the strategy if a predetermined number of components are aged the maintenance decision can also be made to maintain the wind farm image 1 as introduced above the decision variables of the model mabo strategy are a min a max ζ the annual maintenance cost is the function of these decision variables genetic algorithm ga is a metaheuristic proposed according to the evolution of organisms in nature which has been widely used to tackle the maintenance optimization issue compare et al 2015 ga has its advantages when compared with other optimization methods such as avoid being trapped in local optimal solution by searching parallel from a population of points use probabilistic selection rules instead of deterministic ones etc in this paper we adopt ga to find the optimal combination of variables the algorithm was configured with a population size of 40 individuals and a maximum number of generations g of 50 the fitness value of each individual is evalauted by monte carlo simulation with 500 times with this setting the simulation in fig 6 should be run 1 10 6 times which is implemented in matlab software the ga optimization process results are represented in fig 7 the optimal combination of three decision variables is about 0 65 0 94 1 2 with the lowest value 1956k in order to illustrate how the varying variables affect the annual cost we further test various combinations in fig 8 and show the effects of age percentage threshold under mabo strategy when ζ equals 1 2 in fig 9 in fig 8 there exists an optimal combination of the decision variables which can minimize the annual maintenance cost the variable ζ determines the exact number of the multiple in the mabo strategy we select and present four faces ζ 0 8 1 2 2 0 2 8 in the figure where the lowest point is on the yellow face ζ 1 2 the lowest point means the optimal combination of the variables 0 65 0 94 1 2 in fig 9 when changing a min or a max the trend is similar the annual cost gradually drops as the increase of age threshold until the bottom then increases to a high value for the former it can be explained that resulting from the lower threshold more components are determined to be repaired in one maintenance cycle contributing to more money then as the increase of threshold the number of qualified components decreases but the state of wind farm becomes worse due to less frequent repair for the latter the lower threshold indicates more components need to preventively replaced more components are likely to fail due to insufficient preventive maintenance if the threshold is set at a higher percentage of the failure age in fig 10 the comparison among three strategies under different thresholds is illustrated the mabo strategy is the most cost effective strategy after optimization as shown in fig 10 and table 4 in the figure the blue face mabo strategy is the lowest in almost half of the area however we can find that it is not always the most cost effective when varying the maintenance thresholds when a max is very high mabo and sabo both perform better than nabo because the expensive failure replacement can be avoided due to the benefit of age based opportunity when a max begins to decrease it will become gradually easier to trigger the age based opportunity causing the increasing maintenance frequency and cost especially for sabo yellow face in these occasions the nabo strategy has a better performance to reduce costs compared with mabo and sabo the variance of annual cost is relatively stable when changing threshold for nabo strategy as shown in green face because the change of thresholds does not affect the trigger of age based opportunity 3 3 comparative analysis in order to study the differences among three strategies and discuss the reasons all the parameters should be assumed the same and the strategies are applied on the following base scenario a max 0 95 a min 0 5 ζ 1 2 in fig 11 the monte carlo simulation of three strategies is presented where the number of iterations is presented by w the simulation is run independently in each iteration the convergence analysis for the monte carlo simulation is conducted after running the monte carlo simulation for 500 iterations it can be seen that no significant variations of the intermediate mean value are obtained it indicates that the 500 iterations provide a sufficiently accurate statistical analysis of the results the final results at the 500 simulation times are used to estimate the economic of different strategies as shown in table 5 and fig 12 these results suggest that mabo strategy shows the economic advantage compared with other two strategies by introducing the age based opportunity the cost of failure replacement decreases accompanied by a increase in the cost of major repair fixed cost and transportation cost in sabo strategy the triggering condition is set as single component the corresponding result is the offshore wind farm can be maintained to a good state with the lowest costs of replacing failed components however more maintenance cycles and activities make the costs of major repair fixed and transportation cost grow inducing the strategy doesn t perform satisfactorily in the aspect of economic the age based opportunity reduces the occurrence of failure events at the expense of triggering preventive repair more frequently the mabo strategy found a balance to reduce the replacement costs with a slight increase of the major repair fixed and transportation costs overall the proposed mabo opportunistic maintenance strategy can lower the total maintenance costs compared with the other two strategies we further show the effects of following parameters on the mabo strategy percentage threshold of number of aged components ζ the occurrence probability of critical influential and minor impact p k 1 p k 2 p k 3 the size of the offshore wind farm k the value of these parameters will change gradually and all other parameters remain fixed in fig 13 as the increase of percentage threshold ζ the annual cost drops at first until the bottom then gradually grows with slight fluctuation the size of the wind farm is 50 turbines with 250 critical components the range of percentage thresholds from 0 4 to 3 2 indicates the number threshold of aged components is from 1 to 8 when the number is 1 that means once one component is determined to be aged the age based opportunity will make the maintenance cycle start the number is 2 means two or more than two aged components can trigger the maintenance and so on for each set of percentage threshold at the threshold of 0 4 the failure occurrence can be avoided as much as possible but the frequency of maintenance is also the highest resulting from the easily triggered conditions the frequent maintenance results in the highest total cost then as the increase of threshold the negative influence of maintenance frequency weakens but component failure is more likely to occur resulting in the costly repair a balance considering these two factors is find out until the lowest point at 1 2 afterwards the effect of failure occurrence becomes significant causing the rise of annual cost setting of the parameters of the environmental impact presents the harshness of the marine environment in fig 14 it clearly shows that the annual cost rises as the increase of the probability of critical impact and influential impact the value of p k 1 has the most significant influence the higher probability results in more components have to be completely replaced so the cost of failure replacement will increase obviously the influential impact can only accelerate the degradation so its effect is less significant as shown in table 6 we have applied the opportunistic maintenance strategy to the offshore wind farms with different number of turbines when comparing mabo strategy with nabo strategy for the small scale farm the results reveal that the cost saving is the most significant as high as 11 9 however as the expansion of farm the reduction of maintenance costs become less considerable it is largely explained by the more occurrence of failure based opportunities and incident based opportunities with the increase of farm size the number of failure and incidents is less for a small scale farm in this case the age based opportunity is more promising to trigger the preventive maintenance and avoid failure replacement then save more money when the farm gets larger with even 100 turbines the failure because of degradation or environmental impact have provided a number of opportunities to start the maintenance cycles the age based opportunity could make the strategy perform better on this condition but not as substantial as small scale farm when the size is small the cost savings of sabo strategy and mabo strategy is the same because the single component is the best option to trigger preventive dispatch however the execution of sabo strategy becomes more costly as the increase of the farm size even exceeding the nabo strategy more turbines mean the number of aged component is more so the over frequent maintenance activities may result in much unnecessary costs in summary the mabo and sabo strategy can reduce maintenance costs for a small scale offshore wind farm when compared with nabo strategy as the increase of turbine number the mabo strategy is still the best option followed by nabo strategy and sabo strategy in fig 15 we change the number threshold of aged components u under the mabo strategy when the size of wind farm is different the annual cost of nabo strategy is seen as the comparison criterion and the cost saving is presented by q when the threshold is only 1 the maintenance cost is minimized for the 10 turbine and 20 turbine farm the preventive dispatch can significantly avoid the severe failure occurrence and high replacement costs furthermore the case is also difficult to happen that more than 1 components reach the maximum age threshold at the same time for a small scale farm the more thresholds can only make the age based opportunity happen more impossibly and the improvement weaken successively when the number of turbines increase to 50 80 and 100 the optimal number thresholds are obtained as 3 5 and 7 respectively showing that the optimal number of aged components increases as the wind farm enlarge 4 conclusion future research the opportunistic maintenance strategy has been studied for the wind energy sector in recent years a common assumption is made that the failure is mainly caused by degradation ignoring the influence of environmental impact furthermore the preventive dispatch of the maintenance team triggered by the occasion that a single component reaches the predetermined threshold probably induces much excessive cost in this paper an opportunistic maintenance strategy is developed for offshore wind farms the offshore wind turbines operating in the harsh marine environment do not only suffer from degradation but also impact from environment the impact may result in the abrupt increase of degradation or the sudden incidents the failures due to ultimate degradation and critical impact will create maintenance opportunities namely failure based opportunity and incident based opportunity another maintenance opportunity considering the number of aged components age based opportunity is also considered to balance costly failure replacement and over frequent maintenance cycles the simulation method is used to represent the maintenance scenarios and evaluate the average annual maintenance costs in the nabo strategy only failure and incident can create the maintenance opportunities the sabo strategy assumes that if any component becomes aged and requires preventive replacement another maintenance opportunity age based opportunity will also arise the developed strategy in the paper mabo strategy considers the number of aged components the age based opportunity will be created when the number of aged components reaches a predetermined value the comparative analysis under the based scenario shows the mabo and sabo strategies can both reduce about 11 9 cost than nabo strategy for a 10 turbine farm when the scale of the farm enlarges the mabo strategy still has the best performance an economic benefit of 2 6 and 1 5 respectively can be achieved for a 50 turbine farm when compared with sabo and nabo strategy when the number of turbine increases to 100 mabo strategy saves 3 9 and 0 5 costs respectively in comparison to sabo strategy and nabo strategy it is noted that the numerical example is generic instead of a real offshore wind farm in future work if more detailed data can be collected from a real wind farm the calculation results will be more realistic and contributive there are several potential extensions of this study the o m of offshore wind farm is a complicated task involving failure repair spare parts management transportation weather prediction and so on in this paper the assumption is made that the maintenance resource are always sufficient to perform maintenance activities and the accessibility to the location of the turbines will not be affected by any negative factor however the resource limitation and uncertain accessibility are significant problems during o m for wind energy sector the introduction of these factors into opportunistic maintenance model is worth further studying moreover the developed model is based on the assumption that the parameters of the model are certain for instance the failure time of components is modelled as a weibull distribution with parameters we have known even before the operation however these parameters should be uncertain due to the lack of knowledge of the actual use and maintenance of the equipment and inaccurate historic data and records these uncertain parameters will affect the performance of the maintenance strategy it is necessary to further consider uncertainty when improving the o m for offshore wind energy credit authorship contribution statement mingxin li conceptualization methodology software formal analysis investigation writing original draft xiaoli jiang supervision writing review editing rudy r negenborn supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is financially supported by the scholar ship from china scholarship council under grant no 201906680095 
20739,the bosphorus is one of the busiest shipping lanes globally as it is the only maritime route for black sea countries every year about 50 000 ships sail through this lane hence it is necessary to develop emergency response planning strategies due to its high vessel passage rate distinguished geometry and delicate hydrodynamics that exhibit two layer stratified flow and exchange water mass between the adjacent seas in this study a 3d hydrodynamic model of the bosphorus is established to simulate oil spill scenarios for improving preparedness for an oil spill event a stochastic approach is followed to identify oil contamination probability maps for four different ensembles considering two different oil types and two meteo oceanographic conditions the results highlight the importance of using different meteo oceanographic conditions as probability maps regarding different meteo oceanographic conditions show large variability the suggested response strategies can be used to manage oil spill emergencies in the bosporus more efficiently keywords bosphorus hydrodynamic modeling oil spill modeling contamination probability stochastic 1 introduction oil spill events are among the most important sources of pollution in the marine environment particularly in coastal zones they can result from natural and anthropogenic sources major spills from human activities are caused by tanker accidents rig explosions and storage leakages ihaksi et al 2011 singkran 2013 according to the international tanker owners pollution federation the total number of incidents related to tankers are about 10 000 from the 1970s to the present itopf 2019 oil pollution leads to an environmental disturbance and can result in various short and long term consequences on marine ecosystems health and economics of coastal communities gundlach et al 1978 kingston 2002 alló and loureiro 2013 therefore it is necessary to develop oil spill response strategies to mitigate spill events and reduce adverse impacts modeling tools can be used to develop emergency response planning and operational forecasting systems the models provide information for determining potential regions affected by oil spills and thus contribute to improving emergency response planning and protection of the environment numerical models predict the movement of oil slick which is governed by external forces such as currents waves and winds considering the physical and chemical processes of oil weathering processes olita et al 2012 lee and jung 2015 toz and koseoglu 2018 numerical models come up with uncertainty since environmental variables and oil characteristics contain too much uncertainty fingas 2011 the main uncertainties in oil spills are the location of oil spill meteo oceanographic condition during the spill and oil spill properties neves et al 2016 probabilistic or stochastic approaches are commonly used in recent studies to consider uncertainty goldman et al 2015 neves et al 2016 lee and jung 2015 landquist et al 2016 guo et al 2016 guo 2017 these approaches use an ensemble of many hypothetical spills in this way the oiling probability of an environmental resource can be calculated amir heidari et al 2019 recent studies have been carried out in the literature to improve the risk assessment s effectiveness by adopting a stochastic approach recommended by international petroleum industry environmental conservation association ipieca 2017 niu et al 2017 studied contamination probability in the salish sea following a stochastic approach under various meteo oceanographic conditions they used high resolution atmospheric and oceanographic data and three different oil types to study contamination probability moreover they investigated the effect of the chemical dispersant on dilbit oil in a study by al shami et al 2017 a stochastic approach was used for risk assessment of oil spills along the mediterranean coastlines the oil pollution metrics such as oiling susceptibility beaching time concentration and frequency were used for hazard assessment their results highlighted the need for considering different metrics in risk quantification nelson and grubesic 2017 applied a repeated sampling method to deal with the stochastic nature of the oceanic environment they indicated that using a single simulation could be misleading in identifying potential areas that could be polluted with a large amount of oil and found that their developed approach provided more robust results amir heidari et al 2019 developed a new model for spatial and stochastic risk assessment of oil spills from shipwrecks they combined three important factors characteristic of the spill source dynamics in the meteo oceanographic field and spatial distribution of environmental sources amir heidari and raie 2019 presented a new stochastic model based on an advanced trajectory model linked with spatiotemporal meteo oceanographic data they used the proposed model to analyze spills in the persian gulf stochastically they found that release start time is the most important factor for the study area and indicated the number of start times and algorithm for selecting random start times as the most significant steps in risk assessment chiri et al 2020 proposed a new methodology for stochastic modeling of deep oil spills they used k means clustering techniques to choose important spatio temporal meteo oceanographic variables from reanalysis datasets by selecting the most relevant meteo oceanographic conditions they optimized computational efforts the bosphorus has been increasingly threatened by oil spill pollution similar to other parts of the world being the only maritime route to open seas for black sea countries bosphorus is one of the busiest shipping lanes it has a transit vessel passage of about 50 000 per year where nearly ten thousand carry dangerous and hazardous cargo the heavy maritime traffic resulted in a yearly average of 23 marine accidents republic of turkey prime minister s office maritime under secretariat 2017 considering the rate of tanker traffic and accidents oil spills are inevitable in the past five major oil spill accidents occurred in istanbul in 1979 the romanian tanker independenta collided with greek tanker evriali near the south end of the bosphorus and 93 800 tons of crude oil spilled and burned for a month it is the largest oil spill accident in turkey and one of the world s largest accidents 13th that ended in the death of 42 crew members similar incidents occurred in 1994 by the collision of the tanker nassia spilling 20 000 tons of crude oil in 1999 by the grounding of tanker volganeft 4000 tons of fuel oils spilled in 2003 by the grounding of svyatoy panteleymon 220 tons of diesel and 260 tons of fuel oils spilled into the sea after these incidents oil pollution led to considerable damages to the aquatic ecosystem and socio economic values of the bosphorus increasing air pollution from burning of oil high mortality rates of the marine habitat disappearance of some species showed detrimental consequences of oil spills in the bosphorus öztürk et al 2001 birpınar et al 2009 oral and öztürk 2006 despite the importance of the threats from oil spills in the bosphorus there is a lack of studies in oil spill modeling bozkurtoğlu 2017 made the only considerable study where the potential areas polluted by oil were determined in that research the particle tracking oil spill model ptosm was developed to simulate the oil slick s movement by considering spreading evaporation and advection processes the risky areas were determined from a deterministic approach although that study could be regarded as an important study for calling attention to oil spill modeling and shading a light in determining critical locations for intervention stations in the bosphorus it does not sufficiently represent dynamics in the bosphorus the lack of calibration in bozkurtoğlu 2017 can cause misleading particle trajectories moreover a statistical assessment which is useful in developing risk assessment and preparedness strategies was not applied in this study new hydrodynamic modeling is performed to better represent the hydrodynamics of the bosphorus which has a nonlinear turbulent and stratified flow structure and makes modeling even more difficult sözer and özsoy 2017 therefore a 3d numerical model with high spatial and temporal resolution under realistic atmospheric forcing is implemented and calibrated intensively to describe the complex hydrodynamics secondly we followed a stochastic modeling approach to estimate oil contamination probability in the bosphorus to handle main uncertainty sources we set up oil spill simulations at five possible launch points for two different types of oil as light and heavy moreover to take into account the dynamics in the bosphorus we performed oil spill simulations over two different representative time periods selected according to the meteo oceanographic conditions finally we produced oil contamination probability maps to improve preparedness against oil spill events 2 study area and its hydrodynamics the bosphorus is located between 41 2 n and 41 0 n in the south north direction it is between 29 2 e and 29 0 e in the east west direction fig 1 it has played a significant role in the social environmental strategic and economic issues of the istanbul metropolitan city from past to present the population of istanbul exceeded 15 million according to official records in 2018 and most of this population live in the coastal part of istanbul the bosphorus has unique geometric features and topographic details affecting hydrodynamics and navigation it is a narrow waterway with a total length of 30 km at the north and south ends its width is about 3 5 km and 2 5 km respectively the north half of the bosphorus is wider than the south half and represents more variations in width it is only 0 7 km in the narrowest section called contraction region and 3 6 km in the widest section it ends with an abrupt opening near the marmara sea end the strait has at least 12 sharp bends with a severely limited vision which makes maneuvering of ships risky the most critical bends are located at yeniköy and near beykoz harbor with an angle of 80 and 70 respectively most of the accidents occur in these locations when vessels take sharp turns with prevalent currents akten 2004 where the dense population resides near both sides of the strait as for bathymetry it has abrupt variations with two sills near the north and south ends and the deepest point in the kandilli bebek contraction which makes hydrodynamics of the bosphorus more complicated fig 1 the north sill has a crest depth of 60 m and is located approximately 3 4 km of the northeast of the black sea end the contraction region is the deepest part of the bosphorus with 100 m depth and placed at the two thirds length of the bosphorus from the black sea end the south sill is located 3 5 km north of the marmara sea junction it is the shallowest section in the bosphorus with a depth of 30 m at the middle and 40 m at the sides these three geometric features are the locations where hydraulic control conditions are expected farmer and armi 1986 ozsoy et al 1986 armi and farmer 1987 ünlülata et al 1990 oguz 2005 the bosphorus exhibits a two layer stratified flow structure which is illustrated in fig 2 it controls exchanges of water and substances between two large water bodies the black sea and the marmara sea thus the mediterranean sea a barotropic forcing driven by water level difference δh between two ends of the bosphorus causes a southward upper layer flow q1 from the black sea to the marmara sea the density difference δρ between the black sea and the marmara sea as a consequence of higher salinity rates in the marmara sea resulted in a northward baroclinic flow q2 at the lower layer oguz and sur 1989 özsoy et al 1998 oğuz 2005 stanev et al 2017 öztürk et al 2012 saçu et al 2020 the lower layer flow is relatively steady however the upper layer flow alters with meteorological conditions oğuz 2005 stanev et al 2017 öztürk et al 2012 erdik et al 2019 jarosz et al 2011a 2011b indicated that upper layer flow is more pronounced than lower layer flow at the southern bosphorus while at the northern bosphorus lower layer flow is more fluctuated than upper layer flow surface current velocities could reach 200 cm s at the southern section and it is under the 30 cm s in the northern section in general the opposite situation observed in the lower layer current reaches 100 cm s at the northern section and is below 70 cm s at the southern section the study domain is mainly affected by two seasonal climatic regimes during winter october to april meteorological conditions are under the influence of the cyclone passages they affect the study domain between 3 and 10 days leading to winds of 9 m s in the summer may to september northerly winds are dominant northerly winds are seen in 60 of the year while southerlies occur 20 of the time in winter the occurrence frequency is almost equal ünlülata et al 1990 jarosz et al 2011a according to measurements conducted by taisei corporation japan rtmeu 2005 between october 2004 and september 2005 the mean wind speed is 4 m s and it could increase up to 15 m s the meteorological variables have significant impacts on the exchange flow of the bosphorus by leading water level variations near the southern end of the bosphorus the strong southerly winds seen in winter during low air pressures increase the water level in the southern region which causes weakened upper layer flow reversing its direction the northerly winds are common throughout the year and in high speeds cause lower layer flow blockage especially when the water level at the black sea end of the bosphorus is high yüce and alpar 1997 jarosz et al 2011a alpar et al 1998 book et al 2014 özsoy et al 1998 saçu et al 2020 3 methodology in this study we adopted a stochastic approach based on deterministic simulations of oil spill scenarios to obtain the probability of different areas contaminated by oil a brief schematization of the adopted methodology is given in fig 3 3 1 numerical model description 3 1 1 hydrodynamic model delft3d flow the oil spill models are generally integrated with hydrodynamic models in the literature there is a common tendency for implementing the current velocity fields using the outputs of the regional models however such a methodology cannot be applied in small scale study areas since the coarse resolution of those models cannot capture the oceanic environment s fine scale features that can affect the transport of oil especially in regions with fast flowing currents this study carried out hydrodynamic simulations with delft3d flow an acknowledged open source software widely used in many open seas and coastal areas it is a structured finite difference model and solves three dimensional shallow water equations continuity equations and transport equations for conservative constituents under the hydrostatic and boussinesq assumptions these equations are derived from navier stokes equations delft3d can simulate three dimensional unsteady flows resulting from meteorological forcing and density differences due to non uniform salinity and temperature distributions which are significant in the bosphorus case for further details readers are referred to delft3d flow user manual deltares 2014a 3 1 2 the oil spill model delft3d part the part a module of delft3d was used to simulate the trajectory of the oil slicks an offline coupling with a flow module provides practical use since it does not need any modification for hydrodynamic model output it is a deterministic 3d particle based numerical model except for a random displacement of the particles at each step monte carlo method each particle is advected due to currents also by horizontal and vertical dispersion the movement of particles consists of two steps in the first step advection due to shear stresses generated by winds and currents is calculated in the second step a random walk process is applied the movement in the second step is random but it is also related to horizontal and vertical dispersion the part can calculate various oil weathering processes including advection evaporation dispersion emulsification decay and sticking to coast or seabed deltares 2014b 3 2 the flow model application and validation the model domain is discretized on the orthogonal curvilinear grid schematization with z layers in the vertical direction the model consists of 7317 ocean cells in horizontal grid the grid resolution varies between 40 m and 100 m inside the bosphorus and gradually decreases towards open boundaries fig 4 in the vertical model grid is composed of 20 layers that are found to be adequate for an accurate representation of currents near surface layers according to a study by saçu et al 2020 a high resolution 1 m is applied near the surface and the resolution decreases towards the bottom to capture the important features of the processes driving by atmospheric forcing the temporal domain was selected as two months january 2005 and july 2005 which represent different flow characteristics of the bosphorus in january the currents are under the effect of the severe winds in july winds are moderate and currents are mainly under the effect of the sea level difference between the two ends of the bosphorus there are two open boundaries located at the south and north ends of the bosphorus in open boundaries the model is forced by water level measurements conducted by taisei rtmeu 2005 at stations d and e fig 1 the monthly salinity and temperature data measured by istanbul water sewerage administration iski at stations k0 and m8 are also applied to obtain a two layer stratified flow structure the effects of wind on the flow field were considered using measurement at station f located south of the bosphorus fig 1 since wind distribution along bosphorus is nearly identical it is applied spatially uniform over the whole domain the model bathymetry is given in fig 1b it is adapted from nautical charts of turkish naval forces of navigation hydrography and oceanography the model initialized with uniform 38 ppt salinity and 15 c temperature with zero water level and current velocity to obtain reliable adjustment of the flow field 2 weeks of spin up is performed for each simulation the hydrodynamic model is calibrated against hourly current velocity data measured by acoustic doppler current profiler adcp at stations b and c shown in fig 1 since the along strait velocity component is too large than across the strait component jarosz et al 2011a we only represented the along strait velocity calibration the calibration period covers january and july 2005 the comparisons among observed and predicted current velocity are illustrated in fig 5 for both months and stations since station c measurements during july are not reliable we do not include this dataset in the calibration study it can be seen that results are generally in good agreement with the available data revealing the ability of the model to reproduce natural dynamics during january currents are largely controlled by the severe winds thus the flow pattern shows large variations such as reversal of upper layer flow condition encircled in fig 5a b in july the flow field is under the influence of the water level difference between two ends of the bosphorus rather than weak atmospheric forcing and the flow follows a calmer pattern fig 5c saçu et al 2020 the performance of the calibrated model is also evaluated through rmse function given by 1 r m s e 1 n i 1 n q i p i 2 where qi is the measured velocity pi is the predicted velocity in january rmse is calculated as 0 20 m s for both stations predictions in july show better results than those in january with rmse values of 0 16 m s the model developed herein yields similar even better results with those in the literature see erdik et al 2019 öztürk et al 2012 saçu et al 2020 3 3 oil spill simulations the purpose of this study is to generate probability maps based on a stochastic approach the oil spill model described in section 3 1 2 was used to obtain a database of oil trajectories in this context a representative number of scenarios were analyzed each scenario was defined as a specific oil spill event at a certain location and time with a certain oil type thus a considerable number of independent events were generated for various spill locations over different oceanographic conditions with different types of oil the selection of flow conditions and oil spill scenarios are described below 3 3 1 flow conditions to consider dynamics in the bosphorus oil spill simulations were performed over two representative flow conditions under the influence of different driving forces 31 days of july 2005 were selected for the first condition representing a two layered flow condition in the bosphorus the upper layer flow is towards the marmara sea southward and does not show high variations in time during this period as seen in fig 5c however the flow spatial velocity field varies dramatically at the northern entrance it flows toward the marmara sea with a velocity of about 0 5 m s and increases up to 1 5 m s near the southern exit fig 6 a the second condition was selected during a reversal of the upper layer flow water flows towards the black sea in a northward direction caused by strong southerly winds in winter although this type of flow is rarely seen in winter times when the cyclones pass over the study area it is crucial as it complicates navigation in the bosphorus the 5 day period between 25 and january 29 2005 is determined for the second condition when the longest reversal of upper layer flow occurs according to current velocity measurements carried out by taisei an encircled period in fig 5a and b the strong southerly winds up to 10 m s reverses the flow direction from southward to northward during this period in addition to spatial variations there are significant temporal variations compared to the first case moreover the magnitude of the current velocity is lower than the first condition fig 6 this variability depicts that oil spill simulations should be classified into two different flow conditions corresponding to different seasons thus oil spill simulations were carried out over time of these two flow types 3 3 2 definition of scenarios in oil spill modeling studies deterministic or stochastic approaches are generally used the deterministic approaches include fate of the oil based on a single model simulation and are generally used in a known spill event the stochastic approach is a combination of many deterministic oil spill simulations in this method the probability of contamination by oil is determined from a series of simulations initiated with various meteo oceanographic conditions oil characteristics and spill locations our study adopted a stochastic modeling approach to identify the probability of oil contact to the bosphorus in this context we set four ensembles of scenarios considering two different oil types light and heavy oil and meteo oceanographic conditions fig 7 these ensembles are called sh sl nh and nl the first letter refers to meteo oceanographic condition southward or northward flow and the second letter is oil type heavy or light in each ensemble different spill scenarios with different launch points and different start times were defined the spill locations were determined from the study of akten 2004 in that study places with a high risk of marine accidents were described five launch points with a high risk of accidents were chosen by considering locations that are not too close to each other and show a uniform distribution along the bosphorus location of launch points is shown in fig 4 the simulation time is 24 h for each scenario since the bosphorus has fast flowing currents and the mass of the oil particles is not taken into account in this study a longer simulation time will not cause significant changes in probability maps the spill start times were selected uniformly over the temporal domain described in section 3 3 1 5 start times in northward flow condition and 31 start times in southward flow condition 3 3 3 simulation of the defined scenarios the defined scenarios are simulated separately by the part module of delft3d using the same computational grid in the flow model every simulation was run using the ocean currents based on the hydrodynamic model and wind data at station f discussed in section 3 2 in the part each oil slick is considered as a number of separate lagrangian particles currents and winds mainly advect the oil slicks in addition to horizontal diffusion which is a random walk process in the part the current and wind factor is taken as 1 and 0 03 respectively fingas 2011 the horizontal diffusion coefficient ranges typically between 0 1 m2 s and 100 000 m2 s asce 1996 in this study a value of 1 m2 s is used the weathering processes as spreading evaporation emulsification natural dispersion stranding are simulated through empirical equations which depend on time meteo oceanographic conditions and oil type the oil models for the selected periods were run separately with each launch points as described in section 3 3 1 two types of oil light crude oil and heavy fuel oil with api 35 and api 12 were used in model configurations different stickiness probabilities are used for two oil types as 0 and 0 5 the particles might contact land due to dispersion or wind if a randomly chosen number between 0 and 1 is smaller than the specified stickiness probability then the particle will stick to the shoreline deltares 2014b detailed information on oil properties is given in table 1 for each scenario a single spill volume of 5000 tons is chosen and the release continued for 5 h with a constant rate of 1000 tons hour each oil slick was represented by 100 lagrangian particles and their trajectories were extracted every 10 min these trajectories were used in probability calculations and post processing 3 4 probability calculations and post processing the part model does not provide the contamination probability of ocean cells only gives the trajectory of the individual particles geographically to obtain contamination probability the main steps followed are summarized in fig 3 by using part we simulated trajectories of particles and arranged them in 3d matrixes the dimensions of each matrix are coordinates of a particle in x and y directions and time then 3d matrixes were loaded to the arcgis environment and the number of trajectories that contact with ocean cells was counted the computational grid established for the hydrodynamic model and coastal land boundary obtained from turkish naval forces of navigation hydrography and oceanography are used as underlying files a contact occurs when a particle passes through an ocean cell the contamination probability of an ocean cell centered at longitude x and latitude y at a certain time p x y t is calculated using 2 p x y t 1 s i 1 s j 0 t c x y t i j n i j where c x y t is the number of contacts at an ocean cell centered at longitude x and latitude y at a certain moment t during slick simulations the t varies between 0 and 24 h and has 10 min increments n is the number of particles released by time t and s is the number of simulations in a certain ensemble the indices i and j are scenario and time indexes respectively the calculated p value varies between 0 and 1 4 results the contamination probability maps of sl and sh at the end of the 6th hour reveal oiling probability for light and heavy oil is similar fig 8 however a discrepancy can be seen between the two ensembles in sh 10 of oil particles moved away from the open boundary while in sl trajectories do not extend to boundaries the prevailing southward currents moved oil slicks to the south of bosphorus while it sometimes tends to eastward and westward by shoreline geometry the oiling probability decreases with increasing distance from the launch points the spatial distribution of oil is drastically varied according to release location at the launch point l1 the advection of oil is too slow compared to other points since the current velocity in this region remains relatively low as mentioned in section 3 1 1 the region that remains between l1 and l2 still is not exposed to significant contamination in both sl and sh the most polluted coastline remains between kandilli kn and uskudar us with a probability of about 10 this might be due to the locations of release points in this region that are too close to the coast and the current direction at the 12th hour from the beginning of the spill the coastline between kn and us reveals distinctive contamination probability reaching over 30 in sl and 15 in sh ensemble fig 9 besides an increase in trajectories leaving the model domain can be seen because of strong southeastern currents near the bosphorus marmara sea junction in the sl 45 of the particles leave the model domain whereas it is 40 in the sh after 24 h from the beginning of the releases in sl nearly 40 of the trajectories pass from the region between kn and us coasts and keep moving towards the marmara sea fig 10 the regions with high oiling probability between kn and us in sh are the same as sl with a lower probability 20 the difference between ensembles resulted from behavior of the oil types since heavy oil has a high stickiness probability finally in the sl ensemble all trajectories leave the model by flowing to the marmara sea in the sh ensemble 65 of the trajectories leave the model domain the other two ensembles nl and nh are investigated for a northward flow condition with strong southerly winds as mentioned in the previous sections flow in this case is slower than the southward flow condition also current velocity patterns are quite different as can be seen in fig 6 considering these differences we expect the rate of the contamination probability will show an important change the contamination probability of nl and nh ensembles after the 6th hours from the release is given in fig 11 the spatial probability shows a similar pattern of disregard of oil type in both of them oil trajectories are elongated in the north direction and mainly pollute the western side of the bosphorus the contamination probability of coastline between be and yeniköy yk reaches up to 6 a significant presence of oil at the north of the yk can also be seen in contrast to sl and sh ensembles at the 12th hour the contamination probability reaches higher rates which generally increases from the eastern to the western side of the bosphorus fig 12 almost the entire west coastline is exposed to oil contamination in contrast to the eastern side where the only significant contamination is found near us coasts 18 and 13 of particles disappear from the bosphorus from the northwest direction in nl and nh ensembles in the nl ensemble 67 of particles moved away from the northwest of the bosphorus 24 h after the spill whereas it is about 35 in nh fig 13 relatively a small portion of trajectories 20 leave the domain from the southeast of bosphorus in nl ensemble resulting from a short time weakening of northward flow because of weakened southerly winds the highest contamination probability is found between rumelikavağı rk and rumelifeneri rf with a probability of up to 15 in the nl ensemble while in the nh it is smaller 6 in the nl ensemble oil trajectories nearly distributed all along the bosphorus while there is a less spatial distribution in nh since trajectories were stranded on the shoreline the eastern coastline is not affected by oil as much as the western in the nl significant contaminations are found near the us 7 kn 5 and bh 8 while in the nh contaminations are too small the other important point about nh is that it does not show a serious change in the spatial distribution of probability after the 12th hour see figs 12 and 13 5 discussion in this study oiling probability in bosporus was investigated by defining four different ensembles sl sh nl and nh to take two different oil types and two different meteo oceanographic conditions into account in fig 14 a summary of the oiling probability of coasts is given to make a clearer discussion of the results the effect of different oil types lighter and heavier oil on oiling probability is relatively small the oiling probability is decreased in heavier oil however the coasts that might be polluted are the same with a lighter oil herein we have to remind that the mass of the oil is not taken into account in probability calculation and a lower probability does not necessarily indicate lower risk the difference between two types of oil is mainly caused by a higher stickiness probability of the heavier oil used in the model application since re float processes are not included in calculations a significant number of particles are trapped on the shorelines different meteo oceanographic conditions demonstrated large variability in oiling probability fig 14 in southward flow ensembles yk be and bt coasts on the western side of the strait and kn us and kk coasts on the strait s eastern side reveal high oiling probability in northward flow conditions nearly all coasts at both sides of the strait have significant oiling probability these results should be taken into account in the planning of intervention stations since southward flow conditions are the common flow structure in the bosphorus and seen throughout the year for a timely intervention oil spill response equipment should be stored at regions near yk be bt coasts at the western side and kn us and kk coasts at the eastern side during winter a northward flow condition is also seen therefore at this time the equipment should be located at all coasts for rapid and effective controlling and cleaning although the main objective of this study is finding oiling probabilities along the bosphorus some inferences about controlling and cleaning of spilled oil could also be made booms sorbents skimmers dispersants and in situ burning are among the most commonly implemented techniques in oil spill response the selection of appropriate equipment is crucial for an efficient response in addition to a timely response lee et al 2015 chen et al 2019 fingas 2016 the wave height current velocity and viscosity of spilled oil are three main parameters limiting equipment selection ventikos et al 2004 muttin 2008 in the bosphorus booms can contain or direct oil however fast flowing currents reaching over 1 m s especially in the southern region could decrease their performance by causing leakage of oil therefore in case of a spill controlling the movement of oil in the northern section will be more efficient pump or skimmers accomplished by booms can remove the contained oil sorbents also could be used in the recovery of shorelines the use of dispersants is a source of concern due to their ecological damage grote et al 2017 board 2020 nrc 2005 and they were found to be less effective in low salinities fingas 2011 chandrasekar et al 2006 considering low salinity in the bosphorus and ecological damage together the use of dispersants should be considered as the final option in response operations in situ burning which is based on a controlled ignition and burning of the oil effectively removes large oil spills it has an easy implementation and low cost sahai et al 2007 ekperusi et al 2019 the in situ burning should be carried out at least 1 km away from the human population for health and safety concerns astm 2008 mullin and champ 2003 since bosphorus is a narrow waterway and has a large human population living near the coastal area the use of in situ burning should not be used as an oil spill countermeasure in the bosphorus the oil could be diverted towards the marmara sea or the black sea where in situ burning could be applied away from a safe distance from the coastal areas by using booms 6 conclusion in this study we established numerical simulations of hydrodynamics and oil spill incidents in the bosphorus to estimate the probability of regions being contaminated by oil the hydrodynamic simulations were carried out for realistic meteo oceanographic conditions whereas oil spill scenarios are hypothetical we followed a stochastic approach to handle uncertainty and improve the accuracy of assessments a short term current data and a limited number of hypothetical spill scenarios were used because of restrictions in data availability computational cost and storage requirements the study s findings suggest that the effects of variations in meteo oceanographic conditions should be considered in the estimation of target regions with high contamination probability we found that during a northward flow much more areas could be contaminated than during a southward flow since southward flow condition is the common flow structure throughout the year and northward flow is rare and generally seen in winter different response and conservation strategies should be planned for winter and the rest of the year moreover we investigated the effects of the oil types without considering the mass loss of the lagrangian oil particles and a relatively small difference was obtained between the oiling probability of different oil types this study presents the first attempt to determine oiling probabilities in the bosphorus through a realistic hydrodynamic model and stochastic assessment the outputs of this study can help decision makers to formulate effective response and conservation strategies in the bosphorus a highly populated area and a busy shipping lane besides this study s models can be used in hindcasting or forecasting trajectories of specific oil accidents in further studies the time of simulation should be extended to account for the inter annual variability of current and wind fields the mass of the oil particles should be included in oiling probability calculations the vulnerability of the coastal environment to oil pollution also could be classified to support risk management credit authorship contribution statement şehriban saçu conceptualization methodology software validation resources data curation writing original draft visualization olgay şen conceptualization methodology software resources data curation visualization writing review editing tarkan erdik writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by istanbul technical university scientific research project coordination unit itu bap with grant number 42543 the authors would like to thank two anonymous reviewers for their constructive and thoughtful comments on our manuscript which helped us to improve it substantially 
20739,the bosphorus is one of the busiest shipping lanes globally as it is the only maritime route for black sea countries every year about 50 000 ships sail through this lane hence it is necessary to develop emergency response planning strategies due to its high vessel passage rate distinguished geometry and delicate hydrodynamics that exhibit two layer stratified flow and exchange water mass between the adjacent seas in this study a 3d hydrodynamic model of the bosphorus is established to simulate oil spill scenarios for improving preparedness for an oil spill event a stochastic approach is followed to identify oil contamination probability maps for four different ensembles considering two different oil types and two meteo oceanographic conditions the results highlight the importance of using different meteo oceanographic conditions as probability maps regarding different meteo oceanographic conditions show large variability the suggested response strategies can be used to manage oil spill emergencies in the bosporus more efficiently keywords bosphorus hydrodynamic modeling oil spill modeling contamination probability stochastic 1 introduction oil spill events are among the most important sources of pollution in the marine environment particularly in coastal zones they can result from natural and anthropogenic sources major spills from human activities are caused by tanker accidents rig explosions and storage leakages ihaksi et al 2011 singkran 2013 according to the international tanker owners pollution federation the total number of incidents related to tankers are about 10 000 from the 1970s to the present itopf 2019 oil pollution leads to an environmental disturbance and can result in various short and long term consequences on marine ecosystems health and economics of coastal communities gundlach et al 1978 kingston 2002 alló and loureiro 2013 therefore it is necessary to develop oil spill response strategies to mitigate spill events and reduce adverse impacts modeling tools can be used to develop emergency response planning and operational forecasting systems the models provide information for determining potential regions affected by oil spills and thus contribute to improving emergency response planning and protection of the environment numerical models predict the movement of oil slick which is governed by external forces such as currents waves and winds considering the physical and chemical processes of oil weathering processes olita et al 2012 lee and jung 2015 toz and koseoglu 2018 numerical models come up with uncertainty since environmental variables and oil characteristics contain too much uncertainty fingas 2011 the main uncertainties in oil spills are the location of oil spill meteo oceanographic condition during the spill and oil spill properties neves et al 2016 probabilistic or stochastic approaches are commonly used in recent studies to consider uncertainty goldman et al 2015 neves et al 2016 lee and jung 2015 landquist et al 2016 guo et al 2016 guo 2017 these approaches use an ensemble of many hypothetical spills in this way the oiling probability of an environmental resource can be calculated amir heidari et al 2019 recent studies have been carried out in the literature to improve the risk assessment s effectiveness by adopting a stochastic approach recommended by international petroleum industry environmental conservation association ipieca 2017 niu et al 2017 studied contamination probability in the salish sea following a stochastic approach under various meteo oceanographic conditions they used high resolution atmospheric and oceanographic data and three different oil types to study contamination probability moreover they investigated the effect of the chemical dispersant on dilbit oil in a study by al shami et al 2017 a stochastic approach was used for risk assessment of oil spills along the mediterranean coastlines the oil pollution metrics such as oiling susceptibility beaching time concentration and frequency were used for hazard assessment their results highlighted the need for considering different metrics in risk quantification nelson and grubesic 2017 applied a repeated sampling method to deal with the stochastic nature of the oceanic environment they indicated that using a single simulation could be misleading in identifying potential areas that could be polluted with a large amount of oil and found that their developed approach provided more robust results amir heidari et al 2019 developed a new model for spatial and stochastic risk assessment of oil spills from shipwrecks they combined three important factors characteristic of the spill source dynamics in the meteo oceanographic field and spatial distribution of environmental sources amir heidari and raie 2019 presented a new stochastic model based on an advanced trajectory model linked with spatiotemporal meteo oceanographic data they used the proposed model to analyze spills in the persian gulf stochastically they found that release start time is the most important factor for the study area and indicated the number of start times and algorithm for selecting random start times as the most significant steps in risk assessment chiri et al 2020 proposed a new methodology for stochastic modeling of deep oil spills they used k means clustering techniques to choose important spatio temporal meteo oceanographic variables from reanalysis datasets by selecting the most relevant meteo oceanographic conditions they optimized computational efforts the bosphorus has been increasingly threatened by oil spill pollution similar to other parts of the world being the only maritime route to open seas for black sea countries bosphorus is one of the busiest shipping lanes it has a transit vessel passage of about 50 000 per year where nearly ten thousand carry dangerous and hazardous cargo the heavy maritime traffic resulted in a yearly average of 23 marine accidents republic of turkey prime minister s office maritime under secretariat 2017 considering the rate of tanker traffic and accidents oil spills are inevitable in the past five major oil spill accidents occurred in istanbul in 1979 the romanian tanker independenta collided with greek tanker evriali near the south end of the bosphorus and 93 800 tons of crude oil spilled and burned for a month it is the largest oil spill accident in turkey and one of the world s largest accidents 13th that ended in the death of 42 crew members similar incidents occurred in 1994 by the collision of the tanker nassia spilling 20 000 tons of crude oil in 1999 by the grounding of tanker volganeft 4000 tons of fuel oils spilled in 2003 by the grounding of svyatoy panteleymon 220 tons of diesel and 260 tons of fuel oils spilled into the sea after these incidents oil pollution led to considerable damages to the aquatic ecosystem and socio economic values of the bosphorus increasing air pollution from burning of oil high mortality rates of the marine habitat disappearance of some species showed detrimental consequences of oil spills in the bosphorus öztürk et al 2001 birpınar et al 2009 oral and öztürk 2006 despite the importance of the threats from oil spills in the bosphorus there is a lack of studies in oil spill modeling bozkurtoğlu 2017 made the only considerable study where the potential areas polluted by oil were determined in that research the particle tracking oil spill model ptosm was developed to simulate the oil slick s movement by considering spreading evaporation and advection processes the risky areas were determined from a deterministic approach although that study could be regarded as an important study for calling attention to oil spill modeling and shading a light in determining critical locations for intervention stations in the bosphorus it does not sufficiently represent dynamics in the bosphorus the lack of calibration in bozkurtoğlu 2017 can cause misleading particle trajectories moreover a statistical assessment which is useful in developing risk assessment and preparedness strategies was not applied in this study new hydrodynamic modeling is performed to better represent the hydrodynamics of the bosphorus which has a nonlinear turbulent and stratified flow structure and makes modeling even more difficult sözer and özsoy 2017 therefore a 3d numerical model with high spatial and temporal resolution under realistic atmospheric forcing is implemented and calibrated intensively to describe the complex hydrodynamics secondly we followed a stochastic modeling approach to estimate oil contamination probability in the bosphorus to handle main uncertainty sources we set up oil spill simulations at five possible launch points for two different types of oil as light and heavy moreover to take into account the dynamics in the bosphorus we performed oil spill simulations over two different representative time periods selected according to the meteo oceanographic conditions finally we produced oil contamination probability maps to improve preparedness against oil spill events 2 study area and its hydrodynamics the bosphorus is located between 41 2 n and 41 0 n in the south north direction it is between 29 2 e and 29 0 e in the east west direction fig 1 it has played a significant role in the social environmental strategic and economic issues of the istanbul metropolitan city from past to present the population of istanbul exceeded 15 million according to official records in 2018 and most of this population live in the coastal part of istanbul the bosphorus has unique geometric features and topographic details affecting hydrodynamics and navigation it is a narrow waterway with a total length of 30 km at the north and south ends its width is about 3 5 km and 2 5 km respectively the north half of the bosphorus is wider than the south half and represents more variations in width it is only 0 7 km in the narrowest section called contraction region and 3 6 km in the widest section it ends with an abrupt opening near the marmara sea end the strait has at least 12 sharp bends with a severely limited vision which makes maneuvering of ships risky the most critical bends are located at yeniköy and near beykoz harbor with an angle of 80 and 70 respectively most of the accidents occur in these locations when vessels take sharp turns with prevalent currents akten 2004 where the dense population resides near both sides of the strait as for bathymetry it has abrupt variations with two sills near the north and south ends and the deepest point in the kandilli bebek contraction which makes hydrodynamics of the bosphorus more complicated fig 1 the north sill has a crest depth of 60 m and is located approximately 3 4 km of the northeast of the black sea end the contraction region is the deepest part of the bosphorus with 100 m depth and placed at the two thirds length of the bosphorus from the black sea end the south sill is located 3 5 km north of the marmara sea junction it is the shallowest section in the bosphorus with a depth of 30 m at the middle and 40 m at the sides these three geometric features are the locations where hydraulic control conditions are expected farmer and armi 1986 ozsoy et al 1986 armi and farmer 1987 ünlülata et al 1990 oguz 2005 the bosphorus exhibits a two layer stratified flow structure which is illustrated in fig 2 it controls exchanges of water and substances between two large water bodies the black sea and the marmara sea thus the mediterranean sea a barotropic forcing driven by water level difference δh between two ends of the bosphorus causes a southward upper layer flow q1 from the black sea to the marmara sea the density difference δρ between the black sea and the marmara sea as a consequence of higher salinity rates in the marmara sea resulted in a northward baroclinic flow q2 at the lower layer oguz and sur 1989 özsoy et al 1998 oğuz 2005 stanev et al 2017 öztürk et al 2012 saçu et al 2020 the lower layer flow is relatively steady however the upper layer flow alters with meteorological conditions oğuz 2005 stanev et al 2017 öztürk et al 2012 erdik et al 2019 jarosz et al 2011a 2011b indicated that upper layer flow is more pronounced than lower layer flow at the southern bosphorus while at the northern bosphorus lower layer flow is more fluctuated than upper layer flow surface current velocities could reach 200 cm s at the southern section and it is under the 30 cm s in the northern section in general the opposite situation observed in the lower layer current reaches 100 cm s at the northern section and is below 70 cm s at the southern section the study domain is mainly affected by two seasonal climatic regimes during winter october to april meteorological conditions are under the influence of the cyclone passages they affect the study domain between 3 and 10 days leading to winds of 9 m s in the summer may to september northerly winds are dominant northerly winds are seen in 60 of the year while southerlies occur 20 of the time in winter the occurrence frequency is almost equal ünlülata et al 1990 jarosz et al 2011a according to measurements conducted by taisei corporation japan rtmeu 2005 between october 2004 and september 2005 the mean wind speed is 4 m s and it could increase up to 15 m s the meteorological variables have significant impacts on the exchange flow of the bosphorus by leading water level variations near the southern end of the bosphorus the strong southerly winds seen in winter during low air pressures increase the water level in the southern region which causes weakened upper layer flow reversing its direction the northerly winds are common throughout the year and in high speeds cause lower layer flow blockage especially when the water level at the black sea end of the bosphorus is high yüce and alpar 1997 jarosz et al 2011a alpar et al 1998 book et al 2014 özsoy et al 1998 saçu et al 2020 3 methodology in this study we adopted a stochastic approach based on deterministic simulations of oil spill scenarios to obtain the probability of different areas contaminated by oil a brief schematization of the adopted methodology is given in fig 3 3 1 numerical model description 3 1 1 hydrodynamic model delft3d flow the oil spill models are generally integrated with hydrodynamic models in the literature there is a common tendency for implementing the current velocity fields using the outputs of the regional models however such a methodology cannot be applied in small scale study areas since the coarse resolution of those models cannot capture the oceanic environment s fine scale features that can affect the transport of oil especially in regions with fast flowing currents this study carried out hydrodynamic simulations with delft3d flow an acknowledged open source software widely used in many open seas and coastal areas it is a structured finite difference model and solves three dimensional shallow water equations continuity equations and transport equations for conservative constituents under the hydrostatic and boussinesq assumptions these equations are derived from navier stokes equations delft3d can simulate three dimensional unsteady flows resulting from meteorological forcing and density differences due to non uniform salinity and temperature distributions which are significant in the bosphorus case for further details readers are referred to delft3d flow user manual deltares 2014a 3 1 2 the oil spill model delft3d part the part a module of delft3d was used to simulate the trajectory of the oil slicks an offline coupling with a flow module provides practical use since it does not need any modification for hydrodynamic model output it is a deterministic 3d particle based numerical model except for a random displacement of the particles at each step monte carlo method each particle is advected due to currents also by horizontal and vertical dispersion the movement of particles consists of two steps in the first step advection due to shear stresses generated by winds and currents is calculated in the second step a random walk process is applied the movement in the second step is random but it is also related to horizontal and vertical dispersion the part can calculate various oil weathering processes including advection evaporation dispersion emulsification decay and sticking to coast or seabed deltares 2014b 3 2 the flow model application and validation the model domain is discretized on the orthogonal curvilinear grid schematization with z layers in the vertical direction the model consists of 7317 ocean cells in horizontal grid the grid resolution varies between 40 m and 100 m inside the bosphorus and gradually decreases towards open boundaries fig 4 in the vertical model grid is composed of 20 layers that are found to be adequate for an accurate representation of currents near surface layers according to a study by saçu et al 2020 a high resolution 1 m is applied near the surface and the resolution decreases towards the bottom to capture the important features of the processes driving by atmospheric forcing the temporal domain was selected as two months january 2005 and july 2005 which represent different flow characteristics of the bosphorus in january the currents are under the effect of the severe winds in july winds are moderate and currents are mainly under the effect of the sea level difference between the two ends of the bosphorus there are two open boundaries located at the south and north ends of the bosphorus in open boundaries the model is forced by water level measurements conducted by taisei rtmeu 2005 at stations d and e fig 1 the monthly salinity and temperature data measured by istanbul water sewerage administration iski at stations k0 and m8 are also applied to obtain a two layer stratified flow structure the effects of wind on the flow field were considered using measurement at station f located south of the bosphorus fig 1 since wind distribution along bosphorus is nearly identical it is applied spatially uniform over the whole domain the model bathymetry is given in fig 1b it is adapted from nautical charts of turkish naval forces of navigation hydrography and oceanography the model initialized with uniform 38 ppt salinity and 15 c temperature with zero water level and current velocity to obtain reliable adjustment of the flow field 2 weeks of spin up is performed for each simulation the hydrodynamic model is calibrated against hourly current velocity data measured by acoustic doppler current profiler adcp at stations b and c shown in fig 1 since the along strait velocity component is too large than across the strait component jarosz et al 2011a we only represented the along strait velocity calibration the calibration period covers january and july 2005 the comparisons among observed and predicted current velocity are illustrated in fig 5 for both months and stations since station c measurements during july are not reliable we do not include this dataset in the calibration study it can be seen that results are generally in good agreement with the available data revealing the ability of the model to reproduce natural dynamics during january currents are largely controlled by the severe winds thus the flow pattern shows large variations such as reversal of upper layer flow condition encircled in fig 5a b in july the flow field is under the influence of the water level difference between two ends of the bosphorus rather than weak atmospheric forcing and the flow follows a calmer pattern fig 5c saçu et al 2020 the performance of the calibrated model is also evaluated through rmse function given by 1 r m s e 1 n i 1 n q i p i 2 where qi is the measured velocity pi is the predicted velocity in january rmse is calculated as 0 20 m s for both stations predictions in july show better results than those in january with rmse values of 0 16 m s the model developed herein yields similar even better results with those in the literature see erdik et al 2019 öztürk et al 2012 saçu et al 2020 3 3 oil spill simulations the purpose of this study is to generate probability maps based on a stochastic approach the oil spill model described in section 3 1 2 was used to obtain a database of oil trajectories in this context a representative number of scenarios were analyzed each scenario was defined as a specific oil spill event at a certain location and time with a certain oil type thus a considerable number of independent events were generated for various spill locations over different oceanographic conditions with different types of oil the selection of flow conditions and oil spill scenarios are described below 3 3 1 flow conditions to consider dynamics in the bosphorus oil spill simulations were performed over two representative flow conditions under the influence of different driving forces 31 days of july 2005 were selected for the first condition representing a two layered flow condition in the bosphorus the upper layer flow is towards the marmara sea southward and does not show high variations in time during this period as seen in fig 5c however the flow spatial velocity field varies dramatically at the northern entrance it flows toward the marmara sea with a velocity of about 0 5 m s and increases up to 1 5 m s near the southern exit fig 6 a the second condition was selected during a reversal of the upper layer flow water flows towards the black sea in a northward direction caused by strong southerly winds in winter although this type of flow is rarely seen in winter times when the cyclones pass over the study area it is crucial as it complicates navigation in the bosphorus the 5 day period between 25 and january 29 2005 is determined for the second condition when the longest reversal of upper layer flow occurs according to current velocity measurements carried out by taisei an encircled period in fig 5a and b the strong southerly winds up to 10 m s reverses the flow direction from southward to northward during this period in addition to spatial variations there are significant temporal variations compared to the first case moreover the magnitude of the current velocity is lower than the first condition fig 6 this variability depicts that oil spill simulations should be classified into two different flow conditions corresponding to different seasons thus oil spill simulations were carried out over time of these two flow types 3 3 2 definition of scenarios in oil spill modeling studies deterministic or stochastic approaches are generally used the deterministic approaches include fate of the oil based on a single model simulation and are generally used in a known spill event the stochastic approach is a combination of many deterministic oil spill simulations in this method the probability of contamination by oil is determined from a series of simulations initiated with various meteo oceanographic conditions oil characteristics and spill locations our study adopted a stochastic modeling approach to identify the probability of oil contact to the bosphorus in this context we set four ensembles of scenarios considering two different oil types light and heavy oil and meteo oceanographic conditions fig 7 these ensembles are called sh sl nh and nl the first letter refers to meteo oceanographic condition southward or northward flow and the second letter is oil type heavy or light in each ensemble different spill scenarios with different launch points and different start times were defined the spill locations were determined from the study of akten 2004 in that study places with a high risk of marine accidents were described five launch points with a high risk of accidents were chosen by considering locations that are not too close to each other and show a uniform distribution along the bosphorus location of launch points is shown in fig 4 the simulation time is 24 h for each scenario since the bosphorus has fast flowing currents and the mass of the oil particles is not taken into account in this study a longer simulation time will not cause significant changes in probability maps the spill start times were selected uniformly over the temporal domain described in section 3 3 1 5 start times in northward flow condition and 31 start times in southward flow condition 3 3 3 simulation of the defined scenarios the defined scenarios are simulated separately by the part module of delft3d using the same computational grid in the flow model every simulation was run using the ocean currents based on the hydrodynamic model and wind data at station f discussed in section 3 2 in the part each oil slick is considered as a number of separate lagrangian particles currents and winds mainly advect the oil slicks in addition to horizontal diffusion which is a random walk process in the part the current and wind factor is taken as 1 and 0 03 respectively fingas 2011 the horizontal diffusion coefficient ranges typically between 0 1 m2 s and 100 000 m2 s asce 1996 in this study a value of 1 m2 s is used the weathering processes as spreading evaporation emulsification natural dispersion stranding are simulated through empirical equations which depend on time meteo oceanographic conditions and oil type the oil models for the selected periods were run separately with each launch points as described in section 3 3 1 two types of oil light crude oil and heavy fuel oil with api 35 and api 12 were used in model configurations different stickiness probabilities are used for two oil types as 0 and 0 5 the particles might contact land due to dispersion or wind if a randomly chosen number between 0 and 1 is smaller than the specified stickiness probability then the particle will stick to the shoreline deltares 2014b detailed information on oil properties is given in table 1 for each scenario a single spill volume of 5000 tons is chosen and the release continued for 5 h with a constant rate of 1000 tons hour each oil slick was represented by 100 lagrangian particles and their trajectories were extracted every 10 min these trajectories were used in probability calculations and post processing 3 4 probability calculations and post processing the part model does not provide the contamination probability of ocean cells only gives the trajectory of the individual particles geographically to obtain contamination probability the main steps followed are summarized in fig 3 by using part we simulated trajectories of particles and arranged them in 3d matrixes the dimensions of each matrix are coordinates of a particle in x and y directions and time then 3d matrixes were loaded to the arcgis environment and the number of trajectories that contact with ocean cells was counted the computational grid established for the hydrodynamic model and coastal land boundary obtained from turkish naval forces of navigation hydrography and oceanography are used as underlying files a contact occurs when a particle passes through an ocean cell the contamination probability of an ocean cell centered at longitude x and latitude y at a certain time p x y t is calculated using 2 p x y t 1 s i 1 s j 0 t c x y t i j n i j where c x y t is the number of contacts at an ocean cell centered at longitude x and latitude y at a certain moment t during slick simulations the t varies between 0 and 24 h and has 10 min increments n is the number of particles released by time t and s is the number of simulations in a certain ensemble the indices i and j are scenario and time indexes respectively the calculated p value varies between 0 and 1 4 results the contamination probability maps of sl and sh at the end of the 6th hour reveal oiling probability for light and heavy oil is similar fig 8 however a discrepancy can be seen between the two ensembles in sh 10 of oil particles moved away from the open boundary while in sl trajectories do not extend to boundaries the prevailing southward currents moved oil slicks to the south of bosphorus while it sometimes tends to eastward and westward by shoreline geometry the oiling probability decreases with increasing distance from the launch points the spatial distribution of oil is drastically varied according to release location at the launch point l1 the advection of oil is too slow compared to other points since the current velocity in this region remains relatively low as mentioned in section 3 1 1 the region that remains between l1 and l2 still is not exposed to significant contamination in both sl and sh the most polluted coastline remains between kandilli kn and uskudar us with a probability of about 10 this might be due to the locations of release points in this region that are too close to the coast and the current direction at the 12th hour from the beginning of the spill the coastline between kn and us reveals distinctive contamination probability reaching over 30 in sl and 15 in sh ensemble fig 9 besides an increase in trajectories leaving the model domain can be seen because of strong southeastern currents near the bosphorus marmara sea junction in the sl 45 of the particles leave the model domain whereas it is 40 in the sh after 24 h from the beginning of the releases in sl nearly 40 of the trajectories pass from the region between kn and us coasts and keep moving towards the marmara sea fig 10 the regions with high oiling probability between kn and us in sh are the same as sl with a lower probability 20 the difference between ensembles resulted from behavior of the oil types since heavy oil has a high stickiness probability finally in the sl ensemble all trajectories leave the model by flowing to the marmara sea in the sh ensemble 65 of the trajectories leave the model domain the other two ensembles nl and nh are investigated for a northward flow condition with strong southerly winds as mentioned in the previous sections flow in this case is slower than the southward flow condition also current velocity patterns are quite different as can be seen in fig 6 considering these differences we expect the rate of the contamination probability will show an important change the contamination probability of nl and nh ensembles after the 6th hours from the release is given in fig 11 the spatial probability shows a similar pattern of disregard of oil type in both of them oil trajectories are elongated in the north direction and mainly pollute the western side of the bosphorus the contamination probability of coastline between be and yeniköy yk reaches up to 6 a significant presence of oil at the north of the yk can also be seen in contrast to sl and sh ensembles at the 12th hour the contamination probability reaches higher rates which generally increases from the eastern to the western side of the bosphorus fig 12 almost the entire west coastline is exposed to oil contamination in contrast to the eastern side where the only significant contamination is found near us coasts 18 and 13 of particles disappear from the bosphorus from the northwest direction in nl and nh ensembles in the nl ensemble 67 of particles moved away from the northwest of the bosphorus 24 h after the spill whereas it is about 35 in nh fig 13 relatively a small portion of trajectories 20 leave the domain from the southeast of bosphorus in nl ensemble resulting from a short time weakening of northward flow because of weakened southerly winds the highest contamination probability is found between rumelikavağı rk and rumelifeneri rf with a probability of up to 15 in the nl ensemble while in the nh it is smaller 6 in the nl ensemble oil trajectories nearly distributed all along the bosphorus while there is a less spatial distribution in nh since trajectories were stranded on the shoreline the eastern coastline is not affected by oil as much as the western in the nl significant contaminations are found near the us 7 kn 5 and bh 8 while in the nh contaminations are too small the other important point about nh is that it does not show a serious change in the spatial distribution of probability after the 12th hour see figs 12 and 13 5 discussion in this study oiling probability in bosporus was investigated by defining four different ensembles sl sh nl and nh to take two different oil types and two different meteo oceanographic conditions into account in fig 14 a summary of the oiling probability of coasts is given to make a clearer discussion of the results the effect of different oil types lighter and heavier oil on oiling probability is relatively small the oiling probability is decreased in heavier oil however the coasts that might be polluted are the same with a lighter oil herein we have to remind that the mass of the oil is not taken into account in probability calculation and a lower probability does not necessarily indicate lower risk the difference between two types of oil is mainly caused by a higher stickiness probability of the heavier oil used in the model application since re float processes are not included in calculations a significant number of particles are trapped on the shorelines different meteo oceanographic conditions demonstrated large variability in oiling probability fig 14 in southward flow ensembles yk be and bt coasts on the western side of the strait and kn us and kk coasts on the strait s eastern side reveal high oiling probability in northward flow conditions nearly all coasts at both sides of the strait have significant oiling probability these results should be taken into account in the planning of intervention stations since southward flow conditions are the common flow structure in the bosphorus and seen throughout the year for a timely intervention oil spill response equipment should be stored at regions near yk be bt coasts at the western side and kn us and kk coasts at the eastern side during winter a northward flow condition is also seen therefore at this time the equipment should be located at all coasts for rapid and effective controlling and cleaning although the main objective of this study is finding oiling probabilities along the bosphorus some inferences about controlling and cleaning of spilled oil could also be made booms sorbents skimmers dispersants and in situ burning are among the most commonly implemented techniques in oil spill response the selection of appropriate equipment is crucial for an efficient response in addition to a timely response lee et al 2015 chen et al 2019 fingas 2016 the wave height current velocity and viscosity of spilled oil are three main parameters limiting equipment selection ventikos et al 2004 muttin 2008 in the bosphorus booms can contain or direct oil however fast flowing currents reaching over 1 m s especially in the southern region could decrease their performance by causing leakage of oil therefore in case of a spill controlling the movement of oil in the northern section will be more efficient pump or skimmers accomplished by booms can remove the contained oil sorbents also could be used in the recovery of shorelines the use of dispersants is a source of concern due to their ecological damage grote et al 2017 board 2020 nrc 2005 and they were found to be less effective in low salinities fingas 2011 chandrasekar et al 2006 considering low salinity in the bosphorus and ecological damage together the use of dispersants should be considered as the final option in response operations in situ burning which is based on a controlled ignition and burning of the oil effectively removes large oil spills it has an easy implementation and low cost sahai et al 2007 ekperusi et al 2019 the in situ burning should be carried out at least 1 km away from the human population for health and safety concerns astm 2008 mullin and champ 2003 since bosphorus is a narrow waterway and has a large human population living near the coastal area the use of in situ burning should not be used as an oil spill countermeasure in the bosphorus the oil could be diverted towards the marmara sea or the black sea where in situ burning could be applied away from a safe distance from the coastal areas by using booms 6 conclusion in this study we established numerical simulations of hydrodynamics and oil spill incidents in the bosphorus to estimate the probability of regions being contaminated by oil the hydrodynamic simulations were carried out for realistic meteo oceanographic conditions whereas oil spill scenarios are hypothetical we followed a stochastic approach to handle uncertainty and improve the accuracy of assessments a short term current data and a limited number of hypothetical spill scenarios were used because of restrictions in data availability computational cost and storage requirements the study s findings suggest that the effects of variations in meteo oceanographic conditions should be considered in the estimation of target regions with high contamination probability we found that during a northward flow much more areas could be contaminated than during a southward flow since southward flow condition is the common flow structure throughout the year and northward flow is rare and generally seen in winter different response and conservation strategies should be planned for winter and the rest of the year moreover we investigated the effects of the oil types without considering the mass loss of the lagrangian oil particles and a relatively small difference was obtained between the oiling probability of different oil types this study presents the first attempt to determine oiling probabilities in the bosphorus through a realistic hydrodynamic model and stochastic assessment the outputs of this study can help decision makers to formulate effective response and conservation strategies in the bosphorus a highly populated area and a busy shipping lane besides this study s models can be used in hindcasting or forecasting trajectories of specific oil accidents in further studies the time of simulation should be extended to account for the inter annual variability of current and wind fields the mass of the oil particles should be included in oiling probability calculations the vulnerability of the coastal environment to oil pollution also could be classified to support risk management credit authorship contribution statement şehriban saçu conceptualization methodology software validation resources data curation writing original draft visualization olgay şen conceptualization methodology software resources data curation visualization writing review editing tarkan erdik writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study was supported by istanbul technical university scientific research project coordination unit itu bap with grant number 42543 the authors would like to thank two anonymous reviewers for their constructive and thoughtful comments on our manuscript which helped us to improve it substantially 
