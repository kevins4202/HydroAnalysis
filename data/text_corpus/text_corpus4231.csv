index,text
21155,this article proposes a new formalism for the dynamic modeling of a cable towing system in which both the tugboat and the towed vessel are subject to forces from waves on the sea surface the continuous flexibility of the cable is approximated by a discrete equivalent formed by rigid links connected by fictitious elastic joints that allow elevation movements since the dynamics are restricted to the vertical plane the euler lagrange formalism was used to determine the dynamic models considering two three and four links the growth patterns of the differential equations of the models were found thus allowing the development of generic algorithms capable of generating dynamic models considering any number of links vertical forces obtained from proportional and derivative control were applied to the tugboat and the towed vessel thus simulating the wave motion of the sea surface simultaneously a motor thrust is applied to the tugboat an algorithmic procedure is also proposed to determine the dynamic tension in the cable simulation results showed dynamic responses as physically expected computer animations made from simulation data show a great sense of physical reality keywords towing system cable dynamic modeling cable s dynamic tension 1 introduction the significant growth in applications involving flexible cable type structures has been observed mainly in the offshore oil exploration industry fig 1 and this is one of the main reasons for the increase in scientific papers on cable modeling finite elements are widely used in cable modeling including dynamic and static analysis fang et al 2012 proposed a new finite element method to modeling cable deformation in towed system using cubic spline interpolation functions bamdad 2013 proposed an analytical solution for the dynamics of manipulators suspended by cables bi et al 2013 applies the finite element method to study the tensions present in submarine umbilical cables eidsvik and schjølberg 2018 presented a novel three dimensional cable model for remotely operated vehicles using euler bernoulli beam theory with the resulting equations discretized spatially by finite elements some authors use other methods to study the dynamics of cables masciola et al 2012 study a solution method for the cable static configuration from a discrete approximation liu et al 2013 study dynamic characteristics of cables in transmission lines based on the lagrangian formulation guo et al 2016 studied the influence of cable support on the dynamics of the cable itself considering that the support has mass stiffness and friction known zhu and yoo 2017 propose a new element reference frame for the lumped mass model by which the dynamics of marine cables can be analyzed efficiently vu et al 2017 propose to use the catenary equation method to identify the efforts applied by the cable in an underwater vehicle gonzález et al 2017 proposed two new simulation methods based on simplified cable models for real time simulation of fast cable pay out and reel in manoeuvres with towed fishing gears the main subject of this article is the towing of vessels and thus some articles involving cable modeling in the context of this application were consulted buckham et al 2003 describe the development of a numerical model that accurately captures the dynamics of the mine hunting systems and use lumped mass approximation for the tow cable sun et al 2011 has introduced a new nodal position finite element method to cable towed body modeling central implicit finite difference method is used by srivastava 2014 to solve a three dimensional model of underwater towed system yuan et al 2014 use finite difference method for solving the nonlinear dynamic equations of the towed system including gains in terms of computational efficiency park and kim 2015 introduced an absolute nodal coordinate formulation to modeling a towing cable and showed simulation results finite difference method is used by wang and sun 2015 to integrate the differential equations of a cable towing system dynamics as well as showed a study on the influence of some parameters on the dynamic behavior of the model lumped mass is also used by gao and wang 2018 to simulate a towing cable system du et al 2019 used the lumped mass approach to modeling a sonar tow cable and showed simulations that included the effects of hydrodynamic drag sun et al 2019 proposed a tug cable barge coupling motion model for bridle towed system using finite differences to perform numerical simulations in this article is presented a new method for the dynamic modeling of vessel towing systems consisting of a cable and two masses at its ends tugboat and towed vessel the cable is modeled using a discrete formalism similar to that used by gomes et al 2016 however in the present case the cable has its ends connected to platforms that can move vertically and horizontally disturbances arising from the wave motion on the sea surface are also considered another important contribution is the proposal of an algorithm for determining the dynamic tension in the cable as will be exposed the results are impressive due to their realism especially when viewed in computer animations 2 cable dynamic modeling in the present work a discrete formalism is used for dynamic cable modeling fig 2 illustrates the main idea of the method it is assumed that the cable is approximated by n e rigid links l i i 1 n e connected by fictitious elastic joints and each of these joints has an associated elastic constant and friction coefficient k i a n d c i i 1 n e mass of each link m i are considered to be concentrated in their respective centers of mass the cable is connected at its ends to two vessels as shown in fig 2 the tugboat m t and the towed vessel m v the elevation angles θ i are taken with respect to the vertical and the gravity sense coincides with the positive sense of the y axis the following forces act on the vessels f t is the motor thrust horizontally applied to the tugboat f h t is the hydrodynamic drag applied to the tugboat f y t is the force that the sea surface exerts vertically on the tugboat f y v is the force that the sea surface exerts vertically on the towed vessel f h v is the hydrodynamic drag applied to the towed vessel it is assumed that the centers of mass x i y i of the links are concentrated in their respective geometric centers so that the following equations can be easily obtained i 1 n e 1 x i x v l i 2 sin θ i j 1 i 1 l j sin θ j 2 y i y v l i 2 cos θ i j 1 i 1 l j cos θ j 3 x t x v j 1 n e l j sin θ j 4 y t y v j 1 n e l j cos θ j where x t y t and x v y v are the coordinates of the tugboat and the towed vessel respectively hydrodynamic drag forces are assumed to have the forms 5 f h v γ 1 γ 2 x v x v 6 f h t β 1 β 2 x t x t whose coefficients γ i and β i i 1 2 are supposedly known the forces that the sea surface exerts on vessels are defined in the following ways 7 f y t k p t y r t y t k d t y r t y t 8 f y v k p v y r v y v k d v y r v y v y r t and y r v correspond to the waves of the sea surface in relation to its average level in the tugboat and towed vessel positions respectively these sea waves will be defined as sinusoidal later obviously they will be null if the sea is considered without wave motion equations 7 and 8 constitute a proportional and derivative control pd whose objective is to make the vessels remain on the sea surface and follow their natural wave movements thereafter the constant gains k p t k d t k p v and k d v will be projected in order to achieve a pre established performance the system is a chain of rigid polyarticulated bodies with all known position coordinates equation 1 to 4 as well as their respective time derivatives the kinetic energy is due to translation and rotation movements and is defined as 9 e c 1 2 m v x v 2 y v 2 1 2 m t x t 2 y t 2 1 2 i 1 n e m i x i 2 y i 2 i r i θ i 2 the rotational moments of inertia of each link are defined as i r i m i 12 l i 2 i 1 n e the potential energy is due to elastic and gravitational effects and can be written in the form 10 e p i 1 n e 1 2 k i θ i θ i 1 2 m i g y v l i 2 1 cos θ i j 1 i 1 l j 1 cos θ j with θ 0 0 considering equations 1 4 as well as their time derivatives and equations 9 and 10 the system s lagrangian l e c e p can be obtained in a generic form equation 11 written in terms of r and r with r y v x v θ 1 θ 2 θ n e t in this case the system has n n e 2 degrees of freedom 11 l 1 2 m v x v 2 y v 2 1 2 m t x v j 1 n e l j c o s θ j θ j 2 y v j 1 n e l j s i n θ j θ j 2 1 2 i 1 n e m i x v l i 2 c o s θ i θ i j 1 i 1 l j cos θ j θ j 2 y v l i 2 sin θ i θ i j 1 i 1 l j sin θ j θ j 2 i r i θ i 2 i 1 n e 1 2 k i θ i θ i 1 2 m i g y v l i 2 1 cos θ i j 1 i 1 l j 1 cos θ j for example if only three links are considered n e 3 and equation 11 can generate equation 12 12 l 1 2 m v m 1 m 2 m 3 m t x v 2 y v 2 m 1 2 m 2 m 3 m t l 1 θ 1 x v cos θ 1 y v sin θ 1 m 1 8 m 2 2 m 3 2 m t 2 l 1 2 θ 1 2 m 2 2 m 3 m t l 2 θ 2 x v c o s θ 2 y v s i n θ 2 m 2 2 m 3 m t l 1 l 2 cos θ 1 θ 2 θ 1 θ 2 m 2 8 m 3 2 m t 2 l 2 2 θ 2 2 m 3 2 m t l 2 l 3 c o s θ 2 θ 3 θ 2 θ 3 m 3 8 m t 2 l 3 2 θ 3 2 m 3 2 m t l 3 θ 3 x v c o s θ 3 y v s i n θ 3 m 3 2 m t l 1 l 3 c o s θ 1 θ 3 θ 1 θ 3 1 2 i r 1 θ 1 2 1 2 i r 2 θ 2 2 1 2 i r 3 θ 3 2 m 1 m 2 m 3 g y v m 1 2 m 2 m 3 g l 1 1 cos θ 1 m 2 2 m 3 g l 2 1 cos θ 2 m 2 2 g l 3 1 c o s θ 3 1 2 k 1 θ 1 2 1 2 k 2 θ 2 θ 1 2 1 2 k 3 θ 3 θ 2 2 as the vessels float on the sea surface the buoyancy is considered equal to its weight and this is equivalent to considering the masses of the vessels null only in the composition of the gravitational efforts when n e links are considered in the discrete approximation of continuous flexibility the system will have n n e 2 degrees of freedom the euler lagrange equations are applied to all n degrees of freedom thus determining the dynamic model which can be put in the form 13 i r r c r k r f r r g r t e i r is the inertia matrix c the friction coefficients matrix k the elastic constants matrix f r r the coriolis centrifuges vector g r the gravitational vector and t e the external efforts vector al matrices are n x n and vectors are n x 1 dynamic models have been developed considering two three and four links as in the case of equation 12 the lagrangian for cases two and four links were also determined as well as all matrices and vectors of the dynamic models tables 1 to 7 show the elements of the vectors and matrix for cases two and three links upper script t means transposed it is important to note that the term c 1 1 referring to the vertical movement of the towed vessel appears as null in the friction coefficients matrices because it has already been considered in the external force f y v and is equivalent to the constant gain k d v present in equation 8 it is observed that the matrices of friction coefficients and elastic constants have the same shape it is also important to note that the term k 1 1 referring to the vertical movement of the towed vessel appears as null in the elastic constants matrices because it has already been considered in the external force f y v and is equivalent to the constant gain k p v equation 8 the external forces applied to the tugboat f h t f t and f y t do not appear explicitly in the external effort vectors table 7 but contribute to the formation of external elevation torques τ i i 1 n e and the external component of f x v as explained in section 4 f y v and f x v are the vertical and horizontal forces applied to towed vessel respectively it is very important to note that as the number of links increases the determinant of the inertia matrix approaches zero making it difficult for the numerical integrator to present a stable solution to overcome this difficulty a mathematical artifice was used as explained below equation 13 can be rewritten in the form 14 j i r r j t e c r k r f r r g r j is a diagonal matrix of order n n e 2 with a high determinant 10 4 for example therefore one can isolate the vector of accelerations in the form 15 r j i r 1 j t e c r k r f r r g r the matlab ode45 routine was used for numerical integration of equation 15 in the function with the dynamic model j i r matrix is inverted instead of inverting only the inertia matrix i r this simple fact makes numerical simulation more stable when the dynamic model considers a large number of links in the discrete representation of continuous flexibility 3 generic algorithms the analytical development of the dynamic cable model equations for the cases of two three and four links allowed the identification of the growth patterns of the vectors and matrices of the models once identified these growth patterns allowed the generation of generic algorithms capable of automatically generating dynamic models for any number of links considered in the discreet approximation of the continuous flexibility of the cable inertia matrix i r is symmetric n order n n e 2 so that its generation algorithm 1 determines only the elements of the main diagonal and those above it algorithm 1 image 1 the matrices of elastic constants and friction coefficients have the same shape algorithm 2 the only difference is that there is no spring constant restricting the horizontal movement of the towed vessel k 2 2 0 while there is friction in this same movement c 2 2 c v x γ 1 as shown in tables 3 and 4 the second term of the gravitational vector g 2 algorithm 3 is related to the horizontal movement of the towed vessel and will always be null since evidently there are no gravitational efforts acting in relation to the horizontal direction the masses m v and m t do not appear in the term g 1 because their floating on the sea surface were considered equal to their weight forces algorithm 2 image 2 algorithm 3 image 3 it is observed that the first two elements of the corioli centrifuges vector algorithm 4 have the same characteristics just exchanging cosine for sine and this elements are related to the vertical and horizontal motion of the towed vessel algorithm 4 image 4 as explained earlier dynamic models were developed analytically using euler lagrange for 2 3 and 4 links the same models generated with the generic algorithms matched perfectly with those developed analytically we repeated the same comparison for 5 links and the result was the same in summary the algorithms are able to generate exactly the same dynamic model developed analytically by applying the euler lagrange formalism but with the great advantage of generating dynamic models regardless the number of links analytical manual development on the other hand is impractical for a number of links greater than six for example because the equations become too large 4 external forces the purpose of this section is to show how the external forces acting on the tugboat will act in the dynamic system generating forces and torques in the other masses of the system it is important to remember that the external forces acting on the towed vessel entered the euler lagrange equations and therefore their dynamic effects are naturally incorporated into the dynamical system as shown in fig 2 the external forces acting on the tugboat can be written in the form 16 f c f t f h t i f y t j f c x i f c y j at each instant of time the geometric configuration of the cable is known so that the torque that the external force f c exerts on the last fictitious joint can be obtained as 17 τ n e f t f h t l n cos θ n e f y t l n s i n θ n e it can be proved that to calculate the torques in the other fictitious joints it is necessary to multiply the external force successively by the cosine of the angle difference between two successive links as explained in the algorithm 5 algorithm 5 image 5 equations 17 and algorithm 5 show the elevation torques in the fictitious joints caused by the external forces acting on the tugboat equation 16 the force that moves the towed vessel horizontally is also caused by the external force on the tugboat more precisely by its horizontal component f c x f t f h t it can be demonstrated that the towing force f v t that the cable will transmit to the towed vessel is determined by the following algorithm algorithm 6 image 6 algorithm 6 could be represented by a single equation in the form 18 f v t f t f h t cos θ n e π 2 sin θ 1 i 1 n e 1 cos θ i 1 θ i the vertical forces acting on the tugboat f y t and on the towed vessel f y v were defined in equations 7 and 8 respectively the gains were defined based on the following control specification t s 1 s e ξ 0 9 corresponding to the stabilization time and damping ratio respectively in this way constant gains are calculated from the following equations 19 w n 4 ξ t s k p t m t w n 2 k p v m v w n 2 k d t 2 m t ξ w n k d v 2 m v ξ w n w n is the undamped natural frequency 5 simulations in the two simulations presented below the system is initially at rest in the spatial configuration shown in fig 2 with d 30 m and d 2 m a parabolic curve was considered for this initial spatial configuration of the cable in static equilibrium benedettini et al 1995 20 y x 4 d d x 1 d x 2 a motor thrust is applied to the tugboat so that its time derivative obeys a trapezoidal profile whose objective is to bring this motor thrust from zero to 320 000 n in 80 s after t 80 s the motor thrust remains constant and equal to f t 320000 n being canceled after t 115 s the total simulation time was 120 s the motor thrust applied as a function of time can be seen in fig 3 a the purpose of using this motor thrust profile is to ensure a smooth transition between the states not stretched and stretched for the cable for the first simulation wave movements of the sea surface were considered according to the following equations 21 y r v k 0 25 sin 0 5 π t k y r t k 0 25 sin 0 5 π t k with k 1 n p t number of points in the discrete time domain equation 21 correspond to vertical reference positions for the towed vessel y r v and tugboat y r t these equations and their time derivatives are replaced in equations 7 and 8 to generate the vertical forces that the sea exerts on the towed vessel and tugboat rewritten here for each discrete instant t k 22 f y t k k p t y r t k y t k k d t y r t k y t k 23 f y v k k p v y r v k y v k k d v y r v k y v k the physical parameters used to perform the simulations can be seen in table 8 fig 3 a 3b 3c and 3d show the motor thrust horizontal velocities a zoom in the vertical velocities and a zoom in the horizontal velocities respectively at first the cable is not stretched and only the tugboat moves the speed of the towed vessel becomes different from zero at time t 15 8 s when the shock occurs and the cable becomes stretched at this time the speed of the tugboat drops abruptly and then increases again along with the speed of the towed vessel one of the objectives of this type of simulation was to verify how the disturbances arising from the ripples of the sea surface fig 3 c interfere with the towing dynamics as can be seen in fig 3 d fluctuations in horizontal speeds appear even in a steady state and this occurs due to disturbances from waves on the sea surface software was developed that allows graphically animating the cable s spatial configuration from the overlapping of successive frames fig 4 to facilitate understanding graphic animation y position coordinate was multiplied by 1 in the software that generates the animation fig 4 was formed with frames captured from the graphic animation in the first row of frames these are time spaced at 1 6 s while in the other rows at 0 2 s as the tugboat slowly moves away from the towed vessel in the horizontal direction the cable approaches the stretched situation the frame marked in red shows the instant of shock at approximately 15 8 s when the cable becomes stretched during all the time both the tugboat and the towed vessel also move vertically following the wave motion of the sea surface in the simulation examples presented in this article we consider the two connecting points of the cable on the tugboat and the towed vessel on the same horizontal line however this is not a restriction imposed by the modeling formalism simulations carried out omitted here due to space limitations showed a good model behavior considering different height levels at these connection points a simulation similar to the previous one was carried out but without considering waves on the sea surface fig 5 a shows horizontal velocities and fig 5 b shows a zoom highlighting the stationary velocity response when the motor thrust is also constant comparing figs 3 d and 5b it is observed that the oscillations in the horizontal velocities occur only when waves are considered on the sea surface the effects of disturbances from waves on the sea surface can also be seen in the angular positions of the links fig 6 shows these positions for dynamics with 6a and without 6b waves on the sea surface note that between 15 8 and 115 s the cable becomes fully stretched and all angles are equal in the case of fig 6 b the angles are equal to pi 2 in that time interval while oscillating around π 2 in fig 6 a it is important to note that the period of these oscillations is half of the period of oscillations of the sea waves this happens because each peak positive or negative of the movement of the sea surface corresponds to a minimum in the horizontal speed due to the motor thrust in the tugboat projected in the direction of the stretched cable reach a minimum this same period is observed in the oscillations of fig 3 d in summary the period of oscillations seen in figs 3 d and 6a corresponds to half the period of oscillations seen in fig 3 c 6 dynamic cable tension the cable will be dynamically subject to two possible situations stretched and not stretched the way to calculate the dynamic tension in the cable changes radically in these two situations it is considered that the cable is initially at rest in the spatial configuration shown in fig 2 the span is d 30 m distance between tugboat and towed vessel and the sag is d 2 m the cable was considered to be in the not stretched situation if the distance between the tugboat and the towed vessel is less than 99 95 of the cable length in other words i f l c x t x v 0 015 m then the cable is not stretched l c is the cable length in this case the cable will only be subject to its own weight this strategy was adopted only for numerical reasons the cable will be fully stretched when the distance between the tugboat and the towed vessel is equal to the length of the cable however in the numerical calculation of this distance very small numerical variations can occur which could generate high frequency switching between the stretched and unstretched modes of the cable to avoid this a tolerance of 0 05 of the cable length was adopted it is considered that the tugboat slowly moves away from the towed vessel at the beginning of the movement so that d and d vary slowly d grows and d decreases almost statically thus the tension in the cable can be calculated as explained in the algorithm 7 more precisely in the first part of the algorithm n p t being the number of simulation time intervals and ρ 0 ρ g the linear density of the cable in n m when the cable is stretched the towing situation is established the cable tension can be obtained from the differential equation that describes the horizontal dynamic equilibrium in the towed vessel 24 m v x v f 0 f h v with f 0 equal to the force that the cable exerts on the towed vessel x v and x v are known from simulation data allowing the determination of f 0 as explained in the algorithm 7 it should be noted that in algorithm 7 a is the area of the cross section of the cable algorithm 7 image 7 the algorithm 7 was used to determine the cable tension from the simulations data with fig 7 a and without fig 7 b considering waves on the sea surface the tension is very small at the beginning because only the tugboat is in a very slow motion and thus the cable is not stretched and the tension is due to its own weight at 15 8 s the shock occurs when the cable becomes stretched causing high frequency oscillations in the dynamic tension which are quickly attenuated after this time the tension increases as well as the horizontal speed and motor thrust the visible oscillations in the horizontal speeds of the tugboat and the towed vessel fig 3 d also cause oscillations in tension as can be seen in fig 7 a these oscillations are related to the wave motion of the sea surface and have the same period as the oscillations seen in figs 6 a and 3d after 115 s the motor thrust on the tugboat is null and the tugboat decelerates enough for the cable to become not stretched and thus the tension drops abruptly 7 conclusions a new method for the dynamic modeling of cable towing systems has been proposed in this article in addition to the horizontal movement of the entire system the tugboat and the towed vessel were also considered to move vertically due to the wave motion of the sea surface qualitative analyzes of the simulation results indicate dynamic behavior that is quite consistent with what is physically expected it is important to explain that many simulations were carried out assuming different types of cable and the results remained stable and with dynamic responses as physically expected we found that the proposed modeling is indeed generic it applies to very flexible cables and also to cables with low flexibility the dynamic system consists of two masses tugboat and towed vessel connected to the ends of a cable the proposed generic algorithms allow the dynamic model to be generated automatically for any number of links in the discrete representation of the continuous flexibility of the cable this is very significant because the simulations are very realistic as demonstrated by graphic animations despite having the same discrete origin the proposed formalism is not equal to the classical lumped mass approach and this is important to note this is the euler lagrange formalism applied to a polyarticulated chain of rigid bodies as the number of links increases more discrete flexibility gets closer to continuous real case growth patterns dictate how nature s phenomena unfold however much of these patterns are still unknown to us the discrete approach proposed in the modeling formalism approximates the real continuous flexibility when increasing the number of links each new considered link increases the cable dynamics in one degree of freedom and its equations grow considerably in size and complexity it was possible to identify these growth patterns allowing the proposition of generic algorithms to automatically generate dynamic models for any number of links considered in discrete approximation the simulations presented were carried out considering twenty links and the graphic animations show behavior that is practically continuous another original contribution of this article is the algorithm to determine the dynamic tension in the cable the algorithm detects whether the cable is stretched or not and calculates the dynamic tension in these two situations this algorithm is applied to data from simulations and the results are very consistent physically in summary the main advantages of the proposed modeling formalism are it allows very realistic simulations it is relatively simple to interact with other dynamics such as vessels at cable s extremities the generic algorithms allow the automatic determination of the matrices and vectors of the dynamic model for any number of links allowing a good approximation between the discrete flexibility of the model with the continuous physical structure as future work it is intended to develop a speed control law for the tugboat such that a reference path is followed by imposing the condition of minimum tension in the cable with special attention to perform a smooth passage of the cable non stretched to the stretched condition credit authorship contribution statement samuel da silva gomes programming generic algorithms performing simulations sebastião cícero pinheiro gomes conceptualization supervision methodology writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data the following are the supplementary data related to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j oceaneng 2020 107653 
21155,this article proposes a new formalism for the dynamic modeling of a cable towing system in which both the tugboat and the towed vessel are subject to forces from waves on the sea surface the continuous flexibility of the cable is approximated by a discrete equivalent formed by rigid links connected by fictitious elastic joints that allow elevation movements since the dynamics are restricted to the vertical plane the euler lagrange formalism was used to determine the dynamic models considering two three and four links the growth patterns of the differential equations of the models were found thus allowing the development of generic algorithms capable of generating dynamic models considering any number of links vertical forces obtained from proportional and derivative control were applied to the tugboat and the towed vessel thus simulating the wave motion of the sea surface simultaneously a motor thrust is applied to the tugboat an algorithmic procedure is also proposed to determine the dynamic tension in the cable simulation results showed dynamic responses as physically expected computer animations made from simulation data show a great sense of physical reality keywords towing system cable dynamic modeling cable s dynamic tension 1 introduction the significant growth in applications involving flexible cable type structures has been observed mainly in the offshore oil exploration industry fig 1 and this is one of the main reasons for the increase in scientific papers on cable modeling finite elements are widely used in cable modeling including dynamic and static analysis fang et al 2012 proposed a new finite element method to modeling cable deformation in towed system using cubic spline interpolation functions bamdad 2013 proposed an analytical solution for the dynamics of manipulators suspended by cables bi et al 2013 applies the finite element method to study the tensions present in submarine umbilical cables eidsvik and schjølberg 2018 presented a novel three dimensional cable model for remotely operated vehicles using euler bernoulli beam theory with the resulting equations discretized spatially by finite elements some authors use other methods to study the dynamics of cables masciola et al 2012 study a solution method for the cable static configuration from a discrete approximation liu et al 2013 study dynamic characteristics of cables in transmission lines based on the lagrangian formulation guo et al 2016 studied the influence of cable support on the dynamics of the cable itself considering that the support has mass stiffness and friction known zhu and yoo 2017 propose a new element reference frame for the lumped mass model by which the dynamics of marine cables can be analyzed efficiently vu et al 2017 propose to use the catenary equation method to identify the efforts applied by the cable in an underwater vehicle gonzález et al 2017 proposed two new simulation methods based on simplified cable models for real time simulation of fast cable pay out and reel in manoeuvres with towed fishing gears the main subject of this article is the towing of vessels and thus some articles involving cable modeling in the context of this application were consulted buckham et al 2003 describe the development of a numerical model that accurately captures the dynamics of the mine hunting systems and use lumped mass approximation for the tow cable sun et al 2011 has introduced a new nodal position finite element method to cable towed body modeling central implicit finite difference method is used by srivastava 2014 to solve a three dimensional model of underwater towed system yuan et al 2014 use finite difference method for solving the nonlinear dynamic equations of the towed system including gains in terms of computational efficiency park and kim 2015 introduced an absolute nodal coordinate formulation to modeling a towing cable and showed simulation results finite difference method is used by wang and sun 2015 to integrate the differential equations of a cable towing system dynamics as well as showed a study on the influence of some parameters on the dynamic behavior of the model lumped mass is also used by gao and wang 2018 to simulate a towing cable system du et al 2019 used the lumped mass approach to modeling a sonar tow cable and showed simulations that included the effects of hydrodynamic drag sun et al 2019 proposed a tug cable barge coupling motion model for bridle towed system using finite differences to perform numerical simulations in this article is presented a new method for the dynamic modeling of vessel towing systems consisting of a cable and two masses at its ends tugboat and towed vessel the cable is modeled using a discrete formalism similar to that used by gomes et al 2016 however in the present case the cable has its ends connected to platforms that can move vertically and horizontally disturbances arising from the wave motion on the sea surface are also considered another important contribution is the proposal of an algorithm for determining the dynamic tension in the cable as will be exposed the results are impressive due to their realism especially when viewed in computer animations 2 cable dynamic modeling in the present work a discrete formalism is used for dynamic cable modeling fig 2 illustrates the main idea of the method it is assumed that the cable is approximated by n e rigid links l i i 1 n e connected by fictitious elastic joints and each of these joints has an associated elastic constant and friction coefficient k i a n d c i i 1 n e mass of each link m i are considered to be concentrated in their respective centers of mass the cable is connected at its ends to two vessels as shown in fig 2 the tugboat m t and the towed vessel m v the elevation angles θ i are taken with respect to the vertical and the gravity sense coincides with the positive sense of the y axis the following forces act on the vessels f t is the motor thrust horizontally applied to the tugboat f h t is the hydrodynamic drag applied to the tugboat f y t is the force that the sea surface exerts vertically on the tugboat f y v is the force that the sea surface exerts vertically on the towed vessel f h v is the hydrodynamic drag applied to the towed vessel it is assumed that the centers of mass x i y i of the links are concentrated in their respective geometric centers so that the following equations can be easily obtained i 1 n e 1 x i x v l i 2 sin θ i j 1 i 1 l j sin θ j 2 y i y v l i 2 cos θ i j 1 i 1 l j cos θ j 3 x t x v j 1 n e l j sin θ j 4 y t y v j 1 n e l j cos θ j where x t y t and x v y v are the coordinates of the tugboat and the towed vessel respectively hydrodynamic drag forces are assumed to have the forms 5 f h v γ 1 γ 2 x v x v 6 f h t β 1 β 2 x t x t whose coefficients γ i and β i i 1 2 are supposedly known the forces that the sea surface exerts on vessels are defined in the following ways 7 f y t k p t y r t y t k d t y r t y t 8 f y v k p v y r v y v k d v y r v y v y r t and y r v correspond to the waves of the sea surface in relation to its average level in the tugboat and towed vessel positions respectively these sea waves will be defined as sinusoidal later obviously they will be null if the sea is considered without wave motion equations 7 and 8 constitute a proportional and derivative control pd whose objective is to make the vessels remain on the sea surface and follow their natural wave movements thereafter the constant gains k p t k d t k p v and k d v will be projected in order to achieve a pre established performance the system is a chain of rigid polyarticulated bodies with all known position coordinates equation 1 to 4 as well as their respective time derivatives the kinetic energy is due to translation and rotation movements and is defined as 9 e c 1 2 m v x v 2 y v 2 1 2 m t x t 2 y t 2 1 2 i 1 n e m i x i 2 y i 2 i r i θ i 2 the rotational moments of inertia of each link are defined as i r i m i 12 l i 2 i 1 n e the potential energy is due to elastic and gravitational effects and can be written in the form 10 e p i 1 n e 1 2 k i θ i θ i 1 2 m i g y v l i 2 1 cos θ i j 1 i 1 l j 1 cos θ j with θ 0 0 considering equations 1 4 as well as their time derivatives and equations 9 and 10 the system s lagrangian l e c e p can be obtained in a generic form equation 11 written in terms of r and r with r y v x v θ 1 θ 2 θ n e t in this case the system has n n e 2 degrees of freedom 11 l 1 2 m v x v 2 y v 2 1 2 m t x v j 1 n e l j c o s θ j θ j 2 y v j 1 n e l j s i n θ j θ j 2 1 2 i 1 n e m i x v l i 2 c o s θ i θ i j 1 i 1 l j cos θ j θ j 2 y v l i 2 sin θ i θ i j 1 i 1 l j sin θ j θ j 2 i r i θ i 2 i 1 n e 1 2 k i θ i θ i 1 2 m i g y v l i 2 1 cos θ i j 1 i 1 l j 1 cos θ j for example if only three links are considered n e 3 and equation 11 can generate equation 12 12 l 1 2 m v m 1 m 2 m 3 m t x v 2 y v 2 m 1 2 m 2 m 3 m t l 1 θ 1 x v cos θ 1 y v sin θ 1 m 1 8 m 2 2 m 3 2 m t 2 l 1 2 θ 1 2 m 2 2 m 3 m t l 2 θ 2 x v c o s θ 2 y v s i n θ 2 m 2 2 m 3 m t l 1 l 2 cos θ 1 θ 2 θ 1 θ 2 m 2 8 m 3 2 m t 2 l 2 2 θ 2 2 m 3 2 m t l 2 l 3 c o s θ 2 θ 3 θ 2 θ 3 m 3 8 m t 2 l 3 2 θ 3 2 m 3 2 m t l 3 θ 3 x v c o s θ 3 y v s i n θ 3 m 3 2 m t l 1 l 3 c o s θ 1 θ 3 θ 1 θ 3 1 2 i r 1 θ 1 2 1 2 i r 2 θ 2 2 1 2 i r 3 θ 3 2 m 1 m 2 m 3 g y v m 1 2 m 2 m 3 g l 1 1 cos θ 1 m 2 2 m 3 g l 2 1 cos θ 2 m 2 2 g l 3 1 c o s θ 3 1 2 k 1 θ 1 2 1 2 k 2 θ 2 θ 1 2 1 2 k 3 θ 3 θ 2 2 as the vessels float on the sea surface the buoyancy is considered equal to its weight and this is equivalent to considering the masses of the vessels null only in the composition of the gravitational efforts when n e links are considered in the discrete approximation of continuous flexibility the system will have n n e 2 degrees of freedom the euler lagrange equations are applied to all n degrees of freedom thus determining the dynamic model which can be put in the form 13 i r r c r k r f r r g r t e i r is the inertia matrix c the friction coefficients matrix k the elastic constants matrix f r r the coriolis centrifuges vector g r the gravitational vector and t e the external efforts vector al matrices are n x n and vectors are n x 1 dynamic models have been developed considering two three and four links as in the case of equation 12 the lagrangian for cases two and four links were also determined as well as all matrices and vectors of the dynamic models tables 1 to 7 show the elements of the vectors and matrix for cases two and three links upper script t means transposed it is important to note that the term c 1 1 referring to the vertical movement of the towed vessel appears as null in the friction coefficients matrices because it has already been considered in the external force f y v and is equivalent to the constant gain k d v present in equation 8 it is observed that the matrices of friction coefficients and elastic constants have the same shape it is also important to note that the term k 1 1 referring to the vertical movement of the towed vessel appears as null in the elastic constants matrices because it has already been considered in the external force f y v and is equivalent to the constant gain k p v equation 8 the external forces applied to the tugboat f h t f t and f y t do not appear explicitly in the external effort vectors table 7 but contribute to the formation of external elevation torques τ i i 1 n e and the external component of f x v as explained in section 4 f y v and f x v are the vertical and horizontal forces applied to towed vessel respectively it is very important to note that as the number of links increases the determinant of the inertia matrix approaches zero making it difficult for the numerical integrator to present a stable solution to overcome this difficulty a mathematical artifice was used as explained below equation 13 can be rewritten in the form 14 j i r r j t e c r k r f r r g r j is a diagonal matrix of order n n e 2 with a high determinant 10 4 for example therefore one can isolate the vector of accelerations in the form 15 r j i r 1 j t e c r k r f r r g r the matlab ode45 routine was used for numerical integration of equation 15 in the function with the dynamic model j i r matrix is inverted instead of inverting only the inertia matrix i r this simple fact makes numerical simulation more stable when the dynamic model considers a large number of links in the discrete representation of continuous flexibility 3 generic algorithms the analytical development of the dynamic cable model equations for the cases of two three and four links allowed the identification of the growth patterns of the vectors and matrices of the models once identified these growth patterns allowed the generation of generic algorithms capable of automatically generating dynamic models for any number of links considered in the discreet approximation of the continuous flexibility of the cable inertia matrix i r is symmetric n order n n e 2 so that its generation algorithm 1 determines only the elements of the main diagonal and those above it algorithm 1 image 1 the matrices of elastic constants and friction coefficients have the same shape algorithm 2 the only difference is that there is no spring constant restricting the horizontal movement of the towed vessel k 2 2 0 while there is friction in this same movement c 2 2 c v x γ 1 as shown in tables 3 and 4 the second term of the gravitational vector g 2 algorithm 3 is related to the horizontal movement of the towed vessel and will always be null since evidently there are no gravitational efforts acting in relation to the horizontal direction the masses m v and m t do not appear in the term g 1 because their floating on the sea surface were considered equal to their weight forces algorithm 2 image 2 algorithm 3 image 3 it is observed that the first two elements of the corioli centrifuges vector algorithm 4 have the same characteristics just exchanging cosine for sine and this elements are related to the vertical and horizontal motion of the towed vessel algorithm 4 image 4 as explained earlier dynamic models were developed analytically using euler lagrange for 2 3 and 4 links the same models generated with the generic algorithms matched perfectly with those developed analytically we repeated the same comparison for 5 links and the result was the same in summary the algorithms are able to generate exactly the same dynamic model developed analytically by applying the euler lagrange formalism but with the great advantage of generating dynamic models regardless the number of links analytical manual development on the other hand is impractical for a number of links greater than six for example because the equations become too large 4 external forces the purpose of this section is to show how the external forces acting on the tugboat will act in the dynamic system generating forces and torques in the other masses of the system it is important to remember that the external forces acting on the towed vessel entered the euler lagrange equations and therefore their dynamic effects are naturally incorporated into the dynamical system as shown in fig 2 the external forces acting on the tugboat can be written in the form 16 f c f t f h t i f y t j f c x i f c y j at each instant of time the geometric configuration of the cable is known so that the torque that the external force f c exerts on the last fictitious joint can be obtained as 17 τ n e f t f h t l n cos θ n e f y t l n s i n θ n e it can be proved that to calculate the torques in the other fictitious joints it is necessary to multiply the external force successively by the cosine of the angle difference between two successive links as explained in the algorithm 5 algorithm 5 image 5 equations 17 and algorithm 5 show the elevation torques in the fictitious joints caused by the external forces acting on the tugboat equation 16 the force that moves the towed vessel horizontally is also caused by the external force on the tugboat more precisely by its horizontal component f c x f t f h t it can be demonstrated that the towing force f v t that the cable will transmit to the towed vessel is determined by the following algorithm algorithm 6 image 6 algorithm 6 could be represented by a single equation in the form 18 f v t f t f h t cos θ n e π 2 sin θ 1 i 1 n e 1 cos θ i 1 θ i the vertical forces acting on the tugboat f y t and on the towed vessel f y v were defined in equations 7 and 8 respectively the gains were defined based on the following control specification t s 1 s e ξ 0 9 corresponding to the stabilization time and damping ratio respectively in this way constant gains are calculated from the following equations 19 w n 4 ξ t s k p t m t w n 2 k p v m v w n 2 k d t 2 m t ξ w n k d v 2 m v ξ w n w n is the undamped natural frequency 5 simulations in the two simulations presented below the system is initially at rest in the spatial configuration shown in fig 2 with d 30 m and d 2 m a parabolic curve was considered for this initial spatial configuration of the cable in static equilibrium benedettini et al 1995 20 y x 4 d d x 1 d x 2 a motor thrust is applied to the tugboat so that its time derivative obeys a trapezoidal profile whose objective is to bring this motor thrust from zero to 320 000 n in 80 s after t 80 s the motor thrust remains constant and equal to f t 320000 n being canceled after t 115 s the total simulation time was 120 s the motor thrust applied as a function of time can be seen in fig 3 a the purpose of using this motor thrust profile is to ensure a smooth transition between the states not stretched and stretched for the cable for the first simulation wave movements of the sea surface were considered according to the following equations 21 y r v k 0 25 sin 0 5 π t k y r t k 0 25 sin 0 5 π t k with k 1 n p t number of points in the discrete time domain equation 21 correspond to vertical reference positions for the towed vessel y r v and tugboat y r t these equations and their time derivatives are replaced in equations 7 and 8 to generate the vertical forces that the sea exerts on the towed vessel and tugboat rewritten here for each discrete instant t k 22 f y t k k p t y r t k y t k k d t y r t k y t k 23 f y v k k p v y r v k y v k k d v y r v k y v k the physical parameters used to perform the simulations can be seen in table 8 fig 3 a 3b 3c and 3d show the motor thrust horizontal velocities a zoom in the vertical velocities and a zoom in the horizontal velocities respectively at first the cable is not stretched and only the tugboat moves the speed of the towed vessel becomes different from zero at time t 15 8 s when the shock occurs and the cable becomes stretched at this time the speed of the tugboat drops abruptly and then increases again along with the speed of the towed vessel one of the objectives of this type of simulation was to verify how the disturbances arising from the ripples of the sea surface fig 3 c interfere with the towing dynamics as can be seen in fig 3 d fluctuations in horizontal speeds appear even in a steady state and this occurs due to disturbances from waves on the sea surface software was developed that allows graphically animating the cable s spatial configuration from the overlapping of successive frames fig 4 to facilitate understanding graphic animation y position coordinate was multiplied by 1 in the software that generates the animation fig 4 was formed with frames captured from the graphic animation in the first row of frames these are time spaced at 1 6 s while in the other rows at 0 2 s as the tugboat slowly moves away from the towed vessel in the horizontal direction the cable approaches the stretched situation the frame marked in red shows the instant of shock at approximately 15 8 s when the cable becomes stretched during all the time both the tugboat and the towed vessel also move vertically following the wave motion of the sea surface in the simulation examples presented in this article we consider the two connecting points of the cable on the tugboat and the towed vessel on the same horizontal line however this is not a restriction imposed by the modeling formalism simulations carried out omitted here due to space limitations showed a good model behavior considering different height levels at these connection points a simulation similar to the previous one was carried out but without considering waves on the sea surface fig 5 a shows horizontal velocities and fig 5 b shows a zoom highlighting the stationary velocity response when the motor thrust is also constant comparing figs 3 d and 5b it is observed that the oscillations in the horizontal velocities occur only when waves are considered on the sea surface the effects of disturbances from waves on the sea surface can also be seen in the angular positions of the links fig 6 shows these positions for dynamics with 6a and without 6b waves on the sea surface note that between 15 8 and 115 s the cable becomes fully stretched and all angles are equal in the case of fig 6 b the angles are equal to pi 2 in that time interval while oscillating around π 2 in fig 6 a it is important to note that the period of these oscillations is half of the period of oscillations of the sea waves this happens because each peak positive or negative of the movement of the sea surface corresponds to a minimum in the horizontal speed due to the motor thrust in the tugboat projected in the direction of the stretched cable reach a minimum this same period is observed in the oscillations of fig 3 d in summary the period of oscillations seen in figs 3 d and 6a corresponds to half the period of oscillations seen in fig 3 c 6 dynamic cable tension the cable will be dynamically subject to two possible situations stretched and not stretched the way to calculate the dynamic tension in the cable changes radically in these two situations it is considered that the cable is initially at rest in the spatial configuration shown in fig 2 the span is d 30 m distance between tugboat and towed vessel and the sag is d 2 m the cable was considered to be in the not stretched situation if the distance between the tugboat and the towed vessel is less than 99 95 of the cable length in other words i f l c x t x v 0 015 m then the cable is not stretched l c is the cable length in this case the cable will only be subject to its own weight this strategy was adopted only for numerical reasons the cable will be fully stretched when the distance between the tugboat and the towed vessel is equal to the length of the cable however in the numerical calculation of this distance very small numerical variations can occur which could generate high frequency switching between the stretched and unstretched modes of the cable to avoid this a tolerance of 0 05 of the cable length was adopted it is considered that the tugboat slowly moves away from the towed vessel at the beginning of the movement so that d and d vary slowly d grows and d decreases almost statically thus the tension in the cable can be calculated as explained in the algorithm 7 more precisely in the first part of the algorithm n p t being the number of simulation time intervals and ρ 0 ρ g the linear density of the cable in n m when the cable is stretched the towing situation is established the cable tension can be obtained from the differential equation that describes the horizontal dynamic equilibrium in the towed vessel 24 m v x v f 0 f h v with f 0 equal to the force that the cable exerts on the towed vessel x v and x v are known from simulation data allowing the determination of f 0 as explained in the algorithm 7 it should be noted that in algorithm 7 a is the area of the cross section of the cable algorithm 7 image 7 the algorithm 7 was used to determine the cable tension from the simulations data with fig 7 a and without fig 7 b considering waves on the sea surface the tension is very small at the beginning because only the tugboat is in a very slow motion and thus the cable is not stretched and the tension is due to its own weight at 15 8 s the shock occurs when the cable becomes stretched causing high frequency oscillations in the dynamic tension which are quickly attenuated after this time the tension increases as well as the horizontal speed and motor thrust the visible oscillations in the horizontal speeds of the tugboat and the towed vessel fig 3 d also cause oscillations in tension as can be seen in fig 7 a these oscillations are related to the wave motion of the sea surface and have the same period as the oscillations seen in figs 6 a and 3d after 115 s the motor thrust on the tugboat is null and the tugboat decelerates enough for the cable to become not stretched and thus the tension drops abruptly 7 conclusions a new method for the dynamic modeling of cable towing systems has been proposed in this article in addition to the horizontal movement of the entire system the tugboat and the towed vessel were also considered to move vertically due to the wave motion of the sea surface qualitative analyzes of the simulation results indicate dynamic behavior that is quite consistent with what is physically expected it is important to explain that many simulations were carried out assuming different types of cable and the results remained stable and with dynamic responses as physically expected we found that the proposed modeling is indeed generic it applies to very flexible cables and also to cables with low flexibility the dynamic system consists of two masses tugboat and towed vessel connected to the ends of a cable the proposed generic algorithms allow the dynamic model to be generated automatically for any number of links in the discrete representation of the continuous flexibility of the cable this is very significant because the simulations are very realistic as demonstrated by graphic animations despite having the same discrete origin the proposed formalism is not equal to the classical lumped mass approach and this is important to note this is the euler lagrange formalism applied to a polyarticulated chain of rigid bodies as the number of links increases more discrete flexibility gets closer to continuous real case growth patterns dictate how nature s phenomena unfold however much of these patterns are still unknown to us the discrete approach proposed in the modeling formalism approximates the real continuous flexibility when increasing the number of links each new considered link increases the cable dynamics in one degree of freedom and its equations grow considerably in size and complexity it was possible to identify these growth patterns allowing the proposition of generic algorithms to automatically generate dynamic models for any number of links considered in discrete approximation the simulations presented were carried out considering twenty links and the graphic animations show behavior that is practically continuous another original contribution of this article is the algorithm to determine the dynamic tension in the cable the algorithm detects whether the cable is stretched or not and calculates the dynamic tension in these two situations this algorithm is applied to data from simulations and the results are very consistent physically in summary the main advantages of the proposed modeling formalism are it allows very realistic simulations it is relatively simple to interact with other dynamics such as vessels at cable s extremities the generic algorithms allow the automatic determination of the matrices and vectors of the dynamic model for any number of links allowing a good approximation between the discrete flexibility of the model with the continuous physical structure as future work it is intended to develop a speed control law for the tugboat such that a reference path is followed by imposing the condition of minimum tension in the cable with special attention to perform a smooth passage of the cable non stretched to the stretched condition credit authorship contribution statement samuel da silva gomes programming generic algorithms performing simulations sebastião cícero pinheiro gomes conceptualization supervision methodology writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data the following are the supplementary data related to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 appendix a supplementary data supplementary data related to this article can be found at https doi org 10 1016 j oceaneng 2020 107653 
21156,ships in ocean waves are suffered from cyclic wave loads which can cause fatigue damage to ship structures classification societies require owners to carry out fatigue assessment for ship structure for its potential great loss caused by fatigue failure currently there are many fatigue assessment methods including simplified method deterministic method spectral based method and time domain method but none of them predict fatigue life precisely and effectively based on linear superposition theory and the assumption that a linear relationship occurred between waves and ship structural response some scholars proposed the hybrid frequency time domain method this method avoids the imprecise narrow band approximation in spectral based method and adopts rainflow counting instead however the hybrid method is not applied extensively on ship fatigue assessment because relevant research is insufficient in this paper aiming to validate the hybrid method a segmented ship model test is carried out and the short term fatigue damages of a 4600teu container forecasted by hybrid method and traditional methods are compared results shows that the hybrid method forecasts the closest fatigue damage prediction to time domain analysis and owns enough efficiency but in some area located at midship hybrid method may predict lower fatigue damage than time domain method keywords ship fatigue assessment hybrid frequency time domain fatigue analysis segmented model test 1 introduction when a ship is sailing at sea ocean waves are considered as cyclic loads acting on the ship these loads may result in fatigue failure on ship structures with the increasment of ship tonnage and extensive use of high strength steel modern ship structures confront severe fatigue failure problems nowadays moe and storhaug storhaug et al 2007 storhaug and moe 2007 reported that fatigue cracks were found in many vessels serviced in the north atlantic and that in some containers only after less than 8 years of service time serious cracks appeared on the deck of these vessels haagensen et al 2014 documented the fatigue cracking occurred on the veslefrikk b platform and its maintenance history despite several repairs were made for the platform fatigue cracking was continuing many classifications such as dnv gl abs ccs provide fatigue assessment references dnv 2014 abs 2012 ccs 2013 currently fatigue assessment technique can be categorized as simplified method deterministic method and direct calculation method the simplified method uses the weibull probability distribution to describe the long term stress range distribution of ship structure components while deterministic method is some sort of a simplified version of spectral based method the main simplification of deterministic method is that it uses deterministic wave height and period to characterize a seastate rather than using short term wave spectrum e g neumann wave spectrum and pierson moskowitz wave spectrum more frequently these two simplified methods are used for local details and suit for urgent cases and because simplified methods based on empirical formulae lacks accuracy societies are likely to recommend the direct calculation method for global fatigue assessment as long as the designer have enough time and computational sources therefore the current work focused on the direct calculation method to perform the study currently direct calculation method is divided into time domain td method and frequency domain fd method a td can consider nonlinearities like slamming and whipping effect and can obtain the fatigue stress time history of structure under real seastates by simulating a series of seastates in hydrodynamic calculations these advantages though indeed improving the accuracy have burdened the computation according to li s comparative study li et al 2014 a td method will cost several hours while fd method takes less than 1 min for a 20 min duration of a seastate in fatigue analysis to reduce the computational time mohammdi et al mohammadi et al 2016 proposed a fatigue damage surface approximation method after combining his algorithm 94 of the simulated seastates are minimized due to the computational restrictions of td analysis classifications only recommend that applying td analysis to cases which contain high nonlinear properties and most generally in scientific researches using td analysis as a reference method as to practical cases fd methods are extensively used there are many kinds of fd methods the most classical spectral method uses rayleigh distribution to describe the short term distribution of the stress range and complete the counting by evaluating the zero up crossing frequency period but rayleigh distribution is only suitable for a narrow band irregularity factor γ 0 99 gaussian process while none of occurred seastates as well as the ship responses can be treated as narrow band processes mohammdi et al mohammadi et al 2016 had identified that the narrow band approximation nba used in spectral method is the most accountable source for the conservation norio and tomohiro takeda and naruse 2012 analyzed the stress amplitude probability density and damage distribution by dirlik method level crossing method and td method they found that both two spectral methods result more high stress amplitude which have very significant influence on damage distribution the improvements made for the spectral method are two main means modification for narrow band nb calculations and wide band wb calculations the former one includes dirlik formula rice formula and wirsching s wide band rainflow correction etc a practical case study made by wang wang 2010 has pointed out that different correction factors dirlik s rice s and wirsching s correction factor can only contribute 5 45 9 2 of the corrections compared with iacsr 56 which is negligible when comparing with the error from narrow band assumption based on dirlik formula norio and tomohiro takeda and naruse 2012 aim to eliminate the overestimated high stress amplitude proposed two adjustments constant adjustment and square error adjustment on the stress probability density applying the adjustments on dirlik method stress probability is in good accordance with td analysis another improvement is wb calculations in terms of a most representative wb progress the bimodal gaussian progress discretization method is the state of the art approach to make the discretization method more reliable gao et al gao and zheng 2019 proposed a parameter to describe the interaction of low frequency and high frequency in the discretized frequencies but such a discretization method requires abundant coefficients to join the calculation as well as a complex algorithm as aforementioned td analysis possesses the highest accuracy but requires abundant computational resources fd analysis is quick but due to that nba is not well solved the accuracy is not ideal for general engineering practices a suitable fatigue assessment method is needed scholars have proposed a hybrid method that combines fd and td analysis this hybrid method is based on linear wave theory and the assumption that linear relationship occurred between waves and ship structural response it considered the irregular stress time history as a superposition of a series of regular stress histories according to fourier transform relationship between fd and td the hybrid method uses the stress spectrum calculated in fd to reconstruct the stress time history this method which combines the advantages of the dynamic analysis conducted in the fd with the fatigue direct assessment criteria in td is efficient and accurate however it is still not applied on ship fatigue assessment extensively and lacks sufficient experimental verifications the primary objective of this paper is to verify the feasibility of the hybrid frequency time domain method in this paper the hybrid method was used to conduct a short term fatigue damage prediction on a container ship and compared with traditional methods in addition a segmented ship model test was also carried out to verify the accuracy of the numerical calculation the remainder of this paper is arranged as follows in section 2 procedures of the hybrid method and fatigue damage calculation are outlined in section 3 the segmented model test was introduced and kinds of data used in the hybrid method are compared a numerical case study is given in section 4 finally conclusions are presented in section 5 2 methodology 2 1 overview for an instinct view of the hybrid method a flow chart is shown in fig 1 as shown in the flow chart the hybrid method highlighted in the red box is a combination of fd and td analyses in terms of specific cases same with fd analysis the hybrid method obtains structural fatigue stresses stress psds through hydrodynamic calculations in fd and finite element fe analysis by applying inverse fast fourier transform ifft stress psds are transformed into stress time histories for each stress time history rainflow counting rfc is applied to obtain pairs of stress range and cycles based on s n curve and palmgren miner s damage linear accumulation rule fatigue damage can be assessed the hybrid method abandons time consuming hydrodynamic calculations in td and inaccurate nba in fd according to the relationship of hydrodynamic calculations between td and fd stress psd can use ifft to reconstruct the stress time history which can yield more accurate fatigue loads by rfc by adopting the advantages of td and fd the hybrid method can yield more accurate fatigue damage than traditional fd method with satisfied efficiency 2 2 frequency domain analysis in a spectral based method three main assumptions are established linear wave theory the irregular wave can be considered as a superposition of a series of component regular waves and its expected energy can be characterized by short term wave spectrum a linear relationship occurred between waves and ship structural response this assumption introduces transfer functions to describe the dynamic properties of the ship structure narrow band approximation nba stress range within each short term seastate is considered as rayleigh distribution and cycle count is according to zero up crossing period of short term structural stress responses while in the hybrid method this assumption is avoided based on the first linear wave theory an irregular wave time history a t can be considered as a superposition of a series of regular waves using fourier analysis 1 a t i 1 n a i cos k i x ω i t ε i where a i is the amplitude of the component regular wave i ω i k i and ε i are the wave frequency the wave number and the phase of the ith harmonic wave component respectively usually a stationary sea state is described by wave spectrum a wave spectrum s ω h s t z is a function of the wave frequency ω and associated with the significant wave height h s and the mean zero up crossing period t z it describes the energy of a short term sea state at different wave frequencies and for ith harmonic wave component in wave spectrum the amplitude a i is determined by 2 a i 2 s ω i δ ω where δ ω denotes the increment of ω in wave spectrum in a real sea condition waves are always directionally spreading which is called short crested wave in calculations cosine square or cosine quartic spreading functions are recommended by issc to conduct the short crested wave simulation another decisive assumption in frequency domain is the linear relationship between waves and ship structural response if a ship is regarded as a linear signal system then the total structural response under irregular waves can be regarded as a superposition of structural responses under regular component waves to simplify the response analysis transfer function is introduced a transfer function is the ratio of outputting to inputting for instance structural response to wave load in terms of fd analysis transfer functions are variant for different hotspots and heading angles and combining each seastates in wave scatter diagram and each individual transfer function short term response of the ship structure can be clarified the modulus of the transfer function response amplitude operators rao is regarded as a scale factor scaling the wave spectrum and the stress psd for a specific location can be obtained by eq 3 3 s σ ω h s t z θ r a o ω θ 2 s ω h s t z where ω is wave frequency θ is heading angle rao is the modulus of the transfer function related to θ s σ ω and s ω are stress psd and wave spectrum respectively for a sailing condition wave encounter frequency ω e is used to replace ω and calculated in eq 4 and therefore stress psd in ω and in ω e is transformed by eq 5 4 ω e ω ω 2 g v c o s θ 5 s σ ω ω s σ ω e ω e where v is the current velocity of the ship and g is gravity acceleration s σ ω and s σ ω e are stress psd in ω and in ω e for a specific spectrum s ω the characteristics of the spectrum are generally described by spectral parameters such as nth order spectral moment m n and zero up crossing frequency ν they are calculated by 6 m n ω ω n s ω d ω 7 ν 1 2 π m 2 m 0 in this paper wasim in hydrod dnv 2011a is applied in the current study and can complete the regular wave hydrodynamic calculations wasim can simulate the wave in arbitrary directions and uses cosine square to describe the short crested sea state also full 3d effect and geometric nonlinearity are considered in wasim which can improve the accuracy of the calculation results once the wave loads on the hull and sectional loads are obtained those loads are imported into sestra dnv 2011b to complete the fe analysis and calculation every specific rao 2 3 signal conversion the standard assumptions for a seastate under stationary conditions are that a t is a stationary and ergodic stochastic process with mean value assumed to be zero and with a spectral density s ω however a real seastate seldom supports the gaussian assumption but since the gaussian random process is well understood and can represent wave characteristics expressed by spectrum s ω it is common to simulate a gaussian process which bases on the wave characteristics of spectrum s ω to replace the real seastate and complete the wave analysis meanwhile according to the linear relationship occurred between waves and ship structural response it is reasonable to assume that the stress process acting on the structure is also a gaussian random process and characteristics of the process can be extracted from stress psd thus a stress psd can be used to reconstruct stress time history several algorithms are available in literatures for the signal reconstruction the most intuitive algorithm is based on the inverse fast fourier transform ifft it generates a finite number of harmonics components with different amplitudes frequencies and random phases hudspeth and borgman 1979 there are two method to complete the conversion random phase deterministic spectral amplitude dsa and the non deterministic spectral amplitude nsa wang and xia 2012 in dsa a stress process σ t simulated by spectrum is expressed as 8 σ t i 1 m a i cos ω i t ε i i 1 m 2 s σ ω i δ ω cos ω i t ε i where s σ denotes stress psd a i ω i and δ ω i are amplitude representative frequency and frequency interval of the ith component respectively ε i is random phase and distributes uniformly in 0 2π m denotes the total number of components fig 2 shows the schematic of dividing spectral frequency intervals it assumes that spectral energy mostly concentrates in frequency range between frequency lower limit ω l and upper limits ω u ω l and ω u can be calculated by setting a negligible energy ratio and integrating the spectrum the frequency range is divided into m intervals ω i and ω i is lower and upper limit of ith interval representative frequency of ith component ω i is chosen in range ω i ω i several methods are used to determine the frequency components but these methods may make the time history repeat periodically or ω i assemble around the spectral peak these drawbacks are avoided by the method proposed by du et al braccesi et al 2014 they divided the frequency range equally and chose ω i in the ith interval randomly unlike dsa using deterministic amplitude nsa is expressed as 9 σ t i 1 m a i cos ω i t ε a i b i sin ω i t ε b i where ε a i and ε b i are random phase similar with ε i amplitudes a i and b i are independent random variables with mean zero value and their standard deviations are given by 10 σ a i σ b i 2 s σ ω i δ ω but ifft generates in a random way the phases of the different harmonic wave components obviously by changing the phases sequence an infinite number of different time histories could be generated this will inevitably bring random errors braccesi et al 2014 investigated the relationship between the duration of a reconstructed time history and its statistical properties they used one spectrum to generate 300 simulated time histories including five different time durations and discussed the variations of two major properties of the process the root mean square and the number of peaks in the time unit they found that when the simulated time history is sufficiently long over 2000s in the reference random characteristics of the generated time history tend to be stable therefore random error can be neglected in the current study wafo tools in matlab are used to convert stress spectrum it adopts nsa method generates a gaussian process by summation of sinus function with random amplitudes and random phase angle and in this paper time duration of reconstruction is set as 1 h 2 4 accumulated fatigue damage for a stress time history to count the stress range and cycles thereof rainflow counting method rfc is commonly used matsuishi and endo 1968 rfc identifies the local maximum and pairs the local maximum with the local minimum to form a hysteresis loop repeatedly then counts the loops this procedure allows rfc count the big circulations without ignoring smaller circulations rfc is extensively accepted to yield the best representation of the cyclic stress strain behavior of material and is considered as a scientific and the most accurate counting method when pairs of stress range and cycle are obtained based on palmgren miner linear damage cumulative rule and s n curve method the damage in a specific seastate can be calculated as follows 11 d i j n j s j m a where d i is fatigue damage cumulated in i seastate n j denotes the number of cycles that the structure endures at stress range s j during i seastate a and m are material parameter of the s n curve and the total damage d can be obtained by 12 d i d i in the current study wafo in matlab is adopted to perform the rainflow counting and complete the damage accumulation calculation additionally considering the characteristics for every hotspot some correction factories are in consideration they are stress concentration factor k k is the ratio of hotspot stress σ h o t s p o t and nominal stress σ n o m i n a l and is obtained by multiplication of k factors arising from different causes as the following equation 13 k σ h o t s p o t σ n o m i n a l k g k t e k t α k n where k g denotes stress concentration factor due to the gross geometry of the considered detail k t e denotes additional stress concentration factor due to eccentricity tolerance k t α denotes additional stress concentration factor due to angular mismatch and k n denotes that for unsymmetrical stiffeners on laterally loaded panels thickness correction because at the thick plate welded joints initial defects exist and decrease the continuity of the structure and for the reason that those locations usually adopt high tensile strength steel the effect of energy absorption of structural plastic deformation is restrained by high yield strength therefore for a hotspot that thickness larger than 25 mm the s n curve is modified by 14 l o g n l o g a m 4 l o g t h 25 m l o g s where t h denotes the thickness of hotspot n a m s denote parameters of s n curves 3 verification 3 1 subject description in the current study a 4600teu container ship was studied the ship is designed for unlimited service area the main characteristics of the container are listed in table 1 for a container ship those locations at midship suffer stronger moments from hogging and sagging during waves especially for corners of opening deck high stress concentration exists according to the preliminary static analysis and dnv recommendation in this paper 6 hotspots are monitored as shown in fig 3 also table 2 describes those hotspots in detail the ship hull nominal stresses can be derived by beam theory or fe analysis sectional loads derived from hydrodynamic calculation including vertical bending moment vbm horizontal bending moment and torsion moment as well as vertical and horizontal shear forces those sectional loads are considered as loading conditions in fe analysis but generally vbm is the only sectional load in consideration in ship fatigue assessment due to the reason that vbm is the main inducement of overall longitudinal bending stress according to a detailed research about the relationships among several sectional forces conducted by li and ringsberg li and ringsberg 2012 vbm dominates the overall longitudinal bending stress not because the horizontal bending and torsion are small but rather because they counteract each other therefore this paper adopts vbm as the only sectional load and because the restriction of experimental conditions some preliminary work was conducted to simplify test and td analysis 3 2 preliminary work for the purpose that reducing workloads of model test and td analysis fd analysis is conducted in advance to decrease the number of analyzed seastates in model test and td analysis a global wave scatter diagram published by dnv dnv 2014 is adopted as environmental data and wave spectrum is a pierson moskowitz wave spectrum recommended by issc and is represented mathematically by 15 s ω 124 h s 2 t z 4 ω 5 e x p 496 t z 4 ω 4 fig 4 shows the fatigue damage distribution in each seastate for hs1 a and hs3 b by fd analysis the seastates with t z of 7 5 10 5s and h s of 3 7 m contribute 80 fatigue damage to the total practically it is hard to consider every seastate in model test or td analysis it needs to filter seastates which contributes few fatigue damages to ship structure but the fatigue damage caused by each seastate depends on many factors such as the probability of occurrence the severity and the motion response of different ship types to each seastate therefore it is difficult to determine seastates which have a greater impact on the ship s fatigue performance generally the severity of a seastate is appraised by spectrum energy which is represented by the area under the spectral density curve that is zero order spectral moment of the wave spectrum in this paper combining the influences of the probability of occurrence and severity an indicator m i 0 p i is adopted to represent the contribution of seastate i m i 0 denotes zero order spectral moment of the wave spectrum and p i is the probability of occurrence fig 5 shows the distribution of m i 0 p i of the global wave scatter diagram and table 3 listed some seastates which have the highest values of m i 0 p i only first 3 seastates in bold in table 3 are simulated in model test and td analysis due to the restriction of experimental conditions and only the head sea is simulated in the model test as well as td analysis because responses of sections in head sea are the severest 3 3 segmented model test wave model test is an important investigation approach on wave and structural response it can reflect and deduce the response of the full scale ship under real seastates generally wave model test includes full scale measurement and ship model test because the former requires abundant resources and cannot be carried out easily in the present work a segmented ship model test is deployed in towing tank to validate the simulations the rigid motions and structural dynamic responses of the ship model in fluid are analyzed model and full scale ship have similarities including geometrical similarity shape of the model should be identical with full scale ship as well as the wave condition kinematic similarity strouhal numbers are identical dynamic similarity gravity similarity mainly froude numbers remain identical the scale ratio λ of the segmented ship model is set as 1 64 considering the characteristics of the towing tank more similar relations are listed in table 4 according to similar relations main characteristics of model are determined and listed in table 5 the model was made up by 8 parts and only three sections 3rd 4th 5th hold transverse sections for explanation are monitored see fig 6 the equipment used in the test includes towing truck wave generator and ship model the model was connected to towing truck by cable navigation rods were installed at bow and stern of the model separately to keep the heading angle of model unchanged during navigation three wave probes were installed on the model to monitor encounter wave height two were separately installed at two sides and one was installed in front of the model gyroscope was placed at center of gravity to monitor pitch angle of the model as shown in fig 7 section strains were measured by strain gages and converted to vbm through calibration coefficient the calibration coefficient represents the relationship between strain and vbm and can be obtained by following procedures shown in fig 8 to reduce the influence of signal noises signals with frequency greater than 20 hz was filtered in collected data in the test the model was tested in regular wave and irregular wave under service velocity regular waves were set 9 groups and irregular waves were set 3 groups parameters of testing wave condition are given in table 6 to eliminate operational error in the test each group of regular wave lasted 1 min and repeated twice and each group of irregular wave latsed 2 min and repeated 4 times the data collected in the test including vbm raos of the monitored sections in regular waves vbm time histories of the monitored sections in irregular waves 3 4 time domain analysis considering that td analysis includes complex irregular wave calculations and nonlinearities scholars use td analysis as a reference commonly in the current work td analysis is also conducted to validate the hybrid method different from fd analysis wave loads on the vessel is directly calculated in hydrodynamic calculations in td analysis those loads are transferred into fe analysis to obtain the stress time histories for each hotspot to guarantee the validation of a td analysis two parameters time duration and time step are imperative in irregular wave calculations time duration should be long enough to contain 100 pairs of peak and trough almost amounts to 20 30 min li and ringsberg li et al 2013 discussed the influence of time duration from 1200 s to 10 800 s and indicated that a 20 min time duration can provide sufficient accuracy for a td analysis in the current study time duration is set as 2000s considering that at the start and the end of the analysis are unstable an 1800s interval midst is used for fatigue assessment in hydrodynamic calculations or fe analysis time step decides the convergence of the results a big time step will ignore some of peaks and result in useless data while a small time step indeed improves the accuracy of the simulation it slows the calculation and burdens computational resources in the current work time step is set as 0 1 s in hydrodynamic calculation and 0 5 s in fe analysis respectively 3 5 comparative analysis in this section kinds data from different methods including vbm rao vbm psd and rainflow counting results are compared and for a better comparison testing results are transformed into full scale firstly vbm rao of the model were compared with fd analysis fig 9 shows the vbm raos of three monitored section from fd analysis and model test it can be observed that tendencies and values of fd analysis results are approximate with those of model test indicates that numerical simulation has enough accuracy for the following assessment peak frequencies of three sections are all near ω e 1 rad s in fd analysis while peak frequencies of the sections are near ω e 0 8 rad s and the peak values in fd analysis are lower than test this maybe because the model test uses segmented ship model the deformation of the hull beam is considered in the measurement while the fd numerical simulation considers hull beam as a rigid body with only small deformation in segmented test and fd analysis vbm time histories of monitored sections in irregular were obtained for a better comparison vbm time history is transformed into vbm psd using fast fourier transform and is compared with fd result fig 10 shows comparisons of vbm psds of monitored sections in irregular wave s1 and table 7 gives spectral parameters of those vbm psds spectral parameters can be calculated following eqs 6 and 7 from fig 10 it can be seen that both vbm psds from test fd and td are approximate overall tendencies of the curves are identical and the values are approximate in table 7 zero order spectral moments of td analysis and fd analysis are very close while testing result is lower than simulations as for zero up crossing frequency three methods are almost the same this indicates that both td and fd analyses can reflect the actual response of the ship during a short term and provide acceptable results in practical cases simulated stress time histories are counted by rfc and compared with the counting result of td analysis fig 11 shows the counting results of 6 hotspots in s1 obviously total number of cycles of fd are greater than td as regard to stress range results of two methods are approximate at hs1 and hs2 and fd is slightly greater than td for hs4 and hs6 results of fd are significantly greater than td analysis however for the hotspots hs3 and hs5 located at midship results of fd are lower than td reversely 4 implementation in this section the hybrid method is implemented on the 4600 teu container ship also as a comparison fatigue damage of the ship was assessed through different methods to understand the accuracy of the hybrid method 4 1 hydrodynamic analysis hydrodynamic model and mass model are required for completing the hydrodynamic analysis the hydrodynamic model is composed by two parts wetted surface model generated by hull surface and free surface shown in fig 12 the free surface mesh was set to be five ship lengths to meet the longest radiated or scattered wave of the encountered waves li et al li et al 2014 mass distribution center of gravity as well as rotational inertia are provided by structural model because the structural model reflects realistically the mass distribution of the ship including steel engine as well as loading condition calculation frequencies of regular waves are 0 1 1 5 rad s with increment 0 1 rad s three sections corresponded with model test are set as shown in fig 13 in the hydrodynamic analysis the following data were collected pressures on the hull plate ship motions of 6 degrees of freedom acceleration of motion and gravity on the structure 4 2 structural analysis in sestra wave loads are imported and applied on the fe element for each wetted panel element in hydrodynamic model the pressure on the panel element is equivalent to a concentrated force on the center of the element therefore the concentrated force is projected on the hull surface element that relevant to the panel element the structural model is previously shown in fig 3 stress raos of 6 hotspots are calculated through fe analysis fig 14 shows the stress raos of 6 hotspots in head sea as mentioned previously in the current study the global wave scatter diagram published by dnv is adopted as environmental data and the pierson moskowitz wave spectrum in eq 14 was used following eqs 3 5 the stress psds for every hotspot and sections can be calculated and through wafo tools in matlab the stress psds are transformed to stress time history and counted by rfc 4 3 fatigue assessment two s n curves published by dnv dnv 2014 listed in table 8 are adopted for various hotspots in the current study in section 2 4 two correction factories are introduced in terms of stress concentration factor k table 9 gives kinds of k factors for 6 hotspots mentioned previously and according to table 2 s n curves used for hs3 and hs4 require thickness correction based on the procedures previously narrated shot term 1 h fatigue damages are calculated and for comparison fatigue damages are obtained from 4 different assessments frequency domain fatigue analysis fd f the common direct method based on fe analysis the fatigue stresses are directly calculated and nba is considered in fd f fatigue damages are calculated considering k thickness correction but without bandwidth correction wirsching s wide band rainflow correction wirsching and light 1980 a fd f analysis with bandwidth correction fd fc similar with fd f in fd fc all corrections are in consideration and also the bandwidth correction time domain fatigue analysis td f based on irregular wave hydrodynamic calculation and rfc fatigue damages for hotspots are calculated and corrected the hybrid method fd r the stress psds obtained in fd are transformed into stress time histories by ifft and then counted through rfc fd r considers k thickness correction but without bandwidth correction the fatigue damage for 6 different hotspots in three seastates are calculated in fig 15 and for a comparative view results obtained from td f are set as 1 the values of columns represent the ratios of results from different methods to those from td f 4 4 comparison and discussion in fig 15 it is observed that fd f and fd fc are larger than td f and fd r results of the hybrid method fd r are sharply lower than fd f and fd fc s although they use same stress psds this indicates that comparing with rfc nba is the main uncertainty in fd analysis and cause the fatigue assessment conservative in frequency domain it can be seen that for most of 6 hotspots the damages counted by nba are over 5 times larger than rfc also by comparing fd f fd fc it can be seen that bandwidth correction only have slightly impact on fatigue damages about a 15 20 decrease and still remain high ratio to td f it indicates that bandwidth correction contributes limited influence on fatigue damage prediction which is not sufficient to eliminate the error caused by nba it also shows that the hybrid method fd r is the closest one to td f for most values in range 1 2 3 2 in fig 15 the discrepancies come from the different obtainments of fatigue stresses it indicates that the hybrid method avoided the error from nba and produced a result closed to td analysis and regarding to calculation time stress time history obtained in td analysis for one seastate needs 24 h or more while using hybrid method on the same computer it only takes half an hour to calculate the rao of each hotspot and if signal conversion functions are debugged the signal conversion only takes less than 10 min it can be seen that the hybrid method is more efficient than td analysis and can produce an accurate fatigue damage prediction but it is still worth noting that in s1 hs3 and hs5 have lower fatigue damage prediction than td analysis for hs3 is 0 84 and hs5 is 0 90 this maybe because that hs3 and hs5 are located midship generally results from fd analysis are more conservative than td it can also be seen from table 7 that spectral area of vbm psd in fd is mostly larger than td but at midship of the container the fd result of section ii is slightly lower than td fig 16 shows the stress psd of hs3 and hs5 in s1 and table 10 gives the spectral parameters it can be seen that their spectral parameters are very close to td analysis and the ratio of zero order spectrum moment of hs3 is less than 1 and according to fig 11 c and e the simulated stress time histories produced lower stress range than td results while number of cycles are close those might be the reasons that the hybrid method produced a lower fatigue damage prediction than td analysis in hs3 and hs5 5 conclusions in the current study a hybrid frequency time domain method for fatigue analysis is used for fatigue assessment of a 4600teu container ship this hybrid method is verified by segmented ship model test as well as traditional methods from the calculation results obtained from different methods the following conclusions can be drawn 1 comparing with testing data both td and fd produce fatigue stresses approximated with test indicates that fatigue stresses obtained from both td and fd can reflect the real response of the ship structure during waves also it proves that adopting the fatigue stress of fd for counts is sufficient to generate reliable predictions 2 fatigue damage predicted by frequency domain remains large conservation the main source of error is considered as narrow band approximation although a band width correction is applied on fatigue assessment the results slightly decreased in range 15 20 3 according to the short term damage prediction the hybrid method produced the closest damage prediction compared with common frequency domain analysis for fatigue damages obtained from the hybrid method are 1 2 3 2 times of time domain while those obtained from frequency domain are 5 20 times it proves that narrow band approximation is the main reason for the huge conservation of frequency domain fatigue analysis avoiding it will produce a relatively accurate fatigue damage prediction 4 in some area located at midship may generate slightly lower fatigue damages than time domain analysis using hybrid method this maybe because that in midship dynamic results calculated by fd analysis are very close to td analysis and sometimes even lower but the reason inherent requires further investigations 5 the hybrid method provides a new idea to conduct fatigue assessment for practical cases using hydrodynamic calculations and fe analysis in frequency domain reliable fatigue stresses are calculated meanwhile the computational time are sharply saved considering the efficiency and the accuracy the hybrid method is useful in preliminary ship structural design stage credit authorship contribution statement jingxia yue supervision ke yang methodology formal analysis writing original draft writing review editing lihua peng conceptualization software methodology investigation visualization yulong guo data curation investigation resources declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests no conflict of interest exits in the submission of this manuscript and manuscript is approved by all authors for publication i would like to declare on behalf of my co authors that the work described was original research that has not been published previously and not under consideration for publication elsewhere in whole or in part all the authors listed have approved the manuscript that is enclosed we declare that we do not have any commercial or associative interest that represents a conflict of interest in connection with the work submitted acknowledgments this work was financially supported by the national natural science foundation of china project no 51679177 the key international regional cooperative research projects of the national natural science foundation of china project no 51720105011 these sources of support are gratefully acknowledged by the authors 
21156,ships in ocean waves are suffered from cyclic wave loads which can cause fatigue damage to ship structures classification societies require owners to carry out fatigue assessment for ship structure for its potential great loss caused by fatigue failure currently there are many fatigue assessment methods including simplified method deterministic method spectral based method and time domain method but none of them predict fatigue life precisely and effectively based on linear superposition theory and the assumption that a linear relationship occurred between waves and ship structural response some scholars proposed the hybrid frequency time domain method this method avoids the imprecise narrow band approximation in spectral based method and adopts rainflow counting instead however the hybrid method is not applied extensively on ship fatigue assessment because relevant research is insufficient in this paper aiming to validate the hybrid method a segmented ship model test is carried out and the short term fatigue damages of a 4600teu container forecasted by hybrid method and traditional methods are compared results shows that the hybrid method forecasts the closest fatigue damage prediction to time domain analysis and owns enough efficiency but in some area located at midship hybrid method may predict lower fatigue damage than time domain method keywords ship fatigue assessment hybrid frequency time domain fatigue analysis segmented model test 1 introduction when a ship is sailing at sea ocean waves are considered as cyclic loads acting on the ship these loads may result in fatigue failure on ship structures with the increasment of ship tonnage and extensive use of high strength steel modern ship structures confront severe fatigue failure problems nowadays moe and storhaug storhaug et al 2007 storhaug and moe 2007 reported that fatigue cracks were found in many vessels serviced in the north atlantic and that in some containers only after less than 8 years of service time serious cracks appeared on the deck of these vessels haagensen et al 2014 documented the fatigue cracking occurred on the veslefrikk b platform and its maintenance history despite several repairs were made for the platform fatigue cracking was continuing many classifications such as dnv gl abs ccs provide fatigue assessment references dnv 2014 abs 2012 ccs 2013 currently fatigue assessment technique can be categorized as simplified method deterministic method and direct calculation method the simplified method uses the weibull probability distribution to describe the long term stress range distribution of ship structure components while deterministic method is some sort of a simplified version of spectral based method the main simplification of deterministic method is that it uses deterministic wave height and period to characterize a seastate rather than using short term wave spectrum e g neumann wave spectrum and pierson moskowitz wave spectrum more frequently these two simplified methods are used for local details and suit for urgent cases and because simplified methods based on empirical formulae lacks accuracy societies are likely to recommend the direct calculation method for global fatigue assessment as long as the designer have enough time and computational sources therefore the current work focused on the direct calculation method to perform the study currently direct calculation method is divided into time domain td method and frequency domain fd method a td can consider nonlinearities like slamming and whipping effect and can obtain the fatigue stress time history of structure under real seastates by simulating a series of seastates in hydrodynamic calculations these advantages though indeed improving the accuracy have burdened the computation according to li s comparative study li et al 2014 a td method will cost several hours while fd method takes less than 1 min for a 20 min duration of a seastate in fatigue analysis to reduce the computational time mohammdi et al mohammadi et al 2016 proposed a fatigue damage surface approximation method after combining his algorithm 94 of the simulated seastates are minimized due to the computational restrictions of td analysis classifications only recommend that applying td analysis to cases which contain high nonlinear properties and most generally in scientific researches using td analysis as a reference method as to practical cases fd methods are extensively used there are many kinds of fd methods the most classical spectral method uses rayleigh distribution to describe the short term distribution of the stress range and complete the counting by evaluating the zero up crossing frequency period but rayleigh distribution is only suitable for a narrow band irregularity factor γ 0 99 gaussian process while none of occurred seastates as well as the ship responses can be treated as narrow band processes mohammdi et al mohammadi et al 2016 had identified that the narrow band approximation nba used in spectral method is the most accountable source for the conservation norio and tomohiro takeda and naruse 2012 analyzed the stress amplitude probability density and damage distribution by dirlik method level crossing method and td method they found that both two spectral methods result more high stress amplitude which have very significant influence on damage distribution the improvements made for the spectral method are two main means modification for narrow band nb calculations and wide band wb calculations the former one includes dirlik formula rice formula and wirsching s wide band rainflow correction etc a practical case study made by wang wang 2010 has pointed out that different correction factors dirlik s rice s and wirsching s correction factor can only contribute 5 45 9 2 of the corrections compared with iacsr 56 which is negligible when comparing with the error from narrow band assumption based on dirlik formula norio and tomohiro takeda and naruse 2012 aim to eliminate the overestimated high stress amplitude proposed two adjustments constant adjustment and square error adjustment on the stress probability density applying the adjustments on dirlik method stress probability is in good accordance with td analysis another improvement is wb calculations in terms of a most representative wb progress the bimodal gaussian progress discretization method is the state of the art approach to make the discretization method more reliable gao et al gao and zheng 2019 proposed a parameter to describe the interaction of low frequency and high frequency in the discretized frequencies but such a discretization method requires abundant coefficients to join the calculation as well as a complex algorithm as aforementioned td analysis possesses the highest accuracy but requires abundant computational resources fd analysis is quick but due to that nba is not well solved the accuracy is not ideal for general engineering practices a suitable fatigue assessment method is needed scholars have proposed a hybrid method that combines fd and td analysis this hybrid method is based on linear wave theory and the assumption that linear relationship occurred between waves and ship structural response it considered the irregular stress time history as a superposition of a series of regular stress histories according to fourier transform relationship between fd and td the hybrid method uses the stress spectrum calculated in fd to reconstruct the stress time history this method which combines the advantages of the dynamic analysis conducted in the fd with the fatigue direct assessment criteria in td is efficient and accurate however it is still not applied on ship fatigue assessment extensively and lacks sufficient experimental verifications the primary objective of this paper is to verify the feasibility of the hybrid frequency time domain method in this paper the hybrid method was used to conduct a short term fatigue damage prediction on a container ship and compared with traditional methods in addition a segmented ship model test was also carried out to verify the accuracy of the numerical calculation the remainder of this paper is arranged as follows in section 2 procedures of the hybrid method and fatigue damage calculation are outlined in section 3 the segmented model test was introduced and kinds of data used in the hybrid method are compared a numerical case study is given in section 4 finally conclusions are presented in section 5 2 methodology 2 1 overview for an instinct view of the hybrid method a flow chart is shown in fig 1 as shown in the flow chart the hybrid method highlighted in the red box is a combination of fd and td analyses in terms of specific cases same with fd analysis the hybrid method obtains structural fatigue stresses stress psds through hydrodynamic calculations in fd and finite element fe analysis by applying inverse fast fourier transform ifft stress psds are transformed into stress time histories for each stress time history rainflow counting rfc is applied to obtain pairs of stress range and cycles based on s n curve and palmgren miner s damage linear accumulation rule fatigue damage can be assessed the hybrid method abandons time consuming hydrodynamic calculations in td and inaccurate nba in fd according to the relationship of hydrodynamic calculations between td and fd stress psd can use ifft to reconstruct the stress time history which can yield more accurate fatigue loads by rfc by adopting the advantages of td and fd the hybrid method can yield more accurate fatigue damage than traditional fd method with satisfied efficiency 2 2 frequency domain analysis in a spectral based method three main assumptions are established linear wave theory the irregular wave can be considered as a superposition of a series of component regular waves and its expected energy can be characterized by short term wave spectrum a linear relationship occurred between waves and ship structural response this assumption introduces transfer functions to describe the dynamic properties of the ship structure narrow band approximation nba stress range within each short term seastate is considered as rayleigh distribution and cycle count is according to zero up crossing period of short term structural stress responses while in the hybrid method this assumption is avoided based on the first linear wave theory an irregular wave time history a t can be considered as a superposition of a series of regular waves using fourier analysis 1 a t i 1 n a i cos k i x ω i t ε i where a i is the amplitude of the component regular wave i ω i k i and ε i are the wave frequency the wave number and the phase of the ith harmonic wave component respectively usually a stationary sea state is described by wave spectrum a wave spectrum s ω h s t z is a function of the wave frequency ω and associated with the significant wave height h s and the mean zero up crossing period t z it describes the energy of a short term sea state at different wave frequencies and for ith harmonic wave component in wave spectrum the amplitude a i is determined by 2 a i 2 s ω i δ ω where δ ω denotes the increment of ω in wave spectrum in a real sea condition waves are always directionally spreading which is called short crested wave in calculations cosine square or cosine quartic spreading functions are recommended by issc to conduct the short crested wave simulation another decisive assumption in frequency domain is the linear relationship between waves and ship structural response if a ship is regarded as a linear signal system then the total structural response under irregular waves can be regarded as a superposition of structural responses under regular component waves to simplify the response analysis transfer function is introduced a transfer function is the ratio of outputting to inputting for instance structural response to wave load in terms of fd analysis transfer functions are variant for different hotspots and heading angles and combining each seastates in wave scatter diagram and each individual transfer function short term response of the ship structure can be clarified the modulus of the transfer function response amplitude operators rao is regarded as a scale factor scaling the wave spectrum and the stress psd for a specific location can be obtained by eq 3 3 s σ ω h s t z θ r a o ω θ 2 s ω h s t z where ω is wave frequency θ is heading angle rao is the modulus of the transfer function related to θ s σ ω and s ω are stress psd and wave spectrum respectively for a sailing condition wave encounter frequency ω e is used to replace ω and calculated in eq 4 and therefore stress psd in ω and in ω e is transformed by eq 5 4 ω e ω ω 2 g v c o s θ 5 s σ ω ω s σ ω e ω e where v is the current velocity of the ship and g is gravity acceleration s σ ω and s σ ω e are stress psd in ω and in ω e for a specific spectrum s ω the characteristics of the spectrum are generally described by spectral parameters such as nth order spectral moment m n and zero up crossing frequency ν they are calculated by 6 m n ω ω n s ω d ω 7 ν 1 2 π m 2 m 0 in this paper wasim in hydrod dnv 2011a is applied in the current study and can complete the regular wave hydrodynamic calculations wasim can simulate the wave in arbitrary directions and uses cosine square to describe the short crested sea state also full 3d effect and geometric nonlinearity are considered in wasim which can improve the accuracy of the calculation results once the wave loads on the hull and sectional loads are obtained those loads are imported into sestra dnv 2011b to complete the fe analysis and calculation every specific rao 2 3 signal conversion the standard assumptions for a seastate under stationary conditions are that a t is a stationary and ergodic stochastic process with mean value assumed to be zero and with a spectral density s ω however a real seastate seldom supports the gaussian assumption but since the gaussian random process is well understood and can represent wave characteristics expressed by spectrum s ω it is common to simulate a gaussian process which bases on the wave characteristics of spectrum s ω to replace the real seastate and complete the wave analysis meanwhile according to the linear relationship occurred between waves and ship structural response it is reasonable to assume that the stress process acting on the structure is also a gaussian random process and characteristics of the process can be extracted from stress psd thus a stress psd can be used to reconstruct stress time history several algorithms are available in literatures for the signal reconstruction the most intuitive algorithm is based on the inverse fast fourier transform ifft it generates a finite number of harmonics components with different amplitudes frequencies and random phases hudspeth and borgman 1979 there are two method to complete the conversion random phase deterministic spectral amplitude dsa and the non deterministic spectral amplitude nsa wang and xia 2012 in dsa a stress process σ t simulated by spectrum is expressed as 8 σ t i 1 m a i cos ω i t ε i i 1 m 2 s σ ω i δ ω cos ω i t ε i where s σ denotes stress psd a i ω i and δ ω i are amplitude representative frequency and frequency interval of the ith component respectively ε i is random phase and distributes uniformly in 0 2π m denotes the total number of components fig 2 shows the schematic of dividing spectral frequency intervals it assumes that spectral energy mostly concentrates in frequency range between frequency lower limit ω l and upper limits ω u ω l and ω u can be calculated by setting a negligible energy ratio and integrating the spectrum the frequency range is divided into m intervals ω i and ω i is lower and upper limit of ith interval representative frequency of ith component ω i is chosen in range ω i ω i several methods are used to determine the frequency components but these methods may make the time history repeat periodically or ω i assemble around the spectral peak these drawbacks are avoided by the method proposed by du et al braccesi et al 2014 they divided the frequency range equally and chose ω i in the ith interval randomly unlike dsa using deterministic amplitude nsa is expressed as 9 σ t i 1 m a i cos ω i t ε a i b i sin ω i t ε b i where ε a i and ε b i are random phase similar with ε i amplitudes a i and b i are independent random variables with mean zero value and their standard deviations are given by 10 σ a i σ b i 2 s σ ω i δ ω but ifft generates in a random way the phases of the different harmonic wave components obviously by changing the phases sequence an infinite number of different time histories could be generated this will inevitably bring random errors braccesi et al 2014 investigated the relationship between the duration of a reconstructed time history and its statistical properties they used one spectrum to generate 300 simulated time histories including five different time durations and discussed the variations of two major properties of the process the root mean square and the number of peaks in the time unit they found that when the simulated time history is sufficiently long over 2000s in the reference random characteristics of the generated time history tend to be stable therefore random error can be neglected in the current study wafo tools in matlab are used to convert stress spectrum it adopts nsa method generates a gaussian process by summation of sinus function with random amplitudes and random phase angle and in this paper time duration of reconstruction is set as 1 h 2 4 accumulated fatigue damage for a stress time history to count the stress range and cycles thereof rainflow counting method rfc is commonly used matsuishi and endo 1968 rfc identifies the local maximum and pairs the local maximum with the local minimum to form a hysteresis loop repeatedly then counts the loops this procedure allows rfc count the big circulations without ignoring smaller circulations rfc is extensively accepted to yield the best representation of the cyclic stress strain behavior of material and is considered as a scientific and the most accurate counting method when pairs of stress range and cycle are obtained based on palmgren miner linear damage cumulative rule and s n curve method the damage in a specific seastate can be calculated as follows 11 d i j n j s j m a where d i is fatigue damage cumulated in i seastate n j denotes the number of cycles that the structure endures at stress range s j during i seastate a and m are material parameter of the s n curve and the total damage d can be obtained by 12 d i d i in the current study wafo in matlab is adopted to perform the rainflow counting and complete the damage accumulation calculation additionally considering the characteristics for every hotspot some correction factories are in consideration they are stress concentration factor k k is the ratio of hotspot stress σ h o t s p o t and nominal stress σ n o m i n a l and is obtained by multiplication of k factors arising from different causes as the following equation 13 k σ h o t s p o t σ n o m i n a l k g k t e k t α k n where k g denotes stress concentration factor due to the gross geometry of the considered detail k t e denotes additional stress concentration factor due to eccentricity tolerance k t α denotes additional stress concentration factor due to angular mismatch and k n denotes that for unsymmetrical stiffeners on laterally loaded panels thickness correction because at the thick plate welded joints initial defects exist and decrease the continuity of the structure and for the reason that those locations usually adopt high tensile strength steel the effect of energy absorption of structural plastic deformation is restrained by high yield strength therefore for a hotspot that thickness larger than 25 mm the s n curve is modified by 14 l o g n l o g a m 4 l o g t h 25 m l o g s where t h denotes the thickness of hotspot n a m s denote parameters of s n curves 3 verification 3 1 subject description in the current study a 4600teu container ship was studied the ship is designed for unlimited service area the main characteristics of the container are listed in table 1 for a container ship those locations at midship suffer stronger moments from hogging and sagging during waves especially for corners of opening deck high stress concentration exists according to the preliminary static analysis and dnv recommendation in this paper 6 hotspots are monitored as shown in fig 3 also table 2 describes those hotspots in detail the ship hull nominal stresses can be derived by beam theory or fe analysis sectional loads derived from hydrodynamic calculation including vertical bending moment vbm horizontal bending moment and torsion moment as well as vertical and horizontal shear forces those sectional loads are considered as loading conditions in fe analysis but generally vbm is the only sectional load in consideration in ship fatigue assessment due to the reason that vbm is the main inducement of overall longitudinal bending stress according to a detailed research about the relationships among several sectional forces conducted by li and ringsberg li and ringsberg 2012 vbm dominates the overall longitudinal bending stress not because the horizontal bending and torsion are small but rather because they counteract each other therefore this paper adopts vbm as the only sectional load and because the restriction of experimental conditions some preliminary work was conducted to simplify test and td analysis 3 2 preliminary work for the purpose that reducing workloads of model test and td analysis fd analysis is conducted in advance to decrease the number of analyzed seastates in model test and td analysis a global wave scatter diagram published by dnv dnv 2014 is adopted as environmental data and wave spectrum is a pierson moskowitz wave spectrum recommended by issc and is represented mathematically by 15 s ω 124 h s 2 t z 4 ω 5 e x p 496 t z 4 ω 4 fig 4 shows the fatigue damage distribution in each seastate for hs1 a and hs3 b by fd analysis the seastates with t z of 7 5 10 5s and h s of 3 7 m contribute 80 fatigue damage to the total practically it is hard to consider every seastate in model test or td analysis it needs to filter seastates which contributes few fatigue damages to ship structure but the fatigue damage caused by each seastate depends on many factors such as the probability of occurrence the severity and the motion response of different ship types to each seastate therefore it is difficult to determine seastates which have a greater impact on the ship s fatigue performance generally the severity of a seastate is appraised by spectrum energy which is represented by the area under the spectral density curve that is zero order spectral moment of the wave spectrum in this paper combining the influences of the probability of occurrence and severity an indicator m i 0 p i is adopted to represent the contribution of seastate i m i 0 denotes zero order spectral moment of the wave spectrum and p i is the probability of occurrence fig 5 shows the distribution of m i 0 p i of the global wave scatter diagram and table 3 listed some seastates which have the highest values of m i 0 p i only first 3 seastates in bold in table 3 are simulated in model test and td analysis due to the restriction of experimental conditions and only the head sea is simulated in the model test as well as td analysis because responses of sections in head sea are the severest 3 3 segmented model test wave model test is an important investigation approach on wave and structural response it can reflect and deduce the response of the full scale ship under real seastates generally wave model test includes full scale measurement and ship model test because the former requires abundant resources and cannot be carried out easily in the present work a segmented ship model test is deployed in towing tank to validate the simulations the rigid motions and structural dynamic responses of the ship model in fluid are analyzed model and full scale ship have similarities including geometrical similarity shape of the model should be identical with full scale ship as well as the wave condition kinematic similarity strouhal numbers are identical dynamic similarity gravity similarity mainly froude numbers remain identical the scale ratio λ of the segmented ship model is set as 1 64 considering the characteristics of the towing tank more similar relations are listed in table 4 according to similar relations main characteristics of model are determined and listed in table 5 the model was made up by 8 parts and only three sections 3rd 4th 5th hold transverse sections for explanation are monitored see fig 6 the equipment used in the test includes towing truck wave generator and ship model the model was connected to towing truck by cable navigation rods were installed at bow and stern of the model separately to keep the heading angle of model unchanged during navigation three wave probes were installed on the model to monitor encounter wave height two were separately installed at two sides and one was installed in front of the model gyroscope was placed at center of gravity to monitor pitch angle of the model as shown in fig 7 section strains were measured by strain gages and converted to vbm through calibration coefficient the calibration coefficient represents the relationship between strain and vbm and can be obtained by following procedures shown in fig 8 to reduce the influence of signal noises signals with frequency greater than 20 hz was filtered in collected data in the test the model was tested in regular wave and irregular wave under service velocity regular waves were set 9 groups and irregular waves were set 3 groups parameters of testing wave condition are given in table 6 to eliminate operational error in the test each group of regular wave lasted 1 min and repeated twice and each group of irregular wave latsed 2 min and repeated 4 times the data collected in the test including vbm raos of the monitored sections in regular waves vbm time histories of the monitored sections in irregular waves 3 4 time domain analysis considering that td analysis includes complex irregular wave calculations and nonlinearities scholars use td analysis as a reference commonly in the current work td analysis is also conducted to validate the hybrid method different from fd analysis wave loads on the vessel is directly calculated in hydrodynamic calculations in td analysis those loads are transferred into fe analysis to obtain the stress time histories for each hotspot to guarantee the validation of a td analysis two parameters time duration and time step are imperative in irregular wave calculations time duration should be long enough to contain 100 pairs of peak and trough almost amounts to 20 30 min li and ringsberg li et al 2013 discussed the influence of time duration from 1200 s to 10 800 s and indicated that a 20 min time duration can provide sufficient accuracy for a td analysis in the current study time duration is set as 2000s considering that at the start and the end of the analysis are unstable an 1800s interval midst is used for fatigue assessment in hydrodynamic calculations or fe analysis time step decides the convergence of the results a big time step will ignore some of peaks and result in useless data while a small time step indeed improves the accuracy of the simulation it slows the calculation and burdens computational resources in the current work time step is set as 0 1 s in hydrodynamic calculation and 0 5 s in fe analysis respectively 3 5 comparative analysis in this section kinds data from different methods including vbm rao vbm psd and rainflow counting results are compared and for a better comparison testing results are transformed into full scale firstly vbm rao of the model were compared with fd analysis fig 9 shows the vbm raos of three monitored section from fd analysis and model test it can be observed that tendencies and values of fd analysis results are approximate with those of model test indicates that numerical simulation has enough accuracy for the following assessment peak frequencies of three sections are all near ω e 1 rad s in fd analysis while peak frequencies of the sections are near ω e 0 8 rad s and the peak values in fd analysis are lower than test this maybe because the model test uses segmented ship model the deformation of the hull beam is considered in the measurement while the fd numerical simulation considers hull beam as a rigid body with only small deformation in segmented test and fd analysis vbm time histories of monitored sections in irregular were obtained for a better comparison vbm time history is transformed into vbm psd using fast fourier transform and is compared with fd result fig 10 shows comparisons of vbm psds of monitored sections in irregular wave s1 and table 7 gives spectral parameters of those vbm psds spectral parameters can be calculated following eqs 6 and 7 from fig 10 it can be seen that both vbm psds from test fd and td are approximate overall tendencies of the curves are identical and the values are approximate in table 7 zero order spectral moments of td analysis and fd analysis are very close while testing result is lower than simulations as for zero up crossing frequency three methods are almost the same this indicates that both td and fd analyses can reflect the actual response of the ship during a short term and provide acceptable results in practical cases simulated stress time histories are counted by rfc and compared with the counting result of td analysis fig 11 shows the counting results of 6 hotspots in s1 obviously total number of cycles of fd are greater than td as regard to stress range results of two methods are approximate at hs1 and hs2 and fd is slightly greater than td for hs4 and hs6 results of fd are significantly greater than td analysis however for the hotspots hs3 and hs5 located at midship results of fd are lower than td reversely 4 implementation in this section the hybrid method is implemented on the 4600 teu container ship also as a comparison fatigue damage of the ship was assessed through different methods to understand the accuracy of the hybrid method 4 1 hydrodynamic analysis hydrodynamic model and mass model are required for completing the hydrodynamic analysis the hydrodynamic model is composed by two parts wetted surface model generated by hull surface and free surface shown in fig 12 the free surface mesh was set to be five ship lengths to meet the longest radiated or scattered wave of the encountered waves li et al li et al 2014 mass distribution center of gravity as well as rotational inertia are provided by structural model because the structural model reflects realistically the mass distribution of the ship including steel engine as well as loading condition calculation frequencies of regular waves are 0 1 1 5 rad s with increment 0 1 rad s three sections corresponded with model test are set as shown in fig 13 in the hydrodynamic analysis the following data were collected pressures on the hull plate ship motions of 6 degrees of freedom acceleration of motion and gravity on the structure 4 2 structural analysis in sestra wave loads are imported and applied on the fe element for each wetted panel element in hydrodynamic model the pressure on the panel element is equivalent to a concentrated force on the center of the element therefore the concentrated force is projected on the hull surface element that relevant to the panel element the structural model is previously shown in fig 3 stress raos of 6 hotspots are calculated through fe analysis fig 14 shows the stress raos of 6 hotspots in head sea as mentioned previously in the current study the global wave scatter diagram published by dnv is adopted as environmental data and the pierson moskowitz wave spectrum in eq 14 was used following eqs 3 5 the stress psds for every hotspot and sections can be calculated and through wafo tools in matlab the stress psds are transformed to stress time history and counted by rfc 4 3 fatigue assessment two s n curves published by dnv dnv 2014 listed in table 8 are adopted for various hotspots in the current study in section 2 4 two correction factories are introduced in terms of stress concentration factor k table 9 gives kinds of k factors for 6 hotspots mentioned previously and according to table 2 s n curves used for hs3 and hs4 require thickness correction based on the procedures previously narrated shot term 1 h fatigue damages are calculated and for comparison fatigue damages are obtained from 4 different assessments frequency domain fatigue analysis fd f the common direct method based on fe analysis the fatigue stresses are directly calculated and nba is considered in fd f fatigue damages are calculated considering k thickness correction but without bandwidth correction wirsching s wide band rainflow correction wirsching and light 1980 a fd f analysis with bandwidth correction fd fc similar with fd f in fd fc all corrections are in consideration and also the bandwidth correction time domain fatigue analysis td f based on irregular wave hydrodynamic calculation and rfc fatigue damages for hotspots are calculated and corrected the hybrid method fd r the stress psds obtained in fd are transformed into stress time histories by ifft and then counted through rfc fd r considers k thickness correction but without bandwidth correction the fatigue damage for 6 different hotspots in three seastates are calculated in fig 15 and for a comparative view results obtained from td f are set as 1 the values of columns represent the ratios of results from different methods to those from td f 4 4 comparison and discussion in fig 15 it is observed that fd f and fd fc are larger than td f and fd r results of the hybrid method fd r are sharply lower than fd f and fd fc s although they use same stress psds this indicates that comparing with rfc nba is the main uncertainty in fd analysis and cause the fatigue assessment conservative in frequency domain it can be seen that for most of 6 hotspots the damages counted by nba are over 5 times larger than rfc also by comparing fd f fd fc it can be seen that bandwidth correction only have slightly impact on fatigue damages about a 15 20 decrease and still remain high ratio to td f it indicates that bandwidth correction contributes limited influence on fatigue damage prediction which is not sufficient to eliminate the error caused by nba it also shows that the hybrid method fd r is the closest one to td f for most values in range 1 2 3 2 in fig 15 the discrepancies come from the different obtainments of fatigue stresses it indicates that the hybrid method avoided the error from nba and produced a result closed to td analysis and regarding to calculation time stress time history obtained in td analysis for one seastate needs 24 h or more while using hybrid method on the same computer it only takes half an hour to calculate the rao of each hotspot and if signal conversion functions are debugged the signal conversion only takes less than 10 min it can be seen that the hybrid method is more efficient than td analysis and can produce an accurate fatigue damage prediction but it is still worth noting that in s1 hs3 and hs5 have lower fatigue damage prediction than td analysis for hs3 is 0 84 and hs5 is 0 90 this maybe because that hs3 and hs5 are located midship generally results from fd analysis are more conservative than td it can also be seen from table 7 that spectral area of vbm psd in fd is mostly larger than td but at midship of the container the fd result of section ii is slightly lower than td fig 16 shows the stress psd of hs3 and hs5 in s1 and table 10 gives the spectral parameters it can be seen that their spectral parameters are very close to td analysis and the ratio of zero order spectrum moment of hs3 is less than 1 and according to fig 11 c and e the simulated stress time histories produced lower stress range than td results while number of cycles are close those might be the reasons that the hybrid method produced a lower fatigue damage prediction than td analysis in hs3 and hs5 5 conclusions in the current study a hybrid frequency time domain method for fatigue analysis is used for fatigue assessment of a 4600teu container ship this hybrid method is verified by segmented ship model test as well as traditional methods from the calculation results obtained from different methods the following conclusions can be drawn 1 comparing with testing data both td and fd produce fatigue stresses approximated with test indicates that fatigue stresses obtained from both td and fd can reflect the real response of the ship structure during waves also it proves that adopting the fatigue stress of fd for counts is sufficient to generate reliable predictions 2 fatigue damage predicted by frequency domain remains large conservation the main source of error is considered as narrow band approximation although a band width correction is applied on fatigue assessment the results slightly decreased in range 15 20 3 according to the short term damage prediction the hybrid method produced the closest damage prediction compared with common frequency domain analysis for fatigue damages obtained from the hybrid method are 1 2 3 2 times of time domain while those obtained from frequency domain are 5 20 times it proves that narrow band approximation is the main reason for the huge conservation of frequency domain fatigue analysis avoiding it will produce a relatively accurate fatigue damage prediction 4 in some area located at midship may generate slightly lower fatigue damages than time domain analysis using hybrid method this maybe because that in midship dynamic results calculated by fd analysis are very close to td analysis and sometimes even lower but the reason inherent requires further investigations 5 the hybrid method provides a new idea to conduct fatigue assessment for practical cases using hydrodynamic calculations and fe analysis in frequency domain reliable fatigue stresses are calculated meanwhile the computational time are sharply saved considering the efficiency and the accuracy the hybrid method is useful in preliminary ship structural design stage credit authorship contribution statement jingxia yue supervision ke yang methodology formal analysis writing original draft writing review editing lihua peng conceptualization software methodology investigation visualization yulong guo data curation investigation resources declaration of competing interest the authors declare the following financial interests personal relationships which may be considered as potential competing interests no conflict of interest exits in the submission of this manuscript and manuscript is approved by all authors for publication i would like to declare on behalf of my co authors that the work described was original research that has not been published previously and not under consideration for publication elsewhere in whole or in part all the authors listed have approved the manuscript that is enclosed we declare that we do not have any commercial or associative interest that represents a conflict of interest in connection with the work submitted acknowledgments this work was financially supported by the national natural science foundation of china project no 51679177 the key international regional cooperative research projects of the national natural science foundation of china project no 51720105011 these sources of support are gratefully acknowledged by the authors 
21157,this paper presents a study of depth tracking controller design for a hybrid auv in the presence of model uncertainty and propeller torque s effect firstly the six degrees of freedom 6 dof nonlinear equations of motion as well as the operating mechanisms and specific characteristics of the hybrid auv are described subsequently the model for depth plane is extracted by decoupling and linearizing the 6 dof auv model furthermore a nonlinear disturbance observer ndo is constructed to deal with the linearization errors and uncertain components in the depth plane model a depth tracking controller is then designed based on the backstepping technique to guarantee the tracking error converges to an arbitrarily small neighborhood of zero besides the robust stability of the proposed controller concerning the propeller torque s effect and the model uncertainty is analyzed to ensure the objectivity and feasibility of the proposed method the depth controller is applied to the 6 dof model of auv so that it maintains the coupling between roll yaw and pitch motion finally the numerical simulation is carried out via matlab simulink to verify the controller s effectiveness feasibility and stability keywords autonomous underwater vehicle auv depth control backstepping 1 introduction nowadays autonomous underwater vehicles auv have become a major tool for activities in deep sea because of the significant improvement in their performance specifically in the scientific field is surveys data collection and environmental sampling for hydrological research wynn et al 2014 eichhorn et al 2018 in the military is clearing sea mines planted by enemies conducting war activities with the navy hagen et al 2003 mondal et al 2019 in the commercial field auvs are used to make detailed maps and surveys of the seafloor oil and gas industries before building subsea infrastructure mondal et al 2019 zhang et al 2015 therefore research and development of controllers for auv are essential in general the controller design bases on the assumption that the model parameters are accurate however the model of auv is a set of highly coupled nonlinear equations newman 1977 fossen 1994 that lead to identifying completely accurate models through estimation or empirical methods etc is a difficult task besides many control algorithms based on the linearization methods around the working point will have a sharply reduced performance when either changing the model parameters or applying in practice this can be seen through the comparison of simulation and experimental results in naik and singh 2007 prestero 2001 mahapatra and subudhi 2018 therefore stability analysis and quality characterization surveys of the controller under the effect of model uncertainty is essential the control problem for auv is a complex issue so it is usually divided into three sub problems for steering diving and speed control jalving 1994 in each sub problem it will be linearized to reduce interaction between each other thereby simplifying the design of the controller consequently auv usually has three main controllers that are speed steering and diving controllers in this paper we only focus on studying the depth control problem diving control problem for auv for the depth control problem in recent years there have been many research projects showing the different algorithms applied to design the depth controller for auv for instance with the simplest and most common algorithm pid there are jalving 1994 prestero 2001 tanakitkorn et al 2017 in jalving 1994 after decomposing the auv control into three subsystems the pid controller was built for each system for the depth controller the mathematical model of depth plane is established under the state space form by linearizing and decoupling the motion model of auv in the vertical plane the pitch transfer function and the depth transfer function are then extracted from the state space model to analyze then the parameters are selected to stabilize for the closed loop transfer function of the whole system in following the same approach as jalving 1994 prestero 2001 has developed a simple pitch and depth pd controller based on transfer functions derived from the linear state space model in tanakitkorn et al 2017 the pi d scheme has been used to design the depth controller for delphin2 auv this pi d scheme has the derivative term fed by an actual state of the system instead of the tracking error to avoid the effect of the sudden change of setting value the pi d controller will make the system works more smoothly but this controller will not be able to process the time varying desired signal moreover the controller gain values are identified using a heuristic approach based on the ziegler nichols method besides linear controllers nonlinear algorithms have also been studied and applied to auv specifically hong et al 2010 joe et al 2014 yan et al 2016 tran et al 2019 have developed various sliding mode control smc algorithms for the depth plane motion of auvs hong et al 2010 presented how to build an smc controller and an experimental verification of it this paper also addresses the effect of positive buoyancy in the dynamic model nevertheless the author did not analyze the stability nor pointed out the advantages of the proposed control algorithm in joe et al 2014 a second order smc was designed based on the 4 dof diving model of auv ignore roll and pitch the simulation and experiment were conducted on cyclops auv to verify the stability of the controller in the presence of parameter uncertainties and external disturbances however the internal stability of the closed loop system was not guaranteed an integral fast terminal sliding mode control iftsmc was explored by yan et al 2016 to control the auv under the effect of parameter perturbations and wave disturbances notwithstanding this paper only proves the convergence on the 3 dof linear motion model of auv in the vertical plane tran et al 2019 proposed an indirect strategy to control depth for the hybrid auv through pitch angle control the simulation results show the simplicity and effectiveness of the proposed strategy but the paper does not analyze the stability and performance of the controller when there are parameter uncertainties moreover several studies on backstepping techniques applied to depth control have been developed by lapierre 2009 cao et al 2011 wei et al 2015 gharesi et al 2017 mahapatra and subudhi 2018 lapierre 2009 proposed the adaptive controller and switching schemes to resolve external parameter uncertainty in this paper the adaptive laws were developed instead of the disturbance rejection to ensure the robustness the simulation results show that the controller can handle when there are parameter uncertainties however the control performance isn t high such as the response time is slow the control signal is not smooth another backstepping controller combined with adaptive law to solve the parameter uncertainty and external disturbance was also discovered by cao et al 2011 nevertheless the controller design and verification simulation were based only on the 3 dof model in depth plane wei et al 2015 formulated a linear state space equation for vertical motion of auv then used backstepping techniques to build controllers this paper addressed model uncertainties and developed a nonlinear disturbance observer ndo to deal with it similarly a backstepping controller combines with a linear extended state observer leso was design by gharesi et al 2017 further mahapatra and subudhi 2018 explored a depth control using the backstepping technique and nonlinear h infinity technique in this paper random perturbations and uncertain hydrodynamic parameters were used to investigate the robustness of the proposed controller the simulation and experiment results demonstrated the controller s effectiveness and feasibility however the control performance decline is proportional to the uncertainty magnitude additionally there exist other methods which are applied to control the depth of auv for example a gain scheduling controller is proposed by silvestre and pascoal 2007 using a reduced output feedback technique for infante auv or the state dependent riccati equation sdre technique developed in naik and singh 2007 further a constrained self tuning controller based on nonlinear auto regressive moving average exogenous narmax is utilized by rout and subudhi 2017 to track a given reference for a torpedo shaped auv besides yu et al 2018 explores a sliding mode fuzzy control method combines with line of sight los guidance law to apply to a bioinspired robotic dolphin moreover various h control methods have been developed for underwater vehicles by liceaga castro and van der molen 1995 moreira and soares 2008 mahapatra et al 2016 mahapatra and subudhi 2018 similarly the h 2 optimal control methods applied to auv in moreira and soares 2008 wadoo et al 2012 qiao et al 2018 in general the papers mentioned above often use linearizing and decoupling equations 3 dof or 4 dof in the vertical motion of auv for controller design stability analysis and simulation it means that the coupling between roll pitch and yaw motion is neglected note that a torpedo shaped auv has a small moment of inertia and drag in the roll motion thus the roll dynamic easily suffers oscillatory when the auv is affected by propeller torque unknown disturbances yaw and pitch motion moreover the roll motion is dynamically coupled into pitch motion so unwanted roll motion can reduce the diving performance and provide no clear opportunities for suppressing roll motion petrich and stilwell 2011 besides due to hydrodynamic characteristics the motion equations of auv are highly nonlinear and strongly coupled so it is inevitable to have model uncertainties in the linear process therefore it is necessary to investigate the robust stability and performance of the controller in the presence of propeller torque s effect and model uncertainties on the other hand the simulation model of auv should be 6 dof to ensure objectivity as well as the accuracy of the designed controller motivated by the aforementioned analysis this paper focuses on designing the nonlinear tracking controller for the vertical motion of a hybrid auv the control laws are produced by employing the backstepping technique to ensure stability and force the depth tracking error to an arbitrarily small neighborhood of zero regardless of propeller torque s effect and model uncertainties the designed controller is applied to a 6 dof nonlinear model to ensure objectivity and feasibility the simulation results will be specific evidence showing the efficiency disturbances rejection ability robustness and superiority of the proposed method the remnant of this paper is organized as follows section 2 presents the auv 6 dof models the operating mechanisms and specific characteristics of the hybrid auv and formulates control problem section 3 proposes the design of nonlinear disturbance observer ndo and backstepping controller for the depth plane motion of the auv and also analyzes the robust stability of the proposed controller under propeller torque s effect and model uncertainties in section 4 the numerical simulations and discussions are carried out to validates the previous analysis and design finally the conclusions of this work are presented in section 5 2 auv modelling and problem formulation 2 1 auv modelling the model will be considered in this paper is the auv2000 mentioned in tran et al 2019 auv2000 shown in fig 1 is a hybrid auv designed to integrate the outstanding characteristics of conventional auv and underwater glider a type of auv that employs variable buoyancy propulsion instead of traditional propellers or thrusters therefore auv2000 can operate in two separate modes specifically without using the thruster glider mode and using the thruster auv mode however in this paper we only focus on designing the depth controller for auv2000 in auv mode 2 1 1 kinematics model in accordance with sname sname 1950 the 6 dof nonlinear kinematic and dynamic equations of motion of auv are described in the earth fixed frame e and the body fixed frame b as shown in fig 2 according to fossen we have coordinate transform relating the translational velocities and the rotational velocities between b and e for various underwater vehicles in general and auv in particular as follows 1 x y z j 1 η 2 u v w φ θ ψ j 2 η 2 p q r where j 1 η 2 cos ψ cos θ sin ψ cos φ cos ψ sin θ sin φ sin ψ sin φ cos ψ sin θ cos φ sin ψ cos θ cos ψ cos φ sin ψ sin θ sin φ cos ψ sin φ sin ψ sin θ cos φ sin θ cos θ sin φ cos θ cos φ j 2 η 2 1 sin φ tan θ cos φ tan θ 0 cos φ sin φ 0 sin φ cos θ cos φ cos θ η 1 x y z t the position of the vehicle with respect to e η 2 φ θ ψ t the orientation roll pitch yaw of the vehicle with respect to e υ 1 u v w t the translational velocities of the vehicle with respect to b υ 2 p q r t the rotational velocities of the vehicle with respect to b 2 1 2 dynamic model of hybrid auv following to prestero 2001 the 6 dof nonlinear dynamic equations of motion of auv2000 can be expressed as 2a m u v r w q x g q 2 r 2 y g p q r z g p r q x e x t 2b m v w p u r y g r 2 p 2 z g q r p x g q p r y e x t 2c m w u q v p z g p 2 q 2 x g r p q y g r q p z e x t 2d i x x p i z z i y y q r m y g w u q v p z g v w p u r k e x t 2e i y y q i x x i z z r p m z g u v r w q x g w u q v p m e x t 2f i z z r i y y i x x p q m x g v w p u r y g u v r w q n e x t where m is the auv s mass x g y g z g is the center of gravity and i x x i y y i z z respectively are inertial moments about the x y and z axes the right side of equations 2a 2f are the sum of the components of the force and moment acting on the vehicle 3a x e x t x u u z w w q z q q 2 y v v r y r r 2 x u u u u w b sin θ x p r o p 3b y e x t y v v y r r x u u r z w w p z q p q y v v v v y r r r r y u v l u v w b cos θ sin φ y r u d 3c z e x t z w w z q q x u u q y v v p y r r p z w w w w z q q q q z u w l z u w f u w z u q f u q w b cos θ cos φ 3d k e x t k p p z w y v w v z q y r v q z q y r w r n r m q q r k p p p p y g w y b b cos θ cos φ z g w z b b cos θ sin φ k p r o p 3e m e x t z q w m q q z w x u u w y r v p k p n r r p z q u q m w w w w m q q q q m u w l m u w f u w m u q f u q z g w z b b sin θ x g w x b b cos θ cos φ 3f n e x t n v v n r r x u y v u v z q w p k p m q p q y r u r n v v v v n r r r r n u v l u v x g w x b b cos θ sin φ y g w y b b sin θ n r u d in 3a 3f x y z k m n are the added mass damping and lift terms x b y b z b is the center of buoyancy w and b respectively are weight and buoyancy of auv the propeller force and torque are x p r o p and k p r o p and the rudder force and moment are y r u d and n r u d in this paper since we only concentrate on depth control we will reduce y r u d n r u d to zero in subsequent calculations 2 1 3 the novel characteristic and operating mechanisms of auv2000 as mentioned above auv2000 is a hybrid auv that is designed to operate without using the thruster therefore many structural elements resemble those of a typical underwater glider the most significant of which are counterweight system and ballast system in this section the dissection of these operating mechanisms of auv2000 is presented thereby paving the way for the construction of the controller in the next section 2 1 3 1 buoyancy engine dynamics analysis auv2000 ballast system is a piston cylinder which is arranged as shown in fig 3 let v f i x be the volume occupied by auv when the ballast system is full of water and r f i x l f i x 0 0 t be the current position of the center of buoyancy of auv considered in the body fixed frame moreover denote v var as the volume of water that the cylinder emits then its relation to the position of the piston is formularized as 4 v var s c l c x p where s c is the cross section of cylinder l c is the length of cylinder and x p is the piston position from fig 3 the formula for determining the buoyancy center of auv can be expressed as 5 r c b x b 0 0 t v var l c x p 2 v f i x l f i x v var v f i x 0 0 t and the buoyancy of auv is 6 b ρ g v f i x v var where ρ is the density of fluid g is the gravitational acceleration 2 1 3 2 analysis of the counterweight system denote the total weight of auv without counterweight fig 4 as m h and let r h l h x l h y l h z t be the mass center of m h in the body fixed frame because the counterweight s mass m m is evenly distributed around the x axis the mass center of the counterweight in the body fixed frame is r m x m 0 0 t where x m is the counterweight position as a result the center of gravity of auv can be determined by the following formula 7 r c g m h r h m m r m m h m m x g y g z g t m h l h x m m x m m h m m m h l h y m h m m m h l h z m h m m t and the weight of auv is 8 w m g m h m m g remark 1 note that because r h is constant it is evident from 7 that moving the counterweight only alters x g in other words y g and z g are constant remark 2 like remus in prestero 2001 to deal with propeller torque s effect auv2000 s internal devices are arranged to obtain y g z g so that the hydrostatic roll moment matches propeller torque thus compensating for the roll offset therefore by setting the number of revolutions rpm for the propeller to achieve the operating speed of auv the roll angle will be small and bounded during movement 2 2 problem formulation in this paper the objective is to develop a controller to maneuver the auv tracking the desired depth in the vertical plane notwithstanding of highly coupled model nonlinearities propeller torque s effect and model uncertainties the objective can be divided into three subproblems as shown below nonlinear disturbance observer ndo is employed to deal with linearization errors and model uncertainties in the depth plane model given a desired depth z d design a control law that determines the position of the counterweight based on the backstepping technique to guarantee the depth tracking error converges to an arbitrarily small neighborhood around zero as t goes to infinity despite model uncertainties and propeller torque s effect the numerical simulations of the proposed controller applied to the 6 dof auv model are carried out to verify the disturbance resistance robustness and effectiveness of the developed control law 3 controller design there exists various methods to build a depth controller for auv some of which are based on a state space equation linearized from the depth plane model silvestre and pascoal 2007 naik and singh 2007 wei et al 2015 gharesi et al 2017 transfer function jalving 1994 prestero 2001 qiao et al 2018 los in the vertical plane tran et al 2019 yu et al 2018 rout and subudhi 2017 this paper presents a different methodology to build a depth controller using the backstepping technique before starting the design of the controller it is noticeable that when the auv operates without thruster the ballast system no longer affects too much to the diving and floating process of auv therefore for convenience and simplicity the paper will consider the ballast system with the volume to balance the buoyancy with the weight of auv utilizing 6 8 and 4 we can solve the position of piston to satisfy condition b w from 1 we derive two differential equations for depth and pitch as follows z u sin θ v cos θ sin φ w cos θ cos φ 9 a θ q cos φ r sin φ 9 b further combining 2e and 3e the nonlinear dynamic equation of pitch can be expressed as 10 i y y q i x x i z z r p m z g u v r w q x g w u q v p z q w m q q z w x u u w y r v p k p n r r p z q u q m w w w w m q q q q m u w l m u w f u w m u q f u q z g w z b b sin θ x g w x b b cos θ cos φ performing linearization for equation 10 with u w p v r φ 0 and note that z b 0 from 5 we can obtain 11 i y y m q q m u w l m u w f z w x u u w m u q f z q u q m w w w w m q q q q m z g w q z g w sin θ x b b cos θ m u q w cos θ x g now from 10 and 11 we can derive pitch dynamic equation as following form 12 q f q g q x g d where f q x u z w m u w l m u w f u w m u q f z q u q m w w w w m q q q q m z g w q z g w sin θ x b b cos θ i y y m q g q m u q w cos θ i y y m q d is the sum of the uncertain components of the model and the linearization errors thereby the depth plane model can be expressed as 13 z u sin θ v cos θ sin φ w cos θ cos φ θ q cos φ r sin φ q f q g q x g d 3 1 ndo design to estimate d we define the new variable f d l q where l 0 is the observer gain which needs to be selected later then the nonlinear disturbance observer for d is constructed as follows 14 d ˆ f ˆ l q f ˆ l f q g q x m d ˆ where d ˆ and f ˆ are the estimations of d and f respectively the estimated error is defined d d d ˆ and its derivative is 15 d d d ˆ d f ˆ l q d l f q g q x m d ˆ l f q g q x m d d l d 3 2 backstepping controller design from here we start building control laws by the backstepping technique and lyapunov functions as follows step 1 let the desired depth be z d then the depth error can be defined as 16 e z z d take the derivative of the depth error and utilizing 9a yields 17 e u sin θ v cos θ sin φ w cos θ cos φ z d define the first control lyapunov function clf as v 1 1 2 e 2 whose time derivative is v 1 e e e u sin θ v cos θ sin φ w cos θ cos φ z d the first virtual control law is selected as follows α θ θ d 18 a θ d k 1 e z d u 0 18 b where u 0 is desired operating speed of auv and k 1 is the control gain which needs to be determined then the derivative of the first clf can be expressed as 19 v 1 e u θ sin θ u θ v cos θ sin φ w cos θ cos φ z d u e θ sin θ e u α θ d v cos θ sin φ w cos θ cos φ z d u e θ sin θ u e α e u k 1 e z d u 0 v cos θ sin φ w cos θ cos φ z d u u 0 k 1 e 2 u e α e u θ sin θ v cos θ sin φ w cos θ cos φ z d u u 0 1 u u 0 k 1 e 2 u e α p e 20 where p e e u θ sin θ v cos θ sin φ w cos θ cos φ z d u u 0 1 step 2 differentiating 18a with respect to time and utilizing 9b we can obtain 21 α θ θ d q cos φ r sin φ θ d define the second clf as v 2 v 1 1 2 α 2 whose time derivative is v 2 v 1 α α u u 0 k 1 e 2 u e α p e α q cos φ r sin φ θ d k 1 e 2 α q cos φ r sin φ θ d u e the second virtual control law is chosen as follows β q q d 22 a q d k 2 α θ d u e 22 b where k 2 0 is control gain hence v 2 u u 0 k 1 e 2 p e α β q d cos φ r sin φ θ d u e u u 0 k 1 e 2 p e α β cos φ α q d cos φ sin φ r θ d u e u u 0 k 1 e 2 p e α β cos φ α k 2 α θ d u e cos φ r sin φ θ d u e u u 0 k 1 e 2 p e α β cos φ k 2 α 2 α θ d u e cos φ 1 r sin φ 23 set p α p e α θ d u e cos φ 1 r sin φ the second clf can be rewritten as follows 24 v 2 u u 0 k 1 e 2 k 2 α 2 p α α β cos φ step 3 from 22a and 12 the derivative of the second virtual control law can be derived as 25 β q q d f q g q x g d q d consider the third clf candidate v 3 v 2 1 2 β 2 and its derivative is v 3 v 2 β β u u 0 k 1 e 2 k 2 α 2 p α α β cos φ β f q g q x g d q d u u 0 k 1 e 2 k 2 α 2 p α β f q g q x g d q d α cos φ the control law is then designed as 26 x g k 3 β f q q d α d ˆ g q where k 3 0 and d ˆ is the estimations of d which is feedback from ndo utilizing 25 and 7 the counterweight position can be determined with the chosen control law we obtain v 3 u u 0 k 1 e 2 k 2 α 2 p α β f q g q k 3 β f q q d α d ˆ g q q d α cos φ d u u 0 k 1 e 2 k 2 α 2 k 3 β 2 p α α β cos φ 1 β d 27 let p β p α α β cos φ 1 then 28 v 3 u u 0 k 1 e 2 k 2 α 2 k 3 β 2 p β β d step 4 define the fourth clf as v 4 v 3 1 2 d 2 differentiating the fourth clf and utilizing 15 yields v 4 v 3 d d u u 0 k 1 e 2 k 2 α 2 k 3 β 2 p β β d d d l d u u 0 k 1 e 2 k 2 α 2 k 3 β 2 l d 2 p β β d d d 29 continue to set p d p β β d d d we get the final result as 30 v 4 u u 0 k 1 e 2 k 2 α 2 k 3 β 2 l d 2 p d 3 3 stability analysis to facilitate the analysis of stability in the next step the following assumptions are required assumption 1 the model uncertainties and the linearization errors are bounded so there exists a positive constant δ d that satisfies d δ d assumption 2 the predefined desired depth is finite such that z d z d and z d are bounded thus from 18b it can be inferred that θ d is bounded and we can set z d δ z d and θ d δ θ d assumption 3 due to the mechanical properties of auv2000 when designed the pitch angle during operation will be bounded specifically θ 70 0 therefore θ sin θ 7 π 18 sin 7 π 18 assumption 4 the surge velocity u of auv is non negative and will converge to the vicinity of the desired operating speed u 0 during movement jalving 1994 fossen 1994 prestero 2001 qiao et al 2018 let the maximum speed of auv be u max we have u u max and u u 0 1 1 assumption 5 the linear and angular velocities of auv are bounded during operation hence there exist the small positive constants δ v δ w and δ r such that the following conditions is satisfied v cos θ sin φ δ v w cos θ cos φ δ w and r sin φ δ r moreover from remark 2 it can be indicated that cos φ 1 δ φ where δ φ is a very small positive constant from 20 23 27 and 29 we have p d e u θ sin θ v cos θ sin φ w cos θ cos φ z d u u 0 1 α θ d u e cos φ 1 r sin φ α β cos φ 1 β d d d utilizing these assumptions above we can obtain 31 p d e u max 7 18 π sin 7 18 π δ v δ w δ z d α δ θ d u max e δ φ δ r α β δ φ β d d δ d let δ e u max 7 18 π sin 7 18 π δ v δ w δ z d and using the young inequality we get 32 p d e δ e u max α e δ φ α δ θ d δ φ δ r α β δ φ β d d δ d e 2 4 ε 1 ε 1 δ e 2 α 2 4 ε 2 ε 2 e 2 u max δ φ α 2 4 ε 3 ε 3 δ θ d δ φ δ r 2 α 2 4 ε 4 ε 4 β 2 δ φ ε 5 β 2 1 4 ε 5 d 2 1 4 ε 6 d 2 ε 6 δ d 2 where ε i i 1 2 3 4 5 6 are positive designed constants substituting 32 into 30 yields 33 v 4 u u 0 k 1 1 4 ε 1 ε 2 u max δ φ e 2 k 2 u max δ φ 4 ε 2 1 4 ε 3 δ φ 4 ε 4 α 2 k 3 ε 4 δ φ ε 5 β 2 l 1 4 ε 5 1 4 ε 6 d 2 ε 1 δ e 2 ε 3 δ θ δ φ δ r 2 ε 6 δ d 2 then we can choose the control gains k j j 1 2 3 that satisfy the following conditions 34 u u 0 k 1 1 4 ε 1 ε 2 u max δ φ 0 k 2 u max δ φ 4 ε 2 1 4 ε 3 δ φ 4 ε 4 0 k 3 ε 4 δ φ ε 5 0 l 1 4 ε 5 1 4 ε 6 0 k 1 1 4 ε 1 ε 2 u max δ φ u 0 u k 2 u max δ φ 4 ε 2 1 4 ε 3 δ φ 4 ε 4 k 3 ε 4 δ φ ε 5 l 1 4 ε 5 1 4 ε 6 denote 35 ρ min u u 0 k 1 1 4 ε 1 ε 2 u max δ φ k 2 u max δ φ 4 ε 2 1 4 ε 3 δ φ 4 ε 4 k 3 ε 4 δ φ ε 5 l 1 4 ε 5 1 4 ε 6 0 μ ε 1 δ e 2 ε 3 δ θ δ φ δ r 2 ε 6 δ d 2 from 33 and 35 it can be inferred that 36 v 4 2 ρ v 4 μ considering the tracking error vector that contains the error states of both the control and observer systems as follows ω e α β d t the fourth clf can be further derived as v 4 1 2 ω 2 which employing the comparison lemma in khalil 2002 yields v 4 t v 4 0 e 2 ρ t μ 2 ρ for t 0 t f i n a l thus 37 ω t ω 0 e ρ t μ ρ t 0 t f i n a l equation 37 means that the tracking error vector remain in a bounded set around zero which can be reduced by increasing ρ and decreasing μ in other words by tuning the control and observer gain k j j 1 2 3 l and choosing ε i i 1 2 3 4 5 6 obviously it can be concluded that the tracking error vector converges to a specified compact set around the origin with the estimated law in 14 and control laws in 18 22 26 remark 3 it is worth noting that the control laws 18 22 and 26 do not contain the roll angle thereby the control signal is independent of the variation of the roll rate and the roll angle during maneuvering this makes the control signal smoother and more accessible to apply in practice 4 simulation results this section presents the numerical simulations of the proposed controller apply to auv2000 on matlab simulink by analyzing the simulation results the effectiveness feasibility and stability of the proposed method are clarified in this study the desired operating speed of the vehicle is considered to be u 0 1 28 m s the control and observer gains selected for the controller are k 1 3 k 2 7 5 k 3 0 15 l 5 to ensure objectivity and completeness in these simulations the vehicle is expected to track different desired paths in the vertical plane besides the initial condition of the auv considered for all simulation is as follows x y z φ θ ψ t 0 0 0 0 0 0 t u v w p q r t 0 0 0 0 0 0 t 4 1 simulations in the absence of the model uncertainties because of the similarity when using the nonlinear algorithm to build the controller for auv2000 the comparison of control performances are constructed between the proposed backstepping controller and the controller developed in tran et al 2019 4 1 1 the desired depth is constant fig 5 shows that both the tran s controller and the backstepping controller perform consistently with the 6 dof model not only speeding up the convergence process of the vehicle to the desired depth but also stabilizing the equilibria however the proposed backstepping controller has better control performance such as no overshoot and faster convergence because fig 6 shows the pitch angle during maneuvering is always within the limit smaller than 70 this ensures that the auv will not fall into a singular point moreover the roll angle overshoots when counterweight displaces abruptly then recovers to an equilibrium therefore it indicates that the proposed controller can operate consistently even when including the involvement of the roll angle roll rate sway velocity yaw rate 4 1 2 the desired depth is not constant z d 0 in this case study we examine the composite desired depth which is a combination of three scenarios are as follows 1 z d 5 0 3 t 0 t 50 2 z d 30 0 2 t 50 t 100 3 z d 30 20 cos 0 005 π t 0 5 π t 100 the results in fig 7 illustrate the disadvantage of most classical controllers prestero 2001 tanakitkorn et al 2017 tran et al 2019 qiao et al 2018 that it is incapable of making the vehicle converge on the desired depth when the desired depth is not constant meanwhile the proposed controller not only ensures excellent tracking performance for auv but also keeps auv s roll angle in a bounded set around zero as shown in fig 8 through all the simulation results above the proposed method has proved its superiority compared to the previous ones because it enables auv to track straight lines even with the curve paths besides the tracking error always converges to zero and has fast convergence speed about 20 s with many different simulation conditions thus the efficiency and stability of the proposed control law are verified moreover it is easily observed that the velocity u is changed when the pitch angle alters thereby using u 0 in the controller design instead of using u in formula 18b delivers the control signal smoother without affecting the system stability 4 2 simulations in the presence of the model uncertainties to evaluate the controller s robustness joe et al 2014 varied the hydrodynamic coefficients by 20 to their actual values qiao et al 2018 and mahapatra and subudhi 2018 considered the uncertainties of the model parameters by 20 25 and 30 of its nominal value respectively in this paper to verify the disturbance resistance and robustness of the proposed controller the parameters of f q and g q in formula 12 deviate by 30 40 from their accurate value in fig 9 the desired depths of several scenarios are as follows 1 z d 20 0 t 60 2 z d 35 0 25 t 60 t 100 3 z d 30 20 cos 0 005 π t 0 5 π t 100 it is noticeable from fig 9 that the proposed controller still works without ndo yet it suffers from a small steady state error besides fig 10 shows that there is hardly any difference in the state variables of the two controllers these simulation results sufficiently validate the strong robustness of the backstepping controller in addition the proposed controller is combined with ndo to compensate for the systematical parametric uncertainties thereby eliminating the steady state error and maintaining the control performance in conclusion the outstanding characteristics of the proposed controller are preserved despite the presence of the model uncertainties and propeller torque s effect 5 conclusion the paper provides a new approach to building the depth tracking controllers for auv2000 a hybrid auv type the proposed controller has been applied to the 6 dof auv model to ensure nonlinearity and strongly coupled in the motion equations as well as a feasibility study for practical applications the paper also considered the effect of roll angle and model uncertainty on the controller and proved the stability of the developed controller the numerical simulations have been carried out and validated to verify the effectiveness and robustness of the proposed method moreover the simulations results demonstrate the proposed control law has superior performance to previous ones and solves the depth control problem more fully for the depth tracking problem in the presence of the model uncertainties and propeller torque s effect declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is funded by vietnam national university ho chi minh city vnu hcm under grant number b2018 20b 01 we acknowledge the support time and facilities from ho chi minh university of technology hcmut vnu hcm laboratory of advance design and manufacturing processes hcmut national key lab of digital control and system engineering dcselab hcmut for this study 
21157,this paper presents a study of depth tracking controller design for a hybrid auv in the presence of model uncertainty and propeller torque s effect firstly the six degrees of freedom 6 dof nonlinear equations of motion as well as the operating mechanisms and specific characteristics of the hybrid auv are described subsequently the model for depth plane is extracted by decoupling and linearizing the 6 dof auv model furthermore a nonlinear disturbance observer ndo is constructed to deal with the linearization errors and uncertain components in the depth plane model a depth tracking controller is then designed based on the backstepping technique to guarantee the tracking error converges to an arbitrarily small neighborhood of zero besides the robust stability of the proposed controller concerning the propeller torque s effect and the model uncertainty is analyzed to ensure the objectivity and feasibility of the proposed method the depth controller is applied to the 6 dof model of auv so that it maintains the coupling between roll yaw and pitch motion finally the numerical simulation is carried out via matlab simulink to verify the controller s effectiveness feasibility and stability keywords autonomous underwater vehicle auv depth control backstepping 1 introduction nowadays autonomous underwater vehicles auv have become a major tool for activities in deep sea because of the significant improvement in their performance specifically in the scientific field is surveys data collection and environmental sampling for hydrological research wynn et al 2014 eichhorn et al 2018 in the military is clearing sea mines planted by enemies conducting war activities with the navy hagen et al 2003 mondal et al 2019 in the commercial field auvs are used to make detailed maps and surveys of the seafloor oil and gas industries before building subsea infrastructure mondal et al 2019 zhang et al 2015 therefore research and development of controllers for auv are essential in general the controller design bases on the assumption that the model parameters are accurate however the model of auv is a set of highly coupled nonlinear equations newman 1977 fossen 1994 that lead to identifying completely accurate models through estimation or empirical methods etc is a difficult task besides many control algorithms based on the linearization methods around the working point will have a sharply reduced performance when either changing the model parameters or applying in practice this can be seen through the comparison of simulation and experimental results in naik and singh 2007 prestero 2001 mahapatra and subudhi 2018 therefore stability analysis and quality characterization surveys of the controller under the effect of model uncertainty is essential the control problem for auv is a complex issue so it is usually divided into three sub problems for steering diving and speed control jalving 1994 in each sub problem it will be linearized to reduce interaction between each other thereby simplifying the design of the controller consequently auv usually has three main controllers that are speed steering and diving controllers in this paper we only focus on studying the depth control problem diving control problem for auv for the depth control problem in recent years there have been many research projects showing the different algorithms applied to design the depth controller for auv for instance with the simplest and most common algorithm pid there are jalving 1994 prestero 2001 tanakitkorn et al 2017 in jalving 1994 after decomposing the auv control into three subsystems the pid controller was built for each system for the depth controller the mathematical model of depth plane is established under the state space form by linearizing and decoupling the motion model of auv in the vertical plane the pitch transfer function and the depth transfer function are then extracted from the state space model to analyze then the parameters are selected to stabilize for the closed loop transfer function of the whole system in following the same approach as jalving 1994 prestero 2001 has developed a simple pitch and depth pd controller based on transfer functions derived from the linear state space model in tanakitkorn et al 2017 the pi d scheme has been used to design the depth controller for delphin2 auv this pi d scheme has the derivative term fed by an actual state of the system instead of the tracking error to avoid the effect of the sudden change of setting value the pi d controller will make the system works more smoothly but this controller will not be able to process the time varying desired signal moreover the controller gain values are identified using a heuristic approach based on the ziegler nichols method besides linear controllers nonlinear algorithms have also been studied and applied to auv specifically hong et al 2010 joe et al 2014 yan et al 2016 tran et al 2019 have developed various sliding mode control smc algorithms for the depth plane motion of auvs hong et al 2010 presented how to build an smc controller and an experimental verification of it this paper also addresses the effect of positive buoyancy in the dynamic model nevertheless the author did not analyze the stability nor pointed out the advantages of the proposed control algorithm in joe et al 2014 a second order smc was designed based on the 4 dof diving model of auv ignore roll and pitch the simulation and experiment were conducted on cyclops auv to verify the stability of the controller in the presence of parameter uncertainties and external disturbances however the internal stability of the closed loop system was not guaranteed an integral fast terminal sliding mode control iftsmc was explored by yan et al 2016 to control the auv under the effect of parameter perturbations and wave disturbances notwithstanding this paper only proves the convergence on the 3 dof linear motion model of auv in the vertical plane tran et al 2019 proposed an indirect strategy to control depth for the hybrid auv through pitch angle control the simulation results show the simplicity and effectiveness of the proposed strategy but the paper does not analyze the stability and performance of the controller when there are parameter uncertainties moreover several studies on backstepping techniques applied to depth control have been developed by lapierre 2009 cao et al 2011 wei et al 2015 gharesi et al 2017 mahapatra and subudhi 2018 lapierre 2009 proposed the adaptive controller and switching schemes to resolve external parameter uncertainty in this paper the adaptive laws were developed instead of the disturbance rejection to ensure the robustness the simulation results show that the controller can handle when there are parameter uncertainties however the control performance isn t high such as the response time is slow the control signal is not smooth another backstepping controller combined with adaptive law to solve the parameter uncertainty and external disturbance was also discovered by cao et al 2011 nevertheless the controller design and verification simulation were based only on the 3 dof model in depth plane wei et al 2015 formulated a linear state space equation for vertical motion of auv then used backstepping techniques to build controllers this paper addressed model uncertainties and developed a nonlinear disturbance observer ndo to deal with it similarly a backstepping controller combines with a linear extended state observer leso was design by gharesi et al 2017 further mahapatra and subudhi 2018 explored a depth control using the backstepping technique and nonlinear h infinity technique in this paper random perturbations and uncertain hydrodynamic parameters were used to investigate the robustness of the proposed controller the simulation and experiment results demonstrated the controller s effectiveness and feasibility however the control performance decline is proportional to the uncertainty magnitude additionally there exist other methods which are applied to control the depth of auv for example a gain scheduling controller is proposed by silvestre and pascoal 2007 using a reduced output feedback technique for infante auv or the state dependent riccati equation sdre technique developed in naik and singh 2007 further a constrained self tuning controller based on nonlinear auto regressive moving average exogenous narmax is utilized by rout and subudhi 2017 to track a given reference for a torpedo shaped auv besides yu et al 2018 explores a sliding mode fuzzy control method combines with line of sight los guidance law to apply to a bioinspired robotic dolphin moreover various h control methods have been developed for underwater vehicles by liceaga castro and van der molen 1995 moreira and soares 2008 mahapatra et al 2016 mahapatra and subudhi 2018 similarly the h 2 optimal control methods applied to auv in moreira and soares 2008 wadoo et al 2012 qiao et al 2018 in general the papers mentioned above often use linearizing and decoupling equations 3 dof or 4 dof in the vertical motion of auv for controller design stability analysis and simulation it means that the coupling between roll pitch and yaw motion is neglected note that a torpedo shaped auv has a small moment of inertia and drag in the roll motion thus the roll dynamic easily suffers oscillatory when the auv is affected by propeller torque unknown disturbances yaw and pitch motion moreover the roll motion is dynamically coupled into pitch motion so unwanted roll motion can reduce the diving performance and provide no clear opportunities for suppressing roll motion petrich and stilwell 2011 besides due to hydrodynamic characteristics the motion equations of auv are highly nonlinear and strongly coupled so it is inevitable to have model uncertainties in the linear process therefore it is necessary to investigate the robust stability and performance of the controller in the presence of propeller torque s effect and model uncertainties on the other hand the simulation model of auv should be 6 dof to ensure objectivity as well as the accuracy of the designed controller motivated by the aforementioned analysis this paper focuses on designing the nonlinear tracking controller for the vertical motion of a hybrid auv the control laws are produced by employing the backstepping technique to ensure stability and force the depth tracking error to an arbitrarily small neighborhood of zero regardless of propeller torque s effect and model uncertainties the designed controller is applied to a 6 dof nonlinear model to ensure objectivity and feasibility the simulation results will be specific evidence showing the efficiency disturbances rejection ability robustness and superiority of the proposed method the remnant of this paper is organized as follows section 2 presents the auv 6 dof models the operating mechanisms and specific characteristics of the hybrid auv and formulates control problem section 3 proposes the design of nonlinear disturbance observer ndo and backstepping controller for the depth plane motion of the auv and also analyzes the robust stability of the proposed controller under propeller torque s effect and model uncertainties in section 4 the numerical simulations and discussions are carried out to validates the previous analysis and design finally the conclusions of this work are presented in section 5 2 auv modelling and problem formulation 2 1 auv modelling the model will be considered in this paper is the auv2000 mentioned in tran et al 2019 auv2000 shown in fig 1 is a hybrid auv designed to integrate the outstanding characteristics of conventional auv and underwater glider a type of auv that employs variable buoyancy propulsion instead of traditional propellers or thrusters therefore auv2000 can operate in two separate modes specifically without using the thruster glider mode and using the thruster auv mode however in this paper we only focus on designing the depth controller for auv2000 in auv mode 2 1 1 kinematics model in accordance with sname sname 1950 the 6 dof nonlinear kinematic and dynamic equations of motion of auv are described in the earth fixed frame e and the body fixed frame b as shown in fig 2 according to fossen we have coordinate transform relating the translational velocities and the rotational velocities between b and e for various underwater vehicles in general and auv in particular as follows 1 x y z j 1 η 2 u v w φ θ ψ j 2 η 2 p q r where j 1 η 2 cos ψ cos θ sin ψ cos φ cos ψ sin θ sin φ sin ψ sin φ cos ψ sin θ cos φ sin ψ cos θ cos ψ cos φ sin ψ sin θ sin φ cos ψ sin φ sin ψ sin θ cos φ sin θ cos θ sin φ cos θ cos φ j 2 η 2 1 sin φ tan θ cos φ tan θ 0 cos φ sin φ 0 sin φ cos θ cos φ cos θ η 1 x y z t the position of the vehicle with respect to e η 2 φ θ ψ t the orientation roll pitch yaw of the vehicle with respect to e υ 1 u v w t the translational velocities of the vehicle with respect to b υ 2 p q r t the rotational velocities of the vehicle with respect to b 2 1 2 dynamic model of hybrid auv following to prestero 2001 the 6 dof nonlinear dynamic equations of motion of auv2000 can be expressed as 2a m u v r w q x g q 2 r 2 y g p q r z g p r q x e x t 2b m v w p u r y g r 2 p 2 z g q r p x g q p r y e x t 2c m w u q v p z g p 2 q 2 x g r p q y g r q p z e x t 2d i x x p i z z i y y q r m y g w u q v p z g v w p u r k e x t 2e i y y q i x x i z z r p m z g u v r w q x g w u q v p m e x t 2f i z z r i y y i x x p q m x g v w p u r y g u v r w q n e x t where m is the auv s mass x g y g z g is the center of gravity and i x x i y y i z z respectively are inertial moments about the x y and z axes the right side of equations 2a 2f are the sum of the components of the force and moment acting on the vehicle 3a x e x t x u u z w w q z q q 2 y v v r y r r 2 x u u u u w b sin θ x p r o p 3b y e x t y v v y r r x u u r z w w p z q p q y v v v v y r r r r y u v l u v w b cos θ sin φ y r u d 3c z e x t z w w z q q x u u q y v v p y r r p z w w w w z q q q q z u w l z u w f u w z u q f u q w b cos θ cos φ 3d k e x t k p p z w y v w v z q y r v q z q y r w r n r m q q r k p p p p y g w y b b cos θ cos φ z g w z b b cos θ sin φ k p r o p 3e m e x t z q w m q q z w x u u w y r v p k p n r r p z q u q m w w w w m q q q q m u w l m u w f u w m u q f u q z g w z b b sin θ x g w x b b cos θ cos φ 3f n e x t n v v n r r x u y v u v z q w p k p m q p q y r u r n v v v v n r r r r n u v l u v x g w x b b cos θ sin φ y g w y b b sin θ n r u d in 3a 3f x y z k m n are the added mass damping and lift terms x b y b z b is the center of buoyancy w and b respectively are weight and buoyancy of auv the propeller force and torque are x p r o p and k p r o p and the rudder force and moment are y r u d and n r u d in this paper since we only concentrate on depth control we will reduce y r u d n r u d to zero in subsequent calculations 2 1 3 the novel characteristic and operating mechanisms of auv2000 as mentioned above auv2000 is a hybrid auv that is designed to operate without using the thruster therefore many structural elements resemble those of a typical underwater glider the most significant of which are counterweight system and ballast system in this section the dissection of these operating mechanisms of auv2000 is presented thereby paving the way for the construction of the controller in the next section 2 1 3 1 buoyancy engine dynamics analysis auv2000 ballast system is a piston cylinder which is arranged as shown in fig 3 let v f i x be the volume occupied by auv when the ballast system is full of water and r f i x l f i x 0 0 t be the current position of the center of buoyancy of auv considered in the body fixed frame moreover denote v var as the volume of water that the cylinder emits then its relation to the position of the piston is formularized as 4 v var s c l c x p where s c is the cross section of cylinder l c is the length of cylinder and x p is the piston position from fig 3 the formula for determining the buoyancy center of auv can be expressed as 5 r c b x b 0 0 t v var l c x p 2 v f i x l f i x v var v f i x 0 0 t and the buoyancy of auv is 6 b ρ g v f i x v var where ρ is the density of fluid g is the gravitational acceleration 2 1 3 2 analysis of the counterweight system denote the total weight of auv without counterweight fig 4 as m h and let r h l h x l h y l h z t be the mass center of m h in the body fixed frame because the counterweight s mass m m is evenly distributed around the x axis the mass center of the counterweight in the body fixed frame is r m x m 0 0 t where x m is the counterweight position as a result the center of gravity of auv can be determined by the following formula 7 r c g m h r h m m r m m h m m x g y g z g t m h l h x m m x m m h m m m h l h y m h m m m h l h z m h m m t and the weight of auv is 8 w m g m h m m g remark 1 note that because r h is constant it is evident from 7 that moving the counterweight only alters x g in other words y g and z g are constant remark 2 like remus in prestero 2001 to deal with propeller torque s effect auv2000 s internal devices are arranged to obtain y g z g so that the hydrostatic roll moment matches propeller torque thus compensating for the roll offset therefore by setting the number of revolutions rpm for the propeller to achieve the operating speed of auv the roll angle will be small and bounded during movement 2 2 problem formulation in this paper the objective is to develop a controller to maneuver the auv tracking the desired depth in the vertical plane notwithstanding of highly coupled model nonlinearities propeller torque s effect and model uncertainties the objective can be divided into three subproblems as shown below nonlinear disturbance observer ndo is employed to deal with linearization errors and model uncertainties in the depth plane model given a desired depth z d design a control law that determines the position of the counterweight based on the backstepping technique to guarantee the depth tracking error converges to an arbitrarily small neighborhood around zero as t goes to infinity despite model uncertainties and propeller torque s effect the numerical simulations of the proposed controller applied to the 6 dof auv model are carried out to verify the disturbance resistance robustness and effectiveness of the developed control law 3 controller design there exists various methods to build a depth controller for auv some of which are based on a state space equation linearized from the depth plane model silvestre and pascoal 2007 naik and singh 2007 wei et al 2015 gharesi et al 2017 transfer function jalving 1994 prestero 2001 qiao et al 2018 los in the vertical plane tran et al 2019 yu et al 2018 rout and subudhi 2017 this paper presents a different methodology to build a depth controller using the backstepping technique before starting the design of the controller it is noticeable that when the auv operates without thruster the ballast system no longer affects too much to the diving and floating process of auv therefore for convenience and simplicity the paper will consider the ballast system with the volume to balance the buoyancy with the weight of auv utilizing 6 8 and 4 we can solve the position of piston to satisfy condition b w from 1 we derive two differential equations for depth and pitch as follows z u sin θ v cos θ sin φ w cos θ cos φ 9 a θ q cos φ r sin φ 9 b further combining 2e and 3e the nonlinear dynamic equation of pitch can be expressed as 10 i y y q i x x i z z r p m z g u v r w q x g w u q v p z q w m q q z w x u u w y r v p k p n r r p z q u q m w w w w m q q q q m u w l m u w f u w m u q f u q z g w z b b sin θ x g w x b b cos θ cos φ performing linearization for equation 10 with u w p v r φ 0 and note that z b 0 from 5 we can obtain 11 i y y m q q m u w l m u w f z w x u u w m u q f z q u q m w w w w m q q q q m z g w q z g w sin θ x b b cos θ m u q w cos θ x g now from 10 and 11 we can derive pitch dynamic equation as following form 12 q f q g q x g d where f q x u z w m u w l m u w f u w m u q f z q u q m w w w w m q q q q m z g w q z g w sin θ x b b cos θ i y y m q g q m u q w cos θ i y y m q d is the sum of the uncertain components of the model and the linearization errors thereby the depth plane model can be expressed as 13 z u sin θ v cos θ sin φ w cos θ cos φ θ q cos φ r sin φ q f q g q x g d 3 1 ndo design to estimate d we define the new variable f d l q where l 0 is the observer gain which needs to be selected later then the nonlinear disturbance observer for d is constructed as follows 14 d ˆ f ˆ l q f ˆ l f q g q x m d ˆ where d ˆ and f ˆ are the estimations of d and f respectively the estimated error is defined d d d ˆ and its derivative is 15 d d d ˆ d f ˆ l q d l f q g q x m d ˆ l f q g q x m d d l d 3 2 backstepping controller design from here we start building control laws by the backstepping technique and lyapunov functions as follows step 1 let the desired depth be z d then the depth error can be defined as 16 e z z d take the derivative of the depth error and utilizing 9a yields 17 e u sin θ v cos θ sin φ w cos θ cos φ z d define the first control lyapunov function clf as v 1 1 2 e 2 whose time derivative is v 1 e e e u sin θ v cos θ sin φ w cos θ cos φ z d the first virtual control law is selected as follows α θ θ d 18 a θ d k 1 e z d u 0 18 b where u 0 is desired operating speed of auv and k 1 is the control gain which needs to be determined then the derivative of the first clf can be expressed as 19 v 1 e u θ sin θ u θ v cos θ sin φ w cos θ cos φ z d u e θ sin θ e u α θ d v cos θ sin φ w cos θ cos φ z d u e θ sin θ u e α e u k 1 e z d u 0 v cos θ sin φ w cos θ cos φ z d u u 0 k 1 e 2 u e α e u θ sin θ v cos θ sin φ w cos θ cos φ z d u u 0 1 u u 0 k 1 e 2 u e α p e 20 where p e e u θ sin θ v cos θ sin φ w cos θ cos φ z d u u 0 1 step 2 differentiating 18a with respect to time and utilizing 9b we can obtain 21 α θ θ d q cos φ r sin φ θ d define the second clf as v 2 v 1 1 2 α 2 whose time derivative is v 2 v 1 α α u u 0 k 1 e 2 u e α p e α q cos φ r sin φ θ d k 1 e 2 α q cos φ r sin φ θ d u e the second virtual control law is chosen as follows β q q d 22 a q d k 2 α θ d u e 22 b where k 2 0 is control gain hence v 2 u u 0 k 1 e 2 p e α β q d cos φ r sin φ θ d u e u u 0 k 1 e 2 p e α β cos φ α q d cos φ sin φ r θ d u e u u 0 k 1 e 2 p e α β cos φ α k 2 α θ d u e cos φ r sin φ θ d u e u u 0 k 1 e 2 p e α β cos φ k 2 α 2 α θ d u e cos φ 1 r sin φ 23 set p α p e α θ d u e cos φ 1 r sin φ the second clf can be rewritten as follows 24 v 2 u u 0 k 1 e 2 k 2 α 2 p α α β cos φ step 3 from 22a and 12 the derivative of the second virtual control law can be derived as 25 β q q d f q g q x g d q d consider the third clf candidate v 3 v 2 1 2 β 2 and its derivative is v 3 v 2 β β u u 0 k 1 e 2 k 2 α 2 p α α β cos φ β f q g q x g d q d u u 0 k 1 e 2 k 2 α 2 p α β f q g q x g d q d α cos φ the control law is then designed as 26 x g k 3 β f q q d α d ˆ g q where k 3 0 and d ˆ is the estimations of d which is feedback from ndo utilizing 25 and 7 the counterweight position can be determined with the chosen control law we obtain v 3 u u 0 k 1 e 2 k 2 α 2 p α β f q g q k 3 β f q q d α d ˆ g q q d α cos φ d u u 0 k 1 e 2 k 2 α 2 k 3 β 2 p α α β cos φ 1 β d 27 let p β p α α β cos φ 1 then 28 v 3 u u 0 k 1 e 2 k 2 α 2 k 3 β 2 p β β d step 4 define the fourth clf as v 4 v 3 1 2 d 2 differentiating the fourth clf and utilizing 15 yields v 4 v 3 d d u u 0 k 1 e 2 k 2 α 2 k 3 β 2 p β β d d d l d u u 0 k 1 e 2 k 2 α 2 k 3 β 2 l d 2 p β β d d d 29 continue to set p d p β β d d d we get the final result as 30 v 4 u u 0 k 1 e 2 k 2 α 2 k 3 β 2 l d 2 p d 3 3 stability analysis to facilitate the analysis of stability in the next step the following assumptions are required assumption 1 the model uncertainties and the linearization errors are bounded so there exists a positive constant δ d that satisfies d δ d assumption 2 the predefined desired depth is finite such that z d z d and z d are bounded thus from 18b it can be inferred that θ d is bounded and we can set z d δ z d and θ d δ θ d assumption 3 due to the mechanical properties of auv2000 when designed the pitch angle during operation will be bounded specifically θ 70 0 therefore θ sin θ 7 π 18 sin 7 π 18 assumption 4 the surge velocity u of auv is non negative and will converge to the vicinity of the desired operating speed u 0 during movement jalving 1994 fossen 1994 prestero 2001 qiao et al 2018 let the maximum speed of auv be u max we have u u max and u u 0 1 1 assumption 5 the linear and angular velocities of auv are bounded during operation hence there exist the small positive constants δ v δ w and δ r such that the following conditions is satisfied v cos θ sin φ δ v w cos θ cos φ δ w and r sin φ δ r moreover from remark 2 it can be indicated that cos φ 1 δ φ where δ φ is a very small positive constant from 20 23 27 and 29 we have p d e u θ sin θ v cos θ sin φ w cos θ cos φ z d u u 0 1 α θ d u e cos φ 1 r sin φ α β cos φ 1 β d d d utilizing these assumptions above we can obtain 31 p d e u max 7 18 π sin 7 18 π δ v δ w δ z d α δ θ d u max e δ φ δ r α β δ φ β d d δ d let δ e u max 7 18 π sin 7 18 π δ v δ w δ z d and using the young inequality we get 32 p d e δ e u max α e δ φ α δ θ d δ φ δ r α β δ φ β d d δ d e 2 4 ε 1 ε 1 δ e 2 α 2 4 ε 2 ε 2 e 2 u max δ φ α 2 4 ε 3 ε 3 δ θ d δ φ δ r 2 α 2 4 ε 4 ε 4 β 2 δ φ ε 5 β 2 1 4 ε 5 d 2 1 4 ε 6 d 2 ε 6 δ d 2 where ε i i 1 2 3 4 5 6 are positive designed constants substituting 32 into 30 yields 33 v 4 u u 0 k 1 1 4 ε 1 ε 2 u max δ φ e 2 k 2 u max δ φ 4 ε 2 1 4 ε 3 δ φ 4 ε 4 α 2 k 3 ε 4 δ φ ε 5 β 2 l 1 4 ε 5 1 4 ε 6 d 2 ε 1 δ e 2 ε 3 δ θ δ φ δ r 2 ε 6 δ d 2 then we can choose the control gains k j j 1 2 3 that satisfy the following conditions 34 u u 0 k 1 1 4 ε 1 ε 2 u max δ φ 0 k 2 u max δ φ 4 ε 2 1 4 ε 3 δ φ 4 ε 4 0 k 3 ε 4 δ φ ε 5 0 l 1 4 ε 5 1 4 ε 6 0 k 1 1 4 ε 1 ε 2 u max δ φ u 0 u k 2 u max δ φ 4 ε 2 1 4 ε 3 δ φ 4 ε 4 k 3 ε 4 δ φ ε 5 l 1 4 ε 5 1 4 ε 6 denote 35 ρ min u u 0 k 1 1 4 ε 1 ε 2 u max δ φ k 2 u max δ φ 4 ε 2 1 4 ε 3 δ φ 4 ε 4 k 3 ε 4 δ φ ε 5 l 1 4 ε 5 1 4 ε 6 0 μ ε 1 δ e 2 ε 3 δ θ δ φ δ r 2 ε 6 δ d 2 from 33 and 35 it can be inferred that 36 v 4 2 ρ v 4 μ considering the tracking error vector that contains the error states of both the control and observer systems as follows ω e α β d t the fourth clf can be further derived as v 4 1 2 ω 2 which employing the comparison lemma in khalil 2002 yields v 4 t v 4 0 e 2 ρ t μ 2 ρ for t 0 t f i n a l thus 37 ω t ω 0 e ρ t μ ρ t 0 t f i n a l equation 37 means that the tracking error vector remain in a bounded set around zero which can be reduced by increasing ρ and decreasing μ in other words by tuning the control and observer gain k j j 1 2 3 l and choosing ε i i 1 2 3 4 5 6 obviously it can be concluded that the tracking error vector converges to a specified compact set around the origin with the estimated law in 14 and control laws in 18 22 26 remark 3 it is worth noting that the control laws 18 22 and 26 do not contain the roll angle thereby the control signal is independent of the variation of the roll rate and the roll angle during maneuvering this makes the control signal smoother and more accessible to apply in practice 4 simulation results this section presents the numerical simulations of the proposed controller apply to auv2000 on matlab simulink by analyzing the simulation results the effectiveness feasibility and stability of the proposed method are clarified in this study the desired operating speed of the vehicle is considered to be u 0 1 28 m s the control and observer gains selected for the controller are k 1 3 k 2 7 5 k 3 0 15 l 5 to ensure objectivity and completeness in these simulations the vehicle is expected to track different desired paths in the vertical plane besides the initial condition of the auv considered for all simulation is as follows x y z φ θ ψ t 0 0 0 0 0 0 t u v w p q r t 0 0 0 0 0 0 t 4 1 simulations in the absence of the model uncertainties because of the similarity when using the nonlinear algorithm to build the controller for auv2000 the comparison of control performances are constructed between the proposed backstepping controller and the controller developed in tran et al 2019 4 1 1 the desired depth is constant fig 5 shows that both the tran s controller and the backstepping controller perform consistently with the 6 dof model not only speeding up the convergence process of the vehicle to the desired depth but also stabilizing the equilibria however the proposed backstepping controller has better control performance such as no overshoot and faster convergence because fig 6 shows the pitch angle during maneuvering is always within the limit smaller than 70 this ensures that the auv will not fall into a singular point moreover the roll angle overshoots when counterweight displaces abruptly then recovers to an equilibrium therefore it indicates that the proposed controller can operate consistently even when including the involvement of the roll angle roll rate sway velocity yaw rate 4 1 2 the desired depth is not constant z d 0 in this case study we examine the composite desired depth which is a combination of three scenarios are as follows 1 z d 5 0 3 t 0 t 50 2 z d 30 0 2 t 50 t 100 3 z d 30 20 cos 0 005 π t 0 5 π t 100 the results in fig 7 illustrate the disadvantage of most classical controllers prestero 2001 tanakitkorn et al 2017 tran et al 2019 qiao et al 2018 that it is incapable of making the vehicle converge on the desired depth when the desired depth is not constant meanwhile the proposed controller not only ensures excellent tracking performance for auv but also keeps auv s roll angle in a bounded set around zero as shown in fig 8 through all the simulation results above the proposed method has proved its superiority compared to the previous ones because it enables auv to track straight lines even with the curve paths besides the tracking error always converges to zero and has fast convergence speed about 20 s with many different simulation conditions thus the efficiency and stability of the proposed control law are verified moreover it is easily observed that the velocity u is changed when the pitch angle alters thereby using u 0 in the controller design instead of using u in formula 18b delivers the control signal smoother without affecting the system stability 4 2 simulations in the presence of the model uncertainties to evaluate the controller s robustness joe et al 2014 varied the hydrodynamic coefficients by 20 to their actual values qiao et al 2018 and mahapatra and subudhi 2018 considered the uncertainties of the model parameters by 20 25 and 30 of its nominal value respectively in this paper to verify the disturbance resistance and robustness of the proposed controller the parameters of f q and g q in formula 12 deviate by 30 40 from their accurate value in fig 9 the desired depths of several scenarios are as follows 1 z d 20 0 t 60 2 z d 35 0 25 t 60 t 100 3 z d 30 20 cos 0 005 π t 0 5 π t 100 it is noticeable from fig 9 that the proposed controller still works without ndo yet it suffers from a small steady state error besides fig 10 shows that there is hardly any difference in the state variables of the two controllers these simulation results sufficiently validate the strong robustness of the backstepping controller in addition the proposed controller is combined with ndo to compensate for the systematical parametric uncertainties thereby eliminating the steady state error and maintaining the control performance in conclusion the outstanding characteristics of the proposed controller are preserved despite the presence of the model uncertainties and propeller torque s effect 5 conclusion the paper provides a new approach to building the depth tracking controllers for auv2000 a hybrid auv type the proposed controller has been applied to the 6 dof auv model to ensure nonlinearity and strongly coupled in the motion equations as well as a feasibility study for practical applications the paper also considered the effect of roll angle and model uncertainty on the controller and proved the stability of the developed controller the numerical simulations have been carried out and validated to verify the effectiveness and robustness of the proposed method moreover the simulations results demonstrate the proposed control law has superior performance to previous ones and solves the depth control problem more fully for the depth tracking problem in the presence of the model uncertainties and propeller torque s effect declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is funded by vietnam national university ho chi minh city vnu hcm under grant number b2018 20b 01 we acknowledge the support time and facilities from ho chi minh university of technology hcmut vnu hcm laboratory of advance design and manufacturing processes hcmut national key lab of digital control and system engineering dcselab hcmut for this study 
21158,the present paper addresses the frictional effect on the circular armour wire lateral buckling in an umbilical for wet annulus condition a nonlinear static finite element model is developed where only one single circular armour wire is simulated and the contact interface with the neighboring layer is represented by a deformable rigid toroid surface the isotropic coulomb friction model regularized with an elastic domain is implemented to simulate the shear interaction case studies are carried out by applying different axial compression and cyclic bending curvatures between zero and a maximum value in one bending direction the minimal axial compression that may cause the armour wire lateral buckling after numerous bending cycles is approximately estimated by fitting the numbers of bending cycles to initiate the buckling under different axial compression through an empirical model the friction coefficient and the maximum elastic slip employed in the coulomb friction model are varied for the parametric studies and their effects on the armour wire sticking slipping status the end shortenings and deflections in cyclic bending the critical lateral buckling limit as well as the stress state at the onset of lateral buckling are extensively discussed keywords umbilicals cables tensile armour wires lateral buckling friction 1 introduction umbilicals and flexible pipes are essential components widely employed in offshore oil and gas field development in general flexible pipes are used for the transportation of liquid or gas between subsea installations and floating production units whereas umbilicals may serve for different purposes such as transferring electrical and hydraulic power electrical and fiber optic signals chemical fluids as well as gas for the artificial lift between the surface facilities and subsea equipment their functions and integration are achieved by composite structures consisting of several layers with specific functions the tensile armour wires normally consisting of two layers of helically counter wound steel wires are key structural components supporting most of the axial tension compression and bending loads in most of the applications steel wires with a quasi rectangular cross section are used in flexible pipes whereas steel wires with a circular cross section are preferably employed in umbilicals failure of the tensile armour wires may result in the loss of the structural integrity and is thus not permitted one of the failure mode that has received considerable attention is the armour wire buckling which usually takes place in the flexible pipe and umbilical when exposed to large axial compression such axial compression may be generated by large dynamic motions of the connecting floating platform as well as the so called reversed end cap effect brack et al 2005 while many tests have been performed on the armour wire buckling in flexible pipes either offshore or in laboratory braga and kaleff 2004 bectarte and coutarel 2004 østergaard et al 2012 amarante et al 2018 li et al 2019a very little data has been published concerning the armour wire buckling in umbilicals as the reversed end cap effect is not significant nonetheless a dynamic analysis performed by garcía et al 2015 indicates that an umbilical may also be exposed to large axial compression during extreme weather conditions thus attention should also be paid to umbilical armour wire buckling under specific conditions driven by the large axial compression the armour wire may buckle in either radial or circumferential directions which are well known as birdcaging and lateral buckling respectively for the flexible pipes and umbilicals that may be exposed to large axial compression in their service lives high strength tapes are generally applied over the armour wires to reinforce the radial resistance against the armour wire radial expansion sousa et al 2012 rabelo et al 2015 sævik and thorsen 2017 li et al 2019c nonetheless the armour wires still retain the degree of freedom to deflect in the lateral direction which is principally retarded by the friction on the interfaces between armour wires and neighboring layers the frictional resistance plays a significant role on the armour wire sliding in bending a small frictional resistance facilitates the armour wire sliding thus promoting the lateral buckling the lateral buckling is generally encountered in the wet annulus condition since the frictional resistance is appreciably reduced under this circumstance also as the inner armour wires experience lesser frictional resistance than the outer armour wires in axial compression the lateral buckling is always triggered by the failure of the inner armour wires moreover it also needs to be noted that cyclic bending is essential for the generation of lateral buckling as it facilitates the armour wire sliding against the frictional resistance therefore accurate modeling of friction behavior is vital for the lateral buckling mechanism simulation the fundamental physics behind friction is extremely complex and many variables may affect the friction between the armour wires and the adjacent layers such as sliding velocity temperature material aging geometric properties of the interface seawater lubrication in the flooded condition etc note that a polymeric tape is generally placed between the armour wire layers to reduce the abrasion between metallic layers when the flexible pipe or umbilical operates under large axial load grooves may be formed on the polymeric tape along the helix paths of armour wires which compels the frictional resistance to be dependent on the sliding direction this is especially the case for umbilicals since such grooves may be more notable due to the circular armour wire cross section the groove effect on the armour wire sliding in a flexible pipe has been thoroughly studied by dai et al 2018 using the anisotropic friction model that has been presented among others by ozaki et al 2012 nonetheless despite the complexity of the fundamental physics behind friction it can be represented by empirical models with sufficient accuracy in many applications the most commonly used empirical shear interaction formulation is the coulomb friction model which consists of static and kinetic frictions that describe respectively the resistances to relative lateral motion between non moving and moving surfaces assuming the friction is independent of the sliding velocity and contact area the static and kinetic frictions can be evaluated respectively by multiplying the coefficients of static and kinetic frictions to the normal contact force a sensitivity study on the effect of the transition domain from static to kinetic friction on flexible pipe bending behavior has been presented by dai et al 2017a although the maximum static friction is generally larger than kinetic friction they are usually assumed equal in simulations of flexible pipes and umbilicals and the applied friction coefficient is normally obtained as an average value between the static and dynamic friction coefficients observed during cyclic runs in tests moreover although the standard coulomb friction model assumes that no relative motion occurs if the equivalent friction is less than the maximum static friction in the numerical algorithm the condition of no relative motion is generally approximated by stiff elastic behavior this isotropic coulomb friction model regularized with an elastic domain with the analogy to the elastic ideally plastic material model concept is widely used in the flexible pipe and umbilical simulations by many authors smith et al 2007 ekeberg et al 2006 sævik 2011 dai et al 2020 despite the reduced number of references for circular armour wire lateral buckling in umbilicals published to date many numerical simulations have been performed on the armour wire lateral buckling in flexible pipes due to its intrinsic relevance those simulations on the flexible pipe armour wire lateral buckling will hereby be presented vaz and rizzo 2011 and li 2014 studied the armour wire buckling in a flexible pipe under axisymmetric compression and external hydrostatic pressure where only one armour wire was modeled to represent each armour wire layer thus significantly reducing the computational costs the friction coefficient was varied for parameter study and the default maximum elastic slip given as 0 005 times the characteristic contact surface length in abaqus was adopted moreover employing a similar modeling strategy nygård 2012 and yang et al 2015 investigated the armour wire buckling in axisymmetric compression where the armour wire is simulated by curved beam elements a sensitivity study was performed by varying the maximum elastic slip between 0 05 m m and 0 2 m m and it was demonstrated that the stability limit decreases with the increasing maximum elastic slip yang et al 2015 besides sertã et al 2012 presented a finite element model for the prediction of armour wire buckling in a flexible pipe however no information related to the contact property was presented additionally also implementing coulomb s law of friction malta and martins 2019 presented a finite element study on the frictional effect on the armour wire buckling in a flexible pipe subjected to axisymmetric compression where all the armour wires were modeled similar finite element studies on the armour wire buckling in axisymmetric compression were also presented by tang et al 2019 and liu et al 2019 sævik and ji 2014 simulated the armour wire lateral buckling in axial compression and cyclic bending where only four armour wires were modeled in each armour wire layer to reduce the computational costs the coulomb friction model was used with friction coefficient and maximum elastic slip equal to respectively 0 15 and 0 1 m m good correlations with the test data presented by østergaard et al 2012 were demonstrated this model was further updated by zhou et al 2015 by considering the anti birdcage tape and it was found that its presence resists the end rotation thus slowing down the buckling process besides østergaard et al 2011 investigated the frictional effect on a single armour wire lateral buckling within a toroid wall subjected to compression and cyclic bending by solving a two point boundary value problem described by six first order nonlinear differential equations system coulomb friction was used where the friction coefficient and the maximum elastic slip were set as 0 1 and 5 m m respectively as a consequence of applying this relatively large elastic slip the armour wire is less prone to slide and it may not experience full friction additionally assuming that the armour wire deflection is periodic caleyron et al 2017 presented a numerical methodology to investigate armour wire buckling in compression and cyclic bending where the armour wires are represented by repeated unit cells a case study was presented where the friction coefficient 0 18 was prescribed for all interfaces based on a similar repeated unit cell method concept lukassen et al 2019 developed a finite element model applicable to armour wire lateral buckling analysis in which the friction coefficient and the maximum elastic slip were set respectively as 0 12 and 0 005 m m more recently gonzalez et al 2019 presented a finite element model to study the armour wire lateral buckling where the bending effect is addressed by assuming that the pre buckling configurations follow geodesic or loxodromic curves in this study the friction on the armour wire was approximated by a linear elastic spring in the transverse direction apart from numerical studies there are also few analytical models concerning the armour wire lateral buckling in the public literature custódio 2005 presented an analytical approach for the investigation of the armour wire instability under axisymmetric loading tan et al 2006 studied the armour wires buckling through a strain energy approach however no details were presented disregarding the frictional effect paiva and vaz 2017 proposed an empirical model for the prediction of armour wire lateral buckling under axisymmetric loading using symbolic regression also employing the assumption of no friction and considering the axisymmetric loading condition similar analytical models were developed independently by sævik and ji 2014 and li et al 2018 for the lateral buckling limit prediction which gives conservative results comparing with the test data presented by østergaard et al 2012 furthermore this analytical model was subsequently updated by li et al 2019b by considering the constant bending through which periodic and global buckling modes were revealed and good correlations between the estimated periodic buckling limit and the test data presented by østergaard et al 2012 were demonstrated more recently the effect of friction and cyclic bending on armour wire lateral buckling was investigated by li et al 2019a and analytical formulations were developed respectively for the predictions of the rectangular and circular armour wires lateral buckling in flexible pipes and umbilicals li and vaz 2019 this analytical model indicates that although the friction affects the armour wire sliding process in bending its effect on the critical axial compression that may eventually cause the lateral buckling after numerous bending cycles may be ignorable the primary objective of this work is to investigate the frictional effect on the circular armour wire lateral buckling in an umbilical subjected to axial compression and cyclic bending for wet annulus condition a nonlinear static finite element model is developed for this study where the shear interaction at the interface between the armour wire and the neighboring layer is simulated by the isotropic coulomb friction model regularized with an elastic domain sensitivity studies of the friction coefficient and the maximum elastic slip in the coulomb friction model on the armour wire lateral buckling mechanism are presented 2 finite element model the calculation scheme used in this study is based on a nonlinear static finite element model for the circular armour wire lateral buckling in umbilicals the commercial finite element software abaqus is employed the modeling approach and assumptions are summarized 2 1 geometric and material parameters the general view of this finite element model is presented in fig 1 note that this model aims to investigate the armour wire lateral buckling for the wet annulus condition under this circumstance the external hydrostatic pressure is neutralized so it does not act as a radial constraint for the armour wires driven by the axial compression the armour wire tends to expand radially and may be separated from the inner layers thus the radial support from the inner layers is not represented in this model on the other hand the support from the outmost external layers e g the anti birdcage tapes and outer sheath is represented by a rigid surface as a result the radial expansion in axial compression is ignored to minimize the computational effort only one single armour wire is modeled so that the lateral contact between neighboring armour wires in the same layer is disregarded three pitches of the armour wire are represented to minimize the boundary effect to achieve a smooth contact interface a precise mesh topology is required the armour wire is modeled with the same radius of the surface and meshed with 601 2 node linear beam elements b31 with a circular beam section the rigid surface is meshed with 200 and 600 4 node quadrilateral surface elements sfm3d4 in the circumferential and along the toroid length respectively in the initial undeformed state the model is in the straight condition where the center of the middle section locates in the origin of the coordinates and the central line coincides with the z axis the circumferential position of the armour wire is described by the angular coordinate θ as illustrated in fig 2 and the armour wire ends locate at θ 0 besides fig 2 also illustrates the beam section axes where the first beam section axis coincides with the surface normal direction in the initial configuration it needs to be noted that the circular armour wire may rotate along its own axis in loading thus the first beam section axis may not always coincide with the surface normal direction the properties of the inner armour wire in an umbilical presented by custódio and vaz 2002 are used for this study which are presented in table 1 since the post buckling behavior is not the major concern of this study the perfect plastic model with zero hardening is implemented 2 2 boundary conditions loads and contacts the boundary and loads are applied by controlling a series of reference points that are created at the central axis of the model those reference points are coupled with the nodes on the surface at the corresponding cross section through kinematic coupling conditions besides the nodes at the armour wire ends are also coupled to the corresponding reference nodes at the ends through kinematic coupling the reference nodes at both ends and in the middle are respectively referred to as master and slave nodes in this study bending is applied in the y z plane symmetrically to the origin of coordinates as illustrated in fig 3 thus the displacement degrees of freedom in the x axis direction and the rotational degrees of freedom in the y axis direction of all those reference points are restricted and the reference node at the origin of the coordinates is restricted in all degrees of freedom to avoid rigid body motion note that this model is not torsionally balanced so it is uncapable of capturing the cable axial twist because only one armour wire is represented thus the rotational degrees of freedom in the z axis direction of all those reference points are restricted as well even though this restriction may affect the post buckling behavior as large axial rotations may be generated its effect on the triggering of lateral buckling is not expected to be relevant which is the main concern of this study the displacement degrees of freedom in the y axis and z axis directions and rotational degrees of freedom in the x axis direction of those slave nodes are computed according to the ones applied on the corresponding master node on the same side using nonlinear multi point constraint mpc abaqus user subroutines the constraint functions used for the fortran implementation of the user subroutine mpc are presented below for each master node the displacement degree of freedom in the z axis direction is released and the displacement in the y axis direction is computed based on its displacement in z axis direction and the applied angular rotation in x axis direction by 1 u y m r 1 cosδ ϕ x m where r is the uniform bending radius which can be evaluated by 2 r x z m u z m sinδ ϕ x m in which x u and δ φ represent respectively the original coordinates displacements and angular rotations the superscript m denotes the master node and the subscripts represent the coordinate axes rewriting eqs 1 and 2 the constraint function for each master node required by the user subroutine mpc can be given by 3 f 1 u y m δ φ x m u y m x z m u z m 1 cosδ φ x m sinδ φ x m 0 assuming that the longitudinal strain in the surface is uniform according to the geometrical relationship illustrated in fig 3 the angular rotation in the x axis direction and the displacements in the y axis and z axis directions of each slave node can be computed respectively based on the ones from the corresponding master node at the same side as 4 δ φ x s δ φ x m x z s x z m 5 u y s r 1 cosδ φ x s 6 u z s r sinδ φ x s x z s where the superscript s denotes the slave node rewriting eqs 4 6 the constraint functions for each slave node required by the user subroutine mpc can be obtained as 7a f 1 u y s u z m δ φ x m u y s x z m u z m 1 cos δ φ x m x z s x z m sinδ φ x m 0 7b f 2 u z s u z m δ φ x m u z s x z s x z m u z m sin δ φ x m x z s x z m sinδ φ x m 0 7c f 3 δ φ x s δ φ x m δ φ x s δ φ x m x z s x z m 0 accordingly the partial derivatives of those constraint functions to the degrees of freedom involved required by the user subroutine mpc implementation can be easily obtained by implementing those constraint functions axial compression and uniform bending can be applied respectively as concentrate loads in the longitudinal direction and angular rotations in the x axis direction on those two master nodes the loading applied on the right hand side master node in each loading step is illustrated in fig 4 the loading on the left hand side master node has the same magnitude but opposite directions a follower axial compression denoted by p is applied on the master node in the first loading step to establish the contact between the armour wire and toroid surface thereafter the axial compression remains and the cyclic angular rotation in the x axis direction between zero and a maximum value is applied on the master node in the following steps the time period of each step is 1 and the initial minimum and maximum time increments are specified respectively as 10 3 10 10 and 10 1 the whole process where the bending curvature increases from zero to the maximum value and then returns to zero is referred to as one bending cycle the maximum angular rotation is assumed constant and equal to κ l 0 2 where κ is the maximum bending curvature and l 0 is the model longitudinal length in the initial undeformed state according to the geometrical relationship illustrated in fig 3 the longitudinal length of the model subjected to loading can be calculated by 8 l l 0 u z m r u z m l δ φ x m r sinδ φ x m r where the superscripts m r and m l represent respectively the master nodes on the right and left sides the model end shortening defined by the ratio of the end compressive displacement to the original model axial length is given by 9 δ l 1 l l 0 it needs to be noted that the obtained end shortening is expected to be smaller than the actual end shortening of an umbilical in wet annulus condition since the radial deformation is not considered in this fe model the interaction between the armour wire and the toroid surface is established with the node to surface contact discretization with a finite sliding formulation as large relative sliding will be generated in buckling the abaqus contact pair algorithm is employed where the armour wire is set as the slave surface and the inner surface of the toroid is set as master surface since the problem addressed in this study involves a highly unstable phenomenon viscous damping is applied between the contact pair by multiplying the automatically calculated damping coefficient by the stabilize factor 0 0001 in the steps of cyclic bending this damping should be small enough to minimize its effect on the structural behavior and large enough to dissipate the strain energy when the armour wire buckles the normal contact is modeled using the penalty method with a contact stiffness 2000 n m m 3 to minimize penetration the tangential forces between contact surfaces are modeled using the isotropic coulomb friction model with a constant shear interaction stick stiffness in the static friction regime as illustrated in fig 5 the contact force friction coefficient and the allowable maximum elastic slip are denoted respectively by p n μ and γ the stick stiffness defined by the ratio of the maximum static frictional force to the maximum elastic slip is denoted by k s t i c k dai et al 2017b presented a formulation to approximately evaluate the stick stiffness 10 1 k s t i c k 1 k f r i c t i o n 1 k s h e a r where k f r i c t i o n and k s h e a r are respectively the stick stiffness components contributed by the internal friction and the shear deformation of the anti wear tape in the work of dai et al 2017b a constant stick stiffness is used as a result the maximum elastic slip varies since the contact pressure changes in cyclic loading in this study the maximum elastic slip is set as a constant so the stick stiffness varies to some extent in cyclic loading the maximum elastic slip used in each research is very different it could be as large as 5 m m østergaard et al 2011 or as small as 0 005 m m lukassen et al 2019 besides the choice of the friction coefficient between the armour wires and polymeric layer also varies from one author to another as discussed in the introduction section generally the friction coefficient is approximately between 0 1 and 0 2 in the present study the elastic slip is varied between 0 001 m m and 0 1 m m and the friction coefficient is varied between 0 05 and 0 15 for parameter studies 3 results and discussion in this section a series of case studies are performed to investigate the effect of friction coefficient and the maximum elastic slip on the circular armour wire lateral buckling mechanism the maximum bending curvature is set to 0 3 m 1 to facilitate the armour wire sliding and the applied longitudinal compressive loads are in a range close to the estimated critical load for the lateral buckling given by an analytical model li and vaz 2019 11 p c r e π d 4 sin 2 2 ϕ cos ϕ 64 r 2 1 2 g cos 2 ϕ e sin 2 ϕ 2 g where r d ϕ are respectively the armour wire radius to the toroid central axis the armour wire cross sectional diameter and the lay angle in the initial straight undeformed state e and g are respectively the young s and shear moduli of the armour wire this formulation is developed to estimate the critical longitudinal compressive load on a single armour wire that may eventually cause the lateral buckling after numerous bending cycles with small curvatures the standard coulomb friction model with no elastic domain was used in the analytical model development substituting the armour wire properties presented in table 1 into eq 11 the lateral buckling limit can be estimated as 1563 n besides an analytical model for the minimum bending curvature that precipitates the first sliding is used to verify the armour wire sticking slipping status obtained in the simulation such minimum bending curvature can be easily obtained based on the theory presented by li et al 2019a the contact pressure per unit armour wire length denoted by p n can be approximately evaluated by 12 p n s sin 2 ϕ r p t s where p t is the axial compression in the armour wire helix direction which is approximately constant at the neutral plane in cyclic bending it needs to be noted that p c r is in the umbilical axial direction rather than the armour wire helix direction when there is no relative sliding between the armour wire and the toroid surface the derivative of the armour wire axial strain denoted by ε in terms of the armour wire arc length denoted by s can be approximately evaluated by 13 d ε d s κ sin ϕ cos 2 ϕ sin θ it can be seen that the maximum strain variation rate locates at the neutral plane thereafter considering the standard coulomb friction model with no elastic domain and assuming that the armour wire slides along the helix direction the first sliding condition can be given as 14 μ p n s e π d 2 4 d ε d s substituting eqs 12 and 13 into eq 14 and applying θ 0 5 π neutral plane the minimum bending curvature that triggers the armour wire first sliding at the neutral plane can be obtained as 15 κ c r 4 μ p t e π d 2 r sin ϕ cos 2 ϕ this equation has been presented in similar forms among others by witz and tan 1992 substituting the armour wire parameters presented in table 1 into eq 15 and applying the longitudinal compression 1563 n the critical curvatures for the friction coefficients 0 05 0 1 0 15 can be obtained respectively as 3 2 e 4 m 1 6 5 e 4 m 1 9 7 e 4 m 1 3 1 friction coefficient 0 1 maximum elastic slip 0 01 mm firstly a case study is performed for an armour wire subjected to axial compression p c r and cyclic curvatures between zero and 0 3 m 1 with the friction coefficient and the maximum elastic slip equal to 0 1 and 0 01 m m respectively the total cpu time is 42475 s fig 6 shows the sticking sliding status of the armour wire in the first bending cycle when the curvature increases from zero to 0 3 m 1 where the values on the left side represent the bending curvatures at each moment and red and green represent respectively the sticking and slipping status to better capture the sticking slipping status the increment in the first bending step is set as 1 0 e 4 m 1 it can be seen that the first sliding section locates at the neutral plane when the bending curvature reaches 3 7 e 3 m 1 which is much larger than the analytical estimation 6 5 e 4 m 1 due to the effect of elastic slip thereafter the sliding section expands from the neutral plane towards intrados and extrados with increasing bending curvature when the bending curvature is bigger than 6 53 e 2 m 1 the entire armour wire slides except for the sections at the intrados and extrados due to symmetry moreover the sliding components in the directions along the length of the armour wire and transverse to the armour wire of the section node at the neutral plane marked by the black circle in fig 6 as well as the armour wire end shortening are plotted in fig 7 it can be observed that the instantaneous sliding at the onset of the first sliding is indeed along the tangential direction as assumed in the analytical model besides under this loading condition the sliding magnitudes in either tangential or transverse directions are much larger than the defined maximum elastic slip while the tangential sliding is repeated in cyclic curvatures the transverse sliding component increases monotonically after each bending cycle as a result of the transverse sliding of the armour wire the end shortening also increases monotonically after each bending cycle during the 22 nd bending cycle the tangential and transverse sliding components as well as the end shortening all increase suddenly indicating that the armour wire fails due to lateral buckling considering that the armour wire transverse sliding and the end shortening have similar variation tendency in the following discussion the end shortening is used to illustrate the armour wire stability status consequently the end shortenings of the armour wire subjected to different axial compression and cyclic curvature with the friction coefficient and the maximum elastic slip equal to 0 1 and 0 01 m m respectively are presented in fig 8 the squeezed plots in fig 8 are enlarged and illustrated in fig 9 it can be seen that the end shortenings increase monotonically after each bending cycle and grow suddenly when the lateral buckling takes place for the cases with the axial compression equal to or bigger than 0 85 p c r in contrast the end shortening grows with a decelerating rate and approaches a stable value after some bending cycles for the case with the axial compression equal to 0 8 p c r consequently it can be concluded that the armour wire lateral buckling limit should lie between 0 8 p c r and 0 85 p c r under this loading condition the difference with the analytical estimation may be due to the small deflection assumption employed in the analytical development moreover to illustrate the armour wire deflection in cyclic bending the armour wire circumferential angular position variations denoted by δ θ for the cases with the axial compression equal to 0 8 p c r p c r and 0 85 p c r after different bending cycles are illustrated respectively in figs 10 12 it can be seen that the armour wire deflection is composed of not only a periodic component but also a global component which is due to the boundary effect li et al 2019b for the stable case as shown in fig 10 the periodic component grows much faster than the global component in the first 50 bending cycles thereafter the periodic component is nearly stable while the global component continues to increase at a very small rate in the subsequent bending cycles in contrast for the case with axial compression p c r since the armour wire develops into the lateral buckling very fast after only 21 bending cycles there is no sufficient time for the global deflection component to grow before the initiation of lateral buckling as a result the deflection is dominated by the periodic component see fig 11 however when the applied axial compression is just slightly larger than the critical load significant bending cycles are required to initiate the lateral buckling which provides sufficient time for the global deflection component developing consequently under this circumstance the armour wire deflection at the moment before the initiation of lateral buckling is a mix of global and periodic components see fig 12 nevertheless despite the presence of the global deflection component due to the end effect the armour wire failed due to a local lateral buckling at the extrados in the middle armour wire pitch i e normalized pitch length equals 1 or 2 for all those buckling cases to illustrate the buckling shapes the armour wire configurations after different bending cycles for the cases subjected to axial compression 0 85 p c r and 1 5 p c r in the y z and x z planes are illustrated respectively in fig 13 and fig 14 where the numbers on the left side represent the bending cycles and the contour shows the maximum von mises stress at those four integration points of each armour wire cross section in fig 14 the number 3 44 represents the moment when the bending curvature increases to 0 88 times the maximum curvature during the fourth bending cycle from fig 13 it can be seen that the armour wire already reaches the yield stress in the regions close to the extrados in the middle pitch after 250 bending cycles thereafter the armour wire fails after a few additional bending cycles as illustrated in fig 8 in contrast for the case with axial compression 1 5 p c r the maximum von mises stress in the armour wire is still much smaller than the yield stress after 3 bending cycles however it increases suddenly and reaches the yield limit during the fourth bending cycle see fig 14 based on the discussion above it can be concluded that the cases with axial compression 0 85 p c r and 1 5 p c r fail due to plastic and elastic buckling respectively to further reveal the stress distributions fig 15 and fig 16 show respectively the axial stresses and the maximum von mises stress at the four integration points of each armour wire cross section for the case subjected to axial compression 0 85 p c r after 200 and 250 bending cycles in which the axisymmetric stress is obtained by dividing the applied axial compression by the armour wire cross sectional area it can be observed that the first yield locations are near the extrados in the middle armour wire pitch symmetrically consequently to reveal the stress status at the onset of lateral buckling the maximum von mises stress in the armour wire extrados in the middle pitch in terms of the bending cycles for the cases presented in fig 8 are illustrated in fig 17 and enlarged in fig 18 to better capture the first cycles it can be seen that the cases with axial compression a 0 8 p c r b 0 85 p c r 0 9 p c r p c r c larger than p c r are respectively a stable in the elastic stage b fail due to plastic buckling and c fail due to elastic buckling 3 2 friction coefficient 0 05 maximum elastic slip 0 01 mm thereafter similar case studies are performed but with a smaller friction coefficient equal to 0 05 applying the same loading as the case presented in fig 6 the critical curvature that triggers the first armour wire sliding under the present condition is 3 4 e 3 m 1 which is slightly smaller than 3 7 e 3 m 1 for the case shown in fig 6 but still much larger than the analytical estimation 3 2 e 4 m 1 comparably the end shortenings of the same armour wire under the same loading conditions are presented in fig 19 and fig 20 it can be observed that the armour wire lateral buckling limit still lies between 0 8 p c r and 0 85 p c r even with a smaller friction coefficient nevertheless the required number of bending cycles to initiate the lateral buckling for each case is less than that of the same case with friction coefficient 0 1 as a consequence of the reduced frictional resistance the cases with axial compression equal to and bigger than p c r fail during the first bending cycle before the curvature reaches the maximum value 0 3 m 1 see fig 20 the armour wire deflection shapes at different bending curvatures for the case in axial compression 1 5 p c r is shown in fig 21 illustrating that the armour wire still buckles in a periodic shape even with such a small friction coefficient subsequently the maximum von mises stress in the armour wire extrados in the middle pitch in terms of the bending cycles for those cases are shown in fig 22 and fig 23 it can be seen that the cases with axial compression a 0 8 p c r b 0 85 p c r 0 9 p c r c equal to or bigger than p c r are respectively a stable in the elastic stage b fail due to plastic buckling and c fail due to elastic buckling 3 3 friction coefficient 0 15 maximum elastic slip 0 01 mm moreover additional case studies are performed for the same armour wire under the same loading conditions but with a larger friction coefficient 0 15 under this circumstance the minimum bending curvature that triggers the first sliding in the armour wire subjected to p c r is 4 1 e 3 m 1 which is slightly larger than 3 7 e 3 m 1 for the case presented in fig 6 and still much larger than the analytical estimation 9 7 e 4 m 1 the armour wire end shortenings in those cases are presented in fig 24 and the squeezed plots are enlarged in fig 25 to better capture the first cycles according to the end shortening variation tendency if the case with axial compression 0 85 p c r buckles eventually it would require a significant number of bending cycles due to the limited computational resource this case was terminated after nearly 200 bending cycles although the final state of this case is unknown it is conceivable that the applied axial compression 0 85 p c r is very close to the actual critical load besides the maximum von mises stress in the armour wire extrados in the middle section in terms of the bending cycles of those cases are shown in fig 26 and the squeezed plots are enlarged in fig 27 it can be observed that except the case with axial compression 0 85 p c r the cases with axial compression a 0 8 p c r b 0 9 p c r p c r 1 1 p c r 1 2 p c r c equal to or bigger than 1 3 p c r are respectively a stable in the elastic stage b fail due to plastic buckling and c fail due to elastic buckling 3 4 friction coefficient 0 1 maximum elastic slip 0 001 mm thereafter case studies are performed under the same loading conditions with the friction coefficient and the maximum elastic slip equal to 0 1 and 0 001 m m respectively as a consequence of the reduced maximum elastic slip it is easier for the armour wire to slide in bending comparing with the case presented in fig 6 the minimum bending curvature to cause the first sliding in the armour wire subjected to p c r under the present condition is 1 0 e 3 m 1 which is much smaller than 3 7 e 3 m 1 for the case shown in fig 6 and is closer to the analytical estimation 6 5 e 4 m 1 moreover fig 28 shows the end shortenings of those cases in cyclic bending where the squeezed plots are enlarged in fig 29 besides the maximum von mises stresses in the armour wire extrados in the middle pitch for the cases presented in figs 28 and 29 are illustrated in fig 30 and fig 31 respectively comparing the results presented in figs 28 31 with the results of the cases with friction coefficient 0 1 and elastic slip 0 01 m m it can be observed that reducing the elastic slip from 0 01 m m to 0 001 m m does not cause any notable change in the range of critical load and the elastic or plastic buckling status this is because the armour wire sliding magnitude in this bending curvatures is much larger than the applied maximum elastic slip as illustrated in fig 7 the only difference caused by this modification is that the lateral buckling takes place after slightly fewer bending cycles for the cases with axial compression 0 85 p c r and 0 9 p c r under this condition 3 5 friction coefficient 0 1 maximum elastic slip 0 1 mm additionally more case studies are performed under the same loading conditions with the friction coefficient and the maximum elastic slip equal to 0 1 and 0 1 m m respectively as a result of a larger maximum elastic slip the minimum bending curvature that causes the first sliding of the armour wire subjected to p c r under this condition is 3 1 e 2 m 1 which is much larger than 3 7 e 3 m 1 for the case presented in fig 6 as well as the analytical estimation 6 5 e 4 m 1 fig 32 shows the end shortenings of those cases where the squeezed plots are enlarged in fig 33 also the maximum von mises stresses in the armour wire extrados in the middle pitch for the cases presented in figs 32 and 33 are illustrated respectively in fig 34 and fig 35 it is interesting to note that by increasing the elastic slip from 0 01 m m to 0 1 m m the case with axial compression 0 85 p c r becomes stable and the lateral buckling limit range hence lies between 0 85 p c r and 0 9 p c r meanwhile the elastic or plastic buckling statuses for the buckling cases are still the same 3 6 discussions based on the preliminary discussion above it can be seen that the critical curvature for the first sliding depends not only on the friction coefficient but also on the maximum elastic slip to further illustrate the effect of the maximum elastic slip on the critical curvature additional parameter studies are performed applying axial compression p c r and bending load with the maximum elastic slip varied at each friction coefficient the obtained critical curvatures of those cases as well as the previously discussed cases are presented in table 2 it can be observed that the critical curvatures given by the finite element model agree very well with the analytical estimation for all the selected friction coefficients when the maximum elastic slip is equal to 0 0001 m m in another word the analytical model is reliable for the coulomb friction model with a very small elastic region however in reality the elastic slip may not be that small considering the shear deformation of the anti wear tape from table 2 it can be seen that varying the maximum elastic slip from 0 0001 m m to 0 1 m m causes a significant difference in the critical curvatures therefore it is vital to consider the effect of elastic slip for the armour wire sticking slipping status evaluation additionally the final state number of bending cycles to initiate the lateral buckling and the corresponding elastic or plastic buckling status for all the previously discussed cases are summarized in table 3 in which the integer and non integer indicate respectively that the buckling takes place when the curvature increases towards the maximum value and returns to zero during the bending cycle and blue and red represent respectively the elastic and plastic buckling an empirical function has been proposed for the approximate estimation of the bending cycle number to initiate buckling at different axial compression 16 n a p p c r p c r p c r where p c r is the actual lateral buckling limit a is a non dimensional parameter and n is the number of bending cycles to initiate the lateral buckling fig 36 shows the plots of the bending cycles and the corresponding fitting curves using eq 16 for all those cases presented in table 3 where hollow and solid symbols represent respectively the elastic and plastic buckling and the dashed lines represent p c r p c r for cases at each condition the parameters of those fitting curves are presented in table 4 it needs to be noted that this is only an empirical model so that the obtained lateral buckling limit p c r is only an approximation according to fig 36 and table 4 it can be observed that the lateral buckling limits for the cases with different friction coefficients but the same maximum elastic slip are very close which is in accordance with the findings achieved in the analytical model li et al 2019a nevertheless it needs to be noted that the friction coefficient has an obvious effect on the number of bending cycles to initiate the lateral buckling fig 37 shows the end shortenings of the armour wire subjected to axial compression 0 9 p c r and cyclic curvatures with the maximum elastic slip equal to 0 01 m m and the friction coefficient equal to 0 05 0 1 and 0 15 respectively it is evident that more bending cycles are required to initiate the lateral buckling for the case with a larger friction coefficient besides it can also be noted that increasing the friction coefficient increases the range of axial compression for the plastic buckling since it is more difficult for the armour wire to buckle elastically with higher frictional resistance on the other hand when the maximum elastic slip is extremely small e g γ 0 001 m m or 0 01 m m the varying of the maximum elastic slip has a negligible effect on the lateral buckling behavior nevertheless increasing the maximum elastic slip from 0 01 m m to 0 1 m m improves the armour wire stability this can be observed in fig 38 which shows the end shortenings of the armour wire subjected to axial compression 0 85 p c r and cyclic curvatures with the friction coefficient equal to 0 1 and the maximum elastic slip equal to 0 001 m m 0 01 m m and 0 1 m m respectively besides it can also be observed from table 3 that modifying the maximum elastic slip does not change the elastic or plastic buckling status 4 conclusions in this work a nonlinear static finite element model was developed for the investigation of circular armour wire lateral buckling in an umbilical for wet annulus condition the isotropic coulomb friction model regularized with an elastic domain was employed to simulate the tangential behavior at the interface between the armour wire and the underlying toroid surface the armour wire responses in different axial compression associated with cyclic bending between the straight condition and a maximum bending condition were simulated and discussed sensitivity studies of the friction coefficient and the maximum elastic slip in the coulomb friction model on the armour wire sliding and lateral buckling mechanism were conducted the results indicate that the critical curvature to trigger the first armour wire sliding depends not only on the friction coefficient but also on the maximum elastic slip while the analytical model for the critical curvature works well for the cases with an extremely small elastic slip it fails when the elastic slip is not ignorable for future studies it is of interest to improve the analytical model to consider the elastic slip besides it was demonstrated that increasing either the friction coefficient or the maximum elastic slip tends to increase the required bending cycles to initiate the lateral buckling nevertheless the critical axial compression that may eventually cause the lateral buckling after numerous bending cycles is not sensitive to the friction coefficient when it is between 0 05 and 0 15 this is in accordance with the findings achieved in the analytical model however it was found that increasing the maximum elastic slip from 0 01 mm to 0 1 mm may increase the lateral buckling limit to some extent note that in a physical umbilical the elastic slip is principally generated by the shear deformation of the underlying polymeric anti wear tape thus this is corresponding to a state that the armour wire stability may be improved to some extent by applying a thicker polymeric tape additionally the results also illustrate that under certain loading conditions the elastic or plastic buckling status depends principally on the friction coefficient rather than on the magnitude of the maximum elastic slip increasing the friction coefficient increases the range of axial compression that may cause plastic buckling it needs to be emphasized that several hypotheses were implemented in this finite element study the armour wire radial expansion and end rotation were restricted the transverse contact between the neighboring armour wires in the same layer was not considered as only one armour wire was modeled the contribution of the other layers on the umbilical overall behavior in the post buckling stage was ignored the effects of those assumptions on the umbilical armour wire lateral buckling mechanism need to be carefully addressed in future work also experimental tests on the umbilical armour wire lateral buckling are needed for the verification and validation of the analytical and numerical models author statement the manuscript has not been published before or submitted to another journal for the consideration for publication the manuscript has been approved by all authors and by the responsible authorities where the work was carried out if the manuscript is accepted it will not be published elsewhere in the same form in english or in any other language without the written consent of the publisher credit authorship contribution statement xiaotian li conceptualization methodology software investigation formal analysis writing original draft murilo augusto vaz investigation formal analysis writing review editing supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge the support from the national council of scientific and technological development cnpq no 302380 2013 2 and the brazilian coordination for the improvement of higher education personnel capes no 1987 2014 for this work 
21158,the present paper addresses the frictional effect on the circular armour wire lateral buckling in an umbilical for wet annulus condition a nonlinear static finite element model is developed where only one single circular armour wire is simulated and the contact interface with the neighboring layer is represented by a deformable rigid toroid surface the isotropic coulomb friction model regularized with an elastic domain is implemented to simulate the shear interaction case studies are carried out by applying different axial compression and cyclic bending curvatures between zero and a maximum value in one bending direction the minimal axial compression that may cause the armour wire lateral buckling after numerous bending cycles is approximately estimated by fitting the numbers of bending cycles to initiate the buckling under different axial compression through an empirical model the friction coefficient and the maximum elastic slip employed in the coulomb friction model are varied for the parametric studies and their effects on the armour wire sticking slipping status the end shortenings and deflections in cyclic bending the critical lateral buckling limit as well as the stress state at the onset of lateral buckling are extensively discussed keywords umbilicals cables tensile armour wires lateral buckling friction 1 introduction umbilicals and flexible pipes are essential components widely employed in offshore oil and gas field development in general flexible pipes are used for the transportation of liquid or gas between subsea installations and floating production units whereas umbilicals may serve for different purposes such as transferring electrical and hydraulic power electrical and fiber optic signals chemical fluids as well as gas for the artificial lift between the surface facilities and subsea equipment their functions and integration are achieved by composite structures consisting of several layers with specific functions the tensile armour wires normally consisting of two layers of helically counter wound steel wires are key structural components supporting most of the axial tension compression and bending loads in most of the applications steel wires with a quasi rectangular cross section are used in flexible pipes whereas steel wires with a circular cross section are preferably employed in umbilicals failure of the tensile armour wires may result in the loss of the structural integrity and is thus not permitted one of the failure mode that has received considerable attention is the armour wire buckling which usually takes place in the flexible pipe and umbilical when exposed to large axial compression such axial compression may be generated by large dynamic motions of the connecting floating platform as well as the so called reversed end cap effect brack et al 2005 while many tests have been performed on the armour wire buckling in flexible pipes either offshore or in laboratory braga and kaleff 2004 bectarte and coutarel 2004 østergaard et al 2012 amarante et al 2018 li et al 2019a very little data has been published concerning the armour wire buckling in umbilicals as the reversed end cap effect is not significant nonetheless a dynamic analysis performed by garcía et al 2015 indicates that an umbilical may also be exposed to large axial compression during extreme weather conditions thus attention should also be paid to umbilical armour wire buckling under specific conditions driven by the large axial compression the armour wire may buckle in either radial or circumferential directions which are well known as birdcaging and lateral buckling respectively for the flexible pipes and umbilicals that may be exposed to large axial compression in their service lives high strength tapes are generally applied over the armour wires to reinforce the radial resistance against the armour wire radial expansion sousa et al 2012 rabelo et al 2015 sævik and thorsen 2017 li et al 2019c nonetheless the armour wires still retain the degree of freedom to deflect in the lateral direction which is principally retarded by the friction on the interfaces between armour wires and neighboring layers the frictional resistance plays a significant role on the armour wire sliding in bending a small frictional resistance facilitates the armour wire sliding thus promoting the lateral buckling the lateral buckling is generally encountered in the wet annulus condition since the frictional resistance is appreciably reduced under this circumstance also as the inner armour wires experience lesser frictional resistance than the outer armour wires in axial compression the lateral buckling is always triggered by the failure of the inner armour wires moreover it also needs to be noted that cyclic bending is essential for the generation of lateral buckling as it facilitates the armour wire sliding against the frictional resistance therefore accurate modeling of friction behavior is vital for the lateral buckling mechanism simulation the fundamental physics behind friction is extremely complex and many variables may affect the friction between the armour wires and the adjacent layers such as sliding velocity temperature material aging geometric properties of the interface seawater lubrication in the flooded condition etc note that a polymeric tape is generally placed between the armour wire layers to reduce the abrasion between metallic layers when the flexible pipe or umbilical operates under large axial load grooves may be formed on the polymeric tape along the helix paths of armour wires which compels the frictional resistance to be dependent on the sliding direction this is especially the case for umbilicals since such grooves may be more notable due to the circular armour wire cross section the groove effect on the armour wire sliding in a flexible pipe has been thoroughly studied by dai et al 2018 using the anisotropic friction model that has been presented among others by ozaki et al 2012 nonetheless despite the complexity of the fundamental physics behind friction it can be represented by empirical models with sufficient accuracy in many applications the most commonly used empirical shear interaction formulation is the coulomb friction model which consists of static and kinetic frictions that describe respectively the resistances to relative lateral motion between non moving and moving surfaces assuming the friction is independent of the sliding velocity and contact area the static and kinetic frictions can be evaluated respectively by multiplying the coefficients of static and kinetic frictions to the normal contact force a sensitivity study on the effect of the transition domain from static to kinetic friction on flexible pipe bending behavior has been presented by dai et al 2017a although the maximum static friction is generally larger than kinetic friction they are usually assumed equal in simulations of flexible pipes and umbilicals and the applied friction coefficient is normally obtained as an average value between the static and dynamic friction coefficients observed during cyclic runs in tests moreover although the standard coulomb friction model assumes that no relative motion occurs if the equivalent friction is less than the maximum static friction in the numerical algorithm the condition of no relative motion is generally approximated by stiff elastic behavior this isotropic coulomb friction model regularized with an elastic domain with the analogy to the elastic ideally plastic material model concept is widely used in the flexible pipe and umbilical simulations by many authors smith et al 2007 ekeberg et al 2006 sævik 2011 dai et al 2020 despite the reduced number of references for circular armour wire lateral buckling in umbilicals published to date many numerical simulations have been performed on the armour wire lateral buckling in flexible pipes due to its intrinsic relevance those simulations on the flexible pipe armour wire lateral buckling will hereby be presented vaz and rizzo 2011 and li 2014 studied the armour wire buckling in a flexible pipe under axisymmetric compression and external hydrostatic pressure where only one armour wire was modeled to represent each armour wire layer thus significantly reducing the computational costs the friction coefficient was varied for parameter study and the default maximum elastic slip given as 0 005 times the characteristic contact surface length in abaqus was adopted moreover employing a similar modeling strategy nygård 2012 and yang et al 2015 investigated the armour wire buckling in axisymmetric compression where the armour wire is simulated by curved beam elements a sensitivity study was performed by varying the maximum elastic slip between 0 05 m m and 0 2 m m and it was demonstrated that the stability limit decreases with the increasing maximum elastic slip yang et al 2015 besides sertã et al 2012 presented a finite element model for the prediction of armour wire buckling in a flexible pipe however no information related to the contact property was presented additionally also implementing coulomb s law of friction malta and martins 2019 presented a finite element study on the frictional effect on the armour wire buckling in a flexible pipe subjected to axisymmetric compression where all the armour wires were modeled similar finite element studies on the armour wire buckling in axisymmetric compression were also presented by tang et al 2019 and liu et al 2019 sævik and ji 2014 simulated the armour wire lateral buckling in axial compression and cyclic bending where only four armour wires were modeled in each armour wire layer to reduce the computational costs the coulomb friction model was used with friction coefficient and maximum elastic slip equal to respectively 0 15 and 0 1 m m good correlations with the test data presented by østergaard et al 2012 were demonstrated this model was further updated by zhou et al 2015 by considering the anti birdcage tape and it was found that its presence resists the end rotation thus slowing down the buckling process besides østergaard et al 2011 investigated the frictional effect on a single armour wire lateral buckling within a toroid wall subjected to compression and cyclic bending by solving a two point boundary value problem described by six first order nonlinear differential equations system coulomb friction was used where the friction coefficient and the maximum elastic slip were set as 0 1 and 5 m m respectively as a consequence of applying this relatively large elastic slip the armour wire is less prone to slide and it may not experience full friction additionally assuming that the armour wire deflection is periodic caleyron et al 2017 presented a numerical methodology to investigate armour wire buckling in compression and cyclic bending where the armour wires are represented by repeated unit cells a case study was presented where the friction coefficient 0 18 was prescribed for all interfaces based on a similar repeated unit cell method concept lukassen et al 2019 developed a finite element model applicable to armour wire lateral buckling analysis in which the friction coefficient and the maximum elastic slip were set respectively as 0 12 and 0 005 m m more recently gonzalez et al 2019 presented a finite element model to study the armour wire lateral buckling where the bending effect is addressed by assuming that the pre buckling configurations follow geodesic or loxodromic curves in this study the friction on the armour wire was approximated by a linear elastic spring in the transverse direction apart from numerical studies there are also few analytical models concerning the armour wire lateral buckling in the public literature custódio 2005 presented an analytical approach for the investigation of the armour wire instability under axisymmetric loading tan et al 2006 studied the armour wires buckling through a strain energy approach however no details were presented disregarding the frictional effect paiva and vaz 2017 proposed an empirical model for the prediction of armour wire lateral buckling under axisymmetric loading using symbolic regression also employing the assumption of no friction and considering the axisymmetric loading condition similar analytical models were developed independently by sævik and ji 2014 and li et al 2018 for the lateral buckling limit prediction which gives conservative results comparing with the test data presented by østergaard et al 2012 furthermore this analytical model was subsequently updated by li et al 2019b by considering the constant bending through which periodic and global buckling modes were revealed and good correlations between the estimated periodic buckling limit and the test data presented by østergaard et al 2012 were demonstrated more recently the effect of friction and cyclic bending on armour wire lateral buckling was investigated by li et al 2019a and analytical formulations were developed respectively for the predictions of the rectangular and circular armour wires lateral buckling in flexible pipes and umbilicals li and vaz 2019 this analytical model indicates that although the friction affects the armour wire sliding process in bending its effect on the critical axial compression that may eventually cause the lateral buckling after numerous bending cycles may be ignorable the primary objective of this work is to investigate the frictional effect on the circular armour wire lateral buckling in an umbilical subjected to axial compression and cyclic bending for wet annulus condition a nonlinear static finite element model is developed for this study where the shear interaction at the interface between the armour wire and the neighboring layer is simulated by the isotropic coulomb friction model regularized with an elastic domain sensitivity studies of the friction coefficient and the maximum elastic slip in the coulomb friction model on the armour wire lateral buckling mechanism are presented 2 finite element model the calculation scheme used in this study is based on a nonlinear static finite element model for the circular armour wire lateral buckling in umbilicals the commercial finite element software abaqus is employed the modeling approach and assumptions are summarized 2 1 geometric and material parameters the general view of this finite element model is presented in fig 1 note that this model aims to investigate the armour wire lateral buckling for the wet annulus condition under this circumstance the external hydrostatic pressure is neutralized so it does not act as a radial constraint for the armour wires driven by the axial compression the armour wire tends to expand radially and may be separated from the inner layers thus the radial support from the inner layers is not represented in this model on the other hand the support from the outmost external layers e g the anti birdcage tapes and outer sheath is represented by a rigid surface as a result the radial expansion in axial compression is ignored to minimize the computational effort only one single armour wire is modeled so that the lateral contact between neighboring armour wires in the same layer is disregarded three pitches of the armour wire are represented to minimize the boundary effect to achieve a smooth contact interface a precise mesh topology is required the armour wire is modeled with the same radius of the surface and meshed with 601 2 node linear beam elements b31 with a circular beam section the rigid surface is meshed with 200 and 600 4 node quadrilateral surface elements sfm3d4 in the circumferential and along the toroid length respectively in the initial undeformed state the model is in the straight condition where the center of the middle section locates in the origin of the coordinates and the central line coincides with the z axis the circumferential position of the armour wire is described by the angular coordinate θ as illustrated in fig 2 and the armour wire ends locate at θ 0 besides fig 2 also illustrates the beam section axes where the first beam section axis coincides with the surface normal direction in the initial configuration it needs to be noted that the circular armour wire may rotate along its own axis in loading thus the first beam section axis may not always coincide with the surface normal direction the properties of the inner armour wire in an umbilical presented by custódio and vaz 2002 are used for this study which are presented in table 1 since the post buckling behavior is not the major concern of this study the perfect plastic model with zero hardening is implemented 2 2 boundary conditions loads and contacts the boundary and loads are applied by controlling a series of reference points that are created at the central axis of the model those reference points are coupled with the nodes on the surface at the corresponding cross section through kinematic coupling conditions besides the nodes at the armour wire ends are also coupled to the corresponding reference nodes at the ends through kinematic coupling the reference nodes at both ends and in the middle are respectively referred to as master and slave nodes in this study bending is applied in the y z plane symmetrically to the origin of coordinates as illustrated in fig 3 thus the displacement degrees of freedom in the x axis direction and the rotational degrees of freedom in the y axis direction of all those reference points are restricted and the reference node at the origin of the coordinates is restricted in all degrees of freedom to avoid rigid body motion note that this model is not torsionally balanced so it is uncapable of capturing the cable axial twist because only one armour wire is represented thus the rotational degrees of freedom in the z axis direction of all those reference points are restricted as well even though this restriction may affect the post buckling behavior as large axial rotations may be generated its effect on the triggering of lateral buckling is not expected to be relevant which is the main concern of this study the displacement degrees of freedom in the y axis and z axis directions and rotational degrees of freedom in the x axis direction of those slave nodes are computed according to the ones applied on the corresponding master node on the same side using nonlinear multi point constraint mpc abaqus user subroutines the constraint functions used for the fortran implementation of the user subroutine mpc are presented below for each master node the displacement degree of freedom in the z axis direction is released and the displacement in the y axis direction is computed based on its displacement in z axis direction and the applied angular rotation in x axis direction by 1 u y m r 1 cosδ ϕ x m where r is the uniform bending radius which can be evaluated by 2 r x z m u z m sinδ ϕ x m in which x u and δ φ represent respectively the original coordinates displacements and angular rotations the superscript m denotes the master node and the subscripts represent the coordinate axes rewriting eqs 1 and 2 the constraint function for each master node required by the user subroutine mpc can be given by 3 f 1 u y m δ φ x m u y m x z m u z m 1 cosδ φ x m sinδ φ x m 0 assuming that the longitudinal strain in the surface is uniform according to the geometrical relationship illustrated in fig 3 the angular rotation in the x axis direction and the displacements in the y axis and z axis directions of each slave node can be computed respectively based on the ones from the corresponding master node at the same side as 4 δ φ x s δ φ x m x z s x z m 5 u y s r 1 cosδ φ x s 6 u z s r sinδ φ x s x z s where the superscript s denotes the slave node rewriting eqs 4 6 the constraint functions for each slave node required by the user subroutine mpc can be obtained as 7a f 1 u y s u z m δ φ x m u y s x z m u z m 1 cos δ φ x m x z s x z m sinδ φ x m 0 7b f 2 u z s u z m δ φ x m u z s x z s x z m u z m sin δ φ x m x z s x z m sinδ φ x m 0 7c f 3 δ φ x s δ φ x m δ φ x s δ φ x m x z s x z m 0 accordingly the partial derivatives of those constraint functions to the degrees of freedom involved required by the user subroutine mpc implementation can be easily obtained by implementing those constraint functions axial compression and uniform bending can be applied respectively as concentrate loads in the longitudinal direction and angular rotations in the x axis direction on those two master nodes the loading applied on the right hand side master node in each loading step is illustrated in fig 4 the loading on the left hand side master node has the same magnitude but opposite directions a follower axial compression denoted by p is applied on the master node in the first loading step to establish the contact between the armour wire and toroid surface thereafter the axial compression remains and the cyclic angular rotation in the x axis direction between zero and a maximum value is applied on the master node in the following steps the time period of each step is 1 and the initial minimum and maximum time increments are specified respectively as 10 3 10 10 and 10 1 the whole process where the bending curvature increases from zero to the maximum value and then returns to zero is referred to as one bending cycle the maximum angular rotation is assumed constant and equal to κ l 0 2 where κ is the maximum bending curvature and l 0 is the model longitudinal length in the initial undeformed state according to the geometrical relationship illustrated in fig 3 the longitudinal length of the model subjected to loading can be calculated by 8 l l 0 u z m r u z m l δ φ x m r sinδ φ x m r where the superscripts m r and m l represent respectively the master nodes on the right and left sides the model end shortening defined by the ratio of the end compressive displacement to the original model axial length is given by 9 δ l 1 l l 0 it needs to be noted that the obtained end shortening is expected to be smaller than the actual end shortening of an umbilical in wet annulus condition since the radial deformation is not considered in this fe model the interaction between the armour wire and the toroid surface is established with the node to surface contact discretization with a finite sliding formulation as large relative sliding will be generated in buckling the abaqus contact pair algorithm is employed where the armour wire is set as the slave surface and the inner surface of the toroid is set as master surface since the problem addressed in this study involves a highly unstable phenomenon viscous damping is applied between the contact pair by multiplying the automatically calculated damping coefficient by the stabilize factor 0 0001 in the steps of cyclic bending this damping should be small enough to minimize its effect on the structural behavior and large enough to dissipate the strain energy when the armour wire buckles the normal contact is modeled using the penalty method with a contact stiffness 2000 n m m 3 to minimize penetration the tangential forces between contact surfaces are modeled using the isotropic coulomb friction model with a constant shear interaction stick stiffness in the static friction regime as illustrated in fig 5 the contact force friction coefficient and the allowable maximum elastic slip are denoted respectively by p n μ and γ the stick stiffness defined by the ratio of the maximum static frictional force to the maximum elastic slip is denoted by k s t i c k dai et al 2017b presented a formulation to approximately evaluate the stick stiffness 10 1 k s t i c k 1 k f r i c t i o n 1 k s h e a r where k f r i c t i o n and k s h e a r are respectively the stick stiffness components contributed by the internal friction and the shear deformation of the anti wear tape in the work of dai et al 2017b a constant stick stiffness is used as a result the maximum elastic slip varies since the contact pressure changes in cyclic loading in this study the maximum elastic slip is set as a constant so the stick stiffness varies to some extent in cyclic loading the maximum elastic slip used in each research is very different it could be as large as 5 m m østergaard et al 2011 or as small as 0 005 m m lukassen et al 2019 besides the choice of the friction coefficient between the armour wires and polymeric layer also varies from one author to another as discussed in the introduction section generally the friction coefficient is approximately between 0 1 and 0 2 in the present study the elastic slip is varied between 0 001 m m and 0 1 m m and the friction coefficient is varied between 0 05 and 0 15 for parameter studies 3 results and discussion in this section a series of case studies are performed to investigate the effect of friction coefficient and the maximum elastic slip on the circular armour wire lateral buckling mechanism the maximum bending curvature is set to 0 3 m 1 to facilitate the armour wire sliding and the applied longitudinal compressive loads are in a range close to the estimated critical load for the lateral buckling given by an analytical model li and vaz 2019 11 p c r e π d 4 sin 2 2 ϕ cos ϕ 64 r 2 1 2 g cos 2 ϕ e sin 2 ϕ 2 g where r d ϕ are respectively the armour wire radius to the toroid central axis the armour wire cross sectional diameter and the lay angle in the initial straight undeformed state e and g are respectively the young s and shear moduli of the armour wire this formulation is developed to estimate the critical longitudinal compressive load on a single armour wire that may eventually cause the lateral buckling after numerous bending cycles with small curvatures the standard coulomb friction model with no elastic domain was used in the analytical model development substituting the armour wire properties presented in table 1 into eq 11 the lateral buckling limit can be estimated as 1563 n besides an analytical model for the minimum bending curvature that precipitates the first sliding is used to verify the armour wire sticking slipping status obtained in the simulation such minimum bending curvature can be easily obtained based on the theory presented by li et al 2019a the contact pressure per unit armour wire length denoted by p n can be approximately evaluated by 12 p n s sin 2 ϕ r p t s where p t is the axial compression in the armour wire helix direction which is approximately constant at the neutral plane in cyclic bending it needs to be noted that p c r is in the umbilical axial direction rather than the armour wire helix direction when there is no relative sliding between the armour wire and the toroid surface the derivative of the armour wire axial strain denoted by ε in terms of the armour wire arc length denoted by s can be approximately evaluated by 13 d ε d s κ sin ϕ cos 2 ϕ sin θ it can be seen that the maximum strain variation rate locates at the neutral plane thereafter considering the standard coulomb friction model with no elastic domain and assuming that the armour wire slides along the helix direction the first sliding condition can be given as 14 μ p n s e π d 2 4 d ε d s substituting eqs 12 and 13 into eq 14 and applying θ 0 5 π neutral plane the minimum bending curvature that triggers the armour wire first sliding at the neutral plane can be obtained as 15 κ c r 4 μ p t e π d 2 r sin ϕ cos 2 ϕ this equation has been presented in similar forms among others by witz and tan 1992 substituting the armour wire parameters presented in table 1 into eq 15 and applying the longitudinal compression 1563 n the critical curvatures for the friction coefficients 0 05 0 1 0 15 can be obtained respectively as 3 2 e 4 m 1 6 5 e 4 m 1 9 7 e 4 m 1 3 1 friction coefficient 0 1 maximum elastic slip 0 01 mm firstly a case study is performed for an armour wire subjected to axial compression p c r and cyclic curvatures between zero and 0 3 m 1 with the friction coefficient and the maximum elastic slip equal to 0 1 and 0 01 m m respectively the total cpu time is 42475 s fig 6 shows the sticking sliding status of the armour wire in the first bending cycle when the curvature increases from zero to 0 3 m 1 where the values on the left side represent the bending curvatures at each moment and red and green represent respectively the sticking and slipping status to better capture the sticking slipping status the increment in the first bending step is set as 1 0 e 4 m 1 it can be seen that the first sliding section locates at the neutral plane when the bending curvature reaches 3 7 e 3 m 1 which is much larger than the analytical estimation 6 5 e 4 m 1 due to the effect of elastic slip thereafter the sliding section expands from the neutral plane towards intrados and extrados with increasing bending curvature when the bending curvature is bigger than 6 53 e 2 m 1 the entire armour wire slides except for the sections at the intrados and extrados due to symmetry moreover the sliding components in the directions along the length of the armour wire and transverse to the armour wire of the section node at the neutral plane marked by the black circle in fig 6 as well as the armour wire end shortening are plotted in fig 7 it can be observed that the instantaneous sliding at the onset of the first sliding is indeed along the tangential direction as assumed in the analytical model besides under this loading condition the sliding magnitudes in either tangential or transverse directions are much larger than the defined maximum elastic slip while the tangential sliding is repeated in cyclic curvatures the transverse sliding component increases monotonically after each bending cycle as a result of the transverse sliding of the armour wire the end shortening also increases monotonically after each bending cycle during the 22 nd bending cycle the tangential and transverse sliding components as well as the end shortening all increase suddenly indicating that the armour wire fails due to lateral buckling considering that the armour wire transverse sliding and the end shortening have similar variation tendency in the following discussion the end shortening is used to illustrate the armour wire stability status consequently the end shortenings of the armour wire subjected to different axial compression and cyclic curvature with the friction coefficient and the maximum elastic slip equal to 0 1 and 0 01 m m respectively are presented in fig 8 the squeezed plots in fig 8 are enlarged and illustrated in fig 9 it can be seen that the end shortenings increase monotonically after each bending cycle and grow suddenly when the lateral buckling takes place for the cases with the axial compression equal to or bigger than 0 85 p c r in contrast the end shortening grows with a decelerating rate and approaches a stable value after some bending cycles for the case with the axial compression equal to 0 8 p c r consequently it can be concluded that the armour wire lateral buckling limit should lie between 0 8 p c r and 0 85 p c r under this loading condition the difference with the analytical estimation may be due to the small deflection assumption employed in the analytical development moreover to illustrate the armour wire deflection in cyclic bending the armour wire circumferential angular position variations denoted by δ θ for the cases with the axial compression equal to 0 8 p c r p c r and 0 85 p c r after different bending cycles are illustrated respectively in figs 10 12 it can be seen that the armour wire deflection is composed of not only a periodic component but also a global component which is due to the boundary effect li et al 2019b for the stable case as shown in fig 10 the periodic component grows much faster than the global component in the first 50 bending cycles thereafter the periodic component is nearly stable while the global component continues to increase at a very small rate in the subsequent bending cycles in contrast for the case with axial compression p c r since the armour wire develops into the lateral buckling very fast after only 21 bending cycles there is no sufficient time for the global deflection component to grow before the initiation of lateral buckling as a result the deflection is dominated by the periodic component see fig 11 however when the applied axial compression is just slightly larger than the critical load significant bending cycles are required to initiate the lateral buckling which provides sufficient time for the global deflection component developing consequently under this circumstance the armour wire deflection at the moment before the initiation of lateral buckling is a mix of global and periodic components see fig 12 nevertheless despite the presence of the global deflection component due to the end effect the armour wire failed due to a local lateral buckling at the extrados in the middle armour wire pitch i e normalized pitch length equals 1 or 2 for all those buckling cases to illustrate the buckling shapes the armour wire configurations after different bending cycles for the cases subjected to axial compression 0 85 p c r and 1 5 p c r in the y z and x z planes are illustrated respectively in fig 13 and fig 14 where the numbers on the left side represent the bending cycles and the contour shows the maximum von mises stress at those four integration points of each armour wire cross section in fig 14 the number 3 44 represents the moment when the bending curvature increases to 0 88 times the maximum curvature during the fourth bending cycle from fig 13 it can be seen that the armour wire already reaches the yield stress in the regions close to the extrados in the middle pitch after 250 bending cycles thereafter the armour wire fails after a few additional bending cycles as illustrated in fig 8 in contrast for the case with axial compression 1 5 p c r the maximum von mises stress in the armour wire is still much smaller than the yield stress after 3 bending cycles however it increases suddenly and reaches the yield limit during the fourth bending cycle see fig 14 based on the discussion above it can be concluded that the cases with axial compression 0 85 p c r and 1 5 p c r fail due to plastic and elastic buckling respectively to further reveal the stress distributions fig 15 and fig 16 show respectively the axial stresses and the maximum von mises stress at the four integration points of each armour wire cross section for the case subjected to axial compression 0 85 p c r after 200 and 250 bending cycles in which the axisymmetric stress is obtained by dividing the applied axial compression by the armour wire cross sectional area it can be observed that the first yield locations are near the extrados in the middle armour wire pitch symmetrically consequently to reveal the stress status at the onset of lateral buckling the maximum von mises stress in the armour wire extrados in the middle pitch in terms of the bending cycles for the cases presented in fig 8 are illustrated in fig 17 and enlarged in fig 18 to better capture the first cycles it can be seen that the cases with axial compression a 0 8 p c r b 0 85 p c r 0 9 p c r p c r c larger than p c r are respectively a stable in the elastic stage b fail due to plastic buckling and c fail due to elastic buckling 3 2 friction coefficient 0 05 maximum elastic slip 0 01 mm thereafter similar case studies are performed but with a smaller friction coefficient equal to 0 05 applying the same loading as the case presented in fig 6 the critical curvature that triggers the first armour wire sliding under the present condition is 3 4 e 3 m 1 which is slightly smaller than 3 7 e 3 m 1 for the case shown in fig 6 but still much larger than the analytical estimation 3 2 e 4 m 1 comparably the end shortenings of the same armour wire under the same loading conditions are presented in fig 19 and fig 20 it can be observed that the armour wire lateral buckling limit still lies between 0 8 p c r and 0 85 p c r even with a smaller friction coefficient nevertheless the required number of bending cycles to initiate the lateral buckling for each case is less than that of the same case with friction coefficient 0 1 as a consequence of the reduced frictional resistance the cases with axial compression equal to and bigger than p c r fail during the first bending cycle before the curvature reaches the maximum value 0 3 m 1 see fig 20 the armour wire deflection shapes at different bending curvatures for the case in axial compression 1 5 p c r is shown in fig 21 illustrating that the armour wire still buckles in a periodic shape even with such a small friction coefficient subsequently the maximum von mises stress in the armour wire extrados in the middle pitch in terms of the bending cycles for those cases are shown in fig 22 and fig 23 it can be seen that the cases with axial compression a 0 8 p c r b 0 85 p c r 0 9 p c r c equal to or bigger than p c r are respectively a stable in the elastic stage b fail due to plastic buckling and c fail due to elastic buckling 3 3 friction coefficient 0 15 maximum elastic slip 0 01 mm moreover additional case studies are performed for the same armour wire under the same loading conditions but with a larger friction coefficient 0 15 under this circumstance the minimum bending curvature that triggers the first sliding in the armour wire subjected to p c r is 4 1 e 3 m 1 which is slightly larger than 3 7 e 3 m 1 for the case presented in fig 6 and still much larger than the analytical estimation 9 7 e 4 m 1 the armour wire end shortenings in those cases are presented in fig 24 and the squeezed plots are enlarged in fig 25 to better capture the first cycles according to the end shortening variation tendency if the case with axial compression 0 85 p c r buckles eventually it would require a significant number of bending cycles due to the limited computational resource this case was terminated after nearly 200 bending cycles although the final state of this case is unknown it is conceivable that the applied axial compression 0 85 p c r is very close to the actual critical load besides the maximum von mises stress in the armour wire extrados in the middle section in terms of the bending cycles of those cases are shown in fig 26 and the squeezed plots are enlarged in fig 27 it can be observed that except the case with axial compression 0 85 p c r the cases with axial compression a 0 8 p c r b 0 9 p c r p c r 1 1 p c r 1 2 p c r c equal to or bigger than 1 3 p c r are respectively a stable in the elastic stage b fail due to plastic buckling and c fail due to elastic buckling 3 4 friction coefficient 0 1 maximum elastic slip 0 001 mm thereafter case studies are performed under the same loading conditions with the friction coefficient and the maximum elastic slip equal to 0 1 and 0 001 m m respectively as a consequence of the reduced maximum elastic slip it is easier for the armour wire to slide in bending comparing with the case presented in fig 6 the minimum bending curvature to cause the first sliding in the armour wire subjected to p c r under the present condition is 1 0 e 3 m 1 which is much smaller than 3 7 e 3 m 1 for the case shown in fig 6 and is closer to the analytical estimation 6 5 e 4 m 1 moreover fig 28 shows the end shortenings of those cases in cyclic bending where the squeezed plots are enlarged in fig 29 besides the maximum von mises stresses in the armour wire extrados in the middle pitch for the cases presented in figs 28 and 29 are illustrated in fig 30 and fig 31 respectively comparing the results presented in figs 28 31 with the results of the cases with friction coefficient 0 1 and elastic slip 0 01 m m it can be observed that reducing the elastic slip from 0 01 m m to 0 001 m m does not cause any notable change in the range of critical load and the elastic or plastic buckling status this is because the armour wire sliding magnitude in this bending curvatures is much larger than the applied maximum elastic slip as illustrated in fig 7 the only difference caused by this modification is that the lateral buckling takes place after slightly fewer bending cycles for the cases with axial compression 0 85 p c r and 0 9 p c r under this condition 3 5 friction coefficient 0 1 maximum elastic slip 0 1 mm additionally more case studies are performed under the same loading conditions with the friction coefficient and the maximum elastic slip equal to 0 1 and 0 1 m m respectively as a result of a larger maximum elastic slip the minimum bending curvature that causes the first sliding of the armour wire subjected to p c r under this condition is 3 1 e 2 m 1 which is much larger than 3 7 e 3 m 1 for the case presented in fig 6 as well as the analytical estimation 6 5 e 4 m 1 fig 32 shows the end shortenings of those cases where the squeezed plots are enlarged in fig 33 also the maximum von mises stresses in the armour wire extrados in the middle pitch for the cases presented in figs 32 and 33 are illustrated respectively in fig 34 and fig 35 it is interesting to note that by increasing the elastic slip from 0 01 m m to 0 1 m m the case with axial compression 0 85 p c r becomes stable and the lateral buckling limit range hence lies between 0 85 p c r and 0 9 p c r meanwhile the elastic or plastic buckling statuses for the buckling cases are still the same 3 6 discussions based on the preliminary discussion above it can be seen that the critical curvature for the first sliding depends not only on the friction coefficient but also on the maximum elastic slip to further illustrate the effect of the maximum elastic slip on the critical curvature additional parameter studies are performed applying axial compression p c r and bending load with the maximum elastic slip varied at each friction coefficient the obtained critical curvatures of those cases as well as the previously discussed cases are presented in table 2 it can be observed that the critical curvatures given by the finite element model agree very well with the analytical estimation for all the selected friction coefficients when the maximum elastic slip is equal to 0 0001 m m in another word the analytical model is reliable for the coulomb friction model with a very small elastic region however in reality the elastic slip may not be that small considering the shear deformation of the anti wear tape from table 2 it can be seen that varying the maximum elastic slip from 0 0001 m m to 0 1 m m causes a significant difference in the critical curvatures therefore it is vital to consider the effect of elastic slip for the armour wire sticking slipping status evaluation additionally the final state number of bending cycles to initiate the lateral buckling and the corresponding elastic or plastic buckling status for all the previously discussed cases are summarized in table 3 in which the integer and non integer indicate respectively that the buckling takes place when the curvature increases towards the maximum value and returns to zero during the bending cycle and blue and red represent respectively the elastic and plastic buckling an empirical function has been proposed for the approximate estimation of the bending cycle number to initiate buckling at different axial compression 16 n a p p c r p c r p c r where p c r is the actual lateral buckling limit a is a non dimensional parameter and n is the number of bending cycles to initiate the lateral buckling fig 36 shows the plots of the bending cycles and the corresponding fitting curves using eq 16 for all those cases presented in table 3 where hollow and solid symbols represent respectively the elastic and plastic buckling and the dashed lines represent p c r p c r for cases at each condition the parameters of those fitting curves are presented in table 4 it needs to be noted that this is only an empirical model so that the obtained lateral buckling limit p c r is only an approximation according to fig 36 and table 4 it can be observed that the lateral buckling limits for the cases with different friction coefficients but the same maximum elastic slip are very close which is in accordance with the findings achieved in the analytical model li et al 2019a nevertheless it needs to be noted that the friction coefficient has an obvious effect on the number of bending cycles to initiate the lateral buckling fig 37 shows the end shortenings of the armour wire subjected to axial compression 0 9 p c r and cyclic curvatures with the maximum elastic slip equal to 0 01 m m and the friction coefficient equal to 0 05 0 1 and 0 15 respectively it is evident that more bending cycles are required to initiate the lateral buckling for the case with a larger friction coefficient besides it can also be noted that increasing the friction coefficient increases the range of axial compression for the plastic buckling since it is more difficult for the armour wire to buckle elastically with higher frictional resistance on the other hand when the maximum elastic slip is extremely small e g γ 0 001 m m or 0 01 m m the varying of the maximum elastic slip has a negligible effect on the lateral buckling behavior nevertheless increasing the maximum elastic slip from 0 01 m m to 0 1 m m improves the armour wire stability this can be observed in fig 38 which shows the end shortenings of the armour wire subjected to axial compression 0 85 p c r and cyclic curvatures with the friction coefficient equal to 0 1 and the maximum elastic slip equal to 0 001 m m 0 01 m m and 0 1 m m respectively besides it can also be observed from table 3 that modifying the maximum elastic slip does not change the elastic or plastic buckling status 4 conclusions in this work a nonlinear static finite element model was developed for the investigation of circular armour wire lateral buckling in an umbilical for wet annulus condition the isotropic coulomb friction model regularized with an elastic domain was employed to simulate the tangential behavior at the interface between the armour wire and the underlying toroid surface the armour wire responses in different axial compression associated with cyclic bending between the straight condition and a maximum bending condition were simulated and discussed sensitivity studies of the friction coefficient and the maximum elastic slip in the coulomb friction model on the armour wire sliding and lateral buckling mechanism were conducted the results indicate that the critical curvature to trigger the first armour wire sliding depends not only on the friction coefficient but also on the maximum elastic slip while the analytical model for the critical curvature works well for the cases with an extremely small elastic slip it fails when the elastic slip is not ignorable for future studies it is of interest to improve the analytical model to consider the elastic slip besides it was demonstrated that increasing either the friction coefficient or the maximum elastic slip tends to increase the required bending cycles to initiate the lateral buckling nevertheless the critical axial compression that may eventually cause the lateral buckling after numerous bending cycles is not sensitive to the friction coefficient when it is between 0 05 and 0 15 this is in accordance with the findings achieved in the analytical model however it was found that increasing the maximum elastic slip from 0 01 mm to 0 1 mm may increase the lateral buckling limit to some extent note that in a physical umbilical the elastic slip is principally generated by the shear deformation of the underlying polymeric anti wear tape thus this is corresponding to a state that the armour wire stability may be improved to some extent by applying a thicker polymeric tape additionally the results also illustrate that under certain loading conditions the elastic or plastic buckling status depends principally on the friction coefficient rather than on the magnitude of the maximum elastic slip increasing the friction coefficient increases the range of axial compression that may cause plastic buckling it needs to be emphasized that several hypotheses were implemented in this finite element study the armour wire radial expansion and end rotation were restricted the transverse contact between the neighboring armour wires in the same layer was not considered as only one armour wire was modeled the contribution of the other layers on the umbilical overall behavior in the post buckling stage was ignored the effects of those assumptions on the umbilical armour wire lateral buckling mechanism need to be carefully addressed in future work also experimental tests on the umbilical armour wire lateral buckling are needed for the verification and validation of the analytical and numerical models author statement the manuscript has not been published before or submitted to another journal for the consideration for publication the manuscript has been approved by all authors and by the responsible authorities where the work was carried out if the manuscript is accepted it will not be published elsewhere in the same form in english or in any other language without the written consent of the publisher credit authorship contribution statement xiaotian li conceptualization methodology software investigation formal analysis writing original draft murilo augusto vaz investigation formal analysis writing review editing supervision project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors acknowledge the support from the national council of scientific and technological development cnpq no 302380 2013 2 and the brazilian coordination for the improvement of higher education personnel capes no 1987 2014 for this work 
21159,this study attempts to refine a model named the integrated formula of wave overtopping and runup modeling iform to improve the prediction performance of mean wave overtopping discharge for a broader range of installation conditions the empirical formula describing the relation between overtopping discharge and maximum runup has been re examined a set of piecewise formulas is implemented in the iform by optimal reconstruction of coefficients depending on the magnitude of deficit in freeboard the refined iform improves the tendency to underestimate the discharge in the range of relatively high freeboard conditions while it retains the high performance of the original iform in the range where the crest freeboard is relatively low the refined model s capability for overtopping prediction is validated by comparison with various existing experimental datasets for inclined vertical seawalls installed at relatively shallow water depth or on land the prediction accuracy is also examined by comparison with well known overtopping formulas qualitative and quantitative comparisons validate that the current model is able to reproduce the experimental observations over a broad range of overtopping conditions and that the performance of the model proposed in the present study is as good as existing representative models keywords wave overtopping inclined seawall vertical seawall integrated formula of overtopping and runup modeling iform 1 introduction the frequent occurrence of violent storms related to intensified typhoon cyclones and or ongoing sea level rise induced by climate change has been becoming a serious threat for coastal societies over the world besides many of the structures for coastal defense have been deteriorating at an increasing rate in many developed countries in order to renewal such aging facilities as effective countermeasures against the violent natural forces under the changing environments it is essentially important to properly estimate wave overtopping as well as runup in a unified way over a wide range of conditions of installation and external forces accordingly significant efforts have been made during the last several decades in order to develop effective design assessment tools representative compilation of the available prediction methods can be found in various literature e g by u s army corps of engineers usace 2002 technical advisory committee on flood defense taw 2002 coastal engineering committee japan society of civil engineers 2004 eurotop 2007 and 2018 coastal development institute of technology cdit 2018 in europe eurotop manual on wave runup and overtopping was first published in 2007 eurotop 2007 the prediction formulas in eurotop 2007 was established based on the original clash datasets provided by the research project on crest level assessment of coastal structures by full scale monitoring neural network prediction and hazard analysis on permissible wave overtopping de rouck et al 2002 verhaeghe 2005 van der meer et al 2009 hereafter this dataset is called as clash dataset for brevity since then the manual has been widely incorporated in practical engineering activities initially the eurotop manual focused on the seawalls installed at relatively deep water depth more recently in its redaction published in 2018 eurotop 2018 the prediction capability has been extended based on a new eurotop database in which a series of additional experimental datasets for cases of low freeboard is appended to the clash datasets the present eurotop database also includes the cases of structures installed on very shallow water depth based on the experimental results by altomare et al 2016 in japan the design procedure for the determination of crest levels of seawalls is based on the technical standards and commentaries for port and harbor facilities in japan tsc issued by the overseas coastal area development institute of japan 2009 and the technical standards and commentaries for coastal facilities in japan coastal development institute of technology cdit 2018 proposed prediction methods are summarized by coastal engineering committee japan society of civil engineers jsce 2004 in which most of the proposed methods treated the vertical and inclined seawalls separately using the clash datasets goda 2009b formulated a unified prediction model for inclined vertical seawalls to estimate the overtopping discharge more recently mase et al 2013 have developed an integrated prediction model for wave runup and overtopping to provide an effective design tool based on the consistent assessment of runup and overtopping it was named later as iform integrated formula of overtopping and runup modeling in tamada et al 2015 the model is based on an imaginary slope method proposed by nakamura et al 1972 and can be flexibly applied to a variety of design conditions including the complex shape of cross sections moreover the model satisfies the proper boundary conditions for overtopping formulas proposed by hedges and reis 1998 which can provide a unified and consistent prediction of wave runup and overtopping initially iform was developed for gently sloped seawalls constructed on land or very shallow water that was typically seen along the japanese coastlines one of the distinct features of iform is that the model application is straightforward even in cases of seawalls constructed on the land further efforts have been made by tamada et al 2015 to extend the applicability of iform to vertical or steep slope seawalls and to the seawalls constructed at relatively deep water depth in the previous studies the model capability of overtopping prediction has been validated against the experiments by tamada et al 2002 and extracted clash database mase et al 2013 2016 tamada et al 2015 the results demonstrated that the overall prediction capability of iform is as good as other existing models such as reis et al 2008 goda 2009b and van der meer and bruce 2014 and that the model is able to quickly provide consistent and useful information on wave runup and overtopping without detailed numerical computations under the conditions in which the relative freeboard is high and close to the threshold of overtopping occurrence on the other hand it has been observed that the model tends to underestimate the overtopping discharge compared with experimental observations mase et al 2013 2016 tamada et al 2015 since the tendency of underestimation is observed only for specific conditions of small overtopping discharge it is considered that the re construction of the formula relating the runup and overtopping in broader conditions leads to more accurate estimation in this study accordingly we attempt to re calibrate the overtopping formula used in iform mase et al 2013 tamada et al 2015 to provide reliable predictions under a broader range of overtopping conditions a set of piecewise formulas is newly derived and implemented in the model the accuracy of the original and refined model is verified against existing hydraulic experiments for inclined and vertical seawalls the comparison with the predictions by representative existing overtopping models is also provided this paper is organized as follows section 2 explains the methodology adopted in the model refinement section 3 describes the method of model performance assessment as well as the experimental datasets and representative existing models employed for comparison the refinement of the original iform by mase et al 2013 is conducted in section 4 section 5 examines the results of the model performance assessment by comparison with the existing experimental datasets and models additional discussion on the scaling and the modeling strategy of the overtopping discharge as well as the model uncertainty are provided in section 6 finally the main outcomes are summarized in section 7 the symbols used in the present paper are defined when first used 2 method of model refinement 2 1 overview of integrated formula of wave overtopping and runup modeling mase et al 2013 have developed an integrated prediction model for wave runup and overtopping for seawalls with smooth and impermeable surfaces that were named later as iform in the model non dimensional overtopping discharge q is defined by 1 q q g h o 3 where h o is the equivalent deep water wave height goda 2004 2009b and g represents the gravitational acceleration hereafter the subscript o stands for the values at offshore boundary located in deep water deep water wave characteristics are employed in the modeling to enable the prediction formula to be easily applicable for seawalls even constructed on the land iform is established based on a scheme that links wave runup and overtopping because these two processes are closely related non dimensional overtopping discharge is estimated based on predicted maximum runup r max freeboard r c and equivalent deep water wave height as follows 2a q c γ r max h o 3 2 1 r c h o r max h o ω for 0 r c r max 2b q 0 for r max r c equation 2a includes three non dimensional coefficients c γ and ω the treatment of these empirical coefficients will be mentioned later mase et al 2013 and tamada et al 2015 validated that the model indicates high performance under the condition h t h o 3 0 and tan θ 1 100 where h t is the water depth at the toe of the structure and tan θ represents the bottom slope the maximum runup is estimated from the following equation where r 2 is the runup level exceeded by 2 of incident waves as 3 r max 99 100 1 54 r 2 in eq 3 r max 99 100 means the runup height not exceeded in 99 of cases in runs of 100 incident waves the 2 runup height is evaluated based on the following equations 4 r 2 h o 2 99 2 73 exp 0 57 tan β h o l o in which l o is the deep water wavelength a small safety margin is incorporated in the determination of the coefficients in the above formula in eq 4 an imaginary slope tanβ is introduced to account for realistic compound profiles of actual sea bottom and seawall based on the method proposed by nakamura et al 1972 as 5 tan β h b r 2 2 2 a in which a is the cross sectional area between the breaking point h b breaker depth and the maximum wave runup level fig 1 the computations of eqs 4 and 5 are conducted as an iterative procedure in which the iteration was repeated until the relative difference between two consecutive estimations is smaller than 0 1 the breaker depth h b for general beach profiles can be estimated by the random wave transformation model by mase and kirby 1993 with and without energy dissipation term by wave breaking in particular for planar beaches with bed slope of tan θ the following formulas mase et al 2016 that are fitted for the systematic computational results can be adopted 6 h b h o a 0 a 1 exp ln h o l o a 2 a 3 2 7a a 0 30 2470 27 3440 exp ln 22 9130 tan θ 5 4509 2 7b a 1 9 9467 8 9213 exp ln 29 3880 tan θ 3 1264 2 7c a 2 0 0302 0 0023 exp ln 25 9160 tan θ 1 7065 2 7d a 3 6 1291 3 5001 exp ln 36 3660 tan θ 1 3457 2 these formulas are applicable as an approximation to the curved beaches and bar trough beaches with representative slope tan θ over the nearshore covering the expected surf zone and its seaward portion the breaker depth model shown above is applicable in the range 0 002 h o l o 0 07 and 1 100 tan θ 1 10 the coefficient c in eq 2a was introduced by tamada et al 2015 it is determined by the following equations depending on the seawall slope cot α the condition denoted by cot α 0 corresponds to a vertical seawall 8a c 1 for cot α 2 8b c 0 25 cot α 0 5 for 0 cot α 2 if the gradient of seawall slope is gentler than 1 2 c 1 is assigned the formula on runup and overtopping discharge is then the same as those in mase et al 2013 if the slope of a seawall is steeper than 1 2 e g vertical seawalls or 1 1 gradient seawalls the runup height is computed from the following procedure first r 2 is evaluated by eq 4 as for 1 2 gradient seawalls next the maximum runup r max is computed from eq 3 the overtopping discharge is then evaluated from eq 2 by multiplying the coefficient c that is determined by eqs 8a and 8b based on the actual slope of the seawall in mase et al 2013 and tamada et al 2015 the other two empirical coefficients in eq 2a are set constant as follows 9a γ e 4 000 0 018 9b ω 6 240 the determination of these two coefficients will be re examined and optimized later in the proceeding sections a set of predictive equations together with the empirical coefficients of eqs 9a and 9b is hereafter called as the original iform for the sake of convenience the influence factors related to oblique attack as well as a berm roughness elements on a slope and the presence of a vertical wall on the top of a dike are not treated in mase et al 2013 and tamada et al 2015 and neither considered in the present study 2 2 re evaluation of coefficients in overtopping formula suitable for a broader range of runup conditions in iform the overtopping discharge is estimated from maximum runup the model is constructed based on the concept of hedges and reis model hedges and reis 1998 hereafter referred to as hr model fig 2 that is described as follows 10a q hr γ 1 r hr ω for r max r c 10b q hr 0 for r max r c 11 q hr q g r max 3 r hr r c r max where q hr stands for the normalized overtopping discharge and r hr refers to the ratio of the freeboard of the seawall to the maximum runup level it is noted that the normalization used in hr model in eq 11 and iform in eq 1 is different this is because the normalization with equivalent deep water wave height is more convenient for practical use in iform r max h o 3 2 has thus been introduced in eq 2a to exchange the overtopping discharge based on different definitions of normalization this point will be further discussed in a later section the hr model satisfies the following physical requirements i wave overtopping does not occur when the maximum runup is lower than the freeboard of seawall and ii overtopping discharge remains finite when the freeboard is zero the two coefficients γ and ω in eq 10a correspond to those in eq 2a in iform the γ determines the overtopping discharge when r hr is zero the ω governs the curvature of the curve in fig 2 that controls the relation between q hr and r hr in the original iform the two coefficients γ and ω have been determined through the following procedure based on the experimental datasets for seawalls installed near the shoreline tamada et al 2002 as shown in fig 3 first the non dimensional quantities x and y are defined as 12a x ln 1 r hr 12b y ln q hr the corresponding experimental results are plotted in fig 3 the plots indicate substantial scatter induced by the stochastic nature of wave overtopping this kind of uncertainty may lead to substantial differences in the regression scheme utilized in prediction models in the original iform the focus was placed on the cases where the overtopping discharge is relatively large approximately x 1 in the figure and the regression line was determined so that it could provide a conservative estimate of discharge rate for design assessment purposes the relation between them has then been described by the line given by eq 13 as shown in fig 3 13 y 6 240 x 4 000 it is noted here that the underlying modeling concept in iform is similar to the design approach in eurotop 2018 rather than the mean value approach next γ and ω were determined by eq 9a and by eq 9b respectively as the y intercept and the slope of the regression line described by eq 13 in this way the overtopping formula was established based on a single straight line over the whole area in mase et al 2013 in the area of relatively large x where r hr is low and the overtopping discharge is high fig 3 demonstrates that the adopted regression line passes through the area close to the upper limit of the scattered data and could provide safety prediction for design purposes in contrast the regression line is located far below the measured data in the area surrounded by a red ellipse in the figure this implies that the model prediction tends to substantially underestimate the experimental observations in the range of small x r hr is close to unity in summary the overtopping prediction by the original iform is in good agreement with experimental observations under the conditions of relatively large overtopping discharge while the model tends to underestimate the overtopping discharge under the conditions of relatively small runup close to the threshold of overtopping occurrence this tendency has been observed in the range of approximately q 10 4 in the previous studies mase et al 2013 tamada et al 2015 in this study accordingly an attempt has been made to optimize the prediction formula for overtopping discharge to achieve a high performance of the model prediction for a broader range of r hr the regression formula between the overtopping discharge and the runup is re examined for further adjustment the formulation has been reconstructed as a set of piecewise formulas for three ranges of x or r hr so that it retains the high performance of the original iform in the range of relatively high value of x while the tendency of underestimation in the range of small x is improved selectively 3 method of model performance assessment the performance of the original and refined model is examined by comparison with existing hydraulic experiments and well known prediction models for inclined and vertical seawalls the experimental datasets and existing models employed for comparison the treatment of wave properties at deep water and the method of statistical evaluation are briefly described in the following 3 1 datasets employed for the assessment of model performance 3 1 1 experimental datasets by tamada et al 2002 for inclined seawall first of all the applicability of the original and refined iform is validated by comparison with the measurements by tamada et al 2002 for inclined seawalls note that this dataset has been used as the basis of the development of iform table 1 lists the experimental conditions in the datasets consisting of the extracted data number and the range of main hydraulic and geometric parameters data of zero overtopping discharges were not used in the present analysis the experiments were conducted in a wave flume of 25 m long 0 5 m wide and 0 6 m high for the generation of random waves the bretschneider mitsuyasu spectrum was used the seawalls were installed at relatively shallow water or on land more detailed information can be found in mase et al 2013 3 1 2 experimental datasets by altomare et al 2016 for inclined seawall the applicability of the original and refined iform for inclined seawalls is then further examined through the comparison with experimental results that were conducted independently by other facilities for this purpose the experimental datasets of altomare et al 2016 have been used the experiments were conducted at flanders hydraulics research fhr in belgium the experimental data consists of two datasets ds13 116 and ds13 168 that include 132 cases in total table 2 lists the experimental conditions in the extracted datasets consisting of the dataset name the number of extracted data from each dataset and the range of the main hydraulic and geometric parameters the seawalls were installed at relatively shallow water or on land the details of the experiments at fhr can be found in altomare et al 2017 and chen et al 2015 3 1 3 experimental datasets extracted from clash database for vertical seawall next the applicability of the original and refined iform is validated by comparison with the measurements for vertical seawalls extracted from the clash datasets the data extraction was made for the cases of a plain vertical wall with smooth and impermeable surfaces that satisfy the conditions of h t h o 3 0 and tan θ 0 01 the data with rf reliable factor 4 were considered to be unreliable and excluded from the analysis the comparison was limited to the cases of simple cross sections and the data with cf complexity factor 1 were also excluded data of zero overtopping discharges were not used in the present analysis extraction resulted in 270 cases from 5 datasets table 3 lists the experimental conditions in each dataset consisting of the dataset name the number of extracted data from each dataset the range of the main hydraulic and geometric parameters 3 2 existing overtopping models employed for the assessment of model performance 3 2 1 prediction models for inclined seawall for inclined seawalls additional comparisons are conducted against the formulas by altomare et al 2016 and by goda 2009b among the existing overtopping prediction formulas hereafter these formulas are called the altomare and goda models respectively the altomare model adopted in eurotop 2018 has improved the applicable range of the model of van gent 1999 adopted in eurotop 2007 by incorporating an equivalent i e imaginary slope that uses the wave height at the toe of the structure and r 2 the altomare model has been tuned against the latest eurotop datasets that include the two datasets 13 116 and 13 168 used in this study the goda model has been derived through the analysis of the datasets selected from the clash datasets wave properties at the toe of the structure are used for prediction in these models 3 2 2 prediction models for vertical seawall for vertical seawalls further comparisons were made with the existing overtopping models proposed by eurotop 2018 and by goda 2009b it is noted that the eurotop model is based on the eurotop database including the clash datasets the goda model is also established based on the clash datasets wave properties at the toe of the structure are used for prediction in these models 3 3 treatment of wave properties at deep water specification of the deep water wave period is needed in the evaluation of deep water wavelength in eq 4 in iform the significant wave period t 1 3 o is usually used for this purpose the deep water wave properties are specified as follows in the course of iform prediction 14 h o h 1 3 o t o t 1 3 o l o g 2 π t o 2 in which h 1 3 o and t 1 3 o refers to the significant wave height and period respectively defined at the offshore deep water boundary in the datasets of altomare et al and the extracted clash datasets the information on the deep water wave properties are given as the h m0 o significant wave height computed from the spectrum t p o peak wave period t m o average wave period and t m 1 0 o spectral wave period in eurotop 2018 typical relations are described among the wave properties based on the different definitions as follows 15 t 1 3 1 1 1 25 t m t p 1 1 t m 1 0 and h 1 3 h m 0 goda 2009a suggested slightly different relations 16 t 1 3 t m 1 0 and h 1 3 0 95 h m 0 referring to the description in eurotop 2018 eq 15 the deep water wave properties in iform are calculated as follows in this study for the datasets of altomare et al and clash 17 t o t 1 3 o 1 1 t m 1 0 o a n d h o h 1 3 o h m 0 o it was confirmed that if the significant wave period t 1 3 o is estimated based on t p o or t m o with the relation presented in eq 15 mostly similar results were obtained it is noted that the non dimensional overtopping discharge is evaluated based on the wave characteristics at deep water in iform while it is evaluated based on the wave height at the toe of the structure in the formulas of the altomare goda and eurotop models for consistent comparison when we apply the formulas in these models the dimensional discharge rates are first computed by their formulas and then normalized by using the wave height at deep water as in iform 3 4 indices for statistical assessment of model performance goda 2009b proposed the use of the geometric mean μ gm and the geometric standard deviation σ gm to evaluate the overall performance of the models 18 μ gm exp 1 n i 1 n ln r i here r i is the ratio of predicted overtopping discharge to measured one hereafter called as the ratio of overtopping prediction 19 r i q pred i q meas i in which the subscripts pred and meas represent the results obtained from model prediction and experimental measurement respectively the scatter of data is evaluated with the geometric standard deviation σ gm defined below 20 σ gm exp 1 n i 1 n ln r i 2 ln μ gm 2 0 5 in the mean value approach the prediction model is usually calibrated so that μ gm approaches unity at the same time however 50 of prediction is considered to be below the measurement when μ gm 1 for design purposes accordingly a parameter setting reproducing μ gm 1 is not necessarily the best choice additional indices should be taken into account to assess the model performance for this purpose the five percent non exceedance and exceedance values or equivalently the 90 confidence interval is often used if the overtopping prediction ratio r i is assumed to follow the log normal distribution 90 of the predicted ratio is to be located in the range between the five percent non exceedance and exceedance values r l 5 and r u 5 respectively 21 r l 5 μ gm 1 64 σ gm r u 5 μ gm 1 64 σ gm these indices are also used in the assessment of the prediction performance when appropriate the assumption of log normal distribution is adopted also in many of the recent overtopping studies e g goda 2009b eurotop 2018 liu et al 2020 the validity of this assumption is examined later in altomare et al 2016 and eurotop 2018 the overtopping formula has been presented based on mean value approach and design or assessment approach the mean value approach estimates the mean value of the stochastic overtopping data the design approach incorporates some safety factor and can be used straightforwardly in the design procedures of coastal structures since the formulation of iform is close to the design approach the comparison with eurotop prediction is mainly made for the design approach it is noted that the goda model is considered to be categorized as the mean value approach 4 refinement of integrated runup overtopping model to obtain overtopping formulas that are applicable to a wide range of overtopping conditions the model equations are empirically re established as a set of piecewise formulas for the following three ranges of x zone i 0 5 x zone ii 1 4 x 0 5 zone iii x 1 4 the zoning above was determined empirically through try and error basis conditions x 1 4 and 0 5 correspond to r max r c 1 33 and 2 54 respectively fig 4 indicates that due to the scattering of observed data the magnitude of overtopping discharge corresponding to y substantially varies for the same value of normalized runup corresponding to x for design purposes accordingly the regression formulas were determined so that the line curve passes close to the upper limit of the scattered data this kind of conservative determination of regression formulas implies that the prediction scheme adopted in the refined iform has some safety factor and the overall model predictions are expected to be larger than the mean of the scattered measurement data zone i corresponds to the case where the crest freeboard is relatively low in other words runup height is sufficiently high and the resulting overtopping discharge becomes large in this zone it has been verified that the original iform provides satisfactory predictions of overtopping discharge mase et al 2013 tamada et al 2015 and therefore the same form is retained in this zone 22 y 6 24 x 4 00 0 5 x as was mentioned before the parameters γ and ω in eq 2 are determined from the slope and intercept of the regression line as 23a γ e 4 000 0 018 0 5 x 23b ω 6 240 0 5 x the overtopping formula in zone iii was constructed as follows in this zone the variation of y was quite gentle compared with other zones since the slope of the regression equation appears as a power index in eq 2a it may have a significant influence on the estimation of overtopping discharge when the maximum runup height is close to overtopping threshold i e 1 r c r max is small in the original iform the use of eq 13 in this area resulted in the underestimation of overtopping discharge in this study accordingly the slope of the regression line in zone iii was set as unity because of the following two reasons first it represents the variation of y in zone iii quite well and second it is the minimum limit for the curve in the hr model in fig 2 to be convex downward the regression line was then set as shown below 24 y x 8 98 x 1 4 the value of the intercept was determined empirically by trial and error approach based on the slope and intercept of the regression line given by eq 24 the two parameters γ and ω are determined as 25a γ e 8 98 0 00013 x 1 4 25b ω 1 000 x 1 4 finally the parabolic curve given by eq 26 was adopted in the central zone zone ii the form of this curve was determined so that it can provide a smooth transition between the lines given by eqs 22 and 24 at both ends of the zone ii 26 y 2 91 x 2 9 15 x 3 27 1 4 x 0 5 in this zone the values of γ and ω are determined from the slope b and the y intercept d of the tangential line to the parabolic curve the values of b and d are not constant but vary with x as 27a b x 5 82 x 9 15 27b d x 3 27 2 91 x 2 the values of γ and ω are then determined as functions of x as follows 28a γ e d x e 3 27 2 91 x 2 1 4 x 0 5 28b ω b x 5 82 x 9 15 1 4 x 0 5 in the course of the reconstruction of model equations several other forms were tested the form presented here has been adopted from the overall viewpoints of the consistency with the original iform brevity of expressions and overall prediction performance hereafter the iform with the use of eqs 23 25 and 28 is called as the refined iform 5 results of model performance assessment 5 1 comparison with the experiments by tamada et al 2002 for inclined seawall the predictions of overtopping discharge by the original iform and refined iform are compared with experimental observations by tamada et al 2002 in a dimensionless form in fig 5 the data are classified into three groups according to the slope of the seabed in the figures three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red overall the prediction by the original iform provides good agreement with the experiment in fig 5 a the predicted values are mostly located slightly above the measurements because a conservative determination was conducted for the coefficients during the formulation of iform in the range where the normalized overtopping discharge is smaller than approximately 10 4 however the original iform tends to underestimate the overtopping discharge as mentioned before in several cases the underestimation of the overtopping discharge reached up to one or two orders of magnitude in contrast the accuracy of prediction in this zone is significantly improved in the refined iform in fig 5 b except for an outlier all of the results are located in the range larger than 10 1 times of the measurements in the area where the normalized overtopping discharge is larger on the other hand the refined iform provides the same estimations as to the original iform it is noted that the prediction based on the refined iform provided a conservative estimate in the figure namely the predicted values are close to or larger than measured values this is because eqs 22 24 and 26 are determined so that they are located close to the upper limit of the scattered data the characteristics of scattering in the plot are similar for different seabed slope the ratio of overtopping prediction is then plotted against the freeboard normalized by the maximum runup in fig 6 a 90 confidence interval is shown in the figure by dashed lines in blue and 50 exceedance level is indicated by the dash dot line in red since the original iform tends to underestimate the overtopping discharge in the range corresponding to zone iii the ratio of overtopping prediction obtained by the original iform exhibits a downward shift toward the right these are significantly improved in the refined iform thus it is confirmed that the prediction by the refined iform was selectively improved in zones ii and iii the new formulas successfully provide the conservative estimate of overtopping discharge for design purposes and indicate no shift over the whole range both of the geometric mean μ gm and geometric standard deviation σ gm for the refined iform has been satisfactorily improved compared with the original one table 4 the use of the refined iform resulted in the μ gm for overall data of 2 92 and the corresponding σ gm is 3 34 if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the predicted data is to be located in the range between approximately 0 5 and 16 times the measured values fig 7 indicates the relation between the non dimensional overtopping discharge and non dimensional maximum runup height in the refined iform the data are classified into five groups according to the ratio of the freeboard to deep water wave height the markers indicate the experimental results by tamada et al 2002 the curves in the figure are obtained by the refined iform the curves represent the general trend of the measurement well compared with the original iform e g fig 21 in mase et al 2013 the curves are modified so that they envelop the measured results over the whole range of runup especially where the non dimensional discharge is small 5 2 comparison with the experiments by altomare et al 2016 for inclined seawall next the original and refined iform were applied to the test conditions of the experiments by altomare et al 2016 listed in table 2 the prediction of overtopping discharge by the original iform is compared with observations in a dimensionless form in fig 8 a the data are classified into two groups according to datasets in the figure three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red qualitatively the original iform reproduces the overall variation of overtopping discharge and most of the predictions lie between the lines that indicate the prediction is 0 1 times and 10 times the measured values however it tends to underestimate the experimental observation this tendency is more apparent for small values of overtopping discharge for several cases in ds 13 168 in particular the original iform underestimates the overtopping discharge up to one to three orders of magnitude comparisons between the refined iform predictions and measurements are demonstrated in fig 8 b besides the ratio of overtopping prediction is plotted against the experimental non dimensional discharge in fig 9 a 90 confidence interval is shown in the figures by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red compared with the predictions by the original iform the prediction accuracy is significantly improved by the refined iform from the figures it is clear that the tendency of underestimation is improved in the area of small overtopping the prediction for the cases of outliers in fig 8 a are significantly improved in fig 8 b the width of the 90 confidence interval is substantially reduced and the estimations by the refined iform are concentrated closer to the line indicating that prediction and measurement are equal except for a few cases the ratio of overtopping prediction is plotted against measured overtopping discharge in fig 9 the overall reproducibility is satisfactory from a detailed inspection of the figure a decreasing trend is captured for ds13 116 while an increasing trend is recognized for ds13 168 a similar tendency is observed in the prediction by the altomare model described later in fig 11 both of the geometric mean μ gm and geometric standard deviation σ gm for the refined iform have been satisfactorily improved compared with the original iform table 5 the use of the refined iform resulted in the μ gm for overall data of 0 77 and the corresponding σ gm is 2 24 if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the predicted data is to be located in the range between 0 21 and 2 81 times the measured values the corresponding values for the original iform are 0 33 and 15 64 for μ gm and σ gm respectively the μ gm and σ gm values for each of the datasets are also listed in table 5 it is found that the prediction performance of the refined iform has been improved for each of the datasets a comparison of the results against the two datasets indicated that the μ gm becomes smaller while σ gm became larger in ds 168 this is commonly seen in both of the original and refined iform it is noted that although the iform has been modeled to provide a conservative prediction for design purposes the estimation by the refined iform still slightly underestimates the measurements the geometric mean is slightly smaller than unity here this point will be discussed in a later section the comparison between the prediction by existing models and the measurements are shown in fig 10 in the figures three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values the ratio of overtopping prediction is plotted against the experimental non dimensional discharge in fig 11 a 90 confidence interval is shown in the figures by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red the altomare model provided quite satisfactory predictions this is reasonable since the model has been tuned to the conditions including the datasets used in the present study most of the cases are located between 1 and 10 times the measured values the values of μ gm and σ gm for the overall cases are 2 57 and 1 74 respectively as shown in table 5 if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the predicted data is to be located in the range between 0 90 and 7 33 times the measured values it is noted that in this figure the model prediction by the altomare model is based on the coefficients proposed for the design approach if the coefficients in the mean value approach are used the plot will be more concentrated along the line indicating that prediction and measurement are equal for the mean value approach the corresponding μ gm and σ gm are 1 32 and 1 74 respectively in contrast the goda model indicates significant scattering and drastic overestimation up to the order of 102 for substantial numbers of cases the values of μ gm and σ gm for the overall cases are 14 25 and 7 32 respectively as shown in table 5 the μ gm and σ gm values became large for ds11 116 examination of figs 8 11 and table 5 demonstrates that the quantitative reproducibility of the refined iform is close to that of the altomare model the overall performance is sufficiently high compared with the goda model taking into account that the iform is developed independently without tuning to these datasets the overall model performance is considered to be satisfactory 5 3 comparison with the extracted clash datasets for vertical seawall finally the original and refined iform are applied to the test conditions of the extracted clash dataset for plain vertical seawall listed in table 3 the prediction of overtopping discharge by the original and refined iform are compared with the experimental observations in the dimensionless form in fig 12 the data are classified into five groups according to the dataset in the figures three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a 50 exceedance level is indicated by the dash dot line in red the original iform in fig 12 a qualitatively reproduces the overall variation of overtopping discharge and most of the predictions lie between the lines that indicate the prediction is 0 1 times and 10 times the measured values however for several cases located around q meas 10 4 the original iform underestimates the overtopping discharge up to one to three orders of magnitude in fig 12 b the predictions by the refined iform are improved in particular the improvement in prediction for the cases of outliers in fig 12 a is significant the predictions by the refined iform are more closely concentrated slightly above the line indicating that prediction and measurement are equal the ratio of overtopping prediction is plotted against the experimental non dimensional discharge in fig 13 a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data is estimated to fall below the interval and 5 above and the corresponding 50 exceedance level is indicated by the dash dot line in red in the figure the ratio of predicted to measured discharge is located above unity for most of the cases the μ gm and σ gm are listed in table 6 both of the geometric mean and standard deviation for the refined iform seems satisfactory the use of the refined iform resulted in the μ gm for overall data of 1 95 and the corresponding σ gm is 2 57 comparison with the original iform reveals that the scattering is improved σ gm varies from 3 93 by the original iform to 2 57 by the refined iform the μ gm value by the refined iform is more conservative than that by the original iform if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the data predicted by the refined iform is to be located in the range between 0 46 and 8 22 times the measured values some of the predictions corresponding to the cases of 1 50 slope ds 224 and ds502 resulted in slight underestimation μ gm 1 this will be addressed later the comparison between the prediction by existing models and extracted clash datasets are shown in figs 14 and 15 in the figures three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red it is noted that eurotop 2018 model has been tuned for the eurotop2018 database including the clash dataset also the goda model has been tuned for the clash dataset including the five sub datasets in table 3 eurotop2018 model provides mostly satisfactory predictions the values of μ gm and σ gm for the overall cases are 1 71 and 1 94 respectively table 6 it is noted that in this figure the model prediction by eurotop2018 model is based on the coefficients proposed for the design approach if the coefficients in the mean value approach are used the plot will be more concentrated along the line indicating that prediction and measurement are equal for the mean value approach the corresponding μ gm and σ gm are 1 19 1 93 respectively the goda model indicates satisfactory prediction except for a couple of cases in total the goda model slightly underestimates the measurements the values of μ gm and σ gm for the overall cases are 0 79 and 2 24 respectively in fig 15 the ratios of overtopping predictions are plotted the figures show that when q meas 10 4 both models indicate a common tendency of slight overestimation it is noted again that the iform is developed without tuning to the clash datasets nevertheless the overall comparisons of figs 12 15 and table 6 clarify that the performance of the refined iform seems to be as good as the models developed based on the clash datasets the refined iform can be applied in a wide range of conditions for vertical walls 5 4 overall examination of model performance and underlying assumption the overall model performance is briefly summarized here the geometric mean of the ratio of overtopping predictions against all of the datasets used in this study is μ gm all 1 74 accordingly the predictions based on the refined iform generally provide conservative estimations the corresponding standard deviation is σ gm all 3 03 if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the data predicted by the refined iform is to be located in the range between 0 35 and 8 64 times the measured values to examine the validity of the assumption of log normal distribution of r i the cumulative relative frequency of ln r i is plotted in fig 16 the horizontal axis is normalized with its mean and standard deviation the dashed lines in red represent the levels where 5 50 and 95 of the data are located below in the actual prediction results the corresponding plot for the theoretical standard normal distribution mean 0 and standard deviation 1 is also plotted for reference the dashed lines in blue represent the levels where 5 50 and 95 of the data are located below in the theory the overall agreements between the two curves are generally good and the correspondence of the 90 confidence intervals looks reasonable these results thus validate the assumption of log normal assumption of the ratio of overtopping prediction moreover the ratio of overtopping prediction for all of the datasets is plotted against the representative non dimensional parameters in fig 17 a c a 90 confidence interval under the assumption of log normal distribution of r i is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red fig 17 a indicates that the scatter of the prediction ratio increases as the overtopping discharge becomes small this is related to the difficulty in the accurate measurements of small overtopping volume a small error in measurements or also in predictions results in a large scatter similar features are observed for the prediction by other representative models in the present study fig 15 and other studies e g figs 5 13 17 and 18 in goda 2009b the prediction for the small overtopping discharge also has a tendency to be located above the overall mean this tendency is common to the results by eurotop and goda models in fig 15 fig 17 b and c demonstrate that the ratio of overtopping prediction has no bias against the relative freeboard and wave steepness as was mentioned before the plots below the 5 level in fig 17 c mainly belong to the cases of 1 50 slope this will be discussed in the proceeding section 6 discussion 6 1 scaling of overtopping discharge recently ibrahim and baldock 2020 hereafter referred to as ib2020 demonstrated that the overtopping volume can be properly expressed in terms of deficit in freeboard defined as follows 29 δ r max r c r max 1 r hr 1 r c r max more recently altomare et al 2020 further discussed the ib2020 s scaling laws they made a novel attempt to find a generalized model for mean wave overtopping discharge assessment of smooth and impermeable sea dikes differently from other approaches an innovative genetic algorithm called evolutionary polynomial regression epr has been employed epr assisted the identification of the main explanatory variables governing the overtopping their results clarified that 1 the deficit in freeboard is a key explanatory variable for the wave overtopping assessment and 2 the use of this parameter can reduce the scatter of experimental data furthermore epr proved that concepts such as imaginary slope or equivalent slope provide an accurate estimate of the processes that occur on the foreshore and dike and lead to wave transformation and breaking finally affecting the overtopping phenomenon the two coefficients γ and ω in the refined iform are functions of deficit in freeboard because they are expressed in terms of x ln δ hedges and reis 1998 mentioned that the γ and ω parameters in the hr model may be influenced by the seaward profile of the structure the expression adopted in the refined iform is more specific at this point with the use of the deficit in freeboard eq 2a can be rewritten as 30 q q g h 0 3 c r max h o 3 2 γ δ 1 r c r max ω δ r max h o 3 2 c γ δ δ ω δ the quantities in the square bracket are expressed as a function of δ namely the overtopping discharge in the refined iform is modeled in a form that is directly related to the deficit in freeboard furthermore if we adopt an alternative form of normalization hr type form as in eq 11 eq 30 is rearranged as 31 q hr q g r max 3 c γ δ δ ω δ if we consider gently sloped seawalls the coefficient c 1 as in eq 8a then in the prediction by the refined iform the deficit in freeboard becomes the only governing parameter for the mean overtopping discharge normalized with the maximum runup more in general the similar consideration holds for the hr type model the successful application of the refined iform in the present study for a wide range of installation condition suggests that in the initial modeling process it is considered to be effective to scale the overtopping discharge with the runup height in which the influence of not only the wave height but also the wave period wavelength and others are incorporated the consideration above is expected to hold for seawalls with steep slopes for cases corresponding to eq 8b c 1 if the formulation given by eq 31 is valid for a wide range of conditions further considerations are possible as shown in the following as previously mentioned the normalization by h o is more preferable in practical situations to adopt this form the exchange between the different definitions of normalization becomes necessary as a result eq 30 indicates that the discharge normalized by h o is governed not only by δ but also by r max h o appearing as an exchange ratio between different types of normalization namely there appear two principal non dimensional parameters with these parameters eq 30 is composed of the products of the following two components the first component c1 in front of the square brackets expresses to what extent the runup is amplified in relation to the incident wave height the latter component c2 in the square brackets regulates the overtopping volume q hr for the given value of δ note that the estimation of r max is related to both of the processes accordingly the two fundamental processes in the development of an overtopping model are recognized as 1 to establish an accurate runup model and 2 to formulate the relation between the runup and overtopping discharge in terms of the deficit in freeboard and the overtopping discharge scaled with the runup height if each component is modeled properly the prediction formula for overtopping discharge can then be obtained straightforwardly by the combination of them in principle as in iform or hr type models in the modeling of overtopping discharge the following type of formulation has often been used e g goda 2009b eurotop 2007 32 q g h m 0 3 a exp b r c h m 0 based on the analogy with the form in eq 30 it is deduced that the exponential term may correspond to the modeling of c2 and the coefficient a may represent the modeling of c1 the considerations above provide a new insight into the scaling and the modeling strategy of overtopping discharge moreover ib2020 introduced the volume of overtopping per wave as 33 v q t o if we introduce the run up scaling proposed by hunt 1959 according to ib2020 34 r max h o l o tan β ξ h o in which ξ is the surf similarity parameter 35 ξ tan β h o l o it can be shown that the overtopping volume per wave is scaled for the refined iform as 36 v 2 π h o l o tan β ξ c γ δ δ ω δ the above form which is derived from the refined iform or more generally from the hr model is consistent with the expression proposed by ib2020 eqs 24 and 25 in their paper the differences are that eq 36 explicitly include the surf similarity parameter and that the expression for the δ related part is more generalized the form above may be useful as an alternative candidate for the scaling of the volume of overtopping per wave a brief discussion is given here on the power of tan β in the scaling of eq 36 in the scaling based on the refined iform the power of the imaginary slope tan β becomes 3 2 in eq 36 because ξ includes tan β 1 2 on the other hand the power of beach slope is set as 1 or 1 2 in ib2020 see eqs 24 and 25 in ib2020 and 1 2 in eurotop see eq 11 in ib2020 this is considered to be related to the difference in the definition of wave height namely the representative wave height h represents h 1 3 o at deep water in iform while h m0 1 toe after breaking in ib2020 and eurotop the h m0 1 toe is influenced by the bottom slope through wave breaking it is then logical to expect that the power of the beach slope takes different values for different definitions of representative wave height the power should be discussed with the selection of the representative wave properties in the scaling formula moreover the definition of beach slope itself is different depending on the model and the influence of beach slope is also included in the estimation of the imaginary slope and deficit in freeboard although the modeling strategy and selection of proper scaling of overtopping prediction deserves further investigation it is beyond the scope of the present paper more detailed examination on these issues are underway 6 2 uncertainty included in the model prediction since the refined iform has been modeled to provide a conservative prediction for design purposes the model is expected to provide the value of geometric mean larger than unity this is attained for most of the conditions in this study nevertheless it is noted here that for certain datasets the estimations by the refined iform still slightly underestimated the measurements the geometric mean was slightly smaller than unity the underestimation was observed for the experiments of altomare with 1 35 ds13 116 and 1 50 ds13 168 slope seabed and the cases of 1 50 slope condition ds 224 and ds 502 in the clash datasets in the procedure to formulate iform the uncertainty of model prediction may arise in the two processes mentioned in the previous section a the estimation of overtopping based on predicted runup or deficit in freeboard and b the prediction of runup level from the specified wave and installation condition note that the influence of the uncertainty in runup estimation appears in both of them the present study focuses on the former one corresponding to the part in the square brackets in eq 30 and the relation between the predicted runup and overtopping discharge is properly described for a wide range of conditions in the refined iform accordingly the underestimation observed here may be resulted from the latter one namely the underestimation of maximum wave runup the runup formula used in iform is based on the experiments conducted for 1 10 to 1 30 slope of the seabed by mase et al 2004 and by mase et al 2013 over the conditions covered in these experiments the runup formula eq 4 has been validated to be sufficiently accurate as shown in fig 10 in mase et al 2013 since the tendency of underestimation in overtopping discharge is observed for the mildly sloping bed with slope 1 30 out of the conditions of mase et al 2004 and mase et al 2013 additional confirmations may be needed preliminary examinations indicated that the runup prediction based on eq 4 is lower than the prediction based on the method by altomare et al 2016 for ds 168 besides the general features of the influence of smaller prediction in runup height on overtopping discharge can be inferred from fig 7 the sensitivity of the overtopping prediction to the estimation of runup as well as imaginary slope and breaking depth deserves further investigation but it is beyond the scope of this paper these aspects will be treated in the future study 7 summary remarks this study attempted to optimize the integrated formula of overtopping and runup modeling iform for mean overtopping discharge to achieve a high performance assessment for a broader range of overtopping conditions for this purpose the regression formula between the overtopping discharge and the runup in iform was re examined and re evaluated the formulation has been reconstructed with a set of piecewise formulas for three ranges of the runup level relative to the freeboard the refined formulas retain the high performance of the original iform in the range where the freeboard of the seawall is relatively low while they improve the tendency of underestimation selectively in the range of relatively high freeboard conditions close to the threshold of overtopping occurrence the prediction capability of the refined iform for overtopping discharge was validated by comparison with various existing hydraulic experiments for gently sloped seawalls installed at shallow depth or on land the model predictions were compared with the experiment by tamada et al 2002 the results indicated that the refined iform is able to well reproduce the experimental observations over a broader range of overtopping conditions and that it enhances the quantitative accuracy of the prediction the model predictions were further compared with the experiments that were conducted independently from the establishment of iform for inclined seawall installed at shallow water depth the model prediction was compared with the measurement by altomare et al 2016 the model performance of the refined iform was shown to be comparable as that of the altomare model eurotop2018 model that is tuned for the particular experiment the prediction accuracy of the refined iform was superior to the goda formula for plain vertical seawalls the model predictions were compared with the data extracted from the original clash datasets the results well demonstrated the enhanced applicability of the refined iform the model capability was shown to be as good as those of the existing representative models such as those proposed by eurotop 2018 and goda 2009b finally an alternative form of the scaling of the overtopping discharge was provided and discussion has been made on a novel strategy to develop an overtopping model credit authorship contribution statement masatoshi yuhi conceptualization methodology investigation formal analysis writing original draft hajime mase conceptualization supervision writing review editing funding acquisition sooyoul kim writing review editing funding acquisition shinya umeda investigation writing review editing corrado altomare investigation writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is partially supported by the grants in aid for scientific research by the japan society for the promotion of science grant no 19h02403 and 20k05046 and the collaborative research program of the disaster prevention research institute of kyoto university grant no 30g 09 dr c altomare acknowledges funding from the european union s horizon 2020 research and innovation programme under the marie sklodowska curie grant agreement no 792370 suggestive comments from prof hiraishi kyoto university dr kawasaki and dr mizutani hydro technology institute co ltd are most appreciated assistance rendered by mr ohtani a former student of kanazawa university and ms ichimura graduate student of kanazawa university is acknowledged constructive comments and suggestions from the anonymous reviewers are appreciated 
21159,this study attempts to refine a model named the integrated formula of wave overtopping and runup modeling iform to improve the prediction performance of mean wave overtopping discharge for a broader range of installation conditions the empirical formula describing the relation between overtopping discharge and maximum runup has been re examined a set of piecewise formulas is implemented in the iform by optimal reconstruction of coefficients depending on the magnitude of deficit in freeboard the refined iform improves the tendency to underestimate the discharge in the range of relatively high freeboard conditions while it retains the high performance of the original iform in the range where the crest freeboard is relatively low the refined model s capability for overtopping prediction is validated by comparison with various existing experimental datasets for inclined vertical seawalls installed at relatively shallow water depth or on land the prediction accuracy is also examined by comparison with well known overtopping formulas qualitative and quantitative comparisons validate that the current model is able to reproduce the experimental observations over a broad range of overtopping conditions and that the performance of the model proposed in the present study is as good as existing representative models keywords wave overtopping inclined seawall vertical seawall integrated formula of overtopping and runup modeling iform 1 introduction the frequent occurrence of violent storms related to intensified typhoon cyclones and or ongoing sea level rise induced by climate change has been becoming a serious threat for coastal societies over the world besides many of the structures for coastal defense have been deteriorating at an increasing rate in many developed countries in order to renewal such aging facilities as effective countermeasures against the violent natural forces under the changing environments it is essentially important to properly estimate wave overtopping as well as runup in a unified way over a wide range of conditions of installation and external forces accordingly significant efforts have been made during the last several decades in order to develop effective design assessment tools representative compilation of the available prediction methods can be found in various literature e g by u s army corps of engineers usace 2002 technical advisory committee on flood defense taw 2002 coastal engineering committee japan society of civil engineers 2004 eurotop 2007 and 2018 coastal development institute of technology cdit 2018 in europe eurotop manual on wave runup and overtopping was first published in 2007 eurotop 2007 the prediction formulas in eurotop 2007 was established based on the original clash datasets provided by the research project on crest level assessment of coastal structures by full scale monitoring neural network prediction and hazard analysis on permissible wave overtopping de rouck et al 2002 verhaeghe 2005 van der meer et al 2009 hereafter this dataset is called as clash dataset for brevity since then the manual has been widely incorporated in practical engineering activities initially the eurotop manual focused on the seawalls installed at relatively deep water depth more recently in its redaction published in 2018 eurotop 2018 the prediction capability has been extended based on a new eurotop database in which a series of additional experimental datasets for cases of low freeboard is appended to the clash datasets the present eurotop database also includes the cases of structures installed on very shallow water depth based on the experimental results by altomare et al 2016 in japan the design procedure for the determination of crest levels of seawalls is based on the technical standards and commentaries for port and harbor facilities in japan tsc issued by the overseas coastal area development institute of japan 2009 and the technical standards and commentaries for coastal facilities in japan coastal development institute of technology cdit 2018 proposed prediction methods are summarized by coastal engineering committee japan society of civil engineers jsce 2004 in which most of the proposed methods treated the vertical and inclined seawalls separately using the clash datasets goda 2009b formulated a unified prediction model for inclined vertical seawalls to estimate the overtopping discharge more recently mase et al 2013 have developed an integrated prediction model for wave runup and overtopping to provide an effective design tool based on the consistent assessment of runup and overtopping it was named later as iform integrated formula of overtopping and runup modeling in tamada et al 2015 the model is based on an imaginary slope method proposed by nakamura et al 1972 and can be flexibly applied to a variety of design conditions including the complex shape of cross sections moreover the model satisfies the proper boundary conditions for overtopping formulas proposed by hedges and reis 1998 which can provide a unified and consistent prediction of wave runup and overtopping initially iform was developed for gently sloped seawalls constructed on land or very shallow water that was typically seen along the japanese coastlines one of the distinct features of iform is that the model application is straightforward even in cases of seawalls constructed on the land further efforts have been made by tamada et al 2015 to extend the applicability of iform to vertical or steep slope seawalls and to the seawalls constructed at relatively deep water depth in the previous studies the model capability of overtopping prediction has been validated against the experiments by tamada et al 2002 and extracted clash database mase et al 2013 2016 tamada et al 2015 the results demonstrated that the overall prediction capability of iform is as good as other existing models such as reis et al 2008 goda 2009b and van der meer and bruce 2014 and that the model is able to quickly provide consistent and useful information on wave runup and overtopping without detailed numerical computations under the conditions in which the relative freeboard is high and close to the threshold of overtopping occurrence on the other hand it has been observed that the model tends to underestimate the overtopping discharge compared with experimental observations mase et al 2013 2016 tamada et al 2015 since the tendency of underestimation is observed only for specific conditions of small overtopping discharge it is considered that the re construction of the formula relating the runup and overtopping in broader conditions leads to more accurate estimation in this study accordingly we attempt to re calibrate the overtopping formula used in iform mase et al 2013 tamada et al 2015 to provide reliable predictions under a broader range of overtopping conditions a set of piecewise formulas is newly derived and implemented in the model the accuracy of the original and refined model is verified against existing hydraulic experiments for inclined and vertical seawalls the comparison with the predictions by representative existing overtopping models is also provided this paper is organized as follows section 2 explains the methodology adopted in the model refinement section 3 describes the method of model performance assessment as well as the experimental datasets and representative existing models employed for comparison the refinement of the original iform by mase et al 2013 is conducted in section 4 section 5 examines the results of the model performance assessment by comparison with the existing experimental datasets and models additional discussion on the scaling and the modeling strategy of the overtopping discharge as well as the model uncertainty are provided in section 6 finally the main outcomes are summarized in section 7 the symbols used in the present paper are defined when first used 2 method of model refinement 2 1 overview of integrated formula of wave overtopping and runup modeling mase et al 2013 have developed an integrated prediction model for wave runup and overtopping for seawalls with smooth and impermeable surfaces that were named later as iform in the model non dimensional overtopping discharge q is defined by 1 q q g h o 3 where h o is the equivalent deep water wave height goda 2004 2009b and g represents the gravitational acceleration hereafter the subscript o stands for the values at offshore boundary located in deep water deep water wave characteristics are employed in the modeling to enable the prediction formula to be easily applicable for seawalls even constructed on the land iform is established based on a scheme that links wave runup and overtopping because these two processes are closely related non dimensional overtopping discharge is estimated based on predicted maximum runup r max freeboard r c and equivalent deep water wave height as follows 2a q c γ r max h o 3 2 1 r c h o r max h o ω for 0 r c r max 2b q 0 for r max r c equation 2a includes three non dimensional coefficients c γ and ω the treatment of these empirical coefficients will be mentioned later mase et al 2013 and tamada et al 2015 validated that the model indicates high performance under the condition h t h o 3 0 and tan θ 1 100 where h t is the water depth at the toe of the structure and tan θ represents the bottom slope the maximum runup is estimated from the following equation where r 2 is the runup level exceeded by 2 of incident waves as 3 r max 99 100 1 54 r 2 in eq 3 r max 99 100 means the runup height not exceeded in 99 of cases in runs of 100 incident waves the 2 runup height is evaluated based on the following equations 4 r 2 h o 2 99 2 73 exp 0 57 tan β h o l o in which l o is the deep water wavelength a small safety margin is incorporated in the determination of the coefficients in the above formula in eq 4 an imaginary slope tanβ is introduced to account for realistic compound profiles of actual sea bottom and seawall based on the method proposed by nakamura et al 1972 as 5 tan β h b r 2 2 2 a in which a is the cross sectional area between the breaking point h b breaker depth and the maximum wave runup level fig 1 the computations of eqs 4 and 5 are conducted as an iterative procedure in which the iteration was repeated until the relative difference between two consecutive estimations is smaller than 0 1 the breaker depth h b for general beach profiles can be estimated by the random wave transformation model by mase and kirby 1993 with and without energy dissipation term by wave breaking in particular for planar beaches with bed slope of tan θ the following formulas mase et al 2016 that are fitted for the systematic computational results can be adopted 6 h b h o a 0 a 1 exp ln h o l o a 2 a 3 2 7a a 0 30 2470 27 3440 exp ln 22 9130 tan θ 5 4509 2 7b a 1 9 9467 8 9213 exp ln 29 3880 tan θ 3 1264 2 7c a 2 0 0302 0 0023 exp ln 25 9160 tan θ 1 7065 2 7d a 3 6 1291 3 5001 exp ln 36 3660 tan θ 1 3457 2 these formulas are applicable as an approximation to the curved beaches and bar trough beaches with representative slope tan θ over the nearshore covering the expected surf zone and its seaward portion the breaker depth model shown above is applicable in the range 0 002 h o l o 0 07 and 1 100 tan θ 1 10 the coefficient c in eq 2a was introduced by tamada et al 2015 it is determined by the following equations depending on the seawall slope cot α the condition denoted by cot α 0 corresponds to a vertical seawall 8a c 1 for cot α 2 8b c 0 25 cot α 0 5 for 0 cot α 2 if the gradient of seawall slope is gentler than 1 2 c 1 is assigned the formula on runup and overtopping discharge is then the same as those in mase et al 2013 if the slope of a seawall is steeper than 1 2 e g vertical seawalls or 1 1 gradient seawalls the runup height is computed from the following procedure first r 2 is evaluated by eq 4 as for 1 2 gradient seawalls next the maximum runup r max is computed from eq 3 the overtopping discharge is then evaluated from eq 2 by multiplying the coefficient c that is determined by eqs 8a and 8b based on the actual slope of the seawall in mase et al 2013 and tamada et al 2015 the other two empirical coefficients in eq 2a are set constant as follows 9a γ e 4 000 0 018 9b ω 6 240 the determination of these two coefficients will be re examined and optimized later in the proceeding sections a set of predictive equations together with the empirical coefficients of eqs 9a and 9b is hereafter called as the original iform for the sake of convenience the influence factors related to oblique attack as well as a berm roughness elements on a slope and the presence of a vertical wall on the top of a dike are not treated in mase et al 2013 and tamada et al 2015 and neither considered in the present study 2 2 re evaluation of coefficients in overtopping formula suitable for a broader range of runup conditions in iform the overtopping discharge is estimated from maximum runup the model is constructed based on the concept of hedges and reis model hedges and reis 1998 hereafter referred to as hr model fig 2 that is described as follows 10a q hr γ 1 r hr ω for r max r c 10b q hr 0 for r max r c 11 q hr q g r max 3 r hr r c r max where q hr stands for the normalized overtopping discharge and r hr refers to the ratio of the freeboard of the seawall to the maximum runup level it is noted that the normalization used in hr model in eq 11 and iform in eq 1 is different this is because the normalization with equivalent deep water wave height is more convenient for practical use in iform r max h o 3 2 has thus been introduced in eq 2a to exchange the overtopping discharge based on different definitions of normalization this point will be further discussed in a later section the hr model satisfies the following physical requirements i wave overtopping does not occur when the maximum runup is lower than the freeboard of seawall and ii overtopping discharge remains finite when the freeboard is zero the two coefficients γ and ω in eq 10a correspond to those in eq 2a in iform the γ determines the overtopping discharge when r hr is zero the ω governs the curvature of the curve in fig 2 that controls the relation between q hr and r hr in the original iform the two coefficients γ and ω have been determined through the following procedure based on the experimental datasets for seawalls installed near the shoreline tamada et al 2002 as shown in fig 3 first the non dimensional quantities x and y are defined as 12a x ln 1 r hr 12b y ln q hr the corresponding experimental results are plotted in fig 3 the plots indicate substantial scatter induced by the stochastic nature of wave overtopping this kind of uncertainty may lead to substantial differences in the regression scheme utilized in prediction models in the original iform the focus was placed on the cases where the overtopping discharge is relatively large approximately x 1 in the figure and the regression line was determined so that it could provide a conservative estimate of discharge rate for design assessment purposes the relation between them has then been described by the line given by eq 13 as shown in fig 3 13 y 6 240 x 4 000 it is noted here that the underlying modeling concept in iform is similar to the design approach in eurotop 2018 rather than the mean value approach next γ and ω were determined by eq 9a and by eq 9b respectively as the y intercept and the slope of the regression line described by eq 13 in this way the overtopping formula was established based on a single straight line over the whole area in mase et al 2013 in the area of relatively large x where r hr is low and the overtopping discharge is high fig 3 demonstrates that the adopted regression line passes through the area close to the upper limit of the scattered data and could provide safety prediction for design purposes in contrast the regression line is located far below the measured data in the area surrounded by a red ellipse in the figure this implies that the model prediction tends to substantially underestimate the experimental observations in the range of small x r hr is close to unity in summary the overtopping prediction by the original iform is in good agreement with experimental observations under the conditions of relatively large overtopping discharge while the model tends to underestimate the overtopping discharge under the conditions of relatively small runup close to the threshold of overtopping occurrence this tendency has been observed in the range of approximately q 10 4 in the previous studies mase et al 2013 tamada et al 2015 in this study accordingly an attempt has been made to optimize the prediction formula for overtopping discharge to achieve a high performance of the model prediction for a broader range of r hr the regression formula between the overtopping discharge and the runup is re examined for further adjustment the formulation has been reconstructed as a set of piecewise formulas for three ranges of x or r hr so that it retains the high performance of the original iform in the range of relatively high value of x while the tendency of underestimation in the range of small x is improved selectively 3 method of model performance assessment the performance of the original and refined model is examined by comparison with existing hydraulic experiments and well known prediction models for inclined and vertical seawalls the experimental datasets and existing models employed for comparison the treatment of wave properties at deep water and the method of statistical evaluation are briefly described in the following 3 1 datasets employed for the assessment of model performance 3 1 1 experimental datasets by tamada et al 2002 for inclined seawall first of all the applicability of the original and refined iform is validated by comparison with the measurements by tamada et al 2002 for inclined seawalls note that this dataset has been used as the basis of the development of iform table 1 lists the experimental conditions in the datasets consisting of the extracted data number and the range of main hydraulic and geometric parameters data of zero overtopping discharges were not used in the present analysis the experiments were conducted in a wave flume of 25 m long 0 5 m wide and 0 6 m high for the generation of random waves the bretschneider mitsuyasu spectrum was used the seawalls were installed at relatively shallow water or on land more detailed information can be found in mase et al 2013 3 1 2 experimental datasets by altomare et al 2016 for inclined seawall the applicability of the original and refined iform for inclined seawalls is then further examined through the comparison with experimental results that were conducted independently by other facilities for this purpose the experimental datasets of altomare et al 2016 have been used the experiments were conducted at flanders hydraulics research fhr in belgium the experimental data consists of two datasets ds13 116 and ds13 168 that include 132 cases in total table 2 lists the experimental conditions in the extracted datasets consisting of the dataset name the number of extracted data from each dataset and the range of the main hydraulic and geometric parameters the seawalls were installed at relatively shallow water or on land the details of the experiments at fhr can be found in altomare et al 2017 and chen et al 2015 3 1 3 experimental datasets extracted from clash database for vertical seawall next the applicability of the original and refined iform is validated by comparison with the measurements for vertical seawalls extracted from the clash datasets the data extraction was made for the cases of a plain vertical wall with smooth and impermeable surfaces that satisfy the conditions of h t h o 3 0 and tan θ 0 01 the data with rf reliable factor 4 were considered to be unreliable and excluded from the analysis the comparison was limited to the cases of simple cross sections and the data with cf complexity factor 1 were also excluded data of zero overtopping discharges were not used in the present analysis extraction resulted in 270 cases from 5 datasets table 3 lists the experimental conditions in each dataset consisting of the dataset name the number of extracted data from each dataset the range of the main hydraulic and geometric parameters 3 2 existing overtopping models employed for the assessment of model performance 3 2 1 prediction models for inclined seawall for inclined seawalls additional comparisons are conducted against the formulas by altomare et al 2016 and by goda 2009b among the existing overtopping prediction formulas hereafter these formulas are called the altomare and goda models respectively the altomare model adopted in eurotop 2018 has improved the applicable range of the model of van gent 1999 adopted in eurotop 2007 by incorporating an equivalent i e imaginary slope that uses the wave height at the toe of the structure and r 2 the altomare model has been tuned against the latest eurotop datasets that include the two datasets 13 116 and 13 168 used in this study the goda model has been derived through the analysis of the datasets selected from the clash datasets wave properties at the toe of the structure are used for prediction in these models 3 2 2 prediction models for vertical seawall for vertical seawalls further comparisons were made with the existing overtopping models proposed by eurotop 2018 and by goda 2009b it is noted that the eurotop model is based on the eurotop database including the clash datasets the goda model is also established based on the clash datasets wave properties at the toe of the structure are used for prediction in these models 3 3 treatment of wave properties at deep water specification of the deep water wave period is needed in the evaluation of deep water wavelength in eq 4 in iform the significant wave period t 1 3 o is usually used for this purpose the deep water wave properties are specified as follows in the course of iform prediction 14 h o h 1 3 o t o t 1 3 o l o g 2 π t o 2 in which h 1 3 o and t 1 3 o refers to the significant wave height and period respectively defined at the offshore deep water boundary in the datasets of altomare et al and the extracted clash datasets the information on the deep water wave properties are given as the h m0 o significant wave height computed from the spectrum t p o peak wave period t m o average wave period and t m 1 0 o spectral wave period in eurotop 2018 typical relations are described among the wave properties based on the different definitions as follows 15 t 1 3 1 1 1 25 t m t p 1 1 t m 1 0 and h 1 3 h m 0 goda 2009a suggested slightly different relations 16 t 1 3 t m 1 0 and h 1 3 0 95 h m 0 referring to the description in eurotop 2018 eq 15 the deep water wave properties in iform are calculated as follows in this study for the datasets of altomare et al and clash 17 t o t 1 3 o 1 1 t m 1 0 o a n d h o h 1 3 o h m 0 o it was confirmed that if the significant wave period t 1 3 o is estimated based on t p o or t m o with the relation presented in eq 15 mostly similar results were obtained it is noted that the non dimensional overtopping discharge is evaluated based on the wave characteristics at deep water in iform while it is evaluated based on the wave height at the toe of the structure in the formulas of the altomare goda and eurotop models for consistent comparison when we apply the formulas in these models the dimensional discharge rates are first computed by their formulas and then normalized by using the wave height at deep water as in iform 3 4 indices for statistical assessment of model performance goda 2009b proposed the use of the geometric mean μ gm and the geometric standard deviation σ gm to evaluate the overall performance of the models 18 μ gm exp 1 n i 1 n ln r i here r i is the ratio of predicted overtopping discharge to measured one hereafter called as the ratio of overtopping prediction 19 r i q pred i q meas i in which the subscripts pred and meas represent the results obtained from model prediction and experimental measurement respectively the scatter of data is evaluated with the geometric standard deviation σ gm defined below 20 σ gm exp 1 n i 1 n ln r i 2 ln μ gm 2 0 5 in the mean value approach the prediction model is usually calibrated so that μ gm approaches unity at the same time however 50 of prediction is considered to be below the measurement when μ gm 1 for design purposes accordingly a parameter setting reproducing μ gm 1 is not necessarily the best choice additional indices should be taken into account to assess the model performance for this purpose the five percent non exceedance and exceedance values or equivalently the 90 confidence interval is often used if the overtopping prediction ratio r i is assumed to follow the log normal distribution 90 of the predicted ratio is to be located in the range between the five percent non exceedance and exceedance values r l 5 and r u 5 respectively 21 r l 5 μ gm 1 64 σ gm r u 5 μ gm 1 64 σ gm these indices are also used in the assessment of the prediction performance when appropriate the assumption of log normal distribution is adopted also in many of the recent overtopping studies e g goda 2009b eurotop 2018 liu et al 2020 the validity of this assumption is examined later in altomare et al 2016 and eurotop 2018 the overtopping formula has been presented based on mean value approach and design or assessment approach the mean value approach estimates the mean value of the stochastic overtopping data the design approach incorporates some safety factor and can be used straightforwardly in the design procedures of coastal structures since the formulation of iform is close to the design approach the comparison with eurotop prediction is mainly made for the design approach it is noted that the goda model is considered to be categorized as the mean value approach 4 refinement of integrated runup overtopping model to obtain overtopping formulas that are applicable to a wide range of overtopping conditions the model equations are empirically re established as a set of piecewise formulas for the following three ranges of x zone i 0 5 x zone ii 1 4 x 0 5 zone iii x 1 4 the zoning above was determined empirically through try and error basis conditions x 1 4 and 0 5 correspond to r max r c 1 33 and 2 54 respectively fig 4 indicates that due to the scattering of observed data the magnitude of overtopping discharge corresponding to y substantially varies for the same value of normalized runup corresponding to x for design purposes accordingly the regression formulas were determined so that the line curve passes close to the upper limit of the scattered data this kind of conservative determination of regression formulas implies that the prediction scheme adopted in the refined iform has some safety factor and the overall model predictions are expected to be larger than the mean of the scattered measurement data zone i corresponds to the case where the crest freeboard is relatively low in other words runup height is sufficiently high and the resulting overtopping discharge becomes large in this zone it has been verified that the original iform provides satisfactory predictions of overtopping discharge mase et al 2013 tamada et al 2015 and therefore the same form is retained in this zone 22 y 6 24 x 4 00 0 5 x as was mentioned before the parameters γ and ω in eq 2 are determined from the slope and intercept of the regression line as 23a γ e 4 000 0 018 0 5 x 23b ω 6 240 0 5 x the overtopping formula in zone iii was constructed as follows in this zone the variation of y was quite gentle compared with other zones since the slope of the regression equation appears as a power index in eq 2a it may have a significant influence on the estimation of overtopping discharge when the maximum runup height is close to overtopping threshold i e 1 r c r max is small in the original iform the use of eq 13 in this area resulted in the underestimation of overtopping discharge in this study accordingly the slope of the regression line in zone iii was set as unity because of the following two reasons first it represents the variation of y in zone iii quite well and second it is the minimum limit for the curve in the hr model in fig 2 to be convex downward the regression line was then set as shown below 24 y x 8 98 x 1 4 the value of the intercept was determined empirically by trial and error approach based on the slope and intercept of the regression line given by eq 24 the two parameters γ and ω are determined as 25a γ e 8 98 0 00013 x 1 4 25b ω 1 000 x 1 4 finally the parabolic curve given by eq 26 was adopted in the central zone zone ii the form of this curve was determined so that it can provide a smooth transition between the lines given by eqs 22 and 24 at both ends of the zone ii 26 y 2 91 x 2 9 15 x 3 27 1 4 x 0 5 in this zone the values of γ and ω are determined from the slope b and the y intercept d of the tangential line to the parabolic curve the values of b and d are not constant but vary with x as 27a b x 5 82 x 9 15 27b d x 3 27 2 91 x 2 the values of γ and ω are then determined as functions of x as follows 28a γ e d x e 3 27 2 91 x 2 1 4 x 0 5 28b ω b x 5 82 x 9 15 1 4 x 0 5 in the course of the reconstruction of model equations several other forms were tested the form presented here has been adopted from the overall viewpoints of the consistency with the original iform brevity of expressions and overall prediction performance hereafter the iform with the use of eqs 23 25 and 28 is called as the refined iform 5 results of model performance assessment 5 1 comparison with the experiments by tamada et al 2002 for inclined seawall the predictions of overtopping discharge by the original iform and refined iform are compared with experimental observations by tamada et al 2002 in a dimensionless form in fig 5 the data are classified into three groups according to the slope of the seabed in the figures three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red overall the prediction by the original iform provides good agreement with the experiment in fig 5 a the predicted values are mostly located slightly above the measurements because a conservative determination was conducted for the coefficients during the formulation of iform in the range where the normalized overtopping discharge is smaller than approximately 10 4 however the original iform tends to underestimate the overtopping discharge as mentioned before in several cases the underestimation of the overtopping discharge reached up to one or two orders of magnitude in contrast the accuracy of prediction in this zone is significantly improved in the refined iform in fig 5 b except for an outlier all of the results are located in the range larger than 10 1 times of the measurements in the area where the normalized overtopping discharge is larger on the other hand the refined iform provides the same estimations as to the original iform it is noted that the prediction based on the refined iform provided a conservative estimate in the figure namely the predicted values are close to or larger than measured values this is because eqs 22 24 and 26 are determined so that they are located close to the upper limit of the scattered data the characteristics of scattering in the plot are similar for different seabed slope the ratio of overtopping prediction is then plotted against the freeboard normalized by the maximum runup in fig 6 a 90 confidence interval is shown in the figure by dashed lines in blue and 50 exceedance level is indicated by the dash dot line in red since the original iform tends to underestimate the overtopping discharge in the range corresponding to zone iii the ratio of overtopping prediction obtained by the original iform exhibits a downward shift toward the right these are significantly improved in the refined iform thus it is confirmed that the prediction by the refined iform was selectively improved in zones ii and iii the new formulas successfully provide the conservative estimate of overtopping discharge for design purposes and indicate no shift over the whole range both of the geometric mean μ gm and geometric standard deviation σ gm for the refined iform has been satisfactorily improved compared with the original one table 4 the use of the refined iform resulted in the μ gm for overall data of 2 92 and the corresponding σ gm is 3 34 if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the predicted data is to be located in the range between approximately 0 5 and 16 times the measured values fig 7 indicates the relation between the non dimensional overtopping discharge and non dimensional maximum runup height in the refined iform the data are classified into five groups according to the ratio of the freeboard to deep water wave height the markers indicate the experimental results by tamada et al 2002 the curves in the figure are obtained by the refined iform the curves represent the general trend of the measurement well compared with the original iform e g fig 21 in mase et al 2013 the curves are modified so that they envelop the measured results over the whole range of runup especially where the non dimensional discharge is small 5 2 comparison with the experiments by altomare et al 2016 for inclined seawall next the original and refined iform were applied to the test conditions of the experiments by altomare et al 2016 listed in table 2 the prediction of overtopping discharge by the original iform is compared with observations in a dimensionless form in fig 8 a the data are classified into two groups according to datasets in the figure three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red qualitatively the original iform reproduces the overall variation of overtopping discharge and most of the predictions lie between the lines that indicate the prediction is 0 1 times and 10 times the measured values however it tends to underestimate the experimental observation this tendency is more apparent for small values of overtopping discharge for several cases in ds 13 168 in particular the original iform underestimates the overtopping discharge up to one to three orders of magnitude comparisons between the refined iform predictions and measurements are demonstrated in fig 8 b besides the ratio of overtopping prediction is plotted against the experimental non dimensional discharge in fig 9 a 90 confidence interval is shown in the figures by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red compared with the predictions by the original iform the prediction accuracy is significantly improved by the refined iform from the figures it is clear that the tendency of underestimation is improved in the area of small overtopping the prediction for the cases of outliers in fig 8 a are significantly improved in fig 8 b the width of the 90 confidence interval is substantially reduced and the estimations by the refined iform are concentrated closer to the line indicating that prediction and measurement are equal except for a few cases the ratio of overtopping prediction is plotted against measured overtopping discharge in fig 9 the overall reproducibility is satisfactory from a detailed inspection of the figure a decreasing trend is captured for ds13 116 while an increasing trend is recognized for ds13 168 a similar tendency is observed in the prediction by the altomare model described later in fig 11 both of the geometric mean μ gm and geometric standard deviation σ gm for the refined iform have been satisfactorily improved compared with the original iform table 5 the use of the refined iform resulted in the μ gm for overall data of 0 77 and the corresponding σ gm is 2 24 if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the predicted data is to be located in the range between 0 21 and 2 81 times the measured values the corresponding values for the original iform are 0 33 and 15 64 for μ gm and σ gm respectively the μ gm and σ gm values for each of the datasets are also listed in table 5 it is found that the prediction performance of the refined iform has been improved for each of the datasets a comparison of the results against the two datasets indicated that the μ gm becomes smaller while σ gm became larger in ds 168 this is commonly seen in both of the original and refined iform it is noted that although the iform has been modeled to provide a conservative prediction for design purposes the estimation by the refined iform still slightly underestimates the measurements the geometric mean is slightly smaller than unity here this point will be discussed in a later section the comparison between the prediction by existing models and the measurements are shown in fig 10 in the figures three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values the ratio of overtopping prediction is plotted against the experimental non dimensional discharge in fig 11 a 90 confidence interval is shown in the figures by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red the altomare model provided quite satisfactory predictions this is reasonable since the model has been tuned to the conditions including the datasets used in the present study most of the cases are located between 1 and 10 times the measured values the values of μ gm and σ gm for the overall cases are 2 57 and 1 74 respectively as shown in table 5 if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the predicted data is to be located in the range between 0 90 and 7 33 times the measured values it is noted that in this figure the model prediction by the altomare model is based on the coefficients proposed for the design approach if the coefficients in the mean value approach are used the plot will be more concentrated along the line indicating that prediction and measurement are equal for the mean value approach the corresponding μ gm and σ gm are 1 32 and 1 74 respectively in contrast the goda model indicates significant scattering and drastic overestimation up to the order of 102 for substantial numbers of cases the values of μ gm and σ gm for the overall cases are 14 25 and 7 32 respectively as shown in table 5 the μ gm and σ gm values became large for ds11 116 examination of figs 8 11 and table 5 demonstrates that the quantitative reproducibility of the refined iform is close to that of the altomare model the overall performance is sufficiently high compared with the goda model taking into account that the iform is developed independently without tuning to these datasets the overall model performance is considered to be satisfactory 5 3 comparison with the extracted clash datasets for vertical seawall finally the original and refined iform are applied to the test conditions of the extracted clash dataset for plain vertical seawall listed in table 3 the prediction of overtopping discharge by the original and refined iform are compared with the experimental observations in the dimensionless form in fig 12 the data are classified into five groups according to the dataset in the figures three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a 50 exceedance level is indicated by the dash dot line in red the original iform in fig 12 a qualitatively reproduces the overall variation of overtopping discharge and most of the predictions lie between the lines that indicate the prediction is 0 1 times and 10 times the measured values however for several cases located around q meas 10 4 the original iform underestimates the overtopping discharge up to one to three orders of magnitude in fig 12 b the predictions by the refined iform are improved in particular the improvement in prediction for the cases of outliers in fig 12 a is significant the predictions by the refined iform are more closely concentrated slightly above the line indicating that prediction and measurement are equal the ratio of overtopping prediction is plotted against the experimental non dimensional discharge in fig 13 a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data is estimated to fall below the interval and 5 above and the corresponding 50 exceedance level is indicated by the dash dot line in red in the figure the ratio of predicted to measured discharge is located above unity for most of the cases the μ gm and σ gm are listed in table 6 both of the geometric mean and standard deviation for the refined iform seems satisfactory the use of the refined iform resulted in the μ gm for overall data of 1 95 and the corresponding σ gm is 2 57 comparison with the original iform reveals that the scattering is improved σ gm varies from 3 93 by the original iform to 2 57 by the refined iform the μ gm value by the refined iform is more conservative than that by the original iform if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the data predicted by the refined iform is to be located in the range between 0 46 and 8 22 times the measured values some of the predictions corresponding to the cases of 1 50 slope ds 224 and ds502 resulted in slight underestimation μ gm 1 this will be addressed later the comparison between the prediction by existing models and extracted clash datasets are shown in figs 14 and 15 in the figures three diagonal solid lines indicate the conditions that the prediction is 0 1 times equal to and 10 times the measured values a 90 confidence interval is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red it is noted that eurotop 2018 model has been tuned for the eurotop2018 database including the clash dataset also the goda model has been tuned for the clash dataset including the five sub datasets in table 3 eurotop2018 model provides mostly satisfactory predictions the values of μ gm and σ gm for the overall cases are 1 71 and 1 94 respectively table 6 it is noted that in this figure the model prediction by eurotop2018 model is based on the coefficients proposed for the design approach if the coefficients in the mean value approach are used the plot will be more concentrated along the line indicating that prediction and measurement are equal for the mean value approach the corresponding μ gm and σ gm are 1 19 1 93 respectively the goda model indicates satisfactory prediction except for a couple of cases in total the goda model slightly underestimates the measurements the values of μ gm and σ gm for the overall cases are 0 79 and 2 24 respectively in fig 15 the ratios of overtopping predictions are plotted the figures show that when q meas 10 4 both models indicate a common tendency of slight overestimation it is noted again that the iform is developed without tuning to the clash datasets nevertheless the overall comparisons of figs 12 15 and table 6 clarify that the performance of the refined iform seems to be as good as the models developed based on the clash datasets the refined iform can be applied in a wide range of conditions for vertical walls 5 4 overall examination of model performance and underlying assumption the overall model performance is briefly summarized here the geometric mean of the ratio of overtopping predictions against all of the datasets used in this study is μ gm all 1 74 accordingly the predictions based on the refined iform generally provide conservative estimations the corresponding standard deviation is σ gm all 3 03 if the ratio of overtopping prediction is assumed to follow the log normal distribution 90 of the data predicted by the refined iform is to be located in the range between 0 35 and 8 64 times the measured values to examine the validity of the assumption of log normal distribution of r i the cumulative relative frequency of ln r i is plotted in fig 16 the horizontal axis is normalized with its mean and standard deviation the dashed lines in red represent the levels where 5 50 and 95 of the data are located below in the actual prediction results the corresponding plot for the theoretical standard normal distribution mean 0 and standard deviation 1 is also plotted for reference the dashed lines in blue represent the levels where 5 50 and 95 of the data are located below in the theory the overall agreements between the two curves are generally good and the correspondence of the 90 confidence intervals looks reasonable these results thus validate the assumption of log normal assumption of the ratio of overtopping prediction moreover the ratio of overtopping prediction for all of the datasets is plotted against the representative non dimensional parameters in fig 17 a c a 90 confidence interval under the assumption of log normal distribution of r i is shown in the figure by dashed lines in blue where 5 of the data are estimated to fall below the interval and 5 above a corresponding 50 exceedance level is indicated by the dash dot line in red fig 17 a indicates that the scatter of the prediction ratio increases as the overtopping discharge becomes small this is related to the difficulty in the accurate measurements of small overtopping volume a small error in measurements or also in predictions results in a large scatter similar features are observed for the prediction by other representative models in the present study fig 15 and other studies e g figs 5 13 17 and 18 in goda 2009b the prediction for the small overtopping discharge also has a tendency to be located above the overall mean this tendency is common to the results by eurotop and goda models in fig 15 fig 17 b and c demonstrate that the ratio of overtopping prediction has no bias against the relative freeboard and wave steepness as was mentioned before the plots below the 5 level in fig 17 c mainly belong to the cases of 1 50 slope this will be discussed in the proceeding section 6 discussion 6 1 scaling of overtopping discharge recently ibrahim and baldock 2020 hereafter referred to as ib2020 demonstrated that the overtopping volume can be properly expressed in terms of deficit in freeboard defined as follows 29 δ r max r c r max 1 r hr 1 r c r max more recently altomare et al 2020 further discussed the ib2020 s scaling laws they made a novel attempt to find a generalized model for mean wave overtopping discharge assessment of smooth and impermeable sea dikes differently from other approaches an innovative genetic algorithm called evolutionary polynomial regression epr has been employed epr assisted the identification of the main explanatory variables governing the overtopping their results clarified that 1 the deficit in freeboard is a key explanatory variable for the wave overtopping assessment and 2 the use of this parameter can reduce the scatter of experimental data furthermore epr proved that concepts such as imaginary slope or equivalent slope provide an accurate estimate of the processes that occur on the foreshore and dike and lead to wave transformation and breaking finally affecting the overtopping phenomenon the two coefficients γ and ω in the refined iform are functions of deficit in freeboard because they are expressed in terms of x ln δ hedges and reis 1998 mentioned that the γ and ω parameters in the hr model may be influenced by the seaward profile of the structure the expression adopted in the refined iform is more specific at this point with the use of the deficit in freeboard eq 2a can be rewritten as 30 q q g h 0 3 c r max h o 3 2 γ δ 1 r c r max ω δ r max h o 3 2 c γ δ δ ω δ the quantities in the square bracket are expressed as a function of δ namely the overtopping discharge in the refined iform is modeled in a form that is directly related to the deficit in freeboard furthermore if we adopt an alternative form of normalization hr type form as in eq 11 eq 30 is rearranged as 31 q hr q g r max 3 c γ δ δ ω δ if we consider gently sloped seawalls the coefficient c 1 as in eq 8a then in the prediction by the refined iform the deficit in freeboard becomes the only governing parameter for the mean overtopping discharge normalized with the maximum runup more in general the similar consideration holds for the hr type model the successful application of the refined iform in the present study for a wide range of installation condition suggests that in the initial modeling process it is considered to be effective to scale the overtopping discharge with the runup height in which the influence of not only the wave height but also the wave period wavelength and others are incorporated the consideration above is expected to hold for seawalls with steep slopes for cases corresponding to eq 8b c 1 if the formulation given by eq 31 is valid for a wide range of conditions further considerations are possible as shown in the following as previously mentioned the normalization by h o is more preferable in practical situations to adopt this form the exchange between the different definitions of normalization becomes necessary as a result eq 30 indicates that the discharge normalized by h o is governed not only by δ but also by r max h o appearing as an exchange ratio between different types of normalization namely there appear two principal non dimensional parameters with these parameters eq 30 is composed of the products of the following two components the first component c1 in front of the square brackets expresses to what extent the runup is amplified in relation to the incident wave height the latter component c2 in the square brackets regulates the overtopping volume q hr for the given value of δ note that the estimation of r max is related to both of the processes accordingly the two fundamental processes in the development of an overtopping model are recognized as 1 to establish an accurate runup model and 2 to formulate the relation between the runup and overtopping discharge in terms of the deficit in freeboard and the overtopping discharge scaled with the runup height if each component is modeled properly the prediction formula for overtopping discharge can then be obtained straightforwardly by the combination of them in principle as in iform or hr type models in the modeling of overtopping discharge the following type of formulation has often been used e g goda 2009b eurotop 2007 32 q g h m 0 3 a exp b r c h m 0 based on the analogy with the form in eq 30 it is deduced that the exponential term may correspond to the modeling of c2 and the coefficient a may represent the modeling of c1 the considerations above provide a new insight into the scaling and the modeling strategy of overtopping discharge moreover ib2020 introduced the volume of overtopping per wave as 33 v q t o if we introduce the run up scaling proposed by hunt 1959 according to ib2020 34 r max h o l o tan β ξ h o in which ξ is the surf similarity parameter 35 ξ tan β h o l o it can be shown that the overtopping volume per wave is scaled for the refined iform as 36 v 2 π h o l o tan β ξ c γ δ δ ω δ the above form which is derived from the refined iform or more generally from the hr model is consistent with the expression proposed by ib2020 eqs 24 and 25 in their paper the differences are that eq 36 explicitly include the surf similarity parameter and that the expression for the δ related part is more generalized the form above may be useful as an alternative candidate for the scaling of the volume of overtopping per wave a brief discussion is given here on the power of tan β in the scaling of eq 36 in the scaling based on the refined iform the power of the imaginary slope tan β becomes 3 2 in eq 36 because ξ includes tan β 1 2 on the other hand the power of beach slope is set as 1 or 1 2 in ib2020 see eqs 24 and 25 in ib2020 and 1 2 in eurotop see eq 11 in ib2020 this is considered to be related to the difference in the definition of wave height namely the representative wave height h represents h 1 3 o at deep water in iform while h m0 1 toe after breaking in ib2020 and eurotop the h m0 1 toe is influenced by the bottom slope through wave breaking it is then logical to expect that the power of the beach slope takes different values for different definitions of representative wave height the power should be discussed with the selection of the representative wave properties in the scaling formula moreover the definition of beach slope itself is different depending on the model and the influence of beach slope is also included in the estimation of the imaginary slope and deficit in freeboard although the modeling strategy and selection of proper scaling of overtopping prediction deserves further investigation it is beyond the scope of the present paper more detailed examination on these issues are underway 6 2 uncertainty included in the model prediction since the refined iform has been modeled to provide a conservative prediction for design purposes the model is expected to provide the value of geometric mean larger than unity this is attained for most of the conditions in this study nevertheless it is noted here that for certain datasets the estimations by the refined iform still slightly underestimated the measurements the geometric mean was slightly smaller than unity the underestimation was observed for the experiments of altomare with 1 35 ds13 116 and 1 50 ds13 168 slope seabed and the cases of 1 50 slope condition ds 224 and ds 502 in the clash datasets in the procedure to formulate iform the uncertainty of model prediction may arise in the two processes mentioned in the previous section a the estimation of overtopping based on predicted runup or deficit in freeboard and b the prediction of runup level from the specified wave and installation condition note that the influence of the uncertainty in runup estimation appears in both of them the present study focuses on the former one corresponding to the part in the square brackets in eq 30 and the relation between the predicted runup and overtopping discharge is properly described for a wide range of conditions in the refined iform accordingly the underestimation observed here may be resulted from the latter one namely the underestimation of maximum wave runup the runup formula used in iform is based on the experiments conducted for 1 10 to 1 30 slope of the seabed by mase et al 2004 and by mase et al 2013 over the conditions covered in these experiments the runup formula eq 4 has been validated to be sufficiently accurate as shown in fig 10 in mase et al 2013 since the tendency of underestimation in overtopping discharge is observed for the mildly sloping bed with slope 1 30 out of the conditions of mase et al 2004 and mase et al 2013 additional confirmations may be needed preliminary examinations indicated that the runup prediction based on eq 4 is lower than the prediction based on the method by altomare et al 2016 for ds 168 besides the general features of the influence of smaller prediction in runup height on overtopping discharge can be inferred from fig 7 the sensitivity of the overtopping prediction to the estimation of runup as well as imaginary slope and breaking depth deserves further investigation but it is beyond the scope of this paper these aspects will be treated in the future study 7 summary remarks this study attempted to optimize the integrated formula of overtopping and runup modeling iform for mean overtopping discharge to achieve a high performance assessment for a broader range of overtopping conditions for this purpose the regression formula between the overtopping discharge and the runup in iform was re examined and re evaluated the formulation has been reconstructed with a set of piecewise formulas for three ranges of the runup level relative to the freeboard the refined formulas retain the high performance of the original iform in the range where the freeboard of the seawall is relatively low while they improve the tendency of underestimation selectively in the range of relatively high freeboard conditions close to the threshold of overtopping occurrence the prediction capability of the refined iform for overtopping discharge was validated by comparison with various existing hydraulic experiments for gently sloped seawalls installed at shallow depth or on land the model predictions were compared with the experiment by tamada et al 2002 the results indicated that the refined iform is able to well reproduce the experimental observations over a broader range of overtopping conditions and that it enhances the quantitative accuracy of the prediction the model predictions were further compared with the experiments that were conducted independently from the establishment of iform for inclined seawall installed at shallow water depth the model prediction was compared with the measurement by altomare et al 2016 the model performance of the refined iform was shown to be comparable as that of the altomare model eurotop2018 model that is tuned for the particular experiment the prediction accuracy of the refined iform was superior to the goda formula for plain vertical seawalls the model predictions were compared with the data extracted from the original clash datasets the results well demonstrated the enhanced applicability of the refined iform the model capability was shown to be as good as those of the existing representative models such as those proposed by eurotop 2018 and goda 2009b finally an alternative form of the scaling of the overtopping discharge was provided and discussion has been made on a novel strategy to develop an overtopping model credit authorship contribution statement masatoshi yuhi conceptualization methodology investigation formal analysis writing original draft hajime mase conceptualization supervision writing review editing funding acquisition sooyoul kim writing review editing funding acquisition shinya umeda investigation writing review editing corrado altomare investigation writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is partially supported by the grants in aid for scientific research by the japan society for the promotion of science grant no 19h02403 and 20k05046 and the collaborative research program of the disaster prevention research institute of kyoto university grant no 30g 09 dr c altomare acknowledges funding from the european union s horizon 2020 research and innovation programme under the marie sklodowska curie grant agreement no 792370 suggestive comments from prof hiraishi kyoto university dr kawasaki and dr mizutani hydro technology institute co ltd are most appreciated assistance rendered by mr ohtani a former student of kanazawa university and ms ichimura graduate student of kanazawa university is acknowledged constructive comments and suggestions from the anonymous reviewers are appreciated 
