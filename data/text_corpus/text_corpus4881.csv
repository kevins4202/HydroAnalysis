index,text
24405,for the purpose of studying the spreading regularity of metal pollution accident and resolving problem of parameters being difficult to obtain in the drinking water source interval transient pollution distribution model was developed and applied to the fenghuangshan drinking water source three gorges reservoir after parameter calibration and model validation the mean absolute deviation between the calculated value data obtained by the model simulation and the measured value the real measured data of the zigui drinking water source area was less than 7 thence the promoted model can be used in practical accident pollution relying on matlab 2014a this research presented the cadmium pollution spreading pattern in the drinking water source based on the proposed model under the premise of different hydrological periods and different initial pollutant quality this study focused on forecasting and analyzing the spatial distribution of pollution accident within one hour concentration diffusion of pollution source change with time and concentration diffusion in the drinking water source with time the results showed that the variation of cadmium concentration was influenced by the distance between the accidental emission source and shore specifically the distance increases and the appearance of the second pollution peak is subsequently delayed moreover the dilution rate of pollutant was directly proportional to water depth and flow velocity and the flow velocity has more important influence on the diffusion of pollutants than others do the purpose of this study is to develop an effective model to forecast and solve the metal pollution accident in drinking water sources under the condition of incomplete or uncertain parameters in order to solve the problem of difficult hydrological data acquisition the results provide some new insights and references for researchers and decision makers to predict and respond to emergency accident pollution in drinking water sources graphical abstract image graphical abstract keywords drinking water source cadmium pollution flow velocity interval distribution model 1 introduction safe drinking water plays a major role in human health and survival social stability and economic development sustainability dippong et al 2020 lópez roldán et al 2016 wang et al 2016 in the past years chemical accidents have caused serious pollution and threats to natural water bodies in 2005 about 100 tons of benzene flowed into the songhua river and formed an 80 kilometer long pollution belt which severely affected local economy and residents lives jiang et al 2012 in 2007 hebei spirit accident spilt 12 547 tons of chemicals directly into the coastal area of taean in western south korea causing serious pollution to the local water body chung and lee 2016 in 2012 the cadmium pollution incident in longjiang river seriously threatened the drinking water safety of residents along the river and downstream zhao et al 2018 in addition the toxic wastewater pollution of the animas river in the united states in 2015 and the saga oil spill accident in japan in 2019 had caused serious impacts on local water quality safety duval et al 2020 misuri et al 2021 statistics on 85 accidents with pollution duration records found that 28 2 pollution lasting less than 12 h 21 2 between 12 and 24 h 14 16 5 between 24 and 48 h and 15 3 between 48 and 96 h while 18 8 cases involved pollution lasting for more than 96 h yao et al 2016 apparently water pollution accidents would seriously threaten the safety of water quality it is important to examine contaminant masses in water and identify the distribution patterns of contaminants chen et al 2015 roșca et al 2020 particularly the drinking water area of lakes and reservoirs which account for more than 40 of urban centralized drinking water sources in china are important freshwater source qu et al 2016 the three gorges reservoir tgr controls 1084 km2 of drainage area upstream and the water level of tgr is between 145 m and 175 m above the sea level xiang et al 2018 13 cities 140 towns and over 1300 villages have been submerged since the impoundment floehr et al 2015 although there have been no major water pollution accidents in the tgr historically ship traffic accidents have occurred frequently xu et al 2021 in 2009 the accident of container falling into shipai water area of the tgr near the three gorges dam tgd caused more than 200 tons of dangerous chemicals spilled directly into the yangtze river in 2012 more than 40 tons of phenol fell into the zhenjiang section of yangtze river due to a korean ship spilled polluting drinking water in many places meanwhile chemical companies built on the sides of the reservoir upstream have increased the risk of water pollution accidents and toxic chemicals contamination caused by marine accidents would arise occasionally wang et al 2018 besides with the annual navigable volume of the tgr exceeding 100 million tons the pressure on the prevention and control of accidental pollution in drinking water sources of the tgr has further increased for dense populations who use surface water from the tgr as drinking water water pollution accidents would affect their lives largely thereby influencing not only the social stability but also the economic development ma et al 2020 the chinese government has developed relevant comprehensive standards such as the environmental quality standards for surface water gb3838 2002 and has repeatedly carried out works to ensure the safety of drinking water wang et al studied the spatial distribution of metal pollution in the yangtze river estuary and found that different areas were polluted to different degrees wang et al 2014 zhang et al assessed and analyzed the metal pollution of the bortala river and found that the pollution of pb cd and hg were serious zhang et al 2016 li et al developed a model based on support vector machine to predict metal concentrations of chaohu lake li et al 2021 karaouzas et al investigated metal contamination status of surface water in greek and calculated the water quality karaouzas et al 2021 usman et al quantified the metal pollution in the indus river watershed usman et al 2021 paul et al compared metal pollution of aquatic bodies in southern usa to evaluate the characteristics of distribution paul et al 2021 in all literatures about metal water pollution mainly focused on the evaluation and analysis was carried out at large scale levels such as watershed and long time zhou et al 2020 conversely there were few researches on metal water pollution accidents as for the single metal pollution accident researches in drinking water sources were rarely reported thence the requirements have been increased significantly to study the metal pollution accident and to analyze the influencing factors in drinking water sources in the past decades a series of spreading models and simulation methods have been developed to study water pollution problems reed et al 1999 chao et al developed and applied a two and three dimensional water models according to mass transport equation and solved the problem of the pollution particles concentration distribution chao et al 2001 based on the integration of geographic information system gis technology rui et al developed an emergency response system for water pollution accidents in the xiangjia dam area of china which could be a reference for analyzing water pollution rui et al 2015 rekadwad and khobragade investigated the origin of pollution spills and highlighted the pollution adverse effects not only on the economy but also on the ecosystem rekadwad and khobragade 2015 in the oslo fjord a 3d fluid dynamics integrated model developed by eregno et al was used to assess the escherichia coli spreading eregno et al 2018 masocha et al presented a first order decay equation to predict pollutant concentrations in some rivers of zimbabwe masocha et al 2019 to predict and simulate a sudden pollution event in a lake wu et al optimized the variable fidelity surrogate dream model and the results showed that the established model improved simulation calculation speed about 200 times wu et al 2020 kumar et al developed a multidisciplinary method to characterize the pollution level in water resources and revealed the contamination situation along the toko dam kumar et al 2021 however the above literature mostly focused on effects on the economy or ecosystem fokina et al 2014 gonnelli et al 2016 there are few studies discussing emergency pollution distribution in water drinking sources furthermore most parameters in model need to be accurately obtained in advance and its application has certain restrictions in cases of incomplete parameter data for the uncertain parameters nataraj and sardar proposed a template generation algorithm based on interval mathematics nataraj and sardar 2000 yang et al overcame the problem of insufficient parameters by using interval analysis algorithm yang et al 2018 leng and zhang employed a new iterative algorithm to obtain the maximum eigenvalue of a real interval matrix leng and zhang 2013 to calculate the interval results dong et al developed a method combining interval algorithm and perturbation method dong et al 2021 thence this study introduced the method of the interval analysis algorithm and then obtained an interval containing accurate results in the case of uncertainty parameters therefore the objective of this study was to develop a new model and applied it to the metal pollution accident in the fenghuangshan drinking water source of zigui county china in this study area hydrological conditions of the drinking water source are influenced by the regulation of tgd in zigui county chemical production and transportation of minerals and electronics are important industries thus heavy metals and their compounds have become the potential pollutants in local drinking water source cadmium one of metal pollutants was took as the water quality index for the prediction and analysis of pollution accidents in this research according to the existing operation scheduling plan of the tgd the hydrological period of the study area in the tgr is divided into four the low water period the flood period the water storage period and the falling period bao et al 2014 the proposed model operation and prediction results analysis were realized through matlab 2014a due to its powerful data and image processing capabilities gdeisat and lilley 2012 giuliani et al 2016 to solve the problem of uncertain parameter or incomplete data interval variables are used to describe the uncertain parameters and the uncertain parameters are converted into deterministic interval parameters thus the interval mapping relationship between parameters and prediction results was established an interval instantaneous pollution distribution model was developed to simulate and predict the instantaneous diffusion of cadmium pollution with time the measured values were used to calibrate the empirical constant and the mean absolute deviation was found to be less than 7 after model verification the basic structure of this paper is as follows in section2 based on the transient point source pollution distribution model and interval analysis algorithm the new model was developed after parameter calibration and model validation the results showed that the promoted model could be used in predicting pollution distribution of practical in drinking water sources in section 3 the information of the study area and model application was introduced an accident pollution forecasting was carried out by using the developed model in the fenghuangshan drinking water source in section 4 this study mainly discussed the results that spatial distribution of pollution accident within one hour concentration diffusion of pollution source change with time and concentration diffusion in the drinking water source with time in section 5 conclusions innovations and outlook were sorted out and summarized combining the two dimensional pollution distribution model with the interval algorithm this study provided a new useful model with practicability to predict the pollutants diffusion on the condition that data or parameters were incomplete or uncertainty the developed model was applied to fenghuangshan drinking water source and the results provided practical reference and technical support for decision makers to formulate emergency plan of water pollution accidents especially heavy metal pollution in the tgr 2 methodology 2 1 transient point source pollution distribution model pollutants which can be dissolved with an aqueous medium after discharging into the river have similar hydrodynamic properties with the water body the distribution pattern of pollutants was assumed only to have the contaminant concentration gradient in the x direction when the river water moved in a large time scale which can be formulated using eq 1 liu 2011 1 d x 2 c x 2 u x c x k c 0 where c is the target concentration of pollutants in water mg l dx is the diffusion coefficient in the x direction ux is the velocity of flow in the x direction transverse velocity m s and k is the attenuation coefficient of pollutant 1 s representing the pollutant degradation rate under the influence of physical chemical and biological factors eq 1 can reflect the diffusion and migration in a situation where the water body is in a steady state however the pollution sources belong to unsteady discharge patterns in sudden pollution incidents considering the influence of time equation 2 was obtained 2a d x 2 c x 2 u x c x k c c t 2b d y 2 c y 2 u y c y k c c t where dy is the diffusion coefficient in the y direction uy is the velocity of flow in the y direction longitudinal velocity m s and t represents the time of contamination s integrating eqs 2a and 2b the two dimensional pollution distribution model was obtained 3 c t d x 2 c x 2 d y 2 c y 2 u x c x u y c y k c considering the impacts of boundary on the spread of pollutants and background concentration fig 1 the laplace transform and inverse transform were used on eq 3 in addition for the sake of simplicity the unit conversion between masses was directly reflected in the formula in this study the background concentration value of drinking water sources was much lower than the contaminant concentration value of accident thence the background concentration of the water source area was taken as the reference value and regardless of its own degradation and diffusion process thus a transient point source pollution distribution model was obtained 4a c x y t c 0 m 4 π h t d x d y exp k t exp x u x t 2 4 d x t y u y t 2 4 d y t exp x u x t 2 4 d x t 2 b y u y t 2 4 d y t meanwhile the calculation of dx or dy was based on empirical formulas baussant et al 2011 4b d x 5 93 h g h i 4c d y α h g h i where c0 is the background concentration of concentration in water mg l b is the distance between the accident emission sources and shore m g is the gravitational acceleration constant m s2 i is the river slope coefficient m is the contaminant mass tons h is the water depth m α is the empirical constant 2 2 interval transient pollution distribution model analyzing equation 4 factors that have an impact on the distribution of pollutant concentration changes were ux uy h and m while time settled actually the data of ux and uy were not easy to obtain precisely under normal circumstances to tackle these issues the interval analysis algorithm was introduced in this study an interval number could be defined as follows huang et al 1995 5 x x x t x x t x to resolve the matter of measurement uncertainty that some parameters such as h ux and uy were unknown interval variables were used to describe uncertain parameters chen et al 2007 thus the uncertain parameters were transformed into deterministic interval parameters based on the certainty of upper and lower bounds of the model the interval mapping relationship between parameters and prediction results were established the model code and its calculation were realized by matlab 2014a the interval transient pollution distribution model was formulated as follows 6a min c x y t c 0 m 4 π h k t d x d y exp k t exp x u x t 2 4 d x t y u y t 2 4 d y t exp x u x t 2 4 d x t 2 b y u y t 2 4 d y t subject to 6b max c c s 6c u x 0 u x u x u x r 6d u y 0 u y u y u y r 6e 0 t t r 6f h k 0 h k h k h k r k 1 2 n 1 6g m 0 where t is the maximum of define time for the goal s cs is the standard value of contaminant mass in water mg l h k is the depth of scene k of a pollution accident spill m m is the contaminant mass of pollution accident spill t and n1 is positive integer 2 3 parameter calibration among the model parameters in this study only α the empirical constant was needed to be calibrated considering the geographic location of fenghuangshan drinking water source this area is in the mainstream of the yangtze river range values of α is from 0 10 to 0 20 due to the water source area belongs to the type of straight natural rivers ding et al 2017a the concentration data measured values of cadmium in may 2014 was chosen to calibrate the value of α the values of other parameters are shown in table 1 besides to determine a good value of α in the calibration only when c target concentration of pollutants cs 0 005 mg l would the simulation program stop after calibration the simulation results would be fine when α was 0 15 fig 2 seen from fig 2 the mean absolute deviation between the calculated value and the measured value was 6 7 therefore this model can be applied to pollution spreading prediction in the drinking water source with the calibrated parameter α 2 4 model validation this study predicted one circumstance to verify the applicability of this model comparing the real measured data of the zigui drinking water source area in 2015 and data obtained by the model simulation the falling period was chosen as the simulation period contaminant mass was settled as 200 t c0 was chosen as 0 001 mg l and h ux and uy were settled as the upper boundary value table 1 after simulation the contaminant in the drinking water source area had disappeared completely as shown in fig 3 the calculated value of this simulation was close to the measured value of the zigui drinking water source area in 2015 the final simulation result was directly related to the initial background concentration that is because the dilution of the background concentration dilution in the drinking water source area was not considered in this simulation thence when the pollutants completely disappear the concentration of pollutants in the drinking water source area would change to its original background concentration therefore this model can be used in practical to forecast metal pollution accident in the drinking water source 3 study area 3 1 fenghuangshan drinking water source from the tgd up to jiangjin city in chongqing municipality the backwater length of tgr is about 660 km and forms a river type reservoir in addition the water level increased through three stages to elevations of 135 156 and 175 m above sea level in 2003 2006 and 2010 respectively bao et al 2015 bing et al 2016 the elevation of the water level motivated the navigation of large container ships in tgr and has thus become an essential potential threat to the water quality meanwhile the manual operation of tgr has affected the characteristic of season water level variation which exhibits some anti season features in other words the low water level would emerge in wet season and the high level occurs in winter zigui county in the city of yichang in the province of hubei has a regional area of 2427 km2 maximum distance of east west is 66 1 km and the largest north south distance is 60 6 km and had a population of more than 380 thousand people the annual average temperature of zigui county was 16 7 c and its annual rainfall was 1129 7 mm in 2014 the town of maoping has a regional area of 206 km2 and its climate belongs to a subtropical continental monsoon climate it has a population of more than 80 thousand which includes 18 villages and 3 communities the yangtze river flows across the central county and runs 64 km from the poshui gorge to the maoping estuary which divides zigui into northern and southern parts in the applied simulation and prediction this research was carried out at the fenghuangshan drinking water source zigui county fig 4 where the geographic coordinates are 110 18 111 0 e 30 38 31 11 n and the water samples were collected from the mapping hydrological station as fig 4 shows the fenghuangshan drinking water source is the main drinking water source of zigui county and its acreage is about 2 4 km2 while the water supply population has reached about 40 000 the fenghuangshan drinking water source which belongs to a river type has the same hydrological conditions with tgr due to its distance being about 2 km away from the tgd according to the environmental quality standards for surface water gb3838 2002 of china the cadmium concentration of the water source area should be less than 0 005 mg l thus 0 005 mg l is the value of water standard in this research analyzing the water quality based on the data of the maoping hydrological station since 2013 the annual water quality in the fenghuangshan drinking water source was below 0 001 mg l the shipping conditions of this water source area are developed because it is in the mainstream of the yangtze river and is very close to the tgd the zigui county is rich in ore resources in addition its industries of electronics chemicals and transportation are developed therefore this study suggests that there may be two reasons for potential cadmium pollution 1 an industrial accident led to the release of cadmium 2 shipping accident caused cadmium pollution in this study considering the geographical location of the study area the cadmium pollution accident was assumed caused by a ship accident the pollution accident was transient and the pollution source was a point source and it happened at the upstream center of the drinking water source fig 4 the pollution source belongs to an instantaneous point source type in addition this study took the indicator of cadmium in the drinking water source as the simulation object in terms of speed direction the positive direction was along with the x axis y axis in fig 4 3 2 model application in the light of contaminants mass in water data detected by the maoping hydrological station c0 was obtained to create a useful friendly environment for testing data minu and shetty 2015 the cadmium migrating diffusion and distribution were simulated with this modified model using the matlab 2014a platform this model was used to program the distribution of the pollution accident in the drinking water sources under different periods to analyze the influence of parameters on pollutant distribution this study assigned interval values to parameters including h ux and uy in addition k has the minimum influence on pollution concentration ding et al 2017b this study did not consider the change value of the attenuation coefficient in the process of prediction data were collected from the maoping hydrological station yichang national bureau of statistics hubei environment monitoring center changjiang maritime safety administration and china three gorges corporation monthly water flow data were obtained from the china three gorges corporation and the monitoring cadmium data in the drinking water source were retrieved from the maoping hydrological station of yichang hydrology and water resources survey bureau in addition based on the environment quality standard for surface water china published by the ministry of environmental protection of the people s republic of china if the cadmium concentration of the drinking water source area was less than 0 005 mg l the water from this area would be considered as qualified on the cadmium level therefore 0 005 mg l was selected as the cs in the simulation based on the water data of the china three gorges corporation fig 5 the graph of flow observed values has an obvious reverse dependency with the water level fig 5 shows that water level declined until june while the flow increased in 2012 then water level had a brief gentle period and lasted about a month after that both the water level and flow had a large fluctuation period from july until the end of august while both still kept a similar connection to the one before afterwards the water level climbed to about 175 m in one month and was kept in the vicinity until the following january in 2013 the relationship between water level and flow had a comparable tendency with that in 2012 the difference was that the duration of the fluctuation period became shorter and the duration was from mid july to mid august after the water level decreased moreover the fluctuation period was cut down to about 20 days and the undulation change was smaller in 2013 finally the fluctuation period in july could be ignored in 2014 due to manual intervention the whole year was divided into four periods the low water period of tgr generally occurs between november and march when the water level of tgr does not change much and the flow is low the falling period is from april to may when the water level of tgr shows a significant downward trend due to artificially increasing the discharge flow of the reservoir the flood period lasts from june to september when the flow of tgr is large and varies greatly thence the water level also changes greatly but it is always at a low level overall in this period the water storage period is october when the water level of tgr shows a clear upward trend because of the artificial water storage the river slope coefficient i was calculated as 4 6 10 6 by analyzing the geological data of the fenghuangshan drinking water source few literatures about the hydrolysis of cadmium in natural water body were reported besides the water of this study area is low in impurities which does not provide enough conditions for cadmium hydrolysis and precipitation considering a sudden pollution accident was settled in a short time the k of cadmium was small enough to be ignored in this study the width of the drinking water source area was about 2000 m this study chose b as 1000 m due to the accident pollution happened in the middle of the drinking water source area fig 4 h was the measured value of water depth in each period the carrying capacity of many yangtze river dangerous goods transport ships is less than 500 tons considering there was an accident that 200 tons of hazardous chemicals leaked in the tgr in 2009 the maximum mass of contaminant was selected as 200 tons in this study in addition the minimum value of velocity in the drinking water source area was 0 01 m s according to the measured values in this study interval values of ux and uy were settled as 0 01 0 05 according to available data received from the maoping hydrological station the cadmium concentration in the fenghuangshan drinking water source was less than 0 001 mg l in most months therefore in this study the value of 0 001 mg l was calculated as the cadmium background concentration the range of parameters in different hydrological periods and the range values of the input parameters can be seen in table 1 3 3 practical application of model the pollution distribution model can be used to simulate the spatio temporal change of the pollutant when a serious water pollution accident occurs according to the simulation results the scope and level of the water pollution accident could be evaluated and the emergency treatment plan can be initiated accordingly so as to provide a rapid decision making basis for the protection and management organizations of water source areas meanwhile the decision making department should put forward the pollutant emission reduction index and the advice to improve water treatment according to the function of water area and the environmental capacity of water body avoid serious water pollution ensure safe water use and sanitation and prevent or mitigate environmental changes that may have unintended consequences for society and the biosphere from possible future sources of pollution finally to achieve social benefits environmental benefits economic benefits of the unity 4 results and discussion 4 1 spatial distribution of pollution accident within one hour the prediction had been carried out on the four hydrological periods and those output images were similar visually taking the flood period as an example fig 6 shows the distribution situation of different cadmium pollutants mass in one hour seen from fig 6 the pollution area would be the area was 2000 2000 200 600 and 2000 2000 200 570 in the situation where h was the max value and the min value respectively in other words the highest concentrations of cadmium appeared in the accident place the coordinates are 0 0 and the lowest concentration values emerged in the area away from the incident about 570 m at least in the y axis and about 2000 m in the x axis this result is similar to the result of guo and cheng s diffusion simulation of water pollution accidents by means of mathematical modeling guo and cheng 2019 both showed that the area with the highest concentration of pollutants was around the accident point and diffusion gradually presents a tendency of inverted v as time goes by meanwhile it can be seen from the results that with the rising water depth the pollution area would increase in other words pollution patterns have a great impact on water quality changes peng and li 2021 changes in water depth disturbed the water dynamic balance and there was a positive correlation between the two similar research results can be corroborated in the study of tsuzuki tsuzuki 2015 table 2 lists the maximum concentration of cadmium pollutants in different hydrological periods and different water depth in one hour max h was the max value of water depth in each hydrological period and min h was the min value the values of ux and uy were both settled as 0 05 m s in these prediction processes a total of 121 401 data were generated in each period of simulation the initial and maximum concentrations of cadmium were different due to the diversification water depth in these four periods comparing water level values in different hydrological periods the increase of seasonal water level could help the pollutants diffusion for the same hydrological period as the water depth increases the dilution rate of the pollutant concentration increases and the pollution area increased overall the change of water depth has an impact on the water movement mechanism zhang et al 2021 the increase in water depth promoted the dilution of pollutants correspondingly the pollutants diffusion would be accelerated and xiang et al had a similar conclusion xiang et al 2021 4 2 concentration diffusion of pollution source change with time fig 7 provides the results of the concentration diffusion of the pollution source change with time under four periods in the legend f represents the flood period fp represents the falling period ws represents the water storage period and lw represents the low water period in comparison the law of pollution distribution exhibits similar changes at the beginning in each hydrological period from fig 7 it can be observed that the concentration had a tendency to go down rapidly during these four periods at the first stage and then the concentration would increase to the second peak before declining again with ux 0 05 m s and uy 0 05 m s the cadmium concentration would reach the water quality standard in less than 4 32 h for example when the water depth was the min value the flood period had a similar tendency with the falling period the concentration of cadmium decreased sharply and met the water standard in 3 84 h and it first reached the lowest concentration of 0 001 mg l in 5 28 h then the cadmium concentration began to rise and climbed over the water standard at 6 72 h to 0 225 mg l 0 211 mg l in fp after about 3 84 h afterwards the value would become smaller by degree and kept this tendency until the polluted water reached the water quality standard at 17 28 h 17 76 h in fp for the tendency of cadmium spread in the water storage period it also declined rapidly at first and met the water standard at 4 32 h the concentration would reach the lowest concentration of 0 002 mg l at 5 28 h and then it would rise over 0 005 mg l at 6 72 h then the concentration climbed to the highest value 0 168 mg l in ws at 10 56 h and then decreased to the water standard at 18 24 h after that the cadmium concentration was guaranteed to meet 0 005 mg l the prediction of the cadmium pollutant in four periods shows that the water could ensure quality safety less than 19 h through the river flow itself in addition these final prediction results were identical to the actual background concentration of cadmium which means that the developed model is reliable thence this model could be used in practical applications by observing fig 7 a weird phenomenon took place in all four periods the concentration value exceeded 0 005 mg l again after meeting the water standard and the phenomenon lasted for hours the strange situation in these four periods continued for about 11 52 h considering the characteristics of the model applied it was a conclusion that the shores and the tgd could affected cadmium pollution distribution this study tested the correctness through changing the value of b and the flood period with max h was chosen as the simulation period fig 8 as seen in fig 8 there is no second peak when b 0 m and the second peak would appear when b 0 m in addition the higher the value of b was the later the second peak would emerge and the lower the maximum concentration value was comparing similar phenomena in other research literatures ani et al 2012 tang et al 2016 the result further supported the previous conclusion of this research 4 3 concentration diffusion in the drinking water source with time the concentration of cadmium pollutant source meeting the water standard did not mean that the water quality of the drinking water source meet the standards in this research the simulation of cadmium with time and velocity in different periods was implemented to describe the distribution pattern various velocities for four periods were predicted to make the contaminant concentration comply with the standard the results were shown in table 3 the results of t x y mean that the time intervals of cadmium meet water standard corresponding to the bounds of water depths in each hydrological period for example in the low water period under the ux 0 01 m s and uy 0 02 m s the time that met the water standard after pollution should be 54 h while h min h and the time would be 55 h while h max h namely the time interval was 55 54 table 3 shows three phenomena in one hydrological period firstly the value of t x y and t x y would close gradually until they were equal to each other with uy or ux increasing secondly the time to meet the water standard would be reduced as the water depth grew however when the value of uy or ux was increasing the influence of water depth on the time to meet water standard would be decreased thirdly t x y would equal to t x y when uy was big enough and the diversification of the water depth had no influence on the time to meet water standard for example t x y had few changes with varieties of water depth while uy was bigger than 0 03 m s in the water storage period in addition with the value of ux or uy increasing the time to meet the water standard decreased comparing the research of mbuh et al the results of this study showed that velocity has an important impact on pollutant diffusion and water quality changes mbuh et al 2019 yan s research showed that under the influence of the flow rate of different water phases the pollutant diffusion rate was in the descending order of abundant water period flat water period dry water period which is also consistent with the results of this study yan et al 2022 moreover velocity was more effective than water depth on the pollution spreading table 3 presents that the influence level of ux or uy to the degree of decline was different take the flood period as an example when ux 0 01 m s the maximum span of t x y was from 118 to 19 h with uy increasing and when uy was fixed as 0 01 m s the biggest leap of t x y was 51 h by contrast the former level of leapfrogging was more 1 94 times than the latter which means uy has more influence than ux on the proliferation of pollutants this result was similar with other research literatures teixeira 2011 zhai et al 2021 in detail the velocity along the flow direction dominates the process of promoting the pollution distribution zhang s research showed that increasing the velocity also increases the diffusion rate of pollutants in his model simulation scenario increasing the flow rate by 10 leads to reaching the peak of the studied section 6 h earlier zhang et al 2011 thence to comply with water quality standards within a limited time after one pollution accident it is a feasible solution to increase the flow velocities especially the flow velocity along the river of drinking water source through reservoir scheduling 5 conclusions the prediction of pollutant diffusion and spatial distribution is one of the key points in the study of water pollution accidents to improve the accuracy of prediction water quality models generally require many parameters however incomplete model parameters or low accuracy often occurs in actual pollution accidents based on the two dimensional pollution distribution model this study introduced the interval algorithm to solve the problem of model parameter uncertainty an interval transient pollution distribution model was developed to simulate and predict the diffusion of cadmium pollution instantaneously with time results presented that cadmium pollution has similar patterns of diffusion throughout the contaminated areas at the early phase in four hydrological periods cadmium concentration diffusion had a fluctuation variety during the time before meeting the standard eventually the trend line would decrease with time at first then it would rise again and last for hours before it drops below the standard in addition the change of cadmium concentration was affected by the distance between the accident discharge source and the shore river velocity and water depth among which the velocity has a more significant effect on the diffusion of pollutants in this study to solve the problem that hydrological data was difficult to access a useful model integrating interval analysis algorithm and pollution distribution model was developed after parameter calibration and model validation the results showed that the mean absolute deviation between the calculated value and the measured value was less than 7 thence the proposed model can used to forecast pollution distribution moreover the new model was applied to predict the cadmium pollution accident in the fenghuangshan drinking water source of zigui county tgr for the first time this model can be a useful tool to predict metal pollution accident in drinking water sources the results would be a beneficial and pragmatic reference for researchers and decision makers to generate desirable strategies of restoring the polluted river body to the standard states within limited time thence to improve the accuracy and stability of the promoted model considering the influence of artificial treatment and natural restoration zengel et al 2015 will be an interesting study direction in the future credit authorship contribution statement xinyi zhang writing original draft writing review editing investigation qiande zhu conceptualization writing review editing aifeng zhai methodology software xiaowen ding conceptualization methodology declaration of competing interest all authors declare no conflict of interest acknowledgments this research work was funded by the national key r d program of china cerc wet project 2018yfe0196000 the national key research and development program of china 2017yfc0404503 and national natural science foundation of china 41601529 the authors gratefully acknowledge the financial support of the programs and agencies finally authors declare no conflict of interest 
24405,for the purpose of studying the spreading regularity of metal pollution accident and resolving problem of parameters being difficult to obtain in the drinking water source interval transient pollution distribution model was developed and applied to the fenghuangshan drinking water source three gorges reservoir after parameter calibration and model validation the mean absolute deviation between the calculated value data obtained by the model simulation and the measured value the real measured data of the zigui drinking water source area was less than 7 thence the promoted model can be used in practical accident pollution relying on matlab 2014a this research presented the cadmium pollution spreading pattern in the drinking water source based on the proposed model under the premise of different hydrological periods and different initial pollutant quality this study focused on forecasting and analyzing the spatial distribution of pollution accident within one hour concentration diffusion of pollution source change with time and concentration diffusion in the drinking water source with time the results showed that the variation of cadmium concentration was influenced by the distance between the accidental emission source and shore specifically the distance increases and the appearance of the second pollution peak is subsequently delayed moreover the dilution rate of pollutant was directly proportional to water depth and flow velocity and the flow velocity has more important influence on the diffusion of pollutants than others do the purpose of this study is to develop an effective model to forecast and solve the metal pollution accident in drinking water sources under the condition of incomplete or uncertain parameters in order to solve the problem of difficult hydrological data acquisition the results provide some new insights and references for researchers and decision makers to predict and respond to emergency accident pollution in drinking water sources graphical abstract image graphical abstract keywords drinking water source cadmium pollution flow velocity interval distribution model 1 introduction safe drinking water plays a major role in human health and survival social stability and economic development sustainability dippong et al 2020 lópez roldán et al 2016 wang et al 2016 in the past years chemical accidents have caused serious pollution and threats to natural water bodies in 2005 about 100 tons of benzene flowed into the songhua river and formed an 80 kilometer long pollution belt which severely affected local economy and residents lives jiang et al 2012 in 2007 hebei spirit accident spilt 12 547 tons of chemicals directly into the coastal area of taean in western south korea causing serious pollution to the local water body chung and lee 2016 in 2012 the cadmium pollution incident in longjiang river seriously threatened the drinking water safety of residents along the river and downstream zhao et al 2018 in addition the toxic wastewater pollution of the animas river in the united states in 2015 and the saga oil spill accident in japan in 2019 had caused serious impacts on local water quality safety duval et al 2020 misuri et al 2021 statistics on 85 accidents with pollution duration records found that 28 2 pollution lasting less than 12 h 21 2 between 12 and 24 h 14 16 5 between 24 and 48 h and 15 3 between 48 and 96 h while 18 8 cases involved pollution lasting for more than 96 h yao et al 2016 apparently water pollution accidents would seriously threaten the safety of water quality it is important to examine contaminant masses in water and identify the distribution patterns of contaminants chen et al 2015 roșca et al 2020 particularly the drinking water area of lakes and reservoirs which account for more than 40 of urban centralized drinking water sources in china are important freshwater source qu et al 2016 the three gorges reservoir tgr controls 1084 km2 of drainage area upstream and the water level of tgr is between 145 m and 175 m above the sea level xiang et al 2018 13 cities 140 towns and over 1300 villages have been submerged since the impoundment floehr et al 2015 although there have been no major water pollution accidents in the tgr historically ship traffic accidents have occurred frequently xu et al 2021 in 2009 the accident of container falling into shipai water area of the tgr near the three gorges dam tgd caused more than 200 tons of dangerous chemicals spilled directly into the yangtze river in 2012 more than 40 tons of phenol fell into the zhenjiang section of yangtze river due to a korean ship spilled polluting drinking water in many places meanwhile chemical companies built on the sides of the reservoir upstream have increased the risk of water pollution accidents and toxic chemicals contamination caused by marine accidents would arise occasionally wang et al 2018 besides with the annual navigable volume of the tgr exceeding 100 million tons the pressure on the prevention and control of accidental pollution in drinking water sources of the tgr has further increased for dense populations who use surface water from the tgr as drinking water water pollution accidents would affect their lives largely thereby influencing not only the social stability but also the economic development ma et al 2020 the chinese government has developed relevant comprehensive standards such as the environmental quality standards for surface water gb3838 2002 and has repeatedly carried out works to ensure the safety of drinking water wang et al studied the spatial distribution of metal pollution in the yangtze river estuary and found that different areas were polluted to different degrees wang et al 2014 zhang et al assessed and analyzed the metal pollution of the bortala river and found that the pollution of pb cd and hg were serious zhang et al 2016 li et al developed a model based on support vector machine to predict metal concentrations of chaohu lake li et al 2021 karaouzas et al investigated metal contamination status of surface water in greek and calculated the water quality karaouzas et al 2021 usman et al quantified the metal pollution in the indus river watershed usman et al 2021 paul et al compared metal pollution of aquatic bodies in southern usa to evaluate the characteristics of distribution paul et al 2021 in all literatures about metal water pollution mainly focused on the evaluation and analysis was carried out at large scale levels such as watershed and long time zhou et al 2020 conversely there were few researches on metal water pollution accidents as for the single metal pollution accident researches in drinking water sources were rarely reported thence the requirements have been increased significantly to study the metal pollution accident and to analyze the influencing factors in drinking water sources in the past decades a series of spreading models and simulation methods have been developed to study water pollution problems reed et al 1999 chao et al developed and applied a two and three dimensional water models according to mass transport equation and solved the problem of the pollution particles concentration distribution chao et al 2001 based on the integration of geographic information system gis technology rui et al developed an emergency response system for water pollution accidents in the xiangjia dam area of china which could be a reference for analyzing water pollution rui et al 2015 rekadwad and khobragade investigated the origin of pollution spills and highlighted the pollution adverse effects not only on the economy but also on the ecosystem rekadwad and khobragade 2015 in the oslo fjord a 3d fluid dynamics integrated model developed by eregno et al was used to assess the escherichia coli spreading eregno et al 2018 masocha et al presented a first order decay equation to predict pollutant concentrations in some rivers of zimbabwe masocha et al 2019 to predict and simulate a sudden pollution event in a lake wu et al optimized the variable fidelity surrogate dream model and the results showed that the established model improved simulation calculation speed about 200 times wu et al 2020 kumar et al developed a multidisciplinary method to characterize the pollution level in water resources and revealed the contamination situation along the toko dam kumar et al 2021 however the above literature mostly focused on effects on the economy or ecosystem fokina et al 2014 gonnelli et al 2016 there are few studies discussing emergency pollution distribution in water drinking sources furthermore most parameters in model need to be accurately obtained in advance and its application has certain restrictions in cases of incomplete parameter data for the uncertain parameters nataraj and sardar proposed a template generation algorithm based on interval mathematics nataraj and sardar 2000 yang et al overcame the problem of insufficient parameters by using interval analysis algorithm yang et al 2018 leng and zhang employed a new iterative algorithm to obtain the maximum eigenvalue of a real interval matrix leng and zhang 2013 to calculate the interval results dong et al developed a method combining interval algorithm and perturbation method dong et al 2021 thence this study introduced the method of the interval analysis algorithm and then obtained an interval containing accurate results in the case of uncertainty parameters therefore the objective of this study was to develop a new model and applied it to the metal pollution accident in the fenghuangshan drinking water source of zigui county china in this study area hydrological conditions of the drinking water source are influenced by the regulation of tgd in zigui county chemical production and transportation of minerals and electronics are important industries thus heavy metals and their compounds have become the potential pollutants in local drinking water source cadmium one of metal pollutants was took as the water quality index for the prediction and analysis of pollution accidents in this research according to the existing operation scheduling plan of the tgd the hydrological period of the study area in the tgr is divided into four the low water period the flood period the water storage period and the falling period bao et al 2014 the proposed model operation and prediction results analysis were realized through matlab 2014a due to its powerful data and image processing capabilities gdeisat and lilley 2012 giuliani et al 2016 to solve the problem of uncertain parameter or incomplete data interval variables are used to describe the uncertain parameters and the uncertain parameters are converted into deterministic interval parameters thus the interval mapping relationship between parameters and prediction results was established an interval instantaneous pollution distribution model was developed to simulate and predict the instantaneous diffusion of cadmium pollution with time the measured values were used to calibrate the empirical constant and the mean absolute deviation was found to be less than 7 after model verification the basic structure of this paper is as follows in section2 based on the transient point source pollution distribution model and interval analysis algorithm the new model was developed after parameter calibration and model validation the results showed that the promoted model could be used in predicting pollution distribution of practical in drinking water sources in section 3 the information of the study area and model application was introduced an accident pollution forecasting was carried out by using the developed model in the fenghuangshan drinking water source in section 4 this study mainly discussed the results that spatial distribution of pollution accident within one hour concentration diffusion of pollution source change with time and concentration diffusion in the drinking water source with time in section 5 conclusions innovations and outlook were sorted out and summarized combining the two dimensional pollution distribution model with the interval algorithm this study provided a new useful model with practicability to predict the pollutants diffusion on the condition that data or parameters were incomplete or uncertainty the developed model was applied to fenghuangshan drinking water source and the results provided practical reference and technical support for decision makers to formulate emergency plan of water pollution accidents especially heavy metal pollution in the tgr 2 methodology 2 1 transient point source pollution distribution model pollutants which can be dissolved with an aqueous medium after discharging into the river have similar hydrodynamic properties with the water body the distribution pattern of pollutants was assumed only to have the contaminant concentration gradient in the x direction when the river water moved in a large time scale which can be formulated using eq 1 liu 2011 1 d x 2 c x 2 u x c x k c 0 where c is the target concentration of pollutants in water mg l dx is the diffusion coefficient in the x direction ux is the velocity of flow in the x direction transverse velocity m s and k is the attenuation coefficient of pollutant 1 s representing the pollutant degradation rate under the influence of physical chemical and biological factors eq 1 can reflect the diffusion and migration in a situation where the water body is in a steady state however the pollution sources belong to unsteady discharge patterns in sudden pollution incidents considering the influence of time equation 2 was obtained 2a d x 2 c x 2 u x c x k c c t 2b d y 2 c y 2 u y c y k c c t where dy is the diffusion coefficient in the y direction uy is the velocity of flow in the y direction longitudinal velocity m s and t represents the time of contamination s integrating eqs 2a and 2b the two dimensional pollution distribution model was obtained 3 c t d x 2 c x 2 d y 2 c y 2 u x c x u y c y k c considering the impacts of boundary on the spread of pollutants and background concentration fig 1 the laplace transform and inverse transform were used on eq 3 in addition for the sake of simplicity the unit conversion between masses was directly reflected in the formula in this study the background concentration value of drinking water sources was much lower than the contaminant concentration value of accident thence the background concentration of the water source area was taken as the reference value and regardless of its own degradation and diffusion process thus a transient point source pollution distribution model was obtained 4a c x y t c 0 m 4 π h t d x d y exp k t exp x u x t 2 4 d x t y u y t 2 4 d y t exp x u x t 2 4 d x t 2 b y u y t 2 4 d y t meanwhile the calculation of dx or dy was based on empirical formulas baussant et al 2011 4b d x 5 93 h g h i 4c d y α h g h i where c0 is the background concentration of concentration in water mg l b is the distance between the accident emission sources and shore m g is the gravitational acceleration constant m s2 i is the river slope coefficient m is the contaminant mass tons h is the water depth m α is the empirical constant 2 2 interval transient pollution distribution model analyzing equation 4 factors that have an impact on the distribution of pollutant concentration changes were ux uy h and m while time settled actually the data of ux and uy were not easy to obtain precisely under normal circumstances to tackle these issues the interval analysis algorithm was introduced in this study an interval number could be defined as follows huang et al 1995 5 x x x t x x t x to resolve the matter of measurement uncertainty that some parameters such as h ux and uy were unknown interval variables were used to describe uncertain parameters chen et al 2007 thus the uncertain parameters were transformed into deterministic interval parameters based on the certainty of upper and lower bounds of the model the interval mapping relationship between parameters and prediction results were established the model code and its calculation were realized by matlab 2014a the interval transient pollution distribution model was formulated as follows 6a min c x y t c 0 m 4 π h k t d x d y exp k t exp x u x t 2 4 d x t y u y t 2 4 d y t exp x u x t 2 4 d x t 2 b y u y t 2 4 d y t subject to 6b max c c s 6c u x 0 u x u x u x r 6d u y 0 u y u y u y r 6e 0 t t r 6f h k 0 h k h k h k r k 1 2 n 1 6g m 0 where t is the maximum of define time for the goal s cs is the standard value of contaminant mass in water mg l h k is the depth of scene k of a pollution accident spill m m is the contaminant mass of pollution accident spill t and n1 is positive integer 2 3 parameter calibration among the model parameters in this study only α the empirical constant was needed to be calibrated considering the geographic location of fenghuangshan drinking water source this area is in the mainstream of the yangtze river range values of α is from 0 10 to 0 20 due to the water source area belongs to the type of straight natural rivers ding et al 2017a the concentration data measured values of cadmium in may 2014 was chosen to calibrate the value of α the values of other parameters are shown in table 1 besides to determine a good value of α in the calibration only when c target concentration of pollutants cs 0 005 mg l would the simulation program stop after calibration the simulation results would be fine when α was 0 15 fig 2 seen from fig 2 the mean absolute deviation between the calculated value and the measured value was 6 7 therefore this model can be applied to pollution spreading prediction in the drinking water source with the calibrated parameter α 2 4 model validation this study predicted one circumstance to verify the applicability of this model comparing the real measured data of the zigui drinking water source area in 2015 and data obtained by the model simulation the falling period was chosen as the simulation period contaminant mass was settled as 200 t c0 was chosen as 0 001 mg l and h ux and uy were settled as the upper boundary value table 1 after simulation the contaminant in the drinking water source area had disappeared completely as shown in fig 3 the calculated value of this simulation was close to the measured value of the zigui drinking water source area in 2015 the final simulation result was directly related to the initial background concentration that is because the dilution of the background concentration dilution in the drinking water source area was not considered in this simulation thence when the pollutants completely disappear the concentration of pollutants in the drinking water source area would change to its original background concentration therefore this model can be used in practical to forecast metal pollution accident in the drinking water source 3 study area 3 1 fenghuangshan drinking water source from the tgd up to jiangjin city in chongqing municipality the backwater length of tgr is about 660 km and forms a river type reservoir in addition the water level increased through three stages to elevations of 135 156 and 175 m above sea level in 2003 2006 and 2010 respectively bao et al 2015 bing et al 2016 the elevation of the water level motivated the navigation of large container ships in tgr and has thus become an essential potential threat to the water quality meanwhile the manual operation of tgr has affected the characteristic of season water level variation which exhibits some anti season features in other words the low water level would emerge in wet season and the high level occurs in winter zigui county in the city of yichang in the province of hubei has a regional area of 2427 km2 maximum distance of east west is 66 1 km and the largest north south distance is 60 6 km and had a population of more than 380 thousand people the annual average temperature of zigui county was 16 7 c and its annual rainfall was 1129 7 mm in 2014 the town of maoping has a regional area of 206 km2 and its climate belongs to a subtropical continental monsoon climate it has a population of more than 80 thousand which includes 18 villages and 3 communities the yangtze river flows across the central county and runs 64 km from the poshui gorge to the maoping estuary which divides zigui into northern and southern parts in the applied simulation and prediction this research was carried out at the fenghuangshan drinking water source zigui county fig 4 where the geographic coordinates are 110 18 111 0 e 30 38 31 11 n and the water samples were collected from the mapping hydrological station as fig 4 shows the fenghuangshan drinking water source is the main drinking water source of zigui county and its acreage is about 2 4 km2 while the water supply population has reached about 40 000 the fenghuangshan drinking water source which belongs to a river type has the same hydrological conditions with tgr due to its distance being about 2 km away from the tgd according to the environmental quality standards for surface water gb3838 2002 of china the cadmium concentration of the water source area should be less than 0 005 mg l thus 0 005 mg l is the value of water standard in this research analyzing the water quality based on the data of the maoping hydrological station since 2013 the annual water quality in the fenghuangshan drinking water source was below 0 001 mg l the shipping conditions of this water source area are developed because it is in the mainstream of the yangtze river and is very close to the tgd the zigui county is rich in ore resources in addition its industries of electronics chemicals and transportation are developed therefore this study suggests that there may be two reasons for potential cadmium pollution 1 an industrial accident led to the release of cadmium 2 shipping accident caused cadmium pollution in this study considering the geographical location of the study area the cadmium pollution accident was assumed caused by a ship accident the pollution accident was transient and the pollution source was a point source and it happened at the upstream center of the drinking water source fig 4 the pollution source belongs to an instantaneous point source type in addition this study took the indicator of cadmium in the drinking water source as the simulation object in terms of speed direction the positive direction was along with the x axis y axis in fig 4 3 2 model application in the light of contaminants mass in water data detected by the maoping hydrological station c0 was obtained to create a useful friendly environment for testing data minu and shetty 2015 the cadmium migrating diffusion and distribution were simulated with this modified model using the matlab 2014a platform this model was used to program the distribution of the pollution accident in the drinking water sources under different periods to analyze the influence of parameters on pollutant distribution this study assigned interval values to parameters including h ux and uy in addition k has the minimum influence on pollution concentration ding et al 2017b this study did not consider the change value of the attenuation coefficient in the process of prediction data were collected from the maoping hydrological station yichang national bureau of statistics hubei environment monitoring center changjiang maritime safety administration and china three gorges corporation monthly water flow data were obtained from the china three gorges corporation and the monitoring cadmium data in the drinking water source were retrieved from the maoping hydrological station of yichang hydrology and water resources survey bureau in addition based on the environment quality standard for surface water china published by the ministry of environmental protection of the people s republic of china if the cadmium concentration of the drinking water source area was less than 0 005 mg l the water from this area would be considered as qualified on the cadmium level therefore 0 005 mg l was selected as the cs in the simulation based on the water data of the china three gorges corporation fig 5 the graph of flow observed values has an obvious reverse dependency with the water level fig 5 shows that water level declined until june while the flow increased in 2012 then water level had a brief gentle period and lasted about a month after that both the water level and flow had a large fluctuation period from july until the end of august while both still kept a similar connection to the one before afterwards the water level climbed to about 175 m in one month and was kept in the vicinity until the following january in 2013 the relationship between water level and flow had a comparable tendency with that in 2012 the difference was that the duration of the fluctuation period became shorter and the duration was from mid july to mid august after the water level decreased moreover the fluctuation period was cut down to about 20 days and the undulation change was smaller in 2013 finally the fluctuation period in july could be ignored in 2014 due to manual intervention the whole year was divided into four periods the low water period of tgr generally occurs between november and march when the water level of tgr does not change much and the flow is low the falling period is from april to may when the water level of tgr shows a significant downward trend due to artificially increasing the discharge flow of the reservoir the flood period lasts from june to september when the flow of tgr is large and varies greatly thence the water level also changes greatly but it is always at a low level overall in this period the water storage period is october when the water level of tgr shows a clear upward trend because of the artificial water storage the river slope coefficient i was calculated as 4 6 10 6 by analyzing the geological data of the fenghuangshan drinking water source few literatures about the hydrolysis of cadmium in natural water body were reported besides the water of this study area is low in impurities which does not provide enough conditions for cadmium hydrolysis and precipitation considering a sudden pollution accident was settled in a short time the k of cadmium was small enough to be ignored in this study the width of the drinking water source area was about 2000 m this study chose b as 1000 m due to the accident pollution happened in the middle of the drinking water source area fig 4 h was the measured value of water depth in each period the carrying capacity of many yangtze river dangerous goods transport ships is less than 500 tons considering there was an accident that 200 tons of hazardous chemicals leaked in the tgr in 2009 the maximum mass of contaminant was selected as 200 tons in this study in addition the minimum value of velocity in the drinking water source area was 0 01 m s according to the measured values in this study interval values of ux and uy were settled as 0 01 0 05 according to available data received from the maoping hydrological station the cadmium concentration in the fenghuangshan drinking water source was less than 0 001 mg l in most months therefore in this study the value of 0 001 mg l was calculated as the cadmium background concentration the range of parameters in different hydrological periods and the range values of the input parameters can be seen in table 1 3 3 practical application of model the pollution distribution model can be used to simulate the spatio temporal change of the pollutant when a serious water pollution accident occurs according to the simulation results the scope and level of the water pollution accident could be evaluated and the emergency treatment plan can be initiated accordingly so as to provide a rapid decision making basis for the protection and management organizations of water source areas meanwhile the decision making department should put forward the pollutant emission reduction index and the advice to improve water treatment according to the function of water area and the environmental capacity of water body avoid serious water pollution ensure safe water use and sanitation and prevent or mitigate environmental changes that may have unintended consequences for society and the biosphere from possible future sources of pollution finally to achieve social benefits environmental benefits economic benefits of the unity 4 results and discussion 4 1 spatial distribution of pollution accident within one hour the prediction had been carried out on the four hydrological periods and those output images were similar visually taking the flood period as an example fig 6 shows the distribution situation of different cadmium pollutants mass in one hour seen from fig 6 the pollution area would be the area was 2000 2000 200 600 and 2000 2000 200 570 in the situation where h was the max value and the min value respectively in other words the highest concentrations of cadmium appeared in the accident place the coordinates are 0 0 and the lowest concentration values emerged in the area away from the incident about 570 m at least in the y axis and about 2000 m in the x axis this result is similar to the result of guo and cheng s diffusion simulation of water pollution accidents by means of mathematical modeling guo and cheng 2019 both showed that the area with the highest concentration of pollutants was around the accident point and diffusion gradually presents a tendency of inverted v as time goes by meanwhile it can be seen from the results that with the rising water depth the pollution area would increase in other words pollution patterns have a great impact on water quality changes peng and li 2021 changes in water depth disturbed the water dynamic balance and there was a positive correlation between the two similar research results can be corroborated in the study of tsuzuki tsuzuki 2015 table 2 lists the maximum concentration of cadmium pollutants in different hydrological periods and different water depth in one hour max h was the max value of water depth in each hydrological period and min h was the min value the values of ux and uy were both settled as 0 05 m s in these prediction processes a total of 121 401 data were generated in each period of simulation the initial and maximum concentrations of cadmium were different due to the diversification water depth in these four periods comparing water level values in different hydrological periods the increase of seasonal water level could help the pollutants diffusion for the same hydrological period as the water depth increases the dilution rate of the pollutant concentration increases and the pollution area increased overall the change of water depth has an impact on the water movement mechanism zhang et al 2021 the increase in water depth promoted the dilution of pollutants correspondingly the pollutants diffusion would be accelerated and xiang et al had a similar conclusion xiang et al 2021 4 2 concentration diffusion of pollution source change with time fig 7 provides the results of the concentration diffusion of the pollution source change with time under four periods in the legend f represents the flood period fp represents the falling period ws represents the water storage period and lw represents the low water period in comparison the law of pollution distribution exhibits similar changes at the beginning in each hydrological period from fig 7 it can be observed that the concentration had a tendency to go down rapidly during these four periods at the first stage and then the concentration would increase to the second peak before declining again with ux 0 05 m s and uy 0 05 m s the cadmium concentration would reach the water quality standard in less than 4 32 h for example when the water depth was the min value the flood period had a similar tendency with the falling period the concentration of cadmium decreased sharply and met the water standard in 3 84 h and it first reached the lowest concentration of 0 001 mg l in 5 28 h then the cadmium concentration began to rise and climbed over the water standard at 6 72 h to 0 225 mg l 0 211 mg l in fp after about 3 84 h afterwards the value would become smaller by degree and kept this tendency until the polluted water reached the water quality standard at 17 28 h 17 76 h in fp for the tendency of cadmium spread in the water storage period it also declined rapidly at first and met the water standard at 4 32 h the concentration would reach the lowest concentration of 0 002 mg l at 5 28 h and then it would rise over 0 005 mg l at 6 72 h then the concentration climbed to the highest value 0 168 mg l in ws at 10 56 h and then decreased to the water standard at 18 24 h after that the cadmium concentration was guaranteed to meet 0 005 mg l the prediction of the cadmium pollutant in four periods shows that the water could ensure quality safety less than 19 h through the river flow itself in addition these final prediction results were identical to the actual background concentration of cadmium which means that the developed model is reliable thence this model could be used in practical applications by observing fig 7 a weird phenomenon took place in all four periods the concentration value exceeded 0 005 mg l again after meeting the water standard and the phenomenon lasted for hours the strange situation in these four periods continued for about 11 52 h considering the characteristics of the model applied it was a conclusion that the shores and the tgd could affected cadmium pollution distribution this study tested the correctness through changing the value of b and the flood period with max h was chosen as the simulation period fig 8 as seen in fig 8 there is no second peak when b 0 m and the second peak would appear when b 0 m in addition the higher the value of b was the later the second peak would emerge and the lower the maximum concentration value was comparing similar phenomena in other research literatures ani et al 2012 tang et al 2016 the result further supported the previous conclusion of this research 4 3 concentration diffusion in the drinking water source with time the concentration of cadmium pollutant source meeting the water standard did not mean that the water quality of the drinking water source meet the standards in this research the simulation of cadmium with time and velocity in different periods was implemented to describe the distribution pattern various velocities for four periods were predicted to make the contaminant concentration comply with the standard the results were shown in table 3 the results of t x y mean that the time intervals of cadmium meet water standard corresponding to the bounds of water depths in each hydrological period for example in the low water period under the ux 0 01 m s and uy 0 02 m s the time that met the water standard after pollution should be 54 h while h min h and the time would be 55 h while h max h namely the time interval was 55 54 table 3 shows three phenomena in one hydrological period firstly the value of t x y and t x y would close gradually until they were equal to each other with uy or ux increasing secondly the time to meet the water standard would be reduced as the water depth grew however when the value of uy or ux was increasing the influence of water depth on the time to meet water standard would be decreased thirdly t x y would equal to t x y when uy was big enough and the diversification of the water depth had no influence on the time to meet water standard for example t x y had few changes with varieties of water depth while uy was bigger than 0 03 m s in the water storage period in addition with the value of ux or uy increasing the time to meet the water standard decreased comparing the research of mbuh et al the results of this study showed that velocity has an important impact on pollutant diffusion and water quality changes mbuh et al 2019 yan s research showed that under the influence of the flow rate of different water phases the pollutant diffusion rate was in the descending order of abundant water period flat water period dry water period which is also consistent with the results of this study yan et al 2022 moreover velocity was more effective than water depth on the pollution spreading table 3 presents that the influence level of ux or uy to the degree of decline was different take the flood period as an example when ux 0 01 m s the maximum span of t x y was from 118 to 19 h with uy increasing and when uy was fixed as 0 01 m s the biggest leap of t x y was 51 h by contrast the former level of leapfrogging was more 1 94 times than the latter which means uy has more influence than ux on the proliferation of pollutants this result was similar with other research literatures teixeira 2011 zhai et al 2021 in detail the velocity along the flow direction dominates the process of promoting the pollution distribution zhang s research showed that increasing the velocity also increases the diffusion rate of pollutants in his model simulation scenario increasing the flow rate by 10 leads to reaching the peak of the studied section 6 h earlier zhang et al 2011 thence to comply with water quality standards within a limited time after one pollution accident it is a feasible solution to increase the flow velocities especially the flow velocity along the river of drinking water source through reservoir scheduling 5 conclusions the prediction of pollutant diffusion and spatial distribution is one of the key points in the study of water pollution accidents to improve the accuracy of prediction water quality models generally require many parameters however incomplete model parameters or low accuracy often occurs in actual pollution accidents based on the two dimensional pollution distribution model this study introduced the interval algorithm to solve the problem of model parameter uncertainty an interval transient pollution distribution model was developed to simulate and predict the diffusion of cadmium pollution instantaneously with time results presented that cadmium pollution has similar patterns of diffusion throughout the contaminated areas at the early phase in four hydrological periods cadmium concentration diffusion had a fluctuation variety during the time before meeting the standard eventually the trend line would decrease with time at first then it would rise again and last for hours before it drops below the standard in addition the change of cadmium concentration was affected by the distance between the accident discharge source and the shore river velocity and water depth among which the velocity has a more significant effect on the diffusion of pollutants in this study to solve the problem that hydrological data was difficult to access a useful model integrating interval analysis algorithm and pollution distribution model was developed after parameter calibration and model validation the results showed that the mean absolute deviation between the calculated value and the measured value was less than 7 thence the proposed model can used to forecast pollution distribution moreover the new model was applied to predict the cadmium pollution accident in the fenghuangshan drinking water source of zigui county tgr for the first time this model can be a useful tool to predict metal pollution accident in drinking water sources the results would be a beneficial and pragmatic reference for researchers and decision makers to generate desirable strategies of restoring the polluted river body to the standard states within limited time thence to improve the accuracy and stability of the promoted model considering the influence of artificial treatment and natural restoration zengel et al 2015 will be an interesting study direction in the future credit authorship contribution statement xinyi zhang writing original draft writing review editing investigation qiande zhu conceptualization writing review editing aifeng zhai methodology software xiaowen ding conceptualization methodology declaration of competing interest all authors declare no conflict of interest acknowledgments this research work was funded by the national key r d program of china cerc wet project 2018yfe0196000 the national key research and development program of china 2017yfc0404503 and national natural science foundation of china 41601529 the authors gratefully acknowledge the financial support of the programs and agencies finally authors declare no conflict of interest 
24406,species distribution models sdms are used regularly to develop management strategies but many modelling methods ignore the spatial nature of data to address this we compared fine scale spatial distribution predictions of harbour porpoise phocoena phocoena using empirical aerial video survey data collected along the east coast of scotland in august and september 2010 and 2014 incorporating environmental covariates that cover habitat preferences and prey proxies we used a traditional and commonly implemented generalized additive model gam and two hierarchical bayesian modelling hbm approaches using integrated nested laplace approximation inla model fitting methodology one hbm inla modelled gridded space similar to the gam and the other dealt more explicitly in continuous space using a log gaussian cox process lgcp overall predicted distributions in the three models were similar however hbms had twice the level of certainty showed much finer scale patterns in porpoise distribution and identified some areas of high relative density that were not apparent in the gam spatial differences were due to how the two methods accounted for autocorrelation spatial clustering of animals and differences between modelling in discrete vs continuous space consequently methods for spatial analyses likely depend on scale at which results and certainty are needed for large scale analysis 5 10 km resolution e g initial impact assessment there was little difference between results however insights into fine scale 1 km distribution of porpoise from the hbm model using lgcp while more computationally costly offered potential benefits for refining conservation management or mitigation measures within offshore developments or protected areas keywords bayesian model generalized additive model gam integrated nested laplace approximation inla harbour porpoise species distribution model abbreviations gam generalized additive model inla integrated nested laplace approximation lgcp log gaussian cox process hbm hierarchical bayesian model 1 introduction understanding environmental and anthropogenic drivers of species distributions is critical for identification of potential areas for protection development of appropriate conservation management strategies and mitigation of negative anthropogenic impacts collection of empirical environmental data however can be risky costly and time consuming consequently desk based species distribution modelling provides a cost effective yet successful alternative method to address these factors e g bailey and thompson 2010 norberg et al 2019 many statistical techniques are used to model species distributions but due to inherent complexity of analysing space most do not fully address the spatial nature of data generalised additive models gams hastie and tibshirani 1990 are one of the most commonly used and well established methods of performing species distribution modelling becker et al 2020 redfern et al 2006 wood 2006 over the past decade there has been rapid development of specific statistical methodologies aiming to address the spatial nature of empirical data e g cameletti et al 2012 diggle et al 2013 illian et al 2008 law et al 2009 sadykova et al 2017 however such methods are complex and require a high level of statistical expertise and computational power practitioners are therefore often faced with a choice of which model to apply to their data which can have considerable impacts on outputs norberg et al 2019 the development of point process models in ecological contexts soriano redondo et al 2019 yuan et al 2017a by using exact locations of points in space within a gam function are being explored by some studies fithian and hastie 2013 miller et al 2019 renner et al 2015 these use an inhomogeneous poisson process maximum entropy or infinitely weighted logistic regression to model data in a point process framework thereby taking advantage of the spatial information however at the time of the production of this study these techniques were still under development for generalist use and were therefore not explored further here the aim of this study was to assess differences between use of traditional frequentist gams and explicit spatial modelling approaches using hierarchical bayesian models hbm fitted with integrated nested laplace approximation inla rue et al 2009 to achieve this we introduce the two methods gam and hbm inla and identify three areas in which bayesian developments offer potential benefits over traditional gams 1 they account for spatial autocorrelation 2 clustering of animals and 3 model in continuous space we then implement both methods using an example of real world aerial video survey data for harbour porpoise phocoena phocoena finally we explore differences in resulting spatial predictions of porpoise distribution and conservation management implications 1 1 two approaches to species distribution modelling 1 1 1 generalized additive models generalized additive models are popular for species distribution modelling because of their ability to encapsulate non linear interactions between sightings and environmental covariates through use of smoothing functions e g booth et al 2013 embling et al 2010 williamson et al 2016 however their ability to capture spatial trends is limited without use of alternative more complex additions fithian and hastie 2013 miller et al 2019 renner et al 2015 scott hayward et al 2014 nonetheless gams are relatively easy to implement by the user through various r libraries such as mgcv wood 2011 or similar counts y in a grid cell si i 1 n are modelled response variable and the model usually assumes that counts in each grid cell follow a poisson distribution the expected value in a grid cell si is modelled as a linear model of covariates x i e 1 g y s i x s i t β β 0 where g is a log link function x si t is a matrix of n observations on each of the k explanatory variables and β is a vector of regression coefficients the gam formulation in eq 1 does not address the problem of spatial autocorrelation instead accounting for trends in data across larger geographical distances dormann et al 2007 one common method for circumventing this problem is to include a bivariate smoothing term of latitude and longitude or a soap film smoother wood et al 2008 in the gam itself soap film x y smoothers also include boundary information to prevent the model from predicting animals presence in areas they are not capable of occupying wood et al 2008 e g porpoises present on land an x y smoother accounts for similarity of the response variable in adjacent cells reducing the effect but not the amount of spatial autocorrelation the spatial autocorrelation problem is solved by using more complex methods such as including autocorrelation structures in a generalized additive mixed effects model carvalho et al 2020 1 1 2 hierarchical bayesian modelling using inla recent developments in spatial statistical methodology have focused on producing a flexible computationally efficient approach that is increasingly accessible to end users here we used a continuously indexed gauss markov random field based on the stochastic partial differential equation spde lindgren et al 2011 this provides an approximation to a continuous spatial field that allows users to work efficiently with complex spatially explicit models blangiardo et al 2013 in addition models were fitted based on inla rue et al 2009 a recently developed computationally efficient method for hierarchical bayesian inference that is particularly suitable for complex spatial models such as those based on the spde approach combining the two methods spde and inla provides a suite of flexible models that allow for realistic spatial modelling within feasible computation timescales as in the gam model counts y in a grid cell si i 1 n are modelled but a bayesian approach is used and spatial autocorrelation is modelled by a random field ξ i e 2 g y s i x s i t β β 0 ξ s i where g is a log link function and β is a vector of regression coefficients in this hbm formula the residual spatial autocorrelation is modelled explicitly by including the ξ term which specifies a spatial or spatio temporal random field rue and held 2005 this framework allows for smooth and nonlinear effects of covariates time trends seasonal effects random intercepts and slopes and spatio temporal random effects therefore this class of model is highly flexible and can accommodate a wide range of paradigms 1 2 discrete vs continuous space spatial data are usually gridded or segmented when using gams which causes spatial information to be lost however spatially explicit approaches such as spde inla can model in continuous space since this implies much less information loss spde inla approaches were expected to be more appropriate and capable of reflecting small scale spatial behaviour that cannot be captured by gridding or segmenting sightings consequently in this paper we made two comparisons we initially used both approaches gam and hbm to model data on the same spatial grid to establish how the approaches differed when the actual models were similar with the expectation of similar results we then moved towards modelling in continuous space using the spde inla approach that also allowed us to incorporate information on the exact location of transects as well as the spatial structure formed by the locations of individual animals i e their clustering yuan et al 2017b 1 3 spatial clustering of animals animals do not always move independently at times some species can form large groups in small areas for several reasons such as social cohesion or specific attraction to the location as a result of physical and or environmental covariates plants and animals are often clustered spatially according to a poisson process which inappropriately assumes complete spatial randomness between clusters to account for this a cox process møller and waagepetersen 2007 waagepetersen and schweder 2006 is a flexible type of spatial point procedure which improves accuracy by modelling spatial patterns relative to observed or unobserved spatial trends illian et al 2012 in this way the spatial pattern can be modelled along with traits of individual observations such as markings scars size or colour and environmental covariates illian et al 2012 since clustering violates poisson process assumptions this obliges the spde to capture low range peaks in detection rather than a large scale distribution trend an alternative and often implemented approach is to use the negative binomial distribution to account for overdispersion which means that the spde does not have to accommodate spikes to capture the large scale trend however while often used to avoid violation of model assumptions it does not explicitly model overdispersion moreover there is no obvious way of extending this to continuous space so analysis is restricted to using gridded bins when using hierarchical bayesian models localised clustering can be differentiated from large scale patterns using the log gaussian cox process lgcp method which models exact locations of points diggle et al 2013 the model assumes point locations are scattered independently in space as a poisson process top level of the hierarchy given a model of the point density formally the intensity of the process the middle level of the hierarchy and a set of priors for all model parameters bottom level of the hierarchy the log of intensity λ in a location s r is modelled as a linear model of covariates x and a random field ξ that is again approximated by an spde 3 l o g λ s t x s t β β 0 ξ s 1 4 case study harbour porpoise is the most numerous cetacean species in european atlantic shelf waters hammond et al 2021 which is also where most anthropogenic activities occur consequently they are threatened by inter alia unsustainable incidental catches in fishing gear and prey removal various forms of chemical and underwater noise pollution and other anthropogenic pressures e g culik 2004 hammond et al 2021 macleod et al 2007 knowledge of porpoise distribution in relation to environmental drivers is therefore critical for effective implementation of management and mitigation measures depth slope bottom temperature and sediment have been significant in previous models of porpoise distribution e g booth et al 2013 brookes et al 2013 sadykova et al 2017 williamson et al 2016 other variables included chlorophyll a net primary productivity and fronts and tidal mixing e g current speed vertical shear and potential energy anomaly to quantify stratification strength which cause prey aggregation and have been correlated previously with the distribution of fish and marine predators e g embling et al 2012 hofmann and powell 1998 olson and backus 1985 scott et al 2010 previous distribution modelling in the moray firth north east scotland part of the current study area fig 1 found a relatively high density of animals in the smith bank a shallow 30 40 m sand bank in the middle of the firth brookes et al 2013 williamson et al 2016 this is likely because the smith bank provides suitable habitat for sandeels ammodytidae and whiting merlangius merlangus hopkins 2011 two of the most common prey species for porpoise in this area santos and pierce 2003 knowledge of porpoise distribution along the east coast of scotland however is lacking consequently the present analysis combines previously collected aerial video survey data with a newer dataset which allowed us to investigate distribution along the entire east coast of scotland aerial video surveys use video cameras to record strip transects below the survey aircraft and are thus different to visual surveys by human observers buckland et al 2012 moreover video surveys provide a permanent record of sightings which can be beneficial for clarifying mis or ambiguous identifications anomalous results improving data transparency and audit indeed some regulatory authorities now require such a permanent record bsh 2013 estimates of relative density of porpoise modelled from video survey data have been found previously to correlate strongly with relative density estimated from visual surveys williamson et al 2016 1 5 aims the purpose of this study was to compare two modelling frameworks to investigate differences between results obtained from a spatial modelling technique hbm using inla and a gam which is used commonly by ecologists we illustrated differences between these methods in how they model spatial autocorrelation groups of individuals and discrete vs continuous space we performed this using a case study of aerial video transect survey data to analyse harbour porpoise distribution along the east coast of scotland and discussed the potential management implications of results 2 methods 2 1 case study data collection aerial digital video surveys covering a total of 5762 km were performed by hidef aerial surveying ltd in august and september 2010 and 2014 along the east coast of scotland fig 1 and table 1 video data were processed by qualified trained and experienced observers who extracted all non avian objects for identification by specialists at wwt consulting ltd resulting in a total of 303 individual porpoises observed 2 2 data preparation for gridded analysis once porpoise observations were extracted a 5 5 km grid matching previous marine mammal work jones et al 2015 was created which covered the entire survey area transect lines were intersected to the grid and the total length of transects and number of porpoises sighted within each grid cell was calculated depth on a raster grid of approximately 180 180 m and polygons of sediment type at a 1 250 000 scale were provided by seazone solutions ltd 2005a 2005b sediment types were classified using a folk triangle folk 1954 and expressed as the proportion of sediment that was sand or gravelly sand within each grid cell based on previous studies of porpoise habitat association in this area brookes et al 2013 williamson et al 2016 seabed slope was calculated in degrees using the slope tool in esri arcgis 10 2 1 esri redlands california usa modelled environmental data were provided from runs of the nemo ersem 3d coupled hydrodynamic ecosystem model nucleus for european modelling of the ocean edwards et al 2012 madec 2008 o dea et al 2012 parameters available included bottom temperature ⁰c potential energy anomaly j m3 which is the energy required to mix the water column completely depth averaged current speed m s vertical velocity shear m s depth averaged vertical velocity m day depth integrated net primary production tons day and maximum chlorophyll a mgc m3 these data were available for the summer season july august september and october as climatological means across 25 years 1989 2014 at a 7 7 km spatial scale an estimate of stratification was calculated using the log10 of depth h divided by current speed u cubed log10 h u3 simpson et al 1981 in addition satellite data on a 1 1 km spatial scale were obtained from neodaas nerc earth observation data acquisition and analysis service and processed to derive ocean front metrics miller et al 2015 distance to the closest major ocean front km and front side whether a location is on the cold negative values or warm positive values side of the closest major front or directly on that front zero these satellite data were provided as weekly means during the survey period however due to cloud cover obscuring parts of the study area each week the mean in august and september of 2010 and 2014 were calculated and joined to the survey data from the corresponding year where surveys overlapped between the two years the mean of august and september in both years was used all environmental variables were up or down sampled depending on spatial resolution and joined to the 5 5 km grid for inclusion in the models variables were also standardised by subtracting the mean value the above variables were selected not necessarily because they were thought to influence porpoise distribution directly but often because they are thought to be drivers of the distribution of porpoise prey e g scott et al 2010 after inspection of histograms of the data cells with a vertical shear greater than 0 15 m s and a front side of 2 were removed as data outside these ranges were sparse 2 3 data preparation for lgcp analysis the same 5 5 km grid of environmental data was used for this analysis however number of sightings in each grid cell and length of survey effort in each cell were not joined to this grid instead the exact location of sightings as well as transect start and end points were used directly 2 4 gam analysis the first model was created using gam only cells in which surveys were performed e g survey effort 0 km were included during model development a 10 10 grid of points spaced evenly throughout the study region in which points that did not overlap with land were used for creation of the soap film smoother resulting in 27 internal knots fig s1 smoothers with more up to 30 30 and fewer 5 5 knots were also tested but not found to influence results models were tested with the maximum likelihood method using families such as negative binomial poisson and zero inflated poisson the negative binomial likelihood was selected for analysis after inspection of summary plots of models in every model an offset of the log of the area surveyed was included the area surveyed was calculated by multiplying the effort length surveyed in each cell in km by the strip width width of sea surface in view of the camera in km all environmental variables were tested for collinearity with each other and those with a correlation of 0 5 or greater were not included in the same models after initial investigation relationships between most covariates and sightings were found to be linear therefore for simplicity all covariates were treated as linear in the model except for the soap film smoother backwards selection was used to select the best model in which a full model was fitted which included all environmental covariates except the soap film smoother e g without the influence of space and then each environmental covariate was removed sequentially and the model re run this process was repeated consecutively using the model which had the lowest akaike information criterion aic akaike 1973 until there was no longer a decrease in aic when further covariates were removed an auto correlation function acf plot was used to check for temporal autocorrelation which was not found to exist therefore use of mixed models was not investigated the selected model was run with the soap film smoother and then used to predict relative density of porpoise in all cells within 10 km of the survey transects fig 2 a variogram was created to investigate if spatial autocorrelation was evident in the model diggle and ribeiro 2007 which was not found to be an issue fig s5 all analysis was performed in r version 3 2 4 and gams were modelled using the mgcv package wood 2011 2017 r code can be seen in appendix 1 and is available on github 2 5 hierarchical bayesian analysis using inla two models were created using hierarchical bayesian methods fitted using inla both models were fitted using the inlabru version 2 2 4 9000 and inla 20 03 17 packages in r version 3 4 1 bachl et al 2019 r core team 2017 rue et al 2009 the first model used the same gridded data that were used in the gam analysis with the addition of the spde to account for spatial autocorrelation lindgren et al 2011 the spde approach uses a matérn covariance function to approximate the gaussian field using a flexible stochastic model which provides a continuous relationship between the response and explanatory variables throughout the study area similar to the knots in the soap film smoother in gam the spde approach requires a triangulation mesh of the modelled area the mesh provides a lower bound on the spatial resolution for analysis therefore a mesh should be developed which is fine enough so that no further changes in the results can be observed when a finer mesh is used lindgren et al 2011 the triangulation mesh for the spde was created bounded by the coastline and the boundary of the study region and allowed to place vertices randomly as needed fig s2 default uninformative prior specification gaussian with mean of 0 and variance of 100 was used for all variables the same effort offset that was used in the gam was included here log of transect length strip width and again environmental covariates were treated as linear a negative binomial likelihood was selected to address clustering of the animals and to be able to compare more closely with the gam results model selection excluding the spde was performed in the same way as described for the gam however a widely applicable information criterion waic also known as watanabe aic watanabe 2010 was used instead of aic this selected model was run once more with the spde included and was then used to predict relative density throughout the study area fig 2 the second continuous space model created using hbm used the point process likelihood simpson et al 2016 which has been adapted to line transect surveys yuan et al 2017b this approach represents the locations of animal sightings as realisations of lgcp observed at the area covered by the transects as opposed to the gridded approach where data are aggregated the lgcp allows the locations of observations and transects to be used directly taking the actual transect locations into account allows us to distinguish between areas where we did not find any animals because no survey was performed in that location compared to those areas where we did not find anything but they were also surveyed this is especially useful when transects are not placed randomly throughout a study area information about the relative and absolute animal location is thereby retained which allows for a higher precision in estimating the relationship between covariates and density as well as the residual spatial correlation structure the lgcp model was created using the same set of covariates and the spde described above similarly backwards selection using waic was used based on the environmental covariates without the influence of space and once the best environmental variables were identified the spde was included and relative density was predicted throughout the study area r code used to create the hbm using inla and the lgcp can be seen in appendices 2 and 3 both hbms were also predicted onto the same grid used in the gam models to facilitate comparison between methods spearman s correlation coefficients were calculated between gam and hbm results moreover for visual comparison results of each model were divided by their maximum value to standardise and hbm results were then subtracted from gam results to investigate if gam or hbms predicted higher relative densities fig 4 3 results the negative binomial likelihood was selected for gam analysis after inspection of summary plots of the models fig s3 a negative binomial likelihood was also selected for the hbms using inla on gridded data for comparison to the gam the best models selected using each of the three methods included many of the same covariates table 2 however potential energy anomaly net primary productivity vertical shear and front distance were not retained in any of the best models this best gam model had a soap film smooth term that included latitude longitude and the boundaries of the study region to account for spatial autocorrelation spatial correlation was not included as a random effect in this model because a variogram of model results did not show any relationship with distance fig s5 this model predicted the highest relative density of porpoise on the smith bank and an area of high density along the southern coast of the moray firth this model explained 33 2 of deviance fig 2 and s4 hbm models used the spde approach to account for spatial autocorrelation when comparing the hbm of gridded data with the gam the same areas of highest density were apparent with an additional third area of high density along the east coast of scotland fig 2 in addition much finer scale clustering was apparent in the hbm results the predicted distribution of porpoise from the gam showed broad areas of high density this contrasted with the hbm on a grid particularly in the southern half of the study area where the area of high density was much more restricted than in the gam comparing the hbm using lgcp fig 2 with the gam we again saw much finer localised clustering with only the smith bank highlighted as a high density area this suggested that the model was identifying areas where animals were either found in groups or they used very fine scale areas 1 2 km which were not apparent in the gridded gam analysis maximum coefficients of variation for the models fitted using hbms were much lower than those created using gam gam cv 33 hbm gridded cv 8 hbm lgcp cv 11 fig 3 which showed higher confidence in the models the influence of environmental covariates on models can be seen in figs s4 s7 and s8 effects of environmental covariates were similar between the three models with the sign of each variable being the same even though the exact numbers varied table 2 the gam also had quite large areas with high coefficient of variation cv whereas both hbms had a maximum cv less than half that of the gam but also the highest areas of cv in the hbms were very localised and only at the edges of the study area in areas with very few data fig 3 correlation with gam results was higher for the hbm of gridded data spearman s ρ 0 76 than for the hbm using lgcp spearman s ρ 0 68 the gam consistently predicted higher relative porpoise density just south of the smith bank and both hbms predicted higher density on the smith bank and along the east coast fig 4 scatterplots were created to investigate how well predicted relative densities matched observed data number of sightings divided by the survey effort fig s6 correlation between these ranged between 0 09 and 0 51 3 1 discussion all three models had similar predicted distributions of porpoise fig 2 with important differences firstly compared to gams hbms particularly when using lgcp revealed more fine scale areas of porpoise higher relative density with an additional fine scale 5 km area that was not identified in gams secondly compared to gams hbm lgcp predicted a more realistic patchier porpoise distribution this trend was not apparent in the other two models which used the negative binomial distribution and gridded data which smoothed out the highest density areas finally the best models from each of these three techniques included tidal mixing and chlorophyll a while two models also included depth slope and vertical shear table 2 suggesting that these may be key drivers of porpoise distribution brookes et al 2013 embling et al 2012 sadykova et al 2017 scott et al 2010 williamson et al 2016 in terms of relating these model outputs to real porpoise ecology animals in the field tended to be observed singly or in small groups of 2 3 animals clustering observed in models can likely be explained in terms of animal use of fine scale environmental features that influenced prey availability table 2 e g scott et al 2010 williamson et al 2017 wider social factors such as cooperative hunting behaviour ortiz et al 2021 or simply porpoise group spacing on survey sampling days in terms of oceanography thermal fronts are fine scale transient features which aggregate fish hofmann and powell 1998 olson and backus 1985 and consequently have been related significantly to porpoise and other cetacean detections e g mendes et al 2002 philpott 2013 finally the scale at which modelling was performed may have influenced the impact importance of variables between models mod et al 2020 3 1 1 variability compared to gam variability for both hbms was less than half showing twice the level of certainty in the results some values of high cv in the gam were in areas where there were survey data whereas in the hbms areas of highest cv were restricted to the perimeter of the study area where there was no survey effort the gam predicted much larger areas 25 km of high density than hbms because the gam smoothed out some spatial trends by gridding the data and using the negative binomial distribution whereas the hbms took the spatiality explicit autocorrelation into account 3 1 2 discrete vs continuous space the continuous modelled data using the spde inla offered clear advantages because it eliminated information loss associated with data gridding as performed in traditional gams this is expected to be similar when segmenting data and can result in more accurate predictions of distribution both the hbm of gridded data analysed in continuous space and the hbm using lgcp which used exact locations of sightings and transects have smaller areas of high density 5 km with a patchier distribution in general the continuous representation and triangulation using the mesh provided a more flexible way of approximating a spatial area this becomes relevant both when the observation area is complex with a lack of data etc and if the study area represents a large area of the earth s surface and a fixed grid distorts special relationships in this case models can be defined on the sphere without the need to project into two dimensional space and the resulting distortion which is inevitable when working with a grid 3 1 3 spatial clustering results of the hbm using lgcp showed a slightly different pattern to either of the other models fitted to the gridded data this lgcp model showed more localised areas of high density with overall low density everywhere else again this was because animals were observed in clusters using the negative binomial likelihood as in both the gam and hbm using gridded data is an arbitrary fix for this grouping problem which smooths data within the grid but there is not a straightforward interpretation of how the negative binomial likelihood reflects overdispersion consequently if appropriate for the data and species being studied using bayesian modelling with the lgcp provides the best advantage because it does not smooth out patchy areas however porpoise is a highly mobile species and performing the same survey on a different day would likely give different results especially because the animals distribution is related strongly to environmental covariates which can change on timescales of minutes with repeated surveys the lgcp approach offers potential to differentiate between fine scale clustering caused by grouping of animals and large scale clustering caused by the underlying distribution pattern but it was not possible to investigate this here due to a lack of data from repeat surveys nonetheless the exercise based on survey data available produced a much clearer and more flexible approach than using the negative binomial likelihood but was not as straightforward to implement when using gams without several repeated surveys it is unclear if these very fine scale trends reflect the true distribution of porpoise a single survey of this type might be appropriate for sessile organisms but this appears to be modelling at a finer resolution than is realistic for data from a single survey of mobile organisms relatively low correlation was observed between predicted relative densities and observed data fig s6 a potential reason for this arises from a spatial mismatch between where surveys or sightings fell within the 5 5 km grid cell and the centre of the cell where predictions were calculated also models considered information from neighbouring cells when calculating predictions which could be increasing decreasing predictions and would not be reflected by survey data within a particular cell in terms of relating this to empirical observations of porpoise spatial clustering of animals in the field the situation is more complex for example in energetically active tidal flows there are linkages between porpoise presence and small scale heterogeneity amongst different environmental covariates e g tidal phase time of day and significant spatiotemporal variability in site use at scales of hundreds of metres and hours benjamins et al 2017 3 1 4 future developments inlabru inlabru org bachl et al 2019 the r package used here to implement hbm using inla yuan et al 2017b is still in development but aims to make these techniques more accessible to users and expand versatility inlabru makes it easier to use data from transects as well as actual locations of sightings using the lgcp method moreover because inlabru was motivated originally by the need to incorporate distance sampling with hbm it is possible to implement information relevant to sighting conditions and a detection function into modelling this was not used here as data analysed were strip transects in which the detection function was assumed to be uniform throughout the strip width however this could be a benefit for line transect surveys e g boat based surveys for marine mammals or birds where sighting conditions e g seastate visibility glare etc influence observations strongly given that models fitted with inlabru are bayesian the user can include prior information about parameters choosing appropriate priors is still an area of ongoing research and the penalised complexity pc prior approach discussed in simpson et al 2017 and sørbye et al 2019 aims at making prior choice transparent and user driven based on the distance and strength of spatial correlation default uninformative priors available in inlabru and r inla were used here but different approaches to prior choice should be assessed in the future 3 1 5 practicalities of use the increased computing time power statistical complexity and high end user capability of fitting models using hbm with inla combined with the fact that they are still under development by statisticians has meant that their uptake within the ecological community has been slow moreover these newer methods have limited user friendly documentation available especially regarding use of the inlabru package which may further hinder implementation norberg et al 2019 nonetheless compared to gams models incorporating inla methodology are more flexible and can assess additional complex relationships moreover hbms are capable of modelling complex spatio temporal data and patterns as well as modelling interspecific interactions and species characteristics e g joint species distribution modelling illian et al 2012 sadykova et al 2017 which is not straight forward in gams 3 2 management implications in terms of translating differences between gam vs hbm inla into applied real world scenarios and case studies this work has demonstrated that the loss of spatial detail in a traditional gam could have important implications for development of protected areas or mitigation during fine scale offshore operations such as pile driving drilling dredging etc for example any elevated fine scale clustering of porpoise at scales 1 km due to inter alia localised bathymetric features e g smith bank adjacent to low use areas could be overlooked with a gam which might misinform any fine scale designation of protected areas moreover relevant to this study for two offshore windfarms in the moray firth gams were used to assess porpoise distribution at a minimum 4 4 km spatial resolution brookes et al 2013 williamson et al 2016 which provided a quick overview of distribution or coarse estimates of relative density e g for initial impact assessment or analysis at the scale of national jurisdictions however if fine scale trends in animal distribution at the sub km resolution was required to develop a plan of where to place the individual moray firth turbines then lgcp analysis could have disentangled relationships between chance and feature related clustering this study has demonstrated that modelling gridded data using a gam and the negative binomial distribution highlighted two areas of high density within the moray firth scotland modelling the same gridded data using hbm inla also with a negative binomial distribution highlighted the same two areas with an additional third area along the east coast that was not apparent when using gams using hbm inla this time with the lgcp which takes spatial clustering of animals into account showed that the smith bank had the area of highest relative density consequently we conclude that there are three parts of the study area which host higher relative densities of harbour porpoise one of which is missed by gams 4 author contributions lw kb and bs conceived the study kb collected data pm provided satellite data lw jbi and ml performed modelling lw bs and vlgt led the writing of the manuscript all authors contributed critically to drafts and gave final approval for publication declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank colleagues at the university of aberdeen moray first marine neri hi def aerial surveying ltd and ravenair for essential support in the field particularly tim barton bill ruck rasmus nielson and dave rutter l d w was supported by the marine alliance for science and technology for scotland masts the university of aberdeen and marine scotland science collaboration between the university of aberdeen and marine scotland was supported by the marine collaboration research forum marcrf digital aerial surveys in 2010 were funded by moray offshore renewables ltd and 2014 by marine scotland additional funding for analysis of the combined datasets was provided by marine scotland collaboration between the university of aberdeen and marine scotland was supported by marcrf supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110011 appendix supplementary materials image application 1 
24406,species distribution models sdms are used regularly to develop management strategies but many modelling methods ignore the spatial nature of data to address this we compared fine scale spatial distribution predictions of harbour porpoise phocoena phocoena using empirical aerial video survey data collected along the east coast of scotland in august and september 2010 and 2014 incorporating environmental covariates that cover habitat preferences and prey proxies we used a traditional and commonly implemented generalized additive model gam and two hierarchical bayesian modelling hbm approaches using integrated nested laplace approximation inla model fitting methodology one hbm inla modelled gridded space similar to the gam and the other dealt more explicitly in continuous space using a log gaussian cox process lgcp overall predicted distributions in the three models were similar however hbms had twice the level of certainty showed much finer scale patterns in porpoise distribution and identified some areas of high relative density that were not apparent in the gam spatial differences were due to how the two methods accounted for autocorrelation spatial clustering of animals and differences between modelling in discrete vs continuous space consequently methods for spatial analyses likely depend on scale at which results and certainty are needed for large scale analysis 5 10 km resolution e g initial impact assessment there was little difference between results however insights into fine scale 1 km distribution of porpoise from the hbm model using lgcp while more computationally costly offered potential benefits for refining conservation management or mitigation measures within offshore developments or protected areas keywords bayesian model generalized additive model gam integrated nested laplace approximation inla harbour porpoise species distribution model abbreviations gam generalized additive model inla integrated nested laplace approximation lgcp log gaussian cox process hbm hierarchical bayesian model 1 introduction understanding environmental and anthropogenic drivers of species distributions is critical for identification of potential areas for protection development of appropriate conservation management strategies and mitigation of negative anthropogenic impacts collection of empirical environmental data however can be risky costly and time consuming consequently desk based species distribution modelling provides a cost effective yet successful alternative method to address these factors e g bailey and thompson 2010 norberg et al 2019 many statistical techniques are used to model species distributions but due to inherent complexity of analysing space most do not fully address the spatial nature of data generalised additive models gams hastie and tibshirani 1990 are one of the most commonly used and well established methods of performing species distribution modelling becker et al 2020 redfern et al 2006 wood 2006 over the past decade there has been rapid development of specific statistical methodologies aiming to address the spatial nature of empirical data e g cameletti et al 2012 diggle et al 2013 illian et al 2008 law et al 2009 sadykova et al 2017 however such methods are complex and require a high level of statistical expertise and computational power practitioners are therefore often faced with a choice of which model to apply to their data which can have considerable impacts on outputs norberg et al 2019 the development of point process models in ecological contexts soriano redondo et al 2019 yuan et al 2017a by using exact locations of points in space within a gam function are being explored by some studies fithian and hastie 2013 miller et al 2019 renner et al 2015 these use an inhomogeneous poisson process maximum entropy or infinitely weighted logistic regression to model data in a point process framework thereby taking advantage of the spatial information however at the time of the production of this study these techniques were still under development for generalist use and were therefore not explored further here the aim of this study was to assess differences between use of traditional frequentist gams and explicit spatial modelling approaches using hierarchical bayesian models hbm fitted with integrated nested laplace approximation inla rue et al 2009 to achieve this we introduce the two methods gam and hbm inla and identify three areas in which bayesian developments offer potential benefits over traditional gams 1 they account for spatial autocorrelation 2 clustering of animals and 3 model in continuous space we then implement both methods using an example of real world aerial video survey data for harbour porpoise phocoena phocoena finally we explore differences in resulting spatial predictions of porpoise distribution and conservation management implications 1 1 two approaches to species distribution modelling 1 1 1 generalized additive models generalized additive models are popular for species distribution modelling because of their ability to encapsulate non linear interactions between sightings and environmental covariates through use of smoothing functions e g booth et al 2013 embling et al 2010 williamson et al 2016 however their ability to capture spatial trends is limited without use of alternative more complex additions fithian and hastie 2013 miller et al 2019 renner et al 2015 scott hayward et al 2014 nonetheless gams are relatively easy to implement by the user through various r libraries such as mgcv wood 2011 or similar counts y in a grid cell si i 1 n are modelled response variable and the model usually assumes that counts in each grid cell follow a poisson distribution the expected value in a grid cell si is modelled as a linear model of covariates x i e 1 g y s i x s i t β β 0 where g is a log link function x si t is a matrix of n observations on each of the k explanatory variables and β is a vector of regression coefficients the gam formulation in eq 1 does not address the problem of spatial autocorrelation instead accounting for trends in data across larger geographical distances dormann et al 2007 one common method for circumventing this problem is to include a bivariate smoothing term of latitude and longitude or a soap film smoother wood et al 2008 in the gam itself soap film x y smoothers also include boundary information to prevent the model from predicting animals presence in areas they are not capable of occupying wood et al 2008 e g porpoises present on land an x y smoother accounts for similarity of the response variable in adjacent cells reducing the effect but not the amount of spatial autocorrelation the spatial autocorrelation problem is solved by using more complex methods such as including autocorrelation structures in a generalized additive mixed effects model carvalho et al 2020 1 1 2 hierarchical bayesian modelling using inla recent developments in spatial statistical methodology have focused on producing a flexible computationally efficient approach that is increasingly accessible to end users here we used a continuously indexed gauss markov random field based on the stochastic partial differential equation spde lindgren et al 2011 this provides an approximation to a continuous spatial field that allows users to work efficiently with complex spatially explicit models blangiardo et al 2013 in addition models were fitted based on inla rue et al 2009 a recently developed computationally efficient method for hierarchical bayesian inference that is particularly suitable for complex spatial models such as those based on the spde approach combining the two methods spde and inla provides a suite of flexible models that allow for realistic spatial modelling within feasible computation timescales as in the gam model counts y in a grid cell si i 1 n are modelled but a bayesian approach is used and spatial autocorrelation is modelled by a random field ξ i e 2 g y s i x s i t β β 0 ξ s i where g is a log link function and β is a vector of regression coefficients in this hbm formula the residual spatial autocorrelation is modelled explicitly by including the ξ term which specifies a spatial or spatio temporal random field rue and held 2005 this framework allows for smooth and nonlinear effects of covariates time trends seasonal effects random intercepts and slopes and spatio temporal random effects therefore this class of model is highly flexible and can accommodate a wide range of paradigms 1 2 discrete vs continuous space spatial data are usually gridded or segmented when using gams which causes spatial information to be lost however spatially explicit approaches such as spde inla can model in continuous space since this implies much less information loss spde inla approaches were expected to be more appropriate and capable of reflecting small scale spatial behaviour that cannot be captured by gridding or segmenting sightings consequently in this paper we made two comparisons we initially used both approaches gam and hbm to model data on the same spatial grid to establish how the approaches differed when the actual models were similar with the expectation of similar results we then moved towards modelling in continuous space using the spde inla approach that also allowed us to incorporate information on the exact location of transects as well as the spatial structure formed by the locations of individual animals i e their clustering yuan et al 2017b 1 3 spatial clustering of animals animals do not always move independently at times some species can form large groups in small areas for several reasons such as social cohesion or specific attraction to the location as a result of physical and or environmental covariates plants and animals are often clustered spatially according to a poisson process which inappropriately assumes complete spatial randomness between clusters to account for this a cox process møller and waagepetersen 2007 waagepetersen and schweder 2006 is a flexible type of spatial point procedure which improves accuracy by modelling spatial patterns relative to observed or unobserved spatial trends illian et al 2012 in this way the spatial pattern can be modelled along with traits of individual observations such as markings scars size or colour and environmental covariates illian et al 2012 since clustering violates poisson process assumptions this obliges the spde to capture low range peaks in detection rather than a large scale distribution trend an alternative and often implemented approach is to use the negative binomial distribution to account for overdispersion which means that the spde does not have to accommodate spikes to capture the large scale trend however while often used to avoid violation of model assumptions it does not explicitly model overdispersion moreover there is no obvious way of extending this to continuous space so analysis is restricted to using gridded bins when using hierarchical bayesian models localised clustering can be differentiated from large scale patterns using the log gaussian cox process lgcp method which models exact locations of points diggle et al 2013 the model assumes point locations are scattered independently in space as a poisson process top level of the hierarchy given a model of the point density formally the intensity of the process the middle level of the hierarchy and a set of priors for all model parameters bottom level of the hierarchy the log of intensity λ in a location s r is modelled as a linear model of covariates x and a random field ξ that is again approximated by an spde 3 l o g λ s t x s t β β 0 ξ s 1 4 case study harbour porpoise is the most numerous cetacean species in european atlantic shelf waters hammond et al 2021 which is also where most anthropogenic activities occur consequently they are threatened by inter alia unsustainable incidental catches in fishing gear and prey removal various forms of chemical and underwater noise pollution and other anthropogenic pressures e g culik 2004 hammond et al 2021 macleod et al 2007 knowledge of porpoise distribution in relation to environmental drivers is therefore critical for effective implementation of management and mitigation measures depth slope bottom temperature and sediment have been significant in previous models of porpoise distribution e g booth et al 2013 brookes et al 2013 sadykova et al 2017 williamson et al 2016 other variables included chlorophyll a net primary productivity and fronts and tidal mixing e g current speed vertical shear and potential energy anomaly to quantify stratification strength which cause prey aggregation and have been correlated previously with the distribution of fish and marine predators e g embling et al 2012 hofmann and powell 1998 olson and backus 1985 scott et al 2010 previous distribution modelling in the moray firth north east scotland part of the current study area fig 1 found a relatively high density of animals in the smith bank a shallow 30 40 m sand bank in the middle of the firth brookes et al 2013 williamson et al 2016 this is likely because the smith bank provides suitable habitat for sandeels ammodytidae and whiting merlangius merlangus hopkins 2011 two of the most common prey species for porpoise in this area santos and pierce 2003 knowledge of porpoise distribution along the east coast of scotland however is lacking consequently the present analysis combines previously collected aerial video survey data with a newer dataset which allowed us to investigate distribution along the entire east coast of scotland aerial video surveys use video cameras to record strip transects below the survey aircraft and are thus different to visual surveys by human observers buckland et al 2012 moreover video surveys provide a permanent record of sightings which can be beneficial for clarifying mis or ambiguous identifications anomalous results improving data transparency and audit indeed some regulatory authorities now require such a permanent record bsh 2013 estimates of relative density of porpoise modelled from video survey data have been found previously to correlate strongly with relative density estimated from visual surveys williamson et al 2016 1 5 aims the purpose of this study was to compare two modelling frameworks to investigate differences between results obtained from a spatial modelling technique hbm using inla and a gam which is used commonly by ecologists we illustrated differences between these methods in how they model spatial autocorrelation groups of individuals and discrete vs continuous space we performed this using a case study of aerial video transect survey data to analyse harbour porpoise distribution along the east coast of scotland and discussed the potential management implications of results 2 methods 2 1 case study data collection aerial digital video surveys covering a total of 5762 km were performed by hidef aerial surveying ltd in august and september 2010 and 2014 along the east coast of scotland fig 1 and table 1 video data were processed by qualified trained and experienced observers who extracted all non avian objects for identification by specialists at wwt consulting ltd resulting in a total of 303 individual porpoises observed 2 2 data preparation for gridded analysis once porpoise observations were extracted a 5 5 km grid matching previous marine mammal work jones et al 2015 was created which covered the entire survey area transect lines were intersected to the grid and the total length of transects and number of porpoises sighted within each grid cell was calculated depth on a raster grid of approximately 180 180 m and polygons of sediment type at a 1 250 000 scale were provided by seazone solutions ltd 2005a 2005b sediment types were classified using a folk triangle folk 1954 and expressed as the proportion of sediment that was sand or gravelly sand within each grid cell based on previous studies of porpoise habitat association in this area brookes et al 2013 williamson et al 2016 seabed slope was calculated in degrees using the slope tool in esri arcgis 10 2 1 esri redlands california usa modelled environmental data were provided from runs of the nemo ersem 3d coupled hydrodynamic ecosystem model nucleus for european modelling of the ocean edwards et al 2012 madec 2008 o dea et al 2012 parameters available included bottom temperature ⁰c potential energy anomaly j m3 which is the energy required to mix the water column completely depth averaged current speed m s vertical velocity shear m s depth averaged vertical velocity m day depth integrated net primary production tons day and maximum chlorophyll a mgc m3 these data were available for the summer season july august september and october as climatological means across 25 years 1989 2014 at a 7 7 km spatial scale an estimate of stratification was calculated using the log10 of depth h divided by current speed u cubed log10 h u3 simpson et al 1981 in addition satellite data on a 1 1 km spatial scale were obtained from neodaas nerc earth observation data acquisition and analysis service and processed to derive ocean front metrics miller et al 2015 distance to the closest major ocean front km and front side whether a location is on the cold negative values or warm positive values side of the closest major front or directly on that front zero these satellite data were provided as weekly means during the survey period however due to cloud cover obscuring parts of the study area each week the mean in august and september of 2010 and 2014 were calculated and joined to the survey data from the corresponding year where surveys overlapped between the two years the mean of august and september in both years was used all environmental variables were up or down sampled depending on spatial resolution and joined to the 5 5 km grid for inclusion in the models variables were also standardised by subtracting the mean value the above variables were selected not necessarily because they were thought to influence porpoise distribution directly but often because they are thought to be drivers of the distribution of porpoise prey e g scott et al 2010 after inspection of histograms of the data cells with a vertical shear greater than 0 15 m s and a front side of 2 were removed as data outside these ranges were sparse 2 3 data preparation for lgcp analysis the same 5 5 km grid of environmental data was used for this analysis however number of sightings in each grid cell and length of survey effort in each cell were not joined to this grid instead the exact location of sightings as well as transect start and end points were used directly 2 4 gam analysis the first model was created using gam only cells in which surveys were performed e g survey effort 0 km were included during model development a 10 10 grid of points spaced evenly throughout the study region in which points that did not overlap with land were used for creation of the soap film smoother resulting in 27 internal knots fig s1 smoothers with more up to 30 30 and fewer 5 5 knots were also tested but not found to influence results models were tested with the maximum likelihood method using families such as negative binomial poisson and zero inflated poisson the negative binomial likelihood was selected for analysis after inspection of summary plots of models in every model an offset of the log of the area surveyed was included the area surveyed was calculated by multiplying the effort length surveyed in each cell in km by the strip width width of sea surface in view of the camera in km all environmental variables were tested for collinearity with each other and those with a correlation of 0 5 or greater were not included in the same models after initial investigation relationships between most covariates and sightings were found to be linear therefore for simplicity all covariates were treated as linear in the model except for the soap film smoother backwards selection was used to select the best model in which a full model was fitted which included all environmental covariates except the soap film smoother e g without the influence of space and then each environmental covariate was removed sequentially and the model re run this process was repeated consecutively using the model which had the lowest akaike information criterion aic akaike 1973 until there was no longer a decrease in aic when further covariates were removed an auto correlation function acf plot was used to check for temporal autocorrelation which was not found to exist therefore use of mixed models was not investigated the selected model was run with the soap film smoother and then used to predict relative density of porpoise in all cells within 10 km of the survey transects fig 2 a variogram was created to investigate if spatial autocorrelation was evident in the model diggle and ribeiro 2007 which was not found to be an issue fig s5 all analysis was performed in r version 3 2 4 and gams were modelled using the mgcv package wood 2011 2017 r code can be seen in appendix 1 and is available on github 2 5 hierarchical bayesian analysis using inla two models were created using hierarchical bayesian methods fitted using inla both models were fitted using the inlabru version 2 2 4 9000 and inla 20 03 17 packages in r version 3 4 1 bachl et al 2019 r core team 2017 rue et al 2009 the first model used the same gridded data that were used in the gam analysis with the addition of the spde to account for spatial autocorrelation lindgren et al 2011 the spde approach uses a matérn covariance function to approximate the gaussian field using a flexible stochastic model which provides a continuous relationship between the response and explanatory variables throughout the study area similar to the knots in the soap film smoother in gam the spde approach requires a triangulation mesh of the modelled area the mesh provides a lower bound on the spatial resolution for analysis therefore a mesh should be developed which is fine enough so that no further changes in the results can be observed when a finer mesh is used lindgren et al 2011 the triangulation mesh for the spde was created bounded by the coastline and the boundary of the study region and allowed to place vertices randomly as needed fig s2 default uninformative prior specification gaussian with mean of 0 and variance of 100 was used for all variables the same effort offset that was used in the gam was included here log of transect length strip width and again environmental covariates were treated as linear a negative binomial likelihood was selected to address clustering of the animals and to be able to compare more closely with the gam results model selection excluding the spde was performed in the same way as described for the gam however a widely applicable information criterion waic also known as watanabe aic watanabe 2010 was used instead of aic this selected model was run once more with the spde included and was then used to predict relative density throughout the study area fig 2 the second continuous space model created using hbm used the point process likelihood simpson et al 2016 which has been adapted to line transect surveys yuan et al 2017b this approach represents the locations of animal sightings as realisations of lgcp observed at the area covered by the transects as opposed to the gridded approach where data are aggregated the lgcp allows the locations of observations and transects to be used directly taking the actual transect locations into account allows us to distinguish between areas where we did not find any animals because no survey was performed in that location compared to those areas where we did not find anything but they were also surveyed this is especially useful when transects are not placed randomly throughout a study area information about the relative and absolute animal location is thereby retained which allows for a higher precision in estimating the relationship between covariates and density as well as the residual spatial correlation structure the lgcp model was created using the same set of covariates and the spde described above similarly backwards selection using waic was used based on the environmental covariates without the influence of space and once the best environmental variables were identified the spde was included and relative density was predicted throughout the study area r code used to create the hbm using inla and the lgcp can be seen in appendices 2 and 3 both hbms were also predicted onto the same grid used in the gam models to facilitate comparison between methods spearman s correlation coefficients were calculated between gam and hbm results moreover for visual comparison results of each model were divided by their maximum value to standardise and hbm results were then subtracted from gam results to investigate if gam or hbms predicted higher relative densities fig 4 3 results the negative binomial likelihood was selected for gam analysis after inspection of summary plots of the models fig s3 a negative binomial likelihood was also selected for the hbms using inla on gridded data for comparison to the gam the best models selected using each of the three methods included many of the same covariates table 2 however potential energy anomaly net primary productivity vertical shear and front distance were not retained in any of the best models this best gam model had a soap film smooth term that included latitude longitude and the boundaries of the study region to account for spatial autocorrelation spatial correlation was not included as a random effect in this model because a variogram of model results did not show any relationship with distance fig s5 this model predicted the highest relative density of porpoise on the smith bank and an area of high density along the southern coast of the moray firth this model explained 33 2 of deviance fig 2 and s4 hbm models used the spde approach to account for spatial autocorrelation when comparing the hbm of gridded data with the gam the same areas of highest density were apparent with an additional third area of high density along the east coast of scotland fig 2 in addition much finer scale clustering was apparent in the hbm results the predicted distribution of porpoise from the gam showed broad areas of high density this contrasted with the hbm on a grid particularly in the southern half of the study area where the area of high density was much more restricted than in the gam comparing the hbm using lgcp fig 2 with the gam we again saw much finer localised clustering with only the smith bank highlighted as a high density area this suggested that the model was identifying areas where animals were either found in groups or they used very fine scale areas 1 2 km which were not apparent in the gridded gam analysis maximum coefficients of variation for the models fitted using hbms were much lower than those created using gam gam cv 33 hbm gridded cv 8 hbm lgcp cv 11 fig 3 which showed higher confidence in the models the influence of environmental covariates on models can be seen in figs s4 s7 and s8 effects of environmental covariates were similar between the three models with the sign of each variable being the same even though the exact numbers varied table 2 the gam also had quite large areas with high coefficient of variation cv whereas both hbms had a maximum cv less than half that of the gam but also the highest areas of cv in the hbms were very localised and only at the edges of the study area in areas with very few data fig 3 correlation with gam results was higher for the hbm of gridded data spearman s ρ 0 76 than for the hbm using lgcp spearman s ρ 0 68 the gam consistently predicted higher relative porpoise density just south of the smith bank and both hbms predicted higher density on the smith bank and along the east coast fig 4 scatterplots were created to investigate how well predicted relative densities matched observed data number of sightings divided by the survey effort fig s6 correlation between these ranged between 0 09 and 0 51 3 1 discussion all three models had similar predicted distributions of porpoise fig 2 with important differences firstly compared to gams hbms particularly when using lgcp revealed more fine scale areas of porpoise higher relative density with an additional fine scale 5 km area that was not identified in gams secondly compared to gams hbm lgcp predicted a more realistic patchier porpoise distribution this trend was not apparent in the other two models which used the negative binomial distribution and gridded data which smoothed out the highest density areas finally the best models from each of these three techniques included tidal mixing and chlorophyll a while two models also included depth slope and vertical shear table 2 suggesting that these may be key drivers of porpoise distribution brookes et al 2013 embling et al 2012 sadykova et al 2017 scott et al 2010 williamson et al 2016 in terms of relating these model outputs to real porpoise ecology animals in the field tended to be observed singly or in small groups of 2 3 animals clustering observed in models can likely be explained in terms of animal use of fine scale environmental features that influenced prey availability table 2 e g scott et al 2010 williamson et al 2017 wider social factors such as cooperative hunting behaviour ortiz et al 2021 or simply porpoise group spacing on survey sampling days in terms of oceanography thermal fronts are fine scale transient features which aggregate fish hofmann and powell 1998 olson and backus 1985 and consequently have been related significantly to porpoise and other cetacean detections e g mendes et al 2002 philpott 2013 finally the scale at which modelling was performed may have influenced the impact importance of variables between models mod et al 2020 3 1 1 variability compared to gam variability for both hbms was less than half showing twice the level of certainty in the results some values of high cv in the gam were in areas where there were survey data whereas in the hbms areas of highest cv were restricted to the perimeter of the study area where there was no survey effort the gam predicted much larger areas 25 km of high density than hbms because the gam smoothed out some spatial trends by gridding the data and using the negative binomial distribution whereas the hbms took the spatiality explicit autocorrelation into account 3 1 2 discrete vs continuous space the continuous modelled data using the spde inla offered clear advantages because it eliminated information loss associated with data gridding as performed in traditional gams this is expected to be similar when segmenting data and can result in more accurate predictions of distribution both the hbm of gridded data analysed in continuous space and the hbm using lgcp which used exact locations of sightings and transects have smaller areas of high density 5 km with a patchier distribution in general the continuous representation and triangulation using the mesh provided a more flexible way of approximating a spatial area this becomes relevant both when the observation area is complex with a lack of data etc and if the study area represents a large area of the earth s surface and a fixed grid distorts special relationships in this case models can be defined on the sphere without the need to project into two dimensional space and the resulting distortion which is inevitable when working with a grid 3 1 3 spatial clustering results of the hbm using lgcp showed a slightly different pattern to either of the other models fitted to the gridded data this lgcp model showed more localised areas of high density with overall low density everywhere else again this was because animals were observed in clusters using the negative binomial likelihood as in both the gam and hbm using gridded data is an arbitrary fix for this grouping problem which smooths data within the grid but there is not a straightforward interpretation of how the negative binomial likelihood reflects overdispersion consequently if appropriate for the data and species being studied using bayesian modelling with the lgcp provides the best advantage because it does not smooth out patchy areas however porpoise is a highly mobile species and performing the same survey on a different day would likely give different results especially because the animals distribution is related strongly to environmental covariates which can change on timescales of minutes with repeated surveys the lgcp approach offers potential to differentiate between fine scale clustering caused by grouping of animals and large scale clustering caused by the underlying distribution pattern but it was not possible to investigate this here due to a lack of data from repeat surveys nonetheless the exercise based on survey data available produced a much clearer and more flexible approach than using the negative binomial likelihood but was not as straightforward to implement when using gams without several repeated surveys it is unclear if these very fine scale trends reflect the true distribution of porpoise a single survey of this type might be appropriate for sessile organisms but this appears to be modelling at a finer resolution than is realistic for data from a single survey of mobile organisms relatively low correlation was observed between predicted relative densities and observed data fig s6 a potential reason for this arises from a spatial mismatch between where surveys or sightings fell within the 5 5 km grid cell and the centre of the cell where predictions were calculated also models considered information from neighbouring cells when calculating predictions which could be increasing decreasing predictions and would not be reflected by survey data within a particular cell in terms of relating this to empirical observations of porpoise spatial clustering of animals in the field the situation is more complex for example in energetically active tidal flows there are linkages between porpoise presence and small scale heterogeneity amongst different environmental covariates e g tidal phase time of day and significant spatiotemporal variability in site use at scales of hundreds of metres and hours benjamins et al 2017 3 1 4 future developments inlabru inlabru org bachl et al 2019 the r package used here to implement hbm using inla yuan et al 2017b is still in development but aims to make these techniques more accessible to users and expand versatility inlabru makes it easier to use data from transects as well as actual locations of sightings using the lgcp method moreover because inlabru was motivated originally by the need to incorporate distance sampling with hbm it is possible to implement information relevant to sighting conditions and a detection function into modelling this was not used here as data analysed were strip transects in which the detection function was assumed to be uniform throughout the strip width however this could be a benefit for line transect surveys e g boat based surveys for marine mammals or birds where sighting conditions e g seastate visibility glare etc influence observations strongly given that models fitted with inlabru are bayesian the user can include prior information about parameters choosing appropriate priors is still an area of ongoing research and the penalised complexity pc prior approach discussed in simpson et al 2017 and sørbye et al 2019 aims at making prior choice transparent and user driven based on the distance and strength of spatial correlation default uninformative priors available in inlabru and r inla were used here but different approaches to prior choice should be assessed in the future 3 1 5 practicalities of use the increased computing time power statistical complexity and high end user capability of fitting models using hbm with inla combined with the fact that they are still under development by statisticians has meant that their uptake within the ecological community has been slow moreover these newer methods have limited user friendly documentation available especially regarding use of the inlabru package which may further hinder implementation norberg et al 2019 nonetheless compared to gams models incorporating inla methodology are more flexible and can assess additional complex relationships moreover hbms are capable of modelling complex spatio temporal data and patterns as well as modelling interspecific interactions and species characteristics e g joint species distribution modelling illian et al 2012 sadykova et al 2017 which is not straight forward in gams 3 2 management implications in terms of translating differences between gam vs hbm inla into applied real world scenarios and case studies this work has demonstrated that the loss of spatial detail in a traditional gam could have important implications for development of protected areas or mitigation during fine scale offshore operations such as pile driving drilling dredging etc for example any elevated fine scale clustering of porpoise at scales 1 km due to inter alia localised bathymetric features e g smith bank adjacent to low use areas could be overlooked with a gam which might misinform any fine scale designation of protected areas moreover relevant to this study for two offshore windfarms in the moray firth gams were used to assess porpoise distribution at a minimum 4 4 km spatial resolution brookes et al 2013 williamson et al 2016 which provided a quick overview of distribution or coarse estimates of relative density e g for initial impact assessment or analysis at the scale of national jurisdictions however if fine scale trends in animal distribution at the sub km resolution was required to develop a plan of where to place the individual moray firth turbines then lgcp analysis could have disentangled relationships between chance and feature related clustering this study has demonstrated that modelling gridded data using a gam and the negative binomial distribution highlighted two areas of high density within the moray firth scotland modelling the same gridded data using hbm inla also with a negative binomial distribution highlighted the same two areas with an additional third area along the east coast that was not apparent when using gams using hbm inla this time with the lgcp which takes spatial clustering of animals into account showed that the smith bank had the area of highest relative density consequently we conclude that there are three parts of the study area which host higher relative densities of harbour porpoise one of which is missed by gams 4 author contributions lw kb and bs conceived the study kb collected data pm provided satellite data lw jbi and ml performed modelling lw bs and vlgt led the writing of the manuscript all authors contributed critically to drafts and gave final approval for publication declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thank colleagues at the university of aberdeen moray first marine neri hi def aerial surveying ltd and ravenair for essential support in the field particularly tim barton bill ruck rasmus nielson and dave rutter l d w was supported by the marine alliance for science and technology for scotland masts the university of aberdeen and marine scotland science collaboration between the university of aberdeen and marine scotland was supported by the marine collaboration research forum marcrf digital aerial surveys in 2010 were funded by moray offshore renewables ltd and 2014 by marine scotland additional funding for analysis of the combined datasets was provided by marine scotland collaboration between the university of aberdeen and marine scotland was supported by marcrf supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 110011 appendix supplementary materials image application 1 
24407,fields studying animal movement are data starved due to large monetary and time costs of data collection and moreover not all quantities of interest can be measured despite limited data diverse models have been developed to study animal movement many of these models are based on random walks that use gaussian noise examinations of real movement data show that the assumptions made in these models are not always valid on all spatial and time scales and these shortcomings suggest that new models may be needed we provide methods for developing and training more realistic models specifically agent based models of animal movement by taking a data driven approach we took an exploratory data analysis eda approach that allowed us to develop a model that best reproduced the movement patterns we observed in a real dataset of animal locations in our eda we examined distributions of positions calculated the autocorrelation of the movement data used fourier analysis calculated mean squared displacements and tested for correlations we introduce the fused lasso regression analysis method for identifying large and sudden changes in position through a non parametric fit that is sensitive to discontinuities we introduce the copula and kernel density estimates as methods for approximating coordinate system independent movement correlations from the marginal location differences represented in our data set use of the copula allows us to create correlated non gaussian noise with the insights gained from our eda we created a langevin model that describes the movements of an individual animal features non gaussian noise and incorporates multiple movement patterns we extended this model to an agent based model that describes the movements of several groups of deer we compared our langevin model to three models built on different assumptions that result in substantial differences in the area covered by an animal using our agent based model we simulated three groups of deer with parameters sampled from our data to illustrate the amount of area covered by deer in our model and the ability of groups to overlap in space this overlapping behavior is an important feature of models of processes driven by interactions between animals such as infectious diseases our model could be useful for studying the spread of infectious diseases in animal populations such as chronic wasting disease while we have applied our data driven methods to animal movement these methods are widely applicable to developing and training models using a wide range of data sources graphical abstract keywords agent based modeling exploratory data analysis non gaussian noise fused lasso tracking data data driven modeling 1 introduction understanding how wildlife move and use the landscape has interested wildlife professionals since the inception of wildlife ecology and management leopold 1933 researchers have explored behaviors such as migration dingle and drake 2007 singh et al 2016 hooten et al 2018 resource use bestley et al 2008 manly et al 2007 johnson 1980 space use aarts et al 2008 anderson 1982 and risk avoidance shepard et al 2008 latham et al 2011 knowledge obtained from such research improves our ability to manage and conserve wildlife hooten et al 2017 quantifying movement behavior is aided by incorporating observations into mathematical models such as hidden markov models whoriskey et al 2017 langrock et al 2012 mckellar et al 2014 aimed at detecting behavior switching state space models jonsen et al 2003 2005 patterson et al 2008 used to correct measurement errors and identify behaviors and models of random walks on potential surfaces preisler et al 2013 michelot et al 2019 that attempt to tie movements to resource distributions as technology for collecting telemetry data advances higher quality data are becoming available such additional data provide insights into complex behavior that can be used to create more realistic models one way to bridge the gap between data generation and analysis is through exploratory data analysis eda tukey et al 1977 hartwig and dearing 1979 miles and huberman 1994 eda aids the development of more realistic models by enabling features of the data to be identified and allowing model assumptions to be checked eda methods are broad and vary with the application but many approaches including visualizing data exploring correlations and generating statistics can be applied to any domain the importance of checking model assumptions was highlighted in a series of papers that revealed that 16 out of 17 models claiming to provide evidence for lévy flights were incorrect edwards 2011 problems with the analyses included misinterpretation of data edwards et al 2007 the use of inaccurate fitting methods edwards 2008 and the assumption of a heavy tail without testing alternative hypotheses eda can mitigate these problems by allowing assumptions to be verified and by exposing model weaknesses we provide insight about the importance of eda and present a specific example of applying eda to model development using movement data and resource selection functions rsfs the rest of the paper is summarized in fig 1 and organized as follows in the next section we give an overview of eda and present our data and eda approach our analysis begins with visualizing and identifying features that we later either corrected for or incorporated into our models we then test for correlations between the movement data and rsfs next we present a machine learning technique to remove trends from our movement data the section is concluded by introducing copulas and kernel density estimates kdes that are used to construct bivariate distributions from the marginals in the following section we develop a langevin random walk model with non gaussian noise that models the movement of a single deer this model is then discretized to create a multiple deer agent based model abm of deer movement with parameters obtained from our movement data we compare our langevin model to three other random walk models to illustrate the importance of eda and its utility for model development finally we show the results of abm simulations of 15 deer in three groups to illustrate how parameters can be sampled from the data and to illustrate the distributions of areas covered we discuss group overlap patterns exhibited in our simulations studying such group overlap patterns could lead to a better understanding of disease spread 2 exploratory data analysis abms are a computational modeling technique for modeling the interactions and actions of discrete autonomous agents in a some cases a model is used to explore qualitative behavior for example the presence or absence of a tipping point is discovered in other cases we wish to compare predictions of an abm with observations perhaps tuning some of the abm s parameters to more closely align with those observations here we explore the inverse of this approach we use eda to suggest a model s rules and to provide empirical parameters for it as emphasized by tukey et al 1977 developing models in this order mitigates the introduction of biases in general we group eda into two steps the first step is to explore and adjust data quality rahm and do 2000 dasu and johnson 2003 this step can include data transformations e g logarithmic compression imputation smoothing noisy signals resampling on more convenient grids and data fitting in the second step patterns are sought in the cleaned data these patterns may appear as shapes of distributions summary statistics correlations or causal relations more complex patterns can be discovered using machine learning techniques that are capable of finding patterns that are difficult for humans to find central to all of these eda efforts is visualization visualization very clearly reveals patterns schwabish 2021 such as trends with line plots and correlations with scatter plots the functional forms of distributions are readily revealed and quantified with for example histograms violin plots and box and whisker plots high dimensional data can be viewed using parallel plots edsall 2003 itoh et al 2017 and or using dimensionality reduction techniques gisbrecht and hammer 2015 kaski and peltonen 2011 all of these analysis and visualization techniques are readily available in most programming languages such as in python s matplotlib hunter 2007 scikit learn pedregosa et al 2011 seaborn waskom 2021 and yellowbrick bengfort and bilbro 2019 libraries in what follows we will employ these eda steps to analyze a real dataset as we will see some eda results directly impact the choice of rules for an abm whereas other results provide insight and error detection without directly impacting model formulation 2 1 initial data analysis the first step in eda is initial data analysis ida which serves to clean and explore data without impacting model formation or attempting to answer questions the goals of ida are to remove bad data identify outliers expose inconsistencies perform transformations assess the relevance of data and begin visualizations to illustrate the ida process we begin with a specific dataset relevant to our goal of characterizing deer movement patterns we examine data from gps collared deer that were captured collared and monitored according to and with approval by state university of new york college of environmental science and forestry institutional animal care and use protocol no 2005 1 these data tracked the movements of 71 white tailed deer inhabiting central new york usa from 2008 to 2009 and have been published previously quinn 2010 williams et al 2014 the data collected on each deer consisted of location data in the form of gps locations and turn angles recorded for each deer in 5 h intervals together with the age and sex of each deer locations were recorded for between 8 and 600 days for each deer in this study the duration of data collection for each deer varied with the life span of the deer and of the gps collar battery with how long each collar remained on each deer and with mechanical error rsfs are also included in the dataset rsfs are models that yield values proportional to the probability that a unit of resource will be used boyce et al 2002 rsfs can be constructed using many methods boyce et al 2002 including methods that account for observed animal movements michelot et al 2019 the rsfs that we examined were created using a step selection method to assess resource selection by the collared deer in this study these rsfs have been described previously quinn 2010 https www proquest com docview 762785557 pq origsite gscholar fromopenview true six rsfs are included in the dataset corresponding to resource selection in three seasons for both males and females we began our eda of this dataset by visualizing the data fig 2 depicts a single deer s recorded gps locations in universal transverse mercator utm coordinates in a scatter plot showing spatial locations and in other plots showing utm coordinates over time note that although the collar is attached to a single deer it reflects that deer s individual behaviors and its interactions with other deer and the environment this trajectory shows that the deer spent time in two regions we refer to these regions as basins and we refer to jumps between basins as basin hops in the time series data for utm coordinates basins can be seen as relatively constant coordinate values at which the animal remained over a substantial period of time a basin hop is indicated by a sudden shift in at least one coordinate the number of basins visited varied for each deer in the dataset movement within basins and basin hopping behavior may reflect different behavioral states of an animal for example slow motion in a basin may indicate foraging while basin hops may indicate migration or dispersal patterson et al 2009 positions were recorded with non uniform time intervals and there were instances of missing entries due to gps collar malfunctions for later convenience the dataset was mapped onto a uniform grid with no missing entries a uniform grid with n g grid points was chosen based on the number of measurements in the dataset the value at each grid point was found by linearly interpolating between the closest points in the original dataset on either side of the chosen grid point after interpolating the movement data we examined the jumps j calculated as the distances between two adjacent recorded locations in fig 3 we show an example of a jump distribution which like the others closely resembles the zero mean laplace distribution 1 f j b 1 2 b e j b the parameter b characterizes the scale of the distribution and for n jumps has the maximum likelihood estimate 2 b ˆ 1 n i 0 n j i jump distributions are typically assumed to be gaussian or power law distributions whoriskey et al 2017 langrock et al 2012 mckellar et al 2014 jonsen et al 2003 2005 patterson et al 2008 preisler et al 2013 michelot et al 2019 edwards et al 2007 edwards 2008 2011 resulting in normal random walk or lévy flight models respectively a laplace distribution decays more slowly than a gaussian distribution allowing for larger jump sizes however laplace jumps are not as extreme as those of a lévy flight thus jump sizes allowed by laplace noise range between those predicted by a normal random walk model and those of a lévy flight model comparisons of maximum likelihood estimates for each type of distribution to the jump data are made in fig 3 which shows that a laplace distribution is superior to a gaussian without over predicting the tail as would a power law we used akaike s information criterion aic as a metric to compare gaussian and laplace models for all of our movement data as shown in fig 4 for each deer we treat utm easting and northing movement data separately and we compute aic scores for each using both the gaussian and laplace models each blue point corresponds to a single deer s interpolated utm easting aic scores and each orange point to its utm northing aic scores the difference between the aic for the gaussian model and the aic for the laplace model for each point is shown on the vertical axis and the gaussian aic for each point is shown on the horizontal axis the dashed gray line indicates where the vertical axis value is zero i e where both aic measurements are equal points lying above the gray line represent movement data for which a lower aic is obtained using a laplace distribution fit for all but two of these points the laplace fit had a lower aic both of our proposed fits had a single parameter which indicates that for all of our data points lying above the gray line the laplace distribution fit the corresponding movement data more accurately after visualizing and interpolating our data we treated the basin hopping trends we observed many eda methods and time series models assume that data are stationary and account for trends separately before further analysis the basin hopping trend needed to be removed one method for removing trends from animal movement data is to use a potential function preisler et al 2013 brillinger et al 2012 2002 whose gradient guides the motion of an animal these potentials can be used to construct potential surfaces which can be linked to the distribution of resources michelot et al 2019 the rsfs provided to us could possibly be used to generate a potential surface but they were created at a discrete spatial resolution which resulted in flat regions with sharp boundaries these discontinuities make it difficult to approximate the gradient of an rsf a smoothing transformation is necessary to accurately incorporate these rsfs into a model moreover such a discontinuous gradient can mask correlations between an animal s positions and an rsf using a gaussian filter we created smoothed maps fig 5 shows a comparison of the original and smoothed rsfs the large regions of constant values in the original map transition between each other much more gradually resulting in a smoother gradient 2 2 examining movement relative to the rsfs although our rsfs were not intended to inform animal movement but rather to inform seasonal habitat use and selection of resources given availability in the surrounding landscape dechen et al 2009 quinn 2010 fortin et al 2005 manly et al 2007 we investigated whether correlations between rsf values and deer locations and preferences for moving to relatively higher rsf values exist coincidentally the results for deer locations are shown in fig 6 and for deer movement are given in table 1 note that while there appear to be correlations between the rsfs and deer locations and movements they are not strong but are very sex dependent the reasons for this are unknown however there appear to be no correlations between our rsfs and movement steps as table 1 shows thus while aspects of the rsfs have potentially useful information the lack of a clear picture of the role of this data in describing deer movements led us not to incorporate this data into our model development 2 3 removing trends from non stationary time series data because the basin hopping trend was surprisingly uncorrelated with our rsf values we were unable to remove the basin hopping trend using these rsfs we then turned to regression analysis when a trend has a known functional form e g exponential growth or seasonality it can be fit and subtracted from the data in fig 2 we see that movement trends in the time series data for deer locations are functionally flat regions connected by discontinuities the fused lasso least absolute shrinkage and selection operator machine learning technique tibshirani et al 2005 allows us to automatically find such a function the fused lasso method aims to find a non parametric function θ that fits uniformly sampled time series data y where y is either of the utm coordinates because θ can take on any value at any point in its domain the fused lasso method first constrains the fit to be close to the data through minimizing θ y 2 2 θ i y i 2 letting 3 d 1 1 0 0 0 0 0 0 1 1 r n 1 n the regularizer λ d θ 1 λ θ i θ i 1 penalizes jumps in the fit θ by forcing the difference in adjacent points in θ to 0 notice that this regularizer has a different purpose than it would in cross validation the strength of the penalty is controlled by the hyperparameter λ 0 when λ 0 there is no penalty for jumps and the resulting fit θ is equal to the data as λ no jumps are allowed and θ will be the average of the data written mathematically the fused lasso method aims to minimize the relation 4 min θ r n y θ 2 2 λ d θ 1 for a given λ the quantity in eq 4 can be minimized using optimization software here we used cvxpy diamond and boyd 2016 agrawal et al 2018 next we consider how to choose a value for λ to choose the optimal λ we need to define the critical jump size defined as 5 j j 3 σ j that differentiates between a basin hop and random motion here j is the average jump size and σ j is the standard deviation of the jump sizes in a trajectory when optimizing λ we will compare the jumps in the data j y to jumps produced by the fits j θ with these definitions we define another loss function to be optimized this is done by finding the jumps in the data y and setting to zero the sizes of any jumps that are less than j this process results in jumps given by 6 j i y y i 1 y i y i 1 y i j 0 y i 1 y i j here the superscript indicates that the jump is calculated from data and the subscript enumerates the total number of jumps our objective is to find the value of λ b e s t corresponding to a fit that best reproduces j i y the optimization in eq 4 is solved for n values of λ λ 1 λ n and the jumps it produces 7 j i θ θ i 1 θ i are compared to j i y we select λ k and corresponding θ such that 8 j y j θ 2 2 i j i y j i θ 2 is minimized using synthetic data we illustrate how the fused lasso approach can be used to detect basin hops in fig 7 the left panel illustrates the threshold for basin hops which is set at the mean jump size plus three standard deviations the middle panel shows that the model with this choice of threshold correctly characterizes the largest jumps in the data as basin hops finally the right panel shows the fit orange line to the synthetic data blue dots and shows that this fit successfully captures the functional form of the trend to test the robustness of our fitting procedure we varied the number and sizes of basin hops and the amount of noise fig 8 shows this comparison in each row one parameter is varied while the other two are held constant we found that the fused lasso method reliably fits basin hopping in different regimes and we thus used this method to remove basin hopping trends from our data 2 4 statistical inference from stationary time series data beyond visualizing and detrending data many techniques can be used to mine useful information from time series data fu 2011 in this section we introduce two metrics that we used to analyze time series data autocorrelation functions and the mean squared displacement calculating autocorrelation functions generated insights about repetitive motion in our data though such motion was not a feature we had aimed to reproduce in our model an examination of mean squared displacements provided evidence for basins in our data and thus a rationale for including basins in our models 2 4 1 time autocorrelation function the first metric we explored was the time autocorrelation function acf acfs can be used in combination with fourier transforms for pattern discovery in time series data berberidis et al 2002 to reveal insights and test a model s assumptions dray et al 2010 the acf r measures how correlated a time series r t is with itself over a time lag for discrete location measurements the acf can be calculated for a lag k t t as 9 r k i 1 n k r i r r i k r i 1 n r i r 2 where r is the average position using the fourier transform 10 r ˆ ω r k e 2 π i k ω d k the acf can be decomposed into its component frequencies these frequencies measure the time scale of repetitive behavior in the time series the power r ˆ ω of each frequency ω can be calculated to determine the contribution of each frequency to the total acf in practice we evaluated a discrete fourier transform using the fast fourier transform algorithm for many deer we found that the acf of their positions primarily took the form of exponential decay with high and low frequency periodic signals superimposed fig 9 shows an example of the acf and corresponding power spectra which highlight the high and low frequencies in the movement data the high frequency peak corresponds to daily repetition in activity which is likely circadian in origin the low frequency peak consists of fewer power spectral data points and hence is not as statistically significant the method presented above assumed that the data were uniformly sampled alternative approaches such as those employing the lomb scargle periodogram péron et al 2016 vanderplas 2018 allow irregular data to be treated directly without interpolation however because interpolation was required for other methods used in this work we implemented the fast fourier transform method in our analysis 2 4 2 mean squared displacement the second metric we examined was the mean squared displacement msd the msd is defined as e r t r 0 2 the msd measures how far an animal moves on average and can be used to classify diffusion by the power by which the msd increases versus time in fig 10 we examined the msd of our stationary within basin movement and non stationary basin hopping data in the non stationary data there was no clear relationship between time and the msd in addition basin hops caused large shifts in the msd after removing the basin hopping trend the msd was constant in time as expected a constant msd results when an animal remains in one region for example the msd is approximately constant if an animal remains in a basin 2 5 recovering correlations in position data the above eda explored our data in each coordinate separately in doing so we assumed that the data in each coordinate were independent and imposed an importance on the coordinate system that our data happened to be measured in for example by rotating the coordinates such that a basin hop is perpendicular to one axis a trend that was observed in both coordinates before rotation would be observed in only one of the new rotated coordinates changing coordinates would affect our fused lasso regression analyses jump distributions and other metrics examined in our eda therefore it is important to ensure one coordinate system is used consistently one way to remove the assumption of independence between coordinates is through correlated random walks johnson et al 2008 however these models assume that the resulting bivariate jump distribution is normally distributed something we did not observe in our data to preserve correlations in the data and to avoid imposing a form on the jump distributions that we pick we used two methods to estimate bivariate distributions from the data directly copulas and kdes copulas allow us to generate a bivariate distribution from the marginal distributions which we know well from our stationary data jumps in the trends do not follow an obvious distribution so we use kdes to approximate these instead 2 5 1 copulas animal locations are often recorded in arbitrary coordinates that are useful for modelers there is no reason to assume that motion in these directions should be independent therefore any distributions stemming from data in these coordinates should be bivariate to account for correlations when the marginal distributions are well known copulas provide a way to estimate a bivariate distribution while preserving the observed marginals a copula c is a function that joins a multivariate distribution function f u v u v to its one dimensional marginals f u u f v v takeuchi 2010 through the relation 11 f u v u v c f u u f v v using copulas one can construct a joint distribution of two variables while knowing only the individual marginal distributions trivedi and zimmer 2007 thus we can estimate the bivariate jump distribution for our data from the one dimensional distributions we observed copulas have been used in ecological studies to accommodate under reporting in wildlife vehicle crash data zou et al 2019 to approximate joint space use among animals french et al 2019 and to describe distributions of multiple species of animals anderson et al 2019 mappings from the marginals to the joint distribution function are not unique a c must be chosen for each application while there are many options for creating copulas takeuchi 2010 for convenience we employed the gaussian copula by allowing c to be a multivariate gaussian to model jumps in our stationary data data with trends removed in fig 11 we graphically show an example of the procedure we employed to generate a bivariate jump distribution using a copula first for each individual deer we identified jumps in their separate utm coordinates we considered only jumps that happened simultaneously in both coordinates and we treated jumps that happened simultaneously in both coordinates as single two dimensional data points the resulting two dimensional distribution of within basin jump data was fit with a zero mean bivariate gaussian distribution as shown in the upper left panel of fig 11 the marginals of these data are also shown in the upper left panel of fig 11 this bivariate gaussian distribution was then sampled for illustration purposes the resulting data together with their associated marginals are shown in the upper right panel of fig 11 the correlations from our data in the upper left panel are preserved here but the marginals which were laplace distributions in the upper left are gaussian distributions in the upper right using the probability integral transformation the data from the bivariate gaussian distribution were transformed to have uniform distributions while retaining correlations the resulting uniform bivariate distribution shown in lower left panel of fig 11 is the copula of the two jump coordinate variables of the fitted bivariate distribution shown in the upper right panel of fig 11 finally the copula was used together with the observed laplace distributed marginals to create a non gaussian bivariate jump distribution with marginal distributions that were constructed from our data this bivariate jump distribution is correlated has marginals that match our data and can be sampled efficiently 2 5 2 kernel density estimates the power of copulas comes from their ability to constrain the marginal distributions of an approximate bivariate distribution by exploiting known marginal distributions when known marginal distributions are unavailable a kde can be used to estimate a multivariate distribution f ˆ kdes have been used in animal ecology studies in methods for estimating home ranges for animals worton 1989 seaman and powell 1996 to construct a kde we consider a probability density kernel k over each observed point x and create a weighted average of the distances between the current observed point and all other points in the dataset x i through 12 f ˆ x 1 n h 2 i 1 n k x x i h here h is a smoothing parameter that controls how closely the output resembles the kernel used in our application each x is a two dimensional point that describes the size of a basin hop in each coordinate we used kdes to estimate the bivariate jump distribution of the trends removed from our movement data first we identified the jumps in the trend in some cases the jumps were not aligned in the separate coordinates and a smoothing procedure was therefore used to correct for slight misalignments within the data we approximated the bivariate jump distribution of the trend using a gaussian kde with h δ r 4 m where δ r is the average distance between points this value of h was chosen to yield a smooth distribution function without losing details present in the original dataset in summary throughout our eda we explored many aspects of our data to illuminate features that then guided the selection of the form of our model visualizing our data informed us of the basin hopping features in our data and demonstrated that jumps in the data are not normally distributed we found that correlations between our movement data and our rsfs are weak and we have thus excluded rsf data from our model when examining the msds of our data we found additional evidence of basins in which deer locations were constrained using these findings in the next section we propose a model that can reproduce the features of the data revealed in our eda 3 modeling as part of the process of constructing an abm we first developed a mathematical model of a single deer s movement that was consistent with our eda this model was then discretized to form the basis of our abm this intermediate step of generating a model for an individual deer s movements before formulating an abm allows us to exploit the eda performed above our eda results suggest that a stochastic drift i e basin hopping non gaussian random walk model would capture important features of our data well hence we chose to develop a model of this form as our single animal movement model our starting point was the usual langevin equation which is usually written in terms of particle velocities as 13 d v d t γ v t ψ t our modification of the langevin model constructs a random process directly from the data using a copula to approximate a bivariate distribution of jumps this results in a correlated random walk model with non gaussian noise moreover we include basins in our model through the use of a harmonic potential to constrain deer within a region to simulate the basin hopping trend basins move according to a poisson process this choice will be discussed in the subsection below while our langevin model is applied to a single animal and misses the effects of heterogeneity these effects can be incorporated into an abm extension of the langevin model an abm can model multiple individuals with different ages and sexes and can integrate other data streams such as knowledge of the locations of bodies of water and impenetrable objects additionally other features such as a disease model are readily incorporated into an abm to study disease transmission without the need to rederive the movement model our goal is for our abm to serve as a foundational framework into which additional wildlife models can be incorporated such a model will facilitate the study of wildlife phenomena in which movement plays an important underlying role in the next two subsections we describe the formulation of our langevin model and then its extension to an abm 3 1 single animal langevin dynamics on a potential energy surface we develop the stationary and non stationary components of our langevin model of a single animal s movements separately we will first discuss the stationary portion of our langevin model consider a single tagged animal at a position x y and moving in a two dimensional space the lack of a trend in the msd data suggests that deer remain localized in a basin with center c x c y that acts as a potential energy surface which we model as 14 u x c x 2 a x y c y 2 a y where a x and a y describe the widths of the basin the stationary movement within the basin is modeled by 15 d x d y 2 γ x a x 0 0 γ y a y 1 x c x y c y d t λ x x γ x λ x y γ x λ y x γ y λ y y γ y d ψ x d ψ y which is analogous to a harmonically trapped particle obeying the langevin equation uhlenbeck and ornstein 1930 the first term is the gradient of eq 14 and models the effects of the basin and the second term contains all of the correlations and describes the random motion of an animal next we model the animal s non stationary basin hopping we assumed that basin hops were independent events that occurred at distinct random times and we calculated the average rate of basin hops from the data our assumptions are consistent with a poisson process thus we used a poisson process to model basin hopping behavior in a poisson process the inter arrival times t between k basin hops are described by an exponential distribution 16 p c moves at t k t e k t t where t is the total number of timesteps at which the movement of an animal is observed and k t is the average rate of basin hops the cumulative sum of the inter arrival times provides the times at which a basin moves instantaneously the sizes of the basin hops are sampled from a bivariate distribution constructed from the removed trends using a kde the stationary and non stationary components of our model are fit separately in order to fit the stationary component described by eq 15 we first need to remove the effects of the basin from our stationary data we do not know the basin s parameters a priori so we choose many possible sets of basin parameters that are then used to subtract the basin from our stationary data in practice we let c 1 x 2 λ x a x and c 1 y 2 λ y a y and perform a grid search over values for c 1 x and c 1 y once the basin is removed we fit a gaussian copula using the method described in section 2 5 1 to the resulting data to capture the parameters and random processes in eq 15 to determine the best set of c 1 x and c 1 y we run our model 10 times for each set of parameters and corresponding random process fit and we select the parameters that minimize the least squares differences in the variances and covariances of locations between the simulated location data and real location data to fit the parameters of the non stationary poisson process we set k to the number of critical jumps observed in a trajectory then t k is the ratio of the total number of timesteps to the number of critical jumps each of these parameters as well as the removed trends were stored for each deer using the method described in section 2 5 2 we construct a bivariate jump distribution from the removed trend with a gaussian kde from which we sample basin hops after fitting the parameters of our langevin model to all of our deer we simulated a trajectory by selecting a set of parameters for a single deer and the corresponding trend and then running our model an animal was given an initial position x 0 y 0 and the basin center c x c y was chosen the entire stationary component of the trajectory was simulated using 17 x t 1 y t 1 x t c 1 x x t c x k x y t c 1 y y t c y k y this equation is a discretized version of eq 15 here k represents a random number sampled from the bivariate jump distribution constructed using a gaussian copula after simulating the stationary component we simulated a trend this was done by sampling the times at which basin hops occur using eq 16 we then sampled the basin hop sizes from the kde constructed from the removed trend jumps i e the basin hops and added the simulated trend to the simulated stationary trajectory with this model we are able to simulate the trajectory of a deer with movements that follow patterns seen in the original dataset in the next subsection we extend this single animal model to a multiple animal abm 3 2 multiple group agent based model we began with a langevin model that treated a single deer at a time because the data that we have tracks individual deer however in practical applications we require models of multiple groups with population diversity moreover many environmental and social effects are implicitly contained in the harmonic potential used to constrain deer within a basin while we would prefer to incorporate these effects explicitly in our models our ability to do so is limited without additional data nonetheless to move towards a multiple animal simulation we assumed that a number of non tracked animals were together with the tracked animals in a basin and that these non tracked and tracked animals formed a group that underwent basin hops together here we provide a simplified description of our model for a full description following the odd protocol grimm et al 2020 see our supplement our abm consists of group designations collectives within the population and deer the simulation contains a number of groups each of which is initialized with a shared basin center a number of deer and a set of parameters and trends trained from a tracked deer based on their parameters groups determine when they will undergo a basin hop and how many basin hops they will undergo at every step of the simulation the deer in each group update their positions x y individually using eq 17 each group then determines whether the current timestep requires a basin hop if so the group samples a jump size from the kde fit to the trend data and moves the center of the basin along with its deer according to the sampled jump our abm can be used as a foundation for models that involve deer movement for example a disease or deer management model could be added to the abm to study additional phenomena while allowing for deer movement that is consistent with real movement data this will be the subject of future work 4 results one of our goals was to demonstrate the importance of eda in developing models we compare our langevin single deer model data and basin hopping dbh with three other models that use different assumptions the first two single deer models are random walk models without basin hopping one with gaussian noise gaussian random walk grw and the other with non gaussian noise constructed from the location data via a copula data and random walk drw these models ignore trends in the data such models might be selected if the data were not visualized and the basin hops were not observed the third model incorporates basin hopping and employed gaussian noise gaussian and basin hopping gbh these models are not an exhaustive list of alternatives but they illuminate how assumptions made about trends and types of noise can affect the accuracy of movement models we additionally present example results from our multiple deer abm that display how groups of deer can come into contact the models compared to our langevin model were fit using methods similar to those used for our langevin model for models without basin hopping a zero mean gaussian distribution was fit to the bivariate jump distribution constructed from the non stationary data the grw model sampled this fit directly while the drw model passed the same jumps through a gaussian copula to simulate a deer s jumps models with basin hops fit a gaussian distribution to the bivariate jump distribution of the stationary data the gbh model sampled this fit directly but the dbh model passed the jumps through a gaussian copula so that its jumps were sampled from a gaussian copula based distribution both the gbh and dbh models sampled a gaussian kde as described in section 3 to simulate a trend that was used for both models we compared the four individual deer models by training them on a single deer in our dataset and performing 100 simulations using each model both the grw and drw models appear to capture correlations in the location data as evidenced in fig 12 by the similarity of the orientations of the distributions to those of the data the basin hopping models produce very similar distributions in fig 13 because they share the same basin hopping trend in each of the 100 trials and this trend represents larger jumps than are seen with the underlying random motion next we further examined the differences between models that included jumps sampled from a gaussian distribution and those that included jumps sampled from a copula based distribution generated using a gaussian copula in fig 14 we show the counts of positions of a deer moving with gaussian distributed jumps within a basin reds superimposed on the counts of positions moving with copula based distributed jumps blues blues in fig 14 corresponding to positions moving with copula based distributed jumps are spread out over a larger area than reds in the figure corresponding to positions moving with gaussian distributed jumps i e the deer movements modeled using a copula based distribution covered a larger area than those modeled using gaussian distributed jumps to further illustrate how these two models differ from each other in fig 15 we show the logarithms of the magnitudes of the differences between these two sets of position counts the position counts generated from gaussian jumps reds in fig 14 are subtracted from the position counts generated from copula based jumps blues in fig 14 short distance movements are reflected in the center of fig 15 and the green color at the center of the figure indicates that far more short distance movements occur with copula based distributed jumps than with gaussian distributed jumps the yellow points away from the center of the figure indicate that occasional larger jumps are also more common among the copula based distributed jumps than among the gaussian distributed jumps intermediate distances shown as red points were less common among the copula based distributed jumps than among gaussian distributed ones after examining how different sets of assumptions affected the movement patterns of our langevin based model we ran our abm to explore the behaviors of multiple deer first to construct our multiple deer model we fit each deer s data to our langevin model creating distributions of parameters by sampling these distributions we created an abm of three groups each containing five deer in fig 16 each group s approximate density is outlined with contours in a unique color for each group with the initial center of the group marked with an x of the same color the blue group underwent a basin hop into the region occupied by the green group this is an example of a behavior that may have been missed using a model without basin hops in the context of disease management this behavior could allow for the transmission of a disease between two groups 5 conclusion we presented an eda approach as the starting point for model building that resulted in less biased models our approach was applied to a real dataset consisting of gps deer locations and rsfs the use of an eda provided a formal testing ground for exploring our data and testing model hypotheses for example we found weak correlations between our movement data and rsfs leading us not to incorporate our rsfs in the construction of our models it is possible that different rsfs perhaps constructed in a data driven way to account for observed animal movements michelot et al 2019 could aid the development of improved future models our initial eda identified important features of our movement data namely that there were disparate geographic regions in which animals spent time and that animals hopped between these regions we referred to these features as basins and basin hops respectively and our models would need to be able to reproduce them further exploration of the data revealed that jumps within these basins do not follow a gaussian distribution in our ida we identified the non stationary basin hopping trend that we attempted to remove from our data with the use of our rsfs when we found that the movement data and the rsfs were only weakly correlated we turned to the fused lasso machine learning method to remove trends from our data this method successfully and automatically detected trends in our data and was used to split our data into stationary and non stationary components beyond our initial data analysis we examined acfs and their fourier transforms which highlighted behaviors on multiple time scales we also calculated msds which provided additional evidence for the presence of basins that constrained deer movements we then used the insights gained from performing our eda to develop a model of deer movement we began with the intermediate step of building a model for a single animal and then extended this model to a multiple animal abm our eda results suggested that a random walk model that featured a copula based jump distribution would capture important features of our movement data additionally the model would require terms that constrain deer to a basin but allow for the basin to move intermittently we created such a model for a single deer and compared it with three other models that employed assumptions that could be made in the absence of eda we found large differences in the amount of area covered by deer in each model our single deer langevin model was expanded to a multiple deer abm that featured multiple groups of deer our abm was able to reproduce features of deer movement that our langevin model could not in particular our abm simulations occasionally revealed two deer groups moving into the same region the ability to model such phenomena can be important for modeling the spread of disease in future work we will extend our movement abm to model the spread of chronic wasting disease in white tailed deer this disease requires accurate modeling of movement and space use to understand its transmission and geographic spread credit authorship contribution statement david j butts writing original draft michael s murillo writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments funding and support was provided by the michigan department of natural resources united states of america the u s fish and wildlife service through the pittman robertson wildlife restoration act grant mi w 155 r the hal and jean glassen memorial foundation united states of america the college of agriculture and natural resources at michigan state university united states of america msu msu extension msu agbioresearch and the boone and crockett quantitative wildlife center united states of america at msu all authors conceived the ideas and designed the methodology all authors contributed critically to the drafts and gave final approval for publication appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 110001 appendix a supplementary data the following is the supplementary material related to this article mmc s1 our supplement contains a description of our model using the overview design concepts and details odd protocol 
24407,fields studying animal movement are data starved due to large monetary and time costs of data collection and moreover not all quantities of interest can be measured despite limited data diverse models have been developed to study animal movement many of these models are based on random walks that use gaussian noise examinations of real movement data show that the assumptions made in these models are not always valid on all spatial and time scales and these shortcomings suggest that new models may be needed we provide methods for developing and training more realistic models specifically agent based models of animal movement by taking a data driven approach we took an exploratory data analysis eda approach that allowed us to develop a model that best reproduced the movement patterns we observed in a real dataset of animal locations in our eda we examined distributions of positions calculated the autocorrelation of the movement data used fourier analysis calculated mean squared displacements and tested for correlations we introduce the fused lasso regression analysis method for identifying large and sudden changes in position through a non parametric fit that is sensitive to discontinuities we introduce the copula and kernel density estimates as methods for approximating coordinate system independent movement correlations from the marginal location differences represented in our data set use of the copula allows us to create correlated non gaussian noise with the insights gained from our eda we created a langevin model that describes the movements of an individual animal features non gaussian noise and incorporates multiple movement patterns we extended this model to an agent based model that describes the movements of several groups of deer we compared our langevin model to three models built on different assumptions that result in substantial differences in the area covered by an animal using our agent based model we simulated three groups of deer with parameters sampled from our data to illustrate the amount of area covered by deer in our model and the ability of groups to overlap in space this overlapping behavior is an important feature of models of processes driven by interactions between animals such as infectious diseases our model could be useful for studying the spread of infectious diseases in animal populations such as chronic wasting disease while we have applied our data driven methods to animal movement these methods are widely applicable to developing and training models using a wide range of data sources graphical abstract keywords agent based modeling exploratory data analysis non gaussian noise fused lasso tracking data data driven modeling 1 introduction understanding how wildlife move and use the landscape has interested wildlife professionals since the inception of wildlife ecology and management leopold 1933 researchers have explored behaviors such as migration dingle and drake 2007 singh et al 2016 hooten et al 2018 resource use bestley et al 2008 manly et al 2007 johnson 1980 space use aarts et al 2008 anderson 1982 and risk avoidance shepard et al 2008 latham et al 2011 knowledge obtained from such research improves our ability to manage and conserve wildlife hooten et al 2017 quantifying movement behavior is aided by incorporating observations into mathematical models such as hidden markov models whoriskey et al 2017 langrock et al 2012 mckellar et al 2014 aimed at detecting behavior switching state space models jonsen et al 2003 2005 patterson et al 2008 used to correct measurement errors and identify behaviors and models of random walks on potential surfaces preisler et al 2013 michelot et al 2019 that attempt to tie movements to resource distributions as technology for collecting telemetry data advances higher quality data are becoming available such additional data provide insights into complex behavior that can be used to create more realistic models one way to bridge the gap between data generation and analysis is through exploratory data analysis eda tukey et al 1977 hartwig and dearing 1979 miles and huberman 1994 eda aids the development of more realistic models by enabling features of the data to be identified and allowing model assumptions to be checked eda methods are broad and vary with the application but many approaches including visualizing data exploring correlations and generating statistics can be applied to any domain the importance of checking model assumptions was highlighted in a series of papers that revealed that 16 out of 17 models claiming to provide evidence for lévy flights were incorrect edwards 2011 problems with the analyses included misinterpretation of data edwards et al 2007 the use of inaccurate fitting methods edwards 2008 and the assumption of a heavy tail without testing alternative hypotheses eda can mitigate these problems by allowing assumptions to be verified and by exposing model weaknesses we provide insight about the importance of eda and present a specific example of applying eda to model development using movement data and resource selection functions rsfs the rest of the paper is summarized in fig 1 and organized as follows in the next section we give an overview of eda and present our data and eda approach our analysis begins with visualizing and identifying features that we later either corrected for or incorporated into our models we then test for correlations between the movement data and rsfs next we present a machine learning technique to remove trends from our movement data the section is concluded by introducing copulas and kernel density estimates kdes that are used to construct bivariate distributions from the marginals in the following section we develop a langevin random walk model with non gaussian noise that models the movement of a single deer this model is then discretized to create a multiple deer agent based model abm of deer movement with parameters obtained from our movement data we compare our langevin model to three other random walk models to illustrate the importance of eda and its utility for model development finally we show the results of abm simulations of 15 deer in three groups to illustrate how parameters can be sampled from the data and to illustrate the distributions of areas covered we discuss group overlap patterns exhibited in our simulations studying such group overlap patterns could lead to a better understanding of disease spread 2 exploratory data analysis abms are a computational modeling technique for modeling the interactions and actions of discrete autonomous agents in a some cases a model is used to explore qualitative behavior for example the presence or absence of a tipping point is discovered in other cases we wish to compare predictions of an abm with observations perhaps tuning some of the abm s parameters to more closely align with those observations here we explore the inverse of this approach we use eda to suggest a model s rules and to provide empirical parameters for it as emphasized by tukey et al 1977 developing models in this order mitigates the introduction of biases in general we group eda into two steps the first step is to explore and adjust data quality rahm and do 2000 dasu and johnson 2003 this step can include data transformations e g logarithmic compression imputation smoothing noisy signals resampling on more convenient grids and data fitting in the second step patterns are sought in the cleaned data these patterns may appear as shapes of distributions summary statistics correlations or causal relations more complex patterns can be discovered using machine learning techniques that are capable of finding patterns that are difficult for humans to find central to all of these eda efforts is visualization visualization very clearly reveals patterns schwabish 2021 such as trends with line plots and correlations with scatter plots the functional forms of distributions are readily revealed and quantified with for example histograms violin plots and box and whisker plots high dimensional data can be viewed using parallel plots edsall 2003 itoh et al 2017 and or using dimensionality reduction techniques gisbrecht and hammer 2015 kaski and peltonen 2011 all of these analysis and visualization techniques are readily available in most programming languages such as in python s matplotlib hunter 2007 scikit learn pedregosa et al 2011 seaborn waskom 2021 and yellowbrick bengfort and bilbro 2019 libraries in what follows we will employ these eda steps to analyze a real dataset as we will see some eda results directly impact the choice of rules for an abm whereas other results provide insight and error detection without directly impacting model formulation 2 1 initial data analysis the first step in eda is initial data analysis ida which serves to clean and explore data without impacting model formation or attempting to answer questions the goals of ida are to remove bad data identify outliers expose inconsistencies perform transformations assess the relevance of data and begin visualizations to illustrate the ida process we begin with a specific dataset relevant to our goal of characterizing deer movement patterns we examine data from gps collared deer that were captured collared and monitored according to and with approval by state university of new york college of environmental science and forestry institutional animal care and use protocol no 2005 1 these data tracked the movements of 71 white tailed deer inhabiting central new york usa from 2008 to 2009 and have been published previously quinn 2010 williams et al 2014 the data collected on each deer consisted of location data in the form of gps locations and turn angles recorded for each deer in 5 h intervals together with the age and sex of each deer locations were recorded for between 8 and 600 days for each deer in this study the duration of data collection for each deer varied with the life span of the deer and of the gps collar battery with how long each collar remained on each deer and with mechanical error rsfs are also included in the dataset rsfs are models that yield values proportional to the probability that a unit of resource will be used boyce et al 2002 rsfs can be constructed using many methods boyce et al 2002 including methods that account for observed animal movements michelot et al 2019 the rsfs that we examined were created using a step selection method to assess resource selection by the collared deer in this study these rsfs have been described previously quinn 2010 https www proquest com docview 762785557 pq origsite gscholar fromopenview true six rsfs are included in the dataset corresponding to resource selection in three seasons for both males and females we began our eda of this dataset by visualizing the data fig 2 depicts a single deer s recorded gps locations in universal transverse mercator utm coordinates in a scatter plot showing spatial locations and in other plots showing utm coordinates over time note that although the collar is attached to a single deer it reflects that deer s individual behaviors and its interactions with other deer and the environment this trajectory shows that the deer spent time in two regions we refer to these regions as basins and we refer to jumps between basins as basin hops in the time series data for utm coordinates basins can be seen as relatively constant coordinate values at which the animal remained over a substantial period of time a basin hop is indicated by a sudden shift in at least one coordinate the number of basins visited varied for each deer in the dataset movement within basins and basin hopping behavior may reflect different behavioral states of an animal for example slow motion in a basin may indicate foraging while basin hops may indicate migration or dispersal patterson et al 2009 positions were recorded with non uniform time intervals and there were instances of missing entries due to gps collar malfunctions for later convenience the dataset was mapped onto a uniform grid with no missing entries a uniform grid with n g grid points was chosen based on the number of measurements in the dataset the value at each grid point was found by linearly interpolating between the closest points in the original dataset on either side of the chosen grid point after interpolating the movement data we examined the jumps j calculated as the distances between two adjacent recorded locations in fig 3 we show an example of a jump distribution which like the others closely resembles the zero mean laplace distribution 1 f j b 1 2 b e j b the parameter b characterizes the scale of the distribution and for n jumps has the maximum likelihood estimate 2 b ˆ 1 n i 0 n j i jump distributions are typically assumed to be gaussian or power law distributions whoriskey et al 2017 langrock et al 2012 mckellar et al 2014 jonsen et al 2003 2005 patterson et al 2008 preisler et al 2013 michelot et al 2019 edwards et al 2007 edwards 2008 2011 resulting in normal random walk or lévy flight models respectively a laplace distribution decays more slowly than a gaussian distribution allowing for larger jump sizes however laplace jumps are not as extreme as those of a lévy flight thus jump sizes allowed by laplace noise range between those predicted by a normal random walk model and those of a lévy flight model comparisons of maximum likelihood estimates for each type of distribution to the jump data are made in fig 3 which shows that a laplace distribution is superior to a gaussian without over predicting the tail as would a power law we used akaike s information criterion aic as a metric to compare gaussian and laplace models for all of our movement data as shown in fig 4 for each deer we treat utm easting and northing movement data separately and we compute aic scores for each using both the gaussian and laplace models each blue point corresponds to a single deer s interpolated utm easting aic scores and each orange point to its utm northing aic scores the difference between the aic for the gaussian model and the aic for the laplace model for each point is shown on the vertical axis and the gaussian aic for each point is shown on the horizontal axis the dashed gray line indicates where the vertical axis value is zero i e where both aic measurements are equal points lying above the gray line represent movement data for which a lower aic is obtained using a laplace distribution fit for all but two of these points the laplace fit had a lower aic both of our proposed fits had a single parameter which indicates that for all of our data points lying above the gray line the laplace distribution fit the corresponding movement data more accurately after visualizing and interpolating our data we treated the basin hopping trends we observed many eda methods and time series models assume that data are stationary and account for trends separately before further analysis the basin hopping trend needed to be removed one method for removing trends from animal movement data is to use a potential function preisler et al 2013 brillinger et al 2012 2002 whose gradient guides the motion of an animal these potentials can be used to construct potential surfaces which can be linked to the distribution of resources michelot et al 2019 the rsfs provided to us could possibly be used to generate a potential surface but they were created at a discrete spatial resolution which resulted in flat regions with sharp boundaries these discontinuities make it difficult to approximate the gradient of an rsf a smoothing transformation is necessary to accurately incorporate these rsfs into a model moreover such a discontinuous gradient can mask correlations between an animal s positions and an rsf using a gaussian filter we created smoothed maps fig 5 shows a comparison of the original and smoothed rsfs the large regions of constant values in the original map transition between each other much more gradually resulting in a smoother gradient 2 2 examining movement relative to the rsfs although our rsfs were not intended to inform animal movement but rather to inform seasonal habitat use and selection of resources given availability in the surrounding landscape dechen et al 2009 quinn 2010 fortin et al 2005 manly et al 2007 we investigated whether correlations between rsf values and deer locations and preferences for moving to relatively higher rsf values exist coincidentally the results for deer locations are shown in fig 6 and for deer movement are given in table 1 note that while there appear to be correlations between the rsfs and deer locations and movements they are not strong but are very sex dependent the reasons for this are unknown however there appear to be no correlations between our rsfs and movement steps as table 1 shows thus while aspects of the rsfs have potentially useful information the lack of a clear picture of the role of this data in describing deer movements led us not to incorporate this data into our model development 2 3 removing trends from non stationary time series data because the basin hopping trend was surprisingly uncorrelated with our rsf values we were unable to remove the basin hopping trend using these rsfs we then turned to regression analysis when a trend has a known functional form e g exponential growth or seasonality it can be fit and subtracted from the data in fig 2 we see that movement trends in the time series data for deer locations are functionally flat regions connected by discontinuities the fused lasso least absolute shrinkage and selection operator machine learning technique tibshirani et al 2005 allows us to automatically find such a function the fused lasso method aims to find a non parametric function θ that fits uniformly sampled time series data y where y is either of the utm coordinates because θ can take on any value at any point in its domain the fused lasso method first constrains the fit to be close to the data through minimizing θ y 2 2 θ i y i 2 letting 3 d 1 1 0 0 0 0 0 0 1 1 r n 1 n the regularizer λ d θ 1 λ θ i θ i 1 penalizes jumps in the fit θ by forcing the difference in adjacent points in θ to 0 notice that this regularizer has a different purpose than it would in cross validation the strength of the penalty is controlled by the hyperparameter λ 0 when λ 0 there is no penalty for jumps and the resulting fit θ is equal to the data as λ no jumps are allowed and θ will be the average of the data written mathematically the fused lasso method aims to minimize the relation 4 min θ r n y θ 2 2 λ d θ 1 for a given λ the quantity in eq 4 can be minimized using optimization software here we used cvxpy diamond and boyd 2016 agrawal et al 2018 next we consider how to choose a value for λ to choose the optimal λ we need to define the critical jump size defined as 5 j j 3 σ j that differentiates between a basin hop and random motion here j is the average jump size and σ j is the standard deviation of the jump sizes in a trajectory when optimizing λ we will compare the jumps in the data j y to jumps produced by the fits j θ with these definitions we define another loss function to be optimized this is done by finding the jumps in the data y and setting to zero the sizes of any jumps that are less than j this process results in jumps given by 6 j i y y i 1 y i y i 1 y i j 0 y i 1 y i j here the superscript indicates that the jump is calculated from data and the subscript enumerates the total number of jumps our objective is to find the value of λ b e s t corresponding to a fit that best reproduces j i y the optimization in eq 4 is solved for n values of λ λ 1 λ n and the jumps it produces 7 j i θ θ i 1 θ i are compared to j i y we select λ k and corresponding θ such that 8 j y j θ 2 2 i j i y j i θ 2 is minimized using synthetic data we illustrate how the fused lasso approach can be used to detect basin hops in fig 7 the left panel illustrates the threshold for basin hops which is set at the mean jump size plus three standard deviations the middle panel shows that the model with this choice of threshold correctly characterizes the largest jumps in the data as basin hops finally the right panel shows the fit orange line to the synthetic data blue dots and shows that this fit successfully captures the functional form of the trend to test the robustness of our fitting procedure we varied the number and sizes of basin hops and the amount of noise fig 8 shows this comparison in each row one parameter is varied while the other two are held constant we found that the fused lasso method reliably fits basin hopping in different regimes and we thus used this method to remove basin hopping trends from our data 2 4 statistical inference from stationary time series data beyond visualizing and detrending data many techniques can be used to mine useful information from time series data fu 2011 in this section we introduce two metrics that we used to analyze time series data autocorrelation functions and the mean squared displacement calculating autocorrelation functions generated insights about repetitive motion in our data though such motion was not a feature we had aimed to reproduce in our model an examination of mean squared displacements provided evidence for basins in our data and thus a rationale for including basins in our models 2 4 1 time autocorrelation function the first metric we explored was the time autocorrelation function acf acfs can be used in combination with fourier transforms for pattern discovery in time series data berberidis et al 2002 to reveal insights and test a model s assumptions dray et al 2010 the acf r measures how correlated a time series r t is with itself over a time lag for discrete location measurements the acf can be calculated for a lag k t t as 9 r k i 1 n k r i r r i k r i 1 n r i r 2 where r is the average position using the fourier transform 10 r ˆ ω r k e 2 π i k ω d k the acf can be decomposed into its component frequencies these frequencies measure the time scale of repetitive behavior in the time series the power r ˆ ω of each frequency ω can be calculated to determine the contribution of each frequency to the total acf in practice we evaluated a discrete fourier transform using the fast fourier transform algorithm for many deer we found that the acf of their positions primarily took the form of exponential decay with high and low frequency periodic signals superimposed fig 9 shows an example of the acf and corresponding power spectra which highlight the high and low frequencies in the movement data the high frequency peak corresponds to daily repetition in activity which is likely circadian in origin the low frequency peak consists of fewer power spectral data points and hence is not as statistically significant the method presented above assumed that the data were uniformly sampled alternative approaches such as those employing the lomb scargle periodogram péron et al 2016 vanderplas 2018 allow irregular data to be treated directly without interpolation however because interpolation was required for other methods used in this work we implemented the fast fourier transform method in our analysis 2 4 2 mean squared displacement the second metric we examined was the mean squared displacement msd the msd is defined as e r t r 0 2 the msd measures how far an animal moves on average and can be used to classify diffusion by the power by which the msd increases versus time in fig 10 we examined the msd of our stationary within basin movement and non stationary basin hopping data in the non stationary data there was no clear relationship between time and the msd in addition basin hops caused large shifts in the msd after removing the basin hopping trend the msd was constant in time as expected a constant msd results when an animal remains in one region for example the msd is approximately constant if an animal remains in a basin 2 5 recovering correlations in position data the above eda explored our data in each coordinate separately in doing so we assumed that the data in each coordinate were independent and imposed an importance on the coordinate system that our data happened to be measured in for example by rotating the coordinates such that a basin hop is perpendicular to one axis a trend that was observed in both coordinates before rotation would be observed in only one of the new rotated coordinates changing coordinates would affect our fused lasso regression analyses jump distributions and other metrics examined in our eda therefore it is important to ensure one coordinate system is used consistently one way to remove the assumption of independence between coordinates is through correlated random walks johnson et al 2008 however these models assume that the resulting bivariate jump distribution is normally distributed something we did not observe in our data to preserve correlations in the data and to avoid imposing a form on the jump distributions that we pick we used two methods to estimate bivariate distributions from the data directly copulas and kdes copulas allow us to generate a bivariate distribution from the marginal distributions which we know well from our stationary data jumps in the trends do not follow an obvious distribution so we use kdes to approximate these instead 2 5 1 copulas animal locations are often recorded in arbitrary coordinates that are useful for modelers there is no reason to assume that motion in these directions should be independent therefore any distributions stemming from data in these coordinates should be bivariate to account for correlations when the marginal distributions are well known copulas provide a way to estimate a bivariate distribution while preserving the observed marginals a copula c is a function that joins a multivariate distribution function f u v u v to its one dimensional marginals f u u f v v takeuchi 2010 through the relation 11 f u v u v c f u u f v v using copulas one can construct a joint distribution of two variables while knowing only the individual marginal distributions trivedi and zimmer 2007 thus we can estimate the bivariate jump distribution for our data from the one dimensional distributions we observed copulas have been used in ecological studies to accommodate under reporting in wildlife vehicle crash data zou et al 2019 to approximate joint space use among animals french et al 2019 and to describe distributions of multiple species of animals anderson et al 2019 mappings from the marginals to the joint distribution function are not unique a c must be chosen for each application while there are many options for creating copulas takeuchi 2010 for convenience we employed the gaussian copula by allowing c to be a multivariate gaussian to model jumps in our stationary data data with trends removed in fig 11 we graphically show an example of the procedure we employed to generate a bivariate jump distribution using a copula first for each individual deer we identified jumps in their separate utm coordinates we considered only jumps that happened simultaneously in both coordinates and we treated jumps that happened simultaneously in both coordinates as single two dimensional data points the resulting two dimensional distribution of within basin jump data was fit with a zero mean bivariate gaussian distribution as shown in the upper left panel of fig 11 the marginals of these data are also shown in the upper left panel of fig 11 this bivariate gaussian distribution was then sampled for illustration purposes the resulting data together with their associated marginals are shown in the upper right panel of fig 11 the correlations from our data in the upper left panel are preserved here but the marginals which were laplace distributions in the upper left are gaussian distributions in the upper right using the probability integral transformation the data from the bivariate gaussian distribution were transformed to have uniform distributions while retaining correlations the resulting uniform bivariate distribution shown in lower left panel of fig 11 is the copula of the two jump coordinate variables of the fitted bivariate distribution shown in the upper right panel of fig 11 finally the copula was used together with the observed laplace distributed marginals to create a non gaussian bivariate jump distribution with marginal distributions that were constructed from our data this bivariate jump distribution is correlated has marginals that match our data and can be sampled efficiently 2 5 2 kernel density estimates the power of copulas comes from their ability to constrain the marginal distributions of an approximate bivariate distribution by exploiting known marginal distributions when known marginal distributions are unavailable a kde can be used to estimate a multivariate distribution f ˆ kdes have been used in animal ecology studies in methods for estimating home ranges for animals worton 1989 seaman and powell 1996 to construct a kde we consider a probability density kernel k over each observed point x and create a weighted average of the distances between the current observed point and all other points in the dataset x i through 12 f ˆ x 1 n h 2 i 1 n k x x i h here h is a smoothing parameter that controls how closely the output resembles the kernel used in our application each x is a two dimensional point that describes the size of a basin hop in each coordinate we used kdes to estimate the bivariate jump distribution of the trends removed from our movement data first we identified the jumps in the trend in some cases the jumps were not aligned in the separate coordinates and a smoothing procedure was therefore used to correct for slight misalignments within the data we approximated the bivariate jump distribution of the trend using a gaussian kde with h δ r 4 m where δ r is the average distance between points this value of h was chosen to yield a smooth distribution function without losing details present in the original dataset in summary throughout our eda we explored many aspects of our data to illuminate features that then guided the selection of the form of our model visualizing our data informed us of the basin hopping features in our data and demonstrated that jumps in the data are not normally distributed we found that correlations between our movement data and our rsfs are weak and we have thus excluded rsf data from our model when examining the msds of our data we found additional evidence of basins in which deer locations were constrained using these findings in the next section we propose a model that can reproduce the features of the data revealed in our eda 3 modeling as part of the process of constructing an abm we first developed a mathematical model of a single deer s movement that was consistent with our eda this model was then discretized to form the basis of our abm this intermediate step of generating a model for an individual deer s movements before formulating an abm allows us to exploit the eda performed above our eda results suggest that a stochastic drift i e basin hopping non gaussian random walk model would capture important features of our data well hence we chose to develop a model of this form as our single animal movement model our starting point was the usual langevin equation which is usually written in terms of particle velocities as 13 d v d t γ v t ψ t our modification of the langevin model constructs a random process directly from the data using a copula to approximate a bivariate distribution of jumps this results in a correlated random walk model with non gaussian noise moreover we include basins in our model through the use of a harmonic potential to constrain deer within a region to simulate the basin hopping trend basins move according to a poisson process this choice will be discussed in the subsection below while our langevin model is applied to a single animal and misses the effects of heterogeneity these effects can be incorporated into an abm extension of the langevin model an abm can model multiple individuals with different ages and sexes and can integrate other data streams such as knowledge of the locations of bodies of water and impenetrable objects additionally other features such as a disease model are readily incorporated into an abm to study disease transmission without the need to rederive the movement model our goal is for our abm to serve as a foundational framework into which additional wildlife models can be incorporated such a model will facilitate the study of wildlife phenomena in which movement plays an important underlying role in the next two subsections we describe the formulation of our langevin model and then its extension to an abm 3 1 single animal langevin dynamics on a potential energy surface we develop the stationary and non stationary components of our langevin model of a single animal s movements separately we will first discuss the stationary portion of our langevin model consider a single tagged animal at a position x y and moving in a two dimensional space the lack of a trend in the msd data suggests that deer remain localized in a basin with center c x c y that acts as a potential energy surface which we model as 14 u x c x 2 a x y c y 2 a y where a x and a y describe the widths of the basin the stationary movement within the basin is modeled by 15 d x d y 2 γ x a x 0 0 γ y a y 1 x c x y c y d t λ x x γ x λ x y γ x λ y x γ y λ y y γ y d ψ x d ψ y which is analogous to a harmonically trapped particle obeying the langevin equation uhlenbeck and ornstein 1930 the first term is the gradient of eq 14 and models the effects of the basin and the second term contains all of the correlations and describes the random motion of an animal next we model the animal s non stationary basin hopping we assumed that basin hops were independent events that occurred at distinct random times and we calculated the average rate of basin hops from the data our assumptions are consistent with a poisson process thus we used a poisson process to model basin hopping behavior in a poisson process the inter arrival times t between k basin hops are described by an exponential distribution 16 p c moves at t k t e k t t where t is the total number of timesteps at which the movement of an animal is observed and k t is the average rate of basin hops the cumulative sum of the inter arrival times provides the times at which a basin moves instantaneously the sizes of the basin hops are sampled from a bivariate distribution constructed from the removed trends using a kde the stationary and non stationary components of our model are fit separately in order to fit the stationary component described by eq 15 we first need to remove the effects of the basin from our stationary data we do not know the basin s parameters a priori so we choose many possible sets of basin parameters that are then used to subtract the basin from our stationary data in practice we let c 1 x 2 λ x a x and c 1 y 2 λ y a y and perform a grid search over values for c 1 x and c 1 y once the basin is removed we fit a gaussian copula using the method described in section 2 5 1 to the resulting data to capture the parameters and random processes in eq 15 to determine the best set of c 1 x and c 1 y we run our model 10 times for each set of parameters and corresponding random process fit and we select the parameters that minimize the least squares differences in the variances and covariances of locations between the simulated location data and real location data to fit the parameters of the non stationary poisson process we set k to the number of critical jumps observed in a trajectory then t k is the ratio of the total number of timesteps to the number of critical jumps each of these parameters as well as the removed trends were stored for each deer using the method described in section 2 5 2 we construct a bivariate jump distribution from the removed trend with a gaussian kde from which we sample basin hops after fitting the parameters of our langevin model to all of our deer we simulated a trajectory by selecting a set of parameters for a single deer and the corresponding trend and then running our model an animal was given an initial position x 0 y 0 and the basin center c x c y was chosen the entire stationary component of the trajectory was simulated using 17 x t 1 y t 1 x t c 1 x x t c x k x y t c 1 y y t c y k y this equation is a discretized version of eq 15 here k represents a random number sampled from the bivariate jump distribution constructed using a gaussian copula after simulating the stationary component we simulated a trend this was done by sampling the times at which basin hops occur using eq 16 we then sampled the basin hop sizes from the kde constructed from the removed trend jumps i e the basin hops and added the simulated trend to the simulated stationary trajectory with this model we are able to simulate the trajectory of a deer with movements that follow patterns seen in the original dataset in the next subsection we extend this single animal model to a multiple animal abm 3 2 multiple group agent based model we began with a langevin model that treated a single deer at a time because the data that we have tracks individual deer however in practical applications we require models of multiple groups with population diversity moreover many environmental and social effects are implicitly contained in the harmonic potential used to constrain deer within a basin while we would prefer to incorporate these effects explicitly in our models our ability to do so is limited without additional data nonetheless to move towards a multiple animal simulation we assumed that a number of non tracked animals were together with the tracked animals in a basin and that these non tracked and tracked animals formed a group that underwent basin hops together here we provide a simplified description of our model for a full description following the odd protocol grimm et al 2020 see our supplement our abm consists of group designations collectives within the population and deer the simulation contains a number of groups each of which is initialized with a shared basin center a number of deer and a set of parameters and trends trained from a tracked deer based on their parameters groups determine when they will undergo a basin hop and how many basin hops they will undergo at every step of the simulation the deer in each group update their positions x y individually using eq 17 each group then determines whether the current timestep requires a basin hop if so the group samples a jump size from the kde fit to the trend data and moves the center of the basin along with its deer according to the sampled jump our abm can be used as a foundation for models that involve deer movement for example a disease or deer management model could be added to the abm to study additional phenomena while allowing for deer movement that is consistent with real movement data this will be the subject of future work 4 results one of our goals was to demonstrate the importance of eda in developing models we compare our langevin single deer model data and basin hopping dbh with three other models that use different assumptions the first two single deer models are random walk models without basin hopping one with gaussian noise gaussian random walk grw and the other with non gaussian noise constructed from the location data via a copula data and random walk drw these models ignore trends in the data such models might be selected if the data were not visualized and the basin hops were not observed the third model incorporates basin hopping and employed gaussian noise gaussian and basin hopping gbh these models are not an exhaustive list of alternatives but they illuminate how assumptions made about trends and types of noise can affect the accuracy of movement models we additionally present example results from our multiple deer abm that display how groups of deer can come into contact the models compared to our langevin model were fit using methods similar to those used for our langevin model for models without basin hopping a zero mean gaussian distribution was fit to the bivariate jump distribution constructed from the non stationary data the grw model sampled this fit directly while the drw model passed the same jumps through a gaussian copula to simulate a deer s jumps models with basin hops fit a gaussian distribution to the bivariate jump distribution of the stationary data the gbh model sampled this fit directly but the dbh model passed the jumps through a gaussian copula so that its jumps were sampled from a gaussian copula based distribution both the gbh and dbh models sampled a gaussian kde as described in section 3 to simulate a trend that was used for both models we compared the four individual deer models by training them on a single deer in our dataset and performing 100 simulations using each model both the grw and drw models appear to capture correlations in the location data as evidenced in fig 12 by the similarity of the orientations of the distributions to those of the data the basin hopping models produce very similar distributions in fig 13 because they share the same basin hopping trend in each of the 100 trials and this trend represents larger jumps than are seen with the underlying random motion next we further examined the differences between models that included jumps sampled from a gaussian distribution and those that included jumps sampled from a copula based distribution generated using a gaussian copula in fig 14 we show the counts of positions of a deer moving with gaussian distributed jumps within a basin reds superimposed on the counts of positions moving with copula based distributed jumps blues blues in fig 14 corresponding to positions moving with copula based distributed jumps are spread out over a larger area than reds in the figure corresponding to positions moving with gaussian distributed jumps i e the deer movements modeled using a copula based distribution covered a larger area than those modeled using gaussian distributed jumps to further illustrate how these two models differ from each other in fig 15 we show the logarithms of the magnitudes of the differences between these two sets of position counts the position counts generated from gaussian jumps reds in fig 14 are subtracted from the position counts generated from copula based jumps blues in fig 14 short distance movements are reflected in the center of fig 15 and the green color at the center of the figure indicates that far more short distance movements occur with copula based distributed jumps than with gaussian distributed jumps the yellow points away from the center of the figure indicate that occasional larger jumps are also more common among the copula based distributed jumps than among the gaussian distributed jumps intermediate distances shown as red points were less common among the copula based distributed jumps than among gaussian distributed ones after examining how different sets of assumptions affected the movement patterns of our langevin based model we ran our abm to explore the behaviors of multiple deer first to construct our multiple deer model we fit each deer s data to our langevin model creating distributions of parameters by sampling these distributions we created an abm of three groups each containing five deer in fig 16 each group s approximate density is outlined with contours in a unique color for each group with the initial center of the group marked with an x of the same color the blue group underwent a basin hop into the region occupied by the green group this is an example of a behavior that may have been missed using a model without basin hops in the context of disease management this behavior could allow for the transmission of a disease between two groups 5 conclusion we presented an eda approach as the starting point for model building that resulted in less biased models our approach was applied to a real dataset consisting of gps deer locations and rsfs the use of an eda provided a formal testing ground for exploring our data and testing model hypotheses for example we found weak correlations between our movement data and rsfs leading us not to incorporate our rsfs in the construction of our models it is possible that different rsfs perhaps constructed in a data driven way to account for observed animal movements michelot et al 2019 could aid the development of improved future models our initial eda identified important features of our movement data namely that there were disparate geographic regions in which animals spent time and that animals hopped between these regions we referred to these features as basins and basin hops respectively and our models would need to be able to reproduce them further exploration of the data revealed that jumps within these basins do not follow a gaussian distribution in our ida we identified the non stationary basin hopping trend that we attempted to remove from our data with the use of our rsfs when we found that the movement data and the rsfs were only weakly correlated we turned to the fused lasso machine learning method to remove trends from our data this method successfully and automatically detected trends in our data and was used to split our data into stationary and non stationary components beyond our initial data analysis we examined acfs and their fourier transforms which highlighted behaviors on multiple time scales we also calculated msds which provided additional evidence for the presence of basins that constrained deer movements we then used the insights gained from performing our eda to develop a model of deer movement we began with the intermediate step of building a model for a single animal and then extended this model to a multiple animal abm our eda results suggested that a random walk model that featured a copula based jump distribution would capture important features of our movement data additionally the model would require terms that constrain deer to a basin but allow for the basin to move intermittently we created such a model for a single deer and compared it with three other models that employed assumptions that could be made in the absence of eda we found large differences in the amount of area covered by deer in each model our single deer langevin model was expanded to a multiple deer abm that featured multiple groups of deer our abm was able to reproduce features of deer movement that our langevin model could not in particular our abm simulations occasionally revealed two deer groups moving into the same region the ability to model such phenomena can be important for modeling the spread of disease in future work we will extend our movement abm to model the spread of chronic wasting disease in white tailed deer this disease requires accurate modeling of movement and space use to understand its transmission and geographic spread credit authorship contribution statement david j butts writing original draft michael s murillo writing original draft declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments funding and support was provided by the michigan department of natural resources united states of america the u s fish and wildlife service through the pittman robertson wildlife restoration act grant mi w 155 r the hal and jean glassen memorial foundation united states of america the college of agriculture and natural resources at michigan state university united states of america msu msu extension msu agbioresearch and the boone and crockett quantitative wildlife center united states of america at msu all authors conceived the ideas and designed the methodology all authors contributed critically to the drafts and gave final approval for publication appendix a supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 110001 appendix a supplementary data the following is the supplementary material related to this article mmc s1 our supplement contains a description of our model using the overview design concepts and details odd protocol 
24408,diadromous species are particularly vulnerable to climate change because they utilize both marine and freshwater habitat to complete their life cycles dispersal plays an important role in restraining the distribution of plant and animal species and is a key mechanism to allow diadromous species to adapt to changes in habitat suitability but it is often not included in species distribution models that explore population trends under climate scenarios the objective of this study was to develop a model to estimate potential shifts in diadromous populations in the atlantic area of europe under two climate change scenarios and multiple global climate models to address the question of range shift responses a hybrid approach for diadromous species distribution hydiad was developed that incorporated two components i statistical static models of habitat suitability describing the influence of environmental factors on species occurrence and ii biological processes relevant for the distribution of the species such as population demography and dispersal dynamics hybrid models were developed using a novel approach that incorporated both population and between catchment dispersal dynamics specific to each species occupancy data for diadromous species in a subset of atlantic area catchments were first validated by regional experts and boosted regression trees were applied to estimate habitat suitability within each catchment based on historical physical and climatic environmental predictors from the continental and marine domains habitat suitability was then used in a population dynamics model that incorporated between catchment dispersal and local population growth results for different sized catchments were compared using time series of spawner density and saturation rate which estimated how much of the available habitat was being utilized many of the species specific values used in hydiad were estimated through a survey of diadromous species experts and group consensus was reached by calculating weighted averages the hydiad model was applied to two shad species alosa alosa and a fallax to explore population trends projected annually from 1951 to 2100 projected trends indicated that under xxist century climate scenarios habitat suitability is expected to increase for a fallax but decrease for a alosa projected trends also indicated an increase in the rate of annual variability for a alosa particularly in the southern part of its range future studies can utilize the hydiad model to explore distribution trends for other diadromous species under climate change scenarios keywords diadromous species species distribution modeling dispersal allee effect habitat suitability climate change 1 introduction diadromous species that migrate between marine and freshwater habitats mcdowall 1988 are especially vulnerable to climate change due to their complex life cycle diadromous species experience the effects of changes in climate conditions in both domains and across different life stages robinson et al 2011 hare et al 2016 lin et al 2017 potentially through a latitudinal range shift in species distributions perry et al 2005 dambach and rödder 2011 it is challenging to develop a better understanding and accurate estimation of the potential effect of climate changes on diadromous species because they utilize both freshwater and marine habitat correlative species distribution models c sdms which are based on the generalized relationships between observed presences absences and abiotic environmental parameters guisan and zimmermann 2000 have been implemented for a large number of species to address the possible effect of climate change however c sdms do not take into account biological factors that are considered important for estimating species distributions such as population dynamics and dispersal capacity guisan and thuiller 2005 elith et al 2010 fordham et al 2013 melo merino et al 2020 on the other end of the spectrum mechanistic species distribution models m sdms explicitly account for these dynamics by incorporating how both abiotic and biological processes constrain the distribution and abundance of a species kearney and porter 2009 singer et al 2016 however m sdms require greater computer processing power and more detailed datasets to parameterize fordham et al 2018 and so have generally only been calibrated for well studied or commercially exploited species for which physiological or ecological constraints are known kearney and porter 2009 cheung et al 2010 rougier et al 2014 lotze et al 2019 developing m sdms for data poor diadromous species on a large spatial scale is problematic because large number of parameters to estimate with insufficient data can trigger high uncertainty a hybrid species distribution model h sdm approach could be classified as intermediate between correlative and mechanistic species distribution models in terms of both model complexity i e number of parameters and data requirements singer et al 2016 h sdms include two components i the correlation of species observations with abiotic environmental conditions and ii biological processes relevant for the distribution of the species such as population demography predator prey interactions and dispersal dynamics dormann et al 2012 singer et al 2018 different studies have shown that incorporating both of these components has led to an improvement in the estimates of species distributions and potential range shifts compared to only including abiotic environmental conditions latimer et al 2006 dormann et al 2012 fordham et al 2013 singer et al 2018 these hybrid models first determine the presences or absences of a species taking into account environmental conditions then biological factors thereby incorporating spatially explicit processes that act on both a coarser and finer spatial scale boulangeat et al 2012 regarding biological factors dispersal is a key mechanism driving the range shift response of aquatic organisms to climate change by increasing population resilience through metapopulation or source sink dynamics harrison 1991 hanski 1998 individuals within a population may return to spawn in the location where they originated homing or they may disperse to a non natal catchment to participate in reproduction straying quinn 1993 methodological and data limitations have resulted in many previous niche based modeling studies that assumed no dispersal or unlimited dispersal guisan and thuiller 2005 lassalle et al 2008b franklin 2010 holloway and miller 2017 but these two hypotheses overestimated either the range loss or the species dispersal abilities jaeschke et al 2013 these hypotheses are simple decision rules on whether a newly suitable environment is reachable or not at the population scale straying and source sink dynamics may provide a mechanism for recovery after poor year class recruitment or may be a way for diadromous species to face environmental changes such as habitat fragmentation and loss schtickzelle and quinn 2007 however this possible rescue effect i e emigrants from surrounding populations reduce the local extinction occurrence gotelli 1991 of strayers moving from source to sink populations may only persist when overall productivity is relatively high as suggested from simulated populations of atlantic salmon salmo salar bowlby and gibson 2019 another factor that may interact with dispersal in shaping species response to environmental changes is the allee effect stephens and sutherland 1999 this concept is defined as a positive relationship between population density and the per capita growth rate of a population previous studies have suggested that this effect can prevent recovery of marine fish populations at low abundances rougier et al 2012 hutchings 2014 kuparinen et al 2014 perälä and kuparinen 2017 and climate change is anticipated to strengthen these effects berec 2019 winter et al 2020 the primary objective of this study was to develop an original h sdm framework for diadromous species that incorporated dispersal and population dynamics coupled with a habitat suitability module based on environmental predictor variables from both marine and freshwater habitats this new modeling framework named hydiad for hybrid approach for diadromous species distribution could be utilized for various diadromous species despite differences in distributions and life history types these models were intended to improve upon the existing c sdms developed for european diadromous species by lassalle et al 2008b and lassalle and rochard 2009 which assumed unlimited dispersal i e all newly predicted suitable habitats were reachable and only included environmental predictor variables from the freshwater habitat hydiad was developed using the steps in the h sdm modeling framework outlined in singer et al 2018 for species with common life history strategies in continuous terrestrial environments as recommended by the previous authors knowledge gaps were identified and an expert elicitation procedure was designed to provide group based estimates of missing parameters for western european diadromous species the dispersal process in hydiad was developed taking into account spatial units i e here catchments compared to grid cells that were varying sizes and distances apart within a spatial matrix that included both the freshwater and oceanic domains the secondary objective was to apply hydiad to the two western european shads the allis shad alosa alosa and the twaite shad a fallax to project species distribution trends under multiple xxist climate models 2 material and methods hydiad was developed to simulate shifts in habitat suitability related to changes in environmental predictors dispersal processes and population dynamics that were specific to each species fig 1 hydiad was developed using the steps in the h sdm modeling framework outlined in singer et al 2018 for species with common life history strategies in continuous terrestrial environments the first step is the habitat modeling by correlating species occurrences with abiotic conditions section 2 2 the second step consists in inserting population dynamics processes accounting for both demography and dispersal with a strong emphasis put on reducing knowledge gaps section 2 3 the advantages of a hybrid approach was assessed by comparing outputs from the habitat model alone first step of the hydiad framework with outputs when biological processes were included in the hydiad framework second step fo the hydiad framework nonetheless the application of the singer et al 2018 generic method to diadromous species required several methodological developments that are fully presented below including i the use of a connectivity matrix to estimate distance between pairs of catchments based on shortest aquatic path ii the estimation of population dynamics parameters and dispersal kernel through an expert knowledge survey iii the estimation of among catchment dispersal dynamics iv the calculation of spawner abundance based on catchment size and species specific spawner density rather than probability of occupancy and vii the use of multiple global climate models gcms and representative concentration pathway rcp scenarios to project spawner abundance the source code was provided at https doi org 10 5281 zenodo 5973788 2 1 species of interest focus on dispersal metapopulations and allee effect the two shad species share similar life history strategies and ranges in the north eastern atlantic wilson and veneranta 2019 the historic range of these species on the atlantic coast extended from norway to morocco though a fallax has been reported as far north as iceland ices 2015 both species are anadromous and migrate into freshwater to spawn in the spring mcdowall 1988 shad populations especially those of a alosa have declined severely across europe over the past century aprahamian et al 2003 baglinière et al 2003 nachón et al 2016 due to a multitude of impacts along their migration routes acting at all life stages costa dias et al 2009 limburg and waldman 2009 while these shad species have the ability to travel long distances martin et al 2015 both species generally exhibit homing i e the return of fish to their natal river aprahamian et al 2003 jolly et al 2012 martin et al 2015 davies et al 2020 though short distance dispersal likely occurs between neighboring rivers with similar environmental conditions aprahamian et al 2003 jolly et al 2012 martin et al 2015 these localized exchanges might result in metapopulation dynamics with some rivers acting as sources and other as sinks randon et al 2017 interestingly rougier et al 2012 demonstrated for allis shad a likely demographic allee effect depensation in fish stock productivity when the abundance of spawners is low for the reference population in the core of its distribution range these complex dynamical processes possibly at play for the two shad species are crucial to consider when simulating species spatial responses to climate change 2 2 correlative species distribution model c sdm c sdm were built and run to relate both the physical characteristics and environmental predictor variables of river catchments to the recorded presences and absences of each species within the equivalent time period c sdm were then used for projecting habitat suitability between 0 not suitable to 1 perfectly suitable annually for each catchment from 1951 to 2100 for three gcms and two rcp scenarios 4 5 and 8 5 2 2 1 presence absence data for both shad species presence absence data to calibrate the c sdm were available from the eurodiad 4 0 database https data inrae fr dataset xhtml persistentid doi 10 15454 ivvaic barber o malley et al 2022 this database stores information about the presence absence and functionality i e reproductive capacity of diadromous species populations in selected catchments in europe the middle east and north africa from 1750 to present time béguer et al 2007 lassalle et al 2008b lassalle and rochard 2009 eurodiad 4 0 stores data for 350 catchments and three time periods though the precision of information varies and not every species has information for each time period this database underwent two validation processes by local experts from various organizations involved in fisheries sciences and environmental management the 292 catchments with presence absence data available represented all of the large 50 000 km2 n 37 and medium sized 10 000 km2 n 48 catchments present in europe the middle east and north africa as well as 207 small sized catchments 10 000 km2 that were specifically chosen to prevent any geographical bias in the database lassalle and rochard 2009 however this represents only a proportion of the small size catchments that exist within the study area for shads calibration was performed using all catchments with available presence absence data for each species n 254 and 243 for a alosa and a fallax respectively this included 37 large 47 medium and 159 small sized catchments for a fallax and 37 large 48 medium and 169 small sized catchments for a alosa projection of future distributions was focused on the same catchments for both species n 135 located in the atlantic area corresponding to their core distribution range and potential northern territories where the species distribution may shift under warming conditions 2 2 2 environmental predictor variables environmental variables used in c sdms were chosen to balance data availability with the potential to affect diadromous species distribution across multiple species bradie and leung 2017 as these species utilize both freshwater and marine habitats both continental and marine environmental variables were used for the first time to predict species distributions table 1 continental variables included elevation at the headwater length of the main watercourse surface area of the drainage basin and precipitation see lassalle et al 2008 for their ecological meaning the first three variables were provided for each catchment by eurodiad 4 0 precipitation was calculated as an annual value across the surface area of each catchment these values represent the physical aspect of each catchment and taken together can represent the range of hydrologic conditions that diadromous species experience pont et al 2005 lassalle and rochard 2009 marine variables at the outlet included surface salinity sea surface temperature sst and mixed layer depth while salinity and temperature are known to have direct physiological effects on anadromous fish the mixed layer depth relates to the euphotic zone and biological production that might be of relevance for pelagic species bruge et al 2016 erauskin extramiana et al 2019 marine variables were calculated for each catchment using a buffer of 0 5 side around the outlet of the river to take into account the dilution of the river plume observed atmospheric data came from the climate research unit time series dataset cru t s 4 03 crudata uea ac uk mitchell and jones 2005 which includes monthly climate observations measured at meteorological stations throughout europe and interpolated between stations with a resolution of 0 5ᵒ 62 km from 1901 to 2018 observed data for the marine variables came from the chore as cmcc historical ocean reanalysis dataset which is a reanalysis performed by the cmcc centro euro mediterraneosui cambiamenti climatici http c glors cmcc it yang et al 2017 reconstructing ocean variables from 1900 to 2010 at a resolution of 0 5 degree table 1 when using climate projections it is important to include the projections from multiple global climate models gcms in order to account for possible discrepancies between model estimates harris et al 2014 in the kind of strategy commonly known as the use of ensembles for marine environmental variables we have used data from three different global climate models gcms that are detailed in table 2 with trends presented in fig 2 for rcp scenario 8 5 and in appendix c figure c1 for rcp scenario 4 5 for atmospheric variables we have used data from three models from the eurocordex project http www euro cordex net where several gcms have been dynamically downscaled to achieve better spatial resolution and better representation of local atmospheric processes these three regional climate models rcms table 3 fig 2 appendix c figure c1 and use the same gcms as the ones used as marine data source to achieve minimally consistent grids climate projections were provided from 1951 to 2100 and as a suggested best practice ecological studies by harris et al 2014 two emissions scenarios were used for each gcm rcp 4 5 and rcp 8 5 table 4 and rcp to encompass a range of uncertainty in the projected increase in global mean temperature and to compare mitigated vs unmitigated responses a correction procedure based in a quantile quantile correction was also applied to each climate model to correct errors intrinsic to the model between a historical projection of modeled data from 1950 to 2005 and the observed data the chore as reanalysis for marine variables and the era5 reanalysis for atmospheric variables kotlarski et al 2014 casanueva et al 2016 in this way of correcting data it is assumed that there should be similar distributions of values between observed data which represented reality and the historical modeled projections and any necessary corrections to ensure this similarity is propagated forward to the projections from 2006 to 2100 2 2 3 algorithm choice for habitat suitability models boosted regression trees brts were chosen to produce quantitative measures of habitat suitability because they can handle different types of predictor variables and missing values de ath 2007 brts combine multiple simple decision trees to optimize a model s predictive performance elith et al 2008 boosting involves growing a large group of trees in sequence and combining the averaged predictions de ath 2007 the predictive error of this method is improved and over learning is reduced using stochastic gradient boosting which uses least squares regression trees and subsamples the training data to include randomness friedman 2001 de ath 2007 due to the limited data set subsampling was accomplished through a cross validation method with smaller datasets de ath 2007 subsets were formed using prevalence stratification to prevent overinflating the influence of absence data elith et al 2008 boosted regression trees were run in r language r v 4 0 3 r core team 2020 using the gbm package greenwell et al 2020 2 2 4 model calibration procedure as the model used presence absence data a bernoulli classification for binomial data was used three metaparameters of the brts were adjusted for each species in order to optimize the predictive performance bag fraction the number of folds and the learning rate table 5 the first two metaparameters relate to the cross validation process internal to the model building procedure model metaparameters were optimized for each species separately and were adjusted so that the models converged and more than 1000 trees were produced as suggested by elith et al 2008 the bag fraction determines the proportion of training versus testing data within each subset this value was set at 0 7 to follow the convention of 70 of the data used for training and 30 for testing elith et al 2008 the number of folds determines the number of random subsets to use for cross validation here the common value of 10 was used the learning rate determines the contribution of each tree to the model and was optimized at 0 005 for both species a smaller value for learning rate can reduce potential overfitting but a larger value results in more trees which can improve the estimate of prediction error de ath 2007 elith et al 2008 one additional parameter is tree complexity which determines the number of splits in each tree for both species tree complexity was set to 1 meaning that only main effects were taken into account table 5 after optimized metaparameters were determined a test was run to see if the brt model for each species could be simplified by dropping environmental predictor variables elith et al 2010 segurado et al 2015 this is done by running a series of species specific jackknife tests that exclude each predictor variable sequentially except for the two variables with the highest relative influence elith et al 2011 a variable was dropped from the model if this test resulted in a decrease in the predictive deviance 2 2 5 tests of model accuracy several indices were then used to test model accuracy in reproducing the historic distribution for each species using the optimized metaparameters table 5 for threshold dependent indices including sensitivity specificity and tss fitted values from the boosted regression trees or the estimates of habitat suitability comprised between 0 and 1 had to be converted to presence absence values for evaluation the threshold value used to define presence above the threshold versus absence below the threshold was estimated using the evaluate function in the package dismo hijmans et al 2021 a confusion matrix of true and false presences and absences was used to calculate sensitivity specificity and the true skill statistic tss for each species allouche et al 2006 the tss index measures the accuracy of each calibrated model by comparing the model accuracy to how well the model performs by chance this index can range from 1 to 1 with a value above 0 indicating that the model is performing better than random and a value of 1 indicating perfect accuracy threshold dependent metrics can be interpreted according to the classification of landis et al 1977 table 7 a threshold independent measure of model accuracy was also estimated for both species this was the auc which estimates the area under the receiver operating characteristic roc curve this method calculates the sensitivity and specificity for every possible threshold value between 0 and 1 the roc curve plots sensitivity against the probability of incorrectly classifying a presence or 1 sensitivity fielding and bell 1997 using the gbm package in r greenwell et al 2020 the auc score was calculated for each subset of data used for cross validation k 10 the standard error of the auc was also calculated for these subsets an auc value of 0 5 or lower indicates a classification no better than random while a value of 1 indicates all modeled predictions were correctly classified swets 1988 2 3 population dynamics and dispersal the second component to the hydiad model built was coupled with the c sdm by applying ad hoc population and dispersal dynamics to estimate the number of fish produced in a given catchment i at time t population dynamics included an estimate of population growth rate r and an allee effect λ table 8 within the hydiad model the allee parameter was related to the number of spawners that participated in reproduction within a given catchment a high value for the allee parameter reduced the proportion of spawners that participated in reproduction making it difficult for populations to persist at a low abundance this also affects the settlement of a population in a novel catchment as a minimum number of spawners need to be present in a given year for reproduction to exceed the limitation imposed by the allee effect this parameter interacted with the population growth rate in that a high value for the latter could reduce the effect of the former dispersal dynamics included an estimate of the probability of emigration γ an additional mortality rate associated with emigration m d i s p and a measure that incorporated both the long and short distance dispersal capabilities of a species α and β used to estimate a dispersal kernel 2 3 1 simulating different age classes within the hydiad model both the habitat suitability and estimate of spawner abundance are calculated on an annual time step the model was developed to simulate a temporal lag between the production of a cohort of fish in a given year and when those fish enter the spawning population and contribute to future production this time lag can be defined based on the life history parameters of the species using the average age at maturation m a in addition while the spawning population within a given year is not explicitly age structured the model is capable of utilizing multiple spawner age classes to estimate n i t in a given time step using a parameter for the number of cohorts n c when n c is set to 1 there is no age structuring in the estimation of n i t for the current time step and only a single year contributes to the current production a value of nc for i 1 simulates a population with multiple cohorts that contribute equally to production in the current year the term nc is used to define the set s of ages s k at which fish contribute to spawning and production in year t such that 1 s s k k 1 n c when both a temporal lag and age structure are simulated in the model ma defines the average of all items in set s and n c defines the spread around that number as follows 2 s k m a k n c 2 of the set s s1 is the minimum generation time and will always be 1 year the item s n c will be the maximum generation time and will always be 2 m a 2 3 2 initial habitat suitability calibration of c sdms was performed using observed historical data to estimate initial habitat suitability within each catchment i hsii t 0 representing conditions at the beginning of the model run which was then used to calculate initial spawner abundance ni t 0 as follows 3 n i t 0 h s i i t 0 d m a x a i where d m a x was a species specific estimate of the maximum density of spawners in ideal conditions and ai was the surface area of catchment i it was assumed that these initial values represented a system in equilibrium hanski 1994 singer et al 2018 initial habitat suitability was estimated for each catchment using observed data for environmental predictors cru and chore as averaged from 1901 to 1911 and presence absence data eurodiad 4 0 from the period 1851 1950 this time period was chosen to represent species distributions right before what is called the great acceleration in human activities during the anthropocene steffen et al 2015 but was also a compromise with environmental data availability this initial value of habitat suitability along with population and dispersal dynamics described in the next section were used for a burn in period of 50 years i e outputs were discarded after the burn in period annual predictions of habitat suitability from 1951 to 2100 were estimated using modeled projections of the same environmental predictor variables averaged across multiple gcms and rcp scenarios as described below 2 3 3 population dynamics and dispersal process spawner abundance in time t bi t was estimated as the sum of spawners n returning to their origin catchment i on the left side of eq 4 and spawners dispersing into catchment i from surrounding catchments on the right side of the same equation 4 b i t s n i t s n c 1 γ j i ω s n j t s n c γ e α d j i β l j ω e α d j l β e m d i s p d j i e h 2 where γ is the probability of emigration m d i s p is the mortality rate for emigrants during dispersal and h2 is an anthropogenic source of mortality e g from a fishery these three parameters are species specific but are considered as a constant across all catchments and through time m d i s p is an additional mortality coefficient that is only applied to emigrants entering a surrounding catchment different from their natal catchment this mortality rate is applied according to the distance between natal and destination catchments d i j an extended negative exponential kernel function de cáceres and brotons 2012 was used to determine the number of spawners arriving in catchment i from each catchment j in the set of possible catchments ω this kernel function e α d j l β is calculated using the distance between catchments i and j d j i and incorporates both long and short distance dispersal through the scale parameter α and the shape parameter β chapman et al 2007 distance between each pair of catchments was calculated as the shortest path following the coastline between the outlets of each catchment this corresponded to the sum of the shortest paths from the departure catchment outlet to the coastline from the destination catchment outlet to the coastline and between the two corresponding points on the coastline however the distance between a catchment and itself was fixed to 0 regardless of the position of the outlet in relation to the coast line the central calculation in hydiad is the number of fish that survive to maturity in catchment i at time t ni t it was estimated by taking the minimum of the two values coming from the two model components i e the habitat suitability model on one side and the ecological dynamics on the other side using the following equation 5 n i t m i n h s i i t d m a x a i e h 1 b i t r where h s i i t is the habitat suitability index for catchment i at time t dmax is the maximum density of fish per km2 for a given species ai is the surface area of catchment i h1 is a measure of anthropogenic effects related to habitat degradation bi t combines spawners that return to their origin catchment and spawners that disperse into catchment i from surrounding catchments as defined in eq 4 and r is a constant growth rate applied to all catchments defining ni t as the minimum of the two separate components in this equation simulates a hockey stick recruitment curve barrowman and myers 2000 the population grows at a rate r until it reaches a limit set by the habitat suitability at time t that is specific for that species dmax and catchment ai eq 3 was then modified to include an allee effect as follows 6 n i t m i n h s i i t d m a x a i e h 1 b i t b i t 2 b i t 2 λ d m a x a i 2 r in this equation b i t 2 b i t 2 λ d m a x a i 2 indicates the proportion of spawners that are participating in reproduction this means that 50 of spawners participate when b i t λ d m a x a i 2 3 4 collecting model parameters for shads and modeling postulates the hydiad model was parameterized for the two shad species using parameter values listed in table 8 and run on a yearly time step from 1951 to 2100 the framework was developed to include two types of anthropogenic influences h1 and h2 current information related to habitat accessibility is available for larger european rivers https www eea europa eu lassalle et al 2010 however historical data was needed for the calibration of the c sdm and this was not available for many of the catchments included though the authors considered several proxies for anthropogenic influences such as human population density lassalle et al 2010 and gross domestic product nevertheless it was difficult to find historical data that covered the spatial extent of the european atlantic area but also had a fine enough resolution to estimate differences on a catchment to catchment scale a coarse spatial resolution would not allow the c sdm to differentiate between conditions that result in a presence versus an absence meaning the model would not be able to learn the relationship between anthropogenic influences and occupancy elith et al 2008 thus it was not possible to include anthropogenic influences as parameters h1 and h2 within the scope of the current study for shads while no local anthropogenic pressures i e h1 and h2 set to 0 were included for shads general anthropogenic pressures such as climate induced changes were included in the form of abiotic environmental predictor variables as described above this implied that spawner abundance estimates in hydiad represented a maximum potential so by using hydiad to make simulations the postulate was made that the underlying assumptions of the model remained all suitable for the actual and future system species specific parameter values for the population and dispersal dynamics in the hydiad model as well as an estimate of maximum density of spawners in ideal conditions needed to convert hsi into spawner abundance were estimated using the primary literature or through the solicitation of knowledge from diadromous species experts table 8 the latter was accomplished using a 10 question iterative online expert knowledge survey that was specifically developed to estimate values for population demographics using a delphi process which is used to address scientific questions with high levels of uncertainty that are difficult to empirically measure elmer et al 2010 while this questioning technique has been used in a variety of ways the basic components include soliciting expert knowledge using a standardized questionnaire through several rounds of survey to estimate a group answer elmer et al 2010 the expert knowledge survey in the current study was performed in two rounds see appendix a for more details for the first round each participant was provided the same written questions and was asked to complete the survey individually see appendix a group results were calculated and presented to participants during a workshop and then a second round was completed using one on one interviews via video conferencing this allowed participants to consider their answers in a group context the authors to receive feedback on the process and a more in depth discussion to ensure that questions were being interpreted in the same way by all participants the survey combined expert knowledge regarding species populations in multiple countries in order to estimate parameter values that represented this large spatial scale as part of the expert knowledge survey participants were asked to provide an estimate of their level of confidence in their response to use as a weighted measure for each survey question the group average and variance was calculated using weighted individual responses as described in appendix a the final group averages calculated for use in the hybrid models used responses and confidence levels from this second round of the expert knowledge survey with a confidence level for each question and species combination 2 4 sensitivity analysis on hydiad parameters a global sensitivity analysis was conducted to determine which parameters had the largest effect on the estimate of total spawner abundance summed across all catchments and years n i t for each shad species in order to explore the relative influence of habitat suitability and population and dispersal dynamics this analysis used the package sensitivity in r iooss et al 2021 and utilized the morris s elementary effects ee screening method with a one at a time oat approach morris 1991 this screening method utilizes a design that consists of multiple individual trajectories that move through the parameter space varying one factor x i k times equal to the number of parameters along a grid with size δ i while keeping all the other factors fixed campolongo et al 2007 each trajectory results in one calculation of the elementary effect for the i th parameter as shown in the following equation morris 1991 7 e e i y x 1 x i 1 x i δ i x i 1 x k y x 1 x p δ i in order to account for interactions multiple trajectories r were performed each starting from a randomly sampled point the set of ee from r trajectories are averaged to get an estimate of total order sensitivity in order to prevent eei with opposite signs from cancelling each other an average μ i was estimated using the absolute values of eei as suggested by campolongo et al 2007 in order to explore interactions and non linear effects the standard deviation σ i of eei was also calculated plotting the results for μ i against σ i indicated which factors had negligible effects both have low values linear and additive effects μ i is high but σ i is low and nonlinear effects or interactions both have high values the sensitivity analyses for the two shad species involved varying the seven parameters estimated from the expert knowledge survey table 8 the range of possible values for each parameter was determined by the upper and lower standard errors calculated for each shad species from the expert knowledge survey for each parameter this possible range of values is sampled evenly by defining a value for p generally 4 6 or 8 which corresponds to a percentile 25th 17th and 12 5th respectively of the uniform distribution for each parameter morris 1991 campolongo et al 2007 franczyk 2019 for both shad species p was defined as 6 and a total of 20 trajectories r were used in the design to calculate μ i 2 5 saturation rate to compare results among catchments and species and to evaluate the added value of a hybrid approach the output of the hydiad model is spawner abundance but the primary intention of developing this modeling framework is to investigate variability in climate induced spatial and temporal trends for multiple diadromous species within the same range of catchments in addition to the habitat suitability between 0 and 1 and spawner density number of spawners per km2 an index was developed to facilitate comparisons across different sized catchments and among different species termed the saturation rate sr this is calculated for each catchment i at time t as follows 8 s r i t n i t h s i i t d m a x a i this index has a value between 0 and 1 and is limited by the hsi of a particular catchment in time t a value close to 1 indicates that the abundance of the population is close to its maximum as defined by the habitat suitability a value close to 0 indicates that the population abundance is much smaller than it could be therefore the saturation rate informs on the interest to run a hybrid model compared to a strictly correlative approach a low sr value indicates the high contribution of dispersal and demography in the population dynamics and thus the added value of considering a more complex approach when modeling a species distribution the hydiad model was run for each shad species from 1951 to 2100 and ni t was calculated annually for all catchments in the atlantic area annual spawner abundance was used to calculate annual saturation rate results were presented as heat plots that were created in the package complexheatmap in r gu et al 2016 to compare trends through time in saturation rate spawner density and habitat suitability among catchments individual catchments were included in heat plots as rows and individual years as columns catchments were ordered by country in the plots then arranged north to south within a region according to latitude the annual spawner abundance averaged from 1951 to 1980 was also calculated in order to make general comparisons among individual catchments for each species heat plots were created by separately modeling the three gcms then averaging the results for each of the two rcp scenarios 2 6 hydiad evaluation based on the saturation ratio metric to further demonstrate the advantage of increasing the model complexity with a population dynamics and dispersal module and to validate hydiad estimations with observations two analyses were performed first the distribution of decadal sr values was inspected across all the catchments included in the hydiad physical environment for a given year between 2041 and 2050 and a specific catchment sr values were averaged across the three gcms under the most pessimistic scenario rcp 8 5 then the decadal means from 2041 to 2050 were calculated and plotted together as a histogram the skewness and spread of the distribution were examined to assess the relative contribution of the population dynamics and dispersal module compared to a strictly correlative approach secondly observed abundances stored in eurodiad 4 0 for the most recent period i e 2010 present times were compared to the saturation ratios calculated on the maximum abundances i e with an hsi of 1 s r hsi 1 across the period 2010 2019 abundances in eurodiad are categorical with i absent 1 the species was never recorded in the basin or was extirpated rare 2 occasional vagrants were recorded in the basin common 3 functional populations were present in the basin and abundant 4 functional populations were present and numerically dominant in the freshwater community barber o malley et al 2022 for a given year between 2010 and 2019 and a specific catchment srhsi 1 values were averaged across the three gcms under the most pessimistic scenario rcp 8 5 then the decadal means from 2010 to 2019 were calculated for each catchment in the hydiad physical environment and categorized into four groups with one group for s r hsi 1 equal to 0 and the three others being defined as equal range classes with 1 3 and 2 3 as limits a confusion matrix with these two categorical variables was built and the results analysed following the matrix diagonal that represents the records that are in agreement considering that hydiad is run without any anthropogenic impacts estimates should be in the same categories or the ones above the observations of current abundances i e on the diagonal or in the matrix lower half 3 results 3 1 c gcm calibration and validation for shads tests related to habitat model simplification as part of the calibration process did not result in a decrease in predictive deviance for either shad species figure b2 in appendix b so all seven environmental predictor variables table 1 were used in the brt model for predictions of habitat suitability prediction error was low for both shad species but was lower for a alosa than a fallax table 9 the confusion matrix for a alosa indicated roughly the same number of false presences and false absences while a fallax estimated a higher number of false presences than false absences table b1 predictive accuracy was high for both species and all indices used table 9 threshold dependent indices were between 0 7 0 9 corresponding to substantial or perfect on the scale proposed by landis et al 1977 table 7 the threshold independent auc was above 0 8 indicating that model accuracy was better than random table 9 figures b3 and b4 the marine and continental environmental predictor variables with the highest relative influence differed slightly between the two shad species for a alosa the top environmental predictors were mixed layer depth precipitation and altitude fig 3 the top environmental predictors for a fallax included precipitation sea surface temperature and altitude fig 4 several of these predictor variables had steep response curves meaning that a small change in the predictor variable could result in a relatively large change in habitat suitability the estimate of habitat suitability was generally lower and displayed more annual variability for a alosa than for a fallax figs 5 and 6 response curves for a alosa indicated a total relative contribution of 31 5 for annual continental precipitation and annual sea surface temperature these two variables had a unimodal distribution with a decrease in habitat suitability for catchments with values at the two extremes of the range of possible values figs 3 and 5 while response curves for a fallax indicated a similar decrease in habitat suitability at the lower range of precipitation and sea surface temperature with a total relative contribution of 41 5 this species did not see a decrease in estimated habitat suitability as the predictor variables increased to their upper range figs 4 and 6 in addition a alosa had a bimodal response curve for annual mixed layer depth while a fallax generally saw a decrease in habitat suitability as mixed layer depth increased taken together this indicates that in general a alosa had fewer instances where the value of certain predictor variables could result in a high estimate of habitat suitability 3 2 expert knowledge survey results in total 12 participants responded for a alosa and 14 for a fallax from five atlantic area countries figure a1 not all the participants provided answers to each of the 10 questions though all questions had at least seven responses that were used when calculating the weighted mean and variance table 8 results for both shad species indicated relatively high agreement between participants for five of the seven questions used to estimate model parameters as seen when considering the standard error values figures a2 a4 the two questions focused on emigration addressing the proportion of the population that emigrates and the survival rate for these emigrants had the highest variability between individual responses figure a5 of these two questions the one estimating emigrant survival rate had the largest standard error weighted estimates derived from this expert knowledge survey were presented in table 8 3 3 projections of climate change impacts on shad distribution using hydiad general spatial and temporal trends in projections differed among catchments and between shad species four types of temporal trends were seen when results were averaged across the three gcms including populations that 1 started with a spawner density number of spawners per km2 that was very low or zero and maintained that density through time ex fig 5 vefsna norway 2 started at a low spawner density and increased through time ex fig 5 elbe germany 3 started at a medium to high spawner density and decreased usually to zero through time ex fig 5 adour france and 4 maintained a medium to high spawner density through time ex figs 5 and 6 meuse france using the dispersal parameters estimated through the expert knowledge survey there were no instances where the population declined to near local extinction and then later increased again for both species instances where populations declined to zero or collapsed corresponded to catchments with higher annual variability in hsi that often spanned the range of possible values this is in contrast to populations that maintained a consistent spawner density through time which had a relatively narrow range i e 0 4 to 0 8 of annual hsi values projected from 1951 to 2100 large differences in averaged projected trends for habitat suitability and spawner density existed between the two shad species for the two rcp scenarios figs 5 and 6 a alosa generally demonstrated a more variable and consistently lower value for habitat suitability across all catchments fig 5 while several individual catchments from north to south weser ems meuse escaut seine loire charente dordogne garonne minho and mondego had relatively high spawner density through time the majority of catchments were consistently at the lower range of possible values this is in contrast to a fallax which demonstrated a spawner density at the higher range across the majority of catchments fig 6 this trend was reflected in the projected hsi for a fallax which was high for most catchments except for several located in spain portugal and morocco e g odiel tinto piedras sado mira loukkos and sebou for this species hsi was seen to increase through time for many catchments especially in the northern extend of its range above approximately 48 n this temporal trend was less common for a alosa which often displayed high annual variability in hsi within a catchment for a alosa some catchments did display an increase in hsi through time however the opposite was also true and several catchments saw a decrease in hsi through time in addition latitudinal trends in hsi were less clear for a alosa than for a fallax while spawner density and habitat suitability were both dramatically different between the two shad species as detailed above trends in saturation rate were similar for both species the saturation rate was generally at one extreme or the other representing either zero a population crash or 1 the available habitat in that catchment is being fully utilized however some individual catchments did demonstrate annual variability in saturation rate ex blavet in france and guadiana in spain which both varied between 0 and 1 for a alosa which was seen more for a alosa than a fallax it is important to keep in mind that saturation rate does not reflect the size of the population but rather how the available habitat though scarce was being used by the population a high saturation rate close to 1 could occur regardless of the value of habitat suitability for both species many catchments started with a high saturation rate that quickly decreased over a short period of time as was demonstrated in figs 5 and 6 where the color rapidly shifted from yellow to dark blue this trend could occur when the population started at a large abundance and rapidly collapsed or when the habitat suitability and spawner density were relatively low in a catchment but the population was still as large as it could be given the value of habitat suitability when the value of habitat suitability was low it limited the population growth as could be seen for both species once a population collapsed saturation rate and density of 0 it did not later recover as would be indicated by an increase in spawner density and saturation rate these population collapses were much more prevalent for a alosa 37 than for a fallax 10 when considering the results from the three gcms averaged together for rcp 8 5 figs 5 and 6 the saturation ratio can also be defined as the comparison of the spawner abundances estimated by hydiad and the habitat model c sdm alone so dominance of values close to 1 in the heat plots indicated no lag between changes in hsi values and the response of the population model projections were similar between rcp 4 5 and rcp 8 5 for saturation rate spawner density and habitat suitability for both shad species figs 5 6 c2 and c3 the largest difference between the two scenarios related to the scale of change which was seen in the temporal trends for habitat suitability the amount of change that occurred between the earlier and later time series was more pronounced as expected for climate scenario rcp 8 5 than rcp 4 5 a good example of these differences can be seen for a alosa in the severn in england in figs 5 and c2 for rcp scenarios hsi and spawner density are in the mid to high end of their range starting at roughly 2070 however the values for both hsi and spawner density increase to consistently be higher for rcp 8 5 than rcp 4 5 however when considering trends across all catchments the difference in projected habitat suitability between the two rcp scenarios was negligible 3 4 sensitivity of total spawner abundance to model parameters results from the global sensitivity analysis were similar for the two shad species fig 7 the parameters related to dispersal i e mortality of emigrants m d i s p the probability of emigration γ and the shape β and scale α parameters for the dispersal kernel table 8 had negligible effects on the total spawner abundance summed across all years and catchments as indicated by the low values of both σ and μ for all of these factors the parameters related to population dynamics i e population growth rate r the allee effect λ and the maximum density of spawners per unit area d m a x demonstrated a nonlinear effect or interaction because of a high value for both σ and μ 3 5 model evaluation based on the saturation ratio metric for allis shad the shape of the saturation ratio distribution is bimodal at the extremes while a unique mode around 1 was depicted for twaite shad fig 8 regarding the confusion matrix between observed abundance and srhsi 1 the error rate was 13 and 5 5 for allis and twaite shad respectively when considering as estimation errors only records above the diagonal errors in the upper half of the matrix indicated observed abundances that overpassed the saturation ratios calculated on the species maximum abundances without any anthropogenic pressures table 10 4 discussion 4 1 development of the hydiad model 4 1 1 novel approaches for the study of spatial dynamics in diadromous species in this paper we demonstrate for the first time how a hybrid model offers an alternative way to estimate spatial dynamics thereby integrating how diadromous species move through a spatial matrix of catchments connected by the oceanic domain as far we know previous attempts at integrating multiple habitats are restricted to sdms so called multi state sdm frans et al 2018 and this is the first time a multi state habitat model has been coupled with population dynamics and dispersal processes in fish species while the hydiad model was developed following the steps laid out by singer et al 2018 for hybrid species distribution models several novel approaches were developed to address difficulties related to knowledge gaps and the fact that dispersal for diadromous species was measured between catchments that were different sizes and distances apart rather than through a continuous landscape meaning it could not be estimated using the grid cell approach often used for terrestrial species de cáceres and brotons 2012 visintin et al 2020 even if this model is difficult to calibrate since it simulates a potential rather than an observable abundance the confusion matrix between observed abundances provided by the eurodiad database and classes of simulated saturation ratios with hsi 1 showed a limited number of discrepancies table 10 leading to a quite good confidence in the model for data poor species the availability of species specific data related to biological processes can be a major knowledge gap and expert knowledge elicitation has been suggested as a possible solution gallien et al 2010 singer et al 2018 the current study successfully used this approach on two aspects i to parameterize the hydiad model for two shad species section 2 3 4 and ii to fill data gaps related to both historical presences absences and physical characteristics of catchments section 2 2 1 lastly given that marine predictor variables have been neglected in previous studies on diadromous species range shift responses the abiotic niche for the two shad species was estimated using a suite of environmental predictor variables that covered the entire species life cycle the inclusion of marine and freshwater predictors led to high predictive accuracy when estimating habitat suitability for both species 4 1 2 applying hydiad to other species and geographic regions the hydiad model could be applied to other anadromous species or modified to fit other life history approaches such as catadromy i e species that reproduce at sea and grow in rivers for data rich species occupancy information and population and dispersal parameters could likely be found in the scientific literature so the most time consuming process would likely be the downscaling of gcms to the appropriate regional scale in order to obtain simulated data for environmental predictor variables another potential time consuming process is the calculation of the distance matrix which would require a longer computation time if a larger number of catchments were added increasing the number of catchments included in the calibration of the c sdm will provide a better representation of the range of possible conditions that a species experiences and improve the estimation of habitat suitability the current study provides an approach for filling in knowledge gaps for data poor diadromous species in which parameters for population and dispersal dynamics may not be readily available in the primary literature for the spatial scale used in the hydiad model the use of iterative expert knowledge elicitation could be an alternative source of information in those cases the results of the expert knowledge survey in addition to the equations and r script for calculating the weighted group mean appendix a could be used to apply the hydiad model to other diadromous species and geographic regions however the ecological processes behind the parameters being estimated are complex and the spatial scale covered by the model was large thus extensive feedback was necessary to develop the wording of the questions used in the expert knowledge survey to address this the survey consisted of multiple rounds with a workshop in between to make sure that the survey questions were interpreted correctly by the respondents after presenting the preliminary group results and discussing the survey questions in both the workshop and one on one interviews many participants changed their initial answer to particular questions based on a better understanding of what the authors intended to estimate to further address this future applications of this expert knowledge survey may benefit from two rounds of one on one interviews rather than an initial questionnaire followed by individual interviews while this kind of approach might be necessary in poor data situations it has to be recognized that there are several potential pitfalls to consider when using this type of expert survey process for example there is the concern that subjectivity and speculation in the answers provided by experts may lead to biased results in addition it is important to consider the ecological paradigm implicit in estimating parameters as the hydiad model was developed to apply the same values for population and dispersal parameters across all populations and catchment scale differences were related to environmental conditions in the current study these biases were addressed by using a group of experts studying shads across a large spatial scale multiple steps to the survey and a weighting scheme for the results that allowed participants to rate the level of confidence they had in their answers for each species and question combination scolozzi and geneletti 2012 which allowed for a more precise weighting scheme in the calculation of group averages although there is evidence for rapid adaptive evolution of species in response to climate change lavergne et al 2010 the hybrid model used in this study did not account for the adaptive potential of species phenotypic plasticity and ecological processes such as competition positive interactions and trophic relationship which can affect rates of species range shifts lavergne et al 2010 for data poor species finding historical presence absence information can be difficult and time consuming in the current study historical presence absence information was available for the two shad species because of an existing database https data inrae fr dataset xhtml persistentid doi 10 15454 ivvaic barber o malley et al 2022 this database required enormous effort from a large group of students and project partners to create and validate but this work will allow the hydiad model to be applied to other diadromous species both within the same area used in the current study as well as other areas in europe while many diadromous species historically supported a freshwater commercial fishery that should be a matter of public record the temporal resolution of these data may be coarse in addition for species that are similar in appearance it may be difficult to distinguish based on historical records whether one or both species were present and making inferences based on the historic species range can reduce the fine scale resolution of the occupancy data used to calibrate the c sdm e g doadrio et al 1991 2011 4 2 using hydiad to estimate future projections of shad distributions 4 2 1 habitat suitability the trends seen in the estimate of habitat suitability and shifts in distribution for both shad species in the current study are similar to what was estimated by lassalle et al 2008b and lassalle and rochard 2009 using c sdms suggesting that habitat suitability may play a larger role than population dynamics and dispersal in the distribution of these two species this point was also suggested by the dominance of saturation ratios close to 1 in the distributions across catchments indicating that variations in habitat suitability were quickly followed by changes in population abundances in relation with the relatively high specific population growth rates in contrast to these previous two c sdm studies surface area only accounted for roughly 9 of the relative influence for both shad species in the current study and precipitation 17 5 for a alosa and 21 8 for a fallax and altitude at the source 16 9 for a alosa and 18 1 for a fallax which together can act as a proxy for river flow lassalle and rochard 2009 pont et al 2005 had a large influence mixed layer depth which was not included in the previous studies was also influential in the current study 21 6 for a alosa and 11 5 for a fallax with a higher habitat suitability when mixed layer depth was lower studies on the moroccan coast have suggested that shallow mixed layer depth corresponds to high cold water upwelling activity bessa et al 2019 which could also lead to lower temperatures nykjær and van camp 1994 and higher productivity and food availability in this region lassalle et al 2008a similar to the previous two studies general distribution trends in the current study indicated that a fallax is expected to increase in abundance and a alosa is expected to decrease in abundance under xxist century climate change scenarios the current model estimated relatively high values of habitat suitability for a fallax across its range the lowest and most variable estimates for habitat suitability and spawner density for a fallax were seen in catchments in southern spain southern portugal and northern morocco for a alosa the two previous studies predicted drastic declines in suitable habitat within the southern range of the species in the current study habitat suitability for a alosa was consistently lower across catchments and more variable through the entire modeled timeframe 1951 2100 especially for basins in spain portugal and morocco for this species some of the response curves used to estimate fitted values from the boosted regression trees were relatively steep for several of the environmental predictor variables and this can result in a higher estimate of habitat suitability when there is only a relatively small change in the value of that variable to address this future applications of hydiad could include process based habitat suitability model under the ecological niche theory framework citores et al 2020 and to downplay the influence of these steep slopes on estimates of habitat suitability 4 2 2 dispersal dispersal parameters probability of emigration and mortality rate for emigrants during dispersal estimated from the expert knowledge survey indicated that long distance dispersal events were rare for both shad species this was supported in the literature by genetic and microchemistry studies that indicated shads displayed a high rate of natal homing alexandrino et al 2006 ices 2015 martin et al 2015 high homing rates may decrease the ability of shads to adapt to climate induced changes in habitat suitability by preventing populations from shifting their distribution take advantage of previously unoccupied habitat that becomes suitable however despite the indication of natal homing there is also evidence that suggests some dispersal of a alosa between catchments that were as far apart as 2000 km randon et al 2017 meaning that while rare long distance dispersal does occur previous studies have indicated a lack of fine scale genetic structure among nearby a alosa populations alexandrino et al 2006 jolly et al 2012 martin et al 2015 which may be the result of the small number of individuals that disperse longer distances it is unlikely that many individuals disperse across very long distances though as genetic and morphological differences have been observed between populations in france and those in portugal alexandrino et al 2006 lassalle et al 2008a previous studies have indicated that a fallax has a higher level of genetic structure ices 2015 and a greater rate of natal homing alexandrino et al 2006 jolly et al 2012 which may limit its ability to colonize newly suitable habitats jolly et al 2012 found that neighboring populations in the uk severn and wye displayed no genetic differentiation while the severn was genetically distinct from several populations located at a farther distance tywi usk and irish catchments davies et al 2020 found that 33 out of 34 a fallax tagged in 2018 from the severn returned to this catchment in 2019 however in tagging studies capture location may not represent natal origin nachón et al 2020 and there may still be long distance dispersal between major estuaries davies et al 2020 for shads not all river catchments in the european atlantic area listed in the ccm river and catchment database data europa eu were included in the model projections many small and medium sized catchments were not incorporated into the dispersal matrix because simulations only used catchments included in eurodiad 4 0 in hydiad smaller catchments would not produce a large number of dispersers because this value was based on an estimate of productivity directly related to surface area and dispersal mortality applied using the distance between a pair of catchments out of the 18 769 pairwise distances in the dispersal matrix only a small proportion 0 06 for a alosa and 0 03 for a fallax appendix d were less than the maximum emigration distances estimated in the expert knowledge survey so while the dispersal kernel allowed a small proportion of emigrants to move past this maximum distance these spawners did not survive to reach a further catchment if the dispersal matrix included more catchments that were each a shorter distance away it is possible that the resulting increase in the number and survival of dispersing spawners could allow surrounding catchments to be rescued from the allee effect due to an annual influx of dispersing fish kanarek et al 2015 recent studies have suggested that small catchments could be more important for the resilience of diadromous species than previously thought melo merino et al 2020 copp et al 2021 and so future applications of the hydiad model would benefit from the inclusion of more small catchments in future projections 4 2 3 disentangling habitat suitability and population and dispersal dynamics it is difficult to disentangle the effects of habitat suitability on the estimates of spawner abundance from those of population and dispersal dynamics within a given catchment within the hydiad model the allee effect was imposed by reducing the number of spawners that were participating in reproduction within a given catchment potential demographic rescue from the allee effect due to immigration was limited for both shad species because of interactions between dispersal capabilities habitat suitability and annual stochasticity population growth a low proportion of spawners participating in reproduction and the focus on medium and large sized catchments included in the distance matrix for both species dispersal from a given population was low and was generally restricted to nearby catchments when environmental conditions were limiting the number of spawners in a catchment were reduced to the point where recovery was not possible because the population could not surpass the threshold set by the allee effect if habitat suitability was low for several years within a short time period spawner density decreased and was often unable to recover regardless of an increase in habitat suitability in later years the combination of high habitat suitability relatively high population growth rate and low allee effect allowed most a fallax populations to persist in contrast many a alosa populations experienced consistently low habitat suitability and this led to low estimates of spawner density and many catchments with population crashes this is demonstrated in the a alosa population crashes early in the time series in catchments with very high annual variability in habitat suitability along the northern coast of spain cantabrian coast these rivers are generally short and steep with high water flow doadrio et al 2011 dr david josé nachón garcía personal communication and while these catchments had spawners present at the start of the model simulation indicating that the model was correctly simulating the presence absence data used for calibration these populations quickly dropped below the threshold imposed by the allee effect and were unable to recover surrounding populations in spain portugal and france either because of a low spawners abundance or too long of a long distance were unable to produce enough dispersers for the cantabrian populations to recover this specific dynamics simulated in several catchments reinforce the need in new approaches that do not limit the interpretation to single habitat suitability this conclusion might become more apparent when considering species with a slower turnover rate as highlighted in the present study fig 8 by the lower peak at sr 1 for allis shad than twaite shad the former having a lower population growth rate than the latter for such a group of species regional dynamics driven by specific ecological and physical features will turn more frequent in the species range as not masked by the population ability in quickly recovering from unsuitable conditions leading to question the underlying mechanisms 4 3 conclusion the hydiad model was developed to estimate the distribution of diadromous species under climate scenarios and was successfully applied to two shad species in the atlantic area of europe estimated trends indicated that under xxist century climate scenarios habitat suitability for a fallax is expected to increase which would likely lead to an increase in abundance except possibly in the southernmost catchments of this species current range in morocco portugal and spain model estimates indicated that habitat suitability for a alosa is expected to decrease as well as display higher rates of annual variability particularly in southern catchments as anthropogenic factors were not modeled for the two shad species these results may be exacerbated by problems with river connectivity or water pollution future studies can apply the hydiad model to other diadromous species including data poor ones using species specific estimates of population dynamics and dispersal parameters credit authorship contribution statement betsy barber o malley data curation validation formal analysis methodology writing original draft géraldine lassalle conceptualization methodology funding acquisition supervision writing review editing guillem chust conceptualization methodology writing review editing estibaliz diaz funding acquisition writing review editing andrew o malley methodology formal analysis writing review editing césar paradinas blázquez data curation validation javier pórtoles marquina data curation validation patrick lambert conceptualization formal analysis methodology funding acquisition supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was funded by the atlantic area interreg project diades many thanks go to all the experts that help with the validation of the eurodiad 4 0 database see the list in barber o malley et al 2022 we are also grateful for the time experts spent on answering the expert knowledge survey on population dynamics and dispersal the world climate research programme s working group on coupled modelling is responsible for the fifth coupled model intercomparison project and we thank the climate modeling groups for producing and making available their model output eurocordex is the european branch of the international cordex initiative which is a program sponsored by the world climate research program wrcp to organize an internationally coordinated framework to produce improved regional climate change projections for all land regions world wide supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 109997 appendix supplementary materials image application 1 
24408,diadromous species are particularly vulnerable to climate change because they utilize both marine and freshwater habitat to complete their life cycles dispersal plays an important role in restraining the distribution of plant and animal species and is a key mechanism to allow diadromous species to adapt to changes in habitat suitability but it is often not included in species distribution models that explore population trends under climate scenarios the objective of this study was to develop a model to estimate potential shifts in diadromous populations in the atlantic area of europe under two climate change scenarios and multiple global climate models to address the question of range shift responses a hybrid approach for diadromous species distribution hydiad was developed that incorporated two components i statistical static models of habitat suitability describing the influence of environmental factors on species occurrence and ii biological processes relevant for the distribution of the species such as population demography and dispersal dynamics hybrid models were developed using a novel approach that incorporated both population and between catchment dispersal dynamics specific to each species occupancy data for diadromous species in a subset of atlantic area catchments were first validated by regional experts and boosted regression trees were applied to estimate habitat suitability within each catchment based on historical physical and climatic environmental predictors from the continental and marine domains habitat suitability was then used in a population dynamics model that incorporated between catchment dispersal and local population growth results for different sized catchments were compared using time series of spawner density and saturation rate which estimated how much of the available habitat was being utilized many of the species specific values used in hydiad were estimated through a survey of diadromous species experts and group consensus was reached by calculating weighted averages the hydiad model was applied to two shad species alosa alosa and a fallax to explore population trends projected annually from 1951 to 2100 projected trends indicated that under xxist century climate scenarios habitat suitability is expected to increase for a fallax but decrease for a alosa projected trends also indicated an increase in the rate of annual variability for a alosa particularly in the southern part of its range future studies can utilize the hydiad model to explore distribution trends for other diadromous species under climate change scenarios keywords diadromous species species distribution modeling dispersal allee effect habitat suitability climate change 1 introduction diadromous species that migrate between marine and freshwater habitats mcdowall 1988 are especially vulnerable to climate change due to their complex life cycle diadromous species experience the effects of changes in climate conditions in both domains and across different life stages robinson et al 2011 hare et al 2016 lin et al 2017 potentially through a latitudinal range shift in species distributions perry et al 2005 dambach and rödder 2011 it is challenging to develop a better understanding and accurate estimation of the potential effect of climate changes on diadromous species because they utilize both freshwater and marine habitat correlative species distribution models c sdms which are based on the generalized relationships between observed presences absences and abiotic environmental parameters guisan and zimmermann 2000 have been implemented for a large number of species to address the possible effect of climate change however c sdms do not take into account biological factors that are considered important for estimating species distributions such as population dynamics and dispersal capacity guisan and thuiller 2005 elith et al 2010 fordham et al 2013 melo merino et al 2020 on the other end of the spectrum mechanistic species distribution models m sdms explicitly account for these dynamics by incorporating how both abiotic and biological processes constrain the distribution and abundance of a species kearney and porter 2009 singer et al 2016 however m sdms require greater computer processing power and more detailed datasets to parameterize fordham et al 2018 and so have generally only been calibrated for well studied or commercially exploited species for which physiological or ecological constraints are known kearney and porter 2009 cheung et al 2010 rougier et al 2014 lotze et al 2019 developing m sdms for data poor diadromous species on a large spatial scale is problematic because large number of parameters to estimate with insufficient data can trigger high uncertainty a hybrid species distribution model h sdm approach could be classified as intermediate between correlative and mechanistic species distribution models in terms of both model complexity i e number of parameters and data requirements singer et al 2016 h sdms include two components i the correlation of species observations with abiotic environmental conditions and ii biological processes relevant for the distribution of the species such as population demography predator prey interactions and dispersal dynamics dormann et al 2012 singer et al 2018 different studies have shown that incorporating both of these components has led to an improvement in the estimates of species distributions and potential range shifts compared to only including abiotic environmental conditions latimer et al 2006 dormann et al 2012 fordham et al 2013 singer et al 2018 these hybrid models first determine the presences or absences of a species taking into account environmental conditions then biological factors thereby incorporating spatially explicit processes that act on both a coarser and finer spatial scale boulangeat et al 2012 regarding biological factors dispersal is a key mechanism driving the range shift response of aquatic organisms to climate change by increasing population resilience through metapopulation or source sink dynamics harrison 1991 hanski 1998 individuals within a population may return to spawn in the location where they originated homing or they may disperse to a non natal catchment to participate in reproduction straying quinn 1993 methodological and data limitations have resulted in many previous niche based modeling studies that assumed no dispersal or unlimited dispersal guisan and thuiller 2005 lassalle et al 2008b franklin 2010 holloway and miller 2017 but these two hypotheses overestimated either the range loss or the species dispersal abilities jaeschke et al 2013 these hypotheses are simple decision rules on whether a newly suitable environment is reachable or not at the population scale straying and source sink dynamics may provide a mechanism for recovery after poor year class recruitment or may be a way for diadromous species to face environmental changes such as habitat fragmentation and loss schtickzelle and quinn 2007 however this possible rescue effect i e emigrants from surrounding populations reduce the local extinction occurrence gotelli 1991 of strayers moving from source to sink populations may only persist when overall productivity is relatively high as suggested from simulated populations of atlantic salmon salmo salar bowlby and gibson 2019 another factor that may interact with dispersal in shaping species response to environmental changes is the allee effect stephens and sutherland 1999 this concept is defined as a positive relationship between population density and the per capita growth rate of a population previous studies have suggested that this effect can prevent recovery of marine fish populations at low abundances rougier et al 2012 hutchings 2014 kuparinen et al 2014 perälä and kuparinen 2017 and climate change is anticipated to strengthen these effects berec 2019 winter et al 2020 the primary objective of this study was to develop an original h sdm framework for diadromous species that incorporated dispersal and population dynamics coupled with a habitat suitability module based on environmental predictor variables from both marine and freshwater habitats this new modeling framework named hydiad for hybrid approach for diadromous species distribution could be utilized for various diadromous species despite differences in distributions and life history types these models were intended to improve upon the existing c sdms developed for european diadromous species by lassalle et al 2008b and lassalle and rochard 2009 which assumed unlimited dispersal i e all newly predicted suitable habitats were reachable and only included environmental predictor variables from the freshwater habitat hydiad was developed using the steps in the h sdm modeling framework outlined in singer et al 2018 for species with common life history strategies in continuous terrestrial environments as recommended by the previous authors knowledge gaps were identified and an expert elicitation procedure was designed to provide group based estimates of missing parameters for western european diadromous species the dispersal process in hydiad was developed taking into account spatial units i e here catchments compared to grid cells that were varying sizes and distances apart within a spatial matrix that included both the freshwater and oceanic domains the secondary objective was to apply hydiad to the two western european shads the allis shad alosa alosa and the twaite shad a fallax to project species distribution trends under multiple xxist climate models 2 material and methods hydiad was developed to simulate shifts in habitat suitability related to changes in environmental predictors dispersal processes and population dynamics that were specific to each species fig 1 hydiad was developed using the steps in the h sdm modeling framework outlined in singer et al 2018 for species with common life history strategies in continuous terrestrial environments the first step is the habitat modeling by correlating species occurrences with abiotic conditions section 2 2 the second step consists in inserting population dynamics processes accounting for both demography and dispersal with a strong emphasis put on reducing knowledge gaps section 2 3 the advantages of a hybrid approach was assessed by comparing outputs from the habitat model alone first step of the hydiad framework with outputs when biological processes were included in the hydiad framework second step fo the hydiad framework nonetheless the application of the singer et al 2018 generic method to diadromous species required several methodological developments that are fully presented below including i the use of a connectivity matrix to estimate distance between pairs of catchments based on shortest aquatic path ii the estimation of population dynamics parameters and dispersal kernel through an expert knowledge survey iii the estimation of among catchment dispersal dynamics iv the calculation of spawner abundance based on catchment size and species specific spawner density rather than probability of occupancy and vii the use of multiple global climate models gcms and representative concentration pathway rcp scenarios to project spawner abundance the source code was provided at https doi org 10 5281 zenodo 5973788 2 1 species of interest focus on dispersal metapopulations and allee effect the two shad species share similar life history strategies and ranges in the north eastern atlantic wilson and veneranta 2019 the historic range of these species on the atlantic coast extended from norway to morocco though a fallax has been reported as far north as iceland ices 2015 both species are anadromous and migrate into freshwater to spawn in the spring mcdowall 1988 shad populations especially those of a alosa have declined severely across europe over the past century aprahamian et al 2003 baglinière et al 2003 nachón et al 2016 due to a multitude of impacts along their migration routes acting at all life stages costa dias et al 2009 limburg and waldman 2009 while these shad species have the ability to travel long distances martin et al 2015 both species generally exhibit homing i e the return of fish to their natal river aprahamian et al 2003 jolly et al 2012 martin et al 2015 davies et al 2020 though short distance dispersal likely occurs between neighboring rivers with similar environmental conditions aprahamian et al 2003 jolly et al 2012 martin et al 2015 these localized exchanges might result in metapopulation dynamics with some rivers acting as sources and other as sinks randon et al 2017 interestingly rougier et al 2012 demonstrated for allis shad a likely demographic allee effect depensation in fish stock productivity when the abundance of spawners is low for the reference population in the core of its distribution range these complex dynamical processes possibly at play for the two shad species are crucial to consider when simulating species spatial responses to climate change 2 2 correlative species distribution model c sdm c sdm were built and run to relate both the physical characteristics and environmental predictor variables of river catchments to the recorded presences and absences of each species within the equivalent time period c sdm were then used for projecting habitat suitability between 0 not suitable to 1 perfectly suitable annually for each catchment from 1951 to 2100 for three gcms and two rcp scenarios 4 5 and 8 5 2 2 1 presence absence data for both shad species presence absence data to calibrate the c sdm were available from the eurodiad 4 0 database https data inrae fr dataset xhtml persistentid doi 10 15454 ivvaic barber o malley et al 2022 this database stores information about the presence absence and functionality i e reproductive capacity of diadromous species populations in selected catchments in europe the middle east and north africa from 1750 to present time béguer et al 2007 lassalle et al 2008b lassalle and rochard 2009 eurodiad 4 0 stores data for 350 catchments and three time periods though the precision of information varies and not every species has information for each time period this database underwent two validation processes by local experts from various organizations involved in fisheries sciences and environmental management the 292 catchments with presence absence data available represented all of the large 50 000 km2 n 37 and medium sized 10 000 km2 n 48 catchments present in europe the middle east and north africa as well as 207 small sized catchments 10 000 km2 that were specifically chosen to prevent any geographical bias in the database lassalle and rochard 2009 however this represents only a proportion of the small size catchments that exist within the study area for shads calibration was performed using all catchments with available presence absence data for each species n 254 and 243 for a alosa and a fallax respectively this included 37 large 47 medium and 159 small sized catchments for a fallax and 37 large 48 medium and 169 small sized catchments for a alosa projection of future distributions was focused on the same catchments for both species n 135 located in the atlantic area corresponding to their core distribution range and potential northern territories where the species distribution may shift under warming conditions 2 2 2 environmental predictor variables environmental variables used in c sdms were chosen to balance data availability with the potential to affect diadromous species distribution across multiple species bradie and leung 2017 as these species utilize both freshwater and marine habitats both continental and marine environmental variables were used for the first time to predict species distributions table 1 continental variables included elevation at the headwater length of the main watercourse surface area of the drainage basin and precipitation see lassalle et al 2008 for their ecological meaning the first three variables were provided for each catchment by eurodiad 4 0 precipitation was calculated as an annual value across the surface area of each catchment these values represent the physical aspect of each catchment and taken together can represent the range of hydrologic conditions that diadromous species experience pont et al 2005 lassalle and rochard 2009 marine variables at the outlet included surface salinity sea surface temperature sst and mixed layer depth while salinity and temperature are known to have direct physiological effects on anadromous fish the mixed layer depth relates to the euphotic zone and biological production that might be of relevance for pelagic species bruge et al 2016 erauskin extramiana et al 2019 marine variables were calculated for each catchment using a buffer of 0 5 side around the outlet of the river to take into account the dilution of the river plume observed atmospheric data came from the climate research unit time series dataset cru t s 4 03 crudata uea ac uk mitchell and jones 2005 which includes monthly climate observations measured at meteorological stations throughout europe and interpolated between stations with a resolution of 0 5ᵒ 62 km from 1901 to 2018 observed data for the marine variables came from the chore as cmcc historical ocean reanalysis dataset which is a reanalysis performed by the cmcc centro euro mediterraneosui cambiamenti climatici http c glors cmcc it yang et al 2017 reconstructing ocean variables from 1900 to 2010 at a resolution of 0 5 degree table 1 when using climate projections it is important to include the projections from multiple global climate models gcms in order to account for possible discrepancies between model estimates harris et al 2014 in the kind of strategy commonly known as the use of ensembles for marine environmental variables we have used data from three different global climate models gcms that are detailed in table 2 with trends presented in fig 2 for rcp scenario 8 5 and in appendix c figure c1 for rcp scenario 4 5 for atmospheric variables we have used data from three models from the eurocordex project http www euro cordex net where several gcms have been dynamically downscaled to achieve better spatial resolution and better representation of local atmospheric processes these three regional climate models rcms table 3 fig 2 appendix c figure c1 and use the same gcms as the ones used as marine data source to achieve minimally consistent grids climate projections were provided from 1951 to 2100 and as a suggested best practice ecological studies by harris et al 2014 two emissions scenarios were used for each gcm rcp 4 5 and rcp 8 5 table 4 and rcp to encompass a range of uncertainty in the projected increase in global mean temperature and to compare mitigated vs unmitigated responses a correction procedure based in a quantile quantile correction was also applied to each climate model to correct errors intrinsic to the model between a historical projection of modeled data from 1950 to 2005 and the observed data the chore as reanalysis for marine variables and the era5 reanalysis for atmospheric variables kotlarski et al 2014 casanueva et al 2016 in this way of correcting data it is assumed that there should be similar distributions of values between observed data which represented reality and the historical modeled projections and any necessary corrections to ensure this similarity is propagated forward to the projections from 2006 to 2100 2 2 3 algorithm choice for habitat suitability models boosted regression trees brts were chosen to produce quantitative measures of habitat suitability because they can handle different types of predictor variables and missing values de ath 2007 brts combine multiple simple decision trees to optimize a model s predictive performance elith et al 2008 boosting involves growing a large group of trees in sequence and combining the averaged predictions de ath 2007 the predictive error of this method is improved and over learning is reduced using stochastic gradient boosting which uses least squares regression trees and subsamples the training data to include randomness friedman 2001 de ath 2007 due to the limited data set subsampling was accomplished through a cross validation method with smaller datasets de ath 2007 subsets were formed using prevalence stratification to prevent overinflating the influence of absence data elith et al 2008 boosted regression trees were run in r language r v 4 0 3 r core team 2020 using the gbm package greenwell et al 2020 2 2 4 model calibration procedure as the model used presence absence data a bernoulli classification for binomial data was used three metaparameters of the brts were adjusted for each species in order to optimize the predictive performance bag fraction the number of folds and the learning rate table 5 the first two metaparameters relate to the cross validation process internal to the model building procedure model metaparameters were optimized for each species separately and were adjusted so that the models converged and more than 1000 trees were produced as suggested by elith et al 2008 the bag fraction determines the proportion of training versus testing data within each subset this value was set at 0 7 to follow the convention of 70 of the data used for training and 30 for testing elith et al 2008 the number of folds determines the number of random subsets to use for cross validation here the common value of 10 was used the learning rate determines the contribution of each tree to the model and was optimized at 0 005 for both species a smaller value for learning rate can reduce potential overfitting but a larger value results in more trees which can improve the estimate of prediction error de ath 2007 elith et al 2008 one additional parameter is tree complexity which determines the number of splits in each tree for both species tree complexity was set to 1 meaning that only main effects were taken into account table 5 after optimized metaparameters were determined a test was run to see if the brt model for each species could be simplified by dropping environmental predictor variables elith et al 2010 segurado et al 2015 this is done by running a series of species specific jackknife tests that exclude each predictor variable sequentially except for the two variables with the highest relative influence elith et al 2011 a variable was dropped from the model if this test resulted in a decrease in the predictive deviance 2 2 5 tests of model accuracy several indices were then used to test model accuracy in reproducing the historic distribution for each species using the optimized metaparameters table 5 for threshold dependent indices including sensitivity specificity and tss fitted values from the boosted regression trees or the estimates of habitat suitability comprised between 0 and 1 had to be converted to presence absence values for evaluation the threshold value used to define presence above the threshold versus absence below the threshold was estimated using the evaluate function in the package dismo hijmans et al 2021 a confusion matrix of true and false presences and absences was used to calculate sensitivity specificity and the true skill statistic tss for each species allouche et al 2006 the tss index measures the accuracy of each calibrated model by comparing the model accuracy to how well the model performs by chance this index can range from 1 to 1 with a value above 0 indicating that the model is performing better than random and a value of 1 indicating perfect accuracy threshold dependent metrics can be interpreted according to the classification of landis et al 1977 table 7 a threshold independent measure of model accuracy was also estimated for both species this was the auc which estimates the area under the receiver operating characteristic roc curve this method calculates the sensitivity and specificity for every possible threshold value between 0 and 1 the roc curve plots sensitivity against the probability of incorrectly classifying a presence or 1 sensitivity fielding and bell 1997 using the gbm package in r greenwell et al 2020 the auc score was calculated for each subset of data used for cross validation k 10 the standard error of the auc was also calculated for these subsets an auc value of 0 5 or lower indicates a classification no better than random while a value of 1 indicates all modeled predictions were correctly classified swets 1988 2 3 population dynamics and dispersal the second component to the hydiad model built was coupled with the c sdm by applying ad hoc population and dispersal dynamics to estimate the number of fish produced in a given catchment i at time t population dynamics included an estimate of population growth rate r and an allee effect λ table 8 within the hydiad model the allee parameter was related to the number of spawners that participated in reproduction within a given catchment a high value for the allee parameter reduced the proportion of spawners that participated in reproduction making it difficult for populations to persist at a low abundance this also affects the settlement of a population in a novel catchment as a minimum number of spawners need to be present in a given year for reproduction to exceed the limitation imposed by the allee effect this parameter interacted with the population growth rate in that a high value for the latter could reduce the effect of the former dispersal dynamics included an estimate of the probability of emigration γ an additional mortality rate associated with emigration m d i s p and a measure that incorporated both the long and short distance dispersal capabilities of a species α and β used to estimate a dispersal kernel 2 3 1 simulating different age classes within the hydiad model both the habitat suitability and estimate of spawner abundance are calculated on an annual time step the model was developed to simulate a temporal lag between the production of a cohort of fish in a given year and when those fish enter the spawning population and contribute to future production this time lag can be defined based on the life history parameters of the species using the average age at maturation m a in addition while the spawning population within a given year is not explicitly age structured the model is capable of utilizing multiple spawner age classes to estimate n i t in a given time step using a parameter for the number of cohorts n c when n c is set to 1 there is no age structuring in the estimation of n i t for the current time step and only a single year contributes to the current production a value of nc for i 1 simulates a population with multiple cohorts that contribute equally to production in the current year the term nc is used to define the set s of ages s k at which fish contribute to spawning and production in year t such that 1 s s k k 1 n c when both a temporal lag and age structure are simulated in the model ma defines the average of all items in set s and n c defines the spread around that number as follows 2 s k m a k n c 2 of the set s s1 is the minimum generation time and will always be 1 year the item s n c will be the maximum generation time and will always be 2 m a 2 3 2 initial habitat suitability calibration of c sdms was performed using observed historical data to estimate initial habitat suitability within each catchment i hsii t 0 representing conditions at the beginning of the model run which was then used to calculate initial spawner abundance ni t 0 as follows 3 n i t 0 h s i i t 0 d m a x a i where d m a x was a species specific estimate of the maximum density of spawners in ideal conditions and ai was the surface area of catchment i it was assumed that these initial values represented a system in equilibrium hanski 1994 singer et al 2018 initial habitat suitability was estimated for each catchment using observed data for environmental predictors cru and chore as averaged from 1901 to 1911 and presence absence data eurodiad 4 0 from the period 1851 1950 this time period was chosen to represent species distributions right before what is called the great acceleration in human activities during the anthropocene steffen et al 2015 but was also a compromise with environmental data availability this initial value of habitat suitability along with population and dispersal dynamics described in the next section were used for a burn in period of 50 years i e outputs were discarded after the burn in period annual predictions of habitat suitability from 1951 to 2100 were estimated using modeled projections of the same environmental predictor variables averaged across multiple gcms and rcp scenarios as described below 2 3 3 population dynamics and dispersal process spawner abundance in time t bi t was estimated as the sum of spawners n returning to their origin catchment i on the left side of eq 4 and spawners dispersing into catchment i from surrounding catchments on the right side of the same equation 4 b i t s n i t s n c 1 γ j i ω s n j t s n c γ e α d j i β l j ω e α d j l β e m d i s p d j i e h 2 where γ is the probability of emigration m d i s p is the mortality rate for emigrants during dispersal and h2 is an anthropogenic source of mortality e g from a fishery these three parameters are species specific but are considered as a constant across all catchments and through time m d i s p is an additional mortality coefficient that is only applied to emigrants entering a surrounding catchment different from their natal catchment this mortality rate is applied according to the distance between natal and destination catchments d i j an extended negative exponential kernel function de cáceres and brotons 2012 was used to determine the number of spawners arriving in catchment i from each catchment j in the set of possible catchments ω this kernel function e α d j l β is calculated using the distance between catchments i and j d j i and incorporates both long and short distance dispersal through the scale parameter α and the shape parameter β chapman et al 2007 distance between each pair of catchments was calculated as the shortest path following the coastline between the outlets of each catchment this corresponded to the sum of the shortest paths from the departure catchment outlet to the coastline from the destination catchment outlet to the coastline and between the two corresponding points on the coastline however the distance between a catchment and itself was fixed to 0 regardless of the position of the outlet in relation to the coast line the central calculation in hydiad is the number of fish that survive to maturity in catchment i at time t ni t it was estimated by taking the minimum of the two values coming from the two model components i e the habitat suitability model on one side and the ecological dynamics on the other side using the following equation 5 n i t m i n h s i i t d m a x a i e h 1 b i t r where h s i i t is the habitat suitability index for catchment i at time t dmax is the maximum density of fish per km2 for a given species ai is the surface area of catchment i h1 is a measure of anthropogenic effects related to habitat degradation bi t combines spawners that return to their origin catchment and spawners that disperse into catchment i from surrounding catchments as defined in eq 4 and r is a constant growth rate applied to all catchments defining ni t as the minimum of the two separate components in this equation simulates a hockey stick recruitment curve barrowman and myers 2000 the population grows at a rate r until it reaches a limit set by the habitat suitability at time t that is specific for that species dmax and catchment ai eq 3 was then modified to include an allee effect as follows 6 n i t m i n h s i i t d m a x a i e h 1 b i t b i t 2 b i t 2 λ d m a x a i 2 r in this equation b i t 2 b i t 2 λ d m a x a i 2 indicates the proportion of spawners that are participating in reproduction this means that 50 of spawners participate when b i t λ d m a x a i 2 3 4 collecting model parameters for shads and modeling postulates the hydiad model was parameterized for the two shad species using parameter values listed in table 8 and run on a yearly time step from 1951 to 2100 the framework was developed to include two types of anthropogenic influences h1 and h2 current information related to habitat accessibility is available for larger european rivers https www eea europa eu lassalle et al 2010 however historical data was needed for the calibration of the c sdm and this was not available for many of the catchments included though the authors considered several proxies for anthropogenic influences such as human population density lassalle et al 2010 and gross domestic product nevertheless it was difficult to find historical data that covered the spatial extent of the european atlantic area but also had a fine enough resolution to estimate differences on a catchment to catchment scale a coarse spatial resolution would not allow the c sdm to differentiate between conditions that result in a presence versus an absence meaning the model would not be able to learn the relationship between anthropogenic influences and occupancy elith et al 2008 thus it was not possible to include anthropogenic influences as parameters h1 and h2 within the scope of the current study for shads while no local anthropogenic pressures i e h1 and h2 set to 0 were included for shads general anthropogenic pressures such as climate induced changes were included in the form of abiotic environmental predictor variables as described above this implied that spawner abundance estimates in hydiad represented a maximum potential so by using hydiad to make simulations the postulate was made that the underlying assumptions of the model remained all suitable for the actual and future system species specific parameter values for the population and dispersal dynamics in the hydiad model as well as an estimate of maximum density of spawners in ideal conditions needed to convert hsi into spawner abundance were estimated using the primary literature or through the solicitation of knowledge from diadromous species experts table 8 the latter was accomplished using a 10 question iterative online expert knowledge survey that was specifically developed to estimate values for population demographics using a delphi process which is used to address scientific questions with high levels of uncertainty that are difficult to empirically measure elmer et al 2010 while this questioning technique has been used in a variety of ways the basic components include soliciting expert knowledge using a standardized questionnaire through several rounds of survey to estimate a group answer elmer et al 2010 the expert knowledge survey in the current study was performed in two rounds see appendix a for more details for the first round each participant was provided the same written questions and was asked to complete the survey individually see appendix a group results were calculated and presented to participants during a workshop and then a second round was completed using one on one interviews via video conferencing this allowed participants to consider their answers in a group context the authors to receive feedback on the process and a more in depth discussion to ensure that questions were being interpreted in the same way by all participants the survey combined expert knowledge regarding species populations in multiple countries in order to estimate parameter values that represented this large spatial scale as part of the expert knowledge survey participants were asked to provide an estimate of their level of confidence in their response to use as a weighted measure for each survey question the group average and variance was calculated using weighted individual responses as described in appendix a the final group averages calculated for use in the hybrid models used responses and confidence levels from this second round of the expert knowledge survey with a confidence level for each question and species combination 2 4 sensitivity analysis on hydiad parameters a global sensitivity analysis was conducted to determine which parameters had the largest effect on the estimate of total spawner abundance summed across all catchments and years n i t for each shad species in order to explore the relative influence of habitat suitability and population and dispersal dynamics this analysis used the package sensitivity in r iooss et al 2021 and utilized the morris s elementary effects ee screening method with a one at a time oat approach morris 1991 this screening method utilizes a design that consists of multiple individual trajectories that move through the parameter space varying one factor x i k times equal to the number of parameters along a grid with size δ i while keeping all the other factors fixed campolongo et al 2007 each trajectory results in one calculation of the elementary effect for the i th parameter as shown in the following equation morris 1991 7 e e i y x 1 x i 1 x i δ i x i 1 x k y x 1 x p δ i in order to account for interactions multiple trajectories r were performed each starting from a randomly sampled point the set of ee from r trajectories are averaged to get an estimate of total order sensitivity in order to prevent eei with opposite signs from cancelling each other an average μ i was estimated using the absolute values of eei as suggested by campolongo et al 2007 in order to explore interactions and non linear effects the standard deviation σ i of eei was also calculated plotting the results for μ i against σ i indicated which factors had negligible effects both have low values linear and additive effects μ i is high but σ i is low and nonlinear effects or interactions both have high values the sensitivity analyses for the two shad species involved varying the seven parameters estimated from the expert knowledge survey table 8 the range of possible values for each parameter was determined by the upper and lower standard errors calculated for each shad species from the expert knowledge survey for each parameter this possible range of values is sampled evenly by defining a value for p generally 4 6 or 8 which corresponds to a percentile 25th 17th and 12 5th respectively of the uniform distribution for each parameter morris 1991 campolongo et al 2007 franczyk 2019 for both shad species p was defined as 6 and a total of 20 trajectories r were used in the design to calculate μ i 2 5 saturation rate to compare results among catchments and species and to evaluate the added value of a hybrid approach the output of the hydiad model is spawner abundance but the primary intention of developing this modeling framework is to investigate variability in climate induced spatial and temporal trends for multiple diadromous species within the same range of catchments in addition to the habitat suitability between 0 and 1 and spawner density number of spawners per km2 an index was developed to facilitate comparisons across different sized catchments and among different species termed the saturation rate sr this is calculated for each catchment i at time t as follows 8 s r i t n i t h s i i t d m a x a i this index has a value between 0 and 1 and is limited by the hsi of a particular catchment in time t a value close to 1 indicates that the abundance of the population is close to its maximum as defined by the habitat suitability a value close to 0 indicates that the population abundance is much smaller than it could be therefore the saturation rate informs on the interest to run a hybrid model compared to a strictly correlative approach a low sr value indicates the high contribution of dispersal and demography in the population dynamics and thus the added value of considering a more complex approach when modeling a species distribution the hydiad model was run for each shad species from 1951 to 2100 and ni t was calculated annually for all catchments in the atlantic area annual spawner abundance was used to calculate annual saturation rate results were presented as heat plots that were created in the package complexheatmap in r gu et al 2016 to compare trends through time in saturation rate spawner density and habitat suitability among catchments individual catchments were included in heat plots as rows and individual years as columns catchments were ordered by country in the plots then arranged north to south within a region according to latitude the annual spawner abundance averaged from 1951 to 1980 was also calculated in order to make general comparisons among individual catchments for each species heat plots were created by separately modeling the three gcms then averaging the results for each of the two rcp scenarios 2 6 hydiad evaluation based on the saturation ratio metric to further demonstrate the advantage of increasing the model complexity with a population dynamics and dispersal module and to validate hydiad estimations with observations two analyses were performed first the distribution of decadal sr values was inspected across all the catchments included in the hydiad physical environment for a given year between 2041 and 2050 and a specific catchment sr values were averaged across the three gcms under the most pessimistic scenario rcp 8 5 then the decadal means from 2041 to 2050 were calculated and plotted together as a histogram the skewness and spread of the distribution were examined to assess the relative contribution of the population dynamics and dispersal module compared to a strictly correlative approach secondly observed abundances stored in eurodiad 4 0 for the most recent period i e 2010 present times were compared to the saturation ratios calculated on the maximum abundances i e with an hsi of 1 s r hsi 1 across the period 2010 2019 abundances in eurodiad are categorical with i absent 1 the species was never recorded in the basin or was extirpated rare 2 occasional vagrants were recorded in the basin common 3 functional populations were present in the basin and abundant 4 functional populations were present and numerically dominant in the freshwater community barber o malley et al 2022 for a given year between 2010 and 2019 and a specific catchment srhsi 1 values were averaged across the three gcms under the most pessimistic scenario rcp 8 5 then the decadal means from 2010 to 2019 were calculated for each catchment in the hydiad physical environment and categorized into four groups with one group for s r hsi 1 equal to 0 and the three others being defined as equal range classes with 1 3 and 2 3 as limits a confusion matrix with these two categorical variables was built and the results analysed following the matrix diagonal that represents the records that are in agreement considering that hydiad is run without any anthropogenic impacts estimates should be in the same categories or the ones above the observations of current abundances i e on the diagonal or in the matrix lower half 3 results 3 1 c gcm calibration and validation for shads tests related to habitat model simplification as part of the calibration process did not result in a decrease in predictive deviance for either shad species figure b2 in appendix b so all seven environmental predictor variables table 1 were used in the brt model for predictions of habitat suitability prediction error was low for both shad species but was lower for a alosa than a fallax table 9 the confusion matrix for a alosa indicated roughly the same number of false presences and false absences while a fallax estimated a higher number of false presences than false absences table b1 predictive accuracy was high for both species and all indices used table 9 threshold dependent indices were between 0 7 0 9 corresponding to substantial or perfect on the scale proposed by landis et al 1977 table 7 the threshold independent auc was above 0 8 indicating that model accuracy was better than random table 9 figures b3 and b4 the marine and continental environmental predictor variables with the highest relative influence differed slightly between the two shad species for a alosa the top environmental predictors were mixed layer depth precipitation and altitude fig 3 the top environmental predictors for a fallax included precipitation sea surface temperature and altitude fig 4 several of these predictor variables had steep response curves meaning that a small change in the predictor variable could result in a relatively large change in habitat suitability the estimate of habitat suitability was generally lower and displayed more annual variability for a alosa than for a fallax figs 5 and 6 response curves for a alosa indicated a total relative contribution of 31 5 for annual continental precipitation and annual sea surface temperature these two variables had a unimodal distribution with a decrease in habitat suitability for catchments with values at the two extremes of the range of possible values figs 3 and 5 while response curves for a fallax indicated a similar decrease in habitat suitability at the lower range of precipitation and sea surface temperature with a total relative contribution of 41 5 this species did not see a decrease in estimated habitat suitability as the predictor variables increased to their upper range figs 4 and 6 in addition a alosa had a bimodal response curve for annual mixed layer depth while a fallax generally saw a decrease in habitat suitability as mixed layer depth increased taken together this indicates that in general a alosa had fewer instances where the value of certain predictor variables could result in a high estimate of habitat suitability 3 2 expert knowledge survey results in total 12 participants responded for a alosa and 14 for a fallax from five atlantic area countries figure a1 not all the participants provided answers to each of the 10 questions though all questions had at least seven responses that were used when calculating the weighted mean and variance table 8 results for both shad species indicated relatively high agreement between participants for five of the seven questions used to estimate model parameters as seen when considering the standard error values figures a2 a4 the two questions focused on emigration addressing the proportion of the population that emigrates and the survival rate for these emigrants had the highest variability between individual responses figure a5 of these two questions the one estimating emigrant survival rate had the largest standard error weighted estimates derived from this expert knowledge survey were presented in table 8 3 3 projections of climate change impacts on shad distribution using hydiad general spatial and temporal trends in projections differed among catchments and between shad species four types of temporal trends were seen when results were averaged across the three gcms including populations that 1 started with a spawner density number of spawners per km2 that was very low or zero and maintained that density through time ex fig 5 vefsna norway 2 started at a low spawner density and increased through time ex fig 5 elbe germany 3 started at a medium to high spawner density and decreased usually to zero through time ex fig 5 adour france and 4 maintained a medium to high spawner density through time ex figs 5 and 6 meuse france using the dispersal parameters estimated through the expert knowledge survey there were no instances where the population declined to near local extinction and then later increased again for both species instances where populations declined to zero or collapsed corresponded to catchments with higher annual variability in hsi that often spanned the range of possible values this is in contrast to populations that maintained a consistent spawner density through time which had a relatively narrow range i e 0 4 to 0 8 of annual hsi values projected from 1951 to 2100 large differences in averaged projected trends for habitat suitability and spawner density existed between the two shad species for the two rcp scenarios figs 5 and 6 a alosa generally demonstrated a more variable and consistently lower value for habitat suitability across all catchments fig 5 while several individual catchments from north to south weser ems meuse escaut seine loire charente dordogne garonne minho and mondego had relatively high spawner density through time the majority of catchments were consistently at the lower range of possible values this is in contrast to a fallax which demonstrated a spawner density at the higher range across the majority of catchments fig 6 this trend was reflected in the projected hsi for a fallax which was high for most catchments except for several located in spain portugal and morocco e g odiel tinto piedras sado mira loukkos and sebou for this species hsi was seen to increase through time for many catchments especially in the northern extend of its range above approximately 48 n this temporal trend was less common for a alosa which often displayed high annual variability in hsi within a catchment for a alosa some catchments did display an increase in hsi through time however the opposite was also true and several catchments saw a decrease in hsi through time in addition latitudinal trends in hsi were less clear for a alosa than for a fallax while spawner density and habitat suitability were both dramatically different between the two shad species as detailed above trends in saturation rate were similar for both species the saturation rate was generally at one extreme or the other representing either zero a population crash or 1 the available habitat in that catchment is being fully utilized however some individual catchments did demonstrate annual variability in saturation rate ex blavet in france and guadiana in spain which both varied between 0 and 1 for a alosa which was seen more for a alosa than a fallax it is important to keep in mind that saturation rate does not reflect the size of the population but rather how the available habitat though scarce was being used by the population a high saturation rate close to 1 could occur regardless of the value of habitat suitability for both species many catchments started with a high saturation rate that quickly decreased over a short period of time as was demonstrated in figs 5 and 6 where the color rapidly shifted from yellow to dark blue this trend could occur when the population started at a large abundance and rapidly collapsed or when the habitat suitability and spawner density were relatively low in a catchment but the population was still as large as it could be given the value of habitat suitability when the value of habitat suitability was low it limited the population growth as could be seen for both species once a population collapsed saturation rate and density of 0 it did not later recover as would be indicated by an increase in spawner density and saturation rate these population collapses were much more prevalent for a alosa 37 than for a fallax 10 when considering the results from the three gcms averaged together for rcp 8 5 figs 5 and 6 the saturation ratio can also be defined as the comparison of the spawner abundances estimated by hydiad and the habitat model c sdm alone so dominance of values close to 1 in the heat plots indicated no lag between changes in hsi values and the response of the population model projections were similar between rcp 4 5 and rcp 8 5 for saturation rate spawner density and habitat suitability for both shad species figs 5 6 c2 and c3 the largest difference between the two scenarios related to the scale of change which was seen in the temporal trends for habitat suitability the amount of change that occurred between the earlier and later time series was more pronounced as expected for climate scenario rcp 8 5 than rcp 4 5 a good example of these differences can be seen for a alosa in the severn in england in figs 5 and c2 for rcp scenarios hsi and spawner density are in the mid to high end of their range starting at roughly 2070 however the values for both hsi and spawner density increase to consistently be higher for rcp 8 5 than rcp 4 5 however when considering trends across all catchments the difference in projected habitat suitability between the two rcp scenarios was negligible 3 4 sensitivity of total spawner abundance to model parameters results from the global sensitivity analysis were similar for the two shad species fig 7 the parameters related to dispersal i e mortality of emigrants m d i s p the probability of emigration γ and the shape β and scale α parameters for the dispersal kernel table 8 had negligible effects on the total spawner abundance summed across all years and catchments as indicated by the low values of both σ and μ for all of these factors the parameters related to population dynamics i e population growth rate r the allee effect λ and the maximum density of spawners per unit area d m a x demonstrated a nonlinear effect or interaction because of a high value for both σ and μ 3 5 model evaluation based on the saturation ratio metric for allis shad the shape of the saturation ratio distribution is bimodal at the extremes while a unique mode around 1 was depicted for twaite shad fig 8 regarding the confusion matrix between observed abundance and srhsi 1 the error rate was 13 and 5 5 for allis and twaite shad respectively when considering as estimation errors only records above the diagonal errors in the upper half of the matrix indicated observed abundances that overpassed the saturation ratios calculated on the species maximum abundances without any anthropogenic pressures table 10 4 discussion 4 1 development of the hydiad model 4 1 1 novel approaches for the study of spatial dynamics in diadromous species in this paper we demonstrate for the first time how a hybrid model offers an alternative way to estimate spatial dynamics thereby integrating how diadromous species move through a spatial matrix of catchments connected by the oceanic domain as far we know previous attempts at integrating multiple habitats are restricted to sdms so called multi state sdm frans et al 2018 and this is the first time a multi state habitat model has been coupled with population dynamics and dispersal processes in fish species while the hydiad model was developed following the steps laid out by singer et al 2018 for hybrid species distribution models several novel approaches were developed to address difficulties related to knowledge gaps and the fact that dispersal for diadromous species was measured between catchments that were different sizes and distances apart rather than through a continuous landscape meaning it could not be estimated using the grid cell approach often used for terrestrial species de cáceres and brotons 2012 visintin et al 2020 even if this model is difficult to calibrate since it simulates a potential rather than an observable abundance the confusion matrix between observed abundances provided by the eurodiad database and classes of simulated saturation ratios with hsi 1 showed a limited number of discrepancies table 10 leading to a quite good confidence in the model for data poor species the availability of species specific data related to biological processes can be a major knowledge gap and expert knowledge elicitation has been suggested as a possible solution gallien et al 2010 singer et al 2018 the current study successfully used this approach on two aspects i to parameterize the hydiad model for two shad species section 2 3 4 and ii to fill data gaps related to both historical presences absences and physical characteristics of catchments section 2 2 1 lastly given that marine predictor variables have been neglected in previous studies on diadromous species range shift responses the abiotic niche for the two shad species was estimated using a suite of environmental predictor variables that covered the entire species life cycle the inclusion of marine and freshwater predictors led to high predictive accuracy when estimating habitat suitability for both species 4 1 2 applying hydiad to other species and geographic regions the hydiad model could be applied to other anadromous species or modified to fit other life history approaches such as catadromy i e species that reproduce at sea and grow in rivers for data rich species occupancy information and population and dispersal parameters could likely be found in the scientific literature so the most time consuming process would likely be the downscaling of gcms to the appropriate regional scale in order to obtain simulated data for environmental predictor variables another potential time consuming process is the calculation of the distance matrix which would require a longer computation time if a larger number of catchments were added increasing the number of catchments included in the calibration of the c sdm will provide a better representation of the range of possible conditions that a species experiences and improve the estimation of habitat suitability the current study provides an approach for filling in knowledge gaps for data poor diadromous species in which parameters for population and dispersal dynamics may not be readily available in the primary literature for the spatial scale used in the hydiad model the use of iterative expert knowledge elicitation could be an alternative source of information in those cases the results of the expert knowledge survey in addition to the equations and r script for calculating the weighted group mean appendix a could be used to apply the hydiad model to other diadromous species and geographic regions however the ecological processes behind the parameters being estimated are complex and the spatial scale covered by the model was large thus extensive feedback was necessary to develop the wording of the questions used in the expert knowledge survey to address this the survey consisted of multiple rounds with a workshop in between to make sure that the survey questions were interpreted correctly by the respondents after presenting the preliminary group results and discussing the survey questions in both the workshop and one on one interviews many participants changed their initial answer to particular questions based on a better understanding of what the authors intended to estimate to further address this future applications of this expert knowledge survey may benefit from two rounds of one on one interviews rather than an initial questionnaire followed by individual interviews while this kind of approach might be necessary in poor data situations it has to be recognized that there are several potential pitfalls to consider when using this type of expert survey process for example there is the concern that subjectivity and speculation in the answers provided by experts may lead to biased results in addition it is important to consider the ecological paradigm implicit in estimating parameters as the hydiad model was developed to apply the same values for population and dispersal parameters across all populations and catchment scale differences were related to environmental conditions in the current study these biases were addressed by using a group of experts studying shads across a large spatial scale multiple steps to the survey and a weighting scheme for the results that allowed participants to rate the level of confidence they had in their answers for each species and question combination scolozzi and geneletti 2012 which allowed for a more precise weighting scheme in the calculation of group averages although there is evidence for rapid adaptive evolution of species in response to climate change lavergne et al 2010 the hybrid model used in this study did not account for the adaptive potential of species phenotypic plasticity and ecological processes such as competition positive interactions and trophic relationship which can affect rates of species range shifts lavergne et al 2010 for data poor species finding historical presence absence information can be difficult and time consuming in the current study historical presence absence information was available for the two shad species because of an existing database https data inrae fr dataset xhtml persistentid doi 10 15454 ivvaic barber o malley et al 2022 this database required enormous effort from a large group of students and project partners to create and validate but this work will allow the hydiad model to be applied to other diadromous species both within the same area used in the current study as well as other areas in europe while many diadromous species historically supported a freshwater commercial fishery that should be a matter of public record the temporal resolution of these data may be coarse in addition for species that are similar in appearance it may be difficult to distinguish based on historical records whether one or both species were present and making inferences based on the historic species range can reduce the fine scale resolution of the occupancy data used to calibrate the c sdm e g doadrio et al 1991 2011 4 2 using hydiad to estimate future projections of shad distributions 4 2 1 habitat suitability the trends seen in the estimate of habitat suitability and shifts in distribution for both shad species in the current study are similar to what was estimated by lassalle et al 2008b and lassalle and rochard 2009 using c sdms suggesting that habitat suitability may play a larger role than population dynamics and dispersal in the distribution of these two species this point was also suggested by the dominance of saturation ratios close to 1 in the distributions across catchments indicating that variations in habitat suitability were quickly followed by changes in population abundances in relation with the relatively high specific population growth rates in contrast to these previous two c sdm studies surface area only accounted for roughly 9 of the relative influence for both shad species in the current study and precipitation 17 5 for a alosa and 21 8 for a fallax and altitude at the source 16 9 for a alosa and 18 1 for a fallax which together can act as a proxy for river flow lassalle and rochard 2009 pont et al 2005 had a large influence mixed layer depth which was not included in the previous studies was also influential in the current study 21 6 for a alosa and 11 5 for a fallax with a higher habitat suitability when mixed layer depth was lower studies on the moroccan coast have suggested that shallow mixed layer depth corresponds to high cold water upwelling activity bessa et al 2019 which could also lead to lower temperatures nykjær and van camp 1994 and higher productivity and food availability in this region lassalle et al 2008a similar to the previous two studies general distribution trends in the current study indicated that a fallax is expected to increase in abundance and a alosa is expected to decrease in abundance under xxist century climate change scenarios the current model estimated relatively high values of habitat suitability for a fallax across its range the lowest and most variable estimates for habitat suitability and spawner density for a fallax were seen in catchments in southern spain southern portugal and northern morocco for a alosa the two previous studies predicted drastic declines in suitable habitat within the southern range of the species in the current study habitat suitability for a alosa was consistently lower across catchments and more variable through the entire modeled timeframe 1951 2100 especially for basins in spain portugal and morocco for this species some of the response curves used to estimate fitted values from the boosted regression trees were relatively steep for several of the environmental predictor variables and this can result in a higher estimate of habitat suitability when there is only a relatively small change in the value of that variable to address this future applications of hydiad could include process based habitat suitability model under the ecological niche theory framework citores et al 2020 and to downplay the influence of these steep slopes on estimates of habitat suitability 4 2 2 dispersal dispersal parameters probability of emigration and mortality rate for emigrants during dispersal estimated from the expert knowledge survey indicated that long distance dispersal events were rare for both shad species this was supported in the literature by genetic and microchemistry studies that indicated shads displayed a high rate of natal homing alexandrino et al 2006 ices 2015 martin et al 2015 high homing rates may decrease the ability of shads to adapt to climate induced changes in habitat suitability by preventing populations from shifting their distribution take advantage of previously unoccupied habitat that becomes suitable however despite the indication of natal homing there is also evidence that suggests some dispersal of a alosa between catchments that were as far apart as 2000 km randon et al 2017 meaning that while rare long distance dispersal does occur previous studies have indicated a lack of fine scale genetic structure among nearby a alosa populations alexandrino et al 2006 jolly et al 2012 martin et al 2015 which may be the result of the small number of individuals that disperse longer distances it is unlikely that many individuals disperse across very long distances though as genetic and morphological differences have been observed between populations in france and those in portugal alexandrino et al 2006 lassalle et al 2008a previous studies have indicated that a fallax has a higher level of genetic structure ices 2015 and a greater rate of natal homing alexandrino et al 2006 jolly et al 2012 which may limit its ability to colonize newly suitable habitats jolly et al 2012 found that neighboring populations in the uk severn and wye displayed no genetic differentiation while the severn was genetically distinct from several populations located at a farther distance tywi usk and irish catchments davies et al 2020 found that 33 out of 34 a fallax tagged in 2018 from the severn returned to this catchment in 2019 however in tagging studies capture location may not represent natal origin nachón et al 2020 and there may still be long distance dispersal between major estuaries davies et al 2020 for shads not all river catchments in the european atlantic area listed in the ccm river and catchment database data europa eu were included in the model projections many small and medium sized catchments were not incorporated into the dispersal matrix because simulations only used catchments included in eurodiad 4 0 in hydiad smaller catchments would not produce a large number of dispersers because this value was based on an estimate of productivity directly related to surface area and dispersal mortality applied using the distance between a pair of catchments out of the 18 769 pairwise distances in the dispersal matrix only a small proportion 0 06 for a alosa and 0 03 for a fallax appendix d were less than the maximum emigration distances estimated in the expert knowledge survey so while the dispersal kernel allowed a small proportion of emigrants to move past this maximum distance these spawners did not survive to reach a further catchment if the dispersal matrix included more catchments that were each a shorter distance away it is possible that the resulting increase in the number and survival of dispersing spawners could allow surrounding catchments to be rescued from the allee effect due to an annual influx of dispersing fish kanarek et al 2015 recent studies have suggested that small catchments could be more important for the resilience of diadromous species than previously thought melo merino et al 2020 copp et al 2021 and so future applications of the hydiad model would benefit from the inclusion of more small catchments in future projections 4 2 3 disentangling habitat suitability and population and dispersal dynamics it is difficult to disentangle the effects of habitat suitability on the estimates of spawner abundance from those of population and dispersal dynamics within a given catchment within the hydiad model the allee effect was imposed by reducing the number of spawners that were participating in reproduction within a given catchment potential demographic rescue from the allee effect due to immigration was limited for both shad species because of interactions between dispersal capabilities habitat suitability and annual stochasticity population growth a low proportion of spawners participating in reproduction and the focus on medium and large sized catchments included in the distance matrix for both species dispersal from a given population was low and was generally restricted to nearby catchments when environmental conditions were limiting the number of spawners in a catchment were reduced to the point where recovery was not possible because the population could not surpass the threshold set by the allee effect if habitat suitability was low for several years within a short time period spawner density decreased and was often unable to recover regardless of an increase in habitat suitability in later years the combination of high habitat suitability relatively high population growth rate and low allee effect allowed most a fallax populations to persist in contrast many a alosa populations experienced consistently low habitat suitability and this led to low estimates of spawner density and many catchments with population crashes this is demonstrated in the a alosa population crashes early in the time series in catchments with very high annual variability in habitat suitability along the northern coast of spain cantabrian coast these rivers are generally short and steep with high water flow doadrio et al 2011 dr david josé nachón garcía personal communication and while these catchments had spawners present at the start of the model simulation indicating that the model was correctly simulating the presence absence data used for calibration these populations quickly dropped below the threshold imposed by the allee effect and were unable to recover surrounding populations in spain portugal and france either because of a low spawners abundance or too long of a long distance were unable to produce enough dispersers for the cantabrian populations to recover this specific dynamics simulated in several catchments reinforce the need in new approaches that do not limit the interpretation to single habitat suitability this conclusion might become more apparent when considering species with a slower turnover rate as highlighted in the present study fig 8 by the lower peak at sr 1 for allis shad than twaite shad the former having a lower population growth rate than the latter for such a group of species regional dynamics driven by specific ecological and physical features will turn more frequent in the species range as not masked by the population ability in quickly recovering from unsuitable conditions leading to question the underlying mechanisms 4 3 conclusion the hydiad model was developed to estimate the distribution of diadromous species under climate scenarios and was successfully applied to two shad species in the atlantic area of europe estimated trends indicated that under xxist century climate scenarios habitat suitability for a fallax is expected to increase which would likely lead to an increase in abundance except possibly in the southernmost catchments of this species current range in morocco portugal and spain model estimates indicated that habitat suitability for a alosa is expected to decrease as well as display higher rates of annual variability particularly in southern catchments as anthropogenic factors were not modeled for the two shad species these results may be exacerbated by problems with river connectivity or water pollution future studies can apply the hydiad model to other diadromous species including data poor ones using species specific estimates of population dynamics and dispersal parameters credit authorship contribution statement betsy barber o malley data curation validation formal analysis methodology writing original draft géraldine lassalle conceptualization methodology funding acquisition supervision writing review editing guillem chust conceptualization methodology writing review editing estibaliz diaz funding acquisition writing review editing andrew o malley methodology formal analysis writing review editing césar paradinas blázquez data curation validation javier pórtoles marquina data curation validation patrick lambert conceptualization formal analysis methodology funding acquisition supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this study was funded by the atlantic area interreg project diades many thanks go to all the experts that help with the validation of the eurodiad 4 0 database see the list in barber o malley et al 2022 we are also grateful for the time experts spent on answering the expert knowledge survey on population dynamics and dispersal the world climate research programme s working group on coupled modelling is responsible for the fifth coupled model intercomparison project and we thank the climate modeling groups for producing and making available their model output eurocordex is the european branch of the international cordex initiative which is a program sponsored by the world climate research program wrcp to organize an internationally coordinated framework to produce improved regional climate change projections for all land regions world wide supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2022 109997 appendix supplementary materials image application 1 
24409,a fish has to grow in an aquatic environment with both positive and negative regulatory mechanisms under stress metabolic upregulation acts as a positive regulatory mechanism while metabolic downregulation acts as the negative regulation these two mechanisms work as a response to the stress on the fish body the tsoularis wallace tw model can portray the two aforementioned metabolic regulations but is not applicable for fish growth under chronic stress if the stress is chronic then the fish body develops a metabolic depression in addition to these two aforementioned metabolic regulations we capture stress effects through regulators similar to the regulators of population ecology in a proposed generalized model pgm at the same time the chronic stress induced metabolic depression is considered in the pgm through a harvesting like term in this study our pgm can capture all the conceptual phenomenon to describe the real data sets well like the tw model our pgm has no analytical solution therefore we propose a linearized model plm from the pgm to overcome this problem we used the mean fish body length data sets for four locations as used in chakraborty et al 2017 the relative growth rate rgr profiles of the plm better fitted to the observed rgr values of the real data sets than the previously used models in three of the four cases comparing the fish body growth with the motion of a particle in newtonian mechanics we formulate the three broad phases lag log and stationary ending time points and the corresponding fish lengths we also obtain the point of inflection regarding time and the corresponding length we calculate all of these results for the real data sets the metabolic downregulation and capacity limitation of our model cause a decreasing trend in maximum body length of the fish upon simulation metabolic depression rate parameter of our model is also a key control of the maximum body length of fish as per the simulation graphical abstract keywords growth curve extended logistic fish growth growth phases newtonian mechanics 1 introduction the fish body grows following a principle similar to the population and ecosystem growth under stress wendelaar bonga 1997 the stress of the fish refers to changes in physiological activities under environmental perturbations the response of the fish body to the stress is very similar to that of terrestrial vertebrates so stress response in fish growth has been a significant research interest and a bridge between ecology and physiology predicting fish growth is mathematically challenging under different stress response mechanisms jørgensen 1976 chakraborty et al 2017 thus a growth model opens a new direction in dynamic system modeling if it is conceptualized based on different stress responses overall there are two types of stress response mechanisms an internal biochemical mechanism and an external response mechanism in growth the fish body experiences alteration in the homeostasis of various physiological activities through the internal mechanism as a result the external mechanism reduces the growth rate of fish barton 2002 wendelaar bonga 1997 pickering 1993 van weerd and komen 1998 abdel tawwab et al 2019 these stress responses are canonical hypothalamus secrets corticosteroids and catecholamines are synthesized as a primary response heat shock protein hsp is synthesized as a secondary response the tertiary response level involves a change in growth rate by further metabolic regulations also if the stress is chronic the fish body develops a permanent drop in metabolic activities in addition to these regulations pickering 1993 wendelaar bonga 1997 barton 2002 previous models have considered only the primary and secondary responses as an allometric function of time to portray the change in growth this change may be upregulation or downregulation in different cases however wendelaar bonga 1997 reviewed that chronic stress always inhibits the growth rate by only reducing metabolism commonly known as metabolic depression this metabolic depression on fish growth is absent in the previous modeling framework the analogy between the stress responses and regulators of population dynamics helps to build a new framework for predicting chronic stress responses the capacity limitation of the fish body is similar to the population carrying capacity both account for size under limited resources the upregulation of metabolism in the fish body is similar to cooperation in the population both facilitate the growth rate the downregulation of metabolism in the fish body is analogous to biotic potential regulation in population ecology both control the growth rate the metabolic depression i e the detrimental effect of chronic stress on the fish body is comparable to the harvesting effect on population ecology both of them are inhibition of growth for reasons other than resource limitation therefore modeling the growth data of a fish body is parallel yet similar to the population and ecosystem modeling there is already a substantial modeling framework for fish data in the literature from single dimensional logistic to multi dimensional system equations chakraborty et al 2017 xu et al 1999 jørgensen 1976 the multidimensional system equations are most useful if all the stresses are reported and finite however such reports are often unavailable and identifying unreported stresses is hard therefore the single dimensional models are better options for cases where the data of multiple stressors are absent the logistic model proposed by verhulst 1838 has successfully described different types of population growth ranging from cells to species thus it seems to be a good choice for fish growth modeling too bacaër 2011 however this law cannot describe asymmetric growth due to the lack of parameters to separately represent the upregulation and downregulation of metabolism thus the logistic law cannot properly portray growth due to stress responses kot 2001 zhang et al 2015 simon 2019 the capacity limitation of logistic law represents the maximum body size under limited resources so it fails to separate chronic stress that has originated due to reasons other than resource limitations for example a fish shows stress responses through prolactin growth hormone and mineralocorticoid synthesis if the resource e g food and salinity is too low irrespective of the limited resources the fish may also suffer from diseases a fish suffering from a disease chronic stress secrets catecholamines causing a metabolic depression in addition to other metabolic regulations thus the growth rate is reduced as a negative feedback of chronic stress these metabolic regulations and metabolic depressions are two sets of separate stress response mechanisms the capacity limitation of the logistic law is not sufficient to capture these metabolic regulations and depression a logistic law must have an extension term representing this metabolic depression of chronic stress on growth the metabolic regulations can be incorporated as size dependent parameters moreover the interplay of two different stress response pathways may lead the fish body s growth trajectory to various sigmoidal forms blumberg 1968 and tsoularis and wallace 2002 proposed generalized versions of logistic law to portray both symmetric and asymmetric growth profiles by incorporating parameters for up and down regulations of metabolisms in physiological growth since conceptually these two laws also lack separate parametric representations for the aforementioned metabolic depression these laws also need further extensions to portray fish growth under chronic stress other than resource limitation such an extension has been added to the logistic law as a harvesting term kot 2001 the harvesting term of this extended logistic law represents additional fish mortality for fish catching the harvesting model is primarily applicable in pisciculture nevertheless it can portray growth data from other fields as well considering the harvesting term as additional negative feedback due to external force s roy et al 2021 thus an extension like the harvesting term may be a better choice to portray further metabolic depression due to chronic stress than adding a time covariate extension previously used by chakraborty et al 2017 and bhowmick et al 2014 their time covariate extensions are specific for response time and adaptation to a new environment a new environment poses stress due to the potential presence of toxic material food scarcity changing dissolved oxygen levels and the chance of new infection each of these factors acts through different physiological pathways so stress response ability of the fish varies with these factors so the time covariate extensions of chakraborty et al 2017 and bhowmick et al 2014 can only capture one stress at a time overall the existing fish growth models including chakraborty et al 2017 and bhowmick et al 2014 focus on response steps primary secondary and tertiary and period but ignore variability of stresses and additional metabolic depression due to chronic stress note that the response may also vary with the fish body itself for example the level of corticosteroids may vary for two different fish body sizes abdel tawwab et al 2019 wendelaar bonga 1997 fish that can adapt easily may regulate their response to stress by changing corticosteroids heat shock protein levels and finally the metabolic rate so a model should combine the concept of stress regulation based on the response pathways and time the regulation of stress response may alter the period of the fish growth and its different phases wendelaar bonga 1997 any growth curve shows at least three major phases lag log and stationary recently paul et al 2021 provided an idea of ending time points for each of these phases and the corresponding population sizes in this case body sizes at each of these points the authors proposed a methodology to estimate the lag phase ending time laet and corresponding size laes lag phase ending size log phase ending time loet and corresponding size loes log phase ending size steady state initiation time ssit and corresponding size ssis steady state initiation size for both the gompertz and the theta logistic growth curve models however a new model for fish growth may follow the same estimation procedure for the time points but those time points expression may differ from the existing one due to the metabolic depression for the chronic stress the analytical solution of any growth model must be known to find each phase ending time point and the corresponding size followed by the growth equation like the tsoularis wallace tw model the proposed generalized model may not be solvable we can linearize the model for an analytical solution in such a case although the linearized model may give each of the phase ending time points and the corresponding sizes due to the existence of the solution it must portray the real data set to be considered for further research and application considering the aforementioned mathematical lacunae to portray stress response regulation we propose a new growth law and linearize it using sets of real data and our proposed linearized model plm we aim to evaluate and compare the superiority of the plm with its preceding models to illustrate ecological growth data studying the property of the model parameters in terms of equilibrium and inflection points we aim to find representatives of different sizes and periods of growth under stress responses the point of inflection time pit and corresponding size pis point of inflection size laes loes ssis laet loet and ssit for the data in use 2 model formulation the single dimensional harvesting model is most useful to predict and understand the growth dynamics for a data set with unknown individual environmental stressors bhowmick et al 2014 chakraborty et al 2017 for a single dimensional model bhowmick et al 2014 suggested to use the latest generalized version of the logistic law by tsoularis and wallace 2002 which can be written as below 1 d n t d t r n t α 1 n t k θ ν here n t is the body size of the fish at t time point the parameters r and k are the intrinsic growth rate and the capacity limited size of the body respectively originally tsoularis and wallace 2002 considered α θ and ν as positive real numbers later bhowmick et al 2014 2015 and other studies suggested the allometric powers in the tsoularis wallace model henceforth tw model can represent three key growth regulators these growth regulators are manifestations of metabolic and other physiological regulators in this case metabolic upregulator α capacity limited growth regulator θ and metabolic downregulator ν bhowmick et al 2015 blumberg 1968 richards 1959 sibly et al 2005 2007 note that these regulators are named after their corresponding physiological and metabolic pathways but their action in the model is on growth rates the metabolic regulators can control the growth for any stresses as the manifestation of primary and secondary responses the capacity limited growth regulator control the satiation in the growth due to stress that is associated with limited resources different growth data can interpret these regulators as different phenomena for example the metabolic upregulator indicates the degree of body size increase the capacity limited growth regulator represents the degree of satiation in growth under limited resources but indicates capacity limitation due to environmental constraints such as temperature water quality and space for growth data of fish body sibly et al 2005 richards 1959 the metabolic downregulator of the tw model can be interpreted into a set of several adaptive strategies for different types of growth data tsoularis and wallace 2002 for example a fish body can downregulate its metabolism in an adverse environment to delay its growth for achieving capacity limited body size bhowmick et al 2014 used gompertz law instead of the tw model arguing about the approximated inflection point of the latter bhowmick et al 2014 and chakraborty et al 2017 both considered multiplicative stress effect on the fitness curve the main drawback of the bhowmick bhattacharya extended gompertz model bbegm is that the analytical solution exists only for the positive integer values of the stress effect regulator bhowmick et al 2014 however it should be able to take the negative values as well as any positive real numbers in reality chakraborty et al 2017 overcome this problem and proposed two growth models viz proposed extended logistic model pelm and proposed extended gompertz model pegm in the absence of the stress effect the form of the pelm and pegm take the fitness function as used in the logistic and the gompertz model respectively however none of these two functional forms take the chronic stress induced metabolic depression separately they consider the effect of a stress by a single parameter regardless of its chronicity to overcome this we have to consider metabolic depression with chronic stress separately as different regulatory model parameters if we incorporate additional negative feedback representing chronic stress induced metabolic depression to the tw model 1 the growth equation becomes 2 d n t d t r n t α 1 n t k θ ν c n t β the parameter c can represent the suppression rate of body growth in terms of length due to chronic stress induced metabolic depression note that chronic stress induced metabolic depression suppresses the growth rate but it cannot decrease the length of the fish therefore this additional negative feedback part of the model cannot exceed the value of the tw part in reality since the metabolic depression can affect an individual s growth to a different degree based on the individual s ability to withstand chronic stress the negative feedback suppression effect depends on the allometric power of the body size the allometric power β represents the degree of body size dependence of additional negative feedback suppression on growth due to chronic stress induced metabolic depression in other words this regulator represents the adaptability of the fish body to withstand chronic stress since metabolic depression reduces the growth as negative feedback of chronic stress at a final level it manifests the tertiary stress response in this model the fitness or the relative growth rate rgr of this proposed generalized model pgm at the body size n t is r n t 1 n t d n t d t 3 o r r n t r n t α 1 1 n t k θ ν c n t β 1 2 1 linearization of the model we transform the pgm to the following quadratic linearized form 4 d n t d t ϕ n t 2 ψ n t η where ϕ α r ν θ k α 2 ψ 1 ν ν θ α r k α 1 1 α r ν θ k α 1 β c k β 1 and η 1 α 1 ν ν θ r k α 1 β c k β see appendix a for detailed transformation the plm eq 4 captures all of the regulator described earlier let eq 4 have two real roots γ and δ then this equation can be written as 5 d n t d t ϕ n t γ n t δ after solving this equation we get the analytical solution of the linearized model as 6 n t γ δ n 0 γ n 0 δ e ϕ γ δ t 1 n 0 γ n 0 δ e ϕ γ δ t in this proposed linearized model plm for growth data with the effect of stress responses we consider γ ψ ψ 2 4 ϕ η 2 ϕ and δ ψ ψ 2 4 ϕ η 2 ϕ among these two roots γ is the stable equilibrium point and δ is the unstable equilibrium point see appendix c therefore for any sustainable body followed this linearized growth model the initial size must be greater than the δ value and the body try to stabilize at the size γ with the inflection point at the size ψ 2 ϕ see appendix d note the plm is a size covariate growth law for this size covariate law the fitness function or the rgr value is represented by r n t ϕ n t ψ η n t where r n t is the rgr value at the body size n t this size covariate rgr functional form can also be written as r n t α r ν θ k α 2 n t 1 ν ν θ α r k α 1 1 α r ν θ k α 1 β c k β 1 1 α 1 ν ν θ r k α 1 β c k β n t the time covariate form of rgr of the same model is as follows r t ϕ γ δ n 0 γ n 0 δ e ϕ γ δ t 1 n 0 γ n 0 δ e ϕ γ δ t γ δ 1 n 0 γ n 0 δ e ϕ γ δ t γ δ n 0 γ n 0 δ e ϕ γ δ t γ δ where r t is the rgr value at the time point t remark 1 in the quadratic linearized form ϕ 0 for the plm again for the extended logistic model the model parameters α θ and ν are 0 therefore ϕ 0 γ and δ are well defined by the model parameters r k c α θ ν and β remark 2 the linearization is not valid for certain parameter combinations our linearized technique is not applicable for the exponential model exponential model itself is a linearized model with an existing analytical solution there is no need for the further approximation again for ν 0 the model becomes d n t d t r n t α c n t β this model can be approximated to a first order linearized form d n t d t a n t b with a α r k α 1 β c k β 1 b 1 α r k α 1 β c k β and the analytical solution is n t n 0 e a t b a 1 e a t see appendix b for a 0 n t and for a 0 n t b a transformability of the model by tuning the regulator parameter values the model 4 can be traced back to its harvesting like form 2 pgm it is noteworthy to mention that eq 2 can be transformed into any form of extended logistic model as shown in fig 1 out of all the branches of growth curves that the proposed model can offer we emphasize the linearized version 4 as it has an analytical solution without compromising the generic properties of tsoularis and wallace 2002 framework 3 model fitting to the data set data set the pgm emphasizes two properties of growth data metabolic regulations and additional negative feedback suppression on growth due to chronic stress induced metabolic depression we choose a fish growth data set of cirrhinus mrigala which has been used to portray other growth models this choice of the data set has two benefits first it may have metabolic regulations to show both symmetric and asymmetric nature to showcase the flexibility of the model second by comparing the data with previously fitted models pegm and pelm with the plm we can judge the superiority of the plm the data set belongs to the experiment performed by the kalyani fish farm details in the supplementary material this fish growth data set can be divided into four subsets for four locations with different aquatic environments water qualities different stress levels sunlight exposure induced cortichosteroidogenic stress different access to foods planktons since there was no additional food source the fish could either up or downregulate metabolism for the food in that case we can expect changes in the value of α and ν for the four locations if the sunlight induced stress is high the fish may experience metabolic depression due to chronic stress only in that case we expect a change in the value of β the fish body can overcome the harshness of water quality by adjusting the mucous secretion rates osmoregulation or other physiological procedures these physiological procedures can change the capacity limitation of growth as adaptive measures in fish body thus we can expect different values of θ for four different locations due to different adaptabilities of fish in those locations fitting method we use grid search algorithm gs and nonlinear least square nls for data fitting details in appendix e for the pgm we perform grid search and choose the parameter values in a grid for the least residual sum of square rss values for the prediction against observations we fit the plm eq 4 separately for size rgr profile any size rgr profile being an inherent property of the growth is least erroneous during model fitting sibly et al 2005 bhowmick et al 2015 2016 we also used the nonlinear least square nls regression algorithm for the observed size rgr data fitting with the plm using the r software r core team 2013 we use both grid search and nls algorithms for the plm fitting with the observed time rgr profile the time rgr profile of model fitting helps us directly compare the plm with existing time covariate models such as pegm and pelm based on the akaike information criterion aic values akaike 1974 4 profiles of the proposed models upon fitting we used the mean values for both the observed size and the observed rgr values with the standard error bar in the figures for all four locations figs 2 5 represent the results of size rgr fittings of pgm and plm figs 2 and 4 show the fitted size rgr profiles for the pgm and plm respectively while figs 3 and 5 show their predicted time size profiles for the estimated parameters from size rgr fittings of figs 2 and 4 respectively for the observed size rgr data fitting with the pgm we use only the grid search algorithm as the number of data points is low for the pgm however for the observed size rgr data fitting with the plm we used the nls algorithm using the grid search estimated values as in this case the estimated values number is too low comparatively to the observed size rgr data points fig 6 shows the result of time rgr fitting along with visualization of comparative fitness profiles of pegm and pelm with the plm the estimated values of parameters especially the regulators are different for each of the four locations figs 2 and 4 in other words the metabolic upregulation capacity limitation metabolic depression due to chronic stresses are different under environmental conditions and stress levels for all four locations notably location c has a decreasing size rgr profile while the locations a and b have concave downward profiles and the location d has a bit erratic profile no specific profile is specifically observed in location d based on the rss the model 2 best describes location b and is least descriptive for location c before linearization upon fitting fig 2 we have to estimate three constant values ϕ ψ and η for the observed size rgr data fittings with the plm all the estimated values are significant for the locations a and b with very low and negative aic values the aic values for the location c and d are too low and negative however all of the estimated values are not significant although the time size predictions fig 3 using the estimated parameters from fig 2 appears to be visually good forecasts the rss of the time size prediction from the generalized model further reduces after linearization based on the grid search estimated values only note that upon prediction of time size profiles the rss values for the prediction by plm using the estimated model parameters from nls methods are greater than the rss of prediction by pgm and plm using estimated model parameters from the grid search one of the reasons for poor predictions of time size profiles may be that the time size profiles are inherently more erroneous than the size rgr profiles the fitted curves portray the visuals of the size rgr data better upon the fitting after linearization the plm is best descriptive for locations a and b the plm is comparatively poor descriptive for locations c and d 4 1 comparison with previous models chakraborty et al 2017 already showed that the pegm and the pelm are best descriptive for the fish growth using the same data set fig 6 further proves that the linearized model is superior to the pegm and pelm in terms of accuracy to portray the time rgr profile in three of the four cases the aic values are least for the plm for three of the four locations here we also use a grid search algorithm for the time rgr fitting of the plm as described in the appendix e but only consider three values ϕ δ and γ we used the grid search estimated values and ran the nls regression method using the r software r core team 2013 we found the statistical estimator named aic values for each of the four locations model fittings chakraborty et al 2017 already calculated the aic values for the pegm and pelm models along with the other growth models gompertz logistic and bbegm and compared the models fitting for each of the four locations the plm s estimated values ϕ δ and γ are all significant for locations a and b with aic values less than the pegm and pelm for the observed time rgr data fitting therefore the plm describes the data set better than the previously used models for the above two locations a and b however the plm does not describe the location c data set as the aic values are greater than the pegm and the pelm with the two insignificant model parameters ϕ and δ out of three the aic value for location d is less than the pegm and pelm but the value of ϕ is not significant the reason for that is that the observed time rgr profile is erratic the model parameters a and b of both pegm and pelm are not significant also like the plm chakraborty et al 2017 for the plm fitting with the location d time rgr profile the number of the insignificant parameter is only one therefore we can say the plm model describes the location d data sets better than the pegm and the pelm the variation in regulators value for the different locations indicates different trends that may arise in a data set and portray the model so we propose the following lemmas based on the different rgr trends we can find from the data set using the proposed model lemma 1 for the plm we get the rgr profile is linearly decreasing function of the body size for α 1 β 1 and for the positive values of both θ and ν appendix f the fig 7 a shows the linearly decreasing rgr profile lemma 2 for α 1 β 1 and 1 ν ν θ 0 we obtain non monotonic rgr profile for the plm the rgr profile is concave downward fig 7 b the extrema of the rgr profile is obtain at n t η ϕ appendix g lemma 3 for α 1 and β 1 we obtain the concave downward rgr profiles with maxima of the rgr at n t η ϕ appendix g the green line of the fig 7 c represents the concave downward rgr profile for α 1 and β 1 lemma 4 for η 0 the rgr profile of the plm is concave upward appendix h this result happen for the cases a α 1 β 1 and 1 ν ν θ 0 b α 1 β 1 and 1 ν ν θ 0 c α 1 β 1 and 1 ν ν θ 0 in this cases the fitness is maximum at the initial body size fig 8 5 connection with the particle motion the lag log and stationary are the three broad phases of any growth dynamics buchanan and cygnarowicz 1990 gave an idea of the lag phase ending time point for the bacteria population like the bacteria population each phase ending time point and the corresponding size also have immense importance for the fish body paul et al 2021 give an idea about the log phase ending time point and the stationary state initiation time point for the theta logistic and the gompertz growth curve models after that kundu et al 2021 uses the same concept of geometry and newtonian mechanics and finds the optimum food concentration for artemia sp according to the literature the growth acceleration similar to the acceleration of particle motion is the key regulator for the optimization of the body sizes for each of the three phase ending time points paul et al 2021 kundu et al 2021 we observe that the plm fitted the fish body growth data better in section 4 we may compare the changes of the body sizes as per the plm growth trajectory with a particle motion in newtonian mechanics to better understand the time size and size acceleration profile here we can write the velocity of body growth v t as 7 v t d n t d t ϕ n t 2 ψ n t η therefore the acceleration a t can be written as a t d v t d t d 2 n t d t 2 2 ϕ n t ψ d n t d t 2 ϕ 2 n t 3 3 ϕ ψ n t 2 2 ϕ η ψ 2 n t ψ η from this we get 8 d a t d t 6 ϕ 2 n t 2 6 ϕ ψ n t 2 ϕ η ψ 2 d n t d t at the extrema of the acceleration d a t d t 0 therefore at the extrema we obtain n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ and n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ among these two body sizes the acceleration will be maximum at n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ this body size is the lag phase ending size laes again the acceleration will be minimum at n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ this body size is the log phase ending size loes let t e l o t e l a t s s t and t i n f l are the log phase ending time point lag phase ending time point stationary state initiation time point and time point at the inflection body size respectively therefore we get t e l o 1 ϕ γ δ log n 0 δ n 0 γ 3 ψ 6 ϕ γ 3 ψ 2 12 ϕ η 3 ψ 6 ϕ δ 3 ψ 2 12 ϕ η t e l a 1 ϕ γ δ log n 0 δ n 0 γ 3 ψ 6 ϕ γ 3 ψ 2 12 ϕ η 3 ψ 6 ϕ δ 3 ψ 2 12 ϕ η t s s t γ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ ϕ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ 2 ψ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ η t e l o and t i n f l 1 ϕ γ δ log n 0 δ n 0 γ γ ψ 2 ϕ δ ψ 2 ϕ the derivation of these time points are in the appendix i using the estimated model parameters we calculate the threshold body size δ maximum size γ loes l e l o laes l e l a t e l a t e l o t s s t ssis l s s t t i n f l and pis l i n f l all of these values are in the table 3 for all of the four locations data sets here we study that the values of δ and the t e l a for the location c data set are negative such a negative value is practically impossible in terms of lengths we have already discussed that the fishes in location c might have been under chronic stress from the initial observation point actually there is no lag phase for the location c data set locations a b and d show realistic threshold fish body lengths although the estimated threshold values are significant in all of these three locations the estimated ϕ of the location d is not significant at 5 level of significance in the nls method so the calculation of threshold value from nls estimates may provide a wrong idea for location d the true threshold value for location d may also be different from the one calculated from grid search so it can be said with confidence that the location a allows fishes to achieve maximum γ maximum fish body length under stress at steady state among the locations a b and d the absence of tree shading might have resulted in less stress resulting in greater body size at steady state compared to the other locations the fig 9a indicates the lag phase ending point of inflection log phase ending and the stationary state initiation point with the corresponding time and the body sizes for the location a data set the acceleration is maximum at the lag phase ending body size point p e l a in the fig 9b and minimum at the log phase ending body size point p e l o in the fig 9b the fig 9b shows that the acceleration vanishes at the inflection point p i n f l the point p s s t in the fig 9b represents the acceleration at the steady state initiation body size 6 influence of model parameters on maximum body size the maximum body size of the fish occurs at the non zero stable equilibrium of the plm the economic benefit of a fish majorly lies in the body size of the fish therefore observing the body size of the fish under stress is very necessary to understand the change in the economic value of the fish since the model parameters determine the stable equilibrium we numerically simulate the influence of model parameters on maximum fish body size under stress details in supplementary material 1 the pgm and plm have two sets of parameters regulatory and rate limiting parameters regulatory parameters α θ ν and β represent the body s controlling ability or adaptability to respond to the stresses the rate parameters r k and c represent the response rate or the limit of response that a fish body shows the regulatory parameters are less likely to change the maximum fish body size than the rate and growth limiting parameters the experimental data of cirrhinus mrigala show the maximum fish body size under stress is much lower than that in natural habitat our simulation details in supplementary material suggests the regulatory parameters except ν have the least influence on the body size k represents the capacity limitation due to stresses associated with resources and c the metabolic depression due to chronic stress greatly varies the fish body size therefore a lower than expected maximum body length under stress is likely to be caused by a metabolic downregulation metabolic depression and its regulation due to chronic stress overall the simulation reveals the internal stress response through limiting parameters and regulation of metabolic depression therefore the economic value of fish majorly relies on the adaptability of a fish to withstand stress and its chronicity via metabolic regulations and depression 7 discussion fish growth modeling has long been a common topic for animal physiology and fish ecology focusing on the fish body under stress fish respond to stress through three canonical pathways primary or corticosteroid synthesis secondary or heat shock protein synthesis and tertiary or metabolic regulation followed by metabolic depression for chronic stress wendelaar bonga 1997 barton 2002 we proposed a generalized logistic model with additional negative feedback to portray the stress responses through both metabolic regulation and depression due to stress and its chronicity previous models considered the primary and secondary stress responses as a function of time that delays the growth through tertiary response chakraborty et al 2017 bhowmick et al 2014 our model overcomes the lack of direct representation of three different responses to the two types of stressors by incorporating them as regulatory parameters also our model can portray the different degrees of responses by different individuals to the same stressors using regulatory parameters thus our model portrays the data of body growth under stress responses more conceptually than the preceding models although conceptually sound the proposed model may suffer from parameter estimation for data sets with few data points also the pgm being mathematically an extension of the tw model is analytically impossible to solve therefore we linearize the pgm to get the analytical solution while still maintaining the conceptual properties of the pgm overall this plm proves to be also a better fit for fish growth data than the existing models and pgm the plm can capture both concavity and convexity in the rgr profiles of the data set from the estimates of our regulatory parameters it is clear that upregulating the metabolic activities is key to defining the shape of the rgr profiles rgr being a surrogate of fitness the nonmonotonic concave downward rgr profiles of the data set indicate the fitness of fish growth in locations a and b changes due to metabolic upregulation to a degree higher than 1 however in location c the fitness decreases monotonically therefore the metabolic depression due to chronic stress might have been already there at the first datapoint the rgr profile at location d is erratic and has no specific shape it is clear from the estimates that the metabolic downregulations for stress are approximately the same for fish bodies in all the locations the regulators of metabolic depression due to chronic stress are notably large for growth in location c than the other three locations this finding suggests that the fish respond to the stress to a greater degree and probably from earlier time point in location c the stress level is also high in location c preventing the fish body from increasing fitness with body size the plm provides the size of the fish attaining the maximum rgr hence maximum fitness this maximum rgr is very important for fish growth under stress chakraborty et al 2017 and tort 2011 and many others has emphasized on the immune suppression in fish that may lead to deterioration of growth of fish body the maximum rgr and its size from the plm provide the idea of body length required for the fish to be most resilient against stress the metabolism under stress must be downregulated to a degree of positive number in order to observe a decreasing fitness over size nonetheless this fitness property and sizes get a broader interpretation by comparing the growth with particle motion the comparison determines the exact size of the fish body at which the growth of the body starts to speed up and or slows down under stress the t e l a and t e l o provide the estimate of the time required for the fish body to maximize this acceleration and deceleration of growth respectively we suggest that these times are the new response times to stress unlike chakraborty et al 2017 proposed time to respond these two estimations of the time represent periods of the primary and secondary responses since the response starts with the primary one we suspect the primary response is likely to occur at the end of the lag phase the loet may be associated with metabolic regulations since the body growth starts to slow down during this time the metabolic upregulation is likely to be slowed down therefore this time may represent the peak of the secondary response our model parameter α i e the metabolic upregulator may play a significant role in determining this time after this time point the expression of tertiary response in the fish body may be detectable by observation during the steady state the metabolism is in homeostasis but the metabolism is more than the catabolic activity of the body during the log phase james 1971 the corridor between t e l o and t s s t can be suspected as the growth phase where the stress response mechanism starts to get exhausted however only further biochemical investigation can confirm this suspicion thus the t s s t of our study represents the time required for the fish body to be numb against the stress so the ssit is the gateway to the corridor where the metabolic downregulation starts to increase until the body metabolism reaches homeostasis note that previous models did not catch this response at specific times although some of the preceding models may provide these phases upon recalculating these definitions those models cannot specify or differentiate these periods based on the chronicity of the stress similar to the times as mentioned above t i n f l is also important to predict fish body growth and response under stress we can interpret t i n f l as the time required to observe the change in the direction of the growth in the fish body using these time and size estimates we can show the fish bodies react almost instantaneously in location c but fish bodies in other locations take time to show primary response one possible explanation for such finding may be that the fish bodies at location c were pre exposed to the stress resulting in observation of only metabolic depression therefore the fish might have been already stress resilient during the experiment this explanation also suits the estimated negative minimum body size required for growth under stress at location c as per our finding note that the pre exposure to the stress of fish bodies to stress and the nature of data in this particular location suggests that plm may not be the true underlying model however pgm may still portray this data the l s s t values of locations a b and d suggest that the fish body achieves a stationary phase at a much shorter length in location b compared to the other locations the t e l a values suggest that location a experiences lag phase in growth longer than the other locations no tree shading on location a might have caused better growth in phytoplankton the abundant food might have resulted in regulation of satiation in growth therefore a prolonged lag phase in this location since external stresses do not allow the body to reach the capacity limited body size we observe the maximum body size under a different set of parameter values using estimated parameters from data fitting in the series of simulated maximum body sizes under different parametric sets enables us to evaluate the simulated results with natural observations none of the fishes cirrhinus mrigala from the pond in the experiment attain the maximum size observed at rivers or other natural habitats our simulations show that the capacity of the habitat is the main reason for such loss growth modeling has long known this association between capacity limitation and natural habitat however the first fish growth equation with a separate parametric representation for metabolic regulations and depression plm suggests that chronic stress cannot cause more response than resource limitation manifested by capacity limitation the simulations see supplimentary files using the estimates in figs 7 9 indicate that the response to chronic stress plays a significant role in determining the maximum body size than the other regulators so even if the stress response is low the maximum fish body size is limited by its regulation 8 conclusion fishery scientists can use all of our estimates of laet laes loes loet ssit and ssis for the fish body to predict the different growth periods of interest under stress this prediction is possible for any growth data with a known underlying model and analytical solution as per our study the plm fulfills all the requirements and describes the three out of four data sets better than the existing models in the literature especially the ssis of our model gives the exact fish length acting as the corridor for reaching the steady state of the fish body under stress experimental scientists can identify the fish body s maximum length under stress and the time to reach the maximum length for the benefit of fishermen again at the laes the acceleration is maximum suggesting that all three stress responses primary secondary and tertiary be sped up from this time point at the estimated loes the retardation negative acceleration is maximum indicating potential exhaustion in the stress response machinery of the fish body alternatively the fish may gain a tolerance to the stress after it attains loes thus the plm can act as a new guide for targeting an exact desired body size under a specific period of the stress response credit authorship contribution statement trina roy conceptualization methodology software formal analysis investigation resources writing original draft writing review editing visualization funding acquisition sinchan ghosh conceptualization software resources writing original draft writing review editing visualization funding acquisition sabyasachi bhattacharya conceptualization supervision data curation writing original draft writing review editing visualization appendix a linearization of the pgm we can rewrite the extended logistic growth eq 2 by considering α 0 r 0 ν 0 and θ 0 as follows d n t d t r n t α 1 ν n t k θ c n t β r n t k k α 1 ν n t k k k θ c n t k k β r k α 1 n t k k α 1 ν 1 n t k k θ c k β 1 n t k k β r k α 1 α n t k k 1 ν ν θ n t k k c k β 1 β n t k k 1 α 1 ν ν θ r k α 1 β c k β 1 ν ν θ α r k α 1 1 α r ν θ k α 1 β c k β 1 n t α r ν θ k α 2 n t 2 ϕ n 2 t ψ n t η appendix b special case for linearization for ν 0 the pgm 2 takes the form d n t d t r n t α c n t β r n t k k α c n t k k β r k α 1 n t k k α c k β 1 n t k k β r k α 1 α n t k k c k β 1 β n t k k α r k α 1 β c k β 1 n t 1 α r k α 1 β c k β a n t b with a α r k α 1 β c k β 1 and b 1 α r k α 1 β c k β this approximated growth model is a first order linearized growth model with the analytical solution n t n 0 e a t b a 1 e a t appendix c stability analysis of plm for the feasibility of the two real roots γ and δ ψ 2 4 ϕ η 0 ϕ is always negative for any sustainable body therefore among the two roots of the plm γ δ again at n t γ ψ ψ 2 4 ϕ η 2 ϕ d 2 n t d t 2 ψ 2 4 ϕ η 0 for any sustainable body therefore the equilibrium point n t γ is the stable equilibrium point again at n t δ d 2 n t d t 2 ψ 2 4 ϕ η 0 and this equilibrium point is an unstable equilibrium point appendix d inflection point of the plm at the inflection point for the curve d n t d t ϕ n t 2 ψ n t η d 2 n t d t 2 0 we get ψ 2 ϕ is the inflection point for the plm appendix e grid search algorithm we perform grid search algorithm with the following steps we compute the relative growth rate rgr of the observed raw data sets based on the fishers estimate for each of the locations the mean rgr values are calculated with the standard error values we treat this mean rgr values as the observed rgr values we choose the grid values for the pgm parameters r k c α θ ν and β each grid is divided into h number of equal partitions total h 1 8 number of parameters combination are available we compute residual sum of square rss values for each of the model parameters we choose the septuplicate with the least rss value same procedures for each location and find the best fitted model parameters we follow the same procedure for the plm fitting for the observed size rgr and time rgr profiles but only for the three values we choose the values ϕ ψ and η for the size rgr fitting again we choose ϕ δ and γ values for the time rgr fitting appendix f proof of lemma 1 for the plm 1 n t d n t d t r n t ϕ n t ψ η n t differentiating with respect to n t we obtain f 1 d r t d n t ϕ η n t 2 therefore d 2 r t d n t 2 2 η n t 3 for α 1 and β 1 the term η become zero and then r n t ϕ n t ψ then r n t become a linearly decreasing function of n t as ϕ is always negative for α 1 β 1 θ 0 and ν 0 appendix g proof of lemmas 2 and 3 at the extrema of r n t d r n t d n t 0 we obtain n t η ϕ at the extreme rgr value for α 1 β 1 and 1 ν ν θ 0 the terms ϕ and η are always negative for sustainability the body size n t δ γ when δ 0 otherwise n t 0 γ for n t δ η ϕ or n t 0 η ϕ i e for n t η ϕ we must have ϕ η n 2 t 0 again ϕ η n 2 t 0 for n t η ϕ γ from eq f 1 we can say d r t d n t 0 before the body size n t η ϕ and d r t d n t 0 for n t η ϕ γ the rgr values are increasing before n t η ϕ and decreasing after that for any body size d 2 r t d n 2 t 0 as η is negative for α 1 β 1 and 1 ν ν θ 0 we obtain concave downward rgr profile for α 1 β 1 and 1 ν ν θ 0 similar things happen for α 1 β 1 and 1 ν ν θ 0 for α 1 and β 1 both of the ϕ and η are negative and similarly we obtain the result appendix h proof of lemma 4 for the linearized model d 2 r n t d n 2 t 2 η n t 3 for the sustainable body n t 0 therefore d 2 r n t d n 2 t 0 for η 0 therefore the rgr profile is concave upward for η 0 appendix i derivations of phase ending time points and corresponding sizes let t e l o is the log phase ending time point loet therefore the body size at this time point must be same with n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ equating the two body sizes γ δ n 0 γ n 0 δ e ϕ γ δ t e l o 1 n 0 γ n 0 δ e ϕ γ δ t e l o 3 ψ 3 ψ 2 12 ϕ η 6 ϕ we obtain t e l o 1 ϕ γ δ log n 0 δ n 0 γ 3 ψ 6 ϕ γ 3 ψ 2 12 ϕ η 3 ψ 6 ϕ δ 3 ψ 2 12 ϕ η again let t e l a is the lag phase ending time as a similar manner equating γ δ n 0 γ n 0 δ e ϕ γ δ t e l a 1 n 0 γ n 0 δ e ϕ γ δ t e l a 3 ψ 3 ψ 2 12 ϕ η 6 ϕ we get t e l a 1 ϕ γ δ log n 0 δ n 0 γ 3 ψ 6 ϕ γ 3 ψ 2 12 ϕ η 3 ψ 6 ϕ δ 3 ψ 2 12 ϕ η the slope of the tangent at the point t e l o is ϕ n t e l o 2 ψ n t e l o η the equation of the tangent at this point is n t n t e l o ϕ n 2 t e l o ψ n t e l o η t t e l o the intersection of the tangent at loet with the maximum number of infection i e n t γ will yield at the stationary state initiation time point t s s t and gives γ n t e l o ϕ n 2 t e l o ψ n t e l o η t t e l o from this we obtain t s s t γ n t e l o ϕ n 2 t e l o ψ n t e l o η t e l o i e t s s t γ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ ϕ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ 2 ψ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ η t e l o let t i n f l is the time point at the inflection body size ψ 2 ϕ as a similar manner we get t i n f l 1 ϕ γ δ log n 0 δ n 0 γ γ ψ 2 ϕ δ ψ 2 ϕ appendix j supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 109999 appendix j supplementary data the following is the supplementary material related to this article mmc s1 simulation of the stable fish body size from estimated parameters 
24409,a fish has to grow in an aquatic environment with both positive and negative regulatory mechanisms under stress metabolic upregulation acts as a positive regulatory mechanism while metabolic downregulation acts as the negative regulation these two mechanisms work as a response to the stress on the fish body the tsoularis wallace tw model can portray the two aforementioned metabolic regulations but is not applicable for fish growth under chronic stress if the stress is chronic then the fish body develops a metabolic depression in addition to these two aforementioned metabolic regulations we capture stress effects through regulators similar to the regulators of population ecology in a proposed generalized model pgm at the same time the chronic stress induced metabolic depression is considered in the pgm through a harvesting like term in this study our pgm can capture all the conceptual phenomenon to describe the real data sets well like the tw model our pgm has no analytical solution therefore we propose a linearized model plm from the pgm to overcome this problem we used the mean fish body length data sets for four locations as used in chakraborty et al 2017 the relative growth rate rgr profiles of the plm better fitted to the observed rgr values of the real data sets than the previously used models in three of the four cases comparing the fish body growth with the motion of a particle in newtonian mechanics we formulate the three broad phases lag log and stationary ending time points and the corresponding fish lengths we also obtain the point of inflection regarding time and the corresponding length we calculate all of these results for the real data sets the metabolic downregulation and capacity limitation of our model cause a decreasing trend in maximum body length of the fish upon simulation metabolic depression rate parameter of our model is also a key control of the maximum body length of fish as per the simulation graphical abstract keywords growth curve extended logistic fish growth growth phases newtonian mechanics 1 introduction the fish body grows following a principle similar to the population and ecosystem growth under stress wendelaar bonga 1997 the stress of the fish refers to changes in physiological activities under environmental perturbations the response of the fish body to the stress is very similar to that of terrestrial vertebrates so stress response in fish growth has been a significant research interest and a bridge between ecology and physiology predicting fish growth is mathematically challenging under different stress response mechanisms jørgensen 1976 chakraborty et al 2017 thus a growth model opens a new direction in dynamic system modeling if it is conceptualized based on different stress responses overall there are two types of stress response mechanisms an internal biochemical mechanism and an external response mechanism in growth the fish body experiences alteration in the homeostasis of various physiological activities through the internal mechanism as a result the external mechanism reduces the growth rate of fish barton 2002 wendelaar bonga 1997 pickering 1993 van weerd and komen 1998 abdel tawwab et al 2019 these stress responses are canonical hypothalamus secrets corticosteroids and catecholamines are synthesized as a primary response heat shock protein hsp is synthesized as a secondary response the tertiary response level involves a change in growth rate by further metabolic regulations also if the stress is chronic the fish body develops a permanent drop in metabolic activities in addition to these regulations pickering 1993 wendelaar bonga 1997 barton 2002 previous models have considered only the primary and secondary responses as an allometric function of time to portray the change in growth this change may be upregulation or downregulation in different cases however wendelaar bonga 1997 reviewed that chronic stress always inhibits the growth rate by only reducing metabolism commonly known as metabolic depression this metabolic depression on fish growth is absent in the previous modeling framework the analogy between the stress responses and regulators of population dynamics helps to build a new framework for predicting chronic stress responses the capacity limitation of the fish body is similar to the population carrying capacity both account for size under limited resources the upregulation of metabolism in the fish body is similar to cooperation in the population both facilitate the growth rate the downregulation of metabolism in the fish body is analogous to biotic potential regulation in population ecology both control the growth rate the metabolic depression i e the detrimental effect of chronic stress on the fish body is comparable to the harvesting effect on population ecology both of them are inhibition of growth for reasons other than resource limitation therefore modeling the growth data of a fish body is parallel yet similar to the population and ecosystem modeling there is already a substantial modeling framework for fish data in the literature from single dimensional logistic to multi dimensional system equations chakraborty et al 2017 xu et al 1999 jørgensen 1976 the multidimensional system equations are most useful if all the stresses are reported and finite however such reports are often unavailable and identifying unreported stresses is hard therefore the single dimensional models are better options for cases where the data of multiple stressors are absent the logistic model proposed by verhulst 1838 has successfully described different types of population growth ranging from cells to species thus it seems to be a good choice for fish growth modeling too bacaër 2011 however this law cannot describe asymmetric growth due to the lack of parameters to separately represent the upregulation and downregulation of metabolism thus the logistic law cannot properly portray growth due to stress responses kot 2001 zhang et al 2015 simon 2019 the capacity limitation of logistic law represents the maximum body size under limited resources so it fails to separate chronic stress that has originated due to reasons other than resource limitations for example a fish shows stress responses through prolactin growth hormone and mineralocorticoid synthesis if the resource e g food and salinity is too low irrespective of the limited resources the fish may also suffer from diseases a fish suffering from a disease chronic stress secrets catecholamines causing a metabolic depression in addition to other metabolic regulations thus the growth rate is reduced as a negative feedback of chronic stress these metabolic regulations and metabolic depressions are two sets of separate stress response mechanisms the capacity limitation of the logistic law is not sufficient to capture these metabolic regulations and depression a logistic law must have an extension term representing this metabolic depression of chronic stress on growth the metabolic regulations can be incorporated as size dependent parameters moreover the interplay of two different stress response pathways may lead the fish body s growth trajectory to various sigmoidal forms blumberg 1968 and tsoularis and wallace 2002 proposed generalized versions of logistic law to portray both symmetric and asymmetric growth profiles by incorporating parameters for up and down regulations of metabolisms in physiological growth since conceptually these two laws also lack separate parametric representations for the aforementioned metabolic depression these laws also need further extensions to portray fish growth under chronic stress other than resource limitation such an extension has been added to the logistic law as a harvesting term kot 2001 the harvesting term of this extended logistic law represents additional fish mortality for fish catching the harvesting model is primarily applicable in pisciculture nevertheless it can portray growth data from other fields as well considering the harvesting term as additional negative feedback due to external force s roy et al 2021 thus an extension like the harvesting term may be a better choice to portray further metabolic depression due to chronic stress than adding a time covariate extension previously used by chakraborty et al 2017 and bhowmick et al 2014 their time covariate extensions are specific for response time and adaptation to a new environment a new environment poses stress due to the potential presence of toxic material food scarcity changing dissolved oxygen levels and the chance of new infection each of these factors acts through different physiological pathways so stress response ability of the fish varies with these factors so the time covariate extensions of chakraborty et al 2017 and bhowmick et al 2014 can only capture one stress at a time overall the existing fish growth models including chakraborty et al 2017 and bhowmick et al 2014 focus on response steps primary secondary and tertiary and period but ignore variability of stresses and additional metabolic depression due to chronic stress note that the response may also vary with the fish body itself for example the level of corticosteroids may vary for two different fish body sizes abdel tawwab et al 2019 wendelaar bonga 1997 fish that can adapt easily may regulate their response to stress by changing corticosteroids heat shock protein levels and finally the metabolic rate so a model should combine the concept of stress regulation based on the response pathways and time the regulation of stress response may alter the period of the fish growth and its different phases wendelaar bonga 1997 any growth curve shows at least three major phases lag log and stationary recently paul et al 2021 provided an idea of ending time points for each of these phases and the corresponding population sizes in this case body sizes at each of these points the authors proposed a methodology to estimate the lag phase ending time laet and corresponding size laes lag phase ending size log phase ending time loet and corresponding size loes log phase ending size steady state initiation time ssit and corresponding size ssis steady state initiation size for both the gompertz and the theta logistic growth curve models however a new model for fish growth may follow the same estimation procedure for the time points but those time points expression may differ from the existing one due to the metabolic depression for the chronic stress the analytical solution of any growth model must be known to find each phase ending time point and the corresponding size followed by the growth equation like the tsoularis wallace tw model the proposed generalized model may not be solvable we can linearize the model for an analytical solution in such a case although the linearized model may give each of the phase ending time points and the corresponding sizes due to the existence of the solution it must portray the real data set to be considered for further research and application considering the aforementioned mathematical lacunae to portray stress response regulation we propose a new growth law and linearize it using sets of real data and our proposed linearized model plm we aim to evaluate and compare the superiority of the plm with its preceding models to illustrate ecological growth data studying the property of the model parameters in terms of equilibrium and inflection points we aim to find representatives of different sizes and periods of growth under stress responses the point of inflection time pit and corresponding size pis point of inflection size laes loes ssis laet loet and ssit for the data in use 2 model formulation the single dimensional harvesting model is most useful to predict and understand the growth dynamics for a data set with unknown individual environmental stressors bhowmick et al 2014 chakraborty et al 2017 for a single dimensional model bhowmick et al 2014 suggested to use the latest generalized version of the logistic law by tsoularis and wallace 2002 which can be written as below 1 d n t d t r n t α 1 n t k θ ν here n t is the body size of the fish at t time point the parameters r and k are the intrinsic growth rate and the capacity limited size of the body respectively originally tsoularis and wallace 2002 considered α θ and ν as positive real numbers later bhowmick et al 2014 2015 and other studies suggested the allometric powers in the tsoularis wallace model henceforth tw model can represent three key growth regulators these growth regulators are manifestations of metabolic and other physiological regulators in this case metabolic upregulator α capacity limited growth regulator θ and metabolic downregulator ν bhowmick et al 2015 blumberg 1968 richards 1959 sibly et al 2005 2007 note that these regulators are named after their corresponding physiological and metabolic pathways but their action in the model is on growth rates the metabolic regulators can control the growth for any stresses as the manifestation of primary and secondary responses the capacity limited growth regulator control the satiation in the growth due to stress that is associated with limited resources different growth data can interpret these regulators as different phenomena for example the metabolic upregulator indicates the degree of body size increase the capacity limited growth regulator represents the degree of satiation in growth under limited resources but indicates capacity limitation due to environmental constraints such as temperature water quality and space for growth data of fish body sibly et al 2005 richards 1959 the metabolic downregulator of the tw model can be interpreted into a set of several adaptive strategies for different types of growth data tsoularis and wallace 2002 for example a fish body can downregulate its metabolism in an adverse environment to delay its growth for achieving capacity limited body size bhowmick et al 2014 used gompertz law instead of the tw model arguing about the approximated inflection point of the latter bhowmick et al 2014 and chakraborty et al 2017 both considered multiplicative stress effect on the fitness curve the main drawback of the bhowmick bhattacharya extended gompertz model bbegm is that the analytical solution exists only for the positive integer values of the stress effect regulator bhowmick et al 2014 however it should be able to take the negative values as well as any positive real numbers in reality chakraborty et al 2017 overcome this problem and proposed two growth models viz proposed extended logistic model pelm and proposed extended gompertz model pegm in the absence of the stress effect the form of the pelm and pegm take the fitness function as used in the logistic and the gompertz model respectively however none of these two functional forms take the chronic stress induced metabolic depression separately they consider the effect of a stress by a single parameter regardless of its chronicity to overcome this we have to consider metabolic depression with chronic stress separately as different regulatory model parameters if we incorporate additional negative feedback representing chronic stress induced metabolic depression to the tw model 1 the growth equation becomes 2 d n t d t r n t α 1 n t k θ ν c n t β the parameter c can represent the suppression rate of body growth in terms of length due to chronic stress induced metabolic depression note that chronic stress induced metabolic depression suppresses the growth rate but it cannot decrease the length of the fish therefore this additional negative feedback part of the model cannot exceed the value of the tw part in reality since the metabolic depression can affect an individual s growth to a different degree based on the individual s ability to withstand chronic stress the negative feedback suppression effect depends on the allometric power of the body size the allometric power β represents the degree of body size dependence of additional negative feedback suppression on growth due to chronic stress induced metabolic depression in other words this regulator represents the adaptability of the fish body to withstand chronic stress since metabolic depression reduces the growth as negative feedback of chronic stress at a final level it manifests the tertiary stress response in this model the fitness or the relative growth rate rgr of this proposed generalized model pgm at the body size n t is r n t 1 n t d n t d t 3 o r r n t r n t α 1 1 n t k θ ν c n t β 1 2 1 linearization of the model we transform the pgm to the following quadratic linearized form 4 d n t d t ϕ n t 2 ψ n t η where ϕ α r ν θ k α 2 ψ 1 ν ν θ α r k α 1 1 α r ν θ k α 1 β c k β 1 and η 1 α 1 ν ν θ r k α 1 β c k β see appendix a for detailed transformation the plm eq 4 captures all of the regulator described earlier let eq 4 have two real roots γ and δ then this equation can be written as 5 d n t d t ϕ n t γ n t δ after solving this equation we get the analytical solution of the linearized model as 6 n t γ δ n 0 γ n 0 δ e ϕ γ δ t 1 n 0 γ n 0 δ e ϕ γ δ t in this proposed linearized model plm for growth data with the effect of stress responses we consider γ ψ ψ 2 4 ϕ η 2 ϕ and δ ψ ψ 2 4 ϕ η 2 ϕ among these two roots γ is the stable equilibrium point and δ is the unstable equilibrium point see appendix c therefore for any sustainable body followed this linearized growth model the initial size must be greater than the δ value and the body try to stabilize at the size γ with the inflection point at the size ψ 2 ϕ see appendix d note the plm is a size covariate growth law for this size covariate law the fitness function or the rgr value is represented by r n t ϕ n t ψ η n t where r n t is the rgr value at the body size n t this size covariate rgr functional form can also be written as r n t α r ν θ k α 2 n t 1 ν ν θ α r k α 1 1 α r ν θ k α 1 β c k β 1 1 α 1 ν ν θ r k α 1 β c k β n t the time covariate form of rgr of the same model is as follows r t ϕ γ δ n 0 γ n 0 δ e ϕ γ δ t 1 n 0 γ n 0 δ e ϕ γ δ t γ δ 1 n 0 γ n 0 δ e ϕ γ δ t γ δ n 0 γ n 0 δ e ϕ γ δ t γ δ where r t is the rgr value at the time point t remark 1 in the quadratic linearized form ϕ 0 for the plm again for the extended logistic model the model parameters α θ and ν are 0 therefore ϕ 0 γ and δ are well defined by the model parameters r k c α θ ν and β remark 2 the linearization is not valid for certain parameter combinations our linearized technique is not applicable for the exponential model exponential model itself is a linearized model with an existing analytical solution there is no need for the further approximation again for ν 0 the model becomes d n t d t r n t α c n t β this model can be approximated to a first order linearized form d n t d t a n t b with a α r k α 1 β c k β 1 b 1 α r k α 1 β c k β and the analytical solution is n t n 0 e a t b a 1 e a t see appendix b for a 0 n t and for a 0 n t b a transformability of the model by tuning the regulator parameter values the model 4 can be traced back to its harvesting like form 2 pgm it is noteworthy to mention that eq 2 can be transformed into any form of extended logistic model as shown in fig 1 out of all the branches of growth curves that the proposed model can offer we emphasize the linearized version 4 as it has an analytical solution without compromising the generic properties of tsoularis and wallace 2002 framework 3 model fitting to the data set data set the pgm emphasizes two properties of growth data metabolic regulations and additional negative feedback suppression on growth due to chronic stress induced metabolic depression we choose a fish growth data set of cirrhinus mrigala which has been used to portray other growth models this choice of the data set has two benefits first it may have metabolic regulations to show both symmetric and asymmetric nature to showcase the flexibility of the model second by comparing the data with previously fitted models pegm and pelm with the plm we can judge the superiority of the plm the data set belongs to the experiment performed by the kalyani fish farm details in the supplementary material this fish growth data set can be divided into four subsets for four locations with different aquatic environments water qualities different stress levels sunlight exposure induced cortichosteroidogenic stress different access to foods planktons since there was no additional food source the fish could either up or downregulate metabolism for the food in that case we can expect changes in the value of α and ν for the four locations if the sunlight induced stress is high the fish may experience metabolic depression due to chronic stress only in that case we expect a change in the value of β the fish body can overcome the harshness of water quality by adjusting the mucous secretion rates osmoregulation or other physiological procedures these physiological procedures can change the capacity limitation of growth as adaptive measures in fish body thus we can expect different values of θ for four different locations due to different adaptabilities of fish in those locations fitting method we use grid search algorithm gs and nonlinear least square nls for data fitting details in appendix e for the pgm we perform grid search and choose the parameter values in a grid for the least residual sum of square rss values for the prediction against observations we fit the plm eq 4 separately for size rgr profile any size rgr profile being an inherent property of the growth is least erroneous during model fitting sibly et al 2005 bhowmick et al 2015 2016 we also used the nonlinear least square nls regression algorithm for the observed size rgr data fitting with the plm using the r software r core team 2013 we use both grid search and nls algorithms for the plm fitting with the observed time rgr profile the time rgr profile of model fitting helps us directly compare the plm with existing time covariate models such as pegm and pelm based on the akaike information criterion aic values akaike 1974 4 profiles of the proposed models upon fitting we used the mean values for both the observed size and the observed rgr values with the standard error bar in the figures for all four locations figs 2 5 represent the results of size rgr fittings of pgm and plm figs 2 and 4 show the fitted size rgr profiles for the pgm and plm respectively while figs 3 and 5 show their predicted time size profiles for the estimated parameters from size rgr fittings of figs 2 and 4 respectively for the observed size rgr data fitting with the pgm we use only the grid search algorithm as the number of data points is low for the pgm however for the observed size rgr data fitting with the plm we used the nls algorithm using the grid search estimated values as in this case the estimated values number is too low comparatively to the observed size rgr data points fig 6 shows the result of time rgr fitting along with visualization of comparative fitness profiles of pegm and pelm with the plm the estimated values of parameters especially the regulators are different for each of the four locations figs 2 and 4 in other words the metabolic upregulation capacity limitation metabolic depression due to chronic stresses are different under environmental conditions and stress levels for all four locations notably location c has a decreasing size rgr profile while the locations a and b have concave downward profiles and the location d has a bit erratic profile no specific profile is specifically observed in location d based on the rss the model 2 best describes location b and is least descriptive for location c before linearization upon fitting fig 2 we have to estimate three constant values ϕ ψ and η for the observed size rgr data fittings with the plm all the estimated values are significant for the locations a and b with very low and negative aic values the aic values for the location c and d are too low and negative however all of the estimated values are not significant although the time size predictions fig 3 using the estimated parameters from fig 2 appears to be visually good forecasts the rss of the time size prediction from the generalized model further reduces after linearization based on the grid search estimated values only note that upon prediction of time size profiles the rss values for the prediction by plm using the estimated model parameters from nls methods are greater than the rss of prediction by pgm and plm using estimated model parameters from the grid search one of the reasons for poor predictions of time size profiles may be that the time size profiles are inherently more erroneous than the size rgr profiles the fitted curves portray the visuals of the size rgr data better upon the fitting after linearization the plm is best descriptive for locations a and b the plm is comparatively poor descriptive for locations c and d 4 1 comparison with previous models chakraborty et al 2017 already showed that the pegm and the pelm are best descriptive for the fish growth using the same data set fig 6 further proves that the linearized model is superior to the pegm and pelm in terms of accuracy to portray the time rgr profile in three of the four cases the aic values are least for the plm for three of the four locations here we also use a grid search algorithm for the time rgr fitting of the plm as described in the appendix e but only consider three values ϕ δ and γ we used the grid search estimated values and ran the nls regression method using the r software r core team 2013 we found the statistical estimator named aic values for each of the four locations model fittings chakraborty et al 2017 already calculated the aic values for the pegm and pelm models along with the other growth models gompertz logistic and bbegm and compared the models fitting for each of the four locations the plm s estimated values ϕ δ and γ are all significant for locations a and b with aic values less than the pegm and pelm for the observed time rgr data fitting therefore the plm describes the data set better than the previously used models for the above two locations a and b however the plm does not describe the location c data set as the aic values are greater than the pegm and the pelm with the two insignificant model parameters ϕ and δ out of three the aic value for location d is less than the pegm and pelm but the value of ϕ is not significant the reason for that is that the observed time rgr profile is erratic the model parameters a and b of both pegm and pelm are not significant also like the plm chakraborty et al 2017 for the plm fitting with the location d time rgr profile the number of the insignificant parameter is only one therefore we can say the plm model describes the location d data sets better than the pegm and the pelm the variation in regulators value for the different locations indicates different trends that may arise in a data set and portray the model so we propose the following lemmas based on the different rgr trends we can find from the data set using the proposed model lemma 1 for the plm we get the rgr profile is linearly decreasing function of the body size for α 1 β 1 and for the positive values of both θ and ν appendix f the fig 7 a shows the linearly decreasing rgr profile lemma 2 for α 1 β 1 and 1 ν ν θ 0 we obtain non monotonic rgr profile for the plm the rgr profile is concave downward fig 7 b the extrema of the rgr profile is obtain at n t η ϕ appendix g lemma 3 for α 1 and β 1 we obtain the concave downward rgr profiles with maxima of the rgr at n t η ϕ appendix g the green line of the fig 7 c represents the concave downward rgr profile for α 1 and β 1 lemma 4 for η 0 the rgr profile of the plm is concave upward appendix h this result happen for the cases a α 1 β 1 and 1 ν ν θ 0 b α 1 β 1 and 1 ν ν θ 0 c α 1 β 1 and 1 ν ν θ 0 in this cases the fitness is maximum at the initial body size fig 8 5 connection with the particle motion the lag log and stationary are the three broad phases of any growth dynamics buchanan and cygnarowicz 1990 gave an idea of the lag phase ending time point for the bacteria population like the bacteria population each phase ending time point and the corresponding size also have immense importance for the fish body paul et al 2021 give an idea about the log phase ending time point and the stationary state initiation time point for the theta logistic and the gompertz growth curve models after that kundu et al 2021 uses the same concept of geometry and newtonian mechanics and finds the optimum food concentration for artemia sp according to the literature the growth acceleration similar to the acceleration of particle motion is the key regulator for the optimization of the body sizes for each of the three phase ending time points paul et al 2021 kundu et al 2021 we observe that the plm fitted the fish body growth data better in section 4 we may compare the changes of the body sizes as per the plm growth trajectory with a particle motion in newtonian mechanics to better understand the time size and size acceleration profile here we can write the velocity of body growth v t as 7 v t d n t d t ϕ n t 2 ψ n t η therefore the acceleration a t can be written as a t d v t d t d 2 n t d t 2 2 ϕ n t ψ d n t d t 2 ϕ 2 n t 3 3 ϕ ψ n t 2 2 ϕ η ψ 2 n t ψ η from this we get 8 d a t d t 6 ϕ 2 n t 2 6 ϕ ψ n t 2 ϕ η ψ 2 d n t d t at the extrema of the acceleration d a t d t 0 therefore at the extrema we obtain n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ and n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ among these two body sizes the acceleration will be maximum at n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ this body size is the lag phase ending size laes again the acceleration will be minimum at n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ this body size is the log phase ending size loes let t e l o t e l a t s s t and t i n f l are the log phase ending time point lag phase ending time point stationary state initiation time point and time point at the inflection body size respectively therefore we get t e l o 1 ϕ γ δ log n 0 δ n 0 γ 3 ψ 6 ϕ γ 3 ψ 2 12 ϕ η 3 ψ 6 ϕ δ 3 ψ 2 12 ϕ η t e l a 1 ϕ γ δ log n 0 δ n 0 γ 3 ψ 6 ϕ γ 3 ψ 2 12 ϕ η 3 ψ 6 ϕ δ 3 ψ 2 12 ϕ η t s s t γ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ ϕ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ 2 ψ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ η t e l o and t i n f l 1 ϕ γ δ log n 0 δ n 0 γ γ ψ 2 ϕ δ ψ 2 ϕ the derivation of these time points are in the appendix i using the estimated model parameters we calculate the threshold body size δ maximum size γ loes l e l o laes l e l a t e l a t e l o t s s t ssis l s s t t i n f l and pis l i n f l all of these values are in the table 3 for all of the four locations data sets here we study that the values of δ and the t e l a for the location c data set are negative such a negative value is practically impossible in terms of lengths we have already discussed that the fishes in location c might have been under chronic stress from the initial observation point actually there is no lag phase for the location c data set locations a b and d show realistic threshold fish body lengths although the estimated threshold values are significant in all of these three locations the estimated ϕ of the location d is not significant at 5 level of significance in the nls method so the calculation of threshold value from nls estimates may provide a wrong idea for location d the true threshold value for location d may also be different from the one calculated from grid search so it can be said with confidence that the location a allows fishes to achieve maximum γ maximum fish body length under stress at steady state among the locations a b and d the absence of tree shading might have resulted in less stress resulting in greater body size at steady state compared to the other locations the fig 9a indicates the lag phase ending point of inflection log phase ending and the stationary state initiation point with the corresponding time and the body sizes for the location a data set the acceleration is maximum at the lag phase ending body size point p e l a in the fig 9b and minimum at the log phase ending body size point p e l o in the fig 9b the fig 9b shows that the acceleration vanishes at the inflection point p i n f l the point p s s t in the fig 9b represents the acceleration at the steady state initiation body size 6 influence of model parameters on maximum body size the maximum body size of the fish occurs at the non zero stable equilibrium of the plm the economic benefit of a fish majorly lies in the body size of the fish therefore observing the body size of the fish under stress is very necessary to understand the change in the economic value of the fish since the model parameters determine the stable equilibrium we numerically simulate the influence of model parameters on maximum fish body size under stress details in supplementary material 1 the pgm and plm have two sets of parameters regulatory and rate limiting parameters regulatory parameters α θ ν and β represent the body s controlling ability or adaptability to respond to the stresses the rate parameters r k and c represent the response rate or the limit of response that a fish body shows the regulatory parameters are less likely to change the maximum fish body size than the rate and growth limiting parameters the experimental data of cirrhinus mrigala show the maximum fish body size under stress is much lower than that in natural habitat our simulation details in supplementary material suggests the regulatory parameters except ν have the least influence on the body size k represents the capacity limitation due to stresses associated with resources and c the metabolic depression due to chronic stress greatly varies the fish body size therefore a lower than expected maximum body length under stress is likely to be caused by a metabolic downregulation metabolic depression and its regulation due to chronic stress overall the simulation reveals the internal stress response through limiting parameters and regulation of metabolic depression therefore the economic value of fish majorly relies on the adaptability of a fish to withstand stress and its chronicity via metabolic regulations and depression 7 discussion fish growth modeling has long been a common topic for animal physiology and fish ecology focusing on the fish body under stress fish respond to stress through three canonical pathways primary or corticosteroid synthesis secondary or heat shock protein synthesis and tertiary or metabolic regulation followed by metabolic depression for chronic stress wendelaar bonga 1997 barton 2002 we proposed a generalized logistic model with additional negative feedback to portray the stress responses through both metabolic regulation and depression due to stress and its chronicity previous models considered the primary and secondary stress responses as a function of time that delays the growth through tertiary response chakraborty et al 2017 bhowmick et al 2014 our model overcomes the lack of direct representation of three different responses to the two types of stressors by incorporating them as regulatory parameters also our model can portray the different degrees of responses by different individuals to the same stressors using regulatory parameters thus our model portrays the data of body growth under stress responses more conceptually than the preceding models although conceptually sound the proposed model may suffer from parameter estimation for data sets with few data points also the pgm being mathematically an extension of the tw model is analytically impossible to solve therefore we linearize the pgm to get the analytical solution while still maintaining the conceptual properties of the pgm overall this plm proves to be also a better fit for fish growth data than the existing models and pgm the plm can capture both concavity and convexity in the rgr profiles of the data set from the estimates of our regulatory parameters it is clear that upregulating the metabolic activities is key to defining the shape of the rgr profiles rgr being a surrogate of fitness the nonmonotonic concave downward rgr profiles of the data set indicate the fitness of fish growth in locations a and b changes due to metabolic upregulation to a degree higher than 1 however in location c the fitness decreases monotonically therefore the metabolic depression due to chronic stress might have been already there at the first datapoint the rgr profile at location d is erratic and has no specific shape it is clear from the estimates that the metabolic downregulations for stress are approximately the same for fish bodies in all the locations the regulators of metabolic depression due to chronic stress are notably large for growth in location c than the other three locations this finding suggests that the fish respond to the stress to a greater degree and probably from earlier time point in location c the stress level is also high in location c preventing the fish body from increasing fitness with body size the plm provides the size of the fish attaining the maximum rgr hence maximum fitness this maximum rgr is very important for fish growth under stress chakraborty et al 2017 and tort 2011 and many others has emphasized on the immune suppression in fish that may lead to deterioration of growth of fish body the maximum rgr and its size from the plm provide the idea of body length required for the fish to be most resilient against stress the metabolism under stress must be downregulated to a degree of positive number in order to observe a decreasing fitness over size nonetheless this fitness property and sizes get a broader interpretation by comparing the growth with particle motion the comparison determines the exact size of the fish body at which the growth of the body starts to speed up and or slows down under stress the t e l a and t e l o provide the estimate of the time required for the fish body to maximize this acceleration and deceleration of growth respectively we suggest that these times are the new response times to stress unlike chakraborty et al 2017 proposed time to respond these two estimations of the time represent periods of the primary and secondary responses since the response starts with the primary one we suspect the primary response is likely to occur at the end of the lag phase the loet may be associated with metabolic regulations since the body growth starts to slow down during this time the metabolic upregulation is likely to be slowed down therefore this time may represent the peak of the secondary response our model parameter α i e the metabolic upregulator may play a significant role in determining this time after this time point the expression of tertiary response in the fish body may be detectable by observation during the steady state the metabolism is in homeostasis but the metabolism is more than the catabolic activity of the body during the log phase james 1971 the corridor between t e l o and t s s t can be suspected as the growth phase where the stress response mechanism starts to get exhausted however only further biochemical investigation can confirm this suspicion thus the t s s t of our study represents the time required for the fish body to be numb against the stress so the ssit is the gateway to the corridor where the metabolic downregulation starts to increase until the body metabolism reaches homeostasis note that previous models did not catch this response at specific times although some of the preceding models may provide these phases upon recalculating these definitions those models cannot specify or differentiate these periods based on the chronicity of the stress similar to the times as mentioned above t i n f l is also important to predict fish body growth and response under stress we can interpret t i n f l as the time required to observe the change in the direction of the growth in the fish body using these time and size estimates we can show the fish bodies react almost instantaneously in location c but fish bodies in other locations take time to show primary response one possible explanation for such finding may be that the fish bodies at location c were pre exposed to the stress resulting in observation of only metabolic depression therefore the fish might have been already stress resilient during the experiment this explanation also suits the estimated negative minimum body size required for growth under stress at location c as per our finding note that the pre exposure to the stress of fish bodies to stress and the nature of data in this particular location suggests that plm may not be the true underlying model however pgm may still portray this data the l s s t values of locations a b and d suggest that the fish body achieves a stationary phase at a much shorter length in location b compared to the other locations the t e l a values suggest that location a experiences lag phase in growth longer than the other locations no tree shading on location a might have caused better growth in phytoplankton the abundant food might have resulted in regulation of satiation in growth therefore a prolonged lag phase in this location since external stresses do not allow the body to reach the capacity limited body size we observe the maximum body size under a different set of parameter values using estimated parameters from data fitting in the series of simulated maximum body sizes under different parametric sets enables us to evaluate the simulated results with natural observations none of the fishes cirrhinus mrigala from the pond in the experiment attain the maximum size observed at rivers or other natural habitats our simulations show that the capacity of the habitat is the main reason for such loss growth modeling has long known this association between capacity limitation and natural habitat however the first fish growth equation with a separate parametric representation for metabolic regulations and depression plm suggests that chronic stress cannot cause more response than resource limitation manifested by capacity limitation the simulations see supplimentary files using the estimates in figs 7 9 indicate that the response to chronic stress plays a significant role in determining the maximum body size than the other regulators so even if the stress response is low the maximum fish body size is limited by its regulation 8 conclusion fishery scientists can use all of our estimates of laet laes loes loet ssit and ssis for the fish body to predict the different growth periods of interest under stress this prediction is possible for any growth data with a known underlying model and analytical solution as per our study the plm fulfills all the requirements and describes the three out of four data sets better than the existing models in the literature especially the ssis of our model gives the exact fish length acting as the corridor for reaching the steady state of the fish body under stress experimental scientists can identify the fish body s maximum length under stress and the time to reach the maximum length for the benefit of fishermen again at the laes the acceleration is maximum suggesting that all three stress responses primary secondary and tertiary be sped up from this time point at the estimated loes the retardation negative acceleration is maximum indicating potential exhaustion in the stress response machinery of the fish body alternatively the fish may gain a tolerance to the stress after it attains loes thus the plm can act as a new guide for targeting an exact desired body size under a specific period of the stress response credit authorship contribution statement trina roy conceptualization methodology software formal analysis investigation resources writing original draft writing review editing visualization funding acquisition sinchan ghosh conceptualization software resources writing original draft writing review editing visualization funding acquisition sabyasachi bhattacharya conceptualization supervision data curation writing original draft writing review editing visualization appendix a linearization of the pgm we can rewrite the extended logistic growth eq 2 by considering α 0 r 0 ν 0 and θ 0 as follows d n t d t r n t α 1 ν n t k θ c n t β r n t k k α 1 ν n t k k k θ c n t k k β r k α 1 n t k k α 1 ν 1 n t k k θ c k β 1 n t k k β r k α 1 α n t k k 1 ν ν θ n t k k c k β 1 β n t k k 1 α 1 ν ν θ r k α 1 β c k β 1 ν ν θ α r k α 1 1 α r ν θ k α 1 β c k β 1 n t α r ν θ k α 2 n t 2 ϕ n 2 t ψ n t η appendix b special case for linearization for ν 0 the pgm 2 takes the form d n t d t r n t α c n t β r n t k k α c n t k k β r k α 1 n t k k α c k β 1 n t k k β r k α 1 α n t k k c k β 1 β n t k k α r k α 1 β c k β 1 n t 1 α r k α 1 β c k β a n t b with a α r k α 1 β c k β 1 and b 1 α r k α 1 β c k β this approximated growth model is a first order linearized growth model with the analytical solution n t n 0 e a t b a 1 e a t appendix c stability analysis of plm for the feasibility of the two real roots γ and δ ψ 2 4 ϕ η 0 ϕ is always negative for any sustainable body therefore among the two roots of the plm γ δ again at n t γ ψ ψ 2 4 ϕ η 2 ϕ d 2 n t d t 2 ψ 2 4 ϕ η 0 for any sustainable body therefore the equilibrium point n t γ is the stable equilibrium point again at n t δ d 2 n t d t 2 ψ 2 4 ϕ η 0 and this equilibrium point is an unstable equilibrium point appendix d inflection point of the plm at the inflection point for the curve d n t d t ϕ n t 2 ψ n t η d 2 n t d t 2 0 we get ψ 2 ϕ is the inflection point for the plm appendix e grid search algorithm we perform grid search algorithm with the following steps we compute the relative growth rate rgr of the observed raw data sets based on the fishers estimate for each of the locations the mean rgr values are calculated with the standard error values we treat this mean rgr values as the observed rgr values we choose the grid values for the pgm parameters r k c α θ ν and β each grid is divided into h number of equal partitions total h 1 8 number of parameters combination are available we compute residual sum of square rss values for each of the model parameters we choose the septuplicate with the least rss value same procedures for each location and find the best fitted model parameters we follow the same procedure for the plm fitting for the observed size rgr and time rgr profiles but only for the three values we choose the values ϕ ψ and η for the size rgr fitting again we choose ϕ δ and γ values for the time rgr fitting appendix f proof of lemma 1 for the plm 1 n t d n t d t r n t ϕ n t ψ η n t differentiating with respect to n t we obtain f 1 d r t d n t ϕ η n t 2 therefore d 2 r t d n t 2 2 η n t 3 for α 1 and β 1 the term η become zero and then r n t ϕ n t ψ then r n t become a linearly decreasing function of n t as ϕ is always negative for α 1 β 1 θ 0 and ν 0 appendix g proof of lemmas 2 and 3 at the extrema of r n t d r n t d n t 0 we obtain n t η ϕ at the extreme rgr value for α 1 β 1 and 1 ν ν θ 0 the terms ϕ and η are always negative for sustainability the body size n t δ γ when δ 0 otherwise n t 0 γ for n t δ η ϕ or n t 0 η ϕ i e for n t η ϕ we must have ϕ η n 2 t 0 again ϕ η n 2 t 0 for n t η ϕ γ from eq f 1 we can say d r t d n t 0 before the body size n t η ϕ and d r t d n t 0 for n t η ϕ γ the rgr values are increasing before n t η ϕ and decreasing after that for any body size d 2 r t d n 2 t 0 as η is negative for α 1 β 1 and 1 ν ν θ 0 we obtain concave downward rgr profile for α 1 β 1 and 1 ν ν θ 0 similar things happen for α 1 β 1 and 1 ν ν θ 0 for α 1 and β 1 both of the ϕ and η are negative and similarly we obtain the result appendix h proof of lemma 4 for the linearized model d 2 r n t d n 2 t 2 η n t 3 for the sustainable body n t 0 therefore d 2 r n t d n 2 t 0 for η 0 therefore the rgr profile is concave upward for η 0 appendix i derivations of phase ending time points and corresponding sizes let t e l o is the log phase ending time point loet therefore the body size at this time point must be same with n t 3 ψ 3 ψ 2 12 ϕ η 6 ϕ equating the two body sizes γ δ n 0 γ n 0 δ e ϕ γ δ t e l o 1 n 0 γ n 0 δ e ϕ γ δ t e l o 3 ψ 3 ψ 2 12 ϕ η 6 ϕ we obtain t e l o 1 ϕ γ δ log n 0 δ n 0 γ 3 ψ 6 ϕ γ 3 ψ 2 12 ϕ η 3 ψ 6 ϕ δ 3 ψ 2 12 ϕ η again let t e l a is the lag phase ending time as a similar manner equating γ δ n 0 γ n 0 δ e ϕ γ δ t e l a 1 n 0 γ n 0 δ e ϕ γ δ t e l a 3 ψ 3 ψ 2 12 ϕ η 6 ϕ we get t e l a 1 ϕ γ δ log n 0 δ n 0 γ 3 ψ 6 ϕ γ 3 ψ 2 12 ϕ η 3 ψ 6 ϕ δ 3 ψ 2 12 ϕ η the slope of the tangent at the point t e l o is ϕ n t e l o 2 ψ n t e l o η the equation of the tangent at this point is n t n t e l o ϕ n 2 t e l o ψ n t e l o η t t e l o the intersection of the tangent at loet with the maximum number of infection i e n t γ will yield at the stationary state initiation time point t s s t and gives γ n t e l o ϕ n 2 t e l o ψ n t e l o η t t e l o from this we obtain t s s t γ n t e l o ϕ n 2 t e l o ψ n t e l o η t e l o i e t s s t γ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ ϕ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ 2 ψ 3 ψ 3 ψ 2 12 ϕ η 6 ϕ η t e l o let t i n f l is the time point at the inflection body size ψ 2 ϕ as a similar manner we get t i n f l 1 ϕ γ δ log n 0 δ n 0 γ γ ψ 2 ϕ δ ψ 2 ϕ appendix j supplementary data supplementary material related to this article can be found online at https doi org 10 1016 j ecolmodel 2022 109999 appendix j supplementary data the following is the supplementary material related to this article mmc s1 simulation of the stable fish body size from estimated parameters 
