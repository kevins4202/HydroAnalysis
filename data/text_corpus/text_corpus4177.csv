index,text
20885,the damage detection of mooring lines is critical to safe operations because the stability of offshore floating platforms depends on the integrity of such lines however existing mooring line damage detection techniques are considerably limited because they cannot be implemented constantly to resolve this inadequacy this paper proposes a deep learning based approach that can detect underwater mooring line damage based on the real time monitored response data of floating structures catenary mooring lines one of the most widely applied types for floating offshore structures are selected for the study in the proposed approach the detection model of catenary mooring line damage uses both the response data generated through the simulation of the floating structure and the corresponding environmental condition data in particular a recurrent neural network rnn that can effectively analyze the time series continuity of the response data is employed for damage detection the results of the rnn based catenary mooring line damage detection approach proposed in this study confirm that the rnn model exhibits minimum and maximum detection accuracies of 99 59 and 99 99 respectively regardless of whether the measurement data include errors these detection accuracies indicate that the proposed approach can be used to determine mooring line damage under actual field conditions keywords damage detection catenary mooring line recurrent neural networks rnn deep neural networks dnn offshore floating structure 1 introduction 1 1 backgrounds rational mooring systems are required to maintain the target position and to secure the structural stability of offshore floating structures in general a mooring system is composed of a number of mooring lines that can be damaged by the environment or friction with the seabed during their lifecycle according to a survey conducted by souza and majhi 2013 more than 1500 mooring lines were damaged during 2000 2014 resulting in more than 2 trillion usd worth of economic losses damage to mooring lines not only leads to considerable economic losses but also results in damage to life and property when floating structures overturn or sink for instance in 1981 an accident on the platform resulting from damaged mooring lines destroyed the structure and caused 123 deaths moan 1985 to prevent such accidents the monitored response data of floating structures were recently analyzed through artificial intelligence ai to identify and estimate influences by damage to mooring lines jamalkia et al 2016 sidarta et al 2018 although the results of the previous studies demonstrate the possibility of detecting mooring line damage based on the response data of the floating structure these studies have only considered the situation where the entire mooring line is damaged or completely broken consequently these studies are limited because local mooring line damage which can be smaller than the damage considered in their analyses may have been left undetected to resolve the foregoing a previous study of authors proposed the damage detection approach using a deep neural network dnn in this case the dnn one of the ai techniques is trained with the environmental conditions and response data of a floating structure to include the detection of local mooring line damage this damage detection technique has a relatively high accuracy however its application is only limited to taut mooring lines mooring lines are classified as catenary and taut systems based on the initial shape of a line the stiffness of the taut type mooring lines directly affects the structural behavior of the floating offshore structures due to the characteristics of the mooring system in contrast the stiffness of the catenary type mooring lines might not significantly affect the structural behavior of the structure because the position of the structure is mainly maintained by the weight of the mooring not stiffness therefore the damage detection approach of taut mooring lines may not be effective for catenary mooring lines the catenary mooring line is one of the most widely used types for floating offshore structures because of the reliability of materials ease of fabrication and sustained development of installation technology especially it is a representative mooring system mainly used in shallow water areas with a depth of 200 m although continuous developments in the catenary mooring system in terms of installation design fabrication inspection and analysis technology to ensure the safe operation of floating offshore structures are ongoing an effective damage detection approach for catenary mooring lines still requires development and application accordingly this study proposes a detection method that can also determine local catenary mooring line damage based on the environmental condition and floating structure response data for this purpose deep learning which is typically employed for extracting and classifying valid information from complex data is applied considering the randomness of environmental conditions and the complexity of the response data of a floating structure to train a deep learning model for the aforementioned objective the response data of a floating structure under various states where different mooring lines are damaged are required however considering safety and economics it is impractical to intentionally inflict damage to the mooring line under actual field conditions hence simulation data are used as substitute for the simulation a floating structure was modeled and environmental condition data were generated and applied in addition damage environment scenarios were constructed by combining the mooring line damage and environmental condition cases the response data of the floating structure were then obtained by performing simulations for each damage environment scenario for deep learning the simulated environmental conditions and response data of the modeled floating structure were considered 1 2 literature review the visual inspection of mooring lines can be categorized as out of water and underwater inspections brown et al 2005 in the out of water inspection the mooring line is pulled out of the water for examination only when the structure such as a drillship moves to another location after completing its operation hence this inspection technique is difficult to employ for the constant detection of mooring line damage accordingly for general offshore floating structures the underwater inspection method is mainly used underwater inspection mainly employs a visual examination technique that makes it possible to directly check the mooring line damage through images or videos with the advancement in the technology of equipment such as 3d and high resolution cameras underwater inspection methods using images and videos have also improved hall and trower 2011 however marine organisms attached to the mooring lines and the high water turbidity caused by many floating objects in the sea make it difficult for the camera to secure a clear field of view consequently it is not easy to check the damage to the mooring line moreover the operating water depth of the exploration equipment for underwater inspection is limited bashir et al 2017 even mooring line climbing robots which have recently been developed to solve this problem dissanayake et al 2018 hernandez et al 2018 kimball et al 2018 cannot be constantly used for inspecting the entire mooring line because of their low inspection speed in view of the foregoing limitations of underwater inspection several alternative damage detection methods based on the mooring line behavior monitoring have been proposed damage detection approaches based on mooring line monitoring utilize attached sensors e g acoustic emission ae and tension meter to directly acquire the state of the lines and analyze the monitored data in particular real time damage detection becomes possible because mooring line monitoring can be performed continuously different from the underwater inspection method to detect mooring line damage the monitored data mainly analyzed include ae bashir et al 2017 rivera et al 2018 angulo et al 2019 and tension du et al 2013 to obtain these data the measuring instrument must be attached to the mooring line under the sea where the instrument is considerably influenced by various environmental conditions thus it is highly possible that a considerable amount of error may be present in the monitored data as a result damage detection may be inaccurate any damage to the mooring lines affects the change in the dynamic behavioral characteristics of the entire offshore floating structure system composed of the floating platform and mooring lines this implies that the mooring line damage can be estimated by monitoring the changes in the floating platform behavior instead of directly monitoring the mooring line behavior in particular the sensors used for monitoring are attached to the floating platform consequently they are less affected by irregular underwater environmental conditions and the amount of measurement error in the monitored platform data is smaller compared with that in the monitored mooring line data moreover this approach is relatively free from problems related to sensor failure and replacement however because the changes in the behavior of the floating platform induced by the mooring line damage are weaker compared to those of the mooring line behavior itself they are difficult to detect to resolve this limitation ai based methods that exhibit satisfactory detection performance even with small pattern changes have been considered with these methods the mooring line damage can be detected by estimating the small changes in the floating platform behavior focusing on the potential of ai for example chaves et al 2015 confirmed that an artificial neural network ann can estimate and calculate the fatigue life of flexible pipes which corresponds to the damages in the pipes wong and kim 2018 proposed an ann based damage detection approach for the short term fatigue damage of a tensioned riser and kim et al 2020 showed that well trained ann models can effectively detect damage to bottom set gillnets although the results of these studies have shown the potential of ai for damage detection studies still need to be proved with mooring lines studies have been conducted on mooring lines using ai for example jamalkia et al 2016 and sidarta et al 2018 showed that mooring line damage can be detected based on the monitored floating platform behavior data using the fuzzy logic and ann respectively jaiswal and ruskin 2019 used a convolutional neural network cnn model to identify mooring line failures and the cnn model exhibited satisfactory performance however these methods cannot be employed for detecting the local mooring line damage because the results of the study were obtained considering the damage such as the entire mooring line is damaged or the mooring line is cut wang et al 2020 proposed a mooring line damage identification approach using a radial basis function neural network however this approach exhibits a limitation about the reliability of the input data because the changes in the mooring line tension are used as input data to overcome this limitation an approach that included the detection of local mooring line damage based on the monitored floating platform behavior data was proposed in the previous study chung et al 2020 of the authors the proposed approach which was developed based on the dnn was capable of detecting local damage to taut mooring lines the dnn model was trained using the means and standard deviations of the environmental conditions and floating platform behavior data it was confirmed that the dnn based damage detection approach was accurate up to 99 this study proposes a method based on floating platform behavior monitoring for detecting underwater catenary mooring line damage for this purpose the dnn based method which exhibited excellent taut mooring line damage detection as presented in the previous study of the authors was applied to the catenary mooring line and thereafter verified 2 data acquisition from simulation to develop a deep learning model for the mooring line damage detection data derived from various types of damage are required however it is impractical to intentionally inflict damage to the actual mooring line therefore the data obtained from various types of damage were replaced with the simulation data in this study the floating platform and catenary mooring lines were modeled and various environmental condition data were considered to increase the reality of the simulation 2 1 floating offshore structure modelling in this study a floating offshore structure model with different damage locations of the mooring line was simulated under various environmental conditions the structural responses obtained from the simulation and corresponding environmental conditions were converted into a database the database was then divided into training validation and test datasets for the deep learning model to obtain reasonable structural responses to major environmental loads such as wind waves and current a fully coupled hull mooring dynamic analysis was performed in this study in other words the analysis model for obtaining the time domain structural response includes the connected floating platform and mooring lines the mooring lines are fixed to the seabed for the time domain dynamic analysis of the floating offshore structure based on the theory of offshore structural dynamics the frequency dependent hydrodynamic coefficients of the floating platform simulated as a rigid body including added mass radiation damping and wave forces are evaluated in advance through the frequency domain analysis thereafter the results are used as input values of the floating platform in the time domain analysis model therefore in this study radiation and diffraction analyses were first performed to evaluate the frequency dependent hydrodynamic coefficients of the floating platform subsequently the time domain analysis of the entire floating body mooring line model was performed using the fully coupled nonlinear hull mooring riser program charm3d from texas a m university ran and kim 1997 ran et al 1999 tahar and kim 2003 yang and kim 2010 2011 kim and kim 2015 in this study the floating platform model of taylor and jeffrey 1986 which has been widely used in the various analytical studies for floating offshore structures is employed fig 1 the floating platform consists of four circular buoyancy columns connected by four pontoons the detailed specifications of the floating body are summarized in table 1 the installation depth was set at 200 m in addition the radiation and diffraction analyses were performed using ansys aqwa 18 1 to obtain the hydrostatic and hydrodynamic quantities of the floating platform model fig 2 in this model 12 mooring lines are arranged as shown in positions c1 c12 in fig 1 the shapes of the x y and x z axes of the arranged mooring lines are shown in fig 3 all mooring lines have been identically constructed according to the specifications listed in table 2 each mooring line was modeled using 21 beam elements as shown in fig 4 the lengths of mooring line elements are summarized in table 3 deep learning models were trained to generalize the changes in the data patterns this allows for the verification of the validation or test data even though they are not used for training therefore the deep learning model trained with the specified damage candidate elements e2 e5 e11 as listed in table 3 is still expected to detect damaged lines even in damage locations away from e2 e5 and e11 the damage candidate elements e2 e5 and e11 were modeled as shorter elements than others these were defined as damage candidate elements to simulate the local mooring line damage although the same mooring line was damaged the behavior of the floating platform slightly differed according to the damage location along the line in view of this three damage candidate elements were arranged for each mooring line the length of the damage candidates was set to the minimum inspection standard length of 1 98 m international association of classification societies 2011 however a slightly longer damaged element was generated during the catenary shape modeling and mesh generation procedure the length of the longest damage candidate element e2 used in the study was 2 38 m which is fairly short and corresponds to the total length of the mooring line 0 3 of the total length therefore the length of the damage element selected in this study was sufficiently short and still available to validate the proposed approach the length of the remaining elements is set at approximately 50 m when the elements are not in contact with the seafloor and 25 m when they are in contact with the seafloor this study did not consider multiple damage to mooring lines hence the state of a mooring line with single damage whose position corresponded to that of one of the three damage candidate elements of the mooring line was considered as a damage case the damage was assumed to be a 50 loss in the cross section for example three damage cases indicate the damage to the c1 mooring line based on the damage to the upper e2 middle e5 and lower e11 positions therefore 36 damage cases 12 mooring lines with three damage candidate elements per line were created damage was applied to each damage candidate element including a no damage case a total of 37 cases were created 2 2 environment conditions the simulations of the modeled offshore floating structure were performed in the offshore environment of the gulf of mexico which was divided by api2int met into four major sea areas western midwest central and eastern areas the extreme values describing the environmental conditions are given according to the return period 10 25 50 100 200 1 000 2 000 and 10 000 years for each sea area american petroleum institute 2007 in the simulation five environmental conditions i e 10 50 100 1 000 and 10 000 years of return period were used for each sea area thus a total of 20 environmental condition cases were generated as listed in table 4 the 1 h average wind speed wave height and current velocity at sea level were designated as extreme environmental values and the environmental condition data consisting of wind load wave load and current load were generated using each environmental extreme value the wind and wave loads were generated by applying the 1 h average wind speed and significant wave height to the norwegian petroleum directorate npd spectrum and the joint north sea wave observation project jonswap spectrum respectively in this study it was assumed that the directions of the wind and wave are coincide for considering the most severe condition the wind and wave heading is 180 deg from x axis shown in fig 3 a the time interval between two successive changes in the environmental conditions generated through the spectrum was set at 0 02 s which was also the time interval for analyzing the floating platform behavior in the simulation the current load distribution was set to decrease exponentially from the sea level to the seafloor the change over time was not considered for example in the case of environmental conditions with a return period of 10 years in the western sea of the gulf of mexico a 1 h average wind speed of 22 3 m s was applied to the jonswap spectrum and an effective wave height of 6 8 m was applied to the npd spectrum the current velocity of 1 13 m s at sea level was set to decrease exponentially on the sea floor the current velocity profile was assumed to follow the 1 7 power rule as eq 1 similarly the environmental condition data were generated at 0 02 s intervals for all 20 cases of environmental conditions 1 v c z v c z 0 0 m n z d d 1 7 v c z current velocity at depth z d z 0 v c z 0 0 m surface current velocity d water depth meanwhile wind wave and current information should be measured and these values are used as input for practical applications there are many applicable sensors and algorithms for measuring and evaluating wind velocity wave height and current velocity in real time in addition to the direct measurement the measured data of wind wave and current are provided on the website of national oceanic and atmospheric administration s national data buoy center 2021 this means that the required data can be obtained by using the presented data from the center however it is obvious that data for the exact position should be obtained by direct measurement at the platform for precise damage detection the evaluation of the directional characteristics of waves is among one of the challenging issues currently effective evaluation technologies for multidirectional incident waves are being developed therefore it is expected that practical applications will be possible with the advanced technology enabling effective sensing and evaluation algorithms for the ocean environmental conditions in real time 2 3 floating offshore model simulation to obtain the time domain structural response from the simulation the floating offshore structure was modeled using rigid elements and beam elements for the floating platform and mooring lines respectively time domain dynamic analysis was performed as described in section 3 1 the fully coupled hull and mooring analyses were conducted using charm3d to make the database of the dynamic responses in time domain in the time domain analysis the floating platform was modeled as a six degree of freedom 6 dof rigid body with the hydrostatic and hydrodynamic coefficients including added mass radiation damping and wave forces evaluated by performing the radiation and diffraction analysis by ansys aqwa the catenary mooring lines were modeled by 6 dof beam elements the wave and current induced forces acting on the mooring lines were calculated and applied by morison equation the added mass coefficient c a and drag coefficient c d of the chain mooring lines were 1 0 and 2 6 respectively 2nd order wave forces might induce additional floater motion depending on the floater and mooring types additionally vortex induced motion vim due to the current is an important motion characteristic of deep draft semi submersible type platforms additionally vortex induced vibrations due to the current might induce a dynamic response of the mooring lines in this hydrodynamic analysis for generating the response data the effects of the 2nd order wave forces vim of the floater and vim of the mooring lines were not considered because the effects are not major sources of the motion of conventional floating platforms the additional responses due to the secondary effects can be precisely evaluated with the related coefficients obtained experimentally for practical applications it is recommended that additional effects should be considered when training the dnn model considering the floater and mooring types as explained in section 3 1 each mooring line has three damage candidates top middle and bottom damage and the corresponding 60 damage environment scenarios 20 environmental conditions 3 damage candidates were set to have the same state label for training the deep learning model the total of 13 states were defined including 12 single damaged states and 1 undamaged state different from the single damaged state scenarios only one scenario is available in the undamaged state for each of 20 environmental conditions consequently each damaged state has 60 scenarios while the undamaged state has 20 scenarios such difference in the number of scenarios however causes the data imbalance between the single damaged states and the undamaged state to address the data imbalance the simulation of the scenarios in the undamaged state was performed over a period equal to three times the time necessary for the damaged state simulation from the simulation of 720 single damaged state scenarios 60 damage environment scenarios 12 single damage states 720 response data of the platform were generated and each data consists of 12 600 data points at 0 5 s intervals from the simulation of 20 undamaged state scenarios 20 damage environment scenarios 1 undamaged state 20 response data of the platform were generated and each data consists of 37 800 data points at 0 5 s intervals the number of 740 response data was used to train validate and test the deep learning models for detecting the catenary mooring line damage 3 dnn based mooring line damage detection in the previous study of the authors chung et al 2020 the dnn model exhibited satisfactory performance in the taut mooring line damage detection thus the architecture hyperparameters and preprocessing methods of the dnn model developed in the previous study were applied to the present work for the catenary mooring line damage detection 3 1 data preprocessing the environmental conditions wind wave and current loads and 6 dof response data of the floating platform surge sway heave roll pitch and yaw described in section 3 have large scale differences among the variables if the difference in the scale of each variable is large the influence of the variable on a large scale can relatively increase during the dnn model training consequently the training performance may decrease hence the scale was adjusted to obtain a value between 1 and 1 for each variable using eq 2 2 x x x m a x where x indicates a preprocessed variable value x indicates an original variable value x m a x indicates the maximum value among the absolute variable values the previous study of authors chung et al 2020 windowed floating platform behavior into several time series data with an identical period the mean and standard deviation were then extracted from the windowed time series data and used as the input for the dnn model in this process the complexity of the time series data was simplified and the floating platform behaviors were represented as mean and standard deviation this preprocessing method is advantageous as the data is acquired for a relatively short term period and can be effectively utilized and the results of the previous study were satisfactory as well moreover through the preliminary analysis of this study it was found that the dnn based damage detection approach exhibits better performance with mean and standard deviation than with time series data the results of the preliminary analysis are probably due to the difficulty of the long term data to represent the behavior of the platform due to its complexity therefore this study was preferentially conducted using the same preprocessing method as in the previous study the data preprocessed through eq 2 were reconstructed into means and standard deviations per unit time and used as input data for the dnn model at this point if the unit time is set extremely short it is set to be longer than the natural periods of the 6 dof floating platform responses because the characteristics of these responses may not be appropriately reflected therefore 180 s was set as the unit time table 5 this is longer than the natural periods of surge and sway which have the longest natural periods among those of the 6 dof floating platform responses the 6300 s time data for each variable was subsampled into 35 datasets using a 180 s window fig 5 therefore the number of data points generated in all damage environment scenarios including damage cases is 27 300 data from the 720 scenarios for the damaged states were divided into 35 datasets and the data from the 20 scenarios for the undamaged state were divided into 105 datasets the mean and standard deviation of the responses and environmental conditions from each dataset were used as the input data of the dnn model to apply the 27 300 data points to the dnn model these were divided into training validation and test datasets at a ratio of 7 2 1 in addition to consider the measurement errors that may occur in practice errors were intentionally introduced into the test datasets the measurement errors were randomly generated using five truncated gaussian distributions from the zero mean and standard deviation of 1 2 5 10 and 20 and according to the error levels standard deviations of distributions therefore a total of six test datasets including the test dataset with no errors were configured the data points for the training validation and test datasets are listed in table 6 3 2 dnn model architecture the number of nodes in the input and output layers of the dnn model in this study had to be changed because the current load data were also used for learning the number of mooring lines also differed therefore only the initial weight values among the hidden layers of the dnn model of chung et al were used and the parameters connected to the remaining input and output layers were initialized using the xavier method the rectified linear unit relu and softmax were used as the activation function of each hidden layer and classifier of the output layer respectively in addition the cross entropy and adam optimizer were applied as the loss function and optimizer respectively the dnn architecture is shown in fig 6 the input data size was sufficiently small hence the batch size was set at 512 for fast training the learning rate was initially set at 0 001 and decreased by 10 6 as the training progressed 3 3 training results the model training progressed up to 20 000 epochs the dnn model accuracy for the training and validation datasets according to the training epoch is shown in fig 7 as the training progressed the accuracy of the training data set convergence was approximately 100 however the accuracy of the validation dataset decreased after 5814 epochs indicated in fig 7 as a red in the web version line therefore the dnn model in 5814 epochs was selected as the optimal model in view of the overfitting problem from the test of the optimal model the accuracy of each test dataset was derived the accuracy of the optimal dnn model for each test dataset is summarized in table 7 the accuracy of the dnn was low 78 44 even without considering the measurement error in the 1 10 measurement error level the accuracies were 73 86 76 58 and did not significantly reduce compared with that in the case without measurement error however when the measurement error level increased to 20 the accuracy was significantly decreased to 34 65 the dnn based damage detection approach for taut mooring lines exhibited an accuracy exceeding 99 chung et al 2020 however by applying this approach to the detection of catenary mooring line damage the resulting accuracy was low refer to table 7 the foregoing results seem to have occurred because the behaviors of the taut mooring lines and catenary mooring lines differ in influencing the floating platform behavior the high tensile force afforded by the taut mooring line effectively controls the horizontal behavior of the floating platform to maintain the tensile force the taut mooring line should be installed in the pre tensioned state thereby maintaining its taut shape up to the seabed anchor therefore the mooring line behavior can directly affect the floating platform behavior by contrast the weight of the catenary mooring line controls the behavior of the floating platform to increase this weight the catenary mooring line is designed to be longer than the water depth to form a seemingly drooping shape underwater considering these characteristics the capacity of the catenary mooring line compared with that of the taut mooring line to control the horizontal behavior of the floating platform is relatively low evidently the behavior of the catenary mooring line barely affects the behavior of the floating platform therefore the mean and standard deviation of the environmental condition data and floating body behavior data used for training the dnn model may not be appropriate for damage detection of the catenary mooring line as an alternative to the detection of damage in the catenary mooring line it is considered that the deep learning model is trained using continuous time series data instead of the mean and standard deviation values of the environmental condition data and floating body behavior data accordingly an rnn exhibiting satisfactory performance in working with time series data was used as a deep learning model for catenary mooring line damage detection 4 rnn based mooring line damage detection different from the general dnn the rnn which is also a deep learning network is a neural network suitable for training sequential data or time series data that change over time lee et al 2020 in particular environmental conditions and floating platform behavior data are time series data and damage mooring line information is extracted from these data hence it is possible for the rnn to exhibit satisfactory performance in detecting catenary mooring line damage based on the floating platform behavior data 4 1 sequence data regeneration to train the rnn it is necessary to reconstruct the environmental conditions and floating body behavior data in sequence units for the rnn model input data were also preprocessed using eq 2 in addition the length of the sequence was set at 180 s in consideration of the natural period of the floating platform as described in section 4 1 by contrast the sequence data for the rnn model were regenerated by overlapping the 180 s sliding window at 5 s intervals because it was determined that the data continuity would be used for the rnn model to exhibit better performance than the dnn model for example the time window is initially located between 0 and 180 s and then moves every 5 s from 5 to 185 s and from 10 to 190 s for convenience of preprocessing 1000 sequence data were randomly sampled in each damage environment scenario a total of 720 scenarios and 3000 sequence data were randomly sampled from each scenario a total of 20 scenarios of the undamaged state therefore a total of 780 000 sequence data 720 1000 data and 20 3000 data were generated because the environmental conditions and floating body behavior data were generated at 0 5 s intervals section 3 the data for every 180 s have a sequence length of 360 however in general if the length of the rnn sequence input exceeds 200 the training performance is potentially inadequate to resolve this the sequence data at 0 5 s intervals were downsampled at 1 5 s intervals allowing the sequence data to be reconstructed with a length of 120 for the rnn model training and validation 780 000 data were divided into training validation and test datasets at a ratio of 7 2 1 table 8 the test datasets were considered to have six levels of measurement error which is similar to those of the dnn model section 4 1 4 2 rnn model architectures as described in section 5 1 the rnn model was constructed to accept the sequence datasets of environmental conditions and floating body behavior as inputs and to output the class of the damaged mooring line fig 8 fig 8 shows the rnn with an input layer for the sequence data a hidden layer a fully connected fc layer and an output layer this model is named s1 as shown in fig 8 the sequence data with a length of 120 are sequentially inputted and each cell in the input layer and hidden layer contains nine variables three environmental conditions and 6 dof floating platform responses meanwhile because the rnn model performance may vary based on the number of hidden layers this study has attempted to present an optimal model obtained by comparing the rnn models with different numbers of hidden layers rnn models with 2 3 4 and 5 hidden layers were designed and named s2 s3 s4 and s5 respectively fig 9 in configuring the rnn architectures the weights for the hidden layers were initialized by the orthogonal method whereas those for the other layers were initialized using the xavier method the relu and sigmoid were applied as activation functions for the hidden and fc layers respectively softmax was used as the classifier of the output layer and the sparse categorical cross entropy and adam optimizer were applied as the loss function and optimizer respectively during training the batch size and learning rate were set at 512 and 0 001 respectively these values were used for all layers of the rnn models 4 3 training results the rnn models from s1 to s5 were trained up to 100 epochs using the same training and validation datasets fig 10 shows the accuracy graphs of the training and validation of the five models the red in the web version dotted line indicates the epoch when the accuracy of the validation data set is highest therefore the rnn models in these corresponding epochs were selected as the optimal models for each rnn the test accuracies of the rnn models are listed in table 9 based on the results of the test accuracies of the five optimal models the s4 model with four hidden layers exhibited the highest accuracy this model only misclassified one of the 156 000 data points included in the test data set without measurement errors and demonstrated a near perfect accuracy of 99 99 in addition even with measurement errors the s4 model exhibited satisfactory accuracies of 99 59 99 99 these accuracies indicate that the rnn based deep learning model is effective in the detection of catenary mooring line damage the results of the rnn models considerably differ from those of the dnn models presented in section 4 the dnn models trained with the mean and standard deviation of environmental conditions and 6 dof floating platform response data exhibited low accuracies only up to 78 44 whereas the rnn models trained with the time series data showed near perfect accuracies of at least 98 30 these findings indicate that the behavior of the floating platform supported by the catenary mooring line cannot be represented by the mean and standard deviation values in particular considering the near perfect accuracies of the rnn models in the presence of measurement errors the environmental conditions and floating platform response data collected over time imply that a clear pattern resulting from the mooring line damage exists in addition the proposed rnn models are considered to be effective for detecting the initial damage to the catenary mooring line because they can detect minimal local damage as small as 2 m 5 conclusions in this study a deep learning approach for the detection of catenary mooring line damage including small local damage was proposed to train the deep learning models environmental conditions and 6 dof floating platform behavior data generated through simulation were used for the simulation floating structures were modeled and environmental conditions were created and applied considering the combination of 37 single mooring line damage cases one undamaged case and 20 environmental conditions 740 damage environment scenarios were created the offshore floating structure model was simulated for each scenario and the floating platform response data and corresponding environmental condition data were acquired using these data the dnn based catenary mooring line damage detection model based on previous studies was developed the accuracy of the dnn mode reached 78 44 although there was no measurement error in the test data at the 1 10 measurement error level the accuracy was 73 86 76 58 hence the test accuracies were unsatisfactory in particular the dnn model exhibited an extremely low accuracy of 34 65 at the 20 measurement error level these results were considered to have occurred because the mean and standard deviation of the floating platform response data and corresponding environmental conditions did not precisely represent the floating platform behavior based on the characteristics of the catenary mooring line as an alternative to the mean and standard deviation the time series type data were considered and the rnn model was employed to achieve an effective time series data analysis in this study five rnn model architectures with different numbers of hidden layers were designed thereafter the damage detection performance of each rnn model was verified the test accuracies of the optimal rnn models with and without measurement errors were near perfect at 99 59 99 99 while the previous study chung et al 2020 is limited to taut lines catenary mooring lines are mostly used to support a floating offshore platform compared to taut lines the catenary mooring line damage detection based on the floating platform response data is considerably challenging because the damage influence only slightly affects the behavior of the floating platform despite this challenge this study demonstrated that the rnn based damage detection approach can accurately identify even small local catenary mooring line damage besides because the proposed approach utilizes a pre trained rnn model real time damage detection is possible in practice regardless of whether only one real time data set is measured the proposed rnn based damage detection technique is apparently advantageous in precluding accidents resulting from mooring line destruction because it affords the early detection of catenary mooring line damage credit authorship contribution statement kanghyeok lee conceptualization methodology validation writing original draft writing review editing minwoong chung conceptualization methodology data curation writing original draft seungjun kim software writing review editing do hyoung shin writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national research foundation of korea nrf grant funded by the korea government msit no 2017r1a2b4011753 
20885,the damage detection of mooring lines is critical to safe operations because the stability of offshore floating platforms depends on the integrity of such lines however existing mooring line damage detection techniques are considerably limited because they cannot be implemented constantly to resolve this inadequacy this paper proposes a deep learning based approach that can detect underwater mooring line damage based on the real time monitored response data of floating structures catenary mooring lines one of the most widely applied types for floating offshore structures are selected for the study in the proposed approach the detection model of catenary mooring line damage uses both the response data generated through the simulation of the floating structure and the corresponding environmental condition data in particular a recurrent neural network rnn that can effectively analyze the time series continuity of the response data is employed for damage detection the results of the rnn based catenary mooring line damage detection approach proposed in this study confirm that the rnn model exhibits minimum and maximum detection accuracies of 99 59 and 99 99 respectively regardless of whether the measurement data include errors these detection accuracies indicate that the proposed approach can be used to determine mooring line damage under actual field conditions keywords damage detection catenary mooring line recurrent neural networks rnn deep neural networks dnn offshore floating structure 1 introduction 1 1 backgrounds rational mooring systems are required to maintain the target position and to secure the structural stability of offshore floating structures in general a mooring system is composed of a number of mooring lines that can be damaged by the environment or friction with the seabed during their lifecycle according to a survey conducted by souza and majhi 2013 more than 1500 mooring lines were damaged during 2000 2014 resulting in more than 2 trillion usd worth of economic losses damage to mooring lines not only leads to considerable economic losses but also results in damage to life and property when floating structures overturn or sink for instance in 1981 an accident on the platform resulting from damaged mooring lines destroyed the structure and caused 123 deaths moan 1985 to prevent such accidents the monitored response data of floating structures were recently analyzed through artificial intelligence ai to identify and estimate influences by damage to mooring lines jamalkia et al 2016 sidarta et al 2018 although the results of the previous studies demonstrate the possibility of detecting mooring line damage based on the response data of the floating structure these studies have only considered the situation where the entire mooring line is damaged or completely broken consequently these studies are limited because local mooring line damage which can be smaller than the damage considered in their analyses may have been left undetected to resolve the foregoing a previous study of authors proposed the damage detection approach using a deep neural network dnn in this case the dnn one of the ai techniques is trained with the environmental conditions and response data of a floating structure to include the detection of local mooring line damage this damage detection technique has a relatively high accuracy however its application is only limited to taut mooring lines mooring lines are classified as catenary and taut systems based on the initial shape of a line the stiffness of the taut type mooring lines directly affects the structural behavior of the floating offshore structures due to the characteristics of the mooring system in contrast the stiffness of the catenary type mooring lines might not significantly affect the structural behavior of the structure because the position of the structure is mainly maintained by the weight of the mooring not stiffness therefore the damage detection approach of taut mooring lines may not be effective for catenary mooring lines the catenary mooring line is one of the most widely used types for floating offshore structures because of the reliability of materials ease of fabrication and sustained development of installation technology especially it is a representative mooring system mainly used in shallow water areas with a depth of 200 m although continuous developments in the catenary mooring system in terms of installation design fabrication inspection and analysis technology to ensure the safe operation of floating offshore structures are ongoing an effective damage detection approach for catenary mooring lines still requires development and application accordingly this study proposes a detection method that can also determine local catenary mooring line damage based on the environmental condition and floating structure response data for this purpose deep learning which is typically employed for extracting and classifying valid information from complex data is applied considering the randomness of environmental conditions and the complexity of the response data of a floating structure to train a deep learning model for the aforementioned objective the response data of a floating structure under various states where different mooring lines are damaged are required however considering safety and economics it is impractical to intentionally inflict damage to the mooring line under actual field conditions hence simulation data are used as substitute for the simulation a floating structure was modeled and environmental condition data were generated and applied in addition damage environment scenarios were constructed by combining the mooring line damage and environmental condition cases the response data of the floating structure were then obtained by performing simulations for each damage environment scenario for deep learning the simulated environmental conditions and response data of the modeled floating structure were considered 1 2 literature review the visual inspection of mooring lines can be categorized as out of water and underwater inspections brown et al 2005 in the out of water inspection the mooring line is pulled out of the water for examination only when the structure such as a drillship moves to another location after completing its operation hence this inspection technique is difficult to employ for the constant detection of mooring line damage accordingly for general offshore floating structures the underwater inspection method is mainly used underwater inspection mainly employs a visual examination technique that makes it possible to directly check the mooring line damage through images or videos with the advancement in the technology of equipment such as 3d and high resolution cameras underwater inspection methods using images and videos have also improved hall and trower 2011 however marine organisms attached to the mooring lines and the high water turbidity caused by many floating objects in the sea make it difficult for the camera to secure a clear field of view consequently it is not easy to check the damage to the mooring line moreover the operating water depth of the exploration equipment for underwater inspection is limited bashir et al 2017 even mooring line climbing robots which have recently been developed to solve this problem dissanayake et al 2018 hernandez et al 2018 kimball et al 2018 cannot be constantly used for inspecting the entire mooring line because of their low inspection speed in view of the foregoing limitations of underwater inspection several alternative damage detection methods based on the mooring line behavior monitoring have been proposed damage detection approaches based on mooring line monitoring utilize attached sensors e g acoustic emission ae and tension meter to directly acquire the state of the lines and analyze the monitored data in particular real time damage detection becomes possible because mooring line monitoring can be performed continuously different from the underwater inspection method to detect mooring line damage the monitored data mainly analyzed include ae bashir et al 2017 rivera et al 2018 angulo et al 2019 and tension du et al 2013 to obtain these data the measuring instrument must be attached to the mooring line under the sea where the instrument is considerably influenced by various environmental conditions thus it is highly possible that a considerable amount of error may be present in the monitored data as a result damage detection may be inaccurate any damage to the mooring lines affects the change in the dynamic behavioral characteristics of the entire offshore floating structure system composed of the floating platform and mooring lines this implies that the mooring line damage can be estimated by monitoring the changes in the floating platform behavior instead of directly monitoring the mooring line behavior in particular the sensors used for monitoring are attached to the floating platform consequently they are less affected by irregular underwater environmental conditions and the amount of measurement error in the monitored platform data is smaller compared with that in the monitored mooring line data moreover this approach is relatively free from problems related to sensor failure and replacement however because the changes in the behavior of the floating platform induced by the mooring line damage are weaker compared to those of the mooring line behavior itself they are difficult to detect to resolve this limitation ai based methods that exhibit satisfactory detection performance even with small pattern changes have been considered with these methods the mooring line damage can be detected by estimating the small changes in the floating platform behavior focusing on the potential of ai for example chaves et al 2015 confirmed that an artificial neural network ann can estimate and calculate the fatigue life of flexible pipes which corresponds to the damages in the pipes wong and kim 2018 proposed an ann based damage detection approach for the short term fatigue damage of a tensioned riser and kim et al 2020 showed that well trained ann models can effectively detect damage to bottom set gillnets although the results of these studies have shown the potential of ai for damage detection studies still need to be proved with mooring lines studies have been conducted on mooring lines using ai for example jamalkia et al 2016 and sidarta et al 2018 showed that mooring line damage can be detected based on the monitored floating platform behavior data using the fuzzy logic and ann respectively jaiswal and ruskin 2019 used a convolutional neural network cnn model to identify mooring line failures and the cnn model exhibited satisfactory performance however these methods cannot be employed for detecting the local mooring line damage because the results of the study were obtained considering the damage such as the entire mooring line is damaged or the mooring line is cut wang et al 2020 proposed a mooring line damage identification approach using a radial basis function neural network however this approach exhibits a limitation about the reliability of the input data because the changes in the mooring line tension are used as input data to overcome this limitation an approach that included the detection of local mooring line damage based on the monitored floating platform behavior data was proposed in the previous study chung et al 2020 of the authors the proposed approach which was developed based on the dnn was capable of detecting local damage to taut mooring lines the dnn model was trained using the means and standard deviations of the environmental conditions and floating platform behavior data it was confirmed that the dnn based damage detection approach was accurate up to 99 this study proposes a method based on floating platform behavior monitoring for detecting underwater catenary mooring line damage for this purpose the dnn based method which exhibited excellent taut mooring line damage detection as presented in the previous study of the authors was applied to the catenary mooring line and thereafter verified 2 data acquisition from simulation to develop a deep learning model for the mooring line damage detection data derived from various types of damage are required however it is impractical to intentionally inflict damage to the actual mooring line therefore the data obtained from various types of damage were replaced with the simulation data in this study the floating platform and catenary mooring lines were modeled and various environmental condition data were considered to increase the reality of the simulation 2 1 floating offshore structure modelling in this study a floating offshore structure model with different damage locations of the mooring line was simulated under various environmental conditions the structural responses obtained from the simulation and corresponding environmental conditions were converted into a database the database was then divided into training validation and test datasets for the deep learning model to obtain reasonable structural responses to major environmental loads such as wind waves and current a fully coupled hull mooring dynamic analysis was performed in this study in other words the analysis model for obtaining the time domain structural response includes the connected floating platform and mooring lines the mooring lines are fixed to the seabed for the time domain dynamic analysis of the floating offshore structure based on the theory of offshore structural dynamics the frequency dependent hydrodynamic coefficients of the floating platform simulated as a rigid body including added mass radiation damping and wave forces are evaluated in advance through the frequency domain analysis thereafter the results are used as input values of the floating platform in the time domain analysis model therefore in this study radiation and diffraction analyses were first performed to evaluate the frequency dependent hydrodynamic coefficients of the floating platform subsequently the time domain analysis of the entire floating body mooring line model was performed using the fully coupled nonlinear hull mooring riser program charm3d from texas a m university ran and kim 1997 ran et al 1999 tahar and kim 2003 yang and kim 2010 2011 kim and kim 2015 in this study the floating platform model of taylor and jeffrey 1986 which has been widely used in the various analytical studies for floating offshore structures is employed fig 1 the floating platform consists of four circular buoyancy columns connected by four pontoons the detailed specifications of the floating body are summarized in table 1 the installation depth was set at 200 m in addition the radiation and diffraction analyses were performed using ansys aqwa 18 1 to obtain the hydrostatic and hydrodynamic quantities of the floating platform model fig 2 in this model 12 mooring lines are arranged as shown in positions c1 c12 in fig 1 the shapes of the x y and x z axes of the arranged mooring lines are shown in fig 3 all mooring lines have been identically constructed according to the specifications listed in table 2 each mooring line was modeled using 21 beam elements as shown in fig 4 the lengths of mooring line elements are summarized in table 3 deep learning models were trained to generalize the changes in the data patterns this allows for the verification of the validation or test data even though they are not used for training therefore the deep learning model trained with the specified damage candidate elements e2 e5 e11 as listed in table 3 is still expected to detect damaged lines even in damage locations away from e2 e5 and e11 the damage candidate elements e2 e5 and e11 were modeled as shorter elements than others these were defined as damage candidate elements to simulate the local mooring line damage although the same mooring line was damaged the behavior of the floating platform slightly differed according to the damage location along the line in view of this three damage candidate elements were arranged for each mooring line the length of the damage candidates was set to the minimum inspection standard length of 1 98 m international association of classification societies 2011 however a slightly longer damaged element was generated during the catenary shape modeling and mesh generation procedure the length of the longest damage candidate element e2 used in the study was 2 38 m which is fairly short and corresponds to the total length of the mooring line 0 3 of the total length therefore the length of the damage element selected in this study was sufficiently short and still available to validate the proposed approach the length of the remaining elements is set at approximately 50 m when the elements are not in contact with the seafloor and 25 m when they are in contact with the seafloor this study did not consider multiple damage to mooring lines hence the state of a mooring line with single damage whose position corresponded to that of one of the three damage candidate elements of the mooring line was considered as a damage case the damage was assumed to be a 50 loss in the cross section for example three damage cases indicate the damage to the c1 mooring line based on the damage to the upper e2 middle e5 and lower e11 positions therefore 36 damage cases 12 mooring lines with three damage candidate elements per line were created damage was applied to each damage candidate element including a no damage case a total of 37 cases were created 2 2 environment conditions the simulations of the modeled offshore floating structure were performed in the offshore environment of the gulf of mexico which was divided by api2int met into four major sea areas western midwest central and eastern areas the extreme values describing the environmental conditions are given according to the return period 10 25 50 100 200 1 000 2 000 and 10 000 years for each sea area american petroleum institute 2007 in the simulation five environmental conditions i e 10 50 100 1 000 and 10 000 years of return period were used for each sea area thus a total of 20 environmental condition cases were generated as listed in table 4 the 1 h average wind speed wave height and current velocity at sea level were designated as extreme environmental values and the environmental condition data consisting of wind load wave load and current load were generated using each environmental extreme value the wind and wave loads were generated by applying the 1 h average wind speed and significant wave height to the norwegian petroleum directorate npd spectrum and the joint north sea wave observation project jonswap spectrum respectively in this study it was assumed that the directions of the wind and wave are coincide for considering the most severe condition the wind and wave heading is 180 deg from x axis shown in fig 3 a the time interval between two successive changes in the environmental conditions generated through the spectrum was set at 0 02 s which was also the time interval for analyzing the floating platform behavior in the simulation the current load distribution was set to decrease exponentially from the sea level to the seafloor the change over time was not considered for example in the case of environmental conditions with a return period of 10 years in the western sea of the gulf of mexico a 1 h average wind speed of 22 3 m s was applied to the jonswap spectrum and an effective wave height of 6 8 m was applied to the npd spectrum the current velocity of 1 13 m s at sea level was set to decrease exponentially on the sea floor the current velocity profile was assumed to follow the 1 7 power rule as eq 1 similarly the environmental condition data were generated at 0 02 s intervals for all 20 cases of environmental conditions 1 v c z v c z 0 0 m n z d d 1 7 v c z current velocity at depth z d z 0 v c z 0 0 m surface current velocity d water depth meanwhile wind wave and current information should be measured and these values are used as input for practical applications there are many applicable sensors and algorithms for measuring and evaluating wind velocity wave height and current velocity in real time in addition to the direct measurement the measured data of wind wave and current are provided on the website of national oceanic and atmospheric administration s national data buoy center 2021 this means that the required data can be obtained by using the presented data from the center however it is obvious that data for the exact position should be obtained by direct measurement at the platform for precise damage detection the evaluation of the directional characteristics of waves is among one of the challenging issues currently effective evaluation technologies for multidirectional incident waves are being developed therefore it is expected that practical applications will be possible with the advanced technology enabling effective sensing and evaluation algorithms for the ocean environmental conditions in real time 2 3 floating offshore model simulation to obtain the time domain structural response from the simulation the floating offshore structure was modeled using rigid elements and beam elements for the floating platform and mooring lines respectively time domain dynamic analysis was performed as described in section 3 1 the fully coupled hull and mooring analyses were conducted using charm3d to make the database of the dynamic responses in time domain in the time domain analysis the floating platform was modeled as a six degree of freedom 6 dof rigid body with the hydrostatic and hydrodynamic coefficients including added mass radiation damping and wave forces evaluated by performing the radiation and diffraction analysis by ansys aqwa the catenary mooring lines were modeled by 6 dof beam elements the wave and current induced forces acting on the mooring lines were calculated and applied by morison equation the added mass coefficient c a and drag coefficient c d of the chain mooring lines were 1 0 and 2 6 respectively 2nd order wave forces might induce additional floater motion depending on the floater and mooring types additionally vortex induced motion vim due to the current is an important motion characteristic of deep draft semi submersible type platforms additionally vortex induced vibrations due to the current might induce a dynamic response of the mooring lines in this hydrodynamic analysis for generating the response data the effects of the 2nd order wave forces vim of the floater and vim of the mooring lines were not considered because the effects are not major sources of the motion of conventional floating platforms the additional responses due to the secondary effects can be precisely evaluated with the related coefficients obtained experimentally for practical applications it is recommended that additional effects should be considered when training the dnn model considering the floater and mooring types as explained in section 3 1 each mooring line has three damage candidates top middle and bottom damage and the corresponding 60 damage environment scenarios 20 environmental conditions 3 damage candidates were set to have the same state label for training the deep learning model the total of 13 states were defined including 12 single damaged states and 1 undamaged state different from the single damaged state scenarios only one scenario is available in the undamaged state for each of 20 environmental conditions consequently each damaged state has 60 scenarios while the undamaged state has 20 scenarios such difference in the number of scenarios however causes the data imbalance between the single damaged states and the undamaged state to address the data imbalance the simulation of the scenarios in the undamaged state was performed over a period equal to three times the time necessary for the damaged state simulation from the simulation of 720 single damaged state scenarios 60 damage environment scenarios 12 single damage states 720 response data of the platform were generated and each data consists of 12 600 data points at 0 5 s intervals from the simulation of 20 undamaged state scenarios 20 damage environment scenarios 1 undamaged state 20 response data of the platform were generated and each data consists of 37 800 data points at 0 5 s intervals the number of 740 response data was used to train validate and test the deep learning models for detecting the catenary mooring line damage 3 dnn based mooring line damage detection in the previous study of the authors chung et al 2020 the dnn model exhibited satisfactory performance in the taut mooring line damage detection thus the architecture hyperparameters and preprocessing methods of the dnn model developed in the previous study were applied to the present work for the catenary mooring line damage detection 3 1 data preprocessing the environmental conditions wind wave and current loads and 6 dof response data of the floating platform surge sway heave roll pitch and yaw described in section 3 have large scale differences among the variables if the difference in the scale of each variable is large the influence of the variable on a large scale can relatively increase during the dnn model training consequently the training performance may decrease hence the scale was adjusted to obtain a value between 1 and 1 for each variable using eq 2 2 x x x m a x where x indicates a preprocessed variable value x indicates an original variable value x m a x indicates the maximum value among the absolute variable values the previous study of authors chung et al 2020 windowed floating platform behavior into several time series data with an identical period the mean and standard deviation were then extracted from the windowed time series data and used as the input for the dnn model in this process the complexity of the time series data was simplified and the floating platform behaviors were represented as mean and standard deviation this preprocessing method is advantageous as the data is acquired for a relatively short term period and can be effectively utilized and the results of the previous study were satisfactory as well moreover through the preliminary analysis of this study it was found that the dnn based damage detection approach exhibits better performance with mean and standard deviation than with time series data the results of the preliminary analysis are probably due to the difficulty of the long term data to represent the behavior of the platform due to its complexity therefore this study was preferentially conducted using the same preprocessing method as in the previous study the data preprocessed through eq 2 were reconstructed into means and standard deviations per unit time and used as input data for the dnn model at this point if the unit time is set extremely short it is set to be longer than the natural periods of the 6 dof floating platform responses because the characteristics of these responses may not be appropriately reflected therefore 180 s was set as the unit time table 5 this is longer than the natural periods of surge and sway which have the longest natural periods among those of the 6 dof floating platform responses the 6300 s time data for each variable was subsampled into 35 datasets using a 180 s window fig 5 therefore the number of data points generated in all damage environment scenarios including damage cases is 27 300 data from the 720 scenarios for the damaged states were divided into 35 datasets and the data from the 20 scenarios for the undamaged state were divided into 105 datasets the mean and standard deviation of the responses and environmental conditions from each dataset were used as the input data of the dnn model to apply the 27 300 data points to the dnn model these were divided into training validation and test datasets at a ratio of 7 2 1 in addition to consider the measurement errors that may occur in practice errors were intentionally introduced into the test datasets the measurement errors were randomly generated using five truncated gaussian distributions from the zero mean and standard deviation of 1 2 5 10 and 20 and according to the error levels standard deviations of distributions therefore a total of six test datasets including the test dataset with no errors were configured the data points for the training validation and test datasets are listed in table 6 3 2 dnn model architecture the number of nodes in the input and output layers of the dnn model in this study had to be changed because the current load data were also used for learning the number of mooring lines also differed therefore only the initial weight values among the hidden layers of the dnn model of chung et al were used and the parameters connected to the remaining input and output layers were initialized using the xavier method the rectified linear unit relu and softmax were used as the activation function of each hidden layer and classifier of the output layer respectively in addition the cross entropy and adam optimizer were applied as the loss function and optimizer respectively the dnn architecture is shown in fig 6 the input data size was sufficiently small hence the batch size was set at 512 for fast training the learning rate was initially set at 0 001 and decreased by 10 6 as the training progressed 3 3 training results the model training progressed up to 20 000 epochs the dnn model accuracy for the training and validation datasets according to the training epoch is shown in fig 7 as the training progressed the accuracy of the training data set convergence was approximately 100 however the accuracy of the validation dataset decreased after 5814 epochs indicated in fig 7 as a red in the web version line therefore the dnn model in 5814 epochs was selected as the optimal model in view of the overfitting problem from the test of the optimal model the accuracy of each test dataset was derived the accuracy of the optimal dnn model for each test dataset is summarized in table 7 the accuracy of the dnn was low 78 44 even without considering the measurement error in the 1 10 measurement error level the accuracies were 73 86 76 58 and did not significantly reduce compared with that in the case without measurement error however when the measurement error level increased to 20 the accuracy was significantly decreased to 34 65 the dnn based damage detection approach for taut mooring lines exhibited an accuracy exceeding 99 chung et al 2020 however by applying this approach to the detection of catenary mooring line damage the resulting accuracy was low refer to table 7 the foregoing results seem to have occurred because the behaviors of the taut mooring lines and catenary mooring lines differ in influencing the floating platform behavior the high tensile force afforded by the taut mooring line effectively controls the horizontal behavior of the floating platform to maintain the tensile force the taut mooring line should be installed in the pre tensioned state thereby maintaining its taut shape up to the seabed anchor therefore the mooring line behavior can directly affect the floating platform behavior by contrast the weight of the catenary mooring line controls the behavior of the floating platform to increase this weight the catenary mooring line is designed to be longer than the water depth to form a seemingly drooping shape underwater considering these characteristics the capacity of the catenary mooring line compared with that of the taut mooring line to control the horizontal behavior of the floating platform is relatively low evidently the behavior of the catenary mooring line barely affects the behavior of the floating platform therefore the mean and standard deviation of the environmental condition data and floating body behavior data used for training the dnn model may not be appropriate for damage detection of the catenary mooring line as an alternative to the detection of damage in the catenary mooring line it is considered that the deep learning model is trained using continuous time series data instead of the mean and standard deviation values of the environmental condition data and floating body behavior data accordingly an rnn exhibiting satisfactory performance in working with time series data was used as a deep learning model for catenary mooring line damage detection 4 rnn based mooring line damage detection different from the general dnn the rnn which is also a deep learning network is a neural network suitable for training sequential data or time series data that change over time lee et al 2020 in particular environmental conditions and floating platform behavior data are time series data and damage mooring line information is extracted from these data hence it is possible for the rnn to exhibit satisfactory performance in detecting catenary mooring line damage based on the floating platform behavior data 4 1 sequence data regeneration to train the rnn it is necessary to reconstruct the environmental conditions and floating body behavior data in sequence units for the rnn model input data were also preprocessed using eq 2 in addition the length of the sequence was set at 180 s in consideration of the natural period of the floating platform as described in section 4 1 by contrast the sequence data for the rnn model were regenerated by overlapping the 180 s sliding window at 5 s intervals because it was determined that the data continuity would be used for the rnn model to exhibit better performance than the dnn model for example the time window is initially located between 0 and 180 s and then moves every 5 s from 5 to 185 s and from 10 to 190 s for convenience of preprocessing 1000 sequence data were randomly sampled in each damage environment scenario a total of 720 scenarios and 3000 sequence data were randomly sampled from each scenario a total of 20 scenarios of the undamaged state therefore a total of 780 000 sequence data 720 1000 data and 20 3000 data were generated because the environmental conditions and floating body behavior data were generated at 0 5 s intervals section 3 the data for every 180 s have a sequence length of 360 however in general if the length of the rnn sequence input exceeds 200 the training performance is potentially inadequate to resolve this the sequence data at 0 5 s intervals were downsampled at 1 5 s intervals allowing the sequence data to be reconstructed with a length of 120 for the rnn model training and validation 780 000 data were divided into training validation and test datasets at a ratio of 7 2 1 table 8 the test datasets were considered to have six levels of measurement error which is similar to those of the dnn model section 4 1 4 2 rnn model architectures as described in section 5 1 the rnn model was constructed to accept the sequence datasets of environmental conditions and floating body behavior as inputs and to output the class of the damaged mooring line fig 8 fig 8 shows the rnn with an input layer for the sequence data a hidden layer a fully connected fc layer and an output layer this model is named s1 as shown in fig 8 the sequence data with a length of 120 are sequentially inputted and each cell in the input layer and hidden layer contains nine variables three environmental conditions and 6 dof floating platform responses meanwhile because the rnn model performance may vary based on the number of hidden layers this study has attempted to present an optimal model obtained by comparing the rnn models with different numbers of hidden layers rnn models with 2 3 4 and 5 hidden layers were designed and named s2 s3 s4 and s5 respectively fig 9 in configuring the rnn architectures the weights for the hidden layers were initialized by the orthogonal method whereas those for the other layers were initialized using the xavier method the relu and sigmoid were applied as activation functions for the hidden and fc layers respectively softmax was used as the classifier of the output layer and the sparse categorical cross entropy and adam optimizer were applied as the loss function and optimizer respectively during training the batch size and learning rate were set at 512 and 0 001 respectively these values were used for all layers of the rnn models 4 3 training results the rnn models from s1 to s5 were trained up to 100 epochs using the same training and validation datasets fig 10 shows the accuracy graphs of the training and validation of the five models the red in the web version dotted line indicates the epoch when the accuracy of the validation data set is highest therefore the rnn models in these corresponding epochs were selected as the optimal models for each rnn the test accuracies of the rnn models are listed in table 9 based on the results of the test accuracies of the five optimal models the s4 model with four hidden layers exhibited the highest accuracy this model only misclassified one of the 156 000 data points included in the test data set without measurement errors and demonstrated a near perfect accuracy of 99 99 in addition even with measurement errors the s4 model exhibited satisfactory accuracies of 99 59 99 99 these accuracies indicate that the rnn based deep learning model is effective in the detection of catenary mooring line damage the results of the rnn models considerably differ from those of the dnn models presented in section 4 the dnn models trained with the mean and standard deviation of environmental conditions and 6 dof floating platform response data exhibited low accuracies only up to 78 44 whereas the rnn models trained with the time series data showed near perfect accuracies of at least 98 30 these findings indicate that the behavior of the floating platform supported by the catenary mooring line cannot be represented by the mean and standard deviation values in particular considering the near perfect accuracies of the rnn models in the presence of measurement errors the environmental conditions and floating platform response data collected over time imply that a clear pattern resulting from the mooring line damage exists in addition the proposed rnn models are considered to be effective for detecting the initial damage to the catenary mooring line because they can detect minimal local damage as small as 2 m 5 conclusions in this study a deep learning approach for the detection of catenary mooring line damage including small local damage was proposed to train the deep learning models environmental conditions and 6 dof floating platform behavior data generated through simulation were used for the simulation floating structures were modeled and environmental conditions were created and applied considering the combination of 37 single mooring line damage cases one undamaged case and 20 environmental conditions 740 damage environment scenarios were created the offshore floating structure model was simulated for each scenario and the floating platform response data and corresponding environmental condition data were acquired using these data the dnn based catenary mooring line damage detection model based on previous studies was developed the accuracy of the dnn mode reached 78 44 although there was no measurement error in the test data at the 1 10 measurement error level the accuracy was 73 86 76 58 hence the test accuracies were unsatisfactory in particular the dnn model exhibited an extremely low accuracy of 34 65 at the 20 measurement error level these results were considered to have occurred because the mean and standard deviation of the floating platform response data and corresponding environmental conditions did not precisely represent the floating platform behavior based on the characteristics of the catenary mooring line as an alternative to the mean and standard deviation the time series type data were considered and the rnn model was employed to achieve an effective time series data analysis in this study five rnn model architectures with different numbers of hidden layers were designed thereafter the damage detection performance of each rnn model was verified the test accuracies of the optimal rnn models with and without measurement errors were near perfect at 99 59 99 99 while the previous study chung et al 2020 is limited to taut lines catenary mooring lines are mostly used to support a floating offshore platform compared to taut lines the catenary mooring line damage detection based on the floating platform response data is considerably challenging because the damage influence only slightly affects the behavior of the floating platform despite this challenge this study demonstrated that the rnn based damage detection approach can accurately identify even small local catenary mooring line damage besides because the proposed approach utilizes a pre trained rnn model real time damage detection is possible in practice regardless of whether only one real time data set is measured the proposed rnn based damage detection technique is apparently advantageous in precluding accidents resulting from mooring line destruction because it affords the early detection of catenary mooring line damage credit authorship contribution statement kanghyeok lee conceptualization methodology validation writing original draft writing review editing minwoong chung conceptualization methodology data curation writing original draft seungjun kim software writing review editing do hyoung shin writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national research foundation of korea nrf grant funded by the korea government msit no 2017r1a2b4011753 
20886,despite extensive use of curved pipes conveying high speed fluids in many engineering fields few researches have been conducted on the supercritical dynamics of curved pipes to explore new dynamic behavior for the first time this paper investigates the vibration characteristics of a slightly curved pipe conveying fluids in a supercritical range the generalized hamilton s principle is adopted to derive the governing equation the non trivial equilibriums and the critical flow velocities are then analytically obtained the analytical predictions agree well with the numerical results obtained using the finite difference method and the differential quadrature element method by introducing the coordinate transformation the governing equation of the curved pipe is established for the vibration about the non trivial equilibrium position the natural frequencies of the pipe are obtained by the galerkin truncation method and verified with the discrete fourier transform it is found that the critical velocities and the natural frequencies are highly dependent on the initial curvature the research results show an interesting phenomenon that the natural frequency of the curved pipe may increase as the pipe length increases but may not in monotonous manner the obtained results provide useful information for further studies of fluid conveying pipes with geometric imperfection keywords slightly curved pipe supercritical vibration critical flow velocity natural frequency 1 introduction fluid conveying pipes are used to transport liquids and gases from one location to another in a wide range of industrial applications such as heat exchangers hydraulic lines liquid fuel rocket pipes water pipes and sewerage pipes fluid induced vibrations in these pipes can cause cyclic and dynamic stress unexpected deformation accelerated deterioration or even catastrophic failure in extreme cases there has been an increasing demand from industry to minimize the negative effects caused by vibrations thus vibrations of pipes have been an active research topic for a long time the early stage of research was focused on the dynamic problems of linear systems for example padoussis and issid 1974 firstly investigated the dynamic stability of pipes with a constant or small harmonic fluid velocity plaut and huseyin 1975 investigated the eigenvalues of a linear system for the stability of pipes conveying fluids recent studies on the dynamics of pipes conveying fluids have indicated the importance of extending the linear analysis to nonlinear domain in order to provide more reasonable results to meet the engineering requirements chai et al 2020 chen et al 2020 upon pressing demands from industry the nonlinear dynamics of pipes conveying fluids has received consideration attention over the last decade li et al 2015 presented the dynamic analysis of a liquid filled pipe system with the consideration of fluid structure interaction ibrahim 2010 2011 gave a detailed overview of fluid conveying pipes xu and yang 2006 studied the dynamic behavior of an internal resonance of the first two frequencies due to the fluid velocity and divided the pipe models into straight lines and circular arcs lee and park 2006 proposed a spectral element model for uniform pipes conveying internal unsteady fluids panda and kar 2007 2008 investigated the combination resonances principal parametric resonances and 3 1 internal resonances of a straight pipe conveying pulsating fluids qu et al 2020 studied the dynamic response of a hydraulic pipe subjected to random vibration jung et al 2007 obtained a new fluid velocity expression for studying the dynamics of an extensible semicircular pipe ni et al 2013 considered the forced vibration of curved pipes on a nonlinear elastic foundation wang et al 2014 investigated the dynamics of a conical pipe conveying fluids with clamped free boundary conditions zhu et al 2016 experimentally studied the vortex induced vibration of a curved pipe in shear flows zhao and sun 2017 analyzed the in plane forced vibration of a curved pipe by using the green function method it should be mentioned that all the above mentioned research papers are focused on fluid conveying pipes in a subcritical velocity range or low velocities the vibrations of the pipes with low velocity fluid inside are around the initial trivial equilibrium when the velocity in a pipe increases to a critical value the static equilibrium of the pipe will be changed from the initial trivial zero equilibrium to a non trivial equilibrium a new curved configuration accordingly the vibration characteristics of pipes conveying supercritical fluids are different from those of pipes conveying subcritical fluids in that the vibrations will be around newly configured position which has recently attracted significant research interests chen et al and zhang et al chen et al 2014 zhang et al 2016 investigated the steady state response under external and internal resonances of viscoelastic pipes conveying fluids zhou et al 2017 studied the global dynamics of pipes conveying supercritical pulsating fluids by considering super harmonic resonance of 1 2 internal resonance mao et al 2016 examined the steady state response of a fluid conveying pipe under 3 1 internal resonance in a supercritical regime ni et al 2017 numerically analyzed the free vibration and stability of a pipe with axially moving supports li et al 2018 obtained the explicit solutions of the forced vibration of oil conveying pipes on a two parameter foundation tan et al 2018 studied the vibration characteristics of pipes conveying fluids in a supercritical range using a timoshenko beam theory and they 2020 revealed multiple resonance responses of the forced vibration of pipes lu et al 2020 investigated the stress distribution of pipes under internal resonance and conveying supercritical fluids li et al 2021 presented a three dimension parametric vibration model for a simply supported pipe and obtained pre buckling and post buckling responses under parametric excitation although the vibrations of supercritical high speed fluid conveying pipes have received much attention all the research works have been focused on straight pipes specific and ideal structures in practical engineering applications apart from ideal straight structures such as beams and pipes most structures have an initial geometric imperfection which can be caused by some engineering restrictions or installations according to the literature some researches addressed the vibration characteristics of slightly curved static beams huang et al 2018 lee et al 2006 z et al 1998 sar and pakdemirli 2013 ye et al 2020 while most existing studies on pipes with imperfections e g an initial deflection are focused on pipes in subcritical regions for example tang et al 2014 proposed a nonlinear model for studying the three dimensional vibration of curved microtubes conveying fluids luo et al 2016 studied the principal parametric resonance response of a curved pipe under the impacts of pulsating flow and support looseness zare et al 2017 used isogeometric analysis to investigate the nonlinear behavior and stability of pipes conveying fluids uczko and czerwiski 2017 proposed a non plane vibration model of an elastically curved pipe caused by fluid pulsation jung and chung 2006 presented a set of linearized equations of motion for the dynamic analysis of a semi circular fluid conveying pipe using the arc length coordinate system hu and zhu 2018 established an extensible fluid conveying curved pipe model for the vibration analysis of an arbitrary undeformed configuration li and yang 2017 analyzed the dynamic response of a slightly curved pipe under a subcritical state owoseni et al 2018 discussed the bifurcation and chaos of a slightly curved pipe conveying hot pressurized fluids zhai et al 2013 used a pseudo excitation method to analyze the dynamic response of a timoshenko curved pipe with random excitation zhou et al 2020 explored nonlinear static and dynamic behaviors of cantilevered pipes with initial shapes to the authors best knowledge there has been no published papers on the supercritical vibration of curved pipes conveying fluids the main purpose of this paper is to investigate the dynamic characteristics of a slightly curved pipe conveying fluids in supercritical regime the nonlinear vibration equation of a slightly curved pipe will be derived based on the generalized hamilton s principle the non trivial equilibria of a pipe will be obtained from the static equation and two numerical methods be used for verification the governing equation of the transverse vibration under the bending structure will be obtained by introducing the coordinate transformation and the natural frequency of a supercritical slightly curved pipe is calculated the effects of initial curvature length and thickness of pipe as well as fluid velocity on the vibration characteristics will be investigated 2 mathematical model as shown in fig 1 the slightly curved fluid conveying pipe is assumed to be an euler bernoulli pipe the x and y in this figure represent the axial and the transverse coordinates respectively t is the time y x a 0 sin  x l is the initial deformation of the pipe and a 0 represents the maximum initial deformation the pipe is simply supported at its two ends the non viscous and incompressible fluids flow at a constant velocity of  inside the pipe table 1 gives the physical parameters of the pipe and the fluid where d h and i b represent the outer diameter the thickness and the moment of inertia of the cross section of the pipe respectively e is young s modulus  p and  f are the densities of the pipe and the fluid per length respectively table 1 refers to the parameters of a hydraulic pipe 1cr18ni9 the vibration of the pipe is assumed to be planar motion this work focuses on natural vibration characteristics without considering the effect of damping based on the euler bernoulli beam theory the nonlinear governing equation of the pipe conveying fluid is derived by applying the generalized hamilton s principle the kinetic energy of the pipe t p and the kinetic energy of fluids t f can be written as 1 t p 1 2 0 l  p a p u t 2 d x 1 2 0 l  p a p v t 2 d x t f 1 2 0 l  f a f  d v d t 2 d x 1 2 0 l  f a f d u d t 2 d x where u x t is the lateral displacement of the pipe with reference to the initially curved state and v x t is the axial displacement a p and a f are the cross sectional areas of the pipe and fluids respectively the variation of strain energy is 2  w v  x   x d v where v denotes the volume of the pipe  x x t and  x x t represent the normal stress and the normal strain respectively the strain displacement relationship is given by chen and tang 2011 3  x 1 v x 2 u y x 2 1 y x 2 where the subscript comma before x or t represents partial derivation with respect to x or t the elastic constitutive relationship of the pipe is written as 4  x e  x the generalized hamilton s principle zhu et al 2016 2020 zhu et al 2016 chai et al 2020 chen et al 2020 takes the form of 5  t 1 t 2 t p t f d t t 1 t 2  w d t 0 substituting eqs 1 4 into eq 5 yields the governing equation of the slightly curved pipe 6  p a p  f a f u t t 2  f a f  u x t  f a f  2 u x t e i b u x x x x e a p 2 l y x x u x x 0 l u x 2 2 u x y x d x 0 where 7 a p  d 2 4 a f  d 2 h 2 4 the boundary conditions for simply supported pipes at both ends are 8 u 0 t 0 u l t 0 u x x 0 t 0 u x x l t 0 by defining the following dimensionless parameters and variables 9  u l  x l  t l 2 e i b  f a f  p a p y 0 y l   l  f a f e i b m r  f a f  f a f  p a p  1 l a p i b the governing equation and boundary conditions can be expressed in dimensionless form 10    2 m r      2          1 2 2    y 0   0 1   2 2   y 0  2 d  0 11  0  0  1  0    0  0    1  0 the dimensional equation will be used in numerical simulations as its convergence is faster 3 non trivial static equilibriums 3 1 analytical solutions according to the previous investigations zare et al 2017 jiang et al 2020 tan et al 2019 the natural frequencies of the pipe gradually decrease as the fluid velocity is increasing when the first natural frequency disappears the fluid velocity is referred to as the critical velocity if the fluid velocity is greater than this critical value the pipe will evolve to the buckling state and the initial trivial equilibrium position will lose its stability the buckling equilibrium configuration u  does not change with time and only depends on the spatial coordinates therefore the buckling configuration u  satisfies the following ordinary differential equations and boundary conditions which are obtained by removing the time derivatives from eqs 6 and 8 12  f a f  2 u  x x e i b u  x x x x e a p 2 l y x x u  x x 0 l u  x 2 2 u  x y x d x 0 13 u  0 t 0 u  l t 0 u  x x 0 t 0 u  x x l t 0 the first term of eq 12 shows that the flow of fluid will create axial pressure on the pipe when the flow velocity is greater than the critical value eq 12 will have non trivial solutions which correspond to the static buckling configurations of the pipe conveying supercritical flow equation 12 can be simplified to 14 b u  x x x x a c 0 l u  x 2 2 u  x y x d x u  x x c y x x 0 l u  x 2 2 u  x y x d x 0 where 15 a  f a f  2 b e i b c e a p 2 l the solution of eq 12 is composed of a general solution of the associated homogeneous equation and a particular solution i e 16 u  x  1 x  2 x where u  x is the supercritical static equilibrium configuration of the curved pipe based on eqs 12 and 13 the k th order equilibrium configuration u  x can be denoted as u  k x the form of the configuration can be assumed to be 17 u  k x  1 sin k  x l  2 sin  x l where  1 and  2 are constants and k is a positive integer when k 1 the first order supercritical equilibrium configuration u  1 x is obtained as 18 u  1 x 3 a 0 2 l c  2 a 0 2 l c 8 l 2 a 8  2 b 2  l c sin  x l when k 1 the general solution and the particular solution is solved as 19  1 x 2  k 0 c  2 k 2 k 2 1 sin k  x l  2 x  sin  x l where 20 k 0 2  a 2 c k 3  2 b k 6 2  2 b a k 4  2 b 2 a 0 2 c 2 a k 2 a k   0 or  3 a 0 2 l c l  2 a 0 2 c 8 a l 2 8 b  2 2 c  l the non trivial static equilibrium configuration of the k th order can be obtained by substituting eqs 19 and 20 into eq 16 as 21 u  k x 2  k 0 c k 2  2 k 2 1 sin k  x l 3 a 0 2 l c l  2 a 0 2 c 8 a l 2 8 b  2 2 c  l sin  x l k 1 the first order and the second order critical flow velocities for a slightly curved pipe can be determined from eqs 18 and 21 respectively 22  1 2  f e h d 3 3 d 2 h 4 d a 0 2 4 d h 2 4 a 0 2 h 2 h 3  2  f l d 2 h 23  2 2  f e h d 3 3 d 2 h 4 d h 2 2 h 3   f l d 2 h since the initial buckling selected in this paper is symmetrical and consistent with the first order static equilibrium buckling configuration of straight pipes the initial buckling has a significant effect on the first order critical fluid velocity of the curved pipe moreover an increase of the initial curvature will increase the first order critical flow velocity however when the first order critical flow velocity is increased to the second order flow velocity the effect of the increase in flow velocity becomes more complicated further research is highly desirable to explore the effects based on the parameters of the hydraulic pipe as shown in table 1 the results of the critical velocities with different initial curvatures are shown in table 2 3 2 numerical solutions in this subsection two numerical methods will be used to obtain the numerical solutions to verify the analytical solutions developed in subsection 3 1 3 2 1 the finite difference method fdm the static equilibrium of eq 12 is an ordinary differential equation without a time variable the fdm is used for the numerical verification the difference form of the space coordinate derivative can be written as 24 d u  i d x u  i 1 u  i 1 2 h 0 d 2 u  i d x 2 u  i 1 2 u  i u  i 1 h 0 2 d 3 u  i d x 3 u  i 2 2 u  i 1 2 u  i 1 u  i 2 2 h 0 3 d 4 u  i d x 4 u  i 2 4 u  i 1 6 u  i 4 u  i 1 u  i 2 h 0 4 where u  i denotes the value of u  x at the nodal point x i i 0 1 n and n 200 is the number of nodes h 0 is the size of the spatial mesh and it given by h 0 l n there are two terms y x and y xx in eq 12 for the initial configuration which can be expressed as 25 y x y x i a 0  l cos  i n y x x y x i x i a 0  2 l 2 sin  i n the complex trapezoidal formula is used for the integral function 26 a b f x d x h 0 2 f a f b 2 i 1 n 1 f x i therefore the integral part in eq 12 can be simplified as 27 0 l u  x i 2 2 u  x i y x d x i 1 n 1 u  i 1 u  i 1 2 4 h 0 u  i 1 u  i 1 a 0  l cos  i n u  1 u  1 2 8 h 0 u  1 u  1 2 a 0  l u  l 1 u  l 1 2 8 h 0 u  l 1 u  l 1 2 a 0  l substituting eqs 24 25 and 27 into eq 12 leads to the following discrete equation 28 u  i u  i 1 u  i 1 2 e i b u  i 2 u  i 1 u  i 1 u  i 2 2 c 1 h 0 2 6 e i b h 0 4 c 01 2 c 1 h 0 2 6 e i b 29 c 1  f a f  2 c 01 e a p 2 l a 0  2 l 2 sin  i n u  i 1 2 u  i u  i 1 h 0 2 u  1 u  1 2 8 h 0 u  1 u  1 a 0  2 l u  l 1 u  l 1 2 8 h 0 u  l 1 u  l 1 a 0  2 l e a p 2 l a 0  2 l 2 sin  i n u  i 1 2 u  i u  i 1 h 0 2 i 1 n 1 u  i 1 u  i 1 2 4 h 0 u  i 1 u  i 1 a 0  l cos  i n substituting eq 24 into the simply supported boundary conditions see eq 13 yields new expressions of boundary conditions 30 u  0 0 u   0 u  1 2 u  0 u  1 h 0 2 0 u  n 0 u   n u  n 1 2 u  n u  n 1 h 0 2 0 introducing x 1 and x n 1 gives rise to 31 u  1 u  1 u  0 0 u  n 0 u  n 1 u  n 1 the initial iteration function used in the simulation is selected as 32 u  x b 0 sin  x l where b 0 is the initial displacement and is set to 0 001 in this paper 3 2 2 the differential quadrature element method dqem according to the dqem the k th order derivative of the non trivial static equilibrium configuration u  x at the nodal point x i can be approximated by a sum function wang et al 2004a 33 u  k x i j 1 n g j k x i u  x j  1 k x i u  1 x 1  n 1 k x i u  1 x n 1 i 1 2 n 1 where n 1 stands for the number of nodes g and  represent the weighting coefficient matrices which are calculated by 34 g j k x i 1 x j x n 1 j 1 l j k x i x j x n 1 j 1 k l j k 1 x i l j x j x 1 x j x n 1 j 1  j k x i j 1 n 1 i 1 2 n 1 35 g j k x i 1 x j x 1 x j x n 1 l j k x i x i x 1 x i x n 1 k l j k 1 x i x i x 1 x i x n 1 k k 1 l j k 2 x i j 2 3 n 1 1 i 1 2 n 1 36  j k x i 1 x j x n 1 j 1 l j k x i x i x 1 x i x n 1 k l j k 1 x i x i x 1 x i x n 1 k k 1 l j k 2 x i j 1 n 1 i 1 2 n 1 where l j x is the lagrange interpolation function 37 l j x k 1 k j n 1 x x k x j x k 38 l j 1 x i 1 x j x i m 1 m i j n 1 x x k x j x k m 1 m i j n 1 1 x i x m i j i j i j 1 2 n 1 39 l j k x i k l j 1 x i l i k 1 x i l j k 1 x i x i x j i j m 1 n 1 l j 1 x m l m k 1 x j i j i j 1 2 n 1 the coefficients satisfy the following conditions 40  j x i 0 i 1 2 n 1  1 x 1  n 1 x n 1 1  1 x n 1  n 1 x 1 0 l j x i  i j 1 i j 0 i j as the static equilibrium of eq 12 includes an integral term the integral quadrature method should be added on the basis of the dqem according to the theory of the integral quadrature method the interpolation relation between the integral operator and the nodal function is 41 x i x j f x d x k 1 n 1 c k i j f x k where the weight coefficient c k i j is calculated by the following formula 42 c k i j a 1 j k a 1 i k the elements in the coefficient matrix a are determined by 43 a i j x i r x j r l i j 1 i j l i i 1 1 x i r i j i j 1 2 n 1 where the weight coefficient l 1 is calculated from eq 38 r represents a constant it was shown shu et al 1995 that when the constant satisfies r 0 1 the influence of the constant term on the numerical simulation accuracy can be ignored here the constant is set to 0 01 to ensure the accuracy of the calculation in this paper the rule of chebyshev gauss lobatto distribution is adopted 44 x i 1 2 1 cos i 1  n 1 1 l i 1 2 n 1 by considering that the pipe element is relatively simple the elastic structure can be approximated with 11 nodes to obtain more accurate results wang and wang 2013 wang et al 2004b therefore the number of nodes n 1 is equal to 11 in this paper 3 3 comparison of numerical and analytical results fig 2 shows the comparison of analytical solutions and the results of two different numerical methods indicating that the analytical results agree well with the numerical results the slight discrepancies are presented in table 3 due to the presence of the symmetrical initial curvature the first order non trivial equilibrium solutions are asymmetric therefore in the presence of initial curvature the supercritical vibrations of the pipe conveying fluid will probably undergo between two asymmetric steady states based on the results in fig 2 table 3 shows the comparison of supercritical configuration solutions of different methods with different initial curvatures it can be seen from table 3 that the differences in equilibrium configurations obtained from the analytic method fdm and dqem are quite small it should be mentioned that the present work mainly focuses on the static equilibrium deformation and the natural vibration characteristics of the curved pipe conveying supercritical fluid without considering damping and excitation factors these methods can achieve high accuracy but they might not give high accuracy if damping and excitation are involved in the equation 4 critical flow velocity the critical velocity is a key index of the transition between subcritical and supercritical states the analytical expression of the critical flow velocity is given as eqs 22 and 23 the subsequent discussion is focused on the curved pipe under the first order supercritical condition meaning that the fluid velocity satisfies  1   2 fig 3 shows the effect of the initial curvature on the first two critical flow velocities when the initial curvature increases from 0 to 3 d 2 6 d h 6 h 2 2 the first order critical flow velocity also increases therefore the larger the initial curvature the higher the first order critical velocity in this range of curvature the second order critical velocity does not change the initial curvature the length and the thickness of the pipe have significant effects on the critical fluid velocities the effects of these key parameters on the critical flow velocities are discussed in detail below for a fixed pipe thickness h 0 0006 m fig 4 a shows the 2 d contour plot of the first order critical velocity with the changing pipe length l and initial curvature a 0 fig 4 a indicates that as the length decreases and the initial curvature increases the pipe is highly unlikely to enter the supercritical state fig 4 b displays the influences of the pipe thickness h and the initial curvature a 0 on the critical velocity as shown in fig 4 a the critical velocities increase with the increase of these two parameters fig 4 shows that if the influence of the initial curvature of the pipe is not considered the critical velocity of the pipe could be underestimated under the same outer diameter a smaller inner diameter pipe corresponds to a larger critical flow velocity therefore the static equilibrium configuration is not prone to instability due to fluid flow this is because the corresponding pipe has a greater rigidity 5 supercritical vibration characteristics when the pipe vibration enters into the supercritical state the corresponding governing equation can be derived by using the following coordinate transformation 45 u x t u x t u  x by substituting the coordinate transformation into eqs 6 and 8 the governing equation for the pipe around the non trivial configuration is obtained as 46  p a p  f a f u t t 2  f a f  u x t  f a f  2 u x x u  x x e i b u x x x x u  x x x x e a p 2 l y x x u x x u  x x 0 l u x u  x 2 2 u x u  x y x d x 0 substituting eq 12 into eq 46 yields 47  p a p  f a f u t t 2  f a f  u x t  f a f  2 u x x e i b u x x x x e a p 2 l y x x u  x x 0 l u  x 2 2 u  x y x d x e a p 2 l y x x u x x u  x x 0 l u x u  x 2 2 u x u  x y x d x 0 5 1 natural frequencies and vibration modes the galerkin truncation method gtm is used to study the natural frequency of the slightly curved pipe in the supercritical regime the mode of the static and slightly curved pipe is obtained first ding et al 2019 for the corresponding static pipe the effects of fluid flow and the nonlinear terms are ignored then based on eq 47 the linear governing equation and the boundary conditions of the pipe is expressed as 48  p a p  f a f u t t e i b u x x x x e a p l y x x u  x x 0 l u x u  x u x y x d x e a p 2 l u x x 0 l u  x 2 2 u  x y x d x 0 49 u 0 t 0 u l t 0 u x x 0 t 0 u x x l t 0 the modal function of the static and slightly curved pipe can be written as 50  x  h x  p x c 1 cos   x l c 2 sin   x l c 3 ch   x l c 4 sh   x l c 5 sin  x l according to the references nayfeh and emam 2004 ye et al 2020 substituting eq 50 into eqs 48 and 49 results in the following algebraic equations for the coefficients 51 c 1 c 3 0  2  2 l 2 c 1 c 3 0 e i b  4 l 4  p a p  f a f  n 2 e a p 2 a 0 2 6 a s a 0 3 a s 2  4 4 l 4 c 5 0 c 1 cos   c 2 sin   c 3 ch   c 4 sh   0  2  2 l 2 c 1 cos   c 2 sin   c 3 ch   c 4 sh   0 a 0 a s 2  2 e a p  3 l 4 cos   1  2 1 c 1 sin    2 1 c 2 ch   1  2 1 c 3 sh    2 1 c 4 e i b  4 l 4  p a p  f a f  n 2 e a p 2 a 0 2 6 a s a 0 3 a s 2  4 4 l 4 c 5 0 where 52 a s a 0 2 2 7  f a f  2 2 4  f a f  2 4 e a p a 0 l 2 e 2  2 a p i b e a p  to find non zero solutions for the coefficients c 1 c 2 c 3 c 4 c 5 t the determinant of the coefficient matrix must be zero thus the eigenvalues  can be obtained from the determinant in the following analysis of the natural frequencies and the transverse vibration modes the modal function of the static and slightly curved pipe is used as the trial function and the weight function for the galerkin truncation method gtm the linear free vibration equation of the slightly curved fluid conveying pipe with the consideration of the fluid velocity is expressed as eq 47 the displacement function of the pipe is assumed to be 53 u x t k 1 n q k e i  k t  k x where n represents the truncation term of the gtm the natural frequencies of the slightly curved fluid conveying pipe are calculated by solving 54  2 m i  g k r 0 r 1 0 m k m 0 k m 1 k m g k m 2  f a f   1 k m  f a f  p a p  0 m k k m 0 k m e i b  4 m  f a f  p a p  0 m  f a f  2 m  2  f a f  p a p  0 m k m r 0 k m e a p  r m c 0 l  f a f  p a p r 1 k m e a p  2 m c 1 2 l  f a f  p a p  0 m 0 l  m x 2 d x  1 k m 0 l  k x  m x d x  2 m 0 l  k x  m x d x  4 m 0 l  k x  m x d x  r m 0 l y x u  x  m x d x c 0 0 l  k x y x  k x u  x d x c 1 0 l u  x 2 2 u  x y x d x where the apostrophe is the derivative with respect to the space coordinate x the eigenvalue  represents natural frequencies of the free transverse vibration of the pipe the modal function of the free vibration of the pipe is written as 55  x k 1 n im q k  k x where q k is the complex eigenvector associated with a given eigenvalue and im q k represents the imaginary part of q k in order to analyze the effect of truncation number on frequency the frequency results of truncation numbers 2 4 6 and 8 are calculated respectively to facilitate the comparison of the convergence of truncation results the frequency deviation is defined as follows 56   i n  i 8  i 8 i 1 2 3 4 n 2 4 6 8 where  i n is the i th order frequency under the n th order truncation  i 8 denotes the i th order frequency under the 8 th order truncation as can be seen from table 4 the second order galerkin truncation method is not good enough to calculate the second order natural frequency moreover when n 4 the errors of the first two order natural frequencies are all less than 0 1 therefore the fourth order truncation result could be adopted for the following calculation according to fig 5 there is a significant difference in the second order natural vibration mode if only the first two natural modes are considered the results of the 4 term galerkin truncation method are in good agreement with those of 6 term and 8 term on the other hand if the first four frequencies are discussed a 6 term truncation will be required therefore the 4 term galerkin method is used for the following investigations 5 2 verification using discrete fourier transform dft method the natural frequencies of the slightly curved pipe in the supercritical regime are numerically obtained in this subsection using the dft and the dqem according to the dqem in subsection 3 2 2 the number of nodes is set as 11 the governing equation eq 47 and boundary conditions eq 49 are discretized into algebraic equations the time domain response for the free vibration of the curved pipe is obtained and the steady state response of the middle point of the pipe is given in fig 6 a the dft is used to transform the time history to the frequency domain and the spectrum diagram is shown in fig 6 b specifically given an initial displacement of the pipe the time history of free vibration of the pipe is determined based on the time domain response the spectrum diagram can be obtained using the dft then each natural frequency can be obtained from the peak of the spectrum diagram under different initial curvatures the fundamental frequencies of the two methods are obtained as shown in fig 7 it is easy to notice that the 4 order gtm and the dft give almost the same results this confirms the validation of two approaches for calculating the natural frequencies of the super critical slightly curved pipe it is easy to observe that the fundamental frequency of the slightly curved pipe is very sensitive to the initial curvature and the fluid velocity as the fluid velocity increases the fundamental natural frequency of the pipe decreases first then when increasing to the critical fluid velocity the fundamental frequency reaches zero at this point the trivial equilibrium configuration of the pipe loses its stability thereafter as the fluid velocity continues to increase the pipe will vibrate around a non trivial static equilibrium configuration moreover the fundamental frequency begins to increase however in the supercritical region the fundamental frequency of the curved pipe is lower than that of the straight pipe an interesting observation is that in the area where the lines overlap which is also the transition area of the subcritical and supercritical states there is a flow velocity range where the fundamental frequency of the straight pipe is higher than that of the slightly curved pipe 5 3 the effects of system parameters the fundamental frequency results of the slightly curved pipe in the supercritical condition in fig 7 are mutually verified by the 4th order galerkin truncation method and the discrete fourier transform the following parameter discussions are all based on the results of the 4th order galerkin truncation as shown in fig 8 the critical velocity decreases with an increase of the pipe length the flow velocity of the fluid in the pipe is in the range of the first order critical velocity and the second order critical velocity different from the observation in subcritical range in the supercritical flow range the pipe has the same fundamental vibration frequency with different lengths moreover the fundamental frequency of the transverse vibration of a longer pipe may be larger fig 9 a shows that when the length of the pipe is longer the corresponding first order and second order critical fluid velocities are lower fig 9 b displays the variation of the fundamental natural frequency of the supercritical pipe with the length it is interesting to note that the fundamental frequency is not monotonous with the change of the length in the supercritical range instead the fundamental frequency first increases and then decreases with an increase in the pipe length 6 conclusions this paper has focused on the free supercritical vibration of the slightly curved pipe it was found that the initial equilibrium of the pipe could lose its stability when the fluid reaches the supercritical velocity the critical velocity of the fluid conveying pipe was obtained based on the buckling configuration furthermore the governing equation was derived for the supercritical vibration of the slightly curved pipe around the non trivial equilibrium natural frequencies of supercritical vibration were determined using two different methods to confirm the correctness of the analyses the effects of the initial curvature the pipe length and the pipe thickness on the fundamental frequency were investigated for the curved pipes based on the obtained results the following conclusions can be drawn 1 the initial curvature has a significant effect on the critical flow velocity of the pipe generally the first order critical flow velocity increases with an increase of initial curvature 2 the presence of initial curvature can increase the supercritical buckling shape of the pipe and lead to the bi stable asymmetry of the supercritical buckling 3 dynamic characteristics of the slightly curved pipe conveying fluid in the supercritical regime are more complicated compared with the case under subcritical conditions in particular the fundamental frequency no longer varies monotonously with the length in short the fluid conveying pipe with an initial curvature has more complex dynamic characteristics in the supercritical regime in order to obtain reasonable and meaningful results it is necessary to consider the geometric imperfections or initial curvatures in analyzing the dynamics of initially curved fluid conveying pipes credit authorship contribution statement si qin ye investigation writing original draft preparation hu ding conceptualization supervision sha wei writing review editing jin chen ji writing review editing li qun chen validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge the support of the natural science foundation of china nos 12025204 12072181 
20886,despite extensive use of curved pipes conveying high speed fluids in many engineering fields few researches have been conducted on the supercritical dynamics of curved pipes to explore new dynamic behavior for the first time this paper investigates the vibration characteristics of a slightly curved pipe conveying fluids in a supercritical range the generalized hamilton s principle is adopted to derive the governing equation the non trivial equilibriums and the critical flow velocities are then analytically obtained the analytical predictions agree well with the numerical results obtained using the finite difference method and the differential quadrature element method by introducing the coordinate transformation the governing equation of the curved pipe is established for the vibration about the non trivial equilibrium position the natural frequencies of the pipe are obtained by the galerkin truncation method and verified with the discrete fourier transform it is found that the critical velocities and the natural frequencies are highly dependent on the initial curvature the research results show an interesting phenomenon that the natural frequency of the curved pipe may increase as the pipe length increases but may not in monotonous manner the obtained results provide useful information for further studies of fluid conveying pipes with geometric imperfection keywords slightly curved pipe supercritical vibration critical flow velocity natural frequency 1 introduction fluid conveying pipes are used to transport liquids and gases from one location to another in a wide range of industrial applications such as heat exchangers hydraulic lines liquid fuel rocket pipes water pipes and sewerage pipes fluid induced vibrations in these pipes can cause cyclic and dynamic stress unexpected deformation accelerated deterioration or even catastrophic failure in extreme cases there has been an increasing demand from industry to minimize the negative effects caused by vibrations thus vibrations of pipes have been an active research topic for a long time the early stage of research was focused on the dynamic problems of linear systems for example padoussis and issid 1974 firstly investigated the dynamic stability of pipes with a constant or small harmonic fluid velocity plaut and huseyin 1975 investigated the eigenvalues of a linear system for the stability of pipes conveying fluids recent studies on the dynamics of pipes conveying fluids have indicated the importance of extending the linear analysis to nonlinear domain in order to provide more reasonable results to meet the engineering requirements chai et al 2020 chen et al 2020 upon pressing demands from industry the nonlinear dynamics of pipes conveying fluids has received consideration attention over the last decade li et al 2015 presented the dynamic analysis of a liquid filled pipe system with the consideration of fluid structure interaction ibrahim 2010 2011 gave a detailed overview of fluid conveying pipes xu and yang 2006 studied the dynamic behavior of an internal resonance of the first two frequencies due to the fluid velocity and divided the pipe models into straight lines and circular arcs lee and park 2006 proposed a spectral element model for uniform pipes conveying internal unsteady fluids panda and kar 2007 2008 investigated the combination resonances principal parametric resonances and 3 1 internal resonances of a straight pipe conveying pulsating fluids qu et al 2020 studied the dynamic response of a hydraulic pipe subjected to random vibration jung et al 2007 obtained a new fluid velocity expression for studying the dynamics of an extensible semicircular pipe ni et al 2013 considered the forced vibration of curved pipes on a nonlinear elastic foundation wang et al 2014 investigated the dynamics of a conical pipe conveying fluids with clamped free boundary conditions zhu et al 2016 experimentally studied the vortex induced vibration of a curved pipe in shear flows zhao and sun 2017 analyzed the in plane forced vibration of a curved pipe by using the green function method it should be mentioned that all the above mentioned research papers are focused on fluid conveying pipes in a subcritical velocity range or low velocities the vibrations of the pipes with low velocity fluid inside are around the initial trivial equilibrium when the velocity in a pipe increases to a critical value the static equilibrium of the pipe will be changed from the initial trivial zero equilibrium to a non trivial equilibrium a new curved configuration accordingly the vibration characteristics of pipes conveying supercritical fluids are different from those of pipes conveying subcritical fluids in that the vibrations will be around newly configured position which has recently attracted significant research interests chen et al and zhang et al chen et al 2014 zhang et al 2016 investigated the steady state response under external and internal resonances of viscoelastic pipes conveying fluids zhou et al 2017 studied the global dynamics of pipes conveying supercritical pulsating fluids by considering super harmonic resonance of 1 2 internal resonance mao et al 2016 examined the steady state response of a fluid conveying pipe under 3 1 internal resonance in a supercritical regime ni et al 2017 numerically analyzed the free vibration and stability of a pipe with axially moving supports li et al 2018 obtained the explicit solutions of the forced vibration of oil conveying pipes on a two parameter foundation tan et al 2018 studied the vibration characteristics of pipes conveying fluids in a supercritical range using a timoshenko beam theory and they 2020 revealed multiple resonance responses of the forced vibration of pipes lu et al 2020 investigated the stress distribution of pipes under internal resonance and conveying supercritical fluids li et al 2021 presented a three dimension parametric vibration model for a simply supported pipe and obtained pre buckling and post buckling responses under parametric excitation although the vibrations of supercritical high speed fluid conveying pipes have received much attention all the research works have been focused on straight pipes specific and ideal structures in practical engineering applications apart from ideal straight structures such as beams and pipes most structures have an initial geometric imperfection which can be caused by some engineering restrictions or installations according to the literature some researches addressed the vibration characteristics of slightly curved static beams huang et al 2018 lee et al 2006 z et al 1998 sar and pakdemirli 2013 ye et al 2020 while most existing studies on pipes with imperfections e g an initial deflection are focused on pipes in subcritical regions for example tang et al 2014 proposed a nonlinear model for studying the three dimensional vibration of curved microtubes conveying fluids luo et al 2016 studied the principal parametric resonance response of a curved pipe under the impacts of pulsating flow and support looseness zare et al 2017 used isogeometric analysis to investigate the nonlinear behavior and stability of pipes conveying fluids uczko and czerwiski 2017 proposed a non plane vibration model of an elastically curved pipe caused by fluid pulsation jung and chung 2006 presented a set of linearized equations of motion for the dynamic analysis of a semi circular fluid conveying pipe using the arc length coordinate system hu and zhu 2018 established an extensible fluid conveying curved pipe model for the vibration analysis of an arbitrary undeformed configuration li and yang 2017 analyzed the dynamic response of a slightly curved pipe under a subcritical state owoseni et al 2018 discussed the bifurcation and chaos of a slightly curved pipe conveying hot pressurized fluids zhai et al 2013 used a pseudo excitation method to analyze the dynamic response of a timoshenko curved pipe with random excitation zhou et al 2020 explored nonlinear static and dynamic behaviors of cantilevered pipes with initial shapes to the authors best knowledge there has been no published papers on the supercritical vibration of curved pipes conveying fluids the main purpose of this paper is to investigate the dynamic characteristics of a slightly curved pipe conveying fluids in supercritical regime the nonlinear vibration equation of a slightly curved pipe will be derived based on the generalized hamilton s principle the non trivial equilibria of a pipe will be obtained from the static equation and two numerical methods be used for verification the governing equation of the transverse vibration under the bending structure will be obtained by introducing the coordinate transformation and the natural frequency of a supercritical slightly curved pipe is calculated the effects of initial curvature length and thickness of pipe as well as fluid velocity on the vibration characteristics will be investigated 2 mathematical model as shown in fig 1 the slightly curved fluid conveying pipe is assumed to be an euler bernoulli pipe the x and y in this figure represent the axial and the transverse coordinates respectively t is the time y x a 0 sin  x l is the initial deformation of the pipe and a 0 represents the maximum initial deformation the pipe is simply supported at its two ends the non viscous and incompressible fluids flow at a constant velocity of  inside the pipe table 1 gives the physical parameters of the pipe and the fluid where d h and i b represent the outer diameter the thickness and the moment of inertia of the cross section of the pipe respectively e is young s modulus  p and  f are the densities of the pipe and the fluid per length respectively table 1 refers to the parameters of a hydraulic pipe 1cr18ni9 the vibration of the pipe is assumed to be planar motion this work focuses on natural vibration characteristics without considering the effect of damping based on the euler bernoulli beam theory the nonlinear governing equation of the pipe conveying fluid is derived by applying the generalized hamilton s principle the kinetic energy of the pipe t p and the kinetic energy of fluids t f can be written as 1 t p 1 2 0 l  p a p u t 2 d x 1 2 0 l  p a p v t 2 d x t f 1 2 0 l  f a f  d v d t 2 d x 1 2 0 l  f a f d u d t 2 d x where u x t is the lateral displacement of the pipe with reference to the initially curved state and v x t is the axial displacement a p and a f are the cross sectional areas of the pipe and fluids respectively the variation of strain energy is 2  w v  x   x d v where v denotes the volume of the pipe  x x t and  x x t represent the normal stress and the normal strain respectively the strain displacement relationship is given by chen and tang 2011 3  x 1 v x 2 u y x 2 1 y x 2 where the subscript comma before x or t represents partial derivation with respect to x or t the elastic constitutive relationship of the pipe is written as 4  x e  x the generalized hamilton s principle zhu et al 2016 2020 zhu et al 2016 chai et al 2020 chen et al 2020 takes the form of 5  t 1 t 2 t p t f d t t 1 t 2  w d t 0 substituting eqs 1 4 into eq 5 yields the governing equation of the slightly curved pipe 6  p a p  f a f u t t 2  f a f  u x t  f a f  2 u x t e i b u x x x x e a p 2 l y x x u x x 0 l u x 2 2 u x y x d x 0 where 7 a p  d 2 4 a f  d 2 h 2 4 the boundary conditions for simply supported pipes at both ends are 8 u 0 t 0 u l t 0 u x x 0 t 0 u x x l t 0 by defining the following dimensionless parameters and variables 9  u l  x l  t l 2 e i b  f a f  p a p y 0 y l   l  f a f e i b m r  f a f  f a f  p a p  1 l a p i b the governing equation and boundary conditions can be expressed in dimensionless form 10    2 m r      2          1 2 2    y 0   0 1   2 2   y 0  2 d  0 11  0  0  1  0    0  0    1  0 the dimensional equation will be used in numerical simulations as its convergence is faster 3 non trivial static equilibriums 3 1 analytical solutions according to the previous investigations zare et al 2017 jiang et al 2020 tan et al 2019 the natural frequencies of the pipe gradually decrease as the fluid velocity is increasing when the first natural frequency disappears the fluid velocity is referred to as the critical velocity if the fluid velocity is greater than this critical value the pipe will evolve to the buckling state and the initial trivial equilibrium position will lose its stability the buckling equilibrium configuration u  does not change with time and only depends on the spatial coordinates therefore the buckling configuration u  satisfies the following ordinary differential equations and boundary conditions which are obtained by removing the time derivatives from eqs 6 and 8 12  f a f  2 u  x x e i b u  x x x x e a p 2 l y x x u  x x 0 l u  x 2 2 u  x y x d x 0 13 u  0 t 0 u  l t 0 u  x x 0 t 0 u  x x l t 0 the first term of eq 12 shows that the flow of fluid will create axial pressure on the pipe when the flow velocity is greater than the critical value eq 12 will have non trivial solutions which correspond to the static buckling configurations of the pipe conveying supercritical flow equation 12 can be simplified to 14 b u  x x x x a c 0 l u  x 2 2 u  x y x d x u  x x c y x x 0 l u  x 2 2 u  x y x d x 0 where 15 a  f a f  2 b e i b c e a p 2 l the solution of eq 12 is composed of a general solution of the associated homogeneous equation and a particular solution i e 16 u  x  1 x  2 x where u  x is the supercritical static equilibrium configuration of the curved pipe based on eqs 12 and 13 the k th order equilibrium configuration u  x can be denoted as u  k x the form of the configuration can be assumed to be 17 u  k x  1 sin k  x l  2 sin  x l where  1 and  2 are constants and k is a positive integer when k 1 the first order supercritical equilibrium configuration u  1 x is obtained as 18 u  1 x 3 a 0 2 l c  2 a 0 2 l c 8 l 2 a 8  2 b 2  l c sin  x l when k 1 the general solution and the particular solution is solved as 19  1 x 2  k 0 c  2 k 2 k 2 1 sin k  x l  2 x  sin  x l where 20 k 0 2  a 2 c k 3  2 b k 6 2  2 b a k 4  2 b 2 a 0 2 c 2 a k 2 a k   0 or  3 a 0 2 l c l  2 a 0 2 c 8 a l 2 8 b  2 2 c  l the non trivial static equilibrium configuration of the k th order can be obtained by substituting eqs 19 and 20 into eq 16 as 21 u  k x 2  k 0 c k 2  2 k 2 1 sin k  x l 3 a 0 2 l c l  2 a 0 2 c 8 a l 2 8 b  2 2 c  l sin  x l k 1 the first order and the second order critical flow velocities for a slightly curved pipe can be determined from eqs 18 and 21 respectively 22  1 2  f e h d 3 3 d 2 h 4 d a 0 2 4 d h 2 4 a 0 2 h 2 h 3  2  f l d 2 h 23  2 2  f e h d 3 3 d 2 h 4 d h 2 2 h 3   f l d 2 h since the initial buckling selected in this paper is symmetrical and consistent with the first order static equilibrium buckling configuration of straight pipes the initial buckling has a significant effect on the first order critical fluid velocity of the curved pipe moreover an increase of the initial curvature will increase the first order critical flow velocity however when the first order critical flow velocity is increased to the second order flow velocity the effect of the increase in flow velocity becomes more complicated further research is highly desirable to explore the effects based on the parameters of the hydraulic pipe as shown in table 1 the results of the critical velocities with different initial curvatures are shown in table 2 3 2 numerical solutions in this subsection two numerical methods will be used to obtain the numerical solutions to verify the analytical solutions developed in subsection 3 1 3 2 1 the finite difference method fdm the static equilibrium of eq 12 is an ordinary differential equation without a time variable the fdm is used for the numerical verification the difference form of the space coordinate derivative can be written as 24 d u  i d x u  i 1 u  i 1 2 h 0 d 2 u  i d x 2 u  i 1 2 u  i u  i 1 h 0 2 d 3 u  i d x 3 u  i 2 2 u  i 1 2 u  i 1 u  i 2 2 h 0 3 d 4 u  i d x 4 u  i 2 4 u  i 1 6 u  i 4 u  i 1 u  i 2 h 0 4 where u  i denotes the value of u  x at the nodal point x i i 0 1 n and n 200 is the number of nodes h 0 is the size of the spatial mesh and it given by h 0 l n there are two terms y x and y xx in eq 12 for the initial configuration which can be expressed as 25 y x y x i a 0  l cos  i n y x x y x i x i a 0  2 l 2 sin  i n the complex trapezoidal formula is used for the integral function 26 a b f x d x h 0 2 f a f b 2 i 1 n 1 f x i therefore the integral part in eq 12 can be simplified as 27 0 l u  x i 2 2 u  x i y x d x i 1 n 1 u  i 1 u  i 1 2 4 h 0 u  i 1 u  i 1 a 0  l cos  i n u  1 u  1 2 8 h 0 u  1 u  1 2 a 0  l u  l 1 u  l 1 2 8 h 0 u  l 1 u  l 1 2 a 0  l substituting eqs 24 25 and 27 into eq 12 leads to the following discrete equation 28 u  i u  i 1 u  i 1 2 e i b u  i 2 u  i 1 u  i 1 u  i 2 2 c 1 h 0 2 6 e i b h 0 4 c 01 2 c 1 h 0 2 6 e i b 29 c 1  f a f  2 c 01 e a p 2 l a 0  2 l 2 sin  i n u  i 1 2 u  i u  i 1 h 0 2 u  1 u  1 2 8 h 0 u  1 u  1 a 0  2 l u  l 1 u  l 1 2 8 h 0 u  l 1 u  l 1 a 0  2 l e a p 2 l a 0  2 l 2 sin  i n u  i 1 2 u  i u  i 1 h 0 2 i 1 n 1 u  i 1 u  i 1 2 4 h 0 u  i 1 u  i 1 a 0  l cos  i n substituting eq 24 into the simply supported boundary conditions see eq 13 yields new expressions of boundary conditions 30 u  0 0 u   0 u  1 2 u  0 u  1 h 0 2 0 u  n 0 u   n u  n 1 2 u  n u  n 1 h 0 2 0 introducing x 1 and x n 1 gives rise to 31 u  1 u  1 u  0 0 u  n 0 u  n 1 u  n 1 the initial iteration function used in the simulation is selected as 32 u  x b 0 sin  x l where b 0 is the initial displacement and is set to 0 001 in this paper 3 2 2 the differential quadrature element method dqem according to the dqem the k th order derivative of the non trivial static equilibrium configuration u  x at the nodal point x i can be approximated by a sum function wang et al 2004a 33 u  k x i j 1 n g j k x i u  x j  1 k x i u  1 x 1  n 1 k x i u  1 x n 1 i 1 2 n 1 where n 1 stands for the number of nodes g and  represent the weighting coefficient matrices which are calculated by 34 g j k x i 1 x j x n 1 j 1 l j k x i x j x n 1 j 1 k l j k 1 x i l j x j x 1 x j x n 1 j 1  j k x i j 1 n 1 i 1 2 n 1 35 g j k x i 1 x j x 1 x j x n 1 l j k x i x i x 1 x i x n 1 k l j k 1 x i x i x 1 x i x n 1 k k 1 l j k 2 x i j 2 3 n 1 1 i 1 2 n 1 36  j k x i 1 x j x n 1 j 1 l j k x i x i x 1 x i x n 1 k l j k 1 x i x i x 1 x i x n 1 k k 1 l j k 2 x i j 1 n 1 i 1 2 n 1 where l j x is the lagrange interpolation function 37 l j x k 1 k j n 1 x x k x j x k 38 l j 1 x i 1 x j x i m 1 m i j n 1 x x k x j x k m 1 m i j n 1 1 x i x m i j i j i j 1 2 n 1 39 l j k x i k l j 1 x i l i k 1 x i l j k 1 x i x i x j i j m 1 n 1 l j 1 x m l m k 1 x j i j i j 1 2 n 1 the coefficients satisfy the following conditions 40  j x i 0 i 1 2 n 1  1 x 1  n 1 x n 1 1  1 x n 1  n 1 x 1 0 l j x i  i j 1 i j 0 i j as the static equilibrium of eq 12 includes an integral term the integral quadrature method should be added on the basis of the dqem according to the theory of the integral quadrature method the interpolation relation between the integral operator and the nodal function is 41 x i x j f x d x k 1 n 1 c k i j f x k where the weight coefficient c k i j is calculated by the following formula 42 c k i j a 1 j k a 1 i k the elements in the coefficient matrix a are determined by 43 a i j x i r x j r l i j 1 i j l i i 1 1 x i r i j i j 1 2 n 1 where the weight coefficient l 1 is calculated from eq 38 r represents a constant it was shown shu et al 1995 that when the constant satisfies r 0 1 the influence of the constant term on the numerical simulation accuracy can be ignored here the constant is set to 0 01 to ensure the accuracy of the calculation in this paper the rule of chebyshev gauss lobatto distribution is adopted 44 x i 1 2 1 cos i 1  n 1 1 l i 1 2 n 1 by considering that the pipe element is relatively simple the elastic structure can be approximated with 11 nodes to obtain more accurate results wang and wang 2013 wang et al 2004b therefore the number of nodes n 1 is equal to 11 in this paper 3 3 comparison of numerical and analytical results fig 2 shows the comparison of analytical solutions and the results of two different numerical methods indicating that the analytical results agree well with the numerical results the slight discrepancies are presented in table 3 due to the presence of the symmetrical initial curvature the first order non trivial equilibrium solutions are asymmetric therefore in the presence of initial curvature the supercritical vibrations of the pipe conveying fluid will probably undergo between two asymmetric steady states based on the results in fig 2 table 3 shows the comparison of supercritical configuration solutions of different methods with different initial curvatures it can be seen from table 3 that the differences in equilibrium configurations obtained from the analytic method fdm and dqem are quite small it should be mentioned that the present work mainly focuses on the static equilibrium deformation and the natural vibration characteristics of the curved pipe conveying supercritical fluid without considering damping and excitation factors these methods can achieve high accuracy but they might not give high accuracy if damping and excitation are involved in the equation 4 critical flow velocity the critical velocity is a key index of the transition between subcritical and supercritical states the analytical expression of the critical flow velocity is given as eqs 22 and 23 the subsequent discussion is focused on the curved pipe under the first order supercritical condition meaning that the fluid velocity satisfies  1   2 fig 3 shows the effect of the initial curvature on the first two critical flow velocities when the initial curvature increases from 0 to 3 d 2 6 d h 6 h 2 2 the first order critical flow velocity also increases therefore the larger the initial curvature the higher the first order critical velocity in this range of curvature the second order critical velocity does not change the initial curvature the length and the thickness of the pipe have significant effects on the critical fluid velocities the effects of these key parameters on the critical flow velocities are discussed in detail below for a fixed pipe thickness h 0 0006 m fig 4 a shows the 2 d contour plot of the first order critical velocity with the changing pipe length l and initial curvature a 0 fig 4 a indicates that as the length decreases and the initial curvature increases the pipe is highly unlikely to enter the supercritical state fig 4 b displays the influences of the pipe thickness h and the initial curvature a 0 on the critical velocity as shown in fig 4 a the critical velocities increase with the increase of these two parameters fig 4 shows that if the influence of the initial curvature of the pipe is not considered the critical velocity of the pipe could be underestimated under the same outer diameter a smaller inner diameter pipe corresponds to a larger critical flow velocity therefore the static equilibrium configuration is not prone to instability due to fluid flow this is because the corresponding pipe has a greater rigidity 5 supercritical vibration characteristics when the pipe vibration enters into the supercritical state the corresponding governing equation can be derived by using the following coordinate transformation 45 u x t u x t u  x by substituting the coordinate transformation into eqs 6 and 8 the governing equation for the pipe around the non trivial configuration is obtained as 46  p a p  f a f u t t 2  f a f  u x t  f a f  2 u x x u  x x e i b u x x x x u  x x x x e a p 2 l y x x u x x u  x x 0 l u x u  x 2 2 u x u  x y x d x 0 substituting eq 12 into eq 46 yields 47  p a p  f a f u t t 2  f a f  u x t  f a f  2 u x x e i b u x x x x e a p 2 l y x x u  x x 0 l u  x 2 2 u  x y x d x e a p 2 l y x x u x x u  x x 0 l u x u  x 2 2 u x u  x y x d x 0 5 1 natural frequencies and vibration modes the galerkin truncation method gtm is used to study the natural frequency of the slightly curved pipe in the supercritical regime the mode of the static and slightly curved pipe is obtained first ding et al 2019 for the corresponding static pipe the effects of fluid flow and the nonlinear terms are ignored then based on eq 47 the linear governing equation and the boundary conditions of the pipe is expressed as 48  p a p  f a f u t t e i b u x x x x e a p l y x x u  x x 0 l u x u  x u x y x d x e a p 2 l u x x 0 l u  x 2 2 u  x y x d x 0 49 u 0 t 0 u l t 0 u x x 0 t 0 u x x l t 0 the modal function of the static and slightly curved pipe can be written as 50  x  h x  p x c 1 cos   x l c 2 sin   x l c 3 ch   x l c 4 sh   x l c 5 sin  x l according to the references nayfeh and emam 2004 ye et al 2020 substituting eq 50 into eqs 48 and 49 results in the following algebraic equations for the coefficients 51 c 1 c 3 0  2  2 l 2 c 1 c 3 0 e i b  4 l 4  p a p  f a f  n 2 e a p 2 a 0 2 6 a s a 0 3 a s 2  4 4 l 4 c 5 0 c 1 cos   c 2 sin   c 3 ch   c 4 sh   0  2  2 l 2 c 1 cos   c 2 sin   c 3 ch   c 4 sh   0 a 0 a s 2  2 e a p  3 l 4 cos   1  2 1 c 1 sin    2 1 c 2 ch   1  2 1 c 3 sh    2 1 c 4 e i b  4 l 4  p a p  f a f  n 2 e a p 2 a 0 2 6 a s a 0 3 a s 2  4 4 l 4 c 5 0 where 52 a s a 0 2 2 7  f a f  2 2 4  f a f  2 4 e a p a 0 l 2 e 2  2 a p i b e a p  to find non zero solutions for the coefficients c 1 c 2 c 3 c 4 c 5 t the determinant of the coefficient matrix must be zero thus the eigenvalues  can be obtained from the determinant in the following analysis of the natural frequencies and the transverse vibration modes the modal function of the static and slightly curved pipe is used as the trial function and the weight function for the galerkin truncation method gtm the linear free vibration equation of the slightly curved fluid conveying pipe with the consideration of the fluid velocity is expressed as eq 47 the displacement function of the pipe is assumed to be 53 u x t k 1 n q k e i  k t  k x where n represents the truncation term of the gtm the natural frequencies of the slightly curved fluid conveying pipe are calculated by solving 54  2 m i  g k r 0 r 1 0 m k m 0 k m 1 k m g k m 2  f a f   1 k m  f a f  p a p  0 m k k m 0 k m e i b  4 m  f a f  p a p  0 m  f a f  2 m  2  f a f  p a p  0 m k m r 0 k m e a p  r m c 0 l  f a f  p a p r 1 k m e a p  2 m c 1 2 l  f a f  p a p  0 m 0 l  m x 2 d x  1 k m 0 l  k x  m x d x  2 m 0 l  k x  m x d x  4 m 0 l  k x  m x d x  r m 0 l y x u  x  m x d x c 0 0 l  k x y x  k x u  x d x c 1 0 l u  x 2 2 u  x y x d x where the apostrophe is the derivative with respect to the space coordinate x the eigenvalue  represents natural frequencies of the free transverse vibration of the pipe the modal function of the free vibration of the pipe is written as 55  x k 1 n im q k  k x where q k is the complex eigenvector associated with a given eigenvalue and im q k represents the imaginary part of q k in order to analyze the effect of truncation number on frequency the frequency results of truncation numbers 2 4 6 and 8 are calculated respectively to facilitate the comparison of the convergence of truncation results the frequency deviation is defined as follows 56   i n  i 8  i 8 i 1 2 3 4 n 2 4 6 8 where  i n is the i th order frequency under the n th order truncation  i 8 denotes the i th order frequency under the 8 th order truncation as can be seen from table 4 the second order galerkin truncation method is not good enough to calculate the second order natural frequency moreover when n 4 the errors of the first two order natural frequencies are all less than 0 1 therefore the fourth order truncation result could be adopted for the following calculation according to fig 5 there is a significant difference in the second order natural vibration mode if only the first two natural modes are considered the results of the 4 term galerkin truncation method are in good agreement with those of 6 term and 8 term on the other hand if the first four frequencies are discussed a 6 term truncation will be required therefore the 4 term galerkin method is used for the following investigations 5 2 verification using discrete fourier transform dft method the natural frequencies of the slightly curved pipe in the supercritical regime are numerically obtained in this subsection using the dft and the dqem according to the dqem in subsection 3 2 2 the number of nodes is set as 11 the governing equation eq 47 and boundary conditions eq 49 are discretized into algebraic equations the time domain response for the free vibration of the curved pipe is obtained and the steady state response of the middle point of the pipe is given in fig 6 a the dft is used to transform the time history to the frequency domain and the spectrum diagram is shown in fig 6 b specifically given an initial displacement of the pipe the time history of free vibration of the pipe is determined based on the time domain response the spectrum diagram can be obtained using the dft then each natural frequency can be obtained from the peak of the spectrum diagram under different initial curvatures the fundamental frequencies of the two methods are obtained as shown in fig 7 it is easy to notice that the 4 order gtm and the dft give almost the same results this confirms the validation of two approaches for calculating the natural frequencies of the super critical slightly curved pipe it is easy to observe that the fundamental frequency of the slightly curved pipe is very sensitive to the initial curvature and the fluid velocity as the fluid velocity increases the fundamental natural frequency of the pipe decreases first then when increasing to the critical fluid velocity the fundamental frequency reaches zero at this point the trivial equilibrium configuration of the pipe loses its stability thereafter as the fluid velocity continues to increase the pipe will vibrate around a non trivial static equilibrium configuration moreover the fundamental frequency begins to increase however in the supercritical region the fundamental frequency of the curved pipe is lower than that of the straight pipe an interesting observation is that in the area where the lines overlap which is also the transition area of the subcritical and supercritical states there is a flow velocity range where the fundamental frequency of the straight pipe is higher than that of the slightly curved pipe 5 3 the effects of system parameters the fundamental frequency results of the slightly curved pipe in the supercritical condition in fig 7 are mutually verified by the 4th order galerkin truncation method and the discrete fourier transform the following parameter discussions are all based on the results of the 4th order galerkin truncation as shown in fig 8 the critical velocity decreases with an increase of the pipe length the flow velocity of the fluid in the pipe is in the range of the first order critical velocity and the second order critical velocity different from the observation in subcritical range in the supercritical flow range the pipe has the same fundamental vibration frequency with different lengths moreover the fundamental frequency of the transverse vibration of a longer pipe may be larger fig 9 a shows that when the length of the pipe is longer the corresponding first order and second order critical fluid velocities are lower fig 9 b displays the variation of the fundamental natural frequency of the supercritical pipe with the length it is interesting to note that the fundamental frequency is not monotonous with the change of the length in the supercritical range instead the fundamental frequency first increases and then decreases with an increase in the pipe length 6 conclusions this paper has focused on the free supercritical vibration of the slightly curved pipe it was found that the initial equilibrium of the pipe could lose its stability when the fluid reaches the supercritical velocity the critical velocity of the fluid conveying pipe was obtained based on the buckling configuration furthermore the governing equation was derived for the supercritical vibration of the slightly curved pipe around the non trivial equilibrium natural frequencies of supercritical vibration were determined using two different methods to confirm the correctness of the analyses the effects of the initial curvature the pipe length and the pipe thickness on the fundamental frequency were investigated for the curved pipes based on the obtained results the following conclusions can be drawn 1 the initial curvature has a significant effect on the critical flow velocity of the pipe generally the first order critical flow velocity increases with an increase of initial curvature 2 the presence of initial curvature can increase the supercritical buckling shape of the pipe and lead to the bi stable asymmetry of the supercritical buckling 3 dynamic characteristics of the slightly curved pipe conveying fluid in the supercritical regime are more complicated compared with the case under subcritical conditions in particular the fundamental frequency no longer varies monotonously with the length in short the fluid conveying pipe with an initial curvature has more complex dynamic characteristics in the supercritical regime in order to obtain reasonable and meaningful results it is necessary to consider the geometric imperfections or initial curvatures in analyzing the dynamics of initially curved fluid conveying pipes credit authorship contribution statement si qin ye investigation writing original draft preparation hu ding conceptualization supervision sha wei writing review editing jin chen ji writing review editing li qun chen validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors gratefully acknowledge the support of the natural science foundation of china nos 12025204 12072181 
20887,hydropneumatic passive heave compensator phc for offshore drilling may exhibit undesirable effects due to nonlinearities of the friction seal causing the so called compensator induced vibration civ phenomenon which induces longitudinal oscillations of frequencies higher than the heave motion in this paper a control system is proposed to attenuate the heave motion and to mitigate the civ and compared to common practice such as a linear feedforward controller the proposed control is composed of a nonlinear feedforward to mitigate the nonlinear seal friction of phc and a feedback crone french acronym for fractional order robust control controller to address the civ the crone control is designed based on a reduced order model of the drill sting and the linearized model of the phc this control drastically reduces the civ and the transmission of heave motion highlighting the limitation of the linear feedforward furthermore it is shown that the proposed control strategy can satisfactory attenuate the heave motion by 95 and the civ phenomenon by 88 despite noisy measurements by the inclusion of a kalman and a butterworth filters keywords ultra long drill string compensator induced vibration civ heave compensator longitudinal natural vibration seal friction nonlinear control crone control kalman filter 1 introduction as explained in sanchez et al 2020 which is the part i of this two part article series seal friction of a phc presents a nonlinearity which has strong influence on the phc force and may easily dominate it consequently it has a severe detrimental impact on the phc performance furthermore the seal friction of a phc also produces the compensator induced vibration civ phenomenon reported and explained by wada et al 2018 the high frequencies oscillations of civ phenomenon which are transmitted to the drill string and drill bit are potential causes of drill string fatigue wada et al 2018 sanchez et al 2020 moreover civ may decrease the performance of the offshore drilling because the weight on bit wob variation increases in such way that the contact between the drill bit and the formation may not be ensured by the phc sanchez et al 2020 wada et al 2018 mentioned the use of draw works heave compensator instead of phc to avoid the effect of seal friction on the other hand ottestad et al 2012 studied one possibility to handle the phc seal friction by introducing an extra relative motion between the piston and the cylinder the static friction is eliminated however the coulomb friction persists and the improvement of phc performance is quite modest in relation to the added complexity associated with rotating the piston another option to mitigate the seal fiction effect of phc consists in adding an ahc to have an hybrid heave compensator hhc active controllers are usually linear feedforwards barr et al 2015 ottestad et al 2010 haao and vangen 2012 hatleskog and dunnigan 2012 which calculates the flow that should be pumped in out or inside the chamber of the active hydraulic cylinder to cancel the heave disturbance these controllers are designed in a simple way as described in ottestad et al 2010 and barr et al 2015 neglecting phc and drill string dynamic however its performance is validated through simulation of a model with nonlinear phc and a drill string model of fourth order the dynamic of drill string was taken into account to design a linear active position control with feedback force in korde 1998 the phc is a vibration absorber and the ahc has two actuators which work simultaneously whereas the control strategy is chosen whether the borehole is engaged or disengaged in both situations the controllers are able to fully decouple heave motion highlighting that the model is linear and perfectly known however when the phc is hydro pneumatic a linear model is too simplified to capture the full system dynamics due to the seal friction of the phc cylinder as is explained by sanchez et al 2020 and suggested by do and pan 2008 do and pan 2008 used a disturbance observer to estimate the seal friction force of the cylinder actuator which is difficult to be accurately modeled that disturbance observer is then implemented in the control design of a strictly active system the controller is unable to fully decouple ship heave from the riser they also pointed out that the seal friction is not the only nonlinearity because the model of a servo valve that commands the cylinder is also highly nonlinear a nonlinear friction observer is also used to estimate the cylinder friction of an ahc yu et al 2019 backstepping method is employed to design a state constrained variable structure it is concluded that this observer reduced the gain of the robust controller and simplified the tuning of its parameters making it more suitable for industrial applications there are actuators which can be more accurately modeled with a linear behavior as a variable displacement hydraulic pump see woodacre et al 2015 but they normally introduce a delay which is addressed by a feedforward control with suitable phase advance of the drive signal hatleskog and dunnigan 2012 this delay problem in heave compensation has also been addressed with heave prediction kchler et al 2011 and model predictive control woodacre et al 2018 delays are not only attributed to ahc actuators the typical heave sensor the motion reference units mru and its communication with the controller also present a delay and are also addressed with heave prediction li et al 2017 yu et al 2019 in this article the main simplification is to neglect the actuator dynamic and sensor delay it means that the system has no delay and neither nonlinearities associated with the actuator or sensor only the measure noise of sensor is considered many kinds of controllers have been proposed in the literature to improve the performance of the phc however to the best knowledge of the authors only hatleskog and dunnigan 2012 showed the response of a feedforward linear control in the presence of civ as the controller is not able to totally cancel the high frequency oscillations an impedance subsystem is added between the lower drill string and the drill bit thus the civ is almost eliminated this means that the system has an ahc and an extra subsystem in this article an active control for an hhc a hydropneumatic phc and an ahc is proposed to mitigate the civ phenomenon and heave motion without an extra subsystem furthermore a linear feedforward controller is designed to compare the performance of the proposed controller this comparison is relevant and serves as a benchmarking since the linear feedforward controller usually commands the ahc barr et al 2015 ottestad et al 2010 haao and vangen 2012 hatleskog and dunnigan 2012 the controllers are validated through the simulation of a model developed in sanchez et al 2020 it considers a nonlinear phc and a lumped model of the drill string with their respective values to simulate the system the proposed controller is composed of a nonlinear feedforward controller and crone feedback controller the design of the nonlinear feedforward control is based on the nonlinear phc model the design of a crone feedback control takes into account a reduced order model of the drill string and the linearized model of the hydro pneumatic phc that was developed in sanchez et al 2020 the reduced order model is usually used to design the controller in vibration control problems fortaleza 2013 this controller is a possible solution for the mitigation of civ produced by the seal friction of hydro pneumatic phc as described in wada et al 2018 and hatleskog and dunnigan 2007b furthermore to analyze the control performance degradation caused by introducing zero mean measurement noise and to check the proposed controllers feasibility in presence of noise in this article measurement noises are added and addressed using kalman and butterworth filters a similar controller was previously proposed by aalerud and klevmo 2013 with a nonlinear feedforward and a feedback pi tuned with an on line method this control is tested in simulation and an experiment modeling the drill string as a spring damper system and implementing the drill string as a short steel rod a more advanced physical drill string representation was not prioritized because the scope was limited to the hhc system neglecting not only its interaction with the drill string but also the civ phenomenon finally the authors concluded that the drill string model stiffness would be required to ensure the feedback loop stability for long drill strings because usually controllers of vibration drill string are designed taken into account drill string model i e the control of torsional vibration is based on a distributed parameter model wang et al 2020 this article is organized as follows in section 2 a reduced order model is obtained through modal reduction for the design the feedback crone controller section 3 shows the design of two feedforward controllers linear and nonlinear and the crone feedback controller then the simulation results of four combination of controllers linear and nonlinear feedforwards crone feedback and crone feedback plus nonlinear feedforward are presented in section 4 for two different waves a sine wave with a frequency that triggers the civ phenomenon and an ocean wave that is composed by a frequency interval section 5 covers measurement noise the filters design and the simulation results of the four controllers with noise finally a conclusion is drawn and future works are suggested 2 modal reduction a reduction order model was realized by gonzalez et al 2019 obtaining an equivalent stiffness mass and damping of the system that reduced model fitted the main behavior for low formation stiffness but it was not suitable for hard formation to improve this a modal reduction is used which consists of keeping the most important modes normally the modes with the largest static gains between the input and the output or lower frequencies and the modes of lower frequencies since higher frequencies are attenuated by the phc the methodology to obtain the order reduction of the modal system is well detailed in simes et al 2018 these models have been used to design controllers in vibration problems e g fortaleza 2013 proposed an active control based on the reduced modal model of a riser to minimize the vortex induced vibrations thus the reduction is applied to the original modal model of the linearized phc and lumped drill string which was obtained in the part i of the article series sanchez et al 2020 the resulting reduced model is represented by the matrices and vectors a r b r and c r which are the small part of the original system and may approximate its dynamic behavior for the chosen eigenvalues normally the static gain of the reduced model suffers losses to neglect the eigenvalues the factor f b r is introduced to ensure that the original and the reduced modal system have the same static gain as is shown in varga 1993 for the siso case 1 x r a r x r f b r b r u y c r x r f b r c r a r 1 b r c m a m 1 b m where a m b m and c m are the matrices describing the modal model prior to the reduction the first three modes are chosen to approximate the original model based on the number of typical vibration modes excited by the civ described in wada et al 2018 furthermore three modes of drill string are also considered significant in korde 1998 and are used to simulate the system and to design a controller of an hhc 2 1 modal reduction results the frequency response with and without modal reduction are presented in fig 1 for a drill string length of 12 km with the maximum operation and minimum ship heave amplitude i e x h m a x 1 5 m x h o p e 1 m and x h m i n 0 5 m and same period of 7 s the linear system without reduction which was presented in sanchez et al 2020 has the force caused by heave motion as input its reduced order model was calculated with eq 1 the three first vibration modes approximate well the original system and the steady state error was adequately compensated with the scalar f b r it is important to highlight that this plant is used to design the crone controller this plant has a particular behavior because it has a phase inversion from 0 deg to 180 deg in the small frequency interval less than 1 rad s see fig 1 3 control two control strategies for the hhc are developed in this section the typical linear feedforward ffl normally used by the industry and the proposed control that is composed of a crone feedback and a nonlinear feedforward ffnl fb the basic scheme of the approaches is shown in fig 2 the feedback control fb represents the feedback crone whereas the feedforward ff may represent the ffl or the ffnl two sensors are used the position x h t and speed x h t of the ship are determined in real time by a motion reference unite mru and the cylinder displacement of the phc is measured with a position sensor ottestad et al 2010 in section 5 the measure noise in the sensors and the filtering process of these signals are considered however the mru delay is not deemed because there are mrus able to predict heave motion rather accurately without delay due to the use of an internal kalman filter aalerud and klevmo 2013 another important simplification is to neglect the actuator dynamic and its delay the actuators of most heave compensation systems are usually hydraulic or electric drive systems with a power capacity of typically only 10 of the phc woodacre et al 2015 the hydraulic actuator presents a delay which is introduced by its long hydraulic lines hatleskg and dunnigan 2007 the electric drive system has a very fast response in comparison to a traditional hydraulic system the section is organized as follows two feedforward controls are presented linear and nonlinear finally the feedback crone is developed 3 1 feedforward controls 3 1 1 linear feedforward ffl the ffl is the control used to mitigate the disturbance caused by the platform movement barr et al 2015 ottestad et al 2010 haao and vangen 2012 hatleskog and dunnigan 2012 the controller parameters are adjusted by several simulations and the parameters that provide the highest attenuation are chosen ottestad et al 2010 haao and vangen 2012 contrary to the aforementioned empirical procedure the ffl considered in this work is designed analytically it is based on the physical analysis and linearization of the dynamic force of the phc developed by sanchez et al 2020 in the part 1 of this two part set of articles 2 f f l t k p h c x h t b p h c x h t where k p h c and b p h c are the linear parameters of phc the stiffness of the air bank and the total friction coefficient the ffl aims to cancel the phc dynamic force applied on the crown block which is produced by the platform movement however these forces are highly nonlinear and their linearization induces significant errors caused especially by the dry friction force as shown in sanchez et al 2020 and in aalerud and klevmo 2013 for this reason a ffl is unable to fully reject this force another negative point is the relation between the linearization and the heave movement velocity so a ffl controller designed for a given heave motion cannot ensure the same performance for another movement and it tends to be degraded because the linearization error increases as explained in sanchez et al 2020 3 1 2 nonlinear feedforward ffnl in theory the phc force could be perfectly canceled using the negative expression as a control law however this is an ideal case and requires the perfect knowledge of the phc model relative position and velocity between the ship and crown block in reality a perfect compensation is not possible due to sensor inaccuracies and noise the limitations of the active drive hatleskg and dunnigan 2007 and modeling errors furthermore the model used here is simplified model because the phc compensator is a complex system e g its model is deduced with twenty one equations in hatletvedt et al 2018 for the above reasons a ffnl was derivated from the nonlinear expression of the phc forces presented in sanchez et al 2020 only considering the force part developed by the position and speed of ship this control law has the opposite sign to try to cancel the force developed by the heave disturbance 3 f f n l t f f c k p h c x h t f f c u s f t a n h f h h x h t f f c  f f s i g n x h t x h t 2 where the parameter of the phc force are u s f is the kinetic friction coefficient of cylinder seal of phc h is the scaling parameter and determines the change speed of friction from one direction to another and  f f is the viscous friction coefficient also two factors are introduced to avoid the perfect cancellation of phc force developed by the disturbance the factor f h modifies the scaling parameter of the hyperbole tangent h such that 0 f h 1 forcing that the seal friction force of control commutes slower than the phc seal friction force and the factor f f c which is 0 f f c 1 changes the amplitude of each terms 3 1 3 scaling parameter f h of seal friction for ffnl the seal friction of the phc commutes from zero to its maximum value 21 kn with small relative velocity variation in the order of millimeters per second 2 mm s with h 1000 in haao and vangen 2012 and in this paper 5 mm s with h 250 fig 3 shows the seal friction force f h 1 and its approximation with three different values of f h 0 5 0 1 0 01 when the factor decreases the control force is slower and less reactive but the error increases the trade off between the increasing error and slower response was managed by choosing h 0 1 despite the obtained error the factor f h is really an important control parameter to avoid chattering of the control signal because the sensors have inaccuracies and noise the drive has its physical limitations hatleskog and dunnigan 2007a and the model of seal friction does not describe the hysteresis of this force ottestad et al 2012 the ffnl proposed in aalerud and klevmo 2013 shows the effect of neglecting this hysteresis and the controller addressed it with a more detailed model of seal friction called lugre 3 2 feedback crone three generations of crone control are found in sabatier et al 1998 oustaloup et al 1993 and oustaloup and bansard 1993 the fact that the phc frequency responses of fig 1 have phase and gain uncertainties at the desired open loop crossover frequency implies the use of the third generation this controller is able to minimize variation of closed loop resonant peak due to plant uncertainties and the variation of the stability degree the crone control is based on the open loop function 4  s c s g s where c s is the controller and g s is the plant i e the phc and drill string after applying the modal reduction of section 2 the normal design methodology of the third generation control is based on a desired open loop transfer function  s with the fractional controller c f r a c respecting the constraints imposed on the following sensitivity functions 5 s s 1 1  s 6 t s 1 s s 7 g s s g s s s a n d 8 c s s c s s s where s s is the sensitivity function t s complementary sensitivity function g s s input disturbance sensitivity function and c s s input sensitivity function finally the crone controller is approximated by a rational transfer function oustaloup 2014 for tracking problems the most relevant constraints are imposed on the complementary sensitivity function whereas in the ahc case the goal is to design a controller with a high rejection level of the input disturbance and which can ensure a minimum stability degree therefore the proposed control design is mainly based on the open loop transfer function  s and the input disturbance sensitivity function g s s 3 2 1 design of a feedback crone control crone methodology is based on the frequency domain thus a linearized model of the plant is required for the controller design first the nonlinear forces of phc were linearized for three sinusoidal signals with the same period 7 s and different amplitudes 0 5 m 1 0 m and 1 5 m that represent sea state number 1 2 and 3 respectively second the modal model was obtained for each linearized force finally the reduced order model was obtained for the three linearized models in eq 1 the ahc controller is designed using the crone toolbox this is a matlab simulink toolbox that was developed by the crone research group lanusse et al 2013 the design methodology is summarized in three steps first the resonance frequency of the control  r is chosen in the interval specified in fig 1 b as this interval is placed before of the first phase inversion a stable open loop is found in an easier way and an acceptable rejection level of the input disturbance may be obtained thus the resonance frequency value chosen was 1 1 rad s second the controller is designed to obtain the open loop of fig 4 which meets two criteria further first criterion the open loop is stable even with the phase and gain variation of the phc with different input disturbance amplitude for the second criterion the inversion phase of the second and third modes is placed between 5 db e 35 db which could be considered as a high value for the open loop and this is the key to improve the input disturbance sensitivity function g s s because it is inversely proportional to the open loop gain  as shown in eqs 7 and 9 finally the rational controller of the fractional controller is obtained with a fourth order transfer function 9 c r a t s 1 855 1 0 7 s 5 20 s 0 439 s 0 365 s 0 322 s 29 5 s 2 21 s 0 544 s 0 028 fig 5 shows the input disturbance sensitivity function g s s and the frequency response of the phc without control the three different amplitudes x h m i n x h o p e and x h m a x the control has an excellent response the first resonance peak of frequency 1 7 rad s is highly attenuated from 95 db and 105 db to 136 db the second peak from 105 db and 116 db to 148 db all the frequency peaks of the phc are attenuated in this frequency interval and the attenuation rate has a small variation in function of the disturbance amplitude 4 simulation results in this section the responses of the phc without control the ffl and the proposed control ffnl fb are presented for two different heave movements of the ship the sinusoidal that generates the civ and one caused by a sea wave to understand the contribution of each part of the proposed control ffnl fb the response of fb and ffnl are also separately shown these responses are the movement of the crown block wob the wob fourier transformation and the forces developed by each control for the first three responses there are two graphs by figure and they are grouped according to the magnitude similarity the top plots correspond to the results obtained with phc and ffl and the bottom ones to the responses of the others in sanchez et al 2020 the model of drill string and phc was described and their parameters were provided 4 1 control results for the civ in order to answer one of the objectives of this article the response of the controllers is shown when there is the civ phenomenon which is produced by a sinusoidal heave motion of the vessel of frequency 1 rad s and amplitude 1 m as explained in the first part of this two part article the parameters to evaluate the performance of the controllers with the phc during the civ are attenuation of the maximum movement of the crown block in relation to the input wave amplitude this parameter is commonly used to describe the performance of the phc wob variation wob is a relevant parameter and is normally used to evaluate the performance of phc with drill bit in contact since drilling efficiency is strongly dependent on this parameter factor f civ defines the control attenuation for the wob at the civ frequency 3 rad s relative to the phc attenuation for this frequency it is calculated with the fourier transformation of wob factor f x h defines the attenuation of the control for the wob at the vessel s input frequency 1 rad s relative to the phc attenuation at that frequency it is also calculated with the fourier transformation of the wob before showing the results it is worth noting that the ffl was theoretically designed to work specifically with the heave wave signal that produces the civ in this section this means that the ffl will be presented the best possible performance for this wave because variation of amplitude or frequency of the input heave disturbance will decrease the linearization quality of the phc forces on the contrary the ffnl was assumed imperfect with the factors f f c 0 9 and f h 0 1 of section 3 1 2 since in the case of an ideal ffnl at least in simulation all dynamic forces of phc would be perfectly attenuated fig 6 shows the movement of the crown block for the four configurations and the phc without control the phenomenon of civ is slightly perceived in the movement of the crown block with phc and some high frequency oscillations are observed the phc attenuation is 53 the fb control has the lowest attenuation of the controllers only 92 5 but it is noted that the response is sinusoidal with the same frequency of vessel movement without high frequencies the attenuations of the feedforward controllers are similar 95 8 and 95 7 the difference being that the high frequencies are well defined especially in the ffl the ffnl fb has the best attenuation of the controllers at 99 3 and the same frequency of the vessel movement the wob is shown in fig 7 with a delay of approximately 2 5 s the wob with phc has a variation of up to 150 kn and the civ phenomenon is well defined the phc is unable to guarantee that the drill bit is always in contact with formation because there are time intervals with wob greater than zero which physically means that the drill bit would be free hatleskog and dunnigan 2007b on the contrary all controllers are able to maintain the wob the wob variation obtained with the fb control is 35 kn and is almost a perfect sine wave which is proved by its fourier transformation in fig 8 which shows that its main component is the frequency of the ship movement 1 rad s thus the factor f x h has a low value of 52 7 which is the smallest value obtained by the controllers this is explained in fig 5 in which the attenuation of the fb and the phc are similar close to the frequency of 1 25 rad s however the factor f c i v is 94 7 indicating that the civ is highly attenuated with this controller another favorable point of this controller is that it has high attenuation at the compensator resonance points fig 5 not only for high frequencies since in the case of the first system mode 0 6 rad s its attenuation is 98 and it is better than the attenuation of the two feedforwards at this frequency the ffl has an attenuation of 95 8 a factor f x h of 98 5 but it presents a wob variation of 61 kn with high frequencies caused by the civ which is evidenced by the low value of factor f c i v of 12 this is the lowest value among the proposed controllers therefore the ffl control has an ideal response for the low frequencies but that in the case of high frequencies the performance deteriorates by 86 in relation to the low frequencies further accentuating the perception of the civ in the active control for the civ of hatleskog and dunnigan 2012 the response with ffl also presents civ and its wob variation is 14 kn and its attenuation of the wob variation is 90 in comparison to the wob variation with the phc however it is not said if the input frequency is exactly triggered by the civ as in this study case although the attenuations of the crown block motion are similar for the two feedforward controls 95 7 and 95 8 the ffnl has a wob variation 73 less than the ffl and its performance is similar for low and high frequencies as indicated by the factors values f c i v 88 4 and f x h 89 8 thus the ffnl response to the civ is 76 better than the ffl and this control mitigates the civ but it does not completely cancel it the ffnl fb showed the best response its parameters are an attenuation of 99 3 and a wob variation of 4 kn and factor f x h of 93 8 the values of these three parameters are better than those obtained with the other controllers and the civ is nearly eliminated with a factor f c i v of 99 5 so the civ frequencies are slightly perceptible in wob which is dominated by the vessel motion frequency the data from the four proposed controllers and the phc are summarized in table 1 fig 9 shows the control signal of the four controllers the control signal of ffnl fb is well behaved and similar to the dynamic force developed by the phc see the first part of this two part article this signal has rapid changes only at the point of sign variation of the seal friction and does not show the high frequency oscillations of the civ this is an important result because there was the possibility of eliminating the civ in wob but as a consequence its high frequencies could be in the control signal 4 2 control results for a platform heave motion caused by ocean wave the same analysis made for the movement that generates the civ is realized for the ship heave movement caused by a sea wave which is presented in fig 10 a and it is composed of different frequencies and amplitudes as indicated by its fourier transformation in fig 10 b the controllers are the same as in section 4 1 the same conditions and parameters to evaluate their performances the first two parameters that evaluate the control performance of section 4 1 the attenuation and the variation of wob are maintained the other two parameters f x h and f c i v are replaced by the factors f w l o w and f w h i g h since as the ship wave consists of many frequencies there is not just one civ frequency these parameters are based on the factor f w of eq 10 which is defined as the percentage attenuation of the area under the wob variation curve between the frequencies  1 and  2 that are obtained with control in relation to those obtained with the phc the fourier transformation of the wob variation is used to calculate numerically this integral value factor fw low for the frequency  1 0 and the maximum frequency of the platform motion  2 3 5 rad s which corresponds to the maximum frequency of the heave motion presented in fig 10 factor fw high is equivalent to the factor f c i v of the above subsection which evaluates the control performance in high frequencies from  1 3 5 rad s to  2 10 rad s 10 f w 100 1  1  2  w o b c o n t r o l  d   1  2  w o b p h c  d  fig 11 shows the movement of the crown block for the four controllers and the phc the phc attenuation is 57 and the ffl has the lowest attenuation of the controllers 88 9 the ffnl and fb has almost the same attenuation 95 these values are in the range expected for an hhc around 95 hatleskog and dunnigan 2007a gonzalez et al 2019 and odp 2012 whereas the ffl fb is evidently better with a 99 4 attenuation similar to the 99 9 value of a nonlinear hhc with a contact drill ottestad et al 2010 only one article was found with a perfect decoupling which refers to a hhc with a drill bit in contact and its passive part which is a linear absorber korde 1998 the proposed controller has an attenuation value comparable to that obtained by semiactive controllers for non contact operations 90 sanchez et al 2017 and 97 liu et al 2015 it is observed in fig 12 that the phc is not able to keep the contact boundary condition for the drill bit which is lifted on five occasions as a result the wob variations are 140 kn almost double that of the desired wob value in addition the oscillations of the wob variation have high frequencies greater than 3 5 rad s this is corroborated by the fourier transformation in fig 13 at these frequencies there are peaks with a magnitude between 8 kn and 10 kn because as the wave is constituted by a spectrum rich in frequencies so the civ phenomenon occurs for different modes of the column with different harmonics of the seal friction force the fb has a large wob variation of 51 kn but it has a better response for the high frequencies than the feedforwards its factor f w h i g h is 80 and for the feedforwards are 6 and 77 the highest value of the high frequency peaks of the fourier transformation is 1 8 kn whereas the feedforwards nonlinear present 2 8 kn however its low frequency response has the lowest performance its factor f w l o w is 62 the ffl only attenuates 6 1 of the high frequencies produced by the civ phenomenon and its attenuation in low frequencies is 54 8 these low attenuations yield a wob variation of 98 6 kn causing a loss of contact between the formation and the drill bit see fig 12 at 41 s the ffnl has an acceptable performance and it is reflected in the terms of its value factors f w l o w of 72 and f w h i g h of 77 again the ffnl fb presents the best response in all parameters with an attenuation and a wob variation similar to the previous result of the civ with control 99 4 and 5 kn the improvement over the other controllers is considerable especially at high frequencies its factor f w h i g h is 96 whereas the factor for fb is 80 and for feedforwards 6 and 77 at low frequencies the factor f w l o w is 80 the data are summarized in table 2 the controllers can mitigate the civ without inducing high frequency oscillations in the control signal as presented in fig 14 aalerud and klevmo 2013 determined that the fb does not considerably increase the performance of the ffnl controller when the drill string has low stiffness long drill string due to very low gains of the pi required to the fb controller which was designed through an on line tuning method called the good gain method the authors also suggested that this limitation would be addressed if the fb parameters were automatically adjusted according to the length of the drill the proposed fb is designed considering the drill string model which implicitly considers its stiffness thus this fb combined with the ffnl improved the ffnl performance in all evaluation control parameters see tables 1 and 2 as was supposed by aalerud and klevmo 2013 5 measure noise in this section to demonstrate our control efficiency in the presence of measure noise white noises are introduced in the measurements and two filters are included to mitigate them the diagram schematic of fig 15 introduces noises and filters the white noises  are applied on the position and the speed of ship their standard deviations are 15 mm and 15 mm s respectively each one of these measurements are filtered by one butterworth filter bf and the filtered signals are the inputs of the ff controller on the other hand the standard deviation of the white noise  introduced in the crown block position is 0 5 mm and a kalman filter kf is used to estimate the variable used by the fb controller 5 1 butterworth filter bf the bf first introduced by butterworth et al 1930 is one of the most popular analog filters and its pass band frequency is almost flat its design is well detailed in van valkenburg 2001 and laghari et al 2014 a low pass bf of third order is used and its parameters are calculated to have a cutoff frequency of 50 rad s which was heuristically chosen based on two criteria to filter the frequencies that can trigger the seal friction of the ffnl and to avoid introducing a high phase delay between noisy and filtered signals 5 2 kalman filter kf the kf proposed by kalman 1960 has played a crucial role in many industrial applications an introduction to the general idea of the kf can be found in welch et al 1995 while a more extensive reference can be consulted in brown and hwang 2012 the problem of heave motion estimation was faced using a kf in cuellar et al 2017 and linhares et al 2016 lainiotis et al 1993 has concluded that kf provides the optimal solution when the model which describes the physical phenomenon is completely known in this application a perfect model is not required considering that the reduced order model obtained in section 2 represents the main behavior therefore the kf is well suitable for this application because the perturbation part that is not canceled by the ff exhibits a rich frequency spectrum kf parameters are fixed as sample time 0 001 s measure noise standard deviation of  0 5 mm r  2 perturbation variance q  2 1 0 3 and the internal model of kf is the one presented in eq 1 5 3 numerical results with measure noise the numerical results with measure noise are set out in table 3 the ffnl fb continues to have the best performance as in the noiseless case for this reason only a comparison between the ffnl fb with and without measure noise is presented the figures of this section in fig 16 a the noise measure produced a degradation of ffnl heave attenuation from 99 4 to 95 8 lower attenuation values have been previously reported for non contact operations by cuellar et al 2017 and linhares et al 2016 91 and 85 the control signals of fig 16 b are suitable for implementation due to the smaller noise transmitted to the system through them the main difference with the noiseless case is that small oscillations are presented when there is a change of speed direction fig 17 a shows that the wob variation of ffnl fb with measure noise is 8 3 kn having an increment of 3 kn in relation to the noiseless case this increment is mainly caused by the performance degradation in high frequencies as is seen in fig 17 b and corroborated by the low variation of f w l o w from 80 2 to 78 36 and the high variation of f w h i g h from 96 6 to 88 3 6 conclusions in this work a comparison of four control strategies have been presented for ahc a linear feedforward ffl used as a benchmarking a nonlinear feedforward ffnl which is designed taking into account the friction seal a feedback fb controller based on the crone methodology and a combination of ffnl and fb control performances were validated through simulation of the drill string of 12 km with a phc the ffnl fb control is proposed with a nonlinear feedforward crone feedback and an actuator that provides an accurate control command force the feedforward addressed the nonlinearities of the phc and the presented crone feedback is a robust answer to civ and the residual heave displacement due to difference between feedforward control and real plant forces the ffnl fb performance is the best in all parameters attenuation of 99 4 wob variation between 4 kn and 5 kn and the civ highly mitigated with factors f c i v of 99 and f w h i g h of 96 so the proposed solution is a robust and efficient controller to attenuate heave motion and the civ phenomenon the controllers ffnl fb and ffnl guarantee the operation condition of the drill bit in contact w o b 0 whereas the phc and the ffl are not able to ensure it ffl control which is usually used for heave control in offshore industry has the lowest attenuation of the civ phenomenon among the tested controllers regarding the attenuation factor of high frequencies f w h i g h which are between 2 and 12 even the imperfect ffnl has better results of the ffl in almost all the evaluation control parameters the proposed controllers were implemented with filters kf and bf commonly used by the industry to address the measure noise the largest degradation of control performance is presented in the civ attenuation even so ffnl fb is highly reduced this phenomenon f w h i g h of 88 and the heave attenuation is also maintained in an acceptable value 95 the crone feedback controller was designed using the reduced plant only 3 modes nevertheless it was tested in the full model indicating the pertinence of the modal reduction and control robustness it was shown that the high attenuation of the civ in ffnl fb is provided largely by the fb which takes into account the high vibration modes of the system this approach may be employed to mitigate the frequencies that are higher than the frequencies of the input wave in heave compensation regardless of whether it was produced by seal friction or by other causes as for example the high frequencies presented in the hhc experiment developed by niu et al 2019 future work is expected to include the actuator model in the validation model and consider its dynamic in the controller design furthermore it is expected to design an experiment of hhc with a drill string to test the proposed controllers credit authorship contribution statement william humberto cullar snchez formal analysis investigation methodology writing original draft writing review editing eugnio librio feitosa fortaleza formal analysis investigation methodology supervision writing original draft writing review editing andr benine neto formal analysis investigation methodology supervision writing original draft writing review editing jos alfredo ruiz vargas formal analysis investigation methodology supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge the brazilian institutions cnpq brazil cape brazil fapdf petrobras through prh pb 223 for supporting the present study 
20887,hydropneumatic passive heave compensator phc for offshore drilling may exhibit undesirable effects due to nonlinearities of the friction seal causing the so called compensator induced vibration civ phenomenon which induces longitudinal oscillations of frequencies higher than the heave motion in this paper a control system is proposed to attenuate the heave motion and to mitigate the civ and compared to common practice such as a linear feedforward controller the proposed control is composed of a nonlinear feedforward to mitigate the nonlinear seal friction of phc and a feedback crone french acronym for fractional order robust control controller to address the civ the crone control is designed based on a reduced order model of the drill sting and the linearized model of the phc this control drastically reduces the civ and the transmission of heave motion highlighting the limitation of the linear feedforward furthermore it is shown that the proposed control strategy can satisfactory attenuate the heave motion by 95 and the civ phenomenon by 88 despite noisy measurements by the inclusion of a kalman and a butterworth filters keywords ultra long drill string compensator induced vibration civ heave compensator longitudinal natural vibration seal friction nonlinear control crone control kalman filter 1 introduction as explained in sanchez et al 2020 which is the part i of this two part article series seal friction of a phc presents a nonlinearity which has strong influence on the phc force and may easily dominate it consequently it has a severe detrimental impact on the phc performance furthermore the seal friction of a phc also produces the compensator induced vibration civ phenomenon reported and explained by wada et al 2018 the high frequencies oscillations of civ phenomenon which are transmitted to the drill string and drill bit are potential causes of drill string fatigue wada et al 2018 sanchez et al 2020 moreover civ may decrease the performance of the offshore drilling because the weight on bit wob variation increases in such way that the contact between the drill bit and the formation may not be ensured by the phc sanchez et al 2020 wada et al 2018 mentioned the use of draw works heave compensator instead of phc to avoid the effect of seal friction on the other hand ottestad et al 2012 studied one possibility to handle the phc seal friction by introducing an extra relative motion between the piston and the cylinder the static friction is eliminated however the coulomb friction persists and the improvement of phc performance is quite modest in relation to the added complexity associated with rotating the piston another option to mitigate the seal fiction effect of phc consists in adding an ahc to have an hybrid heave compensator hhc active controllers are usually linear feedforwards barr et al 2015 ottestad et al 2010 haao and vangen 2012 hatleskog and dunnigan 2012 which calculates the flow that should be pumped in out or inside the chamber of the active hydraulic cylinder to cancel the heave disturbance these controllers are designed in a simple way as described in ottestad et al 2010 and barr et al 2015 neglecting phc and drill string dynamic however its performance is validated through simulation of a model with nonlinear phc and a drill string model of fourth order the dynamic of drill string was taken into account to design a linear active position control with feedback force in korde 1998 the phc is a vibration absorber and the ahc has two actuators which work simultaneously whereas the control strategy is chosen whether the borehole is engaged or disengaged in both situations the controllers are able to fully decouple heave motion highlighting that the model is linear and perfectly known however when the phc is hydro pneumatic a linear model is too simplified to capture the full system dynamics due to the seal friction of the phc cylinder as is explained by sanchez et al 2020 and suggested by do and pan 2008 do and pan 2008 used a disturbance observer to estimate the seal friction force of the cylinder actuator which is difficult to be accurately modeled that disturbance observer is then implemented in the control design of a strictly active system the controller is unable to fully decouple ship heave from the riser they also pointed out that the seal friction is not the only nonlinearity because the model of a servo valve that commands the cylinder is also highly nonlinear a nonlinear friction observer is also used to estimate the cylinder friction of an ahc yu et al 2019 backstepping method is employed to design a state constrained variable structure it is concluded that this observer reduced the gain of the robust controller and simplified the tuning of its parameters making it more suitable for industrial applications there are actuators which can be more accurately modeled with a linear behavior as a variable displacement hydraulic pump see woodacre et al 2015 but they normally introduce a delay which is addressed by a feedforward control with suitable phase advance of the drive signal hatleskog and dunnigan 2012 this delay problem in heave compensation has also been addressed with heave prediction kchler et al 2011 and model predictive control woodacre et al 2018 delays are not only attributed to ahc actuators the typical heave sensor the motion reference units mru and its communication with the controller also present a delay and are also addressed with heave prediction li et al 2017 yu et al 2019 in this article the main simplification is to neglect the actuator dynamic and sensor delay it means that the system has no delay and neither nonlinearities associated with the actuator or sensor only the measure noise of sensor is considered many kinds of controllers have been proposed in the literature to improve the performance of the phc however to the best knowledge of the authors only hatleskog and dunnigan 2012 showed the response of a feedforward linear control in the presence of civ as the controller is not able to totally cancel the high frequency oscillations an impedance subsystem is added between the lower drill string and the drill bit thus the civ is almost eliminated this means that the system has an ahc and an extra subsystem in this article an active control for an hhc a hydropneumatic phc and an ahc is proposed to mitigate the civ phenomenon and heave motion without an extra subsystem furthermore a linear feedforward controller is designed to compare the performance of the proposed controller this comparison is relevant and serves as a benchmarking since the linear feedforward controller usually commands the ahc barr et al 2015 ottestad et al 2010 haao and vangen 2012 hatleskog and dunnigan 2012 the controllers are validated through the simulation of a model developed in sanchez et al 2020 it considers a nonlinear phc and a lumped model of the drill string with their respective values to simulate the system the proposed controller is composed of a nonlinear feedforward controller and crone feedback controller the design of the nonlinear feedforward control is based on the nonlinear phc model the design of a crone feedback control takes into account a reduced order model of the drill string and the linearized model of the hydro pneumatic phc that was developed in sanchez et al 2020 the reduced order model is usually used to design the controller in vibration control problems fortaleza 2013 this controller is a possible solution for the mitigation of civ produced by the seal friction of hydro pneumatic phc as described in wada et al 2018 and hatleskog and dunnigan 2007b furthermore to analyze the control performance degradation caused by introducing zero mean measurement noise and to check the proposed controllers feasibility in presence of noise in this article measurement noises are added and addressed using kalman and butterworth filters a similar controller was previously proposed by aalerud and klevmo 2013 with a nonlinear feedforward and a feedback pi tuned with an on line method this control is tested in simulation and an experiment modeling the drill string as a spring damper system and implementing the drill string as a short steel rod a more advanced physical drill string representation was not prioritized because the scope was limited to the hhc system neglecting not only its interaction with the drill string but also the civ phenomenon finally the authors concluded that the drill string model stiffness would be required to ensure the feedback loop stability for long drill strings because usually controllers of vibration drill string are designed taken into account drill string model i e the control of torsional vibration is based on a distributed parameter model wang et al 2020 this article is organized as follows in section 2 a reduced order model is obtained through modal reduction for the design the feedback crone controller section 3 shows the design of two feedforward controllers linear and nonlinear and the crone feedback controller then the simulation results of four combination of controllers linear and nonlinear feedforwards crone feedback and crone feedback plus nonlinear feedforward are presented in section 4 for two different waves a sine wave with a frequency that triggers the civ phenomenon and an ocean wave that is composed by a frequency interval section 5 covers measurement noise the filters design and the simulation results of the four controllers with noise finally a conclusion is drawn and future works are suggested 2 modal reduction a reduction order model was realized by gonzalez et al 2019 obtaining an equivalent stiffness mass and damping of the system that reduced model fitted the main behavior for low formation stiffness but it was not suitable for hard formation to improve this a modal reduction is used which consists of keeping the most important modes normally the modes with the largest static gains between the input and the output or lower frequencies and the modes of lower frequencies since higher frequencies are attenuated by the phc the methodology to obtain the order reduction of the modal system is well detailed in simes et al 2018 these models have been used to design controllers in vibration problems e g fortaleza 2013 proposed an active control based on the reduced modal model of a riser to minimize the vortex induced vibrations thus the reduction is applied to the original modal model of the linearized phc and lumped drill string which was obtained in the part i of the article series sanchez et al 2020 the resulting reduced model is represented by the matrices and vectors a r b r and c r which are the small part of the original system and may approximate its dynamic behavior for the chosen eigenvalues normally the static gain of the reduced model suffers losses to neglect the eigenvalues the factor f b r is introduced to ensure that the original and the reduced modal system have the same static gain as is shown in varga 1993 for the siso case 1 x r a r x r f b r b r u y c r x r f b r c r a r 1 b r c m a m 1 b m where a m b m and c m are the matrices describing the modal model prior to the reduction the first three modes are chosen to approximate the original model based on the number of typical vibration modes excited by the civ described in wada et al 2018 furthermore three modes of drill string are also considered significant in korde 1998 and are used to simulate the system and to design a controller of an hhc 2 1 modal reduction results the frequency response with and without modal reduction are presented in fig 1 for a drill string length of 12 km with the maximum operation and minimum ship heave amplitude i e x h m a x 1 5 m x h o p e 1 m and x h m i n 0 5 m and same period of 7 s the linear system without reduction which was presented in sanchez et al 2020 has the force caused by heave motion as input its reduced order model was calculated with eq 1 the three first vibration modes approximate well the original system and the steady state error was adequately compensated with the scalar f b r it is important to highlight that this plant is used to design the crone controller this plant has a particular behavior because it has a phase inversion from 0 deg to 180 deg in the small frequency interval less than 1 rad s see fig 1 3 control two control strategies for the hhc are developed in this section the typical linear feedforward ffl normally used by the industry and the proposed control that is composed of a crone feedback and a nonlinear feedforward ffnl fb the basic scheme of the approaches is shown in fig 2 the feedback control fb represents the feedback crone whereas the feedforward ff may represent the ffl or the ffnl two sensors are used the position x h t and speed x h t of the ship are determined in real time by a motion reference unite mru and the cylinder displacement of the phc is measured with a position sensor ottestad et al 2010 in section 5 the measure noise in the sensors and the filtering process of these signals are considered however the mru delay is not deemed because there are mrus able to predict heave motion rather accurately without delay due to the use of an internal kalman filter aalerud and klevmo 2013 another important simplification is to neglect the actuator dynamic and its delay the actuators of most heave compensation systems are usually hydraulic or electric drive systems with a power capacity of typically only 10 of the phc woodacre et al 2015 the hydraulic actuator presents a delay which is introduced by its long hydraulic lines hatleskg and dunnigan 2007 the electric drive system has a very fast response in comparison to a traditional hydraulic system the section is organized as follows two feedforward controls are presented linear and nonlinear finally the feedback crone is developed 3 1 feedforward controls 3 1 1 linear feedforward ffl the ffl is the control used to mitigate the disturbance caused by the platform movement barr et al 2015 ottestad et al 2010 haao and vangen 2012 hatleskog and dunnigan 2012 the controller parameters are adjusted by several simulations and the parameters that provide the highest attenuation are chosen ottestad et al 2010 haao and vangen 2012 contrary to the aforementioned empirical procedure the ffl considered in this work is designed analytically it is based on the physical analysis and linearization of the dynamic force of the phc developed by sanchez et al 2020 in the part 1 of this two part set of articles 2 f f l t k p h c x h t b p h c x h t where k p h c and b p h c are the linear parameters of phc the stiffness of the air bank and the total friction coefficient the ffl aims to cancel the phc dynamic force applied on the crown block which is produced by the platform movement however these forces are highly nonlinear and their linearization induces significant errors caused especially by the dry friction force as shown in sanchez et al 2020 and in aalerud and klevmo 2013 for this reason a ffl is unable to fully reject this force another negative point is the relation between the linearization and the heave movement velocity so a ffl controller designed for a given heave motion cannot ensure the same performance for another movement and it tends to be degraded because the linearization error increases as explained in sanchez et al 2020 3 1 2 nonlinear feedforward ffnl in theory the phc force could be perfectly canceled using the negative expression as a control law however this is an ideal case and requires the perfect knowledge of the phc model relative position and velocity between the ship and crown block in reality a perfect compensation is not possible due to sensor inaccuracies and noise the limitations of the active drive hatleskg and dunnigan 2007 and modeling errors furthermore the model used here is simplified model because the phc compensator is a complex system e g its model is deduced with twenty one equations in hatletvedt et al 2018 for the above reasons a ffnl was derivated from the nonlinear expression of the phc forces presented in sanchez et al 2020 only considering the force part developed by the position and speed of ship this control law has the opposite sign to try to cancel the force developed by the heave disturbance 3 f f n l t f f c k p h c x h t f f c u s f t a n h f h h x h t f f c  f f s i g n x h t x h t 2 where the parameter of the phc force are u s f is the kinetic friction coefficient of cylinder seal of phc h is the scaling parameter and determines the change speed of friction from one direction to another and  f f is the viscous friction coefficient also two factors are introduced to avoid the perfect cancellation of phc force developed by the disturbance the factor f h modifies the scaling parameter of the hyperbole tangent h such that 0 f h 1 forcing that the seal friction force of control commutes slower than the phc seal friction force and the factor f f c which is 0 f f c 1 changes the amplitude of each terms 3 1 3 scaling parameter f h of seal friction for ffnl the seal friction of the phc commutes from zero to its maximum value 21 kn with small relative velocity variation in the order of millimeters per second 2 mm s with h 1000 in haao and vangen 2012 and in this paper 5 mm s with h 250 fig 3 shows the seal friction force f h 1 and its approximation with three different values of f h 0 5 0 1 0 01 when the factor decreases the control force is slower and less reactive but the error increases the trade off between the increasing error and slower response was managed by choosing h 0 1 despite the obtained error the factor f h is really an important control parameter to avoid chattering of the control signal because the sensors have inaccuracies and noise the drive has its physical limitations hatleskog and dunnigan 2007a and the model of seal friction does not describe the hysteresis of this force ottestad et al 2012 the ffnl proposed in aalerud and klevmo 2013 shows the effect of neglecting this hysteresis and the controller addressed it with a more detailed model of seal friction called lugre 3 2 feedback crone three generations of crone control are found in sabatier et al 1998 oustaloup et al 1993 and oustaloup and bansard 1993 the fact that the phc frequency responses of fig 1 have phase and gain uncertainties at the desired open loop crossover frequency implies the use of the third generation this controller is able to minimize variation of closed loop resonant peak due to plant uncertainties and the variation of the stability degree the crone control is based on the open loop function 4  s c s g s where c s is the controller and g s is the plant i e the phc and drill string after applying the modal reduction of section 2 the normal design methodology of the third generation control is based on a desired open loop transfer function  s with the fractional controller c f r a c respecting the constraints imposed on the following sensitivity functions 5 s s 1 1  s 6 t s 1 s s 7 g s s g s s s a n d 8 c s s c s s s where s s is the sensitivity function t s complementary sensitivity function g s s input disturbance sensitivity function and c s s input sensitivity function finally the crone controller is approximated by a rational transfer function oustaloup 2014 for tracking problems the most relevant constraints are imposed on the complementary sensitivity function whereas in the ahc case the goal is to design a controller with a high rejection level of the input disturbance and which can ensure a minimum stability degree therefore the proposed control design is mainly based on the open loop transfer function  s and the input disturbance sensitivity function g s s 3 2 1 design of a feedback crone control crone methodology is based on the frequency domain thus a linearized model of the plant is required for the controller design first the nonlinear forces of phc were linearized for three sinusoidal signals with the same period 7 s and different amplitudes 0 5 m 1 0 m and 1 5 m that represent sea state number 1 2 and 3 respectively second the modal model was obtained for each linearized force finally the reduced order model was obtained for the three linearized models in eq 1 the ahc controller is designed using the crone toolbox this is a matlab simulink toolbox that was developed by the crone research group lanusse et al 2013 the design methodology is summarized in three steps first the resonance frequency of the control  r is chosen in the interval specified in fig 1 b as this interval is placed before of the first phase inversion a stable open loop is found in an easier way and an acceptable rejection level of the input disturbance may be obtained thus the resonance frequency value chosen was 1 1 rad s second the controller is designed to obtain the open loop of fig 4 which meets two criteria further first criterion the open loop is stable even with the phase and gain variation of the phc with different input disturbance amplitude for the second criterion the inversion phase of the second and third modes is placed between 5 db e 35 db which could be considered as a high value for the open loop and this is the key to improve the input disturbance sensitivity function g s s because it is inversely proportional to the open loop gain  as shown in eqs 7 and 9 finally the rational controller of the fractional controller is obtained with a fourth order transfer function 9 c r a t s 1 855 1 0 7 s 5 20 s 0 439 s 0 365 s 0 322 s 29 5 s 2 21 s 0 544 s 0 028 fig 5 shows the input disturbance sensitivity function g s s and the frequency response of the phc without control the three different amplitudes x h m i n x h o p e and x h m a x the control has an excellent response the first resonance peak of frequency 1 7 rad s is highly attenuated from 95 db and 105 db to 136 db the second peak from 105 db and 116 db to 148 db all the frequency peaks of the phc are attenuated in this frequency interval and the attenuation rate has a small variation in function of the disturbance amplitude 4 simulation results in this section the responses of the phc without control the ffl and the proposed control ffnl fb are presented for two different heave movements of the ship the sinusoidal that generates the civ and one caused by a sea wave to understand the contribution of each part of the proposed control ffnl fb the response of fb and ffnl are also separately shown these responses are the movement of the crown block wob the wob fourier transformation and the forces developed by each control for the first three responses there are two graphs by figure and they are grouped according to the magnitude similarity the top plots correspond to the results obtained with phc and ffl and the bottom ones to the responses of the others in sanchez et al 2020 the model of drill string and phc was described and their parameters were provided 4 1 control results for the civ in order to answer one of the objectives of this article the response of the controllers is shown when there is the civ phenomenon which is produced by a sinusoidal heave motion of the vessel of frequency 1 rad s and amplitude 1 m as explained in the first part of this two part article the parameters to evaluate the performance of the controllers with the phc during the civ are attenuation of the maximum movement of the crown block in relation to the input wave amplitude this parameter is commonly used to describe the performance of the phc wob variation wob is a relevant parameter and is normally used to evaluate the performance of phc with drill bit in contact since drilling efficiency is strongly dependent on this parameter factor f civ defines the control attenuation for the wob at the civ frequency 3 rad s relative to the phc attenuation for this frequency it is calculated with the fourier transformation of wob factor f x h defines the attenuation of the control for the wob at the vessel s input frequency 1 rad s relative to the phc attenuation at that frequency it is also calculated with the fourier transformation of the wob before showing the results it is worth noting that the ffl was theoretically designed to work specifically with the heave wave signal that produces the civ in this section this means that the ffl will be presented the best possible performance for this wave because variation of amplitude or frequency of the input heave disturbance will decrease the linearization quality of the phc forces on the contrary the ffnl was assumed imperfect with the factors f f c 0 9 and f h 0 1 of section 3 1 2 since in the case of an ideal ffnl at least in simulation all dynamic forces of phc would be perfectly attenuated fig 6 shows the movement of the crown block for the four configurations and the phc without control the phenomenon of civ is slightly perceived in the movement of the crown block with phc and some high frequency oscillations are observed the phc attenuation is 53 the fb control has the lowest attenuation of the controllers only 92 5 but it is noted that the response is sinusoidal with the same frequency of vessel movement without high frequencies the attenuations of the feedforward controllers are similar 95 8 and 95 7 the difference being that the high frequencies are well defined especially in the ffl the ffnl fb has the best attenuation of the controllers at 99 3 and the same frequency of the vessel movement the wob is shown in fig 7 with a delay of approximately 2 5 s the wob with phc has a variation of up to 150 kn and the civ phenomenon is well defined the phc is unable to guarantee that the drill bit is always in contact with formation because there are time intervals with wob greater than zero which physically means that the drill bit would be free hatleskog and dunnigan 2007b on the contrary all controllers are able to maintain the wob the wob variation obtained with the fb control is 35 kn and is almost a perfect sine wave which is proved by its fourier transformation in fig 8 which shows that its main component is the frequency of the ship movement 1 rad s thus the factor f x h has a low value of 52 7 which is the smallest value obtained by the controllers this is explained in fig 5 in which the attenuation of the fb and the phc are similar close to the frequency of 1 25 rad s however the factor f c i v is 94 7 indicating that the civ is highly attenuated with this controller another favorable point of this controller is that it has high attenuation at the compensator resonance points fig 5 not only for high frequencies since in the case of the first system mode 0 6 rad s its attenuation is 98 and it is better than the attenuation of the two feedforwards at this frequency the ffl has an attenuation of 95 8 a factor f x h of 98 5 but it presents a wob variation of 61 kn with high frequencies caused by the civ which is evidenced by the low value of factor f c i v of 12 this is the lowest value among the proposed controllers therefore the ffl control has an ideal response for the low frequencies but that in the case of high frequencies the performance deteriorates by 86 in relation to the low frequencies further accentuating the perception of the civ in the active control for the civ of hatleskog and dunnigan 2012 the response with ffl also presents civ and its wob variation is 14 kn and its attenuation of the wob variation is 90 in comparison to the wob variation with the phc however it is not said if the input frequency is exactly triggered by the civ as in this study case although the attenuations of the crown block motion are similar for the two feedforward controls 95 7 and 95 8 the ffnl has a wob variation 73 less than the ffl and its performance is similar for low and high frequencies as indicated by the factors values f c i v 88 4 and f x h 89 8 thus the ffnl response to the civ is 76 better than the ffl and this control mitigates the civ but it does not completely cancel it the ffnl fb showed the best response its parameters are an attenuation of 99 3 and a wob variation of 4 kn and factor f x h of 93 8 the values of these three parameters are better than those obtained with the other controllers and the civ is nearly eliminated with a factor f c i v of 99 5 so the civ frequencies are slightly perceptible in wob which is dominated by the vessel motion frequency the data from the four proposed controllers and the phc are summarized in table 1 fig 9 shows the control signal of the four controllers the control signal of ffnl fb is well behaved and similar to the dynamic force developed by the phc see the first part of this two part article this signal has rapid changes only at the point of sign variation of the seal friction and does not show the high frequency oscillations of the civ this is an important result because there was the possibility of eliminating the civ in wob but as a consequence its high frequencies could be in the control signal 4 2 control results for a platform heave motion caused by ocean wave the same analysis made for the movement that generates the civ is realized for the ship heave movement caused by a sea wave which is presented in fig 10 a and it is composed of different frequencies and amplitudes as indicated by its fourier transformation in fig 10 b the controllers are the same as in section 4 1 the same conditions and parameters to evaluate their performances the first two parameters that evaluate the control performance of section 4 1 the attenuation and the variation of wob are maintained the other two parameters f x h and f c i v are replaced by the factors f w l o w and f w h i g h since as the ship wave consists of many frequencies there is not just one civ frequency these parameters are based on the factor f w of eq 10 which is defined as the percentage attenuation of the area under the wob variation curve between the frequencies  1 and  2 that are obtained with control in relation to those obtained with the phc the fourier transformation of the wob variation is used to calculate numerically this integral value factor fw low for the frequency  1 0 and the maximum frequency of the platform motion  2 3 5 rad s which corresponds to the maximum frequency of the heave motion presented in fig 10 factor fw high is equivalent to the factor f c i v of the above subsection which evaluates the control performance in high frequencies from  1 3 5 rad s to  2 10 rad s 10 f w 100 1  1  2  w o b c o n t r o l  d   1  2  w o b p h c  d  fig 11 shows the movement of the crown block for the four controllers and the phc the phc attenuation is 57 and the ffl has the lowest attenuation of the controllers 88 9 the ffnl and fb has almost the same attenuation 95 these values are in the range expected for an hhc around 95 hatleskog and dunnigan 2007a gonzalez et al 2019 and odp 2012 whereas the ffl fb is evidently better with a 99 4 attenuation similar to the 99 9 value of a nonlinear hhc with a contact drill ottestad et al 2010 only one article was found with a perfect decoupling which refers to a hhc with a drill bit in contact and its passive part which is a linear absorber korde 1998 the proposed controller has an attenuation value comparable to that obtained by semiactive controllers for non contact operations 90 sanchez et al 2017 and 97 liu et al 2015 it is observed in fig 12 that the phc is not able to keep the contact boundary condition for the drill bit which is lifted on five occasions as a result the wob variations are 140 kn almost double that of the desired wob value in addition the oscillations of the wob variation have high frequencies greater than 3 5 rad s this is corroborated by the fourier transformation in fig 13 at these frequencies there are peaks with a magnitude between 8 kn and 10 kn because as the wave is constituted by a spectrum rich in frequencies so the civ phenomenon occurs for different modes of the column with different harmonics of the seal friction force the fb has a large wob variation of 51 kn but it has a better response for the high frequencies than the feedforwards its factor f w h i g h is 80 and for the feedforwards are 6 and 77 the highest value of the high frequency peaks of the fourier transformation is 1 8 kn whereas the feedforwards nonlinear present 2 8 kn however its low frequency response has the lowest performance its factor f w l o w is 62 the ffl only attenuates 6 1 of the high frequencies produced by the civ phenomenon and its attenuation in low frequencies is 54 8 these low attenuations yield a wob variation of 98 6 kn causing a loss of contact between the formation and the drill bit see fig 12 at 41 s the ffnl has an acceptable performance and it is reflected in the terms of its value factors f w l o w of 72 and f w h i g h of 77 again the ffnl fb presents the best response in all parameters with an attenuation and a wob variation similar to the previous result of the civ with control 99 4 and 5 kn the improvement over the other controllers is considerable especially at high frequencies its factor f w h i g h is 96 whereas the factor for fb is 80 and for feedforwards 6 and 77 at low frequencies the factor f w l o w is 80 the data are summarized in table 2 the controllers can mitigate the civ without inducing high frequency oscillations in the control signal as presented in fig 14 aalerud and klevmo 2013 determined that the fb does not considerably increase the performance of the ffnl controller when the drill string has low stiffness long drill string due to very low gains of the pi required to the fb controller which was designed through an on line tuning method called the good gain method the authors also suggested that this limitation would be addressed if the fb parameters were automatically adjusted according to the length of the drill the proposed fb is designed considering the drill string model which implicitly considers its stiffness thus this fb combined with the ffnl improved the ffnl performance in all evaluation control parameters see tables 1 and 2 as was supposed by aalerud and klevmo 2013 5 measure noise in this section to demonstrate our control efficiency in the presence of measure noise white noises are introduced in the measurements and two filters are included to mitigate them the diagram schematic of fig 15 introduces noises and filters the white noises  are applied on the position and the speed of ship their standard deviations are 15 mm and 15 mm s respectively each one of these measurements are filtered by one butterworth filter bf and the filtered signals are the inputs of the ff controller on the other hand the standard deviation of the white noise  introduced in the crown block position is 0 5 mm and a kalman filter kf is used to estimate the variable used by the fb controller 5 1 butterworth filter bf the bf first introduced by butterworth et al 1930 is one of the most popular analog filters and its pass band frequency is almost flat its design is well detailed in van valkenburg 2001 and laghari et al 2014 a low pass bf of third order is used and its parameters are calculated to have a cutoff frequency of 50 rad s which was heuristically chosen based on two criteria to filter the frequencies that can trigger the seal friction of the ffnl and to avoid introducing a high phase delay between noisy and filtered signals 5 2 kalman filter kf the kf proposed by kalman 1960 has played a crucial role in many industrial applications an introduction to the general idea of the kf can be found in welch et al 1995 while a more extensive reference can be consulted in brown and hwang 2012 the problem of heave motion estimation was faced using a kf in cuellar et al 2017 and linhares et al 2016 lainiotis et al 1993 has concluded that kf provides the optimal solution when the model which describes the physical phenomenon is completely known in this application a perfect model is not required considering that the reduced order model obtained in section 2 represents the main behavior therefore the kf is well suitable for this application because the perturbation part that is not canceled by the ff exhibits a rich frequency spectrum kf parameters are fixed as sample time 0 001 s measure noise standard deviation of  0 5 mm r  2 perturbation variance q  2 1 0 3 and the internal model of kf is the one presented in eq 1 5 3 numerical results with measure noise the numerical results with measure noise are set out in table 3 the ffnl fb continues to have the best performance as in the noiseless case for this reason only a comparison between the ffnl fb with and without measure noise is presented the figures of this section in fig 16 a the noise measure produced a degradation of ffnl heave attenuation from 99 4 to 95 8 lower attenuation values have been previously reported for non contact operations by cuellar et al 2017 and linhares et al 2016 91 and 85 the control signals of fig 16 b are suitable for implementation due to the smaller noise transmitted to the system through them the main difference with the noiseless case is that small oscillations are presented when there is a change of speed direction fig 17 a shows that the wob variation of ffnl fb with measure noise is 8 3 kn having an increment of 3 kn in relation to the noiseless case this increment is mainly caused by the performance degradation in high frequencies as is seen in fig 17 b and corroborated by the low variation of f w l o w from 80 2 to 78 36 and the high variation of f w h i g h from 96 6 to 88 3 6 conclusions in this work a comparison of four control strategies have been presented for ahc a linear feedforward ffl used as a benchmarking a nonlinear feedforward ffnl which is designed taking into account the friction seal a feedback fb controller based on the crone methodology and a combination of ffnl and fb control performances were validated through simulation of the drill string of 12 km with a phc the ffnl fb control is proposed with a nonlinear feedforward crone feedback and an actuator that provides an accurate control command force the feedforward addressed the nonlinearities of the phc and the presented crone feedback is a robust answer to civ and the residual heave displacement due to difference between feedforward control and real plant forces the ffnl fb performance is the best in all parameters attenuation of 99 4 wob variation between 4 kn and 5 kn and the civ highly mitigated with factors f c i v of 99 and f w h i g h of 96 so the proposed solution is a robust and efficient controller to attenuate heave motion and the civ phenomenon the controllers ffnl fb and ffnl guarantee the operation condition of the drill bit in contact w o b 0 whereas the phc and the ffl are not able to ensure it ffl control which is usually used for heave control in offshore industry has the lowest attenuation of the civ phenomenon among the tested controllers regarding the attenuation factor of high frequencies f w h i g h which are between 2 and 12 even the imperfect ffnl has better results of the ffl in almost all the evaluation control parameters the proposed controllers were implemented with filters kf and bf commonly used by the industry to address the measure noise the largest degradation of control performance is presented in the civ attenuation even so ffnl fb is highly reduced this phenomenon f w h i g h of 88 and the heave attenuation is also maintained in an acceptable value 95 the crone feedback controller was designed using the reduced plant only 3 modes nevertheless it was tested in the full model indicating the pertinence of the modal reduction and control robustness it was shown that the high attenuation of the civ in ffnl fb is provided largely by the fb which takes into account the high vibration modes of the system this approach may be employed to mitigate the frequencies that are higher than the frequencies of the input wave in heave compensation regardless of whether it was produced by seal friction or by other causes as for example the high frequencies presented in the hhc experiment developed by niu et al 2019 future work is expected to include the actuator model in the validation model and consider its dynamic in the controller design furthermore it is expected to design an experiment of hhc with a drill string to test the proposed controllers credit authorship contribution statement william humberto cullar snchez formal analysis investigation methodology writing original draft writing review editing eugnio librio feitosa fortaleza formal analysis investigation methodology supervision writing original draft writing review editing andr benine neto formal analysis investigation methodology supervision writing original draft writing review editing jos alfredo ruiz vargas formal analysis investigation methodology supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge the brazilian institutions cnpq brazil cape brazil fapdf petrobras through prh pb 223 for supporting the present study 
20888,in this paper a structural health monitoring strategy that performs in time multi axial fatigue damage evaluations for welded tubular joints is proposed first we developed a stress monitoring program that obtains the reference for the multi axial fatigue strength assessment namely the components of the hot spot stress and zero point structural stress from a sensor arrangement strategy representing explicit physical meaning for tubular t joints then we established a programmable procedure for multi axial fatigue damage evaluation based on stress monitoring which is verified through a finite element simulation taking practical interests into consideration we suggest that the proposed strategy is suitable for in field engineering practice keywords multi axial fatigue structural health monitoring stress monitoring fatigue damage evaluation welded tubular joint nomenclature c n c n c n  the coefficient between the measured value of axial stress  n and the stress components of hot spot stress state  hs  hs and  hs c n d t c n d t c n  d t distribution along scl for coefficient between the measured value of axial stress  n and the stress components of stress state    c mip c mip c mip  the coefficient between the measured in plane bending stress difference  mip and the stress components of hot spot stress state  hs  hs and  hs c mip d t c mip d t c mip  d t distribution along scl for coefficient between the measured in plane bending stress difference  mip and the stress components of stress state    c mop c mop c mop  the coefficient between the measured out of plane bending stress difference  mop and the stress components of hot spot stress state  hs  hs and  hs c mop d t c mop d t c mop  d t distribution along scl for coefficient between the measured out of plane bending stress difference  mop and the stress components of stress state    c the coefficient matrix of measured values and the stress components of hot spot stress state c d t distribution along scl for the coefficient matrix of measured values and the stress components d external diameter of chord d external diameter of brace d t the ratio between the distance to the structure surface of given location on scl and the wall thickness f ax axial loading f r cp enhancement factor hss hot spot stress k negative inverse slope of the uniaxial fatigue curve k 0 negative inverse slope of the torsional fatigue curve k  modified whler curve s negative inverse slope l brace length from center of brace end to crown position l chord length n a reference number of cycles to failure n f number of cycles to failure n f i fatigue life extrapolated at reference shear stress range  i n kp number of cycles to failure defining the position of the knee point mv the direction that experiencing the maximum variance of the resolved shear stress m ip in plane bending moment m op out of plane bending moment r cp critical plane load ratio scl stress classification line t chord thickness t brace thickness plate thickness zp zero point a position in the wall thickness direction where the nonlinear stress peak decreases to zero zpss zero point structural stress the structural stress at zero point  plane in axial of scl u nom diameter of the circular path in comb loading  a range of the reference normal stress at n a cycles to failure  mip  mip n the measured value of in plane bending stress difference and its nominal quantity  mop  mop n the measured value of out of plane bending stress difference and its nominal quantity  n normal stress range relative to the critical plane  shear stress range relative to the critical plane  a range of the reference shear stress at n a cycles to failure  i individual reference shear stress range  ref reference shear stress range relative to the critical plane  angle measured around intersection from crow position indicating loading direction with respect to the structure  w critical plane stress ratio  w lim limit value for the critical plane stress ratio  b bending stress  hs  hs  hs the stress components of hot spot stress state i e normal stress perpendicular and parallel to the weld bead and the corresponding shear stress  ln local notch stress  m membrane stress  nlp nonlinear peak stress  n  n n the measured value of axial stress and its nominal quantity  n a amplitude of the stress perpendicular to the critical plane  n m mean stress perpendicular to the critical plane  zp  zp t normal the stress components of zpss perpendicular to the weld bead and its time history    the stress components of stress state i e normal stress perpendicular and parallel to the weld bead and the corresponding shear stress  d t  d t  d t distribution alone scl of the stress components   and   x the local notch stress distribution from x 0 at surface to x t at through plate thickness  mv t instantaneous value of the shear stress resolved along mv  zp  zp t shear the stress components of zpss parallel to the weld bead and its time history  angle measured around intersection from crow position 1 introduction fatigue damage has been one of the most common modes of in service failure in tubular joints of offshore structures especially in harsh environments the main causes of fatigue damage are that the geometry of the connections and welds produces high stress concentrations in the intersection area and these offshore structures are frequently subjected to cyclic loading caused by waves and winds dong et al 2011 dong and hong 2012 maheswaran and siriwardane 2016 thvenet et al 2013 in existing rules and guides abs 2005 dnvgl 2016 the spectral based method is mainly recommended for the fatigue assessment of offshore structures the key to fatigue analyses is to accurately obtain the long term distribution of the stress at welded joints however there are two limitations of the spectral method in the stress calculation one limitation is that the spectral method assumes that the relationship between the wave height and the wave induced loads is linear which is not in accord with actual wave loads the other limitation is the error of numerically calculated stresses at welded joints caused by the simplification of finite element fe models and boundary conditions the accumulation of various errors in fe analyses will make the calculated stress inconsistent with the true stress response of welded joints therefore the estimated fatigue lives by using the spectral method may be much different from the actual fatigue lives of welded joints to ensure the safety of the engineering structures during service it is important to monitor the stress strain state at critical locations and assess the fatigue lives of the structures based on monitoring data in recent years structural health monitoring shm has been widely used in engineering structures compared to the numerical analysis of structural responses a large amount of hydrodynamic calculations and fe analyses of the structures are not required in shm and the structural responses directly measured by sensors are considered to be more accurate than the numerical results mondoro et al 2016 used shm data to assess the fatigue life of a high speed aluminium catamaran strain gauges were installed at the high stress areas indicated in the fe analysis results with the goal of providing stress data at the fatigue critical details the stress concentration responses determined through the conversion of strain gauge data were directly used for the fatigue life calculation with both time domain and spectral based methods leander et al 2010 performed a monitoring program to study the differences between theoretical calculations and the inspected reality in the fatigue life assessment of a steel railway bridge in the monitoring program strain gauges were placed on the web of the main beam to measure strains and a quadratic extrapolation method was used to calculate the hot spot stress hss according to recommendations in the international institute of welding chan et al 2001 carried out a fatigue analysis and life prediction of bridges with shm data in which strain gauges were installed to measure the nominal stresses at bridge deck sections and the hss was calculated at the weld toe by considering some related factors affecting the hss such as the stress concentration factor in the vicinity of the weld due to geometric discontinuities the factor for the stress distribution at the weld toe and the factor that expresses the influence of the residual stress due to welding ye et al 2019 proposed a master s n curve based fatigue life assessment of welded joints in a steel bridge based on an fe analysis and shm data fibre bragg grating sensors were installed on both the top and bottom surfaces of specific critical joints so that the membrane stress bending stress and structural stress of the joints could be calculated through the measured stresses in the proposed method the structural stress was used in the fatigue life assessment which provided an effective method when the nominal stress of the welded joints was hard to define however the abovementioned methods of stress monitoring are only for the uniaxial fatigue life assessment of welded structures due to the complex and variable loads experienced during the service of welded structures critical locations of the structures are often in a multi axial stress state even if the structure is subjected to uniaxial loading the local stress state at the welded joints is usually multi axial due to the complex geometry of the welded structures the methods of fatigue life assessment widely used in engineering are based on uniaxial fatigue tests and theoretical assumptions which often result in a large dispersion of the calculated fatigue lives of actual complex structures therefore if a fatigue life assessment method based on multi axial fatigue theory can be used in the shm the estimated results will be more accurate in early multi axial fatigue studies many research efforts were devoted to estimating multi axial fatigue life by using uniaxial fatigue theory when a welded structure is subjected to proportional multi axial loading the stress state can be reduced to an equivalent stress based on conventional hypotheses cen 2014 hobbacher 1996 sonsino 2009a b however the equivalent stress method is not suitable for fatigue life assessment under nonproportional loading the energy based criterion for multi axial fatigue failure has been proposed for proportional or nearly proportional loading but it is also not suitable for non proportional loading ellyin and golos 1988 macha and sonsino 1999 in addition the energy based criterion is hard to use in the shm because of the difficulty associated with measuring the energy absorbed by the structure thvenet et al 2013 carried out a numerical analysis and fatigue tests for the fatigue strength assessment of tubular welded t joints subjected to combined loadings in which a pragmatic approach based on the dang van criterion fayard et al 1996 was developed to take into account the multi axial stress state at the weld toe comparisons between the experimental and numerical results showed that the application of a multi axial fatigue criterion for the fatigue design of welded joints appears to be completely suitable and taking into account the multi axial stress state indeed makes it possible to considerably improve lifetime predictions the critical plane approach has been widely applied to the multi axial fatigue problem there are different models with different definitions of the critical plane but the methodology is the same a critical plane based criterion was applied to fatigue life estimation of fillet welded tubular t joints subjected to multi axial loading by carpinteri et al 2017 both experimental strain measurements on the t joints and fe analysis of the welded structure were performed which verified the applicability of the proposed stress based approach to multi axial fatigue strength assessment of tubular t joints susmel and tovo 2004 proposed the modified whler curve method mwcm which takes the shear stress range and the ratio of the normal and shear stress range on the critical plane as parameters in the multi axial fatigue assessment the multi axial fatigue s n curve in this method is calibrated by the uniaxial tension and torsion fatigue curve in standard codes in this way the method can take into account both the shear and normal stresses together rather than just the normal stress in uniaxial fatigue methods the mwcm has been used to estimate the multi axial fatigue life of welded joints and the results show that it is much more accurate than the procedure proposed by eurocode 3 under both proportional and non proportional loading susmel 2009a applied the mwcm in terms of both nominal structural and local stresses to estimate the multi axial fatigue damage in welded joints the three ways of applying the mwcm suggest to be highly accurate and reliable by using experimental results taken from the literature and generated by testing steel and aluminium welded details the stress monitoring programs in existing engineering practice are designed for performing uniaxial fatigue life assessments but are not necessarily applicable to multi axial fatigue theories in this article focusing on tubular joints a multi axial fatigue oriented monitoring strategy is proposed to perform in time fatigue damage evaluations directly from stress monitoring data using multi axial fatigue damage theories first two stress monitoring programs are developed to obtain the hot spot stress and zero point structural stress zpss liu et al 2014 subsequently a multi axial fatigue damage evaluation procedure is established by applying the mwcm based on structural monitoring finally a case study on the proposed multi axial fatigue damage evaluation based on monitoring is investigated the stress monitoring program proposed in this article has explicit physical meaning and can also be suitable for in field engineering practice 2 stress monitoring program in terms of the hss the hss approach has been widely used in engineering designs compared to the nominal stress approach the hss approach utilizes more accurate stress analysis for different types of welded joints and has higher precision and more extensive applicability for complex structures compared to the notch stress approach the hss approach does not consider the local stress concentration caused by the weld toe itself and hence avoids the difficulty of determining the local geometry of the weld toe therefore the hss approach has been the most favourable option due to both its accuracy and applicability in engineering designs 2 1 sensor arrangement strategy for tubular t joints fig 1 shows the dimensions of a welded tubular t joint the crown and saddle positions along the chord brace intersection of the joint are located at points where the angular positions are  0 and  270 respectively to obtain the stress distribution along the weld toe a total of 16 hot spot positions are selected on both the chord and brace sides along the intersection where  k 45 k 0 1 7 since sea states are multidirectional tubular joints are usually subjected to multi axial loading which can be separated into three basic components axial loading f ax in plane bending moment m ip and out of plane bending moment m op in this paper multi axial loading is considered as a combination of the three basic components the nominal stress is obtained using general theories such as beam theory therefore the distinctive characteristics of the nominal stress in a structural component under each basic loading condition can be used to distinguish the existence and the effect of the basic loading components in the case of applied multi axial loading to quantify the magnitude of each basic loading component the arrangement of the sensors should comply with the characteristics of the corresponding nominal stress components according to general theories the distribution of the normal stress parallel to the brace axis in the brace tube cross section under each basic loading is shown in fig 2 in light of the distinctive characteristics of the normal stress distribution an array of four sensors is equally distributed over the entire circumference of the brace tube section where  k 90 k 0 1 2 3 the strain gauge sensors are installed on the outer surface of the brace tube along the brace axis direction to the measure normal stresses    in this direction furthermore three measured values are defined in accordance with the internal forces on the brace tube section to quantitatively reflect the effect of each nominal stress component the three measured values namely the measured value of the axial stress  n measured value of the in plane bending stress difference  mip and measured value of the out of plane bending stress difference  mop as well as their nominal quantities  n n  mip n and  mop n are expressed as follows 1  n   0   90   180   270 4 2   mip   0   90 3   mop   90   270 4  n n 4 f ax  d 2 d 2 t 2 5   mip n 64 m ip d  d 4 d 2 t 4 6   mop n 64 m op d  d 4 d 2 t 4 2 2 monitoring data processing strategy for obtaining the hss the hss is defined as the maximum principal stress of the structural stress at the weld toe tomkins 1984 which essentially describes the stress state at the hot spot when using the hss in traditional uniaxial fatigue theory fatigue damage is often evaluated only based on the magnitude of the hss however considering the multi axial stress state at the weld joints changes in the magnitude and direction of the hss are likely to be more complicated therefore obtaining a complete hot spot stress state would be beneficial when applying multi axial fatigue damage theories when a tubular joint is subject to multi axial loading the response corresponding to each basic loading component is linearly independent of each other while their linear superposition constitutes the response of the tubular joint similarly the hot spot stress state at a certain hot spot of the tubular joint under multi axial loading is also a summation of the hot spot stress states corresponding to each of the basic loading components with the help of the sensors arranged as proposed above three measured values quantify the magnitude of the corresponding nominal stress component additionally the nominal stress components reflect the corresponding basic loading component of a multi axial loading therefore by determining under each basic loading a proportional relation between the hot spot stress state and nominal stress the hot spot stress state corresponding to each basic loading component of multi axial loading can be determined since nominal stresses are obtained from monitoring for a tubular joint being monitored under multi axial loading the hot spot stress state at a certain hot spot is a summation of hot spot stress states that are calculated from values of monitoring obtained nominal stresses which is the monitoring data processing strategy to obtain the hss fig 3 a schematically shows the strategy followed to calculate the hss at the weld toe in a linear extrapolation manner for the investigated tubular joints in more detail each stress component namely the normal stresses perpendicular and parallel to the weld bead  and  or the corresponding shear stress  is individually extrapolated at the weld toe by using the reference stress of the positions at a distance from the hot spot equal to 0 5t and 1 5t where t is the plate thickness the reference stresses used to extrapolate the hot spot quantities are the element component stresses obtained for the element s surface that is on the plane containing the line along the weld toe in the fe analysis then the extrapolated stress components are used to compute the maximum principal stress at the weld toe which is calculating the hss from the hot spot stress state the three stress components  hs  hs and  hs that constitute the hot spot stress state are linearly independent therefore by determining a proportional relation between the individual stress component and nominal stress the relation between the hot spot stress state and nominal stress is established for each hot spot location the relation between the measured values and stress components of the hot spot stress state can be defined as 7 c n c mip c mop c n c mip c mop c n  c mip  c mop   n   mip   mop  hs  hs  hs where the coefficient matrix of the measured values and stress components of the hot spot stress state can be denoted as 8 c c n c mip c mop c n c mip c mop c n  c mip  c mop  since the response corresponding to each basic loading component is linearly independent of each other for the tubular joint the three vectors of measured values  n  mip  mop t as well as the three vectors of hot spot stress components  hs  hs  hs t obtained under each unit basic loading are considered to be two sets of base vectors of the vector space and c can be calculated as their transition matrix when applying the monitoring program on a tubular joint under multi axial loading for any given time measured values  n  mip and  mop can be obtained from the monitoring data of the strain gauge sensors and then the hot spot stress components  hs  hs and  hs are calculated from eq 7 such a process produces accurate in time hss values that are required in fatigue damage assessment which constitutes the monitoring data processing strategy obtaining the hss for the structure of interest under multi axial loading 3 stress monitoring program in terms of zpss the hss approach can be used for the multi axial fatigue analysis in combination with the mwcm however calculation of the hss by the stress extrapolation on the plate surface makes the hss approach only suitable for simple welded joints for complex welded joints the multi axial stress states in the vicinity of the critical sites can be generated by either the remote loading or the geometry itself the shear and nominal stresses on the critical plane are difficult to differentiate in advance another limitation of the hss approach is that only the surface stress is considered for the fatigue life assessment it has been found that the stress gradient of the plate thickness also influences the fatigue life lotsberg and sigurdsson 2006 which cannot be considered in the hss approach liu et al 2014 proposed the zpss approach for the multi axial fatigue life assessment of complex welded joints the main advantage of the zpss approach is that the maximum shear stress range and the range of the stress perpendicular to the critical plane can be directly calculated by postprocessing the fe results moreover the zpss approach has higher accuracy than the hss approach when the shell bending stress is dominant over the plate thickness because the effect of the stress gradient on the fatigue life can be taken into account in the former in this paper the stress monitoring program in terms of the zpss is also proposed for the multi axial fatigue assessment of complex welded joints in engineering 3 1 zpss approach as shown in fig 4 the local notch stress  ln at the weld toe consists of three components the membrane stress  m shell bending stress  b and nonlinear stress peak due to the notch effect of the weld  nlp the membrane stress  m is equal to the average stress calculated through the thickness of the plate which is constant through the thickness the shell bending stress  b is linearly distributed through the thickness of the plate the gradient of the shell bending stress is chosen such that the remaining nonlinearly distributed component is in self equilibrium hobbacher 1996 the stress components can be expressed as 9  m 1 t 0 t  x d x 10  b 6 t 2 0 t  x t 2 x d x 11  nlp x  x  m 1 2 x t  b where t is the plate thickness  x is the local notch stress distribution from x 0 at the surface to x t at the through plate thickness the structural stress at a weld toe consists of the membrane stress and shell bending stress and equilibrates the external loading the nonlinear distributed peak stress has no contribution to bear the external loading for the self equilibrium property there must be a point in the wall thickness direction where the value of the nonlinear peak stress decreases to zero liu et al 2014 defined this point as the zero point zp the real notch stress is equal to the structural stress at zp which avoids the notch effect of the weld toe the structural stress at the zp is defined as the zpss based on the basic idea of the hss approach that excludes the nonlinear peak stress from the local notch stress the zpss is taken as a reference for the fatigue life assessment of welded joints if the structural stress distribution curve and the local notch stress distribution curve through the wall thickness are known the zp can be located by finding the intersection of the two curves from numerical results of the notch stress distribution through wall thickness it has been found that the zp is just below and very close to the hot spot on the structure surface when the shell bending stress is included in the notch stress distribution the zpss will be slightly smaller than the hss on the structure surface due to the gradient of the shell bending stress itself therefore the effect of the stress gradient on the fatigue life can be considered to a certain extent in the zpss approach in this paper the stress classification line scl defined in asme 2004 is adopted in the zpss approach for the fatigue strength assessment of tubular joints as shown in fig 5 a the scl is set at the weld toe perpendicular to the tube surface along the wall thickness the notch stress perpendicular to the scl is taken for the zpss calculation at a given angular position along the intersection to specify the plane  where the calculated zpss achieves its peak value the zpss on 360 planes in the axial direction of the scl with an interval of 1 is calculated and the maximum value is selected as the zpss at this angular position as shown in fig 5 b based on the fe results of the stress analysis the procedure of the zpss calculation at a given angular position is described as follows liu et al 2015 1 the stress tensors of all the nodes along the scl are directly obtained from fe analysis 2 according to elastic mechanics the normal stress distribution  n x and the shear stress distribution  x are calculated on a given plane 3 the structural stress  ss and the nonlinear stress peak  nlp are calculated using eqs 9 11 to obtain the positions of the zp and zpss on the given plane 4 according to step 2 and step 3 the zpss on all the planes in the axial scl is calculated and the maximum value of the zpss as well as its corresponding zp are selected as the final results at this given angular position in order to take better advantage of the zpss approach whether the fatigue loading is multi axial or uniaxial as soon as the zpss is calculated it is recommended that mwcm shall be applied to obtain the fatigue curve and to conduct fatigue damage evaluation which will be presented in section 4 in great detail 3 2 monitoring data processing strategy for obtaining the zpss the zpss a resolved stress at the zp along a certain direction perpendicular to the scl is a structural stress vector located at the zp since the stress response corresponding to each basic loading component is linearly independent of each other for a tubular joint the zpss corresponding to each basic loading component is a structural stress vector located at different zps from each other with different magnitudes and directions therefore the vector summation of the zpss under each of the basic loading components similar to that adopted in the monitoring data processing strategy for obtaining the hss would certainly not result in the zpss for the tubular joint under multi axial loading by definition the value of zpss depends on the location of the zp while the location of the zp depends on the stress distribution along the scl for a tubular joint under multi axial loading the stress distribution along the scl at a certain hot spot is a linear superposition of the stress distributions along the scl under each of the basic loading components therefore for monitoring data processing the calculation of the zpss under multi axial loading can be decomposed into two steps obtaining the stress distribution along the scl and locating the zp with the help of the sensors arranged as proposed in 2 1 three measured values quantify the magnitude of the corresponding nominal stress component based on the fact that the response corresponding to each basic loading component is linearly independent of each other similar to that adopted in the monitoring data processing strategy for obtaining the hss by determining under each basic loading a proportional relation between the stress distribution along the scl and nominal stress the stress distribution along the scl under multi axial loading can easily be determined this process converts monitoring obtained nominal stresses into the stress distribution along the scl which is the first step of the monitoring data processing strategy to obtain the zpss according to the zpss calculation procedure stress tensors of all nodes along the scl at the weld toe are required to obtain the stress distribution along the scl since the normal stress distribution on a given plane  is the analysed stress quantity to locate the zp only the stress components relative to the planes perpendicular to the scl are required to determine the stress distribution along the scl namely the normal stress perpendicular and parallel to the weld bead  and  and the shear stress parallel to the weld bead  by transforming the stress tensors into a cartesian coordinate system with the scl and chord brace intersecting line tangent directions as axes stress components   and  are obtained and the 6 independent components of a stress tensor required to obtain the zpss are reduced to 3 similar to that proposed in section 2 2 the relation between the measured values and distribution along the scl of the stress components   and  can be defined as 12 c n d t c mip d t c mop d t c n d t c mip d t c mop d t c n  d t c mip  d t c mop  d t  n   mip   mop  d t  d t  d t where d t is the ratio between the distance to the structure surface of a given location on the scl and the wall thickness 0 d t 1 the coefficient matrix of the measured values and the stress components varies with d t and the distribution along the scl of the coefficient matrix can be denoted as 13 c d t c n d t c mip d t c mop d t c n d t c mip d t c mop d t c n  d t c mip  d t c mop  d t when calculating the coefficient matrix c d t for any point on the scl the three vectors of measured values  n  mip  mop t as well as the three vectors of stress components    t obtained under each unit basic loading are considered to be two sets of base vectors of the vector space and c d t can be calculated as their transition matrix when applying the monitoring program on a tubular joint under multi axial loading for any given time the measured values  n  mip and  mop can be obtained from the monitoring data of the strain gauge sensors and then the distribution along the scl of the stress components   and  are calculated from eq 12 subsequently the zpss of the given time can be obtained according to the procedure of the zpss calculation such a process produces accurate in time zpss values that are required in fatigue damage assessment which constitutes the monitoring data processing strategy for obtaining the zpss for the structure of interest under multi axial loading 4 multi axial fatigue damage evaluation applying the mwcm based on structural monitoring the mwcm based on the critical plane approach has higher accuracy in the multi axial fatigue life assessment and is convenient for engineering applications susmel 2009a 2014 in this paper the mwcm is applied to develop a procedure for the multi axial fatigue life assessment of welded tubular joints in terms of the hss and zpss monitoring programs 4 1 the modified whler curve method the mwcm assumes that the material plane on which the probability of having the crack initiation phenomenon reaches its maximum value under multi axial cyclic loading is the plane experiencing the maximum shear stress range  susmel et al 2009 the initiation and propagation phenomena are also influenced by the stress component perpendicular to the assumed crack initiation plane susmel 2009b the complexity of the stress state at the assumed critical point is hypothesized to be taken into account by combining the shear stress range  and normal stress range  n relative to the critical plane through the following stress ratio 14  w   n   the ratio  w is capable of giving an engineering measurement of the complexity of the assessed stress state in particular under fully reversed uniaxial fatigue loading  w is equal to unity whereas under fully reversed torsional fatigue loading  w is invariably equal to zero susmel et al 2009 the mwcm estimates the fatigue life using a log log modified whler diagram of the shear stress range relative to the critical plane  against the number of cycles to failure n f as sketched in fig 6 the fatigue curve obtained in the modified whler diagram varies with the ratio  w and is specifically characterized by the negative inverse slope k   w and the reference shear stress range  ref  w extrapolated at n a cycles to failure since the experimental fatigue curves that are usually available are those generated under both uniaxial  w 1 and torsional  w 0 fatigue loading the position of any other modified whler curve has to be estimated according to the following linear reactions susmel 2009b 2014 15 k   w k k 0  w k 0  w 1 n f n kp k   w k  w 1 n f n kp 16   ref  w   a 2   a  w   a  w  w lim   ref  w   ref  w lim  w  w lim where k and k 0 are the negative inverse slopes of the uniaxial and torsional fatigue curves respectively and  a and  a are the ranges of the corresponding reference stresses extrapolated at n a cycles to failure n kp is the number of cycles to failure that defines the position of the knee point taken at 108  w lim is a threshold value considering that fatigue damage is no longer solely shear stress governed when critical planes experience large values of the ratio  w assuming that the reference shear stress  ref  w is constant and equal to  ref  w lim for those modified whler curves with a ratio  w larger than the threshold value determined as 17  w lim   a 2   a   a for n f n kp the slope of the modified whler curves under constant amplitude loading is suggested to be taken invariably equal to 22 holding true independently from the actual value of the  w ratio relative to the critical plane under investigation sonsino 2009a b when applying the mwcm to perform a multi axial fatigue assessment as soon as the shear stress range  is known the lifetime can be directly estimated since the modified whler curve with ratio  w is unambiguously defined 4 2 stress components relative to the critical plane under multi axial non proportional fatigue loading in the mwcm 4 2 1 mwcm applied in terms of the hss when applying the mwcm in terms of the hss it is required to use the geometrical stress components perpendicular and parallel to the weld bead namely  hs and  hs in fig 3 for determining the maximum shear stress range as well as the range of the stress perpendicular to the critical plane susmel 2009a the above requirement is suggested in performing multi axial fatigue assessment of weldments because when engineering materials are weakened by notches having opening angles larger than approximately 100 the fatigue strength is observed to depend mainly on the mode i and iii stress components however the contribution of mode ii loading to the overall fatigue damage can be neglected without much loss of accuracy because the resulting stress components are not singular considering the way that they are defined the values of the geometrical stresses depend on the distribution of the linear elastic stress field in the vicinity of the hot spots therefore the structural stress components perpendicular to the weld bead are related to the mode i stress components whereas the structural shear stress components parallel to the weld bead are related to the mode iii stress components in mwcm the maximum variance method mvm is adopted to determine the critical plane susmel 2010 according to the mvm the critical plane can be defined as that plane containing the direction mv mv is a direction passes through the assumed critical point also the direction experiences the maximum variance of the resolved shear stress  mv t since the mvm utilizes statistics of the stress components at the critical location to determine the critical plane it does not depend on the length of the input load history and is considered to be efficient and reliable in practice bel knani et al 2007 since the stress components used to determine the stress relative to the critical plane namely the hot spot stress components perpendicular and parallel to the weld bead  hs and  hs are in fact parallel to the structural surface the direction mv and the normal direction of the critical plane are consequently parallel to the structural surface therefore by comparing the variance of the resolved shear stress relative to each plane  in the axial scl the plane having the maximum variance of the resolved shear stress is determined as the critical plane and subsequently the shear stress range  and normal stress range  n relative to the critical plane are obtained 4 2 2 mwcm applied in terms of the zpss for engineering practice the maximum principal stress of the geometric stress extrapolated to the weld toe is taken as a reference for the fatigue strength assessment in current recommendations abs 2014 dnvgl 2016 as stated before the value of the zpss comes from geometric stress that considers the effect of the stress gradient and the reference for the fatigue strength assessment is also related to the direction where the geometric stress reaches a maximum in view of the similarities between the handling of geometric stress in estimating the hss and zpss the determination of the stress components relative to the critical plane for the mwcm applied in terms of the zpss performing multi axial fatigue assessment should reference that in terms of the hss the value of the zpss is the structural stress at the point in the wall thickness direction from the hot spot location where the value of the nonlinear peak stress equals zero hence the value of the zpss is highly relevant to the distribution of the linear elastic stress field in the vicinity of the hot spots to describe the mode i and iii stress components that the fatigue strength mainly depends on the structural stress components of zpss that are perpendicular and parallel to the weld bead should be required in more detail the normal stress components of the zpss perpendicular to the weld bead  zp and shear stress components of the zpss parallel to the weld bead  zp are required for determining the maximum shear stress range as well as the range of the stress perpendicular to the critical plane based on the definition of the zpss under multi axial non proportional fatigue loading the position of the zp as well as the magnitude and direction of the zpss at each moment will change continuously with the load since the zpss is taken as a reference for the fatigue life assessment the variation of the position of the zp only represents the variation of the location in the wall thickness direction where the zpss is obtained while the variation of the magnitude and direction of the zpss is what affects the determination of the critical plane and consequently fatigue strength assessment therefore the determination of the critical plane according to the mvm should be a statistical analysis of the stress time histories  zp t and  zp t which are obtained from the time history of the value of zpss when applying the mwcm in terms of the zpss to the perform multi axial fatigue assessment of weldments similar to that in terms of the hss the stress components used to determine the stress relative to the critical plane  zp t and  zp t are parallel to the structural surface therefore by comparing the variance of the resolved shear stress relative to each plane  in the axial scl the plane having the maximum variance of the resolved shear stress is determined as the critical plane and subsequently the shear stress range  and normal stress range  n relative to the critical plane are obtained 4 3 multi axial fatigue damage evaluation based on structural monitoring for a critical fatigue detail of an engineering structure with an implemented stress monitoring program the real time hss or zpss could be obtained from monitoring data processing of the stress data continuously acquired from the arranged sensors according to the stress time history obtained from the monitoring program the modified whler curve as well as the fatigue stress spectrum of the shear stress range relative to the critical plane are obtained and then the multi axial fatigue damage can be calculated according to the palmgren miner linear cumulative damage criterion a flow chart for the multi axial fatigue damage evaluation based on structural monitoring is illustrated in fig 7 the uniaxial and torsional fatigue curves used to calibrate the modified whler curve are supplied by the recommendation of iiw hobbacher 2015 as listed in table 1 the mwcm is proposed to perform the fatigue assessment of weldments working in the as welded condition susmel 2014 to reduce the estimates level of conservatism stress relieved welded joints are recommended to be designed against fatigue by multiplying the reference shear stress range of the adopted modified whler curve by a suitable enhancement factor f r cp hobbacher 2015 for the adjusted reference shear stress range  ref  w f r cp the load ratio r cp is calculated through the stress perpendicular to the critical plane susmel 2008 and the factor f r cp for steel welded joints are calculated as follows susmel et al 2011 18 r cp  n m  n a  n m  n a 19 f r cp 1 32 r cp 1 0 22 r cp 1 1 1 r cp 0 0 22 r cp 1 1 0 r cp 0 5 1 r cp 0 5 where  n m and  n a are the mean value and the amplitude of the normal stress  n respectively for engineering structures with an implemented stress monitoring program the stress gauges cannot acquire the initial stress in the structure that exists before when the sensors are installed on the structure surface the initial stress discussed here is regarded as residual stress that caused by structure construction and it could be introduced by lack of fit during assembly of prefabricated welded components by displacements of abutments or by other loads and displacements occurred during structure construction hence the magnitude and the tension compression attribute of the initial stress is uncertain and the influence of initial stress on the value of residual stress is unknown since there are no reliable information on residual stress according to the recommendations of iiw hobbacher 2015 the enhancement factor calculated from eq 19 should not be applied in the proposed fatigue damage evaluation process whether the welded joints are stress relieved or not in the practical engineering structures it is worth noting that in the case of using the s n curve in the multi axial fatigue damage evaluation based on structural monitoring the maximum principal stress at the hot spot location is the stress resulting from the hot spot stress components acquired by the stress monitoring program and the fatigue stress spectrum can be obtained using rain flow counting then the multi axial fatigue damage can be directly evaluated according to the palmgren miner linear cumulative damage criterion 5 case study on the multi axial fatigue damage evaluation based on structural monitoring in this study the tubular t joint from the fatigue tests conducted by thvenet et al 2013 is investigated implementing the monitoring program and comparing the fatigue life prediction results as a case study on the proposed multi axial fatigue damage evaluation based on monitoring 5 1 calculation of the coefficient matrix c and c d t in a numerical manner the geometric parameters of the tubular t joint are given in table 2 fe analyses are carried out to calculate the coefficient matrix c and c d t using the multipurpose fe package ansys the young s modulus and poisson s ratio in the fe analysis are 2 05 105 mpa and 0 3 respectively as illustrated in fig 8 for calculation of c in terms of the hss the fe model of the tubular t joint was generated using 4 node shell elements shell63 and a mesh size of t t around the weld intersection according to rules for the calculation of c d t in terms of the zpss the fe model of the tubular t joint was generated using 20 node solid elements solid95 and the mesh sizes in the vicinity of the weld tole were 0 05t and 0 025t for the brace tube and chord tube respectively as shown in fig 9 the weld toe geometry depended on the geometric parameters of the investigated tubular joint and satisfied the requirements of aws 2002 in the fatigue tests conducted by thvenet et al 2013 a combined loading called comb is applied to the t joints the comb loading is obtained by displacing the centre of the brace end following a circular path of diameter u nom whose centre is at the axis of the brace tube with the help of a rotating machine while the two ends of the chord are fixed on the floor as indicated in fig 10 in a loading cycle the loading direction with respect to the structure is located by the angle  the comb loading is deviated bending loading and it is considered to be constant amplitude non proportional multi axial loading in terms of fatigue analysis to simulate the comb loading applied in the fatigue tests for the fe model the chord ends are fixed while the brace end is displaced in the same manner the validity of the fe analysis related to the fatigue tests is verified by comparing readings of the strain gauge rosette which is positioned approximately 4 mm away from the weld toe on the chord tube and the maximum principal stresses from the same location of the two fe models as illustrated in fig 11 the two sets of fe results are well fitted to the test measurements and the stress results obtained from the fe analysis using either shell elements or sold elements can be considered equivalent to the stress collected from the strain gauges to determine a reasonable position of the brace tube circumference to place the sensors the variation of the measured values along the brace tube axis under respective basic loading is obtained as shown in fig 12 for the extent of the brace tube away from the brace chord intersection the effects of the structural discontinuity reduction and the stress state would be in agreement with general theories and therefore considered suitable for fitting the strain gauge sensors as shown in fig 12 the measured values remain constant for the extent of the brace tube distance 3 to 6 times the brace tube diameter d from the crown position which indicates that the stress state is in compliance with beam theory in the current study the brace tube circumference at 4 5d from the crown position is selected to place the array of four sensors as illustrated in fig 13 for the calculation of c based on the fe results of the t joint under each basic loading the hot spot stress components  hs  hs and  hs are obtained by postprocessing while the measured values  n  mip and  mop are obtained per sensor arrangement by regarding the vectors of measured values  n  mip  mop t and hot spot stress components  hs  hs  hs t obtained under each basic loading condition as the basis of the corresponding vector space c can be calculated accordingly using eq 7 and the results are shown in table 3 for the calculation of c d t based on the fe results of the t joint under each basic loading condition the distribution along the scl of stress components   and  are obtained by postprocessing while the measured values  n  mip and  mop are the same as those in the calculation of c for each node along the scl regarding the vectors of measured values  n  mip  mop t and stress components    t obtained under each basic loading condition as the basis of the corresponding vector space c d t can be calculated accordingly using eq 12 taking the investigated tubular t joint as an example the distribution along the scl of the coefficient between the measured in plane bending stress difference  mip and the stress components for the chord tube at the weld bead at  0 45 and 90 is shown in fig 14 5 2 comparison of the multi axial fatigue analysis results comb loading is applied to the fe model of the investigated tubular t joint and the stress components corresponding to the strain gauges are obtained which constitute the time history of the measured values  n  mip and  mop in a loading cycle accordingly the hot spot stress component time histories are obtained by multiplying c while the stress distribution alone scl for within the loading cycle is obtained by multiplying c d t and zpss component time histories are acquired based on the zpss calculation procedure then the fatigue life estimation using mwcm in terms of the hhs and the zpss is performed in accordance with the multi axial fatigue damage evaluation process proposed in section 4 3 meanwhile for the fatigue life estimation using s n curve in terms of the hhs the time history of the magnitude of maximum principal stress is calculated from the hot spot stress component time histories and the fatigue stress spectrum is then obtained by rain flow counting of the magnitude time history the uniaxial s n curve from table 1 is selected and the fatigue life estimation is performed according to the palmgren miner linear cumulative damage criterion since the tubular joints investigated were systematically submitted to stress relief by heat treatment in the fatigue test conducted by thvenet et al 2013 fatigue strength modifications of stress relieving are adapted in this fatigue damage evaluation for the fatigue life estimation using s n curve in terms of the hhs a simplified approach according to iiw hobbacher 2015 is applied where only 60 of the stresses in compression is considered for the hot spot stress time history for the fatigue life estimation using mwcm in terms of the hhs and the zpss the enhancement factor is calculated from eq 19 to modify the shear stress range  ref  w of the adopted modified whler curve fig 15 illustrates the fatigue lives obtained per the s n curve and mwcm in terms of the hss as well as the mwcm in terms of the zpss as shown in fig 15 the degree of conservation decreases successively when comparing the fatigue life prediction using the s n curve in terms of the hss the mwcm in terms of the hss and the mwcm in terms of the zpss the mwcm in terms of the zpss shows the highest accuracy in fatigue life prediction under the same loading case fatigue life prediction using the mwcm in terms of the zpss is less conservative than that in terms of the hss by comparing the parameters in the mwcm multi axial fatigue damage evaluation in terms of the hss or zpss shown in table 4  w has a similar value under the same loading case while  is slightly smaller for the zpss such a difference shows that the effect of the stress gradient on the fatigue life can be considered to a certain extent in the zpss approach which explains the reason for a higher accuracy in the fatigue life prediction using the mwcm in terms of the zpss 6 discussion a stress monitoring program suitable for engineering structures is proposed in this article which can acquire the stress components of the hss or zpss at the hot spot locations of welded tubular joints and the mwcm is applied to develop a procedure for the multi axial fatigue life assessment in terms of the proposed monitoring program compared to existing stress monitoring programs for fatigue life assessment the one proposed in this article can better accommodate the multi axiality of the fatigue damage in engineering structures and can also be more flexible in terms of the fatigue life assessment since both the traditional s n curve and multi axial fatigue oriented mwcm could be applied in this article a stress monitoring program is devised for welded tubular t joints as an example other structural nodes with similar load bearing characteristics can also be used to formulate a stress monitoring program by referring to the strategies and specific solutions in this article essentially the arrangement of the sensors uses pairs of strain gauges to acquire the corresponding response characteristic of the structural detail under each basic loading condition while the monitoring data processing strategy establishes a proportional relation between the characteristic of the responses and the reference for the fatigue strength assessment in terms of the stress concentration coefficient in this article the sensor arrangement and monitoring data processing strategy is developed with the help of the fe analysis of the local structural detail whose validity is verified by a comparison to the data acquired from tests in the case where the stress monitoring program is applied to welded tubular joints during engineering practice since the sensors are placed away from the fatigue hot spot the stress state would be in compliance with beam theory and the stress response in the vicinity of the sensors installed on the engineering structure would be consistent with the fe analysis results under the same loading therefore the measured values obtained from the stress monitoring program can be considered equivalent to those used in monitoring data processing and the effectiveness of the proposed stress monitoring program applied during engineering practice is ensured when placing the strain gauges onto the engineering structure the position and axial direction of the sensors inevitably deviate from the ideal distribution to a certain extent however since the sensors are placed away from the fatigue hot spot the gradient of the stress response on the structural surface is relatively small therefore even if the sensor distribution shows a small deviation the reading from the strain gauge which is the average stress of the area on the structural surface that is in contact with the strain gauge would be almost equal to the stress at the target position hence the influence on the morning data would also be insignificant demonstrating the robustness of the proposed plan of the sensor arrangement it is worth noting that the values in the coefficient matrix c or c d t calculated in this article are not only determined by the arrangement of the sensors but also by the geometry of the monitored structural detail for a monitoring program with different structural dimensions structural form or sensor arrangement the values in the coefficient matrix would certainly differentiate from those calculated in this article therefore to more extensively apply the proposed multi axial fatigue life assessment strategy based on structural monitoring during engineering practice of offshore structures it is necessary to further research the fatigue damage monitoring program for more typical structure details the fatigue damage monitoring program and the corresponding multi axial fatigue damage evaluation proposed in this article present a complete step by step strategy for obtaining the fatigue damage from readings of strain gauges arranged on the structure surface the strategy is acquired through the combination of the linear elastic fe analysis of the structure detail performed in advance and software programming of basic data processing demonstrating the feasibility and practicability in implementing the strategy during engineering practice 7 conclusions 1 in this article a fatigue damage monitoring program is proposed for tubular joints under multi axial loading which is accomplished from the combination of two coordinating strategies on the one hand a sensor arrangement strategy with explicit physical meaning is proposed based on the load bearing characteristics of the structural detail on the other hand a proportional relation between the readings of sensors and the reference for the fatigue strength namely the components of the hss or zpss is established with the help of fe analysis performed in advance which is the monitoring data processing strategy 2 in the case of establishing a fatigue damage monitoring program according to the strategy proposed in this article a reference for the fatigue strength assessment at critical fatigue locations could be obtained in real time combined with the applicable multi axial fatigue damage evaluation method in time fatigue life assessment could be programmatically performed demonstrating practicability in implementing this strategy for engineering practice 3 to more extensively apply the proposed multi axial fatigue life assessment strategy based on structural monitoring of offshore structures during engineering practice it is necessary to further research the fatigue damage monitoring program for more typical structure details credit authorship contribution statement gang liu conceptualization methodology investigation supervision writing review editing zhengrun li software validation data curation writing original draft zhiyuan li validation writing review editing yi huang resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china grant no 51879038 51179027 and the national key research and development program of china grant no 2018yfc0310502 
20888,in this paper a structural health monitoring strategy that performs in time multi axial fatigue damage evaluations for welded tubular joints is proposed first we developed a stress monitoring program that obtains the reference for the multi axial fatigue strength assessment namely the components of the hot spot stress and zero point structural stress from a sensor arrangement strategy representing explicit physical meaning for tubular t joints then we established a programmable procedure for multi axial fatigue damage evaluation based on stress monitoring which is verified through a finite element simulation taking practical interests into consideration we suggest that the proposed strategy is suitable for in field engineering practice keywords multi axial fatigue structural health monitoring stress monitoring fatigue damage evaluation welded tubular joint nomenclature c n c n c n  the coefficient between the measured value of axial stress  n and the stress components of hot spot stress state  hs  hs and  hs c n d t c n d t c n  d t distribution along scl for coefficient between the measured value of axial stress  n and the stress components of stress state    c mip c mip c mip  the coefficient between the measured in plane bending stress difference  mip and the stress components of hot spot stress state  hs  hs and  hs c mip d t c mip d t c mip  d t distribution along scl for coefficient between the measured in plane bending stress difference  mip and the stress components of stress state    c mop c mop c mop  the coefficient between the measured out of plane bending stress difference  mop and the stress components of hot spot stress state  hs  hs and  hs c mop d t c mop d t c mop  d t distribution along scl for coefficient between the measured out of plane bending stress difference  mop and the stress components of stress state    c the coefficient matrix of measured values and the stress components of hot spot stress state c d t distribution along scl for the coefficient matrix of measured values and the stress components d external diameter of chord d external diameter of brace d t the ratio between the distance to the structure surface of given location on scl and the wall thickness f ax axial loading f r cp enhancement factor hss hot spot stress k negative inverse slope of the uniaxial fatigue curve k 0 negative inverse slope of the torsional fatigue curve k  modified whler curve s negative inverse slope l brace length from center of brace end to crown position l chord length n a reference number of cycles to failure n f number of cycles to failure n f i fatigue life extrapolated at reference shear stress range  i n kp number of cycles to failure defining the position of the knee point mv the direction that experiencing the maximum variance of the resolved shear stress m ip in plane bending moment m op out of plane bending moment r cp critical plane load ratio scl stress classification line t chord thickness t brace thickness plate thickness zp zero point a position in the wall thickness direction where the nonlinear stress peak decreases to zero zpss zero point structural stress the structural stress at zero point  plane in axial of scl u nom diameter of the circular path in comb loading  a range of the reference normal stress at n a cycles to failure  mip  mip n the measured value of in plane bending stress difference and its nominal quantity  mop  mop n the measured value of out of plane bending stress difference and its nominal quantity  n normal stress range relative to the critical plane  shear stress range relative to the critical plane  a range of the reference shear stress at n a cycles to failure  i individual reference shear stress range  ref reference shear stress range relative to the critical plane  angle measured around intersection from crow position indicating loading direction with respect to the structure  w critical plane stress ratio  w lim limit value for the critical plane stress ratio  b bending stress  hs  hs  hs the stress components of hot spot stress state i e normal stress perpendicular and parallel to the weld bead and the corresponding shear stress  ln local notch stress  m membrane stress  nlp nonlinear peak stress  n  n n the measured value of axial stress and its nominal quantity  n a amplitude of the stress perpendicular to the critical plane  n m mean stress perpendicular to the critical plane  zp  zp t normal the stress components of zpss perpendicular to the weld bead and its time history    the stress components of stress state i e normal stress perpendicular and parallel to the weld bead and the corresponding shear stress  d t  d t  d t distribution alone scl of the stress components   and   x the local notch stress distribution from x 0 at surface to x t at through plate thickness  mv t instantaneous value of the shear stress resolved along mv  zp  zp t shear the stress components of zpss parallel to the weld bead and its time history  angle measured around intersection from crow position 1 introduction fatigue damage has been one of the most common modes of in service failure in tubular joints of offshore structures especially in harsh environments the main causes of fatigue damage are that the geometry of the connections and welds produces high stress concentrations in the intersection area and these offshore structures are frequently subjected to cyclic loading caused by waves and winds dong et al 2011 dong and hong 2012 maheswaran and siriwardane 2016 thvenet et al 2013 in existing rules and guides abs 2005 dnvgl 2016 the spectral based method is mainly recommended for the fatigue assessment of offshore structures the key to fatigue analyses is to accurately obtain the long term distribution of the stress at welded joints however there are two limitations of the spectral method in the stress calculation one limitation is that the spectral method assumes that the relationship between the wave height and the wave induced loads is linear which is not in accord with actual wave loads the other limitation is the error of numerically calculated stresses at welded joints caused by the simplification of finite element fe models and boundary conditions the accumulation of various errors in fe analyses will make the calculated stress inconsistent with the true stress response of welded joints therefore the estimated fatigue lives by using the spectral method may be much different from the actual fatigue lives of welded joints to ensure the safety of the engineering structures during service it is important to monitor the stress strain state at critical locations and assess the fatigue lives of the structures based on monitoring data in recent years structural health monitoring shm has been widely used in engineering structures compared to the numerical analysis of structural responses a large amount of hydrodynamic calculations and fe analyses of the structures are not required in shm and the structural responses directly measured by sensors are considered to be more accurate than the numerical results mondoro et al 2016 used shm data to assess the fatigue life of a high speed aluminium catamaran strain gauges were installed at the high stress areas indicated in the fe analysis results with the goal of providing stress data at the fatigue critical details the stress concentration responses determined through the conversion of strain gauge data were directly used for the fatigue life calculation with both time domain and spectral based methods leander et al 2010 performed a monitoring program to study the differences between theoretical calculations and the inspected reality in the fatigue life assessment of a steel railway bridge in the monitoring program strain gauges were placed on the web of the main beam to measure strains and a quadratic extrapolation method was used to calculate the hot spot stress hss according to recommendations in the international institute of welding chan et al 2001 carried out a fatigue analysis and life prediction of bridges with shm data in which strain gauges were installed to measure the nominal stresses at bridge deck sections and the hss was calculated at the weld toe by considering some related factors affecting the hss such as the stress concentration factor in the vicinity of the weld due to geometric discontinuities the factor for the stress distribution at the weld toe and the factor that expresses the influence of the residual stress due to welding ye et al 2019 proposed a master s n curve based fatigue life assessment of welded joints in a steel bridge based on an fe analysis and shm data fibre bragg grating sensors were installed on both the top and bottom surfaces of specific critical joints so that the membrane stress bending stress and structural stress of the joints could be calculated through the measured stresses in the proposed method the structural stress was used in the fatigue life assessment which provided an effective method when the nominal stress of the welded joints was hard to define however the abovementioned methods of stress monitoring are only for the uniaxial fatigue life assessment of welded structures due to the complex and variable loads experienced during the service of welded structures critical locations of the structures are often in a multi axial stress state even if the structure is subjected to uniaxial loading the local stress state at the welded joints is usually multi axial due to the complex geometry of the welded structures the methods of fatigue life assessment widely used in engineering are based on uniaxial fatigue tests and theoretical assumptions which often result in a large dispersion of the calculated fatigue lives of actual complex structures therefore if a fatigue life assessment method based on multi axial fatigue theory can be used in the shm the estimated results will be more accurate in early multi axial fatigue studies many research efforts were devoted to estimating multi axial fatigue life by using uniaxial fatigue theory when a welded structure is subjected to proportional multi axial loading the stress state can be reduced to an equivalent stress based on conventional hypotheses cen 2014 hobbacher 1996 sonsino 2009a b however the equivalent stress method is not suitable for fatigue life assessment under nonproportional loading the energy based criterion for multi axial fatigue failure has been proposed for proportional or nearly proportional loading but it is also not suitable for non proportional loading ellyin and golos 1988 macha and sonsino 1999 in addition the energy based criterion is hard to use in the shm because of the difficulty associated with measuring the energy absorbed by the structure thvenet et al 2013 carried out a numerical analysis and fatigue tests for the fatigue strength assessment of tubular welded t joints subjected to combined loadings in which a pragmatic approach based on the dang van criterion fayard et al 1996 was developed to take into account the multi axial stress state at the weld toe comparisons between the experimental and numerical results showed that the application of a multi axial fatigue criterion for the fatigue design of welded joints appears to be completely suitable and taking into account the multi axial stress state indeed makes it possible to considerably improve lifetime predictions the critical plane approach has been widely applied to the multi axial fatigue problem there are different models with different definitions of the critical plane but the methodology is the same a critical plane based criterion was applied to fatigue life estimation of fillet welded tubular t joints subjected to multi axial loading by carpinteri et al 2017 both experimental strain measurements on the t joints and fe analysis of the welded structure were performed which verified the applicability of the proposed stress based approach to multi axial fatigue strength assessment of tubular t joints susmel and tovo 2004 proposed the modified whler curve method mwcm which takes the shear stress range and the ratio of the normal and shear stress range on the critical plane as parameters in the multi axial fatigue assessment the multi axial fatigue s n curve in this method is calibrated by the uniaxial tension and torsion fatigue curve in standard codes in this way the method can take into account both the shear and normal stresses together rather than just the normal stress in uniaxial fatigue methods the mwcm has been used to estimate the multi axial fatigue life of welded joints and the results show that it is much more accurate than the procedure proposed by eurocode 3 under both proportional and non proportional loading susmel 2009a applied the mwcm in terms of both nominal structural and local stresses to estimate the multi axial fatigue damage in welded joints the three ways of applying the mwcm suggest to be highly accurate and reliable by using experimental results taken from the literature and generated by testing steel and aluminium welded details the stress monitoring programs in existing engineering practice are designed for performing uniaxial fatigue life assessments but are not necessarily applicable to multi axial fatigue theories in this article focusing on tubular joints a multi axial fatigue oriented monitoring strategy is proposed to perform in time fatigue damage evaluations directly from stress monitoring data using multi axial fatigue damage theories first two stress monitoring programs are developed to obtain the hot spot stress and zero point structural stress zpss liu et al 2014 subsequently a multi axial fatigue damage evaluation procedure is established by applying the mwcm based on structural monitoring finally a case study on the proposed multi axial fatigue damage evaluation based on monitoring is investigated the stress monitoring program proposed in this article has explicit physical meaning and can also be suitable for in field engineering practice 2 stress monitoring program in terms of the hss the hss approach has been widely used in engineering designs compared to the nominal stress approach the hss approach utilizes more accurate stress analysis for different types of welded joints and has higher precision and more extensive applicability for complex structures compared to the notch stress approach the hss approach does not consider the local stress concentration caused by the weld toe itself and hence avoids the difficulty of determining the local geometry of the weld toe therefore the hss approach has been the most favourable option due to both its accuracy and applicability in engineering designs 2 1 sensor arrangement strategy for tubular t joints fig 1 shows the dimensions of a welded tubular t joint the crown and saddle positions along the chord brace intersection of the joint are located at points where the angular positions are  0 and  270 respectively to obtain the stress distribution along the weld toe a total of 16 hot spot positions are selected on both the chord and brace sides along the intersection where  k 45 k 0 1 7 since sea states are multidirectional tubular joints are usually subjected to multi axial loading which can be separated into three basic components axial loading f ax in plane bending moment m ip and out of plane bending moment m op in this paper multi axial loading is considered as a combination of the three basic components the nominal stress is obtained using general theories such as beam theory therefore the distinctive characteristics of the nominal stress in a structural component under each basic loading condition can be used to distinguish the existence and the effect of the basic loading components in the case of applied multi axial loading to quantify the magnitude of each basic loading component the arrangement of the sensors should comply with the characteristics of the corresponding nominal stress components according to general theories the distribution of the normal stress parallel to the brace axis in the brace tube cross section under each basic loading is shown in fig 2 in light of the distinctive characteristics of the normal stress distribution an array of four sensors is equally distributed over the entire circumference of the brace tube section where  k 90 k 0 1 2 3 the strain gauge sensors are installed on the outer surface of the brace tube along the brace axis direction to the measure normal stresses    in this direction furthermore three measured values are defined in accordance with the internal forces on the brace tube section to quantitatively reflect the effect of each nominal stress component the three measured values namely the measured value of the axial stress  n measured value of the in plane bending stress difference  mip and measured value of the out of plane bending stress difference  mop as well as their nominal quantities  n n  mip n and  mop n are expressed as follows 1  n   0   90   180   270 4 2   mip   0   90 3   mop   90   270 4  n n 4 f ax  d 2 d 2 t 2 5   mip n 64 m ip d  d 4 d 2 t 4 6   mop n 64 m op d  d 4 d 2 t 4 2 2 monitoring data processing strategy for obtaining the hss the hss is defined as the maximum principal stress of the structural stress at the weld toe tomkins 1984 which essentially describes the stress state at the hot spot when using the hss in traditional uniaxial fatigue theory fatigue damage is often evaluated only based on the magnitude of the hss however considering the multi axial stress state at the weld joints changes in the magnitude and direction of the hss are likely to be more complicated therefore obtaining a complete hot spot stress state would be beneficial when applying multi axial fatigue damage theories when a tubular joint is subject to multi axial loading the response corresponding to each basic loading component is linearly independent of each other while their linear superposition constitutes the response of the tubular joint similarly the hot spot stress state at a certain hot spot of the tubular joint under multi axial loading is also a summation of the hot spot stress states corresponding to each of the basic loading components with the help of the sensors arranged as proposed above three measured values quantify the magnitude of the corresponding nominal stress component additionally the nominal stress components reflect the corresponding basic loading component of a multi axial loading therefore by determining under each basic loading a proportional relation between the hot spot stress state and nominal stress the hot spot stress state corresponding to each basic loading component of multi axial loading can be determined since nominal stresses are obtained from monitoring for a tubular joint being monitored under multi axial loading the hot spot stress state at a certain hot spot is a summation of hot spot stress states that are calculated from values of monitoring obtained nominal stresses which is the monitoring data processing strategy to obtain the hss fig 3 a schematically shows the strategy followed to calculate the hss at the weld toe in a linear extrapolation manner for the investigated tubular joints in more detail each stress component namely the normal stresses perpendicular and parallel to the weld bead  and  or the corresponding shear stress  is individually extrapolated at the weld toe by using the reference stress of the positions at a distance from the hot spot equal to 0 5t and 1 5t where t is the plate thickness the reference stresses used to extrapolate the hot spot quantities are the element component stresses obtained for the element s surface that is on the plane containing the line along the weld toe in the fe analysis then the extrapolated stress components are used to compute the maximum principal stress at the weld toe which is calculating the hss from the hot spot stress state the three stress components  hs  hs and  hs that constitute the hot spot stress state are linearly independent therefore by determining a proportional relation between the individual stress component and nominal stress the relation between the hot spot stress state and nominal stress is established for each hot spot location the relation between the measured values and stress components of the hot spot stress state can be defined as 7 c n c mip c mop c n c mip c mop c n  c mip  c mop   n   mip   mop  hs  hs  hs where the coefficient matrix of the measured values and stress components of the hot spot stress state can be denoted as 8 c c n c mip c mop c n c mip c mop c n  c mip  c mop  since the response corresponding to each basic loading component is linearly independent of each other for the tubular joint the three vectors of measured values  n  mip  mop t as well as the three vectors of hot spot stress components  hs  hs  hs t obtained under each unit basic loading are considered to be two sets of base vectors of the vector space and c can be calculated as their transition matrix when applying the monitoring program on a tubular joint under multi axial loading for any given time measured values  n  mip and  mop can be obtained from the monitoring data of the strain gauge sensors and then the hot spot stress components  hs  hs and  hs are calculated from eq 7 such a process produces accurate in time hss values that are required in fatigue damage assessment which constitutes the monitoring data processing strategy obtaining the hss for the structure of interest under multi axial loading 3 stress monitoring program in terms of zpss the hss approach can be used for the multi axial fatigue analysis in combination with the mwcm however calculation of the hss by the stress extrapolation on the plate surface makes the hss approach only suitable for simple welded joints for complex welded joints the multi axial stress states in the vicinity of the critical sites can be generated by either the remote loading or the geometry itself the shear and nominal stresses on the critical plane are difficult to differentiate in advance another limitation of the hss approach is that only the surface stress is considered for the fatigue life assessment it has been found that the stress gradient of the plate thickness also influences the fatigue life lotsberg and sigurdsson 2006 which cannot be considered in the hss approach liu et al 2014 proposed the zpss approach for the multi axial fatigue life assessment of complex welded joints the main advantage of the zpss approach is that the maximum shear stress range and the range of the stress perpendicular to the critical plane can be directly calculated by postprocessing the fe results moreover the zpss approach has higher accuracy than the hss approach when the shell bending stress is dominant over the plate thickness because the effect of the stress gradient on the fatigue life can be taken into account in the former in this paper the stress monitoring program in terms of the zpss is also proposed for the multi axial fatigue assessment of complex welded joints in engineering 3 1 zpss approach as shown in fig 4 the local notch stress  ln at the weld toe consists of three components the membrane stress  m shell bending stress  b and nonlinear stress peak due to the notch effect of the weld  nlp the membrane stress  m is equal to the average stress calculated through the thickness of the plate which is constant through the thickness the shell bending stress  b is linearly distributed through the thickness of the plate the gradient of the shell bending stress is chosen such that the remaining nonlinearly distributed component is in self equilibrium hobbacher 1996 the stress components can be expressed as 9  m 1 t 0 t  x d x 10  b 6 t 2 0 t  x t 2 x d x 11  nlp x  x  m 1 2 x t  b where t is the plate thickness  x is the local notch stress distribution from x 0 at the surface to x t at the through plate thickness the structural stress at a weld toe consists of the membrane stress and shell bending stress and equilibrates the external loading the nonlinear distributed peak stress has no contribution to bear the external loading for the self equilibrium property there must be a point in the wall thickness direction where the value of the nonlinear peak stress decreases to zero liu et al 2014 defined this point as the zero point zp the real notch stress is equal to the structural stress at zp which avoids the notch effect of the weld toe the structural stress at the zp is defined as the zpss based on the basic idea of the hss approach that excludes the nonlinear peak stress from the local notch stress the zpss is taken as a reference for the fatigue life assessment of welded joints if the structural stress distribution curve and the local notch stress distribution curve through the wall thickness are known the zp can be located by finding the intersection of the two curves from numerical results of the notch stress distribution through wall thickness it has been found that the zp is just below and very close to the hot spot on the structure surface when the shell bending stress is included in the notch stress distribution the zpss will be slightly smaller than the hss on the structure surface due to the gradient of the shell bending stress itself therefore the effect of the stress gradient on the fatigue life can be considered to a certain extent in the zpss approach in this paper the stress classification line scl defined in asme 2004 is adopted in the zpss approach for the fatigue strength assessment of tubular joints as shown in fig 5 a the scl is set at the weld toe perpendicular to the tube surface along the wall thickness the notch stress perpendicular to the scl is taken for the zpss calculation at a given angular position along the intersection to specify the plane  where the calculated zpss achieves its peak value the zpss on 360 planes in the axial direction of the scl with an interval of 1 is calculated and the maximum value is selected as the zpss at this angular position as shown in fig 5 b based on the fe results of the stress analysis the procedure of the zpss calculation at a given angular position is described as follows liu et al 2015 1 the stress tensors of all the nodes along the scl are directly obtained from fe analysis 2 according to elastic mechanics the normal stress distribution  n x and the shear stress distribution  x are calculated on a given plane 3 the structural stress  ss and the nonlinear stress peak  nlp are calculated using eqs 9 11 to obtain the positions of the zp and zpss on the given plane 4 according to step 2 and step 3 the zpss on all the planes in the axial scl is calculated and the maximum value of the zpss as well as its corresponding zp are selected as the final results at this given angular position in order to take better advantage of the zpss approach whether the fatigue loading is multi axial or uniaxial as soon as the zpss is calculated it is recommended that mwcm shall be applied to obtain the fatigue curve and to conduct fatigue damage evaluation which will be presented in section 4 in great detail 3 2 monitoring data processing strategy for obtaining the zpss the zpss a resolved stress at the zp along a certain direction perpendicular to the scl is a structural stress vector located at the zp since the stress response corresponding to each basic loading component is linearly independent of each other for a tubular joint the zpss corresponding to each basic loading component is a structural stress vector located at different zps from each other with different magnitudes and directions therefore the vector summation of the zpss under each of the basic loading components similar to that adopted in the monitoring data processing strategy for obtaining the hss would certainly not result in the zpss for the tubular joint under multi axial loading by definition the value of zpss depends on the location of the zp while the location of the zp depends on the stress distribution along the scl for a tubular joint under multi axial loading the stress distribution along the scl at a certain hot spot is a linear superposition of the stress distributions along the scl under each of the basic loading components therefore for monitoring data processing the calculation of the zpss under multi axial loading can be decomposed into two steps obtaining the stress distribution along the scl and locating the zp with the help of the sensors arranged as proposed in 2 1 three measured values quantify the magnitude of the corresponding nominal stress component based on the fact that the response corresponding to each basic loading component is linearly independent of each other similar to that adopted in the monitoring data processing strategy for obtaining the hss by determining under each basic loading a proportional relation between the stress distribution along the scl and nominal stress the stress distribution along the scl under multi axial loading can easily be determined this process converts monitoring obtained nominal stresses into the stress distribution along the scl which is the first step of the monitoring data processing strategy to obtain the zpss according to the zpss calculation procedure stress tensors of all nodes along the scl at the weld toe are required to obtain the stress distribution along the scl since the normal stress distribution on a given plane  is the analysed stress quantity to locate the zp only the stress components relative to the planes perpendicular to the scl are required to determine the stress distribution along the scl namely the normal stress perpendicular and parallel to the weld bead  and  and the shear stress parallel to the weld bead  by transforming the stress tensors into a cartesian coordinate system with the scl and chord brace intersecting line tangent directions as axes stress components   and  are obtained and the 6 independent components of a stress tensor required to obtain the zpss are reduced to 3 similar to that proposed in section 2 2 the relation between the measured values and distribution along the scl of the stress components   and  can be defined as 12 c n d t c mip d t c mop d t c n d t c mip d t c mop d t c n  d t c mip  d t c mop  d t  n   mip   mop  d t  d t  d t where d t is the ratio between the distance to the structure surface of a given location on the scl and the wall thickness 0 d t 1 the coefficient matrix of the measured values and the stress components varies with d t and the distribution along the scl of the coefficient matrix can be denoted as 13 c d t c n d t c mip d t c mop d t c n d t c mip d t c mop d t c n  d t c mip  d t c mop  d t when calculating the coefficient matrix c d t for any point on the scl the three vectors of measured values  n  mip  mop t as well as the three vectors of stress components    t obtained under each unit basic loading are considered to be two sets of base vectors of the vector space and c d t can be calculated as their transition matrix when applying the monitoring program on a tubular joint under multi axial loading for any given time the measured values  n  mip and  mop can be obtained from the monitoring data of the strain gauge sensors and then the distribution along the scl of the stress components   and  are calculated from eq 12 subsequently the zpss of the given time can be obtained according to the procedure of the zpss calculation such a process produces accurate in time zpss values that are required in fatigue damage assessment which constitutes the monitoring data processing strategy for obtaining the zpss for the structure of interest under multi axial loading 4 multi axial fatigue damage evaluation applying the mwcm based on structural monitoring the mwcm based on the critical plane approach has higher accuracy in the multi axial fatigue life assessment and is convenient for engineering applications susmel 2009a 2014 in this paper the mwcm is applied to develop a procedure for the multi axial fatigue life assessment of welded tubular joints in terms of the hss and zpss monitoring programs 4 1 the modified whler curve method the mwcm assumes that the material plane on which the probability of having the crack initiation phenomenon reaches its maximum value under multi axial cyclic loading is the plane experiencing the maximum shear stress range  susmel et al 2009 the initiation and propagation phenomena are also influenced by the stress component perpendicular to the assumed crack initiation plane susmel 2009b the complexity of the stress state at the assumed critical point is hypothesized to be taken into account by combining the shear stress range  and normal stress range  n relative to the critical plane through the following stress ratio 14  w   n   the ratio  w is capable of giving an engineering measurement of the complexity of the assessed stress state in particular under fully reversed uniaxial fatigue loading  w is equal to unity whereas under fully reversed torsional fatigue loading  w is invariably equal to zero susmel et al 2009 the mwcm estimates the fatigue life using a log log modified whler diagram of the shear stress range relative to the critical plane  against the number of cycles to failure n f as sketched in fig 6 the fatigue curve obtained in the modified whler diagram varies with the ratio  w and is specifically characterized by the negative inverse slope k   w and the reference shear stress range  ref  w extrapolated at n a cycles to failure since the experimental fatigue curves that are usually available are those generated under both uniaxial  w 1 and torsional  w 0 fatigue loading the position of any other modified whler curve has to be estimated according to the following linear reactions susmel 2009b 2014 15 k   w k k 0  w k 0  w 1 n f n kp k   w k  w 1 n f n kp 16   ref  w   a 2   a  w   a  w  w lim   ref  w   ref  w lim  w  w lim where k and k 0 are the negative inverse slopes of the uniaxial and torsional fatigue curves respectively and  a and  a are the ranges of the corresponding reference stresses extrapolated at n a cycles to failure n kp is the number of cycles to failure that defines the position of the knee point taken at 108  w lim is a threshold value considering that fatigue damage is no longer solely shear stress governed when critical planes experience large values of the ratio  w assuming that the reference shear stress  ref  w is constant and equal to  ref  w lim for those modified whler curves with a ratio  w larger than the threshold value determined as 17  w lim   a 2   a   a for n f n kp the slope of the modified whler curves under constant amplitude loading is suggested to be taken invariably equal to 22 holding true independently from the actual value of the  w ratio relative to the critical plane under investigation sonsino 2009a b when applying the mwcm to perform a multi axial fatigue assessment as soon as the shear stress range  is known the lifetime can be directly estimated since the modified whler curve with ratio  w is unambiguously defined 4 2 stress components relative to the critical plane under multi axial non proportional fatigue loading in the mwcm 4 2 1 mwcm applied in terms of the hss when applying the mwcm in terms of the hss it is required to use the geometrical stress components perpendicular and parallel to the weld bead namely  hs and  hs in fig 3 for determining the maximum shear stress range as well as the range of the stress perpendicular to the critical plane susmel 2009a the above requirement is suggested in performing multi axial fatigue assessment of weldments because when engineering materials are weakened by notches having opening angles larger than approximately 100 the fatigue strength is observed to depend mainly on the mode i and iii stress components however the contribution of mode ii loading to the overall fatigue damage can be neglected without much loss of accuracy because the resulting stress components are not singular considering the way that they are defined the values of the geometrical stresses depend on the distribution of the linear elastic stress field in the vicinity of the hot spots therefore the structural stress components perpendicular to the weld bead are related to the mode i stress components whereas the structural shear stress components parallel to the weld bead are related to the mode iii stress components in mwcm the maximum variance method mvm is adopted to determine the critical plane susmel 2010 according to the mvm the critical plane can be defined as that plane containing the direction mv mv is a direction passes through the assumed critical point also the direction experiences the maximum variance of the resolved shear stress  mv t since the mvm utilizes statistics of the stress components at the critical location to determine the critical plane it does not depend on the length of the input load history and is considered to be efficient and reliable in practice bel knani et al 2007 since the stress components used to determine the stress relative to the critical plane namely the hot spot stress components perpendicular and parallel to the weld bead  hs and  hs are in fact parallel to the structural surface the direction mv and the normal direction of the critical plane are consequently parallel to the structural surface therefore by comparing the variance of the resolved shear stress relative to each plane  in the axial scl the plane having the maximum variance of the resolved shear stress is determined as the critical plane and subsequently the shear stress range  and normal stress range  n relative to the critical plane are obtained 4 2 2 mwcm applied in terms of the zpss for engineering practice the maximum principal stress of the geometric stress extrapolated to the weld toe is taken as a reference for the fatigue strength assessment in current recommendations abs 2014 dnvgl 2016 as stated before the value of the zpss comes from geometric stress that considers the effect of the stress gradient and the reference for the fatigue strength assessment is also related to the direction where the geometric stress reaches a maximum in view of the similarities between the handling of geometric stress in estimating the hss and zpss the determination of the stress components relative to the critical plane for the mwcm applied in terms of the zpss performing multi axial fatigue assessment should reference that in terms of the hss the value of the zpss is the structural stress at the point in the wall thickness direction from the hot spot location where the value of the nonlinear peak stress equals zero hence the value of the zpss is highly relevant to the distribution of the linear elastic stress field in the vicinity of the hot spots to describe the mode i and iii stress components that the fatigue strength mainly depends on the structural stress components of zpss that are perpendicular and parallel to the weld bead should be required in more detail the normal stress components of the zpss perpendicular to the weld bead  zp and shear stress components of the zpss parallel to the weld bead  zp are required for determining the maximum shear stress range as well as the range of the stress perpendicular to the critical plane based on the definition of the zpss under multi axial non proportional fatigue loading the position of the zp as well as the magnitude and direction of the zpss at each moment will change continuously with the load since the zpss is taken as a reference for the fatigue life assessment the variation of the position of the zp only represents the variation of the location in the wall thickness direction where the zpss is obtained while the variation of the magnitude and direction of the zpss is what affects the determination of the critical plane and consequently fatigue strength assessment therefore the determination of the critical plane according to the mvm should be a statistical analysis of the stress time histories  zp t and  zp t which are obtained from the time history of the value of zpss when applying the mwcm in terms of the zpss to the perform multi axial fatigue assessment of weldments similar to that in terms of the hss the stress components used to determine the stress relative to the critical plane  zp t and  zp t are parallel to the structural surface therefore by comparing the variance of the resolved shear stress relative to each plane  in the axial scl the plane having the maximum variance of the resolved shear stress is determined as the critical plane and subsequently the shear stress range  and normal stress range  n relative to the critical plane are obtained 4 3 multi axial fatigue damage evaluation based on structural monitoring for a critical fatigue detail of an engineering structure with an implemented stress monitoring program the real time hss or zpss could be obtained from monitoring data processing of the stress data continuously acquired from the arranged sensors according to the stress time history obtained from the monitoring program the modified whler curve as well as the fatigue stress spectrum of the shear stress range relative to the critical plane are obtained and then the multi axial fatigue damage can be calculated according to the palmgren miner linear cumulative damage criterion a flow chart for the multi axial fatigue damage evaluation based on structural monitoring is illustrated in fig 7 the uniaxial and torsional fatigue curves used to calibrate the modified whler curve are supplied by the recommendation of iiw hobbacher 2015 as listed in table 1 the mwcm is proposed to perform the fatigue assessment of weldments working in the as welded condition susmel 2014 to reduce the estimates level of conservatism stress relieved welded joints are recommended to be designed against fatigue by multiplying the reference shear stress range of the adopted modified whler curve by a suitable enhancement factor f r cp hobbacher 2015 for the adjusted reference shear stress range  ref  w f r cp the load ratio r cp is calculated through the stress perpendicular to the critical plane susmel 2008 and the factor f r cp for steel welded joints are calculated as follows susmel et al 2011 18 r cp  n m  n a  n m  n a 19 f r cp 1 32 r cp 1 0 22 r cp 1 1 1 r cp 0 0 22 r cp 1 1 0 r cp 0 5 1 r cp 0 5 where  n m and  n a are the mean value and the amplitude of the normal stress  n respectively for engineering structures with an implemented stress monitoring program the stress gauges cannot acquire the initial stress in the structure that exists before when the sensors are installed on the structure surface the initial stress discussed here is regarded as residual stress that caused by structure construction and it could be introduced by lack of fit during assembly of prefabricated welded components by displacements of abutments or by other loads and displacements occurred during structure construction hence the magnitude and the tension compression attribute of the initial stress is uncertain and the influence of initial stress on the value of residual stress is unknown since there are no reliable information on residual stress according to the recommendations of iiw hobbacher 2015 the enhancement factor calculated from eq 19 should not be applied in the proposed fatigue damage evaluation process whether the welded joints are stress relieved or not in the practical engineering structures it is worth noting that in the case of using the s n curve in the multi axial fatigue damage evaluation based on structural monitoring the maximum principal stress at the hot spot location is the stress resulting from the hot spot stress components acquired by the stress monitoring program and the fatigue stress spectrum can be obtained using rain flow counting then the multi axial fatigue damage can be directly evaluated according to the palmgren miner linear cumulative damage criterion 5 case study on the multi axial fatigue damage evaluation based on structural monitoring in this study the tubular t joint from the fatigue tests conducted by thvenet et al 2013 is investigated implementing the monitoring program and comparing the fatigue life prediction results as a case study on the proposed multi axial fatigue damage evaluation based on monitoring 5 1 calculation of the coefficient matrix c and c d t in a numerical manner the geometric parameters of the tubular t joint are given in table 2 fe analyses are carried out to calculate the coefficient matrix c and c d t using the multipurpose fe package ansys the young s modulus and poisson s ratio in the fe analysis are 2 05 105 mpa and 0 3 respectively as illustrated in fig 8 for calculation of c in terms of the hss the fe model of the tubular t joint was generated using 4 node shell elements shell63 and a mesh size of t t around the weld intersection according to rules for the calculation of c d t in terms of the zpss the fe model of the tubular t joint was generated using 20 node solid elements solid95 and the mesh sizes in the vicinity of the weld tole were 0 05t and 0 025t for the brace tube and chord tube respectively as shown in fig 9 the weld toe geometry depended on the geometric parameters of the investigated tubular joint and satisfied the requirements of aws 2002 in the fatigue tests conducted by thvenet et al 2013 a combined loading called comb is applied to the t joints the comb loading is obtained by displacing the centre of the brace end following a circular path of diameter u nom whose centre is at the axis of the brace tube with the help of a rotating machine while the two ends of the chord are fixed on the floor as indicated in fig 10 in a loading cycle the loading direction with respect to the structure is located by the angle  the comb loading is deviated bending loading and it is considered to be constant amplitude non proportional multi axial loading in terms of fatigue analysis to simulate the comb loading applied in the fatigue tests for the fe model the chord ends are fixed while the brace end is displaced in the same manner the validity of the fe analysis related to the fatigue tests is verified by comparing readings of the strain gauge rosette which is positioned approximately 4 mm away from the weld toe on the chord tube and the maximum principal stresses from the same location of the two fe models as illustrated in fig 11 the two sets of fe results are well fitted to the test measurements and the stress results obtained from the fe analysis using either shell elements or sold elements can be considered equivalent to the stress collected from the strain gauges to determine a reasonable position of the brace tube circumference to place the sensors the variation of the measured values along the brace tube axis under respective basic loading is obtained as shown in fig 12 for the extent of the brace tube away from the brace chord intersection the effects of the structural discontinuity reduction and the stress state would be in agreement with general theories and therefore considered suitable for fitting the strain gauge sensors as shown in fig 12 the measured values remain constant for the extent of the brace tube distance 3 to 6 times the brace tube diameter d from the crown position which indicates that the stress state is in compliance with beam theory in the current study the brace tube circumference at 4 5d from the crown position is selected to place the array of four sensors as illustrated in fig 13 for the calculation of c based on the fe results of the t joint under each basic loading the hot spot stress components  hs  hs and  hs are obtained by postprocessing while the measured values  n  mip and  mop are obtained per sensor arrangement by regarding the vectors of measured values  n  mip  mop t and hot spot stress components  hs  hs  hs t obtained under each basic loading condition as the basis of the corresponding vector space c can be calculated accordingly using eq 7 and the results are shown in table 3 for the calculation of c d t based on the fe results of the t joint under each basic loading condition the distribution along the scl of stress components   and  are obtained by postprocessing while the measured values  n  mip and  mop are the same as those in the calculation of c for each node along the scl regarding the vectors of measured values  n  mip  mop t and stress components    t obtained under each basic loading condition as the basis of the corresponding vector space c d t can be calculated accordingly using eq 12 taking the investigated tubular t joint as an example the distribution along the scl of the coefficient between the measured in plane bending stress difference  mip and the stress components for the chord tube at the weld bead at  0 45 and 90 is shown in fig 14 5 2 comparison of the multi axial fatigue analysis results comb loading is applied to the fe model of the investigated tubular t joint and the stress components corresponding to the strain gauges are obtained which constitute the time history of the measured values  n  mip and  mop in a loading cycle accordingly the hot spot stress component time histories are obtained by multiplying c while the stress distribution alone scl for within the loading cycle is obtained by multiplying c d t and zpss component time histories are acquired based on the zpss calculation procedure then the fatigue life estimation using mwcm in terms of the hhs and the zpss is performed in accordance with the multi axial fatigue damage evaluation process proposed in section 4 3 meanwhile for the fatigue life estimation using s n curve in terms of the hhs the time history of the magnitude of maximum principal stress is calculated from the hot spot stress component time histories and the fatigue stress spectrum is then obtained by rain flow counting of the magnitude time history the uniaxial s n curve from table 1 is selected and the fatigue life estimation is performed according to the palmgren miner linear cumulative damage criterion since the tubular joints investigated were systematically submitted to stress relief by heat treatment in the fatigue test conducted by thvenet et al 2013 fatigue strength modifications of stress relieving are adapted in this fatigue damage evaluation for the fatigue life estimation using s n curve in terms of the hhs a simplified approach according to iiw hobbacher 2015 is applied where only 60 of the stresses in compression is considered for the hot spot stress time history for the fatigue life estimation using mwcm in terms of the hhs and the zpss the enhancement factor is calculated from eq 19 to modify the shear stress range  ref  w of the adopted modified whler curve fig 15 illustrates the fatigue lives obtained per the s n curve and mwcm in terms of the hss as well as the mwcm in terms of the zpss as shown in fig 15 the degree of conservation decreases successively when comparing the fatigue life prediction using the s n curve in terms of the hss the mwcm in terms of the hss and the mwcm in terms of the zpss the mwcm in terms of the zpss shows the highest accuracy in fatigue life prediction under the same loading case fatigue life prediction using the mwcm in terms of the zpss is less conservative than that in terms of the hss by comparing the parameters in the mwcm multi axial fatigue damage evaluation in terms of the hss or zpss shown in table 4  w has a similar value under the same loading case while  is slightly smaller for the zpss such a difference shows that the effect of the stress gradient on the fatigue life can be considered to a certain extent in the zpss approach which explains the reason for a higher accuracy in the fatigue life prediction using the mwcm in terms of the zpss 6 discussion a stress monitoring program suitable for engineering structures is proposed in this article which can acquire the stress components of the hss or zpss at the hot spot locations of welded tubular joints and the mwcm is applied to develop a procedure for the multi axial fatigue life assessment in terms of the proposed monitoring program compared to existing stress monitoring programs for fatigue life assessment the one proposed in this article can better accommodate the multi axiality of the fatigue damage in engineering structures and can also be more flexible in terms of the fatigue life assessment since both the traditional s n curve and multi axial fatigue oriented mwcm could be applied in this article a stress monitoring program is devised for welded tubular t joints as an example other structural nodes with similar load bearing characteristics can also be used to formulate a stress monitoring program by referring to the strategies and specific solutions in this article essentially the arrangement of the sensors uses pairs of strain gauges to acquire the corresponding response characteristic of the structural detail under each basic loading condition while the monitoring data processing strategy establishes a proportional relation between the characteristic of the responses and the reference for the fatigue strength assessment in terms of the stress concentration coefficient in this article the sensor arrangement and monitoring data processing strategy is developed with the help of the fe analysis of the local structural detail whose validity is verified by a comparison to the data acquired from tests in the case where the stress monitoring program is applied to welded tubular joints during engineering practice since the sensors are placed away from the fatigue hot spot the stress state would be in compliance with beam theory and the stress response in the vicinity of the sensors installed on the engineering structure would be consistent with the fe analysis results under the same loading therefore the measured values obtained from the stress monitoring program can be considered equivalent to those used in monitoring data processing and the effectiveness of the proposed stress monitoring program applied during engineering practice is ensured when placing the strain gauges onto the engineering structure the position and axial direction of the sensors inevitably deviate from the ideal distribution to a certain extent however since the sensors are placed away from the fatigue hot spot the gradient of the stress response on the structural surface is relatively small therefore even if the sensor distribution shows a small deviation the reading from the strain gauge which is the average stress of the area on the structural surface that is in contact with the strain gauge would be almost equal to the stress at the target position hence the influence on the morning data would also be insignificant demonstrating the robustness of the proposed plan of the sensor arrangement it is worth noting that the values in the coefficient matrix c or c d t calculated in this article are not only determined by the arrangement of the sensors but also by the geometry of the monitored structural detail for a monitoring program with different structural dimensions structural form or sensor arrangement the values in the coefficient matrix would certainly differentiate from those calculated in this article therefore to more extensively apply the proposed multi axial fatigue life assessment strategy based on structural monitoring during engineering practice of offshore structures it is necessary to further research the fatigue damage monitoring program for more typical structure details the fatigue damage monitoring program and the corresponding multi axial fatigue damage evaluation proposed in this article present a complete step by step strategy for obtaining the fatigue damage from readings of strain gauges arranged on the structure surface the strategy is acquired through the combination of the linear elastic fe analysis of the structure detail performed in advance and software programming of basic data processing demonstrating the feasibility and practicability in implementing the strategy during engineering practice 7 conclusions 1 in this article a fatigue damage monitoring program is proposed for tubular joints under multi axial loading which is accomplished from the combination of two coordinating strategies on the one hand a sensor arrangement strategy with explicit physical meaning is proposed based on the load bearing characteristics of the structural detail on the other hand a proportional relation between the readings of sensors and the reference for the fatigue strength namely the components of the hss or zpss is established with the help of fe analysis performed in advance which is the monitoring data processing strategy 2 in the case of establishing a fatigue damage monitoring program according to the strategy proposed in this article a reference for the fatigue strength assessment at critical fatigue locations could be obtained in real time combined with the applicable multi axial fatigue damage evaluation method in time fatigue life assessment could be programmatically performed demonstrating practicability in implementing this strategy for engineering practice 3 to more extensively apply the proposed multi axial fatigue life assessment strategy based on structural monitoring of offshore structures during engineering practice it is necessary to further research the fatigue damage monitoring program for more typical structure details credit authorship contribution statement gang liu conceptualization methodology investigation supervision writing review editing zhengrun li software validation data curation writing original draft zhiyuan li validation writing review editing yi huang resources writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china grant no 51879038 51179027 and the national key research and development program of china grant no 2018yfc0310502 
20889,numerical analyses were performed on a kvlcc2 korea research institute of ships and ocean kriso very large crude oil carrier 2 at f r 0 092 and 0 037 in regular wave conditions a reynolds averaged navier stokes rans solver was applied with the finite volume method and a realizable k  model as a turbulence model the volume of fluid vof equation was solved to implement the free surface the body force propeller method of the virtual disk model was used to represent the effect of the propeller and reduce the computation time significantly resistance and self propulsion computations were carried out in calm water and regular head waves and the results were verified by comparing them to the added resistance and motions from experiments to find the trend of the delivered horsepower dhp in regular waves regular head waves from the short wave to long wave conditions with two different wave steepness were considered the load variation method was also performed using the obtained added resistance and the resulting self propulsion points were compared with the cfd results in each wave case the propulsive coefficients and dhp were also compared and we discuss the relationship between the thrust deduction factor and wake fraction factor according to the wave conditions keywords computational fluid dynamics cfd regular wave self propulsion test propulsive coefficient kvlcc2 added resistance delivered horsepower dhp virtual disk 1 introduction at the 45th meeting of the marine environment protection committee mepc in 2000 it was announced that shipping accounted for 3 3 of greenhouse gas ghg emissions in the world and carbon dioxide co2 accounted for 99 97 of the ghg at the 2009 mepc 59th conference co2 emissions from ships were expected to increase by 220 310 for the period of 2007 2050 hence the international maritime organization imo adopted the energy efficiency operational indicator eeoi and energy efficiency design index eedi to regulate co2 emissions the eedi is formulated using technical parameters that are required to increase the energy efficiency of vessels in order to increase the energy efficiency of a ship there are operational methods such as adjusting the operating speed of the ship or selecting a ship according to the cargo volume there are also design methods like improving the hull engine and propulsors to reduce drag and increase propulsion efficiency in consideration of the operating speed of a ship co2 emissions are reduced by about 23 when the speed decreases by about 10 there is clear evidence that the reduction of the speed corresponds to the cube root of engine power and relates to fuel consumption it was also estimated that an s 175 container ship sailing in the north atlantic recorded 15 increased co2 emissions in a seaway compared with calm water conditions prpi ori and faltinsen 2012 therefore one way to reduce co2 emissions is to design an energy efficient hull by considering more realistic situations rather than calm water one of the reasons for increasing engine power is that the total resistance increases when the ship is operating in wave conditions which is known as added resistance in the past many experimental and theoretical studies have been conducted to predict the added resistance and the importance of the operating efficiency of a ship has been re examined to improve the operating efficiency research on added resistance can be divided into experimental and numerical studies experimental approaches have been used to understand the motion that is produced by waves basic concepts for analysing the effects of waves were suggested in initial studies such as linear superposition of motion denis and pierson 1953 and vertical acceleration components lewis and bennet 1965 gerritsma et al 1961 indicated that waves coming towards a ship generate oscillating forces that have nonlinear properties these forces are generally divided into radiation forces and diffraction forces when a ship is moving up and down the surrounding water acts as a damper of the motions and propagates the energy which makes drifting forces on the hull alexandersson 2009 using series 60 parent hulls strm tejsen et al 1973 indicated that this hydrodynamic damping is largely influenced by heave and pitch motions and viscous damping can be neglected therefore the radiation force is regarded as dominating in motions and is usually bigger in long wave conditions and non viscous phenomena when testing with an s175 container ship it was pointed out that diffraction force occurs when a wave contacting a blunt ship bounces off the proportion of this force in the added resistance is relatively small but it is dominant in short wave conditions and hard to predict due to the non linearity fujii and takahashi 1975 experiments were conducted with a kvlcc2 hull korea research institute of ships and ocean kriso very large crude oil carrier 2 in the short wavelength region guo and steen 2012 and in various wavelength regions hwang et al 2013 further studies have been performed on the uncertainty of the added resistance measured by experiments park et al 2015 and the effect of the shape of the bow lee et al 2017 numerical research can be sorted into approaches based on empirical equations and potential theory and approaches based on solving the navier stokes n s equations that take into account the viscosity since empirical formulas have no iterative calculation process they have been developed for a relatively long time a method using energy or momentum conservation called the far field method was suggested to calculate the added resistance by maruo 1960 and gerritsma and beukelman 1972 this method generally estimates the added resistance in long waves well however the added resistance can be underestimated in short wave conditions and if the motion of a ship becomes excessive it is difficult to trust a pressure integration method called the near field method was proved by boese 1970 this method is a relatively simple method that integrates the pressure of the wetted surface of the hull which is called the control surface since this method uses the average receiving surface area in the wave conditions it is difficult to follow the effects of the instantaneous waves furthermore various approaches have been attempted to use correction factors based on previous studies or to introduce new concepts such as strip theory and a three dimensional panel method salvesen et al 1970 faltinsen et al 1980 fang 1991 papanikolaou et al 1992 journe and adegeest 2003 recently liu and papanikolaou 2016 2019 proposed a formula that can predict the added resistance relatively easily by combining a formula based on basic ship design parameters for short wave conditions and an approximate formula suggested by jinkine and ferdinanade 1974 for long ones this work can also cover a wide range of speeds and various draft conditions and particularly captures tankers well the importance of ship parameters to estimate added resistance has been mentioned frequently in previous studies cepowski 2020 proposed that artificial neural networks ann can be practically applied in the design stage by deriving the added resistance as an output value by inputting design parameters simulations are performed to model various hulls traveling in waves and methodologies for predicting added resistance have been discussed using a variety computational fluid dynamic cfd program for a kvlcc2 the resistance performance in regular head waves was evaluated in research institutes by their own code or analysis software such as openfoam el moctar et al 2010 isis cfd solver guo et al 2011 surf ohashi et al 2013 cfdship iowa sadat hosseini et al 2010 wavis2 kim et al 2018 and star ccm lee et al 2019 in addition sadat hosseini et al 2013 conducted a systematic comparison of resistance performance through an experimental and numerical analysis conducted by various organizations of a kvlcc2 in head waves in the comparison it was clear that cfd estimates the added resistance well and it is easy to inspect the physical phenomena and interaction between the hull and fluid representatively the maximum excitation of the kvlcc2 was observed around  l p p 1 33 at f r 0 142 and the added resistance was largest in the wave conditions with maximum relative motion of the bow furthermore related studies have analysed the computation in oblique wave conditions islam et al 2019 the nominal wake induced by the stern shape in regular head wave conditions wu et al 2016 shin et al 2020 and the change of propeller kp458 performance in wave conditions jang et al 2020 in this study the main objective is performing the resistance and self propulsion tests with a kvlcc2 in regular head waves through cfd calculation the grid structures around the hull and forcing area applied for the effective calculations in wave condition are presented also it shows that the self propulsion test was possible in a regular wave using the virtual disk body force propeller method and through this the computation time is significantly reduced two velocities were adopted to consider different sea states 10 knots f r 0 092 was selected to take into account the lower operating speed in an actual seaway and 4 knots f r 0 037 was selected because it is introduced in res mepc 232 65 as the minimum navigational speed in adverse conditions in a self propulsion test a virtual disk that was verified with an experiment and a propeller model was applied for efficient calculations several wave lengths and two different wave steepness values were chosen as regular head wave conditions the self propulsion factors and required power for each wavelength estimated through the ittc 1978 performance prediction method were compared furthermore a load variation method that estimates the power using added resistance was applied and compared with the cfd self propulsion results 2 geometry analysis conditions the kvlcc2 hull form is similar to that of modern commercial ships the kvlcc2 was designed at kriso and can transport 300 000 tons of crude oil the propeller model was the kp458 model which is the original propeller for the kvlcc2 the geometry of the hull and propeller are shown in fig 1 the main dimensions are tabulated in table 1 and two different scale ratios 1 177 8 and 1 100 were considered for the experiment and numerical calculation respectively in this study the test conditions for measuring the resistance and self propulsion performance of ship are shown as table 2 among the conditions the case where the experiment was conducted is marked and the reason to perform the experiment up to the  l p p 1 1 which is due to the facility that can generate waves up to a maximum of 2 0 m in addition the self propulsion test was performed only limited conditions due to its complexity and it was hard to measure the resistance and thrust at 4 knots which was very slow on the other hand in terms of numerical calculations the analysis conditions were selected in consideration of computation time which leads the limited test cases more cases were selected at the point where the additional resistance peaked for each ship speed and the short wavelength and long wavelength regions were considered and in order to consider the effect of wave steepness h  two cases of 0 01 and 0 02 were tested at 10 knots and the other speeds were performed at 0 01 in addition this study is focused on 10 and 4 knots and 15 5 knots is the design speed of kvlcc2 and was selected to validate the performance in wave conditions 3 facilities of model test basin as a reference for the calculation an experiment was conducted at the inha university towing tank iutt iutt consists of a towing carriage wave maker beach type wave absorber and concrete tank that is 50 m long 4 m wide and 1 5 m deep as shown in fig 2 a the wave maker is a flap type and can generate regular waves with a maximum wavelength of 2 m and a wave height of 0 2 m the towing carriage is a cantilever type as shown in fig 2 b and can speed up to 5 m s as shown in table 1 the model ship is about 1 8 m long which is a sufficient size to avoid the blockage effect blockage ratio 1 in this towing tank as a measurement system a load cell and a motion measurement device were used and the resistance heave and pitch motion were measured in this study all experiments performed only heave and pitch are free 4 numerical methodology 4 1 governing equations to determine the motion for fluid flow the governing equations were the continuity equation and incompressible n s equation when the reynolds number increases in the flow the flow transitions from laminar to turbulent and exhibits complex behaviour the computation time needed to resolve small scale vortex motions in complex turbulent flows exponentially increases therefore we use the reynolds averaged navier stokes rans equations which solve the n s equation by dividing the complex behaviour into time averaged and variable components and then determine the mean flow quantities for an incompressible fluid the equations can be written in tensor form in cartesian coordinates 1 u i t u j u i x j 1  p x i 1  x j  u i x j  u i u j where u i is the three dimensional velocity vector i j 1 2 3 in the x y and z directions the flow variables are decomposed into the mean component u and the fluctuating component u p t  and  are the static pressure time density and dynamic viscosity respectively the last term in equation 1 is called the reynolds stress and has six unknown stresses due to the lack of relationship between stresses and the average value this nonlinear term is required to make linkages a common way is to use a turbulence model to close the rans equation through the assumption of unknown values or implementation of a semi empirical equation the realizable k epsilon turbulence model has been chosen which determines the turbulence dissipation rate  and turbulence kinematic energy t k e 4 2 numerical setup to evaluate the added resistance and conduct a self propulsion test in a regular head wave the commercial numerical computation program star ccm version 13 06 was used a dynamic fluid body interaction dfbi model was used for the movement of the hull and an overset mesh was used in consideration of the deformation of the grid system due to the wave which leads to larger movement of the hull in six degrees of freedom the heave and pitch motions were free while sway and yaw are fixed in order to capture the free surface the volume of fluid vof wave model with a high resolution interface capturing hric scheme has been chosen the boundary conditions used in this calculation were set to symmetry conditions of the y axis boundary because the hull is symmetrical in the case of resistance calculation as shown in fig 3 a in the case of the self propulsion calculation which is represented by fig 3 b the domain of the full width is used and the boundary conditions for the inlet both sides outlet bottom and top were set as velocity inlets for the hull no slip boundary conditions were chosen the grid distributions used in the added resistance and self propulsion tests in waves are shown in fig 3 a trimmer mesh that has an advantage of tracking the free surface was used we considered the part where the shape of the hull changes rapidly which leads to rapid flow change and the mesh was clustered around the stern and bow parts therefore the size of the mesh was decreased as shown in fig 3 c and d in the case of the finest mesh the area shown in orange is 3 125 of the base size of 0 02 l p p the dense area 6 25 of the base size is the green area which is arranged in the bow and stern parts the red area has a grid corresponding to four times its size within the same size of the domain 30 m 40 m cells were used for the half domain calculation in the case of the full one 60 m 80 m were used in this study the waves are generated with fifth order waves that governed by equation 2 which capture the waves realistically fenton 1985 and are functions of the wavelength wave height and depth of the water 2 k g 1 2 u 1 2  t g k 1 2 c 0 k d k h 2 2 c 2 k d k h 2 4 c 4 k d 0 where k 2   is the wavenumber  is the wavelength g is the gravity acceleration u 1 is the mean component of current in the direction of the wave h is the wave height t is the wave period that propagating in wave of constant depth d the quantities c 0 k d c 2 k d and c 4 k d are functions of the wavelength depth ratio the detailed formula for these quantities can be found in the work of fenton 1985 to describe a precise wave the finest mesh was implemented with roughly 100 cells 90 150 cells due to the variation of the wavelength per wavelength and around 20 cells 16 24 cells as presented by the blue band on the hull in fig 3 c similarly the sky blue and pale blue bands have mesh sizes that are two and four times the size of the finest area respectively the length of each area was applied as shown in fig 4 we used solution forcing in the velocity inlet boundary conditions to exclude the effect of the wave reflection at the boundary the forcing zone corresponding to half of l p p was applied to the area excluding the entrance and 0 8 l p p from the inlet boundary was applied as the appropriate length to minimize the attenuation of the incident wave and to consider the influence of the head waves the simulation is a transient simulation that has a first order temporal scheme for time discretization the motions and resistance were over estimated compared to the experimental results when using second order temporal discretization around 300 time steps t per encounter wave period t e were applied which results in a convective courant number lower than 1 0 except for the bow of the hull this simulation used the body force propeller method of the virtual disk model provided by star ccm this method does not directly resolve the propeller and it has the advantage of significantly reducing the calculation time because reducing the time step for accurate propeller simulation is not needed for the calculation to converge basically this method simply calculates the thrust and torque at the corresponding advance ratio firstly the advance ratio j should be determined at the sampled inflow plane which was specified at a position 0 1 r p away from the centre of the virtual disk secondly the thrust and torque are determined at the detected j and the force follows the goldstein optimum distribution along the blade line the goldstein load distribution follows equations 3 5 3 f b x a x r 1 r f b  a  r 1 r r 1 r h r h 4 a x 105 8 t   3 r h 4 r p r p r h a  105 8 q   r p 3 r h 4 r p r p r h 5 r r r h 1 r h r h r h r p r r r p where f b x is the body force component in axial direction f b  is the body force component in the tangential direction a x and a  are constants computed from the thrust and torque r is the specified radius in radial coordinates r h and r p are the hub radius and propeller radius respectively and  is the thickness of the virtual disk finally the axial and tangential forces are calculated along the span as shown in fig 5 and they vary in the radial direction to specify the span this method only requires the geometrical dimensions of the disk the inner diameter corresponding to the hub radius the outer radius and the thickness were set as 0 163 r p 1 005 r p and 0 1 r p respectively 5 validation verification 5 1 convergence test the results of computation highly depend on the time step and grid refinement in general the finer the grid and the lower the time step the more the convergence value is derived on the other hand because of the limited computing equipment the grid sizes and time steps should be compromised to get convergence value in this study the grid convergence index gci proposed by celik et al 2008 was applied to determine the degree of convergence in this study the convergence test was performed by selecting the conditions shown in table 3 to find what level of grid resolution and time step is appropriate the time step and grid size were selected for each of the three conditions first based on the coarse grid the time step was used as 0 1 0 01 and 0 05 and the grid size was tested with three sizes fine medium and coarse by changing the base size through the convergence test the resistance value tended to decrease as the time step and grid were reduced meanwhile the gci for the two variables is 0 005 and 0 121 respectively and it is judged that the values have sufficiently converged based on the test the subsequent analysis was performed by applying a time step of 0 005 and a grid size of 0 014 l p p which is the highest convergence value 5 2 resistance performance before performing self propulsion computation in waves step by step verification of the resistance self propulsion performance in calm water propeller open water test wave generation added resistance and motions is required to confirm the resistance performance and motion response of a ship in the calm water we used model test data from kriso and numerical calculations kim et al 2010 and the results are compared in table 4 the total resistance was 5 or less which is similar to the experiment but in the case of the motions the error rate is relatively large however when comparing absolute values the difference is smaller than 1 mm in the heave motion and the pitch motion shows a difference less than 0 1 in terms of the residuary resistance the pressure resistance is the biggest part and includes the wave resistance so a comparison of the wave distribution is one way to prove the resistance resulting from the waves indirectly otherwise it is difficult to separate the components of the wave resistance in the model experiments so quantitative comparison is not easy therefore a qualitative comparison of the wave pattern and profile around the hull and the experiment results were compared as shown fig 6 a and b kim et al 2001 the wave at the fore part and the wave at the stern shoulder are similar also a similar kelvin wave pattern to the experiment appears in the direction of the ship and wave profile also shows good agreement with the experiment the nominal wake is related to the propeller performance and self propulsion characteristics in fig 6 b the non dimensional velocity distribution that normalized by ship speed u 0 is compared with an experiment conducted by kim et al 2001 through stereoscopic particle image velocimetry spiv within the radius the velocity distribution is slightly faster than in the experiment the wake of the cfd calculation appears to be relatively smaller than the experiment this is interpreted as the difference due to the influence of the boundary layer the boundary layer can be determined by the turbulence model and affected by scale therefore the specific flow differs due to the turbulence model and scale used in this study otherwise it is considered reliable in terms of the overall flow tendency and inflow velocity especially flow back in the direction of the propeller hub called a hook shaped vortex was observed when comparing the nominal wake the result of the experiment was 0 561 and the present calculation result was 0 531 so the velocity of the flow is sufficiently similar 5 3 pow propeller open water test we need to confirm the performance of the virtual disk to validate the pow characteristics they were compared with the experimental results of nmri which a have scale ratio of 1 110 http www simman2008 dk kvlcc kvlcc2 kvlcc2 geometry html furthermore to compare the difference between using the propeller geometry and using virtual disk on cfd the results were compared in fig 7 the mesh distribution in each case is displayed and a sliding mesh was implemented for the propeller model shown in the blue area in fig 7 a this scheme divides the domain into moving and stationary zones and the moving zone moves according to the time step after that the updated data is exchanged through the interface with the same mesh distribution fig 7 b shows the virtual disk as a red area the numbers of meshes were 6 5 m for the propeller model and 3 m for the virtual disk respectively as a result of the obtained pow characteristics shown in fig 8 the torque coefficients show light deviation at low advance ratio but the values are similar to the nmri results it is thought that the pow performance depends on the refinement of the mesh due to the fact that the error rate was decreased to 1 in the fine grid number of meshes was 30 m the direct propeller and virtual disk results show a difference of less than 1 in fig 9 to observe how the virtual disk describes the properties of the propeller geometry the velocity and pressure are compared at x dp 0 148 where the inflow plane is and x dp 0 112 where the outflow plane is the advanced ratio used for comparison is 0 5 and the velocity distribution of the virtual disk has a constant tendency in the case of the propeller the time averaged value was observed in the case of the propeller model the propeller thickness and pitch angle for each radius are different which results in unique characteristics of the kp458 as shown in fig 9 similarly in the case of the virtual disk it follows an own characteristic of the goldstein optimum distribution the results are not exactly the same but show similar trends 5 4 self propulsion test in calm water in order to verify the applicability of the self propulsion test through the virtual disk the propulsive characteristics were compared with the experimental results and computation with the propeller model 6 f d 0 1 2  m v m 2 s m c f m c f s herein f d 0 is the towing force  m v m s m c f m are water density velocity wetted surface area and friction resistance coefficient with model scale respectively c f s denotes the friction resistance coefficient of a full scale ship in estimating the delivered horsepower dhp the frictional resistance coefficient is higher for the model ship than the full scale ship so the towing force f d 0 to correct it is calculated as shown in equation 6 the point where the calculated towing force is equal to the difference between the resistance and thrust obtained through a self propulsion test to find the self propulsion point a load variation test was performed to obtain the performance dependency by observing the tendency of the difference in the thrust and resistance according to the rate of the propeller revolutions n m while keeping the speed constant fig 10 shows the change of the towing force thrust t m and torque q m with 4 different propeller revolutions for the case of the virtual disk this process is the same as in the work of choi et al 2009 who corrected the self propulsion point by f d 0 table 5 compares the effects of the use of virtual disk ship speed and scale through a comparison of self propulsion factors in the calm water obtained through experiment and cfd first when using propeller and virtual disk on cfd the self propulsion test results are very similar on the other hand in the case of the propeller model it is necessary to reduce the time step so that the rotation angle of the propeller is 1 which results in accurate thrust and torque but this requires a long computation time and when considering the self propulsion test in the wave conditions the running time becomes too long the recommended encountered wave periods are at least 10 in ittc procedure 7 5 02 07 02 8 therefore when using the body force propeller method it is possible to obtain similar results to the propeller model without a time step adjustment which was double checked with the uniform flow in this calculation the calculation time was reduced by about 3 times in calm water when the same core was used which is more advantageous in wave conditions after verifying the self propulsion factors in fig 11 we observed whether the virtual disk exhibited flow characteristics similar to that of the propeller in the wake field the flow distribution was observed before entering the propeller x d p 0 1315 and after the propeller plane x d p 0 235 and the point at which x 0 which is the reference is the centre of the propeller hub the overall trend is similar but the characteristics of the propeller can be observed at x d p 0 235 when the propeller model is used a fast flow velocity is distributed on the right side due to the rotational direction of the propeller as shown in fig 11 e this trend is due to the angle of attack varies according to the pitch of each position of the propeller when it comes to the virtual disk an area where the velocity increases slightly appears on the right but the magnitude is weak and the pressure distribution is similar in both cases unlike propeller geometry the virtual disk is simply the result of the sum of the wake distribution and the virtual disk velocity distribution when using the virtual disk it should be noted that the above flow differences may occur secondly three different scales were selected to consider the effect of the scale in f r 0 142 the reason for the selection of the three scales was to investigate how the self propulsion factors could change depending on the scale because the scale of 100 considered in this study was different from that of the iutt of 177 8 scale when comparing the experimental results at the 58 scale and 177 8 scale with the case of using a virtual disk similar results are shown depending on the scale the change of self propulsion factors was not large but there is a difference in the thrust deduction factor the thrust deduction factor tends to increase as the scale increases this is thought of as the effect of the difference in the boundary layer which depends on the reynolds number the smaller the scale the larger the change in the stern pressure due to propeller rotation due to the larger boundary layer although the change of the boundary layer according to the scale other factors show similar trends regardless of scale when using a virtual disk through this it was verified the self propulsion performance of the virtual disk at 100 scale which has chosen in this study on the other hand in terms of the ship speed the change in self propulsion factors due to the decrease in speed was not large just wake fraction tends to increase due to the slowed flow velocity 5 5 added resistance self propulsion performance in waves the additional resistance coefficient and motion response were compared to verify the added resistance performance in the waves generated in the setting of the wave region first the present numerical results were compared with the experimental benchmark tests at the design speed f r 0 142 larsson et al 2013 park et al 2016 in fig 12 ou and snu indicate osaka university and seoul national university the experiment conducted in iutt shows a reliable value for each coefficient when it comes to 10 knots the result shows high coincidence with the iutt experiment in addition it was observed that the position of the peak point of the added resistance coefficient occurs at a lower wavelength as the line speed decreases and the motion response becomes lower after the wavelength at which the peak is reached for 4 knots the magnitude of the added resistance coefficient is similar to the iutt experiment but shows a difference in the peak and short wavelength results this is thought to be because it is difficult to measure the force that is relatively small in the low speed region and the short wavelength region during the experiment therefore the variation in the short wavelength region is large so it is evaluated that there is good agreement as a result of the comparison of this calculation to verify the self propulsion of the regular waves the dhp in calm and wave conditions was compared as shown in fig 13 the towing point in the wave was estimated using the same towing force as in the calm water the thrust identity method was used with the results of the pow model results that were verified in fig 8 the self propulsion factors and dhp were estimated through the ittc 1978 performance prediction method ittc procedure 7 5 02 03 01 4 for this procedure it is necessary to define the self propulsion point in waves but the forces acting on the ship fluctuate along with the wave such as the resistance thrust and torque therefore the forces are determined as the mean value in the wave obviously this method cannot reflect the interaction of a point where the force changes rapidly such as when a bow meets a crest or trough so it does not represent the detail therefore it is necessary to observe the interaction of the waves and hull with the wave phase in further study as shown in fig 12 the dhp obtained through cfd was compared with the experimental results from iutt performed under the same conditions and similar propensity of the dhp was observed according to the wave conditions particularly in conditions where the wave height is not high the difference in dhp is not large compared to the result in calm water under high crest conditions  l p p 0 9 h  0 02 almost 6 m at full scale dhp was increased more than 7 times compared to that in calm water it is thought that the amount of energy due to the wave depends on the wave height and wavelength and is proportional to the square of the wave height 6 results 6 1 load variation method changes in the self propulsion points in regular waves at 10 knots and 4 knots were calculated after verification and compared with the results estimated through the load variation method 7 f d w f d 0 r a w where f d 0 is the towing force in calm water f d w means the towing force in wave conditions and r a w is added resistance in wave conditions for the load variation method the added resistance is viewed as an external force that adjusts the target towing force as f d w which is calculated with equation 7 in this procedure it is assumed that the effect of the viscosity on the added resistance is relatively small because it predominantly occurs from non viscous phenomena such as the motion of the ship lee et al 2019 basically in terms of the propeller the wave conditions correspond to overload conditions compared to the calm water therefore the number of revolutions increases and the thrust and torque increase accordingly in waves the values of f d w are derived using the results of the added resistance computation as shown in fig 10 the load variation method uses the linear relationship between the thrust torque and propeller revolution according to the towing force adopting this linearity the obtained n m t m and q m values at the self propulsion point for each wavelength were compared to the cfd results the difference between them is displayed in fig 14 in the case of 10 knots the difference was relatively small near the towing force which is the centre of the 4 points used in the load variation test however in the case of the underload area located in the front region of the centre point the differences of n m t m and q m were large this region has a short wavelength range under low crest conditions and it is considered that the force acts nonlinearly due to the viscous effect in the overload range the point at which the target towing force is reduced from the centre of the 4 points corresponds to a long wavelength with h  0 01 and the wave conditions with h  0 02 in these conditions the agreement between t m and q m is considered high and they are interpreted as maintaining a linear relationship with the towing force however it was seen that the difference in n m increases at a long wavelength of h  0 02 where the wave height increases thus it is thought that the change in the force due to the increase in the wave height is not proportional to the number of revolutions gerritsma et al 1961 also suggested that the propeller revolutions do not have a linear relation with the total resistance in regular waves through an experiment for 4 knots the difference between the load variation and cfd results was around 5 percent it is thought that the range of the four points used in the load variation test is appropriate because of the relatively small increase in the added resistance due to the wave and the increase shows a similar trend regardless of the wavelength in conclusion the range of the load variation test seems to have an influence on the predicted force and propeller revolutions furthermore a wide test range is required in the case of a high wave height which showed a large change in the force 6 2 self propulsion characteristics the self propulsion factors were estimated according to each wavelength as shown in fig 15 first of all when it comes to the cfd results both the thrust deduction factor t and the wake fraction coefficient of the model w t m showed a tendency to decrease in a similar fashion to the increase in the added resistance at both speeds as the resistance is increased by waves t decreases indicating that the proportion of the increase in the resistance is greater than the increase in the thrust in addition when the ship moves along regular waves the flow velocity behind the hull changes regularly from the average of the regular changes the increase in the axial velocity is thought to be the cause shin et al 2020 suggested that the axial velocity of the propeller plane would be higher compared to that in calm water in these test conditions the propeller was sufficiently immersed and there was no interaction with the free surface paik 2017 indicated that the thrust and torque would be lower when the submerged depth decreases a decrease of the force on the propeller was indicated by lee and paik 2018 due to air ventilation which was generated when the propeller met the free surface therefore in the case of ballast conditions rather than full load a different tendency will occur in the wave conditions compared to the sufficiently submerged case the question here is whether the propeller performance can be well estimated even when a virtual disk is used when there is interaction with free surface when comparing the results of the load variation there is a difference from the results of cfd in particular at short wavelength the underload range a significant difference in t and w t m occurred and w t m was estimated to be low in the high wave height region the overload range this is due to the difference in t m in the short wavelength region in the case of high wave height it is viewed that the change in the flow velocity in the wave conditions is not greater than estimated in the load variation moreover such a change in the flow velocity requires an excessive increase in the propeller revolutions thereby showing a tendency to increase the relative rotative efficiency  r excluding this region the change of  r in the regular wave is not large at 4 knots the wake fraction was somewhat overestimated but similar self propulsion factors tended to occur because the self propulsion points were similar between cfd and load variation result the dhp result obtained through the ittc 1978 performance prediction method is compared in fig 16 it was assumed that the air resistance was the same regardless of the conditions of high wave height conditions it was shown that dhp increases with the same trend as the added resistance in addition at 10 knots the results from load variation were underestimated overall this is thought to be due to the difference of the estimated self propulsion point the 10 error rate bar shows error rates similar to the difference of the forces in fig 14 at each wavelength at 4 knots dhp was also increased and the cfd and load variation results showed less than a 5 difference which is a similar tendency to the self propulsion factors as a result when estimating the power through load variation it tends to be comparable to that of the cfd but the difference in the wavelength and wave height with a large increase in the resistance may increase generally the speed is proportional to the cube root of the power the required power levels at 10 knots and 4 knots have a difference of about 2 5 times and the required power is proportional to 6 5 times this is considered to be due to the speeds of 10 knots and 4 knots being in unusual low speed regions for the high wave height the cfd and load variation results show that dhp is almost 7 times higher than in calm water which corresponds to a beaufort number bn of 8 this suggests that a rapid increase in the power should be considered when the crest is high also in this rough sea situation bn was 6 at h  0 01 and  l p p was higher than 1 0 the ship s captain would consciously slow down known as voluntary speed loss and this reduced speed requires about 4000 kw of power as shown in fig 16 c this seems sufficient to escape the extreme conditions however since the waves of the seaway are irregular the required power in irregular waves will be predicted in the future 7 conclusions in this study self propulsion tests in waves were performed using incompressible rans equations and the computations were verified the results were compared with experiments and showed good agreement 1 we compared the flow and force of the body force propeller method following the goldstein optimum distribution to use a virtual disk for wave conditions we observed reliable flow and force results however when using this method characteristics such as the pitch angle for each position of the propeller model are not reflected 2 the added resistance varied with the wavelength and the largest added resistance coefficient was obtained at a wavelength close to the resonance frequency it was shown that the wavelength with the highest point decreased with the speed additionally it was shown that the added resistance at long wavelengths decreased with the speed but the value was similar to that at short wavelengths furthermore it was difficult to predict the added resistance in the short area due to the viscous effects 3 in the case of the thrust deduction factor and wake fraction in waves a tendency to decrease with the wave height was observed in comparison to the results in calm water this is considered to be due to an increase in the thrust due to an increase in the resistance acting on the hull as the wave height and the axial speed flowing into the propeller increase according to the motion response during the wave 4 the dhp in the regular waves increases compared to that in calm water conditions the increasing trend is the same as that of the added resistance coefficient graph through the difference in wave steepness the dhp is considerably increased when the wave energy is high as in harsh sea conditions 5 the self propulsion factors and power predicted by cfd were compared with results obtained using the load variation method overall the load variation method estimates the propulsive characters and power well but the results of the load variation method are influenced by the graph derived through the load variation test based on the centre point of the test the force was overestimated in the underload range and showed an error in the rotational speed in the overload region in a future study the required power in irregular waves will be estimated with various methods the flow characteristics in regular head wave conditions and the estimation method for the propulsive factors in regular waves will also be discussed credit authorship contribution statement soon hyun lee conceptualization writing original draft investigation formal analysis kwang jun paik conceptualization writing review editing supervision project administration hong sik hwang validation investigation myeong jin eom formal analysis investigation resources sang hyun kim writing review editing investigation resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research was funded by the development of co2 emission dfoc reduction technology for midsize ship under real operation 20007847 of the ministry of trade industry and energy republic of korea and a hrd program for global advanced engineer education program for future ocean structures no p0012646 supported by the competency development program for industry specialists of the korean ministry of trade industry and energy republic of korea 
20889,numerical analyses were performed on a kvlcc2 korea research institute of ships and ocean kriso very large crude oil carrier 2 at f r 0 092 and 0 037 in regular wave conditions a reynolds averaged navier stokes rans solver was applied with the finite volume method and a realizable k  model as a turbulence model the volume of fluid vof equation was solved to implement the free surface the body force propeller method of the virtual disk model was used to represent the effect of the propeller and reduce the computation time significantly resistance and self propulsion computations were carried out in calm water and regular head waves and the results were verified by comparing them to the added resistance and motions from experiments to find the trend of the delivered horsepower dhp in regular waves regular head waves from the short wave to long wave conditions with two different wave steepness were considered the load variation method was also performed using the obtained added resistance and the resulting self propulsion points were compared with the cfd results in each wave case the propulsive coefficients and dhp were also compared and we discuss the relationship between the thrust deduction factor and wake fraction factor according to the wave conditions keywords computational fluid dynamics cfd regular wave self propulsion test propulsive coefficient kvlcc2 added resistance delivered horsepower dhp virtual disk 1 introduction at the 45th meeting of the marine environment protection committee mepc in 2000 it was announced that shipping accounted for 3 3 of greenhouse gas ghg emissions in the world and carbon dioxide co2 accounted for 99 97 of the ghg at the 2009 mepc 59th conference co2 emissions from ships were expected to increase by 220 310 for the period of 2007 2050 hence the international maritime organization imo adopted the energy efficiency operational indicator eeoi and energy efficiency design index eedi to regulate co2 emissions the eedi is formulated using technical parameters that are required to increase the energy efficiency of vessels in order to increase the energy efficiency of a ship there are operational methods such as adjusting the operating speed of the ship or selecting a ship according to the cargo volume there are also design methods like improving the hull engine and propulsors to reduce drag and increase propulsion efficiency in consideration of the operating speed of a ship co2 emissions are reduced by about 23 when the speed decreases by about 10 there is clear evidence that the reduction of the speed corresponds to the cube root of engine power and relates to fuel consumption it was also estimated that an s 175 container ship sailing in the north atlantic recorded 15 increased co2 emissions in a seaway compared with calm water conditions prpi ori and faltinsen 2012 therefore one way to reduce co2 emissions is to design an energy efficient hull by considering more realistic situations rather than calm water one of the reasons for increasing engine power is that the total resistance increases when the ship is operating in wave conditions which is known as added resistance in the past many experimental and theoretical studies have been conducted to predict the added resistance and the importance of the operating efficiency of a ship has been re examined to improve the operating efficiency research on added resistance can be divided into experimental and numerical studies experimental approaches have been used to understand the motion that is produced by waves basic concepts for analysing the effects of waves were suggested in initial studies such as linear superposition of motion denis and pierson 1953 and vertical acceleration components lewis and bennet 1965 gerritsma et al 1961 indicated that waves coming towards a ship generate oscillating forces that have nonlinear properties these forces are generally divided into radiation forces and diffraction forces when a ship is moving up and down the surrounding water acts as a damper of the motions and propagates the energy which makes drifting forces on the hull alexandersson 2009 using series 60 parent hulls strm tejsen et al 1973 indicated that this hydrodynamic damping is largely influenced by heave and pitch motions and viscous damping can be neglected therefore the radiation force is regarded as dominating in motions and is usually bigger in long wave conditions and non viscous phenomena when testing with an s175 container ship it was pointed out that diffraction force occurs when a wave contacting a blunt ship bounces off the proportion of this force in the added resistance is relatively small but it is dominant in short wave conditions and hard to predict due to the non linearity fujii and takahashi 1975 experiments were conducted with a kvlcc2 hull korea research institute of ships and ocean kriso very large crude oil carrier 2 in the short wavelength region guo and steen 2012 and in various wavelength regions hwang et al 2013 further studies have been performed on the uncertainty of the added resistance measured by experiments park et al 2015 and the effect of the shape of the bow lee et al 2017 numerical research can be sorted into approaches based on empirical equations and potential theory and approaches based on solving the navier stokes n s equations that take into account the viscosity since empirical formulas have no iterative calculation process they have been developed for a relatively long time a method using energy or momentum conservation called the far field method was suggested to calculate the added resistance by maruo 1960 and gerritsma and beukelman 1972 this method generally estimates the added resistance in long waves well however the added resistance can be underestimated in short wave conditions and if the motion of a ship becomes excessive it is difficult to trust a pressure integration method called the near field method was proved by boese 1970 this method is a relatively simple method that integrates the pressure of the wetted surface of the hull which is called the control surface since this method uses the average receiving surface area in the wave conditions it is difficult to follow the effects of the instantaneous waves furthermore various approaches have been attempted to use correction factors based on previous studies or to introduce new concepts such as strip theory and a three dimensional panel method salvesen et al 1970 faltinsen et al 1980 fang 1991 papanikolaou et al 1992 journe and adegeest 2003 recently liu and papanikolaou 2016 2019 proposed a formula that can predict the added resistance relatively easily by combining a formula based on basic ship design parameters for short wave conditions and an approximate formula suggested by jinkine and ferdinanade 1974 for long ones this work can also cover a wide range of speeds and various draft conditions and particularly captures tankers well the importance of ship parameters to estimate added resistance has been mentioned frequently in previous studies cepowski 2020 proposed that artificial neural networks ann can be practically applied in the design stage by deriving the added resistance as an output value by inputting design parameters simulations are performed to model various hulls traveling in waves and methodologies for predicting added resistance have been discussed using a variety computational fluid dynamic cfd program for a kvlcc2 the resistance performance in regular head waves was evaluated in research institutes by their own code or analysis software such as openfoam el moctar et al 2010 isis cfd solver guo et al 2011 surf ohashi et al 2013 cfdship iowa sadat hosseini et al 2010 wavis2 kim et al 2018 and star ccm lee et al 2019 in addition sadat hosseini et al 2013 conducted a systematic comparison of resistance performance through an experimental and numerical analysis conducted by various organizations of a kvlcc2 in head waves in the comparison it was clear that cfd estimates the added resistance well and it is easy to inspect the physical phenomena and interaction between the hull and fluid representatively the maximum excitation of the kvlcc2 was observed around  l p p 1 33 at f r 0 142 and the added resistance was largest in the wave conditions with maximum relative motion of the bow furthermore related studies have analysed the computation in oblique wave conditions islam et al 2019 the nominal wake induced by the stern shape in regular head wave conditions wu et al 2016 shin et al 2020 and the change of propeller kp458 performance in wave conditions jang et al 2020 in this study the main objective is performing the resistance and self propulsion tests with a kvlcc2 in regular head waves through cfd calculation the grid structures around the hull and forcing area applied for the effective calculations in wave condition are presented also it shows that the self propulsion test was possible in a regular wave using the virtual disk body force propeller method and through this the computation time is significantly reduced two velocities were adopted to consider different sea states 10 knots f r 0 092 was selected to take into account the lower operating speed in an actual seaway and 4 knots f r 0 037 was selected because it is introduced in res mepc 232 65 as the minimum navigational speed in adverse conditions in a self propulsion test a virtual disk that was verified with an experiment and a propeller model was applied for efficient calculations several wave lengths and two different wave steepness values were chosen as regular head wave conditions the self propulsion factors and required power for each wavelength estimated through the ittc 1978 performance prediction method were compared furthermore a load variation method that estimates the power using added resistance was applied and compared with the cfd self propulsion results 2 geometry analysis conditions the kvlcc2 hull form is similar to that of modern commercial ships the kvlcc2 was designed at kriso and can transport 300 000 tons of crude oil the propeller model was the kp458 model which is the original propeller for the kvlcc2 the geometry of the hull and propeller are shown in fig 1 the main dimensions are tabulated in table 1 and two different scale ratios 1 177 8 and 1 100 were considered for the experiment and numerical calculation respectively in this study the test conditions for measuring the resistance and self propulsion performance of ship are shown as table 2 among the conditions the case where the experiment was conducted is marked and the reason to perform the experiment up to the  l p p 1 1 which is due to the facility that can generate waves up to a maximum of 2 0 m in addition the self propulsion test was performed only limited conditions due to its complexity and it was hard to measure the resistance and thrust at 4 knots which was very slow on the other hand in terms of numerical calculations the analysis conditions were selected in consideration of computation time which leads the limited test cases more cases were selected at the point where the additional resistance peaked for each ship speed and the short wavelength and long wavelength regions were considered and in order to consider the effect of wave steepness h  two cases of 0 01 and 0 02 were tested at 10 knots and the other speeds were performed at 0 01 in addition this study is focused on 10 and 4 knots and 15 5 knots is the design speed of kvlcc2 and was selected to validate the performance in wave conditions 3 facilities of model test basin as a reference for the calculation an experiment was conducted at the inha university towing tank iutt iutt consists of a towing carriage wave maker beach type wave absorber and concrete tank that is 50 m long 4 m wide and 1 5 m deep as shown in fig 2 a the wave maker is a flap type and can generate regular waves with a maximum wavelength of 2 m and a wave height of 0 2 m the towing carriage is a cantilever type as shown in fig 2 b and can speed up to 5 m s as shown in table 1 the model ship is about 1 8 m long which is a sufficient size to avoid the blockage effect blockage ratio 1 in this towing tank as a measurement system a load cell and a motion measurement device were used and the resistance heave and pitch motion were measured in this study all experiments performed only heave and pitch are free 4 numerical methodology 4 1 governing equations to determine the motion for fluid flow the governing equations were the continuity equation and incompressible n s equation when the reynolds number increases in the flow the flow transitions from laminar to turbulent and exhibits complex behaviour the computation time needed to resolve small scale vortex motions in complex turbulent flows exponentially increases therefore we use the reynolds averaged navier stokes rans equations which solve the n s equation by dividing the complex behaviour into time averaged and variable components and then determine the mean flow quantities for an incompressible fluid the equations can be written in tensor form in cartesian coordinates 1 u i t u j u i x j 1  p x i 1  x j  u i x j  u i u j where u i is the three dimensional velocity vector i j 1 2 3 in the x y and z directions the flow variables are decomposed into the mean component u and the fluctuating component u p t  and  are the static pressure time density and dynamic viscosity respectively the last term in equation 1 is called the reynolds stress and has six unknown stresses due to the lack of relationship between stresses and the average value this nonlinear term is required to make linkages a common way is to use a turbulence model to close the rans equation through the assumption of unknown values or implementation of a semi empirical equation the realizable k epsilon turbulence model has been chosen which determines the turbulence dissipation rate  and turbulence kinematic energy t k e 4 2 numerical setup to evaluate the added resistance and conduct a self propulsion test in a regular head wave the commercial numerical computation program star ccm version 13 06 was used a dynamic fluid body interaction dfbi model was used for the movement of the hull and an overset mesh was used in consideration of the deformation of the grid system due to the wave which leads to larger movement of the hull in six degrees of freedom the heave and pitch motions were free while sway and yaw are fixed in order to capture the free surface the volume of fluid vof wave model with a high resolution interface capturing hric scheme has been chosen the boundary conditions used in this calculation were set to symmetry conditions of the y axis boundary because the hull is symmetrical in the case of resistance calculation as shown in fig 3 a in the case of the self propulsion calculation which is represented by fig 3 b the domain of the full width is used and the boundary conditions for the inlet both sides outlet bottom and top were set as velocity inlets for the hull no slip boundary conditions were chosen the grid distributions used in the added resistance and self propulsion tests in waves are shown in fig 3 a trimmer mesh that has an advantage of tracking the free surface was used we considered the part where the shape of the hull changes rapidly which leads to rapid flow change and the mesh was clustered around the stern and bow parts therefore the size of the mesh was decreased as shown in fig 3 c and d in the case of the finest mesh the area shown in orange is 3 125 of the base size of 0 02 l p p the dense area 6 25 of the base size is the green area which is arranged in the bow and stern parts the red area has a grid corresponding to four times its size within the same size of the domain 30 m 40 m cells were used for the half domain calculation in the case of the full one 60 m 80 m were used in this study the waves are generated with fifth order waves that governed by equation 2 which capture the waves realistically fenton 1985 and are functions of the wavelength wave height and depth of the water 2 k g 1 2 u 1 2  t g k 1 2 c 0 k d k h 2 2 c 2 k d k h 2 4 c 4 k d 0 where k 2   is the wavenumber  is the wavelength g is the gravity acceleration u 1 is the mean component of current in the direction of the wave h is the wave height t is the wave period that propagating in wave of constant depth d the quantities c 0 k d c 2 k d and c 4 k d are functions of the wavelength depth ratio the detailed formula for these quantities can be found in the work of fenton 1985 to describe a precise wave the finest mesh was implemented with roughly 100 cells 90 150 cells due to the variation of the wavelength per wavelength and around 20 cells 16 24 cells as presented by the blue band on the hull in fig 3 c similarly the sky blue and pale blue bands have mesh sizes that are two and four times the size of the finest area respectively the length of each area was applied as shown in fig 4 we used solution forcing in the velocity inlet boundary conditions to exclude the effect of the wave reflection at the boundary the forcing zone corresponding to half of l p p was applied to the area excluding the entrance and 0 8 l p p from the inlet boundary was applied as the appropriate length to minimize the attenuation of the incident wave and to consider the influence of the head waves the simulation is a transient simulation that has a first order temporal scheme for time discretization the motions and resistance were over estimated compared to the experimental results when using second order temporal discretization around 300 time steps t per encounter wave period t e were applied which results in a convective courant number lower than 1 0 except for the bow of the hull this simulation used the body force propeller method of the virtual disk model provided by star ccm this method does not directly resolve the propeller and it has the advantage of significantly reducing the calculation time because reducing the time step for accurate propeller simulation is not needed for the calculation to converge basically this method simply calculates the thrust and torque at the corresponding advance ratio firstly the advance ratio j should be determined at the sampled inflow plane which was specified at a position 0 1 r p away from the centre of the virtual disk secondly the thrust and torque are determined at the detected j and the force follows the goldstein optimum distribution along the blade line the goldstein load distribution follows equations 3 5 3 f b x a x r 1 r f b  a  r 1 r r 1 r h r h 4 a x 105 8 t   3 r h 4 r p r p r h a  105 8 q   r p 3 r h 4 r p r p r h 5 r r r h 1 r h r h r h r p r r r p where f b x is the body force component in axial direction f b  is the body force component in the tangential direction a x and a  are constants computed from the thrust and torque r is the specified radius in radial coordinates r h and r p are the hub radius and propeller radius respectively and  is the thickness of the virtual disk finally the axial and tangential forces are calculated along the span as shown in fig 5 and they vary in the radial direction to specify the span this method only requires the geometrical dimensions of the disk the inner diameter corresponding to the hub radius the outer radius and the thickness were set as 0 163 r p 1 005 r p and 0 1 r p respectively 5 validation verification 5 1 convergence test the results of computation highly depend on the time step and grid refinement in general the finer the grid and the lower the time step the more the convergence value is derived on the other hand because of the limited computing equipment the grid sizes and time steps should be compromised to get convergence value in this study the grid convergence index gci proposed by celik et al 2008 was applied to determine the degree of convergence in this study the convergence test was performed by selecting the conditions shown in table 3 to find what level of grid resolution and time step is appropriate the time step and grid size were selected for each of the three conditions first based on the coarse grid the time step was used as 0 1 0 01 and 0 05 and the grid size was tested with three sizes fine medium and coarse by changing the base size through the convergence test the resistance value tended to decrease as the time step and grid were reduced meanwhile the gci for the two variables is 0 005 and 0 121 respectively and it is judged that the values have sufficiently converged based on the test the subsequent analysis was performed by applying a time step of 0 005 and a grid size of 0 014 l p p which is the highest convergence value 5 2 resistance performance before performing self propulsion computation in waves step by step verification of the resistance self propulsion performance in calm water propeller open water test wave generation added resistance and motions is required to confirm the resistance performance and motion response of a ship in the calm water we used model test data from kriso and numerical calculations kim et al 2010 and the results are compared in table 4 the total resistance was 5 or less which is similar to the experiment but in the case of the motions the error rate is relatively large however when comparing absolute values the difference is smaller than 1 mm in the heave motion and the pitch motion shows a difference less than 0 1 in terms of the residuary resistance the pressure resistance is the biggest part and includes the wave resistance so a comparison of the wave distribution is one way to prove the resistance resulting from the waves indirectly otherwise it is difficult to separate the components of the wave resistance in the model experiments so quantitative comparison is not easy therefore a qualitative comparison of the wave pattern and profile around the hull and the experiment results were compared as shown fig 6 a and b kim et al 2001 the wave at the fore part and the wave at the stern shoulder are similar also a similar kelvin wave pattern to the experiment appears in the direction of the ship and wave profile also shows good agreement with the experiment the nominal wake is related to the propeller performance and self propulsion characteristics in fig 6 b the non dimensional velocity distribution that normalized by ship speed u 0 is compared with an experiment conducted by kim et al 2001 through stereoscopic particle image velocimetry spiv within the radius the velocity distribution is slightly faster than in the experiment the wake of the cfd calculation appears to be relatively smaller than the experiment this is interpreted as the difference due to the influence of the boundary layer the boundary layer can be determined by the turbulence model and affected by scale therefore the specific flow differs due to the turbulence model and scale used in this study otherwise it is considered reliable in terms of the overall flow tendency and inflow velocity especially flow back in the direction of the propeller hub called a hook shaped vortex was observed when comparing the nominal wake the result of the experiment was 0 561 and the present calculation result was 0 531 so the velocity of the flow is sufficiently similar 5 3 pow propeller open water test we need to confirm the performance of the virtual disk to validate the pow characteristics they were compared with the experimental results of nmri which a have scale ratio of 1 110 http www simman2008 dk kvlcc kvlcc2 kvlcc2 geometry html furthermore to compare the difference between using the propeller geometry and using virtual disk on cfd the results were compared in fig 7 the mesh distribution in each case is displayed and a sliding mesh was implemented for the propeller model shown in the blue area in fig 7 a this scheme divides the domain into moving and stationary zones and the moving zone moves according to the time step after that the updated data is exchanged through the interface with the same mesh distribution fig 7 b shows the virtual disk as a red area the numbers of meshes were 6 5 m for the propeller model and 3 m for the virtual disk respectively as a result of the obtained pow characteristics shown in fig 8 the torque coefficients show light deviation at low advance ratio but the values are similar to the nmri results it is thought that the pow performance depends on the refinement of the mesh due to the fact that the error rate was decreased to 1 in the fine grid number of meshes was 30 m the direct propeller and virtual disk results show a difference of less than 1 in fig 9 to observe how the virtual disk describes the properties of the propeller geometry the velocity and pressure are compared at x dp 0 148 where the inflow plane is and x dp 0 112 where the outflow plane is the advanced ratio used for comparison is 0 5 and the velocity distribution of the virtual disk has a constant tendency in the case of the propeller the time averaged value was observed in the case of the propeller model the propeller thickness and pitch angle for each radius are different which results in unique characteristics of the kp458 as shown in fig 9 similarly in the case of the virtual disk it follows an own characteristic of the goldstein optimum distribution the results are not exactly the same but show similar trends 5 4 self propulsion test in calm water in order to verify the applicability of the self propulsion test through the virtual disk the propulsive characteristics were compared with the experimental results and computation with the propeller model 6 f d 0 1 2  m v m 2 s m c f m c f s herein f d 0 is the towing force  m v m s m c f m are water density velocity wetted surface area and friction resistance coefficient with model scale respectively c f s denotes the friction resistance coefficient of a full scale ship in estimating the delivered horsepower dhp the frictional resistance coefficient is higher for the model ship than the full scale ship so the towing force f d 0 to correct it is calculated as shown in equation 6 the point where the calculated towing force is equal to the difference between the resistance and thrust obtained through a self propulsion test to find the self propulsion point a load variation test was performed to obtain the performance dependency by observing the tendency of the difference in the thrust and resistance according to the rate of the propeller revolutions n m while keeping the speed constant fig 10 shows the change of the towing force thrust t m and torque q m with 4 different propeller revolutions for the case of the virtual disk this process is the same as in the work of choi et al 2009 who corrected the self propulsion point by f d 0 table 5 compares the effects of the use of virtual disk ship speed and scale through a comparison of self propulsion factors in the calm water obtained through experiment and cfd first when using propeller and virtual disk on cfd the self propulsion test results are very similar on the other hand in the case of the propeller model it is necessary to reduce the time step so that the rotation angle of the propeller is 1 which results in accurate thrust and torque but this requires a long computation time and when considering the self propulsion test in the wave conditions the running time becomes too long the recommended encountered wave periods are at least 10 in ittc procedure 7 5 02 07 02 8 therefore when using the body force propeller method it is possible to obtain similar results to the propeller model without a time step adjustment which was double checked with the uniform flow in this calculation the calculation time was reduced by about 3 times in calm water when the same core was used which is more advantageous in wave conditions after verifying the self propulsion factors in fig 11 we observed whether the virtual disk exhibited flow characteristics similar to that of the propeller in the wake field the flow distribution was observed before entering the propeller x d p 0 1315 and after the propeller plane x d p 0 235 and the point at which x 0 which is the reference is the centre of the propeller hub the overall trend is similar but the characteristics of the propeller can be observed at x d p 0 235 when the propeller model is used a fast flow velocity is distributed on the right side due to the rotational direction of the propeller as shown in fig 11 e this trend is due to the angle of attack varies according to the pitch of each position of the propeller when it comes to the virtual disk an area where the velocity increases slightly appears on the right but the magnitude is weak and the pressure distribution is similar in both cases unlike propeller geometry the virtual disk is simply the result of the sum of the wake distribution and the virtual disk velocity distribution when using the virtual disk it should be noted that the above flow differences may occur secondly three different scales were selected to consider the effect of the scale in f r 0 142 the reason for the selection of the three scales was to investigate how the self propulsion factors could change depending on the scale because the scale of 100 considered in this study was different from that of the iutt of 177 8 scale when comparing the experimental results at the 58 scale and 177 8 scale with the case of using a virtual disk similar results are shown depending on the scale the change of self propulsion factors was not large but there is a difference in the thrust deduction factor the thrust deduction factor tends to increase as the scale increases this is thought of as the effect of the difference in the boundary layer which depends on the reynolds number the smaller the scale the larger the change in the stern pressure due to propeller rotation due to the larger boundary layer although the change of the boundary layer according to the scale other factors show similar trends regardless of scale when using a virtual disk through this it was verified the self propulsion performance of the virtual disk at 100 scale which has chosen in this study on the other hand in terms of the ship speed the change in self propulsion factors due to the decrease in speed was not large just wake fraction tends to increase due to the slowed flow velocity 5 5 added resistance self propulsion performance in waves the additional resistance coefficient and motion response were compared to verify the added resistance performance in the waves generated in the setting of the wave region first the present numerical results were compared with the experimental benchmark tests at the design speed f r 0 142 larsson et al 2013 park et al 2016 in fig 12 ou and snu indicate osaka university and seoul national university the experiment conducted in iutt shows a reliable value for each coefficient when it comes to 10 knots the result shows high coincidence with the iutt experiment in addition it was observed that the position of the peak point of the added resistance coefficient occurs at a lower wavelength as the line speed decreases and the motion response becomes lower after the wavelength at which the peak is reached for 4 knots the magnitude of the added resistance coefficient is similar to the iutt experiment but shows a difference in the peak and short wavelength results this is thought to be because it is difficult to measure the force that is relatively small in the low speed region and the short wavelength region during the experiment therefore the variation in the short wavelength region is large so it is evaluated that there is good agreement as a result of the comparison of this calculation to verify the self propulsion of the regular waves the dhp in calm and wave conditions was compared as shown in fig 13 the towing point in the wave was estimated using the same towing force as in the calm water the thrust identity method was used with the results of the pow model results that were verified in fig 8 the self propulsion factors and dhp were estimated through the ittc 1978 performance prediction method ittc procedure 7 5 02 03 01 4 for this procedure it is necessary to define the self propulsion point in waves but the forces acting on the ship fluctuate along with the wave such as the resistance thrust and torque therefore the forces are determined as the mean value in the wave obviously this method cannot reflect the interaction of a point where the force changes rapidly such as when a bow meets a crest or trough so it does not represent the detail therefore it is necessary to observe the interaction of the waves and hull with the wave phase in further study as shown in fig 12 the dhp obtained through cfd was compared with the experimental results from iutt performed under the same conditions and similar propensity of the dhp was observed according to the wave conditions particularly in conditions where the wave height is not high the difference in dhp is not large compared to the result in calm water under high crest conditions  l p p 0 9 h  0 02 almost 6 m at full scale dhp was increased more than 7 times compared to that in calm water it is thought that the amount of energy due to the wave depends on the wave height and wavelength and is proportional to the square of the wave height 6 results 6 1 load variation method changes in the self propulsion points in regular waves at 10 knots and 4 knots were calculated after verification and compared with the results estimated through the load variation method 7 f d w f d 0 r a w where f d 0 is the towing force in calm water f d w means the towing force in wave conditions and r a w is added resistance in wave conditions for the load variation method the added resistance is viewed as an external force that adjusts the target towing force as f d w which is calculated with equation 7 in this procedure it is assumed that the effect of the viscosity on the added resistance is relatively small because it predominantly occurs from non viscous phenomena such as the motion of the ship lee et al 2019 basically in terms of the propeller the wave conditions correspond to overload conditions compared to the calm water therefore the number of revolutions increases and the thrust and torque increase accordingly in waves the values of f d w are derived using the results of the added resistance computation as shown in fig 10 the load variation method uses the linear relationship between the thrust torque and propeller revolution according to the towing force adopting this linearity the obtained n m t m and q m values at the self propulsion point for each wavelength were compared to the cfd results the difference between them is displayed in fig 14 in the case of 10 knots the difference was relatively small near the towing force which is the centre of the 4 points used in the load variation test however in the case of the underload area located in the front region of the centre point the differences of n m t m and q m were large this region has a short wavelength range under low crest conditions and it is considered that the force acts nonlinearly due to the viscous effect in the overload range the point at which the target towing force is reduced from the centre of the 4 points corresponds to a long wavelength with h  0 01 and the wave conditions with h  0 02 in these conditions the agreement between t m and q m is considered high and they are interpreted as maintaining a linear relationship with the towing force however it was seen that the difference in n m increases at a long wavelength of h  0 02 where the wave height increases thus it is thought that the change in the force due to the increase in the wave height is not proportional to the number of revolutions gerritsma et al 1961 also suggested that the propeller revolutions do not have a linear relation with the total resistance in regular waves through an experiment for 4 knots the difference between the load variation and cfd results was around 5 percent it is thought that the range of the four points used in the load variation test is appropriate because of the relatively small increase in the added resistance due to the wave and the increase shows a similar trend regardless of the wavelength in conclusion the range of the load variation test seems to have an influence on the predicted force and propeller revolutions furthermore a wide test range is required in the case of a high wave height which showed a large change in the force 6 2 self propulsion characteristics the self propulsion factors were estimated according to each wavelength as shown in fig 15 first of all when it comes to the cfd results both the thrust deduction factor t and the wake fraction coefficient of the model w t m showed a tendency to decrease in a similar fashion to the increase in the added resistance at both speeds as the resistance is increased by waves t decreases indicating that the proportion of the increase in the resistance is greater than the increase in the thrust in addition when the ship moves along regular waves the flow velocity behind the hull changes regularly from the average of the regular changes the increase in the axial velocity is thought to be the cause shin et al 2020 suggested that the axial velocity of the propeller plane would be higher compared to that in calm water in these test conditions the propeller was sufficiently immersed and there was no interaction with the free surface paik 2017 indicated that the thrust and torque would be lower when the submerged depth decreases a decrease of the force on the propeller was indicated by lee and paik 2018 due to air ventilation which was generated when the propeller met the free surface therefore in the case of ballast conditions rather than full load a different tendency will occur in the wave conditions compared to the sufficiently submerged case the question here is whether the propeller performance can be well estimated even when a virtual disk is used when there is interaction with free surface when comparing the results of the load variation there is a difference from the results of cfd in particular at short wavelength the underload range a significant difference in t and w t m occurred and w t m was estimated to be low in the high wave height region the overload range this is due to the difference in t m in the short wavelength region in the case of high wave height it is viewed that the change in the flow velocity in the wave conditions is not greater than estimated in the load variation moreover such a change in the flow velocity requires an excessive increase in the propeller revolutions thereby showing a tendency to increase the relative rotative efficiency  r excluding this region the change of  r in the regular wave is not large at 4 knots the wake fraction was somewhat overestimated but similar self propulsion factors tended to occur because the self propulsion points were similar between cfd and load variation result the dhp result obtained through the ittc 1978 performance prediction method is compared in fig 16 it was assumed that the air resistance was the same regardless of the conditions of high wave height conditions it was shown that dhp increases with the same trend as the added resistance in addition at 10 knots the results from load variation were underestimated overall this is thought to be due to the difference of the estimated self propulsion point the 10 error rate bar shows error rates similar to the difference of the forces in fig 14 at each wavelength at 4 knots dhp was also increased and the cfd and load variation results showed less than a 5 difference which is a similar tendency to the self propulsion factors as a result when estimating the power through load variation it tends to be comparable to that of the cfd but the difference in the wavelength and wave height with a large increase in the resistance may increase generally the speed is proportional to the cube root of the power the required power levels at 10 knots and 4 knots have a difference of about 2 5 times and the required power is proportional to 6 5 times this is considered to be due to the speeds of 10 knots and 4 knots being in unusual low speed regions for the high wave height the cfd and load variation results show that dhp is almost 7 times higher than in calm water which corresponds to a beaufort number bn of 8 this suggests that a rapid increase in the power should be considered when the crest is high also in this rough sea situation bn was 6 at h  0 01 and  l p p was higher than 1 0 the ship s captain would consciously slow down known as voluntary speed loss and this reduced speed requires about 4000 kw of power as shown in fig 16 c this seems sufficient to escape the extreme conditions however since the waves of the seaway are irregular the required power in irregular waves will be predicted in the future 7 conclusions in this study self propulsion tests in waves were performed using incompressible rans equations and the computations were verified the results were compared with experiments and showed good agreement 1 we compared the flow and force of the body force propeller method following the goldstein optimum distribution to use a virtual disk for wave conditions we observed reliable flow and force results however when using this method characteristics such as the pitch angle for each position of the propeller model are not reflected 2 the added resistance varied with the wavelength and the largest added resistance coefficient was obtained at a wavelength close to the resonance frequency it was shown that the wavelength with the highest point decreased with the speed additionally it was shown that the added resistance at long wavelengths decreased with the speed but the value was similar to that at short wavelengths furthermore it was difficult to predict the added resistance in the short area due to the viscous effects 3 in the case of the thrust deduction factor and wake fraction in waves a tendency to decrease with the wave height was observed in comparison to the results in calm water this is considered to be due to an increase in the thrust due to an increase in the resistance acting on the hull as the wave height and the axial speed flowing into the propeller increase according to the motion response during the wave 4 the dhp in the regular waves increases compared to that in calm water conditions the increasing trend is the same as that of the added resistance coefficient graph through the difference in wave steepness the dhp is considerably increased when the wave energy is high as in harsh sea conditions 5 the self propulsion factors and power predicted by cfd were compared with results obtained using the load variation method overall the load variation method estimates the propulsive characters and power well but the results of the load variation method are influenced by the graph derived through the load variation test based on the centre point of the test the force was overestimated in the underload range and showed an error in the rotational speed in the overload region in a future study the required power in irregular waves will be estimated with various methods the flow characteristics in regular head wave conditions and the estimation method for the propulsive factors in regular waves will also be discussed credit authorship contribution statement soon hyun lee conceptualization writing original draft investigation formal analysis kwang jun paik conceptualization writing review editing supervision project administration hong sik hwang validation investigation myeong jin eom formal analysis investigation resources sang hyun kim writing review editing investigation resources declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research was funded by the development of co2 emission dfoc reduction technology for midsize ship under real operation 20007847 of the ministry of trade industry and energy republic of korea and a hrd program for global advanced engineer education program for future ocean structures no p0012646 supported by the competency development program for industry specialists of the korean ministry of trade industry and energy republic of korea 
