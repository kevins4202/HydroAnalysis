index,text
21180,the static load test method is currently the standard horizontal bearing capacity test for offshore foundation piles the static load test method requires extensive testing time high equipment cost and uses equipment sensitive to environmental conditions as offshore wind power piles increase in diameter the static load test method becomes increasingly cumbersome to use in this contribution a single pile model test under the action of static force and impact was carried out based on the m method the dynamic and static transformation relationship of m value in the test was explored and a new lateral dynamic load test method for offshore piles is proposed the new method employs the in situ ship impact impulse test method the m value dynamic static ratio m value under dynamic force m value under static force exhibits a quadratic parabolic distribution relative to horizontal displacement and external load the m value under impact can be converted into the equivalent static m value which can be used to analyze the pile soil interaction and evaluate the pile horizontal bearing capacity keywords horizontal bearing capacity m method dynamic static ratio offshore piles 1 introduction in china the construction of offshore wind power projects has developed rapidly and single pile foundations have been widely used in offshore wind power construction single piles used as offshore wind turbine foundations need to bear the combined effect of various horizontal loads such as wind waves and current pile soil interactions under horizontal load are of key significance bi 2017 at present pile soil interactions under horizontal load can be examined using the m method p y curve method and finite element method deng and carter 2002 matlock 1970 mostafa and naggar 2004 muthukkumaran and arun 2015 xie et al 2017 bi et al 2018 the m method is a linear elastic foundation reaction method which assumes that the soil horizontal foundation resistance coefficient increases linearly with depth that is k mz and the m value should be determined using the horizontal static load test for a single pile the horizontal static load test refers to the method of applying horizontal thrust at the top of the pile and observing the horizontal displacement of the pile top with time to determine the horizontal bearing capacity of a single pile jts 215 2018 2018 when the horizontal static load test is carried out at sea the horizontal load generally applied to the pile is provided by a reaction force device and reaction force platform reference pile and reference beam are placed around the engineering test pile jts 237 2017 2017 li et al 2019 the static load test has strict test environment requirements in actual operation the reference beam undergoes large deformation due to temperature differences which has a significant influence on the static load test result as pile diameter increases horizontal bearing capacity increases the horizontal bearing capacity static load test for offshore wind power piles has a compilated loading method and increased loading tonnage the china rudong offshore wind farm project carried out the horizontal static load test for single pile with a diameter of 2800 mm fig 1 the project costs tens of millions rmb lasting several months wang et al 2018 at present pile horizontal bearing capacity evaluation methods are based on static results obtained using the static load test the key to analyzing pile soil interactions using the m method is determining the m value the horizontal static load test for offshore piles has issues with increased testing time and high equipment cost this contribution presents a single pile model test under a static force and impact davisson and salley 1970 poulos 1971 abendroth and greimann 1990 ismael 1990 pan et al 2000 dyson and randolph 2001 hajialilue bonab et al 2013 the m values of the two tests are compared and analyzed also the dynamic and static transformation relationship of the m value was examined furthermore a method of assessing the horizontal bearing capacity of offshore piles using the impulse test method for in situ ship impact test piles is proposed 2 single pile model test under the action of a static force and impact in order to analyze the mechanical properties of a pile under horizontal static and dynamic loads the m value under the static force and impact must be determined this contribution examines the single pile model under the action of a static force and impact 2 1 test model tank in this test a test model tank was specially constructed with pulleys on both sides of the test tank two piles can be tested at the same time which significantly reduces the required manpower and time spent filling the tank fig 2 to determine the appropriate scale factors such as test site actual pile size and test accuracy need to be comprehensively taken into account at present the size of model test tank is roughly 2 m the model test tank is rectangular 2 m length 1 m width 2 m height in size and is primarily composed of steel plate and plexiglass figs 3 and 4 in order to ensure the strength of the model groove the bottom front and back of the test tank is composed of 10 mm thick steel plate the left and right side panels are composed of steel plate and plexiglass the plexiglass plate is the same thickness as the bottom of the test tank and the test tank is welded with six channel steels to support the outside of the plexiglass plate in this way the plexiglass will only undergo extremely small lateral deformation and ensure the safety of the model in addition the test tank is equipped with two sand outlets which can be used to discharge the sand in the test tank 2 2 test material in order to more accurately simulate large diameter long piles the pile diameter is set to 2000 mm in this test a length diameter ratio of 45 1 is used as the control condition for the model test geometry scale qian et al used a model reduction scale of 1 75 to study the load transfer law along the pile body and the status of stress distribution in the soil around pile and the test results are consistent with the general rules of field tests qian et al 2012 considering the large pile size we suggest that the model reduction scale should be 1 75 to 1 25 the model reduction scale of this test is set as 1 50 considering the similar stiffness condition the test uses a circular hollow aluminum tube as the model pile the length of the pile is 1 8 m the thickness of the tube wall is 3 mm and the diameter of the model pile is 40 mm xiong et al 2008 xiang et al 2010 luo et al 2011 qian et al 2012 the bending stiffness of the model pile is determined by loading in a cantilever beam and is set to 5163 097 n m2 referring to the existing research on pile models medium coarse sand is used as the test soil for this test the test soil parameters are listed in table 1 2 3 loading device during the test a horizontal force is applied to the model pile by pulling a cable using a weighted tray a static load is applied using a weight on a pallet 10 kg weights are loaded in 14 steps successive the impact load is applied using a free falling mass with height and weight 5 kg and 10 kg weights are used for the impact load which are freely dropped from 10 cm 20 cm 30 cm 40 cm and 50 cm the impact load is measured using an acquisition frequency of 5000 hz 2 4 measuring device the test parameters that need to be measured include the horizontal load at the pile top displacement of the pile top displacement of the mud surface and strain on the pile body 1 horizontal load at the pile top the test employs a self made full bridge strain type force sensor the force sensor layout is shown in fig 5 2 displacement of the pile top and mud surface a dial indicator with a 50 mm range and the electronic displacement meter model gefran py 2 are installed at the pile top and on mud surface to measure the displacement of the pile top and mud surface respectively in the static load test the pile top and mud surface displacement is measured using a dial indicator which is fixed on the steel beam in the dynamic load test the displacement time history curve is determined using an electronic displacement meter fig 6 3 strain on the pile body in the indoor model test pile body strain is commonly obtained using a strain gauge on the model pile in this test a bx120 3aa type resistance strain gauge is used the strain gauge has a resistance of 120 0 1 ω grid width grid length of 2 mm 3 mm and sensitivity parameter of 2 08 the strain gauge location is shown in fig 7 in this test a tmr 200 multi channel dynamic strain gauge is used to collect the strain value at each point during the measurement the pile body strain gauge displacement sensor and force sensor are connected to the dynamic strain gauge at the same time and the data is output synchronously 3 processing and analysis of test results 3 1 test data processing method force and displacement were the primary test measurements the direct measured force data includes the horizontal load at the pile top and the direct measured displacement data includes the horizontal displacement of the pile tip horizontal displacement at the mud surface position and pile strain the bending moment value displacement value pile rotation angle value and soil resistance can be obtained indirectly from the measured strain value position of the pile tip and displacement at the mud surface position the soil resistance coefficient can be calculated from the soil resistance and pile displacement 1 calculation of the mud surface rotation during the test the pile top and mud surface horizontal displacement are measured based on the difference between the pile top and mud surface displacement y and the distance between the two measuring points l the mud surface rotation can be approximated as 1 θ tan 1 δ y l 2 calculation of pile bending moment the pile bending moment is calculated using measured strain value in this test the tensile strain and compressive strain at the measuring points of the pile test sections are obtained using strain gauges and the bending moment of the corresponding section is calculated from the section bending strain ε ε ε the bending moment is calculated according to eq 2 2 m e i ε b 0 where b 0 is the measuring point spacing of the tensile strain and compressive strain of the same test section unit m ei is the pile bending stiffness unit n m2 3 calculation of pile rotation and deflection during the test the horizontal displacement of the pile top and the mud surface as well as the strain on the pile is directly measured the pile rotation at the mud surface and the pile bending moment can be calculated using eqs 1 and 2 respectively the pile rotation and deflection curve can be obtained by calculating the bending strain of each test section assuming that the bending between adjacent test sections forms a linear distribution fig 8 the bending strain at nodes i and i 1 in the differential section are ε i and ε i 1 respectively the strain at distance x from node i is 3 δ ε δ ε i δ ε i 1 δ ε i x l i 4 e i d 2 y d x 2 m substituting eqs 2 and 3 into eq 4 gives 5 d 2 y d x 2 1 b 0 ε i ε i 1 ε i x l i according to the relationship θ d y d x the rotation and displacement of each section can be obtained by integrating eq 5 once and twice respectively 6 θ i 1 θ i ε i 1 ε i l i 2 b 0 7 y i 1 y i θ i l i δ ε i 1 2 δ ε i l i 2 ε b o where ei is the pile bending stiffness unit kn m2 ε i 1 and ε i are the bending strains of section i 1 and i respectively θ i 1 and θ i are the rotations of section i 1 and i respectively unit rad y i 1 and y i are the horizontal displacements of section i 1 and i respectively unit m the deflection and rotation of each section can be obtained using eqs 6 and 7 respectively the integral starting point of the middle and long piles is the pile tip where the rotation is 0 and the initial displacement is also 0 mud surface displacement in the static load test was measured using a dial gauge comparison of measured values and calculated values of the mud displacement is listed in table 2 the horizontal displacement of the pile calculated using eqs 6 and 7 is reasonable 4 calculation of soil resistance the common method for calculating soil resistance involves obtaining the distribution curve of the soil resistance p using the quadratic differential of the pile bending moment m 8 d 2 m d z 2 b p where b is the width or diameter of the pile unit m z is the depth unit m using eq 8 to determine soil resistance requires accurate bending moment value measurements although error can be reduced by encrypting the pile test section and increasing the quantity of strain gauges the measured bending moment value will still fluctuate therefore it is necessary to smooth the bending moment so that the bending moment under the action of soil resistance is a smooth curve before the smoothing process the bending moments obtained by the test should be inserted equidistantly along the pile in this contribution the five point slip difference method recommended in the pile and pile foundation handbook shi 2012 is used to deal with the horizontal soil resistance p of the pile soil interaction the steps to determine the soil resistance p are as follows a smooth processing the computational expression of the five point slip difference is 9 m z 0 2 h m z 0 h m z 0 m z 0 h m z 0 2 h 1 70 69 4 6 4 1 4 54 24 16 4 6 24 34 24 6 4 16 24 54 4 1 4 6 4 69 m z 0 2 h m z 0 h m z 0 m z 0 h m z 0 2 h where m is the bending moment for each point on the pile after insertion m is the bending moment for each point of the pile after smoothing z 0 is the distance from smooth section to the mud surface h is the length of the difference step b calculation of shear force the shear force on the pile q is obtained by determining the first derivative of the smoothed bending moment 10 q z 0 2 h q z 0 h q z 0 q z 0 h q z 0 2 h 1 20 h 21 13 17 9 0 11 3 7 1 0 4 2 0 2 4 0 1 7 3 11 0 9 17 13 21 m z 0 2 h m z 0 h m z 0 m z 0 h m z 0 2 h c calculation of soil resistance the soil resistance p is obtained by dividing the first derivative of the shear force by the pile width 11 p z 0 2 h p z 0 h p z 0 p z 0 h p z 0 2 h 1 20 h b 21 13 17 9 0 11 3 7 1 0 4 2 0 2 4 0 1 7 3 11 0 9 17 13 21 q z 0 2 h q z 0 h q z 0 q z 0 h q z 0 2 h the first and second lines of the matrix are used to calculate the first and second sections of the mud surface the fourth and fifth lines of the matrix are used to calculate the last two sections of the pile tip the third line is used to calculate the rest sections 3 2 analysis of static loading test 1 analysis of pile bending moment the upper part of the model pile is where the pile bending moment is concentrated the greater the horizontal load value is the greater the pile bending moment will be the position of the maximum pile bending moment varies from 2 5 d to 5 d below the mud surface in addition with increasing horizontal load the depth of the bending moment zero point exhibits a significant downward trend from 64 92 cm to 77 25 cm below the mud surface i e from 16 d to 19 d indicating that the model pile satisfies the working characteristics of elastic long pile fig 9 2 analysis of pile deflection under varying load levels the upper part of the model pile is the primary displacement area the first zero displacement of the pile varies from 40 cm to 45 cm below the mud surface i e from 10 d to 11 d also the displacement of the lower part of the pile is small fig 10 3 analysis of pile lateral soil resistance distribution the pile lateral soil resistance distribution is obtained by determining the quadratic differential of the pile bending moment the pile lateral soil resistance along the pile length first increases and then decreases the maximum soil reaction value is at a certain depth near the mud surface and with increasing load the maximum soil reaction is transferred to the deep soil the resistance of the topsoil first increases and then decreases reflecting the topsoil change from elastic to plastic failure as the load increases fig 11 4 analysis of soil resistance coefficient the horizontal soil resistance coefficient can be obtained by dividing the soil resistance by the corresponding pile deflection the soil horizontal resistance coefficient increases almost linearly along the pile length and as the load increases the horizontal resistance coefficient gradually decreases indicating that as the load increases the soil compression deformation increases and soil resistance to the model pile decreases fig 12 3 3 analysis of impact loading test 1 analysis of impact time history of the pile top after data processing the impact force time history results are obtained fig 13 for convenience of analysis the first pulse impact is taken as the research object the impact force data is fitted to reduce error caused by the sensor s lacking sensitivity the impulse history of each weight falling at different heights is given in fig 14 2 analysis of displacement time history of the pile tip with increasing impact height the pile tip displacement significantly increased and the displacement pulse duration was 0 04 s under the impact of a 5 kg weight the maximum pile top displacement was 9 5 mm under the impact of a 10 kg weight the maximum pile top displacement was 18 mm fig 15 3 analysis of displacement time history of the mud surface with increasing impact height the mud surface displacement increased significantly and the displacement pulse duration was 0 04 s under the impact of a 5 kg weight the maximum mud surface displacement was 4 5 mm under the impact of a 10 kg weight the maximum mud surface displacement was 8 5 mm fig 16 3 4 dynamic and static equivalent of dynamic load in real applications a large part of the external load on the pile foundation exists in a dynamic form when the pile is subjected to an external impact load the impact force varies based on time in this contribution the concept of equivalent static load is applied to the dynamic and static equivalent of impact force kang 2002 choi et al 2005 under the impact force the pile and soil structure will generate a displacement field the maximum displacement condition and thus the maximum displacement moment of the impact load is considered in this contribution the maximum displacement under the impact load is taken as the impact load displacement field under an assumed static force under the action of the static force the displacement field generated by the pile and soil structure is equal to the maximum displacement under the impact force the static force is the equivalent static force of the dynamic impact force based on the displacement equivalent at present equivalent static load calculation methods primarily include the pulse equivalent method global average method and partial average method the advantage of the equivalent static load method is that it can ignore the time factor and only consider the load value the difference between the three methods lies in the length of the selected time period in this contribution the pulse equivalent method is used to calculate the equivalent static load el tawil 2005 cui 2014 1 the pulse equivalent method the pulse equivalent method was proposed by chopra 1996 in his book dynamics of structures theory and application to earthquake engineering the pulse force refers to a force whose action time is very short and the time integral is a finite value according to newton s second law for a force acting on an object with mass m the momentum change of the object is equal to the action impulse 12 d d t m u p when the mass is constant eq 12 can be written as 13 p m u integrating the variable t eq 13 can be written as 14 t 1 t 2 p d t m u 2 u 1 m u i the impulse magnitude is equal to the change in momentum damping has little effect on the response to pulse forces chopra 1996 the impact force begins to be divided into a forced vibration phase and free vibration phase when the forced vibration phase ends the free vibration phase begins the pile model subjected to horizontal impact loads can be simplified to an undamped mass spring system fig 17 the dynamic equation of the model of the pile subjected to horizontal impact load is 15 m u k u p t the displacement value of the forced vibration phase can be obtained using the static initial condition u 0 u 0 0 the displacement value of the free vibration phases can be obtained using the same analytical solution method and the maximum displacement of the structural reaction is the maximum value of the displacement in the forced vibration phase and free vibration phase if t d pulse duration is less than t n 2 half the structural period the overall maximum response of the system occurs in the free vibration phase the response of the system to this impact is the unit impulse response of the undamped system reaction multiplied by the impulse i e 16 u t i 1 m ω n sin ω n t where ω n is the load frequency unit hz i is the unit pulse load impulse unit hz t is the pulse duration unit s then the maximum structural deformation is given by 17 u max i m ω n 2 π i k t n based on the definition of displacement equivalent when the structure is subjected to impact load the static force f s required to produce the maximum displacement u max is 18 f s k u max 2 π i t n 2 π i f where f is the first order natural frequency of the structure unit hz a calculation of resonance frequency in this contribution the finite element calculation software abaqus is used to simulate resonance frequency and the winkel spring model is used to analyze pile soil interactions in order to ensure the accuracy of the resonance frequency calculation a three dimensional solid element and a three dimensional linear beam element are used to calculate the resonance frequency figs 18 and 19 the abaqus finite element model is constructed using the 3d solid model and the 3d beam element model with resonant frequencies of 9 248 hz and 9 012 hz respectively and an average value of 9 13 hz the natural period t n is 0 1095 s b calculation of unit pulse impulse in the impact load loading test only the first pulse impact force was examined for the measured time history of the pile top impact the impulse of the first pulse i can be calculated using eq 19 and the peak value of each impact load and the unit pulse are listed in table 3 19 i 0 t f d t d t c equivalent static result because the time t d under the impact load for each working condition in this contribution is 0 04s t d 1 2 t n the test is suited to the pulse equivalent method the equivalent static force results are calculated using the pulse equivalent method using eq 18 and the test impulse values for table 3 are listed in table 4 2 equivalent static load displacement curve the equivalent static results obtained using the pulse equivalent method and the maximum pile top displacement data of each impact test are taken as the force value and displacement value for the equivalent static load displacement curve the equivalent static load displacement curve for the pile top and test static load displacement curve are shown in fig 20 the two curves are in good agreement although some differences exist the equivalent static load curve can be used to determine the horizontal bearing capacity of foundation piles 4 study on dynamic and static equivalent of the m method the pile soil interaction analysis was carried out using the m method according to construction code for wharf structures jts 215 2018 the m value should be determined using the single pile horizontal static load test in this section we examine the relationship between horizontal load and mud surface displacement under static and dynamic loads finding that the pile soil interaction can be converted into static and dynamic equivalents static m value and dynamic m value can be obtained from the soil resistance coefficient calculated using the static load and impact load tests respectively the equivalent conversion relationship between dynamic m and static m is analyzed based on the mud surface displacement 4 1 relationship between horizontal load and mud surface displacement under the model pile horizontal static and dynamic loads the relationship between the measured horizontal load on the pile top and the measured mud surface displacement is shown in fig 21 only the increasing section of the load is analyzed under horizontal static and dynamic loads when the load displacement curve of the model pile is within 1 mm of the mud surface displacement the horizontal load on the pile top and the mud surface displacement are linear and the static and dynamic load curves are basically the same fig 20 when mud surface displacement is greater than 1 mm the mud surface displacement under the dynamic load is significantly smaller than the corresponding static load mud surface displacement the dynamic load displacement curves under various dynamic loads are basically the same indicating that under dynamic load the influence of the peak applied load and the loading rate is relatively small and the pile soil interaction can be converted into static and dynamic equivalents for fitting the dynamic load data in fig 21 the relationship between horizontal dynamic load and mud surface displacement is 20 f d 10 56 y 0 2 321 45 y 0 19 92 where f d is the dynamic horizontal load unit n y 0 is the mud surface horizontal displacement unit mm 4 2 dynamic and static equivalent of m value based on mud surface displacement the m method considers that the horizontal foundation resistance coefficient and soil depth are linear and the horizontal foundation resistance coefficient increases with increasing depth according to the static load and impact load test the soil resistance p can be calculated using eq 11 and the corresponding m value under each static and dynamic load can be obtained 21 m p y z where y is the horizontal displacement at the measuring point unit m z is the depth at the measuring point unit m for convenience of expression the concept of the m value dynamic static ratio is introduced η is given by 22 η m d m s where m d is the m value under dynamic load unit kn m4 m s is the m value under static load unit kn m4 1 static and dynamic equivalent m value at the same mud surface horizontal displacement taking the mud surface displacement at the horizontal static load of each level as reference we calculate the dynamic m value of the soil at the moment of the same mud surface displacement under each impact load and compare it with the corresponding static load m value when horizontal static load is small the pile soil interaction is small and the soil resistance is not fully exerted the calculated horizontal resistance coefficient cannot reflect the interaction of soil and pile therefore the calculations of static m value for the 10 kg and 20 kg static load are not listed the mud surface displacement under the horizontal static load for each level is listed in table 5 and the comparison of analytical dynamic and static m values is shown in fig 22 when the mud surface displacement is greater than 1 mm the dynamic static ratio of m value fluctuates within a fixed interval fig 22 and η can be obtained by fitting the data as follows 23 η m d m s 0 01 y 0 2 0 1 y 0 1 where y 0 is the mud surface horizontal displacement unit mm the curve of eq 23 is plotted in fig 22 it can be seen from eq 23 that when the mud surface displacement is less than 1 mm the static and dynamic m values are similar and considered to be the same in this case 2 static and dynamic equivalent of m value at the same horizontal load taking the horizontal static load value of each level as reference we calculate the dynamic m value of the soil at the same loading moment under each impact load and compare it with the corresponding static load m value fig 23 combining eq 20 with eq 23 to find the relationship between η and horizontal load and omitting the high order terms gives 24 η m d m s 3 45 10 7 f d 2 2 9 10 4 f d 0 99 the curve of eq 24 is plotted in fig 23 the curve of eq 24 still falls within the data point interval and the data points themselves are somewhat discrete which may be related to the error in dynamic load selection fig 23 comparing eq 23 and eq 24 we propose that eq 23 is the dynamic and static equivalent method based on the m method the relationship between dynamic static ratio of m value and displacement exhibits a parabolic distribution 5 dynamic test method for offshore pile horizontal bearing capacity in order to solve the problems of long time use high equipment cost and sensitivity of testing equipment to environmental conditions this contribution proposes a dynamic test method for horizontal bearing capacity of offshore piles which employs the on site ship impact test the pile impulse test method replaces the traditional static load test method the ship impact test method uses the impact impulse of the ship impact test pile as the horizontal thrust applied to the test pile and then evaluates the pile horizontal bearing capacity horizontal bearing capacity assessment process is shown in fig 24 5 1 equivalent static load displacement curve according to on site ship impact test data equivalent static results can be obtained using the pulse equivalent method and the maximum pile top displacement data can be calculated by integration the equivalent static load curve can be used to evaluate the horizontal bearing capacity of foundation piles in engineering applications 5 2 dynamic and static equivalent of m value according to the soil resistance and displacement data processing formula in the pile and pile foundation handbook the dynamic soil resistance and dynamic displacement values can be obtained and the dynamic m value can be calculated according to the relationship between the m value dynamic static ratio and displacement obtained in the laboratory test the equivalent static force m value can be obtained and the horizontal bearing capacity can be evaluated based on the technical code for building pile foundations jgj 94 2008 2018 6 conclusions at present the static load test is the primary method for testing the horizontal bearing capacity of piles in china the static load test requires significant financial and material resources and the test time is quite long in this contribution static and impact tests on a single pile model are carried out and the dynamic and static transformation relationship of m value in the test is explored using the m method a new dynamic test method for horizontal bearing capacity of offshore piles is proposed which uses an on site ship impact test pile based on the test results and theoretical research the following conclusions can be drawn 1 the measured dynamic m value is greater than the measured static m value the dynamic static ratio of m value increases with increasing the horizontal displacement the dynamic static ratio of m value increases with external load both exhibit a quadratic parabolic distribution 2 the transformation of dynamic time history force into equivalent static force primarily involves the global average method the partial average method and the pulse equivalent method test data show that the pulse equivalent method used in this impact test can more effectively convert the dynamic time history force into equivalent static force the pile top equivalent static load displacement curve obtained by the pulse equivalent method is in good agreement with test static load displacement curve and can be used to evaluate the horizontal bearing capacity of foundation piles in engineering applications 3 this contribution puts forward the concept of the m value dynamic static ratio results show that the relationship between the m value dynamic static ratio and mud surface displacement forms a parabolic distribution the measured dynamic m value can be converted into the equivalent static m value and dynamic horizontal bearing capacity testing of the pile is feasible 4 this contribution proposes a new dynamic test method for pile horizontal bearing capacity and introduces the detailed process of dynamic test in practical application the dynamic and static equivalent formulas for pile soil interactions proposed in this contribution are derived from the soil in this test owing to the complexity of the soil the usability of this new test method should be examined further credit authorship contribution statement jin peng wang conceptualization writing original draft visualization jing bo su conceptualization writing review editing feng wu resources zheng zhang methodology data curation yaru lv writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the support of the national natural science foundation of china grant no 51679081 the natural science foundation of jiangsu province no bk20171399 and the central universities fund operating expenses no b200202119 
21180,the static load test method is currently the standard horizontal bearing capacity test for offshore foundation piles the static load test method requires extensive testing time high equipment cost and uses equipment sensitive to environmental conditions as offshore wind power piles increase in diameter the static load test method becomes increasingly cumbersome to use in this contribution a single pile model test under the action of static force and impact was carried out based on the m method the dynamic and static transformation relationship of m value in the test was explored and a new lateral dynamic load test method for offshore piles is proposed the new method employs the in situ ship impact impulse test method the m value dynamic static ratio m value under dynamic force m value under static force exhibits a quadratic parabolic distribution relative to horizontal displacement and external load the m value under impact can be converted into the equivalent static m value which can be used to analyze the pile soil interaction and evaluate the pile horizontal bearing capacity keywords horizontal bearing capacity m method dynamic static ratio offshore piles 1 introduction in china the construction of offshore wind power projects has developed rapidly and single pile foundations have been widely used in offshore wind power construction single piles used as offshore wind turbine foundations need to bear the combined effect of various horizontal loads such as wind waves and current pile soil interactions under horizontal load are of key significance bi 2017 at present pile soil interactions under horizontal load can be examined using the m method p y curve method and finite element method deng and carter 2002 matlock 1970 mostafa and naggar 2004 muthukkumaran and arun 2015 xie et al 2017 bi et al 2018 the m method is a linear elastic foundation reaction method which assumes that the soil horizontal foundation resistance coefficient increases linearly with depth that is k mz and the m value should be determined using the horizontal static load test for a single pile the horizontal static load test refers to the method of applying horizontal thrust at the top of the pile and observing the horizontal displacement of the pile top with time to determine the horizontal bearing capacity of a single pile jts 215 2018 2018 when the horizontal static load test is carried out at sea the horizontal load generally applied to the pile is provided by a reaction force device and reaction force platform reference pile and reference beam are placed around the engineering test pile jts 237 2017 2017 li et al 2019 the static load test has strict test environment requirements in actual operation the reference beam undergoes large deformation due to temperature differences which has a significant influence on the static load test result as pile diameter increases horizontal bearing capacity increases the horizontal bearing capacity static load test for offshore wind power piles has a compilated loading method and increased loading tonnage the china rudong offshore wind farm project carried out the horizontal static load test for single pile with a diameter of 2800 mm fig 1 the project costs tens of millions rmb lasting several months wang et al 2018 at present pile horizontal bearing capacity evaluation methods are based on static results obtained using the static load test the key to analyzing pile soil interactions using the m method is determining the m value the horizontal static load test for offshore piles has issues with increased testing time and high equipment cost this contribution presents a single pile model test under a static force and impact davisson and salley 1970 poulos 1971 abendroth and greimann 1990 ismael 1990 pan et al 2000 dyson and randolph 2001 hajialilue bonab et al 2013 the m values of the two tests are compared and analyzed also the dynamic and static transformation relationship of the m value was examined furthermore a method of assessing the horizontal bearing capacity of offshore piles using the impulse test method for in situ ship impact test piles is proposed 2 single pile model test under the action of a static force and impact in order to analyze the mechanical properties of a pile under horizontal static and dynamic loads the m value under the static force and impact must be determined this contribution examines the single pile model under the action of a static force and impact 2 1 test model tank in this test a test model tank was specially constructed with pulleys on both sides of the test tank two piles can be tested at the same time which significantly reduces the required manpower and time spent filling the tank fig 2 to determine the appropriate scale factors such as test site actual pile size and test accuracy need to be comprehensively taken into account at present the size of model test tank is roughly 2 m the model test tank is rectangular 2 m length 1 m width 2 m height in size and is primarily composed of steel plate and plexiglass figs 3 and 4 in order to ensure the strength of the model groove the bottom front and back of the test tank is composed of 10 mm thick steel plate the left and right side panels are composed of steel plate and plexiglass the plexiglass plate is the same thickness as the bottom of the test tank and the test tank is welded with six channel steels to support the outside of the plexiglass plate in this way the plexiglass will only undergo extremely small lateral deformation and ensure the safety of the model in addition the test tank is equipped with two sand outlets which can be used to discharge the sand in the test tank 2 2 test material in order to more accurately simulate large diameter long piles the pile diameter is set to 2000 mm in this test a length diameter ratio of 45 1 is used as the control condition for the model test geometry scale qian et al used a model reduction scale of 1 75 to study the load transfer law along the pile body and the status of stress distribution in the soil around pile and the test results are consistent with the general rules of field tests qian et al 2012 considering the large pile size we suggest that the model reduction scale should be 1 75 to 1 25 the model reduction scale of this test is set as 1 50 considering the similar stiffness condition the test uses a circular hollow aluminum tube as the model pile the length of the pile is 1 8 m the thickness of the tube wall is 3 mm and the diameter of the model pile is 40 mm xiong et al 2008 xiang et al 2010 luo et al 2011 qian et al 2012 the bending stiffness of the model pile is determined by loading in a cantilever beam and is set to 5163 097 n m2 referring to the existing research on pile models medium coarse sand is used as the test soil for this test the test soil parameters are listed in table 1 2 3 loading device during the test a horizontal force is applied to the model pile by pulling a cable using a weighted tray a static load is applied using a weight on a pallet 10 kg weights are loaded in 14 steps successive the impact load is applied using a free falling mass with height and weight 5 kg and 10 kg weights are used for the impact load which are freely dropped from 10 cm 20 cm 30 cm 40 cm and 50 cm the impact load is measured using an acquisition frequency of 5000 hz 2 4 measuring device the test parameters that need to be measured include the horizontal load at the pile top displacement of the pile top displacement of the mud surface and strain on the pile body 1 horizontal load at the pile top the test employs a self made full bridge strain type force sensor the force sensor layout is shown in fig 5 2 displacement of the pile top and mud surface a dial indicator with a 50 mm range and the electronic displacement meter model gefran py 2 are installed at the pile top and on mud surface to measure the displacement of the pile top and mud surface respectively in the static load test the pile top and mud surface displacement is measured using a dial indicator which is fixed on the steel beam in the dynamic load test the displacement time history curve is determined using an electronic displacement meter fig 6 3 strain on the pile body in the indoor model test pile body strain is commonly obtained using a strain gauge on the model pile in this test a bx120 3aa type resistance strain gauge is used the strain gauge has a resistance of 120 0 1 ω grid width grid length of 2 mm 3 mm and sensitivity parameter of 2 08 the strain gauge location is shown in fig 7 in this test a tmr 200 multi channel dynamic strain gauge is used to collect the strain value at each point during the measurement the pile body strain gauge displacement sensor and force sensor are connected to the dynamic strain gauge at the same time and the data is output synchronously 3 processing and analysis of test results 3 1 test data processing method force and displacement were the primary test measurements the direct measured force data includes the horizontal load at the pile top and the direct measured displacement data includes the horizontal displacement of the pile tip horizontal displacement at the mud surface position and pile strain the bending moment value displacement value pile rotation angle value and soil resistance can be obtained indirectly from the measured strain value position of the pile tip and displacement at the mud surface position the soil resistance coefficient can be calculated from the soil resistance and pile displacement 1 calculation of the mud surface rotation during the test the pile top and mud surface horizontal displacement are measured based on the difference between the pile top and mud surface displacement y and the distance between the two measuring points l the mud surface rotation can be approximated as 1 θ tan 1 δ y l 2 calculation of pile bending moment the pile bending moment is calculated using measured strain value in this test the tensile strain and compressive strain at the measuring points of the pile test sections are obtained using strain gauges and the bending moment of the corresponding section is calculated from the section bending strain ε ε ε the bending moment is calculated according to eq 2 2 m e i ε b 0 where b 0 is the measuring point spacing of the tensile strain and compressive strain of the same test section unit m ei is the pile bending stiffness unit n m2 3 calculation of pile rotation and deflection during the test the horizontal displacement of the pile top and the mud surface as well as the strain on the pile is directly measured the pile rotation at the mud surface and the pile bending moment can be calculated using eqs 1 and 2 respectively the pile rotation and deflection curve can be obtained by calculating the bending strain of each test section assuming that the bending between adjacent test sections forms a linear distribution fig 8 the bending strain at nodes i and i 1 in the differential section are ε i and ε i 1 respectively the strain at distance x from node i is 3 δ ε δ ε i δ ε i 1 δ ε i x l i 4 e i d 2 y d x 2 m substituting eqs 2 and 3 into eq 4 gives 5 d 2 y d x 2 1 b 0 ε i ε i 1 ε i x l i according to the relationship θ d y d x the rotation and displacement of each section can be obtained by integrating eq 5 once and twice respectively 6 θ i 1 θ i ε i 1 ε i l i 2 b 0 7 y i 1 y i θ i l i δ ε i 1 2 δ ε i l i 2 ε b o where ei is the pile bending stiffness unit kn m2 ε i 1 and ε i are the bending strains of section i 1 and i respectively θ i 1 and θ i are the rotations of section i 1 and i respectively unit rad y i 1 and y i are the horizontal displacements of section i 1 and i respectively unit m the deflection and rotation of each section can be obtained using eqs 6 and 7 respectively the integral starting point of the middle and long piles is the pile tip where the rotation is 0 and the initial displacement is also 0 mud surface displacement in the static load test was measured using a dial gauge comparison of measured values and calculated values of the mud displacement is listed in table 2 the horizontal displacement of the pile calculated using eqs 6 and 7 is reasonable 4 calculation of soil resistance the common method for calculating soil resistance involves obtaining the distribution curve of the soil resistance p using the quadratic differential of the pile bending moment m 8 d 2 m d z 2 b p where b is the width or diameter of the pile unit m z is the depth unit m using eq 8 to determine soil resistance requires accurate bending moment value measurements although error can be reduced by encrypting the pile test section and increasing the quantity of strain gauges the measured bending moment value will still fluctuate therefore it is necessary to smooth the bending moment so that the bending moment under the action of soil resistance is a smooth curve before the smoothing process the bending moments obtained by the test should be inserted equidistantly along the pile in this contribution the five point slip difference method recommended in the pile and pile foundation handbook shi 2012 is used to deal with the horizontal soil resistance p of the pile soil interaction the steps to determine the soil resistance p are as follows a smooth processing the computational expression of the five point slip difference is 9 m z 0 2 h m z 0 h m z 0 m z 0 h m z 0 2 h 1 70 69 4 6 4 1 4 54 24 16 4 6 24 34 24 6 4 16 24 54 4 1 4 6 4 69 m z 0 2 h m z 0 h m z 0 m z 0 h m z 0 2 h where m is the bending moment for each point on the pile after insertion m is the bending moment for each point of the pile after smoothing z 0 is the distance from smooth section to the mud surface h is the length of the difference step b calculation of shear force the shear force on the pile q is obtained by determining the first derivative of the smoothed bending moment 10 q z 0 2 h q z 0 h q z 0 q z 0 h q z 0 2 h 1 20 h 21 13 17 9 0 11 3 7 1 0 4 2 0 2 4 0 1 7 3 11 0 9 17 13 21 m z 0 2 h m z 0 h m z 0 m z 0 h m z 0 2 h c calculation of soil resistance the soil resistance p is obtained by dividing the first derivative of the shear force by the pile width 11 p z 0 2 h p z 0 h p z 0 p z 0 h p z 0 2 h 1 20 h b 21 13 17 9 0 11 3 7 1 0 4 2 0 2 4 0 1 7 3 11 0 9 17 13 21 q z 0 2 h q z 0 h q z 0 q z 0 h q z 0 2 h the first and second lines of the matrix are used to calculate the first and second sections of the mud surface the fourth and fifth lines of the matrix are used to calculate the last two sections of the pile tip the third line is used to calculate the rest sections 3 2 analysis of static loading test 1 analysis of pile bending moment the upper part of the model pile is where the pile bending moment is concentrated the greater the horizontal load value is the greater the pile bending moment will be the position of the maximum pile bending moment varies from 2 5 d to 5 d below the mud surface in addition with increasing horizontal load the depth of the bending moment zero point exhibits a significant downward trend from 64 92 cm to 77 25 cm below the mud surface i e from 16 d to 19 d indicating that the model pile satisfies the working characteristics of elastic long pile fig 9 2 analysis of pile deflection under varying load levels the upper part of the model pile is the primary displacement area the first zero displacement of the pile varies from 40 cm to 45 cm below the mud surface i e from 10 d to 11 d also the displacement of the lower part of the pile is small fig 10 3 analysis of pile lateral soil resistance distribution the pile lateral soil resistance distribution is obtained by determining the quadratic differential of the pile bending moment the pile lateral soil resistance along the pile length first increases and then decreases the maximum soil reaction value is at a certain depth near the mud surface and with increasing load the maximum soil reaction is transferred to the deep soil the resistance of the topsoil first increases and then decreases reflecting the topsoil change from elastic to plastic failure as the load increases fig 11 4 analysis of soil resistance coefficient the horizontal soil resistance coefficient can be obtained by dividing the soil resistance by the corresponding pile deflection the soil horizontal resistance coefficient increases almost linearly along the pile length and as the load increases the horizontal resistance coefficient gradually decreases indicating that as the load increases the soil compression deformation increases and soil resistance to the model pile decreases fig 12 3 3 analysis of impact loading test 1 analysis of impact time history of the pile top after data processing the impact force time history results are obtained fig 13 for convenience of analysis the first pulse impact is taken as the research object the impact force data is fitted to reduce error caused by the sensor s lacking sensitivity the impulse history of each weight falling at different heights is given in fig 14 2 analysis of displacement time history of the pile tip with increasing impact height the pile tip displacement significantly increased and the displacement pulse duration was 0 04 s under the impact of a 5 kg weight the maximum pile top displacement was 9 5 mm under the impact of a 10 kg weight the maximum pile top displacement was 18 mm fig 15 3 analysis of displacement time history of the mud surface with increasing impact height the mud surface displacement increased significantly and the displacement pulse duration was 0 04 s under the impact of a 5 kg weight the maximum mud surface displacement was 4 5 mm under the impact of a 10 kg weight the maximum mud surface displacement was 8 5 mm fig 16 3 4 dynamic and static equivalent of dynamic load in real applications a large part of the external load on the pile foundation exists in a dynamic form when the pile is subjected to an external impact load the impact force varies based on time in this contribution the concept of equivalent static load is applied to the dynamic and static equivalent of impact force kang 2002 choi et al 2005 under the impact force the pile and soil structure will generate a displacement field the maximum displacement condition and thus the maximum displacement moment of the impact load is considered in this contribution the maximum displacement under the impact load is taken as the impact load displacement field under an assumed static force under the action of the static force the displacement field generated by the pile and soil structure is equal to the maximum displacement under the impact force the static force is the equivalent static force of the dynamic impact force based on the displacement equivalent at present equivalent static load calculation methods primarily include the pulse equivalent method global average method and partial average method the advantage of the equivalent static load method is that it can ignore the time factor and only consider the load value the difference between the three methods lies in the length of the selected time period in this contribution the pulse equivalent method is used to calculate the equivalent static load el tawil 2005 cui 2014 1 the pulse equivalent method the pulse equivalent method was proposed by chopra 1996 in his book dynamics of structures theory and application to earthquake engineering the pulse force refers to a force whose action time is very short and the time integral is a finite value according to newton s second law for a force acting on an object with mass m the momentum change of the object is equal to the action impulse 12 d d t m u p when the mass is constant eq 12 can be written as 13 p m u integrating the variable t eq 13 can be written as 14 t 1 t 2 p d t m u 2 u 1 m u i the impulse magnitude is equal to the change in momentum damping has little effect on the response to pulse forces chopra 1996 the impact force begins to be divided into a forced vibration phase and free vibration phase when the forced vibration phase ends the free vibration phase begins the pile model subjected to horizontal impact loads can be simplified to an undamped mass spring system fig 17 the dynamic equation of the model of the pile subjected to horizontal impact load is 15 m u k u p t the displacement value of the forced vibration phase can be obtained using the static initial condition u 0 u 0 0 the displacement value of the free vibration phases can be obtained using the same analytical solution method and the maximum displacement of the structural reaction is the maximum value of the displacement in the forced vibration phase and free vibration phase if t d pulse duration is less than t n 2 half the structural period the overall maximum response of the system occurs in the free vibration phase the response of the system to this impact is the unit impulse response of the undamped system reaction multiplied by the impulse i e 16 u t i 1 m ω n sin ω n t where ω n is the load frequency unit hz i is the unit pulse load impulse unit hz t is the pulse duration unit s then the maximum structural deformation is given by 17 u max i m ω n 2 π i k t n based on the definition of displacement equivalent when the structure is subjected to impact load the static force f s required to produce the maximum displacement u max is 18 f s k u max 2 π i t n 2 π i f where f is the first order natural frequency of the structure unit hz a calculation of resonance frequency in this contribution the finite element calculation software abaqus is used to simulate resonance frequency and the winkel spring model is used to analyze pile soil interactions in order to ensure the accuracy of the resonance frequency calculation a three dimensional solid element and a three dimensional linear beam element are used to calculate the resonance frequency figs 18 and 19 the abaqus finite element model is constructed using the 3d solid model and the 3d beam element model with resonant frequencies of 9 248 hz and 9 012 hz respectively and an average value of 9 13 hz the natural period t n is 0 1095 s b calculation of unit pulse impulse in the impact load loading test only the first pulse impact force was examined for the measured time history of the pile top impact the impulse of the first pulse i can be calculated using eq 19 and the peak value of each impact load and the unit pulse are listed in table 3 19 i 0 t f d t d t c equivalent static result because the time t d under the impact load for each working condition in this contribution is 0 04s t d 1 2 t n the test is suited to the pulse equivalent method the equivalent static force results are calculated using the pulse equivalent method using eq 18 and the test impulse values for table 3 are listed in table 4 2 equivalent static load displacement curve the equivalent static results obtained using the pulse equivalent method and the maximum pile top displacement data of each impact test are taken as the force value and displacement value for the equivalent static load displacement curve the equivalent static load displacement curve for the pile top and test static load displacement curve are shown in fig 20 the two curves are in good agreement although some differences exist the equivalent static load curve can be used to determine the horizontal bearing capacity of foundation piles 4 study on dynamic and static equivalent of the m method the pile soil interaction analysis was carried out using the m method according to construction code for wharf structures jts 215 2018 the m value should be determined using the single pile horizontal static load test in this section we examine the relationship between horizontal load and mud surface displacement under static and dynamic loads finding that the pile soil interaction can be converted into static and dynamic equivalents static m value and dynamic m value can be obtained from the soil resistance coefficient calculated using the static load and impact load tests respectively the equivalent conversion relationship between dynamic m and static m is analyzed based on the mud surface displacement 4 1 relationship between horizontal load and mud surface displacement under the model pile horizontal static and dynamic loads the relationship between the measured horizontal load on the pile top and the measured mud surface displacement is shown in fig 21 only the increasing section of the load is analyzed under horizontal static and dynamic loads when the load displacement curve of the model pile is within 1 mm of the mud surface displacement the horizontal load on the pile top and the mud surface displacement are linear and the static and dynamic load curves are basically the same fig 20 when mud surface displacement is greater than 1 mm the mud surface displacement under the dynamic load is significantly smaller than the corresponding static load mud surface displacement the dynamic load displacement curves under various dynamic loads are basically the same indicating that under dynamic load the influence of the peak applied load and the loading rate is relatively small and the pile soil interaction can be converted into static and dynamic equivalents for fitting the dynamic load data in fig 21 the relationship between horizontal dynamic load and mud surface displacement is 20 f d 10 56 y 0 2 321 45 y 0 19 92 where f d is the dynamic horizontal load unit n y 0 is the mud surface horizontal displacement unit mm 4 2 dynamic and static equivalent of m value based on mud surface displacement the m method considers that the horizontal foundation resistance coefficient and soil depth are linear and the horizontal foundation resistance coefficient increases with increasing depth according to the static load and impact load test the soil resistance p can be calculated using eq 11 and the corresponding m value under each static and dynamic load can be obtained 21 m p y z where y is the horizontal displacement at the measuring point unit m z is the depth at the measuring point unit m for convenience of expression the concept of the m value dynamic static ratio is introduced η is given by 22 η m d m s where m d is the m value under dynamic load unit kn m4 m s is the m value under static load unit kn m4 1 static and dynamic equivalent m value at the same mud surface horizontal displacement taking the mud surface displacement at the horizontal static load of each level as reference we calculate the dynamic m value of the soil at the moment of the same mud surface displacement under each impact load and compare it with the corresponding static load m value when horizontal static load is small the pile soil interaction is small and the soil resistance is not fully exerted the calculated horizontal resistance coefficient cannot reflect the interaction of soil and pile therefore the calculations of static m value for the 10 kg and 20 kg static load are not listed the mud surface displacement under the horizontal static load for each level is listed in table 5 and the comparison of analytical dynamic and static m values is shown in fig 22 when the mud surface displacement is greater than 1 mm the dynamic static ratio of m value fluctuates within a fixed interval fig 22 and η can be obtained by fitting the data as follows 23 η m d m s 0 01 y 0 2 0 1 y 0 1 where y 0 is the mud surface horizontal displacement unit mm the curve of eq 23 is plotted in fig 22 it can be seen from eq 23 that when the mud surface displacement is less than 1 mm the static and dynamic m values are similar and considered to be the same in this case 2 static and dynamic equivalent of m value at the same horizontal load taking the horizontal static load value of each level as reference we calculate the dynamic m value of the soil at the same loading moment under each impact load and compare it with the corresponding static load m value fig 23 combining eq 20 with eq 23 to find the relationship between η and horizontal load and omitting the high order terms gives 24 η m d m s 3 45 10 7 f d 2 2 9 10 4 f d 0 99 the curve of eq 24 is plotted in fig 23 the curve of eq 24 still falls within the data point interval and the data points themselves are somewhat discrete which may be related to the error in dynamic load selection fig 23 comparing eq 23 and eq 24 we propose that eq 23 is the dynamic and static equivalent method based on the m method the relationship between dynamic static ratio of m value and displacement exhibits a parabolic distribution 5 dynamic test method for offshore pile horizontal bearing capacity in order to solve the problems of long time use high equipment cost and sensitivity of testing equipment to environmental conditions this contribution proposes a dynamic test method for horizontal bearing capacity of offshore piles which employs the on site ship impact test the pile impulse test method replaces the traditional static load test method the ship impact test method uses the impact impulse of the ship impact test pile as the horizontal thrust applied to the test pile and then evaluates the pile horizontal bearing capacity horizontal bearing capacity assessment process is shown in fig 24 5 1 equivalent static load displacement curve according to on site ship impact test data equivalent static results can be obtained using the pulse equivalent method and the maximum pile top displacement data can be calculated by integration the equivalent static load curve can be used to evaluate the horizontal bearing capacity of foundation piles in engineering applications 5 2 dynamic and static equivalent of m value according to the soil resistance and displacement data processing formula in the pile and pile foundation handbook the dynamic soil resistance and dynamic displacement values can be obtained and the dynamic m value can be calculated according to the relationship between the m value dynamic static ratio and displacement obtained in the laboratory test the equivalent static force m value can be obtained and the horizontal bearing capacity can be evaluated based on the technical code for building pile foundations jgj 94 2008 2018 6 conclusions at present the static load test is the primary method for testing the horizontal bearing capacity of piles in china the static load test requires significant financial and material resources and the test time is quite long in this contribution static and impact tests on a single pile model are carried out and the dynamic and static transformation relationship of m value in the test is explored using the m method a new dynamic test method for horizontal bearing capacity of offshore piles is proposed which uses an on site ship impact test pile based on the test results and theoretical research the following conclusions can be drawn 1 the measured dynamic m value is greater than the measured static m value the dynamic static ratio of m value increases with increasing the horizontal displacement the dynamic static ratio of m value increases with external load both exhibit a quadratic parabolic distribution 2 the transformation of dynamic time history force into equivalent static force primarily involves the global average method the partial average method and the pulse equivalent method test data show that the pulse equivalent method used in this impact test can more effectively convert the dynamic time history force into equivalent static force the pile top equivalent static load displacement curve obtained by the pulse equivalent method is in good agreement with test static load displacement curve and can be used to evaluate the horizontal bearing capacity of foundation piles in engineering applications 3 this contribution puts forward the concept of the m value dynamic static ratio results show that the relationship between the m value dynamic static ratio and mud surface displacement forms a parabolic distribution the measured dynamic m value can be converted into the equivalent static m value and dynamic horizontal bearing capacity testing of the pile is feasible 4 this contribution proposes a new dynamic test method for pile horizontal bearing capacity and introduces the detailed process of dynamic test in practical application the dynamic and static equivalent formulas for pile soil interactions proposed in this contribution are derived from the soil in this test owing to the complexity of the soil the usability of this new test method should be examined further credit authorship contribution statement jin peng wang conceptualization writing original draft visualization jing bo su conceptualization writing review editing feng wu resources zheng zhang methodology data curation yaru lv writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors would like to acknowledge the support of the national natural science foundation of china grant no 51679081 the natural science foundation of jiangsu province no bk20171399 and the central universities fund operating expenses no b200202119 
21181,an experimental study was conducted to investigate the effects of currents on solitary wave attenuation by rigid vegetation in the experiments the vegetation was simulated by cylinders and the oscillation of cylinder was ignored the experimental results showed that vegetation could effectively attenuate solitary wave in positive currents the wave attenuation rate in vegetation zone increases with increasing current velocity however in oppositive currents the wave attenuation rate does not vary monotonously with increasing current velocity the ratio of current velocity to the horizontal velocity of solitary wave has influence on wave attenuation effects in vegetation zones for a small velocity ratio positive currents would enhance wave attenuation due to vegetation while oppositive currents weaken it for a larger velocity ratio wave attenuation due to vegetation is increased in both positive and oppositive currents the solitary wave attenuation rate due to vegetation increases with increasing velocity ratio when velocity ratio is larger than the value at the transition point in both positive and oppositive currents moreover positive currents increase the attenuation of solitary wave velocity in vegetation zone up to 46 while oppositive currents decrease it up to 23 compared to those in the absence of currents in the experiments keywords solitary wave vegetation wave attenuation current effect on wave experimental study 1 introduction coastal areas are always the region with advanced economies and densely population and people are quite concerned about the prevention and control of marine disasters such as tsunami as a tsunami propagates shorelines it undergoes a significant inflow and backflow ranasinghe et al 2013 navarrete et al 2014 and causes tremendous coastal disasters such as flooding erosion casualties and property losses it has been widely recognized that coastal vegetation plays an important role on coastal protection borsje et al 2011 noarayanan et al 2012 hashim et al 2013 duarte et al 2013 temmerman et al 2013 ondiviela et al 2014 vegetation can not only reduce wave height and run up mendez and losada 2004 möller 2006 augustin et al 2009 anderson and smith 2014 möller et al 2014 tang et al 2015 2017 yang et al 2018 but also buffer against erosive wave and prevent coast erosion callaghan et al 2010 shi et al 2012 ondiviela et al 2014 thus studies of tsunami wave propagates through vegetation are fundamental to understand how a tsunami event may be reduced by planted vegetation along coastlines some researchers have studied the attenuation effects of solitary waves due to coastal vegetation by using laboratory experiments or numerical simulations huang et al 2011 studied the interaction of solitary wave and emergent rigid vegetation by experimental and numerical methods and presented an empirical expression for the mean drag coefficient fathi moghadam et al 2018 carried out a series of comprehensive experiments to investigate the effects of vegetation belt on attenuation of solitary wave height and force and found that the force absorption increases and drag coefficient decreases with increase in the incident wave height vegetation density and breaking wave velocity tang et al 2013 numerically investigated the sensitivity of solitary wave run up to vegetation characteristics and the numerical results showed that solitary wave propagation velocity can be reduced effectively by vegetation and solitary wave run up decreases with increase in the plant effective height and also plant diameter and stem density yao et al 2018 presented a numerical model to study the reduction of the run up of tsunami like solitary wave by vegetation on a slope and the results showed that the wave run up and drag coefficient decrease with increase in the vegetation density and the drag coefficient for vegetation on the slope was found to increase with increasing incident wave height tognin et al 2019 presented an experimental setup to investigate the interaction between solitary wave and rigid emergent vegetation and observed that vegetation can reduce the wave height proportionally with the vegetation density and turn the vertical velocity profile into a uniform velocity distribution which shows that in rigid emergent vegetation area the velocity at half of the water depth can represent the velocity in whole water depth in order to make the research more closely fit the natural situation some researchers also studied solitary wave propagation through vegetation patch maza et al 2016 studied the effect of vegetation patchiness on solitary wave propagation attenuation and wave induced forces and introduced a new set of parameters which have high correlations with wave attenuation wang et al 2016 conducted a series of experiments to investigate attenuations of solitary wave over a patch of submerged canopy and studied the relationship among the decay coefficient and the dimensionless wave height submergence ratio relative height and arrangement of the canopy the currents effects on wave attenuation due to vegetation have also been studied by some researchers li and yan 2007 developed a fully three dimensional numerical model to simulate wave current vegetation interaction phenomenon and conducted a series of relevant experiments they found that positive currents lead to a greater attenuation of wave in the presence of vegetation paul et al 2012 found that when the density of seagrass mimics is high the wave attenuation by vegetation would be reduced strongly in the presence of a tidal current which is contrary to the conclusions of li and yan 2007 hu et al 2014 performed a series of physical experiments and found that positive currents can either increase or decrease wave dissipation depending on the velocity ratio which explained the contradiction of li and yan 2007 and paul et al 2012 wu et al 2014 presented a 3 d shallow water flow model to simulate the currents in coastal vegetated area by including the drag and inertia forces of vegetation in the momentum equations and the wave action balance equation lara et al 2016 and maza et al 2015 conducted a series of experiments including wave and currents interaction with real salt marsh vegetation and found that positive currents have a smaller wave damping and oppositive currents have an increase in the wave damping rate losada et al 2016 put forward an analytical formulation for the evaluation of wave damping due to vegetation under the combined effect of waves and currents zhang et al 2016 numerically studied coastal waves and wave induced longshore currents in vegetation area and the results showed that the variation of wave energy dissipation due to vegetation results in radiation stress gradient which has an influence on longshore currents lou et al 2018 experimentally investigated the effects of vegetation density on vegetation induced vertical variation of mean velocity on wave current condition and found that the mean velocity of wave current flow is lower than that of pure current these researches have explained the attenuation effects of vegetation on solitary waves and the current effects on wave attenuation due to vegetation and improved our insight into the mitigating effects of coastal vegetation on water wave propagation however compared to these progress the effects of currents on solitary wave attenuation due to vegetation have less been studied in coastal zones waves always propagate in positive or oppositive currents hence study on the effects of currents on solitary wave attenuation due to rigid vegetation is essential for well understanding the effects of vegetation on the mitigation of a tsunami like solitary wave event in the present study experimental study on solitary wave propagating in currents through rigid vegetated areas are conducted the paper is organized as follows section 2 provides the details of experimental setup section 3 presents the experimental results of relative wave height variation and velocity variation the analysis of the experiment results pertaining to solitary wave attenuation by rigid emerged vegetation in currents is addressed in section 4 which is divided into three parts the effects of vegetation on solitary wave attenuation in the absence of currents in positive currents and oppositive currents finally some conclusions are drawn in section 5 2 experimental setup experiments were conducted in a wave flume at the state key laboratory of coastal and offshore engineering dalian university of technology china the experimental setup is shown in fig 1 the flume is 3 0 m wide 50 0 m long and 1 0 m deep the flume was divided into two parts 2 2 m wide and 0 8 m wide by a barricade the experimental test zones was set in the 0 8 m wide part the solitary wave was generated by a piston type wave maker at the left end of the flume at the right end a sponge layer was set to eliminate wave reflection a pump system was equipped at the bottom of the flume to generate uniform current in the flume fig 1 and it can generate positive currents that flow from left to right or oppositive currents that flow from right to left the rigid vegetation was simulated by wooden cylinders of 0 005 m in diameter 0 6 m in height and the oscillation of the plant is neglected the plant was fixed on the false bottom over a span of 5 0 m and fully occupied the flume width the centre of the vegetation area was located at 29 4 m from the wave paddle in the horizontal direction fig 1 the configuration of the cylinders is shown in fig 2 to investigate the effects of currents on solitary wave attenuation by vegetation solitary wave with different wave heights were tested under five current velocities and the range of the current velocity was set according to the capability of the current making instrumentation in the experiment there are no breaking wave cases in all the tests the wave and current parameters are listed in table 1 in which h is the still water depth before the false bottom h p is the preset wave height and u c means the uniform current velocity all the 30 tests mentioned in table 1 were set corresponding experiments of non vegetation 14 wave gauges and 3 acoustic doppler velocimetries advs were set along the flume to measure solitary wave heights and current velocities fig 3 the wave gauges were sampled at 50 hz for 60 s and the measurement accuracy is 0 001 m the advs were also sampled at 50 hz for 60 s and the measurement accuracy is 0 001 m s to avoid spikes in the velocity record the data recorded by advs were dealt with median filtering method and the filtering neighbourhood size was set to be 5 gauge 1 g1 was placed before the false bottom gauge 2 g2 was placed at the beginning of the false bottom g1 and g2 were used to make sure the incident wave being stable gauge 3 g3 gauge 4 g4 and adv1 were placed 0 5 m in front of the vegetation area to measure the incident waves and currents before the vegetation gauge 14 g14 and adv3 0 2 m were placed behind the vegetation area to measure the waves and currents behind the vegetation gauge 5 13 g5 13 and adv2 were scattered along the vegetation area the adv sensors were set at half of the water depth position the location of the wave gauges and advs are provided in table 2 3 experimental results the measured relative wave height by g3 g14 in case a f are shown in fig 4 with the distance from wave maker as abscissa and relative wave height as ordinate in which h i is the incident wave height measured by g3 fig 5 shows the velocity variations of case a f to compare the effects of currents on solitary wave propagation speed the time of solitary wave crest arriving at adv1 is set to be the initial time t 0 s 4 results analysis 4 1 the effects of vegetation on wave propagation in the absence of currents in terms of solitary wave height it can be seen from fig 4 that in the absence of currents slight wave reflections occur before the vegetation area table 3 shows the solitary wave height damping rate by vegetation it indicates that vegetation has an obvious attenuation effect on solitary wave height and the attenuation effect is influenced by the preset wave height the damping rate increases with increase in the preset wave height under a constant water depth for further analysis about wave height attenuation along the vegetation zone the wave height attenuation due to vegetation is expressed as function of a damping coefficient dalrymple et al 1984 losada et al 2016 1 h h i 1 1 β wc x where β wc is the wave height damping coefficient due to vegetation in currents measurements at gauges 3 14 are used to calculate the damping coefficient β w c which can be used to evaluate the effect of vegetation on wave damping wave current damping coefficient β w c is represented as a function of the relative incident wave height h i h in fig 6 in which h i means the average value of wave height measured by g3 and g4 namely the incident wave height and r 2 is the correlation coefficient of the fitting line the trend of fitting line in the absence of currents is similar with the consequence of maza et al 2016 wave attenuation effect by vegetation is influenced by incident wave height and it increases with increase in the incident wave height when solitary wave passes through vegetation model wave energy can be divided into three parts reflection wave energy decay wave energy and transmission wave energy almost all the energy of solitary wave concentrates near the wave crest so solitary wave energy can be expressed as longuethiggins 1974 2 e 8 3 3 ρ g h 3 2 h 3 2 fig 7 shows solitary wave energy variation before at wave gauge g3 position inside at wave gauge g8 position and behind at wave gauge g14 position the vegetation area in the absence of currents it can be seen that vegetation can attenuate wave energy obviously and up to 68 in the test cases the wave energy attenuation rate is increased with increase in the wave height and still water depth in terms of horizontal velocity it can be seen from fig 5 that horizontal velocity reaches the peak value when the wave crest passes the velocity increases with increase in the wave height and water depth moreover the velocity tested by adv1 adv2 and adv3 show a decreasing trend this is because of the existence of vegetation which has a blocking effect on the propagation of wave and current the exact reduction rates of solitary velocities at adv2 and adv3 are shown in table 4 it indicates that the reduction rate of the solitary velocity increases with increase in the wave height and decrease with increase in the water depth 4 2 the effects of positive currents on wave propagation through vegetation area for solitary wave propagating through vegetation area in positive currents from fig 4 it appears that the wave attenuation due to vegetation in positive currents is greater than that in the absence of currents with same water depth and preset wave height up to 57 fig 8 shows the wave current damping coefficient β w c as a function of relative wave height in positive currents currents with velocity u 2 produce higher wave dissipation than currents with velocity u 1 and both of them produce higher wave dissipation than absence of currents by comparing fig 6 with fig 8 which shows that positive current has an obvious influence on the wave current damping coefficient consequently positive currents have a more obvious effect on wave attenuation and the attenuation effect is enhanced with increase in the positive current velocity fig 9 shows solitary wave energy variation before inside and behind the vegetation area in positive currents with different velocities it can be seen that positive currents can increase wave energy attenuation rate moreover positive currents with larger velocities lead to larger wave energy attenuation rate and the largest wave energy attenuation rate is up to 85 in the test cases in terms of horizontal velocity it can be seen from fig 5 that the peak value arriving times of horizontal velocity in positive currents at adv2 and adv3 are earlier than those in the absence of currents it indicates that positive currents can accelerate the propagation speed of solitary wave up to 9 in this research moreover same as the absence of currents the velocity in positive currents tested by adv2 and adv3 are smaller than those tested by adv1 for the reason of the blocking effect of vegetation the exact reduction rates of solitary velocities at adv2 and adv3 are shown in table 5 and table 6 it can be seen that the reduction rates of solitary velocities in positive currents are much larger than those in the absence of currents up to 46 in this research furthermore the reduction rates in table 6 are generally larger than those in table 5 which indicates that the damping effect of vegetation on horizontal velocity increases with increase in the positive current velocity 4 3 the effects of oppositive currents on wave propagation through vegetation area for solitary wave propagating through vegetation area in oppositive currents in terms of solitary wave height it can be seen in fig 4 that the wave attenuation effects in oppositive currents are smaller than those in the absence of currents with same water depth and preset wave height in general fig 10 shows wave current damping coefficient β w c as a function of relative wave height of oppositive currents it appears that when oppositive current velocity is u 3 among 0 09 m s and 0 07 m s the slope of the fitting line equals 0 18 being positive and smaller than that in the absence of currents it can be seen that oppositive currents produce smaller wave dissipation than the absence of currents when oppositive current velocity is u 41 0 15 m s the slope of the fitting line equals 0 85 being minus and when oppositive current velocity is u 42 0 19 m s the slope of the fitting line equals 1 76 being minus and smaller than that of u 41 so it can be seen that when the oppositive current velocity is larger than a particular value the slope of the fitting line becomes minus which means the wave current damping coefficient β w c decreases with increase in the incident wave height when the oppositive current velocity is large enough moreover the fitting line becomes more and more precipitous with increase in the oppositive current velocity this indicates that the wave attenuation effect by vegetation in oppositive currents does not vary monotonously with the variety of oppositive current velocity which is different with that in positive currents fig 11 shows solitary wave energy variation before inside and behind the vegetation area in oppositive currents with different velocities it can be seen that wave energy decreases with the increase in the current velocity on the whole the wave energy attenuation rate is smaller than that in the absence of currents moreover the energy of outgoing wave with large velocity is often smaller than that with small velocity the largest wave energy attenuation rate due to vegetation in positive currents is up to 68 in the test cases in terms of current velocity the peak value arriving times of horizontal velocity in oppositive currents at adv2 and adv3 are later than those in the absence of currents it indicates that oppositive current can decrease the propagation speed of solitary wave up to 18 in this research same with absence of currents and positive currents the velocities in oppositive currents decrease along the vegetation area due to the damping effect of vegetation on wave and current the exact reduction rates of solitary velocities in oppositive currents are shown in table 7 and table 8 it can be seen that the reduction rates of solitary velocities in oppositive currents are decreased up to 23 compared to those in the absence of currents 4 4 the effect of velocity ratio on wave propagation through vegetation area to evaluate the effect of positive and oppositive currents on solitary wave height attenuation the relationship between the relative wave height decay r w and α is shown in fig 12 where α is the absolute value of u c u w and u w is the horizontal solitary wave water particle velocity u w g h h p h the relative wave height decay is defined as hu et al 2014 3 r w δ h c w δ h p w where δ h c w is the reduced wave height per unit length of vegetation in currents and δ h p w is that in pure wave thus except the cases at the transition points where r w 1 the wave attenuation due to vegetation in all cases is influenced by currents when α is larger than the values at the transition points the r w 1 it means that wave attenuation due to vegetation is increased in currents when α is less than the values at the transition points the r w 1 it means that wave attenuation due to vegetation is decreased in currents thus from fig 12 it can be seen that the values of α at the transition points in positive current conditions are much smaller than those in oppositive current conditions that means when α is relatively small wave attenuation due to vegetation is increased in positive currents but decreased in the oppositive currents however for oppositive current conditions when α is larger than the values at the transition points the r w is larger than 1 and increases with increase of α that means when α is large enough wave attenuation due to vegetation is increased in oppositive currents and increases with increase of α 5 conclusions a series of experiments were conducted to investigate the effects of currents on solitary wave propagation through emerged rigid vegetation area the experiment results show that vegetation has an obvious effect on solitary wave attenuation in both positive and oppositive currents as well as in the absence of currents for solitary wave propagating through vegetation area in positive currents the wave attenuation rate in vegetation zone would increase with increase in the current velocity in oppositive currents with small velocity the wave attenuation rate in vegetation zone is decreased compared to that in the absence of currents in general but it does not vary monotonously with current velocity the effect of velocity ratio on wave attenuation is also discussed when velocity ratio is relatively small positive currents can increase wave attenuation due to vegetation while oppositive currents decrease it when velocity ratio is larger wave attenuation due to vegetation is also increased in oppositive currents for both positive and oppositive currents wave attenuation effect is increased with increase of the velocity ratio when velocity ratio is larger than the value at the transition point moreover currents have an obvious effect on solitary wave velocity attenuation due to vegetation and positive currents can decrease solitary wave velocity up to 46 while oppositive currents can decrease it up to 23 in the experiments it should be noted that in the present study the vegetation is assumed to be rigid vegetation and represented by wooden cylinders where the sway of the plant is neglected though there is some slight oscillation which is obviously a simplification compared to real coastal vegetation moreover due to capability of the current making system in the experiment the range of the current velocity is relative small in future work the real vegetation may be used and the capability of the current making system would also be improved in the experiments to further confirm the validity of our findings under naturally vegetated coastal environments credit authorship contribution statement chuyan zhao data curation formal analysis writing original draft jun tang conceptualization methodology supervision writing review editing funding acquisition yongming shen writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge support from the national natural science foundation of china under contract nos 51579036 and 51779039 and the fundamental research funds for the central universities of china under contract no dut19lab13 
21181,an experimental study was conducted to investigate the effects of currents on solitary wave attenuation by rigid vegetation in the experiments the vegetation was simulated by cylinders and the oscillation of cylinder was ignored the experimental results showed that vegetation could effectively attenuate solitary wave in positive currents the wave attenuation rate in vegetation zone increases with increasing current velocity however in oppositive currents the wave attenuation rate does not vary monotonously with increasing current velocity the ratio of current velocity to the horizontal velocity of solitary wave has influence on wave attenuation effects in vegetation zones for a small velocity ratio positive currents would enhance wave attenuation due to vegetation while oppositive currents weaken it for a larger velocity ratio wave attenuation due to vegetation is increased in both positive and oppositive currents the solitary wave attenuation rate due to vegetation increases with increasing velocity ratio when velocity ratio is larger than the value at the transition point in both positive and oppositive currents moreover positive currents increase the attenuation of solitary wave velocity in vegetation zone up to 46 while oppositive currents decrease it up to 23 compared to those in the absence of currents in the experiments keywords solitary wave vegetation wave attenuation current effect on wave experimental study 1 introduction coastal areas are always the region with advanced economies and densely population and people are quite concerned about the prevention and control of marine disasters such as tsunami as a tsunami propagates shorelines it undergoes a significant inflow and backflow ranasinghe et al 2013 navarrete et al 2014 and causes tremendous coastal disasters such as flooding erosion casualties and property losses it has been widely recognized that coastal vegetation plays an important role on coastal protection borsje et al 2011 noarayanan et al 2012 hashim et al 2013 duarte et al 2013 temmerman et al 2013 ondiviela et al 2014 vegetation can not only reduce wave height and run up mendez and losada 2004 möller 2006 augustin et al 2009 anderson and smith 2014 möller et al 2014 tang et al 2015 2017 yang et al 2018 but also buffer against erosive wave and prevent coast erosion callaghan et al 2010 shi et al 2012 ondiviela et al 2014 thus studies of tsunami wave propagates through vegetation are fundamental to understand how a tsunami event may be reduced by planted vegetation along coastlines some researchers have studied the attenuation effects of solitary waves due to coastal vegetation by using laboratory experiments or numerical simulations huang et al 2011 studied the interaction of solitary wave and emergent rigid vegetation by experimental and numerical methods and presented an empirical expression for the mean drag coefficient fathi moghadam et al 2018 carried out a series of comprehensive experiments to investigate the effects of vegetation belt on attenuation of solitary wave height and force and found that the force absorption increases and drag coefficient decreases with increase in the incident wave height vegetation density and breaking wave velocity tang et al 2013 numerically investigated the sensitivity of solitary wave run up to vegetation characteristics and the numerical results showed that solitary wave propagation velocity can be reduced effectively by vegetation and solitary wave run up decreases with increase in the plant effective height and also plant diameter and stem density yao et al 2018 presented a numerical model to study the reduction of the run up of tsunami like solitary wave by vegetation on a slope and the results showed that the wave run up and drag coefficient decrease with increase in the vegetation density and the drag coefficient for vegetation on the slope was found to increase with increasing incident wave height tognin et al 2019 presented an experimental setup to investigate the interaction between solitary wave and rigid emergent vegetation and observed that vegetation can reduce the wave height proportionally with the vegetation density and turn the vertical velocity profile into a uniform velocity distribution which shows that in rigid emergent vegetation area the velocity at half of the water depth can represent the velocity in whole water depth in order to make the research more closely fit the natural situation some researchers also studied solitary wave propagation through vegetation patch maza et al 2016 studied the effect of vegetation patchiness on solitary wave propagation attenuation and wave induced forces and introduced a new set of parameters which have high correlations with wave attenuation wang et al 2016 conducted a series of experiments to investigate attenuations of solitary wave over a patch of submerged canopy and studied the relationship among the decay coefficient and the dimensionless wave height submergence ratio relative height and arrangement of the canopy the currents effects on wave attenuation due to vegetation have also been studied by some researchers li and yan 2007 developed a fully three dimensional numerical model to simulate wave current vegetation interaction phenomenon and conducted a series of relevant experiments they found that positive currents lead to a greater attenuation of wave in the presence of vegetation paul et al 2012 found that when the density of seagrass mimics is high the wave attenuation by vegetation would be reduced strongly in the presence of a tidal current which is contrary to the conclusions of li and yan 2007 hu et al 2014 performed a series of physical experiments and found that positive currents can either increase or decrease wave dissipation depending on the velocity ratio which explained the contradiction of li and yan 2007 and paul et al 2012 wu et al 2014 presented a 3 d shallow water flow model to simulate the currents in coastal vegetated area by including the drag and inertia forces of vegetation in the momentum equations and the wave action balance equation lara et al 2016 and maza et al 2015 conducted a series of experiments including wave and currents interaction with real salt marsh vegetation and found that positive currents have a smaller wave damping and oppositive currents have an increase in the wave damping rate losada et al 2016 put forward an analytical formulation for the evaluation of wave damping due to vegetation under the combined effect of waves and currents zhang et al 2016 numerically studied coastal waves and wave induced longshore currents in vegetation area and the results showed that the variation of wave energy dissipation due to vegetation results in radiation stress gradient which has an influence on longshore currents lou et al 2018 experimentally investigated the effects of vegetation density on vegetation induced vertical variation of mean velocity on wave current condition and found that the mean velocity of wave current flow is lower than that of pure current these researches have explained the attenuation effects of vegetation on solitary waves and the current effects on wave attenuation due to vegetation and improved our insight into the mitigating effects of coastal vegetation on water wave propagation however compared to these progress the effects of currents on solitary wave attenuation due to vegetation have less been studied in coastal zones waves always propagate in positive or oppositive currents hence study on the effects of currents on solitary wave attenuation due to rigid vegetation is essential for well understanding the effects of vegetation on the mitigation of a tsunami like solitary wave event in the present study experimental study on solitary wave propagating in currents through rigid vegetated areas are conducted the paper is organized as follows section 2 provides the details of experimental setup section 3 presents the experimental results of relative wave height variation and velocity variation the analysis of the experiment results pertaining to solitary wave attenuation by rigid emerged vegetation in currents is addressed in section 4 which is divided into three parts the effects of vegetation on solitary wave attenuation in the absence of currents in positive currents and oppositive currents finally some conclusions are drawn in section 5 2 experimental setup experiments were conducted in a wave flume at the state key laboratory of coastal and offshore engineering dalian university of technology china the experimental setup is shown in fig 1 the flume is 3 0 m wide 50 0 m long and 1 0 m deep the flume was divided into two parts 2 2 m wide and 0 8 m wide by a barricade the experimental test zones was set in the 0 8 m wide part the solitary wave was generated by a piston type wave maker at the left end of the flume at the right end a sponge layer was set to eliminate wave reflection a pump system was equipped at the bottom of the flume to generate uniform current in the flume fig 1 and it can generate positive currents that flow from left to right or oppositive currents that flow from right to left the rigid vegetation was simulated by wooden cylinders of 0 005 m in diameter 0 6 m in height and the oscillation of the plant is neglected the plant was fixed on the false bottom over a span of 5 0 m and fully occupied the flume width the centre of the vegetation area was located at 29 4 m from the wave paddle in the horizontal direction fig 1 the configuration of the cylinders is shown in fig 2 to investigate the effects of currents on solitary wave attenuation by vegetation solitary wave with different wave heights were tested under five current velocities and the range of the current velocity was set according to the capability of the current making instrumentation in the experiment there are no breaking wave cases in all the tests the wave and current parameters are listed in table 1 in which h is the still water depth before the false bottom h p is the preset wave height and u c means the uniform current velocity all the 30 tests mentioned in table 1 were set corresponding experiments of non vegetation 14 wave gauges and 3 acoustic doppler velocimetries advs were set along the flume to measure solitary wave heights and current velocities fig 3 the wave gauges were sampled at 50 hz for 60 s and the measurement accuracy is 0 001 m the advs were also sampled at 50 hz for 60 s and the measurement accuracy is 0 001 m s to avoid spikes in the velocity record the data recorded by advs were dealt with median filtering method and the filtering neighbourhood size was set to be 5 gauge 1 g1 was placed before the false bottom gauge 2 g2 was placed at the beginning of the false bottom g1 and g2 were used to make sure the incident wave being stable gauge 3 g3 gauge 4 g4 and adv1 were placed 0 5 m in front of the vegetation area to measure the incident waves and currents before the vegetation gauge 14 g14 and adv3 0 2 m were placed behind the vegetation area to measure the waves and currents behind the vegetation gauge 5 13 g5 13 and adv2 were scattered along the vegetation area the adv sensors were set at half of the water depth position the location of the wave gauges and advs are provided in table 2 3 experimental results the measured relative wave height by g3 g14 in case a f are shown in fig 4 with the distance from wave maker as abscissa and relative wave height as ordinate in which h i is the incident wave height measured by g3 fig 5 shows the velocity variations of case a f to compare the effects of currents on solitary wave propagation speed the time of solitary wave crest arriving at adv1 is set to be the initial time t 0 s 4 results analysis 4 1 the effects of vegetation on wave propagation in the absence of currents in terms of solitary wave height it can be seen from fig 4 that in the absence of currents slight wave reflections occur before the vegetation area table 3 shows the solitary wave height damping rate by vegetation it indicates that vegetation has an obvious attenuation effect on solitary wave height and the attenuation effect is influenced by the preset wave height the damping rate increases with increase in the preset wave height under a constant water depth for further analysis about wave height attenuation along the vegetation zone the wave height attenuation due to vegetation is expressed as function of a damping coefficient dalrymple et al 1984 losada et al 2016 1 h h i 1 1 β wc x where β wc is the wave height damping coefficient due to vegetation in currents measurements at gauges 3 14 are used to calculate the damping coefficient β w c which can be used to evaluate the effect of vegetation on wave damping wave current damping coefficient β w c is represented as a function of the relative incident wave height h i h in fig 6 in which h i means the average value of wave height measured by g3 and g4 namely the incident wave height and r 2 is the correlation coefficient of the fitting line the trend of fitting line in the absence of currents is similar with the consequence of maza et al 2016 wave attenuation effect by vegetation is influenced by incident wave height and it increases with increase in the incident wave height when solitary wave passes through vegetation model wave energy can be divided into three parts reflection wave energy decay wave energy and transmission wave energy almost all the energy of solitary wave concentrates near the wave crest so solitary wave energy can be expressed as longuethiggins 1974 2 e 8 3 3 ρ g h 3 2 h 3 2 fig 7 shows solitary wave energy variation before at wave gauge g3 position inside at wave gauge g8 position and behind at wave gauge g14 position the vegetation area in the absence of currents it can be seen that vegetation can attenuate wave energy obviously and up to 68 in the test cases the wave energy attenuation rate is increased with increase in the wave height and still water depth in terms of horizontal velocity it can be seen from fig 5 that horizontal velocity reaches the peak value when the wave crest passes the velocity increases with increase in the wave height and water depth moreover the velocity tested by adv1 adv2 and adv3 show a decreasing trend this is because of the existence of vegetation which has a blocking effect on the propagation of wave and current the exact reduction rates of solitary velocities at adv2 and adv3 are shown in table 4 it indicates that the reduction rate of the solitary velocity increases with increase in the wave height and decrease with increase in the water depth 4 2 the effects of positive currents on wave propagation through vegetation area for solitary wave propagating through vegetation area in positive currents from fig 4 it appears that the wave attenuation due to vegetation in positive currents is greater than that in the absence of currents with same water depth and preset wave height up to 57 fig 8 shows the wave current damping coefficient β w c as a function of relative wave height in positive currents currents with velocity u 2 produce higher wave dissipation than currents with velocity u 1 and both of them produce higher wave dissipation than absence of currents by comparing fig 6 with fig 8 which shows that positive current has an obvious influence on the wave current damping coefficient consequently positive currents have a more obvious effect on wave attenuation and the attenuation effect is enhanced with increase in the positive current velocity fig 9 shows solitary wave energy variation before inside and behind the vegetation area in positive currents with different velocities it can be seen that positive currents can increase wave energy attenuation rate moreover positive currents with larger velocities lead to larger wave energy attenuation rate and the largest wave energy attenuation rate is up to 85 in the test cases in terms of horizontal velocity it can be seen from fig 5 that the peak value arriving times of horizontal velocity in positive currents at adv2 and adv3 are earlier than those in the absence of currents it indicates that positive currents can accelerate the propagation speed of solitary wave up to 9 in this research moreover same as the absence of currents the velocity in positive currents tested by adv2 and adv3 are smaller than those tested by adv1 for the reason of the blocking effect of vegetation the exact reduction rates of solitary velocities at adv2 and adv3 are shown in table 5 and table 6 it can be seen that the reduction rates of solitary velocities in positive currents are much larger than those in the absence of currents up to 46 in this research furthermore the reduction rates in table 6 are generally larger than those in table 5 which indicates that the damping effect of vegetation on horizontal velocity increases with increase in the positive current velocity 4 3 the effects of oppositive currents on wave propagation through vegetation area for solitary wave propagating through vegetation area in oppositive currents in terms of solitary wave height it can be seen in fig 4 that the wave attenuation effects in oppositive currents are smaller than those in the absence of currents with same water depth and preset wave height in general fig 10 shows wave current damping coefficient β w c as a function of relative wave height of oppositive currents it appears that when oppositive current velocity is u 3 among 0 09 m s and 0 07 m s the slope of the fitting line equals 0 18 being positive and smaller than that in the absence of currents it can be seen that oppositive currents produce smaller wave dissipation than the absence of currents when oppositive current velocity is u 41 0 15 m s the slope of the fitting line equals 0 85 being minus and when oppositive current velocity is u 42 0 19 m s the slope of the fitting line equals 1 76 being minus and smaller than that of u 41 so it can be seen that when the oppositive current velocity is larger than a particular value the slope of the fitting line becomes minus which means the wave current damping coefficient β w c decreases with increase in the incident wave height when the oppositive current velocity is large enough moreover the fitting line becomes more and more precipitous with increase in the oppositive current velocity this indicates that the wave attenuation effect by vegetation in oppositive currents does not vary monotonously with the variety of oppositive current velocity which is different with that in positive currents fig 11 shows solitary wave energy variation before inside and behind the vegetation area in oppositive currents with different velocities it can be seen that wave energy decreases with the increase in the current velocity on the whole the wave energy attenuation rate is smaller than that in the absence of currents moreover the energy of outgoing wave with large velocity is often smaller than that with small velocity the largest wave energy attenuation rate due to vegetation in positive currents is up to 68 in the test cases in terms of current velocity the peak value arriving times of horizontal velocity in oppositive currents at adv2 and adv3 are later than those in the absence of currents it indicates that oppositive current can decrease the propagation speed of solitary wave up to 18 in this research same with absence of currents and positive currents the velocities in oppositive currents decrease along the vegetation area due to the damping effect of vegetation on wave and current the exact reduction rates of solitary velocities in oppositive currents are shown in table 7 and table 8 it can be seen that the reduction rates of solitary velocities in oppositive currents are decreased up to 23 compared to those in the absence of currents 4 4 the effect of velocity ratio on wave propagation through vegetation area to evaluate the effect of positive and oppositive currents on solitary wave height attenuation the relationship between the relative wave height decay r w and α is shown in fig 12 where α is the absolute value of u c u w and u w is the horizontal solitary wave water particle velocity u w g h h p h the relative wave height decay is defined as hu et al 2014 3 r w δ h c w δ h p w where δ h c w is the reduced wave height per unit length of vegetation in currents and δ h p w is that in pure wave thus except the cases at the transition points where r w 1 the wave attenuation due to vegetation in all cases is influenced by currents when α is larger than the values at the transition points the r w 1 it means that wave attenuation due to vegetation is increased in currents when α is less than the values at the transition points the r w 1 it means that wave attenuation due to vegetation is decreased in currents thus from fig 12 it can be seen that the values of α at the transition points in positive current conditions are much smaller than those in oppositive current conditions that means when α is relatively small wave attenuation due to vegetation is increased in positive currents but decreased in the oppositive currents however for oppositive current conditions when α is larger than the values at the transition points the r w is larger than 1 and increases with increase of α that means when α is large enough wave attenuation due to vegetation is increased in oppositive currents and increases with increase of α 5 conclusions a series of experiments were conducted to investigate the effects of currents on solitary wave propagation through emerged rigid vegetation area the experiment results show that vegetation has an obvious effect on solitary wave attenuation in both positive and oppositive currents as well as in the absence of currents for solitary wave propagating through vegetation area in positive currents the wave attenuation rate in vegetation zone would increase with increase in the current velocity in oppositive currents with small velocity the wave attenuation rate in vegetation zone is decreased compared to that in the absence of currents in general but it does not vary monotonously with current velocity the effect of velocity ratio on wave attenuation is also discussed when velocity ratio is relatively small positive currents can increase wave attenuation due to vegetation while oppositive currents decrease it when velocity ratio is larger wave attenuation due to vegetation is also increased in oppositive currents for both positive and oppositive currents wave attenuation effect is increased with increase of the velocity ratio when velocity ratio is larger than the value at the transition point moreover currents have an obvious effect on solitary wave velocity attenuation due to vegetation and positive currents can decrease solitary wave velocity up to 46 while oppositive currents can decrease it up to 23 in the experiments it should be noted that in the present study the vegetation is assumed to be rigid vegetation and represented by wooden cylinders where the sway of the plant is neglected though there is some slight oscillation which is obviously a simplification compared to real coastal vegetation moreover due to capability of the current making system in the experiment the range of the current velocity is relative small in future work the real vegetation may be used and the capability of the current making system would also be improved in the experiments to further confirm the validity of our findings under naturally vegetated coastal environments credit authorship contribution statement chuyan zhao data curation formal analysis writing original draft jun tang conceptualization methodology supervision writing review editing funding acquisition yongming shen writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors would like to acknowledge support from the national natural science foundation of china under contract nos 51579036 and 51779039 and the fundamental research funds for the central universities of china under contract no dut19lab13 
21182,identifying marine pollutant sources is essential to assess contain and minimize their risk we propose a lagrangian particle tracking algorithm lpt to study the transport of passive tracers advected by an uncertain flow field described by an ensemble of realizations of the ocean currents and to identify the source parameters of the release in backward mode starting from a probability map describing the distribution of a pollutant reverse tracking is used to generate probabilistic inverse maps by integrating it with the ensemble of flow fields backward in time an objective function based on the probability weighted distance between the resulting inverse maps and the source trajectory is then minimized to identify the likely source of pollution we conduct numerical experiments to demonstrate the efficiency of the proposed algorithm in the mediterranean sea passive tracers are released along the path of a ship and propagated with an ensemble of realistic flow fields to generate a probability map which is then used for the inverse problem of source identification our results suggest that the proposed algorithm captures the release time and source of pollution successfully pinpointing to the release parameters up to two weeks back in time in certain case studies keywords marine pollution source identification lagrangian tracking moving source stochastic flow field 1 introduction modeling the transport of species and pollutants in the ocean is important for a variety of applications including search and rescue otote et al 2019 risk assessment niu et al 2010 havens et al 2010 and ecosystem management raitsos et al 2017 wang et al 2019 this is often used to determine the trajectory and final destination of pollutants particle tracking of pollutants in water bodies has been extensively studied for a deterministic flow e g kao and elsayed 1990 and also for an uncertain stochastic flow e g zhao et al 2011 el mohtar et al 2018 in a stochastic framework the solution of the particle tracking problem is described by a probability map that indicates the likelihood of a particle reaching a certain location beaudoin et al 2007 el mohtar et al 2018 lagrangian particle tracking lpt algorithms which track individual particles in a lagrangian framework are commonly used to model the transport of matter in a flow field kao and elsayed 1990 brickman and smith 2002 batchelder 2006 such algorithms can be coupled with physical models to study the transport of specific types of particles for instance the lpt can be coupled with certain biological modules to investigate the transport of nutrients and fish larvae in water bodies petihakis et al 2002 sentchev and korotenko 2007 lett et al 2008 another use of this algorithm is to track micro plastics and study their spread wichmann et al 2019 lpt was also used for simulating oil spills de dominicis et al 2013b such as the deepwater horizon in the gulf of mexico north et al 2013 liu et al 2013 after augmenting it with diffusion and oil weathering to describe the coupling between physical and chemical processes such as emulsification evaporation and dispersion north et al 2013 liu et al 2013 a thorough review of recent advances in ocean applications of lagrangian tracking algorithms can be found in van sebille et al 2018 the use of lpt also extends to the field of medicine and drug delivery where models for micro scale motion are implemented to track the transport of drugs in the human body pourmehran et al 2015 schuster et al 2015 uncertainties in particle tracking are associated with uncertainties in processes particles undergo and in the oceanic flow field which arises from the imperfect representation of the ocean forcing initial conditions and internal physics groves et al 2008 bennett et al 2012 edwards et al 2015 hoteit et al 2018 uncertainties in the oceanic flow are commonly tackled by advecting particles with a stochastic flow field represented by an ensemble of realizations beaudoin et al 2007 guo et al 2013 2019 el mohtar et al 2018 in this sense at each time step the velocity field consists of a set of realizations representing possible scenarios of the ocean currents hoteit et al 2013 recently el mohtar et al 2018 investigated an lpt algorithm operating with an ensemble of flow fields of the red sea this algorithm advects particles in a parallel framework and introduces a cost effective binning scheme that groups spatially close particles in order to cap the number of particles to avoid memory and storage issues similarly guo et al 2013 investigated the advection of particles in a stochastic atmospheric flow and constructed a variational field which characterizes the differences in ensemble runs based on the different pathlines obtained for each particle the mediterranean sea is a busy waterway responsible for around 15 of the global shipping activity kostianoy and carpenter 2018a offering a passageway for different types of ships recreational shipping tankers etc girin and carpenter 2018 and hosting many oil platforms along its coast kostianoy and carpenter 2018b it is therefore prone to marine pollution from fixed platforms and from moving ships according to kostianoy and carpenter 2018b 14 accidental oil spills occurred in the mediterranean between 1970 and early 2016 that contaminated the sea with more than 10 tons of oil the lebanese oil leak of 2006 is considered as the biggest oil pollution incident in the eastern mediterranean coppini et al 2011 lpt models have been extensively applied to the mediterranean sea to study various transport phenomena such as micro plastics van sebille et al 2015 liubartseva et al 2016 2018 duncan et al 2018 and oil some of the well developed oil spill models are poseidon annika et al 2001 perivoliotis et al 2011 medslik zodiatis et al 2012 2017 lardner and zodiatis 2016 2017 and medslik ii de dominicis et al 2013a b lpt algorithms can also be operated in reverse mode to investigate the inverse problem of source identification which only requires direct integration of the particles backward in time when time reversible terms are involved brickman and smith 2002 batchelder 2006 breivik et al 2011 this generally becomes noticeably more complex for nonlinear irreversible problems which may require more advanced inverse approaches such as bayesian inference yee 2007 or more sophisticated integration techniques such as operator splitting ivorra et al 2016 until recently source identification in ocean studies has been restricted to a single source applications with a deterministic flow field zodiatis et al 2012 tackled the problem of determining multiple sources in a deterministic flow by integrating contours and particles backward in time el mohtar et al 2018 addressed the problem of source identification of a single release source in a probabilistic framework by integrating a single particle backward in time using an ensemble of flow fields and generating a spatial distribution describing the likelihood of where the particle might be located in this work we first investigate the transport of particles from fixed and moving sources with an uncertain flow we then introduce and test a new approach to identify the contamination source based on an objective function described by the distance between the inverse probability maps and the paths of different ships weighted by the probability associated with individual particle locations found by inverse tracking the proposed methodology is computationally very efficient and can be utilized with any lpt algorithm capable of backward integration brickman and smith 2002 batchelder 2006 breivik et al 2011 zodiatis et al 2012 de dominicis et al 2013a b el mohtar et al 2018 this could also be particularly useful to provide timely support for a first fast response of a spill for instance in an operational setting when the composition of the pollutant is not known or when weathering processes cannot be accurately modeled we demonstrate the efficiency of the proposed framework by conducting realistic numerical experiments to identify the source of pollution in the mediterranean sea advected by an uncertain flow the experiments indicate that under certain conditions that do not include heavy beaching effects the release source and time of pollutants may be efficiently predicted up to two weeks after the release the sensitivity of the objective function to the observation time and flow variability is also examined the paper is structured as follows the lpt methodology is described in section 2 with a focus on continuous particle release from both fixed and moving sources in an uncertain flow field section 3 presents the proposed algorithm for source identification the design of the numerical experiments is outlined in section 4 and the results are analyzed and discussed in section 5 conclusions and final remarks are offered in section 6 2 forward tracking we build on the lpt algorithm presented by el mohtar et al 2018 to advect particles released from a single source at a given time with deterministic and stochastic flow fields the algorithm efficiently deals with particle advection through parallelization and controls the growth of the number of particles when advected with an ensemble of flow fields by binning integration for particles location is carried out using a 4 t h order runge kutta scheme to solve for the unsteady advection equation governing the transport of passive particles at each integration advection time step δ t in an uncertain setting the released particle is advected by each of the realizations of the ensemble of flow fields with each realization representing a possible scenario for the transport of a particle at that specific location this generates a spatial distribution of the particles with associated probabilities of being at the corresponding location this distribution is referred to as a probability map to overcome computational issues arising from the exponentially growing number of particles particles are binned so that the total number of particles is capped to a maximum hollt et al 2015 bins are defined as refined spatial cells where particles belonging to the same bin are grouped into a single particle here binning is spatially adaptive with smaller bins assigned to regions of higher probability and smaller variance the smallest bin has quarter the dimension of the computational grid cell in each direction binning is also designed to conserve the first two moments of probability of the particles to be at a given location before generating new particles with new weights where the weight of a particle is defined as the scaled probability of a particle being at a given location el mohtar et al 2018 a new particle injection mode is developed here to allow for a continuous release of particles from fixed and moving sources this model is schematized in fig 1 where new particles are released at each advection time step and advected from the release time till the end of the simulation time this staged injection advection allows to keep track of the time stamp of particles mimicking a realistic release fractional time stamping associated with the newly injected particles is used in the staged release to ensure their release at the intended time the time fraction is the ratio of the time elapsed from the current lpt model time step to the time between two consecutive velocity fields particles can be released from a fixed location denoted by x i n j at every advection time step particles can also be continuously released from a moving source of fixed path and speed the injection locations are determined based on the velocity and initial location of the moving source which can be expressed as 1 x i n j u s r c t i n j x 0 where t i n j is the injection time the release can last for as long as the ship is moving along the path where particles are released in stages and advected till the end of the simulation time based on the staged injection a particle is released at the chosen location of the moving source at the exact time it crosses this location for an ensemble of flow fields every particle is then advected by each realization of the currents where particles that end up in the same bin are grouped into a single bin while conserving the first two moments of probability as performed by el mohtar et al 2018 3 inverse tracking and source identification the inverse problem of identifying the source of a pollution patch released from a moving source starts with a standard lpt framework operating in reverse de dominicis et al 2013a el mohtar et al 2018 starting from an observed distribution of particles which may be deterministic or probabilistic particles are first sampled from this distribution before they are advected back to a selected time with the reversed currents an initial probabilistic distribution of this inverse problem may for instance represent an uncertain spatial map of particles locations inferred from a satellite image where such uncertainties may arise from imperfections in remote sensing and processing such as pixel noise and error bars in the classification algorithm wang et al 2009 zhang and zhang 2019 since the actual release time of the particles could also be an unknown inverse time integration is performed till a selected time prior to the release which is believed to be close to the release window where the release window is defined as the time frame between the start and end time of the release upon integrating the observed distribution backward in time a new inverse probability map is generated at every integration time step the inverse probability map represents the uncertainty in the particles location generated based on the particle distribution at every inverse time step an objective function is formulated based on the geographical distance between the inverse probability map and the moving source trajectory the objective function is designed so that its minimum occurs at the release time where the inverse probability map and the release segment are spatially closest to each other to identify a pollution source this objective function is computed for different ship trajectories in the area near the spill the minima are compared to identify the most probable culprit which corresponds to the smallest objective function different forms of such an objective function were investigated including the shortest and average distances the objective functions are normalized for a more straightforward comparison between the distances associated with the particle distributions obtained from deterministic and stochastic flows the first objective function measures the shortest distance between the points of the discretized probability map and the trajectory scaled by the probability of a particle lying in the cell and normalized by the total sum of probabilities of the particles to be at their corresponding locations such distances are schematized in fig 2 which shows the projections from some points of the probability map to the release path the distances are summed over all the points of the inverse probability map to produce the objective function based on the shortest distance which is expressed as 2 j s h o r t e s t k i 1 n p t s m a p p i j 1 n p t s m a p p j x i x p i k where j k is the objective function corresponding to the k t h trajectory x i is the position of the point on the grid cell x p i k is the position of the projection of x i on the k t h trajectory p i is the likelihood at the i t h point of the probability map and n p t s m a p is the number of particles forming the probability map the objective function based on the average distance is evaluated as the sum of the distances between the inverse probability map and each of the points forming the trajectory scaled by the probability of the particle being there this can be expressed as 3 j a v e r a g e k i 1 n p t s m a p j 1 n p t s t r a j p i n p t s t r a j j 1 n p t s m a p p j k x i z j k where z j k represents the points forming the k t h trajectory and n p t s t r a j corresponds to the number of points forming the trajectory in our linear model the objective function in its two forms is convex having a minimum at the expected release time in order to determine the release location and time using a given observation a number of candidate trajectories of moving sources that have recently passed near the study region are first identified after computing the objective function and comparing the resulting distances some trajectories can be discarded since they are farther from the probability map than other trajectories in most situations a few close trajectories can be selected as possible candidates this can be addressed by tracking the time when ships passed through the release location using automatic identification systems e g marinetraffic global ship tracking intelligence www marinetraffic com to illustrate the form of the objective functions an experiment is conducted in which particles were released at hourly increments along a ship path extending from 35 n 22 e to 36 n 16 e over a period of one day from day 3 till day 4 of the simulation time fig 3 plots sample results for the proposed objective functions showing convex shapes for both objective functions for the test shown the two objective functions defined in equations 2 and 3 point to different minima with the shortest distance based objective function being able to accurately pinpoint the release time as opposed to the average distance based approach which was 3 days off as can be seen in fig 3 in particular in the case of a continuous release the proposed methodology would point to the end of the release window after all the particles are released into the ocean this was observed in our study where the data is available at a daily rate after extensive testing the shortest distance formulation was selected as the better approach 4 experiments design 4 1 experimental setup experiments are conducted to assess the performance of the proposed algorithm to test the continuous release of particles from a fixed source we place the source location at the south of the ionian sea at 18 e 34 6 n and continuously release particles at an hourly rate for a period of one day for the moving source experiment we opted to use a ship trajectory that is densely operated by vessels we first examined the vessel routes density in order to choose a route that is representative of a real case scenario the density map for the vessels in the mediterranean is shown in fig 4 which outlines how congested the mediterranean is in terms of annual number of ships from the density map a path of high density is selected the chosen path is for a ship traversing the mediterranean sea westwards starting from the suez canal and leaving through the strait of gibraltar release segments were chosen to represent single day releases based on a ship that moves at a constant speed the chosen path is split into seven segments each segment corresponding to continuous ship motion over a single day traveling at a constant speed of 14 knots corresponding to a typical tanker or bulk carrier these release segments are illustrated in fig 5 a single day release period was chosen to mimic an emergency scenario an example of such is the lebanon jiyyeh oil spill which lasted for approximately 2 days coppini et al 2011 the experiments focus on the day 3 release path with a release window between days 3 and 4 with the exception of section 5 4 in which we study the release from the day 1 path due to the heavy beaching observed in its vicinity simulations are conducted using the ensemble of velocity fields described in section 4 2 advecting particles every hour as for the inverse simulation particles were integrated two week back to reach the first data time step which was day 0 in our experiments finally we use a maximum of 100 million particles for all simulations following the results of el mohtar et al 2018 who suggested that a maximum number of particles greater than 50 million is needed to capture the details of the particle distribution 4 2 generating a flow field ensemble copernicus marine environment monitoring system cmems offers 30 years of reanalysis fields for the mediterranean sea based on which we generate an ensemble of realizations of the ocean currents to mimic a probabilistic framework the reanalysis spans the mediterranean from 6 00 to 36 25 in longitude 30 17 to 45 9375 in latitude and a depth stretching down to 5334 65 m below sea level the data is uniformly spaced horizontally with a resolution of 0 0625 0 0625 and non uniformly spaced in depth with 72 levels corresponding to 677 253 72 grid points the reanalysis is available over a 30 years period from 1987 till 2016 from which we focus on the time frame between the 14 t h of july and the 12 t h of august this provides a sufficient time span to examine long time integration and discontinuous releases the whole reanalysis dataset was also used for generating an ensemble of flow fields as described below an ensemble of realizations of the sea currents is randomly generated for each day of the simulation period based on a normal distribution with mean as the background velocity and covariance as that of the reanalysis velocity fields on that same day of each year for a total of 30 fields in order to include more realizations for a given date windows of 0 1 and 2 days about the day of interest were examined based on which a window of 1 day was found sufficient to sample smooth fields an empirical orthogonal function eof analysis is then performed to filter out low time variance features generally of small scales nature in the ocean before sampling golub and reinsch 1971 preisendorfer and mobley 1988 hoteit et al 2001 this is achieved by computing the eigenvectors and corresponding eigenvalues λ i j of the covariance matrix c d i the eigendirections corresponding to small eigenvalues of the covariance are then truncated to obtain a low rank approximation c d i of c d i here we select the first eigenvectors that describe at least 95 of the variance of the realizations according to 4 j 1 r λ j j 1 m λ j 0 95 where m is the total number of eigendirections and r is the number of retained eigendirections this low rank approximation of the covariance is readily decomposed into c l l t which is used to generate the members of the ensemble of flow fields as follows 5 x d a y j i x d a y j 2006 l γ d a y j i γ d a y j i n 0 i m m where x denotes the longitudinal or latitudinal currents j is the day of interest i 1 2 n e and n e the ensemble size chosen to be 50 in our experiments as typically provided by marine weather services the γ i s are resampled every time step from a normal distribution of zero mean and identity covariance the background surface velocity field the variance of this ensemble and a few realizations of the surface currents for day 15 are presented in fig 6 suggesting high uncertainty near oceanic mesoscale features such as straits and eddy peripheries as typically obtained from ocean ensemble data assimilation systems hoteit et al 2010 4 3 inverse maps and post processing the probability maps are generated at each time step by processing particle distributions using a gaussian basis function that maps the particle weights into probabilities defined on grid cells el mohtar et al 2018 it is generally beneficial to post process the probability maps in order to remove particles with negligible weights and to filter out particles trapped along the coast where trapped particles are particles that are advected by multiple realizations of small velocity particles with negligible weights are usually found along the edge of the slick and although they have low probabilities however since they are far from the ship trajectory they contribute to the objective function causing a deviation of its minimum removing particles trapped near the coast however is generally useful because these particles were found trapped along the coast by several realizations of small velocities that prevented them from being released back into the ocean which in turn leads to deviating the minimum of the objective function away from the actual release time one straightforward way to filter the particles distribution is to discard unlikely particles whose weights are less than a prescribed threshold another way is to evaluate the cdf of the probability distribution then truncate all the particles in the lower 5 density which would remove all particles with low probability relative to the whole distribution it is also possible to truncate all the particles in both the lower and upper 5 of the cdf this discards all particles with low probabilities and by removing the top 5 particles highly concentrated particles near the beach are discarded this would however remove particles near the trajectory with high probabilities one may also only disregard particles located in coastal cells where coastal cells are defined as those with at least one node of the 3 d grid cell on land a stricter procedure to handle concentrations of particles near the shore is to remove both coastal and directly neighboring cells this allows to mitigate beaching effects where beached particles trapped near the beach would be excluded from calculating distances filtering based on coastal cells schemes is illustrated in fig 7 after testing the aforementioned techniques removing the coastal cells was chosen for filtering the particles distributions for our study further discussion is presented in the supplementary material in which comparisons of the resulting probability maps and distances are discussed 5 results this section presents and discusses the results of the numerical experiments illustrating the implementation of the proposed source identification algorithm for continuous release from fixed and moving sources in addition we assess the sensitivity of the algorithm to various parameters including the size of the observed area the observation time and the variance of the ocean currents ensemble 5 1 continuous release from a fixed source in this experiment particles are released from a source located at 18 e 34 6 n over a single day between days 3 and 4 and advected till day 30 the resulting probability map at day 14 is then saved from which particles for the inverse study are sampled and propagated backward in time the objective function is then computed at every inverse time step and the minimum is located these results are presented in fig 8 the forward probability map shows that the particles were advected far from the source location the inverse study portrays the stochastic behavior of the ensemble which causes some deviation of the location of the maximum probability from the actual release location the minimum distance between the probability maps and the release location which indicates the release time of the spill is detected to be within the release window where the distance was approximately 66 7 km at day 4 the end of the release 5 2 continuous release from a moving source 5 2 1 forward simulation release path 3 yellow in fig 5 is now considered for the forward moving source experiment particles injection starts at day 3 and ends at day 4 snapshots of the probability map are presented for different times in fig 9 the impact of staged injection is observed at day 4 with the particles released earlier spreading more than later ones as expected here the particles are released from a location far from the shore and the interaction of the particles with the coast occurs at a later time with beaching occurring between days 12 and 15 near the north african shore prior to day 12 regions of high probability were concentrated near the release path 5 2 2 inverse simulation starting with the probability map shown in the top left of fig 10 as generated by the forward integration taken at day 14 integration of the particles distribution is conducted backward to day 0 a collection of resulting probability maps at different simulation times of the inverse integration is presented in fig 10 the inverse probability map is observed to be advected away from the north african shore it becomes more diffuse in time due to the stochastic nature of the ensemble however the high probability areas of the probability map becomes concentrated near the release path beaching occurs at the periphery of the probability map where particles interact with the italian coast from as early as day 9 5 3 source identification the objective function is computed between the inverse probability maps and all seven release paths from fig 5 to identify the most probable polluter among the selected paths fig 11 presents the plots for the resulting objective function with respect to all seven paths along with another plot focusing on the evolution of the objective function relative to path 3 the actual release path in the study the results suggest that the most probable release source path is the actual release path release path 3 which is the closest to all the inverse probability maps the plot of the objective function computed between the inverse probability maps and release path 3 is convex with its minimum lying within the release window where the release time is correctly identified to be day 4 the end of the release window this demonstrates that the algorithm is capable of identifying both the release time and path of the pollutant 5 4 sensitivity analysis observation time this experiment focuses on release path 1 red in fig 5 where the mainstream currents are observed in fig 6 to drive particles into the shore leading to beaching early on the release path and time are fixed and different times at which the observation is available are investigated to assess the robustness of the algorithm in identifying the release time and path in fig 12 various curves of the objective function computed with respect to probability maps from different observation times are presented the closer the observation time is to the release time the better the algorithm is at pointing to the release window when beaching effects are dominant the observation time has to be close to the release time in order to accurately identify the pollutant comparing these results to the distances in fig 11 we notice that when beaching effects are present the release time can be identified if the observation is collected at most 5 days after the initial release as opposed to the release from trajectory 3 where the source was identified using an observation collected 12 days after the release 5 5 sensitivity analysis ensemble variance the impact of uncertainties in the ensemble of the flow fields on the identification of the spill time and location is investigated by varying the ensemble variance in the forward and inverse runs the aim is to examine whether a more certain flow field or a more localized probability map would help better identifying the release source the sensitivity analysis utilizes a modified ensemble with 50 and 100 of the reference ensemble variance in the forwards simulation and 100 75 50 25 of the reference ensemble variance along with a deterministic current field that advects particles with the average of the ensemble for the inverse study the ensemble variance is adjusted by spreading its members by a variance fraction f 2 that represents the fraction of the variance of the new ensemble to the old ensemble the new ensemble is then generated as 6 u i j x t f 2 u i o g j x t 1 f 2 u o g j x t where i 1 2 n e represents the realizations j 1 2 denotes the time index u i j x t the i t h new ensemble realization of the currents at position x and time t u i o g j the i t h original ensemble realization and u o g j the average of the original ensemble realizations the results presented in fig 13 reveal that a more certain inverse flow field effectively yields a probability map that is closer to the release path than the original ensemble snapshots of probability maps at day 3 are presented in the supplementary to illustrate the effect of the ensemble variance on the spread of the probability maps the results also suggest that using a more certain flow field in the forward run would yield a tighter probability map which in turn leads to samples located spatially close to each other and the objective function was smaller the accuracy of source identification is noticeably improved when the inverse advection uses a more certain flow field in particular the objective function yielded a minimum distance of approximately 93 k m when the particles were advected with an ensemble of flow fields with half the original ensemble variance as opposed to 115 k m with the original ensemble focusing on the case of half ensemble variance in the forward integration the minimum distance ranged between 86 k m in the deterministic case and 104 k m in the full variance case to be able to compare with the deterministic case where the solution is represented by a collection of points instead of a probability map the objective function was computed based on the average distance 5 6 sensitivity analysis initial number of particles the sensitivity of the objective function to the initial number of particles from which the inverse study starts is examined by varying the number of sampled particles from the observed probability map the objective function is computed for inverse simulations starting with 1 10000 20000 30000 and 40000 particles where 40000 particles is the maximum number of particles based on the available computer memory in our case the number of particles sampled from the observed map corresponds to the observed area where using less particles may under represent the spill which prevents from accurately identifying the release time fig 14 presents the distance curves for different initial particles distributions using the objective function in addition a sufficiently large collection of particles which adequately represents the spatial uncertainties is needed to identify the release time and source in particular the more particles are used the more information is available and the objective function would point to the release time better which was seen in this experiment where by sampling one particle the objective function points to day 0 as the release time whereas using at least 10 000 particles the objective function points to the actual release window between days 3 and 4 5 7 investigating more challenging scenarios finally the algorithm is tested on paths that are close to the actual release to further assess its robustness to possible nearby release paths the selected paths illustrated in fig 15 are as follows the actual path where the release originates paths that are parallel to the actual release at 0 5 and 1 paths 1 to 4 respectively a path that is perpendicular to the actual path path 5 paths that intersect with the actual path with some angle paths 6 and 7 the objective function computed between the inverse probability maps and these paths are plotted in fig 15 suggesting that the proposed algorithm pinpoints two most likely source ships this is indicated by the objective functions which yielded comparably close distances to the probability map 41 2 k m actual release path and 41 7 k m release path 3 in this situation additional information about the marine traffic may help identify the source ship the results of fig 15 show that the path to the south of the actual release has a similar distance to the probability map this can be explained by the nature of the velocity field in the region which drives particles northwards in the inverse simulation therefore the path 0 5 to the south is expected to have a short distance at a time close to the observation time thus the proposed methodology provides a systematic approach to rule out ship paths that do not belong to probable polluters 6 conclusion we proposed a new methodology for identifying the release time and path of pollutants from fixed and moving sources the proposed methodology relies on an lpt algorithm capable of backward integration and accommodates deterministic and stochastic flow fields a staged particle injection algorithm for the forward particle tracking from fixed and moving sources was implemented backward particle tracking starting from an observed map which could be deterministic or probabilistic was introduced along with proper filtering of particles trapped at the coast or particles of low probability the identification of the release time and trajectory was formulated as determining the minimum of an objective function measuring the distance between inverse probability maps and release trajectories weighted by the probability of the particle to be at its corresponding location source identification was tested with our lpt operating with an uncertain flow in the mediterranean sea the results of the numerical experiments suggest that the proposed methodology could successfully identify the release time and location for up to two weeks when the effects of coastal interactions are weak and up to 5 days when particles interact heavily with the coast the results also suggest that the proposed methodology could also be used to shortlist the probable polluters in challenging scenarios where densely operated paths are nearby or intersecting in future work we shall augment our lpt with a physical model to simulate specific pollution spills such as oil spills this may require developing a more sophisticated inversion such as bayesian inference to address the nonlinear irreversible nature of the pollution dynamics and weathering effects a bayesian inference framework however will be computationally prohibitive in a realistic setting as the sampling of the posterior distribution of the parameters of interest will require evaluating the likelihood using the pollution model for each sample of the parameters to be inverted we will explore surrogate models to alleviate the computational burden of such an approach we also plan to investigate other more sophisticated beaching models to mitigate the loss of information caused by coastal interactions credit authorship contribution statement mohamad abed el rahman hammoud methodology visualization investigation software writing original draft issam lakkis conceptualization supervision software writing review editing omar knio conceptualization methodology supervision writing review editing funding acquisition ibrahim hoteit conceptualization methodology supervision writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments research reported in this publication was supported by the office of sponsored research osr at king abdullah university of science and technology kaust crg award no osr crg2018 3711 and virtual red sea initiative grant rep 1 3268 01 01 and by the university research board of the american university of beirut aub we acknowledge the use of e u copernicus marine service information available at https doi org 10 25423 medsea reanalysis phys 006 004 appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 108435 
21182,identifying marine pollutant sources is essential to assess contain and minimize their risk we propose a lagrangian particle tracking algorithm lpt to study the transport of passive tracers advected by an uncertain flow field described by an ensemble of realizations of the ocean currents and to identify the source parameters of the release in backward mode starting from a probability map describing the distribution of a pollutant reverse tracking is used to generate probabilistic inverse maps by integrating it with the ensemble of flow fields backward in time an objective function based on the probability weighted distance between the resulting inverse maps and the source trajectory is then minimized to identify the likely source of pollution we conduct numerical experiments to demonstrate the efficiency of the proposed algorithm in the mediterranean sea passive tracers are released along the path of a ship and propagated with an ensemble of realistic flow fields to generate a probability map which is then used for the inverse problem of source identification our results suggest that the proposed algorithm captures the release time and source of pollution successfully pinpointing to the release parameters up to two weeks back in time in certain case studies keywords marine pollution source identification lagrangian tracking moving source stochastic flow field 1 introduction modeling the transport of species and pollutants in the ocean is important for a variety of applications including search and rescue otote et al 2019 risk assessment niu et al 2010 havens et al 2010 and ecosystem management raitsos et al 2017 wang et al 2019 this is often used to determine the trajectory and final destination of pollutants particle tracking of pollutants in water bodies has been extensively studied for a deterministic flow e g kao and elsayed 1990 and also for an uncertain stochastic flow e g zhao et al 2011 el mohtar et al 2018 in a stochastic framework the solution of the particle tracking problem is described by a probability map that indicates the likelihood of a particle reaching a certain location beaudoin et al 2007 el mohtar et al 2018 lagrangian particle tracking lpt algorithms which track individual particles in a lagrangian framework are commonly used to model the transport of matter in a flow field kao and elsayed 1990 brickman and smith 2002 batchelder 2006 such algorithms can be coupled with physical models to study the transport of specific types of particles for instance the lpt can be coupled with certain biological modules to investigate the transport of nutrients and fish larvae in water bodies petihakis et al 2002 sentchev and korotenko 2007 lett et al 2008 another use of this algorithm is to track micro plastics and study their spread wichmann et al 2019 lpt was also used for simulating oil spills de dominicis et al 2013b such as the deepwater horizon in the gulf of mexico north et al 2013 liu et al 2013 after augmenting it with diffusion and oil weathering to describe the coupling between physical and chemical processes such as emulsification evaporation and dispersion north et al 2013 liu et al 2013 a thorough review of recent advances in ocean applications of lagrangian tracking algorithms can be found in van sebille et al 2018 the use of lpt also extends to the field of medicine and drug delivery where models for micro scale motion are implemented to track the transport of drugs in the human body pourmehran et al 2015 schuster et al 2015 uncertainties in particle tracking are associated with uncertainties in processes particles undergo and in the oceanic flow field which arises from the imperfect representation of the ocean forcing initial conditions and internal physics groves et al 2008 bennett et al 2012 edwards et al 2015 hoteit et al 2018 uncertainties in the oceanic flow are commonly tackled by advecting particles with a stochastic flow field represented by an ensemble of realizations beaudoin et al 2007 guo et al 2013 2019 el mohtar et al 2018 in this sense at each time step the velocity field consists of a set of realizations representing possible scenarios of the ocean currents hoteit et al 2013 recently el mohtar et al 2018 investigated an lpt algorithm operating with an ensemble of flow fields of the red sea this algorithm advects particles in a parallel framework and introduces a cost effective binning scheme that groups spatially close particles in order to cap the number of particles to avoid memory and storage issues similarly guo et al 2013 investigated the advection of particles in a stochastic atmospheric flow and constructed a variational field which characterizes the differences in ensemble runs based on the different pathlines obtained for each particle the mediterranean sea is a busy waterway responsible for around 15 of the global shipping activity kostianoy and carpenter 2018a offering a passageway for different types of ships recreational shipping tankers etc girin and carpenter 2018 and hosting many oil platforms along its coast kostianoy and carpenter 2018b it is therefore prone to marine pollution from fixed platforms and from moving ships according to kostianoy and carpenter 2018b 14 accidental oil spills occurred in the mediterranean between 1970 and early 2016 that contaminated the sea with more than 10 tons of oil the lebanese oil leak of 2006 is considered as the biggest oil pollution incident in the eastern mediterranean coppini et al 2011 lpt models have been extensively applied to the mediterranean sea to study various transport phenomena such as micro plastics van sebille et al 2015 liubartseva et al 2016 2018 duncan et al 2018 and oil some of the well developed oil spill models are poseidon annika et al 2001 perivoliotis et al 2011 medslik zodiatis et al 2012 2017 lardner and zodiatis 2016 2017 and medslik ii de dominicis et al 2013a b lpt algorithms can also be operated in reverse mode to investigate the inverse problem of source identification which only requires direct integration of the particles backward in time when time reversible terms are involved brickman and smith 2002 batchelder 2006 breivik et al 2011 this generally becomes noticeably more complex for nonlinear irreversible problems which may require more advanced inverse approaches such as bayesian inference yee 2007 or more sophisticated integration techniques such as operator splitting ivorra et al 2016 until recently source identification in ocean studies has been restricted to a single source applications with a deterministic flow field zodiatis et al 2012 tackled the problem of determining multiple sources in a deterministic flow by integrating contours and particles backward in time el mohtar et al 2018 addressed the problem of source identification of a single release source in a probabilistic framework by integrating a single particle backward in time using an ensemble of flow fields and generating a spatial distribution describing the likelihood of where the particle might be located in this work we first investigate the transport of particles from fixed and moving sources with an uncertain flow we then introduce and test a new approach to identify the contamination source based on an objective function described by the distance between the inverse probability maps and the paths of different ships weighted by the probability associated with individual particle locations found by inverse tracking the proposed methodology is computationally very efficient and can be utilized with any lpt algorithm capable of backward integration brickman and smith 2002 batchelder 2006 breivik et al 2011 zodiatis et al 2012 de dominicis et al 2013a b el mohtar et al 2018 this could also be particularly useful to provide timely support for a first fast response of a spill for instance in an operational setting when the composition of the pollutant is not known or when weathering processes cannot be accurately modeled we demonstrate the efficiency of the proposed framework by conducting realistic numerical experiments to identify the source of pollution in the mediterranean sea advected by an uncertain flow the experiments indicate that under certain conditions that do not include heavy beaching effects the release source and time of pollutants may be efficiently predicted up to two weeks after the release the sensitivity of the objective function to the observation time and flow variability is also examined the paper is structured as follows the lpt methodology is described in section 2 with a focus on continuous particle release from both fixed and moving sources in an uncertain flow field section 3 presents the proposed algorithm for source identification the design of the numerical experiments is outlined in section 4 and the results are analyzed and discussed in section 5 conclusions and final remarks are offered in section 6 2 forward tracking we build on the lpt algorithm presented by el mohtar et al 2018 to advect particles released from a single source at a given time with deterministic and stochastic flow fields the algorithm efficiently deals with particle advection through parallelization and controls the growth of the number of particles when advected with an ensemble of flow fields by binning integration for particles location is carried out using a 4 t h order runge kutta scheme to solve for the unsteady advection equation governing the transport of passive particles at each integration advection time step δ t in an uncertain setting the released particle is advected by each of the realizations of the ensemble of flow fields with each realization representing a possible scenario for the transport of a particle at that specific location this generates a spatial distribution of the particles with associated probabilities of being at the corresponding location this distribution is referred to as a probability map to overcome computational issues arising from the exponentially growing number of particles particles are binned so that the total number of particles is capped to a maximum hollt et al 2015 bins are defined as refined spatial cells where particles belonging to the same bin are grouped into a single particle here binning is spatially adaptive with smaller bins assigned to regions of higher probability and smaller variance the smallest bin has quarter the dimension of the computational grid cell in each direction binning is also designed to conserve the first two moments of probability of the particles to be at a given location before generating new particles with new weights where the weight of a particle is defined as the scaled probability of a particle being at a given location el mohtar et al 2018 a new particle injection mode is developed here to allow for a continuous release of particles from fixed and moving sources this model is schematized in fig 1 where new particles are released at each advection time step and advected from the release time till the end of the simulation time this staged injection advection allows to keep track of the time stamp of particles mimicking a realistic release fractional time stamping associated with the newly injected particles is used in the staged release to ensure their release at the intended time the time fraction is the ratio of the time elapsed from the current lpt model time step to the time between two consecutive velocity fields particles can be released from a fixed location denoted by x i n j at every advection time step particles can also be continuously released from a moving source of fixed path and speed the injection locations are determined based on the velocity and initial location of the moving source which can be expressed as 1 x i n j u s r c t i n j x 0 where t i n j is the injection time the release can last for as long as the ship is moving along the path where particles are released in stages and advected till the end of the simulation time based on the staged injection a particle is released at the chosen location of the moving source at the exact time it crosses this location for an ensemble of flow fields every particle is then advected by each realization of the currents where particles that end up in the same bin are grouped into a single bin while conserving the first two moments of probability as performed by el mohtar et al 2018 3 inverse tracking and source identification the inverse problem of identifying the source of a pollution patch released from a moving source starts with a standard lpt framework operating in reverse de dominicis et al 2013a el mohtar et al 2018 starting from an observed distribution of particles which may be deterministic or probabilistic particles are first sampled from this distribution before they are advected back to a selected time with the reversed currents an initial probabilistic distribution of this inverse problem may for instance represent an uncertain spatial map of particles locations inferred from a satellite image where such uncertainties may arise from imperfections in remote sensing and processing such as pixel noise and error bars in the classification algorithm wang et al 2009 zhang and zhang 2019 since the actual release time of the particles could also be an unknown inverse time integration is performed till a selected time prior to the release which is believed to be close to the release window where the release window is defined as the time frame between the start and end time of the release upon integrating the observed distribution backward in time a new inverse probability map is generated at every integration time step the inverse probability map represents the uncertainty in the particles location generated based on the particle distribution at every inverse time step an objective function is formulated based on the geographical distance between the inverse probability map and the moving source trajectory the objective function is designed so that its minimum occurs at the release time where the inverse probability map and the release segment are spatially closest to each other to identify a pollution source this objective function is computed for different ship trajectories in the area near the spill the minima are compared to identify the most probable culprit which corresponds to the smallest objective function different forms of such an objective function were investigated including the shortest and average distances the objective functions are normalized for a more straightforward comparison between the distances associated with the particle distributions obtained from deterministic and stochastic flows the first objective function measures the shortest distance between the points of the discretized probability map and the trajectory scaled by the probability of a particle lying in the cell and normalized by the total sum of probabilities of the particles to be at their corresponding locations such distances are schematized in fig 2 which shows the projections from some points of the probability map to the release path the distances are summed over all the points of the inverse probability map to produce the objective function based on the shortest distance which is expressed as 2 j s h o r t e s t k i 1 n p t s m a p p i j 1 n p t s m a p p j x i x p i k where j k is the objective function corresponding to the k t h trajectory x i is the position of the point on the grid cell x p i k is the position of the projection of x i on the k t h trajectory p i is the likelihood at the i t h point of the probability map and n p t s m a p is the number of particles forming the probability map the objective function based on the average distance is evaluated as the sum of the distances between the inverse probability map and each of the points forming the trajectory scaled by the probability of the particle being there this can be expressed as 3 j a v e r a g e k i 1 n p t s m a p j 1 n p t s t r a j p i n p t s t r a j j 1 n p t s m a p p j k x i z j k where z j k represents the points forming the k t h trajectory and n p t s t r a j corresponds to the number of points forming the trajectory in our linear model the objective function in its two forms is convex having a minimum at the expected release time in order to determine the release location and time using a given observation a number of candidate trajectories of moving sources that have recently passed near the study region are first identified after computing the objective function and comparing the resulting distances some trajectories can be discarded since they are farther from the probability map than other trajectories in most situations a few close trajectories can be selected as possible candidates this can be addressed by tracking the time when ships passed through the release location using automatic identification systems e g marinetraffic global ship tracking intelligence www marinetraffic com to illustrate the form of the objective functions an experiment is conducted in which particles were released at hourly increments along a ship path extending from 35 n 22 e to 36 n 16 e over a period of one day from day 3 till day 4 of the simulation time fig 3 plots sample results for the proposed objective functions showing convex shapes for both objective functions for the test shown the two objective functions defined in equations 2 and 3 point to different minima with the shortest distance based objective function being able to accurately pinpoint the release time as opposed to the average distance based approach which was 3 days off as can be seen in fig 3 in particular in the case of a continuous release the proposed methodology would point to the end of the release window after all the particles are released into the ocean this was observed in our study where the data is available at a daily rate after extensive testing the shortest distance formulation was selected as the better approach 4 experiments design 4 1 experimental setup experiments are conducted to assess the performance of the proposed algorithm to test the continuous release of particles from a fixed source we place the source location at the south of the ionian sea at 18 e 34 6 n and continuously release particles at an hourly rate for a period of one day for the moving source experiment we opted to use a ship trajectory that is densely operated by vessels we first examined the vessel routes density in order to choose a route that is representative of a real case scenario the density map for the vessels in the mediterranean is shown in fig 4 which outlines how congested the mediterranean is in terms of annual number of ships from the density map a path of high density is selected the chosen path is for a ship traversing the mediterranean sea westwards starting from the suez canal and leaving through the strait of gibraltar release segments were chosen to represent single day releases based on a ship that moves at a constant speed the chosen path is split into seven segments each segment corresponding to continuous ship motion over a single day traveling at a constant speed of 14 knots corresponding to a typical tanker or bulk carrier these release segments are illustrated in fig 5 a single day release period was chosen to mimic an emergency scenario an example of such is the lebanon jiyyeh oil spill which lasted for approximately 2 days coppini et al 2011 the experiments focus on the day 3 release path with a release window between days 3 and 4 with the exception of section 5 4 in which we study the release from the day 1 path due to the heavy beaching observed in its vicinity simulations are conducted using the ensemble of velocity fields described in section 4 2 advecting particles every hour as for the inverse simulation particles were integrated two week back to reach the first data time step which was day 0 in our experiments finally we use a maximum of 100 million particles for all simulations following the results of el mohtar et al 2018 who suggested that a maximum number of particles greater than 50 million is needed to capture the details of the particle distribution 4 2 generating a flow field ensemble copernicus marine environment monitoring system cmems offers 30 years of reanalysis fields for the mediterranean sea based on which we generate an ensemble of realizations of the ocean currents to mimic a probabilistic framework the reanalysis spans the mediterranean from 6 00 to 36 25 in longitude 30 17 to 45 9375 in latitude and a depth stretching down to 5334 65 m below sea level the data is uniformly spaced horizontally with a resolution of 0 0625 0 0625 and non uniformly spaced in depth with 72 levels corresponding to 677 253 72 grid points the reanalysis is available over a 30 years period from 1987 till 2016 from which we focus on the time frame between the 14 t h of july and the 12 t h of august this provides a sufficient time span to examine long time integration and discontinuous releases the whole reanalysis dataset was also used for generating an ensemble of flow fields as described below an ensemble of realizations of the sea currents is randomly generated for each day of the simulation period based on a normal distribution with mean as the background velocity and covariance as that of the reanalysis velocity fields on that same day of each year for a total of 30 fields in order to include more realizations for a given date windows of 0 1 and 2 days about the day of interest were examined based on which a window of 1 day was found sufficient to sample smooth fields an empirical orthogonal function eof analysis is then performed to filter out low time variance features generally of small scales nature in the ocean before sampling golub and reinsch 1971 preisendorfer and mobley 1988 hoteit et al 2001 this is achieved by computing the eigenvectors and corresponding eigenvalues λ i j of the covariance matrix c d i the eigendirections corresponding to small eigenvalues of the covariance are then truncated to obtain a low rank approximation c d i of c d i here we select the first eigenvectors that describe at least 95 of the variance of the realizations according to 4 j 1 r λ j j 1 m λ j 0 95 where m is the total number of eigendirections and r is the number of retained eigendirections this low rank approximation of the covariance is readily decomposed into c l l t which is used to generate the members of the ensemble of flow fields as follows 5 x d a y j i x d a y j 2006 l γ d a y j i γ d a y j i n 0 i m m where x denotes the longitudinal or latitudinal currents j is the day of interest i 1 2 n e and n e the ensemble size chosen to be 50 in our experiments as typically provided by marine weather services the γ i s are resampled every time step from a normal distribution of zero mean and identity covariance the background surface velocity field the variance of this ensemble and a few realizations of the surface currents for day 15 are presented in fig 6 suggesting high uncertainty near oceanic mesoscale features such as straits and eddy peripheries as typically obtained from ocean ensemble data assimilation systems hoteit et al 2010 4 3 inverse maps and post processing the probability maps are generated at each time step by processing particle distributions using a gaussian basis function that maps the particle weights into probabilities defined on grid cells el mohtar et al 2018 it is generally beneficial to post process the probability maps in order to remove particles with negligible weights and to filter out particles trapped along the coast where trapped particles are particles that are advected by multiple realizations of small velocity particles with negligible weights are usually found along the edge of the slick and although they have low probabilities however since they are far from the ship trajectory they contribute to the objective function causing a deviation of its minimum removing particles trapped near the coast however is generally useful because these particles were found trapped along the coast by several realizations of small velocities that prevented them from being released back into the ocean which in turn leads to deviating the minimum of the objective function away from the actual release time one straightforward way to filter the particles distribution is to discard unlikely particles whose weights are less than a prescribed threshold another way is to evaluate the cdf of the probability distribution then truncate all the particles in the lower 5 density which would remove all particles with low probability relative to the whole distribution it is also possible to truncate all the particles in both the lower and upper 5 of the cdf this discards all particles with low probabilities and by removing the top 5 particles highly concentrated particles near the beach are discarded this would however remove particles near the trajectory with high probabilities one may also only disregard particles located in coastal cells where coastal cells are defined as those with at least one node of the 3 d grid cell on land a stricter procedure to handle concentrations of particles near the shore is to remove both coastal and directly neighboring cells this allows to mitigate beaching effects where beached particles trapped near the beach would be excluded from calculating distances filtering based on coastal cells schemes is illustrated in fig 7 after testing the aforementioned techniques removing the coastal cells was chosen for filtering the particles distributions for our study further discussion is presented in the supplementary material in which comparisons of the resulting probability maps and distances are discussed 5 results this section presents and discusses the results of the numerical experiments illustrating the implementation of the proposed source identification algorithm for continuous release from fixed and moving sources in addition we assess the sensitivity of the algorithm to various parameters including the size of the observed area the observation time and the variance of the ocean currents ensemble 5 1 continuous release from a fixed source in this experiment particles are released from a source located at 18 e 34 6 n over a single day between days 3 and 4 and advected till day 30 the resulting probability map at day 14 is then saved from which particles for the inverse study are sampled and propagated backward in time the objective function is then computed at every inverse time step and the minimum is located these results are presented in fig 8 the forward probability map shows that the particles were advected far from the source location the inverse study portrays the stochastic behavior of the ensemble which causes some deviation of the location of the maximum probability from the actual release location the minimum distance between the probability maps and the release location which indicates the release time of the spill is detected to be within the release window where the distance was approximately 66 7 km at day 4 the end of the release 5 2 continuous release from a moving source 5 2 1 forward simulation release path 3 yellow in fig 5 is now considered for the forward moving source experiment particles injection starts at day 3 and ends at day 4 snapshots of the probability map are presented for different times in fig 9 the impact of staged injection is observed at day 4 with the particles released earlier spreading more than later ones as expected here the particles are released from a location far from the shore and the interaction of the particles with the coast occurs at a later time with beaching occurring between days 12 and 15 near the north african shore prior to day 12 regions of high probability were concentrated near the release path 5 2 2 inverse simulation starting with the probability map shown in the top left of fig 10 as generated by the forward integration taken at day 14 integration of the particles distribution is conducted backward to day 0 a collection of resulting probability maps at different simulation times of the inverse integration is presented in fig 10 the inverse probability map is observed to be advected away from the north african shore it becomes more diffuse in time due to the stochastic nature of the ensemble however the high probability areas of the probability map becomes concentrated near the release path beaching occurs at the periphery of the probability map where particles interact with the italian coast from as early as day 9 5 3 source identification the objective function is computed between the inverse probability maps and all seven release paths from fig 5 to identify the most probable polluter among the selected paths fig 11 presents the plots for the resulting objective function with respect to all seven paths along with another plot focusing on the evolution of the objective function relative to path 3 the actual release path in the study the results suggest that the most probable release source path is the actual release path release path 3 which is the closest to all the inverse probability maps the plot of the objective function computed between the inverse probability maps and release path 3 is convex with its minimum lying within the release window where the release time is correctly identified to be day 4 the end of the release window this demonstrates that the algorithm is capable of identifying both the release time and path of the pollutant 5 4 sensitivity analysis observation time this experiment focuses on release path 1 red in fig 5 where the mainstream currents are observed in fig 6 to drive particles into the shore leading to beaching early on the release path and time are fixed and different times at which the observation is available are investigated to assess the robustness of the algorithm in identifying the release time and path in fig 12 various curves of the objective function computed with respect to probability maps from different observation times are presented the closer the observation time is to the release time the better the algorithm is at pointing to the release window when beaching effects are dominant the observation time has to be close to the release time in order to accurately identify the pollutant comparing these results to the distances in fig 11 we notice that when beaching effects are present the release time can be identified if the observation is collected at most 5 days after the initial release as opposed to the release from trajectory 3 where the source was identified using an observation collected 12 days after the release 5 5 sensitivity analysis ensemble variance the impact of uncertainties in the ensemble of the flow fields on the identification of the spill time and location is investigated by varying the ensemble variance in the forward and inverse runs the aim is to examine whether a more certain flow field or a more localized probability map would help better identifying the release source the sensitivity analysis utilizes a modified ensemble with 50 and 100 of the reference ensemble variance in the forwards simulation and 100 75 50 25 of the reference ensemble variance along with a deterministic current field that advects particles with the average of the ensemble for the inverse study the ensemble variance is adjusted by spreading its members by a variance fraction f 2 that represents the fraction of the variance of the new ensemble to the old ensemble the new ensemble is then generated as 6 u i j x t f 2 u i o g j x t 1 f 2 u o g j x t where i 1 2 n e represents the realizations j 1 2 denotes the time index u i j x t the i t h new ensemble realization of the currents at position x and time t u i o g j the i t h original ensemble realization and u o g j the average of the original ensemble realizations the results presented in fig 13 reveal that a more certain inverse flow field effectively yields a probability map that is closer to the release path than the original ensemble snapshots of probability maps at day 3 are presented in the supplementary to illustrate the effect of the ensemble variance on the spread of the probability maps the results also suggest that using a more certain flow field in the forward run would yield a tighter probability map which in turn leads to samples located spatially close to each other and the objective function was smaller the accuracy of source identification is noticeably improved when the inverse advection uses a more certain flow field in particular the objective function yielded a minimum distance of approximately 93 k m when the particles were advected with an ensemble of flow fields with half the original ensemble variance as opposed to 115 k m with the original ensemble focusing on the case of half ensemble variance in the forward integration the minimum distance ranged between 86 k m in the deterministic case and 104 k m in the full variance case to be able to compare with the deterministic case where the solution is represented by a collection of points instead of a probability map the objective function was computed based on the average distance 5 6 sensitivity analysis initial number of particles the sensitivity of the objective function to the initial number of particles from which the inverse study starts is examined by varying the number of sampled particles from the observed probability map the objective function is computed for inverse simulations starting with 1 10000 20000 30000 and 40000 particles where 40000 particles is the maximum number of particles based on the available computer memory in our case the number of particles sampled from the observed map corresponds to the observed area where using less particles may under represent the spill which prevents from accurately identifying the release time fig 14 presents the distance curves for different initial particles distributions using the objective function in addition a sufficiently large collection of particles which adequately represents the spatial uncertainties is needed to identify the release time and source in particular the more particles are used the more information is available and the objective function would point to the release time better which was seen in this experiment where by sampling one particle the objective function points to day 0 as the release time whereas using at least 10 000 particles the objective function points to the actual release window between days 3 and 4 5 7 investigating more challenging scenarios finally the algorithm is tested on paths that are close to the actual release to further assess its robustness to possible nearby release paths the selected paths illustrated in fig 15 are as follows the actual path where the release originates paths that are parallel to the actual release at 0 5 and 1 paths 1 to 4 respectively a path that is perpendicular to the actual path path 5 paths that intersect with the actual path with some angle paths 6 and 7 the objective function computed between the inverse probability maps and these paths are plotted in fig 15 suggesting that the proposed algorithm pinpoints two most likely source ships this is indicated by the objective functions which yielded comparably close distances to the probability map 41 2 k m actual release path and 41 7 k m release path 3 in this situation additional information about the marine traffic may help identify the source ship the results of fig 15 show that the path to the south of the actual release has a similar distance to the probability map this can be explained by the nature of the velocity field in the region which drives particles northwards in the inverse simulation therefore the path 0 5 to the south is expected to have a short distance at a time close to the observation time thus the proposed methodology provides a systematic approach to rule out ship paths that do not belong to probable polluters 6 conclusion we proposed a new methodology for identifying the release time and path of pollutants from fixed and moving sources the proposed methodology relies on an lpt algorithm capable of backward integration and accommodates deterministic and stochastic flow fields a staged particle injection algorithm for the forward particle tracking from fixed and moving sources was implemented backward particle tracking starting from an observed map which could be deterministic or probabilistic was introduced along with proper filtering of particles trapped at the coast or particles of low probability the identification of the release time and trajectory was formulated as determining the minimum of an objective function measuring the distance between inverse probability maps and release trajectories weighted by the probability of the particle to be at its corresponding location source identification was tested with our lpt operating with an uncertain flow in the mediterranean sea the results of the numerical experiments suggest that the proposed methodology could successfully identify the release time and location for up to two weeks when the effects of coastal interactions are weak and up to 5 days when particles interact heavily with the coast the results also suggest that the proposed methodology could also be used to shortlist the probable polluters in challenging scenarios where densely operated paths are nearby or intersecting in future work we shall augment our lpt with a physical model to simulate specific pollution spills such as oil spills this may require developing a more sophisticated inversion such as bayesian inference to address the nonlinear irreversible nature of the pollution dynamics and weathering effects a bayesian inference framework however will be computationally prohibitive in a realistic setting as the sampling of the posterior distribution of the parameters of interest will require evaluating the likelihood using the pollution model for each sample of the parameters to be inverted we will explore surrogate models to alleviate the computational burden of such an approach we also plan to investigate other more sophisticated beaching models to mitigate the loss of information caused by coastal interactions credit authorship contribution statement mohamad abed el rahman hammoud methodology visualization investigation software writing original draft issam lakkis conceptualization supervision software writing review editing omar knio conceptualization methodology supervision writing review editing funding acquisition ibrahim hoteit conceptualization methodology supervision writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments research reported in this publication was supported by the office of sponsored research osr at king abdullah university of science and technology kaust crg award no osr crg2018 3711 and virtual red sea initiative grant rep 1 3268 01 01 and by the university research board of the american university of beirut aub we acknowledge the use of e u copernicus marine service information available at https doi org 10 25423 medsea reanalysis phys 006 004 appendix a supplementary data the following are the supplementary data to this article multimedia component 1 multimedia component 1 multimedia component 2 multimedia component 2 multimedia component 3 multimedia component 3 multimedia component 4 multimedia component 4 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2020 108435 
21183,colregs based collision risk awareness model is urgently needed in real time operating conditions however this is a complicated problem under various encounter situations some of which are very complex in order to quantify the collision risk in real operating conditions a novel risk informed collision risk awareness approach is proposed for real time operating conditions firstly the ship s actions are identified based on the automatic identification system ais data secondly the uncertainty of ship action patterns is analyzed by regarding the target ships as velocity obstacles then the collision risk model is utilized to assess the collision risk level based on the uncertainty in the non linear velocity obstacles algorithm considering responsibility finally some case studies are carried out based on the proposed model in the model the dynamic and uncertainty features of the ship action dynamics in real operating conditions are considered which could benefit on reducing ship collision accidents and improving the development of technologies on intelligent collision avoidance decision makings keywords ship collision real time risk awareness colregs automatic identification system velocity obstacles 1 introduction shipping has been a significant mode of transportation for international and domestic trade because of its large capacity and environmental friendly nature wan et al 2019 research on ship collision and anti collision strategy has been an essential topic of maritime transportation studies chen et al 2019 wang et al 2013 one element in preventing collision accidents is the presence of a collision alert system providing warnings to ship crews and or personnel in vessel traffic services of the collision risk in a real time operational environment goerlandt et al 2015 to release crews from longtime navigation in the open sea or frequent navigational acts in restricted waterways researchers have made great efforts in finding safer and more intelligent transportation methods intelligent and autonomous real time collision risk awareness methods are becoming popular intelligent risk awareness methods are commonly used in autonomous underwater vehicles auv and unmanned surface vehicles usv they are two different types of intelligent tools that play a significant role in military and scientific research the risk analysis of auv and usv have attracted researchers attentions because of their various potential applications compared with merchant ships the risk evaluation method of auv and usv is somewhat different as they are much easier to operate and they can react quickly but they mostly share the same term of safety domain which is applied to find the available room to maneuver they have to take the influencing factors into consideration such as speed course environment and maneuverability therefore the quantitative and qualitative risk analysis of usv and auv can be a reference for ships velocity obstacles vo is one of the most popular intelligent collision avoidance methods used in usv and auv it has been utilized in risk awareness and collision avoidance for ships however most of the existing studies have many strict restrictions such as regular or constant speed known trajectories and dynamics therefore there is still much space to be explored for vo applications it would be meaningful to learn a ship s vo based on motion features from historical ais data to predict the risk the rest of the paper is organized as follows section 2 presents a literature review of the related researches on collision risk awareness focusing on techniques and algorithms in section 3 a novel collision risk awareness model is proposed which contains action identification motion uncertainty and the collision risk model based on non linear velocity obstacle algorithm section 4 presents case studies to verify the proposed approach including both paired ship and multi ship encounter scenarios and comparative analysis between unlvo and nlvo is carried out finally conclusions on the results are raised in section 5 2 literature review collision risk analysis of ship including ship ship collision and near miss collisions have been widely investigated by researchers because shipping is one of the most efficient and low cost transport modes wang et al 2020 wu et al 2020 however maritime transportation sometimes brings severe consequences such as loss of lives irreversible environmental damage zhang et al 2019 there are various methods used for evaluating and quantifying risk accordingly most of the existing researches regarding collision risk models can be divided into several categories including historical data related statistics collision risk anti collision model collision risk prediction model and behavior oriented simulations fang et al 2019 liu et al 2020 jiang et al 2021 studies on collision risk of ships usv and auv can be further divided into three classes prior risk analysis and quantification process or real time collision avoidance decision making and post collision causation analysis the collision risk and anti collision strategies mainly include ship domain related risk awareness and risk evaluation probability risk calculation method risk constrained by colregs historical data related statistics real time collision awareness and velocity obstacles vo as the approach mentioned in this paper some related research containing ship domain based risk awareness and other real time risk awareness methods are comprehensively discussed in the following subsections 2 1 ship domain related research the ship domain model was first proposed by observing the ship navigation behavior within a certain water area fujii and tanaka 1971 ship domain model as a quantitive tool to evaluate potential risk when another ship enters in the scope of own ship has been widely used in different areas including ship collision avoidance hansen et al 2013 im and luong 2019 jingsong et al 1993 qu et al 2011 szlapczynski et al 2018 szlapczynski and szlapczynska 2017 near miss and hot area identification winkler et al 2019 yoo 2018 zhang et al 2015 zhou et al 2017 calculation of encounter rates collision risk and vts design moreover many concepts have been introduced based on ship domain including fuzzy quaternion ship domain fqsd qu et al 2011 dynamic quaternion ship domain dqsd wang 2013 collision diameter silveira et al 2013 distance at closest point of approach dcpa and time to closest point of approach tcpa minimum distance to collision mdtc montewka et al 2010 velocity obstacles degré and lefèvre 1981 the dcpa and the tcpa are the two most important parameters to evaluate collision risk some analytic approaches have been proposed for domain based collision risk parameters such as the degree of domain violation ddv and time to domain violation tdv szlapczynski and szlapczynska 2016 however dcpa and tcpa can not gererate an applicable and quantitative value about collision risk they are used to show collision risk based on subjective judgment therefore another important index called collision risk index cri is introduced in which the probability of collision is evaluated with three significant characteristics namely ambiguity uncertainty and instantaneity the value of cri is affected by various factors among which the key elements with a significant impact on cri are dcpa tcpa the distance from the threatening vessel the relative bearing and the ratio of speed according to existing literature zhao et al 2016 it is not only used to evaluate collision risk but also to grounding and sinking risk with dynamic ship domain model liu et al 2015 wang and chin 2015 moreover ship domain has been used for risk awareness zhang et al 2017 ship domain related risk awareness focus on the gradient of distance to target ships and ship domain area however it does not have the ability to show navigable area thus they are not sufficient for estimating ship collision risk and for planning evasive maneuvers 2 2 real time collision risk awareness there is an urgent need to better visualize the collision risk which can also present a reference for collision avoidance operations wu et al 2019 moreover the assessment of collision risk should be in a real time mode perera et al 2010 many researches recognized that it is urgent need for crews to be alert to the real time collision risk which is beneficial to make decisions however many existing studies have some strict assumptions and are applied to limited scenarios such as simple dynamics of the ship huang et al 2019 which bring limitations on making anti collision decisions most of the systems cannot provide with a general picture in a complex situation involving all possibilities of maneuver in relation to changes of course and or speed by the threatened ship and taking into account of all other ships in the vicinity degré and lefèvre 1981 some advanced methods were proposed to improve the efficiency and effectiveness of collision avoidance zhang et al 2020 while showing real time collsion risk im and luong 2019 offered a picture of risk zone around a ship and divided the risk zone into four zones by three boundaries with different levels of risk then collision risk zone was utilized to detect and evaluate risk of collision in real time however these studies can t integrate real time collsion risk with collsion avoidance effectively 2 3 velocity obstacle algorithm the velocity obstacle vo treats the velocity of the target ship as a dynamic obstacle considering both static and dynamic information and make real time risk visualization degré and lefèvre 1981 described the initial idea of vo then paolo fiorini 1996 put forward the concept and formulated the vo model since then vo has been widely applied to risk visualization of intelligent entities however many existing researches make an assumption that both the information of own entity including ships usv auv and targets are available in advance meanwhile the target ships navigation information is not fully available in advance in real cases that is to say traditional vo algorithm does not take efficient communication between entities into consideration accounting for communication and reaction among entities van den berg et al 2011 introduced a probabilistic extension to the vo approach called probabilistic velocity obstacle pvo which considers the discrete prediction of the motion behavior of other agents then the concepts of collision cone cc reciprocal velocity obstacles rvo hybrid reciprocal velocity obstacles hrvo safety velocity obstacles svo and optimal reciprocal collision avoidance orca van den berg et al 2011 have been introduced in different studies for further understanding the impact of vo bareiss van den berg 2015 best et al 2016 rashid et al 2012 rufli et al 2013 snape et al 2011 a method called rvo among these terms provides with both collision free and oscillation free navigation zhao et al 2016 huang et al 2018 2019 huang and gelder 2017 used vo algorithm in collision avoidance issues for merchant ships huang et al 2019 summarized the linear vo and non linear vo that prevent collisions from target ships whose motions might change over time considering collision avoidance and the destinations song et al 2018 introduced a two level dynamic obstacle avoidance algorithm by combining the vo algorithm with the improved artificial potential field apf method in a non emergency situation a time discrete non linear velocity obstacle td nlvo method for collision candidate detection which is based on the non linear vo algorithm was also proposed to detect the collision candidates chen et al 2018 compared with other risk awareness methods vo performs better in collision risk visualization moreover nlvo can deal with nonlinear motions of target ships however some assumptions on nlvo limit its further applications to the situations that ship actions are not fully available in advance 2 4 innovation in light of the above the innovation of the paper can be summarized in three folds 1 a risk informed model is proposed that can be used for real time risk awareness 2 ship action identification model and ship action uncertainties are recognized by turning points and velocity uncertainty 3 an improved velocity obstacles method called uncertainty non linear velocity obstacles unlvo is proposed accordingly unlvo overcomes the following limitations of nlvo model traditional nlvo does not take the uncertainty of navigating information into consideration ship trajectory data are directly utilized to assess the risk in these studies which will lead to low accuracy in quantifying collision risk traditional nlvo ignores the identification of ship action that will result in the oscillation of risk especially when the ais data is not available in real time mode oscillation of risk will confuse the encounter situations as a result the main objective of this paper is to perform a dynamic risk informed collision awareness approach in real time operating conditions it is established by a modified nlvo method named unlvo that can express collision risk considering different types of uncertainties 3 methodologies and modelling 3 1 assumptions in order to reduce the complexity of the procedure and calculation time some rational assumptions should be made in advance the focus of this paper is to design a novel collision risk awareness model for navigating ships therefore the assumptions are prepared as described in zhang et al 2015 as follows the ship domain is treated as a circular and any intrusion of other moving or static obstacles must be avoided the size of the ship domain differs from the influencing factors such as encounter situations ship size and navigational water e g open sea narrow channel busy waterways szlapczynski et al 2018 it also depends on the specification of the ships traffic density automation and degree of efficient communication with obstacles the parameters of the dynamic ship domain could be adjusted according to the real time situations by the controlling system zhang et al 2015 the navigational information including speed course and position of all entities is available for the os in real situations the tes can be seen or detected by radar automatic radar plotting aid arpa or other detecting devices efficient navigational information is also influenced by many factors including visibility and the performance of arpa all these influencing factors can be simplified as the uncertainty of ship action as discussed in this paper the officer on watch oow may adjust this parameter to real situations as discussed in zhang et al 2015 the available operations on changing course or speed of os is determined by the maneuverability of the ships and navigational environment for example in open sea with good visibility the parameters can be set by the maximum in narrow or busy waterways they are set by the available speed and course derived from historical data according to channel conditions every entity except the static obstacles is assumed to comply with colregs then collision risk can be calculated however it is possible that one or some of the involved entities does not take actions as required by colregs so it is assumed that if there are any tes that should give way to the os but did not take actions the os will take full responsibility zhang et al 2015 3 2 risk informed collision dynamic awareness model real time risk awareness model is based on effecitive description of ship motions until now most researches on risk awareness rely on the acquisition of ais data however there are also challenges in extracting knowledge from ais data due to large data volume incompleteness noise rogue dark vessels etc tu et al 2018 on the other hand the influencing factors such as environmental factors recognition is often simplied most existing methods works on ideal conditions such as regular or constant moving speed no current influence and good weather conditions chen et al 2020 therefore there is still much space to be explored to understand the characteristics of ship motion behavior and the uncertainty of ship motion tu et al 2018 yan et al 2020 researches on ship motion behaviors are often refined by the uncertainty of ship control considering ship dynamics however in the real situation disturbances from the environment cannot be neglected which reflects the uncertainties on ship trajectories such uncertainties should be considered in a proper way in real time collision risk awareness hou et al 2020 so short term ship action uncertainty and relatively long term ship ation identification models are raised to express the ship motion characteristics zhang et al 2020 which can be treated as the foundation of real time collision risk awareness based on vo the framework is shown in fig 1 a collision risk awareness approach is proposed in real time operating conditions as shown in fig 1 first the ship actions are identified based on ais data in real operating conditions second the uncertainty of motion patterns is analyzed then unlvo model is raised based on ship action identification ship action uncertainty and collision risk responsibility model finally the risk awareness model is utilized to quantify the collision risk based on the unlvo algorithm more details are discussed in the following sections 3 3 ship action identification model ship actions are complex as multiple factors have impact on it these factors can be divided into internal or external factors the ship actions can be identified from a series of ship trajectories ship trajectories are becoming increasingly available and the size of recorded trajectories is becoming larger rong et al 2019 using appropriate methods while maintaining the main characteristics can help get the key information on ship action then ship action identification can be learnt from historical sub trajectories by use of appropriate compression threshold therefore the issue of ship action identification can be simplified as determining the range of position as shown in fig 2 there are various approaches to obtain the turning points such as clustering methods the douglas peucker dp algorithm was first presented by douglas and peucker 1973 it is one of the appropriate approaches in dealing with this problem as it can show different patterns based on threshold alteration the algorithm can split the line data recursively and control the compression quality by means of the threshold which is commonly used in simplifying the trajectory of moving objects zhao and shi 2018 in this paper a new scheme and the implementation of dp algorithm is introduced different thresholds can be used to reflect different kinds of compression in order to simplify and standardize threshold selection process a set of threshold step can be utilized to visualize compression degree therefore a threshold interval is firstly adopted then the interval step can be determined according to the threshold interval and compression result the threshold selection is fully connected with the aim and usage of compression in this paper compression rate formulated by the records reduction will be used as an indicator of the compression degree com represents the compression degree r e c o r d s t 1 means the records left based on previous threshold r e c o r d s t means the records left based on current threshold the threshold interval and threshold determination and iteration are presented in fig 3 1 c o m r e c o r d s t 1 r e c o r d s t t t the ais trajectory can be marked as a point set d p 1 p i according to the dp theory the algorithm is recursively applied to all trajectory subparts an improved dp algorithm is proposed in this paper considering threshold alteration it is a critical element showing the range of course and it is influenced by the factors including ship type water areas and environmental conditions in order to calculate the distance of point to line geographical coordinates should be converted into the coordinates in mercator projection zhao and shi 2018 the coordinates in the mercator projection of the track point x y are calculated as follows 2 r 0 a cos ϕ 0 1 e 2 sin 2 ϕ 0 3 q ln tan π 4 ϕ 2 1 e sin ϕ 1 e sin ϕ e 2 4 x r 0 λ 5 y r 0 q where ϕ and λ denote the latitude and longitude respectively ϕ 0 represents the standard latitude in mercator projection a represents the long radius of earth ellipsoid e represents the first eccentricity of earth ellipsoid r 0 represents the radius of the parallel circle of standard latitude q represents the isometric latitude the point to line distance can be calculated through the vector method which is expressed as 6 d s e s t s e where s e denotes the vector from the start point to the endpoint of the line segment s t denotes the vector from the start point to the target point of the line segment the detailled derivation is elaborated in zhao and shi 2018 then a series of threshold interval can be obtained which can help forecast the risk probability 3 4 ship action uncertainty model ship action uncertainty is affected by environmental and operational factors in this paper the focus is mainly on ship velocity aiming at trying to make a probabilistic evaluation of ship action ship action uncertainty model can be expressed as 7 i b v b where v b refers to velocity forming action uncertainty model of ship b i b is a ship action uncertainty set the contribution of nlvo algorithm is that it regards the ship maneuvering as a non linear motion the speed of navigating ships changes over time because of the structure of ships regulations and the environment as a critical element in the nlvo model speed distribution plays an important role in ship action uncertainty recognition the high values of speed always appears in the safe and open waterway the ships share similar velocities for the same ship type especially in the same navigation area gaussian process models have been applied for ship behavior anomaly detection as studied in perera et al 2012 rong et al 2019 considering such characteristics the speed distribution can be expressed as 8 f v 1 2 π σ v 2 exp x u v 2 2 σ v 2 where u v is the sample mean σ v is the standard deviation then the principle of 3 σ expressing the interval of ship action uncertainty 3 5 uncertain nlvo unlvo algorithm until now the researches of nlvo mainly consider the nonlinear trajectory considering that the trajectory is available with satisfactory precision what is more the nlvo algorithm cannot provide a general picture of collision risk caused by current velocity course and position in order to overcome such limitations the method proposed in this paper focuses on the ship action uncertainty and ship action identification combining the strength of pvo rvo svo and nlvo 3 5 1 traditional nlvo algorithm the nlvo set is defined as the collection of all the conflicting velocities leading to the ship collision for ship a and other entity b the velocity obstacle for a induced by b is a set of velocities that will result in a collision between a and b at a given moment the basic idea of the nlvo algorithm is to identify the nlvo set that a collision risk occurs in the near future if os s speed falls into this set which is expressed as follows 9 u n l v o t t p a t p b t 0 t t 0 c o n f p o r t t 0 c o n f p o r p a t p b t 0 r where u n l v o t is the nlvo set p a and p b are the position of the tes and os respectively c o n f p is the term describing all the possible positions of the tes when ship collision risk occurs between os and tes at time t is minkowski addition and the prohibited region around the os can be formulated as p a c o n f p o r if the speed vector of te is the element of u n l v o t the ship collision risk exists the formula derivation process is elaborated in huang et al 2019 from the explanation of nlvo it can be determined the space that te cannot enter obviously the motion of te can not be controlled by others but the available space current risk of os and anti collision responsibility for os and te cannot be inferred from the traditional nlvo so in order to realize real time collision awareness the nlvo algorithm should be further analyzed and improved 3 5 2 uncertain nlvo unlvo algorithm based on the previous analysis on vo it can be found that the velocity of ship b the distance between two ships and ship domain are the critical factors that influence the shape and vertexes of the vo areas ship action identification in previous sections is a foundation of unlvo take ship b as an example the velocity uncertainty of ship b can be modeled as 10 v b t n e w v t v t p ψ v t v b t σ b v t f v b t σ b ψ 0 1 v b t n e w is an iterative set of velocity interval with probability ψ and the new gaussian model with the mean of current velocity v b t and standard deviation σ b of current velocity the dynamic gaussian distribution is introduced with the hypothesis that the ship will keep the current velocity with high probability in the next sampling time for action identification of ship b historical ship traffic route can be regarded as prior knowledge in order to predict the position of ships rong et al 2019 some thresholds sets are found based on the sub trajectories for the free navigation in open waterways a threshold can be selected from thresholds sets according to the preference of oows ship dynamics and other influencing factors in narrow waterways or turning areas ship actions should be carefully regarded and the threshold can be determined by oows for different decision time slice the identification of ship b can be expressed as 11 l b t n e w l t l t e l b t l b t n e w is a set of positions it can simplify the position range into circle or ellipse with the center of the current position l b t indicates radius or semi major axis the position range is parallel to the velocity of ship b unlvo considering uncertainty and ship action identification is shown in fig 4 the dashed purple line shows the expanded area caused by the uncertainty of velocity and action pattern the new unlvo gives the ship a new alternative to navigate fig 4 shows that the ship action space is divided into three parts by vo namely srvo rear srvo front and srvo diverging meaning that the selected velocity will result in actions in rear front and diverging of tes the srvo is a dynamic area constrained by different encounter situations ship domain velocity of ship a and b range of course and velocity besides ships have the responsibility to alter course or change speed with respect to different encounter situations encounter situation can be divided into four stages as shown in fig 5 according to the responsibilities defined by colregs then a weighted index w a i can be used to denote the responsibility of ship a during stage i i i 1 2 3 4 as shown in fig 6 w b i denotes the responsibility of ship b based on ship action identification ship action uncertainty and collision responsibility analysis for encounter scenario the unlvo algorithm is developed based on traditional nlvo considering ship action identification and uncertainty let λ p a t c a t max v a t m a x denote a navigable space that is a closed disc of radius vatmax with the angle of catmax centered at position of a for every time slice more formally let a b a b a a b b be the minkowski sum of ship a and entity b d p a t a b means the points that lie in the area constrained by the right and left tangent of a b ending at point pa the basic idea of the unlvo algorithm is to identify the unlvo set that a collision risk occurs in a specific time slice if os s speed falls into this set for the next time slice each entity will attain its new velocity and unlvo set will be updated it is expressed as follows 12 λ p a t c a t max v a t m a x q p a t q p a t p a v a t m a x c a t c a t max d p a t a b q a t t a n g e t a b p a t a b a b a a b b t t i i c a t max c v a t max v u n l v o t t t i i v a t w a i λ p a t c a t m a x v a t m a x d p a t a b the formula derivation process is an integration of studies in huang et al 2019 and van den berg et al 2011 considering ship action identification and uncertainty with respect to pvo rvo and srvo then unlvo can be applied to different encounter situations defined by colregs the new unlvo can replace the traditional vo model and a new scheme of unlvo in compliance with colregs can be obtained 3 6 collision risk quantification and visualization the unlvo set of ship a induced by ship b is a set of risky velocities but the risk in unlvo varies from the different diameters of the collision triangle velocity around the area of vetex has a minor risk because ship a can maintain the same velocity for a longer time than the velocity close to the relative ship domain that is to say quantifying the risk using the velocity in unlvo is also meaningful steering and deceleration are the most common strategies to avoid collision in this paper steering means changing course while remaining the value of velocity whereas deceleration means keeping the direction while reduce the value of the velocity these factors can be used for risk visualization of steering including the intersection angle between current velocity and nearest safe velocity c r the intersection angle between current velocity and right largest safe velocity c r i g h t the intersection angle between current velocity and left largest safe velocity c l e f t distance between the apex of current velocity and collision free velocity d r distance between the apex of current velocity and the largest safe velocity d r max details are described in fig 7 13 r a b c r c r i g h t c r c l e f t d r d r max r ab is a set of visualized risk a risk visualizing index is selected with respect to environmental and navigational factors 1 risk of steering the distance of current velocity and the optimal velocity is used as an example to visualize risk risk at every sampling time can be calculated by how far it is from the endpoint of the current velocity to ℑ v o b that is the boundary of vo srvo and unlvo with the same velocity constrained by colregs induced by ship b vo tdist means the distance between the endpoint of current velocity and ℑ v o b during time interval t 14 v o t d i s t v t v o b t v t ℑ v o b t v t r v o b t t t b b the distance may vary due to different velocities in a specific time interval including maybe several time slices the maximum distance v o t d i s t max can be obtained as 15 v o t max d i s t v t v o b t max v t ℑ v o b t v t r v o b t t t the risk can be evaluated by the normalized distance as 16 r a b t v o t d i s t v t v o b t v o t max d i s t v t v o b t v t r v o b t t t b b where r a b t 0 1 so the collision risk caused by steering can be expressed as 17 p t c o l l i s i o n r a b t p ψ v b t n e w ψ 0 1 t t b b 2 risk of deceleration deceleration is also an alternative way to avoid collision the distance between current velocity and risk free velocity whose endpoint lies in the boundary between vo and unlvo with certain probability is also used to evaluate the risk caused by the current velocity in every sampling time the distance is calculated to make some comparison with the risk of steering constrained by colregs induced by ship b similar to the risk of steering v o v t d i s t means the distance between the endpoint of current velocity and ℑ v o v b during time interval t ℑ v o v b represents the intersection point of current velocity and vo i 18 v o v t d i s t v t v o v b t v t ℑ v o v b t v t r v o b t t t b b in certain time interval the maximum distance vo vtmaxdist can be obtained as 19 v o v t max d i s t v t v o v b t max v t ℑ v o v b t v t r v o b t t t the risk of current velocity can be evaluated by the normalized distance as 20 r v a b t v o v t d i s t v t v o b t v o v t max d i s t v t v o b t v t r v o b t t t b b where r v a b t 0 1 so the collision risk caused by deceleration can be expressed as 21 p v t c o l l i s i o n r v a b t p ψ v b t n e w ψ 0 1 t t b b 3 risk of action space the area of unlvo constrained by navigable space is another way to calculate risk the percentage of srvo shows the ratio of safety area in every sampling time or time slice the area of srvo rear srvo front srvo diverging constrained by unlvo represent that os has different choices for collision avoidance strategies thus the area of feasible space is used to calculate collision risk z u n l v o v t means the area of unlvo during time interval t with the velocity v z s r v o v t represents the area of srvo during time interval t so the risk of current velocity can be formulated as 22 r v a b t z u n l v o v t z s r v o v t v t r v o b t t t b b different risk awareness methods can be determined according to the encounter situation the tes navigational waterways and so on 4 case studies two case studies are performed to demonstrate the performance of the proposed method one is the pairwise ship case based on real ais data from an accident report of two merchant ships in section 4 1 the second case is a multi vessel encounter situation shown in section 4 2 in order to simplify the model the ship domain is set to be a circular in the case studies the radius is set to be three times of the ship length according to wu et al 2016 zhang and meng 2019 4 1 case study i 4 1 1 data source in order to quantify and visualize the collision risk in real time operation conditions a case study is carried out based on a historical ship collision accident using ais data two ships collided in the east china sea and the information of ship speed position and course was retrieved from ais between 19 20 to 20 04 of jan 6th 2018 the encounter scenario is shown in fig 8 the geographical coordinates have been converted into the coordinates in mercator projection in order to identify ship action as described in section 3 3 the ais data presents the high frequency almost real time information with respect to sailing patterns the ais data in the case study was retrieved from the accident report outliers and some pre processing have been removed to get useful information the longitude and latitude are transformed in meters in mercator projection as summarized in table 1 an appropriate dynamic threshold can be obtained in order to reflect the evolution of collision risk and anti collision decisions can be made accordingly 4 1 2 ship action identification the basis of real time vo is the synchronous of the ship dynamics data ais data play a significant role and are mainly applied to identifying ships historical routes svanberg et al 2019 usually ais devices transmit dynamic data at intervals ranging from 2 s to 3 min asynchronous data among ships cannot help formulate real time vo so data interpolation and information fusion borkowski 2017 have been used to synchronizing the ship dynamics information it is essential for the own ship to know the uncertainty in future positions of the target ships in a specific time span to effectively reflect encounter situations borkowski 2017 then the improved dp algorithm is adopted as described in section 3 2 the coordinates in the mercator projection are calculated according to the range of trajectories the threshold can be determined with 5 m according to ais data then the results of compression by the dp algorithm of both os and te is illustrated in fig 9 accordingly the highest points at 25 m and 30 m could be used to identify actions of os and te because records are changing rapidly furthermore other threshold interval can be selected for detecting ship action they will be selected according to waterway conditions and ability to deal with ship action based on the above analysis 25 m and 30 m are selected as the ship action identification threshold of os and te considering the open waterway condition and room to maneuver 4 1 3 ship action uncertainty the annotated time history of the analyzed ship trajectories os and te are shown in fig 10 as explained previously a gaussian model can express the uncertainty of ship s action for os the sample mean u v 1 is 6 79 m s the standard deviation σ v 1 is 0 43 with respect to te the sample mean u v 2 is 4 22 m s the standard deviation σ v 2 is 0 41 so the speed distribution can be determined accordingly the historical navigable data and simulation speed are presented in fig 11 4 1 4 parameter determination some parameters are predefined according to static information the velocity boundary of both ships is defined according to ship mobility and historical ais data the maximum velocity of os that is plotted as the boundary of arc of nlvo and unlvo is set to be 20kn which is 10 3 m s the maximum velocity of te is set to be 7 72 m s the left and right navigable course of both ships is 60 because they are navigating in open sea and there is enough space for operations the time slice is set to be 2 min which is the same with the time interval of ais data the details are present in table 2 4 1 5 unlvo modeling compared with nlvo dcpa tcpa it can be inferred that the area of nlvo of both ships is smaller than unlvo the uncertainty enlarged the traditional nlvo areas no matter what the uncertainty details are 1 nlvo analysis of real collision scenario the real time nlvo as time goes on is shown in fig 12 the navigable area is 58 m2 the red area represents the nlvo area the blue area means that the ship would cross from the rear of te the green area means that the ship would cross from the front of te in order to present a clear view of the area of nlvo the whole area have been enlarged by 300 times the calculation procedure stops at the point of the domain of the two ships no matter what magnified times are adopted the end point of the calculation is fully connected with the domain of os and te this phenomenon is also the same to other encounter situations according to colregs os is stand on ship and te is given way ship their actions should abide by colregs formally the encounter situation for stand on ship can be divided into four stages according to rule 17 of colregs namely action permitted for long range action prohibited action permitted and action required as shown in fig 5 usually the four stages are guidance for actions during the encounter situation meanwhile these actions are taken with respect to controllers experience skills immediate reaction and understanding of colregs for the first stage free actions can be taken as long as they identify each other the distance is usually beyond 6 nm as shown in fig 12 a in which the nlvo set is involved in the navigable room of os it means that there is a risky area that os can t enter in so in this stage os can take avoiding actions for the second stage actions of os are prohibited as long as the te takes an action well in time but it does not mean that os would not be alert and monitor the situation as shown in fig 12 b for the third stage the oows of os have to be alerted and should have monitored the situation their plans of action for evasive action should be ready at all instances since he has to take evasive action if the te failed to take action or if the action is not sufficient to clear the impending danger however te is not to alter course to port as shown in fig 12 c for the fourth stage the action range is set to be within 3 nm the action that the os finally takes to avoid the situation depends on what is the nature of the action of the te apparently the action of te is insufficient so os has to take the action that will get the two ships safely away from each other then real time collision risk can be calculated and compared with dcpa and tcpa as shown in fig 13 considering the encountering situation based on colregs os have the minor responsibility then it can be assumed that os have 0 3 wt the weight can be determined by oows as shown in fig 13 real time collision risk awareness based on nlvo considering anti collision responsibility can reflect the risk changing smoothly which would be beneficial for oows decision makings on the contrary the values of dcpa have many fluctuations which would confuse oows 2 unlvo analysis of real collison scenario the ship identification of os and te will lead to additional 55 m in traditional a b at the same time ship action uncertainty of os and te will lead to additional 300 m in traditional a b so that the a b in unlvo is 355 m larger than in nlvo consequently the unlvo area is bigger than nlvo but the navigable area is the same the simulation process is shown in fig 14 the whole area is 58 m2 the red area represents the unlvo area the blue area means that os will navigate to the rear of te the green area means that os will navigate to the front of te similar to the four stages analysis of nlvo the unlvo is analyzed to verify the risk awareness for the first stage free actions can be taken as long as they find each other the distance is usually beyond 6 nm as shown in fig 14 a unlvo set is involved in the navigable room of os it means that there is a risky area that os cannot enter so in this stage os can take collision avoidance actions for the second stage actions of os is prohibited as long as te takes correct actions in time but it does not mean that os would not be alert and monitor the situation as shown in fig 14 b for the third stage the watchkeeper of os has to be alerted and should monitor the situation with the unlvo set changing sufficient actions have not taken by te so os should select srvo area to make anti collision actions for the fourth stage the action range is set to be within ship domain the action that the os finally takes to avoid the situation depends on what is the nature of the action of the te if the action of te is insufficient and os has no navigable room to take actions collision will happen based on the analysis of unlvo real time collision risk and area of unlvo considering responsibility is present in fig 15 the collison risk of unlvo is increasing with time dcpa and tcpa have shown a decreasing trend and provide correct tendency about collision risk so both of them can be used to show the tendency as for real time collision awareness dcpa has many fluctuations that will make the oows feel confused about the encounter situation otherwise unlvo provides more accurate predictions and has less fluctuations than dcpa it can well reflect the evolution on collision risk from the 6 nm between os and te the risk goes up smoothly so the method raised in this paper can be used to achieve real time risk awareness successfully 4 2 case study ii 4 2 1 scenarios design the encounter situation including initial position velocity and course of os and tes are set as shown in table 3 considering different types of disturbances the course of ships encountered is given a random disturbance between 5 and 15 the time interval of ais data is set to be 1 min fig 16 shows the trajectories of the encountered ships according to colregs te2 is the given way ship te1 and te3 are stand on ships from the perspective of os 4 2 2 result of ship action identification and ship action uncertainty the indicators of ship action uncertainty are predefined based on previous analysis details are shown in table 4 ship action identification is represented by the indicator of compression rate then performance results of compression by the dp algorithm of both os and tes are illustrated in fig 17 accordingly the highest points at 10 m 15 m and 20 m could be used to identify actions of te1 te2 and os te3 4 2 3 unlvo analysis mutli ship encounter scenario can be divided into multiple pairwise unlvo analysis the area of a b is closely related to ship domain ship action uncertainty and ship action identification the ship identification of os and te1 will lead to additional 25 m in traditional a b at the same time ship action uncertainty of os and te1 will lead to additional 162 m in traditional a b so that the a b in unlvo is 187 m larger than ship domain the calculation process of a b between os and tes is shown in table 4 the simulation result is shown in fig 18 the areas with red blue and green have the same meaning with the previous simulation there is a new area marked with gray that is a mixed area of blue and green area induced by te1 te2 and te3 the encounter scenario includes situations of crossing from left and right so the mixed area emerges the left gray area in fig 18 means that the ship would cross from the rear of te2 and from the front of te1 and te3 the right gray area named mixed area means that the ship would cross from the front of te2 and the rear of te1 and te3 green area indicate that the ship would cross from tbe front of te2 te1 and te3 blue area indicate that the ship would cross from the rear of te2 te1 and te3 details are shown in fig 18 a b and c the whole area of os is 58 m2 then unlvo areas of os and te1 os and te2 os and te3 with time going is shown with blue green and red solid lines then the risk of action space of os and te1 os and te2 os and te3 with time going is shown in fig 19 os is threatened the most by te2 the risk induced by te1 and te3 are almost the same however te1 contributes higher risk than te3 before 700s and risk caused by te3 is higher than te1 after 700s however os is the stand on ship from te2 perspective and is the given way ship from te1 and te3 perspectives according to colregs so the collision responsibility should be considered into risk calculation the collision responsibility weight of os can be assumed from 0 3 to 1 subjectively during the encounter situation of os and te2 so the risk of te2 has some turning points as the weight increase details are shown in fig 20 based on the analysis in a two ship encounter situation unlvo can be utilized to achieve risk awareness and performs better than dcpa and tcpa in real time collision awareness the dcpa and tcpa of the multi ship encounter scenario are presented in fig 21 dcpa and tcpa have witnessed a decreasing trend and reflect correct tendency about collision risk but as for real time collison awareness dcpa and tcpa do not consider collision responsibility which will result in confused anti collision priority between te1 and te2 otherwise unlvo provides more accurate predictions and has less fluctuations than dcpa and tcpa it can effectively show the risk changing so the method raised in this paper can not only be applied to two ship but also to multi ship encounter scenarios and can realize real time collision risk awareness 4 3 comparative analysis a novel risk informed dynamic collision awareness approach is constructed to show the safe navigable space and the current risk caused by velocity course position of encountered obstacles with the identification of ship motion and uncertainty a modified nlvo method named unlvo and collision risk evaluation method is proposed to integrate ship motion with uncertainty into nlvo unlvo has a higher operability and feasibility and can better deal with complex situations considering more influencing factors than nlvo as in the above model construction and case studies the navigable room of unlvo and nlvo are the same because it is determined by ship maneuverability however the srvo area of unlvo is relatively smaller than that of nlvo considering risk quantification ais data interval navigational sea and anti collision strategies the difference and similarities between unlvo and nlvo can be summarized in table 5 5 conclusions by combining the advantages of vo and ship action uncertainty a real time collision risk awareness based on unlvo is proposed in this paper simulations on pairwise ships and multi ship encounter scenarios are fully analylzed to validate the method compared with nlvo dcpa and tcpa the results indicate that unlvo model presents a general picture so as to realize the monitoring and forecasting of collision risk moreover the dynamic and uncertain characteristics of ship motion patterns in operating conditions are considered in unlvo which could benefit from reducing constant collision actions compared with dcpa and tcpa unlvo provides more accurate predictions in expressing collision risk and can generate a uniform and acceptable risk evaluation it can better reflect the risk changing with the calculation of unlvo area moreover unlvo model takes collision avoidance responsibility into consideration the proposed model provides with a new perspective for risk awareness improving the development of theoretical technology on intelligent collision avoidance decision makings its applications can be further developed in the future research for instance it can be utilized to show the real time collision risk among encountered entities considering degrees of autonomy goerlandt 2020 both dynamic and static obstacles encountered scenarios can be considered furthermore this method can also be used to evaluate the overall risk of navigational waters by synthesizing with ship traffic flow data credit authorship contribution statement xiaoli yuan conceptualization methodology software validation formal analysis data curation visualization writing original draft di zhang project administration funding acquisition supervision writing review editing jinfen zhang conceptualization methodology software writing review editing mingyang zhang methodology resources visualization writing review editing c guedes soares supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research was supported by national key technologies research and development program 2017yfe0118000 2017yfc0804900 20170804904 funds for international cooperation and exchange of the national natural science foundation of china 52071247 51920105014 the hubei provincial natural science foundation of china 2019cfa039 and the european union s horizon 2020 research and innovation programme under the marie skłodowska curie reset 730888 fundamental research funds for the central universities wut 2019ⅲ207 wut 2020iva061 appendix a data availability and result visualization the ais data can be download from the researchgate website https www researchgate net publication 344952725 ais data the real time unlvo simulation and collision risk are available at https www researchgate net publication 344952307 unlvo modelling and simulation and https www researchgate net publication 344952097 the real time collision risk appendix b dtbl1 list of abbreviations table 6 abbreviations full name abbreviations full name ais automatic identification system vo velocity obstacles auv autonomous underwater vehicles usv unmanned surface vehicles fqsd fuzzy quaternion ship domain dqsd dynamic quaternion ship domain dcpa distance at closest point of approach tcpa time to closest point of approach mdtc minimum distance to collision ddv degree of domain violation tdv time to domain violation cri collision risk incidence imo international maritime organization pvo probabilistic velocity obstacle cc collision cone rvo reciprocal velocity obstacles hrvo hybrid reciprocal velocity obstacles svo safety velocity obstacles orca optimal reciprocal collision avoidance td nlvo time discrete non linear velocity obstacle os own ship tes target entities arpa automatic radar plotting aid oow officer on watch nlvo non linear velocity obstacles unlvo non linear velocity obstacles dp douglas peucker cpa closest point of approach rrvo responsibility rvo appendix c dtbl2 list of symbols table 7 symbols definitions d trajectory point set p s starting point p e end point d max largest distance of point to line p max point of d max x y track point in mercator projection ϕ latitude λ lontitude ϕ 0 standard latitude in mercator projection α long radius of earth ellipsoid e eccentricity of earth ellipsoid e 0 first eccentricity of earth ellipsoid a long radius of earth ellipsoid r 0 radius of the parallel circle of standard latitude q isometric latitude d point to line distance s e vector from the start point to the endpoint of the line segment s t vector from the start point to the target point of the line segment i b action uncertainty set of ship b v b velocity forming action uncertainty model of ship b u v sample mean σ v standard deviation u n l v o t nlvo set p a position of tes p b position of os c o n f p all the possible positions of the tes when ship collision risk occurs between os and tes at time t λ p a t c a t max v a t m a x a navigable space that is a closed disc of radius vatmax with the angle of c atmax centered at position of a for every time slice a b a b a a b b minkowski sum of ship a and entity b d p a t a b points that lie in the area constrained by the right and left tangent of a b ending at point p a w a i anti collision responsibility of ship a for stage i w b i anti collision responsibility of ship b for stage i w n overall anti collision responsibility v a velocity of ship a v b velocity of ship b c a course of ship a c b course of ship b l ship length ts time slice sd ship domain ψ probability of velocity distribution v b t n e w an iterative set of ship b s velocity interval with probability ψ at time t v b t velocity of ship b at time t also the mean of dynamic gaussian model σ b standard deviation of ship b l b t position of ship b at time t l b t n e w an iterative set of positions in a circle or ellipse with the center of l b t radius or semi major axis of a circle or ellipse r a b a set of visualized risk c r intersection angel between current velocity and nearest safe velocity c r i g h t intersection angel between current velocity and fastest safe velocity d r distance between the apex of current velocity and collision free velocity d r max distance between the apex of current velocity and fastest safe velocity r a b a set of visualized risk ℑ v o b edge velocity of vo sr vo and unlvo constrained by colregs induced by ship b v o t d i s t distance between the endpoint of current velocity and ℑ v o b during time interval t v o t d i s t max maximum distance of v o t d i s t p t c o l l i s i o n collision risk caused by steering at time t p ψ v b t n e w probability of v b t n e w with probability ψ at time t v o v t d i s t distance between the endpoint of current velocity and during time interval t v o v t d i s t max maximum distance of v o v t d i s t p v t c o l l i s i o n collision risk caused by deceleration at time t z u n l v o v t area of unlvo during time interval t z s r v o v t area of sr vo during time interval t 
21183,colregs based collision risk awareness model is urgently needed in real time operating conditions however this is a complicated problem under various encounter situations some of which are very complex in order to quantify the collision risk in real operating conditions a novel risk informed collision risk awareness approach is proposed for real time operating conditions firstly the ship s actions are identified based on the automatic identification system ais data secondly the uncertainty of ship action patterns is analyzed by regarding the target ships as velocity obstacles then the collision risk model is utilized to assess the collision risk level based on the uncertainty in the non linear velocity obstacles algorithm considering responsibility finally some case studies are carried out based on the proposed model in the model the dynamic and uncertainty features of the ship action dynamics in real operating conditions are considered which could benefit on reducing ship collision accidents and improving the development of technologies on intelligent collision avoidance decision makings keywords ship collision real time risk awareness colregs automatic identification system velocity obstacles 1 introduction shipping has been a significant mode of transportation for international and domestic trade because of its large capacity and environmental friendly nature wan et al 2019 research on ship collision and anti collision strategy has been an essential topic of maritime transportation studies chen et al 2019 wang et al 2013 one element in preventing collision accidents is the presence of a collision alert system providing warnings to ship crews and or personnel in vessel traffic services of the collision risk in a real time operational environment goerlandt et al 2015 to release crews from longtime navigation in the open sea or frequent navigational acts in restricted waterways researchers have made great efforts in finding safer and more intelligent transportation methods intelligent and autonomous real time collision risk awareness methods are becoming popular intelligent risk awareness methods are commonly used in autonomous underwater vehicles auv and unmanned surface vehicles usv they are two different types of intelligent tools that play a significant role in military and scientific research the risk analysis of auv and usv have attracted researchers attentions because of their various potential applications compared with merchant ships the risk evaluation method of auv and usv is somewhat different as they are much easier to operate and they can react quickly but they mostly share the same term of safety domain which is applied to find the available room to maneuver they have to take the influencing factors into consideration such as speed course environment and maneuverability therefore the quantitative and qualitative risk analysis of usv and auv can be a reference for ships velocity obstacles vo is one of the most popular intelligent collision avoidance methods used in usv and auv it has been utilized in risk awareness and collision avoidance for ships however most of the existing studies have many strict restrictions such as regular or constant speed known trajectories and dynamics therefore there is still much space to be explored for vo applications it would be meaningful to learn a ship s vo based on motion features from historical ais data to predict the risk the rest of the paper is organized as follows section 2 presents a literature review of the related researches on collision risk awareness focusing on techniques and algorithms in section 3 a novel collision risk awareness model is proposed which contains action identification motion uncertainty and the collision risk model based on non linear velocity obstacle algorithm section 4 presents case studies to verify the proposed approach including both paired ship and multi ship encounter scenarios and comparative analysis between unlvo and nlvo is carried out finally conclusions on the results are raised in section 5 2 literature review collision risk analysis of ship including ship ship collision and near miss collisions have been widely investigated by researchers because shipping is one of the most efficient and low cost transport modes wang et al 2020 wu et al 2020 however maritime transportation sometimes brings severe consequences such as loss of lives irreversible environmental damage zhang et al 2019 there are various methods used for evaluating and quantifying risk accordingly most of the existing researches regarding collision risk models can be divided into several categories including historical data related statistics collision risk anti collision model collision risk prediction model and behavior oriented simulations fang et al 2019 liu et al 2020 jiang et al 2021 studies on collision risk of ships usv and auv can be further divided into three classes prior risk analysis and quantification process or real time collision avoidance decision making and post collision causation analysis the collision risk and anti collision strategies mainly include ship domain related risk awareness and risk evaluation probability risk calculation method risk constrained by colregs historical data related statistics real time collision awareness and velocity obstacles vo as the approach mentioned in this paper some related research containing ship domain based risk awareness and other real time risk awareness methods are comprehensively discussed in the following subsections 2 1 ship domain related research the ship domain model was first proposed by observing the ship navigation behavior within a certain water area fujii and tanaka 1971 ship domain model as a quantitive tool to evaluate potential risk when another ship enters in the scope of own ship has been widely used in different areas including ship collision avoidance hansen et al 2013 im and luong 2019 jingsong et al 1993 qu et al 2011 szlapczynski et al 2018 szlapczynski and szlapczynska 2017 near miss and hot area identification winkler et al 2019 yoo 2018 zhang et al 2015 zhou et al 2017 calculation of encounter rates collision risk and vts design moreover many concepts have been introduced based on ship domain including fuzzy quaternion ship domain fqsd qu et al 2011 dynamic quaternion ship domain dqsd wang 2013 collision diameter silveira et al 2013 distance at closest point of approach dcpa and time to closest point of approach tcpa minimum distance to collision mdtc montewka et al 2010 velocity obstacles degré and lefèvre 1981 the dcpa and the tcpa are the two most important parameters to evaluate collision risk some analytic approaches have been proposed for domain based collision risk parameters such as the degree of domain violation ddv and time to domain violation tdv szlapczynski and szlapczynska 2016 however dcpa and tcpa can not gererate an applicable and quantitative value about collision risk they are used to show collision risk based on subjective judgment therefore another important index called collision risk index cri is introduced in which the probability of collision is evaluated with three significant characteristics namely ambiguity uncertainty and instantaneity the value of cri is affected by various factors among which the key elements with a significant impact on cri are dcpa tcpa the distance from the threatening vessel the relative bearing and the ratio of speed according to existing literature zhao et al 2016 it is not only used to evaluate collision risk but also to grounding and sinking risk with dynamic ship domain model liu et al 2015 wang and chin 2015 moreover ship domain has been used for risk awareness zhang et al 2017 ship domain related risk awareness focus on the gradient of distance to target ships and ship domain area however it does not have the ability to show navigable area thus they are not sufficient for estimating ship collision risk and for planning evasive maneuvers 2 2 real time collision risk awareness there is an urgent need to better visualize the collision risk which can also present a reference for collision avoidance operations wu et al 2019 moreover the assessment of collision risk should be in a real time mode perera et al 2010 many researches recognized that it is urgent need for crews to be alert to the real time collision risk which is beneficial to make decisions however many existing studies have some strict assumptions and are applied to limited scenarios such as simple dynamics of the ship huang et al 2019 which bring limitations on making anti collision decisions most of the systems cannot provide with a general picture in a complex situation involving all possibilities of maneuver in relation to changes of course and or speed by the threatened ship and taking into account of all other ships in the vicinity degré and lefèvre 1981 some advanced methods were proposed to improve the efficiency and effectiveness of collision avoidance zhang et al 2020 while showing real time collsion risk im and luong 2019 offered a picture of risk zone around a ship and divided the risk zone into four zones by three boundaries with different levels of risk then collision risk zone was utilized to detect and evaluate risk of collision in real time however these studies can t integrate real time collsion risk with collsion avoidance effectively 2 3 velocity obstacle algorithm the velocity obstacle vo treats the velocity of the target ship as a dynamic obstacle considering both static and dynamic information and make real time risk visualization degré and lefèvre 1981 described the initial idea of vo then paolo fiorini 1996 put forward the concept and formulated the vo model since then vo has been widely applied to risk visualization of intelligent entities however many existing researches make an assumption that both the information of own entity including ships usv auv and targets are available in advance meanwhile the target ships navigation information is not fully available in advance in real cases that is to say traditional vo algorithm does not take efficient communication between entities into consideration accounting for communication and reaction among entities van den berg et al 2011 introduced a probabilistic extension to the vo approach called probabilistic velocity obstacle pvo which considers the discrete prediction of the motion behavior of other agents then the concepts of collision cone cc reciprocal velocity obstacles rvo hybrid reciprocal velocity obstacles hrvo safety velocity obstacles svo and optimal reciprocal collision avoidance orca van den berg et al 2011 have been introduced in different studies for further understanding the impact of vo bareiss van den berg 2015 best et al 2016 rashid et al 2012 rufli et al 2013 snape et al 2011 a method called rvo among these terms provides with both collision free and oscillation free navigation zhao et al 2016 huang et al 2018 2019 huang and gelder 2017 used vo algorithm in collision avoidance issues for merchant ships huang et al 2019 summarized the linear vo and non linear vo that prevent collisions from target ships whose motions might change over time considering collision avoidance and the destinations song et al 2018 introduced a two level dynamic obstacle avoidance algorithm by combining the vo algorithm with the improved artificial potential field apf method in a non emergency situation a time discrete non linear velocity obstacle td nlvo method for collision candidate detection which is based on the non linear vo algorithm was also proposed to detect the collision candidates chen et al 2018 compared with other risk awareness methods vo performs better in collision risk visualization moreover nlvo can deal with nonlinear motions of target ships however some assumptions on nlvo limit its further applications to the situations that ship actions are not fully available in advance 2 4 innovation in light of the above the innovation of the paper can be summarized in three folds 1 a risk informed model is proposed that can be used for real time risk awareness 2 ship action identification model and ship action uncertainties are recognized by turning points and velocity uncertainty 3 an improved velocity obstacles method called uncertainty non linear velocity obstacles unlvo is proposed accordingly unlvo overcomes the following limitations of nlvo model traditional nlvo does not take the uncertainty of navigating information into consideration ship trajectory data are directly utilized to assess the risk in these studies which will lead to low accuracy in quantifying collision risk traditional nlvo ignores the identification of ship action that will result in the oscillation of risk especially when the ais data is not available in real time mode oscillation of risk will confuse the encounter situations as a result the main objective of this paper is to perform a dynamic risk informed collision awareness approach in real time operating conditions it is established by a modified nlvo method named unlvo that can express collision risk considering different types of uncertainties 3 methodologies and modelling 3 1 assumptions in order to reduce the complexity of the procedure and calculation time some rational assumptions should be made in advance the focus of this paper is to design a novel collision risk awareness model for navigating ships therefore the assumptions are prepared as described in zhang et al 2015 as follows the ship domain is treated as a circular and any intrusion of other moving or static obstacles must be avoided the size of the ship domain differs from the influencing factors such as encounter situations ship size and navigational water e g open sea narrow channel busy waterways szlapczynski et al 2018 it also depends on the specification of the ships traffic density automation and degree of efficient communication with obstacles the parameters of the dynamic ship domain could be adjusted according to the real time situations by the controlling system zhang et al 2015 the navigational information including speed course and position of all entities is available for the os in real situations the tes can be seen or detected by radar automatic radar plotting aid arpa or other detecting devices efficient navigational information is also influenced by many factors including visibility and the performance of arpa all these influencing factors can be simplified as the uncertainty of ship action as discussed in this paper the officer on watch oow may adjust this parameter to real situations as discussed in zhang et al 2015 the available operations on changing course or speed of os is determined by the maneuverability of the ships and navigational environment for example in open sea with good visibility the parameters can be set by the maximum in narrow or busy waterways they are set by the available speed and course derived from historical data according to channel conditions every entity except the static obstacles is assumed to comply with colregs then collision risk can be calculated however it is possible that one or some of the involved entities does not take actions as required by colregs so it is assumed that if there are any tes that should give way to the os but did not take actions the os will take full responsibility zhang et al 2015 3 2 risk informed collision dynamic awareness model real time risk awareness model is based on effecitive description of ship motions until now most researches on risk awareness rely on the acquisition of ais data however there are also challenges in extracting knowledge from ais data due to large data volume incompleteness noise rogue dark vessels etc tu et al 2018 on the other hand the influencing factors such as environmental factors recognition is often simplied most existing methods works on ideal conditions such as regular or constant moving speed no current influence and good weather conditions chen et al 2020 therefore there is still much space to be explored to understand the characteristics of ship motion behavior and the uncertainty of ship motion tu et al 2018 yan et al 2020 researches on ship motion behaviors are often refined by the uncertainty of ship control considering ship dynamics however in the real situation disturbances from the environment cannot be neglected which reflects the uncertainties on ship trajectories such uncertainties should be considered in a proper way in real time collision risk awareness hou et al 2020 so short term ship action uncertainty and relatively long term ship ation identification models are raised to express the ship motion characteristics zhang et al 2020 which can be treated as the foundation of real time collision risk awareness based on vo the framework is shown in fig 1 a collision risk awareness approach is proposed in real time operating conditions as shown in fig 1 first the ship actions are identified based on ais data in real operating conditions second the uncertainty of motion patterns is analyzed then unlvo model is raised based on ship action identification ship action uncertainty and collision risk responsibility model finally the risk awareness model is utilized to quantify the collision risk based on the unlvo algorithm more details are discussed in the following sections 3 3 ship action identification model ship actions are complex as multiple factors have impact on it these factors can be divided into internal or external factors the ship actions can be identified from a series of ship trajectories ship trajectories are becoming increasingly available and the size of recorded trajectories is becoming larger rong et al 2019 using appropriate methods while maintaining the main characteristics can help get the key information on ship action then ship action identification can be learnt from historical sub trajectories by use of appropriate compression threshold therefore the issue of ship action identification can be simplified as determining the range of position as shown in fig 2 there are various approaches to obtain the turning points such as clustering methods the douglas peucker dp algorithm was first presented by douglas and peucker 1973 it is one of the appropriate approaches in dealing with this problem as it can show different patterns based on threshold alteration the algorithm can split the line data recursively and control the compression quality by means of the threshold which is commonly used in simplifying the trajectory of moving objects zhao and shi 2018 in this paper a new scheme and the implementation of dp algorithm is introduced different thresholds can be used to reflect different kinds of compression in order to simplify and standardize threshold selection process a set of threshold step can be utilized to visualize compression degree therefore a threshold interval is firstly adopted then the interval step can be determined according to the threshold interval and compression result the threshold selection is fully connected with the aim and usage of compression in this paper compression rate formulated by the records reduction will be used as an indicator of the compression degree com represents the compression degree r e c o r d s t 1 means the records left based on previous threshold r e c o r d s t means the records left based on current threshold the threshold interval and threshold determination and iteration are presented in fig 3 1 c o m r e c o r d s t 1 r e c o r d s t t t the ais trajectory can be marked as a point set d p 1 p i according to the dp theory the algorithm is recursively applied to all trajectory subparts an improved dp algorithm is proposed in this paper considering threshold alteration it is a critical element showing the range of course and it is influenced by the factors including ship type water areas and environmental conditions in order to calculate the distance of point to line geographical coordinates should be converted into the coordinates in mercator projection zhao and shi 2018 the coordinates in the mercator projection of the track point x y are calculated as follows 2 r 0 a cos ϕ 0 1 e 2 sin 2 ϕ 0 3 q ln tan π 4 ϕ 2 1 e sin ϕ 1 e sin ϕ e 2 4 x r 0 λ 5 y r 0 q where ϕ and λ denote the latitude and longitude respectively ϕ 0 represents the standard latitude in mercator projection a represents the long radius of earth ellipsoid e represents the first eccentricity of earth ellipsoid r 0 represents the radius of the parallel circle of standard latitude q represents the isometric latitude the point to line distance can be calculated through the vector method which is expressed as 6 d s e s t s e where s e denotes the vector from the start point to the endpoint of the line segment s t denotes the vector from the start point to the target point of the line segment the detailled derivation is elaborated in zhao and shi 2018 then a series of threshold interval can be obtained which can help forecast the risk probability 3 4 ship action uncertainty model ship action uncertainty is affected by environmental and operational factors in this paper the focus is mainly on ship velocity aiming at trying to make a probabilistic evaluation of ship action ship action uncertainty model can be expressed as 7 i b v b where v b refers to velocity forming action uncertainty model of ship b i b is a ship action uncertainty set the contribution of nlvo algorithm is that it regards the ship maneuvering as a non linear motion the speed of navigating ships changes over time because of the structure of ships regulations and the environment as a critical element in the nlvo model speed distribution plays an important role in ship action uncertainty recognition the high values of speed always appears in the safe and open waterway the ships share similar velocities for the same ship type especially in the same navigation area gaussian process models have been applied for ship behavior anomaly detection as studied in perera et al 2012 rong et al 2019 considering such characteristics the speed distribution can be expressed as 8 f v 1 2 π σ v 2 exp x u v 2 2 σ v 2 where u v is the sample mean σ v is the standard deviation then the principle of 3 σ expressing the interval of ship action uncertainty 3 5 uncertain nlvo unlvo algorithm until now the researches of nlvo mainly consider the nonlinear trajectory considering that the trajectory is available with satisfactory precision what is more the nlvo algorithm cannot provide a general picture of collision risk caused by current velocity course and position in order to overcome such limitations the method proposed in this paper focuses on the ship action uncertainty and ship action identification combining the strength of pvo rvo svo and nlvo 3 5 1 traditional nlvo algorithm the nlvo set is defined as the collection of all the conflicting velocities leading to the ship collision for ship a and other entity b the velocity obstacle for a induced by b is a set of velocities that will result in a collision between a and b at a given moment the basic idea of the nlvo algorithm is to identify the nlvo set that a collision risk occurs in the near future if os s speed falls into this set which is expressed as follows 9 u n l v o t t p a t p b t 0 t t 0 c o n f p o r t t 0 c o n f p o r p a t p b t 0 r where u n l v o t is the nlvo set p a and p b are the position of the tes and os respectively c o n f p is the term describing all the possible positions of the tes when ship collision risk occurs between os and tes at time t is minkowski addition and the prohibited region around the os can be formulated as p a c o n f p o r if the speed vector of te is the element of u n l v o t the ship collision risk exists the formula derivation process is elaborated in huang et al 2019 from the explanation of nlvo it can be determined the space that te cannot enter obviously the motion of te can not be controlled by others but the available space current risk of os and anti collision responsibility for os and te cannot be inferred from the traditional nlvo so in order to realize real time collision awareness the nlvo algorithm should be further analyzed and improved 3 5 2 uncertain nlvo unlvo algorithm based on the previous analysis on vo it can be found that the velocity of ship b the distance between two ships and ship domain are the critical factors that influence the shape and vertexes of the vo areas ship action identification in previous sections is a foundation of unlvo take ship b as an example the velocity uncertainty of ship b can be modeled as 10 v b t n e w v t v t p ψ v t v b t σ b v t f v b t σ b ψ 0 1 v b t n e w is an iterative set of velocity interval with probability ψ and the new gaussian model with the mean of current velocity v b t and standard deviation σ b of current velocity the dynamic gaussian distribution is introduced with the hypothesis that the ship will keep the current velocity with high probability in the next sampling time for action identification of ship b historical ship traffic route can be regarded as prior knowledge in order to predict the position of ships rong et al 2019 some thresholds sets are found based on the sub trajectories for the free navigation in open waterways a threshold can be selected from thresholds sets according to the preference of oows ship dynamics and other influencing factors in narrow waterways or turning areas ship actions should be carefully regarded and the threshold can be determined by oows for different decision time slice the identification of ship b can be expressed as 11 l b t n e w l t l t e l b t l b t n e w is a set of positions it can simplify the position range into circle or ellipse with the center of the current position l b t indicates radius or semi major axis the position range is parallel to the velocity of ship b unlvo considering uncertainty and ship action identification is shown in fig 4 the dashed purple line shows the expanded area caused by the uncertainty of velocity and action pattern the new unlvo gives the ship a new alternative to navigate fig 4 shows that the ship action space is divided into three parts by vo namely srvo rear srvo front and srvo diverging meaning that the selected velocity will result in actions in rear front and diverging of tes the srvo is a dynamic area constrained by different encounter situations ship domain velocity of ship a and b range of course and velocity besides ships have the responsibility to alter course or change speed with respect to different encounter situations encounter situation can be divided into four stages as shown in fig 5 according to the responsibilities defined by colregs then a weighted index w a i can be used to denote the responsibility of ship a during stage i i i 1 2 3 4 as shown in fig 6 w b i denotes the responsibility of ship b based on ship action identification ship action uncertainty and collision responsibility analysis for encounter scenario the unlvo algorithm is developed based on traditional nlvo considering ship action identification and uncertainty let λ p a t c a t max v a t m a x denote a navigable space that is a closed disc of radius vatmax with the angle of catmax centered at position of a for every time slice more formally let a b a b a a b b be the minkowski sum of ship a and entity b d p a t a b means the points that lie in the area constrained by the right and left tangent of a b ending at point pa the basic idea of the unlvo algorithm is to identify the unlvo set that a collision risk occurs in a specific time slice if os s speed falls into this set for the next time slice each entity will attain its new velocity and unlvo set will be updated it is expressed as follows 12 λ p a t c a t max v a t m a x q p a t q p a t p a v a t m a x c a t c a t max d p a t a b q a t t a n g e t a b p a t a b a b a a b b t t i i c a t max c v a t max v u n l v o t t t i i v a t w a i λ p a t c a t m a x v a t m a x d p a t a b the formula derivation process is an integration of studies in huang et al 2019 and van den berg et al 2011 considering ship action identification and uncertainty with respect to pvo rvo and srvo then unlvo can be applied to different encounter situations defined by colregs the new unlvo can replace the traditional vo model and a new scheme of unlvo in compliance with colregs can be obtained 3 6 collision risk quantification and visualization the unlvo set of ship a induced by ship b is a set of risky velocities but the risk in unlvo varies from the different diameters of the collision triangle velocity around the area of vetex has a minor risk because ship a can maintain the same velocity for a longer time than the velocity close to the relative ship domain that is to say quantifying the risk using the velocity in unlvo is also meaningful steering and deceleration are the most common strategies to avoid collision in this paper steering means changing course while remaining the value of velocity whereas deceleration means keeping the direction while reduce the value of the velocity these factors can be used for risk visualization of steering including the intersection angle between current velocity and nearest safe velocity c r the intersection angle between current velocity and right largest safe velocity c r i g h t the intersection angle between current velocity and left largest safe velocity c l e f t distance between the apex of current velocity and collision free velocity d r distance between the apex of current velocity and the largest safe velocity d r max details are described in fig 7 13 r a b c r c r i g h t c r c l e f t d r d r max r ab is a set of visualized risk a risk visualizing index is selected with respect to environmental and navigational factors 1 risk of steering the distance of current velocity and the optimal velocity is used as an example to visualize risk risk at every sampling time can be calculated by how far it is from the endpoint of the current velocity to ℑ v o b that is the boundary of vo srvo and unlvo with the same velocity constrained by colregs induced by ship b vo tdist means the distance between the endpoint of current velocity and ℑ v o b during time interval t 14 v o t d i s t v t v o b t v t ℑ v o b t v t r v o b t t t b b the distance may vary due to different velocities in a specific time interval including maybe several time slices the maximum distance v o t d i s t max can be obtained as 15 v o t max d i s t v t v o b t max v t ℑ v o b t v t r v o b t t t the risk can be evaluated by the normalized distance as 16 r a b t v o t d i s t v t v o b t v o t max d i s t v t v o b t v t r v o b t t t b b where r a b t 0 1 so the collision risk caused by steering can be expressed as 17 p t c o l l i s i o n r a b t p ψ v b t n e w ψ 0 1 t t b b 2 risk of deceleration deceleration is also an alternative way to avoid collision the distance between current velocity and risk free velocity whose endpoint lies in the boundary between vo and unlvo with certain probability is also used to evaluate the risk caused by the current velocity in every sampling time the distance is calculated to make some comparison with the risk of steering constrained by colregs induced by ship b similar to the risk of steering v o v t d i s t means the distance between the endpoint of current velocity and ℑ v o v b during time interval t ℑ v o v b represents the intersection point of current velocity and vo i 18 v o v t d i s t v t v o v b t v t ℑ v o v b t v t r v o b t t t b b in certain time interval the maximum distance vo vtmaxdist can be obtained as 19 v o v t max d i s t v t v o v b t max v t ℑ v o v b t v t r v o b t t t the risk of current velocity can be evaluated by the normalized distance as 20 r v a b t v o v t d i s t v t v o b t v o v t max d i s t v t v o b t v t r v o b t t t b b where r v a b t 0 1 so the collision risk caused by deceleration can be expressed as 21 p v t c o l l i s i o n r v a b t p ψ v b t n e w ψ 0 1 t t b b 3 risk of action space the area of unlvo constrained by navigable space is another way to calculate risk the percentage of srvo shows the ratio of safety area in every sampling time or time slice the area of srvo rear srvo front srvo diverging constrained by unlvo represent that os has different choices for collision avoidance strategies thus the area of feasible space is used to calculate collision risk z u n l v o v t means the area of unlvo during time interval t with the velocity v z s r v o v t represents the area of srvo during time interval t so the risk of current velocity can be formulated as 22 r v a b t z u n l v o v t z s r v o v t v t r v o b t t t b b different risk awareness methods can be determined according to the encounter situation the tes navigational waterways and so on 4 case studies two case studies are performed to demonstrate the performance of the proposed method one is the pairwise ship case based on real ais data from an accident report of two merchant ships in section 4 1 the second case is a multi vessel encounter situation shown in section 4 2 in order to simplify the model the ship domain is set to be a circular in the case studies the radius is set to be three times of the ship length according to wu et al 2016 zhang and meng 2019 4 1 case study i 4 1 1 data source in order to quantify and visualize the collision risk in real time operation conditions a case study is carried out based on a historical ship collision accident using ais data two ships collided in the east china sea and the information of ship speed position and course was retrieved from ais between 19 20 to 20 04 of jan 6th 2018 the encounter scenario is shown in fig 8 the geographical coordinates have been converted into the coordinates in mercator projection in order to identify ship action as described in section 3 3 the ais data presents the high frequency almost real time information with respect to sailing patterns the ais data in the case study was retrieved from the accident report outliers and some pre processing have been removed to get useful information the longitude and latitude are transformed in meters in mercator projection as summarized in table 1 an appropriate dynamic threshold can be obtained in order to reflect the evolution of collision risk and anti collision decisions can be made accordingly 4 1 2 ship action identification the basis of real time vo is the synchronous of the ship dynamics data ais data play a significant role and are mainly applied to identifying ships historical routes svanberg et al 2019 usually ais devices transmit dynamic data at intervals ranging from 2 s to 3 min asynchronous data among ships cannot help formulate real time vo so data interpolation and information fusion borkowski 2017 have been used to synchronizing the ship dynamics information it is essential for the own ship to know the uncertainty in future positions of the target ships in a specific time span to effectively reflect encounter situations borkowski 2017 then the improved dp algorithm is adopted as described in section 3 2 the coordinates in the mercator projection are calculated according to the range of trajectories the threshold can be determined with 5 m according to ais data then the results of compression by the dp algorithm of both os and te is illustrated in fig 9 accordingly the highest points at 25 m and 30 m could be used to identify actions of os and te because records are changing rapidly furthermore other threshold interval can be selected for detecting ship action they will be selected according to waterway conditions and ability to deal with ship action based on the above analysis 25 m and 30 m are selected as the ship action identification threshold of os and te considering the open waterway condition and room to maneuver 4 1 3 ship action uncertainty the annotated time history of the analyzed ship trajectories os and te are shown in fig 10 as explained previously a gaussian model can express the uncertainty of ship s action for os the sample mean u v 1 is 6 79 m s the standard deviation σ v 1 is 0 43 with respect to te the sample mean u v 2 is 4 22 m s the standard deviation σ v 2 is 0 41 so the speed distribution can be determined accordingly the historical navigable data and simulation speed are presented in fig 11 4 1 4 parameter determination some parameters are predefined according to static information the velocity boundary of both ships is defined according to ship mobility and historical ais data the maximum velocity of os that is plotted as the boundary of arc of nlvo and unlvo is set to be 20kn which is 10 3 m s the maximum velocity of te is set to be 7 72 m s the left and right navigable course of both ships is 60 because they are navigating in open sea and there is enough space for operations the time slice is set to be 2 min which is the same with the time interval of ais data the details are present in table 2 4 1 5 unlvo modeling compared with nlvo dcpa tcpa it can be inferred that the area of nlvo of both ships is smaller than unlvo the uncertainty enlarged the traditional nlvo areas no matter what the uncertainty details are 1 nlvo analysis of real collision scenario the real time nlvo as time goes on is shown in fig 12 the navigable area is 58 m2 the red area represents the nlvo area the blue area means that the ship would cross from the rear of te the green area means that the ship would cross from the front of te in order to present a clear view of the area of nlvo the whole area have been enlarged by 300 times the calculation procedure stops at the point of the domain of the two ships no matter what magnified times are adopted the end point of the calculation is fully connected with the domain of os and te this phenomenon is also the same to other encounter situations according to colregs os is stand on ship and te is given way ship their actions should abide by colregs formally the encounter situation for stand on ship can be divided into four stages according to rule 17 of colregs namely action permitted for long range action prohibited action permitted and action required as shown in fig 5 usually the four stages are guidance for actions during the encounter situation meanwhile these actions are taken with respect to controllers experience skills immediate reaction and understanding of colregs for the first stage free actions can be taken as long as they identify each other the distance is usually beyond 6 nm as shown in fig 12 a in which the nlvo set is involved in the navigable room of os it means that there is a risky area that os can t enter in so in this stage os can take avoiding actions for the second stage actions of os are prohibited as long as the te takes an action well in time but it does not mean that os would not be alert and monitor the situation as shown in fig 12 b for the third stage the oows of os have to be alerted and should have monitored the situation their plans of action for evasive action should be ready at all instances since he has to take evasive action if the te failed to take action or if the action is not sufficient to clear the impending danger however te is not to alter course to port as shown in fig 12 c for the fourth stage the action range is set to be within 3 nm the action that the os finally takes to avoid the situation depends on what is the nature of the action of the te apparently the action of te is insufficient so os has to take the action that will get the two ships safely away from each other then real time collision risk can be calculated and compared with dcpa and tcpa as shown in fig 13 considering the encountering situation based on colregs os have the minor responsibility then it can be assumed that os have 0 3 wt the weight can be determined by oows as shown in fig 13 real time collision risk awareness based on nlvo considering anti collision responsibility can reflect the risk changing smoothly which would be beneficial for oows decision makings on the contrary the values of dcpa have many fluctuations which would confuse oows 2 unlvo analysis of real collison scenario the ship identification of os and te will lead to additional 55 m in traditional a b at the same time ship action uncertainty of os and te will lead to additional 300 m in traditional a b so that the a b in unlvo is 355 m larger than in nlvo consequently the unlvo area is bigger than nlvo but the navigable area is the same the simulation process is shown in fig 14 the whole area is 58 m2 the red area represents the unlvo area the blue area means that os will navigate to the rear of te the green area means that os will navigate to the front of te similar to the four stages analysis of nlvo the unlvo is analyzed to verify the risk awareness for the first stage free actions can be taken as long as they find each other the distance is usually beyond 6 nm as shown in fig 14 a unlvo set is involved in the navigable room of os it means that there is a risky area that os cannot enter so in this stage os can take collision avoidance actions for the second stage actions of os is prohibited as long as te takes correct actions in time but it does not mean that os would not be alert and monitor the situation as shown in fig 14 b for the third stage the watchkeeper of os has to be alerted and should monitor the situation with the unlvo set changing sufficient actions have not taken by te so os should select srvo area to make anti collision actions for the fourth stage the action range is set to be within ship domain the action that the os finally takes to avoid the situation depends on what is the nature of the action of the te if the action of te is insufficient and os has no navigable room to take actions collision will happen based on the analysis of unlvo real time collision risk and area of unlvo considering responsibility is present in fig 15 the collison risk of unlvo is increasing with time dcpa and tcpa have shown a decreasing trend and provide correct tendency about collision risk so both of them can be used to show the tendency as for real time collision awareness dcpa has many fluctuations that will make the oows feel confused about the encounter situation otherwise unlvo provides more accurate predictions and has less fluctuations than dcpa it can well reflect the evolution on collision risk from the 6 nm between os and te the risk goes up smoothly so the method raised in this paper can be used to achieve real time risk awareness successfully 4 2 case study ii 4 2 1 scenarios design the encounter situation including initial position velocity and course of os and tes are set as shown in table 3 considering different types of disturbances the course of ships encountered is given a random disturbance between 5 and 15 the time interval of ais data is set to be 1 min fig 16 shows the trajectories of the encountered ships according to colregs te2 is the given way ship te1 and te3 are stand on ships from the perspective of os 4 2 2 result of ship action identification and ship action uncertainty the indicators of ship action uncertainty are predefined based on previous analysis details are shown in table 4 ship action identification is represented by the indicator of compression rate then performance results of compression by the dp algorithm of both os and tes are illustrated in fig 17 accordingly the highest points at 10 m 15 m and 20 m could be used to identify actions of te1 te2 and os te3 4 2 3 unlvo analysis mutli ship encounter scenario can be divided into multiple pairwise unlvo analysis the area of a b is closely related to ship domain ship action uncertainty and ship action identification the ship identification of os and te1 will lead to additional 25 m in traditional a b at the same time ship action uncertainty of os and te1 will lead to additional 162 m in traditional a b so that the a b in unlvo is 187 m larger than ship domain the calculation process of a b between os and tes is shown in table 4 the simulation result is shown in fig 18 the areas with red blue and green have the same meaning with the previous simulation there is a new area marked with gray that is a mixed area of blue and green area induced by te1 te2 and te3 the encounter scenario includes situations of crossing from left and right so the mixed area emerges the left gray area in fig 18 means that the ship would cross from the rear of te2 and from the front of te1 and te3 the right gray area named mixed area means that the ship would cross from the front of te2 and the rear of te1 and te3 green area indicate that the ship would cross from tbe front of te2 te1 and te3 blue area indicate that the ship would cross from the rear of te2 te1 and te3 details are shown in fig 18 a b and c the whole area of os is 58 m2 then unlvo areas of os and te1 os and te2 os and te3 with time going is shown with blue green and red solid lines then the risk of action space of os and te1 os and te2 os and te3 with time going is shown in fig 19 os is threatened the most by te2 the risk induced by te1 and te3 are almost the same however te1 contributes higher risk than te3 before 700s and risk caused by te3 is higher than te1 after 700s however os is the stand on ship from te2 perspective and is the given way ship from te1 and te3 perspectives according to colregs so the collision responsibility should be considered into risk calculation the collision responsibility weight of os can be assumed from 0 3 to 1 subjectively during the encounter situation of os and te2 so the risk of te2 has some turning points as the weight increase details are shown in fig 20 based on the analysis in a two ship encounter situation unlvo can be utilized to achieve risk awareness and performs better than dcpa and tcpa in real time collision awareness the dcpa and tcpa of the multi ship encounter scenario are presented in fig 21 dcpa and tcpa have witnessed a decreasing trend and reflect correct tendency about collision risk but as for real time collison awareness dcpa and tcpa do not consider collision responsibility which will result in confused anti collision priority between te1 and te2 otherwise unlvo provides more accurate predictions and has less fluctuations than dcpa and tcpa it can effectively show the risk changing so the method raised in this paper can not only be applied to two ship but also to multi ship encounter scenarios and can realize real time collision risk awareness 4 3 comparative analysis a novel risk informed dynamic collision awareness approach is constructed to show the safe navigable space and the current risk caused by velocity course position of encountered obstacles with the identification of ship motion and uncertainty a modified nlvo method named unlvo and collision risk evaluation method is proposed to integrate ship motion with uncertainty into nlvo unlvo has a higher operability and feasibility and can better deal with complex situations considering more influencing factors than nlvo as in the above model construction and case studies the navigable room of unlvo and nlvo are the same because it is determined by ship maneuverability however the srvo area of unlvo is relatively smaller than that of nlvo considering risk quantification ais data interval navigational sea and anti collision strategies the difference and similarities between unlvo and nlvo can be summarized in table 5 5 conclusions by combining the advantages of vo and ship action uncertainty a real time collision risk awareness based on unlvo is proposed in this paper simulations on pairwise ships and multi ship encounter scenarios are fully analylzed to validate the method compared with nlvo dcpa and tcpa the results indicate that unlvo model presents a general picture so as to realize the monitoring and forecasting of collision risk moreover the dynamic and uncertain characteristics of ship motion patterns in operating conditions are considered in unlvo which could benefit from reducing constant collision actions compared with dcpa and tcpa unlvo provides more accurate predictions in expressing collision risk and can generate a uniform and acceptable risk evaluation it can better reflect the risk changing with the calculation of unlvo area moreover unlvo model takes collision avoidance responsibility into consideration the proposed model provides with a new perspective for risk awareness improving the development of theoretical technology on intelligent collision avoidance decision makings its applications can be further developed in the future research for instance it can be utilized to show the real time collision risk among encountered entities considering degrees of autonomy goerlandt 2020 both dynamic and static obstacles encountered scenarios can be considered furthermore this method can also be used to evaluate the overall risk of navigational waters by synthesizing with ship traffic flow data credit authorship contribution statement xiaoli yuan conceptualization methodology software validation formal analysis data curation visualization writing original draft di zhang project administration funding acquisition supervision writing review editing jinfen zhang conceptualization methodology software writing review editing mingyang zhang methodology resources visualization writing review editing c guedes soares supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the research was supported by national key technologies research and development program 2017yfe0118000 2017yfc0804900 20170804904 funds for international cooperation and exchange of the national natural science foundation of china 52071247 51920105014 the hubei provincial natural science foundation of china 2019cfa039 and the european union s horizon 2020 research and innovation programme under the marie skłodowska curie reset 730888 fundamental research funds for the central universities wut 2019ⅲ207 wut 2020iva061 appendix a data availability and result visualization the ais data can be download from the researchgate website https www researchgate net publication 344952725 ais data the real time unlvo simulation and collision risk are available at https www researchgate net publication 344952307 unlvo modelling and simulation and https www researchgate net publication 344952097 the real time collision risk appendix b dtbl1 list of abbreviations table 6 abbreviations full name abbreviations full name ais automatic identification system vo velocity obstacles auv autonomous underwater vehicles usv unmanned surface vehicles fqsd fuzzy quaternion ship domain dqsd dynamic quaternion ship domain dcpa distance at closest point of approach tcpa time to closest point of approach mdtc minimum distance to collision ddv degree of domain violation tdv time to domain violation cri collision risk incidence imo international maritime organization pvo probabilistic velocity obstacle cc collision cone rvo reciprocal velocity obstacles hrvo hybrid reciprocal velocity obstacles svo safety velocity obstacles orca optimal reciprocal collision avoidance td nlvo time discrete non linear velocity obstacle os own ship tes target entities arpa automatic radar plotting aid oow officer on watch nlvo non linear velocity obstacles unlvo non linear velocity obstacles dp douglas peucker cpa closest point of approach rrvo responsibility rvo appendix c dtbl2 list of symbols table 7 symbols definitions d trajectory point set p s starting point p e end point d max largest distance of point to line p max point of d max x y track point in mercator projection ϕ latitude λ lontitude ϕ 0 standard latitude in mercator projection α long radius of earth ellipsoid e eccentricity of earth ellipsoid e 0 first eccentricity of earth ellipsoid a long radius of earth ellipsoid r 0 radius of the parallel circle of standard latitude q isometric latitude d point to line distance s e vector from the start point to the endpoint of the line segment s t vector from the start point to the target point of the line segment i b action uncertainty set of ship b v b velocity forming action uncertainty model of ship b u v sample mean σ v standard deviation u n l v o t nlvo set p a position of tes p b position of os c o n f p all the possible positions of the tes when ship collision risk occurs between os and tes at time t λ p a t c a t max v a t m a x a navigable space that is a closed disc of radius vatmax with the angle of c atmax centered at position of a for every time slice a b a b a a b b minkowski sum of ship a and entity b d p a t a b points that lie in the area constrained by the right and left tangent of a b ending at point p a w a i anti collision responsibility of ship a for stage i w b i anti collision responsibility of ship b for stage i w n overall anti collision responsibility v a velocity of ship a v b velocity of ship b c a course of ship a c b course of ship b l ship length ts time slice sd ship domain ψ probability of velocity distribution v b t n e w an iterative set of ship b s velocity interval with probability ψ at time t v b t velocity of ship b at time t also the mean of dynamic gaussian model σ b standard deviation of ship b l b t position of ship b at time t l b t n e w an iterative set of positions in a circle or ellipse with the center of l b t radius or semi major axis of a circle or ellipse r a b a set of visualized risk c r intersection angel between current velocity and nearest safe velocity c r i g h t intersection angel between current velocity and fastest safe velocity d r distance between the apex of current velocity and collision free velocity d r max distance between the apex of current velocity and fastest safe velocity r a b a set of visualized risk ℑ v o b edge velocity of vo sr vo and unlvo constrained by colregs induced by ship b v o t d i s t distance between the endpoint of current velocity and ℑ v o b during time interval t v o t d i s t max maximum distance of v o t d i s t p t c o l l i s i o n collision risk caused by steering at time t p ψ v b t n e w probability of v b t n e w with probability ψ at time t v o v t d i s t distance between the endpoint of current velocity and during time interval t v o v t d i s t max maximum distance of v o v t d i s t p v t c o l l i s i o n collision risk caused by deceleration at time t z u n l v o v t area of unlvo during time interval t z s r v o v t area of sr vo during time interval t 
21184,large diameter monopiles are the predominant foundation solution for supporting offshore wind turbines they are conventionally designed using soil reaction curves developed for long slender piles used for supporting offshore oil and gas platforms e g the api p y model however due to the difference in the length diameter ratio and the resulting soil mechanisms the use of p y curves alone can lead to significant under prediction of the lateral stiffness and capacity of monopiles to overcome the shortcoming the authors have previously proposed a conceptual two spring framework i e the so called p y m r θ r model to capture the monopile response in soft clay under lateral loading the framework uses distributed p y springs to consider the lateral soil resistance along the pile above the rotation point rp and a single moment rotation m r θ r spring attached at the rp to capture the entire soil resistance below the rp i e the distributed resistance along the pile base shear and base moment at the pile tip the proposed p y and m r θ r springs were curve fitted to the results of 3d numerical analyses however as the stress strain response and the shear strength profile inevitably influence the p y and m r θ r springs the applicability of the empirical formulations to soil conditions other than those examined is uncertain this study proposes an enhancement to the p y m r θ r framework in which the p y and m r θ r springs are not tied to a specific soil and strength profile but fundamentally linked to the properties that can be measured directly in the site investigation and laboratory this extension is achieved through analytical analyses and an extensive parametric numerical study the predictive capabilities of the model are demonstrated by back analyses of finite element analyses and centrifuge model tests the proposed model provides practising engineers with a simple yet powerful approach to use site specific soil reaction curves in the design of monopiles embedded in soft clay keywords monopile soft clay p y curve base shear base moment stress strain finite element analysis centrifuge modelling 1 introduction monopiles are the dominant foundation solution for supporting offshore wind turbines owts to resist large lateral load and bending moment resulting from wind waves and current pile diameter d in the range of 6 8 m is common nowadays extra large monopiles with diameter greater than 10 m are also being considered in newer projects the embedded length to diameter ratio l d of monopiles is typically in the range of 4 8 doherty and gavin 2012 murphy et al 2018 in competent soils in soft seabed conditions such as offshore china the l d ratio can be as high as 10 or more lai et al 2020 1 1 literature review monopile foundations are commonly designed using the beam column approach where the pile is modelled as an equivalent elastic beam and the lateral soil resistance are represented by distributed nonlinear p y springs along the pile length in soft clays the api formulation api recommended practice 2geo 2014 has been conventionally used despite that the api p y model is originally developed for the design of small diameter slender piles used in the offshore oil and gas industry direct adoption of the api model to the design of monopiles with small l d ratios are insufficient and may lead to an underestimation of lateral pile capacity and stiffness gerolymos and gazetas 2006 lam 2009 gao et al 2015 byrne et al 2017 2019 wang et al 2018 2020 zhang and andersen 2019 fu et al 2020a during the past decade a number of alternative p y formulations have been proposed for improving the modelling of slender pile response in clay through numerical analytical and experimental studies examples are among others jeanjean 2009 yu et al 2017 zhang and andersen 2017 jeanjean et al 2017 and zhu et al 2017 it is worth noting that generalized approach proposed zhang and andersen 2017 and jeanjean et al 2017 which derives the site specific p y response by mapping the normalised stress strain response measured in direct simple shear test is set to be incorporated in the upcoming revisions of the iso 19901 4 and api rp2geo and supersedes the existing clay p y formulation to gain insight into the monopile response a joint industry research project pisa performed a comprehensive set of large scale field tests on model piles based on the test results and extensive 3d finite element analyses byrne et al 2017 2019 emphasized that for monopiles besides the distributed lateral soil resistance additional resistance components including the base shear the base moment and the distributed moment resistance due to vertical shaft friction are meaningful and cannot be neglected for optimized design they proposed a four spring model for monopile analysis which includes the aforementioned soil resistances zhang and andersen 2019 proposed a two spring model that accounts for the distributed lateral soil resistance along the pile and the base shear at the pile tip arguing that the base moment is negligible compared to the pisa model zhang and andersen 2019 linked the soil springs to the elemental stress strain response of the soil for ease of application in design fu et al 2020a further proposed scaling relationship for mapping stress strain response to distributed moment rotation spring due to the vertical shaft friction in addition three dimensional numerical models are widely adopted in research for analysing monopile behaviour kim and jeong 2011 qi et al 2014 achmus and thieken 2016 he et al 2019 wang et al 2020 which are capable of modelling complex three dimensional pile soil interaction however it is clear that three dimensional numerical modelling is too computationally expensive and thus may not suitable for engineering practice burd et al 2017 the authors have previously proposed a conceptual framework termed as p y m r θ r model as illustrated in fig 1 the soil resistance along the pile above the rotation point rp is represented by distributed lateral springs p y springs while the soil resistance below the rotation point is modelled by i constraining the lateral displacement at the rotation point and ii incorporating a concentrated rotational spring m r θ r spring at the rotation point by doing so the overall soil resistance at and below the rotation point including the contributions from the base shear and base moment are all integrated into the concentrated rotational spring validation exercises demonstrate that the model can predict the lateral behaviour of monopiles with a range of l d ratios using a unified set of parameters wang et al 2020 although the original p y m r θ r framework is simple and easy to apply the formulations of the p y and the m r θ r curves were based on empirical curve fitting to the results of finite element analyses in a specific soil normally consolidated malaysian kaolin it is well established that soil reaction curves are highly dependent on the stress strain response of the soil bransby 1999 klar and osman 2008 yu et al 2017 zhang and andersen 2017 2019 a soil with stiffer stress strain response will naturally result in stiffer soil reaction curves and vice versa in addition the strength distribution below the rotation point will naturally changes the ultimate capacity of the m r θ r curve based on the above discussions the applicability of the previously proposed p y m r θ r framework to other soil conditions is uncertain and further development is necessary to generalise the model for wider range of soil conditions 1 2 motivation of this study the motivation of this study is therefore to enhance the previously proposed p y m r θ r framework so that the formulations of the p y and m r θ r springs are no longer tied to a specific soil type and strength profile but linked to fundamental soil properties that can be directly measured in routine site investigation and laboratory testing note that zhang and andersen 2017 have already proposed a model for mapping the lateral p y response in clay from the laboratory stress strain curves more details are provided in section 5 1 therefore this study mainly focusses on the development of a model for the construction of the m r θ r spring from the site specific stress strain response and the undrained shear strength profile osman and bolton 2005 proposed the so called mobilizable strength design msd concept which assumes self similarity between the stress strain response of a soil element and the load displacement response of a boundary value problem based on this concept the work by osman et al 2007 demonstrates that for a circular surface foundation under pure moment loading its moment rotation response can be scaled from the soil element s stress strain response for monopiles the m r θ r response at the rotation point can be regarded as the moment rotation response of an imaginary circular foundation with embedment equal to the pile length below the rotation point as the soil failure mechanism beneath the circular surface foundation is similar to that below the rotation point of a monopile i e a rotational scoop type mechanism hong et al 2017 it is worth noting that in the current framework the lumped m r θ r response is only meant to capture the soil resistance below the rotation point the soil that is above the rotation point but also mobilised by the rotational mechanism does indeed contribute to additional resistance however this resistance is captured by the distributed p y springs based on the above discussion it is possible and rationale to link the m r θ r response of the monopiles to the stress strain response of the soil in this study an analytical derivation of the ultimate capacity of the m r θ r spring based on the well established scoop failure mechanism is first presented thereafter an extensive numerical parametric investigation of the m r θ r responses for various geometries over a wide range of stress strain behaviours and undrained shear strength profiles is performed the parametric investigation explores the scaling relationship of the m r θ r springs to the stress strain response and how that scaling relation is influenced by the strength profile and geometry lastly to verify the validity of the proposed p y m r θ r framework pile responses computed by 3d finite element analyses and measured in centrifuge model tests are compared with the model predictions 2 analytical solution for ultimate moment capacity of m r θ r curves m r ult as reported by hong et al 2017 and zhang and andersen 2019 for semi rigid or rigid monopiles the soil failure mechanism below the pile rotation point takes the form of a rotational scoop around the rotation point therefore the upper bound solution of the reacting ultimate moment capacity m r ult about the rotation point is given as the sum of the moment resistance due to the scoop failure surface m r scoop and side shear m r side 1 m r ult m r scoop m r side the scoop failure surface is a 3d surface the ultimate moment resistance from the scoop failure surface m r scoop can be considered as the sum of the moment resistance from the slip surfaces caused by a series of strips as illustrated in fig 2 a strip aa with a thickness of dy and located at a distance y from the pile central cross section forms a semi circle slip surface cbb c with a radius of r f 2 r f o b o a 2 a b 2 o a 2 o o 2 a b 2 d 2 2 y 2 h 2 for a linearly increasing undrained shear strength profile with a strength at the rotation point equal to s u0 and a strength gradient k see fig 2 the moment resistance about the rotation point o due to the slip surface caused by strip aa can be calculated as assuming unit thickness i e dy 1 3 m r scoop section 2 0 π 2 s u0 k r f sin α r f d l 1 2 0 π 2 s u0 k r f sin α r f r f d α therefore the m r scoop due to the 3d scoop failure surface is 4 m r scoop 2 0 d 2 m r scoop section d y substituting eq 3 into eq 4 5 m r scoop 2 0 d 2 2 0 π 2 s u0 k r f sin α r f r f d α d y 1 6 π d 3 s u0 π s u0 d h 2 k 1 2 d 2 2 h 2 2 3 8 t 1 4 sin 2 t 1 32 sin 4 t where t arcsin d d 2 4 h 2 due to the circular cross section of the monopile a 3d spherical scoop mechanism is mobilised by the pile around the rotation point it was not attempted to derive the moment resistance due to side shear directly instead the resistance for a square cross section is first derived and then corrected for the shape by applying a side shear factor which is well established for suction anchor design at ngi jostad and andersen 2015 assuming a square pile cross section with the width equal to the pile diameter d the ultimate moment resistance contributed from the shear on the two side planes m r side is given as the sum of reacting moment about axis e e as shown in fig 3 6 m r side 2 0 h 2 0 π 2 s u0 k z sin δ z d l d z 2 0 h 2 0 π 2 s u0 k z sin δ z z d δ d z however the monopile foundation has a circular cross section instead of a square the difference in shape results in a reduced side shear resistance which is corrected by a side shear factor r ss for computing the holding capacity of suction anchors using 2d soil elements jostad and andersen 2015 carried out series of comparative 2d and 3d finite element analyses on suction anchors of different length to diameter ratios in order to calibrate the side shear factor which accounts for the 3d shape of the suction anchor they concluded a side shear factor r ss 0 73 for correcting for the 3d effect therefore r ss 0 73 is applied herein to correct the side shear moment resistance derived for a square cross section 7 m r side 2 0 h 2 0 π 2 r ss s u0 k z sin δ z z d δ d z 0 73 2 π 3 s u0 h 3 k h 4 therefore substituting eq 5 and eq 7 into eq 1 the solution for ultimate moment capacity m r ult is 8 m r ult 1 6 π d 3 s u0 π s u0 d h 2 k 1 2 d 2 2 h 2 2 3 8 t 1 4 sin 2 t 1 32 sin 4 t 0 73 2 π 3 s u0 h 3 k h 4 where t arcsin d d 2 4 h 2 3 m r θ r response of monopiles in soft clay methodology of 3d numerical parametric study 3 1 simplified finite element model to investigate mr θr response of monopiles to form the p y m r θ r model the m r θ r spring as a key element of the model should be generalized to formulate m r θ r response of monopiles wang et al 2020 performed a series of numerical analyses of full length monopiles with various l d ratios the pile bending moment and rotation at the rotation point was extracted to form the m r θ r curves in this study a more efficient method is adopted instead of modelling the full length monopile only the monopile below the rotation point is modelled since the m r θ r response represents the overall soil resistance below the rotation point as illustrated in fig 4 it should be borne in mind that the m r θ r response is only meant to capture the soil resistance below the rotation point the soil resistance above the rotation point is captured by the distributed p y springs in the current framework lateral displacement at the rotation point is constrained and a pure moment loading is applied on the top surface of the pile model enforcing a rotational scoop mechanism around the rotation point by doing so the behaviour of the monopile below the rotation point is reproduced by the simplified model the computed moment rotation response of the pile model equivalents to the m r θ r response below the rp of a monopile the validity of the simplified approach is examined in section 3 4 where the m r θ r responses computed by the simplified models are compared with those extracted from the full length monopile models the numerical analyses were performed in abaqus abaqus 2014 this study considers a monopile with a diameter d of 6 m and a range of pile lengths h below the rotation point h 3 6 9 12 and 15 m are considered covering h d ratios from 0 5 to 2 5 which is considered a practical range as the results will be presented in a normalised format the absolute dimension of the pile diameter does not matter a typical three dimensional finite element mesh for a monopile with d 6 m and h 6 m is illustrated in fig 4 only half of the pile is modelled by taking advantage of the symmetry the diameter of the cylindrical soil block and the distance between the pile tip and the soil bottom boundary are chosen to be 20d and 5d respectively to minimize the boundary effect the lateral boundary of the finite element mesh is constrained by roller support while the bottom boundary is fixed by pinned support the top of the soil domain is set free to displacement the monopile is constrained to be a rigid body for simplicity which is considered reasonable since the pile rotates with negligible bending below the rotation point a fully rough pile soil interface is modelled in the numerical analyses on the front side of the loading direction the pile pushes against the soil above the rotation point thus cutting off the water flow path if a tension gap was to open below the rotation point on the rear side the pile kicks against the soil below the rotation point thus no separation is allowed on the interface a pure moment load is applied on the top surface of the pile and the ultimate state is indicated by minimal increase in moment load with increase of rotation 3 2 soil model the soil is described by a total stress anisotropic model ngi adp model grimstad et al 2012 for simplicity the strength and stiffness anisotropy are not considered although the ngi adp model is not a built in soil model in abaqus it was achieved by adopting the mohr coulomb model with a zero degree friction angle i e tresca yield criterion and specifying a table of plastic shear strain versus yield stress i e mobilised shear stress in this study the stress strain response plastic component is calculated using the following plastic hardening rule adopted by the ngi adp model and then used as input in abaqus 9 τ s u 2 γ p γ f p 1 γ p γ f p where τ currently mobilised shear stress s u the shear strength of soil γ p the current plastic shear strain γ f p the plastic shear strain at failure full mobilisation the total shear strain γ associated with the currently mobilised shear stress τ is the summation of elastic and plastic shear strain components γ e and γ p respectively 10 γ γ e γ p τ g max γ p τ s u g max s u γ p where g max s u is the small strain shear modulus ratio and is used to calculate the elastic component of shear strain over the entire stress range as can be seen from eqs 9 and 10 the ngi adp model uses two parameters i e γ f p and g max s u to define the stress strain response of clay g max can be determined through a resonant column test or bender elements incorporated in a soil element test γ f p literally stands for the plastic shear strain at failure and should be determined by curve fitting that provides the best fit to the stress strain curve measured in the soil element shear test zhang and andersen 2017 demonstrate that the model can describe the stress strain behaviour measured over a wide range of natural clays with combinations of the two parameters 3 3 parametric range in this study an extensive numerical parametric study over a wide range of h d ratios and soil stress strain response is carried out to investigate the m r θ r response the ranges of the parameters are summarized in table 1 it is assumed that the part of the pile below the rotation point is embedded entirely within a single soil layer with a constant or linearly increasing strength profile and the degree of soil strength heterogeneity can be expressed by the normalised parameter κ defined as 11 κ k d s u 0 where k and s u0 denote the shear strength gradient and the shear strength at the depth of the rotation point respectively as illustrated in fig 4 in this study a pile diameter of d 6 m is fixed while a range of soil strength profiles are investigated they are detailed in table 2 which presents a normalised group κ varying from 0 to 0 5 in total 300 3d finite element analyses involving the full combination of all parameters listed in tables 1 and 2 are performed producing 300 m r θ r curves the scaling relationship between the m r θ r curve and the corresponding soil stress strain curve is explored which will be presented below 3 4 validation of the simplified finite element model for investigating mr θr response before performing the numerical parametric study using the simplified finite element model the validity and accuracy of the simplified model for deriving m r θ r response is verified first for this purpose the m r θ r responses computed by the simplified model are compared with those computed by the corresponding full length monopile model two finite element analyses of laterally loaded full length monopiles with a diameter d 6 m with l d ratio of 4 and 5 are carried out the monopiles are modelled as linearly elastic solid cylinders assigned with equivalent elastic properties that produce bending stiffness ei that is equivalent to the steel hollow piles with a wall thickness of 0 06 m typical finite element mesh for the full length monopile with l d 5 is presented in fig 5 the pile stick up above the soil surface is kept 30 m for the two l d ratios where a lateral force is applied the magnitude of the applied lateral force does not matter as long as the full m r θ r response can be obtained from the numerical results therefore in the analyses reported herein a relatively large lateral force is applied to ensure the m r θ r response reaches its ultimate state i e the m r θ r curve reaches a plateau the soil is described by the ngi adp model see section 3 2 with parameters of γ f p 5 and g max s u 500 an effective soil unit weight of 6 kn m3 is adopted for all the cases the soil strength increases linearly with depth at a gradient of 1 5 kpa per metre i e s u 1 5z a fully rough pile soil interface is modelled and separation between the interface is not allowed the pile bending moment m r and rotation angle θ r at the depth of the rotation point were extracted from the full length monopile model to form the m r θ r relationships the length of the pile below the rotation point h is also obtained from the finite element analyses based on the h revealed by the full length models corresponding simplified finite element models in which only the monopile below the rotation point is modelled as illustrated in fig 4 are then developed for deriving the m r θ r responses using the simplified approach as presented in section 3 1 the computed m r θ r responses from the simplified finite element models are compared with those computed from the full length model in fig 6 it can be seen from the figure that the m r θ r responses computed by the simplified models match well with those computed by the full length monopile models demonstrating the validity and accuracy of the simplified model fundamentally the good match is obtained because i undrained soil response is assumed here thus the soil weight above the rotation point does not affect the undrained shear strength of the soil below the rotation point ii since a pure rotational scoop mechanism is enforced about the rotation point the soil mechanism below the rotation point is the same with or without the soil above it the mobilised resistance offered by the soil below the rotation point is thus the same with or without soil above the rotation point it should be reiterated that the lumped m r θ r is only meant to capture the soil resistance below the rotation point the soil that is above the rotation point but also mobilised by the rotational mechanism does indeed contribute to additional resistance however this contribution is captured by distributed p y springs in the current framework 4 numerical analysis results 4 1 ultimate moment capacity of mr θr curves mr ult fig 7 shows the variation of the computed ultimate moment capacity m r ult with soil strength heterogeneity κ and h d ratio in the figure m r ult is normalised by ads u0 where a is the overall cross sectional area enclosed by the pile as expected m r ult is strongly influenced by κ and the h d ratio at any given of h d ratio m r ult shows an approximately linear relationship with soil strength heterogeneity κ comparing to the influence of κ the increase in h d ratio leads to a much more pronounced growth in m r ult as illustrated in fig 7 the m r ult is well predicted by the analytical solution presented in section 2 4 2 normalised mr θr curves fig 8 a 8 d presents some typical results illustrating the influence of h d ratio γ f p g max s u and κ on the normalised m r θ r curves m r m r ult vs θ r respectively the representative set of m r θ r curves presented in fig 8 a shows that as the h d ratio increases the normalised m r θ r curve becomes gradually softer this is as expected that when h d ratio increases the rotational soil scoop expands and thus a larger rotation angle θ r is needed to reach failure resulting in a softer response fig 8 b presents an example set of four computed m r θ r curves for four soil stress strain responses that are increasingly softer i e γ f p 2 5 10 15 as anticipated the computed m r θ r response also becomes increasing softer different from the h d ratio and γ f p g max s u and κ exhibit negligible impact on the normalised m r θ r curves as can be seen in fig 8 c and d respectively from fig 8 it is clear that the shape of the m r θ r curves bears strong similarities to the soil stress strain curves that were used as input to derive them therefore it is interesting to explore the possibility of scaling the soil stress strain curves to the m r θ r curves which is attempted in the following section 5 proposed site specific p y m r θ r framework this section aims to propose a site specific p y m r θ r framework where the p y and m r θ r curves can be constructed by directly scaling the soil stress strain curves measured in the laboratory tests while the site specific p y curves proposed by zhang and andersen 2017 is adopted for capturing the soil resistance above the rotation point attempt is made in this section to link the m r θ r curves to the soil stress strain curves based on the results of the extensive parametric numerical analyses 5 1 p y curves based on an extensive finite element study zhang and andersen 2017 proposed a framework that allows for construction of site specific p y curves by directly scaling the soil stress strain curves measured in laboratory element test as schematically illustrated in fig 9 a point on the stress strain curve with mobilisation in shear stress τ s u corresponds to a point on the p y curve with the same level of mobilisation in lateral bearing pressure p p u 12 p p u τ s u the corresponding normalised lateral displacement y d can be scaled from the shear strain γ by using two scaling factors 13 y d ξ y e γ e ξ y p γ p 14 γ e τ g max τ s u g max s u 15 γ p γ γ e where ξ y e and ξ y p are the two scaling factors applied to the elastic and plastic components of the shear strain respectively for simplicity a constant value of ξ y e 2 8 is proposed while ξ y p is expressed as a function of pile soil interface roughness factor α ξ y p 1 35 0 25α further details on the derivation of the scaling factors can be found in zhang and andersen 2017 it should be noted that this p y framework is strictly only applicable for a plain strain flow around soil mechanism and thus it is more suitable for flexible piles for a rigid or semi rigid monopile the soil flow mechanisms are dominated by a wedge type flow in the upper part and a rotational flow in the lower part hong et al 2017 considering the soft clay conditions concerned in this paper a tension gap is unlikely on the rear side of the monopile fu et al 2020b and thus two soil wedges passive and active wedge will be mobilised this is not too dis similar to the condition of a flow around mechanism therefore despite the difference in soil mechanisms the p y curves proposed by zhang and andersen 2017 are recommended for representing the lateral soil resistance above the rotation point the suitability of the p y curves will be examined later when the proposed model is used to back analyse the pile response obtained from centrifuge tests and finite element analyses through eqs 12 15 the shape of the p y curves p p u vs y d is determined the ultimate soil resistance of the p y curves p u is calculated by 16 p u n p s u d where n p is the lateral bearing capacity factor for the condition with suction i e no tension gap the equations proposed by zhang et al 2016 which is derived from yu et al 2015 s upper bound analyses is adopted in the model to calculate the n p value as follows 17 n p 2 n 1 n 1 n 2 z d d z d d z d d 0 6 1 35 1 α n pd 18 n pd 9 14 2 8 α where n 1 11 94 n 2 3 22 d 16 8 2 3log10 λ λ s um kd and 0 1 λ 10 s um is the soil shear strength at the mudline as shown in fig 4 5 2 mr θr curves due to the similarities between the input soil stress strain curves and derived m r θ r curves a simple scaling model similar to the p y model is proposed as illustrated in fig 10 a point on the stress strain curve with mobilisation in shear stress τ s u corresponds to a point on the m r θ r curve with the same level of mobilisation in moment resistance m r m r ult 19 m r m r ult τ s u the corresponding normalised rotation angle θ r can be scaled from the shear strain γ by using two scaling factors 20 θ r ξ θ e γ e ξ θ p γ p where ξ θ e and ξ θ p are the two scaling factors applied to the elastic and plastic components of the shear strain respectively γ e and γ p can be calculated by using eqs 14 and 15 in elastic homogeneous soil k 0 and κ 0 with constant shear modulus g γ p 0 and thus γ γ e eq 19 can then be re written as 21 k r ξ θ e γ m r ult g γ s u0 where k r is elastic rotational stiffness the elastic scaling factor ξ θ e follows that 22 ξ θ e m r ult g s u k r the closed form solution of k r for a rigid caisson similar to the monopile segment below the rotation point in elastic homogeneous soil has been proposed by efthymiou and gazetas 2019 which can be expressed by the following equation assuming infinite bottom boundary 23 k r g d 3 3 1 ν 1 1 5 h d 1 2 h d 1 4 where ν is soil poisson s ratio ν 0 5 for undrained condition according to eq 8 the m r ult for monopiles in homogenous soil with fully rough interface i e k 0 and κ 0 can be expressed as 24 m r ult 1 6 π d 3 s u0 π s u0 d h 2 0 73 2 π 3 s u0 h 3 substituting eqs 23 and 24 into eq 22 leads to 25 ξ θ e π 4 1 6 h d 2 2 92 h d 3 1 1 5 h d 1 2 h d 1 4 as illustrated in the equation the ξ θ e is not a constant but changes with h d ratio the variation of ξ θ e with h d ratio according to eq 25 is presented in fig 11 for simplicity the variation of ξ θ e is fitted by a linear equation 26 ξ θ e 0 63 0 32 h d it is worth noting that eq 26 for elastic scaling factor ξ θ e is derived for monopiles in homogenous soil κ 0 however from the computed results presented in fig 8 d the m r θ r curves are insensitive to the degree of soil strength heterogeneity κ therefore the equation for ξ θ e is considered also applicable for monopiles in non homogenous soil conditions differing from the elastic scaling factor ξ θ e the plastic scaling factor ξ θ p is developed based on the numerical results a ξ θ p that varies linearly with h d ratio is found to give a best fit to the numerical results based on least squares regressions 27 ξ θ p 0 34 0 19 h d the variation of ξ θ p is also presented in fig 11 fig 12 shows an example where the m r θ r curves constructed by the proposed approach eqs 19 and 20 and 26 27 for the same stress strain curve are compared with those computed by the finite element analyses overall a very good match is demonstrated between the finite element results and the model predictions for all h d ratios examined here as the h d ratio increases noting that the normalised m r θ r response is insensitive to κ as demonstrated in section 4 2 the rotation needed to reach the ultimate moment resistance is increased which amplifies the discrepancy towards higher mobilisation levels in practice the l d ratio of offshore monopiles is typically in the range of 4 8 doherty and gavin 2012 murphy et al 2018 the pile length below the rotation point h varies between 0 2l 0 3l considering the depth of rotation point usually occurs between 0 7 and 0 8l chortis et al 2020 randolph and gourvenec 2011 wang et al 2020 this leads h d ranges from 0 8 to 2 4 which is fully covered in this study therefore it can be expected that the proposed approach is sufficiently accurate for analysing offshore monopiles the stress strain response of the soil layer below the rotation point measured at the in situ stress state should be used for the mapping the assumption is that the normalised stress strain response remains relatively constant within the soil layer below the rotation point 5 3 determination of the depth of the rotation point the above sections have described the proposed site specific p y m r θ r model in detail where the site specific p y and m r θ r springs can be directly derived from soil stress strain response measured in laboratory tests in addition to the soil reaction curves another key element of the proposed model is the depth of the rotation point for offshore monopiles in clay as reported by randolph and gourvenec 2011 and wang et al 2020 the depth of the pile rotation point falls within z 0 75 0 80l recently chortis et al 2020 performed a series of high quality centrifuge tests and three dimensional finite element analyses aiming to quantify the influence of scour depth and type on the lateral response of monopiles in sand it is revealed by both centrifuge tests and numerical analyses that the pile rotation point occurs at 0 7l irrespective of the magnitude of lateral displacement given the relatively narrow band 0 7 0 8l for the depth of the rotation point wang et al 2020 recommend a rotation point depth of z 0 80l for a quick assessment of the monopile response in the tender design and early design phases for the detailed design it is recommended to perform a trial analysis where p y springs are used along the entire pile length from the trial analysis the depth of the rotation point can be well determined as pointed out by zhang and andersen 2019 the depth of the rotation point is relatively insensitive to the p y curves adopted therefore a trial prediction is sufficiently accurate 5 4 summary of the proposed site specific p y mr θr model table 3 provides a summary of the proposed site specific p y m r θ r model note that the proposed model is suited for different design limit states it can be either used to check the bearing capacity of the pile under ultimate limit state uls or the foundation stiffness for fatigue limit state fls design the spring components of the proposed model p y and m r θ r are formulated in such a way that the complete soil pile interaction from initial stiffness at small displacement to degraded stiffness at large displacement is captured the input to the model i e strength and stress strain response of the soil should be aligned with the purpose of the springs 6 validation of the proposed site specific p y m r θ r model this section presents validation to the predictive capability of the site specific p y m r θ r model against finite element analyses and published centrifuge pile test results comparisons between the computed measured and predicted results are presented and discussed in the following subsections the pile responses calculated by the api p y curves are also included when using the api curves two input parameters i e j and ϵ 50 should be determined j is a dimensionless empirical factor that describes the rate of increase of the lateral bearing capacity factor n p with normalised depth and ϵ 50 denotes the axial strain at which 50 deviator stress is mobilised in an undrained compression test in the following validation cases a constant value of j 0 5 is adopted which is recommended by matlock 1970 for normally consolidated soft clay the value of ϵ 50 is determined from the stress strain curves of the corresponding soil 6 1 validation against 3d finite element analyses of full length monopiles to demonstrate the capability of the proposed model finite element analyses of full length monopiles with various l d ratios and soil stress strain responses are carried out the diameter d and wall thickness t of the monopiles are fixed to 8 m and 0 09 m respectively three pile embedment lengths of 24 m l d 3 32 m l d 4 and 40 m l d 5 are examined a constant stick up of 30 m is considered in all analyses the undrained shear strength profile is s u 5 1 5z the soil is modelled by the ngi adp model as described in section 3 2 with the relevant parameters being g max su 500 and γ f p 5 8 or 10 the fully rough interface between pile and soil is modelled and tension gap on the soil pile interface is not allowed fig 13 shows the comparison between computed and model predicted load displacement relationship for three selected cases as illustrated the proposed model satisfactorily captures the computed pile responses by finite element analyses with different combinations of l d ratio and stress strain response the model predicted pile responses are slightly softer than the computed responses by finite element analyses which can be attributed to the neglect of the soil resistance contribution from the vertical pile shaft friction above the rotation point the model predictions are considered sufficiently accurate for practical design purposes using the api p y curves alone leads to much softer pile responses compared to the current model prediction which is due to i too soft distributed p y curves which has been discussed amongst others by jeanjean 2009 and zhang and andersen 2017 ii neglect of the soil resistance from the pile tip which is more important for piles with smaller l d ratios in addition to the pile head load displacement response the proposed model also offers reasonable predictions for the displacement and rotation profiles as illustrated in fig 14 for example fig 15 compares the m r θ r curves at the pile rotation point extracted from the finite element analyses of the full length pile models and predicted by the proposed model as illustrated the model predicted m r θ r curves which are established by directly scaling the soil stress strain curve match well with the computed results demonstrating the accuracy of the proposed m r θ r model 6 2 validation against centrifuge monopiles tests reported by murali et al 2015 2019 murali et al 2015 2019 reported a series of centrifuge tests on a rigid monopile with a prototype diameter of 3 47 m in normally consolidated soft clay the model pile has a wall thickness of 0 042 m in prototype and an embedded length of 7 1 m in prototype leading to a l d ratio of 2 four load eccentricities i e e 1 2 1 5 2 5 and 3 5d were examined the tests with the load eccentricity of 1 2 and 3 5d were carried out in clay bed 1 which has an undrained strength profile of s u 1 1 1z the tests with the load eccentricity of 1 5 and 2 5d were conducted in clay bed 2 which has an undrained shear strength profile of s u 1 1 3z the soil used in their centrifuge tests was the basf kaolin clay which has a plasticity index i p of 33 due to the lack of reported soil element tests on this kaolin clay the stress strain response of the uwa kaolin clay g max s u 500 and γ f p 5 is adopted in the back analyses zhang et al 2020 the properties of the uwa kaolin are selected because of its comparable plasticity index 28 fig 16 compares the measured and predicted load displacement relationship of the monopile at four load eccentricities the results predicted by the api p y model are also included in the figure for comparison as illustrated the api p y model grossly underestimates the pile response on the other hand the predicted pile response by the proposed model agrees well with those measured from the tests indicating the superiority of the proposed model for monopile analysis for the extremely short monopiles examined l d 2 in this validation the soil resistance from the pile tip is essential this validation demonstrates that the proposed model can successfully capture the soil resistance below the rotation point 7 limitations in the current study the soil has been simplified as an isotropic material however natural soil exhibits anisotropic strength and stress strain response this aspect is to be investigated in further studies for the monopile foundation under lateral loading mixed shearing modes are mobilised for example the triaxial extension and dss shearing modes are mobilised by the passive soil wedge while the triaxial compression and dss shearing modes are mobilised by the active soil wedge the rotational scoop mobilises the three different shearing modes along different parts of the mechanism as an interim recommendation the shear strength and stress strain response measured in the dss shear model is suggested to be used when applying the proposed model as the dss strength is found to be typically a good average of triaxial compression dss and triaxial extension strengths andersen et al 2008 liedtke et al 2019 it should be also noted that the proposed site specific p y m r θ r model in this study assumes that the pile section below the rotation point is embedded entirely within a single soil layer with a constant or linearly increasing strength profile for the case in which the soil below rotation point is layered engineering judgement is called on to simplify the soil profile into a single layer however if the strengths or the stress strain responses are strongly contrasted between the layers a site specific calibration of the m r θ r using the proposed simplified finite element approach might be justified 8 summary and conclusions this paper proposes a site specific p y m r θ r framework for the design of laterally loaded monopiles in soft clay the lateral soil resistance above the rotation point is represented by distributed p y springs while the soil resistance below the rotation point is lumped into a concentrated m r θ r spring the p y model proposed by zhang and andersen 2017 which scales the p y curves from the stress strain response of the soil is adopted to capture the distributed soil resistance above the rotation point special attention is paid on the construction of the m r θ r spring from the site specific stress strain response and the undrained shear strength profile based on the combined analytical analyses and an extensive parametric finite element study the following conclusions can be drawn 1 the ultimate moment capacity m r ult of the m r θ r curves is the sum of the moment resistance due to the scoop failure surface and side shear a closed form solution of m r ult is proposed in this study through an upper bound analysis which is a function of pile diameter the pile length below the rotation point and soil strength profile 2 the shape of m r θ r curves bear strong similarities to the soil stress strain curves a soil with stiffer stress strain response results in stiffer m r θ r response when the pile length below the rotation point increases the m r θ r response becomes gradually softer while the soil strength heterogeneity exhibits negligible impact on it 3 the m r θ r response can be well scaled from the stress strain response of the soil by introducing two scaling factors applied to the elastic and plastic components of the shear stain these two factors show an approximately linear relationship with h d 4 with the proposed site specific p y m r θ r model soil reaction curves for monopile analysis can be readily constructed based on the stress strain response of the soil measured in routine soil element tests and shear strength profile established from site characterisation this provides practising engineers with a simple yet powerful approach to use site specific soil reaction curves in monopile design 5 validations against finite element analyses and centrifuge pile load tests demonstrate the satisfactory predictive capabilities of the proposed model on the other hand the conventional api p y model is proven to significantly underestimate the pile stiffness and capacity the adoption of the proposed model has large potential for achieving safer and more optimized monopile designs credit authorship contribution statement yongqing lai conceptualization methodology validation investigation writing original draft lizhong wang conceptualization methodology writing review editing youhu zhang conceptualization methodology writing review editing yi hong conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge the financial support provided by national key research and development program of china 2018yfe0109500 national natural science foundation of china 51939010 and 51779221 the key research and development program of zhejiang province 2018c03031 and joint fund of ministry of education for pre research of equipment 6141a02022137 
21184,large diameter monopiles are the predominant foundation solution for supporting offshore wind turbines they are conventionally designed using soil reaction curves developed for long slender piles used for supporting offshore oil and gas platforms e g the api p y model however due to the difference in the length diameter ratio and the resulting soil mechanisms the use of p y curves alone can lead to significant under prediction of the lateral stiffness and capacity of monopiles to overcome the shortcoming the authors have previously proposed a conceptual two spring framework i e the so called p y m r θ r model to capture the monopile response in soft clay under lateral loading the framework uses distributed p y springs to consider the lateral soil resistance along the pile above the rotation point rp and a single moment rotation m r θ r spring attached at the rp to capture the entire soil resistance below the rp i e the distributed resistance along the pile base shear and base moment at the pile tip the proposed p y and m r θ r springs were curve fitted to the results of 3d numerical analyses however as the stress strain response and the shear strength profile inevitably influence the p y and m r θ r springs the applicability of the empirical formulations to soil conditions other than those examined is uncertain this study proposes an enhancement to the p y m r θ r framework in which the p y and m r θ r springs are not tied to a specific soil and strength profile but fundamentally linked to the properties that can be measured directly in the site investigation and laboratory this extension is achieved through analytical analyses and an extensive parametric numerical study the predictive capabilities of the model are demonstrated by back analyses of finite element analyses and centrifuge model tests the proposed model provides practising engineers with a simple yet powerful approach to use site specific soil reaction curves in the design of monopiles embedded in soft clay keywords monopile soft clay p y curve base shear base moment stress strain finite element analysis centrifuge modelling 1 introduction monopiles are the dominant foundation solution for supporting offshore wind turbines owts to resist large lateral load and bending moment resulting from wind waves and current pile diameter d in the range of 6 8 m is common nowadays extra large monopiles with diameter greater than 10 m are also being considered in newer projects the embedded length to diameter ratio l d of monopiles is typically in the range of 4 8 doherty and gavin 2012 murphy et al 2018 in competent soils in soft seabed conditions such as offshore china the l d ratio can be as high as 10 or more lai et al 2020 1 1 literature review monopile foundations are commonly designed using the beam column approach where the pile is modelled as an equivalent elastic beam and the lateral soil resistance are represented by distributed nonlinear p y springs along the pile length in soft clays the api formulation api recommended practice 2geo 2014 has been conventionally used despite that the api p y model is originally developed for the design of small diameter slender piles used in the offshore oil and gas industry direct adoption of the api model to the design of monopiles with small l d ratios are insufficient and may lead to an underestimation of lateral pile capacity and stiffness gerolymos and gazetas 2006 lam 2009 gao et al 2015 byrne et al 2017 2019 wang et al 2018 2020 zhang and andersen 2019 fu et al 2020a during the past decade a number of alternative p y formulations have been proposed for improving the modelling of slender pile response in clay through numerical analytical and experimental studies examples are among others jeanjean 2009 yu et al 2017 zhang and andersen 2017 jeanjean et al 2017 and zhu et al 2017 it is worth noting that generalized approach proposed zhang and andersen 2017 and jeanjean et al 2017 which derives the site specific p y response by mapping the normalised stress strain response measured in direct simple shear test is set to be incorporated in the upcoming revisions of the iso 19901 4 and api rp2geo and supersedes the existing clay p y formulation to gain insight into the monopile response a joint industry research project pisa performed a comprehensive set of large scale field tests on model piles based on the test results and extensive 3d finite element analyses byrne et al 2017 2019 emphasized that for monopiles besides the distributed lateral soil resistance additional resistance components including the base shear the base moment and the distributed moment resistance due to vertical shaft friction are meaningful and cannot be neglected for optimized design they proposed a four spring model for monopile analysis which includes the aforementioned soil resistances zhang and andersen 2019 proposed a two spring model that accounts for the distributed lateral soil resistance along the pile and the base shear at the pile tip arguing that the base moment is negligible compared to the pisa model zhang and andersen 2019 linked the soil springs to the elemental stress strain response of the soil for ease of application in design fu et al 2020a further proposed scaling relationship for mapping stress strain response to distributed moment rotation spring due to the vertical shaft friction in addition three dimensional numerical models are widely adopted in research for analysing monopile behaviour kim and jeong 2011 qi et al 2014 achmus and thieken 2016 he et al 2019 wang et al 2020 which are capable of modelling complex three dimensional pile soil interaction however it is clear that three dimensional numerical modelling is too computationally expensive and thus may not suitable for engineering practice burd et al 2017 the authors have previously proposed a conceptual framework termed as p y m r θ r model as illustrated in fig 1 the soil resistance along the pile above the rotation point rp is represented by distributed lateral springs p y springs while the soil resistance below the rotation point is modelled by i constraining the lateral displacement at the rotation point and ii incorporating a concentrated rotational spring m r θ r spring at the rotation point by doing so the overall soil resistance at and below the rotation point including the contributions from the base shear and base moment are all integrated into the concentrated rotational spring validation exercises demonstrate that the model can predict the lateral behaviour of monopiles with a range of l d ratios using a unified set of parameters wang et al 2020 although the original p y m r θ r framework is simple and easy to apply the formulations of the p y and the m r θ r curves were based on empirical curve fitting to the results of finite element analyses in a specific soil normally consolidated malaysian kaolin it is well established that soil reaction curves are highly dependent on the stress strain response of the soil bransby 1999 klar and osman 2008 yu et al 2017 zhang and andersen 2017 2019 a soil with stiffer stress strain response will naturally result in stiffer soil reaction curves and vice versa in addition the strength distribution below the rotation point will naturally changes the ultimate capacity of the m r θ r curve based on the above discussions the applicability of the previously proposed p y m r θ r framework to other soil conditions is uncertain and further development is necessary to generalise the model for wider range of soil conditions 1 2 motivation of this study the motivation of this study is therefore to enhance the previously proposed p y m r θ r framework so that the formulations of the p y and m r θ r springs are no longer tied to a specific soil type and strength profile but linked to fundamental soil properties that can be directly measured in routine site investigation and laboratory testing note that zhang and andersen 2017 have already proposed a model for mapping the lateral p y response in clay from the laboratory stress strain curves more details are provided in section 5 1 therefore this study mainly focusses on the development of a model for the construction of the m r θ r spring from the site specific stress strain response and the undrained shear strength profile osman and bolton 2005 proposed the so called mobilizable strength design msd concept which assumes self similarity between the stress strain response of a soil element and the load displacement response of a boundary value problem based on this concept the work by osman et al 2007 demonstrates that for a circular surface foundation under pure moment loading its moment rotation response can be scaled from the soil element s stress strain response for monopiles the m r θ r response at the rotation point can be regarded as the moment rotation response of an imaginary circular foundation with embedment equal to the pile length below the rotation point as the soil failure mechanism beneath the circular surface foundation is similar to that below the rotation point of a monopile i e a rotational scoop type mechanism hong et al 2017 it is worth noting that in the current framework the lumped m r θ r response is only meant to capture the soil resistance below the rotation point the soil that is above the rotation point but also mobilised by the rotational mechanism does indeed contribute to additional resistance however this resistance is captured by the distributed p y springs based on the above discussion it is possible and rationale to link the m r θ r response of the monopiles to the stress strain response of the soil in this study an analytical derivation of the ultimate capacity of the m r θ r spring based on the well established scoop failure mechanism is first presented thereafter an extensive numerical parametric investigation of the m r θ r responses for various geometries over a wide range of stress strain behaviours and undrained shear strength profiles is performed the parametric investigation explores the scaling relationship of the m r θ r springs to the stress strain response and how that scaling relation is influenced by the strength profile and geometry lastly to verify the validity of the proposed p y m r θ r framework pile responses computed by 3d finite element analyses and measured in centrifuge model tests are compared with the model predictions 2 analytical solution for ultimate moment capacity of m r θ r curves m r ult as reported by hong et al 2017 and zhang and andersen 2019 for semi rigid or rigid monopiles the soil failure mechanism below the pile rotation point takes the form of a rotational scoop around the rotation point therefore the upper bound solution of the reacting ultimate moment capacity m r ult about the rotation point is given as the sum of the moment resistance due to the scoop failure surface m r scoop and side shear m r side 1 m r ult m r scoop m r side the scoop failure surface is a 3d surface the ultimate moment resistance from the scoop failure surface m r scoop can be considered as the sum of the moment resistance from the slip surfaces caused by a series of strips as illustrated in fig 2 a strip aa with a thickness of dy and located at a distance y from the pile central cross section forms a semi circle slip surface cbb c with a radius of r f 2 r f o b o a 2 a b 2 o a 2 o o 2 a b 2 d 2 2 y 2 h 2 for a linearly increasing undrained shear strength profile with a strength at the rotation point equal to s u0 and a strength gradient k see fig 2 the moment resistance about the rotation point o due to the slip surface caused by strip aa can be calculated as assuming unit thickness i e dy 1 3 m r scoop section 2 0 π 2 s u0 k r f sin α r f d l 1 2 0 π 2 s u0 k r f sin α r f r f d α therefore the m r scoop due to the 3d scoop failure surface is 4 m r scoop 2 0 d 2 m r scoop section d y substituting eq 3 into eq 4 5 m r scoop 2 0 d 2 2 0 π 2 s u0 k r f sin α r f r f d α d y 1 6 π d 3 s u0 π s u0 d h 2 k 1 2 d 2 2 h 2 2 3 8 t 1 4 sin 2 t 1 32 sin 4 t where t arcsin d d 2 4 h 2 due to the circular cross section of the monopile a 3d spherical scoop mechanism is mobilised by the pile around the rotation point it was not attempted to derive the moment resistance due to side shear directly instead the resistance for a square cross section is first derived and then corrected for the shape by applying a side shear factor which is well established for suction anchor design at ngi jostad and andersen 2015 assuming a square pile cross section with the width equal to the pile diameter d the ultimate moment resistance contributed from the shear on the two side planes m r side is given as the sum of reacting moment about axis e e as shown in fig 3 6 m r side 2 0 h 2 0 π 2 s u0 k z sin δ z d l d z 2 0 h 2 0 π 2 s u0 k z sin δ z z d δ d z however the monopile foundation has a circular cross section instead of a square the difference in shape results in a reduced side shear resistance which is corrected by a side shear factor r ss for computing the holding capacity of suction anchors using 2d soil elements jostad and andersen 2015 carried out series of comparative 2d and 3d finite element analyses on suction anchors of different length to diameter ratios in order to calibrate the side shear factor which accounts for the 3d shape of the suction anchor they concluded a side shear factor r ss 0 73 for correcting for the 3d effect therefore r ss 0 73 is applied herein to correct the side shear moment resistance derived for a square cross section 7 m r side 2 0 h 2 0 π 2 r ss s u0 k z sin δ z z d δ d z 0 73 2 π 3 s u0 h 3 k h 4 therefore substituting eq 5 and eq 7 into eq 1 the solution for ultimate moment capacity m r ult is 8 m r ult 1 6 π d 3 s u0 π s u0 d h 2 k 1 2 d 2 2 h 2 2 3 8 t 1 4 sin 2 t 1 32 sin 4 t 0 73 2 π 3 s u0 h 3 k h 4 where t arcsin d d 2 4 h 2 3 m r θ r response of monopiles in soft clay methodology of 3d numerical parametric study 3 1 simplified finite element model to investigate mr θr response of monopiles to form the p y m r θ r model the m r θ r spring as a key element of the model should be generalized to formulate m r θ r response of monopiles wang et al 2020 performed a series of numerical analyses of full length monopiles with various l d ratios the pile bending moment and rotation at the rotation point was extracted to form the m r θ r curves in this study a more efficient method is adopted instead of modelling the full length monopile only the monopile below the rotation point is modelled since the m r θ r response represents the overall soil resistance below the rotation point as illustrated in fig 4 it should be borne in mind that the m r θ r response is only meant to capture the soil resistance below the rotation point the soil resistance above the rotation point is captured by the distributed p y springs in the current framework lateral displacement at the rotation point is constrained and a pure moment loading is applied on the top surface of the pile model enforcing a rotational scoop mechanism around the rotation point by doing so the behaviour of the monopile below the rotation point is reproduced by the simplified model the computed moment rotation response of the pile model equivalents to the m r θ r response below the rp of a monopile the validity of the simplified approach is examined in section 3 4 where the m r θ r responses computed by the simplified models are compared with those extracted from the full length monopile models the numerical analyses were performed in abaqus abaqus 2014 this study considers a monopile with a diameter d of 6 m and a range of pile lengths h below the rotation point h 3 6 9 12 and 15 m are considered covering h d ratios from 0 5 to 2 5 which is considered a practical range as the results will be presented in a normalised format the absolute dimension of the pile diameter does not matter a typical three dimensional finite element mesh for a monopile with d 6 m and h 6 m is illustrated in fig 4 only half of the pile is modelled by taking advantage of the symmetry the diameter of the cylindrical soil block and the distance between the pile tip and the soil bottom boundary are chosen to be 20d and 5d respectively to minimize the boundary effect the lateral boundary of the finite element mesh is constrained by roller support while the bottom boundary is fixed by pinned support the top of the soil domain is set free to displacement the monopile is constrained to be a rigid body for simplicity which is considered reasonable since the pile rotates with negligible bending below the rotation point a fully rough pile soil interface is modelled in the numerical analyses on the front side of the loading direction the pile pushes against the soil above the rotation point thus cutting off the water flow path if a tension gap was to open below the rotation point on the rear side the pile kicks against the soil below the rotation point thus no separation is allowed on the interface a pure moment load is applied on the top surface of the pile and the ultimate state is indicated by minimal increase in moment load with increase of rotation 3 2 soil model the soil is described by a total stress anisotropic model ngi adp model grimstad et al 2012 for simplicity the strength and stiffness anisotropy are not considered although the ngi adp model is not a built in soil model in abaqus it was achieved by adopting the mohr coulomb model with a zero degree friction angle i e tresca yield criterion and specifying a table of plastic shear strain versus yield stress i e mobilised shear stress in this study the stress strain response plastic component is calculated using the following plastic hardening rule adopted by the ngi adp model and then used as input in abaqus 9 τ s u 2 γ p γ f p 1 γ p γ f p where τ currently mobilised shear stress s u the shear strength of soil γ p the current plastic shear strain γ f p the plastic shear strain at failure full mobilisation the total shear strain γ associated with the currently mobilised shear stress τ is the summation of elastic and plastic shear strain components γ e and γ p respectively 10 γ γ e γ p τ g max γ p τ s u g max s u γ p where g max s u is the small strain shear modulus ratio and is used to calculate the elastic component of shear strain over the entire stress range as can be seen from eqs 9 and 10 the ngi adp model uses two parameters i e γ f p and g max s u to define the stress strain response of clay g max can be determined through a resonant column test or bender elements incorporated in a soil element test γ f p literally stands for the plastic shear strain at failure and should be determined by curve fitting that provides the best fit to the stress strain curve measured in the soil element shear test zhang and andersen 2017 demonstrate that the model can describe the stress strain behaviour measured over a wide range of natural clays with combinations of the two parameters 3 3 parametric range in this study an extensive numerical parametric study over a wide range of h d ratios and soil stress strain response is carried out to investigate the m r θ r response the ranges of the parameters are summarized in table 1 it is assumed that the part of the pile below the rotation point is embedded entirely within a single soil layer with a constant or linearly increasing strength profile and the degree of soil strength heterogeneity can be expressed by the normalised parameter κ defined as 11 κ k d s u 0 where k and s u0 denote the shear strength gradient and the shear strength at the depth of the rotation point respectively as illustrated in fig 4 in this study a pile diameter of d 6 m is fixed while a range of soil strength profiles are investigated they are detailed in table 2 which presents a normalised group κ varying from 0 to 0 5 in total 300 3d finite element analyses involving the full combination of all parameters listed in tables 1 and 2 are performed producing 300 m r θ r curves the scaling relationship between the m r θ r curve and the corresponding soil stress strain curve is explored which will be presented below 3 4 validation of the simplified finite element model for investigating mr θr response before performing the numerical parametric study using the simplified finite element model the validity and accuracy of the simplified model for deriving m r θ r response is verified first for this purpose the m r θ r responses computed by the simplified model are compared with those computed by the corresponding full length monopile model two finite element analyses of laterally loaded full length monopiles with a diameter d 6 m with l d ratio of 4 and 5 are carried out the monopiles are modelled as linearly elastic solid cylinders assigned with equivalent elastic properties that produce bending stiffness ei that is equivalent to the steel hollow piles with a wall thickness of 0 06 m typical finite element mesh for the full length monopile with l d 5 is presented in fig 5 the pile stick up above the soil surface is kept 30 m for the two l d ratios where a lateral force is applied the magnitude of the applied lateral force does not matter as long as the full m r θ r response can be obtained from the numerical results therefore in the analyses reported herein a relatively large lateral force is applied to ensure the m r θ r response reaches its ultimate state i e the m r θ r curve reaches a plateau the soil is described by the ngi adp model see section 3 2 with parameters of γ f p 5 and g max s u 500 an effective soil unit weight of 6 kn m3 is adopted for all the cases the soil strength increases linearly with depth at a gradient of 1 5 kpa per metre i e s u 1 5z a fully rough pile soil interface is modelled and separation between the interface is not allowed the pile bending moment m r and rotation angle θ r at the depth of the rotation point were extracted from the full length monopile model to form the m r θ r relationships the length of the pile below the rotation point h is also obtained from the finite element analyses based on the h revealed by the full length models corresponding simplified finite element models in which only the monopile below the rotation point is modelled as illustrated in fig 4 are then developed for deriving the m r θ r responses using the simplified approach as presented in section 3 1 the computed m r θ r responses from the simplified finite element models are compared with those computed from the full length model in fig 6 it can be seen from the figure that the m r θ r responses computed by the simplified models match well with those computed by the full length monopile models demonstrating the validity and accuracy of the simplified model fundamentally the good match is obtained because i undrained soil response is assumed here thus the soil weight above the rotation point does not affect the undrained shear strength of the soil below the rotation point ii since a pure rotational scoop mechanism is enforced about the rotation point the soil mechanism below the rotation point is the same with or without the soil above it the mobilised resistance offered by the soil below the rotation point is thus the same with or without soil above the rotation point it should be reiterated that the lumped m r θ r is only meant to capture the soil resistance below the rotation point the soil that is above the rotation point but also mobilised by the rotational mechanism does indeed contribute to additional resistance however this contribution is captured by distributed p y springs in the current framework 4 numerical analysis results 4 1 ultimate moment capacity of mr θr curves mr ult fig 7 shows the variation of the computed ultimate moment capacity m r ult with soil strength heterogeneity κ and h d ratio in the figure m r ult is normalised by ads u0 where a is the overall cross sectional area enclosed by the pile as expected m r ult is strongly influenced by κ and the h d ratio at any given of h d ratio m r ult shows an approximately linear relationship with soil strength heterogeneity κ comparing to the influence of κ the increase in h d ratio leads to a much more pronounced growth in m r ult as illustrated in fig 7 the m r ult is well predicted by the analytical solution presented in section 2 4 2 normalised mr θr curves fig 8 a 8 d presents some typical results illustrating the influence of h d ratio γ f p g max s u and κ on the normalised m r θ r curves m r m r ult vs θ r respectively the representative set of m r θ r curves presented in fig 8 a shows that as the h d ratio increases the normalised m r θ r curve becomes gradually softer this is as expected that when h d ratio increases the rotational soil scoop expands and thus a larger rotation angle θ r is needed to reach failure resulting in a softer response fig 8 b presents an example set of four computed m r θ r curves for four soil stress strain responses that are increasingly softer i e γ f p 2 5 10 15 as anticipated the computed m r θ r response also becomes increasing softer different from the h d ratio and γ f p g max s u and κ exhibit negligible impact on the normalised m r θ r curves as can be seen in fig 8 c and d respectively from fig 8 it is clear that the shape of the m r θ r curves bears strong similarities to the soil stress strain curves that were used as input to derive them therefore it is interesting to explore the possibility of scaling the soil stress strain curves to the m r θ r curves which is attempted in the following section 5 proposed site specific p y m r θ r framework this section aims to propose a site specific p y m r θ r framework where the p y and m r θ r curves can be constructed by directly scaling the soil stress strain curves measured in the laboratory tests while the site specific p y curves proposed by zhang and andersen 2017 is adopted for capturing the soil resistance above the rotation point attempt is made in this section to link the m r θ r curves to the soil stress strain curves based on the results of the extensive parametric numerical analyses 5 1 p y curves based on an extensive finite element study zhang and andersen 2017 proposed a framework that allows for construction of site specific p y curves by directly scaling the soil stress strain curves measured in laboratory element test as schematically illustrated in fig 9 a point on the stress strain curve with mobilisation in shear stress τ s u corresponds to a point on the p y curve with the same level of mobilisation in lateral bearing pressure p p u 12 p p u τ s u the corresponding normalised lateral displacement y d can be scaled from the shear strain γ by using two scaling factors 13 y d ξ y e γ e ξ y p γ p 14 γ e τ g max τ s u g max s u 15 γ p γ γ e where ξ y e and ξ y p are the two scaling factors applied to the elastic and plastic components of the shear strain respectively for simplicity a constant value of ξ y e 2 8 is proposed while ξ y p is expressed as a function of pile soil interface roughness factor α ξ y p 1 35 0 25α further details on the derivation of the scaling factors can be found in zhang and andersen 2017 it should be noted that this p y framework is strictly only applicable for a plain strain flow around soil mechanism and thus it is more suitable for flexible piles for a rigid or semi rigid monopile the soil flow mechanisms are dominated by a wedge type flow in the upper part and a rotational flow in the lower part hong et al 2017 considering the soft clay conditions concerned in this paper a tension gap is unlikely on the rear side of the monopile fu et al 2020b and thus two soil wedges passive and active wedge will be mobilised this is not too dis similar to the condition of a flow around mechanism therefore despite the difference in soil mechanisms the p y curves proposed by zhang and andersen 2017 are recommended for representing the lateral soil resistance above the rotation point the suitability of the p y curves will be examined later when the proposed model is used to back analyse the pile response obtained from centrifuge tests and finite element analyses through eqs 12 15 the shape of the p y curves p p u vs y d is determined the ultimate soil resistance of the p y curves p u is calculated by 16 p u n p s u d where n p is the lateral bearing capacity factor for the condition with suction i e no tension gap the equations proposed by zhang et al 2016 which is derived from yu et al 2015 s upper bound analyses is adopted in the model to calculate the n p value as follows 17 n p 2 n 1 n 1 n 2 z d d z d d z d d 0 6 1 35 1 α n pd 18 n pd 9 14 2 8 α where n 1 11 94 n 2 3 22 d 16 8 2 3log10 λ λ s um kd and 0 1 λ 10 s um is the soil shear strength at the mudline as shown in fig 4 5 2 mr θr curves due to the similarities between the input soil stress strain curves and derived m r θ r curves a simple scaling model similar to the p y model is proposed as illustrated in fig 10 a point on the stress strain curve with mobilisation in shear stress τ s u corresponds to a point on the m r θ r curve with the same level of mobilisation in moment resistance m r m r ult 19 m r m r ult τ s u the corresponding normalised rotation angle θ r can be scaled from the shear strain γ by using two scaling factors 20 θ r ξ θ e γ e ξ θ p γ p where ξ θ e and ξ θ p are the two scaling factors applied to the elastic and plastic components of the shear strain respectively γ e and γ p can be calculated by using eqs 14 and 15 in elastic homogeneous soil k 0 and κ 0 with constant shear modulus g γ p 0 and thus γ γ e eq 19 can then be re written as 21 k r ξ θ e γ m r ult g γ s u0 where k r is elastic rotational stiffness the elastic scaling factor ξ θ e follows that 22 ξ θ e m r ult g s u k r the closed form solution of k r for a rigid caisson similar to the monopile segment below the rotation point in elastic homogeneous soil has been proposed by efthymiou and gazetas 2019 which can be expressed by the following equation assuming infinite bottom boundary 23 k r g d 3 3 1 ν 1 1 5 h d 1 2 h d 1 4 where ν is soil poisson s ratio ν 0 5 for undrained condition according to eq 8 the m r ult for monopiles in homogenous soil with fully rough interface i e k 0 and κ 0 can be expressed as 24 m r ult 1 6 π d 3 s u0 π s u0 d h 2 0 73 2 π 3 s u0 h 3 substituting eqs 23 and 24 into eq 22 leads to 25 ξ θ e π 4 1 6 h d 2 2 92 h d 3 1 1 5 h d 1 2 h d 1 4 as illustrated in the equation the ξ θ e is not a constant but changes with h d ratio the variation of ξ θ e with h d ratio according to eq 25 is presented in fig 11 for simplicity the variation of ξ θ e is fitted by a linear equation 26 ξ θ e 0 63 0 32 h d it is worth noting that eq 26 for elastic scaling factor ξ θ e is derived for monopiles in homogenous soil κ 0 however from the computed results presented in fig 8 d the m r θ r curves are insensitive to the degree of soil strength heterogeneity κ therefore the equation for ξ θ e is considered also applicable for monopiles in non homogenous soil conditions differing from the elastic scaling factor ξ θ e the plastic scaling factor ξ θ p is developed based on the numerical results a ξ θ p that varies linearly with h d ratio is found to give a best fit to the numerical results based on least squares regressions 27 ξ θ p 0 34 0 19 h d the variation of ξ θ p is also presented in fig 11 fig 12 shows an example where the m r θ r curves constructed by the proposed approach eqs 19 and 20 and 26 27 for the same stress strain curve are compared with those computed by the finite element analyses overall a very good match is demonstrated between the finite element results and the model predictions for all h d ratios examined here as the h d ratio increases noting that the normalised m r θ r response is insensitive to κ as demonstrated in section 4 2 the rotation needed to reach the ultimate moment resistance is increased which amplifies the discrepancy towards higher mobilisation levels in practice the l d ratio of offshore monopiles is typically in the range of 4 8 doherty and gavin 2012 murphy et al 2018 the pile length below the rotation point h varies between 0 2l 0 3l considering the depth of rotation point usually occurs between 0 7 and 0 8l chortis et al 2020 randolph and gourvenec 2011 wang et al 2020 this leads h d ranges from 0 8 to 2 4 which is fully covered in this study therefore it can be expected that the proposed approach is sufficiently accurate for analysing offshore monopiles the stress strain response of the soil layer below the rotation point measured at the in situ stress state should be used for the mapping the assumption is that the normalised stress strain response remains relatively constant within the soil layer below the rotation point 5 3 determination of the depth of the rotation point the above sections have described the proposed site specific p y m r θ r model in detail where the site specific p y and m r θ r springs can be directly derived from soil stress strain response measured in laboratory tests in addition to the soil reaction curves another key element of the proposed model is the depth of the rotation point for offshore monopiles in clay as reported by randolph and gourvenec 2011 and wang et al 2020 the depth of the pile rotation point falls within z 0 75 0 80l recently chortis et al 2020 performed a series of high quality centrifuge tests and three dimensional finite element analyses aiming to quantify the influence of scour depth and type on the lateral response of monopiles in sand it is revealed by both centrifuge tests and numerical analyses that the pile rotation point occurs at 0 7l irrespective of the magnitude of lateral displacement given the relatively narrow band 0 7 0 8l for the depth of the rotation point wang et al 2020 recommend a rotation point depth of z 0 80l for a quick assessment of the monopile response in the tender design and early design phases for the detailed design it is recommended to perform a trial analysis where p y springs are used along the entire pile length from the trial analysis the depth of the rotation point can be well determined as pointed out by zhang and andersen 2019 the depth of the rotation point is relatively insensitive to the p y curves adopted therefore a trial prediction is sufficiently accurate 5 4 summary of the proposed site specific p y mr θr model table 3 provides a summary of the proposed site specific p y m r θ r model note that the proposed model is suited for different design limit states it can be either used to check the bearing capacity of the pile under ultimate limit state uls or the foundation stiffness for fatigue limit state fls design the spring components of the proposed model p y and m r θ r are formulated in such a way that the complete soil pile interaction from initial stiffness at small displacement to degraded stiffness at large displacement is captured the input to the model i e strength and stress strain response of the soil should be aligned with the purpose of the springs 6 validation of the proposed site specific p y m r θ r model this section presents validation to the predictive capability of the site specific p y m r θ r model against finite element analyses and published centrifuge pile test results comparisons between the computed measured and predicted results are presented and discussed in the following subsections the pile responses calculated by the api p y curves are also included when using the api curves two input parameters i e j and ϵ 50 should be determined j is a dimensionless empirical factor that describes the rate of increase of the lateral bearing capacity factor n p with normalised depth and ϵ 50 denotes the axial strain at which 50 deviator stress is mobilised in an undrained compression test in the following validation cases a constant value of j 0 5 is adopted which is recommended by matlock 1970 for normally consolidated soft clay the value of ϵ 50 is determined from the stress strain curves of the corresponding soil 6 1 validation against 3d finite element analyses of full length monopiles to demonstrate the capability of the proposed model finite element analyses of full length monopiles with various l d ratios and soil stress strain responses are carried out the diameter d and wall thickness t of the monopiles are fixed to 8 m and 0 09 m respectively three pile embedment lengths of 24 m l d 3 32 m l d 4 and 40 m l d 5 are examined a constant stick up of 30 m is considered in all analyses the undrained shear strength profile is s u 5 1 5z the soil is modelled by the ngi adp model as described in section 3 2 with the relevant parameters being g max su 500 and γ f p 5 8 or 10 the fully rough interface between pile and soil is modelled and tension gap on the soil pile interface is not allowed fig 13 shows the comparison between computed and model predicted load displacement relationship for three selected cases as illustrated the proposed model satisfactorily captures the computed pile responses by finite element analyses with different combinations of l d ratio and stress strain response the model predicted pile responses are slightly softer than the computed responses by finite element analyses which can be attributed to the neglect of the soil resistance contribution from the vertical pile shaft friction above the rotation point the model predictions are considered sufficiently accurate for practical design purposes using the api p y curves alone leads to much softer pile responses compared to the current model prediction which is due to i too soft distributed p y curves which has been discussed amongst others by jeanjean 2009 and zhang and andersen 2017 ii neglect of the soil resistance from the pile tip which is more important for piles with smaller l d ratios in addition to the pile head load displacement response the proposed model also offers reasonable predictions for the displacement and rotation profiles as illustrated in fig 14 for example fig 15 compares the m r θ r curves at the pile rotation point extracted from the finite element analyses of the full length pile models and predicted by the proposed model as illustrated the model predicted m r θ r curves which are established by directly scaling the soil stress strain curve match well with the computed results demonstrating the accuracy of the proposed m r θ r model 6 2 validation against centrifuge monopiles tests reported by murali et al 2015 2019 murali et al 2015 2019 reported a series of centrifuge tests on a rigid monopile with a prototype diameter of 3 47 m in normally consolidated soft clay the model pile has a wall thickness of 0 042 m in prototype and an embedded length of 7 1 m in prototype leading to a l d ratio of 2 four load eccentricities i e e 1 2 1 5 2 5 and 3 5d were examined the tests with the load eccentricity of 1 2 and 3 5d were carried out in clay bed 1 which has an undrained strength profile of s u 1 1 1z the tests with the load eccentricity of 1 5 and 2 5d were conducted in clay bed 2 which has an undrained shear strength profile of s u 1 1 3z the soil used in their centrifuge tests was the basf kaolin clay which has a plasticity index i p of 33 due to the lack of reported soil element tests on this kaolin clay the stress strain response of the uwa kaolin clay g max s u 500 and γ f p 5 is adopted in the back analyses zhang et al 2020 the properties of the uwa kaolin are selected because of its comparable plasticity index 28 fig 16 compares the measured and predicted load displacement relationship of the monopile at four load eccentricities the results predicted by the api p y model are also included in the figure for comparison as illustrated the api p y model grossly underestimates the pile response on the other hand the predicted pile response by the proposed model agrees well with those measured from the tests indicating the superiority of the proposed model for monopile analysis for the extremely short monopiles examined l d 2 in this validation the soil resistance from the pile tip is essential this validation demonstrates that the proposed model can successfully capture the soil resistance below the rotation point 7 limitations in the current study the soil has been simplified as an isotropic material however natural soil exhibits anisotropic strength and stress strain response this aspect is to be investigated in further studies for the monopile foundation under lateral loading mixed shearing modes are mobilised for example the triaxial extension and dss shearing modes are mobilised by the passive soil wedge while the triaxial compression and dss shearing modes are mobilised by the active soil wedge the rotational scoop mobilises the three different shearing modes along different parts of the mechanism as an interim recommendation the shear strength and stress strain response measured in the dss shear model is suggested to be used when applying the proposed model as the dss strength is found to be typically a good average of triaxial compression dss and triaxial extension strengths andersen et al 2008 liedtke et al 2019 it should be also noted that the proposed site specific p y m r θ r model in this study assumes that the pile section below the rotation point is embedded entirely within a single soil layer with a constant or linearly increasing strength profile for the case in which the soil below rotation point is layered engineering judgement is called on to simplify the soil profile into a single layer however if the strengths or the stress strain responses are strongly contrasted between the layers a site specific calibration of the m r θ r using the proposed simplified finite element approach might be justified 8 summary and conclusions this paper proposes a site specific p y m r θ r framework for the design of laterally loaded monopiles in soft clay the lateral soil resistance above the rotation point is represented by distributed p y springs while the soil resistance below the rotation point is lumped into a concentrated m r θ r spring the p y model proposed by zhang and andersen 2017 which scales the p y curves from the stress strain response of the soil is adopted to capture the distributed soil resistance above the rotation point special attention is paid on the construction of the m r θ r spring from the site specific stress strain response and the undrained shear strength profile based on the combined analytical analyses and an extensive parametric finite element study the following conclusions can be drawn 1 the ultimate moment capacity m r ult of the m r θ r curves is the sum of the moment resistance due to the scoop failure surface and side shear a closed form solution of m r ult is proposed in this study through an upper bound analysis which is a function of pile diameter the pile length below the rotation point and soil strength profile 2 the shape of m r θ r curves bear strong similarities to the soil stress strain curves a soil with stiffer stress strain response results in stiffer m r θ r response when the pile length below the rotation point increases the m r θ r response becomes gradually softer while the soil strength heterogeneity exhibits negligible impact on it 3 the m r θ r response can be well scaled from the stress strain response of the soil by introducing two scaling factors applied to the elastic and plastic components of the shear stain these two factors show an approximately linear relationship with h d 4 with the proposed site specific p y m r θ r model soil reaction curves for monopile analysis can be readily constructed based on the stress strain response of the soil measured in routine soil element tests and shear strength profile established from site characterisation this provides practising engineers with a simple yet powerful approach to use site specific soil reaction curves in monopile design 5 validations against finite element analyses and centrifuge pile load tests demonstrate the satisfactory predictive capabilities of the proposed model on the other hand the conventional api p y model is proven to significantly underestimate the pile stiffness and capacity the adoption of the proposed model has large potential for achieving safer and more optimized monopile designs credit authorship contribution statement yongqing lai conceptualization methodology validation investigation writing original draft lizhong wang conceptualization methodology writing review editing youhu zhang conceptualization methodology writing review editing yi hong conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the authors gratefully acknowledge the financial support provided by national key research and development program of china 2018yfe0109500 national natural science foundation of china 51939010 and 51779221 the key research and development program of zhejiang province 2018c03031 and joint fund of ministry of education for pre research of equipment 6141a02022137 
