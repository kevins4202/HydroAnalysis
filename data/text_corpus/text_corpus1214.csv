index,text
6070,a new numerical method was developed to accurately and efficiently compute a solution of the nonlinear richards equation with a layered soil in the proposed method the kirchhoff integral transformation was applied however in the kirchhoff integral transformation approach the transformed kirchhoff head has dyadic characteristics at the material interface between different soil types to avoid the dyadic characteristics at the material interface a truncated taylor series expansion was applied to the kirchhoff head at the material interface and so the kirchhoff head was replaced with a single pressure head value at the material interface accordingly through the taylor series expansion a set of algebraic equations in the one dimensional control volume finite difference discretized system formed a tridiagonal matrix system through a series of numerical experiments the new method was compared to other numerical methods to determine its superiority the results clearly demonstrated that the approach was not only more computationally efficient but also more accurate and robust than other numerical methods computational performance was greatly enhanced with the proposed method and which could be used to simulate complicated heterogeneous flow at a large scale watershed or regional scale keywords nonlinear richards equation variably saturated flow kirchhoff integral transformation layered soil gardner constitutive relation 1 introduction the prediction of fluid movement in unsaturated soil is an important problem in many branches of science and engineering in all studies of the unsaturated zone fluid motion is assumed to obey the classical nonlinear richards equation hillel 1980 the nonlinear richards equation in variably saturated porous media needs to be solved numerically with constitutive relations heterogeneities irregular geometries and complex boundary conditions however because of nonlinearity determined based on the constitutive relations of fluid pressure saturation and relative permeability williams et al 2000 ji et al 2008 farthing and ogden 2017 zeng et al 2018 and the mathematical characteristics of the nonlinear richards equation changing from its hyperbolic form to its parabolic form there are many difficulties encountered in solving the nonlinear richards equation depending on the degree of saturation in the solution domain for example when the constitutive relation is highly nonlinear and the current state is very different from the solution state the size of the time step should be limited for transient simulations of variably saturated flow to make the iterative procedures converge and to preserve small changes in saturation or the pressure head in any part of the domain during the time step such inherent difficulties in solving the richards equation have severely limited its various applications including coupled surface and subsurface water movement problems which simultaneously simulate subsurface water flow in the unsaturated and saturated zones as well as complex regional scale problems describing groundwater flow around a high level nuclear waste repository and water budget calculations in a watershed many numerical solution strategies have been suggested to efficiently solve the equation such as picard or newton raphson iterative techniques together with finite difference or finite element approximations primary variable switching between the pressure head and water content upstream weighting of the relative permeability method of lines and transformation techniques celia et al 1990 kirkland et al 1992 tocci et al 1997 williams et al 2000 matthews et al 2004 ji et al 2008 zha et al 2017 zeng et al 2018 zhang et al 2015 2016 2018 li et al 2016 the most popular numerical methods for solving the nonlinear richards equation have the h based form they can be used for saturated and unsaturated soils as well as for layered soils however these methods suffer from poor mass balance for unsaturated soils and from unacceptable time step limitations or poor central processing unit cpu efficiency especially for very dry initial conditions bouloutas 1989 and celia et al 1990 greatly improved the performance of h based methods using a mixed form of the richards equation the strategy used by celia et al 1990 was to evaluate the change in water content over one time step directly from the change of the pressure head this results in much improved mass balance however as shown by kirkland et al 1992 cpu efficiency is still a problem in h based methods under very dry initial conditions numerical methods of the θ based form of the nonlinear richards equation result in a significantly improved performance when modeling infiltration into very dry soil hills et al 1989 kirkland et al 1992 forsyth et al 1995 zha et al 2013 unfortunately θ based methods cannot be used for simulating water flow in soils with saturated regions to retain the advantages of the θ based method wu and forsyth 2001 kirkland et al 1992 and zeng et al 2018 combined the θ and h based methods kirkland et al 1992 defined a new variable ϕ to transform the richards equation which is a linear function of the water content if soil is unsaturated and of the pressure head if soil is at or near saturation the method results in very good cpu efficiency particularly under relatively dry initial conditions williams et al 2000 however in this method a user should define a value of h 0 the point at which the h and θ based portions of the method are joined which may significantly affect the accuracy and robustness of the numerical results but this is difficult to determine a priori if h 0 is too close to saturation to improve the mass balance at the nodes close to saturation the numerical results will produce oscillations kirkland et al 1992 but if h 0 is too distant from saturation the accuracy will be decreased and mass balance errors will be introduced at the transition between the saturated and unsaturated zones in addition the kirkland method uses a partially explicit method and therefore does not have a monotone unless δ t δ x is sufficiently small another well known numerical method used to solve the nonlinear richards equation is the kirchhoff integral transformation approach haverkamp et al 1977 campbell 1985 vauclin et al 1979 ross and bristow 1990 williams et al 2000 ji et al 2008 berninger et al 2011 zhang et al 2015 2016 2018 li et al 2016 pan and wierenga 1995 pointed out that the integral in the kirchhoff transformation is in general difficult to evaluate unless special numerical interpolation methods are used williams et al 2000 introduced a second integral transform which was defined as a linear combination of θ an arbitrary parameter β and the kirchhoff integral transform they demonstrated that the second integral transform approach had very good efficiency and robustness compared to other transformation approaches which are defined in terms of θ kirkland et al 1992 the hyperbolic sine function of h ross 1990 and a rational function of h pan and wierenga 1995 for a wide range of medium properties and discretization levels however a parameter β included in the second integral transform approach must be specified but is difficult to estimate a priori as a function of medium and simulation variables williams et al 2000 recently zhang et al 2015 first introduced finite analytic method fam which applied for kirchhoff transform to solve unsaturated flow equation the fam used a local analytic solution to form a set of algebraic equations on the kirchhoff transformed variable they showed that from numerical experiments fam is very accurate and efficient compared with other numerical methods zhang et al 2016 applied the fam to the mixed form richards equation zhang et al 2018 extended the fam to apply for solving the two dimensional richards equation however all problems solved by using the fam mentioned above were limited to only homogeneous media ji et al 2008 compared a steady state solution obtained from the kirchhoff integral transformation approach to a steady state solution obtained from a time marching scheme using the transient h based method because the direct steady state solution using the h based method failed to converge their results showed that the kirchhoff integral transformation in a variably saturated region could simulate the pressure head and saturation distributions reasonably well and determine the water table distribution in complex regional scale problems for arbitrarily constitutive relations they also showed that it can enhance the computational performance by several orders of magnitude compared to a time marching scheme using the transient h based method since ji et al 2008 performed a full linearization of the unsaturated richards equation using gardner constitutive relations the computational cost in unsaturated flow simulation can be greatly reduced so that the kirchhoff integral transformation has practical implications for efficiently solving coupled surface and subsurface water problems or variably saturated flow problems at the watershed or regional scale however ji et al 2008 only considered pseudo heterogeneous layered porous media instead of true heterogeneous layered porous media here the pseudo heterogeneous layered porous media was described as follows the hydraulic conductivities of each layer differ but a soil index parameter λ residual water content θ r and saturated water content θ s in the soil water retention function are identical in all layers in addition ji et al 2008 did not extend their algorithm to a transient variably saturated flow problem but instead limited it to steady state conditions until now the kirchhoff transformation seems to be very promising method for simulating unsaturated richards equation because variations of kirchhoff head in its integral nature are much smaller than those in pressure head so that numerical errors can be reduced effectively although some it s limitations mentioned above exist especially when the kirchhoff transformation is employed to solve nonlinear richards equation based on specific constitutive relation such as gardner relation a full linearization of the unsaturated richards equation is allowed this linearization has enabled analytic and semi analytic solutions and stochastic analysis to be found for many unsaturated flow problems pullan 1990 srivastava and yeh 1991 ameli et al 2013 merrill et al 1978 read and broadbridge 1996 lu and zhang 2004 philip 1986a b 1989 basha 1994 2000a b bakker and nieber 2004a b teng et al 2016 li et al 2016 friedman and gamliel 2019 despite of widespread popular use of the gardner constitutive relations some people noted that exponential dependence of hydraulic conductivity on pressure head may not be representative of the full moisture range in real soils philip 1984 khaleel and relyea 2001 and so applicability of gardner model is limited compared to brooks corey and van genuchten models which well reproduce measured relationship between hydraulic conductivity and pressure head over entire range of pressure head nevertheless merrill et al 1978 found from their experimental and analytical studies that an exponential hydraulic conductivity and pressure head relationship is reasonable for natural heterogeneous soil profile taghavi et al 1985 compared numerical results using the exponential hydraulic conductivity and pressure head relationship to the experiment results of merrill et al 1978 and thus they concluded that the exponential relationship can be applied for adequately predicting transient movement in heterogeneous soil profiles in two dimensions khaleel and relyea 2001 showed from their experimental studies that the gardner model with variable soil index parameters is appealing because of adequate representation of hydraulic conductivity for gravelly soils and within some ranges of pressure head bakker and nieber 2004b found out from their analytical studies that the gardner relations is accurate for simulating steady state unsaturated flow when the exponential conductivity function adequately represents the unsaturated hydraulic conductivity over the entire range of pressures experienced within the flow region ji et al 2008 showed that using equivalence formula among van genuchten mulaem mualem 1976 van genuchten 1980 brooks corey 1964 and gardner constitutive relations gardner 1958 russo 1988 calculated pressure head profiles and calculated water table elevations for each constitutive relations are very similar each other and thus they proved the applicability of gardner relations in their problem braester 1973 developed analytical solution using gardner relations and obtained finite element results with experimental soil properties in one dimensional infiltration problem and then compared both solutions each other which leads to conclusion that the variation of moisture content at the soil surface and the location of wetting front calculated using the analytical solutions were predicted quite accurately ben asher et al 1978 compared numerical solution of the richards equation and full linearized analytical solution based on the gardner relation using experimental hydraulic data for sinai sand for water flow from a point source they found out that both models predict nearly the same averages and ranges of moisture content throughout the soil and so the linearized solutions give reasonable approximations to some nonlinear problems lastly there is famous excerpt from philip 1969 p 256 used by many researchers in their justification of use of gardner constitutive relations which is as follows even though it cannot be claimed that gardner equation is universally exact it does model in a reasonably convincing way the quite generally observed rapid and nonlinear decrease of hydraulic conductivity and pressure head besides there are many experimental k h curves in the literature that support use of gardner constitutive relations dirksen 1978 although the gardner constitutive relation has the practical applicability in a real problem as mentioned above many people have more popularly used brooks corey and van genuchten relations rather than the gardner relation accordingly in order to extend the applicability of the proposed method in this study to the brooks corey and van genuchten relations various conversion techniques between van genuchten brooks corey and gardner functions will be introduced ma et al 1999 rucker et al 2005 morel seytoux et al 1996 zhu et al 2004 ji et al 2008 discussion on these conversion methods can be found out in detail in section 6 the purpose of this study was to demonstrate a full linearization of the richards equation with gardner constitutive relations using the kirchhoff integral transformation in steady and transient variably saturated flows as well as within true heterogeneous layered porous media and to show that the integral transformation approach is not only more computationally efficient but also more accurate than other existing numerical methods e g the h based method celia method celia et al 1990 kirkland method kirkland et al 1992 fam zhang et al 2015 and 3dfemwater downloaded from https www epa gov ceam 3dfemwater3dlewaste and modified to consider the gardner relations in the subroutine sprop furthermore the proposed numerical algorithm was shown to be able to handle the discontinuity of the kirchhoff head at the material interface for applications in true heterogeneous layered porous media 2 mathematical formulation the richards equation describing fluid flow in variably saturated porous media is given by 1a k s k r h z θ t 1b q k s k r h z where q lt 1 is the fluid flux k s lt 1 is the saturated hydraulic conductivity tensor k r is the relative permeability as a scalar function of the pressure head h l or the water content θ l3l 3 z l is the vertical coordinate positive downward and t t is time the primary variable used to solve eq 1a is often taken to be the pressure head h and constitutive relations must be established that relate the primary unknown h to the secondary variables θ and k r the van genuchten mualem mualem 1976 van genuchten 1980 and brooks corey constitutive relations brooks and corey 1964 have been widely accepted while the gardner and gardner russo relations gardner 1958 russo 1988 have also been applied in many analytical and numerical approaches due to their simple nature in this study only the gardner constitutive relations were used to solve transient flow in variably saturated porous media with a heterogeneous layered system in the gardner constitutive relations the water content and relative permeability are given as simple exponential functions of the pressure head as follows 2a θ θ r θ s θ r e λ h θ s for f o r h 0 h 0 2b k r e λ h 1 for f o r h 0 h 0 where θ s θ r and λ represent the saturated water content l3l 3 residual water content l3l 3 and a soil index parameter l 1 related to the pore size distribution respectively the boundary conditions for eq 1a are generally given as 3a h h db on γ 1 3b n k s k r h q nb on γ 2 3c n k s k r h z q cb on γ 3 where n is an outward unit vector normal to the boundary and h db q nb and q cb are the specified head l along γ 1 specified pressure head normal gradient lt 1 on γ 2 and prescribed fluid flux lt 1 normal to γ 3 respectively with γ γ 1 γ 2 γ 3 being the boundary of the domain the kirchhoff integral transformation is defined as 4 ϕ h h k r s d s where ϕ h is a transform variable or a kirchhoff head l eq 1a can now be transformed assuming incompressibility of soil media as 5a k s ϕ k r k s z λ θ s θ r ϕ t when h 0 5b k s ϕ k s z 0 when h 0 using the gardner relations 2b the transformation 4 results in 6 ϕ h 1 λ e λ h 1 λ h for f o r h 0 h 0 substituting 6 into 5 the governing equation is fully linearized as follows 7a k s ϕ ϕ λ k s z λ θ s θ r ϕ t when ϕ 1 λ 7b k s ϕ k s z 0 when ϕ 1 λ here eqs 7a and 7b are governing equations that are fully linearized with the primary variable ϕ h for the unsaturated and saturated zones respectively for convenience eqs 7a and 7b can be expressed as follows 8 c ϕ t k s ϕ d ϕ g where 9a c λ θ s θ r when ϕ 1 λ 0 when ϕ 1 λ 9b d k s λ z when ϕ 1 λ 0 when ϕ 1 λ 9c g 0 when ϕ 1 λ k s z when ϕ 1 λ where c d θ dh dh d ϕ is the transformed specific moisture capacity function l 1 d is related to the gravity driven flux term in the unsaturated zone t 1 and g represents the gravity driven flux term in the saturated zone lt 1 as indicated in eqs 9a 9c the parameters of c d and g are determined depending on ϕ eq 8 is subject to the transformed boundary condition 10a ϕ h db ϕ db o n γ 1 10b n k s ϕ q nb on γ 2 10c n k s ϕ d ϕ g q cb on γ 3 where ϕ h db is a known value determined from eq 6 using the dirichlet head h db finally the darcy flux can be expressed using the kirchhoff head as follows 11 q k s ϕ d ϕ g 3 numerical implementation the governing equation obtained from the kirchhoff integral transformation can be rewritten by substituting eq 11 into eq 8 as follows 12 c ϕ t q here to show the derivation of the numerical formulation for eq 12 layered soil is assumed and grids are placed at the material interface and cell boundaries so that the medium between neighboring grids is always homogeneous while the grids situated at the material interface are subjected to two different soils as shown in fig 1 a and b accordingly the control volume of grid i contains two kinds of soils because grid i is located at the layer interface as shown in fig 1a and b consequently the kirchhoff head ϕ at the interface grid should be described with dyadic properties because two different values of the kirchhoff head ϕ are associated with the two different soil parameters λ i 1 2 and λ i 1 2 which are soil index parameters related to the pore size distribution at cell i 1 2 and i 1 2 within the control volume of grid i respectively although h is a single value parameter over the control volume of grid i the water balance equation in the control volume of grid i can then be written based on eq 12 as c i i 1 2 ϕ h i n 1 m 1 λ i 1 2 ϕ h i n λ i 1 2 δ t n 1 δ z i 1 2 2 13 c i i 1 2 ϕ h i n 1 m 1 λ i 1 2 ϕ h i n λ i 1 2 δ t n 1 δ z i 1 2 2 q i 1 2 q i 1 2 where the superscript n represents the old time level while m represents the previous iteration level h i n 1 m 1 is the pressure head on grid i at the new time level n 1 and current iteration level m 1 h i n is the pressure head on grid i at the old time level n δ t n 1 t n 1 t n is the size of the time step at the new time level n 1 δ z i 1 2 z i z i 1 and δ z i 1 2 z i 1 z i represent the lengths of cells i 1 2 and i 1 2 respectively and q i 1 2 and q i 1 2 are the flux into the control volume of grid i and the flux out of the control volume of grid i at the intermediate time level respectively the superscript represents the intermediate time level depending on the time derivative weighting factor w w 0 explicit method w 0 5 crank nicolson method and w 1 0 fully implicit method ϕ h i n 1 m 1 λ i 1 2 and ϕ h i n 1 m 1 λ i 1 2 are the dyadic kirchhoff heads from eq 6 on grid i with λ i 1 2 and λ i 1 2 at the new time level and current iteration level respectively in addition ϕ h i n λ i 1 2 and ϕ h i n λ i 1 2 are the dyadic kirchhoff heads on grid i at the old time level n here c i i 1 2 and c i i 1 2 are the transformed specific moisture capacities at cells i 1 2 and i 1 2 within the control volume of grid i determined from ϕ h i λ i 1 2 and λ i 1 2 and ϕ h i λ i 1 2 and λ i 1 2 at the intermediate time levels respectively and ϕ h i λ i 1 2 and ϕ h i λ i 1 2 are the kirchhoff heads on grid i at the intermediate time level as follows 14a ϕ h i λ i 1 2 w ϕ h i n 1 m λ i 1 2 1 w ϕ h i n λ i 1 2 14b ϕ h i λ i 1 2 w ϕ h i n 1 m λ i 1 2 1 w ϕ h i n λ i 1 2 from eq 9a c i i 1 2 and c i i 1 2 can be defined as follows 15a c i i 1 2 λ i 1 2 θ s i 1 2 θ r i 1 2 when ϕ h i λ i 1 2 1 λ i 1 2 0 when ϕ h i λ i 1 2 1 λ i 1 2 15b c i i 1 2 λ i 1 2 θ s i 1 2 θ r i 1 2 when ϕ h i λ i 1 2 1 λ i 1 2 0 when ϕ h i λ i 1 2 1 λ i 1 2 where θ r i 1 2 and θ r i 1 2 are the residual water contents of cells i 1 2 and i 1 2 respectively and θ s i 1 2 and θ s i 1 2 are the saturated water contents of cells i 1 2 and i 1 2 respectively in addition q i 1 2 and q i 1 2 are shown in fig 1a and b which can be obtained from eq 11 as follows 16a q i 1 2 k s i 1 2 w ϕ i 1 n 1 m 1 ϕ h i n 1 m 1 λ i 1 2 δ z i 1 2 1 w ϕ i 1 n ϕ h i n λ i 1 2 δ z i 1 2 w d i 1 i 1 2 n 1 ϕ i 1 n 1 m 1 d i i 1 2 n 1 ϕ h i n 1 m 1 λ i 1 2 2 1 w d i 1 i 1 2 n ϕ i 1 n d i i 1 2 n ϕ h i n λ i 1 2 2 g i 1 i 1 2 g i i 1 2 2 16b q i 1 2 k s i 1 2 w ϕ h i n 1 m 1 λ i 1 2 ϕ i 1 n 1 m 1 δ z i 1 2 1 w ϕ h i n λ i 1 2 ϕ i 1 n δ z i 1 2 w d i i 1 2 n 1 ϕ h i n 1 m 1 λ i 1 2 d i 1 i 1 2 n 1 ϕ i 1 n 1 m 1 2 1 w d i i 1 2 n ϕ h i n λ i 1 2 d i 1 i 1 2 n ϕ i 1 n 2 g i i 1 2 g i 1 i 1 2 2 where k s i 1 2 and k s i 1 2 are the saturated hydraulic conductivity of cells i 1 2 and i 1 2 respectively and ϕ i 1 n 1 m 1 and ϕ i 1 n 1 m 1 are the kirchhoff heads at grids i 1 and i 1 at the new time level and current iteration level respectively it should be noted that ϕ i 1 n 1 m 1 and ϕ i 1 n 1 m 1 are not dyadic values because the neighboring areas of the respective grids i 1 and i 1 are homogeneous ϕ i 1 n and ϕ i 1 n are the kirchhoff heads at grids i 1 and i 1 at the old time level respectively d i 1 i 1 2 n 1 and d i i 1 2 n 1 are associated with the gravity driven flux terms in the unsaturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the new time level n 1 respectively d i i 1 2 n 1 and d i 1 i 1 2 n 1 are parameters related to gravity driven flux terms in the unsaturated zone at cell i 1 2 within the control volume of grid i and at cell i 1 2 within the control volume of grid i 1 at the new time level respectively similarly d i 1 i 1 2 n d i i 1 2 n d i i 1 2 n and d i 1 i 1 2 n are associated with the gravity driven flux terms at the old time level g i 1 i 1 2 and g i i 1 2 represent the gravity driven flux terms in the saturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the intermediate time level respectively and g i i 1 2 and g i 1 i 1 2 represent the gravity driven flux terms in the saturated zone at cell i 1 2 within the control volume of grid i and at cell i 1 2 within the control volume of grid i 1 at the intermediate time level respectively the aforementioned parameters are defined in supplementary section 1 in eqs 16a and 16b the second and third terms on the right hand side are obtained using the arithmetic spatial average the fourth term is also obtained using the arithmetic spatial average substituting eqs 16a and 16b into eq 13 using a truncated taylor series expansion eq 13 can be rewritten as follows 17 a i ϕ i 1 n 1 m 1 b 1 i c 1 i h i n 1 m 1 d i ϕ i 1 n 1 m 1 e 1 i where the definitions of a i b 1 i c 1 i d i and e 1 i can be found out in appendix a in addition the detail derivation of eq 17 can be found out in appendix a if the soils on both sides of the interface are the same as each other eq 17 can be rewritten since λ i 1 2 λ i 1 2 and ϕ i n 1 m 1 ϕ h i n 1 m 1 λ i 1 2 ϕ h i n 1 m 1 λ i 1 2 as follows 18 a i ϕ i 1 n 1 m 1 b i c i ϕ i n 1 m 1 d i ϕ i 1 n 1 m 1 e i where the definitions of b i c i and e i can be found out in appendix a similarly at grids i 1 and i 1 in the neighborhood of the material interface detail derivation of discretized equation can be found out in appendix b for application of various boundary conditions to eqs 17 and 18 these equations should be changed according to types of boundary conditions such as dirichlet neumann and cauchy boundary conditions in cases where either the top or bottom boundaries are specified as the dirichlet boundary according to eq 10a either ϕ 0 n 1 m 1 or ϕ n n 1 m 1 becomes ϕ db accordingly when the top boundary is specified the discretized equation corresponding to the top boundary will be removed and the system of equations to be solved will be reduced by one having any number of primary variables of n rather than n 1 simultaneously e 1 in eq 18 should be changed to e 1 a 1 ϕ db similarly when the bottom boundary is specified the discretized equation corresponding to the bottom boundary will be removed and e n 1 in eq 18 will be changed to e n 1 d n 1 ϕ db similarly in cases where the bottom boundary is specified as either the neumann boundary or cauchy boundary according to either eq 10b or eq 10c respectively the discretized equation should be manipulated to incorporate corresponding boundary conditions the detail of manipulation can be found out appendix c 4 verification wetting scenario example of two layered soil in example 2 of srivastava and yeh 1991 was used to verify the proposed numerical method by comparing numerical results obtained using the proposed method against analytical solution of srivastava and yeh 1991 in this example λ of the two layers were identically set to be 0 1 cm 1 and the saturated hydraulic conductivities of the lower and upper layers were equal to 1 and 10 cm h respectively the thickness of each layer was 100 cm the saturated and residual water contents were taken to as 0 4 and 0 06 respectively the initial pressure head profile was the steady state profile at an infiltration rate equal to 0 1 cm h then at simulation time greater than 0 the infiltration rate was suddenly increased to 0 9 cm h fig 2 shows the pressure profile heads at several times obtained using the proposed method and analytical solutions of srivastava and yeh 1991 as shown in fig 2 the results are exactly same each other it should be noted that since the analytical solution of srivastava and yeh 1991 can only consider the same λ for layered soil we showed only problem considering pseudo heterogeneity media which can analyze only the effect of discontinuous saturated hydraulic conductivity on the moisture movement rather than discontinuous soil parameters such as λ θ r and θ s 5 examples and results the accuracy and efficiency of the proposed algorithm was evaluated by performing numerical experiments for three cases where a 1d homogenous soil a heterogeneous layered soil and a regional scale unsaturated saturated groundwater system were assumed respectively the numerical experiments were conducted by comparing the proposed method with other numerical methods or public software the methods used were the pressure head based method eq 6 in celia et al 1990 celia method eq 17 in celia et al 1990 kirkland method kirkland et al 1992 fam zhang et al 2015 3dfemwater downloaded from https www epa gov ceam 3dfemwater3dlewaste and modified to consider the gardner relations in the subroutine sprop kirchhoff integral transformation using a fully implicit method and kirchhoff integral transformation using the crank nicolson time differenced equation the finite difference equations 6 and 17 in celia et al 1990 were adopted for the pressure head approach and the celia method respectively on the other hand the finite difference equation 13 in the kirkland et al 1992 was employed for the kirkland method finally a set of algebraic equation 16 in zhang et al 2015 was used in the fam 5 1 example 1 one dimensional 1 d flow in a homogeneous soil in this example 1 d flow in homogeneous porous media was considered under three different scenarios the parameter values and initial and boundary conditions for the simulation are shown in fig 3 the three scenarios were established according to the initial conditions and bottom boundary conditions in all scenarios the top boundaries were set as the dirichlet boundary condition at a pressure head of 75 cm while at the bottom boundary pressure heads hdb s of 200 400 and 600 cm were assigned as the dirichlet boundary condition according to each different scenario as shown in fig 3 the initial pressure heads h 0 s were set to be exactly the same as the dirichlet boundary conditions on the bottom boundary with values of 200 400 and 600 cm assigned according to each different scenario as shown in fig 3 this means that different initial water contents in the soil column were assumed in each scenario the purpose of this study was to compare the computational accuracy and efficiency of the seven numerical methods over the range of initial water contents to illustrate the superiority of the proposed algorithm computational efficiency was evaluated on the basis of the cpu time consumed to achieve a given level of accuracy to evaluate the seven numerical methods over as a wide range of accuracy levels as possible the numerical methods were run repeatedly using a different fixed size time step δ t for each run the level of accuracy attained for each run was computed using the maximum difference between the exact and numerical solutions as shown in eq 19 19 ε δ t max z h z t final δ t h exact z t final t final 0 89 h r z δ z 2 δ z 40 c m we computed the maximum difference between the numerical solution h and an exact solution h exact measured at the final simulation time t final in this test problem to obtain the exact solution we used a numerical solution that very accurately solved the kirchhoff integral transformation method using the crank nicolson time difference scheme based on a very fine grid and very small time steps as a surrogate of h exact for calculation of the maximum difference in eq 19 the reason why the kirchhoff integral transformation method was used to obtain a base case solution is that the method is stable and mass conserved the celia and kirkland methods are not stable and the pressure head based method and 3dfemwater are not mass conserved which will be illustrated later we also recorded the cpu time used for each run the simulations were performed on a pc with a pentium processor 3865u 1 8 ghz 2 mb l3 cache evaluating efficiency over a wide range of accuracy levels enabled us to draw conclusions regarding the comparative performance of the seven numerical methods varying the time step size for each run of the test problem also allowed us to make some observations about the stability of the different methods the pressure head profiles computed using all seven numerical methods for the three scenarios are shown in fig 4 here solutions from all seven methods were obtained under all three different initial conditions using the same grid size and time step of 0 01 cm and 0 001 h respectively under the initial pressure head of 200 cm the numerical solutions from all seven methods could not be visibly distinguished from the exact solution as shown in fig 4 this means that the solutions from all seven methods were reasonably well matched with the exact solution however the celia method failed to produce a converged solution at the initial pressure head of 300 cm and lower while the kirkland method failed to produce converged solutions at an initial pressure head of 400 cm and lower as shown in fig 4 in contrast the solutions obtained from the pressure head based method fam 3dfemwater kirchhoff integral transformation using a fully implicit method and kirchhoff integral transformation using the crank nicolson time differenced equation matched the exact solution reasonably well at initial pressure heads of 400 and 600 cm as shown in fig 4 therefore it appears that the celia and kirkland methods were conditionally stable for the limited initial condition as kirkland et al 1992 and celia et al 1990 noted this could be attributed to the fact that the kirkland method uses a partially explicit scheme and therefore does not have a monotone unless δ t δ x is sufficiently small and the iteration number of the celia method is significantly increased in very dry soil and thus the celia method may not reach convergence in very dry soil accordingly our numerical result was consistent with previous findings fig 5 shows plots of the maximum differences calculated using eq 19 for all seven numerical methods against time steps with a range of 0 001 0 5 h this plot enables numerical accuracy to be compared between different methods when the size of the time step is given the kirchhoff integral transformation method using the crank nicolson time differenced equation produced the most accurate solutions among the methods tested at time steps of less than 0 1 h from the slopes of the accuracy curves in fig 5 it can be seen that all methods except the kirchhoff integral transformation method using the crank nicolson time differenced equation were approximately first order accurate while the kirchhoff integral transformation method using the crank nicolson time differenced equation was approximately o δ t 2 accurate in order to compare the performance of the seven numerical methods regarding efficiency cpu time consumed to achieve a certain level of accuracy was plotted versus maximum difference in fig s1 in supplementary section 2 in addition the detail discussion can be found out in supplementary section 2 5 2 example 2 one dimensional flow in a heterogeneous layered soil the 1 d vertical flow in a true heterogeneous layered soil column was considered as shown in fig 6 the soil configuration soil thickness soil properties and boundary conditions were adapted from case 3 in ji et al 2008 where the soil column consisted of three layers with thicknesses of 50 50 and 100 cm from the bottom to the top respectively the k s of the bottom middle and top layers was set to 10 1 and 10 cm h respectively and the θ s and θ r were set to 0 368 and 0 102 respectively for all three layers the λ of the bottom middle and top layers was set to 0 1 0 2 and 0 1 cm 1 respectively which differed from ji et al 2008 where all λ s were 0 1 cm 1 this means that ji et al 2008 considered pseudo heterogeneous layered soils in their problem but in the example in the present study a true heterogeneous layered soil was investigated because soil properties such as λ θ s and θ r were allowed to vary with soil type as in case 3 in ji et al 2008 the pressure head of 0 cm was specified at the bottom and a prescribed flux of 0 1 cm h was imposed at the top in this example to compare the accuracy and efficiency of the proposed algorithm with others three scenarios were designed according to the initial conditions with the respective initial pressure heads h 0 s of 50 150 and 200 cm as shown in fig 6 differently from example 1 fam was not employed here due to its incapability of dealing with water flow in heterogeneous media in the case of the celia pressure head based and kirchhoff methods the time stepping strategy followed the automatically adaptive time step scheme in which if the number of iterations is less than five the size of time step will be increased by a factor of from 1 00001 to 1 1 depending on the scenario but if the number of iterations is greater than 10 the size of the time step will be decreased by a factor of 0 3 however the kirkland method used a slightly different adaptive time step scheme where if the number of iterations was less than 5 the size of the time step size will be increased by a factor of 1 000001 regardless of the scenario but if the number of iterations is greater than 10 the size of the time step will be decreased by a factor of 0 3 unlike the automatic time stepping strategy 3dfemwater used an initial time step of 0 00001 h time step multiplier of 1 1 and maximum time step of 0 1 h to measure the ability of the simulator to conserve mass we defined a mass balance measure as follows 20 mb t 1 0 total additional mass in the domain total net flux into the domain where the additional mass is measured with respect to the initial mass in the system and then the mass balance can be calculated as follows allen and murphy 1985 1986 celia and pinder 1986 celia et al 1987 1990 shahraiyni and ataie ashtiani 2012 21 m b t 1 0 i 1 n 1 θ i n 1 θ i 0 δ z i 1 2 2 δ z i 1 2 2 j 1 n 1 k n 1 2 j h n j h n 1 j δ z n 1 2 1 k 1 2 j h 1 j h 0 j δ z 1 2 1 δ t j fig 7 a shows the pressure head with elevation at various times obtained from all numerical methods at the initial pressure head of 50 cm for all numerical methods very good agreement was obtained with the exact solution at the initial pressure head of 150 cm the simulation result obtained from the kirkland method is only shown at the early time of 0 89 h in fig 7b due to the excessive computational cpu time furthermore the results from the kirkland method and 3dfemwater deviated greatly from the exact solution in the vicinity of the material interface at the early time of 0 89 h when soil was drier because the kirkland method incurs an enormous computational expense we did not perform a numerical simulation with the kirkland method at the initial pressure head of 200 cm accordingly the results from the kirkland method did not appear at the initial pressure head of 200 cm as shown in fig 7c in addition at the initial pressure head of 200 cm the results from 3dfemwater deviated much greatly from the exact solution in the vicinity of the material interface at the early time of 0 89 h evaluating the performance of the proposed method including the kirchhoff approaches using a fully implicit method and the crank nicolson scheme with regard to efficiency and accuracy the proposed method was found to have the best performance because the mass balance error of the proposed method was 8 orders of magnitude smaller than that of any other method as shown in fig 8 and table 1 regarding the computational efficiency the detail discussion can be found out in supplementary section 3 5 3 example 3 application to regional scale unsaturated saturated groundwater system in order to show the applicability of the proposed method to regional scale or watershed unsaturated saturated groundwater system a hypothetical regional aquifer system was considered this hypothetical example was designed to be characterized by regional scale groundwater flow in multi layer aquifer with complex geometry in order to simulate regional groundwater flow in this example the 1d proposed method was straightforwardly extended to 3d numerical model by using a finite element approach also in order to assess the accuracy of the 3d proposed model the analytical solution of ameli et al 2013 where a steady state unsaturated saturated groundwater flow in two dimensional stratified aquifer cross section of the regional scale groundwater system was solved with series solutions was employed to compare numerical solutions the analytical solution was developed by minimizing head and flow continuity errors at a set of control points along interfaces between layers ameli et al 2013 as shown in fig 9 a the two dimensional cross section in aquifer system with five layers has the irregular interface geometry between layers as well as undulating boundaries of bottom and top although the proposed method has the capability of simulating groundwater flow in an anisotropic true heterogeneous aquifer in a transient situation the hypothetical example is assumed to have identical soil index parameters for all layers and to have isotropic saturated hydraulic conductivities because analytical solutions can account for only pseudo heterogeneous and isotropic systems under steady state flow condition the saturated hydraulic conductivity used are 1 15 m day 2 36 m day 1 07 10 3 m day 4 18 m day and 7 98 10 2 m day from top to bottom layers also λ θ r and θ s are identical for all five layers to 0 128 m 1 0 0 and 1 0 respectively the left right and bottom boundaries are specified as no flow condition while at the top surface dirichlet pressure head is assigned the developed 3d proposed model discretize the domain with 59 940 hexahedron elements and 122 000 nodes to simulate subsurface flow as shown in fig 9b in this discretization x and y directional sizes of element are set to be 2 m and 1 m respectively but z directional size ranges from 0 9 m to 5 9 m across the whole domain time step sizes are varied from 1 0 10 6 day to 5 0 10 2 day during simulation numerical solutions of hydraulic head and pressure head obtained at simulation time of 4 8 days which is considered to reach steady state using the 3d proposed numerical model are compared to the analytical solutions as shown in fig 10 a and 10b respectively as shown in fig 10a and 10b excellent agreements are shown between the numerical solutions and analytical solutions besides both water table locations which are defined as a curve with zero pressure head obtained through numerical and analytical solutions show perfect agreement each other to demonstrate capabilities of the new proposed method to efficiently solve regional scale unsaturated saturated groundwater flow problems the commercial 3dfemwater is also applied to this example using same spatial discretization adopted in the 3d proposed model and thus two results obtained from the proposed model and 3dfemwater are compared not shown here from the comparison we find out that 3dfemwater produces accurate solutions as the proposed model but computational time of 3dfemwater is about 50 times larger than that of the proposed model since cpu times of the proposed model and 3dfemwater are 594 3 s and 29 877 5 s respectively using a pc with a pentium processor 3865u 1 8 ghz 2 mb l3 cache therefore the proposed method can simulate very efficiently regional scale unsaturated and saturated groundwater flow under heterogeneous aquifer with complex geometry 6 discussion although the examples reported here successfully demonstrate the superiority of the proposed method over other methods regarding its efficiency and accuracy the proposed method is limited to only the gardner constitutive relations however the van genuchten and brooks corey relations are more widely employed in soil constitutive relations accordingly to retain the advantages of the proposed method using the gardner constitutive relation when the more commonly used van genuchten and brooks corey relations are adopted various conversion methods between the van genuchten brooks corey and gardner functions can be used ma et al 1999 rucker et al 2005 morel seytoux et al 1996 zhu et al 2004 ji et al 2008 these conversion methods were devised by preserving some characteristics of the relations e g identifying parameters that minimize differences between the soil water retention curves or ensuring that capillary length or effective capillary drive is preserved in each conversion method the respective formula for parameter equivalence between various constitutive relations was developed and the influence on predictions of various hydrological components and soil hydraulic properties such as water retention hydraulic conductivity runoff evapotranspiration infiltration rate and cumulative outflow was studied ma et al 1999 rucker et al 2005 morel seytoux et al 1996 zhu et al 2004 previous studies concluded that some conversion methods can reproduce the characteristics of certain constitutive functions well at some specified range of suction heads in particular ji et al 2008 demonstrated that by using the parameter equivalence formula of zhu et al 2004 the calculated water tables using the gardner van genuchten and brooks corey functions were similar thus previous studies indicated that it was possible to extend the new proposed algorithm to soils with arbitrary constitutive relations including the van genuchten and brooks corey functions for simulating the water content or pressure head distributions in variably saturated media these studies indicate that the algorithm proposed in this study is versatile when using arbitrary constitutive relations and thus the proposed algorithm is not only limited to the gardner function therefore through the use of a conversion method the kirchhoff transformed richards equation using the gardner constitutive relation has the ability to successfully simulate the distribution of soil water content or the pressure head 7 conclusions in this study a new method was proposed to modify the kirchhoff transformation approach for describing unsaturated and saturated groundwater flow in heterogeneous layered porous media because the new method follows the kirchhoff transformation approach using gardner constitutive relations the original nonlinear richards equation becomes fully linearized in terms of the kirchhoff head accordingly this new method is advantageous relative to existing numerical methods in terms of its numerical accuracy and efficiency because the new method solves a linearized partial differential equation while the other existing numerical methods solve a nonlinear partial differential equation this was apparent from the numerical experiment in example 1 however in heterogeneous layered soils because kirchhoff heads are discontinuous at the interface between two different materials the algebraic equation for a 1 d finite difference discretization associated with a grid located at the material interface will have four unknown variables rather than three this causes the number of unknown variables to be greater than the number of equations when the set of algebraic equations is formed for a 1 d finite difference discretization mathematically it is impossible to solve this assembled matrix system whose number of unknown variables is greater than the number of equations however the new method employed a truncated taylor series to deal with the discontinuity of the kirchhoff head at the interface between different materials with the result that the two different kirchhoff heads on each side of the interface can be replaced with a continuous single pressure head at the interface when a truncated taylor series is used the set of algebraic equations will form a tridiagonal matrix system because adoption of the taylor series expansion will decrease the number of unknown variables in the algebraic equation at the material interface by one therefore the new method can solve this tridiagonal system without any numerical difficulties using traditional matrix solvers such as the thomas algorithm or other advanced solvers moreover the numerical experiment in example 2 showed that for simulating variably saturated groundwater flow in heterogeneous layered porous media the performance of the proposed method including the kirchhoff approaches using a fully implicit method and using the crank nicolson scheme had the best performance because cpu times in the proposed method were from 2 to 4 orders of magnitude less than for other methods and the mass balance error of the proposed method was 8 orders of magnitude smaller than for any other methods finally from the application of regional scale unsaturated saturated groundwater system in example 3 we found out that this new method can be easily extended to a three dimensional case and thus there are implications of the new method for efficiently solving coupled surface and subsurface water problems or variably saturated flow problems in watersheds or large scale problems because of the very low computational cost declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported national institute of agricultural sciences rural development administration republic of korea grant no pj013392032019 appendix a detail derivation of eq 17 substituting eqs 16a and 16b into eq 13 eq 13 can be rearranged as follows a 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 1 2 ϕ i 1 n 1 m 1 c i i 1 2 δ t n 1 δ z i 1 2 2 w k s i 1 2 δ z i 1 2 d i i 1 2 n 1 2 ϕ h i n 1 m 1 λ i 1 2 c i i 1 2 δ t n 1 δ z i 1 2 2 w k s i 1 2 δ z i 1 2 d i i 1 2 n 1 2 ϕ h i n 1 m 1 λ i 1 2 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 1 2 ϕ i 1 n 1 m 1 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 2 ϕ i 1 n c i i 1 2 δ t n 1 δ z i 1 2 2 1 w k s i 1 2 δ z i 1 2 d i i 1 2 n 2 ϕ h i n λ i 1 2 c i i 1 2 δ t n 1 δ z i 1 2 2 1 w k s i 1 2 δ z i 1 2 d i i 1 2 n 2 ϕ h i n λ i 1 2 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 2 ϕ i 1 n g i 1 i 1 2 g i i 1 2 2 g i i 1 2 g i 1 i 1 2 2 eq a 1 can be further simplified as follows a 2 a i ϕ i 1 n 1 m 1 b i ϕ h i n 1 m 1 λ i 1 2 c i ϕ h i n 1 m 1 λ i 1 2 d i ϕ i 1 n 1 m 1 e i where a 3a a i w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 1 2 a 3b b i c i i 1 2 δ t n 1 δ z i 1 2 2 w k s i 1 2 δ z i 1 2 d i i 1 2 n 1 2 a 3c c i c i i 1 2 δ t n 1 δ z i 1 2 2 w k s i 1 2 δ z i 1 2 d i i 1 2 n 1 2 a 3d d i w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 1 2 a 3e e i 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 2 ϕ i 1 n c i i 1 2 δ t n 1 δ z i 1 2 2 1 w k s i 1 2 δ z i 1 2 d i i 1 2 n 2 ϕ h i n λ i 1 2 c i i 1 2 δ t n 1 δ z i 1 2 2 1 w k s i 1 2 δ z i 1 2 d i i 1 2 n 2 ϕ h i n λ i 1 2 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 2 ϕ i 1 n g i 1 i 1 2 g i i 1 2 2 g i i 1 2 g i 1 i 1 2 2 due to different types of soil on each side of the interface the kirchhoff head ϕ is discontinuous across the interface thus as shown in eq a 2 four unknowns occur in the algebraic equation at the control volume of grid i however noting that the pressure head h is a continuous single value across the material interface within the control volume of grid i the number of unknowns can be decreased to three by adopting the pressure head h on the interface as an unknown variable rather than dyadic values of the kirchhoff head ϕ this can be performed by changing the dyadic values of the kirchhoff head ϕ with the pressure head h using a truncated taylor series which is shown as follows a 4a ϕ h i n 1 m 1 λ i 1 2 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m 1 h i n 1 m a 4b ϕ h i n 1 m 1 λ i 1 2 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m 1 h i n 1 m where ϕ h i n 1 m λ i 1 2 and ϕ h i n 1 m λ i 1 2 are the dyadic values of the kirchhoff head at grid i with λ i 1 2 and λ i 1 2 at the new time and previous iteration levels respectively using eq 6 d ϕ dh i i 1 2 n 1 m and d ϕ dh i i 1 2 n 1 m can be written as follows a 5a d ϕ dh i i 1 2 n 1 m exp λ i 1 2 h i n 1 m when h i n 1 m 0 1 when h i n 1 m 0 a 5b d ϕ dh i i 1 2 n 1 m exp λ i 1 2 h i n 1 m when h i n 1 m 0 1 when h i n 1 m 0 here ϕ h i n 1 m λ i 1 2 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m and d ϕ dh i i 1 2 n 1 m in eq a 4a and a 4b are known because they are a function of the known h i n 1 m substituting eqs a 4a and a 4b into eq a 2 eq a 2 can be rearranged as follows a 6 a i ϕ i 1 n 1 m 1 b 1 i c 1 i h i n 1 m 1 d i ϕ i 1 n 1 m 1 e 1 i where a 7a b 1 i b i d ϕ dh i i 1 2 n 1 m a 7b c 1 i c i d ϕ dh i i 1 2 n 1 m a 7c e 1 i e i b i ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m c i ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m appendix b numerical formulations at grids i 1 and i 1 in the neighborhood of the material interface because the control volume of grid i 1 contains one kind soil as shown in fig 1b the kirchhoff head ϕ is continuous across the grid i 1 and therefore the kirchhoff head ϕ at the grid i 1 is not dyadic therefore the water balance equation within the control volume of grid i 1 can be written as b 1 c i 1 i 3 2 ϕ i 1 n 1 m 1 ϕ i 1 n δ t n 1 δ z i 3 2 2 c i 1 i 1 2 ϕ i 1 n 1 m 1 ϕ i 1 n δ t n 1 δ z i 1 2 2 q i 3 2 q i 1 2 where c i 1 i 3 2 and c i 1 i 1 2 are the transformed specific moisture capacities at cells i 3 2 and i 1 2 within the control volume of grid i 1 at the intermediate time level respectively q i 3 2 and q i 1 2 are the fluxes into and out of the control volume of grid i 1 at the intermediate time level respectively as follows b 2a q i 3 2 k s i 3 2 w ϕ i 2 n 1 m 1 ϕ i 1 n 1 m 1 δ z i 3 2 1 w ϕ i 2 n ϕ i 1 n δ z i 3 2 w d i 2 i 3 2 n 1 ϕ i 2 n 1 m 1 d i 1 i 3 2 n 1 ϕ i 1 n 1 m 1 2 1 w d i 2 i 3 2 n ϕ i 2 n d i 1 i 3 2 n ϕ i 1 n 2 g i 2 i 3 2 g i 1 i 3 2 2 b 2b q i 1 2 k s i 1 2 w ϕ i 1 n 1 m 1 ϕ h i n 1 m 1 λ i 1 2 δ z i 1 2 1 w ϕ i 1 n ϕ h i n λ i 1 2 δ z i 1 2 w d i 1 i 1 2 n 1 ϕ i 1 n 1 m 1 d i i 1 2 n 1 ϕ h i n 1 m 1 λ i 1 2 2 1 w d i 1 i 1 2 n ϕ i 1 n d i i 1 2 n ϕ h i n λ i 1 2 2 g i 1 i 1 2 g i i 1 2 2 it should be noted that ϕ i 1 n 1 m 1 and ϕ i 2 n 1 m 1 are continuous across grids i 1 and i 2 respectively because the soils at both sides of grids i 1 and i 2 are the same as shown in fig 1b respectively accordingly ϕ i 1 n 1 m 1 and ϕ i 2 n 1 m 1 are not dyadic values while the kirchhoff head ϕ at grid i is a dyadic value d i 2 i 3 2 n 1 and d i 1 i 3 2 n 1 are associated with gravity driven flux terms in the unsaturated zone at cell i 3 2 within the control volume of grid i 2 and at cell i 3 2 within the control volume of grid i 1 at the new time level n 1 respectively d i 1 i 1 2 n 1 and d i i 1 2 n 1 are associated with the gravity driven flux terms in the unsaturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the new time level n 1 respectively d i 2 i 3 2 n and d i 1 i 3 2 n are associated with the gravity driven flux terms in the unsaturated zones at cell i 3 2 within the control volume of grid i 2 and at cell i 3 2 within the control volume of grid i 1 at the old time level n respectively d i 1 i 1 2 n and d i i 1 2 n are associated with the gravity driven flux terms in the unsaturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the old time level n respectively g i 2 i 3 2 and g i 1 i 3 2 represent the gravity driven flux terms in the saturated zone at cell i 3 2 within the control volume of grid i 2 and at cell i 3 2 within the control volume of grid i 1 at the intermediate time respectively and g i 1 i 1 2 and g i i 1 2 represent the gravity driven flux terms in the saturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the intermediate time respectively substituting eqs b 2a and b 2b into eq b 1 and rearranging eq b 1 can be simplified as follows b 3 a i 1 ϕ i 2 n 1 m 1 b i 1 c i 1 ϕ i 1 n 1 m 1 d i 1 ϕ h i n 1 m 1 λ i 1 2 e i 1 where a i 1 b i 1 c i 1 d i 1 and e i 1 are exactly the same as in eqs a 3a a 3b a 3c a 3d and a 3e in appendix a as long as subscript i is changed into subscript i 1 in eq b 3 ϕ h i n 1 m 1 λ i 1 2 can be changed into h i n 1 m 1 using eq a 4a finally eq b 3 can be expressed as follows b 4 a i 1 ϕ i 2 n 1 m 1 b i 1 c i 1 ϕ i 1 n 1 m 1 d 1 i 1 h i n 1 m 1 e 2 i 1 where b 5a d 1 i 1 d i 1 d ϕ dh i i 1 2 n 1 m b 5b e 2 i 1 e i 1 d i 1 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m similarly the formulation of the discretized equation for grid i 1 can be derived as eq b 6 using the same procedure as above b 6 a 1 i 1 h i n 1 m 1 b i 1 c i 1 ϕ i 1 n 1 m 1 d i 1 ϕ i 2 n 1 m 1 e 3 i 1 where b 7a a 1 i 1 a i 1 d ϕ dh i i 1 2 n 1 m b 7b e 3 i 1 e i 1 a i 1 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m appendix c application of neumann and cauchy boundary conditions in cases where the bottom boundary is specified as the neumann boundary according to eq 10b the coefficients of the equation corresponding to the bottom boundary should be changed to incorporate the neumann boundary condition as follows c 1a a n w k s n 1 2 δ z n 1 2 d n 1 n 1 2 n 1 2 c 1b b n c n n 1 2 δ t n 1 δ z n 1 2 2 w k s n 1 2 δ z n 1 2 d n n 1 2 n 1 2 c 1c c n n w d n n 1 2 n 1 c 1d d n 0 e n 1 w k s n 1 2 δ z n 1 2 d n 1 n 1 2 n 2 ϕ n 1 n c n n 1 2 δ t n 1 δ z n 1 2 2 1 w k s n 1 2 δ z n 1 2 d n n 1 2 n 2 ϕ n n c 1e g n 1 n 1 2 g n n 1 2 2 n 1 w d n n 1 2 n ϕ n n n g n n 1 2 q nb finally in cases where the top boundary is specified as the cauchy boundary according to eq 10c the coefficients of the equation corresponding to the top boundary should be changed to incorporate the cauchy boundary condition as follows c 2a a 0 0 c 2b b 0 0 c 2c c 0 c 0 1 2 δ t n 1 δ z 1 2 2 w k s 1 2 δ z 1 2 d 0 1 2 n 1 2 c 2d d 0 w k s 1 2 δ z 1 2 d 1 1 2 n 1 2 e 0 c 0 1 2 δ t n 1 δ z 1 2 2 1 w k s 1 2 δ z 1 2 d 0 1 2 n 2 ϕ 0 n c 2e 1 w k s 1 2 δ z 1 2 d 1 1 2 n 2 ϕ 1 n g 0 1 2 g 1 1 2 2 q cb appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 124213 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 
6070,a new numerical method was developed to accurately and efficiently compute a solution of the nonlinear richards equation with a layered soil in the proposed method the kirchhoff integral transformation was applied however in the kirchhoff integral transformation approach the transformed kirchhoff head has dyadic characteristics at the material interface between different soil types to avoid the dyadic characteristics at the material interface a truncated taylor series expansion was applied to the kirchhoff head at the material interface and so the kirchhoff head was replaced with a single pressure head value at the material interface accordingly through the taylor series expansion a set of algebraic equations in the one dimensional control volume finite difference discretized system formed a tridiagonal matrix system through a series of numerical experiments the new method was compared to other numerical methods to determine its superiority the results clearly demonstrated that the approach was not only more computationally efficient but also more accurate and robust than other numerical methods computational performance was greatly enhanced with the proposed method and which could be used to simulate complicated heterogeneous flow at a large scale watershed or regional scale keywords nonlinear richards equation variably saturated flow kirchhoff integral transformation layered soil gardner constitutive relation 1 introduction the prediction of fluid movement in unsaturated soil is an important problem in many branches of science and engineering in all studies of the unsaturated zone fluid motion is assumed to obey the classical nonlinear richards equation hillel 1980 the nonlinear richards equation in variably saturated porous media needs to be solved numerically with constitutive relations heterogeneities irregular geometries and complex boundary conditions however because of nonlinearity determined based on the constitutive relations of fluid pressure saturation and relative permeability williams et al 2000 ji et al 2008 farthing and ogden 2017 zeng et al 2018 and the mathematical characteristics of the nonlinear richards equation changing from its hyperbolic form to its parabolic form there are many difficulties encountered in solving the nonlinear richards equation depending on the degree of saturation in the solution domain for example when the constitutive relation is highly nonlinear and the current state is very different from the solution state the size of the time step should be limited for transient simulations of variably saturated flow to make the iterative procedures converge and to preserve small changes in saturation or the pressure head in any part of the domain during the time step such inherent difficulties in solving the richards equation have severely limited its various applications including coupled surface and subsurface water movement problems which simultaneously simulate subsurface water flow in the unsaturated and saturated zones as well as complex regional scale problems describing groundwater flow around a high level nuclear waste repository and water budget calculations in a watershed many numerical solution strategies have been suggested to efficiently solve the equation such as picard or newton raphson iterative techniques together with finite difference or finite element approximations primary variable switching between the pressure head and water content upstream weighting of the relative permeability method of lines and transformation techniques celia et al 1990 kirkland et al 1992 tocci et al 1997 williams et al 2000 matthews et al 2004 ji et al 2008 zha et al 2017 zeng et al 2018 zhang et al 2015 2016 2018 li et al 2016 the most popular numerical methods for solving the nonlinear richards equation have the h based form they can be used for saturated and unsaturated soils as well as for layered soils however these methods suffer from poor mass balance for unsaturated soils and from unacceptable time step limitations or poor central processing unit cpu efficiency especially for very dry initial conditions bouloutas 1989 and celia et al 1990 greatly improved the performance of h based methods using a mixed form of the richards equation the strategy used by celia et al 1990 was to evaluate the change in water content over one time step directly from the change of the pressure head this results in much improved mass balance however as shown by kirkland et al 1992 cpu efficiency is still a problem in h based methods under very dry initial conditions numerical methods of the θ based form of the nonlinear richards equation result in a significantly improved performance when modeling infiltration into very dry soil hills et al 1989 kirkland et al 1992 forsyth et al 1995 zha et al 2013 unfortunately θ based methods cannot be used for simulating water flow in soils with saturated regions to retain the advantages of the θ based method wu and forsyth 2001 kirkland et al 1992 and zeng et al 2018 combined the θ and h based methods kirkland et al 1992 defined a new variable ϕ to transform the richards equation which is a linear function of the water content if soil is unsaturated and of the pressure head if soil is at or near saturation the method results in very good cpu efficiency particularly under relatively dry initial conditions williams et al 2000 however in this method a user should define a value of h 0 the point at which the h and θ based portions of the method are joined which may significantly affect the accuracy and robustness of the numerical results but this is difficult to determine a priori if h 0 is too close to saturation to improve the mass balance at the nodes close to saturation the numerical results will produce oscillations kirkland et al 1992 but if h 0 is too distant from saturation the accuracy will be decreased and mass balance errors will be introduced at the transition between the saturated and unsaturated zones in addition the kirkland method uses a partially explicit method and therefore does not have a monotone unless δ t δ x is sufficiently small another well known numerical method used to solve the nonlinear richards equation is the kirchhoff integral transformation approach haverkamp et al 1977 campbell 1985 vauclin et al 1979 ross and bristow 1990 williams et al 2000 ji et al 2008 berninger et al 2011 zhang et al 2015 2016 2018 li et al 2016 pan and wierenga 1995 pointed out that the integral in the kirchhoff transformation is in general difficult to evaluate unless special numerical interpolation methods are used williams et al 2000 introduced a second integral transform which was defined as a linear combination of θ an arbitrary parameter β and the kirchhoff integral transform they demonstrated that the second integral transform approach had very good efficiency and robustness compared to other transformation approaches which are defined in terms of θ kirkland et al 1992 the hyperbolic sine function of h ross 1990 and a rational function of h pan and wierenga 1995 for a wide range of medium properties and discretization levels however a parameter β included in the second integral transform approach must be specified but is difficult to estimate a priori as a function of medium and simulation variables williams et al 2000 recently zhang et al 2015 first introduced finite analytic method fam which applied for kirchhoff transform to solve unsaturated flow equation the fam used a local analytic solution to form a set of algebraic equations on the kirchhoff transformed variable they showed that from numerical experiments fam is very accurate and efficient compared with other numerical methods zhang et al 2016 applied the fam to the mixed form richards equation zhang et al 2018 extended the fam to apply for solving the two dimensional richards equation however all problems solved by using the fam mentioned above were limited to only homogeneous media ji et al 2008 compared a steady state solution obtained from the kirchhoff integral transformation approach to a steady state solution obtained from a time marching scheme using the transient h based method because the direct steady state solution using the h based method failed to converge their results showed that the kirchhoff integral transformation in a variably saturated region could simulate the pressure head and saturation distributions reasonably well and determine the water table distribution in complex regional scale problems for arbitrarily constitutive relations they also showed that it can enhance the computational performance by several orders of magnitude compared to a time marching scheme using the transient h based method since ji et al 2008 performed a full linearization of the unsaturated richards equation using gardner constitutive relations the computational cost in unsaturated flow simulation can be greatly reduced so that the kirchhoff integral transformation has practical implications for efficiently solving coupled surface and subsurface water problems or variably saturated flow problems at the watershed or regional scale however ji et al 2008 only considered pseudo heterogeneous layered porous media instead of true heterogeneous layered porous media here the pseudo heterogeneous layered porous media was described as follows the hydraulic conductivities of each layer differ but a soil index parameter λ residual water content θ r and saturated water content θ s in the soil water retention function are identical in all layers in addition ji et al 2008 did not extend their algorithm to a transient variably saturated flow problem but instead limited it to steady state conditions until now the kirchhoff transformation seems to be very promising method for simulating unsaturated richards equation because variations of kirchhoff head in its integral nature are much smaller than those in pressure head so that numerical errors can be reduced effectively although some it s limitations mentioned above exist especially when the kirchhoff transformation is employed to solve nonlinear richards equation based on specific constitutive relation such as gardner relation a full linearization of the unsaturated richards equation is allowed this linearization has enabled analytic and semi analytic solutions and stochastic analysis to be found for many unsaturated flow problems pullan 1990 srivastava and yeh 1991 ameli et al 2013 merrill et al 1978 read and broadbridge 1996 lu and zhang 2004 philip 1986a b 1989 basha 1994 2000a b bakker and nieber 2004a b teng et al 2016 li et al 2016 friedman and gamliel 2019 despite of widespread popular use of the gardner constitutive relations some people noted that exponential dependence of hydraulic conductivity on pressure head may not be representative of the full moisture range in real soils philip 1984 khaleel and relyea 2001 and so applicability of gardner model is limited compared to brooks corey and van genuchten models which well reproduce measured relationship between hydraulic conductivity and pressure head over entire range of pressure head nevertheless merrill et al 1978 found from their experimental and analytical studies that an exponential hydraulic conductivity and pressure head relationship is reasonable for natural heterogeneous soil profile taghavi et al 1985 compared numerical results using the exponential hydraulic conductivity and pressure head relationship to the experiment results of merrill et al 1978 and thus they concluded that the exponential relationship can be applied for adequately predicting transient movement in heterogeneous soil profiles in two dimensions khaleel and relyea 2001 showed from their experimental studies that the gardner model with variable soil index parameters is appealing because of adequate representation of hydraulic conductivity for gravelly soils and within some ranges of pressure head bakker and nieber 2004b found out from their analytical studies that the gardner relations is accurate for simulating steady state unsaturated flow when the exponential conductivity function adequately represents the unsaturated hydraulic conductivity over the entire range of pressures experienced within the flow region ji et al 2008 showed that using equivalence formula among van genuchten mulaem mualem 1976 van genuchten 1980 brooks corey 1964 and gardner constitutive relations gardner 1958 russo 1988 calculated pressure head profiles and calculated water table elevations for each constitutive relations are very similar each other and thus they proved the applicability of gardner relations in their problem braester 1973 developed analytical solution using gardner relations and obtained finite element results with experimental soil properties in one dimensional infiltration problem and then compared both solutions each other which leads to conclusion that the variation of moisture content at the soil surface and the location of wetting front calculated using the analytical solutions were predicted quite accurately ben asher et al 1978 compared numerical solution of the richards equation and full linearized analytical solution based on the gardner relation using experimental hydraulic data for sinai sand for water flow from a point source they found out that both models predict nearly the same averages and ranges of moisture content throughout the soil and so the linearized solutions give reasonable approximations to some nonlinear problems lastly there is famous excerpt from philip 1969 p 256 used by many researchers in their justification of use of gardner constitutive relations which is as follows even though it cannot be claimed that gardner equation is universally exact it does model in a reasonably convincing way the quite generally observed rapid and nonlinear decrease of hydraulic conductivity and pressure head besides there are many experimental k h curves in the literature that support use of gardner constitutive relations dirksen 1978 although the gardner constitutive relation has the practical applicability in a real problem as mentioned above many people have more popularly used brooks corey and van genuchten relations rather than the gardner relation accordingly in order to extend the applicability of the proposed method in this study to the brooks corey and van genuchten relations various conversion techniques between van genuchten brooks corey and gardner functions will be introduced ma et al 1999 rucker et al 2005 morel seytoux et al 1996 zhu et al 2004 ji et al 2008 discussion on these conversion methods can be found out in detail in section 6 the purpose of this study was to demonstrate a full linearization of the richards equation with gardner constitutive relations using the kirchhoff integral transformation in steady and transient variably saturated flows as well as within true heterogeneous layered porous media and to show that the integral transformation approach is not only more computationally efficient but also more accurate than other existing numerical methods e g the h based method celia method celia et al 1990 kirkland method kirkland et al 1992 fam zhang et al 2015 and 3dfemwater downloaded from https www epa gov ceam 3dfemwater3dlewaste and modified to consider the gardner relations in the subroutine sprop furthermore the proposed numerical algorithm was shown to be able to handle the discontinuity of the kirchhoff head at the material interface for applications in true heterogeneous layered porous media 2 mathematical formulation the richards equation describing fluid flow in variably saturated porous media is given by 1a k s k r h z θ t 1b q k s k r h z where q lt 1 is the fluid flux k s lt 1 is the saturated hydraulic conductivity tensor k r is the relative permeability as a scalar function of the pressure head h l or the water content θ l3l 3 z l is the vertical coordinate positive downward and t t is time the primary variable used to solve eq 1a is often taken to be the pressure head h and constitutive relations must be established that relate the primary unknown h to the secondary variables θ and k r the van genuchten mualem mualem 1976 van genuchten 1980 and brooks corey constitutive relations brooks and corey 1964 have been widely accepted while the gardner and gardner russo relations gardner 1958 russo 1988 have also been applied in many analytical and numerical approaches due to their simple nature in this study only the gardner constitutive relations were used to solve transient flow in variably saturated porous media with a heterogeneous layered system in the gardner constitutive relations the water content and relative permeability are given as simple exponential functions of the pressure head as follows 2a θ θ r θ s θ r e λ h θ s for f o r h 0 h 0 2b k r e λ h 1 for f o r h 0 h 0 where θ s θ r and λ represent the saturated water content l3l 3 residual water content l3l 3 and a soil index parameter l 1 related to the pore size distribution respectively the boundary conditions for eq 1a are generally given as 3a h h db on γ 1 3b n k s k r h q nb on γ 2 3c n k s k r h z q cb on γ 3 where n is an outward unit vector normal to the boundary and h db q nb and q cb are the specified head l along γ 1 specified pressure head normal gradient lt 1 on γ 2 and prescribed fluid flux lt 1 normal to γ 3 respectively with γ γ 1 γ 2 γ 3 being the boundary of the domain the kirchhoff integral transformation is defined as 4 ϕ h h k r s d s where ϕ h is a transform variable or a kirchhoff head l eq 1a can now be transformed assuming incompressibility of soil media as 5a k s ϕ k r k s z λ θ s θ r ϕ t when h 0 5b k s ϕ k s z 0 when h 0 using the gardner relations 2b the transformation 4 results in 6 ϕ h 1 λ e λ h 1 λ h for f o r h 0 h 0 substituting 6 into 5 the governing equation is fully linearized as follows 7a k s ϕ ϕ λ k s z λ θ s θ r ϕ t when ϕ 1 λ 7b k s ϕ k s z 0 when ϕ 1 λ here eqs 7a and 7b are governing equations that are fully linearized with the primary variable ϕ h for the unsaturated and saturated zones respectively for convenience eqs 7a and 7b can be expressed as follows 8 c ϕ t k s ϕ d ϕ g where 9a c λ θ s θ r when ϕ 1 λ 0 when ϕ 1 λ 9b d k s λ z when ϕ 1 λ 0 when ϕ 1 λ 9c g 0 when ϕ 1 λ k s z when ϕ 1 λ where c d θ dh dh d ϕ is the transformed specific moisture capacity function l 1 d is related to the gravity driven flux term in the unsaturated zone t 1 and g represents the gravity driven flux term in the saturated zone lt 1 as indicated in eqs 9a 9c the parameters of c d and g are determined depending on ϕ eq 8 is subject to the transformed boundary condition 10a ϕ h db ϕ db o n γ 1 10b n k s ϕ q nb on γ 2 10c n k s ϕ d ϕ g q cb on γ 3 where ϕ h db is a known value determined from eq 6 using the dirichlet head h db finally the darcy flux can be expressed using the kirchhoff head as follows 11 q k s ϕ d ϕ g 3 numerical implementation the governing equation obtained from the kirchhoff integral transformation can be rewritten by substituting eq 11 into eq 8 as follows 12 c ϕ t q here to show the derivation of the numerical formulation for eq 12 layered soil is assumed and grids are placed at the material interface and cell boundaries so that the medium between neighboring grids is always homogeneous while the grids situated at the material interface are subjected to two different soils as shown in fig 1 a and b accordingly the control volume of grid i contains two kinds of soils because grid i is located at the layer interface as shown in fig 1a and b consequently the kirchhoff head ϕ at the interface grid should be described with dyadic properties because two different values of the kirchhoff head ϕ are associated with the two different soil parameters λ i 1 2 and λ i 1 2 which are soil index parameters related to the pore size distribution at cell i 1 2 and i 1 2 within the control volume of grid i respectively although h is a single value parameter over the control volume of grid i the water balance equation in the control volume of grid i can then be written based on eq 12 as c i i 1 2 ϕ h i n 1 m 1 λ i 1 2 ϕ h i n λ i 1 2 δ t n 1 δ z i 1 2 2 13 c i i 1 2 ϕ h i n 1 m 1 λ i 1 2 ϕ h i n λ i 1 2 δ t n 1 δ z i 1 2 2 q i 1 2 q i 1 2 where the superscript n represents the old time level while m represents the previous iteration level h i n 1 m 1 is the pressure head on grid i at the new time level n 1 and current iteration level m 1 h i n is the pressure head on grid i at the old time level n δ t n 1 t n 1 t n is the size of the time step at the new time level n 1 δ z i 1 2 z i z i 1 and δ z i 1 2 z i 1 z i represent the lengths of cells i 1 2 and i 1 2 respectively and q i 1 2 and q i 1 2 are the flux into the control volume of grid i and the flux out of the control volume of grid i at the intermediate time level respectively the superscript represents the intermediate time level depending on the time derivative weighting factor w w 0 explicit method w 0 5 crank nicolson method and w 1 0 fully implicit method ϕ h i n 1 m 1 λ i 1 2 and ϕ h i n 1 m 1 λ i 1 2 are the dyadic kirchhoff heads from eq 6 on grid i with λ i 1 2 and λ i 1 2 at the new time level and current iteration level respectively in addition ϕ h i n λ i 1 2 and ϕ h i n λ i 1 2 are the dyadic kirchhoff heads on grid i at the old time level n here c i i 1 2 and c i i 1 2 are the transformed specific moisture capacities at cells i 1 2 and i 1 2 within the control volume of grid i determined from ϕ h i λ i 1 2 and λ i 1 2 and ϕ h i λ i 1 2 and λ i 1 2 at the intermediate time levels respectively and ϕ h i λ i 1 2 and ϕ h i λ i 1 2 are the kirchhoff heads on grid i at the intermediate time level as follows 14a ϕ h i λ i 1 2 w ϕ h i n 1 m λ i 1 2 1 w ϕ h i n λ i 1 2 14b ϕ h i λ i 1 2 w ϕ h i n 1 m λ i 1 2 1 w ϕ h i n λ i 1 2 from eq 9a c i i 1 2 and c i i 1 2 can be defined as follows 15a c i i 1 2 λ i 1 2 θ s i 1 2 θ r i 1 2 when ϕ h i λ i 1 2 1 λ i 1 2 0 when ϕ h i λ i 1 2 1 λ i 1 2 15b c i i 1 2 λ i 1 2 θ s i 1 2 θ r i 1 2 when ϕ h i λ i 1 2 1 λ i 1 2 0 when ϕ h i λ i 1 2 1 λ i 1 2 where θ r i 1 2 and θ r i 1 2 are the residual water contents of cells i 1 2 and i 1 2 respectively and θ s i 1 2 and θ s i 1 2 are the saturated water contents of cells i 1 2 and i 1 2 respectively in addition q i 1 2 and q i 1 2 are shown in fig 1a and b which can be obtained from eq 11 as follows 16a q i 1 2 k s i 1 2 w ϕ i 1 n 1 m 1 ϕ h i n 1 m 1 λ i 1 2 δ z i 1 2 1 w ϕ i 1 n ϕ h i n λ i 1 2 δ z i 1 2 w d i 1 i 1 2 n 1 ϕ i 1 n 1 m 1 d i i 1 2 n 1 ϕ h i n 1 m 1 λ i 1 2 2 1 w d i 1 i 1 2 n ϕ i 1 n d i i 1 2 n ϕ h i n λ i 1 2 2 g i 1 i 1 2 g i i 1 2 2 16b q i 1 2 k s i 1 2 w ϕ h i n 1 m 1 λ i 1 2 ϕ i 1 n 1 m 1 δ z i 1 2 1 w ϕ h i n λ i 1 2 ϕ i 1 n δ z i 1 2 w d i i 1 2 n 1 ϕ h i n 1 m 1 λ i 1 2 d i 1 i 1 2 n 1 ϕ i 1 n 1 m 1 2 1 w d i i 1 2 n ϕ h i n λ i 1 2 d i 1 i 1 2 n ϕ i 1 n 2 g i i 1 2 g i 1 i 1 2 2 where k s i 1 2 and k s i 1 2 are the saturated hydraulic conductivity of cells i 1 2 and i 1 2 respectively and ϕ i 1 n 1 m 1 and ϕ i 1 n 1 m 1 are the kirchhoff heads at grids i 1 and i 1 at the new time level and current iteration level respectively it should be noted that ϕ i 1 n 1 m 1 and ϕ i 1 n 1 m 1 are not dyadic values because the neighboring areas of the respective grids i 1 and i 1 are homogeneous ϕ i 1 n and ϕ i 1 n are the kirchhoff heads at grids i 1 and i 1 at the old time level respectively d i 1 i 1 2 n 1 and d i i 1 2 n 1 are associated with the gravity driven flux terms in the unsaturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the new time level n 1 respectively d i i 1 2 n 1 and d i 1 i 1 2 n 1 are parameters related to gravity driven flux terms in the unsaturated zone at cell i 1 2 within the control volume of grid i and at cell i 1 2 within the control volume of grid i 1 at the new time level respectively similarly d i 1 i 1 2 n d i i 1 2 n d i i 1 2 n and d i 1 i 1 2 n are associated with the gravity driven flux terms at the old time level g i 1 i 1 2 and g i i 1 2 represent the gravity driven flux terms in the saturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the intermediate time level respectively and g i i 1 2 and g i 1 i 1 2 represent the gravity driven flux terms in the saturated zone at cell i 1 2 within the control volume of grid i and at cell i 1 2 within the control volume of grid i 1 at the intermediate time level respectively the aforementioned parameters are defined in supplementary section 1 in eqs 16a and 16b the second and third terms on the right hand side are obtained using the arithmetic spatial average the fourth term is also obtained using the arithmetic spatial average substituting eqs 16a and 16b into eq 13 using a truncated taylor series expansion eq 13 can be rewritten as follows 17 a i ϕ i 1 n 1 m 1 b 1 i c 1 i h i n 1 m 1 d i ϕ i 1 n 1 m 1 e 1 i where the definitions of a i b 1 i c 1 i d i and e 1 i can be found out in appendix a in addition the detail derivation of eq 17 can be found out in appendix a if the soils on both sides of the interface are the same as each other eq 17 can be rewritten since λ i 1 2 λ i 1 2 and ϕ i n 1 m 1 ϕ h i n 1 m 1 λ i 1 2 ϕ h i n 1 m 1 λ i 1 2 as follows 18 a i ϕ i 1 n 1 m 1 b i c i ϕ i n 1 m 1 d i ϕ i 1 n 1 m 1 e i where the definitions of b i c i and e i can be found out in appendix a similarly at grids i 1 and i 1 in the neighborhood of the material interface detail derivation of discretized equation can be found out in appendix b for application of various boundary conditions to eqs 17 and 18 these equations should be changed according to types of boundary conditions such as dirichlet neumann and cauchy boundary conditions in cases where either the top or bottom boundaries are specified as the dirichlet boundary according to eq 10a either ϕ 0 n 1 m 1 or ϕ n n 1 m 1 becomes ϕ db accordingly when the top boundary is specified the discretized equation corresponding to the top boundary will be removed and the system of equations to be solved will be reduced by one having any number of primary variables of n rather than n 1 simultaneously e 1 in eq 18 should be changed to e 1 a 1 ϕ db similarly when the bottom boundary is specified the discretized equation corresponding to the bottom boundary will be removed and e n 1 in eq 18 will be changed to e n 1 d n 1 ϕ db similarly in cases where the bottom boundary is specified as either the neumann boundary or cauchy boundary according to either eq 10b or eq 10c respectively the discretized equation should be manipulated to incorporate corresponding boundary conditions the detail of manipulation can be found out appendix c 4 verification wetting scenario example of two layered soil in example 2 of srivastava and yeh 1991 was used to verify the proposed numerical method by comparing numerical results obtained using the proposed method against analytical solution of srivastava and yeh 1991 in this example λ of the two layers were identically set to be 0 1 cm 1 and the saturated hydraulic conductivities of the lower and upper layers were equal to 1 and 10 cm h respectively the thickness of each layer was 100 cm the saturated and residual water contents were taken to as 0 4 and 0 06 respectively the initial pressure head profile was the steady state profile at an infiltration rate equal to 0 1 cm h then at simulation time greater than 0 the infiltration rate was suddenly increased to 0 9 cm h fig 2 shows the pressure profile heads at several times obtained using the proposed method and analytical solutions of srivastava and yeh 1991 as shown in fig 2 the results are exactly same each other it should be noted that since the analytical solution of srivastava and yeh 1991 can only consider the same λ for layered soil we showed only problem considering pseudo heterogeneity media which can analyze only the effect of discontinuous saturated hydraulic conductivity on the moisture movement rather than discontinuous soil parameters such as λ θ r and θ s 5 examples and results the accuracy and efficiency of the proposed algorithm was evaluated by performing numerical experiments for three cases where a 1d homogenous soil a heterogeneous layered soil and a regional scale unsaturated saturated groundwater system were assumed respectively the numerical experiments were conducted by comparing the proposed method with other numerical methods or public software the methods used were the pressure head based method eq 6 in celia et al 1990 celia method eq 17 in celia et al 1990 kirkland method kirkland et al 1992 fam zhang et al 2015 3dfemwater downloaded from https www epa gov ceam 3dfemwater3dlewaste and modified to consider the gardner relations in the subroutine sprop kirchhoff integral transformation using a fully implicit method and kirchhoff integral transformation using the crank nicolson time differenced equation the finite difference equations 6 and 17 in celia et al 1990 were adopted for the pressure head approach and the celia method respectively on the other hand the finite difference equation 13 in the kirkland et al 1992 was employed for the kirkland method finally a set of algebraic equation 16 in zhang et al 2015 was used in the fam 5 1 example 1 one dimensional 1 d flow in a homogeneous soil in this example 1 d flow in homogeneous porous media was considered under three different scenarios the parameter values and initial and boundary conditions for the simulation are shown in fig 3 the three scenarios were established according to the initial conditions and bottom boundary conditions in all scenarios the top boundaries were set as the dirichlet boundary condition at a pressure head of 75 cm while at the bottom boundary pressure heads hdb s of 200 400 and 600 cm were assigned as the dirichlet boundary condition according to each different scenario as shown in fig 3 the initial pressure heads h 0 s were set to be exactly the same as the dirichlet boundary conditions on the bottom boundary with values of 200 400 and 600 cm assigned according to each different scenario as shown in fig 3 this means that different initial water contents in the soil column were assumed in each scenario the purpose of this study was to compare the computational accuracy and efficiency of the seven numerical methods over the range of initial water contents to illustrate the superiority of the proposed algorithm computational efficiency was evaluated on the basis of the cpu time consumed to achieve a given level of accuracy to evaluate the seven numerical methods over as a wide range of accuracy levels as possible the numerical methods were run repeatedly using a different fixed size time step δ t for each run the level of accuracy attained for each run was computed using the maximum difference between the exact and numerical solutions as shown in eq 19 19 ε δ t max z h z t final δ t h exact z t final t final 0 89 h r z δ z 2 δ z 40 c m we computed the maximum difference between the numerical solution h and an exact solution h exact measured at the final simulation time t final in this test problem to obtain the exact solution we used a numerical solution that very accurately solved the kirchhoff integral transformation method using the crank nicolson time difference scheme based on a very fine grid and very small time steps as a surrogate of h exact for calculation of the maximum difference in eq 19 the reason why the kirchhoff integral transformation method was used to obtain a base case solution is that the method is stable and mass conserved the celia and kirkland methods are not stable and the pressure head based method and 3dfemwater are not mass conserved which will be illustrated later we also recorded the cpu time used for each run the simulations were performed on a pc with a pentium processor 3865u 1 8 ghz 2 mb l3 cache evaluating efficiency over a wide range of accuracy levels enabled us to draw conclusions regarding the comparative performance of the seven numerical methods varying the time step size for each run of the test problem also allowed us to make some observations about the stability of the different methods the pressure head profiles computed using all seven numerical methods for the three scenarios are shown in fig 4 here solutions from all seven methods were obtained under all three different initial conditions using the same grid size and time step of 0 01 cm and 0 001 h respectively under the initial pressure head of 200 cm the numerical solutions from all seven methods could not be visibly distinguished from the exact solution as shown in fig 4 this means that the solutions from all seven methods were reasonably well matched with the exact solution however the celia method failed to produce a converged solution at the initial pressure head of 300 cm and lower while the kirkland method failed to produce converged solutions at an initial pressure head of 400 cm and lower as shown in fig 4 in contrast the solutions obtained from the pressure head based method fam 3dfemwater kirchhoff integral transformation using a fully implicit method and kirchhoff integral transformation using the crank nicolson time differenced equation matched the exact solution reasonably well at initial pressure heads of 400 and 600 cm as shown in fig 4 therefore it appears that the celia and kirkland methods were conditionally stable for the limited initial condition as kirkland et al 1992 and celia et al 1990 noted this could be attributed to the fact that the kirkland method uses a partially explicit scheme and therefore does not have a monotone unless δ t δ x is sufficiently small and the iteration number of the celia method is significantly increased in very dry soil and thus the celia method may not reach convergence in very dry soil accordingly our numerical result was consistent with previous findings fig 5 shows plots of the maximum differences calculated using eq 19 for all seven numerical methods against time steps with a range of 0 001 0 5 h this plot enables numerical accuracy to be compared between different methods when the size of the time step is given the kirchhoff integral transformation method using the crank nicolson time differenced equation produced the most accurate solutions among the methods tested at time steps of less than 0 1 h from the slopes of the accuracy curves in fig 5 it can be seen that all methods except the kirchhoff integral transformation method using the crank nicolson time differenced equation were approximately first order accurate while the kirchhoff integral transformation method using the crank nicolson time differenced equation was approximately o δ t 2 accurate in order to compare the performance of the seven numerical methods regarding efficiency cpu time consumed to achieve a certain level of accuracy was plotted versus maximum difference in fig s1 in supplementary section 2 in addition the detail discussion can be found out in supplementary section 2 5 2 example 2 one dimensional flow in a heterogeneous layered soil the 1 d vertical flow in a true heterogeneous layered soil column was considered as shown in fig 6 the soil configuration soil thickness soil properties and boundary conditions were adapted from case 3 in ji et al 2008 where the soil column consisted of three layers with thicknesses of 50 50 and 100 cm from the bottom to the top respectively the k s of the bottom middle and top layers was set to 10 1 and 10 cm h respectively and the θ s and θ r were set to 0 368 and 0 102 respectively for all three layers the λ of the bottom middle and top layers was set to 0 1 0 2 and 0 1 cm 1 respectively which differed from ji et al 2008 where all λ s were 0 1 cm 1 this means that ji et al 2008 considered pseudo heterogeneous layered soils in their problem but in the example in the present study a true heterogeneous layered soil was investigated because soil properties such as λ θ s and θ r were allowed to vary with soil type as in case 3 in ji et al 2008 the pressure head of 0 cm was specified at the bottom and a prescribed flux of 0 1 cm h was imposed at the top in this example to compare the accuracy and efficiency of the proposed algorithm with others three scenarios were designed according to the initial conditions with the respective initial pressure heads h 0 s of 50 150 and 200 cm as shown in fig 6 differently from example 1 fam was not employed here due to its incapability of dealing with water flow in heterogeneous media in the case of the celia pressure head based and kirchhoff methods the time stepping strategy followed the automatically adaptive time step scheme in which if the number of iterations is less than five the size of time step will be increased by a factor of from 1 00001 to 1 1 depending on the scenario but if the number of iterations is greater than 10 the size of the time step will be decreased by a factor of 0 3 however the kirkland method used a slightly different adaptive time step scheme where if the number of iterations was less than 5 the size of the time step size will be increased by a factor of 1 000001 regardless of the scenario but if the number of iterations is greater than 10 the size of the time step will be decreased by a factor of 0 3 unlike the automatic time stepping strategy 3dfemwater used an initial time step of 0 00001 h time step multiplier of 1 1 and maximum time step of 0 1 h to measure the ability of the simulator to conserve mass we defined a mass balance measure as follows 20 mb t 1 0 total additional mass in the domain total net flux into the domain where the additional mass is measured with respect to the initial mass in the system and then the mass balance can be calculated as follows allen and murphy 1985 1986 celia and pinder 1986 celia et al 1987 1990 shahraiyni and ataie ashtiani 2012 21 m b t 1 0 i 1 n 1 θ i n 1 θ i 0 δ z i 1 2 2 δ z i 1 2 2 j 1 n 1 k n 1 2 j h n j h n 1 j δ z n 1 2 1 k 1 2 j h 1 j h 0 j δ z 1 2 1 δ t j fig 7 a shows the pressure head with elevation at various times obtained from all numerical methods at the initial pressure head of 50 cm for all numerical methods very good agreement was obtained with the exact solution at the initial pressure head of 150 cm the simulation result obtained from the kirkland method is only shown at the early time of 0 89 h in fig 7b due to the excessive computational cpu time furthermore the results from the kirkland method and 3dfemwater deviated greatly from the exact solution in the vicinity of the material interface at the early time of 0 89 h when soil was drier because the kirkland method incurs an enormous computational expense we did not perform a numerical simulation with the kirkland method at the initial pressure head of 200 cm accordingly the results from the kirkland method did not appear at the initial pressure head of 200 cm as shown in fig 7c in addition at the initial pressure head of 200 cm the results from 3dfemwater deviated much greatly from the exact solution in the vicinity of the material interface at the early time of 0 89 h evaluating the performance of the proposed method including the kirchhoff approaches using a fully implicit method and the crank nicolson scheme with regard to efficiency and accuracy the proposed method was found to have the best performance because the mass balance error of the proposed method was 8 orders of magnitude smaller than that of any other method as shown in fig 8 and table 1 regarding the computational efficiency the detail discussion can be found out in supplementary section 3 5 3 example 3 application to regional scale unsaturated saturated groundwater system in order to show the applicability of the proposed method to regional scale or watershed unsaturated saturated groundwater system a hypothetical regional aquifer system was considered this hypothetical example was designed to be characterized by regional scale groundwater flow in multi layer aquifer with complex geometry in order to simulate regional groundwater flow in this example the 1d proposed method was straightforwardly extended to 3d numerical model by using a finite element approach also in order to assess the accuracy of the 3d proposed model the analytical solution of ameli et al 2013 where a steady state unsaturated saturated groundwater flow in two dimensional stratified aquifer cross section of the regional scale groundwater system was solved with series solutions was employed to compare numerical solutions the analytical solution was developed by minimizing head and flow continuity errors at a set of control points along interfaces between layers ameli et al 2013 as shown in fig 9 a the two dimensional cross section in aquifer system with five layers has the irregular interface geometry between layers as well as undulating boundaries of bottom and top although the proposed method has the capability of simulating groundwater flow in an anisotropic true heterogeneous aquifer in a transient situation the hypothetical example is assumed to have identical soil index parameters for all layers and to have isotropic saturated hydraulic conductivities because analytical solutions can account for only pseudo heterogeneous and isotropic systems under steady state flow condition the saturated hydraulic conductivity used are 1 15 m day 2 36 m day 1 07 10 3 m day 4 18 m day and 7 98 10 2 m day from top to bottom layers also λ θ r and θ s are identical for all five layers to 0 128 m 1 0 0 and 1 0 respectively the left right and bottom boundaries are specified as no flow condition while at the top surface dirichlet pressure head is assigned the developed 3d proposed model discretize the domain with 59 940 hexahedron elements and 122 000 nodes to simulate subsurface flow as shown in fig 9b in this discretization x and y directional sizes of element are set to be 2 m and 1 m respectively but z directional size ranges from 0 9 m to 5 9 m across the whole domain time step sizes are varied from 1 0 10 6 day to 5 0 10 2 day during simulation numerical solutions of hydraulic head and pressure head obtained at simulation time of 4 8 days which is considered to reach steady state using the 3d proposed numerical model are compared to the analytical solutions as shown in fig 10 a and 10b respectively as shown in fig 10a and 10b excellent agreements are shown between the numerical solutions and analytical solutions besides both water table locations which are defined as a curve with zero pressure head obtained through numerical and analytical solutions show perfect agreement each other to demonstrate capabilities of the new proposed method to efficiently solve regional scale unsaturated saturated groundwater flow problems the commercial 3dfemwater is also applied to this example using same spatial discretization adopted in the 3d proposed model and thus two results obtained from the proposed model and 3dfemwater are compared not shown here from the comparison we find out that 3dfemwater produces accurate solutions as the proposed model but computational time of 3dfemwater is about 50 times larger than that of the proposed model since cpu times of the proposed model and 3dfemwater are 594 3 s and 29 877 5 s respectively using a pc with a pentium processor 3865u 1 8 ghz 2 mb l3 cache therefore the proposed method can simulate very efficiently regional scale unsaturated and saturated groundwater flow under heterogeneous aquifer with complex geometry 6 discussion although the examples reported here successfully demonstrate the superiority of the proposed method over other methods regarding its efficiency and accuracy the proposed method is limited to only the gardner constitutive relations however the van genuchten and brooks corey relations are more widely employed in soil constitutive relations accordingly to retain the advantages of the proposed method using the gardner constitutive relation when the more commonly used van genuchten and brooks corey relations are adopted various conversion methods between the van genuchten brooks corey and gardner functions can be used ma et al 1999 rucker et al 2005 morel seytoux et al 1996 zhu et al 2004 ji et al 2008 these conversion methods were devised by preserving some characteristics of the relations e g identifying parameters that minimize differences between the soil water retention curves or ensuring that capillary length or effective capillary drive is preserved in each conversion method the respective formula for parameter equivalence between various constitutive relations was developed and the influence on predictions of various hydrological components and soil hydraulic properties such as water retention hydraulic conductivity runoff evapotranspiration infiltration rate and cumulative outflow was studied ma et al 1999 rucker et al 2005 morel seytoux et al 1996 zhu et al 2004 previous studies concluded that some conversion methods can reproduce the characteristics of certain constitutive functions well at some specified range of suction heads in particular ji et al 2008 demonstrated that by using the parameter equivalence formula of zhu et al 2004 the calculated water tables using the gardner van genuchten and brooks corey functions were similar thus previous studies indicated that it was possible to extend the new proposed algorithm to soils with arbitrary constitutive relations including the van genuchten and brooks corey functions for simulating the water content or pressure head distributions in variably saturated media these studies indicate that the algorithm proposed in this study is versatile when using arbitrary constitutive relations and thus the proposed algorithm is not only limited to the gardner function therefore through the use of a conversion method the kirchhoff transformed richards equation using the gardner constitutive relation has the ability to successfully simulate the distribution of soil water content or the pressure head 7 conclusions in this study a new method was proposed to modify the kirchhoff transformation approach for describing unsaturated and saturated groundwater flow in heterogeneous layered porous media because the new method follows the kirchhoff transformation approach using gardner constitutive relations the original nonlinear richards equation becomes fully linearized in terms of the kirchhoff head accordingly this new method is advantageous relative to existing numerical methods in terms of its numerical accuracy and efficiency because the new method solves a linearized partial differential equation while the other existing numerical methods solve a nonlinear partial differential equation this was apparent from the numerical experiment in example 1 however in heterogeneous layered soils because kirchhoff heads are discontinuous at the interface between two different materials the algebraic equation for a 1 d finite difference discretization associated with a grid located at the material interface will have four unknown variables rather than three this causes the number of unknown variables to be greater than the number of equations when the set of algebraic equations is formed for a 1 d finite difference discretization mathematically it is impossible to solve this assembled matrix system whose number of unknown variables is greater than the number of equations however the new method employed a truncated taylor series to deal with the discontinuity of the kirchhoff head at the interface between different materials with the result that the two different kirchhoff heads on each side of the interface can be replaced with a continuous single pressure head at the interface when a truncated taylor series is used the set of algebraic equations will form a tridiagonal matrix system because adoption of the taylor series expansion will decrease the number of unknown variables in the algebraic equation at the material interface by one therefore the new method can solve this tridiagonal system without any numerical difficulties using traditional matrix solvers such as the thomas algorithm or other advanced solvers moreover the numerical experiment in example 2 showed that for simulating variably saturated groundwater flow in heterogeneous layered porous media the performance of the proposed method including the kirchhoff approaches using a fully implicit method and using the crank nicolson scheme had the best performance because cpu times in the proposed method were from 2 to 4 orders of magnitude less than for other methods and the mass balance error of the proposed method was 8 orders of magnitude smaller than for any other methods finally from the application of regional scale unsaturated saturated groundwater system in example 3 we found out that this new method can be easily extended to a three dimensional case and thus there are implications of the new method for efficiently solving coupled surface and subsurface water problems or variably saturated flow problems in watersheds or large scale problems because of the very low computational cost declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported national institute of agricultural sciences rural development administration republic of korea grant no pj013392032019 appendix a detail derivation of eq 17 substituting eqs 16a and 16b into eq 13 eq 13 can be rearranged as follows a 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 1 2 ϕ i 1 n 1 m 1 c i i 1 2 δ t n 1 δ z i 1 2 2 w k s i 1 2 δ z i 1 2 d i i 1 2 n 1 2 ϕ h i n 1 m 1 λ i 1 2 c i i 1 2 δ t n 1 δ z i 1 2 2 w k s i 1 2 δ z i 1 2 d i i 1 2 n 1 2 ϕ h i n 1 m 1 λ i 1 2 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 1 2 ϕ i 1 n 1 m 1 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 2 ϕ i 1 n c i i 1 2 δ t n 1 δ z i 1 2 2 1 w k s i 1 2 δ z i 1 2 d i i 1 2 n 2 ϕ h i n λ i 1 2 c i i 1 2 δ t n 1 δ z i 1 2 2 1 w k s i 1 2 δ z i 1 2 d i i 1 2 n 2 ϕ h i n λ i 1 2 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 2 ϕ i 1 n g i 1 i 1 2 g i i 1 2 2 g i i 1 2 g i 1 i 1 2 2 eq a 1 can be further simplified as follows a 2 a i ϕ i 1 n 1 m 1 b i ϕ h i n 1 m 1 λ i 1 2 c i ϕ h i n 1 m 1 λ i 1 2 d i ϕ i 1 n 1 m 1 e i where a 3a a i w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 1 2 a 3b b i c i i 1 2 δ t n 1 δ z i 1 2 2 w k s i 1 2 δ z i 1 2 d i i 1 2 n 1 2 a 3c c i c i i 1 2 δ t n 1 δ z i 1 2 2 w k s i 1 2 δ z i 1 2 d i i 1 2 n 1 2 a 3d d i w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 1 2 a 3e e i 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 2 ϕ i 1 n c i i 1 2 δ t n 1 δ z i 1 2 2 1 w k s i 1 2 δ z i 1 2 d i i 1 2 n 2 ϕ h i n λ i 1 2 c i i 1 2 δ t n 1 δ z i 1 2 2 1 w k s i 1 2 δ z i 1 2 d i i 1 2 n 2 ϕ h i n λ i 1 2 1 w k s i 1 2 δ z i 1 2 d i 1 i 1 2 n 2 ϕ i 1 n g i 1 i 1 2 g i i 1 2 2 g i i 1 2 g i 1 i 1 2 2 due to different types of soil on each side of the interface the kirchhoff head ϕ is discontinuous across the interface thus as shown in eq a 2 four unknowns occur in the algebraic equation at the control volume of grid i however noting that the pressure head h is a continuous single value across the material interface within the control volume of grid i the number of unknowns can be decreased to three by adopting the pressure head h on the interface as an unknown variable rather than dyadic values of the kirchhoff head ϕ this can be performed by changing the dyadic values of the kirchhoff head ϕ with the pressure head h using a truncated taylor series which is shown as follows a 4a ϕ h i n 1 m 1 λ i 1 2 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m 1 h i n 1 m a 4b ϕ h i n 1 m 1 λ i 1 2 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m 1 h i n 1 m where ϕ h i n 1 m λ i 1 2 and ϕ h i n 1 m λ i 1 2 are the dyadic values of the kirchhoff head at grid i with λ i 1 2 and λ i 1 2 at the new time and previous iteration levels respectively using eq 6 d ϕ dh i i 1 2 n 1 m and d ϕ dh i i 1 2 n 1 m can be written as follows a 5a d ϕ dh i i 1 2 n 1 m exp λ i 1 2 h i n 1 m when h i n 1 m 0 1 when h i n 1 m 0 a 5b d ϕ dh i i 1 2 n 1 m exp λ i 1 2 h i n 1 m when h i n 1 m 0 1 when h i n 1 m 0 here ϕ h i n 1 m λ i 1 2 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m and d ϕ dh i i 1 2 n 1 m in eq a 4a and a 4b are known because they are a function of the known h i n 1 m substituting eqs a 4a and a 4b into eq a 2 eq a 2 can be rearranged as follows a 6 a i ϕ i 1 n 1 m 1 b 1 i c 1 i h i n 1 m 1 d i ϕ i 1 n 1 m 1 e 1 i where a 7a b 1 i b i d ϕ dh i i 1 2 n 1 m a 7b c 1 i c i d ϕ dh i i 1 2 n 1 m a 7c e 1 i e i b i ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m c i ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m appendix b numerical formulations at grids i 1 and i 1 in the neighborhood of the material interface because the control volume of grid i 1 contains one kind soil as shown in fig 1b the kirchhoff head ϕ is continuous across the grid i 1 and therefore the kirchhoff head ϕ at the grid i 1 is not dyadic therefore the water balance equation within the control volume of grid i 1 can be written as b 1 c i 1 i 3 2 ϕ i 1 n 1 m 1 ϕ i 1 n δ t n 1 δ z i 3 2 2 c i 1 i 1 2 ϕ i 1 n 1 m 1 ϕ i 1 n δ t n 1 δ z i 1 2 2 q i 3 2 q i 1 2 where c i 1 i 3 2 and c i 1 i 1 2 are the transformed specific moisture capacities at cells i 3 2 and i 1 2 within the control volume of grid i 1 at the intermediate time level respectively q i 3 2 and q i 1 2 are the fluxes into and out of the control volume of grid i 1 at the intermediate time level respectively as follows b 2a q i 3 2 k s i 3 2 w ϕ i 2 n 1 m 1 ϕ i 1 n 1 m 1 δ z i 3 2 1 w ϕ i 2 n ϕ i 1 n δ z i 3 2 w d i 2 i 3 2 n 1 ϕ i 2 n 1 m 1 d i 1 i 3 2 n 1 ϕ i 1 n 1 m 1 2 1 w d i 2 i 3 2 n ϕ i 2 n d i 1 i 3 2 n ϕ i 1 n 2 g i 2 i 3 2 g i 1 i 3 2 2 b 2b q i 1 2 k s i 1 2 w ϕ i 1 n 1 m 1 ϕ h i n 1 m 1 λ i 1 2 δ z i 1 2 1 w ϕ i 1 n ϕ h i n λ i 1 2 δ z i 1 2 w d i 1 i 1 2 n 1 ϕ i 1 n 1 m 1 d i i 1 2 n 1 ϕ h i n 1 m 1 λ i 1 2 2 1 w d i 1 i 1 2 n ϕ i 1 n d i i 1 2 n ϕ h i n λ i 1 2 2 g i 1 i 1 2 g i i 1 2 2 it should be noted that ϕ i 1 n 1 m 1 and ϕ i 2 n 1 m 1 are continuous across grids i 1 and i 2 respectively because the soils at both sides of grids i 1 and i 2 are the same as shown in fig 1b respectively accordingly ϕ i 1 n 1 m 1 and ϕ i 2 n 1 m 1 are not dyadic values while the kirchhoff head ϕ at grid i is a dyadic value d i 2 i 3 2 n 1 and d i 1 i 3 2 n 1 are associated with gravity driven flux terms in the unsaturated zone at cell i 3 2 within the control volume of grid i 2 and at cell i 3 2 within the control volume of grid i 1 at the new time level n 1 respectively d i 1 i 1 2 n 1 and d i i 1 2 n 1 are associated with the gravity driven flux terms in the unsaturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the new time level n 1 respectively d i 2 i 3 2 n and d i 1 i 3 2 n are associated with the gravity driven flux terms in the unsaturated zones at cell i 3 2 within the control volume of grid i 2 and at cell i 3 2 within the control volume of grid i 1 at the old time level n respectively d i 1 i 1 2 n and d i i 1 2 n are associated with the gravity driven flux terms in the unsaturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the old time level n respectively g i 2 i 3 2 and g i 1 i 3 2 represent the gravity driven flux terms in the saturated zone at cell i 3 2 within the control volume of grid i 2 and at cell i 3 2 within the control volume of grid i 1 at the intermediate time respectively and g i 1 i 1 2 and g i i 1 2 represent the gravity driven flux terms in the saturated zone at cell i 1 2 within the control volume of grid i 1 and at cell i 1 2 within the control volume of grid i at the intermediate time respectively substituting eqs b 2a and b 2b into eq b 1 and rearranging eq b 1 can be simplified as follows b 3 a i 1 ϕ i 2 n 1 m 1 b i 1 c i 1 ϕ i 1 n 1 m 1 d i 1 ϕ h i n 1 m 1 λ i 1 2 e i 1 where a i 1 b i 1 c i 1 d i 1 and e i 1 are exactly the same as in eqs a 3a a 3b a 3c a 3d and a 3e in appendix a as long as subscript i is changed into subscript i 1 in eq b 3 ϕ h i n 1 m 1 λ i 1 2 can be changed into h i n 1 m 1 using eq a 4a finally eq b 3 can be expressed as follows b 4 a i 1 ϕ i 2 n 1 m 1 b i 1 c i 1 ϕ i 1 n 1 m 1 d 1 i 1 h i n 1 m 1 e 2 i 1 where b 5a d 1 i 1 d i 1 d ϕ dh i i 1 2 n 1 m b 5b e 2 i 1 e i 1 d i 1 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m similarly the formulation of the discretized equation for grid i 1 can be derived as eq b 6 using the same procedure as above b 6 a 1 i 1 h i n 1 m 1 b i 1 c i 1 ϕ i 1 n 1 m 1 d i 1 ϕ i 2 n 1 m 1 e 3 i 1 where b 7a a 1 i 1 a i 1 d ϕ dh i i 1 2 n 1 m b 7b e 3 i 1 e i 1 a i 1 ϕ h i n 1 m λ i 1 2 d ϕ dh i i 1 2 n 1 m h i n 1 m appendix c application of neumann and cauchy boundary conditions in cases where the bottom boundary is specified as the neumann boundary according to eq 10b the coefficients of the equation corresponding to the bottom boundary should be changed to incorporate the neumann boundary condition as follows c 1a a n w k s n 1 2 δ z n 1 2 d n 1 n 1 2 n 1 2 c 1b b n c n n 1 2 δ t n 1 δ z n 1 2 2 w k s n 1 2 δ z n 1 2 d n n 1 2 n 1 2 c 1c c n n w d n n 1 2 n 1 c 1d d n 0 e n 1 w k s n 1 2 δ z n 1 2 d n 1 n 1 2 n 2 ϕ n 1 n c n n 1 2 δ t n 1 δ z n 1 2 2 1 w k s n 1 2 δ z n 1 2 d n n 1 2 n 2 ϕ n n c 1e g n 1 n 1 2 g n n 1 2 2 n 1 w d n n 1 2 n ϕ n n n g n n 1 2 q nb finally in cases where the top boundary is specified as the cauchy boundary according to eq 10c the coefficients of the equation corresponding to the top boundary should be changed to incorporate the cauchy boundary condition as follows c 2a a 0 0 c 2b b 0 0 c 2c c 0 c 0 1 2 δ t n 1 δ z 1 2 2 w k s 1 2 δ z 1 2 d 0 1 2 n 1 2 c 2d d 0 w k s 1 2 δ z 1 2 d 1 1 2 n 1 2 e 0 c 0 1 2 δ t n 1 δ z 1 2 2 1 w k s 1 2 δ z 1 2 d 0 1 2 n 2 ϕ 0 n c 2e 1 w k s 1 2 δ z 1 2 d 1 1 2 n 2 ϕ 1 n g 0 1 2 g 1 1 2 2 q cb appendix d supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 124213 appendix d supplementary data the following are the supplementary data to this article supplementary data 1 
6071,traditional flood frequency analysis is usually performed under the stationary assumption that flood elements such as flood peak and flood volume are independent and identically distributed i i d however with global climate change and human activities across the landscape stationary approaches cannot capture the nonstationary characteristics of flood events this study aims to explore the key elements in establishing an effective bivariate nonstationary flood frequency model for flood peak and volume series at the three gorges dam in china a stationary reference model and six nonstationary models were established and rigorously compared to evaluate their benefits and limitations including two time informed models and four climate informed models that consider time and climate indices as explanatory variables the results suggest that nonstationary models are clearly superior to stationary models with respect to model performance based on the deviance information criterion dic the time informed nonstationary model provides a potential tool to project future trends in flood return periods with minimal data availability yet the uncertainty in the estimation of design values of such models is limited on the other hand explicitly incorporating climate indices as explanatory variables of flood frequency distribution can significantly improve model performance and reduce uncertainty but at the cost of increased model complexity keywords nonstationary flood frequency analysis copula function bayesian theory three gorges dam 1 introduction extreme flooding is a major natural disaster that threatens human life and properties and has been an important issue in hydrological communities flood frequency analysis is the fundamental method for quantifying the uncertainty and risks of extreme floods to design or manage some hydraulic engineering such as bridges or dams villarini et al 2009 traditional flood frequency analysis is usually performed based on the stationary assumption that floods in each year are independent and identically distributed however the 5th ipcc report has noted that the uncertainties and frequencies of extreme flood disasters will be time varying under the impacts of climate change and human activities ipcc 2014 thus stationary flood frequency analysis can no longer satisfy the requirement of future hydroclimatic conditions and faces serious challenges pörtner and farrell 2016 since some previous studies have stated that the stationarity is dead milly et al 2008 2015 nonstationary flood frequency analysis has become one of the hotspots in hydrology communities thus it is critical to study how to make an effective nonstationary model of flood frequency and provide new standards for the dynamic management of hydraulic engineering luke et al 2017 zeng et al 2017 under stationary assumptions the parameters of the flood distributions are constant with time and are estimated solely by existing flood data in contrast the nonstationary frequency analysis uses some explanatory variables to express the variability of floods by nonstationary models such as the generalized additive models for location scale and shape gamlss lane et al 2005 therefore time was first selected as one main explanatory variable in nonstationary frequency analysis to represent the time dependent trend cheng et al 2014 um et al 2017 villarini et al 2009 yilmaz and perera 2014 with the advanced studies about the teleconnections of floods some studies attributed the extreme floods to large scale climate anomalies such as the el niño southern oscillation enso north atlantic oscillation nao indian ocean dipole iod and pacific decadal oscillation pdo gershunov and cayan 2003 haylock et al 2006 henley et al 2011 willems 2013 thus climate indices have gradually become another important type of explanatory variable in nonstationary frequency analysis bracken et al 2018 lima and aghakouchak 2017 lima et al 2015 luke et al 2017 zeng et al 2017 zhang et al 2015 multivariate frequency analysis is a main tool for regional frequency analysis which is necessary to better understand and capture flood characteristics at multiple stations chen et al 2014b renard 2011 sun et al 2014 or multiple flood characteristics at the same station mediero et al 2010 salas and obeysekera 2014 floods in multiple regions or multiple flood characteristics always have some intrinsic independence which can be exploited to quantify the uncertainty of parameters sun et al 2015 2014 or estimate frequency at ungauged stations chebana et al 2014 lima et al 2015 yan and moradkhani 2015 fitting a joint distribution among multivariates is the most useful method for capturing dependence copula function has already been utilized in multivariate frequency analysis for stochastic simulation flood coincidence risk analysis and measurement of the dependences between variables grimaldi and serinaldi 2006 huang et al 2018a requena et al 2013 salvadori and de michele 2010 shiau 2006 zhang and singh 2006 for example reddy and ganguli 2012 applies archimedean copulas for frequency analysis of flood characteristics annual peak flow flood volume and flood duration chen et al 2014a proposes a new method based on the copula entropy theory parent et al 2014 analyzes the parameters of joint distributions and select copula functions under the bayesian framework huang et al 2018b proposes a stochastic simulation method comprising a copula based simulation method accounting for the uncertainty in flood forecasts and flood hydrographs to analyze flood control risk nonstationary models for multivariate frequency analysis have also been developed using time varying copulas bender et al 2014 conducted a nonstationary model for bivariate frequency analysis using a time dependent copula to model flood peak and flood volume on the rhine river jiang et al 2015 utilized a time varying copula that takes the changing reservoir environment into consideration sarhadi et al 2016 proposed a time varying risk analysis for adaptive design in nonstationary conditions using a bayesian dynamic conditional copula kwon and lall 2016 used a time dependent copula and bayesian theory to investigate california drought during 2002 2015 using a multicentury reconstruction of drought with the development of bayesian theory and related methods e g markov chain monte carlo bayesian approaches have been widely applied in nonstationary frequency analysis to better quantify the uncertainty of the parameters o connell et al 2002 conducted bayesian flood frequency analysis with annual peak discharge historical and paleohydrologic bound data for the santa ynez river california and the big lost river idaho kwon et al 2008 used hierarchical bayesian analysis to evaluate several factors that influence the frequency of extreme floods for a basin in montana renard 2011 gave a full bayesian framework to conduct regional frequency analysis scott and upmanu 2015 presented a nonstationary regional frequency analysis of precipitation extremes in northern california that is conditioned on the variability of tropical moisture exports bracken et al 2018 proposed a comprehensive bayesian framework for conducting multivariate nonstationary frequency analysis and showed the advantages of multivariate distributions over the univariate distributions chen et al 2018 used the bayesian technique to objectively select the optimal distribution for extreme daily and hourly rainfall despite a number of studies illustrating multivariate and nonstationary frequency analysis a rigorous comparison of nonstationary models in analyzing bivariate flood frequency has not been implemented in depth this study aims to compare different bivariate nonstationary flood frequency models with different explanatory variables and to provide references for establishing nonstationary models more specifically the objective of this paper is to compare the fitting capability uncertainty and implications of one stationary model and six nonstationary models including two time informed models and four climate informed models that consider time and climate indices as explanatory variables the study area and data are presented in section 2 then the methods are given in section 3 the benefits and limitations of these stationary and nonstationary models will be rigorously compared in section 4 finally discussion and conclusions will be drawn 2 study area and data 2 1 study area and flood data the three gorges dam tgd is the largest hydropower project in china fig 1 providing a variety of benefits including flood control hydropower generation and facilitating navigation the upper reaches of the tgd are approximately 1 million km2 and the total storage capacity is 39 billion m3 the tgd ensures the safety of approximately 400 million people living in the middle and lower reaches of the yangtze river xu et al 2007 the current management strategy of the tgd is mostly based on the stationary assumption from the end of may to early september the water level at the tgd is restricted to the limit level of 145 m and then raised to the normal level of 175 m by mid and late september some studies have shown that the power generation of the tgd could be significantly improved by dynamically controlling the water level based on short term runoff forecasts xiang et al 2010 zhang et al 2009 in addition the discharge of the tgd has changed significantly and is closely correlated to large scale climate anomalies bai et al 2014 kwon et al 2009 xu et al 2007 however few long term management strategies are drawn based on the climate informed predictions with the concern of nonstationarity the nonstationary models in this case may improve the safety and power generation of the tgd daily streamflow data from 1953 to 2012 at the yichang hydrological station fig 1 were collected to represent the streamflow at the tgd the yichang hydrological station is located 44 km downstream of the tgd we chose this site because it is the longest continuous hydrologic observation in the yangtze river the m k trend test showed that the flood peak maximum daily discharge has a significant decreasing trend the study by zhao et al 2012 have shown that 2003 is a possible change point in the streamflow at the yichang hydrological station in addition the largest hydropower project the tgd was also initially operated in 2003 the operation of the tgd should have been responsible for the decline in the flood peak therefore the streamflow data after 2003 was reconstructed to approximate the natural flow to keep the long term records consistent by using the principle of water balance details about the reconstruction of the natural flow can be found in the study by dong et al 2019 the reconstructed flood peak maximum daily discharge and maximum 30 day volume were highly correlated r 0 749 p 0 05 and used for subsequent bivariate flood frequency analysis we reused the mann kendall m k test to detect the trend of the reconstructed flood peak and volume and they no longer have any significant trend 2 2 climate data climate data used to establish nonstationary models include some commonly used global climate indices and three indicators of sea surface temperature sst nino 3 nino 3 4 and nino 4 more details and sources of these datasets can be found in table 1 2 3 selection of climate covariates the flood season of the tgd is usually from june to september time series of 12 climate indices from the preceding two years to april in the forecast year 28 months in total were collected as 336 candidate predictors 12 variables 28 months for flood peak and volume the selection of the most relevant predictors was performed based on pearson correlation coefficients and p values the pearson coefficients map and p values were plotted in fig 2 the covariates whose p values were less than 0 05 were selected as the potential covariates then we used the all subsets regression of the multiple linear model to select the final covariates based on the adjusted r squared kabacoff 2015 all subsets regression is also called best subsets regression and all possible regression all subsets regression fits all possible models based on the potential variables and determines the best model using the adjusted r squared the adjusted r squared can limit the number of covariates and avoid overfitting theil and cramer 1961 the climate covariates c p t for flood peak and covariates c v t for flood volume are summarized in table 2 the pearson coefficients between the selected predictors were mainly less than 0 15 suggesting no multicollinearity among the covariates 3 methods 3 1 bayesian models copula functions have been widely used in multivariate frequency analysis to establish joint distributions parent et al 2014 renard and lang 2007 requena et al 2013 zhang and singh 2006 the time varying copula under the bayesian framework was established to analyze the nonstationary bivariate frequency in this case we first compared the efficiency of normal distribution log normal distribution generalized extreme value gev distribution and exponential distribution for fitting the marginal distributions of flood peak p and volume v then the family of archimedean copulas was tested for fitting the joint distribution including gumbel copula clayton copula and frank copula the akaike information criterion aic bayesian information criterion bic and deviance information criterion dic spiegelhalter et al 2002 zeng et al 2017 were used as the criteria for the selection of the marginal and joint distributions the results are summarized in table 3 based on the dic the gev distribution and normal distribution were selected to fit the marginal distributions of flood peak and volume respectively in this case the clayton copula outperformed other copula functions in the aic bic and dic table 3 and was used to fit the joint distribution the joint cumulative distribution function between the flood peak p and the flood volume v based on the clayton copula is as follows 1 f p v c u v θ u θ v θ 1 1 θ 2 u f p p μ 1 σ 1 ξ 3 v f v v μ 2 σ 2 where f p and f v are the marginal cumulative density functions of the flood peak p and flood volume v respectively and θ is the parameter in the copula functions that indicates the association between peak and volume let d p 1 v 1 p 2 v 2 p n v n denote the observed peak and volume in n years then the likelihood function is as follows 4 p d θ t 1 n l p t v t μ 1 t σ 1 ξ 1 μ 2 t σ 2 θ where θ represents the parameters we need to estimate including μ 1 t σ 1 ξ 1 in the gev distribution u 2 t σ 2 in the normal distribution and θ in the copula function l is the probability density function of joint distribution which is the clayton copula function in this case we established the associations between the distribution parameters and covariates to represent the nonstationarity following previous studies kwon and lall 2016 lima et al 2015 shape parameters ξ 1 and scale parameters σ 1 and σ 2 in eq 4 were assumed to be constant while location parameters μ 1 t and u 2 t were time varying variables and have associations with time covariate t or climate covariates c p t for flood peak and c v t for flood volume seven models representing different assumptions of the associations between the covariates and variables μ 1 t and u 2 t were evaluated 1 stationary model st representing the traditional flood frequency analysis model in which all distribution parameters are assumed to be constant over time 2 time informed model using linear regression ti l with time for the location variables μ 1 t and u 2 t 3 time informed model using quadratic regression ti q with time for the location variables μ 1 t and u 2 t 4 climate informed model with one climate covariate ci 1 5 climate informed model with two climate covariates ci 2 6 climate informed model with three climate covariates ci 3 and 7 climate informed model with four climate covariates ci 4 the equations of location variables μ 1 t and u 2 t in the seven models are summarized in table 4 the regression parameters α α 0 α 1 α 2 α m and β β 0 β 1 β 2 β m need to be estimated bayesian theory is used to estimate the distributions of parameters and incorporates the uncertainty compared with traditional approaches such as the maximum likelihood estimation mle and least squares estimation bayesian methods consider the parameters as distributions and effectively update the prior estimates based on the likelihood functions here uninformative prior distributions were used for most parameters including the regression parameters α and β the prior distributions of the parameters in the ci 4 model were described in table 5 as an example the bayesian theory updates the prior distributions based on the likelihood function as follows 5 p θ d p d θ p θ p d where p d θ is the likelihood function as eq 4 and p θ is the prior distribution the markov chain monte carlo mcmc method was used to simulate the posterior distribution of the parameters the mcmc method ignores the absolute value of the posterior distribution and uses the relative value to sample the distribution we used the r package rjags for the mcmc simulations http mcmc jags sourceforge net the convergence index is gelman and rubin s shrink factor gelman and rubin 1992 kwon and lall 2016 when the index is less than 1 05 the sample is considered convergent cowles 2013 3 2 nonstationary return periods and design values the return period and the design value are the crucial parameters that determine the scales and operation of the water resources projects in the nonstationary assumption the distribution parameters are time varying as a result the return period and the design value are also time varying and need to be calculated in each year the nonstationary return period for flood peak t p t and flood volume t v t at year t are 6 t p t 1 e p t 1 1 f p p μ 1 t σ 1 ξ 1 7 t v t 1 e v t 1 1 f v v μ 2 t σ 2 where e p t and e v t are the exceedance probabilities of the flood peak and flood volume respectively at year t in the nonstationary assumption the nonstationary univariate design values of the flood peak p t t and flood volume v t t with return period t are defined as the q 1 1 t th quantiles 8 p t t f p 1 q μ 1 t σ 1 ξ 1 9 v t t f v 1 q μ 2 t σ 2 in the bayesian framework both the return period and the design value are not only time varying but also uncertain because the parameters μ 1 t σ 1 ξ 1 μ 2 t σ 2 follow some distributions to investigate the uncertainty in the design values we used 1000 parameter samples from the posterior distributions to generate 1000 design values for each year then the confidence interval ci and box plot were analyzed in this paper for bivariate distribution the joint return periods between the flood peak p and flood volume v were analyzed and can be defined in two categories return period t and for p p and v v and return period t or for p p or v v shiau 2006 10 t and 1 p p p and v v 1 1 f p p μ 1 t σ 1 ξ 1 f v v μ 2 t σ 2 c f p p f v v μ 1 t σ 1 ξ 1 μ 2 t σ 2 θ 11 t or 1 p p p or v v 1 1 c f p p f v v μ 1 t σ 1 ξ 1 μ 2 t σ 2 θ the kth quantiles of the parameter samples from the posterior distributions are applied to calculate the joint return period in this case the median values k 0 5 of the parameters were used to calculate the nonstationary joint return period bracken et al 2018 3 3 evaluation of model performance we used the dic spiegelhalter et al 2002 zeng et al 2017 to evaluate the efficiency of the bayesian models the dic is a statistical measurement for bayesian model comparison and it provides a better way to evaluate the model complexity compared with the aic and bic the dic is calculated as 12 dic e h θ p d where h θ equals 2 l o g d θ e h θ denotes the averaged value for the posterior distribution of θ and p d denotes the number of effective parameters in the model and is calculated as p d e h θ h mean θ the function p d represents the complexity of the model and a smaller dic suggests a better fitting capability 4 results 4 1 parameters estimation and model performance we sampled 35 000 times of mcmc for posterior distributions of the parameters in total according to gelman and rubin s shrink factor the first 30 000 times were selected as the burn samples and the rest of them were the posterior distribution samples the posterior distributions of the parameters in the ci 4 model are shown in fig 3 although we did not give informative prior distributions for the regression parameters α and β the posterior density distributions also showed that the regression parameters converged to centered distributions we chose posterior distributions of three parameters that were included in all seven models to compare the results fig 4 including standard deviation of the flood peak distribution s d p standard deviation of the flood volume distribution s d v and the parameter θ in the copula functions the standard deviation of the flood peak s d p was calculated from the shape parameters ξ 1 and the scale parameters σ 1 because the flood peak follows a gev distribution the standard deviation of the flood volume s d v equaled the scale parameters σ 2 because flood volume follows a normal distribution in fig 4 the standard deviations of the flood peak and flood volume gradually declined from the st model to the ci 4 model the cl 4 model achieved the least uncertainty in the estimation of the design values of the flood peak and flood volume the values e h θ h mean θ p d and dic are summarized in table 6 to compare the goodness of fit and complexity of the seven models the st model is the simplest model and nearly has the worst fitting performance the ti l model increases the complexity of the model and does not achieve better performance compared with the st model the reason for this performance may be that the ti l model uses linear regression and flood elements in the tgd do not have significant linear trend as the m k test shows the ti q model has better performance but higher complexity than the st model the climate informed models outperform the st model and the time informed models with reference to the dic values with the increased number of covariates from one in the ci 1 model to four in the ci 4 model the dic based performance continuously improved however the complexity p d also increased too many covariates may induce other problems such as the difficulty of convergence and the selection of independent covariates in summary the ci 4 model achieved the best performance and was used for subsequent analysis 4 2 nonstationary return periods and design values the flood that occurred in 1998 was one of the most disastrous natural hazards in history which affected the entire yangtze river basin and caused more than 2000 deaths he and jiao 2000 therefore the nonstationary exceedance probabilities of the 1998 flood peak and flood volume are plotted in fig 5 it was found that the exceedance probabilities in 1998 were always larger than the probabilities in other years suggesting that the nonstationary models can predict the risks of 1998 flood fig 6 shows nonstationary design values of the flood peak and flood volume with a 100 year return period using the ci 4 model in 1981 and 2012 the observed flood peaks at the tgd were very high and the corresponding nonstationary design flood peaks were also larger than the values in other years the nonstationary model can decrease the potential dangers caused by floods in 1981 and 2012 this also agrees with the results of the nonstationary exceedance probabilities in fig 5 to compare the uncertainty of the design values we calculated the width of the 90 credible intervals ci of the design values for each year then the mean width of the annual 90 ci from 1953 to 2012 under the seven models was plotted in fig 7 the time informed models ti l and ti q have the largest uncertainties of the design values the reason may be that the time informed models increase the complexity but do not provide enough useful information to improve the fitting capability the uncertainty of the climate informed models is the smallest however the width of the 90 ci did not decrease with the increased number of climate covariates for example the ci 4 model has a larger uncertainty than the ci 2 model for flood volume using the floods in 1998 and 2012 as examples we compared the usefulness of the st model and ci 4 model in analyzing the bivariate return period the contours of the joint return period using median parameters of the st model and the ci 4 model for the years 1998 and 2012 are shown in fig 8 the ci 4 model predicts a higher risk for extreme flood events such as floods occurring in 1998 and 2012 in other words the stationary model underestimated the probability of extreme floods compared with the nonstationary model if one had used the nonstationary model for flood frequency analysis in 1998 it could have better prepared and reduced casualties 5 discussion and conclusions this study investigated the benefits and limitations of nonstationary models in bivariate flood frequency analysis at the three gorges dam tgd six nonstationary bivariate models and a stationary model were established based on the bayesian theory and copula functions to analyze their fitting capability nonstationary return periods design values and uncertainty the results demonstrate that nonstationary flood frequency analysis can better meet our requirements for example the ci 4 model can predict the huge danger of historical flood in 1998 the climate informed models reduce the uncertainty in the estimation of parameters and design values compared with stationary models however many hydraulic engineering structures in china are still established and operated under stationary assumptions it is necessary to use the nonstationary model as one of the references for the construction and operation of some grand hydraulic engineering structures although nonstationary models improve the fitting capability and uncertainty the number of parameters and model complexity are also increased climate informed models add up to eight parameters compared with stationary models many studies selected only two or three climate indices for climate informed models without discussion of the number of explanatory variables bracken et al 2018 lima et al 2015 liu et al 2014 xu et al 2007 zeng et al 2017 the dic based results indicate that using four explanatory variables is still valid at the tgd however too many parameters may bring the difficulty for model convergence and the possibility of overfitting liu et al 2014 how to balance the complexity and fitting capability of nonstationary models deserves further investigation one of the major concerns about the use of nonstationary models is its uncertainty in this study the uncertainty in the parameters and return periods was quantified using bayesian theory climate informed models have less uncertainty than stationary models the time informed nonstationary models have larger uncertainties than the stationary models in the estimation of design values in addition the results show that increasing the number of explanatory variables may not definitely reduce the uncertainty in design value estimation for example the ci 4 model has larger uncertainty than the ci 2 model in the estimation of the design flood volume lins and cohn 2011 and serinaldi and kilsby 2015 express doubt with the implications of nonstationarity mainly because of the untrustworthy uncertainty the bayesian method provides us with an important method for solving this problem many studies have utilized the hierarchical bayesian method to quantify the spatial correlation and uncertainty in flood frequency analysis bracken et al 2018 sun et al 2015 yan and moradkhani 2015 accurately quantifying the uncertainty using bayesian theory may greatly promote the use of nonstationary models at present many nonstationary models are statistical models and do not have enough physical basis debele et al 2017 li et al 2018 um et al 2017 yan and moradkhani 2015 climate change and human activities are the two main drivers of nonstationarity armal et al 2018 sowers et al 2011 the best performance of the climate informed model may partly come from its physical mechanisms in the future a physical based nonstationary model may be an essential method for nonstationary flood frequency analysis selecting reservoir indices climate indices land use and rainfall seasonality as explanatory variables may increase the robustness of nonstationary models zeng et al 2017 zhang et al 2015 discovering the uncertainty of floods from a perspective of well understood physical mechanisms is what we need following the discussion above the main conclusions are listed as follows 1 traditional stationary models have a relatively simple model structure but cannot capture the variations and nonstationarity of flood characteristics a stationary model may increase the risks when some historical extreme floods occur in contrast the nonstationary model can better quantify the return periods of floods and help us better operate hydraulic engineering structures with climate change and human activities 2 the time informed model is relatively easy to establish and does not require extra explanatory variables in this case the linear regression and quadratic regression were used in the ti l and ti q models respectively the results show that quadratic regression is necessary and can improve the dic based results in the tgd one of the defects of the time informed model is that the uncertainty in design value estimation is larger than that of the st model 3 the climate informed models have better performance than the time informed models based on the dic the climate informed model with four covariates achieves the best dic based performance in addition a climate informed model can decrease the uncertainty in the estimation of design values credit authorship contribution statement xu zhang conceptualization methodology writing original draft kai duan writing review editing validation supervision qianjin dong funding acquisition writing review editing visualization investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is financially supported by the national key r d program of china grant no 2016yfc0401309 national natural science foundation of china grant nos 51979198 51909285 51439007 and innovation group of hubei natural science foundation grant no 2017cfa015 we thank dr peter caldwell from usda forest service for his valuable comments that have substantially improved the manuscript 
6071,traditional flood frequency analysis is usually performed under the stationary assumption that flood elements such as flood peak and flood volume are independent and identically distributed i i d however with global climate change and human activities across the landscape stationary approaches cannot capture the nonstationary characteristics of flood events this study aims to explore the key elements in establishing an effective bivariate nonstationary flood frequency model for flood peak and volume series at the three gorges dam in china a stationary reference model and six nonstationary models were established and rigorously compared to evaluate their benefits and limitations including two time informed models and four climate informed models that consider time and climate indices as explanatory variables the results suggest that nonstationary models are clearly superior to stationary models with respect to model performance based on the deviance information criterion dic the time informed nonstationary model provides a potential tool to project future trends in flood return periods with minimal data availability yet the uncertainty in the estimation of design values of such models is limited on the other hand explicitly incorporating climate indices as explanatory variables of flood frequency distribution can significantly improve model performance and reduce uncertainty but at the cost of increased model complexity keywords nonstationary flood frequency analysis copula function bayesian theory three gorges dam 1 introduction extreme flooding is a major natural disaster that threatens human life and properties and has been an important issue in hydrological communities flood frequency analysis is the fundamental method for quantifying the uncertainty and risks of extreme floods to design or manage some hydraulic engineering such as bridges or dams villarini et al 2009 traditional flood frequency analysis is usually performed based on the stationary assumption that floods in each year are independent and identically distributed however the 5th ipcc report has noted that the uncertainties and frequencies of extreme flood disasters will be time varying under the impacts of climate change and human activities ipcc 2014 thus stationary flood frequency analysis can no longer satisfy the requirement of future hydroclimatic conditions and faces serious challenges pörtner and farrell 2016 since some previous studies have stated that the stationarity is dead milly et al 2008 2015 nonstationary flood frequency analysis has become one of the hotspots in hydrology communities thus it is critical to study how to make an effective nonstationary model of flood frequency and provide new standards for the dynamic management of hydraulic engineering luke et al 2017 zeng et al 2017 under stationary assumptions the parameters of the flood distributions are constant with time and are estimated solely by existing flood data in contrast the nonstationary frequency analysis uses some explanatory variables to express the variability of floods by nonstationary models such as the generalized additive models for location scale and shape gamlss lane et al 2005 therefore time was first selected as one main explanatory variable in nonstationary frequency analysis to represent the time dependent trend cheng et al 2014 um et al 2017 villarini et al 2009 yilmaz and perera 2014 with the advanced studies about the teleconnections of floods some studies attributed the extreme floods to large scale climate anomalies such as the el niño southern oscillation enso north atlantic oscillation nao indian ocean dipole iod and pacific decadal oscillation pdo gershunov and cayan 2003 haylock et al 2006 henley et al 2011 willems 2013 thus climate indices have gradually become another important type of explanatory variable in nonstationary frequency analysis bracken et al 2018 lima and aghakouchak 2017 lima et al 2015 luke et al 2017 zeng et al 2017 zhang et al 2015 multivariate frequency analysis is a main tool for regional frequency analysis which is necessary to better understand and capture flood characteristics at multiple stations chen et al 2014b renard 2011 sun et al 2014 or multiple flood characteristics at the same station mediero et al 2010 salas and obeysekera 2014 floods in multiple regions or multiple flood characteristics always have some intrinsic independence which can be exploited to quantify the uncertainty of parameters sun et al 2015 2014 or estimate frequency at ungauged stations chebana et al 2014 lima et al 2015 yan and moradkhani 2015 fitting a joint distribution among multivariates is the most useful method for capturing dependence copula function has already been utilized in multivariate frequency analysis for stochastic simulation flood coincidence risk analysis and measurement of the dependences between variables grimaldi and serinaldi 2006 huang et al 2018a requena et al 2013 salvadori and de michele 2010 shiau 2006 zhang and singh 2006 for example reddy and ganguli 2012 applies archimedean copulas for frequency analysis of flood characteristics annual peak flow flood volume and flood duration chen et al 2014a proposes a new method based on the copula entropy theory parent et al 2014 analyzes the parameters of joint distributions and select copula functions under the bayesian framework huang et al 2018b proposes a stochastic simulation method comprising a copula based simulation method accounting for the uncertainty in flood forecasts and flood hydrographs to analyze flood control risk nonstationary models for multivariate frequency analysis have also been developed using time varying copulas bender et al 2014 conducted a nonstationary model for bivariate frequency analysis using a time dependent copula to model flood peak and flood volume on the rhine river jiang et al 2015 utilized a time varying copula that takes the changing reservoir environment into consideration sarhadi et al 2016 proposed a time varying risk analysis for adaptive design in nonstationary conditions using a bayesian dynamic conditional copula kwon and lall 2016 used a time dependent copula and bayesian theory to investigate california drought during 2002 2015 using a multicentury reconstruction of drought with the development of bayesian theory and related methods e g markov chain monte carlo bayesian approaches have been widely applied in nonstationary frequency analysis to better quantify the uncertainty of the parameters o connell et al 2002 conducted bayesian flood frequency analysis with annual peak discharge historical and paleohydrologic bound data for the santa ynez river california and the big lost river idaho kwon et al 2008 used hierarchical bayesian analysis to evaluate several factors that influence the frequency of extreme floods for a basin in montana renard 2011 gave a full bayesian framework to conduct regional frequency analysis scott and upmanu 2015 presented a nonstationary regional frequency analysis of precipitation extremes in northern california that is conditioned on the variability of tropical moisture exports bracken et al 2018 proposed a comprehensive bayesian framework for conducting multivariate nonstationary frequency analysis and showed the advantages of multivariate distributions over the univariate distributions chen et al 2018 used the bayesian technique to objectively select the optimal distribution for extreme daily and hourly rainfall despite a number of studies illustrating multivariate and nonstationary frequency analysis a rigorous comparison of nonstationary models in analyzing bivariate flood frequency has not been implemented in depth this study aims to compare different bivariate nonstationary flood frequency models with different explanatory variables and to provide references for establishing nonstationary models more specifically the objective of this paper is to compare the fitting capability uncertainty and implications of one stationary model and six nonstationary models including two time informed models and four climate informed models that consider time and climate indices as explanatory variables the study area and data are presented in section 2 then the methods are given in section 3 the benefits and limitations of these stationary and nonstationary models will be rigorously compared in section 4 finally discussion and conclusions will be drawn 2 study area and data 2 1 study area and flood data the three gorges dam tgd is the largest hydropower project in china fig 1 providing a variety of benefits including flood control hydropower generation and facilitating navigation the upper reaches of the tgd are approximately 1 million km2 and the total storage capacity is 39 billion m3 the tgd ensures the safety of approximately 400 million people living in the middle and lower reaches of the yangtze river xu et al 2007 the current management strategy of the tgd is mostly based on the stationary assumption from the end of may to early september the water level at the tgd is restricted to the limit level of 145 m and then raised to the normal level of 175 m by mid and late september some studies have shown that the power generation of the tgd could be significantly improved by dynamically controlling the water level based on short term runoff forecasts xiang et al 2010 zhang et al 2009 in addition the discharge of the tgd has changed significantly and is closely correlated to large scale climate anomalies bai et al 2014 kwon et al 2009 xu et al 2007 however few long term management strategies are drawn based on the climate informed predictions with the concern of nonstationarity the nonstationary models in this case may improve the safety and power generation of the tgd daily streamflow data from 1953 to 2012 at the yichang hydrological station fig 1 were collected to represent the streamflow at the tgd the yichang hydrological station is located 44 km downstream of the tgd we chose this site because it is the longest continuous hydrologic observation in the yangtze river the m k trend test showed that the flood peak maximum daily discharge has a significant decreasing trend the study by zhao et al 2012 have shown that 2003 is a possible change point in the streamflow at the yichang hydrological station in addition the largest hydropower project the tgd was also initially operated in 2003 the operation of the tgd should have been responsible for the decline in the flood peak therefore the streamflow data after 2003 was reconstructed to approximate the natural flow to keep the long term records consistent by using the principle of water balance details about the reconstruction of the natural flow can be found in the study by dong et al 2019 the reconstructed flood peak maximum daily discharge and maximum 30 day volume were highly correlated r 0 749 p 0 05 and used for subsequent bivariate flood frequency analysis we reused the mann kendall m k test to detect the trend of the reconstructed flood peak and volume and they no longer have any significant trend 2 2 climate data climate data used to establish nonstationary models include some commonly used global climate indices and three indicators of sea surface temperature sst nino 3 nino 3 4 and nino 4 more details and sources of these datasets can be found in table 1 2 3 selection of climate covariates the flood season of the tgd is usually from june to september time series of 12 climate indices from the preceding two years to april in the forecast year 28 months in total were collected as 336 candidate predictors 12 variables 28 months for flood peak and volume the selection of the most relevant predictors was performed based on pearson correlation coefficients and p values the pearson coefficients map and p values were plotted in fig 2 the covariates whose p values were less than 0 05 were selected as the potential covariates then we used the all subsets regression of the multiple linear model to select the final covariates based on the adjusted r squared kabacoff 2015 all subsets regression is also called best subsets regression and all possible regression all subsets regression fits all possible models based on the potential variables and determines the best model using the adjusted r squared the adjusted r squared can limit the number of covariates and avoid overfitting theil and cramer 1961 the climate covariates c p t for flood peak and covariates c v t for flood volume are summarized in table 2 the pearson coefficients between the selected predictors were mainly less than 0 15 suggesting no multicollinearity among the covariates 3 methods 3 1 bayesian models copula functions have been widely used in multivariate frequency analysis to establish joint distributions parent et al 2014 renard and lang 2007 requena et al 2013 zhang and singh 2006 the time varying copula under the bayesian framework was established to analyze the nonstationary bivariate frequency in this case we first compared the efficiency of normal distribution log normal distribution generalized extreme value gev distribution and exponential distribution for fitting the marginal distributions of flood peak p and volume v then the family of archimedean copulas was tested for fitting the joint distribution including gumbel copula clayton copula and frank copula the akaike information criterion aic bayesian information criterion bic and deviance information criterion dic spiegelhalter et al 2002 zeng et al 2017 were used as the criteria for the selection of the marginal and joint distributions the results are summarized in table 3 based on the dic the gev distribution and normal distribution were selected to fit the marginal distributions of flood peak and volume respectively in this case the clayton copula outperformed other copula functions in the aic bic and dic table 3 and was used to fit the joint distribution the joint cumulative distribution function between the flood peak p and the flood volume v based on the clayton copula is as follows 1 f p v c u v θ u θ v θ 1 1 θ 2 u f p p μ 1 σ 1 ξ 3 v f v v μ 2 σ 2 where f p and f v are the marginal cumulative density functions of the flood peak p and flood volume v respectively and θ is the parameter in the copula functions that indicates the association between peak and volume let d p 1 v 1 p 2 v 2 p n v n denote the observed peak and volume in n years then the likelihood function is as follows 4 p d θ t 1 n l p t v t μ 1 t σ 1 ξ 1 μ 2 t σ 2 θ where θ represents the parameters we need to estimate including μ 1 t σ 1 ξ 1 in the gev distribution u 2 t σ 2 in the normal distribution and θ in the copula function l is the probability density function of joint distribution which is the clayton copula function in this case we established the associations between the distribution parameters and covariates to represent the nonstationarity following previous studies kwon and lall 2016 lima et al 2015 shape parameters ξ 1 and scale parameters σ 1 and σ 2 in eq 4 were assumed to be constant while location parameters μ 1 t and u 2 t were time varying variables and have associations with time covariate t or climate covariates c p t for flood peak and c v t for flood volume seven models representing different assumptions of the associations between the covariates and variables μ 1 t and u 2 t were evaluated 1 stationary model st representing the traditional flood frequency analysis model in which all distribution parameters are assumed to be constant over time 2 time informed model using linear regression ti l with time for the location variables μ 1 t and u 2 t 3 time informed model using quadratic regression ti q with time for the location variables μ 1 t and u 2 t 4 climate informed model with one climate covariate ci 1 5 climate informed model with two climate covariates ci 2 6 climate informed model with three climate covariates ci 3 and 7 climate informed model with four climate covariates ci 4 the equations of location variables μ 1 t and u 2 t in the seven models are summarized in table 4 the regression parameters α α 0 α 1 α 2 α m and β β 0 β 1 β 2 β m need to be estimated bayesian theory is used to estimate the distributions of parameters and incorporates the uncertainty compared with traditional approaches such as the maximum likelihood estimation mle and least squares estimation bayesian methods consider the parameters as distributions and effectively update the prior estimates based on the likelihood functions here uninformative prior distributions were used for most parameters including the regression parameters α and β the prior distributions of the parameters in the ci 4 model were described in table 5 as an example the bayesian theory updates the prior distributions based on the likelihood function as follows 5 p θ d p d θ p θ p d where p d θ is the likelihood function as eq 4 and p θ is the prior distribution the markov chain monte carlo mcmc method was used to simulate the posterior distribution of the parameters the mcmc method ignores the absolute value of the posterior distribution and uses the relative value to sample the distribution we used the r package rjags for the mcmc simulations http mcmc jags sourceforge net the convergence index is gelman and rubin s shrink factor gelman and rubin 1992 kwon and lall 2016 when the index is less than 1 05 the sample is considered convergent cowles 2013 3 2 nonstationary return periods and design values the return period and the design value are the crucial parameters that determine the scales and operation of the water resources projects in the nonstationary assumption the distribution parameters are time varying as a result the return period and the design value are also time varying and need to be calculated in each year the nonstationary return period for flood peak t p t and flood volume t v t at year t are 6 t p t 1 e p t 1 1 f p p μ 1 t σ 1 ξ 1 7 t v t 1 e v t 1 1 f v v μ 2 t σ 2 where e p t and e v t are the exceedance probabilities of the flood peak and flood volume respectively at year t in the nonstationary assumption the nonstationary univariate design values of the flood peak p t t and flood volume v t t with return period t are defined as the q 1 1 t th quantiles 8 p t t f p 1 q μ 1 t σ 1 ξ 1 9 v t t f v 1 q μ 2 t σ 2 in the bayesian framework both the return period and the design value are not only time varying but also uncertain because the parameters μ 1 t σ 1 ξ 1 μ 2 t σ 2 follow some distributions to investigate the uncertainty in the design values we used 1000 parameter samples from the posterior distributions to generate 1000 design values for each year then the confidence interval ci and box plot were analyzed in this paper for bivariate distribution the joint return periods between the flood peak p and flood volume v were analyzed and can be defined in two categories return period t and for p p and v v and return period t or for p p or v v shiau 2006 10 t and 1 p p p and v v 1 1 f p p μ 1 t σ 1 ξ 1 f v v μ 2 t σ 2 c f p p f v v μ 1 t σ 1 ξ 1 μ 2 t σ 2 θ 11 t or 1 p p p or v v 1 1 c f p p f v v μ 1 t σ 1 ξ 1 μ 2 t σ 2 θ the kth quantiles of the parameter samples from the posterior distributions are applied to calculate the joint return period in this case the median values k 0 5 of the parameters were used to calculate the nonstationary joint return period bracken et al 2018 3 3 evaluation of model performance we used the dic spiegelhalter et al 2002 zeng et al 2017 to evaluate the efficiency of the bayesian models the dic is a statistical measurement for bayesian model comparison and it provides a better way to evaluate the model complexity compared with the aic and bic the dic is calculated as 12 dic e h θ p d where h θ equals 2 l o g d θ e h θ denotes the averaged value for the posterior distribution of θ and p d denotes the number of effective parameters in the model and is calculated as p d e h θ h mean θ the function p d represents the complexity of the model and a smaller dic suggests a better fitting capability 4 results 4 1 parameters estimation and model performance we sampled 35 000 times of mcmc for posterior distributions of the parameters in total according to gelman and rubin s shrink factor the first 30 000 times were selected as the burn samples and the rest of them were the posterior distribution samples the posterior distributions of the parameters in the ci 4 model are shown in fig 3 although we did not give informative prior distributions for the regression parameters α and β the posterior density distributions also showed that the regression parameters converged to centered distributions we chose posterior distributions of three parameters that were included in all seven models to compare the results fig 4 including standard deviation of the flood peak distribution s d p standard deviation of the flood volume distribution s d v and the parameter θ in the copula functions the standard deviation of the flood peak s d p was calculated from the shape parameters ξ 1 and the scale parameters σ 1 because the flood peak follows a gev distribution the standard deviation of the flood volume s d v equaled the scale parameters σ 2 because flood volume follows a normal distribution in fig 4 the standard deviations of the flood peak and flood volume gradually declined from the st model to the ci 4 model the cl 4 model achieved the least uncertainty in the estimation of the design values of the flood peak and flood volume the values e h θ h mean θ p d and dic are summarized in table 6 to compare the goodness of fit and complexity of the seven models the st model is the simplest model and nearly has the worst fitting performance the ti l model increases the complexity of the model and does not achieve better performance compared with the st model the reason for this performance may be that the ti l model uses linear regression and flood elements in the tgd do not have significant linear trend as the m k test shows the ti q model has better performance but higher complexity than the st model the climate informed models outperform the st model and the time informed models with reference to the dic values with the increased number of covariates from one in the ci 1 model to four in the ci 4 model the dic based performance continuously improved however the complexity p d also increased too many covariates may induce other problems such as the difficulty of convergence and the selection of independent covariates in summary the ci 4 model achieved the best performance and was used for subsequent analysis 4 2 nonstationary return periods and design values the flood that occurred in 1998 was one of the most disastrous natural hazards in history which affected the entire yangtze river basin and caused more than 2000 deaths he and jiao 2000 therefore the nonstationary exceedance probabilities of the 1998 flood peak and flood volume are plotted in fig 5 it was found that the exceedance probabilities in 1998 were always larger than the probabilities in other years suggesting that the nonstationary models can predict the risks of 1998 flood fig 6 shows nonstationary design values of the flood peak and flood volume with a 100 year return period using the ci 4 model in 1981 and 2012 the observed flood peaks at the tgd were very high and the corresponding nonstationary design flood peaks were also larger than the values in other years the nonstationary model can decrease the potential dangers caused by floods in 1981 and 2012 this also agrees with the results of the nonstationary exceedance probabilities in fig 5 to compare the uncertainty of the design values we calculated the width of the 90 credible intervals ci of the design values for each year then the mean width of the annual 90 ci from 1953 to 2012 under the seven models was plotted in fig 7 the time informed models ti l and ti q have the largest uncertainties of the design values the reason may be that the time informed models increase the complexity but do not provide enough useful information to improve the fitting capability the uncertainty of the climate informed models is the smallest however the width of the 90 ci did not decrease with the increased number of climate covariates for example the ci 4 model has a larger uncertainty than the ci 2 model for flood volume using the floods in 1998 and 2012 as examples we compared the usefulness of the st model and ci 4 model in analyzing the bivariate return period the contours of the joint return period using median parameters of the st model and the ci 4 model for the years 1998 and 2012 are shown in fig 8 the ci 4 model predicts a higher risk for extreme flood events such as floods occurring in 1998 and 2012 in other words the stationary model underestimated the probability of extreme floods compared with the nonstationary model if one had used the nonstationary model for flood frequency analysis in 1998 it could have better prepared and reduced casualties 5 discussion and conclusions this study investigated the benefits and limitations of nonstationary models in bivariate flood frequency analysis at the three gorges dam tgd six nonstationary bivariate models and a stationary model were established based on the bayesian theory and copula functions to analyze their fitting capability nonstationary return periods design values and uncertainty the results demonstrate that nonstationary flood frequency analysis can better meet our requirements for example the ci 4 model can predict the huge danger of historical flood in 1998 the climate informed models reduce the uncertainty in the estimation of parameters and design values compared with stationary models however many hydraulic engineering structures in china are still established and operated under stationary assumptions it is necessary to use the nonstationary model as one of the references for the construction and operation of some grand hydraulic engineering structures although nonstationary models improve the fitting capability and uncertainty the number of parameters and model complexity are also increased climate informed models add up to eight parameters compared with stationary models many studies selected only two or three climate indices for climate informed models without discussion of the number of explanatory variables bracken et al 2018 lima et al 2015 liu et al 2014 xu et al 2007 zeng et al 2017 the dic based results indicate that using four explanatory variables is still valid at the tgd however too many parameters may bring the difficulty for model convergence and the possibility of overfitting liu et al 2014 how to balance the complexity and fitting capability of nonstationary models deserves further investigation one of the major concerns about the use of nonstationary models is its uncertainty in this study the uncertainty in the parameters and return periods was quantified using bayesian theory climate informed models have less uncertainty than stationary models the time informed nonstationary models have larger uncertainties than the stationary models in the estimation of design values in addition the results show that increasing the number of explanatory variables may not definitely reduce the uncertainty in design value estimation for example the ci 4 model has larger uncertainty than the ci 2 model in the estimation of the design flood volume lins and cohn 2011 and serinaldi and kilsby 2015 express doubt with the implications of nonstationarity mainly because of the untrustworthy uncertainty the bayesian method provides us with an important method for solving this problem many studies have utilized the hierarchical bayesian method to quantify the spatial correlation and uncertainty in flood frequency analysis bracken et al 2018 sun et al 2015 yan and moradkhani 2015 accurately quantifying the uncertainty using bayesian theory may greatly promote the use of nonstationary models at present many nonstationary models are statistical models and do not have enough physical basis debele et al 2017 li et al 2018 um et al 2017 yan and moradkhani 2015 climate change and human activities are the two main drivers of nonstationarity armal et al 2018 sowers et al 2011 the best performance of the climate informed model may partly come from its physical mechanisms in the future a physical based nonstationary model may be an essential method for nonstationary flood frequency analysis selecting reservoir indices climate indices land use and rainfall seasonality as explanatory variables may increase the robustness of nonstationary models zeng et al 2017 zhang et al 2015 discovering the uncertainty of floods from a perspective of well understood physical mechanisms is what we need following the discussion above the main conclusions are listed as follows 1 traditional stationary models have a relatively simple model structure but cannot capture the variations and nonstationarity of flood characteristics a stationary model may increase the risks when some historical extreme floods occur in contrast the nonstationary model can better quantify the return periods of floods and help us better operate hydraulic engineering structures with climate change and human activities 2 the time informed model is relatively easy to establish and does not require extra explanatory variables in this case the linear regression and quadratic regression were used in the ti l and ti q models respectively the results show that quadratic regression is necessary and can improve the dic based results in the tgd one of the defects of the time informed model is that the uncertainty in design value estimation is larger than that of the st model 3 the climate informed models have better performance than the time informed models based on the dic the climate informed model with four covariates achieves the best dic based performance in addition a climate informed model can decrease the uncertainty in the estimation of design values credit authorship contribution statement xu zhang conceptualization methodology writing original draft kai duan writing review editing validation supervision qianjin dong funding acquisition writing review editing visualization investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research is financially supported by the national key r d program of china grant no 2016yfc0401309 national natural science foundation of china grant nos 51979198 51909285 51439007 and innovation group of hubei natural science foundation grant no 2017cfa015 we thank dr peter caldwell from usda forest service for his valuable comments that have substantially improved the manuscript 
6072,reservoir operation rules play a key role in real time reservoir operation the main factors affecting operation decisions are the current reservoir status and the future inflows however the future reservoir inflows are stochastic and always contain uncertainty to study the influence of inflow uncertainty on reservoir operation rules this paper proposes a bayesian deep learning method that considers both model parameter uncertainty and inflow uncertainty in the model the monte carlo integration is used to convert the complex integrals of inflow probability into a summation form variational inference is employed to obtain the posterior distribution of model parameters the proposed method is applied to a real world application at three gorges project on the yangtze river the uncertainty estimation results show that the influence of inflow uncertainty on reservoir operation rule is greater than model parameter uncertainty and the decision of reservoir operation is more sensitive to the reservoir inflow during dry season than other seasons the experimental results demonstrate that the proposed bayesian deep learning performs better than the comparison method in term of hydropower generation and the root mean square errors moreover the proposed method is more robust than the comparison method when considering the inflow uncertainty keywords reservoir operation operation rule uncertainty analysis deep learning variational inference bayesian neural networks 1 introduction the reservoir operation system is a complex problem with many variables and constraints yakowitz 1982 although deterministic optimization methods such as dynamic programming and intelligent algorithms are able to derive the detail decision policies for each time step of the reservoir system yeh 1985 all these optimal operation decisions are based on perfect hydrologic forecast which is impossible practically a more desirable approach for real time operation is to use operation rules that specify operation decisions e g water level as a function of the current reservoir water level and inflow chen et al 2007 there are two main approaches to obtain such operational rules one approach is to predefine the form of the rules such as rule curves or rule tables and optimize the parameters in the rule by an optimization algorithm chang and chang 2009 liu et al 2019a however this approach lacks flexibility due to the limitation of its fixed rule form a more flexible approach is to use data mining methods to extract the optimal decision rules based on the deterministic reservoir optimization operation solutions feng et al 2019 during the last decades many methods have been applied to derive the reservoir operation rules such as linear regression lr simonovic 1987 young 1967 nonlinear regression bhaskar and whitlatch 1980 and fuzzy inference chang and chang 2001 with the development of computer science more and more researchers derived the reservoir operating rules using machine learning methods such as artificial neural networks ann bowden et al 2005 decision trees wei and hsu 2008 support vector machine svm karamouz et al 2009 and maximum relevance minimum redundancy algorithm hejazi and cai 2011 although the above methods have been successfully used to derive the reservoir operation rules the uncertainty of the rules needs to be analyzed and evaluated due to the uncertainty inherent in the reservoir operation models zhao et al 2012 the uncertainty of the decision models usually consists of two parts input variables uncertainty and model parameter uncertainty in recent years model uncertainty has attracted a lot of researchers attention the generalized likelihood uncertainty estimation glue and markov chain monte carlo method mcmc were used to analyze the model parameter uncertainty of the reservoir operation rules liu et al 2014 the uncertainty of reservoir operation rules was analyzed by using the bayesian model averaging model which combines three individual models zhang et al 2015 the grey relational analysis method and the bayesian model averaging method is combined to derive the monthly optimal operation rules for a hydropower reservoir fang et al 2018 the above studies mainly focused on the model parameter uncertainty in operation rules while the reservoir inflows are often unknown and contains many uncertainties therefore inflow uncertainty involved in the reservoir operation rules also needs to be estimated forecast uncertainty can be represented by the ensemble forecasting liu et al 2019b zhao et al 2016 the forecast interval khosravi et al 2011 ye et al 2016 or probability density function liu et al 2019d it is of great challenge to use the forecast inflow and its uncertainty information for operation rules in this work we proposed a framework to derive the reservoir operation rules that considers both the model parameter uncertainty and inflow uncertainty in the framework the inflow uncertainty is represented by a probabilistic streamflow forecasting model hidden markov model and gaussian mixture regression hmm gmr liu et al 2018 furthermore variational inference is employed to obtain the model parameters posterior distribution major contributions are outlined as follows 1 first and foremost a bayesian deep learning bdl method is proposed to derive the reservoir operation rules under multiple uncertainties monte carlo integration and variational bayesian inference techniques are coupled with the ann which enables ann to efficiently handle the inflow uncertainty and model parameter uncertainty simultaneously 2 bdl is applied to a real world case study at three gorges project tgp which has the largest installed hydropower capacity in the world the purpose of this application is to demonstrate the role of bdl in dealing with multiple uncertainties 3 the uncertainty estimations of the operation rules are shown which is aim at finding the impact of inflow uncertainty and model parameter uncertainty on the decision output the remainder of this paper is organized as follows in section 2 the methodology is given in detail which includes the deterministic reservoir optimization operation model probabilistic inflow forecasting model and the proposed bdl in section 3 an application of bdl on tgp is presented the discussion and conclusions are given in sections 4 and 5 2 methodology the framework for deriving reservoir operation rule under uncertainty is shown in fig 1 first the optimal deterministic reservoir operation solutions are generated through adaptive differential evolution algorithm adaptive de then the probabilistic forecast of 10 days ahead streamflow is given by hmm gmr based on the optimal operation processes and probabilistic forecast the reservoir operation rule is derived by bdl details of each step are given in the following subsections 2 1 deterministic reservoir operation to derive the reservoir operating rule the deterministic reservoir optimization operation solutions with the maximum potential benefit under perfect streamflow forecasting are needed in this study we focus on the maximization of hydropower generation e as the objective in our reservoir operation model 1 max e i 1 n n i δ t i i 1 n max η h i r i n max h i δ t i where n is the number of time steps δti is the time step length during time period i ni is power output during time period i output ni is a function of water head ht and release rt η is the power production coefficient of the hydropower plant n max hi is the expected maximum power output which is a function of water head hi the optimization is subject to the water balance equation water level constraint release constraint and power generation limits as follows 2 v i v i 1 i i r i δ t i 3 z i min z i z i max 4 r i min r i r i max 5 n i n min where ii is the inflow of the reservoir during time period i vi is the storage at beginning of time period i zi is the water level at beginning of time period i ranging from the minimum water level zmin i to the maximum water level z i max the release rt is ranging from the minimum release r i max to the maximum release rmax i the power output ni should be larger than the minimum power output n min the above model can be considered as a deterministic operation problem under the condition that the inflow ii i 1 n and initial and final reservoir storages are known however the future inflow is always uncertainty in real time reservoir operation therefore a reservoir operating rule considering the forecast uncertainty is necessary to be developed 2 2 probabilistic inflow forecasting in real time reservoir operation we can only get the current reservoir water level and historical inflow information future reservoir inflow information can help water resources managers make better utilization of water resources however future inflows are stochastic and uncertain so a probability forecasting model is needed to predict future inflows and the inflow uncertainty based on our previous work liu et al 2018 hmm gmr is applied to predict the 10 days ahead inflow in this study which can give the forecast probability distribution of the streamflow the main idea of hmm gmr is to train the hidden markov model hmm which joints forecasting streamflow and predictors using historical streamflow and then employ the gaussian mixture regression gmr to derive the probability distribution of future streamflow given the predictors the hmm consists of a discrete time discrete state markov chain and an observation model the markov chain of the hidden states can be represented as a transition probabilities matrix a as follows 6 a a 11 a 1 k a k 1 a kk where aij denotes the probability that the hidden state transition from i to j aij p zt j zt 1 i and satisfy 0 aij 1 with j aij 1 k is the total number of status categories zt denotes the hidden state at time t the observation model p xt zt k φk is a conditional probabilistic distribution given the hidden state zt in this study the conditional probabilistic distribution is defined as a multivariate gaussian distribution therefore the observation model can be formulated as follows 7 p x t z t k φ k n x t μ k σ k where φ is a set of parameters that govern the distribution φk μk σ k μk is the mean vector and σ k is the covariance matrix of the multivariate gaussian distribution with hidden state equals to k hmm is the joint probability distribution over both the hidden states and observed variables which can be formulated as follows 8 p x z θ p z 1 π t 2 t p z t z t 1 a t 1 t n x t μ z t σ z t where x x 1 x t z z 1 z t π is the initial probability and θ π μ σ denotes the set of parameters of hmm the baum welch algorithm baum et al 1970 which is a variant of the expectation maximization em algorithm is used to learn the parameters θ after learning the parameters of hmm the gmr approach is employed to derive the posterior conditional distribution given the predictors the joint data x can be divided into two subvectors x x 1 x 2 where x 1 denotes the predictors and x2 denotes the predictands thus the mean vector and covariance matrix of the multivariate gaussian distribution in each state of the hmm can also be divided as follows 9 μ k μ 1 k μ 2 k σ k σ 11 k σ 12 k σ 21 k σ 22 k k 1 k where k is the number of states of the hmm for each hidden state k the conditional mean vector μ 2 1 k and the estimated conditional covariance matrix σ 2 1 k of x 2 given x 1 are 10 μ 2 1 k μ 2 k σ 21 k σ 11 k 1 x 1 μ 1 k 11 σ 2 1 k σ 22 k σ 21 k σ 11 k 1 σ 12 k the conditional probability distribution function of x 2 given x 1 can be derive as follows 12 p x 2 x 1 k 1 k h k x 1 n μ 2 1 k σ 2 1 k 13 h k x t 1 i 1 k h i x t 1 1 a ik n x t 1 μ 1 k σ 11 k j 1 k i 1 k h i x t 1 1 a ij n x t 1 μ 1 j σ 11 j where h k x t 1 represents the hmm forward variable initialized with h k x t 1 π k n x 1 1 μ 11 k σ 11 k i 1 k π k n x 1 1 μ 11 i σ 11 i 2 3 reservoir operation rule considering multiple uncertainties after giving the optimal deterministic reservoir operation solutions and the future inflow prediction the vbnn method that considers both inflow uncertainty and model parameter uncertainty is used to mine the optimal reservoir operation rule from the historical optimal operation processes the conventional operation rules usually make decision through current water level and a deterministic inflow which can be described as a function y f zt it oliveira and loucks 1997 when considering the future inflow uncertainty the decision is no longer a point value but a distribution with some uncertainty by considering future inflow uncertainty the decision function can be formulated as follows 14 p y z t p y z t i t p i t d i t where zt is the current water level at beginning of time period t y is the decision variables y zt 1 zt 1 is the reservoir water level at the end of time period t to be decided it is the inflow during time period t and p it is the probability density function of inflow that can be derived by equation p y zt it can be view as the decision model which give the decision water level under the condition of zt and it furthermore when considering the uncertainty of model parameters the decision model can be rewritten as follows 15 p y z t i t p y z t i t ω p ω d ω where ω denotes the parameters of the model p ω is the distribution of the parameters substituting this model into equation the reservoir operation decision rule with both inflow uncertainty and parameters uncertainty is defined as follows 16 p y z t p y z t i t ω p ω p i t d ω d i t next we will describe how to implement this decision model using neural network nn and how to consider inflow uncertainty and parameters uncertainty in the model 2 3 1 neural network the nn is a powerful model for classification and regression that uses multiple neurons as hidden layers to extract the explicit information and relationship between input and output data when the number of hidden layers is greater than two nn is considered to be a dnn which can extract deeper relationships lecun et al 2015 using deep rather than shallow networks has two main advantages first deeper larger network achieve lower training losses and second deep network is more stable when handle the stochastic input variables the nn struct used in this study is shown in fig 2 the input data zt it and output data y zt 1 are fully connected by the hidden layers h 1 h n h 1 therefore the nn can be formulated as follows 17 y g f f f xw 1 b 1 w 2 b 2 w n h b n h where nh is the number of nn layers ignore the input layer w 1 w 2 w nh denote the weight matrices b 1 b 2 bnh denote the bias vectors f and g are activation functions in this study we use leaky relu maas et al 2013 with negative slope coefficient equaling to 0 2 as f and linear function as g for simplicity we set the ω w 1 w 2 w nh b 1 b 2 bnh which denote all the parameters in the model and write f y ω x for representing the nn model 18 y f y ω x f y ω z t i t traditional nns learn model parameters from given training data to give a determined output value next we will introduce how to couple forecast uncertainty and model parameter uncertainty into the deep learning model 2 3 2 multiple uncertainties in nn in this study inflow uncertainty and parameters uncertainty are considered in the model inflow uncertainty can be obtained by the probability density function of streamflow based on the prediction method described in section 2 2 19 p i t p x 2 x 1 k 1 k h k x 1 n μ 2 1 k σ 2 1 k where x 2 represent the forecast inflow it to embed the inflow uncertainty into the model we regard the inflow as a random variable obeying this probability distribution then equation can be approximated as follows 20 p y z t 1 l l p y z t i t ω p ω d ω i t p i t where l is the sample size of the approximation the larger the value of l the closer the approximation is to the true distribution this method is called the monte carlo integration by which complex integrals can be transformed into summation forms the remaining difficulty is the evaluation of the parameters uncertainty p ω from the bayesian perspective we need to estimate the posterior over the parameters given our observables x y p ω x y one approach is to give a prior distribution p 0 ω and then use bayesian rule to compute the true posterior distribution p ω x y p 0 ω p x y ω p x y however this posterior is not tractable for a bayesian ann neal 1996 and we use variational inference to solve this problem in variational inference a variational distribution qθ ω with the variational parameters θ should be defined to approximate the posterior the objective of variational inference is to minimize the kl divergence between qθ ω and p ω x y which is also equivalent to maximizing the evidence lower bound elbo 21 elbo l q θ k l q θ ω p ω q θ ω log p y x ω d ω k l q θ ω p ω n 1 n q θ ω log 1 l l p y n z t n i t n ω d ω k l q θ ω p ω where the first term l qθ is called the expected log likelihood the second term kl qθ ω p ω can act as a regularization term n is the number of samples in the training set i t n is a stochastic inflow sampled from the prediction distribution p in t regarding ω as random variables following the variational distribution the first term l qθ in equation can be approximated by monte carlo estimate 22 l q n m m 1 m log 1 l l p y m f y ω z t m i t m i t m p i t m ω q θ ω where the mini batch y m z t m i t m m 1 m consist of m data points randomly chosen from the full dataset y z t i t as shown by tishby et al 1989 the negative log likelihood can be rewritten as square loss y m f y ω z t m i t m 2 constant plugging this estimator in eq 21 the elbo can be approximated as follows 23 elob n m m 1 m 1 l l y m f y ω z t m i t m 2 k l q θ ω p ω following gal and ghahramani 2015 the variational distribution qθ ω is defined as a gaussian mixture distribution with two components 24 q θ ω p n θ σ 2 i 1 p n 0 σ 2 i where θ is the variational parameter p is a predefined probability σ is a small scalar with a normal prior distribution p ω of ω n 0 i the kl divergence can be approximated as follows 25 kl q θ ω p ω i 1 n h p i 2 θ i t θ i j i σ i 2 ln σ i 2 1 c where ji is the number of hidden units of ith layer c is a constant when suppose that the scalar σ is close to 0 and the constant c is ignored the kl divergence can be approximated as l2 regularization over the variational parameter θ the variational distribution qθ ω can be viewed as a bernoulli distribution with probabilities p therefore the model can be implemented by using bernoulli dropout srivastava et al 2014 and l2 regularization in the network the final training loss function is formulated as follows 26 loss n m m 1 m 1 l l y m f y ω z t m i t m 2 i 1 h l 2 r e g u l a r i z a t i o n θ i 2 3 3 output uncertainty after training the model the optimized variational distribution qθ ω can be used to approximate the true posterior distribution p ω x y then given a new data point x the output distribution of y can be approximated as 27 p y z t p y f y ω z t i t q θ ω p i t d ω d i t although the parameter distribution qθ ω and inflow distribution p it are known it is difficult to get the analytical solution of the output distribution in order to obtain the distribution of the model output monte carlo sampling is applied to generate multiple outputs 28 y 1 y 2 y s f y ω 1 z t i t 1 f y ω 2 z t i t 2 f y ω s z t i t s ω 1 ω 2 ω s q θ ω i t 1 i t 2 i t s p i t where s is sample number of monte carlo sampling this process is equivalent to performing s stochastic forward passes through the nn model the expectation of the model output can be obtained by averaging y 1 s s 1 s y s 2 4 simulation based training process in contrast to other regression or classification machine learning models the decision water level at time t is the initial water level at time t 1 of the reservoir which indicates that the model output zt 1 at time t will affect the model input at time t 1 therefore a rolling simulation based training process is proposed to optimize the model the steps of the process are as follows 1 give the initial water level z 0 at the first time period of the reservoir t 0 2 train the model using current water level zt and inflow it as input variables 3 predict the distribution of model output y1 y2 ys using eq and calculate the expectation output y as the decision water level 4 modify the decision water level if it does not satisfy the water level constraint release constraint and power generation constraint 5 set the water level at the beginning of the next period as the decision water level zt 1 y 6 repeat steps 2 5 for all time steps using the above reservoir simulation based optimization process the parameters bld models at all time periods are trained in real time reservoir operation simulation the rules can be used by repeating steps 3 5 for all time steps 3 case study 3 1 study area and data the three gorges project tgp with the largest installed hydropower capacity in the world is located in the middle of the yangtze river the location of tgp in the yangtze river basin is presented in fig 3 the catchment area of the upper yangtze river basin from headstream to tgp is about 1 000 000 km2 the average annual rainfall in the catchment is 1203 7 mm the normal reservoir storage water level is 175 m and the total reservoir storage capacity is 39 3 billion m3 of which flood control reservoir storage capacity is 22 15 billion m3 the tgp hydropower installation has 32 units with a single unit capacity of 700 mw and 2 units with a single unit capacity of 50 mw the total installed capacity of 22500 mw the main features of tgp are presented in table 1 historical streamflow obtained from the yichang station is used as the inflow for the tgp the time step used in deterministic reservoir operation is 10 days therefore the time step of streamflow forecasting is also set to be 10 days a total of 120 years streamflow series from 1883 6 to 2003 6 is used in our study since the streamflow after 2003 fundamentally changed due to reservoir regulation we do not use it in the study for both streamflow forecasting and reservoir operation rule mining the first 100 years 1883 6 1983 6 are used as calibration period and the remaining 20 years 1983 6 2003 6 3 2 results 3 2 1 optimal solution of deterministic reservoir operations an adaptive de algorithm liu et al 2019c is employed to obtain the optimal solution of deterministic reservoir operations the adaptive de is an evolutionary algorithm which uses an adaptive de operator for population recombination and polynomial mutation operators for mutation liu et al 2019 in this paper the population consists of 50 individuals and water level is used as the decision variable to encode the individuals every individual vector is expressed as a series of water levels that is ind j zj 1 zj t zj t where zj t is the water level of the j th individual in the t th period the constraint handling strategies described in qin et al 2010 are used for the constraint problem as shown in table 4 the average annual hydropower generation is 96 57 billion kwh during calibration period and 92 95 billion kwh during validation period the deterministic reservoir operation optimization model is to maximize the hydropower generation the power production coefficient of the hydropower plant k is 8 8 the minimum output is the firm output of tgp 4990 mw the maximum output is determined by the expected maximum power output under a water head the initial and final water levels are set to 145 0 m in the model the minimum and maximum water levels of the tgr are 145 m and 146 5 m during the flood seasons and 155 m and 175 m during the non flood seasons respectively the minimum discharge is set to 5000 m3 s and the maximum discharge is determined by considering the flood control the capacity of spillway 3 2 2 probabilistic forecasting results the antecedent streamflow it 1 it 2 and it 36 are chosen as the prediction factors the linear regression lr is also applied to forecast the 10 days inflow as the comparative model firstly we evaluated the prediction accuracy based on the root mean square errors rmse mean absolute errors mae and nash sutcliffe coefficient of efficiency nsc sun et al 2014 table 2 shows the rmse mae and nsc of hmm gmr and lr in calibration period and validation period the mean of the probability forecast for hmm gmr is used to calculate rmse mae and nsc it can be seen obviously form the table that hmm gmr outperforms lr in terms of rmse mae and nsc for both calibration and validation periods this result proves that hmm gmr can give an accurate prediction for 10 days streamflow in contrast to lr hmm gmr also provide the distribution of the forecast streamflow fig 4 shows the forecasting results of hmm gmr during validation period the 95 credible interval and 80 credible interval of hmm gmr is also plotted in the figure in addition hmm gmr gives an appropriate probability density estimate of the data points because most of the observed points are in the credible interval fig 5 gives the illustration of uncertainty estimation and the probability integral transform pit uniform probability plot of the streamflow forecasting it can be seen from fig 5 a that hmm gmr gets a linear relationship between the observed streamflow and the prediction the uncertainty of the forecast is larger in flood season and smaller in non flood season the pit uniform probability plot is to verify the reliability of the forecast laio and tamea 2007 in the figure the pit values are generally close to the diagonal line and all points are located within the kolmogorov 5 significance band which indicates that the probabilistic forecasts are not excessively high or low or excessively wide or narrow therefore the forecast probability distributions are convincing and reliable 3 2 3 results of reservoir operation rules four reservoir operation rules are developed by using the proposed bayesian deep learning bdl method 1 reservoir operation rule which uses probabilistic forecast inflow for both model training and validation rule1 2 reservoir operation rule which do not consider the future inflow rule2 3 reservoir operation rule which uses historical observed inflow for model training and uses probabilistic forecast inflow for validation rule3 4 reservoir operation rule which uses perfect point inflow forecast for both model training and validation rule4 all these four rules are trained based on bdl with the same structure moreover two comparison rules are developed by using lr model 1 reservoir operation rule uses perfect point inflow forecast for both model training and validation lr1 2 reservoir operation rule which uses historical observed inflow for model training and uses probabilistic forecast inflow for validation lr2 the characteristics of all operation rules are shown in table 3 the number of hidden layers in bdl is set to be 3 each of which consists of 64 nodes the predefined probability p in bdl is set as 0 5 all bdl models are trained using adam optimizer with 1000 epoch application of these models are performed over a single nvidia geforce 940mx gpu on python 3 6 and keras 2 2 4 with tensorflow 1 11 0 backend lr models are implemented by the scikit learn package on python https scikit learn org to verify the performance of the reservoir operation rules three metrics are used in this study including rmse of the optimal water level and simulated water level based on operation rules the average annual hydropower generation based on rules simulation and the rate of satisfying the output constraint based on rules simulation the results of the deterministic optimal reservoir operation four rules based on based on bdl and two rules based on lr are shown in table 4 we use the results of deterministic optimal reservoir operation as a benchmark for comparison because it has potential maximum benefit under perfect streamflow forecasting as can be seen from the table rule4 and lr1 are the best and second best rules in terms of rmse and power generation because they use perfect 10 days inflow forecast observed inflow compared rule4 with lr1 rule4 has a better performance than lr1 with 14 6 rmse improvements which indicates that bdl outperforms lr in term of rmse in real time reservoir operation only forecast inflow can be used for operation manager in contrast to these two rules rule1 rule2 rule3 and lr2 use probability inflow forecast during simulation rule1 outperform other rules in term of both rmse and power generation the performance of rule3 is similar to rule1 which shows that using historical observed inflow to train the model and use forecast inflow for simulation is also a good choice rule2 in which do not consider the inflow is worse than rule1 and rule3 the result demonstrates that the probabilistic inflow forecasting based on hmm gmr can improve the power generation of the rule rule4 and lr1 outperform rule1 and rule3 which proves that more accurate of the inflow forecast will result in a better reservoir operation rule the training process and simulation process of lr2 is the same as rule3 but obtain the worst performance among the rules which demonstrates that bld is more robust than lr when the input variables are stochastic 3 2 4 comparison of nns with different structure this section gives the comparison results of different nns with different structure the structure of the first nn is shown in section 3 2 3 which has 3 hidden layers each of which consists of 64 nodes the structure of the second nn has only 1 hidden layer with 8 nodes which is a shallow network four reservoir operation rules rule 1 4 described in section 3 2 3 are developed the two models table 5 shows the rmse values of the four rules trained by the two nns from the table we can see that the nn with one hidden layer is not much different from the nn with three hidden layers in term of rmse values for rule1 rule2 and rule4 this phenomenon indicates that shallow nn is able to capture the relationship between input and output variables even better than deeper nn in some cases however the rmse values of rule3 of shallow nn is significant worse than deeper nn which indicates that deeper nn is more stable when input variables are stochastic than shallow nn we think the shallow nn is too sensitive to the input variables and may contains more uncertainty in the model therefore we recommend using a deeper nn as a training model for devring the reservoir operation rules rather than the shallow nn 3 2 5 uncertainty estimation of reservoir operation rules fig 6 shows the simulation results of six reservoir operation rules the corresponding inflow data used in the rule are also illustrated the 80 confidence intervals of simulation water level are shown in green shadow lr1 does not consider the model uncertainty or inflow uncertainty so its simulation water level is a point in rule2 and rule4 the inflow uncertainty is not into consideration the 80 confidence intervals of rule2 and rule4 represent the model uncertainty lr2 uses probabilistic inflow forecasting for simulation thus the 80 confidence interval represent the inflow uncertainty it can be seen form that the intervals of lr2 are much wider than the intervals of rule2 and rule4 which demonstrates that the inflow uncertainty has a greater impact on reservoir operation than model uncertainty rule1 and rule3 consider both model uncertainty and inflow uncertainty however the intervals of rule3 are wider than the intervals of rule1 this result demonstrates that using probabilistic inflow forecasting for training can reduce the decision uncertainty cause by inflow uncertainty as shown in fig 6 the intervals of water level during dry season are wider than the intervals during flood season while the intervals of inflow during dry season are narrower than the intervals during flood season this indicates that although the uncertainty of the inflow in the dry season is small the decision water level is very sensitive to it which lead to a large uncertainty the uncertainty of the decision water level is small even if the uncertainty of inflow is large during flood season which is due to the limitation of flood control level accordingly as for hydropower operation the operator should pay more attention the inflow forecasting during dry season fig 7 illustrates the distribution of reservoir operation decisions obtained by rule1 rule2 rule3 rule4 and lr2 in contrast to lr1 these rules can not only give a point decision water level but a range of the optimal decisions such operation rules can give decision makers more potential selections in practice the corresponding optimal water level can be given according to the real time inflow forecasting situation power generation limits water level constraint and release constraint 4 discussion the above section indicates that the proposed bdl can give a distribution of decision water level for decision making this section gives a detail discussion of the proposed method refer to other models in other studies for reservoir operation yang et al 2016 proposed a robust reservoir operation model using the classification and regression tree algorithm cart combined with a shuffled cross validation scheme compared to their paper although we all use data mining methods to capture the relationship between reservoir decision and input variables they are more concerned with changing climate such as water delivery requirement environmental constraints and dry wet conditions and we are more concerned with the uncertainty of the inflow and model parameter liu et al 2019a proposed a multi objective hierarchical reservoir flood operation rule hfor which is optimized by a multi objective evolutionary algorithm different form our study the operation rule in this paper is represented by a neural network model but the hfor has its fixed rule form and the parameters of the rule are optimized by evolutionary algorithm which is less flexible however the hfor can handle multi objectives such as flood control power generation navigation etc while bdl is hard to handle multi objective problems wang et al 2019 proposed an improved operation based reservoir scheme to simulate the storage and outflow variations for multiyear and multipurpose reservoirs at a daily time step the new operation based reservoir scheme is neither optimized by the evolutionary algorithm or trained by the data mining method but determines the outflow according to the current reservoir storage level and the trade off relationship between multiple purposes of the reservoir this reservoir operation rule improves the feasibility and applicability of previous operation based reservoir schemes for actual reservoir operation applications overall the bdl proposed in this paper is recommended due to the following two advantages one is that the bdl is a flexible data mining method that can capture the relationship between reservoir decision and input variables from historical reservoir operation data or hypothetical optimal reservoir operation solution the other is that the bdl consider both the reservoir inflow uncertainty and the model parameter uncertainty which can give a reasonable range of the decision water level to water resource manager under the multiple uncertainties the further improvements of this work are suggested to focus on the following aspects as mentioned above the model needs to further consider the impact of climate change water quality requirements and ecosystem water demand on reservoir operation decisions moreover we need to combine the data mining method with multi objective evolutionary algorithm to derive optimal operation rule for multipurpose reservoirs such as flood control hydropower generation navigation and ecological flow control etc 5 conclusion reservoir operation rules play a key role in real time reservoir operation which specify operation decisions as a function of the current reservoir water level and the inflow however the decision model and the inflow always contain uncertainty this study proposes a bayesian deep learning method which considers both model parameter uncertainty and inflow uncertainty the monte carlo integration is used to transform complex integrals of inflow probability into summation forms variational inference is employed to obtain the model parameter posterior distribution the proposed method is applied to a real world application at three gorges project on the yangtze river four reservoir operation rules with different training input variables are developed by the proposed bayesian deep learning method two reservoir operation rules are developed by linear regression method the conclusion is summarized as follows 1 bdl perform better than lr in terms of both rmse and hydropower generation 2 bdl is more reliable and robust when using probabilistic forecast inflow as model input 3 the inflow uncertainty has greater impact on the decision output than model parameter uncertainty 4 the decision output is more sensitive to the inflow during dry season than other seasons 5 using probabilistic inflow forecasting for training can reduce the decision uncertainty cause by inflow uncertainty declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national key r d program of china 2016yfc0402209 the national natural science foundation of china no 91647114 51979113 50779013 91547208 the national public research institutes for basic r d operating expenses special project cksf2017061 sz the fundamental research funds for the central universities hust 2016yxzd047 and special thanks are given to the anonymous reviewers and editors for their constructive comments 
6072,reservoir operation rules play a key role in real time reservoir operation the main factors affecting operation decisions are the current reservoir status and the future inflows however the future reservoir inflows are stochastic and always contain uncertainty to study the influence of inflow uncertainty on reservoir operation rules this paper proposes a bayesian deep learning method that considers both model parameter uncertainty and inflow uncertainty in the model the monte carlo integration is used to convert the complex integrals of inflow probability into a summation form variational inference is employed to obtain the posterior distribution of model parameters the proposed method is applied to a real world application at three gorges project on the yangtze river the uncertainty estimation results show that the influence of inflow uncertainty on reservoir operation rule is greater than model parameter uncertainty and the decision of reservoir operation is more sensitive to the reservoir inflow during dry season than other seasons the experimental results demonstrate that the proposed bayesian deep learning performs better than the comparison method in term of hydropower generation and the root mean square errors moreover the proposed method is more robust than the comparison method when considering the inflow uncertainty keywords reservoir operation operation rule uncertainty analysis deep learning variational inference bayesian neural networks 1 introduction the reservoir operation system is a complex problem with many variables and constraints yakowitz 1982 although deterministic optimization methods such as dynamic programming and intelligent algorithms are able to derive the detail decision policies for each time step of the reservoir system yeh 1985 all these optimal operation decisions are based on perfect hydrologic forecast which is impossible practically a more desirable approach for real time operation is to use operation rules that specify operation decisions e g water level as a function of the current reservoir water level and inflow chen et al 2007 there are two main approaches to obtain such operational rules one approach is to predefine the form of the rules such as rule curves or rule tables and optimize the parameters in the rule by an optimization algorithm chang and chang 2009 liu et al 2019a however this approach lacks flexibility due to the limitation of its fixed rule form a more flexible approach is to use data mining methods to extract the optimal decision rules based on the deterministic reservoir optimization operation solutions feng et al 2019 during the last decades many methods have been applied to derive the reservoir operation rules such as linear regression lr simonovic 1987 young 1967 nonlinear regression bhaskar and whitlatch 1980 and fuzzy inference chang and chang 2001 with the development of computer science more and more researchers derived the reservoir operating rules using machine learning methods such as artificial neural networks ann bowden et al 2005 decision trees wei and hsu 2008 support vector machine svm karamouz et al 2009 and maximum relevance minimum redundancy algorithm hejazi and cai 2011 although the above methods have been successfully used to derive the reservoir operation rules the uncertainty of the rules needs to be analyzed and evaluated due to the uncertainty inherent in the reservoir operation models zhao et al 2012 the uncertainty of the decision models usually consists of two parts input variables uncertainty and model parameter uncertainty in recent years model uncertainty has attracted a lot of researchers attention the generalized likelihood uncertainty estimation glue and markov chain monte carlo method mcmc were used to analyze the model parameter uncertainty of the reservoir operation rules liu et al 2014 the uncertainty of reservoir operation rules was analyzed by using the bayesian model averaging model which combines three individual models zhang et al 2015 the grey relational analysis method and the bayesian model averaging method is combined to derive the monthly optimal operation rules for a hydropower reservoir fang et al 2018 the above studies mainly focused on the model parameter uncertainty in operation rules while the reservoir inflows are often unknown and contains many uncertainties therefore inflow uncertainty involved in the reservoir operation rules also needs to be estimated forecast uncertainty can be represented by the ensemble forecasting liu et al 2019b zhao et al 2016 the forecast interval khosravi et al 2011 ye et al 2016 or probability density function liu et al 2019d it is of great challenge to use the forecast inflow and its uncertainty information for operation rules in this work we proposed a framework to derive the reservoir operation rules that considers both the model parameter uncertainty and inflow uncertainty in the framework the inflow uncertainty is represented by a probabilistic streamflow forecasting model hidden markov model and gaussian mixture regression hmm gmr liu et al 2018 furthermore variational inference is employed to obtain the model parameters posterior distribution major contributions are outlined as follows 1 first and foremost a bayesian deep learning bdl method is proposed to derive the reservoir operation rules under multiple uncertainties monte carlo integration and variational bayesian inference techniques are coupled with the ann which enables ann to efficiently handle the inflow uncertainty and model parameter uncertainty simultaneously 2 bdl is applied to a real world case study at three gorges project tgp which has the largest installed hydropower capacity in the world the purpose of this application is to demonstrate the role of bdl in dealing with multiple uncertainties 3 the uncertainty estimations of the operation rules are shown which is aim at finding the impact of inflow uncertainty and model parameter uncertainty on the decision output the remainder of this paper is organized as follows in section 2 the methodology is given in detail which includes the deterministic reservoir optimization operation model probabilistic inflow forecasting model and the proposed bdl in section 3 an application of bdl on tgp is presented the discussion and conclusions are given in sections 4 and 5 2 methodology the framework for deriving reservoir operation rule under uncertainty is shown in fig 1 first the optimal deterministic reservoir operation solutions are generated through adaptive differential evolution algorithm adaptive de then the probabilistic forecast of 10 days ahead streamflow is given by hmm gmr based on the optimal operation processes and probabilistic forecast the reservoir operation rule is derived by bdl details of each step are given in the following subsections 2 1 deterministic reservoir operation to derive the reservoir operating rule the deterministic reservoir optimization operation solutions with the maximum potential benefit under perfect streamflow forecasting are needed in this study we focus on the maximization of hydropower generation e as the objective in our reservoir operation model 1 max e i 1 n n i δ t i i 1 n max η h i r i n max h i δ t i where n is the number of time steps δti is the time step length during time period i ni is power output during time period i output ni is a function of water head ht and release rt η is the power production coefficient of the hydropower plant n max hi is the expected maximum power output which is a function of water head hi the optimization is subject to the water balance equation water level constraint release constraint and power generation limits as follows 2 v i v i 1 i i r i δ t i 3 z i min z i z i max 4 r i min r i r i max 5 n i n min where ii is the inflow of the reservoir during time period i vi is the storage at beginning of time period i zi is the water level at beginning of time period i ranging from the minimum water level zmin i to the maximum water level z i max the release rt is ranging from the minimum release r i max to the maximum release rmax i the power output ni should be larger than the minimum power output n min the above model can be considered as a deterministic operation problem under the condition that the inflow ii i 1 n and initial and final reservoir storages are known however the future inflow is always uncertainty in real time reservoir operation therefore a reservoir operating rule considering the forecast uncertainty is necessary to be developed 2 2 probabilistic inflow forecasting in real time reservoir operation we can only get the current reservoir water level and historical inflow information future reservoir inflow information can help water resources managers make better utilization of water resources however future inflows are stochastic and uncertain so a probability forecasting model is needed to predict future inflows and the inflow uncertainty based on our previous work liu et al 2018 hmm gmr is applied to predict the 10 days ahead inflow in this study which can give the forecast probability distribution of the streamflow the main idea of hmm gmr is to train the hidden markov model hmm which joints forecasting streamflow and predictors using historical streamflow and then employ the gaussian mixture regression gmr to derive the probability distribution of future streamflow given the predictors the hmm consists of a discrete time discrete state markov chain and an observation model the markov chain of the hidden states can be represented as a transition probabilities matrix a as follows 6 a a 11 a 1 k a k 1 a kk where aij denotes the probability that the hidden state transition from i to j aij p zt j zt 1 i and satisfy 0 aij 1 with j aij 1 k is the total number of status categories zt denotes the hidden state at time t the observation model p xt zt k φk is a conditional probabilistic distribution given the hidden state zt in this study the conditional probabilistic distribution is defined as a multivariate gaussian distribution therefore the observation model can be formulated as follows 7 p x t z t k φ k n x t μ k σ k where φ is a set of parameters that govern the distribution φk μk σ k μk is the mean vector and σ k is the covariance matrix of the multivariate gaussian distribution with hidden state equals to k hmm is the joint probability distribution over both the hidden states and observed variables which can be formulated as follows 8 p x z θ p z 1 π t 2 t p z t z t 1 a t 1 t n x t μ z t σ z t where x x 1 x t z z 1 z t π is the initial probability and θ π μ σ denotes the set of parameters of hmm the baum welch algorithm baum et al 1970 which is a variant of the expectation maximization em algorithm is used to learn the parameters θ after learning the parameters of hmm the gmr approach is employed to derive the posterior conditional distribution given the predictors the joint data x can be divided into two subvectors x x 1 x 2 where x 1 denotes the predictors and x2 denotes the predictands thus the mean vector and covariance matrix of the multivariate gaussian distribution in each state of the hmm can also be divided as follows 9 μ k μ 1 k μ 2 k σ k σ 11 k σ 12 k σ 21 k σ 22 k k 1 k where k is the number of states of the hmm for each hidden state k the conditional mean vector μ 2 1 k and the estimated conditional covariance matrix σ 2 1 k of x 2 given x 1 are 10 μ 2 1 k μ 2 k σ 21 k σ 11 k 1 x 1 μ 1 k 11 σ 2 1 k σ 22 k σ 21 k σ 11 k 1 σ 12 k the conditional probability distribution function of x 2 given x 1 can be derive as follows 12 p x 2 x 1 k 1 k h k x 1 n μ 2 1 k σ 2 1 k 13 h k x t 1 i 1 k h i x t 1 1 a ik n x t 1 μ 1 k σ 11 k j 1 k i 1 k h i x t 1 1 a ij n x t 1 μ 1 j σ 11 j where h k x t 1 represents the hmm forward variable initialized with h k x t 1 π k n x 1 1 μ 11 k σ 11 k i 1 k π k n x 1 1 μ 11 i σ 11 i 2 3 reservoir operation rule considering multiple uncertainties after giving the optimal deterministic reservoir operation solutions and the future inflow prediction the vbnn method that considers both inflow uncertainty and model parameter uncertainty is used to mine the optimal reservoir operation rule from the historical optimal operation processes the conventional operation rules usually make decision through current water level and a deterministic inflow which can be described as a function y f zt it oliveira and loucks 1997 when considering the future inflow uncertainty the decision is no longer a point value but a distribution with some uncertainty by considering future inflow uncertainty the decision function can be formulated as follows 14 p y z t p y z t i t p i t d i t where zt is the current water level at beginning of time period t y is the decision variables y zt 1 zt 1 is the reservoir water level at the end of time period t to be decided it is the inflow during time period t and p it is the probability density function of inflow that can be derived by equation p y zt it can be view as the decision model which give the decision water level under the condition of zt and it furthermore when considering the uncertainty of model parameters the decision model can be rewritten as follows 15 p y z t i t p y z t i t ω p ω d ω where ω denotes the parameters of the model p ω is the distribution of the parameters substituting this model into equation the reservoir operation decision rule with both inflow uncertainty and parameters uncertainty is defined as follows 16 p y z t p y z t i t ω p ω p i t d ω d i t next we will describe how to implement this decision model using neural network nn and how to consider inflow uncertainty and parameters uncertainty in the model 2 3 1 neural network the nn is a powerful model for classification and regression that uses multiple neurons as hidden layers to extract the explicit information and relationship between input and output data when the number of hidden layers is greater than two nn is considered to be a dnn which can extract deeper relationships lecun et al 2015 using deep rather than shallow networks has two main advantages first deeper larger network achieve lower training losses and second deep network is more stable when handle the stochastic input variables the nn struct used in this study is shown in fig 2 the input data zt it and output data y zt 1 are fully connected by the hidden layers h 1 h n h 1 therefore the nn can be formulated as follows 17 y g f f f xw 1 b 1 w 2 b 2 w n h b n h where nh is the number of nn layers ignore the input layer w 1 w 2 w nh denote the weight matrices b 1 b 2 bnh denote the bias vectors f and g are activation functions in this study we use leaky relu maas et al 2013 with negative slope coefficient equaling to 0 2 as f and linear function as g for simplicity we set the ω w 1 w 2 w nh b 1 b 2 bnh which denote all the parameters in the model and write f y ω x for representing the nn model 18 y f y ω x f y ω z t i t traditional nns learn model parameters from given training data to give a determined output value next we will introduce how to couple forecast uncertainty and model parameter uncertainty into the deep learning model 2 3 2 multiple uncertainties in nn in this study inflow uncertainty and parameters uncertainty are considered in the model inflow uncertainty can be obtained by the probability density function of streamflow based on the prediction method described in section 2 2 19 p i t p x 2 x 1 k 1 k h k x 1 n μ 2 1 k σ 2 1 k where x 2 represent the forecast inflow it to embed the inflow uncertainty into the model we regard the inflow as a random variable obeying this probability distribution then equation can be approximated as follows 20 p y z t 1 l l p y z t i t ω p ω d ω i t p i t where l is the sample size of the approximation the larger the value of l the closer the approximation is to the true distribution this method is called the monte carlo integration by which complex integrals can be transformed into summation forms the remaining difficulty is the evaluation of the parameters uncertainty p ω from the bayesian perspective we need to estimate the posterior over the parameters given our observables x y p ω x y one approach is to give a prior distribution p 0 ω and then use bayesian rule to compute the true posterior distribution p ω x y p 0 ω p x y ω p x y however this posterior is not tractable for a bayesian ann neal 1996 and we use variational inference to solve this problem in variational inference a variational distribution qθ ω with the variational parameters θ should be defined to approximate the posterior the objective of variational inference is to minimize the kl divergence between qθ ω and p ω x y which is also equivalent to maximizing the evidence lower bound elbo 21 elbo l q θ k l q θ ω p ω q θ ω log p y x ω d ω k l q θ ω p ω n 1 n q θ ω log 1 l l p y n z t n i t n ω d ω k l q θ ω p ω where the first term l qθ is called the expected log likelihood the second term kl qθ ω p ω can act as a regularization term n is the number of samples in the training set i t n is a stochastic inflow sampled from the prediction distribution p in t regarding ω as random variables following the variational distribution the first term l qθ in equation can be approximated by monte carlo estimate 22 l q n m m 1 m log 1 l l p y m f y ω z t m i t m i t m p i t m ω q θ ω where the mini batch y m z t m i t m m 1 m consist of m data points randomly chosen from the full dataset y z t i t as shown by tishby et al 1989 the negative log likelihood can be rewritten as square loss y m f y ω z t m i t m 2 constant plugging this estimator in eq 21 the elbo can be approximated as follows 23 elob n m m 1 m 1 l l y m f y ω z t m i t m 2 k l q θ ω p ω following gal and ghahramani 2015 the variational distribution qθ ω is defined as a gaussian mixture distribution with two components 24 q θ ω p n θ σ 2 i 1 p n 0 σ 2 i where θ is the variational parameter p is a predefined probability σ is a small scalar with a normal prior distribution p ω of ω n 0 i the kl divergence can be approximated as follows 25 kl q θ ω p ω i 1 n h p i 2 θ i t θ i j i σ i 2 ln σ i 2 1 c where ji is the number of hidden units of ith layer c is a constant when suppose that the scalar σ is close to 0 and the constant c is ignored the kl divergence can be approximated as l2 regularization over the variational parameter θ the variational distribution qθ ω can be viewed as a bernoulli distribution with probabilities p therefore the model can be implemented by using bernoulli dropout srivastava et al 2014 and l2 regularization in the network the final training loss function is formulated as follows 26 loss n m m 1 m 1 l l y m f y ω z t m i t m 2 i 1 h l 2 r e g u l a r i z a t i o n θ i 2 3 3 output uncertainty after training the model the optimized variational distribution qθ ω can be used to approximate the true posterior distribution p ω x y then given a new data point x the output distribution of y can be approximated as 27 p y z t p y f y ω z t i t q θ ω p i t d ω d i t although the parameter distribution qθ ω and inflow distribution p it are known it is difficult to get the analytical solution of the output distribution in order to obtain the distribution of the model output monte carlo sampling is applied to generate multiple outputs 28 y 1 y 2 y s f y ω 1 z t i t 1 f y ω 2 z t i t 2 f y ω s z t i t s ω 1 ω 2 ω s q θ ω i t 1 i t 2 i t s p i t where s is sample number of monte carlo sampling this process is equivalent to performing s stochastic forward passes through the nn model the expectation of the model output can be obtained by averaging y 1 s s 1 s y s 2 4 simulation based training process in contrast to other regression or classification machine learning models the decision water level at time t is the initial water level at time t 1 of the reservoir which indicates that the model output zt 1 at time t will affect the model input at time t 1 therefore a rolling simulation based training process is proposed to optimize the model the steps of the process are as follows 1 give the initial water level z 0 at the first time period of the reservoir t 0 2 train the model using current water level zt and inflow it as input variables 3 predict the distribution of model output y1 y2 ys using eq and calculate the expectation output y as the decision water level 4 modify the decision water level if it does not satisfy the water level constraint release constraint and power generation constraint 5 set the water level at the beginning of the next period as the decision water level zt 1 y 6 repeat steps 2 5 for all time steps using the above reservoir simulation based optimization process the parameters bld models at all time periods are trained in real time reservoir operation simulation the rules can be used by repeating steps 3 5 for all time steps 3 case study 3 1 study area and data the three gorges project tgp with the largest installed hydropower capacity in the world is located in the middle of the yangtze river the location of tgp in the yangtze river basin is presented in fig 3 the catchment area of the upper yangtze river basin from headstream to tgp is about 1 000 000 km2 the average annual rainfall in the catchment is 1203 7 mm the normal reservoir storage water level is 175 m and the total reservoir storage capacity is 39 3 billion m3 of which flood control reservoir storage capacity is 22 15 billion m3 the tgp hydropower installation has 32 units with a single unit capacity of 700 mw and 2 units with a single unit capacity of 50 mw the total installed capacity of 22500 mw the main features of tgp are presented in table 1 historical streamflow obtained from the yichang station is used as the inflow for the tgp the time step used in deterministic reservoir operation is 10 days therefore the time step of streamflow forecasting is also set to be 10 days a total of 120 years streamflow series from 1883 6 to 2003 6 is used in our study since the streamflow after 2003 fundamentally changed due to reservoir regulation we do not use it in the study for both streamflow forecasting and reservoir operation rule mining the first 100 years 1883 6 1983 6 are used as calibration period and the remaining 20 years 1983 6 2003 6 3 2 results 3 2 1 optimal solution of deterministic reservoir operations an adaptive de algorithm liu et al 2019c is employed to obtain the optimal solution of deterministic reservoir operations the adaptive de is an evolutionary algorithm which uses an adaptive de operator for population recombination and polynomial mutation operators for mutation liu et al 2019 in this paper the population consists of 50 individuals and water level is used as the decision variable to encode the individuals every individual vector is expressed as a series of water levels that is ind j zj 1 zj t zj t where zj t is the water level of the j th individual in the t th period the constraint handling strategies described in qin et al 2010 are used for the constraint problem as shown in table 4 the average annual hydropower generation is 96 57 billion kwh during calibration period and 92 95 billion kwh during validation period the deterministic reservoir operation optimization model is to maximize the hydropower generation the power production coefficient of the hydropower plant k is 8 8 the minimum output is the firm output of tgp 4990 mw the maximum output is determined by the expected maximum power output under a water head the initial and final water levels are set to 145 0 m in the model the minimum and maximum water levels of the tgr are 145 m and 146 5 m during the flood seasons and 155 m and 175 m during the non flood seasons respectively the minimum discharge is set to 5000 m3 s and the maximum discharge is determined by considering the flood control the capacity of spillway 3 2 2 probabilistic forecasting results the antecedent streamflow it 1 it 2 and it 36 are chosen as the prediction factors the linear regression lr is also applied to forecast the 10 days inflow as the comparative model firstly we evaluated the prediction accuracy based on the root mean square errors rmse mean absolute errors mae and nash sutcliffe coefficient of efficiency nsc sun et al 2014 table 2 shows the rmse mae and nsc of hmm gmr and lr in calibration period and validation period the mean of the probability forecast for hmm gmr is used to calculate rmse mae and nsc it can be seen obviously form the table that hmm gmr outperforms lr in terms of rmse mae and nsc for both calibration and validation periods this result proves that hmm gmr can give an accurate prediction for 10 days streamflow in contrast to lr hmm gmr also provide the distribution of the forecast streamflow fig 4 shows the forecasting results of hmm gmr during validation period the 95 credible interval and 80 credible interval of hmm gmr is also plotted in the figure in addition hmm gmr gives an appropriate probability density estimate of the data points because most of the observed points are in the credible interval fig 5 gives the illustration of uncertainty estimation and the probability integral transform pit uniform probability plot of the streamflow forecasting it can be seen from fig 5 a that hmm gmr gets a linear relationship between the observed streamflow and the prediction the uncertainty of the forecast is larger in flood season and smaller in non flood season the pit uniform probability plot is to verify the reliability of the forecast laio and tamea 2007 in the figure the pit values are generally close to the diagonal line and all points are located within the kolmogorov 5 significance band which indicates that the probabilistic forecasts are not excessively high or low or excessively wide or narrow therefore the forecast probability distributions are convincing and reliable 3 2 3 results of reservoir operation rules four reservoir operation rules are developed by using the proposed bayesian deep learning bdl method 1 reservoir operation rule which uses probabilistic forecast inflow for both model training and validation rule1 2 reservoir operation rule which do not consider the future inflow rule2 3 reservoir operation rule which uses historical observed inflow for model training and uses probabilistic forecast inflow for validation rule3 4 reservoir operation rule which uses perfect point inflow forecast for both model training and validation rule4 all these four rules are trained based on bdl with the same structure moreover two comparison rules are developed by using lr model 1 reservoir operation rule uses perfect point inflow forecast for both model training and validation lr1 2 reservoir operation rule which uses historical observed inflow for model training and uses probabilistic forecast inflow for validation lr2 the characteristics of all operation rules are shown in table 3 the number of hidden layers in bdl is set to be 3 each of which consists of 64 nodes the predefined probability p in bdl is set as 0 5 all bdl models are trained using adam optimizer with 1000 epoch application of these models are performed over a single nvidia geforce 940mx gpu on python 3 6 and keras 2 2 4 with tensorflow 1 11 0 backend lr models are implemented by the scikit learn package on python https scikit learn org to verify the performance of the reservoir operation rules three metrics are used in this study including rmse of the optimal water level and simulated water level based on operation rules the average annual hydropower generation based on rules simulation and the rate of satisfying the output constraint based on rules simulation the results of the deterministic optimal reservoir operation four rules based on based on bdl and two rules based on lr are shown in table 4 we use the results of deterministic optimal reservoir operation as a benchmark for comparison because it has potential maximum benefit under perfect streamflow forecasting as can be seen from the table rule4 and lr1 are the best and second best rules in terms of rmse and power generation because they use perfect 10 days inflow forecast observed inflow compared rule4 with lr1 rule4 has a better performance than lr1 with 14 6 rmse improvements which indicates that bdl outperforms lr in term of rmse in real time reservoir operation only forecast inflow can be used for operation manager in contrast to these two rules rule1 rule2 rule3 and lr2 use probability inflow forecast during simulation rule1 outperform other rules in term of both rmse and power generation the performance of rule3 is similar to rule1 which shows that using historical observed inflow to train the model and use forecast inflow for simulation is also a good choice rule2 in which do not consider the inflow is worse than rule1 and rule3 the result demonstrates that the probabilistic inflow forecasting based on hmm gmr can improve the power generation of the rule rule4 and lr1 outperform rule1 and rule3 which proves that more accurate of the inflow forecast will result in a better reservoir operation rule the training process and simulation process of lr2 is the same as rule3 but obtain the worst performance among the rules which demonstrates that bld is more robust than lr when the input variables are stochastic 3 2 4 comparison of nns with different structure this section gives the comparison results of different nns with different structure the structure of the first nn is shown in section 3 2 3 which has 3 hidden layers each of which consists of 64 nodes the structure of the second nn has only 1 hidden layer with 8 nodes which is a shallow network four reservoir operation rules rule 1 4 described in section 3 2 3 are developed the two models table 5 shows the rmse values of the four rules trained by the two nns from the table we can see that the nn with one hidden layer is not much different from the nn with three hidden layers in term of rmse values for rule1 rule2 and rule4 this phenomenon indicates that shallow nn is able to capture the relationship between input and output variables even better than deeper nn in some cases however the rmse values of rule3 of shallow nn is significant worse than deeper nn which indicates that deeper nn is more stable when input variables are stochastic than shallow nn we think the shallow nn is too sensitive to the input variables and may contains more uncertainty in the model therefore we recommend using a deeper nn as a training model for devring the reservoir operation rules rather than the shallow nn 3 2 5 uncertainty estimation of reservoir operation rules fig 6 shows the simulation results of six reservoir operation rules the corresponding inflow data used in the rule are also illustrated the 80 confidence intervals of simulation water level are shown in green shadow lr1 does not consider the model uncertainty or inflow uncertainty so its simulation water level is a point in rule2 and rule4 the inflow uncertainty is not into consideration the 80 confidence intervals of rule2 and rule4 represent the model uncertainty lr2 uses probabilistic inflow forecasting for simulation thus the 80 confidence interval represent the inflow uncertainty it can be seen form that the intervals of lr2 are much wider than the intervals of rule2 and rule4 which demonstrates that the inflow uncertainty has a greater impact on reservoir operation than model uncertainty rule1 and rule3 consider both model uncertainty and inflow uncertainty however the intervals of rule3 are wider than the intervals of rule1 this result demonstrates that using probabilistic inflow forecasting for training can reduce the decision uncertainty cause by inflow uncertainty as shown in fig 6 the intervals of water level during dry season are wider than the intervals during flood season while the intervals of inflow during dry season are narrower than the intervals during flood season this indicates that although the uncertainty of the inflow in the dry season is small the decision water level is very sensitive to it which lead to a large uncertainty the uncertainty of the decision water level is small even if the uncertainty of inflow is large during flood season which is due to the limitation of flood control level accordingly as for hydropower operation the operator should pay more attention the inflow forecasting during dry season fig 7 illustrates the distribution of reservoir operation decisions obtained by rule1 rule2 rule3 rule4 and lr2 in contrast to lr1 these rules can not only give a point decision water level but a range of the optimal decisions such operation rules can give decision makers more potential selections in practice the corresponding optimal water level can be given according to the real time inflow forecasting situation power generation limits water level constraint and release constraint 4 discussion the above section indicates that the proposed bdl can give a distribution of decision water level for decision making this section gives a detail discussion of the proposed method refer to other models in other studies for reservoir operation yang et al 2016 proposed a robust reservoir operation model using the classification and regression tree algorithm cart combined with a shuffled cross validation scheme compared to their paper although we all use data mining methods to capture the relationship between reservoir decision and input variables they are more concerned with changing climate such as water delivery requirement environmental constraints and dry wet conditions and we are more concerned with the uncertainty of the inflow and model parameter liu et al 2019a proposed a multi objective hierarchical reservoir flood operation rule hfor which is optimized by a multi objective evolutionary algorithm different form our study the operation rule in this paper is represented by a neural network model but the hfor has its fixed rule form and the parameters of the rule are optimized by evolutionary algorithm which is less flexible however the hfor can handle multi objectives such as flood control power generation navigation etc while bdl is hard to handle multi objective problems wang et al 2019 proposed an improved operation based reservoir scheme to simulate the storage and outflow variations for multiyear and multipurpose reservoirs at a daily time step the new operation based reservoir scheme is neither optimized by the evolutionary algorithm or trained by the data mining method but determines the outflow according to the current reservoir storage level and the trade off relationship between multiple purposes of the reservoir this reservoir operation rule improves the feasibility and applicability of previous operation based reservoir schemes for actual reservoir operation applications overall the bdl proposed in this paper is recommended due to the following two advantages one is that the bdl is a flexible data mining method that can capture the relationship between reservoir decision and input variables from historical reservoir operation data or hypothetical optimal reservoir operation solution the other is that the bdl consider both the reservoir inflow uncertainty and the model parameter uncertainty which can give a reasonable range of the decision water level to water resource manager under the multiple uncertainties the further improvements of this work are suggested to focus on the following aspects as mentioned above the model needs to further consider the impact of climate change water quality requirements and ecosystem water demand on reservoir operation decisions moreover we need to combine the data mining method with multi objective evolutionary algorithm to derive optimal operation rule for multipurpose reservoirs such as flood control hydropower generation navigation and ecological flow control etc 5 conclusion reservoir operation rules play a key role in real time reservoir operation which specify operation decisions as a function of the current reservoir water level and the inflow however the decision model and the inflow always contain uncertainty this study proposes a bayesian deep learning method which considers both model parameter uncertainty and inflow uncertainty the monte carlo integration is used to transform complex integrals of inflow probability into summation forms variational inference is employed to obtain the model parameter posterior distribution the proposed method is applied to a real world application at three gorges project on the yangtze river four reservoir operation rules with different training input variables are developed by the proposed bayesian deep learning method two reservoir operation rules are developed by linear regression method the conclusion is summarized as follows 1 bdl perform better than lr in terms of both rmse and hydropower generation 2 bdl is more reliable and robust when using probabilistic forecast inflow as model input 3 the inflow uncertainty has greater impact on the decision output than model parameter uncertainty 4 the decision output is more sensitive to the inflow during dry season than other seasons 5 using probabilistic inflow forecasting for training can reduce the decision uncertainty cause by inflow uncertainty declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national key r d program of china 2016yfc0402209 the national natural science foundation of china no 91647114 51979113 50779013 91547208 the national public research institutes for basic r d operating expenses special project cksf2017061 sz the fundamental research funds for the central universities hust 2016yxzd047 and special thanks are given to the anonymous reviewers and editors for their constructive comments 
6073,this paper presents the results of column tests in which the fluidization of sands was studied as a result of water flow while the hydraulic gradient was used as the independent variable three stages of the experiment were distinguished increase in pressure fluidization fluidization defluidization cycle and decrease in pressure the obtained data were used to estimate the critical hydraulic gradient and two values of the minimum fluidization velocity for the increasing and decreasing hydraulic gradients named fluidizing and defluidizing velocity respectively modelling of the fluidization process was based on the assumption that there are zero effective stresses based on the model the critical hydraulic gradient and minimum fluidization velocities were determined for the increasing and decreasing hydraulic gradients studies on sands of different granularity showed the consistency of the model and experimental results fluidization in experimental studies was observed for lower values of the hydraulic gradient than was predicted by the model the most significant discrepancy between the model and experimental results occurred for the finest sand while the smallest discrepancy was found for the sand with the highest porosity and a relatively narrow particle size distribution the distinction of the fluidizing and defluidizing velocities is not only relevant for sand with grains larger than 0 5 mm keywords fluidization column tests effective stress minimum fluidization velocity critical hydraulic gradient nomenclature symbols a b coefficients in forchheimer s law g vector of density of gravity force h pressure hydraulic head i vector of hydraulic gradient n porosity k k hydraulic conductivity permeability p pressure in liquid q discharge velocity of liquid r r vectors of interaction forces between solid and liquid phase r 2 determination coefficient σ stress tensor ρ mass density δl depth of sand bad in filtration column φ piezometric pressure subscripts f critical hydraulic gradient or minimum filtration velocity max maximum hydraulic gradient i d increasing and decreasing hydraulic gradients superscripts s solid phase f fluid phase e experimental result 1 introduction experimental studies and modelling of fluidization of granular materials caused by liquid or gas flow are most often considered in the context of technological processes and chemical engineering e g filter rinsing in the water treatment process metallurgy processes and other bulk material production processes mccabe et al 1993 di felice 1995 yang 2013 philippsen et al 2015 duriš et al 2016 in addition fluidization associated with the flow of liquids through soils is a subject of geotechnical interest soil stability excavations geomorphology transfer of bottom sediments and hydrogeology groundwater drainage cashman and preene 2013 fujisawa et al 2013 zhang et al 2018 fluidization tests in laboratory conditions are usually carried out in vertical columns with a layer of granular material the surface of which lacks a clamp and the fluid flow has a direction opposite that of gravity the characteristic parameters that are determined are the critical hydraulic gradient and the minimum fluidization velocity most of the results concerning fluidization available in the literature are column tests with flow rate as an independent manipulated variable and a hydraulic gradient as a dependent variable fig 1 a mccabe et al 1993 di felice 1995 then the standard procedure is that first the flow rate is increased which causes the material to achieve a suspension state with a high proportion of the liquid phase voidage after which the flow rate is gradually reduced and a decreasing sample height is observed when the sample reaches the minimum height the minimum fluidization velocity is determined which is a characteristic parameter of this process the results of such tests show that in the range of flow velocities larger than the minimum fluidization velocity the hydraulic gradient is almost independent of the flow rate in some works e g mandal 2015 the concept of minimum fluidization velocity means the velocity at which the fluidization process begins presuming that this applies to a process with increasing flow intensity through the bed one can also find papers e g do nascimento et al 2016 where the minimum fluidization velocity is understood in a broader sense encompassing both of the above concepts in turn most investigations of hydraulic properties of granular materials carried out in column tests are performed in accordance with the darcy procedure where the independent manipulated variable is the pressure difference hydraulic gradient and the resulting quantity is the flow rate see e g scheidegger 1974 terzaghi et al 1996 such methodology the idea of which is presented in fig 1b is not considered in a more detailed way for experimental tests of fluidization of granular materials due to the difficulty associated with precisely controlling very small changes in pressure in the vicinity of the maximum hydraulic gradient accompanied by fluidization and rapid changes in flow velocity it also raises difficulty in unambiguously determining the minimum fluidization velocity the abovementioned drawbacks of the fluidization test when the hydraulic gradient is an independent variable can be omitted using the procedure described in this paper for estimation of the minimum fluidization velocity from the intersection of the extension of the linear dependence of the flow rate on the hydraulic gradient q i for the fixed bed and the straight line defining the maximum hydraulic gradient i imax for the fluidized bed using this technique it is possible not only to determine the fluidization parameters for a material that has been previously converted into a slurry as in the standard procedure with flow rate as an independent variable but the fluidization parameters for the material from the consolidated form can also be determined the minimum fluidization velocity for increasing hydraulic gradient will be called fluidizing velocity while the minimum fluidization velocity for decreasing hydraulic gradient will be called defluidizing velocity this terminology will briefly and clearly define the specific parameters of the fluidization and will avoid the need to redefine the concepts used so far in particular the minimum fluidization velocity based on the test results reported in this paper the values of fluidizing and defluidizing velocities may differ significantly the implementation of fluidization tests with a hydraulic gradient as an independent variable also provides a justification for modelling hydrogeological processes when fluidization occurs in the hyporheic zone and it is not possible to measure the water velocity during the fluidization of bottom sediments but it is possible to assess the value of the pressure difference between groundwater and surface water as in the case for the experimental fluidization studies most of the available work on fluidization modelling is based on analyses of the balance of mechanical forces on granular material suspended in a liquid e g fan and kawamura 1985 niven 2002 yang and renken 2003 the basis of the considerations is the postulate that in the fluidization process there is a balance of flow resistance forces drag gravity and buoyancy to introduce the fluid velocity into this balance the empirical relationships obtained for flow through granular porous material such as kozeny carman s or erguna s laws are usually used despite many works concerning the description of fluidization some interpretation doubts have not been resolved especially with regard to the drag force see di felice 1995 among few theoretical works in which fluidization is modelled from the perspective of the description formulated for the consolidated porous material not for the slurry there are the papers by vardoulakis 2004 2005 these works are a continuation of the well known considerations proposed by terzaghi et al 1996 regarding the critical hydraulic gradient that causes the bed grains to rise the assumptions of this approach result from the concept of zero effective stresses and the validity of darcy s law of note are the strong references in the vardoulakis publications to the theory of multiphase media the analysis of physical relationships for both phases and an interesting discussion of the problem of porosity waves a certain limitation of vardoulakis work is the lack of a broader comparison of modelling results with the results of experiments especially for cases of materials with different grain sizes this paper is devoted to experimental and modelling research of the fluidization problem starting from the classic permeability tests of granular materials with hydraulic gradient as an independent variable the presented macroscopic description of fluidization as in the works of vardoulakis is based on elementary dependences of the mechanical equilibrium of a two phase mixture the key assumptions of the fluidization model can be equivalently introduced in two ways by requiring zero effective stresses as in the geotechnical tradition or by demanding that the total stresses in a two phase mixture be equal to the fluid pressure viewpoint corresponding to suspension modelling the main objective of this work was to compare the results of experiments and predictions for the fluidization model for four types of sands with significantly different grain sizes and distributions the range of lithological variability of the studied sands was selected so that their hydraulic conductivity covered the entire range of variability corresponding to aquifers it was assumed that cohesion forces pulls did not act between sand grains linear and non linear flow laws were considered showing that linear components should be considered for assessment of the minimum fluidization velocity the performed experimental research and the discussion of modelling are related primarily to the hydrogeological situation for the drained aquifer when differences in hydraulic heads between groundwater and surface water can lead to fluidization of the hyporheic zone of the spring the bottom of the stream river lake or water reservoir 2 experimental method and materials a sand deposit of δl height was filled into the fluidization column of height lc and diameter dc fig 2 the direction of the water flow can be set by adjusting the water level below and above the sand bed by the two overflow chambers as a result the independent variable was the hydraulic gradient i in fluidization tests the direction of flow was opposite to the force of gravity and the measured resultant quantity was the flow rate or discharge velocity q column tests were carried out in the cycle shown in fig 1b in which three stages can be distinguished in the first stage the granular material is a fixed bed and with an increase of the hydraulic gradient from zero there is a proportional increase in the water discharge in the second stage the maximum hydraulic gradient is reached the local fluidization process is started and the flow rate increases stepwise the size of which depends on the capability of the fluid delivery system in the third stage the hydraulic gradient is lowered and the rates of flow are again proportional to the hydraulic gradient a characteristic feature of sands in the fluidization stage is the occurrence of local fluidization foci especially in the vicinity of the column walls as a result of changes in the structure packing of granular material caused by fluidization both in tests with a flow rate as an independent variable see mccabe et al 1993 and in tests with a variable hydraulic gradient it is possible to achieve a hysteresis effect which results in a lack of coverage of the course of q i for the third stage of the test and q i for the first stage as indicated in fig 1b an unstable process occurs in a fluidization test with a variable hydraulic gradient in the vicinity of the maximum gradient and a continuous flow rate cannot be guaranteed in such a situation the velocity corresponding to a transition from the fixed to the fluidized state or vice versa qt can be determined by estimation revealing the intersection of the extension of the dependence q i for the fixed bed and the line i imax for the fluidized bed in the event of hysteresis two such estimations will be possible resulting from a different test run for the increasing and decreasing hydraulic gradients they will give the fluidizing velocity qf t f and the defluidizing velocity qd t d values experimental research was carried out for four sands designated ii iii iv and v for which the grain size distribution curves are presented in fig 3 the sands were selected to provide a representation of the hydraulic conductivity of natural aquifers the tests were carried out at a constant temperature of 10 c 3 mathematical model the derivation of the fluidization model was focused on determining the conditions necessary for the occurrence of this process i e minimum flow velocity and minimum or critical hydraulic gradient the analysis was based on the well known concept of the mechanics of saturated porous materials similar to the approach adopted by vardoulakis 2004 omitting some details especially regarding stability analysis the starting point was therefore the macroscopic equation of the equilibrium of the forces obtained based on the linear momentum balance of the two phase mixtures the type of phase is marked in the superscript s solid f liquid without accounting for account inertia forces vardoulakis 2004 1 σ s 1 n ρ s g r 0 2 σ f n ρ f g r 0 where σ s and σ f are partial stress tensors n is the volumetric liquid content for a fixed bed porosity or for fluidized bed voidage ρs and ρf are the mean mass densities of the solid material and the liquid g is the gravitational force density vector and r is the interaction force vector between the phases neglecting the viscous components in the macroscopic stress tensors and introducing the total stresses σ and liquid pressure p 3 σ σ s σ f 4 σ f n p i where i is the unit tensor and the system of eqs 1 and 2 can be replaced by the equivalent equilibrium equations for the system of both phases sum of eqs 1 and 2 and for the liquid phase 5 σ n ρ f 1 n ρ s g 0 6 p ρ f g 1 n r 0 where the identity n p n p p n and the observation that the expression p n occurs both as a component of the stress tensor in the fluid and in the total force r of the interaction force representing a component called the buoyancy force resulting from the inhomogeneity of the structure of a material vardoulakis 2004 vardoulakis and alevizos 2005 as a result the component r representing the resultant force associated with the relative motion of phases will remain in the interaction force 7 r p n r for an incompressible fluid eq 6 is often written in the form 8 φ 1 n r 0 where φ p ρ f g z is the piezometric pressure g g z and z is the coordinate that is opposite to the direction of gravity alternatively by introducing the piezometric head h as the sum of the pressure head and the elevation head the hydraulic gradient reads 9 i h φ ρ f g p ρ f g z and from eq 8 we obtain 10 n ρ f g i r 0 equation 10 relates the hydraulic gradient in the fluid with the interaction force between the fluid and solid skeleton by subtracting the equation for fluid 6 from the equation of equilibrium for the entire system 5 we get the equation 11 σ p 1 n ρ s ρ f g 1 n r 0 which can be interpreted as a form of the equation of the equilibrium of the solid phase other than eq 1 in which the total stresses minus the pressure positive pressure corresponds to the negative stress in the fluid are balanced by the gravitational force on the skeleton reduced by the buoyancy force and the interaction force related to relative motion r with the multiplier scale factor 1 n the characteristic parameters determining the fluidization of the granular porous material caused by the flow of fluid against gravity are the so called critical hydraulic gradient if and the minimum flow rate qt at which fluidization takes place assuming no cohesion forces between sand grains the only reason for the connectedness of the layer of such granular material in the column is the force of gravity this force induces higher stresses in the grains forming the skeleton of the material than the compressive stresses caused by the pressure of the fluid surrounding the grains if the fluid flow is directed against gravity the interaction force of the fluid on the skeleton results in an effect opposite to gravity i e lifting of the grains of the material at an appropriate flow rate this phenomenon may result in the loss of compressive forces in the skeleton and change the state of the mixture from the saturated porous material to the slurry the velocity of the fluid at which the interaction forces balance the forces of gravity is defined by the term of the fluidizing or defluidizing velocity qt according to the tradition of soil mechanics and geotechnics the condition of the disappearance of stresses ensuring the mechanical connectedness of the skeleton was formulated in the form of the disappearance of the so called effective stresses according to terzaghi terzaghi et al 1996 vardoulakis 2004 vardoulakis and alevizos 2005 cashman and preene 2013 12 σ e σ p i 0 condition 12 allows the use of eqs 5 and 6 to write the relationship 13 1 n ρ s ρ f g 1 n r f 0 which determines the magnitude of the interaction force r r f required for fluidization it is worth noting that at constant densities ρs and ρf the magnitude of the interaction force r f is a parabolic function of the contribution of the liquid phase n and takes the maximum value for n 0 5 in works in which fluidization is modelled from the perspective of the material in liquid suspension e g fan and kawamura 1985 niven 2002 yang and renken 2003 two conditions are assumed 1 the balance of forces on the solid phase is satisfied in which the drag force is balanced by the weight of the grains reduced by the buoyancy force 2 the maximum density of the solid phase minimum voidage is reached considering the eq 11 and assuming that the drag force in the first of the fluidization conditions is equal 1 n r f this condition is equivalent to the requirement for the sum of the first two components in eq 11 total stress in a two phase system and liquid pressure is zero this latter condition turn indicates a condition identical to the demand for zero effective stress 12 based on the above analysis it is worth noting that to ensure that both approaches are equivalent the condition for balance of forces for the slurry should not contain the full interaction force r between phases or its flow related component r reduced by the heterogeneity component see eq 7 the interaction force should be represented by the force r scaled by the factor that is the inverse of the voidage 1 n which for sands usually means multiplication by a coefficient between 2 and 4 this feature is not noticed in the literature and the form of the interaction force is discussed di felice 1995 it is worth noting that with the above interpretation both models of fluidization the model of porous material with zero effective stresses and the model of suspension which has a maximum density of the solid phase and the total stresses equal to the pressure lead to eq 13 linking the interaction force r scaled by the factor 1 n with the solid weight reduced by the buoyancy force 1 n ρ s ρ f g the critical hydraulic gradient at which fluidization occurs can be determined by eliminating the interaction force from eqs 10 and 13 a dependency is thus obtained 14 i f 1 n ρ s ρ f 1 g g in which there is only a volume fraction of the liquid phase and density of the solid and fluid materials the minimum fluidization velocity of the porous granular material can be determined from eq 13 if the interaction force r f is expressed by the fluid velocity relative to the solid phase or by equivalently using the eq 14 and the dependence of the hydraulic gradient i f with the flow rate the second method was further chosen focusing on the one dimensional problem corresponding to the column tests where the vertical direction of flow is consistent with the axis of the column the relationship between the hydraulic gradient i and the flow velocity through the porous material q discharge velocity in a wide range of relative velocities then takes the form of the so called forchheimer s law 15 i a q b q 2 where a and b are physical constants by inserting eq 15 in 14 a relationship is obtained for the fluidizing or defluidizing velocity qt 16 a q t b q t 2 1 n ρ s ρ f 1 from which qt can be determined if constants a and b n ρs and ρf are known in the linear case b 0 the quantitative effect of the non linear component on the results is given in the section discussion of the results the relationship 15 is reduced to darcy s law where parameter a can be expressed by the hydraulic conductivity k or permeability k of the porous material 17 a 1 k μ k ρ f g where μ is the dynamic viscosity of the fluid the fluidizing or defluidizing velocity can then be determined from the dependence 18 q t k μ 1 n ρ s ρ f g k 1 n ρ s ρ f 1 it is worth noting that in comparison to the condition for the critical gradient if eq 14 the velocity qt eq 16 or 18 additionally depends on the properties defining flow resistance through the porous material i e constants a and b in the non linear case or the permeability of the material and fluid viscosity in a linear range 4 discussion of the results the results of the experimental tests and modelling of fluidization in column tests for four types of sands are presented in figs 4 7 and table 1 the experiments in the column tests consisted of three stages an increase in the hydraulic gradient fluidization and gradient reduction in all tests the hydraulic gradient was an independent variable the flow rate was the dependent variable and the temperature was controlled 10 c figs 4 7 present the results obtained for the flow velocity measurements q for given hydraulic gradient values along with their linear approximations the graphs also show the maximum recorded value of the hydraulic gradient imax and on each of the graphs the values of the fluidizing or defluidizing velocity estimated in accordance with the procedure described above intersection of linear approximations of q i with the line imax the values of the flow velocity corresponding to the maximum hydraulic gradient were omitted from the graphs because this quantity was related to the discharge of the supply system and was irrelevant to the analysed results it was also outside of the range of the considered flow rate scale for the purpose of the comparison of experimental estimations in figs 4 7 and table 1 the values of the critical hydraulic gradient if and the fluidizing and defluidizing velocities qf qd predicted by the model determined from eqs 14 18 were gathered parameters characteristic of sand samples such as the porosity n sample height δl and hydraulic conductivity values for increasing and decreasing hydraulic gradients ki kd determined from linear approximation of the column test results together with the corresponding determination coefficients r2 are presented in table 1 to determine the critical hydraulic gradient and the minimum fluidization velocity eqs 14 and 18 it was assumed that the sand grains have an average density equal to the quartz density ρ s 2650 kg m3 and the liquid is water with a density of ρ f 999 73 kg m3 and viscosity μ 1 316 x 10 3 pas to quantitatively compare the measured estimated or identified data with the help of the model quantities x1 and x2 the relative difference rd were used 19 rd x 1 x 2 x 1 x 2 x 1 the dependence of the flow velocity q on the hydraulic gradient i for all the sands tested both for increasing and decreasing gradients were in the range of 0 to imax and they were approximately linear with a coefficient of determination r2 greater than 0 9 only for the sand with the largest grains sand ii was the hydraulic conductivity values for the increasing and decreasing hydraulic gradients ki and kd determined to be approximately equal table 1 for the other three sands there was a strong hysteresis effect and the hydraulic conductivity of the sand after fluidization for decreasing i was significantly higher than before fluidization the relative differences in hydraulic conductivity for the increasing and decreasing hydraulic gradients x1 ki x2 kd for sands ii iii iv v were 0 05 0 88 2 03 and 13 42 respectively the fluidizing and defluidizing velocities estimated based on experimental data behaved similarly to the hydraulic conductance for the sand with the largest grains sand ii the differences are minimal while for the other sands the discrepancies increased with the decreasing grain size the relative differences in the experimentally determined fluidizing and defluidizing velocities in eq 19 x1 qe f x2 qe f were 0 0008 1 03 2 03 and 17 5 respectively the maximum hydraulic gradients corresponding to the gradients at which fluidization was observed in figs 4 7 and in table 1 ie imax for all sands tested were close to one similar values were assumed by the critical hydraulic gradient determined from the model eq 14 relative differences determined in experiments and from the model of hydraulic gradients in which fluidization occurred x1 ie x2 if for sands ii iii iv and v were respectively 0 23 0 13 0 08 0 03 thus these differences tended to decrease with decreasing grains of sands a comparison of the fluidizing velocities estimated experimentally based on tests with an increasing hydraulic gradient up to values approaching fluidization qe f with appropriate values determined from the model qf eq 18 indicated the consistency of model predictions and relative difference coefficients x1 qe f x2 qf for sands ii iii and iv and v of 0 24 0 19 0 15 and 0 5 the analogous values of the coefficient of relative differences in the defluidizing velocity from the experimental estimation and the model for the test stage with a decreasing hydraulic gradient x1 qe d x2 qd were 0 18 0 09 0 16 and 0 3 thus the model predictions and experimental results were in good agreement despite significant differences in the minimum fluidization velocities before and after fluidization to assess the dependence of the fluidization velocity on the non linear component in the flow law through the granular material the fluidization velocity was determined according to formula 16 and compared with the velocity determined from the linear model i e from formula 18 because non linear effects were not observed in the range of recorded changes in the hydraulic gradient but the recorded ranges did not include maximum values of the hydraulic gradient the empirical relationship between b and a was assumed following the paper by von lopik et al 2017 in the form b 172 77 a 0 584 adopted units a and b are s m and s2 m2 respectively a comparison of the minimum fluidization velocities determined from the non linear and linear model showed that the maximum discrepancy noted for the sand with the largest grains sand ii was 1 thus non linear effects are of little importance in estimating the minimum fluidization velocity of sands and can be neglected in fig 8 the fluidizing and defluidizing velocities experimentally estimated qe t and calculated from the model qt for all types of sands are summarized both the consistency of the results obtained by different methods the coefficient of relative differences at the level of 0 1 0 5 and the discrepancy between the parameters determined before and after the fluidization coefficient of relative differences 0 0008 17 5 are shown 5 summary and conclusions in this analysis fluidization column experiments were performed in which the water flow through the sand samples was tested in which the flow was contrary to gravity the independent variable was the pressure difference applied at the upper and lower boundary of the sample or hydraulic gradient and the resulting dependent variable was the flow velocity the test procedure can be divided into three stages 1 pressure increase stage with pressure proportional changes in flow velocity 2 fluidization step surrounded by the maximal hydraulic gradient imax when there is a rapid increase or decrease in flow velocity with slight pressure variations 3 stage of lowering the pressure and proportional declines in the flow velocity a characteristic feature of the fluidization step is the occurrence of local fluidization centres especially in the vicinity of the column walls the dependence of liquid flow velocity on the hydraulic gradient can be characterized by hysteresis a clear hysteresis was visible for the three sands with smaller grains sands iii iv v in cases of tests with hysteresis the hydraulic conductivities for the test before and after fluidization were different due to the lack of a visible change in the height of the sand samples in the column tests before and after fluidization it can be assumed that the porosity of the sands did not change significantly the linear regression analysis of the relationship between the flow velocity and the hydraulic gradient below the critical value revealed its linear characteristics both before and after fluidization the procedure for determining the fluidization parameters proposed in the work based on the experimental estimation might lead to the determination of values of the fluidizing and defluidizing velocity for the tested sand samples the distinction between the two values of the velocity was found to be unimportant only for sand consisting of a majority of grains with a diameter larger than 0 5 mm sand ii according to the model with zero effective stresses the critical hydraulic gradient if and the fluidizing and defluidizing velocity qt can be determined using dependence 14 and 18 knowledge of the measurements the best fits of q i can allow determination of the hydraulic conductivity of sands for the increasing and decreasing hydraulic gradients in tests for sands fluidization was observed for lower values of the hydraulic gradient in table 1 imax than predicted by the model in table 1 if the largest discrepancy occurred for the finest sand v and the smallest was observed for sand ii with the highest porosity and relatively narrow grain size distribution the local nature of fluidization and inhomogeneity of grains or deposits might be the causes of the observed discrepancies in the experimental and model results it is worth noting that the methodology used in this work focused on fluidization in the column test and estimation of the fluidization parameters resulted in more complete information about the bed material than the method with the flow rate as an independent variable for which one fluidization speed was found due to the method of determining the minimum fluidization velocity from the bed material in the form of a slurry the studies confirmed a small contribution of nonlinear effects in the evaluation of the fluidizing and defluidizing velocity it can therefore be concluded that if the hydraulic gradient under natural conditions in the hyporheic zone is lower than the critical one and drainage of the water in this zone may take place in accordance with darcy s law both before and after fluidization of this zone recognition of the sand bed fluidization conditions may be useful in hydrology for the determination of groundwater drainage in hydrogeology for the study of surface and underground water interactions in the hyporheic zone in geomorphology when analysing channel processes and in crenology in determining conditions of occurrence of spring sources and zones declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national science centre in poland ncn project 2015 17 8 st10 01833 titled the conditions of the daily fluctuations of the water level in headwaters zones and rivers with consideration of the hyporheic zone impact 
6073,this paper presents the results of column tests in which the fluidization of sands was studied as a result of water flow while the hydraulic gradient was used as the independent variable three stages of the experiment were distinguished increase in pressure fluidization fluidization defluidization cycle and decrease in pressure the obtained data were used to estimate the critical hydraulic gradient and two values of the minimum fluidization velocity for the increasing and decreasing hydraulic gradients named fluidizing and defluidizing velocity respectively modelling of the fluidization process was based on the assumption that there are zero effective stresses based on the model the critical hydraulic gradient and minimum fluidization velocities were determined for the increasing and decreasing hydraulic gradients studies on sands of different granularity showed the consistency of the model and experimental results fluidization in experimental studies was observed for lower values of the hydraulic gradient than was predicted by the model the most significant discrepancy between the model and experimental results occurred for the finest sand while the smallest discrepancy was found for the sand with the highest porosity and a relatively narrow particle size distribution the distinction of the fluidizing and defluidizing velocities is not only relevant for sand with grains larger than 0 5 mm keywords fluidization column tests effective stress minimum fluidization velocity critical hydraulic gradient nomenclature symbols a b coefficients in forchheimer s law g vector of density of gravity force h pressure hydraulic head i vector of hydraulic gradient n porosity k k hydraulic conductivity permeability p pressure in liquid q discharge velocity of liquid r r vectors of interaction forces between solid and liquid phase r 2 determination coefficient σ stress tensor ρ mass density δl depth of sand bad in filtration column φ piezometric pressure subscripts f critical hydraulic gradient or minimum filtration velocity max maximum hydraulic gradient i d increasing and decreasing hydraulic gradients superscripts s solid phase f fluid phase e experimental result 1 introduction experimental studies and modelling of fluidization of granular materials caused by liquid or gas flow are most often considered in the context of technological processes and chemical engineering e g filter rinsing in the water treatment process metallurgy processes and other bulk material production processes mccabe et al 1993 di felice 1995 yang 2013 philippsen et al 2015 duriš et al 2016 in addition fluidization associated with the flow of liquids through soils is a subject of geotechnical interest soil stability excavations geomorphology transfer of bottom sediments and hydrogeology groundwater drainage cashman and preene 2013 fujisawa et al 2013 zhang et al 2018 fluidization tests in laboratory conditions are usually carried out in vertical columns with a layer of granular material the surface of which lacks a clamp and the fluid flow has a direction opposite that of gravity the characteristic parameters that are determined are the critical hydraulic gradient and the minimum fluidization velocity most of the results concerning fluidization available in the literature are column tests with flow rate as an independent manipulated variable and a hydraulic gradient as a dependent variable fig 1 a mccabe et al 1993 di felice 1995 then the standard procedure is that first the flow rate is increased which causes the material to achieve a suspension state with a high proportion of the liquid phase voidage after which the flow rate is gradually reduced and a decreasing sample height is observed when the sample reaches the minimum height the minimum fluidization velocity is determined which is a characteristic parameter of this process the results of such tests show that in the range of flow velocities larger than the minimum fluidization velocity the hydraulic gradient is almost independent of the flow rate in some works e g mandal 2015 the concept of minimum fluidization velocity means the velocity at which the fluidization process begins presuming that this applies to a process with increasing flow intensity through the bed one can also find papers e g do nascimento et al 2016 where the minimum fluidization velocity is understood in a broader sense encompassing both of the above concepts in turn most investigations of hydraulic properties of granular materials carried out in column tests are performed in accordance with the darcy procedure where the independent manipulated variable is the pressure difference hydraulic gradient and the resulting quantity is the flow rate see e g scheidegger 1974 terzaghi et al 1996 such methodology the idea of which is presented in fig 1b is not considered in a more detailed way for experimental tests of fluidization of granular materials due to the difficulty associated with precisely controlling very small changes in pressure in the vicinity of the maximum hydraulic gradient accompanied by fluidization and rapid changes in flow velocity it also raises difficulty in unambiguously determining the minimum fluidization velocity the abovementioned drawbacks of the fluidization test when the hydraulic gradient is an independent variable can be omitted using the procedure described in this paper for estimation of the minimum fluidization velocity from the intersection of the extension of the linear dependence of the flow rate on the hydraulic gradient q i for the fixed bed and the straight line defining the maximum hydraulic gradient i imax for the fluidized bed using this technique it is possible not only to determine the fluidization parameters for a material that has been previously converted into a slurry as in the standard procedure with flow rate as an independent variable but the fluidization parameters for the material from the consolidated form can also be determined the minimum fluidization velocity for increasing hydraulic gradient will be called fluidizing velocity while the minimum fluidization velocity for decreasing hydraulic gradient will be called defluidizing velocity this terminology will briefly and clearly define the specific parameters of the fluidization and will avoid the need to redefine the concepts used so far in particular the minimum fluidization velocity based on the test results reported in this paper the values of fluidizing and defluidizing velocities may differ significantly the implementation of fluidization tests with a hydraulic gradient as an independent variable also provides a justification for modelling hydrogeological processes when fluidization occurs in the hyporheic zone and it is not possible to measure the water velocity during the fluidization of bottom sediments but it is possible to assess the value of the pressure difference between groundwater and surface water as in the case for the experimental fluidization studies most of the available work on fluidization modelling is based on analyses of the balance of mechanical forces on granular material suspended in a liquid e g fan and kawamura 1985 niven 2002 yang and renken 2003 the basis of the considerations is the postulate that in the fluidization process there is a balance of flow resistance forces drag gravity and buoyancy to introduce the fluid velocity into this balance the empirical relationships obtained for flow through granular porous material such as kozeny carman s or erguna s laws are usually used despite many works concerning the description of fluidization some interpretation doubts have not been resolved especially with regard to the drag force see di felice 1995 among few theoretical works in which fluidization is modelled from the perspective of the description formulated for the consolidated porous material not for the slurry there are the papers by vardoulakis 2004 2005 these works are a continuation of the well known considerations proposed by terzaghi et al 1996 regarding the critical hydraulic gradient that causes the bed grains to rise the assumptions of this approach result from the concept of zero effective stresses and the validity of darcy s law of note are the strong references in the vardoulakis publications to the theory of multiphase media the analysis of physical relationships for both phases and an interesting discussion of the problem of porosity waves a certain limitation of vardoulakis work is the lack of a broader comparison of modelling results with the results of experiments especially for cases of materials with different grain sizes this paper is devoted to experimental and modelling research of the fluidization problem starting from the classic permeability tests of granular materials with hydraulic gradient as an independent variable the presented macroscopic description of fluidization as in the works of vardoulakis is based on elementary dependences of the mechanical equilibrium of a two phase mixture the key assumptions of the fluidization model can be equivalently introduced in two ways by requiring zero effective stresses as in the geotechnical tradition or by demanding that the total stresses in a two phase mixture be equal to the fluid pressure viewpoint corresponding to suspension modelling the main objective of this work was to compare the results of experiments and predictions for the fluidization model for four types of sands with significantly different grain sizes and distributions the range of lithological variability of the studied sands was selected so that their hydraulic conductivity covered the entire range of variability corresponding to aquifers it was assumed that cohesion forces pulls did not act between sand grains linear and non linear flow laws were considered showing that linear components should be considered for assessment of the minimum fluidization velocity the performed experimental research and the discussion of modelling are related primarily to the hydrogeological situation for the drained aquifer when differences in hydraulic heads between groundwater and surface water can lead to fluidization of the hyporheic zone of the spring the bottom of the stream river lake or water reservoir 2 experimental method and materials a sand deposit of δl height was filled into the fluidization column of height lc and diameter dc fig 2 the direction of the water flow can be set by adjusting the water level below and above the sand bed by the two overflow chambers as a result the independent variable was the hydraulic gradient i in fluidization tests the direction of flow was opposite to the force of gravity and the measured resultant quantity was the flow rate or discharge velocity q column tests were carried out in the cycle shown in fig 1b in which three stages can be distinguished in the first stage the granular material is a fixed bed and with an increase of the hydraulic gradient from zero there is a proportional increase in the water discharge in the second stage the maximum hydraulic gradient is reached the local fluidization process is started and the flow rate increases stepwise the size of which depends on the capability of the fluid delivery system in the third stage the hydraulic gradient is lowered and the rates of flow are again proportional to the hydraulic gradient a characteristic feature of sands in the fluidization stage is the occurrence of local fluidization foci especially in the vicinity of the column walls as a result of changes in the structure packing of granular material caused by fluidization both in tests with a flow rate as an independent variable see mccabe et al 1993 and in tests with a variable hydraulic gradient it is possible to achieve a hysteresis effect which results in a lack of coverage of the course of q i for the third stage of the test and q i for the first stage as indicated in fig 1b an unstable process occurs in a fluidization test with a variable hydraulic gradient in the vicinity of the maximum gradient and a continuous flow rate cannot be guaranteed in such a situation the velocity corresponding to a transition from the fixed to the fluidized state or vice versa qt can be determined by estimation revealing the intersection of the extension of the dependence q i for the fixed bed and the line i imax for the fluidized bed in the event of hysteresis two such estimations will be possible resulting from a different test run for the increasing and decreasing hydraulic gradients they will give the fluidizing velocity qf t f and the defluidizing velocity qd t d values experimental research was carried out for four sands designated ii iii iv and v for which the grain size distribution curves are presented in fig 3 the sands were selected to provide a representation of the hydraulic conductivity of natural aquifers the tests were carried out at a constant temperature of 10 c 3 mathematical model the derivation of the fluidization model was focused on determining the conditions necessary for the occurrence of this process i e minimum flow velocity and minimum or critical hydraulic gradient the analysis was based on the well known concept of the mechanics of saturated porous materials similar to the approach adopted by vardoulakis 2004 omitting some details especially regarding stability analysis the starting point was therefore the macroscopic equation of the equilibrium of the forces obtained based on the linear momentum balance of the two phase mixtures the type of phase is marked in the superscript s solid f liquid without accounting for account inertia forces vardoulakis 2004 1 σ s 1 n ρ s g r 0 2 σ f n ρ f g r 0 where σ s and σ f are partial stress tensors n is the volumetric liquid content for a fixed bed porosity or for fluidized bed voidage ρs and ρf are the mean mass densities of the solid material and the liquid g is the gravitational force density vector and r is the interaction force vector between the phases neglecting the viscous components in the macroscopic stress tensors and introducing the total stresses σ and liquid pressure p 3 σ σ s σ f 4 σ f n p i where i is the unit tensor and the system of eqs 1 and 2 can be replaced by the equivalent equilibrium equations for the system of both phases sum of eqs 1 and 2 and for the liquid phase 5 σ n ρ f 1 n ρ s g 0 6 p ρ f g 1 n r 0 where the identity n p n p p n and the observation that the expression p n occurs both as a component of the stress tensor in the fluid and in the total force r of the interaction force representing a component called the buoyancy force resulting from the inhomogeneity of the structure of a material vardoulakis 2004 vardoulakis and alevizos 2005 as a result the component r representing the resultant force associated with the relative motion of phases will remain in the interaction force 7 r p n r for an incompressible fluid eq 6 is often written in the form 8 φ 1 n r 0 where φ p ρ f g z is the piezometric pressure g g z and z is the coordinate that is opposite to the direction of gravity alternatively by introducing the piezometric head h as the sum of the pressure head and the elevation head the hydraulic gradient reads 9 i h φ ρ f g p ρ f g z and from eq 8 we obtain 10 n ρ f g i r 0 equation 10 relates the hydraulic gradient in the fluid with the interaction force between the fluid and solid skeleton by subtracting the equation for fluid 6 from the equation of equilibrium for the entire system 5 we get the equation 11 σ p 1 n ρ s ρ f g 1 n r 0 which can be interpreted as a form of the equation of the equilibrium of the solid phase other than eq 1 in which the total stresses minus the pressure positive pressure corresponds to the negative stress in the fluid are balanced by the gravitational force on the skeleton reduced by the buoyancy force and the interaction force related to relative motion r with the multiplier scale factor 1 n the characteristic parameters determining the fluidization of the granular porous material caused by the flow of fluid against gravity are the so called critical hydraulic gradient if and the minimum flow rate qt at which fluidization takes place assuming no cohesion forces between sand grains the only reason for the connectedness of the layer of such granular material in the column is the force of gravity this force induces higher stresses in the grains forming the skeleton of the material than the compressive stresses caused by the pressure of the fluid surrounding the grains if the fluid flow is directed against gravity the interaction force of the fluid on the skeleton results in an effect opposite to gravity i e lifting of the grains of the material at an appropriate flow rate this phenomenon may result in the loss of compressive forces in the skeleton and change the state of the mixture from the saturated porous material to the slurry the velocity of the fluid at which the interaction forces balance the forces of gravity is defined by the term of the fluidizing or defluidizing velocity qt according to the tradition of soil mechanics and geotechnics the condition of the disappearance of stresses ensuring the mechanical connectedness of the skeleton was formulated in the form of the disappearance of the so called effective stresses according to terzaghi terzaghi et al 1996 vardoulakis 2004 vardoulakis and alevizos 2005 cashman and preene 2013 12 σ e σ p i 0 condition 12 allows the use of eqs 5 and 6 to write the relationship 13 1 n ρ s ρ f g 1 n r f 0 which determines the magnitude of the interaction force r r f required for fluidization it is worth noting that at constant densities ρs and ρf the magnitude of the interaction force r f is a parabolic function of the contribution of the liquid phase n and takes the maximum value for n 0 5 in works in which fluidization is modelled from the perspective of the material in liquid suspension e g fan and kawamura 1985 niven 2002 yang and renken 2003 two conditions are assumed 1 the balance of forces on the solid phase is satisfied in which the drag force is balanced by the weight of the grains reduced by the buoyancy force 2 the maximum density of the solid phase minimum voidage is reached considering the eq 11 and assuming that the drag force in the first of the fluidization conditions is equal 1 n r f this condition is equivalent to the requirement for the sum of the first two components in eq 11 total stress in a two phase system and liquid pressure is zero this latter condition turn indicates a condition identical to the demand for zero effective stress 12 based on the above analysis it is worth noting that to ensure that both approaches are equivalent the condition for balance of forces for the slurry should not contain the full interaction force r between phases or its flow related component r reduced by the heterogeneity component see eq 7 the interaction force should be represented by the force r scaled by the factor that is the inverse of the voidage 1 n which for sands usually means multiplication by a coefficient between 2 and 4 this feature is not noticed in the literature and the form of the interaction force is discussed di felice 1995 it is worth noting that with the above interpretation both models of fluidization the model of porous material with zero effective stresses and the model of suspension which has a maximum density of the solid phase and the total stresses equal to the pressure lead to eq 13 linking the interaction force r scaled by the factor 1 n with the solid weight reduced by the buoyancy force 1 n ρ s ρ f g the critical hydraulic gradient at which fluidization occurs can be determined by eliminating the interaction force from eqs 10 and 13 a dependency is thus obtained 14 i f 1 n ρ s ρ f 1 g g in which there is only a volume fraction of the liquid phase and density of the solid and fluid materials the minimum fluidization velocity of the porous granular material can be determined from eq 13 if the interaction force r f is expressed by the fluid velocity relative to the solid phase or by equivalently using the eq 14 and the dependence of the hydraulic gradient i f with the flow rate the second method was further chosen focusing on the one dimensional problem corresponding to the column tests where the vertical direction of flow is consistent with the axis of the column the relationship between the hydraulic gradient i and the flow velocity through the porous material q discharge velocity in a wide range of relative velocities then takes the form of the so called forchheimer s law 15 i a q b q 2 where a and b are physical constants by inserting eq 15 in 14 a relationship is obtained for the fluidizing or defluidizing velocity qt 16 a q t b q t 2 1 n ρ s ρ f 1 from which qt can be determined if constants a and b n ρs and ρf are known in the linear case b 0 the quantitative effect of the non linear component on the results is given in the section discussion of the results the relationship 15 is reduced to darcy s law where parameter a can be expressed by the hydraulic conductivity k or permeability k of the porous material 17 a 1 k μ k ρ f g where μ is the dynamic viscosity of the fluid the fluidizing or defluidizing velocity can then be determined from the dependence 18 q t k μ 1 n ρ s ρ f g k 1 n ρ s ρ f 1 it is worth noting that in comparison to the condition for the critical gradient if eq 14 the velocity qt eq 16 or 18 additionally depends on the properties defining flow resistance through the porous material i e constants a and b in the non linear case or the permeability of the material and fluid viscosity in a linear range 4 discussion of the results the results of the experimental tests and modelling of fluidization in column tests for four types of sands are presented in figs 4 7 and table 1 the experiments in the column tests consisted of three stages an increase in the hydraulic gradient fluidization and gradient reduction in all tests the hydraulic gradient was an independent variable the flow rate was the dependent variable and the temperature was controlled 10 c figs 4 7 present the results obtained for the flow velocity measurements q for given hydraulic gradient values along with their linear approximations the graphs also show the maximum recorded value of the hydraulic gradient imax and on each of the graphs the values of the fluidizing or defluidizing velocity estimated in accordance with the procedure described above intersection of linear approximations of q i with the line imax the values of the flow velocity corresponding to the maximum hydraulic gradient were omitted from the graphs because this quantity was related to the discharge of the supply system and was irrelevant to the analysed results it was also outside of the range of the considered flow rate scale for the purpose of the comparison of experimental estimations in figs 4 7 and table 1 the values of the critical hydraulic gradient if and the fluidizing and defluidizing velocities qf qd predicted by the model determined from eqs 14 18 were gathered parameters characteristic of sand samples such as the porosity n sample height δl and hydraulic conductivity values for increasing and decreasing hydraulic gradients ki kd determined from linear approximation of the column test results together with the corresponding determination coefficients r2 are presented in table 1 to determine the critical hydraulic gradient and the minimum fluidization velocity eqs 14 and 18 it was assumed that the sand grains have an average density equal to the quartz density ρ s 2650 kg m3 and the liquid is water with a density of ρ f 999 73 kg m3 and viscosity μ 1 316 x 10 3 pas to quantitatively compare the measured estimated or identified data with the help of the model quantities x1 and x2 the relative difference rd were used 19 rd x 1 x 2 x 1 x 2 x 1 the dependence of the flow velocity q on the hydraulic gradient i for all the sands tested both for increasing and decreasing gradients were in the range of 0 to imax and they were approximately linear with a coefficient of determination r2 greater than 0 9 only for the sand with the largest grains sand ii was the hydraulic conductivity values for the increasing and decreasing hydraulic gradients ki and kd determined to be approximately equal table 1 for the other three sands there was a strong hysteresis effect and the hydraulic conductivity of the sand after fluidization for decreasing i was significantly higher than before fluidization the relative differences in hydraulic conductivity for the increasing and decreasing hydraulic gradients x1 ki x2 kd for sands ii iii iv v were 0 05 0 88 2 03 and 13 42 respectively the fluidizing and defluidizing velocities estimated based on experimental data behaved similarly to the hydraulic conductance for the sand with the largest grains sand ii the differences are minimal while for the other sands the discrepancies increased with the decreasing grain size the relative differences in the experimentally determined fluidizing and defluidizing velocities in eq 19 x1 qe f x2 qe f were 0 0008 1 03 2 03 and 17 5 respectively the maximum hydraulic gradients corresponding to the gradients at which fluidization was observed in figs 4 7 and in table 1 ie imax for all sands tested were close to one similar values were assumed by the critical hydraulic gradient determined from the model eq 14 relative differences determined in experiments and from the model of hydraulic gradients in which fluidization occurred x1 ie x2 if for sands ii iii iv and v were respectively 0 23 0 13 0 08 0 03 thus these differences tended to decrease with decreasing grains of sands a comparison of the fluidizing velocities estimated experimentally based on tests with an increasing hydraulic gradient up to values approaching fluidization qe f with appropriate values determined from the model qf eq 18 indicated the consistency of model predictions and relative difference coefficients x1 qe f x2 qf for sands ii iii and iv and v of 0 24 0 19 0 15 and 0 5 the analogous values of the coefficient of relative differences in the defluidizing velocity from the experimental estimation and the model for the test stage with a decreasing hydraulic gradient x1 qe d x2 qd were 0 18 0 09 0 16 and 0 3 thus the model predictions and experimental results were in good agreement despite significant differences in the minimum fluidization velocities before and after fluidization to assess the dependence of the fluidization velocity on the non linear component in the flow law through the granular material the fluidization velocity was determined according to formula 16 and compared with the velocity determined from the linear model i e from formula 18 because non linear effects were not observed in the range of recorded changes in the hydraulic gradient but the recorded ranges did not include maximum values of the hydraulic gradient the empirical relationship between b and a was assumed following the paper by von lopik et al 2017 in the form b 172 77 a 0 584 adopted units a and b are s m and s2 m2 respectively a comparison of the minimum fluidization velocities determined from the non linear and linear model showed that the maximum discrepancy noted for the sand with the largest grains sand ii was 1 thus non linear effects are of little importance in estimating the minimum fluidization velocity of sands and can be neglected in fig 8 the fluidizing and defluidizing velocities experimentally estimated qe t and calculated from the model qt for all types of sands are summarized both the consistency of the results obtained by different methods the coefficient of relative differences at the level of 0 1 0 5 and the discrepancy between the parameters determined before and after the fluidization coefficient of relative differences 0 0008 17 5 are shown 5 summary and conclusions in this analysis fluidization column experiments were performed in which the water flow through the sand samples was tested in which the flow was contrary to gravity the independent variable was the pressure difference applied at the upper and lower boundary of the sample or hydraulic gradient and the resulting dependent variable was the flow velocity the test procedure can be divided into three stages 1 pressure increase stage with pressure proportional changes in flow velocity 2 fluidization step surrounded by the maximal hydraulic gradient imax when there is a rapid increase or decrease in flow velocity with slight pressure variations 3 stage of lowering the pressure and proportional declines in the flow velocity a characteristic feature of the fluidization step is the occurrence of local fluidization centres especially in the vicinity of the column walls the dependence of liquid flow velocity on the hydraulic gradient can be characterized by hysteresis a clear hysteresis was visible for the three sands with smaller grains sands iii iv v in cases of tests with hysteresis the hydraulic conductivities for the test before and after fluidization were different due to the lack of a visible change in the height of the sand samples in the column tests before and after fluidization it can be assumed that the porosity of the sands did not change significantly the linear regression analysis of the relationship between the flow velocity and the hydraulic gradient below the critical value revealed its linear characteristics both before and after fluidization the procedure for determining the fluidization parameters proposed in the work based on the experimental estimation might lead to the determination of values of the fluidizing and defluidizing velocity for the tested sand samples the distinction between the two values of the velocity was found to be unimportant only for sand consisting of a majority of grains with a diameter larger than 0 5 mm sand ii according to the model with zero effective stresses the critical hydraulic gradient if and the fluidizing and defluidizing velocity qt can be determined using dependence 14 and 18 knowledge of the measurements the best fits of q i can allow determination of the hydraulic conductivity of sands for the increasing and decreasing hydraulic gradients in tests for sands fluidization was observed for lower values of the hydraulic gradient in table 1 imax than predicted by the model in table 1 if the largest discrepancy occurred for the finest sand v and the smallest was observed for sand ii with the highest porosity and relatively narrow grain size distribution the local nature of fluidization and inhomogeneity of grains or deposits might be the causes of the observed discrepancies in the experimental and model results it is worth noting that the methodology used in this work focused on fluidization in the column test and estimation of the fluidization parameters resulted in more complete information about the bed material than the method with the flow rate as an independent variable for which one fluidization speed was found due to the method of determining the minimum fluidization velocity from the bed material in the form of a slurry the studies confirmed a small contribution of nonlinear effects in the evaluation of the fluidizing and defluidizing velocity it can therefore be concluded that if the hydraulic gradient under natural conditions in the hyporheic zone is lower than the critical one and drainage of the water in this zone may take place in accordance with darcy s law both before and after fluidization of this zone recognition of the sand bed fluidization conditions may be useful in hydrology for the determination of groundwater drainage in hydrogeology for the study of surface and underground water interactions in the hyporheic zone in geomorphology when analysing channel processes and in crenology in determining conditions of occurrence of spring sources and zones declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national science centre in poland ncn project 2015 17 8 st10 01833 titled the conditions of the daily fluctuations of the water level in headwaters zones and rivers with consideration of the hyporheic zone impact 
6074,as a significant fraction of carbon in inland waters dissolved organic carbon doc plays a crucial role in carbon cycling at a global scale understanding the linkages between variations in doc and its dominant factors in lakes is critical for estimating its concentration on a larger scale this study characterized the concentrations of doc in the lakes of tibet plateau and explored the major underlying influencing factors the overall mean concentration of doc in these closed lakes had a mean value of 21 80 30 82 mg l mean s d and was higher than open lakes f 174 1 p 0 05 the potential drivers for the concentration of doc in the lakes of tibet plateau were conducted by the correlation analysis of doc with the observed landscape water quality variables and climatic factors the multiple regression model showed that 78 of doc concentrations across the lakes could be explained by shannon evenness index shei of landscape slope and landscape dominance index ldi of which shei explained the most substantial variations for the concentration of doc the changes in the concentrations of doc in river lake interaction were analyzed in qinghai lake watershed the concentration of doc in the qinghai lake water was higher than the surrounding rivers slope and the density of soil organic matter som in the qinghai lake watershed were responsible for the higher doc in lake than rivers the landscape had a significant influence on doc in the lakes and the dominant factor was shei the results observed from this investigation further supplement the information of doc in the inland waters with plateau lakes further this study is expected to improve the understanding of the transport of doc in the river lake ecosystem keywords dissolved organic carbon landscape environmental factors lake tibet plateau 1 introduction as a significant fraction of carbon in inland waters dissolved organic carbon doc plays a crucial role in carbon cycling on a global scale it has a crucial influence on light penetration secondary production and nitrogen dynamics processes in aquatic systems cole et al 2007 mostofa et al 2013 song et al 2018a doc in marine and freshwater systems account for the same amount of carbon as that of atmospheric intake siegenthaler and sarmiento 1993 recent research has reported that the doc stored in lakes and reservoirs of china reached 17 43 tg c song et al 2018a to a greater extent climate change and environmental conditions may be responsible for the variations in the concentrations of doc in water godin et al 2017 liu and chen 2000 xu et al 2013 therefore it is of utmost importance in understanding the concentration of doc in inland waters considering climate change in recent decades the concentrations of doc in many of the lakes in boreal regions have increased and notably its concentrations in boreal lakes are predicted to increase by as much as 65 owing to the effects of climate change on terrestrial ecosystems larsen et al 2011 a widespread increase in the concentrations of doc was also observed in the surface waters of glaciated landscapes across northern and central europe which may be resulted from changes of sulfate deposition with precipitation and temperature gavin et al 2018 and watershed soils acid sensitivity driscoll et al 2016 monteith et al 2007 however these temporal patterns in doc dynamics are difficult to extrapolate from one region to another due to different environments and climates oni et al 2011 understanding the linkages between the variations of doc and its dominant factor in waters is favourable in realizing the estimation of the concentration of doc in a larger scale doc in aquatic environment originates from allochthonous and autochthonous sources the metabolism of phytoplankton and surrounding catchments decides the quality and quantity of doc together sugiyama et al 2004 as the lowest point in the surrounding landscape lakes act as receivers in the landscape from terrestrial and river ecosystems williamson et al 2014 the river lake interaction is an integrated system with the mutual exchange of water nutrients pollutants and organisms in river lake systems gao et al 2014 this relationship could be significantly impacted by natural and anthropogenic factors gao et al 2014 zhang et al 2019 the carbon transport caused by the evolution of river lake interactions has received more attention for better understanding the role of the river lake ecosystem in a global carbon cycle xu and xu 2018 yamada et al 2018 also the primary source of doc in most waters is from the surrounding terrestrial landscape williamson et al 2014 watershed landscape pattern plays a crucial role in the concentration of doc in lakes lapierre et al 2015 lee et al 2018 oni et al 2011 and lakes exhibit different trends of doc in the regions with a different landscape the different landscape processes could alter the quantity and quality of doc exported from terrestrial ecosystems lee et al 2018 boreal peatlands are primary catchment sources of doc and nutrients and higher concentrations and fluxes of doc were often observed in peatland catchments broder et al 2017 burd et al 2018 the agricultural practices also have the potential to alter the doc dynamics of water in a dominant agricultural watershed oh et al 2013 the percentage wetland cover in the catchment could be used as the predictor of concentrations of doc in lakes and rivers ritson et al 2019 xenopoulos et al 2003 to clearly understand the changes in the concentration of doc in lakes it requires the identification of components of the landscape that are responsible for the transport of doc to the lakes for watershed scale the physio geographic factors such as runoff slope and soil organic matter som are useful predictors for regulating the availability of doc and substrate transport lee et al 2019 however few investigations pay attention to the concern of how landscapes effect doc pools in the catchment scale the water volume in tibet plateau lakes is about 550 km3 and 92 of which is present in saline lakes song et al 2018a most of the saline lakes are located in endorheic watersheds which are hydrological terminal and the nutrients and organic matter tend to remain within the waters instead of exported to downstream duarte et al 2008 lakes in tibet plateau always have a high salt content or possessing a significant accumulation of doc with the prolonged sunshine and arid environment song et al 2016 zhang et al 2011 the storage of doc is 13 39 tg c in these alpine lakes which is the most abundant storage of doc in the five lake regions in china song et al 2018a furthermore tibet plateau has the highest alpine lakes in the world where the landscapes in the catchments are different from other parts of lakes in the world which merits further investigations to explore the characteristics of doc and river lakes continuums in recent years the climate change alters the balance of the carbon cycle of water ecosystems and the consequent permafrost and glacier thawing induced by climatic warming could trigger the release of doc preserved in the soil to river lake ecosystems godin et al 2017 tibet plateau is a sensitive area to climate change liu and chen 2000 lakes in tibet plateau play a key role in terrestrial carbon cycling under the conditions of climatic warming but the distribution of the concentration of doc in these waters is not precise which may help in fully understand the role of inland waters in terrestrial carbon cycling in this context we present the investigation of doc concentrations in the lakes of tibet plateau china we hypothesize here that the land use type within lake basins and rivers inflow into lakes all had an important influence on doc concentrations in lakes in tibet plateau we anticipate that the results from the study could further supplement the information on doc in inland waters with plateau lakes more significantly this study is expected to assist in exploring the main influencing factors of the concentrations of doc in lakes and also may improve the understanding of the transport of doc in the river lake ecosystem the objectives of this study are to 1 characterize the concentrations of doc in the lakes of tibet plateau and exploring the primary underlying reasons 2 explore the dominant influencing factors of the concentrations of doc in the lakes of tibet plateau based on the water quality parameters climatic factors and catchment landscapes analysis 3 reveal the variations in the concentrations of doc in lake and the entering rivers to expound the impact of river lake interaction on the concentrations of doc this river lake continuum was selected in qinghai lake whichisthelargestinland lake of china isalsothelargestsaline lake of china 2 materials and methods 2 1 study area tibet plateau in the west of china located between 74 98 e and 28 40 n is the largest and extensive plateau in the world with an area about 2 5 million km2 zhang et al 2011 it is referred to as the third pole of the earth with the earth s largest ice store except for the north and south polar regions kotlia et al 2017 qiu 2008 because of its immense size and elevation the tibetan plateau has a significant influence on the atmospheric circulation of the northern hemisphere kotlia et al 2017 the altitude makes tibet plateau cold and the cover of snow and ice could reflect sunlight making it colder in winter the year round average temperature in this area is lower than 8 c qiu 2008 in the northwest of tibet plateau where the average elevation exceeds 5000 m and the average temperature is 40 c song et al 2016 the annual precipitation in tibet plateau ranges from 100 to 1300 mm and abundant snow takes place in winter also there is intense solar uv radiation because of the dry and thin air with a low concentration of ozone and the duration of total annual average sunshine is over 2600 h there are thousands of closed lakes in tibet plateau and the total area of lakes accounts for more than half of china s inland waters ma et al 2011 lakes in this region are mainly fed by precipitation snow and glacier melting and are sensitive to global warming liu and chen 2000 song et al 2016 despite the present day aridity the lakes with the surface area greater than 10 km2 are still more than 300 which vary from fresh to hypersaline kong et al 2011 the changes in the levels of lake and water stored in this area are the net result of precipitation input from melting glaciers outflow and evaporation kong et al 2011 2 2 water sampling and field measurements three field campaigns were conducted in the summer of 2014 2015 and 2017 fig 1 a and the field campaigns were all performed by the same research group during these field campaigns a total of 310 samples were collected from 80 lakes to be specific 87 samples were taken from 19 lakes in late summer 2014 and 94 samples were collected from 33 lakes in early summer 2015 in summer 2017 93 samples were collected from 28 lakes and 36 samples were collected from 12 previous sampling lakes these lakes were selected based on their salinity gradients and areas these lakes were selected based on their salinity gradients and areas we ensured the selected lakes covered all trophic types and the salinity of lakes was from fresh to hypersaline these lakes are distributed in different land use patterns including forest grass built up land arable land sand swamp and unused land fig 1a the examined lakes ranging in size from 1 to 4256 km2 are situated at altitudes between 2000 and 4718 m above the sea level fig 1b based on the electrical conductivity these lakes are grouped into 33 freshwater n 115 and 47 saline waters n 195 duarte et al 2008 the closed drainage in this area is marked in fig 1b waters were taken as grab samples from approximately 0 5 m below the water surface water samples were collected at 3 5 sampling points from lakes on average these sampling points were evenly distributed across the lake the number of sampling stations in lake were linking to the area of the lake it always had 3 4 points in the lake with area less than 100 km2 4 5 points in the lake with area between 100 and 1000 km2 and 6 points in the lake with area over 1000 km2 an exceptionwas that qinghai lake had 37 sampling points with area of 4256 km2 20 of them was collected in 2013 during sample collection secchi disk depth sdd at each sampling site was measured and recorded using a black and white disk salinity and water temperature were also determined in situ using a portable multi parameter water quality analyzer ysi 6600 u s with the uncertainty of 0 01 and 0 001 k water samples were collected to amber coloured high density polyethylene hdpe bottle and were placed in a portable refrigerator at 4 c for no more than 7 days before they were transported back to the laboratory a part of the collected water samples was filtered through a 0 45 μm glass fiber filter bandao industrial co ltd china within 24 h of the water being got and the filtrate was used for the analysis of doc the concentration of doc was measured using a shimadzu total organic carbon analyzer toc vcpn shimadzu corporation japan the analysis of blanks and replications showed a detection limit of 0 3 mg l a precision of 5 0 at a concentration of 4 mg l and a precision of 3 4 at a concentration of 60 mg l song et al 2018b the concentrations of doc of all the samples were measured by the same instruments the glass fiber filter was used to extract chlorophyll a chla using a 90 buffered acetone solution and the concentration of chla was determined by spectrophotometry uv 2600 pc shimadzu jeffrey and humphrey 1975 in the laboratory the raw water samples were used to test for the concentrations of total phosphorus tp using a continuous flow analyzer skalar san plus system the netherlands the concentration of total suspended matter tsm in raw water samples was determined gravimetrically using a pre combusted 0 7 μm glass fiber millipore filters whatman gf f 1825 047 cleveland and weidemann 1993 the analytical replicates for every parameter were double 2 3 data acquisition and analysis according to the concentrations of sdd tp and chla the trophic state of each lake and sampling site were evaluated based on a modified carlson s trophic state index tsi aizaki et al 1981 carlson 1977 based on the tsi value the lakes are then classified as being eutrophic mesotrophic or oligotrophic tsi 30 indicates an oligotrophic state 30 50 indicates a mesotrophic state and 50 100 indicates a eutrophic state the annual average temperature annual average precipitation wind speed and humidity were all collected from national meteorological information center http data cma cn gis analysis arcgis10 0 software package was used to delineate the catchment areas based on fine resolution 10 m dem data and to derive the slope value the data about catchment came from lake watershed science data center national earth system science data sharing infrastructure national science technology infrastructure of china http lake geodata cn the density of soil organic matter som for the top 20 cm soils in tibet plateau derived the second national soil census song et al 2018b the computation of landscape indices was based on the 50 50 m2 grid dem for tibet plateau in china the land use datasets obtained from the globeland 30 the address of which is http www globallandcover com chinese glc30download index aspx shannon s diversity index shdi shannon evenness index shei and landscape dominance index ldi were calculated by the following equations shdi i 1 m p i l n p i shei i 1 m p i l n p i ln m ldi lnm i 1 m p i l n p i where pi is the area proportion of landscape i to the total area of all the landscapes and m is the number of landscape types non parametric test was employed to test the difference of doc concentrations between fresh and saline lakes using spss 22 0 software the analysis method is two sample kolmogorov smirnov test spearman s rank correlation analysis is used to characterize the relationship in the concentrations of doc with environmental variables including land use type characteristics meteorological factors and water quality characteristics in spss statistics 19 0 software the relationships between doc concentrations and environmental variables were explored using the multivariate regression analysis with stepwise selection model in spss statistics 19 0 software the dependent variable was doc concentrations and the predictors were shei slope humidity precipitation salinity tp and ldi 3 results 3 1 doc concentration and variability in water quality in all the field surveys conducted over the 80 lakes with the diverse land use patterns a vast diversity of lakes with different water qualities was encountered table 1 the transparency and trophic status of these lakes were analyzed and it has been found that 36 51 of the studied lakes in tibet plateau were oligotrophic lakes 44 44 of the studied lakes were mesotrophic lakes whereas the proportion of eutrophication of these lakes was only 19 05 these lakes had good transparency sdd with the median mean standard deviation of 2 45 3 68 5 02 m the salinity of these lakes ranged from 0 04 to 113 23 many lakes located in the closed area and the salinity in these lakes were higher than the lakes in the open area the concentration of doc varies significantly among the 80 lakes the overall mean doc concentration of these sampling lakes was 23 94 34 34 mg l mean s d ranging from 0 27 to 164 80 mg l table 1 the minimum value was observed in the shibu co and the maximum value was noted in the hajiang lake fig s1 the concentrations of doc in several major lakes were compared as shown in fig 2 the qinghai lake showed the highest mean doc concentration 72 97 52 40 mg l and the lowest doc concentration was in nam co with 4 63 1 79 mg l an analysis of the whole land use type in tibet plateau reveals that it is a grass dominated area accounting for 58 8 of land mass use fig 3 followed by forest 10 6 the land use patterns in several main lake basins also demonstrated the grass dominated pattern moreover the proportions of bare land and swamp showed the highest values in qinghai lake than other lake watersheds in this study fig 3 doc concentrations in fresh and saline lakes were compared the concentration of doc in these saline lakes was significantly different from that of the fresh lakes f 222 1 p 0 001 as shown in fig 4 a in terms of either the mean or median value the saline lakes exhibited higher concentration of doc than the fresh lakes a broad range in the concentration of doc 3 89 284 40 mg l was encountered for these saline lakes a higher mean doc concentration was observed 34 07 mg l with some modest variation s d 40 02 mg l the concentrations of doc in fresh lakes ranged from 0 27 to 15 45 mg l and the mean value in fresh lakes was much lower 5 72 4 23 mg l the concentrations of doc in closed lakes were different compared to open lakes f 174 1 p 0 05 the lakes in the closed area displayed higher mean doc concentration 21 80 30 82 mg l compared to the open area 16 29 18 78 mg l 3 2 doc versus environmental factors in tibet plateau the correlation analysis reveals the strongest correlation of doc concentration with the shei of land use type with a spearman s rank correlation coefficient rs of 0 73 and a weakly negative correlation with ldi and the mean slope in the catchment rs 0 39 rs 0 33 p 0 05 the climate parameters analysis showed that only humidity and precipitation were weakly correlated to the concentrations of doc rs 0 21 rs 0 22 p 0 05 the correlation analysis with water quality variables reveals good correlations of doc with salinity and concentration of tp rs 0 51 p 0 01 but no relationship to all other parameters rs 0 2 p 0 05 fig 5 the multiple regression analysis showed that shei slope and ldi had an impact on kd par table 2 and the relationship could be expressed as follows doc 542 42 shei 16 22 slope 48 64 ldi 338 91 r2 0 78 p 0 001 the multiple regression model indicated that these variables could explain 78 of the variance in the concentrations of doc across the lakes the standardized coefficient of independent variables indicated that shei had the most significant impact on the concentration of doc followed by the slope however the water quality parameters salinity and tn concentration and climate characteristics cannot sufficiently explain the spatial differences in the concentrations of doc which were excluded in the building up of the multiple regression model 3 3 doc concentrations in the qinghai lake and the inflow rivers doc concentrations in the qinghai lake basin were analyzed in detail fig 6 the doc concentration in the qinghai lake water was higher than the surrounding rivers fig 6a the mean doc concentration in the lake water was 72 97 52 40 mg l and the doc concentrations in the influent rivers ranged from 1 55 to 5 80 mg l the daotang river was originally the outflow river of qinghai lake and the doc concentration in this river was 12 45 mg l the eastern waters showed the highest doc concentration in qinghai lake fig 6b the doc concentrations inside the lakes were higher than in the outer locations fig 6b the slope analysis of this basin showed that qinghai lake was in the downgrade position fig 6c the som density in qinghai lake basin ranged from 0 3 to 8 and closer to the lake shore it was lower 4 discussion 4 1 analysis in the concentration of doc in tibet plateau lakes the total mean doc concentration of these sampling lakes in tibet plateau was 11 28 23 94 34 34 mg l median mean s d with the range of 0 27 164 80 mg l table 1 compared with the lakes in yungui and east limnetic regions in china the median mean concentrations of doc in tibet plateau lakes were all much higher fig s2 song et al 2018a most of the lakes in the tqr are located in endorheic regions fig 1 fig s3 whereas yungui and east limnetic regions are located in the outflow regions the previous study has pointed out that the closed lakes exhibited significantly higher doc concentrations than the open lakes song et al 2018a song et al 2013 because of no flow export the doc gradually accumulated in these closed lakes with the prolongation of water residence times and strong evapoconcentration song et al 2013 moreover the doc in lakes is related to the watershed som concentrations and the allochthonous doc is likely to be transported into lakes lee et al 2018 in tibet plateau som in the watershed is relatively higher than the yungui and east limnetic regions fig s2 compared to the lakes in northeast and inner mongolia xingjiang limnetic regions the median mean doc concentrations in tibet plateau lakes were lower fig s3 the trophic status may be responsible for the observed phenomenon many studies have shown that eutrophic waters tend to have higher doc concentrations than mesotrophic and oligotrophic waters shang et al 2018 song et al 2018a yoshioka et al 2002 zhang et al 2010 eutrophication generally results in algal blooms thereby higher production of autochthonous doc by phytoplankton and macrophyte pacheco et al 2014 sobek et al 2007 zhang et al 2018 although most of the northeast limnetic region is located in the outflow region fig s4 the proportion of eutrophic lakes among surveyed lakes in this limnetic region reached to 44 and is about 33 in the inner mongolia xingjiang limnetic region in tibet plateau most of the lakes were oligotrophic and mesotrophic and in this study the proportion of eutrophication of the studied lakes was only 15 fig s5 the autochthonous doc accumulation in the tibet plateau lakes might be inhibited by limited nutrients even in the growing season remarkably a higher concentration of doc was found out in the saline lakes than fresh lakes in tibet plateau fig 4a similar results have been found out in the lakes of semi arid area of northern china wen et al 2018 in the semi humid semi arid areas of northern china song et al 2013 in the east central alberta canada curtis and adams 1995 and in the canadian prairies waiser and robarts 2000 the evapoconcentration has an essential effect on the elevated concentration of doc in the saline lakes anderson and stedmon 2007 an increase in the concentration of salt would result in a decreased osmotic potential which has adverse effects on the microbial activity mavi et al 2012 doc can accumulate in the terminal lakes with a lower microbial activity wen et al 2016 the intense ultraviolet uv radiation in tqr has photobleaching and photodegradation effects on doc studies have shown the photoinduced degradation of dissolved organic matter in the natural waters generally convert substances of high molecular weight to low molecular weight the photo production such as h2o2 has been found to increase with salinity linearly in natural waters mostofa et al 2013 nieto cid et al 2006 this is evidence that more doc may be produced in saline lakes through photorespiration or photo assimilation 4 2 effect of environmental factors on the concentration of doc many studies have shown that different landscape processes could alter the quantity and quality of doc exported from terrestrial landscapes lee et al 2018 mao et al 2018 and the primary type of land use in catchment had an important impact on the concentration of doc in lakes broder et al 2017 oh et al 2013 xenopoulos et al 2003 the above studies mainly analyzed the relationship between a specific land use type and the output loading of doc in the surface water and a little is known about how these relationships vary when considering the whole complex landscape in this study the results presented that the concentration of doc in tibet plateau lakes was positively correlated to the landscape shei which indicates that in tibet plateau the more heterogeneous and straightforward landscape is shown in the catchment and a lower doc concentration in the lakes the land use patterns in tibet plateau and several main lake watersheds were all the grass dominated pattern followed by forest 10 6 fig 3 soils with different land covers exhibited substantial differences in their doc concentrations in some grassland systems the organic layers are small or missing which is the major source of doc don and schulze 2008 this appearance may lead to the lower exportation of doc to rivers and lakes from grass soil than peatland and agricultural land eze et al 2018 studies have proven that the concentration of doc in forest soil water increased with precipitation and it was correlated with the concentrations of doc in the nearby outflowing rivers rasilo et al 2015 this study area located in the arid region and the precipitation in summer was only 200 300 mm during the sampling period these may be responsible for the weakly positive correlation between the concentration of doc and landscape ldi observed in this study the dominant landscape had an impact on the final result but this influence was not decisive doc is a readily available substrate for microorganisms whether doc is mineralised depends on environment characteristics ph texture aggregation the composition of the decomposer community and the contact time between doc and decomposer don and schulze 2008 in forested covered catchments the doc of surface waters is primarily from the allochthonous source lofgren and zetterberg 2011 and the doc from the vegetation litter in woodlands was relatively recalcitrant to microbial degradation ritson et al 2019 the doc bioavailability is different in various land soils this could affect the final doc concentration in the surface water within watershed although the grassland and forest dominated most of the catchments in tibet plateau there were also covered with many landscapes including agriculture desert marsh and urban areas fig 1a the multiple land use pattern acts together to control the variations in the concentration of doc in the lakes many studies concerning the catchment scale influences on the concentration of doc in waters admitted the integral effect of catchment landscape oni et al 2011 sliva and williams 2001 the concentration of doc in the mixed land use area was significantly higher than the peaty headwaters in the river exe uk p 0 001 ritson et al 2019 which also indirectly proved the effect of the evenness of landscape might be before the dominant landscape furthermore the concentration of doc in the lakes is the combined effect of a series of processes including surface runoff soil infiltration photolysis biological metabolism and sedimentation jones et al 2016 thus the topography and surficial geology seem to be of particular importance to doc flux and export from the surrounding terrestrial ecosystems sliva and williams 2001 the watershed slope represents physical watershed characteristics that are primarily independent of land use comparing with worldwide surface waters the watershed slope is highlighted as a controlling factor of the doc transport of terrestrial surface water connolly et al 2018 lee et al 2019 sliva and williams 2001 the allochthonous doc is likely to be transported by the surface runoff and rivers into lakes during this transfer process in the subtropical small mountainous rivers the slope could restrain the generation of doc due to shallow soil depth and fast runoff velocity lee et al 2019 in the lakes of tibet plateau the watershed slope also showed a negative relationship with doc in the lakes doc 542 42 shei 16 22 slope 48 64 ldi 338 91 doc in the lakes is related to the watershed som concentrations which depends on the soil saturation and water flow from land to lakes lee et al 2018 the gentle watershed slope brings about a longer water residence times which is beneficial to the leaching of dom from watershed soil and dom is then transferred to the lakes by the permeation or the stream and river networks creed et al 2008 winn et al 2009 the significant relationship between som and watershed slope has been proven in many of the watersheds harms et al 2016 winn et al 2009 4 3 doc transport in rivers qinghai lake continuum lakes in qinghai lake watershed exhibited a high som density fig 6d the density of som in the surrounding landscape played an important role in the concentration of doc in surface water lee et al 2019 song et al 2018b the closer to the qinghai lake the lower som it presented in the soil fig 6d which means that the som in the soil around the lake may be transported to the water soils have been reported as the main source of riverine doc and the transport of doc in river includes the production of doc in soils and the transportation to drainage networks evans et al 2007 riverine doc can represent a significant carbon loss pathway in temperate and boreal soil ecosystems billett et al 2004 finlay et al 2006 the rivers could export this terrestrial carbon to the nearby lakes which indicates that the soc stock dominates the doc supply several studies have stated that rivers and lakes should be considered as a combined conduit and reactor for the transport of terrestrial carbon across the waterscapes cole et al 2007 tranvik et al 2009 studies also proposed that doc increases in the surface water of the uk may be linked to the carbon losses of soil bellamy et al 2005 the destabilization of soil carbon is as a part of anthropogenic influence davidson and janssens 2006 evans et al 2007 thus the anthropogenic activity also had an essential influence on the concentration of doc derived from soil to lakes qinghai lake was fed with more than forty rivers and with no effluent evans et al 2007 xu et al 2013 the different concentrations of doc were shown in the water of the studied river fig 6a changes in the concentrations of doc among these rivers were generally related to contrasts in the organic matter content of soil and water flow through soils among drainage basins judd and kling 2002 mcguire et al 2005 in the warm wet seasons the riverine concentration of doc is likely due to the melting of surface soils which could increase the inflow of dissolved organic material xu et al 2013 this study was conducted in summer and thus the dissolved organic material in the soil had an important influence on the concentration of doc in rivers the concentration of doc in the rivers is also closely linking with the landscapes in the watershed studies also exhibited that the operation management could affect the carbon balance in the agricultural grasslands which may be a driver for soil depletion franzluebbers et al 2000 soussana et al 2004 forests are also significantly influencing on carbon loss the different land use type around qinghai lake determined various concentrations of doc in the rivers fig 3 besides earlier studies have demonstrated that the watershed slope could be as a promising indicator of variations in the concentration of fluvial doc in arctic region with a strong negative relationship connolly et al 2018 harms et al 2016 inamdar et al 2006 in qinghai lake watershed this negative relationship was also presented between the concentration of lake doc and watershed slope rs 0 33 p 0 05 fig 5 qinghai lake was in the downgrade position and played the receiving function of doc fig 6c however the slope in the south shoreline region was steeper than the north shore presenting a higher concentration of fluvial doc fig 6c this indicates that the linkage between watershed slope and concentration of fluvial doc also depends on soil saturation and water flow from land to rivers creed et al 2008 the som in south shore was higher than north shore fig 6d which may be a reason for the higher concentration of fluvial doc the leaching of doc from soil to river networks is a complicated process demonstrating the biogeochemical connectivity among soil rivers and lakes which can assist us to understand their ecological and environmental impacts within a drainage basin xu and xu 2018 there is a connectivity between the doc of rivers and lakes in a river lake continuum which is an integral entity for carbon transport in this study the doc in the inflow rivers qinghai lake was analyzed to assess the transport of doc in such a river lake continuum the concentration of doc in qinghai lake water was higher than the surrounding rivers fig 6a this may be due to that the lake received the inflow fluvial doc without any outflow and doc was accumulated in qinghai lake as a terminal aquatic environment via runoff and rivers passing through various landscapes song et al 2013 although doc in qinghai lake can be lost through sedimentation or being transformed into dissolved inorganic carbon the accumulation may be conducted in waters at a much higher rate than the lost the elevated concentrations of doc in the lake could also be attributed to evaporation which would be expected to be stronger in the arid environment 5 conclusions the main aim of this study was to identify the distribution of the concentration of doc in the lakes of tibet plateau mean doc concentration of 21 80 30 82 mg l in the closed lakes was higher than open lakes f 174 1 p 0 05 however due to the oligotrophic and mesotrophic status the concentration of doc in the lakes of tibet plateau was lower than some of the lakes in the outflow region the potential analysis of drivers for the concentration of doc in the lakes of tibet plateau showed that 78 of the changes in the concentration of doc across the lakes could be explained by shei slope and ldi where shei had the most significant impact on the concentration of doc the concentration of doc in qinghai lake water was higher than the surrounding rivers the slope and som density in qinghai lake watershed might be responsible for the observed phenomenon overall this study is believed to be beneficial to understand the linkages between the variations in doc and its dominant factor in lakes which is favorable in realizing the estimation of the concentration of doc in a larger scale declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research was jointly supported by the national natural science foundation of china no 41730104 and 41701423 national key research and development project of china no 2016yfb0501502 and 2016yfb0602301 1 and the outstanding yong scientist foundation ofinstituteofnortheastgeography andagroecology iga cas the authors would also like to sincerely thank the students and staff from our research group for their assistance with samples collection and laboratory analysis the authors would like to express their gratitude to editsprings https www editsprings com for the expert linguistic services provided acknowledgement for the data support from lake watershed science data center national earth system science data sharing infrastructure national science technology infrastructure of china http lake geodata cn appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 124202 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
6074,as a significant fraction of carbon in inland waters dissolved organic carbon doc plays a crucial role in carbon cycling at a global scale understanding the linkages between variations in doc and its dominant factors in lakes is critical for estimating its concentration on a larger scale this study characterized the concentrations of doc in the lakes of tibet plateau and explored the major underlying influencing factors the overall mean concentration of doc in these closed lakes had a mean value of 21 80 30 82 mg l mean s d and was higher than open lakes f 174 1 p 0 05 the potential drivers for the concentration of doc in the lakes of tibet plateau were conducted by the correlation analysis of doc with the observed landscape water quality variables and climatic factors the multiple regression model showed that 78 of doc concentrations across the lakes could be explained by shannon evenness index shei of landscape slope and landscape dominance index ldi of which shei explained the most substantial variations for the concentration of doc the changes in the concentrations of doc in river lake interaction were analyzed in qinghai lake watershed the concentration of doc in the qinghai lake water was higher than the surrounding rivers slope and the density of soil organic matter som in the qinghai lake watershed were responsible for the higher doc in lake than rivers the landscape had a significant influence on doc in the lakes and the dominant factor was shei the results observed from this investigation further supplement the information of doc in the inland waters with plateau lakes further this study is expected to improve the understanding of the transport of doc in the river lake ecosystem keywords dissolved organic carbon landscape environmental factors lake tibet plateau 1 introduction as a significant fraction of carbon in inland waters dissolved organic carbon doc plays a crucial role in carbon cycling on a global scale it has a crucial influence on light penetration secondary production and nitrogen dynamics processes in aquatic systems cole et al 2007 mostofa et al 2013 song et al 2018a doc in marine and freshwater systems account for the same amount of carbon as that of atmospheric intake siegenthaler and sarmiento 1993 recent research has reported that the doc stored in lakes and reservoirs of china reached 17 43 tg c song et al 2018a to a greater extent climate change and environmental conditions may be responsible for the variations in the concentrations of doc in water godin et al 2017 liu and chen 2000 xu et al 2013 therefore it is of utmost importance in understanding the concentration of doc in inland waters considering climate change in recent decades the concentrations of doc in many of the lakes in boreal regions have increased and notably its concentrations in boreal lakes are predicted to increase by as much as 65 owing to the effects of climate change on terrestrial ecosystems larsen et al 2011 a widespread increase in the concentrations of doc was also observed in the surface waters of glaciated landscapes across northern and central europe which may be resulted from changes of sulfate deposition with precipitation and temperature gavin et al 2018 and watershed soils acid sensitivity driscoll et al 2016 monteith et al 2007 however these temporal patterns in doc dynamics are difficult to extrapolate from one region to another due to different environments and climates oni et al 2011 understanding the linkages between the variations of doc and its dominant factor in waters is favourable in realizing the estimation of the concentration of doc in a larger scale doc in aquatic environment originates from allochthonous and autochthonous sources the metabolism of phytoplankton and surrounding catchments decides the quality and quantity of doc together sugiyama et al 2004 as the lowest point in the surrounding landscape lakes act as receivers in the landscape from terrestrial and river ecosystems williamson et al 2014 the river lake interaction is an integrated system with the mutual exchange of water nutrients pollutants and organisms in river lake systems gao et al 2014 this relationship could be significantly impacted by natural and anthropogenic factors gao et al 2014 zhang et al 2019 the carbon transport caused by the evolution of river lake interactions has received more attention for better understanding the role of the river lake ecosystem in a global carbon cycle xu and xu 2018 yamada et al 2018 also the primary source of doc in most waters is from the surrounding terrestrial landscape williamson et al 2014 watershed landscape pattern plays a crucial role in the concentration of doc in lakes lapierre et al 2015 lee et al 2018 oni et al 2011 and lakes exhibit different trends of doc in the regions with a different landscape the different landscape processes could alter the quantity and quality of doc exported from terrestrial ecosystems lee et al 2018 boreal peatlands are primary catchment sources of doc and nutrients and higher concentrations and fluxes of doc were often observed in peatland catchments broder et al 2017 burd et al 2018 the agricultural practices also have the potential to alter the doc dynamics of water in a dominant agricultural watershed oh et al 2013 the percentage wetland cover in the catchment could be used as the predictor of concentrations of doc in lakes and rivers ritson et al 2019 xenopoulos et al 2003 to clearly understand the changes in the concentration of doc in lakes it requires the identification of components of the landscape that are responsible for the transport of doc to the lakes for watershed scale the physio geographic factors such as runoff slope and soil organic matter som are useful predictors for regulating the availability of doc and substrate transport lee et al 2019 however few investigations pay attention to the concern of how landscapes effect doc pools in the catchment scale the water volume in tibet plateau lakes is about 550 km3 and 92 of which is present in saline lakes song et al 2018a most of the saline lakes are located in endorheic watersheds which are hydrological terminal and the nutrients and organic matter tend to remain within the waters instead of exported to downstream duarte et al 2008 lakes in tibet plateau always have a high salt content or possessing a significant accumulation of doc with the prolonged sunshine and arid environment song et al 2016 zhang et al 2011 the storage of doc is 13 39 tg c in these alpine lakes which is the most abundant storage of doc in the five lake regions in china song et al 2018a furthermore tibet plateau has the highest alpine lakes in the world where the landscapes in the catchments are different from other parts of lakes in the world which merits further investigations to explore the characteristics of doc and river lakes continuums in recent years the climate change alters the balance of the carbon cycle of water ecosystems and the consequent permafrost and glacier thawing induced by climatic warming could trigger the release of doc preserved in the soil to river lake ecosystems godin et al 2017 tibet plateau is a sensitive area to climate change liu and chen 2000 lakes in tibet plateau play a key role in terrestrial carbon cycling under the conditions of climatic warming but the distribution of the concentration of doc in these waters is not precise which may help in fully understand the role of inland waters in terrestrial carbon cycling in this context we present the investigation of doc concentrations in the lakes of tibet plateau china we hypothesize here that the land use type within lake basins and rivers inflow into lakes all had an important influence on doc concentrations in lakes in tibet plateau we anticipate that the results from the study could further supplement the information on doc in inland waters with plateau lakes more significantly this study is expected to assist in exploring the main influencing factors of the concentrations of doc in lakes and also may improve the understanding of the transport of doc in the river lake ecosystem the objectives of this study are to 1 characterize the concentrations of doc in the lakes of tibet plateau and exploring the primary underlying reasons 2 explore the dominant influencing factors of the concentrations of doc in the lakes of tibet plateau based on the water quality parameters climatic factors and catchment landscapes analysis 3 reveal the variations in the concentrations of doc in lake and the entering rivers to expound the impact of river lake interaction on the concentrations of doc this river lake continuum was selected in qinghai lake whichisthelargestinland lake of china isalsothelargestsaline lake of china 2 materials and methods 2 1 study area tibet plateau in the west of china located between 74 98 e and 28 40 n is the largest and extensive plateau in the world with an area about 2 5 million km2 zhang et al 2011 it is referred to as the third pole of the earth with the earth s largest ice store except for the north and south polar regions kotlia et al 2017 qiu 2008 because of its immense size and elevation the tibetan plateau has a significant influence on the atmospheric circulation of the northern hemisphere kotlia et al 2017 the altitude makes tibet plateau cold and the cover of snow and ice could reflect sunlight making it colder in winter the year round average temperature in this area is lower than 8 c qiu 2008 in the northwest of tibet plateau where the average elevation exceeds 5000 m and the average temperature is 40 c song et al 2016 the annual precipitation in tibet plateau ranges from 100 to 1300 mm and abundant snow takes place in winter also there is intense solar uv radiation because of the dry and thin air with a low concentration of ozone and the duration of total annual average sunshine is over 2600 h there are thousands of closed lakes in tibet plateau and the total area of lakes accounts for more than half of china s inland waters ma et al 2011 lakes in this region are mainly fed by precipitation snow and glacier melting and are sensitive to global warming liu and chen 2000 song et al 2016 despite the present day aridity the lakes with the surface area greater than 10 km2 are still more than 300 which vary from fresh to hypersaline kong et al 2011 the changes in the levels of lake and water stored in this area are the net result of precipitation input from melting glaciers outflow and evaporation kong et al 2011 2 2 water sampling and field measurements three field campaigns were conducted in the summer of 2014 2015 and 2017 fig 1 a and the field campaigns were all performed by the same research group during these field campaigns a total of 310 samples were collected from 80 lakes to be specific 87 samples were taken from 19 lakes in late summer 2014 and 94 samples were collected from 33 lakes in early summer 2015 in summer 2017 93 samples were collected from 28 lakes and 36 samples were collected from 12 previous sampling lakes these lakes were selected based on their salinity gradients and areas these lakes were selected based on their salinity gradients and areas we ensured the selected lakes covered all trophic types and the salinity of lakes was from fresh to hypersaline these lakes are distributed in different land use patterns including forest grass built up land arable land sand swamp and unused land fig 1a the examined lakes ranging in size from 1 to 4256 km2 are situated at altitudes between 2000 and 4718 m above the sea level fig 1b based on the electrical conductivity these lakes are grouped into 33 freshwater n 115 and 47 saline waters n 195 duarte et al 2008 the closed drainage in this area is marked in fig 1b waters were taken as grab samples from approximately 0 5 m below the water surface water samples were collected at 3 5 sampling points from lakes on average these sampling points were evenly distributed across the lake the number of sampling stations in lake were linking to the area of the lake it always had 3 4 points in the lake with area less than 100 km2 4 5 points in the lake with area between 100 and 1000 km2 and 6 points in the lake with area over 1000 km2 an exceptionwas that qinghai lake had 37 sampling points with area of 4256 km2 20 of them was collected in 2013 during sample collection secchi disk depth sdd at each sampling site was measured and recorded using a black and white disk salinity and water temperature were also determined in situ using a portable multi parameter water quality analyzer ysi 6600 u s with the uncertainty of 0 01 and 0 001 k water samples were collected to amber coloured high density polyethylene hdpe bottle and were placed in a portable refrigerator at 4 c for no more than 7 days before they were transported back to the laboratory a part of the collected water samples was filtered through a 0 45 μm glass fiber filter bandao industrial co ltd china within 24 h of the water being got and the filtrate was used for the analysis of doc the concentration of doc was measured using a shimadzu total organic carbon analyzer toc vcpn shimadzu corporation japan the analysis of blanks and replications showed a detection limit of 0 3 mg l a precision of 5 0 at a concentration of 4 mg l and a precision of 3 4 at a concentration of 60 mg l song et al 2018b the concentrations of doc of all the samples were measured by the same instruments the glass fiber filter was used to extract chlorophyll a chla using a 90 buffered acetone solution and the concentration of chla was determined by spectrophotometry uv 2600 pc shimadzu jeffrey and humphrey 1975 in the laboratory the raw water samples were used to test for the concentrations of total phosphorus tp using a continuous flow analyzer skalar san plus system the netherlands the concentration of total suspended matter tsm in raw water samples was determined gravimetrically using a pre combusted 0 7 μm glass fiber millipore filters whatman gf f 1825 047 cleveland and weidemann 1993 the analytical replicates for every parameter were double 2 3 data acquisition and analysis according to the concentrations of sdd tp and chla the trophic state of each lake and sampling site were evaluated based on a modified carlson s trophic state index tsi aizaki et al 1981 carlson 1977 based on the tsi value the lakes are then classified as being eutrophic mesotrophic or oligotrophic tsi 30 indicates an oligotrophic state 30 50 indicates a mesotrophic state and 50 100 indicates a eutrophic state the annual average temperature annual average precipitation wind speed and humidity were all collected from national meteorological information center http data cma cn gis analysis arcgis10 0 software package was used to delineate the catchment areas based on fine resolution 10 m dem data and to derive the slope value the data about catchment came from lake watershed science data center national earth system science data sharing infrastructure national science technology infrastructure of china http lake geodata cn the density of soil organic matter som for the top 20 cm soils in tibet plateau derived the second national soil census song et al 2018b the computation of landscape indices was based on the 50 50 m2 grid dem for tibet plateau in china the land use datasets obtained from the globeland 30 the address of which is http www globallandcover com chinese glc30download index aspx shannon s diversity index shdi shannon evenness index shei and landscape dominance index ldi were calculated by the following equations shdi i 1 m p i l n p i shei i 1 m p i l n p i ln m ldi lnm i 1 m p i l n p i where pi is the area proportion of landscape i to the total area of all the landscapes and m is the number of landscape types non parametric test was employed to test the difference of doc concentrations between fresh and saline lakes using spss 22 0 software the analysis method is two sample kolmogorov smirnov test spearman s rank correlation analysis is used to characterize the relationship in the concentrations of doc with environmental variables including land use type characteristics meteorological factors and water quality characteristics in spss statistics 19 0 software the relationships between doc concentrations and environmental variables were explored using the multivariate regression analysis with stepwise selection model in spss statistics 19 0 software the dependent variable was doc concentrations and the predictors were shei slope humidity precipitation salinity tp and ldi 3 results 3 1 doc concentration and variability in water quality in all the field surveys conducted over the 80 lakes with the diverse land use patterns a vast diversity of lakes with different water qualities was encountered table 1 the transparency and trophic status of these lakes were analyzed and it has been found that 36 51 of the studied lakes in tibet plateau were oligotrophic lakes 44 44 of the studied lakes were mesotrophic lakes whereas the proportion of eutrophication of these lakes was only 19 05 these lakes had good transparency sdd with the median mean standard deviation of 2 45 3 68 5 02 m the salinity of these lakes ranged from 0 04 to 113 23 many lakes located in the closed area and the salinity in these lakes were higher than the lakes in the open area the concentration of doc varies significantly among the 80 lakes the overall mean doc concentration of these sampling lakes was 23 94 34 34 mg l mean s d ranging from 0 27 to 164 80 mg l table 1 the minimum value was observed in the shibu co and the maximum value was noted in the hajiang lake fig s1 the concentrations of doc in several major lakes were compared as shown in fig 2 the qinghai lake showed the highest mean doc concentration 72 97 52 40 mg l and the lowest doc concentration was in nam co with 4 63 1 79 mg l an analysis of the whole land use type in tibet plateau reveals that it is a grass dominated area accounting for 58 8 of land mass use fig 3 followed by forest 10 6 the land use patterns in several main lake basins also demonstrated the grass dominated pattern moreover the proportions of bare land and swamp showed the highest values in qinghai lake than other lake watersheds in this study fig 3 doc concentrations in fresh and saline lakes were compared the concentration of doc in these saline lakes was significantly different from that of the fresh lakes f 222 1 p 0 001 as shown in fig 4 a in terms of either the mean or median value the saline lakes exhibited higher concentration of doc than the fresh lakes a broad range in the concentration of doc 3 89 284 40 mg l was encountered for these saline lakes a higher mean doc concentration was observed 34 07 mg l with some modest variation s d 40 02 mg l the concentrations of doc in fresh lakes ranged from 0 27 to 15 45 mg l and the mean value in fresh lakes was much lower 5 72 4 23 mg l the concentrations of doc in closed lakes were different compared to open lakes f 174 1 p 0 05 the lakes in the closed area displayed higher mean doc concentration 21 80 30 82 mg l compared to the open area 16 29 18 78 mg l 3 2 doc versus environmental factors in tibet plateau the correlation analysis reveals the strongest correlation of doc concentration with the shei of land use type with a spearman s rank correlation coefficient rs of 0 73 and a weakly negative correlation with ldi and the mean slope in the catchment rs 0 39 rs 0 33 p 0 05 the climate parameters analysis showed that only humidity and precipitation were weakly correlated to the concentrations of doc rs 0 21 rs 0 22 p 0 05 the correlation analysis with water quality variables reveals good correlations of doc with salinity and concentration of tp rs 0 51 p 0 01 but no relationship to all other parameters rs 0 2 p 0 05 fig 5 the multiple regression analysis showed that shei slope and ldi had an impact on kd par table 2 and the relationship could be expressed as follows doc 542 42 shei 16 22 slope 48 64 ldi 338 91 r2 0 78 p 0 001 the multiple regression model indicated that these variables could explain 78 of the variance in the concentrations of doc across the lakes the standardized coefficient of independent variables indicated that shei had the most significant impact on the concentration of doc followed by the slope however the water quality parameters salinity and tn concentration and climate characteristics cannot sufficiently explain the spatial differences in the concentrations of doc which were excluded in the building up of the multiple regression model 3 3 doc concentrations in the qinghai lake and the inflow rivers doc concentrations in the qinghai lake basin were analyzed in detail fig 6 the doc concentration in the qinghai lake water was higher than the surrounding rivers fig 6a the mean doc concentration in the lake water was 72 97 52 40 mg l and the doc concentrations in the influent rivers ranged from 1 55 to 5 80 mg l the daotang river was originally the outflow river of qinghai lake and the doc concentration in this river was 12 45 mg l the eastern waters showed the highest doc concentration in qinghai lake fig 6b the doc concentrations inside the lakes were higher than in the outer locations fig 6b the slope analysis of this basin showed that qinghai lake was in the downgrade position fig 6c the som density in qinghai lake basin ranged from 0 3 to 8 and closer to the lake shore it was lower 4 discussion 4 1 analysis in the concentration of doc in tibet plateau lakes the total mean doc concentration of these sampling lakes in tibet plateau was 11 28 23 94 34 34 mg l median mean s d with the range of 0 27 164 80 mg l table 1 compared with the lakes in yungui and east limnetic regions in china the median mean concentrations of doc in tibet plateau lakes were all much higher fig s2 song et al 2018a most of the lakes in the tqr are located in endorheic regions fig 1 fig s3 whereas yungui and east limnetic regions are located in the outflow regions the previous study has pointed out that the closed lakes exhibited significantly higher doc concentrations than the open lakes song et al 2018a song et al 2013 because of no flow export the doc gradually accumulated in these closed lakes with the prolongation of water residence times and strong evapoconcentration song et al 2013 moreover the doc in lakes is related to the watershed som concentrations and the allochthonous doc is likely to be transported into lakes lee et al 2018 in tibet plateau som in the watershed is relatively higher than the yungui and east limnetic regions fig s2 compared to the lakes in northeast and inner mongolia xingjiang limnetic regions the median mean doc concentrations in tibet plateau lakes were lower fig s3 the trophic status may be responsible for the observed phenomenon many studies have shown that eutrophic waters tend to have higher doc concentrations than mesotrophic and oligotrophic waters shang et al 2018 song et al 2018a yoshioka et al 2002 zhang et al 2010 eutrophication generally results in algal blooms thereby higher production of autochthonous doc by phytoplankton and macrophyte pacheco et al 2014 sobek et al 2007 zhang et al 2018 although most of the northeast limnetic region is located in the outflow region fig s4 the proportion of eutrophic lakes among surveyed lakes in this limnetic region reached to 44 and is about 33 in the inner mongolia xingjiang limnetic region in tibet plateau most of the lakes were oligotrophic and mesotrophic and in this study the proportion of eutrophication of the studied lakes was only 15 fig s5 the autochthonous doc accumulation in the tibet plateau lakes might be inhibited by limited nutrients even in the growing season remarkably a higher concentration of doc was found out in the saline lakes than fresh lakes in tibet plateau fig 4a similar results have been found out in the lakes of semi arid area of northern china wen et al 2018 in the semi humid semi arid areas of northern china song et al 2013 in the east central alberta canada curtis and adams 1995 and in the canadian prairies waiser and robarts 2000 the evapoconcentration has an essential effect on the elevated concentration of doc in the saline lakes anderson and stedmon 2007 an increase in the concentration of salt would result in a decreased osmotic potential which has adverse effects on the microbial activity mavi et al 2012 doc can accumulate in the terminal lakes with a lower microbial activity wen et al 2016 the intense ultraviolet uv radiation in tqr has photobleaching and photodegradation effects on doc studies have shown the photoinduced degradation of dissolved organic matter in the natural waters generally convert substances of high molecular weight to low molecular weight the photo production such as h2o2 has been found to increase with salinity linearly in natural waters mostofa et al 2013 nieto cid et al 2006 this is evidence that more doc may be produced in saline lakes through photorespiration or photo assimilation 4 2 effect of environmental factors on the concentration of doc many studies have shown that different landscape processes could alter the quantity and quality of doc exported from terrestrial landscapes lee et al 2018 mao et al 2018 and the primary type of land use in catchment had an important impact on the concentration of doc in lakes broder et al 2017 oh et al 2013 xenopoulos et al 2003 the above studies mainly analyzed the relationship between a specific land use type and the output loading of doc in the surface water and a little is known about how these relationships vary when considering the whole complex landscape in this study the results presented that the concentration of doc in tibet plateau lakes was positively correlated to the landscape shei which indicates that in tibet plateau the more heterogeneous and straightforward landscape is shown in the catchment and a lower doc concentration in the lakes the land use patterns in tibet plateau and several main lake watersheds were all the grass dominated pattern followed by forest 10 6 fig 3 soils with different land covers exhibited substantial differences in their doc concentrations in some grassland systems the organic layers are small or missing which is the major source of doc don and schulze 2008 this appearance may lead to the lower exportation of doc to rivers and lakes from grass soil than peatland and agricultural land eze et al 2018 studies have proven that the concentration of doc in forest soil water increased with precipitation and it was correlated with the concentrations of doc in the nearby outflowing rivers rasilo et al 2015 this study area located in the arid region and the precipitation in summer was only 200 300 mm during the sampling period these may be responsible for the weakly positive correlation between the concentration of doc and landscape ldi observed in this study the dominant landscape had an impact on the final result but this influence was not decisive doc is a readily available substrate for microorganisms whether doc is mineralised depends on environment characteristics ph texture aggregation the composition of the decomposer community and the contact time between doc and decomposer don and schulze 2008 in forested covered catchments the doc of surface waters is primarily from the allochthonous source lofgren and zetterberg 2011 and the doc from the vegetation litter in woodlands was relatively recalcitrant to microbial degradation ritson et al 2019 the doc bioavailability is different in various land soils this could affect the final doc concentration in the surface water within watershed although the grassland and forest dominated most of the catchments in tibet plateau there were also covered with many landscapes including agriculture desert marsh and urban areas fig 1a the multiple land use pattern acts together to control the variations in the concentration of doc in the lakes many studies concerning the catchment scale influences on the concentration of doc in waters admitted the integral effect of catchment landscape oni et al 2011 sliva and williams 2001 the concentration of doc in the mixed land use area was significantly higher than the peaty headwaters in the river exe uk p 0 001 ritson et al 2019 which also indirectly proved the effect of the evenness of landscape might be before the dominant landscape furthermore the concentration of doc in the lakes is the combined effect of a series of processes including surface runoff soil infiltration photolysis biological metabolism and sedimentation jones et al 2016 thus the topography and surficial geology seem to be of particular importance to doc flux and export from the surrounding terrestrial ecosystems sliva and williams 2001 the watershed slope represents physical watershed characteristics that are primarily independent of land use comparing with worldwide surface waters the watershed slope is highlighted as a controlling factor of the doc transport of terrestrial surface water connolly et al 2018 lee et al 2019 sliva and williams 2001 the allochthonous doc is likely to be transported by the surface runoff and rivers into lakes during this transfer process in the subtropical small mountainous rivers the slope could restrain the generation of doc due to shallow soil depth and fast runoff velocity lee et al 2019 in the lakes of tibet plateau the watershed slope also showed a negative relationship with doc in the lakes doc 542 42 shei 16 22 slope 48 64 ldi 338 91 doc in the lakes is related to the watershed som concentrations which depends on the soil saturation and water flow from land to lakes lee et al 2018 the gentle watershed slope brings about a longer water residence times which is beneficial to the leaching of dom from watershed soil and dom is then transferred to the lakes by the permeation or the stream and river networks creed et al 2008 winn et al 2009 the significant relationship between som and watershed slope has been proven in many of the watersheds harms et al 2016 winn et al 2009 4 3 doc transport in rivers qinghai lake continuum lakes in qinghai lake watershed exhibited a high som density fig 6d the density of som in the surrounding landscape played an important role in the concentration of doc in surface water lee et al 2019 song et al 2018b the closer to the qinghai lake the lower som it presented in the soil fig 6d which means that the som in the soil around the lake may be transported to the water soils have been reported as the main source of riverine doc and the transport of doc in river includes the production of doc in soils and the transportation to drainage networks evans et al 2007 riverine doc can represent a significant carbon loss pathway in temperate and boreal soil ecosystems billett et al 2004 finlay et al 2006 the rivers could export this terrestrial carbon to the nearby lakes which indicates that the soc stock dominates the doc supply several studies have stated that rivers and lakes should be considered as a combined conduit and reactor for the transport of terrestrial carbon across the waterscapes cole et al 2007 tranvik et al 2009 studies also proposed that doc increases in the surface water of the uk may be linked to the carbon losses of soil bellamy et al 2005 the destabilization of soil carbon is as a part of anthropogenic influence davidson and janssens 2006 evans et al 2007 thus the anthropogenic activity also had an essential influence on the concentration of doc derived from soil to lakes qinghai lake was fed with more than forty rivers and with no effluent evans et al 2007 xu et al 2013 the different concentrations of doc were shown in the water of the studied river fig 6a changes in the concentrations of doc among these rivers were generally related to contrasts in the organic matter content of soil and water flow through soils among drainage basins judd and kling 2002 mcguire et al 2005 in the warm wet seasons the riverine concentration of doc is likely due to the melting of surface soils which could increase the inflow of dissolved organic material xu et al 2013 this study was conducted in summer and thus the dissolved organic material in the soil had an important influence on the concentration of doc in rivers the concentration of doc in the rivers is also closely linking with the landscapes in the watershed studies also exhibited that the operation management could affect the carbon balance in the agricultural grasslands which may be a driver for soil depletion franzluebbers et al 2000 soussana et al 2004 forests are also significantly influencing on carbon loss the different land use type around qinghai lake determined various concentrations of doc in the rivers fig 3 besides earlier studies have demonstrated that the watershed slope could be as a promising indicator of variations in the concentration of fluvial doc in arctic region with a strong negative relationship connolly et al 2018 harms et al 2016 inamdar et al 2006 in qinghai lake watershed this negative relationship was also presented between the concentration of lake doc and watershed slope rs 0 33 p 0 05 fig 5 qinghai lake was in the downgrade position and played the receiving function of doc fig 6c however the slope in the south shoreline region was steeper than the north shore presenting a higher concentration of fluvial doc fig 6c this indicates that the linkage between watershed slope and concentration of fluvial doc also depends on soil saturation and water flow from land to rivers creed et al 2008 the som in south shore was higher than north shore fig 6d which may be a reason for the higher concentration of fluvial doc the leaching of doc from soil to river networks is a complicated process demonstrating the biogeochemical connectivity among soil rivers and lakes which can assist us to understand their ecological and environmental impacts within a drainage basin xu and xu 2018 there is a connectivity between the doc of rivers and lakes in a river lake continuum which is an integral entity for carbon transport in this study the doc in the inflow rivers qinghai lake was analyzed to assess the transport of doc in such a river lake continuum the concentration of doc in qinghai lake water was higher than the surrounding rivers fig 6a this may be due to that the lake received the inflow fluvial doc without any outflow and doc was accumulated in qinghai lake as a terminal aquatic environment via runoff and rivers passing through various landscapes song et al 2013 although doc in qinghai lake can be lost through sedimentation or being transformed into dissolved inorganic carbon the accumulation may be conducted in waters at a much higher rate than the lost the elevated concentrations of doc in the lake could also be attributed to evaporation which would be expected to be stronger in the arid environment 5 conclusions the main aim of this study was to identify the distribution of the concentration of doc in the lakes of tibet plateau mean doc concentration of 21 80 30 82 mg l in the closed lakes was higher than open lakes f 174 1 p 0 05 however due to the oligotrophic and mesotrophic status the concentration of doc in the lakes of tibet plateau was lower than some of the lakes in the outflow region the potential analysis of drivers for the concentration of doc in the lakes of tibet plateau showed that 78 of the changes in the concentration of doc across the lakes could be explained by shei slope and ldi where shei had the most significant impact on the concentration of doc the concentration of doc in qinghai lake water was higher than the surrounding rivers the slope and som density in qinghai lake watershed might be responsible for the observed phenomenon overall this study is believed to be beneficial to understand the linkages between the variations in doc and its dominant factor in lakes which is favorable in realizing the estimation of the concentration of doc in a larger scale declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research was jointly supported by the national natural science foundation of china no 41730104 and 41701423 national key research and development project of china no 2016yfb0501502 and 2016yfb0602301 1 and the outstanding yong scientist foundation ofinstituteofnortheastgeography andagroecology iga cas the authors would also like to sincerely thank the students and staff from our research group for their assistance with samples collection and laboratory analysis the authors would like to express their gratitude to editsprings https www editsprings com for the expert linguistic services provided acknowledgement for the data support from lake watershed science data center national earth system science data sharing infrastructure national science technology infrastructure of china http lake geodata cn appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2019 124202 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
