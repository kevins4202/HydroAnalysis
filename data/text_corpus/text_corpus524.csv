index,text
2620,water scarcity and soil salinization are two major problems threatening the sustainability of irrigation districts in arid regions with shallow groundwater table to study water and salt balances in arid irrigation districts we developed a monthly distributed water and salt balance model for arid irrigation district dahmid s with shallow groundwater table by integrating models of major hydrological processes and the associated salt transport processes including irrigation evapotranspiration soil water and groundwater and salt balances drainage of water and salt through ditches and interior drainage of water and associated dry drainage of salt between irrigated and non irrigated lands the model was successfully applied to the hetao irrigation district hid the largest irrigation district in the arid region of china results indicate that evapotranspiration is the dominant water consumption component in the hid and accounts for about 95 of the total irrigation and precipitation while drainage through ditches accounts for 10 5 of the total irrigation only 49 4 of the introduced salt is discharged from the hid through drainage ditches consequently most parts of the hid are in the state of salt accumulation except the northern wulate sub irrigation district and the problem of salt accumulation is more serious in the western and southern hid under more favorable conditions of water use dry drainage plays a crucial role in salt balance of both irrigated and non irrigated lands which results in desalinization in most irrigated lands while salt accumulation in non irrigated lands appropriate measures should be taken to solve water and salt related problems to improve the sustainability of the hid in the western hid irrigation water diversion should be decreased and the drainage system should be further improved to decrease the salt accumulation to a lower level meanwhile the irrigation water diversion can be increased in the southeastern hid by planting more corn and wheat besides irrigation management should be improved to reduce the surface water return flow to increase the groundwater drainage capacity especially in the southwestern hid keywords irrigation district water balance salt balance drainage dry drainage distributed model data availability the authors do not have permission to share data 1 introduction arid regions including hyper arid arid and semi arid regions cover about 39 4 of the earth s terrestrial surface and the percentage is expected to increase in the future due to climate change koutroulis 2019 land resource in the arid region is abundant which provides the possibility for regional or even global food security however the arid region is characterized by scarcity of precipitation and water resources therefore the agricultural production in arid region is mainly concentrated in irrigation districts and relies heavily on the availability of irrigation water meanwhile the unmatched irrigation and drainage systems and improper irrigation water management practices may lead to soil salinization in many arid irrigation districts which in turn threatens the agricultural production and sustainability of the irrigation districts wichelns and qadir 2015 devkota et al 2022 therefore it is crucial to study water and salt balances in arid irrigation districts to support irrigation water management and soil salinization control different from the dominated hydrological processes of precipitation runoff and evapotranspiration in humid watersheds hydrological processes in arid irrigation districts are dominated by irrigation water diversion drainage and evapotranspiration moreover interior drainage lateral groundwater flow between irrigated and non irrigated lands and associated dry drainage of salt are important for water and salt balances of different land use types in arid irrigation districts with shallow groundwater table yu et al 2016 ren et al 2018 wen et al 2022 consequently commonly used hydrological models such as the topmodel beven and kirkby 1979 she abbott et al 1986 xinanjiang zhao 1992 vic liang et al 1994 and swat arnold et al 1998 models are not applicable directly to arid irrigation districts to account for the impact of anthropogenic activities on hydrological processes in arid irrigation districts modules describing irrigation drainage and or crop growth have also been added to traditional hydrological models to study hydrological processes in irrigation districts e g christiansen et al 2004 ahmadzadeh et al 2016 malek et al 2017 xiong et al 2019 moreover some agro hydrological models for the cropland have also been extended to the irrigation district or catchment scale for distributed simulation of water flow and or salt transport processes such as hydrus van gaelen et al 2017 swap xue and ren 2016 xu et al 2019 rzwqm2 xi et al 2017 saltmod singh 2012 and sahysmod singh and panda 2012 the above distributed agro hydrological models have been widely used but they may have some problems when applied to arid irrigation districts with shallow groundwater table for example some models mainly consider the hydrological processes in the vertical direction in simulation units while ignoring groundwater interior drainage and associated dry drainage that are important for water and salt balances in different land use types yu et al 2016 ren et al 2018 wen et al 2022 besides a large amount of distributed model parameters and inputs required by the model also limit their wide use singh and panda 2012 wen et al 2022 developed a monthly distributed agro hydrological model for irrigation district dahmid with shallow groundwater table to study the total groundwater and soil water balances of irrigated and non irrigated lands in each sub canal command area within an irrigation district the dahmid integrated models for major hydrological processes in arid irrigation districts including a remote sensing based evapotranspiration et model yang and shang 2013 a semi distributed drainage model wen et al 2020 a variable specific yield model for long term groundwater table fluctuation prediction crosbie et al 2005 and an interior drainage model for lateral groundwater flow between irrigated and non irrigated lands the model has been successfully applied in the hetao irrigation district hid of china however salt transport processes are not considered in the model in arid irrigation district with shallow groundwater table such as the hid soil salinization due to improper irrigation and drainage practices is another key factor influencing agricultural production therefore it is crucial to study salt balance and transport processes associated with water flow processes in these irrigation districts such as salt transports with irrigation drainage and interior drainage main objective of this study is to develop a novel monthly distributed water and salt balance model dahmid s for irrigation district with shallow groundwater table by incorporating the dahmid model and sub models for the salt transport processes the dahmid s considers salt transport with drainage through ditch system as well as interior drainage from irrigated cropland to non irrigated land and therefore allows us to study water and salt balances in both irrigated cropland and non irrigated land that are important for soil salinization control in cropland 2 materials and methods 2 1 description of study irrigation district the hid lies in 40 1 41 4 n and 106 1 109 4 e in the west of inner mongolia autonomous region of china and is the largest irrigation district in arid region of northwest china fig 1 the hid covers a total land area of 1 2 million ha with an irrigated cropland area of 0 58 million ha the hid is located in a typical arid continental climate zone characterized by scarce precipitation of around 160 mm per year and strong potential evaporation of about 2240 mm per year measured with 20 cm evaporation pan ren et al 2016 wen et al 2022 therefore irrigation is essential for agricultural production in the hid irrigation water is mainly diverted from the sanshenggong canal head at the yellow river fig 1 and has a relatively small salinity of approximately 0 6 kg m3 the hid has a complex seven level irrigation canal and drainage ditch system with the total canal and ditch lengths of about 50400 km and 14000 km respectively wen et al 2020 the drainage salinity in different ditches ranges from 0 53 to 19 66 kg m3 which is generally much higher than the irrigation salinity meanwhile drainage salinity in the lower reach of the hid is generally higher than the upper reach due to runoff decrease and integrated water resources management of the yellow river basin available irrigation water from the yellow river to the hid tends to decrease in recent years which has a significant influence on water balance in the hid wen et al 2022 meanwhile drainage in most parts of the hid is not enough due to flat terrain with a gentle slope of about 0 2 from the southwest to the northeast which has resulted in shallower groundwater table and severer soil salinization in some parts of the hid li et al 2012 ren et al 2018 in the hid groundwater table depth generally fluctuates between 0 5 and 3 0 m while groundwater salinity from 1 3 to 12 2 kg m3 that is generally higher in the lower reaches severe soil salinization areas cover about 25 of the whole hid li et al 2012 ren et al 2018 available studies showed that interior drainage of groundwater and dry drainage of salt from irrigated lands to non irrigated lands are important pathways of water and salt drainage through lateral groundwater flow in the hid yu et al 2016 ren et al 2018 and other similar irrigation districts in arid region han 2009 therefore drainage through ditches and interior drainage should be considered simultaneously in water and salt balance analysis for irrigation districts like the hid 2 2 data collection data required for the monthly distributed water and salt balance model in arid irrigation district dahmid s mainly include 1 meteorological data from 2008 to 2014 collected from china meteorological data service center http data cma cn and water resources development center of hetao irrigation district http www zghtgq com 2 digital elevation model dem downloaded from geospatial data cloud http www gscloud cn 3 soil texture downloaded from national tibetan plateau data center http data tpdc ac cn 4 land use map in 2010 downloaded from the department of earth system science tsinghua university http data ess tsinghua edu cn 5 surface reflectance and land surface temperature products from 2008 to 2014 downloaded from the moderate resolution imaging spectroradiometer modis aboard the terra and aqua satellites https ladsweb modaps eosdis nasa gov 6 irrigation canal and drainage ditch systems monthly amount and salinity of irrigation water and drainage water and groundwater table depth and salinity data from 2008 to 2014 collected from bayannur water conservancy research institute and water resources development center of hetao irrigation district http www zghtgq com among the above datasets the datasets related with salinities of irrigation water drainage water and groundwater are newly added in the dahmid s model while the rest datasets are used both in the previous dahmid model wen et al 2022 and the present dahmid s model groundwater table depth from 2008 to 2014 except 2011 was measured every 5 days in 224 wells while groundwater salinity was measured in the middle of january march may july september october and november in 115 wells from 2008 to 2014 the groundwater table depth and salinity data were interpolated to a spatial resolution of 250 m by the widely used ordinary kriging method and used mainly for model evaluation 2 3 delineation of simulation units different from watershed delineation that depends mainly on dem the simulation units for the irrigation districts with flat terrain are delineated on the bases of irrigation system drainage system land use map sub irrigation district map and soil texture map following wen et al 2022 the hid was divided into 13 canal command areas ccas based on 21 main and secondary canals 19 sub drainage command areas sdcas based on 17 main and secondary ditches two land use types irrigated lands and non irrigated lands reclassified from land use map fig 1 five sub irrigation districts fig 1 and three dominant soil textures sandy loam silty clay and sand consequently 306 simulation units were delineated wen et al 2022 2 4 monthly distributed water and salt balance model for irrigation district with shallow groundwater table wen et al 2022 developed a monthly distributed agro hydrological model for irrigation district dahmid with shallow groundwater table to study the total groundwater and soil water balances of irrigated and non irrigated lands in each cca in the present study sub models for salt transport processes associated with the water flow processes are further incorporated into the dahmid model to develop a monthly distributed water and salt balance model for irrigation district dahmid s with shallow groundwater table fig 2 generally salt is introduced into the irrigation district with irrigation water diversion part of which enters the irrigated land with canal seepage and field irrigation while others into non irrigated land through canal seepage then salt enters into the groundwater layer along with deep percolation salt in groundwater can be drained out of the irrigation district through the drainage system while groundwater salt in irrigated land can also be transported to non irrigated land through dry drainage salt drainage through ditches and dry drainage from irrigated land to non irrigated land are modelled in the dahmid s overall the model is a conceptual model based on water and salt balances applied to the irrigated and non irrigated lands of each cca the water and salt balances are analyzed for different units vertical layers and agricultural periods 2 4 1 brief introduction of the dahmid model the dahmid is composed of several sub models depicting major hydrological processes in irrigation district with shallow groundwater table including a remote sensing based evapotranspiration et model yang and shang 2013 and an empirical model yu et al 2016 for et estimation in the plant growth period from april to october and soil freezing and thawing period from november to next march respectively a semi distributed drainage model wen et al 2020 a variable specific yield sy model for long term groundwater table fluctuation prediction crosbie et al 2005 an empirical model for groundwater table fluctuation in soil freezing and thawing period liu et al 2017 and an interior drainage model wen et al 2022 evapotranspiration et is the major water consumption component in arid irrigation districts in the plant growth period from april to october et is estimated with a hybrid dual source scheme and trapezoid framework based evapotranspiration model htem yang and shang 2013 which is fed with the modis surface reflectance and land surface temperature products as a result et with a spatial resolution of 250 m can be obtained wen et al 2022 during soil freezing and thawing period from november to next march an empirical model yu et al 2016 is used to estimate the monthly et drainage is an important way to drain excess water and salt from the irrigation district to drainage ditches and finally to the drainage receiver water drained into the ditches is modelled as the sum of surface return flow from irrigation canals or irrigated lands and groundwater drainage from both irrigated and non irrigated lands which is 1 d t i k max d g i k d s i k 0 where d t ik d s ik and d g ik are total drainage surface return flow and groundwater drainage of the ith sdca 104 m3 in the kth month respectively following wen et al 2020 the monthly surface return flow is estimated as a proportion of excess irrigation over a threshold and the monthly groundwater drainage is calculated from the difference of water levels in groundwater and drainage ditch according to darcy s law in non freezing period from april to october the groundwater table fluctuation is modelled with the long term groundwater fluctuation theory proposed by crosbie et al 2005 which is based on the van genuchten vg 1980 model for soil water characteristic curve in this model the variable specific yield is related to the groundwater table depth and can be calculated by eq 2 for irrigated the subscript lu a and non irrigated lu na lands respectively 2 s y lu s y u s y u 1 α gh lu k 1 gh lu k 2 100 2 β 1 1 β where sy lu is the apparent specific yield that changes with the groundwater table depth sy u is the ultimate specific yield close to the difference between saturated and residual water contents crosbie et al 2005 gh k 1 and gh k 2 are the average groundwater table depths of the simulation unit in the k 1th beginning and k 2th end months m respectively α cm 1 and β are soil specific parameters of the vg van genuchten 1980 model and need to be calibrated for different soil textures besides groundwater table variations in soil freezing and thawing periods are mainly determined by the freezing and thawing processes and an empirical model liu et al 2017 is used to estimate the monthly groundwater table fluctuations 2 4 2 interior drainage and dry drainage models interior drainage and dry drainage are lateral groundwater flow and associated salt transport from irrigated to non irrigated lands due to groundwater level gradient after irrigation respectively they are important supplements to the drainage system in arid irrigation districts with shallow groundwater table konukcu et al 2006 yu et al 2016 from darcy s law for groundwater flow monthly interior drainage of the kth month in the jth cca gt jk 104 m3 can be calculated from wen et al 2022 3 gt jk k gt j el a j gh a j k gh a j k 1 2 el na j gh na j k gh na j k 1 2 a s j where k gt j is the efficiency coefficient of groundwater flow between irrigated and non irrigated lands per unit area in the jth cca subscripts a and na refer to irrigated and non irrigated lands respectively el j is the average elevation of ground surface m in the jth cca gh jk and gh j k 1 are the groundwater table depths at the beginning of the kth and k 1 th months m respectively and a s j is the area of the simulation unit hm2 then monthly dry drainage of salt gst jk in the jth cca salt transport between irrigated and non irrigated lands can be calculated from 4 gst jk gt jk s gt j k where s gt jk is the salinity of interior drainage in the jth cca in the kth month in most cases interior drainage results in groundwater flow from irrigated to non irrigated lands gt jk greater than 0 and s gt jk can be approximated as groundwater salinity in the irrigated lands s ga jk while in rare cases when groundwater flows from non irrigated to irrigated lands gt jk less than 0 s gt jk can be approximated as groundwater salinity in the non irrigated lands s gna jk consequently s gt jk can be estimated from 5 s gt j k s ga j k gt jk 0 s gna j k gt jk 0 furthermore dry drainage efficiency e gst is defined as dry drainage amount per unit irrigation water and can be calculated by 6 e gst j k gst jk i jk this indicator can reflect the amount of salt transported from irrigated land to non irrigated land per unit irrigation water application the larger the dry drainage efficiency the better the dry drainage effect 2 4 3 water balance model water balances for the unsaturated soil layer including the transition zone groundwater layer and their total in both irrigated and non irrigated lands during non freezing and freezing periods are analyzed based on the principle of mass balance in non freezing period total water balance in the unsaturated soil layer and shallow groundwater layer is analyzed using the following equations for irrigated and non irrigated lands respectively 7 p a j k i jk lcs a j k gi a j k 1000 s y a j k gh a j k gh a j k 1 et a j k go a j k 1000 d s j k d ga j k gt jk a sa j 8 p na j k lcs na j k gi a j k 1000 gt jk a sna 1000 s y na j k gh na j k gh na j k 1 et na j k go na j k gwe jk 1000 d gna j k a sna j where a sa j and a sna j are areas of irrigated lands non irrigated lands hm2 in the jth cca respectively pjk ijk lcs jk et jk gi jk go jk and gwe jk are precipitation irrigation canal seepage evapotranspiration groundwater inflow groundwater outflow and groundwater extraction for urban use in the irrigated a and non irrigated na lands of the jth cca in the kth month mm respectively syjk is the apparent specific yield in kth month calculated using eq 2 by replacing k 1 with k and k 2 with k 1 detailed estimation methods of water balance components can refer to wen et al 2022 during the freezing and thawing period from december to next march there is no irrigation and almost no drainage in hid and total precipitation and et are both very small of about 20 mm therefore the water balance from december to march is analyzed together with that of april consequently the total water balance from december to next april can be described using the following equations for irrigated and non irrigated lands respectively wen et al 2022 9 k m 4 m 1 p a j k et a j k p a j m i jm lcs a j m gi a j m s y a j m gh a j m 4 gh a j m 1 et a j m d s j m d ga j m go a j m gt a j m 10 k m 4 m 1 p na j k et na j k p na j m lcs na j m gi na j m gt na j m s y na j m gh na j m 4 gh na j m 1 et na j m d gna j m go na j m where m and m 4 refer to april and december of the previous year respectively and sym is the apparent specific yield that can be calculated using eq 2 by replacing k 1 with m 4 and k 2 with m 1 furthermore water balances in the unsaturated soil layer including the transition zone and groundwater layer are analyzed separately based on the simulated groundwater table depth gh in the total water balance available studies showed that irrigation recharge to groundwater generally forms a relatively fresh groundwater layer above the underlying groundwater layer asghar and prathapar 2002 and the relatively fresh groundwater layer is considered in the following analysis water storages in the groundwater layer soil layer and their total can be calculated from 11 wsg jk 1000 z a gh jk θ s 12 wss jk max tws jk wsg jk 1000 θ wp gh jk 0 1000 θ s gh jk 0 13 tws j k 1 tws jk s y jk gh jk gh j k 1 1000 where wsg jk wss jk and tws jk are water storages of shallow groundwater layer soil layer and their total mm in the jth cca at the beginning of the kth month za is the depth from ground surface to the bottom of the relatively fresh groundwater layer m that needs to be calibrated for different sub irrigated districts θs and θ wp are soil moisture corresponding to saturation and wilting point and was set as 0 40 and 0 04 cm3 cm3 respectively following ren et al 2016 and xue et al 2018 the initial water storages in soil and groundwater layer are calculated by the vg model with the parameters in eq 2 and the observed initial groundwater table depth which are summed up to obtain the initial tws then deep percolation and capillary rise in the irrigated a and non irrigated na lands are estimated from 14 ps a j k η p p jk η i i jk d s j k a sa j 10 3 η l lcs a j k 15 ps na j k η p p jk η l lcs na j k 16 ge a j k ps a j k gi a j k gt jk d ga j k a sa j 10 3 s y g gh a j k gh a j k 1 17 ge na j k ps na j k gi na j k gt jk d gna j k a sna j 10 3 s y g gh na j k gh na j k 1 where ps is the deep percolation from soil layer mm ηp ηi and ηl are infiltration recharge coefficients of precipitation irrigation and canal seepage and set as 0 10 0 30 and 0 15 according to available studies in the hid yu et al 2016 xue et al 2017 ge is the capillary rise and can be calculated from the water balance in the fluctuation region of groundwater level syg is the specific yield of groundwater layer and is set as 0 07 referring to xue et al 2017 2 4 4 salt balance model the salt balance is further analyzed based on the water balance analysis considering that the salt variation is complex in freezing and thawing periods only the salt balance from april to november is considered the average salinity of the tws is calculated as follows 18 s j k 1 tws jk s jk 10 3 δ s jk tws j k 1 10 3 19 δ s a j k p jk s p i jk d sa j k a sa j 10 3 lcs a j k s i gi jk s gi 10 3 d ga j k s gda j k gt jk s gt j k a sa j 20 δ s na j k p jk s p lcs na j k s i gi jk s gi 10 3 d gna j k s gdna j k gt jk s gt j k a sna j where s is the average salinity of the total water storage in groundwater and soil layers kg m3 s is the net salt introduced with the hydrological processes kg m2 s p s i s gi and s gd are salinities of precipitation irrigation groundwater inflow and groundwater drainage respectively kg m3 the sp is set as 0 referring to xue et al 2018 and the s i takes the average value of 0 6 kg m3 due to low variance of the irrigation water salinity in the hid wen et al 2020 the s gd is determined by the flow direction and amount of groundwater drainage from irrigated and non irrigated lands if groundwater drainage from the irrigated or non irrigated lands is over 0 the s gd is equal to the corresponding groundwater salinity in the irrigated s ga or non irrigated s gna land if one of them is positive groundwater drained into the ditch and the other is negative ditch recharging to groundwater the s gd is equal to the mixed drainage water salinity in ditches if they are both less than 0 when ditch water recharges to groundwater then surface return flow is the only source of water to the ditches and then recharge to groundwater the s gd is set to the s i consequently the s gd of the irrigated s gda and non irrigated s gdna lands can be calculated from 21 s gda j k s ga j k d ga j k 0 s gna j k d gna j k s i d s j k d gna j k d s j k d ga j k 0 d gna j k 0 s i d ga j k 0 d gna j k 0 22 s gdna j k s gna j k d gna j k 0 s ga j k d ga j k s i d s j k d ga j k d s j k d gna j k 0 d ga j k 0 s i d gna j k 0 d ga j k 0 meanwhile the drainage water salinity can be estimated from 23 s ditch j k s ga j k d ga j k s gna j k d gna j k s i d s j k d ga j k d gna j k d s j k d ga j k 0 d gna j k 0 s ga j k d ga j k s i d s j k d ga j k d s j k d ga j k 0 d gna j k 0 s gna j k d gna j k s i d s j k d gna j k d s j k d ga j k 0 d gna j k 0 s i d ga j k 0 d gna j k 0 the change of groundwater salinity is determined by salt transport fluxes with hydrological processes and groundwater table fluctuations considering the continuity of groundwater layer and water table fluctuation zone transition zone and the alternative processes of deep percolation and capillary rise salinities in the groundwater layer and transition zone are assumed to be equal and can be estimated from 24 s g j k 1 wsg jk θ s s y g gh jk gh j k 1 sg jk δ sg jk wsg j k 1 25 δ sg a j k ps a j k ss a j k gi jk s gi ge a j k sg a j k 10 3 d ga j k s gda j k gt jk s gt j k a a 26 δ sg na j k ps na j k ss na j k gi jk s gi ge na j k sg na j k 10 3 d gna j k s gdna j k gt jk s gt j k a na where δsg is the salt introduced into the groundwater kg m2 then soil salinity in the unsaturated soil layer can be estimated from 27 ss j k 1 s j k 1 tws j k 1 s g j k 1 wsg j k 1 wss j k 1 where ss is the salinity in soil layer kg m3 2 5 model evaluation parameters for the dahmid were calibrated with groundwater table depth and drainage measurements and given in wen et al 2022 besides these parameters a new parameter za is further introduced in the present dahmid s this parameter is related to geographic location groundwater table depth groundwater salinity and irrigation water salinity and is calibrated and validated with observed groundwater salinity and drainage salinity data in the irrigated and non irrigated lands for each cca for the simulation of groundwater salinity the calibration and validation periods are from 2008 to 2010 and from 2011 to 2013 respectively meanwhile the drainage salinity is simulated directly based on the drainage model without new parameters and therefore all drainage salinity data are used for model validation to evaluate the model performance five commonly used indicators are calculated for both the calibration and validation periods including the percent bias pbias yapo et al 1996 normalized rmse nrmse jamieson et al 1991 nash sutcliffe efficiency coefficient nse nash and sutcliffe 1970 kling gupta efficiency kge gupta et al 2009 and coefficient of determination r 2 nagelkerke 1991 generally the model performs better when pbias and nrmse are close to 0 and nse kge and r 2 are close to 1 additionally positive values of pbias represent overestimation and negative values represent underestimation 3 results 3 1 model calibration and validation in addition to parameters of the dahmid given in wen et al 2022 the new parameter i e za of the dahmid s model was further calibrated for each sub irrigation district table 1 results show that za varies with sub irrigation districts and ranges from 3 5 to 6 0 m the za values of jfz and yc sub irrigation districts are smaller 3 5 4 0 m while those of wlbh yj and wlt are larger due to different reasons the groundwater salinity of wlbh is close to that of irrigation water and changes little with time which leads to difficulty in the precise simulation of groundwater salinity therefore a larger water storage depth za can effectively reduce the variation range of simulated salinity and result in acceptable simulation accuracy for yj there exists a 4 m groundwater depression cone in the south which leads to a larger za wlt has the highest groundwater salinity and therefore irrigation percolation has a greater impact on groundwater salinity which results in a larger za in groundwater salt balance simulation of xue et al 2018 the thickness of the groundwater layer was set as a fixed value of 2 m for an experiment site in the yongji sub irrigation district of the hid considering the maximum groundwater table depth of 2 7 m during the experiment period of xue et al 2018 a maximum za 4 7 m gave satisfactory simulation results of groundwater salt balance the difference between the za values used in groundwater salt balance by xue et al 2018 and the present study is mainly caused by the different spatial scales considered i e field scale for the former and sub irrigation district scale for the latter fig 3 shows the comparison of simulated and observed values of groundwater salinity in irrigated and non irrigated lands the pbiass in both irrigated and non irrigated lands are between 10 and 10 during the calibration and validation periods nrmses lower than 13 52 nses between 0 60 and 0 90 kge between 0 80 and 0 94 and r 2 between 0 83 and 0 95 compared with other studies on the groundwater table and groundwater salinity simulations in the hid huang et al 2010 xu et al 2010 xue and ren 2017a b xue 2018 the present model shows similar or better performance the simulation results of drainage water salinity are compared with the observed data for 12 main ditches the root mean squared error rmse nrmse nse and r 2 are 1 37 kg m3 7 0 0 74 and 0 87 wen et al 2020 respectively indicating that the accuracy of present model is higher than or close to the other similar models cavero et al 2012 wu et al 2017 xue 2018 the largest simulation error occurs in wlt sub irrigation district with nrmse of 21 1 due to the greater spatial variability of groundwater salinity and the greater uncertainty of the observed data overall the present model is effective in the simulation of drainage water salinity in summary the present model can describe water and salt balances in the hid satisfactorily 3 2 water balance in the hid main hydrological processes in the hid have been analyzed in wen et al 2022 fig 4 summarizes the changes of major annual water balance components in the whole hid including major water recharge components irrigation water diverted from the yellow river to the hid i and precipitation p major discharge components et and drainage through ditches d and the residuals representing changes in annual water storage by neglecting other minor water balance components during 2008 2014 the total water recharge from irrigation and precipitation ranges from 5 53 to 7 11 billion m3 with an average of 6 43 billion m3 among which irrigation water diversion ranges from 3 84 to 5 10 billion m3 with an average of 4 53 billion m3 and accounts for 54 to 86 71 in average of the total meanwhile et is the dominant water consumption component which ranges from 5 43 to 6 77 billion m3 with an average of 6 09 billion m3 and accounts for 91 to 99 95 on average of i p and 90 to 94 93 in average of et d the ratio of et to i p tends to increase with i p in contrast annual drainage ranges from 0 36 to 0 62 billion m3 with an average of 0 49 billion m3 accounting for 5 6 to 9 7 7 5 in average of i p and 5 7 to 9 6 7 4 in average of et d average annual drainage is about 10 5 of the total irrigation water diversion besides et d is generally slightly greater than i p which results in the decrease of water storage in most years more details about hydrological processes in the hid can be found in wen et al 2022 fig 5 shows the variations of monthly water storages in the unsaturated soil layer groundwater layer up to za and their sums in the irrigated and non irrigated lands in the whole hid in terms of inter annual variations the total and groundwater storages of irrigated lands change from 12 79 and 10 39 billion m3 in 2008 to 12 51 and 9 71 billion m3 in 2014 respectively both showing a slightly decreasing trend in contrast the soil water storage of irrigated lands is relatively small and fluctuates between 1 0 and 6 0 billion m3 while for the non irrigated lands the total groundwater and soil water storages are all basically stable which are 6 87 5 60 and 1 12 billion m3 at the start of the study period and 6 93 5 74 and 1 33 billion m3 at the end of the study period respectively the total water storage remains stable within a year while the soil water and groundwater storages fluctuate significantly due to significant fluctuation in groundwater table caused by irrigation applications and evapotranspiration the soil water storage reaches its annual peaks in march and september and valleys in june and november which generally correspond to the lowest and highest groundwater level respectively during the soil freezing period from late november to early march soil freezing induces capillary rise and consequently results in increased soil water content and dropped groundwater table shang et al 1999 which results in the peak of soil water storage in march meanwhile the peak of soil water storage in september is caused by a significant increase in the depth of unsaturated soil layer or a decline in groundwater level due to less irrigation and increased capillary rise in the late crop growth stage of august and september on the contrary the valleys of soil water storage are mainly caused by groundwater table rise after spring irrigation from late march to early june and autumn irrigation from late september to early november contrary to the soil water storage the monthly groundwater storage reaches the peaks in june and november and valleys in march and september meanwhile the variation trends of the water storages in irrigated and non irrigated lands are similar on both monthly and annual scales 3 3 variations of major salt balance components in the hid major salt balance components in the whole hid and irrigated and non irrigated lands are shown in fig 6 for clarity minor salt balance components are not shown in the figure including salt exchange associated with lateral groundwater inflow to and outflow from hid salt introduction to the non irrigated lands due to canal seepage and salt discharge with groundwater abstraction which are less than 7 of the total salt introduction from the simulated salt balance fig 6 the whole hid and non irrigated lands both show general states of salt accumulation from 2008 to 2014 while irrigated lands show an overall desalination state for the whole hid the monthly salt introduction discharge and accumulation amounts from april to november range from 0 10 to 0 78 million t month from 0 01 to 0 52 million t month and from 0 37 to 0 77 million t month in the study period fig 6a respectively the peaks of salt introduction and accumulation occur in may july and october associated with large amount of spring summer and autumn irrigation applications meanwhile the peaks of salt discharge generally occur in june and november which is about one month lagging the spring and autumn irrigation applications as a result the whole hid may be in desalinization state in these two months of some years the annual average amounts of introduced salt discharged salt and accumulated salt are 2 91 1 44 and 1 47 million t respectively only 49 4 of the salt introduced to the hid is drained out of the hid through drainage ditches and the rest 50 6 is accumulated in the soil and groundwater of the irrigation district for irrigated lands in the hid monthly changes in soil salt storage range from 0 53 desalination to 0 13 salt accumulation million t and annual desalination amount ranges from 0 45 to 1 27 million t with a mean annual desalination amount of 0 96 million t fig 6b the peaks of soil salt change generally occur in may and october after spring and autumn irrigations the desalination process of irrigated lands is closely related to the process of salt introduction with irrigation and dry drainage the monthly dry drainage process fig 6 is basically consistent with the interior drainage wen et al 2022 which reaches the peaks in may and october due to spring and autumn irrigations and valleys in april and september with less irrigation the monthly dry drainage amounts generally account for 48 99 of the total salt discharge from the irrigated lands and annual ones 2 58 3 39 million t from 2008 to 2014 generally account for 69 82 of the total with the average ratio of 77 therefore dry drainage plays a key role in the desalination of irrigated lands for non irrigated lands in hid the monthly salt accumulation amounts from april to november fig 6c range from 0 04 to 0 74 million t the maximum salt accumulation generally occurs in may and october and the minimum salt accumulation in april and september which is directly related to the interior and dry drainage processes the annual salt accumulation amounts range from 1 90 to 2 87 million t presenting a significant salt accumulation state dry drainage is the main source of salt to the non irrigated lands which accounts for 83 87 85 on average of the total among total salt introduced to the non irrigated lands only 12 to 24 16 on average is drained out through ditches 11 to 13 12 on average is discharged with groundwater abstraction while the rest 63 to 77 72 on average is accumulated in the non irrigated lands fig 7 shows the monthly salt storage processes from april to november in the unsaturated soil layer groundwater layer and their total in irrigated and non irrigated lands of the hid in terms of inter annual variation both the total and groundwater salt storages of irrigated lands show slight decreasing trends while soil salt storage in the irrigated lands is relatively stable in the study period therefore the decrease in groundwater salt storage is the main source of desalination in irrigated lands in contrast to the irrigated lands the total and soil salt storages in non irrigated lands increases in the study period while the groundwater salt storage remains stable consequently the soil layer in the non irrigated lands is the main region of salt accumulation 3 4 spatial pattern of dry drainage in the hid for irrigated lands of different ccas the average annual dry drainage per unit irrigated lands is 262 3 616 1 t km2 fig 8 a the dry drainage is more effective in the middle and southern yc and northern wlt which is related to higher soil and groundwater salinity although the interior drainage amount in wlbh is large dry drainage per unit irrigated lands is slightly lower than that of the middle and southern yc and northern wlt due to the lower soil and groundwater salinity 0 5 1 5 kg m3 in wlbh in general the annual dry drainage amount fig 8 a is basically consistent with the interior drainage wen et al 2022 but it is also related to regional salinization degree the ratios of dry drainage to irrigation introduced salt in different ccas range from 0 62 to 3 84 fig 8 b the ratios in wlt 1 60 3 84 and middle and southern yc 1 60 are significantly greater than other regions due to higher groundwater salinity from 3 2 8 2 kg m3 and less salt introduction as a result of less irrigation in southern and eastern wlt meanwhile the ratio in most parts of wlbh is 1 17 and greater than 1 00 due to the large proportion of non irrigated lands in other parts of the hid the ratios are all less than 1 00 ranging from 0 62 to 0 90 in conclusion dry drainage plays an important role in controlling soil salinization in irrigated lands but can also result in salt accumulation in non irrigated lands that may have negative impacts on the soil environment and natural ecosystems in non irrigated lands fig 8 c shows the spatial distribution of dry drainage efficiency in different ccas which is defined as dry drainage amount per unit irrigation water the efficiency ranges from 0 37 kg m3 in a small part of wlbh to 2 30 kg m3 in southern and eastern wlt and its spatial variation is mainly influenced by irrigation amount per unit irrigated lands soil salinization degree and the proportion of irrigated land area the dry drainage efficiency is the highest in southern and eastern wlt 2 30 followed by northern wlt 0 96 middle and southern yc 0 96 and most parts of wlbh 0 70 higher dry drainage efficiency in wlt and part of yc is mainly caused by smaller irrigation amount per unit area and higher soil and groundwater salinity while higher efficiency in wlbh is mainly caused by smaller percentage of irrigated area however the efficiency is relatively smaller in jfz and yj of the hid which is mainly caused by higher irrigation amount per unit irrigated lands fig 9 shows the spatial distribution of average dry drainage per unit irrigated lands from april to november which indicates the monthly dry drainage changes between 40 and 150 t km2 and has a similar monthly change trend with interior drainage wen et al 2022 negative value of dry drainage indicating dry drainage from non irrigated lands to irrigated lands mainly occurs in months or regions with little or no irrigation and stronger et in irrigated lands and vice versa for example less irrigation in april august and september results in smaller or even negative dry drainage in most parts of the hid while more autumn irrigation in october leads to greater dry drainage meanwhile crop planting pattern determines the irrigation scheduling which in turn influences the spatial distribution of dry drainage for example jfz and yj plant more corn and less sunflower than yc and wlt wen et al 2019 which leads to less irrigation in the spring irrigation period and less dry drainage in may 3 5 spatial pattern of salt accumulation desalinization in the hid different ccas irrigated lands and non irrigated lands show different states of salt balance i e desalinization in most irrigated lands while salt accumulation in non irrigated lands and most ccas fig 10 most ccas show salt accumulation state except for the northwestern wlt sub irrigation district the small cca in the eastern wlbh shows the most severe salt accumulation with the annual salt accumulation amount of 326 3 t km2 which is the outcome of several factors including sufficient water supply of the cca near the sanshenggong canal head shallower groundwater table depth and poorer dry drainage capacity fig 8 the yj middle and southern yc and southern and eastern wlt sub irrigation districts show relatively severer salt accumulation of 200 300 t km2 per year besides other ccas except for the northwestern wlt show moderate to slight salt accumulation the northern wlt shows a desalinization state due to stronger groundwater drainage capacity and higher groundwater salinity wen et al 2020 for irrigated lands the average annual salt storage changes range from 382 6 t km2 to 120 8 t km2 irrigated lands in yj and a small part of the eastern wlbh show slight salt accumulation while irrigated lands in other parts of the hid are all in desalination state the eastern wlbh is close to the sanshenggong canal head of the yellow river which results in sufficient supply of irrigation water and poor dry drainage capacity fig 8 and consequently slight salt accumulation in the irrigated lands poorer dry drainage capacity in the yj sub irrigation district also leads to slight salt accumulation in the irrigated lands fig 8 the desalination effect in the eastern jfz yc and the northern wlt is significant which is related to the higher dry drainage capacity in these regions fig 8 on the other hand the average annual salt accumulation of non irrigated lands varies from 263 1 t km2 to 1613 9 t km2 and the whole non irrigated lands is in the state of salt accumulation in jfz and middle and southern yc with the most severe dry drainage higher soil salinization degree and more effective salt leaching by spring irrigation lead to the most serious salt accumulation in non irrigated soil although the total amount of dry drainage in wlbh is relatively large fig 10 the average salt accumulation per unit area is the smallest 263 1 t km2 because of the highest ratio of non irrigated lands 67 1 in wlbh as soil salt content in the crop root zone is more closely related to crop growth soil salt storage in the unsaturated soil layer is further analyzed to account for significant change of unsaturated soil depth groundwater table depth due to irrigation and evapotranspiration in the hid changes in soil salt storage of the whole unsaturated layer are divided by the unsaturated soil depth to obtain the average soil salt content changes per unit soil layer for comparison purpose as shown in fig 11 a the annual variations of salt content per unit soil depth of irrigated lands range from 474 7 desalinization to 600 0 salt accumulation t km2 regions with significant soil desalination are jfz and the middle and southern yc which is mainly related to irrigation amount soil salinity level and dry drainage capacity on the contrary the soil layer of the irrigated lands in wlbh and the southern and eastern wlt presents a state of salt accumulation especially the latter the salt accumulation in the southern and eastern wlt is the most serious because of less irrigation 2 2 of the total irrigation water diversion and higher groundwater salinity 3 2 8 2 kg m3 as a result soil salt leaching to the groundwater is difficult while groundwater salt can recharge the soil layer with capillary rise although irrigated lands in the southern and eastern wlt is in the state of slight desalinization fig 10 the redistribution of salt between soil layer and groundwater layer results in salt accumulation in the soil layer for the non irrigated lands the average annual variations of soil salt content per unit soil depth range from 192 3 to 1755 5 t km2 which are all in the state of salt accumulation fig 11 b affected by dry drainage groundwater salinity and the percentage of non irrigated lands the soil salinity is the most serious in the southern and eastern wlt and the middle and southern yc due to higher dry drainage capacity fig 8 a dry drainage and the percentage of non irrigated land mainly determine the degree of salt accumulation in non irrigated lands while groundwater salinity mainly affects the distribution of salt in soil layer and groundwater layer in non irrigated lands in non irrigated lands of the hid there is no irrigation and scarce precipitation to provide enough water for evapotranspiration and leaching the soil salt and shallow groundwater is the main source of evapotranspiration in addition to precipitation and canal seepage when the groundwater salt content is higher a large amount of salt is transferred from groundwater to the soil surface through capillary rise leading to an increase of soil salt content therefore attention should be paid to the soil salinization in the non irrigated lands in the southern and eastern wlt and the middle and southern yc 4 discussion in the current study we developed a monthly distributed water and salt balance model for irrigation district dahmid s with shallow groundwater table based on the monthly distributed agro hydrological model for irrigation district dahmid wen et al 2022 major water and salt processes considered in the model include irrigation water diversion evapotranspiration soil water and groundwater balances drainage through ditches interior drainage from irrigated lands to non irrigated lands and salt transport processes associated with the above water processes one major characteristic of the model is that both ditch drainage and interior dry drainage are considered which enables us to simulate water and salt balances in both irrigated lands and non irrigated lands besides only one new parameter za is added in the salt balance model based on the dahmid model which makes the model more convenient to use the model has been successfully applied to the hid based on the simulation results water and salt balances in the hid were analyzed and reasonable water and salt regulation modes for different regions were proposed 4 1 characteristics of water and salt balances in the hid different from dominated hydrological processes of precipitation runoff and evapotranspiration in humid watersheds hydrological processes in arid irrigation districts such as the hid are dominated by irrigation water diversion and evapotranspiration meanwhile salt balance in arid irrigation districts with shallow groundwater table is mainly controlled by salt introduced by irrigation and salt drained through ditches due to the nature of arid climate precipitation in the hid is scarce and there is almost no local runoff moreover the limited precipitation is far less to support the agriculture production and well grown natural ecosystem and thus irrigation water diversion from the yellow river is the main water source for the crop and natural ecosystem in the hid in the study period irrigation water diversion is about 71 of the amount of irrigation and precipitation for the whole hid which provides the key source of water for agriculture directly and natural ecosystem indirectly meanwhile 95 of irrigation water and precipitation are consumed by evapotranspiration water balance in the hid is influenced by both natural factors such as precipitation and evapotranspiration potential in the hid and runoff from the upstream yellow river and human activities such as crop planting area and pattern and irrigation management practices in recent years sunflower and corn have become the dominant crops in the hid where the sunflower planting area tends to increase wen et al 2019 the sunflower is sowed in late may which is about one month later than other major crops and has a significant influence on irrigation during crop growing season and autumn spring irrigation during fallow period qian et al 2022 besides groundwater extraction for domestic industrial and agricultural uses is another human activity that influences water balance in the hid especially the groundwater balance however groundwater extraction has less influence on water balance as compared with other major components such as irrigation evapotranspiration and drainage although salinity of the irrigation water for the hid is lower around 0 6 kg m3 large amount of irrigation water diversion and minor groundwater inflow introduce considerable amount of salt 2 91 million t year on average into the hid however due to flat topography and very small hydraulic gradient of the groundwater level the drainage system in the hid is not effective enough to drain the introduced salt out of the irrigation district in the study period total drainage is about 10 9 of the irrigation water diversion while the amount of salt drained through ditches is only 49 4 of the introduced salt consequently about half of the introduced salt is left in the hid which is not sustainable for the irrigation district fortunately dry drainage of salt from irrigated lands to non irrigated lands provides a possibility for draining excess salt out of the irrigated cropland which results in desalinization for most of the irrigated lands however non irrigated lands are general in salt accumulation state which may intensify soil salinization in non irrigated lands and threaten local natural ecosystems wu et al 2009 studied the soil salinization process in the hid from 1973 to 2009 and found that nearly 70 of the introduced salt was accumulated in the whole hid which is higher than the salt accumulation proportion 50 6 during 2008 to 2014 in the present study the decrease of salt accumulation proportion in these two periods implies that the improvement of the drainage system has been effective in reducing soil salinization in recent years however the whole hid is still in the state of salt accumulation and the drainage system in the hid should be further improved to mitigate the soil salinization problems by improving the water drainage and salt discharge conditions the salt balances in different land use types and soil layers are closely related to water flow and salt transport processes in the hid salt transport in the irrigation district can be roughly divided into five stages the first stage is salt introduction to the irrigation district with irrigation water diversion from the yellow river through irrigation system most of the salt enters the irrigated lands with canal seepage and field application while the rest enters non irrigated lands through canal seepage in the second stage salt entering the irrigated lands is partly leached downward to the groundwater aquifer with irrigation application which leads to the change of groundwater salinity due to canal seepage and field irrigation in the third stage groundwater salt in the irrigated lands is transported to non irrigated lands through dry drainage which is the result of interior drainage due to the groundwater level gradient between irrigated and non irrigated lands after irrigation in the fourth stage the salt in the groundwater of the non irrigated lands enters the soil layer through capillary rise and accumulates on the soil surface in the fifth stage part of the groundwater salt in both the irrigated and non irrigated lands can be drained through the drainage system to the drainage receiver salt enters into the irrigation district in the first stage and flows out of the irrigation district in the last stage can be measured from irrigation and drainage water and salinity while salt transport processes in the other three stages are hard to be monitored in the irrigation district scale however we can simulate the salt transport processes in ungauged stages using the dahmid s model within a year the monthly total salt storage in both irrigated lands and non irrigated lands is relatively stable but the salt storage in the soil layer and groundwater layer has larger fluctuations due to greater fluctuation of groundwater table in a year for irrigated lands the salt storage of soil layer reaches the valley in june and november and the peak in march and september consistent with the changes in water storage the redistribution of salt between the soil layer and the groundwater layer leads to the opposite trend of salt storage in the two layers within a year fig 7 4 2 the role of interior drainage and dry drainage in water and salt balances interior drainage is the lateral groundwater flow from irrigated lands to non irrigated lands due to groundwater level gradient after irrigation it is a supplementary way to control the groundwater table in irrigated lands and the most important recharge component to groundwater in non irrigated lands that provides water for the growth of natural ecosystems in the non irrigated lands wen et al 2022 dry drainage of salt accompanied with interior drainage is a unique and key process of salt balance for both irrigated and non irrigated lands in arid irrigation districts with shallow groundwater for the whole hid dry drainage is about 99 of the total salt introduced to the hid averaged during 2008 2014 in an experiment area of 2900 ha in the middle of the hid wang et al 2019 found that the dry drainage accounts for 83 2 of the salt introduced by irrigation from 2007 to 2011 which is slightly lower than the present results for the whole hid in fact the ratio of dry drainage to total salt introduction is related to the land use pattern and may change with spatial scale wu et al 2009 a greater percentage of irrigated lands 71 4 in the experiment area of wang et al 2019 is likely the reason for lower dry drainage ratio in irrigated lands of the hid annual dry drainage amounts are 69 82 77 on average of the total salt discharge from fig 6 b which plays a key role in salt desalinization in most parts of the irrigated lands in the hid fig 10 a and 11 a consequently salt content in the irrigated cropland can be kept at an appropriate range for crop growth on the contrary annual dry drainage accounts for 83 87 85 on average of the total salt introduced to the non irrigated lands due to poorer drainage conditions in non irrigated lands 63 to 77 72 on average of the introduced salt is accumulated in the non irrigated lands which leads to salt accumulation in non irrigated lands in different ccas fig 10 b and 11 b the sustained salt accumulation in non irrigated lands is mainly caused by several reasons firstly decreased water diversion from the yellow river in recent years and insufficient drainage capacity result in less drainage water and salt out of the hid and salt accumulation in the whole hid secondly interior drainage of groundwater and dry drainage of groundwater salt lead to salt accumulation in non irrigated lands thirdly increased cultivated land area and decreased non irrigated area in recent decades lead to higher salt accumulation amount per unit non irrigated land as a result soil salinization degree tends to exacerbate in some parts of the hid which further threatens the natural ecosystems in non irrigated lands and even the sustainability of the whole hid appropriate measures should be taken to mitigate the harm of exacerbated soil salinization in some parts of the hid such as allocating irrigation water more rationally both in space and time improving the drainage system to increase the amount of water and salt drained out of the hid and controlling the area of cultivated land to reserve enough area of non irrigated lands to alleviate salt accumulation per unit non irrigated land consequently interior drainage and dry drainage play important roles in water and salt balances of irrigated and non irrigated lands in the hid and similar irrigation districts compared with other distributed hydrological models for arid irrigation districts that do not consider lateral groundwater flow and salt transport between adjacent simulation units incorporating the sub models for interior drainage and dry drainage in the dahmid s model makes it more applicable to arid irrigation districts with shallow groundwater table 4 3 feasible regulation mode of water and salt regime in the hid most parts of the hid especially the non irrigated lands and a small part of the irrigated lands are in the state of salt accumulation which is harmful to agricultural production and natural ecosystem protection to improve the sustainability of the hid it is necessary to study the feasible regulation mode of water and salt regime in the hid groundwater table control is the core for water and salt regulation in the hid in the current irrigation and drainage conditions the groundwater level remains relatively stable with a slight decreasing trend in the study period i e 12 9 mm year in irrigated lands and 5 5 mm year in non irrigated lands this implies that the reduced irrigation water diversion with the implementation of water saving projects in the hid since 1999 has a certain positive effect on the regulation of groundwater level in the irrigated areas regional salt change in a year is influenced by many factors including irrigation amount drainage system regional salinization degree and land use and planting patterns due to differences of the above factors in different ccas the annual salt change in ccas shows irregular spatial distribution pattern fig 10 specifically the northern wlt had the best salinity control effect showing an overall desalination trend fig 10 for northern wlt the overall desalinization is mainly a result of the following reasons first irrigation water amount per unit area from the general main canal in this cca is smaller compared with the whole hid because of unfavorable irrigation conditions in the downstream of the hid second more groundwater is abstracted for irrigation to compensate for insufficient water supply from the surface water which reduces the dependence on canal irrigation and lowers the groundwater level third the ditch drainage system in wlt is relatively well developed and the drainage amount per unit area is higher than the average level of the whole hid wen et al 2020 fourth higher groundwater salinization degree in the northern wlt results in higher salt drainage capacity for the same amount of drainage water fifth sunflower has become the dominant crop in the northern wlt wen et al 2019 which has a lower irrigation water requirement of only 240 mm during the growth period compared with corn and wheat wang 2012 with the integrated effect of the above factors the groundwater salinity in wlt decreased from 6 34 kg m3 in early 2008 to 4 04 kg m3 at the end of 2014 showing a good level of salt control however there is still room for further improvement in the irrigation and drainage management in wlt compared with the northern wlt other sub irrigation districts all show some problems in water and salt balance the wlbh located in the upstream has more water supply for irrigation and sparse ditch system which results in smaller drainage capacity of only 44 of the average level in the whole hid in jfz main crops are corn and wheat that consume more water than sunflower and the amount of irrigation water diversion accounts for 26 4 of the total hid in the study period as a result the surface water return flow to the ditches in some areas is as high as 7 3 22 8 of the irrigation water diversion and the groundwater drainage capacity is lower than the average level of the whole hid wen et al 2020 in yj the irrigation amount only accounts for 18 7 of the total hid and the surface water return flow rate is only 0 6 3 9 wen et al 2020 however there is a groundwater depression cone in the southern yj wen et al 2020 which leads to smaller groundwater drainage and salt discharge and severer salt accumulation in this region in northern yc close to the general main drainage ditch annual salt accumulation is relatively slight due to the well developed drainage system and more sunflower planting area while other parts of yc show moderate salt accumulation due to unmatched irrigation and drainage systems the southern and eastern wlt also shows moderate salt accumulation therefore appropriate measures should be taken to solve these problems to improve the water and salt conditions for the sustainability of the hid such as improving the irrigation management controlling the irrigation water supply improving the drainage system and regulating the crop planting pattern to reduce the overall salinization degree of the study region in controlling the irrigation water supply its influences on salt introduction groundwater and salt drainage through ditches and interior drainage of groundwater and dry drainage of salt from irrigated lands to non irrigated lands should be considered comprehensively in eastern wlbh jfz and yj with more irrigation application per unit irrigated area irrigation water supply should be decreased by planting more sunflower to provide more water for the downstream regions of the hid and the drainage system should be further improved to decrease the salt accumulation to a lower level however in southern and eastern yc and wlt with less irrigation application per unit area and higher efficiency of dry drainage fig 8 the irrigation water diversion can be increased by planting more corn and wheat besides irrigation management should be improved to reduce the surface water return flow to increase the groundwater drainage capacity especially in the eastern wlbh and southern jfz sub irrigation districts with higher surface return ratio wen et al 2020 5 conclusions in this study we developed a monthly distributed water and salt balance model for irrigation district dahmid s in arid regions with shallow groundwater table based on a monthly distributed agro hydrological model for irrigation district dahmid the model considers major water and salt processes in arid irrigation districts including irrigation water evapotranspiration soil water and groundwater balances drainage through ditches interior drainage from irrigated lands to non irrigated lands and salt transport processes associated with the above water processes by considering both ditch drainage and interior dry drainage the model is capable of simulating water and salt balances in canal command areas ccas and irrigated and non irrigated lands in a cca the model was successfully applied to the hid the largest irrigation district in arid region of china based on the simulation results from 2008 to 2014 the following conclusions can be drawn 1 in the irrigated land of the hid groundwater storage shows a decreasing trend from 10 39 to 9 71 billion m3 during 2008 2014 while soil water storage fluctuates between 1 0 and 6 0 billion m3 in the non irrigated land groundwater and soil water storages are both steady and in the ranges of 5 6 5 74 and 1 12 1 33 billion m3 respectively 2 for the salt balance in the whole hid only 49 4 of the salt introduced to the hid is finally drained out of hid through drainage ditches and the remaining salt is accumulated in the soil and groundwater due to large amount of autumn irrigation from late september to early november the best time for salt leaching occurs in november except for the northern wlt showing a desalinization trend other parts of the hid are all in the state of salt accumulation the problem of salt accumulation in the western and southern hid is more severe due to adequate water supply 3 dry drainage of salt i e salt transport with interior drainage of groundwater from irrigated lands to non irrigated lands plays a crucial role in salt balance of both irrigated lands and non irrigated lands the monthly dry drainage process is closely related to the irrigation process and basically consistent with the interior drainage process the ratio of dry drainage to irrigation introduced salt is generally higher in the downstream region the amount of annual salt transport through dry drainage in the whole hid accounts for 77 of the total salt discharge from the irrigated lands and 85 of the total salt introduced to the non irrigated lands as a result most irrigated lands in the hid are in a desalinization state except for yj and a small part of the eastern wlbh while non irrigated lands are generally in salt accumulation state 4 appropriate measures should be taken to solve water and salt related problems to improve the water and salt conditions for the sustainability of the hid in eastern wlbh jfz and yj irrigation water supply should be decreased by planting more sunflower with less water requirement and the drainage system should be further improved to decrease the salt accumulation to a lower level meanwhile in southern and eastern yc and wlt the irrigation water diversion can be increased by planting more corn and wheat furthermore irrigation management should be improved to reduce the surface water return flow to increase the groundwater drainage capacity especially in the eastern wlbh and southern jfz sub irrigation districts credit authorship contribution statement yeqiang wen methodology software data curation formal analysis writing original draft heyang wan software data curation formal analysis visualization investigation writing original draft songhao shang conceptualization supervision writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was partially supported by the national natural science foundation of china grant numbers 51839006 and 51779119 and the state key laboratory of hydroscience and engineering grant number 2020 ky 01 
2620,water scarcity and soil salinization are two major problems threatening the sustainability of irrigation districts in arid regions with shallow groundwater table to study water and salt balances in arid irrigation districts we developed a monthly distributed water and salt balance model for arid irrigation district dahmid s with shallow groundwater table by integrating models of major hydrological processes and the associated salt transport processes including irrigation evapotranspiration soil water and groundwater and salt balances drainage of water and salt through ditches and interior drainage of water and associated dry drainage of salt between irrigated and non irrigated lands the model was successfully applied to the hetao irrigation district hid the largest irrigation district in the arid region of china results indicate that evapotranspiration is the dominant water consumption component in the hid and accounts for about 95 of the total irrigation and precipitation while drainage through ditches accounts for 10 5 of the total irrigation only 49 4 of the introduced salt is discharged from the hid through drainage ditches consequently most parts of the hid are in the state of salt accumulation except the northern wulate sub irrigation district and the problem of salt accumulation is more serious in the western and southern hid under more favorable conditions of water use dry drainage plays a crucial role in salt balance of both irrigated and non irrigated lands which results in desalinization in most irrigated lands while salt accumulation in non irrigated lands appropriate measures should be taken to solve water and salt related problems to improve the sustainability of the hid in the western hid irrigation water diversion should be decreased and the drainage system should be further improved to decrease the salt accumulation to a lower level meanwhile the irrigation water diversion can be increased in the southeastern hid by planting more corn and wheat besides irrigation management should be improved to reduce the surface water return flow to increase the groundwater drainage capacity especially in the southwestern hid keywords irrigation district water balance salt balance drainage dry drainage distributed model data availability the authors do not have permission to share data 1 introduction arid regions including hyper arid arid and semi arid regions cover about 39 4 of the earth s terrestrial surface and the percentage is expected to increase in the future due to climate change koutroulis 2019 land resource in the arid region is abundant which provides the possibility for regional or even global food security however the arid region is characterized by scarcity of precipitation and water resources therefore the agricultural production in arid region is mainly concentrated in irrigation districts and relies heavily on the availability of irrigation water meanwhile the unmatched irrigation and drainage systems and improper irrigation water management practices may lead to soil salinization in many arid irrigation districts which in turn threatens the agricultural production and sustainability of the irrigation districts wichelns and qadir 2015 devkota et al 2022 therefore it is crucial to study water and salt balances in arid irrigation districts to support irrigation water management and soil salinization control different from the dominated hydrological processes of precipitation runoff and evapotranspiration in humid watersheds hydrological processes in arid irrigation districts are dominated by irrigation water diversion drainage and evapotranspiration moreover interior drainage lateral groundwater flow between irrigated and non irrigated lands and associated dry drainage of salt are important for water and salt balances of different land use types in arid irrigation districts with shallow groundwater table yu et al 2016 ren et al 2018 wen et al 2022 consequently commonly used hydrological models such as the topmodel beven and kirkby 1979 she abbott et al 1986 xinanjiang zhao 1992 vic liang et al 1994 and swat arnold et al 1998 models are not applicable directly to arid irrigation districts to account for the impact of anthropogenic activities on hydrological processes in arid irrigation districts modules describing irrigation drainage and or crop growth have also been added to traditional hydrological models to study hydrological processes in irrigation districts e g christiansen et al 2004 ahmadzadeh et al 2016 malek et al 2017 xiong et al 2019 moreover some agro hydrological models for the cropland have also been extended to the irrigation district or catchment scale for distributed simulation of water flow and or salt transport processes such as hydrus van gaelen et al 2017 swap xue and ren 2016 xu et al 2019 rzwqm2 xi et al 2017 saltmod singh 2012 and sahysmod singh and panda 2012 the above distributed agro hydrological models have been widely used but they may have some problems when applied to arid irrigation districts with shallow groundwater table for example some models mainly consider the hydrological processes in the vertical direction in simulation units while ignoring groundwater interior drainage and associated dry drainage that are important for water and salt balances in different land use types yu et al 2016 ren et al 2018 wen et al 2022 besides a large amount of distributed model parameters and inputs required by the model also limit their wide use singh and panda 2012 wen et al 2022 developed a monthly distributed agro hydrological model for irrigation district dahmid with shallow groundwater table to study the total groundwater and soil water balances of irrigated and non irrigated lands in each sub canal command area within an irrigation district the dahmid integrated models for major hydrological processes in arid irrigation districts including a remote sensing based evapotranspiration et model yang and shang 2013 a semi distributed drainage model wen et al 2020 a variable specific yield model for long term groundwater table fluctuation prediction crosbie et al 2005 and an interior drainage model for lateral groundwater flow between irrigated and non irrigated lands the model has been successfully applied in the hetao irrigation district hid of china however salt transport processes are not considered in the model in arid irrigation district with shallow groundwater table such as the hid soil salinization due to improper irrigation and drainage practices is another key factor influencing agricultural production therefore it is crucial to study salt balance and transport processes associated with water flow processes in these irrigation districts such as salt transports with irrigation drainage and interior drainage main objective of this study is to develop a novel monthly distributed water and salt balance model dahmid s for irrigation district with shallow groundwater table by incorporating the dahmid model and sub models for the salt transport processes the dahmid s considers salt transport with drainage through ditch system as well as interior drainage from irrigated cropland to non irrigated land and therefore allows us to study water and salt balances in both irrigated cropland and non irrigated land that are important for soil salinization control in cropland 2 materials and methods 2 1 description of study irrigation district the hid lies in 40 1 41 4 n and 106 1 109 4 e in the west of inner mongolia autonomous region of china and is the largest irrigation district in arid region of northwest china fig 1 the hid covers a total land area of 1 2 million ha with an irrigated cropland area of 0 58 million ha the hid is located in a typical arid continental climate zone characterized by scarce precipitation of around 160 mm per year and strong potential evaporation of about 2240 mm per year measured with 20 cm evaporation pan ren et al 2016 wen et al 2022 therefore irrigation is essential for agricultural production in the hid irrigation water is mainly diverted from the sanshenggong canal head at the yellow river fig 1 and has a relatively small salinity of approximately 0 6 kg m3 the hid has a complex seven level irrigation canal and drainage ditch system with the total canal and ditch lengths of about 50400 km and 14000 km respectively wen et al 2020 the drainage salinity in different ditches ranges from 0 53 to 19 66 kg m3 which is generally much higher than the irrigation salinity meanwhile drainage salinity in the lower reach of the hid is generally higher than the upper reach due to runoff decrease and integrated water resources management of the yellow river basin available irrigation water from the yellow river to the hid tends to decrease in recent years which has a significant influence on water balance in the hid wen et al 2022 meanwhile drainage in most parts of the hid is not enough due to flat terrain with a gentle slope of about 0 2 from the southwest to the northeast which has resulted in shallower groundwater table and severer soil salinization in some parts of the hid li et al 2012 ren et al 2018 in the hid groundwater table depth generally fluctuates between 0 5 and 3 0 m while groundwater salinity from 1 3 to 12 2 kg m3 that is generally higher in the lower reaches severe soil salinization areas cover about 25 of the whole hid li et al 2012 ren et al 2018 available studies showed that interior drainage of groundwater and dry drainage of salt from irrigated lands to non irrigated lands are important pathways of water and salt drainage through lateral groundwater flow in the hid yu et al 2016 ren et al 2018 and other similar irrigation districts in arid region han 2009 therefore drainage through ditches and interior drainage should be considered simultaneously in water and salt balance analysis for irrigation districts like the hid 2 2 data collection data required for the monthly distributed water and salt balance model in arid irrigation district dahmid s mainly include 1 meteorological data from 2008 to 2014 collected from china meteorological data service center http data cma cn and water resources development center of hetao irrigation district http www zghtgq com 2 digital elevation model dem downloaded from geospatial data cloud http www gscloud cn 3 soil texture downloaded from national tibetan plateau data center http data tpdc ac cn 4 land use map in 2010 downloaded from the department of earth system science tsinghua university http data ess tsinghua edu cn 5 surface reflectance and land surface temperature products from 2008 to 2014 downloaded from the moderate resolution imaging spectroradiometer modis aboard the terra and aqua satellites https ladsweb modaps eosdis nasa gov 6 irrigation canal and drainage ditch systems monthly amount and salinity of irrigation water and drainage water and groundwater table depth and salinity data from 2008 to 2014 collected from bayannur water conservancy research institute and water resources development center of hetao irrigation district http www zghtgq com among the above datasets the datasets related with salinities of irrigation water drainage water and groundwater are newly added in the dahmid s model while the rest datasets are used both in the previous dahmid model wen et al 2022 and the present dahmid s model groundwater table depth from 2008 to 2014 except 2011 was measured every 5 days in 224 wells while groundwater salinity was measured in the middle of january march may july september october and november in 115 wells from 2008 to 2014 the groundwater table depth and salinity data were interpolated to a spatial resolution of 250 m by the widely used ordinary kriging method and used mainly for model evaluation 2 3 delineation of simulation units different from watershed delineation that depends mainly on dem the simulation units for the irrigation districts with flat terrain are delineated on the bases of irrigation system drainage system land use map sub irrigation district map and soil texture map following wen et al 2022 the hid was divided into 13 canal command areas ccas based on 21 main and secondary canals 19 sub drainage command areas sdcas based on 17 main and secondary ditches two land use types irrigated lands and non irrigated lands reclassified from land use map fig 1 five sub irrigation districts fig 1 and three dominant soil textures sandy loam silty clay and sand consequently 306 simulation units were delineated wen et al 2022 2 4 monthly distributed water and salt balance model for irrigation district with shallow groundwater table wen et al 2022 developed a monthly distributed agro hydrological model for irrigation district dahmid with shallow groundwater table to study the total groundwater and soil water balances of irrigated and non irrigated lands in each cca in the present study sub models for salt transport processes associated with the water flow processes are further incorporated into the dahmid model to develop a monthly distributed water and salt balance model for irrigation district dahmid s with shallow groundwater table fig 2 generally salt is introduced into the irrigation district with irrigation water diversion part of which enters the irrigated land with canal seepage and field irrigation while others into non irrigated land through canal seepage then salt enters into the groundwater layer along with deep percolation salt in groundwater can be drained out of the irrigation district through the drainage system while groundwater salt in irrigated land can also be transported to non irrigated land through dry drainage salt drainage through ditches and dry drainage from irrigated land to non irrigated land are modelled in the dahmid s overall the model is a conceptual model based on water and salt balances applied to the irrigated and non irrigated lands of each cca the water and salt balances are analyzed for different units vertical layers and agricultural periods 2 4 1 brief introduction of the dahmid model the dahmid is composed of several sub models depicting major hydrological processes in irrigation district with shallow groundwater table including a remote sensing based evapotranspiration et model yang and shang 2013 and an empirical model yu et al 2016 for et estimation in the plant growth period from april to october and soil freezing and thawing period from november to next march respectively a semi distributed drainage model wen et al 2020 a variable specific yield sy model for long term groundwater table fluctuation prediction crosbie et al 2005 an empirical model for groundwater table fluctuation in soil freezing and thawing period liu et al 2017 and an interior drainage model wen et al 2022 evapotranspiration et is the major water consumption component in arid irrigation districts in the plant growth period from april to october et is estimated with a hybrid dual source scheme and trapezoid framework based evapotranspiration model htem yang and shang 2013 which is fed with the modis surface reflectance and land surface temperature products as a result et with a spatial resolution of 250 m can be obtained wen et al 2022 during soil freezing and thawing period from november to next march an empirical model yu et al 2016 is used to estimate the monthly et drainage is an important way to drain excess water and salt from the irrigation district to drainage ditches and finally to the drainage receiver water drained into the ditches is modelled as the sum of surface return flow from irrigation canals or irrigated lands and groundwater drainage from both irrigated and non irrigated lands which is 1 d t i k max d g i k d s i k 0 where d t ik d s ik and d g ik are total drainage surface return flow and groundwater drainage of the ith sdca 104 m3 in the kth month respectively following wen et al 2020 the monthly surface return flow is estimated as a proportion of excess irrigation over a threshold and the monthly groundwater drainage is calculated from the difference of water levels in groundwater and drainage ditch according to darcy s law in non freezing period from april to october the groundwater table fluctuation is modelled with the long term groundwater fluctuation theory proposed by crosbie et al 2005 which is based on the van genuchten vg 1980 model for soil water characteristic curve in this model the variable specific yield is related to the groundwater table depth and can be calculated by eq 2 for irrigated the subscript lu a and non irrigated lu na lands respectively 2 s y lu s y u s y u 1 α gh lu k 1 gh lu k 2 100 2 β 1 1 β where sy lu is the apparent specific yield that changes with the groundwater table depth sy u is the ultimate specific yield close to the difference between saturated and residual water contents crosbie et al 2005 gh k 1 and gh k 2 are the average groundwater table depths of the simulation unit in the k 1th beginning and k 2th end months m respectively α cm 1 and β are soil specific parameters of the vg van genuchten 1980 model and need to be calibrated for different soil textures besides groundwater table variations in soil freezing and thawing periods are mainly determined by the freezing and thawing processes and an empirical model liu et al 2017 is used to estimate the monthly groundwater table fluctuations 2 4 2 interior drainage and dry drainage models interior drainage and dry drainage are lateral groundwater flow and associated salt transport from irrigated to non irrigated lands due to groundwater level gradient after irrigation respectively they are important supplements to the drainage system in arid irrigation districts with shallow groundwater table konukcu et al 2006 yu et al 2016 from darcy s law for groundwater flow monthly interior drainage of the kth month in the jth cca gt jk 104 m3 can be calculated from wen et al 2022 3 gt jk k gt j el a j gh a j k gh a j k 1 2 el na j gh na j k gh na j k 1 2 a s j where k gt j is the efficiency coefficient of groundwater flow between irrigated and non irrigated lands per unit area in the jth cca subscripts a and na refer to irrigated and non irrigated lands respectively el j is the average elevation of ground surface m in the jth cca gh jk and gh j k 1 are the groundwater table depths at the beginning of the kth and k 1 th months m respectively and a s j is the area of the simulation unit hm2 then monthly dry drainage of salt gst jk in the jth cca salt transport between irrigated and non irrigated lands can be calculated from 4 gst jk gt jk s gt j k where s gt jk is the salinity of interior drainage in the jth cca in the kth month in most cases interior drainage results in groundwater flow from irrigated to non irrigated lands gt jk greater than 0 and s gt jk can be approximated as groundwater salinity in the irrigated lands s ga jk while in rare cases when groundwater flows from non irrigated to irrigated lands gt jk less than 0 s gt jk can be approximated as groundwater salinity in the non irrigated lands s gna jk consequently s gt jk can be estimated from 5 s gt j k s ga j k gt jk 0 s gna j k gt jk 0 furthermore dry drainage efficiency e gst is defined as dry drainage amount per unit irrigation water and can be calculated by 6 e gst j k gst jk i jk this indicator can reflect the amount of salt transported from irrigated land to non irrigated land per unit irrigation water application the larger the dry drainage efficiency the better the dry drainage effect 2 4 3 water balance model water balances for the unsaturated soil layer including the transition zone groundwater layer and their total in both irrigated and non irrigated lands during non freezing and freezing periods are analyzed based on the principle of mass balance in non freezing period total water balance in the unsaturated soil layer and shallow groundwater layer is analyzed using the following equations for irrigated and non irrigated lands respectively 7 p a j k i jk lcs a j k gi a j k 1000 s y a j k gh a j k gh a j k 1 et a j k go a j k 1000 d s j k d ga j k gt jk a sa j 8 p na j k lcs na j k gi a j k 1000 gt jk a sna 1000 s y na j k gh na j k gh na j k 1 et na j k go na j k gwe jk 1000 d gna j k a sna j where a sa j and a sna j are areas of irrigated lands non irrigated lands hm2 in the jth cca respectively pjk ijk lcs jk et jk gi jk go jk and gwe jk are precipitation irrigation canal seepage evapotranspiration groundwater inflow groundwater outflow and groundwater extraction for urban use in the irrigated a and non irrigated na lands of the jth cca in the kth month mm respectively syjk is the apparent specific yield in kth month calculated using eq 2 by replacing k 1 with k and k 2 with k 1 detailed estimation methods of water balance components can refer to wen et al 2022 during the freezing and thawing period from december to next march there is no irrigation and almost no drainage in hid and total precipitation and et are both very small of about 20 mm therefore the water balance from december to march is analyzed together with that of april consequently the total water balance from december to next april can be described using the following equations for irrigated and non irrigated lands respectively wen et al 2022 9 k m 4 m 1 p a j k et a j k p a j m i jm lcs a j m gi a j m s y a j m gh a j m 4 gh a j m 1 et a j m d s j m d ga j m go a j m gt a j m 10 k m 4 m 1 p na j k et na j k p na j m lcs na j m gi na j m gt na j m s y na j m gh na j m 4 gh na j m 1 et na j m d gna j m go na j m where m and m 4 refer to april and december of the previous year respectively and sym is the apparent specific yield that can be calculated using eq 2 by replacing k 1 with m 4 and k 2 with m 1 furthermore water balances in the unsaturated soil layer including the transition zone and groundwater layer are analyzed separately based on the simulated groundwater table depth gh in the total water balance available studies showed that irrigation recharge to groundwater generally forms a relatively fresh groundwater layer above the underlying groundwater layer asghar and prathapar 2002 and the relatively fresh groundwater layer is considered in the following analysis water storages in the groundwater layer soil layer and their total can be calculated from 11 wsg jk 1000 z a gh jk θ s 12 wss jk max tws jk wsg jk 1000 θ wp gh jk 0 1000 θ s gh jk 0 13 tws j k 1 tws jk s y jk gh jk gh j k 1 1000 where wsg jk wss jk and tws jk are water storages of shallow groundwater layer soil layer and their total mm in the jth cca at the beginning of the kth month za is the depth from ground surface to the bottom of the relatively fresh groundwater layer m that needs to be calibrated for different sub irrigated districts θs and θ wp are soil moisture corresponding to saturation and wilting point and was set as 0 40 and 0 04 cm3 cm3 respectively following ren et al 2016 and xue et al 2018 the initial water storages in soil and groundwater layer are calculated by the vg model with the parameters in eq 2 and the observed initial groundwater table depth which are summed up to obtain the initial tws then deep percolation and capillary rise in the irrigated a and non irrigated na lands are estimated from 14 ps a j k η p p jk η i i jk d s j k a sa j 10 3 η l lcs a j k 15 ps na j k η p p jk η l lcs na j k 16 ge a j k ps a j k gi a j k gt jk d ga j k a sa j 10 3 s y g gh a j k gh a j k 1 17 ge na j k ps na j k gi na j k gt jk d gna j k a sna j 10 3 s y g gh na j k gh na j k 1 where ps is the deep percolation from soil layer mm ηp ηi and ηl are infiltration recharge coefficients of precipitation irrigation and canal seepage and set as 0 10 0 30 and 0 15 according to available studies in the hid yu et al 2016 xue et al 2017 ge is the capillary rise and can be calculated from the water balance in the fluctuation region of groundwater level syg is the specific yield of groundwater layer and is set as 0 07 referring to xue et al 2017 2 4 4 salt balance model the salt balance is further analyzed based on the water balance analysis considering that the salt variation is complex in freezing and thawing periods only the salt balance from april to november is considered the average salinity of the tws is calculated as follows 18 s j k 1 tws jk s jk 10 3 δ s jk tws j k 1 10 3 19 δ s a j k p jk s p i jk d sa j k a sa j 10 3 lcs a j k s i gi jk s gi 10 3 d ga j k s gda j k gt jk s gt j k a sa j 20 δ s na j k p jk s p lcs na j k s i gi jk s gi 10 3 d gna j k s gdna j k gt jk s gt j k a sna j where s is the average salinity of the total water storage in groundwater and soil layers kg m3 s is the net salt introduced with the hydrological processes kg m2 s p s i s gi and s gd are salinities of precipitation irrigation groundwater inflow and groundwater drainage respectively kg m3 the sp is set as 0 referring to xue et al 2018 and the s i takes the average value of 0 6 kg m3 due to low variance of the irrigation water salinity in the hid wen et al 2020 the s gd is determined by the flow direction and amount of groundwater drainage from irrigated and non irrigated lands if groundwater drainage from the irrigated or non irrigated lands is over 0 the s gd is equal to the corresponding groundwater salinity in the irrigated s ga or non irrigated s gna land if one of them is positive groundwater drained into the ditch and the other is negative ditch recharging to groundwater the s gd is equal to the mixed drainage water salinity in ditches if they are both less than 0 when ditch water recharges to groundwater then surface return flow is the only source of water to the ditches and then recharge to groundwater the s gd is set to the s i consequently the s gd of the irrigated s gda and non irrigated s gdna lands can be calculated from 21 s gda j k s ga j k d ga j k 0 s gna j k d gna j k s i d s j k d gna j k d s j k d ga j k 0 d gna j k 0 s i d ga j k 0 d gna j k 0 22 s gdna j k s gna j k d gna j k 0 s ga j k d ga j k s i d s j k d ga j k d s j k d gna j k 0 d ga j k 0 s i d gna j k 0 d ga j k 0 meanwhile the drainage water salinity can be estimated from 23 s ditch j k s ga j k d ga j k s gna j k d gna j k s i d s j k d ga j k d gna j k d s j k d ga j k 0 d gna j k 0 s ga j k d ga j k s i d s j k d ga j k d s j k d ga j k 0 d gna j k 0 s gna j k d gna j k s i d s j k d gna j k d s j k d ga j k 0 d gna j k 0 s i d ga j k 0 d gna j k 0 the change of groundwater salinity is determined by salt transport fluxes with hydrological processes and groundwater table fluctuations considering the continuity of groundwater layer and water table fluctuation zone transition zone and the alternative processes of deep percolation and capillary rise salinities in the groundwater layer and transition zone are assumed to be equal and can be estimated from 24 s g j k 1 wsg jk θ s s y g gh jk gh j k 1 sg jk δ sg jk wsg j k 1 25 δ sg a j k ps a j k ss a j k gi jk s gi ge a j k sg a j k 10 3 d ga j k s gda j k gt jk s gt j k a a 26 δ sg na j k ps na j k ss na j k gi jk s gi ge na j k sg na j k 10 3 d gna j k s gdna j k gt jk s gt j k a na where δsg is the salt introduced into the groundwater kg m2 then soil salinity in the unsaturated soil layer can be estimated from 27 ss j k 1 s j k 1 tws j k 1 s g j k 1 wsg j k 1 wss j k 1 where ss is the salinity in soil layer kg m3 2 5 model evaluation parameters for the dahmid were calibrated with groundwater table depth and drainage measurements and given in wen et al 2022 besides these parameters a new parameter za is further introduced in the present dahmid s this parameter is related to geographic location groundwater table depth groundwater salinity and irrigation water salinity and is calibrated and validated with observed groundwater salinity and drainage salinity data in the irrigated and non irrigated lands for each cca for the simulation of groundwater salinity the calibration and validation periods are from 2008 to 2010 and from 2011 to 2013 respectively meanwhile the drainage salinity is simulated directly based on the drainage model without new parameters and therefore all drainage salinity data are used for model validation to evaluate the model performance five commonly used indicators are calculated for both the calibration and validation periods including the percent bias pbias yapo et al 1996 normalized rmse nrmse jamieson et al 1991 nash sutcliffe efficiency coefficient nse nash and sutcliffe 1970 kling gupta efficiency kge gupta et al 2009 and coefficient of determination r 2 nagelkerke 1991 generally the model performs better when pbias and nrmse are close to 0 and nse kge and r 2 are close to 1 additionally positive values of pbias represent overestimation and negative values represent underestimation 3 results 3 1 model calibration and validation in addition to parameters of the dahmid given in wen et al 2022 the new parameter i e za of the dahmid s model was further calibrated for each sub irrigation district table 1 results show that za varies with sub irrigation districts and ranges from 3 5 to 6 0 m the za values of jfz and yc sub irrigation districts are smaller 3 5 4 0 m while those of wlbh yj and wlt are larger due to different reasons the groundwater salinity of wlbh is close to that of irrigation water and changes little with time which leads to difficulty in the precise simulation of groundwater salinity therefore a larger water storage depth za can effectively reduce the variation range of simulated salinity and result in acceptable simulation accuracy for yj there exists a 4 m groundwater depression cone in the south which leads to a larger za wlt has the highest groundwater salinity and therefore irrigation percolation has a greater impact on groundwater salinity which results in a larger za in groundwater salt balance simulation of xue et al 2018 the thickness of the groundwater layer was set as a fixed value of 2 m for an experiment site in the yongji sub irrigation district of the hid considering the maximum groundwater table depth of 2 7 m during the experiment period of xue et al 2018 a maximum za 4 7 m gave satisfactory simulation results of groundwater salt balance the difference between the za values used in groundwater salt balance by xue et al 2018 and the present study is mainly caused by the different spatial scales considered i e field scale for the former and sub irrigation district scale for the latter fig 3 shows the comparison of simulated and observed values of groundwater salinity in irrigated and non irrigated lands the pbiass in both irrigated and non irrigated lands are between 10 and 10 during the calibration and validation periods nrmses lower than 13 52 nses between 0 60 and 0 90 kge between 0 80 and 0 94 and r 2 between 0 83 and 0 95 compared with other studies on the groundwater table and groundwater salinity simulations in the hid huang et al 2010 xu et al 2010 xue and ren 2017a b xue 2018 the present model shows similar or better performance the simulation results of drainage water salinity are compared with the observed data for 12 main ditches the root mean squared error rmse nrmse nse and r 2 are 1 37 kg m3 7 0 0 74 and 0 87 wen et al 2020 respectively indicating that the accuracy of present model is higher than or close to the other similar models cavero et al 2012 wu et al 2017 xue 2018 the largest simulation error occurs in wlt sub irrigation district with nrmse of 21 1 due to the greater spatial variability of groundwater salinity and the greater uncertainty of the observed data overall the present model is effective in the simulation of drainage water salinity in summary the present model can describe water and salt balances in the hid satisfactorily 3 2 water balance in the hid main hydrological processes in the hid have been analyzed in wen et al 2022 fig 4 summarizes the changes of major annual water balance components in the whole hid including major water recharge components irrigation water diverted from the yellow river to the hid i and precipitation p major discharge components et and drainage through ditches d and the residuals representing changes in annual water storage by neglecting other minor water balance components during 2008 2014 the total water recharge from irrigation and precipitation ranges from 5 53 to 7 11 billion m3 with an average of 6 43 billion m3 among which irrigation water diversion ranges from 3 84 to 5 10 billion m3 with an average of 4 53 billion m3 and accounts for 54 to 86 71 in average of the total meanwhile et is the dominant water consumption component which ranges from 5 43 to 6 77 billion m3 with an average of 6 09 billion m3 and accounts for 91 to 99 95 on average of i p and 90 to 94 93 in average of et d the ratio of et to i p tends to increase with i p in contrast annual drainage ranges from 0 36 to 0 62 billion m3 with an average of 0 49 billion m3 accounting for 5 6 to 9 7 7 5 in average of i p and 5 7 to 9 6 7 4 in average of et d average annual drainage is about 10 5 of the total irrigation water diversion besides et d is generally slightly greater than i p which results in the decrease of water storage in most years more details about hydrological processes in the hid can be found in wen et al 2022 fig 5 shows the variations of monthly water storages in the unsaturated soil layer groundwater layer up to za and their sums in the irrigated and non irrigated lands in the whole hid in terms of inter annual variations the total and groundwater storages of irrigated lands change from 12 79 and 10 39 billion m3 in 2008 to 12 51 and 9 71 billion m3 in 2014 respectively both showing a slightly decreasing trend in contrast the soil water storage of irrigated lands is relatively small and fluctuates between 1 0 and 6 0 billion m3 while for the non irrigated lands the total groundwater and soil water storages are all basically stable which are 6 87 5 60 and 1 12 billion m3 at the start of the study period and 6 93 5 74 and 1 33 billion m3 at the end of the study period respectively the total water storage remains stable within a year while the soil water and groundwater storages fluctuate significantly due to significant fluctuation in groundwater table caused by irrigation applications and evapotranspiration the soil water storage reaches its annual peaks in march and september and valleys in june and november which generally correspond to the lowest and highest groundwater level respectively during the soil freezing period from late november to early march soil freezing induces capillary rise and consequently results in increased soil water content and dropped groundwater table shang et al 1999 which results in the peak of soil water storage in march meanwhile the peak of soil water storage in september is caused by a significant increase in the depth of unsaturated soil layer or a decline in groundwater level due to less irrigation and increased capillary rise in the late crop growth stage of august and september on the contrary the valleys of soil water storage are mainly caused by groundwater table rise after spring irrigation from late march to early june and autumn irrigation from late september to early november contrary to the soil water storage the monthly groundwater storage reaches the peaks in june and november and valleys in march and september meanwhile the variation trends of the water storages in irrigated and non irrigated lands are similar on both monthly and annual scales 3 3 variations of major salt balance components in the hid major salt balance components in the whole hid and irrigated and non irrigated lands are shown in fig 6 for clarity minor salt balance components are not shown in the figure including salt exchange associated with lateral groundwater inflow to and outflow from hid salt introduction to the non irrigated lands due to canal seepage and salt discharge with groundwater abstraction which are less than 7 of the total salt introduction from the simulated salt balance fig 6 the whole hid and non irrigated lands both show general states of salt accumulation from 2008 to 2014 while irrigated lands show an overall desalination state for the whole hid the monthly salt introduction discharge and accumulation amounts from april to november range from 0 10 to 0 78 million t month from 0 01 to 0 52 million t month and from 0 37 to 0 77 million t month in the study period fig 6a respectively the peaks of salt introduction and accumulation occur in may july and october associated with large amount of spring summer and autumn irrigation applications meanwhile the peaks of salt discharge generally occur in june and november which is about one month lagging the spring and autumn irrigation applications as a result the whole hid may be in desalinization state in these two months of some years the annual average amounts of introduced salt discharged salt and accumulated salt are 2 91 1 44 and 1 47 million t respectively only 49 4 of the salt introduced to the hid is drained out of the hid through drainage ditches and the rest 50 6 is accumulated in the soil and groundwater of the irrigation district for irrigated lands in the hid monthly changes in soil salt storage range from 0 53 desalination to 0 13 salt accumulation million t and annual desalination amount ranges from 0 45 to 1 27 million t with a mean annual desalination amount of 0 96 million t fig 6b the peaks of soil salt change generally occur in may and october after spring and autumn irrigations the desalination process of irrigated lands is closely related to the process of salt introduction with irrigation and dry drainage the monthly dry drainage process fig 6 is basically consistent with the interior drainage wen et al 2022 which reaches the peaks in may and october due to spring and autumn irrigations and valleys in april and september with less irrigation the monthly dry drainage amounts generally account for 48 99 of the total salt discharge from the irrigated lands and annual ones 2 58 3 39 million t from 2008 to 2014 generally account for 69 82 of the total with the average ratio of 77 therefore dry drainage plays a key role in the desalination of irrigated lands for non irrigated lands in hid the monthly salt accumulation amounts from april to november fig 6c range from 0 04 to 0 74 million t the maximum salt accumulation generally occurs in may and october and the minimum salt accumulation in april and september which is directly related to the interior and dry drainage processes the annual salt accumulation amounts range from 1 90 to 2 87 million t presenting a significant salt accumulation state dry drainage is the main source of salt to the non irrigated lands which accounts for 83 87 85 on average of the total among total salt introduced to the non irrigated lands only 12 to 24 16 on average is drained out through ditches 11 to 13 12 on average is discharged with groundwater abstraction while the rest 63 to 77 72 on average is accumulated in the non irrigated lands fig 7 shows the monthly salt storage processes from april to november in the unsaturated soil layer groundwater layer and their total in irrigated and non irrigated lands of the hid in terms of inter annual variation both the total and groundwater salt storages of irrigated lands show slight decreasing trends while soil salt storage in the irrigated lands is relatively stable in the study period therefore the decrease in groundwater salt storage is the main source of desalination in irrigated lands in contrast to the irrigated lands the total and soil salt storages in non irrigated lands increases in the study period while the groundwater salt storage remains stable consequently the soil layer in the non irrigated lands is the main region of salt accumulation 3 4 spatial pattern of dry drainage in the hid for irrigated lands of different ccas the average annual dry drainage per unit irrigated lands is 262 3 616 1 t km2 fig 8 a the dry drainage is more effective in the middle and southern yc and northern wlt which is related to higher soil and groundwater salinity although the interior drainage amount in wlbh is large dry drainage per unit irrigated lands is slightly lower than that of the middle and southern yc and northern wlt due to the lower soil and groundwater salinity 0 5 1 5 kg m3 in wlbh in general the annual dry drainage amount fig 8 a is basically consistent with the interior drainage wen et al 2022 but it is also related to regional salinization degree the ratios of dry drainage to irrigation introduced salt in different ccas range from 0 62 to 3 84 fig 8 b the ratios in wlt 1 60 3 84 and middle and southern yc 1 60 are significantly greater than other regions due to higher groundwater salinity from 3 2 8 2 kg m3 and less salt introduction as a result of less irrigation in southern and eastern wlt meanwhile the ratio in most parts of wlbh is 1 17 and greater than 1 00 due to the large proportion of non irrigated lands in other parts of the hid the ratios are all less than 1 00 ranging from 0 62 to 0 90 in conclusion dry drainage plays an important role in controlling soil salinization in irrigated lands but can also result in salt accumulation in non irrigated lands that may have negative impacts on the soil environment and natural ecosystems in non irrigated lands fig 8 c shows the spatial distribution of dry drainage efficiency in different ccas which is defined as dry drainage amount per unit irrigation water the efficiency ranges from 0 37 kg m3 in a small part of wlbh to 2 30 kg m3 in southern and eastern wlt and its spatial variation is mainly influenced by irrigation amount per unit irrigated lands soil salinization degree and the proportion of irrigated land area the dry drainage efficiency is the highest in southern and eastern wlt 2 30 followed by northern wlt 0 96 middle and southern yc 0 96 and most parts of wlbh 0 70 higher dry drainage efficiency in wlt and part of yc is mainly caused by smaller irrigation amount per unit area and higher soil and groundwater salinity while higher efficiency in wlbh is mainly caused by smaller percentage of irrigated area however the efficiency is relatively smaller in jfz and yj of the hid which is mainly caused by higher irrigation amount per unit irrigated lands fig 9 shows the spatial distribution of average dry drainage per unit irrigated lands from april to november which indicates the monthly dry drainage changes between 40 and 150 t km2 and has a similar monthly change trend with interior drainage wen et al 2022 negative value of dry drainage indicating dry drainage from non irrigated lands to irrigated lands mainly occurs in months or regions with little or no irrigation and stronger et in irrigated lands and vice versa for example less irrigation in april august and september results in smaller or even negative dry drainage in most parts of the hid while more autumn irrigation in october leads to greater dry drainage meanwhile crop planting pattern determines the irrigation scheduling which in turn influences the spatial distribution of dry drainage for example jfz and yj plant more corn and less sunflower than yc and wlt wen et al 2019 which leads to less irrigation in the spring irrigation period and less dry drainage in may 3 5 spatial pattern of salt accumulation desalinization in the hid different ccas irrigated lands and non irrigated lands show different states of salt balance i e desalinization in most irrigated lands while salt accumulation in non irrigated lands and most ccas fig 10 most ccas show salt accumulation state except for the northwestern wlt sub irrigation district the small cca in the eastern wlbh shows the most severe salt accumulation with the annual salt accumulation amount of 326 3 t km2 which is the outcome of several factors including sufficient water supply of the cca near the sanshenggong canal head shallower groundwater table depth and poorer dry drainage capacity fig 8 the yj middle and southern yc and southern and eastern wlt sub irrigation districts show relatively severer salt accumulation of 200 300 t km2 per year besides other ccas except for the northwestern wlt show moderate to slight salt accumulation the northern wlt shows a desalinization state due to stronger groundwater drainage capacity and higher groundwater salinity wen et al 2020 for irrigated lands the average annual salt storage changes range from 382 6 t km2 to 120 8 t km2 irrigated lands in yj and a small part of the eastern wlbh show slight salt accumulation while irrigated lands in other parts of the hid are all in desalination state the eastern wlbh is close to the sanshenggong canal head of the yellow river which results in sufficient supply of irrigation water and poor dry drainage capacity fig 8 and consequently slight salt accumulation in the irrigated lands poorer dry drainage capacity in the yj sub irrigation district also leads to slight salt accumulation in the irrigated lands fig 8 the desalination effect in the eastern jfz yc and the northern wlt is significant which is related to the higher dry drainage capacity in these regions fig 8 on the other hand the average annual salt accumulation of non irrigated lands varies from 263 1 t km2 to 1613 9 t km2 and the whole non irrigated lands is in the state of salt accumulation in jfz and middle and southern yc with the most severe dry drainage higher soil salinization degree and more effective salt leaching by spring irrigation lead to the most serious salt accumulation in non irrigated soil although the total amount of dry drainage in wlbh is relatively large fig 10 the average salt accumulation per unit area is the smallest 263 1 t km2 because of the highest ratio of non irrigated lands 67 1 in wlbh as soil salt content in the crop root zone is more closely related to crop growth soil salt storage in the unsaturated soil layer is further analyzed to account for significant change of unsaturated soil depth groundwater table depth due to irrigation and evapotranspiration in the hid changes in soil salt storage of the whole unsaturated layer are divided by the unsaturated soil depth to obtain the average soil salt content changes per unit soil layer for comparison purpose as shown in fig 11 a the annual variations of salt content per unit soil depth of irrigated lands range from 474 7 desalinization to 600 0 salt accumulation t km2 regions with significant soil desalination are jfz and the middle and southern yc which is mainly related to irrigation amount soil salinity level and dry drainage capacity on the contrary the soil layer of the irrigated lands in wlbh and the southern and eastern wlt presents a state of salt accumulation especially the latter the salt accumulation in the southern and eastern wlt is the most serious because of less irrigation 2 2 of the total irrigation water diversion and higher groundwater salinity 3 2 8 2 kg m3 as a result soil salt leaching to the groundwater is difficult while groundwater salt can recharge the soil layer with capillary rise although irrigated lands in the southern and eastern wlt is in the state of slight desalinization fig 10 the redistribution of salt between soil layer and groundwater layer results in salt accumulation in the soil layer for the non irrigated lands the average annual variations of soil salt content per unit soil depth range from 192 3 to 1755 5 t km2 which are all in the state of salt accumulation fig 11 b affected by dry drainage groundwater salinity and the percentage of non irrigated lands the soil salinity is the most serious in the southern and eastern wlt and the middle and southern yc due to higher dry drainage capacity fig 8 a dry drainage and the percentage of non irrigated land mainly determine the degree of salt accumulation in non irrigated lands while groundwater salinity mainly affects the distribution of salt in soil layer and groundwater layer in non irrigated lands in non irrigated lands of the hid there is no irrigation and scarce precipitation to provide enough water for evapotranspiration and leaching the soil salt and shallow groundwater is the main source of evapotranspiration in addition to precipitation and canal seepage when the groundwater salt content is higher a large amount of salt is transferred from groundwater to the soil surface through capillary rise leading to an increase of soil salt content therefore attention should be paid to the soil salinization in the non irrigated lands in the southern and eastern wlt and the middle and southern yc 4 discussion in the current study we developed a monthly distributed water and salt balance model for irrigation district dahmid s with shallow groundwater table based on the monthly distributed agro hydrological model for irrigation district dahmid wen et al 2022 major water and salt processes considered in the model include irrigation water diversion evapotranspiration soil water and groundwater balances drainage through ditches interior drainage from irrigated lands to non irrigated lands and salt transport processes associated with the above water processes one major characteristic of the model is that both ditch drainage and interior dry drainage are considered which enables us to simulate water and salt balances in both irrigated lands and non irrigated lands besides only one new parameter za is added in the salt balance model based on the dahmid model which makes the model more convenient to use the model has been successfully applied to the hid based on the simulation results water and salt balances in the hid were analyzed and reasonable water and salt regulation modes for different regions were proposed 4 1 characteristics of water and salt balances in the hid different from dominated hydrological processes of precipitation runoff and evapotranspiration in humid watersheds hydrological processes in arid irrigation districts such as the hid are dominated by irrigation water diversion and evapotranspiration meanwhile salt balance in arid irrigation districts with shallow groundwater table is mainly controlled by salt introduced by irrigation and salt drained through ditches due to the nature of arid climate precipitation in the hid is scarce and there is almost no local runoff moreover the limited precipitation is far less to support the agriculture production and well grown natural ecosystem and thus irrigation water diversion from the yellow river is the main water source for the crop and natural ecosystem in the hid in the study period irrigation water diversion is about 71 of the amount of irrigation and precipitation for the whole hid which provides the key source of water for agriculture directly and natural ecosystem indirectly meanwhile 95 of irrigation water and precipitation are consumed by evapotranspiration water balance in the hid is influenced by both natural factors such as precipitation and evapotranspiration potential in the hid and runoff from the upstream yellow river and human activities such as crop planting area and pattern and irrigation management practices in recent years sunflower and corn have become the dominant crops in the hid where the sunflower planting area tends to increase wen et al 2019 the sunflower is sowed in late may which is about one month later than other major crops and has a significant influence on irrigation during crop growing season and autumn spring irrigation during fallow period qian et al 2022 besides groundwater extraction for domestic industrial and agricultural uses is another human activity that influences water balance in the hid especially the groundwater balance however groundwater extraction has less influence on water balance as compared with other major components such as irrigation evapotranspiration and drainage although salinity of the irrigation water for the hid is lower around 0 6 kg m3 large amount of irrigation water diversion and minor groundwater inflow introduce considerable amount of salt 2 91 million t year on average into the hid however due to flat topography and very small hydraulic gradient of the groundwater level the drainage system in the hid is not effective enough to drain the introduced salt out of the irrigation district in the study period total drainage is about 10 9 of the irrigation water diversion while the amount of salt drained through ditches is only 49 4 of the introduced salt consequently about half of the introduced salt is left in the hid which is not sustainable for the irrigation district fortunately dry drainage of salt from irrigated lands to non irrigated lands provides a possibility for draining excess salt out of the irrigated cropland which results in desalinization for most of the irrigated lands however non irrigated lands are general in salt accumulation state which may intensify soil salinization in non irrigated lands and threaten local natural ecosystems wu et al 2009 studied the soil salinization process in the hid from 1973 to 2009 and found that nearly 70 of the introduced salt was accumulated in the whole hid which is higher than the salt accumulation proportion 50 6 during 2008 to 2014 in the present study the decrease of salt accumulation proportion in these two periods implies that the improvement of the drainage system has been effective in reducing soil salinization in recent years however the whole hid is still in the state of salt accumulation and the drainage system in the hid should be further improved to mitigate the soil salinization problems by improving the water drainage and salt discharge conditions the salt balances in different land use types and soil layers are closely related to water flow and salt transport processes in the hid salt transport in the irrigation district can be roughly divided into five stages the first stage is salt introduction to the irrigation district with irrigation water diversion from the yellow river through irrigation system most of the salt enters the irrigated lands with canal seepage and field application while the rest enters non irrigated lands through canal seepage in the second stage salt entering the irrigated lands is partly leached downward to the groundwater aquifer with irrigation application which leads to the change of groundwater salinity due to canal seepage and field irrigation in the third stage groundwater salt in the irrigated lands is transported to non irrigated lands through dry drainage which is the result of interior drainage due to the groundwater level gradient between irrigated and non irrigated lands after irrigation in the fourth stage the salt in the groundwater of the non irrigated lands enters the soil layer through capillary rise and accumulates on the soil surface in the fifth stage part of the groundwater salt in both the irrigated and non irrigated lands can be drained through the drainage system to the drainage receiver salt enters into the irrigation district in the first stage and flows out of the irrigation district in the last stage can be measured from irrigation and drainage water and salinity while salt transport processes in the other three stages are hard to be monitored in the irrigation district scale however we can simulate the salt transport processes in ungauged stages using the dahmid s model within a year the monthly total salt storage in both irrigated lands and non irrigated lands is relatively stable but the salt storage in the soil layer and groundwater layer has larger fluctuations due to greater fluctuation of groundwater table in a year for irrigated lands the salt storage of soil layer reaches the valley in june and november and the peak in march and september consistent with the changes in water storage the redistribution of salt between the soil layer and the groundwater layer leads to the opposite trend of salt storage in the two layers within a year fig 7 4 2 the role of interior drainage and dry drainage in water and salt balances interior drainage is the lateral groundwater flow from irrigated lands to non irrigated lands due to groundwater level gradient after irrigation it is a supplementary way to control the groundwater table in irrigated lands and the most important recharge component to groundwater in non irrigated lands that provides water for the growth of natural ecosystems in the non irrigated lands wen et al 2022 dry drainage of salt accompanied with interior drainage is a unique and key process of salt balance for both irrigated and non irrigated lands in arid irrigation districts with shallow groundwater for the whole hid dry drainage is about 99 of the total salt introduced to the hid averaged during 2008 2014 in an experiment area of 2900 ha in the middle of the hid wang et al 2019 found that the dry drainage accounts for 83 2 of the salt introduced by irrigation from 2007 to 2011 which is slightly lower than the present results for the whole hid in fact the ratio of dry drainage to total salt introduction is related to the land use pattern and may change with spatial scale wu et al 2009 a greater percentage of irrigated lands 71 4 in the experiment area of wang et al 2019 is likely the reason for lower dry drainage ratio in irrigated lands of the hid annual dry drainage amounts are 69 82 77 on average of the total salt discharge from fig 6 b which plays a key role in salt desalinization in most parts of the irrigated lands in the hid fig 10 a and 11 a consequently salt content in the irrigated cropland can be kept at an appropriate range for crop growth on the contrary annual dry drainage accounts for 83 87 85 on average of the total salt introduced to the non irrigated lands due to poorer drainage conditions in non irrigated lands 63 to 77 72 on average of the introduced salt is accumulated in the non irrigated lands which leads to salt accumulation in non irrigated lands in different ccas fig 10 b and 11 b the sustained salt accumulation in non irrigated lands is mainly caused by several reasons firstly decreased water diversion from the yellow river in recent years and insufficient drainage capacity result in less drainage water and salt out of the hid and salt accumulation in the whole hid secondly interior drainage of groundwater and dry drainage of groundwater salt lead to salt accumulation in non irrigated lands thirdly increased cultivated land area and decreased non irrigated area in recent decades lead to higher salt accumulation amount per unit non irrigated land as a result soil salinization degree tends to exacerbate in some parts of the hid which further threatens the natural ecosystems in non irrigated lands and even the sustainability of the whole hid appropriate measures should be taken to mitigate the harm of exacerbated soil salinization in some parts of the hid such as allocating irrigation water more rationally both in space and time improving the drainage system to increase the amount of water and salt drained out of the hid and controlling the area of cultivated land to reserve enough area of non irrigated lands to alleviate salt accumulation per unit non irrigated land consequently interior drainage and dry drainage play important roles in water and salt balances of irrigated and non irrigated lands in the hid and similar irrigation districts compared with other distributed hydrological models for arid irrigation districts that do not consider lateral groundwater flow and salt transport between adjacent simulation units incorporating the sub models for interior drainage and dry drainage in the dahmid s model makes it more applicable to arid irrigation districts with shallow groundwater table 4 3 feasible regulation mode of water and salt regime in the hid most parts of the hid especially the non irrigated lands and a small part of the irrigated lands are in the state of salt accumulation which is harmful to agricultural production and natural ecosystem protection to improve the sustainability of the hid it is necessary to study the feasible regulation mode of water and salt regime in the hid groundwater table control is the core for water and salt regulation in the hid in the current irrigation and drainage conditions the groundwater level remains relatively stable with a slight decreasing trend in the study period i e 12 9 mm year in irrigated lands and 5 5 mm year in non irrigated lands this implies that the reduced irrigation water diversion with the implementation of water saving projects in the hid since 1999 has a certain positive effect on the regulation of groundwater level in the irrigated areas regional salt change in a year is influenced by many factors including irrigation amount drainage system regional salinization degree and land use and planting patterns due to differences of the above factors in different ccas the annual salt change in ccas shows irregular spatial distribution pattern fig 10 specifically the northern wlt had the best salinity control effect showing an overall desalination trend fig 10 for northern wlt the overall desalinization is mainly a result of the following reasons first irrigation water amount per unit area from the general main canal in this cca is smaller compared with the whole hid because of unfavorable irrigation conditions in the downstream of the hid second more groundwater is abstracted for irrigation to compensate for insufficient water supply from the surface water which reduces the dependence on canal irrigation and lowers the groundwater level third the ditch drainage system in wlt is relatively well developed and the drainage amount per unit area is higher than the average level of the whole hid wen et al 2020 fourth higher groundwater salinization degree in the northern wlt results in higher salt drainage capacity for the same amount of drainage water fifth sunflower has become the dominant crop in the northern wlt wen et al 2019 which has a lower irrigation water requirement of only 240 mm during the growth period compared with corn and wheat wang 2012 with the integrated effect of the above factors the groundwater salinity in wlt decreased from 6 34 kg m3 in early 2008 to 4 04 kg m3 at the end of 2014 showing a good level of salt control however there is still room for further improvement in the irrigation and drainage management in wlt compared with the northern wlt other sub irrigation districts all show some problems in water and salt balance the wlbh located in the upstream has more water supply for irrigation and sparse ditch system which results in smaller drainage capacity of only 44 of the average level in the whole hid in jfz main crops are corn and wheat that consume more water than sunflower and the amount of irrigation water diversion accounts for 26 4 of the total hid in the study period as a result the surface water return flow to the ditches in some areas is as high as 7 3 22 8 of the irrigation water diversion and the groundwater drainage capacity is lower than the average level of the whole hid wen et al 2020 in yj the irrigation amount only accounts for 18 7 of the total hid and the surface water return flow rate is only 0 6 3 9 wen et al 2020 however there is a groundwater depression cone in the southern yj wen et al 2020 which leads to smaller groundwater drainage and salt discharge and severer salt accumulation in this region in northern yc close to the general main drainage ditch annual salt accumulation is relatively slight due to the well developed drainage system and more sunflower planting area while other parts of yc show moderate salt accumulation due to unmatched irrigation and drainage systems the southern and eastern wlt also shows moderate salt accumulation therefore appropriate measures should be taken to solve these problems to improve the water and salt conditions for the sustainability of the hid such as improving the irrigation management controlling the irrigation water supply improving the drainage system and regulating the crop planting pattern to reduce the overall salinization degree of the study region in controlling the irrigation water supply its influences on salt introduction groundwater and salt drainage through ditches and interior drainage of groundwater and dry drainage of salt from irrigated lands to non irrigated lands should be considered comprehensively in eastern wlbh jfz and yj with more irrigation application per unit irrigated area irrigation water supply should be decreased by planting more sunflower to provide more water for the downstream regions of the hid and the drainage system should be further improved to decrease the salt accumulation to a lower level however in southern and eastern yc and wlt with less irrigation application per unit area and higher efficiency of dry drainage fig 8 the irrigation water diversion can be increased by planting more corn and wheat besides irrigation management should be improved to reduce the surface water return flow to increase the groundwater drainage capacity especially in the eastern wlbh and southern jfz sub irrigation districts with higher surface return ratio wen et al 2020 5 conclusions in this study we developed a monthly distributed water and salt balance model for irrigation district dahmid s in arid regions with shallow groundwater table based on a monthly distributed agro hydrological model for irrigation district dahmid the model considers major water and salt processes in arid irrigation districts including irrigation water evapotranspiration soil water and groundwater balances drainage through ditches interior drainage from irrigated lands to non irrigated lands and salt transport processes associated with the above water processes by considering both ditch drainage and interior dry drainage the model is capable of simulating water and salt balances in canal command areas ccas and irrigated and non irrigated lands in a cca the model was successfully applied to the hid the largest irrigation district in arid region of china based on the simulation results from 2008 to 2014 the following conclusions can be drawn 1 in the irrigated land of the hid groundwater storage shows a decreasing trend from 10 39 to 9 71 billion m3 during 2008 2014 while soil water storage fluctuates between 1 0 and 6 0 billion m3 in the non irrigated land groundwater and soil water storages are both steady and in the ranges of 5 6 5 74 and 1 12 1 33 billion m3 respectively 2 for the salt balance in the whole hid only 49 4 of the salt introduced to the hid is finally drained out of hid through drainage ditches and the remaining salt is accumulated in the soil and groundwater due to large amount of autumn irrigation from late september to early november the best time for salt leaching occurs in november except for the northern wlt showing a desalinization trend other parts of the hid are all in the state of salt accumulation the problem of salt accumulation in the western and southern hid is more severe due to adequate water supply 3 dry drainage of salt i e salt transport with interior drainage of groundwater from irrigated lands to non irrigated lands plays a crucial role in salt balance of both irrigated lands and non irrigated lands the monthly dry drainage process is closely related to the irrigation process and basically consistent with the interior drainage process the ratio of dry drainage to irrigation introduced salt is generally higher in the downstream region the amount of annual salt transport through dry drainage in the whole hid accounts for 77 of the total salt discharge from the irrigated lands and 85 of the total salt introduced to the non irrigated lands as a result most irrigated lands in the hid are in a desalinization state except for yj and a small part of the eastern wlbh while non irrigated lands are generally in salt accumulation state 4 appropriate measures should be taken to solve water and salt related problems to improve the water and salt conditions for the sustainability of the hid in eastern wlbh jfz and yj irrigation water supply should be decreased by planting more sunflower with less water requirement and the drainage system should be further improved to decrease the salt accumulation to a lower level meanwhile in southern and eastern yc and wlt the irrigation water diversion can be increased by planting more corn and wheat furthermore irrigation management should be improved to reduce the surface water return flow to increase the groundwater drainage capacity especially in the eastern wlbh and southern jfz sub irrigation districts credit authorship contribution statement yeqiang wen methodology software data curation formal analysis writing original draft heyang wan software data curation formal analysis visualization investigation writing original draft songhao shang conceptualization supervision writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was partially supported by the national natural science foundation of china grant numbers 51839006 and 51779119 and the state key laboratory of hydroscience and engineering grant number 2020 ky 01 
2621,stream gauge clustering enables diverse studies such as the analysis of spatial patterns and the physical reasons for these patterns the clustering of monitoring gauges through complex networks combined with community detection algorithms is a strong alternative to classical methods however this approach involves several particularities that impact the clustering results and the non stationarity commonly present in streamflow series is typically not accounted for in studies that use this methodology this article presents the application of a new framework developed to cluster stream gauge stations and to analyse changes in the clustering results across time weighted networks were created through mutual information combined with an automated threshold complex networks were obtained for the entire series and for sliding windows to investigate if significant differences occur across time a more in depth analysis was carried out with selected time windows through the perspective of network science and complex network analysis and the results were compared to those from a classic clustering approach the framework provided robust and physically coherent clustering results and a more detailed clustering result than the classic approach the weighted networks construction procedure successfully diminished time delimited effects induced by non stationarity however the sliding windows networks results demonstrated that significant changes occurred across time and three different community configurations were obtained these results indicate that the use a single network can result in a misrepresentation of local characteristic and lead to wrong conclusions the communities evolution across time showed spatial time coherence with both the physical phenomenology of the study area and previous studies the changes observed were associated with phase shifts of low frequency sea surface temperature oscillations of both the atlantic and the pacific oceans through the phase shifts direct and indirect influence on the south atlantic convergence zone the in depth analysis resulted in the identification of a spatially coherent transition zone within the clusters obtained and attested the reliability of the framework results based on network typologies thus the proposed framework can aid in clustering problems and provide better comprehension of local characteristics although the framework was developed for stream gauge clustering its use can be extended to the clustering of any data with nonlinear and nonstationary characteristics keywords non linearity network science mutual information hydrologic regionalization climate variability community detection 1 introduction stream gauge station clustering is important to identify stations that exhibit similar seasonal interannual or other temporal variability mcmanamay et al 2014 sun et al 2015 the analysis of stream gauge clustering facilitates the study of the physical reasons behind observed similarities such as teleconnections and climate forcing dickinson et al 2019 ivancic and shaw 2017 the grouping results also enable the analysis of spatial patterns and of the extension of stations that display similar or opposite behaviour han et al 2020 mccabe and wolock 2014 ridolfi et al 2016 yang et al 2019 yoo et al 2011 essential information when dealing with the operation of an interconnected system of reservoirs finally clustering methodologies can reduce the dimensionality of the streamflow modelling process lima and lall 2010 allowing for a more in depth analysis using fewer stations than were originally selected to represent the different regional behaviours this is key to facilitate the study of stream gauge dynamics as streamflow modelling often requires complex methodologies to deal with the nonlinearity present in streamflow time series the clustering problem however is not simple or straightforward on the contrary it involves a variety of methodological considerations a diverse range of clustering methodologies exist each one with its own particularities thus the selection of the adequate number of clusters can involve the use of dendrograms quantitative indices and or plot analysis charrad et al 2014 the diversity of techniques presented in the literature illustrates that the clustering problem is on going and has room to be improved fang et al 2017 halverson and fleming 2015 han et al 2020 konapala and mishra 2017 rodríguez alarcón and lozano 2019 recent field related studies use complex networks and community detection to cluster rainfall and stream gauges a methodology derived from social network analysis that has become an increasingly popular alternative to classical methods han et al 2020 joo et al 2020 this methodology involves two steps 1 the creation of a network with the aid of a similarity metric to determine the links between the nodes that represent the stations and 2 the use of a community detection algorithm to group similar stations into a community i e cluster the results obtained in recent studies emphasize the effectiveness of the use of complex networks and community detection for stream gauge clustering joo et al 2020 concluded that community detection was superior to the well established k means technique providing a more effective clustering in terms of hydrologic similarity persistence and connectivity than the k means technique additionally halverson and fleming 2015 observed that the communities obtained using community detection resulted in a befitting regional spatial dispersion with stream gauges of the same community presenting similar seasonality patterns in this case the communities detected were also able to capture physical characteristics such as drainage area and elevation where stations with similar characteristics belonged to the same community despite the utility of using complex networks and community detection for stream or rainfall gauge clustering few studies have applied the methodology for this objective agarwal et al 2019 2018 halverson and fleming 2015 han et al 2020 joo et al 2021 2020 kim et al 2019 rodríguez alarcón and lozano 2019 this is expected since the use of complex networks in hydrology related studies is an emerging area of research sivakumar and woldemeskel 2014 and the clustering objective is only one particular use of complex networks also the application of complex network has only recently emerged across different fields of studies following advances related to small world networks watts and strogatz 1998 scale free networks barabási and albert 1999 network motifs milo et al 2002 and the modularity concept newman and girvan 2004 these advances allow for a better representation of real world networks that violates the assumptions made in previous studies based in random graph theory further studies are required to fully comprehend the details involved in the application of complex networks for hydrology related studies including stream gauges clustering the two step methodology described above involves several considerations such as the selection of the similarity metric used in network creation which can significantly change the clustering results for example correlation is commonly used as a similarity metric when creating networks fang et al 2017 halverson and fleming 2015 joo et al 2020 scarsoglio et al 2013 sivakumar and woldemeskel 2014 yet mutual information mi has been shown to obtain better results than correlation for nonlinear physical processes donges et al 2009 donges et al 2009 including nonlinear rainfall patterns kim et al 2019 these results may not be captured by classical linear methods donges et al 2009 in a comparison study of correlation and mi for instance donges et al 2009 observed a high degree of similarity in two of the scales analysed but a larger difference for the third one supporting the use of mi when working with nonlinear physical processes donges et al 2009 thus using mi as similarity metric for the construction of complex networks of stream gauges emerges as a natural solution to deal with the nonlinearity present in streamflow series the selection of the threshold of the similarity metric is another key factor in network creation the threshold value controls which links are created among the different nodes of the network the threshold value can significantly impact the resulting network fang et al 2017 sivakumar and woldemeskel 2014 diverse selecting approaches can be found in the articles cited above ranging from the direct use of different thresholds values to the selection of a threshold that produces a fitting value of a complex network analysis metric such as edge density or modularity these metrics are obtained after the application of the community detection algorithm embedding in the network structure the uncertainty involved in the community detection given the variety of threshold selection methods and the fact that the threshold value can significantly impact the network obtained further studies are needed to establish a robust threshold selection method the use of unweighted and weighted networks must also be considered in network creation although halverson and fleming 2015 argue that the use of weighted networks can enhance the results obtained in clustering analyses weighted networks are not common in studies examining streamflow data in the present study we propose that a combination of weighted networks and an automated approach for threshold selection may be a viable solution to provide a robust network creation framework where the weight of the network would reduce the impact of eventual links created between nodes that do not present a high degree of similarity the presence of non stationarity in streamflow data can alter the conclusions drawn from the network obtained as these conclusions may not be valid for the entire time series but rather for only a determined period although non stationarity is commonly mentioned in hydrological studies deb et al 2019a 2019b rocha and de souza filho 2020 to the best of our knowledge it has not yet been considered in studies that use community detection for clustering the use of complex networks also allows network science theory and complex network analysis to be used to characterize the type of the network obtained and to analyse the obtained network s stability efficiency and robustness important aspects when dealing with a system of monitoring gauges agarwal et al 2018 halverson and fleming 2015 sivakumar and woldemeskel 2014 additionally network nodes can be classified in terms of their role in their community enabling the analysis of transition zones between the clusters and other possibilities jones et al 2019 in this article we present the application of a framework developed to incorporate all factors mentioned above and effectively deal with the non stationarity and non linearity commonly found in streamflow series weighted networks were obtained using mi with a threshold selection based on monte carlo markov chain mcmc bootstrapping simulations it was evaluated whether this methodologic decision can reduce the subjectivity involved in the threshold selection networks for the entire series and for sliding windows of 30 and 20 years were obtained and the clustering results were compared to determine if changes occurred across time and if this approach could identify and deal with non stationary effects select time periods and the complete series networks were chosen for a more in depth analysis from the perspective of network science and complex networks analysis to verify the networks typologies and clustering quality this analysis was complemented by the application of a novel complex network analysis metric called bridge centrality jones et al 2019 to analyse the existence of transition zones between the clusters finally the results were compared to a commonly used clustering technique based on principal components analysis the framework successfully reduces the subjectivity involved in threshold selection and incorporates the non stationarity of the series using sliding windows diminishing time delimited effects with the use of the weighted networks it provides robust and physically coherent clustering results that can be further evaluated using network science and complex network analysis to define the clusters properties investigate the existence of transition zones and better understand other network characteristics consequently the proposed framework can aid in clustering problems and increase comprehension of local characteristics while the framework is applied to stream gauge clustering in this study its use may be extended to the clustering of any data with nonlinear and nonstationary characteristics 2 data and methodology this section is divided in six subsections the first subsection presents the context on this research and the data used subsections 2 2 to 2 5 describe the methodology used to obtain the complex networks with the aid of the mi metric and the mcmc threshold selection 2 2 detect the communities 2 3 analysis the communities structure and how they evolve through time 2 4 and perform an in depth analysis of selected complex networks from the perspective of complex network analysis and network science theory 2 5 see fig 1 for flowchart of the methodologic steps the last subsection reviews the classic methodology used to compare the clustering results 2 1 study area background and data brazil was selected as study area based on national and local relevance as well as the non stationarity observed at gauge stations given the country s dependence on the production of hydropower electricity it is crucial to better understand national streamflow data at least two recent studies applying different techniques observed the non stationarity present at various stations rocha and de souza filho 2020 rolim and filho 2020 making the series appropriate for the application of the proposed framework the analysis and identification of eventual changes in the relationship of the stations has local relevance since a stationarity relationship between the stations is typically assumed for the development of projections scenarios and streamflow forecasting cepel 2012 we used monthly naturalized streamflow data of 88 stations located across brazil with a higher concentration in the southeast and southern regions of the country regions that are responsible for the majority of the country s hydropower production the naturalization process is described in detail by ons 2017 and aims to remove anthropogenically derived factors that modify the natural variability of the streamflow process annual naturalized streamflow from 1931 to 2015 was obtained by averaging monthly values according to the hydrologic year the use of annual streamflow data aims to cluster stations with similar interannual variability diminishing seasonal oscillations we find that interannual clustering can provide relevant information for long term energy production projections the annual average precipitation temperature and streamflow is presented in the supplemental files along with spatial plots although not analysed in this work we find that this information better characterizes the area of study and the stations 2 2 complex network analysis through mutual information and mcmc threshold selection a network represents the relationship between the selected variables nodes or vertices through directed or undirected connections links or edges therefore a network can be expressed as g v e with v representing a set of n nodes v 1 v 2 v n and e a set of n edges the link creation between two nodes relies on theorical assumptions based on the expertise of the researchers or on similarity metrics combined with a threshold criterium mutual information mi measures the mutual dependency of two variables and is sensitive to non linear dependencies as non linear dependencies cannot be detected by simpler metrics e g linear correlation coefficient mi acts as a measure of true dependence kraskov et al 2004 the construction of a network based on mi results in an undirected network mi is a function of entropy and exact computation is only considered feasible for discrete variables and special cases with known probabilities distribution belghazi et al 2018 in this paper we used a discretization approach via the r package muti scheuerell 2017 with the default five symbolic representations of the streamflow annual series 1 q t 1 q t q t 1 p e a k q t 1 q t q t 1 i n c r e a s i n g q t 1 q t q t 1 s a m e q t 1 q t q t 1 d e c r e a s i n g q t 1 q t q t 1 t r o u g h where q t q t 1 and q t 1 are the streamflow event in the timestep t immediately before t 1 and after t 1 respectively the entropy h x of a series x can be calculated using the equation 2 h x e log p x i 1 l p x i log b p x i where p x is a probability mass function l is the length of the time series and b is the logarithm base muti package uses a logarithm of base two measuring the information in units of bits the joint entropy between two series x and y is given by the equation 3 h x y i 1 l p x i y i log b p x i y i where p x i y i is the probability that x x i and y y i finally mi can be calculated and normalized mi through the equations 4 m i x y h x h y h x y 5 mi x y mi x y h x h y normalized mutual information mi ranges between the values of zero and one where a value of one indicates a perfect simultaneous behaviour of series x and y mi results were used to construct a weighted network representing the interrelation between gauge stations each node of the weighted network represents a station and an edge linking one node to another was created if the result was higher than a 95 significance threshold obtained through mcmc bootstrapping the weight of the edge is the mi value and acts as a similarity measure mcmc bootstrapping is performed by obtaining the transition matrix between discrete categories of the x and y time series randomly choosing the initial value and pooling values according to the transition matrix probabilities until a series with the same length is obtained 2 3 community detection for weighted networks despite having similar objectives classical clustering techniques and community detection differ significantly methodologically in a broad sense the communities of complex networks can also be referred as clusters community detection algorithms aim to group nodes that are closely connected and therefore share similar attributes while presenting a certain degree of dissimilarity or independence from the remaining nodes outside of the given community however whereas classical clustering techniques rely exclusively on the direct similarity between time series data community detection is based on both the similarity of the data and network theory joo et al 2020 to optimize the resulting communities most algorithms use the division quality function called modularity modularity was developed to compare the links within the obtained communities to random theoretical connections the concept derives from the idea that if a natural random expected division of the network exists the connection within a community needs to surpass the expected random theoretical value while the connections between communities must be lower than the expected random theoretical value chang et al 2012 the probability of an edge existing between nodes i and j is given by k i k j 2 m where k i is the degree of node i and m is the total sum of the weights of all edges in the network newman 2004 in weighted networks the degree of a given node is the sum of the weights of its links thus 6 k i j a ij m 1 2 i j a ij 1 2 i k i where a ij is the weight of the link between nodes i and j an element of the weighted adjacency matrix a the modularity is then given by 7 q 1 2 m ij a ij k i k j 2 m δ c i c j where δ c i c j is a function that returns one if the community of the node i is equal to node j c i c j and zero otherwise newman 2004 modularity ranges from zero to one with values close to zero expressing a relatively random number of within community edges and values close to one indicating a strong community structure within the network typical values of modularity for real world networks range between 0 3 and 0 7 newman and girvan 2004 and values of about 0 3 or higher indicate good divisions newman 2004 modularity optimization however is not a simple task which has led to the development of diverse algorithms to overcome the inherent complexity although halverson and fleming 2015 did not detect significant disparities between different methodologies de sousa and zhao 2014 found that the walktrap algorithm pons and latapy 2005 leads to better results on average this algorithm is based on the simple assumption that short random walks along the network have a tendency to stay within the same community in this study we applied the walktrap algorithm to optimize modularity and used the r package igraph csardi and nepusz 2006 which was used by both halverson and fleming 2015 and de sousa and zhao 2014 2 4 community changes detection across time to investigate if significant differences occur across time the communities detected for the network obtained for the entire series and the results obtained using sliding windows of 20 and 30 years were compared using five metrics the variation of information vi meila 2003 the normalized mutual information nmi danon et al 2005 split join distance split join van dongen 2000 the rand index rand rand 1971 and the adjusted rand index adjusted rand hubert and arabie 1985 the use of another acronym to refer to the same similarity metric normalized mutual information is to prevent confusion as the metric was applied with two different purposes to extract the amount of information within two streamflow time series mi and to quantify the difference within two networks communities nmi the results within the sliding windows were also compared to analyse the different configurations that occurred across time and to check the stability of the communities for this procedure only the metric that produced the best results in the previous step was used the different configurations were obtained with the aid of a hierarchical clustering for each unique community configuration a representative time window was selected based on the metric results within the cluster therefore the time window that presented the highest mean value of the metric was selected as representative for the time windows that belonged to the same cluster 2 5 complex network analysis an in depth analysis was carried out for the network of the entire series and for the networks of the selected time windows first a simple analysis using network science theory was performed to verify if the topologies of the obtained networks were characteristic of a random network while the detection of network communities does not require assumptions regarding the network topology halverson and fleming 2015 a random network typology indicates that the links between the nodes may occur by chance this does not reflect a network constructed based on streamflow variability rather the streamflow variability is a product of climate variability and physical characteristics which impose spatially consistent behaviour therefore a random network typology would raise concerns regarding the reliability of the network construction methodology the network typology was evaluated using the clustering coefficient and by analysing the degree distribution the clustering coefficient c evaluates the tendency of the nodes of a network to cluster together much larger values of c are expected for real networks than for corresponding random network with the same number of nodes and links c c random weighted networks require a slightly different calculation of this metric to correctly include the weights of the network in this work the method presented by barrat et al 2004 was used the degree of a node corresponds to the number of connections that node has with other nodes complex network theory states that the degree distribution of a random network follows a binomial distribution therefore the histogram comparison between the obtained network and the corresponding random network allows for the analysis of the network typology bridge closeness was used to analyse transition zones between the different communities bridge closeness evaluates the average distance between a node and other nodes outside of the specified node s community jones et al 2019 the distance between nodes of an unweighted network corresponds to the shortest path between two nodes i e the number of edges in weighted networks the weights are interpreted according to theoretical concepts for example the classic dijkstra algorithm interprets the weights as costs when finding the shortest paths among nodes in this case the distance needs to be based on the inverse of the edge weights to act as a measure of similarity bridge closeness is calculated using the inverse of the average distance between nodes nodes with higher values of bridge closeness act as a bridge transition between communities as they are more likely to share common attributes with different communities than nodes with lower values of this metric to decide which node act as a bridge jones et al 2019 suggest the evaluation of the metric s distribution through a preliminary analysis we decided to consider the stations with the ten highest values as bridges resulting in a more restrictive threshold 11 than used by jones et al 2019 after theoretical simulations 20 highest values no significant changes were observed when considering other bridge centrality metrics i e strength betweenness and expected influence the results were obtained using the r package networktools 2 6 comparison with a classical clustering technique the results for the selected time windows were compared to the results obtained through principal components analysis pca a widely used clustering method the streamflow series were analyzed using ten principal components that explained more than 80 of the variance of the series in the preliminary tests a hierarchical clustering was applied to the pca results the number of clusters was selected by cutting the hierarchical tree into the partition that resulted in the highest relative loss of inertia this process was performed with the aid of the r package factominer lê et al 2008 the spatial dispersion of the clusters was compared to previous results and the nmi was used to quantify the difference between the cluster results 3 results 3 1 community changes detection across time all five metrics suggested changes in the communities across time when used to compare the results obtained for the complete series network csn to both sliding windows networks the nmi was adopted as reference for this work since it has a range within a defined interval 0 to 1 and the values obtained showed significant variation along the scale the five metrics presented similar patterns and are presented in the supplemental files the communities obtained for the csn shared more similarities with the communities obtained using the 30 year sliding window sw30 than with those obtained with the 20 year sliding window sw20 fig 2 the highest nmi values were obtained for the sw30 with starting years between 1961 and 1976 sw20 showed increasing similarity from 1955 until about 1985 with low values after 1985 in concordance to the results obtained for the sw30 fig 2 also presents the modularity of the networks obtained the modularity values of the sw20 exhibited a high variation across time ranging from 0 26 to 0 63 with a strong v shaped pattern between 1946 and 1961 the modularity of sw30 presented a steady oscillation between 0 36 and 0 56 without a significant shift the modularity of the csn was 0 44 these results indicate that the communities obtained for the sw20 presented strong variations within small changes of the sliding windows which can result in a fragile stability of the communities the continuous results of the nmi of the networks created using sliding windows fig 3 left corroborate the observed fragile stability for the sw20 communities the similarities between close windows show a fast decrease within a small number of years for the sw20 on the other hand the sw30 shows a marked cohesion for several years without large oscillations indicating a stronger stability of the communities obtained the hierarchical clustering analysis of the nmi results between the sliding windows resulted in four clusters for the sw20 and three for the sw30 fig 3 right these clusters were selected through the analysis of the different cluster configurations detailed in table 1 the clusters found for sw30 exhibit a stronger cohesion than the sw20 clusters as diverse periods grouped together do not have high nmi values for the latter however the sw30 also presented time windows with abnormally low nmi values within the same cluster which is clearly noticeable for the windows starting in the years 1938 and 1939 for the first cluster between 1973 and 1976 in the second and between 1984 and 1986 in the third for the second cluster the years mentioned are close to the start of the third cluster and delimit a transition between the two clusters the years mentioned for the first and third clusters are close to the limits of the series and suffers from border effects which suggests a previous and forthcoming configuration before the first cluster and after the third one respectively the years of change in the clusters of both sliding windows share some resemblance and occur close to the years of 1956 and 1980 the fragile stability observed for the communities detected for the sw20 raised concerns regarding the reliability of sw20 results thus the sw20 clusters were discarded and only sw30 results were considered for the remaining analysis 3 2 complex network analysis and spatial dispersion the clustering coefficient results and histogram plot analysis indicate that none of the selected networks presented a random network typology table 2 fig 4 the csn was the most similar to the random network compared to the other time window networks the clustering coefficient of the csn had the smallest difference in comparison to the correspondent random network value only 1 75 times the c random value where the remaining time windows were close to 3 times the c random the histogram plots corroborate these conclusions fig 4 none of plots follow the equivalent random distribution while the csn shares the most similarities with the random distribution the spatial dispersion of the communities is shown in fig 5 where the evolution of the communities is presented in fig 6 notably most southern stations remained in the same cluster 3 for all the periods analysed one station itaipu was considered a bridge station given the bridge closeness criteria this classification was in concordance with the community results since the station belonged to different communities across the time windows reinforcing the similarities shared with diverse stations another station belonged to cluster 2 throughout the different periods cluster 3 presented the largest changes in the third period 1980 2009 fig 5c with the presence of additional stations in the midwest and northern regions cluster 3 showed smaller changes across the other periods the remaining clusters showed more significant changes especially when compared to the first time window 1934 1963 fig 5a the major differences were delimited to clusters 4 and 5 the significant relevance of cluster 4 in the first period translates to a small presence concentrated in the northern region for the second period 1969 1998 fig 5b mostly due to the western expansion of cluster 2 combined with a southwest displacement of cluster 1 this displacement comprised the stations that belonged to clusters 5 and 6 also resulting in a migration of cluster 1 stations to cluster 2 the previously observed movements continue in the third period with cluster 1 exhibiting a western expansion comprising the remaining stations of cluster 4 and cluster 2 absorbing diverse cluster 1 stations the mentioned cluster 3 expansion comprised some stations of the cluster 1 the cluster evolution across these three periods indicates a reduction of the different variability patterns across time resulting in three large spatially consistent patterns both the second and third periods presented a station that did not belong to any community the csn 1931 2015 fig 5d has a similar spatial concentration of the bridge stations the southeast area close to the lower limits between the midwest and the southeast regions seems to act as a transition zone since it concentrated most of the bridge stations the bridge classification could also detect stations that presented cluster changes across time it was clear that the csn shared strong similarities with the second period but diverged from the spatial patterns obtained for the first and third periods these results agree with the nmi results and indicate that the csn should not be used to represent the complete series the presence of more links between the stations indicates that the methodology resulted in a more densely connected graph for the csn which was corroborated by the network plot found in the supplemental files 3 3 pca results comparison fig 7 presents the results for the pca clustering pcac the spatial dispersion for the selected time windows resembles the complex network clustering results cnc most of the southern stations of the pcac remained in the same cluster for all periods analysed one southern station belonged to cluster 1 across time in concordance with the cnc results stations closer to the northwest region did not show many changes for the complete series or the second and third periods for these time windows the changes were mostly concentrated in the north center west and southwest region in concordance with the cnc for the first period cluster 1 of the pcac encompasses all stations of clusters 2 4 and 6 and half of the stations of cluster 1 of the cnc given this the cnc seems to provide a more detailed local disaggregation with spatial coherence this observation is corroborated for stations near the center west north border where the cnc grouped the stations in cluster 4 whereas pcac divided the stations between clusters 1 and 2 for the second period resulting in stations very close to each other in different clusters similar behaviour is observed in the third period of the cnc as a more coherent spatial pattern is observed for stations localized in the center west region the spatial dispersion of complete series showed remarkable similarity to both methodologies clustering results similarity that was corroborated by the nmi metric where the complete series showed the highest value of all periods analysed 0 8 nmi results also reflected the differences observed between the two clustering techniques in the three time windows analysed providing values of 0 54 0 64 0 49 for the first second and third period respectively 4 discussion the proposed network construction methodology yielded reliable results for the sw30 presenting stable communities within close time windows smaller fluctuations of the modularity values when compared to the sw20 and network typologies that did not follow a random distribution however the histogram plot of the degree distribution of the csn shared some resemblance to a random network this result is similar to that reported by halverson and fleming 2015 the larger similarity value observed for the csn can be explained by the csn s more densely connected graph the dense graph was a result of time window delimited correspondent behaviour between the stations the same behaviour that produced different communities across time a time window delimited correspondence that does not stand for the complete series produces a link with a comparably smaller mi value the consistent spatial dispersion obtained for the csn indicates that the use of weighted networks can successfully diminish the impact of comparably weaker connections to result in a network that represents the local behaviour however both the nmi results and the spatial dispersion of the communities show that significant variations of the communities can occur across time and therefore the use a single network can result in a misrepresentation of local characteristic and lead to wrong conclusions therefore a densely connected graph produced using the proposed methodology may indicate that the time window used does not correctly represent the network s local characteristics the pcac also presented changes in the clustering results across time although in a more discrete way corroborating the conclusion that one cluster analysis for the complete series is not recommended when dealing with non stationarity timeseries the fact that the highest similarity between both techniques was observed for the complete series raised concerns regarding pcac results the cnc results for this period were more fragile than the remaining networks analysed since this network s typology was the closest to a random network even though the cnc framework could successfully diminish time delimited effects this observation combined with the more coherent spatial dispersion of cnc results is in synergy with the conclusion of work by joo et al 2020 and halverson and fleming 2015 that the cnc methodology is a strong alternative to classic methods and can obtain a more effective clustering in this study we used two fixed time windows sw30 and sw20 and obtained good results with the sw30 the stability of the sw20 community results was certainly affected by the smaller time window and the discretization procedure the discretization process further reduces statistical significance due to the comparison of the streamflow event t with the previous t 1 and next t 1 events ending with only 18 observations for each time window therefore time windows smaller than 20 years do not seems feasible while a middle range 25 years can possibly yield good results further studies are needed to improve the selection process to determine the appropriate time window the spatial pattern obtained in this work agrees with the reported influence of the south atlantic convergence zone sacz on local streamflow lima and lall 2010 rocha and de souza filho 2020 rocha and de souza filho 2020 associated step changes observed in brazilian streamflow series to the impacts of the phase shift of low frequency sst oscillations in the sacz the sacz extends from the southeast to the north region of brazil in a straight line pattern with some variations in its extension and north south displacements the cluster 1 pattern obtained for the csn shows remarkable similarities to the sacz spatial extension the cluster evolution corroborates the low frequency influence of the sacz in the communities detected chiessi et al 2009 observed southward displacements of the sacz during cold phases of the atlantic multidecadal oscillation amo similar displacement was observed in the cluster evolution a cold phase of the amo occurred around 1964 to 1994 enfield et al 2001 rocha and de souza filho 2020 most of time windows in the second configuration belonged to a cold phase of amo time windows with initial years between 1956 and 1976 similarly half of the years of the third representative time window 1980 2009 occurred within the same cold phase the initial year of the third configuration is also consistent with the changes reported in the streamflow series and a cold warm phase shift of the pacific decadal oscillation pdo that occurred around the same year 1976 the 1975 phase shift of the pdo has been associated with more frequent and intense el niño events keller et al 2009 cavalcanti 2009 argue that the el niño southern oscillation enso may be a possible factor in the persistence of the sacz therefore the years that delimit the similar time windows seem to be influenced by both the pdo and amo phases indicating a strong low frequency impact on the relationship between the stations which agrees with results reported by rocha and de souza filho 2020 finally bridge closeness presented good results in determining the stations that shared similarities outside their community diverse stations classified as bridges presented changes in their community of belonging across time which agrees with the results obtained using bridge closeness metric also the area characterized as a transition zone matches the findings of lima and lall 2010 and rocha and de souza filho 2020 the threshold selection of bridge closeness relies on the analysis of the metric s value distribution although the threshold selected led to good results in this work further studies specifically analyzing streamflow networks will be useful to establish a standard selection procedure which was not the goal of this article 5 conclusions in this paper we presented an application of a clustering framework aimed to deal with non stationary and non linear series characteristics commonly found in streamflow timeseries the framework constructs weighted complex networks to detect and analyse changes in communities across time the weighted network construction was based on mi combined with a threshold selection through mcmc bootstrapping simulations the communities detected for the network obtained for the entire time series were compared to the results of networks constructed using sliding windows of 30 and 20 years a more in depth analysis was made to the representative time periods networks and for the complete series network bridge closeness was used to detect nodes that act as a bridge between different communities sharing similarities with nodes outside their own community finally the results were compared to a classic clustering approach based on principal components analysis the weighted network construction procedure presented consistent results obtaining networks with coherent spatial dispersion of their communities and degree distributions that did not fit a random network typology the use of a weighted network effectively diminished the impact of weaker connections that were a result of time delimited similarities between the stations this led to the successfully obtaining a network for the entire series that could represent the local overall behaviour however the comparison of the results with the 30 year sliding windows networks demonstrated that significant changes occurred across time and that the use a single network can result in a misrepresentation of local characteristic and promote wrong conclusions the 20 year sliding window did not present consistent results due to its reduced statistical significance and the discretization procedure used for the mutual information calculation the network based clustering seemed to provide a more detailed and coherent spatial dispersion of the clusters in comparison to the results obtained based on a principal component analysis clustering this observation is in concordance with previous studies indicating that the network based methodology is a strong and possibly superior alternative to classic methods the nmi community comparison metric successfully detected the presence of different community configurations three different configurations were observed and the communities evolution across time showed spatial time coherence with both the physical phenomenology of the study area and previous studies the changes were associated to phase shifts of low frequency sea surface temperature oscillations of both the atlantic amo and the pacific pdo oceans both of these low frequency patterns affected the stations relationship through their direct and indirect influence on the sacz the bridge closeness metric presented good results successfully identifying stations that presented changes in their respective community across time and characterizing a coherent transition zone between different communities this combined with the solid results obtained shows that the proposed framework can successfully be used to cluster and further analyse the results not only for streamflow gauges but also for any data with nonlinear and nonstationary characteristics however further studies are required to develop a standard selection procedure for a threshold value of this bridge closeness metric the use of this metric is one of the possibilities that emerges from the use of complex networks and demonstrates the potential of network based studies in the field of hydrology funding this study was financed in part by the coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 credit authorship contribution statement renan vieira rocha conceptualization methodology software visualization writing original draft francisco de assis de souza filho conceptualization validation writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128773 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2621,stream gauge clustering enables diverse studies such as the analysis of spatial patterns and the physical reasons for these patterns the clustering of monitoring gauges through complex networks combined with community detection algorithms is a strong alternative to classical methods however this approach involves several particularities that impact the clustering results and the non stationarity commonly present in streamflow series is typically not accounted for in studies that use this methodology this article presents the application of a new framework developed to cluster stream gauge stations and to analyse changes in the clustering results across time weighted networks were created through mutual information combined with an automated threshold complex networks were obtained for the entire series and for sliding windows to investigate if significant differences occur across time a more in depth analysis was carried out with selected time windows through the perspective of network science and complex network analysis and the results were compared to those from a classic clustering approach the framework provided robust and physically coherent clustering results and a more detailed clustering result than the classic approach the weighted networks construction procedure successfully diminished time delimited effects induced by non stationarity however the sliding windows networks results demonstrated that significant changes occurred across time and three different community configurations were obtained these results indicate that the use a single network can result in a misrepresentation of local characteristic and lead to wrong conclusions the communities evolution across time showed spatial time coherence with both the physical phenomenology of the study area and previous studies the changes observed were associated with phase shifts of low frequency sea surface temperature oscillations of both the atlantic and the pacific oceans through the phase shifts direct and indirect influence on the south atlantic convergence zone the in depth analysis resulted in the identification of a spatially coherent transition zone within the clusters obtained and attested the reliability of the framework results based on network typologies thus the proposed framework can aid in clustering problems and provide better comprehension of local characteristics although the framework was developed for stream gauge clustering its use can be extended to the clustering of any data with nonlinear and nonstationary characteristics keywords non linearity network science mutual information hydrologic regionalization climate variability community detection 1 introduction stream gauge station clustering is important to identify stations that exhibit similar seasonal interannual or other temporal variability mcmanamay et al 2014 sun et al 2015 the analysis of stream gauge clustering facilitates the study of the physical reasons behind observed similarities such as teleconnections and climate forcing dickinson et al 2019 ivancic and shaw 2017 the grouping results also enable the analysis of spatial patterns and of the extension of stations that display similar or opposite behaviour han et al 2020 mccabe and wolock 2014 ridolfi et al 2016 yang et al 2019 yoo et al 2011 essential information when dealing with the operation of an interconnected system of reservoirs finally clustering methodologies can reduce the dimensionality of the streamflow modelling process lima and lall 2010 allowing for a more in depth analysis using fewer stations than were originally selected to represent the different regional behaviours this is key to facilitate the study of stream gauge dynamics as streamflow modelling often requires complex methodologies to deal with the nonlinearity present in streamflow time series the clustering problem however is not simple or straightforward on the contrary it involves a variety of methodological considerations a diverse range of clustering methodologies exist each one with its own particularities thus the selection of the adequate number of clusters can involve the use of dendrograms quantitative indices and or plot analysis charrad et al 2014 the diversity of techniques presented in the literature illustrates that the clustering problem is on going and has room to be improved fang et al 2017 halverson and fleming 2015 han et al 2020 konapala and mishra 2017 rodríguez alarcón and lozano 2019 recent field related studies use complex networks and community detection to cluster rainfall and stream gauges a methodology derived from social network analysis that has become an increasingly popular alternative to classical methods han et al 2020 joo et al 2020 this methodology involves two steps 1 the creation of a network with the aid of a similarity metric to determine the links between the nodes that represent the stations and 2 the use of a community detection algorithm to group similar stations into a community i e cluster the results obtained in recent studies emphasize the effectiveness of the use of complex networks and community detection for stream gauge clustering joo et al 2020 concluded that community detection was superior to the well established k means technique providing a more effective clustering in terms of hydrologic similarity persistence and connectivity than the k means technique additionally halverson and fleming 2015 observed that the communities obtained using community detection resulted in a befitting regional spatial dispersion with stream gauges of the same community presenting similar seasonality patterns in this case the communities detected were also able to capture physical characteristics such as drainage area and elevation where stations with similar characteristics belonged to the same community despite the utility of using complex networks and community detection for stream or rainfall gauge clustering few studies have applied the methodology for this objective agarwal et al 2019 2018 halverson and fleming 2015 han et al 2020 joo et al 2021 2020 kim et al 2019 rodríguez alarcón and lozano 2019 this is expected since the use of complex networks in hydrology related studies is an emerging area of research sivakumar and woldemeskel 2014 and the clustering objective is only one particular use of complex networks also the application of complex network has only recently emerged across different fields of studies following advances related to small world networks watts and strogatz 1998 scale free networks barabási and albert 1999 network motifs milo et al 2002 and the modularity concept newman and girvan 2004 these advances allow for a better representation of real world networks that violates the assumptions made in previous studies based in random graph theory further studies are required to fully comprehend the details involved in the application of complex networks for hydrology related studies including stream gauges clustering the two step methodology described above involves several considerations such as the selection of the similarity metric used in network creation which can significantly change the clustering results for example correlation is commonly used as a similarity metric when creating networks fang et al 2017 halverson and fleming 2015 joo et al 2020 scarsoglio et al 2013 sivakumar and woldemeskel 2014 yet mutual information mi has been shown to obtain better results than correlation for nonlinear physical processes donges et al 2009 donges et al 2009 including nonlinear rainfall patterns kim et al 2019 these results may not be captured by classical linear methods donges et al 2009 in a comparison study of correlation and mi for instance donges et al 2009 observed a high degree of similarity in two of the scales analysed but a larger difference for the third one supporting the use of mi when working with nonlinear physical processes donges et al 2009 thus using mi as similarity metric for the construction of complex networks of stream gauges emerges as a natural solution to deal with the nonlinearity present in streamflow series the selection of the threshold of the similarity metric is another key factor in network creation the threshold value controls which links are created among the different nodes of the network the threshold value can significantly impact the resulting network fang et al 2017 sivakumar and woldemeskel 2014 diverse selecting approaches can be found in the articles cited above ranging from the direct use of different thresholds values to the selection of a threshold that produces a fitting value of a complex network analysis metric such as edge density or modularity these metrics are obtained after the application of the community detection algorithm embedding in the network structure the uncertainty involved in the community detection given the variety of threshold selection methods and the fact that the threshold value can significantly impact the network obtained further studies are needed to establish a robust threshold selection method the use of unweighted and weighted networks must also be considered in network creation although halverson and fleming 2015 argue that the use of weighted networks can enhance the results obtained in clustering analyses weighted networks are not common in studies examining streamflow data in the present study we propose that a combination of weighted networks and an automated approach for threshold selection may be a viable solution to provide a robust network creation framework where the weight of the network would reduce the impact of eventual links created between nodes that do not present a high degree of similarity the presence of non stationarity in streamflow data can alter the conclusions drawn from the network obtained as these conclusions may not be valid for the entire time series but rather for only a determined period although non stationarity is commonly mentioned in hydrological studies deb et al 2019a 2019b rocha and de souza filho 2020 to the best of our knowledge it has not yet been considered in studies that use community detection for clustering the use of complex networks also allows network science theory and complex network analysis to be used to characterize the type of the network obtained and to analyse the obtained network s stability efficiency and robustness important aspects when dealing with a system of monitoring gauges agarwal et al 2018 halverson and fleming 2015 sivakumar and woldemeskel 2014 additionally network nodes can be classified in terms of their role in their community enabling the analysis of transition zones between the clusters and other possibilities jones et al 2019 in this article we present the application of a framework developed to incorporate all factors mentioned above and effectively deal with the non stationarity and non linearity commonly found in streamflow series weighted networks were obtained using mi with a threshold selection based on monte carlo markov chain mcmc bootstrapping simulations it was evaluated whether this methodologic decision can reduce the subjectivity involved in the threshold selection networks for the entire series and for sliding windows of 30 and 20 years were obtained and the clustering results were compared to determine if changes occurred across time and if this approach could identify and deal with non stationary effects select time periods and the complete series networks were chosen for a more in depth analysis from the perspective of network science and complex networks analysis to verify the networks typologies and clustering quality this analysis was complemented by the application of a novel complex network analysis metric called bridge centrality jones et al 2019 to analyse the existence of transition zones between the clusters finally the results were compared to a commonly used clustering technique based on principal components analysis the framework successfully reduces the subjectivity involved in threshold selection and incorporates the non stationarity of the series using sliding windows diminishing time delimited effects with the use of the weighted networks it provides robust and physically coherent clustering results that can be further evaluated using network science and complex network analysis to define the clusters properties investigate the existence of transition zones and better understand other network characteristics consequently the proposed framework can aid in clustering problems and increase comprehension of local characteristics while the framework is applied to stream gauge clustering in this study its use may be extended to the clustering of any data with nonlinear and nonstationary characteristics 2 data and methodology this section is divided in six subsections the first subsection presents the context on this research and the data used subsections 2 2 to 2 5 describe the methodology used to obtain the complex networks with the aid of the mi metric and the mcmc threshold selection 2 2 detect the communities 2 3 analysis the communities structure and how they evolve through time 2 4 and perform an in depth analysis of selected complex networks from the perspective of complex network analysis and network science theory 2 5 see fig 1 for flowchart of the methodologic steps the last subsection reviews the classic methodology used to compare the clustering results 2 1 study area background and data brazil was selected as study area based on national and local relevance as well as the non stationarity observed at gauge stations given the country s dependence on the production of hydropower electricity it is crucial to better understand national streamflow data at least two recent studies applying different techniques observed the non stationarity present at various stations rocha and de souza filho 2020 rolim and filho 2020 making the series appropriate for the application of the proposed framework the analysis and identification of eventual changes in the relationship of the stations has local relevance since a stationarity relationship between the stations is typically assumed for the development of projections scenarios and streamflow forecasting cepel 2012 we used monthly naturalized streamflow data of 88 stations located across brazil with a higher concentration in the southeast and southern regions of the country regions that are responsible for the majority of the country s hydropower production the naturalization process is described in detail by ons 2017 and aims to remove anthropogenically derived factors that modify the natural variability of the streamflow process annual naturalized streamflow from 1931 to 2015 was obtained by averaging monthly values according to the hydrologic year the use of annual streamflow data aims to cluster stations with similar interannual variability diminishing seasonal oscillations we find that interannual clustering can provide relevant information for long term energy production projections the annual average precipitation temperature and streamflow is presented in the supplemental files along with spatial plots although not analysed in this work we find that this information better characterizes the area of study and the stations 2 2 complex network analysis through mutual information and mcmc threshold selection a network represents the relationship between the selected variables nodes or vertices through directed or undirected connections links or edges therefore a network can be expressed as g v e with v representing a set of n nodes v 1 v 2 v n and e a set of n edges the link creation between two nodes relies on theorical assumptions based on the expertise of the researchers or on similarity metrics combined with a threshold criterium mutual information mi measures the mutual dependency of two variables and is sensitive to non linear dependencies as non linear dependencies cannot be detected by simpler metrics e g linear correlation coefficient mi acts as a measure of true dependence kraskov et al 2004 the construction of a network based on mi results in an undirected network mi is a function of entropy and exact computation is only considered feasible for discrete variables and special cases with known probabilities distribution belghazi et al 2018 in this paper we used a discretization approach via the r package muti scheuerell 2017 with the default five symbolic representations of the streamflow annual series 1 q t 1 q t q t 1 p e a k q t 1 q t q t 1 i n c r e a s i n g q t 1 q t q t 1 s a m e q t 1 q t q t 1 d e c r e a s i n g q t 1 q t q t 1 t r o u g h where q t q t 1 and q t 1 are the streamflow event in the timestep t immediately before t 1 and after t 1 respectively the entropy h x of a series x can be calculated using the equation 2 h x e log p x i 1 l p x i log b p x i where p x is a probability mass function l is the length of the time series and b is the logarithm base muti package uses a logarithm of base two measuring the information in units of bits the joint entropy between two series x and y is given by the equation 3 h x y i 1 l p x i y i log b p x i y i where p x i y i is the probability that x x i and y y i finally mi can be calculated and normalized mi through the equations 4 m i x y h x h y h x y 5 mi x y mi x y h x h y normalized mutual information mi ranges between the values of zero and one where a value of one indicates a perfect simultaneous behaviour of series x and y mi results were used to construct a weighted network representing the interrelation between gauge stations each node of the weighted network represents a station and an edge linking one node to another was created if the result was higher than a 95 significance threshold obtained through mcmc bootstrapping the weight of the edge is the mi value and acts as a similarity measure mcmc bootstrapping is performed by obtaining the transition matrix between discrete categories of the x and y time series randomly choosing the initial value and pooling values according to the transition matrix probabilities until a series with the same length is obtained 2 3 community detection for weighted networks despite having similar objectives classical clustering techniques and community detection differ significantly methodologically in a broad sense the communities of complex networks can also be referred as clusters community detection algorithms aim to group nodes that are closely connected and therefore share similar attributes while presenting a certain degree of dissimilarity or independence from the remaining nodes outside of the given community however whereas classical clustering techniques rely exclusively on the direct similarity between time series data community detection is based on both the similarity of the data and network theory joo et al 2020 to optimize the resulting communities most algorithms use the division quality function called modularity modularity was developed to compare the links within the obtained communities to random theoretical connections the concept derives from the idea that if a natural random expected division of the network exists the connection within a community needs to surpass the expected random theoretical value while the connections between communities must be lower than the expected random theoretical value chang et al 2012 the probability of an edge existing between nodes i and j is given by k i k j 2 m where k i is the degree of node i and m is the total sum of the weights of all edges in the network newman 2004 in weighted networks the degree of a given node is the sum of the weights of its links thus 6 k i j a ij m 1 2 i j a ij 1 2 i k i where a ij is the weight of the link between nodes i and j an element of the weighted adjacency matrix a the modularity is then given by 7 q 1 2 m ij a ij k i k j 2 m δ c i c j where δ c i c j is a function that returns one if the community of the node i is equal to node j c i c j and zero otherwise newman 2004 modularity ranges from zero to one with values close to zero expressing a relatively random number of within community edges and values close to one indicating a strong community structure within the network typical values of modularity for real world networks range between 0 3 and 0 7 newman and girvan 2004 and values of about 0 3 or higher indicate good divisions newman 2004 modularity optimization however is not a simple task which has led to the development of diverse algorithms to overcome the inherent complexity although halverson and fleming 2015 did not detect significant disparities between different methodologies de sousa and zhao 2014 found that the walktrap algorithm pons and latapy 2005 leads to better results on average this algorithm is based on the simple assumption that short random walks along the network have a tendency to stay within the same community in this study we applied the walktrap algorithm to optimize modularity and used the r package igraph csardi and nepusz 2006 which was used by both halverson and fleming 2015 and de sousa and zhao 2014 2 4 community changes detection across time to investigate if significant differences occur across time the communities detected for the network obtained for the entire series and the results obtained using sliding windows of 20 and 30 years were compared using five metrics the variation of information vi meila 2003 the normalized mutual information nmi danon et al 2005 split join distance split join van dongen 2000 the rand index rand rand 1971 and the adjusted rand index adjusted rand hubert and arabie 1985 the use of another acronym to refer to the same similarity metric normalized mutual information is to prevent confusion as the metric was applied with two different purposes to extract the amount of information within two streamflow time series mi and to quantify the difference within two networks communities nmi the results within the sliding windows were also compared to analyse the different configurations that occurred across time and to check the stability of the communities for this procedure only the metric that produced the best results in the previous step was used the different configurations were obtained with the aid of a hierarchical clustering for each unique community configuration a representative time window was selected based on the metric results within the cluster therefore the time window that presented the highest mean value of the metric was selected as representative for the time windows that belonged to the same cluster 2 5 complex network analysis an in depth analysis was carried out for the network of the entire series and for the networks of the selected time windows first a simple analysis using network science theory was performed to verify if the topologies of the obtained networks were characteristic of a random network while the detection of network communities does not require assumptions regarding the network topology halverson and fleming 2015 a random network typology indicates that the links between the nodes may occur by chance this does not reflect a network constructed based on streamflow variability rather the streamflow variability is a product of climate variability and physical characteristics which impose spatially consistent behaviour therefore a random network typology would raise concerns regarding the reliability of the network construction methodology the network typology was evaluated using the clustering coefficient and by analysing the degree distribution the clustering coefficient c evaluates the tendency of the nodes of a network to cluster together much larger values of c are expected for real networks than for corresponding random network with the same number of nodes and links c c random weighted networks require a slightly different calculation of this metric to correctly include the weights of the network in this work the method presented by barrat et al 2004 was used the degree of a node corresponds to the number of connections that node has with other nodes complex network theory states that the degree distribution of a random network follows a binomial distribution therefore the histogram comparison between the obtained network and the corresponding random network allows for the analysis of the network typology bridge closeness was used to analyse transition zones between the different communities bridge closeness evaluates the average distance between a node and other nodes outside of the specified node s community jones et al 2019 the distance between nodes of an unweighted network corresponds to the shortest path between two nodes i e the number of edges in weighted networks the weights are interpreted according to theoretical concepts for example the classic dijkstra algorithm interprets the weights as costs when finding the shortest paths among nodes in this case the distance needs to be based on the inverse of the edge weights to act as a measure of similarity bridge closeness is calculated using the inverse of the average distance between nodes nodes with higher values of bridge closeness act as a bridge transition between communities as they are more likely to share common attributes with different communities than nodes with lower values of this metric to decide which node act as a bridge jones et al 2019 suggest the evaluation of the metric s distribution through a preliminary analysis we decided to consider the stations with the ten highest values as bridges resulting in a more restrictive threshold 11 than used by jones et al 2019 after theoretical simulations 20 highest values no significant changes were observed when considering other bridge centrality metrics i e strength betweenness and expected influence the results were obtained using the r package networktools 2 6 comparison with a classical clustering technique the results for the selected time windows were compared to the results obtained through principal components analysis pca a widely used clustering method the streamflow series were analyzed using ten principal components that explained more than 80 of the variance of the series in the preliminary tests a hierarchical clustering was applied to the pca results the number of clusters was selected by cutting the hierarchical tree into the partition that resulted in the highest relative loss of inertia this process was performed with the aid of the r package factominer lê et al 2008 the spatial dispersion of the clusters was compared to previous results and the nmi was used to quantify the difference between the cluster results 3 results 3 1 community changes detection across time all five metrics suggested changes in the communities across time when used to compare the results obtained for the complete series network csn to both sliding windows networks the nmi was adopted as reference for this work since it has a range within a defined interval 0 to 1 and the values obtained showed significant variation along the scale the five metrics presented similar patterns and are presented in the supplemental files the communities obtained for the csn shared more similarities with the communities obtained using the 30 year sliding window sw30 than with those obtained with the 20 year sliding window sw20 fig 2 the highest nmi values were obtained for the sw30 with starting years between 1961 and 1976 sw20 showed increasing similarity from 1955 until about 1985 with low values after 1985 in concordance to the results obtained for the sw30 fig 2 also presents the modularity of the networks obtained the modularity values of the sw20 exhibited a high variation across time ranging from 0 26 to 0 63 with a strong v shaped pattern between 1946 and 1961 the modularity of sw30 presented a steady oscillation between 0 36 and 0 56 without a significant shift the modularity of the csn was 0 44 these results indicate that the communities obtained for the sw20 presented strong variations within small changes of the sliding windows which can result in a fragile stability of the communities the continuous results of the nmi of the networks created using sliding windows fig 3 left corroborate the observed fragile stability for the sw20 communities the similarities between close windows show a fast decrease within a small number of years for the sw20 on the other hand the sw30 shows a marked cohesion for several years without large oscillations indicating a stronger stability of the communities obtained the hierarchical clustering analysis of the nmi results between the sliding windows resulted in four clusters for the sw20 and three for the sw30 fig 3 right these clusters were selected through the analysis of the different cluster configurations detailed in table 1 the clusters found for sw30 exhibit a stronger cohesion than the sw20 clusters as diverse periods grouped together do not have high nmi values for the latter however the sw30 also presented time windows with abnormally low nmi values within the same cluster which is clearly noticeable for the windows starting in the years 1938 and 1939 for the first cluster between 1973 and 1976 in the second and between 1984 and 1986 in the third for the second cluster the years mentioned are close to the start of the third cluster and delimit a transition between the two clusters the years mentioned for the first and third clusters are close to the limits of the series and suffers from border effects which suggests a previous and forthcoming configuration before the first cluster and after the third one respectively the years of change in the clusters of both sliding windows share some resemblance and occur close to the years of 1956 and 1980 the fragile stability observed for the communities detected for the sw20 raised concerns regarding the reliability of sw20 results thus the sw20 clusters were discarded and only sw30 results were considered for the remaining analysis 3 2 complex network analysis and spatial dispersion the clustering coefficient results and histogram plot analysis indicate that none of the selected networks presented a random network typology table 2 fig 4 the csn was the most similar to the random network compared to the other time window networks the clustering coefficient of the csn had the smallest difference in comparison to the correspondent random network value only 1 75 times the c random value where the remaining time windows were close to 3 times the c random the histogram plots corroborate these conclusions fig 4 none of plots follow the equivalent random distribution while the csn shares the most similarities with the random distribution the spatial dispersion of the communities is shown in fig 5 where the evolution of the communities is presented in fig 6 notably most southern stations remained in the same cluster 3 for all the periods analysed one station itaipu was considered a bridge station given the bridge closeness criteria this classification was in concordance with the community results since the station belonged to different communities across the time windows reinforcing the similarities shared with diverse stations another station belonged to cluster 2 throughout the different periods cluster 3 presented the largest changes in the third period 1980 2009 fig 5c with the presence of additional stations in the midwest and northern regions cluster 3 showed smaller changes across the other periods the remaining clusters showed more significant changes especially when compared to the first time window 1934 1963 fig 5a the major differences were delimited to clusters 4 and 5 the significant relevance of cluster 4 in the first period translates to a small presence concentrated in the northern region for the second period 1969 1998 fig 5b mostly due to the western expansion of cluster 2 combined with a southwest displacement of cluster 1 this displacement comprised the stations that belonged to clusters 5 and 6 also resulting in a migration of cluster 1 stations to cluster 2 the previously observed movements continue in the third period with cluster 1 exhibiting a western expansion comprising the remaining stations of cluster 4 and cluster 2 absorbing diverse cluster 1 stations the mentioned cluster 3 expansion comprised some stations of the cluster 1 the cluster evolution across these three periods indicates a reduction of the different variability patterns across time resulting in three large spatially consistent patterns both the second and third periods presented a station that did not belong to any community the csn 1931 2015 fig 5d has a similar spatial concentration of the bridge stations the southeast area close to the lower limits between the midwest and the southeast regions seems to act as a transition zone since it concentrated most of the bridge stations the bridge classification could also detect stations that presented cluster changes across time it was clear that the csn shared strong similarities with the second period but diverged from the spatial patterns obtained for the first and third periods these results agree with the nmi results and indicate that the csn should not be used to represent the complete series the presence of more links between the stations indicates that the methodology resulted in a more densely connected graph for the csn which was corroborated by the network plot found in the supplemental files 3 3 pca results comparison fig 7 presents the results for the pca clustering pcac the spatial dispersion for the selected time windows resembles the complex network clustering results cnc most of the southern stations of the pcac remained in the same cluster for all periods analysed one southern station belonged to cluster 1 across time in concordance with the cnc results stations closer to the northwest region did not show many changes for the complete series or the second and third periods for these time windows the changes were mostly concentrated in the north center west and southwest region in concordance with the cnc for the first period cluster 1 of the pcac encompasses all stations of clusters 2 4 and 6 and half of the stations of cluster 1 of the cnc given this the cnc seems to provide a more detailed local disaggregation with spatial coherence this observation is corroborated for stations near the center west north border where the cnc grouped the stations in cluster 4 whereas pcac divided the stations between clusters 1 and 2 for the second period resulting in stations very close to each other in different clusters similar behaviour is observed in the third period of the cnc as a more coherent spatial pattern is observed for stations localized in the center west region the spatial dispersion of complete series showed remarkable similarity to both methodologies clustering results similarity that was corroborated by the nmi metric where the complete series showed the highest value of all periods analysed 0 8 nmi results also reflected the differences observed between the two clustering techniques in the three time windows analysed providing values of 0 54 0 64 0 49 for the first second and third period respectively 4 discussion the proposed network construction methodology yielded reliable results for the sw30 presenting stable communities within close time windows smaller fluctuations of the modularity values when compared to the sw20 and network typologies that did not follow a random distribution however the histogram plot of the degree distribution of the csn shared some resemblance to a random network this result is similar to that reported by halverson and fleming 2015 the larger similarity value observed for the csn can be explained by the csn s more densely connected graph the dense graph was a result of time window delimited correspondent behaviour between the stations the same behaviour that produced different communities across time a time window delimited correspondence that does not stand for the complete series produces a link with a comparably smaller mi value the consistent spatial dispersion obtained for the csn indicates that the use of weighted networks can successfully diminish the impact of comparably weaker connections to result in a network that represents the local behaviour however both the nmi results and the spatial dispersion of the communities show that significant variations of the communities can occur across time and therefore the use a single network can result in a misrepresentation of local characteristic and lead to wrong conclusions therefore a densely connected graph produced using the proposed methodology may indicate that the time window used does not correctly represent the network s local characteristics the pcac also presented changes in the clustering results across time although in a more discrete way corroborating the conclusion that one cluster analysis for the complete series is not recommended when dealing with non stationarity timeseries the fact that the highest similarity between both techniques was observed for the complete series raised concerns regarding pcac results the cnc results for this period were more fragile than the remaining networks analysed since this network s typology was the closest to a random network even though the cnc framework could successfully diminish time delimited effects this observation combined with the more coherent spatial dispersion of cnc results is in synergy with the conclusion of work by joo et al 2020 and halverson and fleming 2015 that the cnc methodology is a strong alternative to classic methods and can obtain a more effective clustering in this study we used two fixed time windows sw30 and sw20 and obtained good results with the sw30 the stability of the sw20 community results was certainly affected by the smaller time window and the discretization procedure the discretization process further reduces statistical significance due to the comparison of the streamflow event t with the previous t 1 and next t 1 events ending with only 18 observations for each time window therefore time windows smaller than 20 years do not seems feasible while a middle range 25 years can possibly yield good results further studies are needed to improve the selection process to determine the appropriate time window the spatial pattern obtained in this work agrees with the reported influence of the south atlantic convergence zone sacz on local streamflow lima and lall 2010 rocha and de souza filho 2020 rocha and de souza filho 2020 associated step changes observed in brazilian streamflow series to the impacts of the phase shift of low frequency sst oscillations in the sacz the sacz extends from the southeast to the north region of brazil in a straight line pattern with some variations in its extension and north south displacements the cluster 1 pattern obtained for the csn shows remarkable similarities to the sacz spatial extension the cluster evolution corroborates the low frequency influence of the sacz in the communities detected chiessi et al 2009 observed southward displacements of the sacz during cold phases of the atlantic multidecadal oscillation amo similar displacement was observed in the cluster evolution a cold phase of the amo occurred around 1964 to 1994 enfield et al 2001 rocha and de souza filho 2020 most of time windows in the second configuration belonged to a cold phase of amo time windows with initial years between 1956 and 1976 similarly half of the years of the third representative time window 1980 2009 occurred within the same cold phase the initial year of the third configuration is also consistent with the changes reported in the streamflow series and a cold warm phase shift of the pacific decadal oscillation pdo that occurred around the same year 1976 the 1975 phase shift of the pdo has been associated with more frequent and intense el niño events keller et al 2009 cavalcanti 2009 argue that the el niño southern oscillation enso may be a possible factor in the persistence of the sacz therefore the years that delimit the similar time windows seem to be influenced by both the pdo and amo phases indicating a strong low frequency impact on the relationship between the stations which agrees with results reported by rocha and de souza filho 2020 finally bridge closeness presented good results in determining the stations that shared similarities outside their community diverse stations classified as bridges presented changes in their community of belonging across time which agrees with the results obtained using bridge closeness metric also the area characterized as a transition zone matches the findings of lima and lall 2010 and rocha and de souza filho 2020 the threshold selection of bridge closeness relies on the analysis of the metric s value distribution although the threshold selected led to good results in this work further studies specifically analyzing streamflow networks will be useful to establish a standard selection procedure which was not the goal of this article 5 conclusions in this paper we presented an application of a clustering framework aimed to deal with non stationary and non linear series characteristics commonly found in streamflow timeseries the framework constructs weighted complex networks to detect and analyse changes in communities across time the weighted network construction was based on mi combined with a threshold selection through mcmc bootstrapping simulations the communities detected for the network obtained for the entire time series were compared to the results of networks constructed using sliding windows of 30 and 20 years a more in depth analysis was made to the representative time periods networks and for the complete series network bridge closeness was used to detect nodes that act as a bridge between different communities sharing similarities with nodes outside their own community finally the results were compared to a classic clustering approach based on principal components analysis the weighted network construction procedure presented consistent results obtaining networks with coherent spatial dispersion of their communities and degree distributions that did not fit a random network typology the use of a weighted network effectively diminished the impact of weaker connections that were a result of time delimited similarities between the stations this led to the successfully obtaining a network for the entire series that could represent the local overall behaviour however the comparison of the results with the 30 year sliding windows networks demonstrated that significant changes occurred across time and that the use a single network can result in a misrepresentation of local characteristic and promote wrong conclusions the 20 year sliding window did not present consistent results due to its reduced statistical significance and the discretization procedure used for the mutual information calculation the network based clustering seemed to provide a more detailed and coherent spatial dispersion of the clusters in comparison to the results obtained based on a principal component analysis clustering this observation is in concordance with previous studies indicating that the network based methodology is a strong and possibly superior alternative to classic methods the nmi community comparison metric successfully detected the presence of different community configurations three different configurations were observed and the communities evolution across time showed spatial time coherence with both the physical phenomenology of the study area and previous studies the changes were associated to phase shifts of low frequency sea surface temperature oscillations of both the atlantic amo and the pacific pdo oceans both of these low frequency patterns affected the stations relationship through their direct and indirect influence on the sacz the bridge closeness metric presented good results successfully identifying stations that presented changes in their respective community across time and characterizing a coherent transition zone between different communities this combined with the solid results obtained shows that the proposed framework can successfully be used to cluster and further analyse the results not only for streamflow gauges but also for any data with nonlinear and nonstationary characteristics however further studies are required to develop a standard selection procedure for a threshold value of this bridge closeness metric the use of this metric is one of the possibilities that emerges from the use of complex networks and demonstrates the potential of network based studies in the field of hydrology funding this study was financed in part by the coordenação de aperfeiçoamento de pessoal de nível superior brasil capes finance code 001 credit authorship contribution statement renan vieira rocha conceptualization methodology software visualization writing original draft francisco de assis de souza filho conceptualization validation writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128773 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2622,evapotranspiration et plays an important role in land surface processes and global climate et cannot be observed directly at a large scale and its spatial distribution is mainly obtained by et models at present however the application of existing et models is greatly hampered by a number of plant functional type pft specific empirical parameters and the difficulty in partitioning the contribution of et from the canopy and soil to this end an eco evolutionary optimality based evapotranspiration model eeoet was developed in this study with some schemes used in the noah mp land surface model the principle of eco evolutionary optimality expresses the underlying acclimation adaption of plants to diverse environments and thus greatly reduces the number of pft specific parameters the noah mp provides schemes to partition the energy between the canopy and soil and to calculate photosynthetic and et resistances owing to the above the eeoet model which has enhanced mechanisms and fewer pft specific parameters requires inputs of daily land surface temperature vegetation related data leaf area index and fractional vegetation and soil information soil texture and soil water content in addition to routine meteorological data the model output is daily et global evaluation across 74 fluxnet sites indicates that the model is capable of reasonably estimating et for all pfts and is also comparable to existing models that require more tunable parameters in addition the eeoet model is less sensitive to uncertainties in the input data than other models making it a more robust solution for estimating et under various conditions keywords evapotranspiration land surface modeling eco evolutionary optimality principle noah mp data availability data will be made available on request 1 introduction evapotranspiration et a key component of the energy and water cycle is the link between the atmosphere hydrology and ecology accurate et monitoring is vital for crop yield prediction ecosystem monitoring and water resource management especially in regions with limited water resources however the spatial representativeness of eddy covariance ec observations is limited with a footprint of hundreds of meters the large aperture scintillometer las provides the area averaged sensible heat flux and et can be calculated using the energy balance equation meijninger et al 2002 liu et al 2011 although the las provides measurements with a larger footprint few kilometers it is costly as an operational approach at a large scale hence mapping the et distribution only by ground based measurements is impossible in contrast it is feasible to estimate regional et from meteorological and land surface variables which are much easier to obtain because of the large uncertainties from the model s structure and empirical parameters pitman et al 1999 as well as high dependence on meteorological forcing data the et simulations from land surface models such as the community land model clm bonan et al 2002 and the multi parameterization option version of the noah land surface model noah mp niu et al 2011 cannot meet practical application requirements various et models based on remote sensing observations and meteorological forcing data have been developed in recent decades these et models can be generally divided into two categories temperature based and stomatal resistance based models chen and liu 2020 temperature based models make use of the land surface temperature lst retrieved from satellite sensors to derive et most of these kinds of models calculate the sensible heat flux and treat et as the residual of the surface energy balance equation although these models avoid the complex calculation of transpiration those uncertainties from inputs and parameterization are all responsible for the error in estimated et zou et al 2018 temperature based models can be further divided into single source bastiaanssen et al 1998 chen et al 2013 su 2002 and dual source norman et al 1995 kustas and norman 1997 models the former takes canopy and soil as a whole and assumes that the energy exchange occurs between the atmosphere and land surface therefore it is unable to distinguish the contribution of the canopy and soil the latter usually requires multi angle thermal information from geostationary satellites relevant review can be found in kustas and anderson 2009 for example two view angles in kustas and norman 1997 and six view angles in song et al 2020 however the objects change with the observational angle which leads to great uncertainties and application limitations for broader applications it is worth trying to partition the et components by observations from a single view angle stomatal resistance based models estimate et using vegetation related information whose retrieval is affected little by clouds these models focus upon the calculation of stomatal resistance r s the et process is complicated therefore its estimation relies on many plant functional type pft specific empirical parameterizations for example the mod16 model mu et al 2007 mu et al 2011 requires the calibration of 9 parameters for each pft and this number increases to 11 for the penman monteith leuning pml model zhang et al 2019 zhang et al 2016 however the calibration is affected by land cover classification study area data amount and fitting method too many pft specific parameters may lead to great uncertainty liu et al 2012 hence reducing the number of pft specific empirical parameters without removing the representation of physical processes is the key to improving the model s applicability most pft specific parameters come from the calculation of r s which often lacks a universal principle recent research advances in eco evolutionary optimality eeo principles may help to reduce the number of pft specific parameters in current et models harrison et al 2021 the principle of optimality states that stomata always act to maximize carbon gain from assimilation while minimize water loss from transpiration during a day cowan and farquhar 1977 wang et al 2017 proposed a gross primary production model hereafter p model without any pft related tunable parameter by combining the optimality principle with a biochemical photosynthesis model farquhar et al 1980 the p model assumes a universal optimal behavior of stomata and allows the prediction of leaf internal c o 2 concentration and carbon assimilation rate at weekly scales as an acclimation result of environmental conditions without specifying the local pfts to date the p model has been successfully applied to carbon assimilation simulations plant growth monitoring and crop yield predictions e g qiao et al 2020 ren et al 2021 smith et al 2019 if the optimality principle can be applied to establish an et model there could be a great potential to enhance its physical mechanism and reduce the number of empirical parameters tan et al 2021 combined the p model with the penman monteith equation to estimate weekly et and the results showed good agreement with observations at flux sites this method is not applicable to time scales shorter than a week due to the coordination effect of light and rubisco limited rates of photosynthesis in addition soil evaporation is calculated through an empirical regression nevertheless tan et al 2021 proved that the application of the optimality principle is promising in et estimation in short there are some imperative problems in existing et models to be solved such as too many pft specific empirical parameters and the difficulty in separating the thermal information between canopy and soil leading to limited applications across different pfts ershadi et al 2014 kim et al 2012 feng et al 2015 tang et al 2011 to improve the et model s applicability and reduce the uncertainty from parameter calibration we aim to solve these two problems in this study we proposed a process based et model the eco evolutionary optimality based et eeoet model which has fewer free parameters and incorporates more physical processes by using the eeo principle and the canopy understory radiation budget on the land surface this model targets the et estimation by remote sensing in a dual source framework with lst as input it should be noted that the purpose of this research is proof of concept instead of its application at a regional scale therefore the meteorological data and flux measurements used in this study are from ground based observations the required data in this study introduced in the following section 2 include the in situ measurements vegetation products and soil dataset on this basis the model is developed by combining the eeo principle with the energy partitioning schemes from the noah mp section 3 in section 4 the model is evaluated against in situ measurements and the results are compared to two typical et models section 5 analyzes the effectiveness of improving the accuracy of et estimates by the eeo principle and the model s uncertainties from diurnal variations 2 data and methods in this study et estimations require measurements from fluxnet2015 dataset pastorello et al 2020 including wind speed u m s air temperature t air k vapor pressure saturation deficit vpd hpa air pressure p air k p a downward longwave and shortwave radiation r ld and r sd w m 2 upward longwave and shortwave radiation r lu and r su w m 2 c o 2 mole fraction μ m o l c o 2 m o l 1 and soil water content θ land surface temperature t sfc k which is inferred from the observed r lu and r ld in this study is also needed furthermore the model requires the leaf area index lai fractional vegetation fveg and soil texture components the observed precipitation p mm is used to select the non rainy days daily latent heat le w m 2 measurements from fluxnet were used to validate the et model 2 1 in situ measurements to reduce the impact of uncertainties in observations fluxnet sites were selected in this study utilizing the following rules 1 the required input variables should be available 2 since the rainfall interception module was not considered yet in this study only the day without rain daily precipitation 0 mm was chosen to avoid the uncertainty caused by the evaporation from canopy interception 3 there are at least 200 available days for each site and 4 each pft contains no less than three sites additionally the θ and le data were selected through the quality control qc flag the instantaneous qc flag values range from 0 to 3 which represent measured 0 filled with high confidence 1 filled with medium confidence 2 and filled with low confidence 3 the instantaneous data with qc flags 2 were treated as good quality in this study the days with no more than 75 good quality instantaneous θ and le data were eliminated the observed daily le from fluxnet was corrected by the bowen ratio method twine et al 2000 to avoid the impact of the observed imbalance on the validation in addition some sites were excluded for significant errors in measurements that were found in previous studies or during our site by site check see the supplementary information text finally 74 sites fig 1 and table s1 in supplementary information met the quality requirement and were classified into nine pfts including grasslands gra 17 sites savannas sav 6 woody savannas wsa 5 evergreen broadleaf forests ebf 3 mixed forests mf 3 deciduous broadleaf forests dbf 13 evergreen needleleaf forests enf 16 open shrublands osh 3 and croplands cro 8 in this study all pfts were treated as c3 plants except cro the cro sites were classified c3 or c4 site by site according to the supplementary document of fluxnet because fluxnet sites do not provide land surface temperature observations the t sfc data at each site were derived using longwave radiation flux data according to the stefan boltzmann law with the effective land surface emissivity obtained by eq 11 below 2 2 vegetation and soil dataset the lai dataset of yuan et al 2011 referred to as lai yuan spans from 2000 to 2016 with a temporal resolution of eight days compared with the original modis lai product the lai yuan product is more continuous and consistent in both time series and spatial domains the 8 day global land surface satellite glass fractional vegetation cover fvc product spans 2000 to 2018 it was generated based on the reflectance obtained from modis and the multivariate adaptive regression splines method jia et al 2015 yang et al 2016 the data are spatially and temporally continuous without gaps and missing values both lai yuan and glass fvc provide products with spatial resolutions of 500 m and 0 05 here we use the 0 05 product for et estimation and the 500 m product for the investigation of the effect of spatial heterogeneity the 8 day lai and fvc products were converted to daily data using linear interpolation the global soil dataset for earth system modeling gsde was made based on the soil map of the world and various regional and national soil databases shangguan and dai 2014 it provides 10 km gridded soil information for eight vertical layers shangguan et al 2014 here the soil texture of the top layer 0 0 045 m was used the values of the pixels in which the sites are located were extracted as the model inputs 2 3 evaluation method of et estimates the estimation results were evaluated with the pearson correlation coefficient r mean bias error mb and root mean square error rmse the models used for pft level performance comparison table a 1 include a process based model the simple terrestrial hydrosphere model hereafter sith zhu et al 2019 and a semi empirical method the priestley taylor model from the jet propulsion laboratory hereafter pt jpl fisher et al 2008 the results of the pt jpl model were calculated using the same sites as the eeoet model while the results for the sith model were obtained from zhu et al 2019 only the non rainy days were selected for all models all compared studies linearly interpolated the 8 day lai and fvc products to daily and the observed et was corrected through the observed bowen ratio twine et al 2000 all compared models were forced with the meteorological data obtained from the fluxnet sites it should be noted that the sites used in zhu et al 2019 and this study were slightly different which was due to the differences in observed elements for each site and the required input variables for each model however the inter comparison was implemented on the pft level instead of the site level the site mean results of each pft were considered representative of the performance for each pft 3 development of the eco evolutionary optimality based et eeoet model in this section an overview of the eeoet model is presented first then the specific modules are described respectively table a 2 shows the model s inputs and fig 2 shows the logic of the eeoet model overall the eeoet model contains two cores 1 the partitioning of the energy between canopy and soil using some schemes in the noah mp section 3 1 and 2 the estimation of stomatal resistance based on the eeo principle section 3 2 the model s sensitivity is shown in section 3 3 the estimation process includes the following steps 1 calculate the parameter k eqs 5 9 ε eff eq 11 r soil eq 12 and φ 0 eq 24 by parameterization schemes 2 estimate j v cmax and c i according to eqs 19 22 3 then calculate gpp based on the eeo principle 16 18 and r s is determined by the ball berry method or fick s law eqs 13 or 15 4 initialize t c and t g and then calculate r nc eqs 2 4 based on the parameters and variables estimated in steps 1 3 iteratively solve the energy balance equation eq 1 and table 1 and longwave radiation budget equation eq 10 to compute t c t g tr and e when the t c difference between two successive steps δ t c is smaller than 0 1 k the iteration is finished 5 the et is determined as the sum of tr and e 3 1 partitioning of energy between the canopy and soil et w m 2 expressed as energy flux in this study usually consists of soil evaporation e and vegetation transpiration tr hence the et of a vegetated pixel can be divided into two parts from the remote sensing perspective fig 3 the vegetation canopy and the soil ground many models solve et in a single source framework bastiaanssen et al 1998 jiang and islam 1999 moran et al 1994 su 2002 which cannot obtain e and tr respectively therefore the first function of our model is to solve the energy balance components within the two media concurrently in a dual source framework the noah mp one of the most widely used land surface models separately considers the energy balance of the canopy and soil in the noah mp the vegetation canopy and soil information can be divided based on the framework of the vege flux module niu et al 2011 yang et al 2011 in this study this framework is modified to enable energy partitioning from a remote sensing perspective the main differences between the eeoet model and the noah mp include 1 the structures differ the noah mp treats a pixel as consisting of bare soil the canopy and the soil beneath the canopy while the eeoet model divides a pixel into the canopy and the soil surface from the viewpoint of remote sensing 2 the equations used for the solution process are partially different the noah mp solves the t c and t g by the energy balance equation of the canopy and soil surface considering the uncertainty in estimating the soil heat flux we use the longwave radiation balance equation instead in this way the t sfc as one of the most accurate land surface variables with mature algorithms is used as input the modified partitioning schemes are as follows for the vegetation canopy the absorbed net radiation r nc w m 2 is allocated to sensible heat h c and latent heat or transpiration which can be described by the energy balance equation 1 r nc t g 4 t c 4 h c t c t r t c 0 2 r nc r snc r lnc 3 r lnc f veg ε v r ld ε v 1 ε v 1 ε g r ld ε v ε g σ t g 4 ε v 1 ε g ε v σ t c 4 2 ε v σ t c 4 4 r snc f veg r sd r su 1 e k l a i f veg where r lnc w m 2 represents the net longwave radiation absorbed by the canopy which is dominated by downward longwave radiation r ld ground temperature t g and canopy temperature t c ε g is the emissivity of the ground 0 98 and the vegetation emissivity is calculated by ε v 1 e 1 1 l a i in the noah mp lai is the leaf area index fveg is the fractional vegetation the calculations of h c and tr require t c see table 1 while that of r nc requires both t c and t g r snc w m 2 is the net shortwave radiation absorbed by the canopy r sd and r su w m 2 represent the downward and upward shortwave radiation respectively k is the extinction coefficient k is usually set as a constant 0 5 or 0 6 actually it is closely related to the canopy structure and the zenith angle of the sun θ sun in the clm k is given as follows 5 k g μ μ 6 μ c o s θ sun where g μ is the relative projected area of leaf and stem elements in the direction θ sun which can be calculated based on the work in goudriaan 1977 as 7 g μ o 1 o 2 μ 8 o 1 0 5 0 633 χ l 0 33 χ l 2 9 o 2 0 877 1 2 o 1 where χ l represents the departure of leaf angles from a random distribution its value under different pfts was taken from dorman and sellers 1989 and listed in table a 3 according to the stefan boltzmann law we can derive the following relationship among t c t g and land surface temperature t sfc k 10 ε eff σ t sfc 4 1 ε v 1 ε g ε v σ t c 4 ε v σ t c 4 1 ε v ε g σ t g 4 f veg ε g σ t g 4 1 f veg with 11 ε eff f veg ε g 1 ε v ε v ε v 1 ε v 1 ε g 1 f veg ε g the formulations of the energy flux components for the vegetation canopy and soil ground are summarized in table 1 et is estimated as the sum of tr and e there are two unknown variables t c and t g and they can be computed by iteratively solving eqs 1 and 10 the above iteration requires the calculation of four resistances aerodynamic resistance r a leaf boundary layer resistance r b soil surface resistance r soil and stomatal resistance r s the r a is estimated following the m o similarity theory and considering the roughness length parameterization under different vegetation coverages the detailed solutions can be found in chen et al 2013 r b is calculated based on k theory using the ragrb module of noah mp the soil surface resistance r soil is parameterized as a function of soil water content θ according to the scheme of hu and jia 2015 12 r soil r soil m i n θ 3 w i t h θ θ θ min θ s θ min where the porosity can be calculated by θ s 0 489 0 00126 s a n d with sand denotes the mass content of sand and r soil min is taken as 50 s m the module of r s estimation where there are many pft specific empirical parameters will be developed by introducing the eco evolutionary optimality principle in section 3 2 3 2 estimation of stomatal resistance 3 2 1 two schemes for the stomatal resistance stomata control both the transpiration and photosynthesis processes of plants usually the estimation of stomatal resistance r s is complicated with a large number of parameterizations involved the eeoet model provides two commonly used methods as options for the r s calculation in the noah mp r s is determined by the ball berry method ball et al 1987 hereafter b b presented as 13 1 r s m gpp c s h s p air 1 r s m a x 14 c s c o 2 1 37 r b g p p r d where h s denotes the relative humidity of the air and r s m a x 2000 s m is the maximum stomatal resistance m is an empirical parameter to relate tr with c o 2 its value is from a look up table in noah mp see table a 3 a larger m indicates more water loss from the tr process when producing the same carbon mass c s p a is the c o 2 partial pressure at the leaf surface derived from fick s law r d μ m o l c o 2 m 2 s is the leaf respiration and gpp μ m o l c o 2 m 2 s is the photosynthesis rate as the other option the r s can also be determined by fick s law to guarantee the mass conservation of c o 2 15 1 r s 1 6 gpp r d c s c i the calculation of gpp requires the rate of electron transport j μ m o l e l e c t r o n s m 2 s maximum rate of carboxylation v cmax μ m o l c o 2 m 2 s and leaf internal c o 2 partial pressure c i pa r d f d v cmax is proportional to v cmax with f d of 0 015 for c3 plants and 0 025 for c4 plants 3 2 2 eco evolutionary optimality eeo principle in noah mp gpp v cmax and c i are determined simultaneously through numerical iteration however there are as many as 10 free parameters relating to each pft during the computation of gpp v cmax and c i here we introduce the p model based on the eeo principle to simplify this calculation process and reduce pft related parameters in the gpp estimation photosynthetic ability is dominated by two limitations light limitation wj and carboxylate limitation or rubisco limitation wc in the p model the gpp is given as the minimum of these factors as 16 gpp m i n w j w c where wj and wc are calculated as follows 17 wj c i γ c i 2 γ j 4 for c3 j 4 for c4 18 wc c i γ c i k c 1 o 2 k o v cmax for c3 v cmax for c4 where γ p a denotes the photorespiratory compensation point of c o 2 bernacchi et al 2001 the oxygen partial pressure o 2 pa equals 0 209 p air k c and k o are the michaelis menten constants for c o 2 and o 2 respectively unlike the noah mp plants are divided into two categories c3 and c4 to represent their photosynthetic pathways in the p model when plants adapt to a changing environment the costs associated with maintaining transpiration and carboxylation capacity are balanced wang et al 2017 based on the acclimation mechanism the j v cmax and c i are treated as functions of environmental variables without any calibrated parameters 19 j 4 i abs φ 0 1 4 i abs φ 0 j max 2 20 j max 4 φ 0 β i abs 1 1 c c i 2 γ c i γ 2 3 1 21 v cmax φ 0 i abs c i k c i 2 γ β 1 c c i 2 γ c i γ 2 3 for c3 φ 0 i abs β 1 c 2 3 for c4 22 c i γ c a γ ξ ξ vpd for c3 0 65 c a for c4 23 ξ 146 k γ 1 6 η 24 φ 0 0 352 0 021 t a 0 00034 t a 2 8 for c3 0 008 0 00375 t a 0 58 10 4 t a 2 for c4 where i abs μ m o l p h o t o n m 2 s 1 is the absorbed photosynthetically active radiation and equals 1 e k l a i p p f d ppfd μ m o l p h o t o n m 2 s 1 is the photosynthetic photon flux density j max μ m o l e l e c t r o n s m 2 s is the maximum rate of electron transport the michaelis menten coefficient for photosynthesis k p a is a function of t air and its solution can be found in farquhar et al 1980 the intrinsic quantum yield parameter φ 0 is modeled as temperature dependent c 0 41 is proportional to the unit carbon cost for the maintenance of electron transport capacity and c a p a is the ambient c o 2 partial pressure the parameter ξ denotes the sensitivity of c i c a to the vapor pressure saturation deficit vpd hpa which is similar to the key parameter in medlyn et al 2011 c i c a was set to a constant for c4 plants tan et al 2021 here the typical value of c i c a for c4 plants was given as 0 65 according to the work in morison and gifford 1983 η is the viscosity of water relative to the value at 25 c huber et al 2009 the soil moisture stress β was expressed as a power function of relative soil water content keenan et al 2009 and the power q is tentatively set to 0 2 25 β θ θ min θ s θ min q the β affects transpiration through a biochemical limitation it reduces v cmax and j max during water stressed periods keenan et al 2010 it should be noted that the stress is not applied to forest sites in this study we tentatively set β to 1 because forests have deep roots to take up the soil water at a deeper layer even in a relatively dry period the energy balance components absorb the errors in β through a complementary effect between tr and e more less tr reduces increases the water vapor gradient between the canopy air and soil surface and further inhibits promotes e from the soil surface therefore the β little affects the et estimates in forests except during extremely dry years another reason is that the observing depth of soil moisture is too shallow to provide stress information in forests in noah mp 10 pft specific parameters are used to estimate gpp while the p model uses two of them and prescribes them as constants shown in table a 4 the original version of the p model wang et al 2017 stocker et al 2020 is applicable at a weekly scale while the noah mp usually simulates at sub daily time scales a new advance in the eeo principle has been made mengoli et al 2022 allowing the estimation of gpp at sub daily scales and pointing out that the j max and v cmax tend to acclimate to the midday meteorological conditions of the last 15 days the instantaneous responses of j max and v cmax were adjusted by the exponential moving average equation the detailed process can be found in mengoli et al 2022 as such the schemes of gpp in the noah mp can be substituted with those in the p model in this way gpp can be calculated without numerical iteration and no pft specific parameter is required to estimate gpp the number of pft specific parameters of the r s estimation in the noah mp schemes is reduced from 10 to no more than one if eq 13 is used only one parameter associated with the pft is retained that is the parameter m this parameter can be further removed if eq 15 is applied therefore the r s dependence on pft related parameters is significantly reduced 3 3 sensitivity of the eeoet model to inputs in practical applications the uncertainty of inputs mainly comes from the retrieval of t sfc and θ and meteorological forcing data thus it is important to understand the model s sensitivity to these inputs hu and jia 2015 investigated the sensitivity of the etmonitor model a stomatal resistance based model to inputs analogous to that work a sensitivity test was performed assuming the same meteorological conditions as the work in hu and jia 2015 the sensitivity of the eeoet model was compared with the sebs model a single source temperature based model su 2002 and the results of hu and jia 2015 the sensitivity of et to a parameter s p is defined as 26 s p 1 2 e t 0 9 r e t 1 1 r e t r where e t r is the et calculated by the input variables that are equal to the reference value p r e t 0 9 r and e t 1 1 r denote the et values calculated by the input variables that are equal to 0 9 p r and 1 1 p r respectively however for t air t sfc e t 0 9 r and e t 1 1 r denote the et values calculated by t air 1 k and t air 1 k t sfc 1 k and t sfc 1 k table 2 shows the sensitivity of the et estimation to main inputs among those inputs the energy related variables significantly influence et estimation because t sfc and u are used for the calculations of et and sensible heat their uncertainties are transferred into the energy balance components as a result the sensitivity of the eeoet model to t sfc 2 8 and u 0 7 is lower than that of the single source temperature based model θ is treated as one of the most uncertain inputs its 10 change causes an 5 3 change in et for the etmonitor model while it only causes a 3 7 change for the eeoet model therefore the lower sensitivity to the parameters for the eeoet model brings more stability in the et estimates when applied to regional or large scales 4 results to understand the model s performance and applicability under different pfts the eeoet model was verified in two parts qualitative evaluation section 4 1 and quantitative validation section 4 2 the qualitative evaluation focused on evaluating the model s ability to partition thermal information and et while the quantitative validation focused on the validation of model performance the impact of surface heterogeneity on the validation is presented in section 4 3 4 1 qualitative evaluation of estimated temperature and et components to exhibit the estimated results nine typical sites were selected from the nine pfts the selection followed the principle that 1 the validated statistics should be close to the median of the corresponding pft and 2 for the convenience of the exhibition the data records should span more than two years using the developed eeoet model t sfc was divided into the canopy temperature t c k and ground temperature t g k as shown in fig s4 the contributions of the canopy and soil to t sfc are diverse for different pfts the difference between t c and t sfc is small when lai is high while the difference between t g and t sfc is small when lai is low for dense vegetation such as croplands and forests there is a negative correlation between t g t sfc and lai which means that increased shadows make the ground cooler for relatively sparse vegetation such as grasslands t c t sfc is larger when lai is low this indicates that as the vegetation becomes denser the canopy s contribution becomes greater while the soil s contribution decreases and vice versa the two year time series of transpiration tr evaporation e and lai fig s5 shows that the trends of tr and lai are similar and almost synchronous which illustrates that tr is significantly influenced by vegetation growth the value of e is very small under dry conditions such as fig s5f with low θ but et can still proceed via the tr process for tall and dense vegetation fig s5b where lai is high et is dominated by tr however for short and sparse vegetation as fig s5h e and tr are comparable to each other under wet conditions before the growing season negative value of evaporation occurs at some sites which correspond to condensation on the soil surface due to moist air 4 2 validation of eeoet estimated daily et the fluxnet dataset provides ec observation records in this study daily et observations with daily precipitation 0 mm were used for validation the validation statistics for 74 sites are presented in table s2 in the supplementary information fig 4 shows the validated results including the medians of r mb and rmse for each pft except for cro the eeoet model performs well for various pfts for the b b method r ranges from 0 72 gra to 0 90 mf and rmse ranges from 16 6 w m 2 osh to 40 0 w m 2 ebf for the fick s law r ranges from 0 67 gra to 0 89 mf and rmse ranges from 14 7 w m 2 osh to 40 5 w m 2 ebf overall the performance of the eeoet model is reasonable the validation was further compared with previous studies that used fluxnet data to estimate and validate daily et as seen in fig 5 the eeoet model with fewer empirical parameters and a complete mechanism provides a comparable performance to the other two models the sith model with four pft related parameters calibrated for each pft performs well with the lowest mb 0 58 w m 2 and rmse 21 4 w m 2 due to the close correlation between environmental variables air humidity and t air and et the pt jpl has a high r value of 0 82 however the determination of environmental constraints in the pt jpl model lacks an ecophysiological mechanism it overestimates et for most pfts with mb and rmse values of 9 8 w m 2 and 34 2 w m 2 respectively the poor performance of the pt jpl model was also found in forests in several studies ershadi et al 2014 yao et al 2021 the r mb and rmse of the eeoet model of the two options are comparable with values of 0 75 2 5 w m 2 and 28 5 w m 2 for the b b method and 0 71 2 0 w m 2 and 31 3 w m 2 for the fick s law respectively the eeoet model performs better in forests dbf enf ebf and mf and shrubland but worse in gra and cro for some grasslands and savannas in dry and arid regions such as australia and africa the classification of plants c3 dominated or c4 dominated usually changes with the season thus the fixed plant classification would probably lead to some errors in such regions although the rainy days p 0 mm were masked the contribution of rainfall interception to et can still exist when there are frequent rains because the intercepted rainfall remains longer in the dense canopy such as forests and mature croplands there are some underestimations of et when it rains frequently for shrublands and grasslands most sites are located in arid and semi arid regions the uncertainty of the θ related parameterization schemes such as the soil surface resistance and soil moisture stress probably causes errors in et estimation this implies that more work should be done to improve the estimation of θ related parameters in the future overall the performance of the b b method is slightly better than fick s law the probable reason is that the uncertainties in the r d parameterization scheme may degrade the model s performance to some extent drake et al 2016 in the application the uncertainty in r d estimation is as high as 30 huntingford et al 2017 yin et al 2011 and the resulting deviation in r s estimated by fick s law is 23 5 while the difference between the r s estimated by the b b method and fick s law is 7 6 nevertheless the derivation of the p model already implicitly assumes a stomatal relationship using fick s law to calculate r s guarantees not only the mass conservation of c o 2 but also the consistency in theory from the perspective of development potential the eeoet model with fick s law is more suitable once a reliable r d parameterization scheme is given we believe that fick s law will provide et estimation with higher accuracy in the future 4 3 impact of surface heterogeneity although a great effort was made to ensure spatial representativeness of the observations when setting up the instruments spatial heterogeneity at the sub pixel scale may cause uncertainties in the validation results liu et al 2016 those sites with a homogeneous extent much smaller than 0 05 0 05 were labeled as focus sites in this study and detailed descriptions for those sites are listed in table s3 it should be pointed out that all cro sites were considered focus sites because of the limited area of croplands to illustrate the influence of heterogeneous surfaces the validation of the eeoet model was compared to the results estimated by the lai yuan and glass fvc products at 500 m as seen from fig 6 the estimation based on 500 m lai and fvc products generally performs better than those based on 0 05 products the us crt site is located in curtice ohio an agriculture dominated region with more than 70 of the area covered by croplands thus the spatial resolution has little effect on the results however the performance at sites it bci and it ca2 sites is unsatisfactory which is also found in other models zhu et al 2019 zhang et al 2019 for site it bci the poor performance is caused by the observed error in longwave radiation after july 2010 see fig s3 in the supplementary information for site it ca2 too many anthropogenic factors sprinkler irrigation herbicide and rotation plantation result in poor performance sabbatini et al 2016 the relatively poor performance of cro could be partly explained by the mismatch of spatial representativeness since the vegetation related parameters play important roles in the energy partition and the temperature solution the bias of the lai and f veg product affects the partitioning of et components tang et al 2011 in future applications at regional scales the effect of surface heterogeneity should be considered 5 discussions 5 1 effectiveness of introducing the eeo principle the eeoet model contains two core parts one is to estimate canopy temperature and under canopy ground temperature based on single land surface temperature information and the energy budget equations in the noah mp land surface model the other is the improvement of the gpp calculation based on the eeo principle does the introduction of eeo principle reduce the pft specific parameters at the cost of degrading model performance to illustrate the effectiveness of each part we compared the performance of the model using only the first part and both parts fig 7 exhibits the model s performance before and after introducing the eeo principle blue represents the results based on photosynthetic parameter values from look up tables and the original schemes in noah mp while red represents the results with parameter values derived from the eeo principle the optimal values of the maximum rate of carboxylation at 25 c for noah mp were obtained from work by kattge et al 2009 with the look up tables in noah mp the first part of the model generally provides good et estimations the estimate is further improved using the eeo principle with higher r values less negative bias and slightly lower rmse therefore introducing the eeo principle not only reduces the number of pft specific parameters and simplifies the gpp calculation but also improves the model s performance 5 2 model uncertainty due to diurnal variation for the convenience of inter comparison the estimation and validation results were based on the daily data however the diurnal variation in the heat transfer is asymmetrical and the contribution of daytime to daily et is larger than that of nighttime yang et al 2009 when averaging the sub daily meteorological data daily the diurnal cycle of the heat transfer or aerodynamic resistance is erased similar to the hypothesis that the evaporative fraction during a day is a constant the contributions of daytime and nighttime are treated as equal in practical applications the influence of the diurnal cycle is usually ignored and the daily meteorological data are directly input into models this will bring a typical underestimation for daily et to illustrate the effect of the diurnal cycle we selected site it sr2 located in the enf with strong diurnal variation in energy transfer as an example here the spatial resolution of lai and f veg is 500 m the half hourly meteorological data from fluxnet were used to calculate et at a sub daily scale the comparison between the estimated et daily and sub daily is presented in table s4 daily denotes the results estimated by the daily average meteorological data daily hh is the daily results assembled by half hourly results noticeably when using half hourly inputs the underestimation is reduced with higher r 0 90 and lower mb 2 3 w m 2 values this partially explains the negative biases in figs 5 7 the results also imply that the effect of the diurnal cycle cannot be ignored and it should be considered by using sub daily observations or adjusting the daily stability parameters in practical applications polar orbiting satellites e g modis with four observations per day and geostationary satellites freitas et al 2012 will enable sub daily estimation in future applications in the past sub daily meteorological forcing data could be obtained from reanalysis products but the et models were still limited by the difficulty in continuous lst retrievals from satellites which are strongly affected by cloud contamination currently machine learning wu et al 2019 statistical approach jia et al 2022 zhang et al 2021 and microwave remote sensing techniques sun et al 2019 xu and cheng 2021 make it feasible to observe lst and estimate et at daily or sub daily scales holmes et al 2018 6 conclusions in this study an eco evolutionary optimality based et model eeoet was developed by integrating a gross primary production model and some schemes used in a land surface model the core components include 1 the energy partitioning between the canopy and soil from the noah mp schemes which is able to allocate the radiative fluxes determine the temperature and energy balance components in the two media and 2 the calculation of gpp from the p model which is the basis of the energy partitioning module 1 and significantly decreases the number of pft specific empirical parameters from 10 to no more than two the estimated et was validated using measurements from 74 fluxnet sites the results show that the eeoet model provides reasonable et estimations for different pfts with an enhanced mechanism and fewer pft specific empirical parameters without any calibration the eeoet model shows comparable performance to other models with more tuned parameters or more empirical processes the advantages of this model are as follows 1 it makes use of lst whose retrieval algorithm is mature in remote sensing microwave remote sensing technology makes it feasible to retrieve lst under all weather conditions therefore the model can be applied to spatially and temporally continuous et estimation 2 there is less dependence of the transpiration on empirical pft specific parameters and higher applicability conventional et models have many empirical parameters where there is a sparse observation or complex terrain the quality of forcing data always becomes poor and the calibrated parameters are consequently inaccurate based on a universal principle the eeoet model determines three key variables in gpp estimates j v cmax and c i from environmental conditions instead of numerous pft specific parameters and thus significantly reduces the number of pft specific parameters to no more than two 3 previous temperature based et models usually estimate et by treating it as the residual of the energy balance equation which results in higher model sensitivity to inputs in the eeoet model concurrent calculation of the energy components makes the estimated results less sensitive to inputs 4 common two source et models require the directional radiometric surface temperature for the same object from two or even more angles although the performance of such methods has been reported as reasonable on a regional scale based on geostationary satellite or airborne observations anderson et al 2005 geng et al 2022 morillas et al 2013 song et al 2020 it seems impractical to apply at global scales in contrast the eeoet model adopts energy partitioning schemes from a land surface model to derive canopy temperature and soil surface temperature from a single lst input this makes the model more widely applicable 5 although existing two source models avoid the computation of stomatal resistance two uncertain elements are introduced instead the priestley taylor coefficient and soil heat flux song et al 2016 and the estimation of transpiration does not consider ecophysiological effects the eeoet model attempts to incorporate additional mechanisms describing the vegetation acclimation adaption to environments which are often ignored in existing remote sensing based et models in this way the model may have great potential in analyzing vegetation dynamics e g investigating the response of carbon and water flux to climate change especially in those regions covered by dense vegetation this research demonstrates the concept of integrating the eeo principle and land processes to estimate et there remain some issues for practical applications such as the effect of the diurnal cycle and the contribution of canopy evaporation although fick s law is more physical and simpler in r s estimation the uncertainty of leaf respiration hinders its performance the errors in soil moisture stress strongly affect the accuracy of et estimation in areas where there is dry and covered by relatively dense vegetation hence establishing reliable schemes of respiration and soil moisture stress is beneficial to enhancing the mechanism of the model further and reducing pft specific parameters in the future credit authorship contribution statement mijun zou conceptualization software validation formal analysis investigation data curation writing original draft writing review editing visualization funding acquisition kun yang conceptualization methodology investigation writing original draft writing review editing supervision funding acquisition hui lu methodology validation writing original draft yanghang ren methodology formal analysis writing original draft writing review editing jing sun formal analysis investigation writing original draft writing review editing han wang methodology writing original draft shen tan resources writing original draft long zhao writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the national natural science foundation of china grant no 42105122 basic science center for tibetan plateau earth system of national natural science foundation of china grant no 41988101 and the international partnership program of chinese academy of sciences grant no 183311kysb20200015 the fluxnet2015 dataset can be obtained from https fluxnet org data fluxnet2015 dataset the lai dataset used in the calculation is now available at http globalchange bnu edu cn research lai the glass fvc product was downloaded from http www glass umd edu index html the global gsde dataset was released at http www tpdc ac cn zh hans data 2e46eb77 3ca2 4b90 9a42 fd49f10630d4 appendix a supplementary data appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128855 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 
2622,evapotranspiration et plays an important role in land surface processes and global climate et cannot be observed directly at a large scale and its spatial distribution is mainly obtained by et models at present however the application of existing et models is greatly hampered by a number of plant functional type pft specific empirical parameters and the difficulty in partitioning the contribution of et from the canopy and soil to this end an eco evolutionary optimality based evapotranspiration model eeoet was developed in this study with some schemes used in the noah mp land surface model the principle of eco evolutionary optimality expresses the underlying acclimation adaption of plants to diverse environments and thus greatly reduces the number of pft specific parameters the noah mp provides schemes to partition the energy between the canopy and soil and to calculate photosynthetic and et resistances owing to the above the eeoet model which has enhanced mechanisms and fewer pft specific parameters requires inputs of daily land surface temperature vegetation related data leaf area index and fractional vegetation and soil information soil texture and soil water content in addition to routine meteorological data the model output is daily et global evaluation across 74 fluxnet sites indicates that the model is capable of reasonably estimating et for all pfts and is also comparable to existing models that require more tunable parameters in addition the eeoet model is less sensitive to uncertainties in the input data than other models making it a more robust solution for estimating et under various conditions keywords evapotranspiration land surface modeling eco evolutionary optimality principle noah mp data availability data will be made available on request 1 introduction evapotranspiration et a key component of the energy and water cycle is the link between the atmosphere hydrology and ecology accurate et monitoring is vital for crop yield prediction ecosystem monitoring and water resource management especially in regions with limited water resources however the spatial representativeness of eddy covariance ec observations is limited with a footprint of hundreds of meters the large aperture scintillometer las provides the area averaged sensible heat flux and et can be calculated using the energy balance equation meijninger et al 2002 liu et al 2011 although the las provides measurements with a larger footprint few kilometers it is costly as an operational approach at a large scale hence mapping the et distribution only by ground based measurements is impossible in contrast it is feasible to estimate regional et from meteorological and land surface variables which are much easier to obtain because of the large uncertainties from the model s structure and empirical parameters pitman et al 1999 as well as high dependence on meteorological forcing data the et simulations from land surface models such as the community land model clm bonan et al 2002 and the multi parameterization option version of the noah land surface model noah mp niu et al 2011 cannot meet practical application requirements various et models based on remote sensing observations and meteorological forcing data have been developed in recent decades these et models can be generally divided into two categories temperature based and stomatal resistance based models chen and liu 2020 temperature based models make use of the land surface temperature lst retrieved from satellite sensors to derive et most of these kinds of models calculate the sensible heat flux and treat et as the residual of the surface energy balance equation although these models avoid the complex calculation of transpiration those uncertainties from inputs and parameterization are all responsible for the error in estimated et zou et al 2018 temperature based models can be further divided into single source bastiaanssen et al 1998 chen et al 2013 su 2002 and dual source norman et al 1995 kustas and norman 1997 models the former takes canopy and soil as a whole and assumes that the energy exchange occurs between the atmosphere and land surface therefore it is unable to distinguish the contribution of the canopy and soil the latter usually requires multi angle thermal information from geostationary satellites relevant review can be found in kustas and anderson 2009 for example two view angles in kustas and norman 1997 and six view angles in song et al 2020 however the objects change with the observational angle which leads to great uncertainties and application limitations for broader applications it is worth trying to partition the et components by observations from a single view angle stomatal resistance based models estimate et using vegetation related information whose retrieval is affected little by clouds these models focus upon the calculation of stomatal resistance r s the et process is complicated therefore its estimation relies on many plant functional type pft specific empirical parameterizations for example the mod16 model mu et al 2007 mu et al 2011 requires the calibration of 9 parameters for each pft and this number increases to 11 for the penman monteith leuning pml model zhang et al 2019 zhang et al 2016 however the calibration is affected by land cover classification study area data amount and fitting method too many pft specific parameters may lead to great uncertainty liu et al 2012 hence reducing the number of pft specific empirical parameters without removing the representation of physical processes is the key to improving the model s applicability most pft specific parameters come from the calculation of r s which often lacks a universal principle recent research advances in eco evolutionary optimality eeo principles may help to reduce the number of pft specific parameters in current et models harrison et al 2021 the principle of optimality states that stomata always act to maximize carbon gain from assimilation while minimize water loss from transpiration during a day cowan and farquhar 1977 wang et al 2017 proposed a gross primary production model hereafter p model without any pft related tunable parameter by combining the optimality principle with a biochemical photosynthesis model farquhar et al 1980 the p model assumes a universal optimal behavior of stomata and allows the prediction of leaf internal c o 2 concentration and carbon assimilation rate at weekly scales as an acclimation result of environmental conditions without specifying the local pfts to date the p model has been successfully applied to carbon assimilation simulations plant growth monitoring and crop yield predictions e g qiao et al 2020 ren et al 2021 smith et al 2019 if the optimality principle can be applied to establish an et model there could be a great potential to enhance its physical mechanism and reduce the number of empirical parameters tan et al 2021 combined the p model with the penman monteith equation to estimate weekly et and the results showed good agreement with observations at flux sites this method is not applicable to time scales shorter than a week due to the coordination effect of light and rubisco limited rates of photosynthesis in addition soil evaporation is calculated through an empirical regression nevertheless tan et al 2021 proved that the application of the optimality principle is promising in et estimation in short there are some imperative problems in existing et models to be solved such as too many pft specific empirical parameters and the difficulty in separating the thermal information between canopy and soil leading to limited applications across different pfts ershadi et al 2014 kim et al 2012 feng et al 2015 tang et al 2011 to improve the et model s applicability and reduce the uncertainty from parameter calibration we aim to solve these two problems in this study we proposed a process based et model the eco evolutionary optimality based et eeoet model which has fewer free parameters and incorporates more physical processes by using the eeo principle and the canopy understory radiation budget on the land surface this model targets the et estimation by remote sensing in a dual source framework with lst as input it should be noted that the purpose of this research is proof of concept instead of its application at a regional scale therefore the meteorological data and flux measurements used in this study are from ground based observations the required data in this study introduced in the following section 2 include the in situ measurements vegetation products and soil dataset on this basis the model is developed by combining the eeo principle with the energy partitioning schemes from the noah mp section 3 in section 4 the model is evaluated against in situ measurements and the results are compared to two typical et models section 5 analyzes the effectiveness of improving the accuracy of et estimates by the eeo principle and the model s uncertainties from diurnal variations 2 data and methods in this study et estimations require measurements from fluxnet2015 dataset pastorello et al 2020 including wind speed u m s air temperature t air k vapor pressure saturation deficit vpd hpa air pressure p air k p a downward longwave and shortwave radiation r ld and r sd w m 2 upward longwave and shortwave radiation r lu and r su w m 2 c o 2 mole fraction μ m o l c o 2 m o l 1 and soil water content θ land surface temperature t sfc k which is inferred from the observed r lu and r ld in this study is also needed furthermore the model requires the leaf area index lai fractional vegetation fveg and soil texture components the observed precipitation p mm is used to select the non rainy days daily latent heat le w m 2 measurements from fluxnet were used to validate the et model 2 1 in situ measurements to reduce the impact of uncertainties in observations fluxnet sites were selected in this study utilizing the following rules 1 the required input variables should be available 2 since the rainfall interception module was not considered yet in this study only the day without rain daily precipitation 0 mm was chosen to avoid the uncertainty caused by the evaporation from canopy interception 3 there are at least 200 available days for each site and 4 each pft contains no less than three sites additionally the θ and le data were selected through the quality control qc flag the instantaneous qc flag values range from 0 to 3 which represent measured 0 filled with high confidence 1 filled with medium confidence 2 and filled with low confidence 3 the instantaneous data with qc flags 2 were treated as good quality in this study the days with no more than 75 good quality instantaneous θ and le data were eliminated the observed daily le from fluxnet was corrected by the bowen ratio method twine et al 2000 to avoid the impact of the observed imbalance on the validation in addition some sites were excluded for significant errors in measurements that were found in previous studies or during our site by site check see the supplementary information text finally 74 sites fig 1 and table s1 in supplementary information met the quality requirement and were classified into nine pfts including grasslands gra 17 sites savannas sav 6 woody savannas wsa 5 evergreen broadleaf forests ebf 3 mixed forests mf 3 deciduous broadleaf forests dbf 13 evergreen needleleaf forests enf 16 open shrublands osh 3 and croplands cro 8 in this study all pfts were treated as c3 plants except cro the cro sites were classified c3 or c4 site by site according to the supplementary document of fluxnet because fluxnet sites do not provide land surface temperature observations the t sfc data at each site were derived using longwave radiation flux data according to the stefan boltzmann law with the effective land surface emissivity obtained by eq 11 below 2 2 vegetation and soil dataset the lai dataset of yuan et al 2011 referred to as lai yuan spans from 2000 to 2016 with a temporal resolution of eight days compared with the original modis lai product the lai yuan product is more continuous and consistent in both time series and spatial domains the 8 day global land surface satellite glass fractional vegetation cover fvc product spans 2000 to 2018 it was generated based on the reflectance obtained from modis and the multivariate adaptive regression splines method jia et al 2015 yang et al 2016 the data are spatially and temporally continuous without gaps and missing values both lai yuan and glass fvc provide products with spatial resolutions of 500 m and 0 05 here we use the 0 05 product for et estimation and the 500 m product for the investigation of the effect of spatial heterogeneity the 8 day lai and fvc products were converted to daily data using linear interpolation the global soil dataset for earth system modeling gsde was made based on the soil map of the world and various regional and national soil databases shangguan and dai 2014 it provides 10 km gridded soil information for eight vertical layers shangguan et al 2014 here the soil texture of the top layer 0 0 045 m was used the values of the pixels in which the sites are located were extracted as the model inputs 2 3 evaluation method of et estimates the estimation results were evaluated with the pearson correlation coefficient r mean bias error mb and root mean square error rmse the models used for pft level performance comparison table a 1 include a process based model the simple terrestrial hydrosphere model hereafter sith zhu et al 2019 and a semi empirical method the priestley taylor model from the jet propulsion laboratory hereafter pt jpl fisher et al 2008 the results of the pt jpl model were calculated using the same sites as the eeoet model while the results for the sith model were obtained from zhu et al 2019 only the non rainy days were selected for all models all compared studies linearly interpolated the 8 day lai and fvc products to daily and the observed et was corrected through the observed bowen ratio twine et al 2000 all compared models were forced with the meteorological data obtained from the fluxnet sites it should be noted that the sites used in zhu et al 2019 and this study were slightly different which was due to the differences in observed elements for each site and the required input variables for each model however the inter comparison was implemented on the pft level instead of the site level the site mean results of each pft were considered representative of the performance for each pft 3 development of the eco evolutionary optimality based et eeoet model in this section an overview of the eeoet model is presented first then the specific modules are described respectively table a 2 shows the model s inputs and fig 2 shows the logic of the eeoet model overall the eeoet model contains two cores 1 the partitioning of the energy between canopy and soil using some schemes in the noah mp section 3 1 and 2 the estimation of stomatal resistance based on the eeo principle section 3 2 the model s sensitivity is shown in section 3 3 the estimation process includes the following steps 1 calculate the parameter k eqs 5 9 ε eff eq 11 r soil eq 12 and φ 0 eq 24 by parameterization schemes 2 estimate j v cmax and c i according to eqs 19 22 3 then calculate gpp based on the eeo principle 16 18 and r s is determined by the ball berry method or fick s law eqs 13 or 15 4 initialize t c and t g and then calculate r nc eqs 2 4 based on the parameters and variables estimated in steps 1 3 iteratively solve the energy balance equation eq 1 and table 1 and longwave radiation budget equation eq 10 to compute t c t g tr and e when the t c difference between two successive steps δ t c is smaller than 0 1 k the iteration is finished 5 the et is determined as the sum of tr and e 3 1 partitioning of energy between the canopy and soil et w m 2 expressed as energy flux in this study usually consists of soil evaporation e and vegetation transpiration tr hence the et of a vegetated pixel can be divided into two parts from the remote sensing perspective fig 3 the vegetation canopy and the soil ground many models solve et in a single source framework bastiaanssen et al 1998 jiang and islam 1999 moran et al 1994 su 2002 which cannot obtain e and tr respectively therefore the first function of our model is to solve the energy balance components within the two media concurrently in a dual source framework the noah mp one of the most widely used land surface models separately considers the energy balance of the canopy and soil in the noah mp the vegetation canopy and soil information can be divided based on the framework of the vege flux module niu et al 2011 yang et al 2011 in this study this framework is modified to enable energy partitioning from a remote sensing perspective the main differences between the eeoet model and the noah mp include 1 the structures differ the noah mp treats a pixel as consisting of bare soil the canopy and the soil beneath the canopy while the eeoet model divides a pixel into the canopy and the soil surface from the viewpoint of remote sensing 2 the equations used for the solution process are partially different the noah mp solves the t c and t g by the energy balance equation of the canopy and soil surface considering the uncertainty in estimating the soil heat flux we use the longwave radiation balance equation instead in this way the t sfc as one of the most accurate land surface variables with mature algorithms is used as input the modified partitioning schemes are as follows for the vegetation canopy the absorbed net radiation r nc w m 2 is allocated to sensible heat h c and latent heat or transpiration which can be described by the energy balance equation 1 r nc t g 4 t c 4 h c t c t r t c 0 2 r nc r snc r lnc 3 r lnc f veg ε v r ld ε v 1 ε v 1 ε g r ld ε v ε g σ t g 4 ε v 1 ε g ε v σ t c 4 2 ε v σ t c 4 4 r snc f veg r sd r su 1 e k l a i f veg where r lnc w m 2 represents the net longwave radiation absorbed by the canopy which is dominated by downward longwave radiation r ld ground temperature t g and canopy temperature t c ε g is the emissivity of the ground 0 98 and the vegetation emissivity is calculated by ε v 1 e 1 1 l a i in the noah mp lai is the leaf area index fveg is the fractional vegetation the calculations of h c and tr require t c see table 1 while that of r nc requires both t c and t g r snc w m 2 is the net shortwave radiation absorbed by the canopy r sd and r su w m 2 represent the downward and upward shortwave radiation respectively k is the extinction coefficient k is usually set as a constant 0 5 or 0 6 actually it is closely related to the canopy structure and the zenith angle of the sun θ sun in the clm k is given as follows 5 k g μ μ 6 μ c o s θ sun where g μ is the relative projected area of leaf and stem elements in the direction θ sun which can be calculated based on the work in goudriaan 1977 as 7 g μ o 1 o 2 μ 8 o 1 0 5 0 633 χ l 0 33 χ l 2 9 o 2 0 877 1 2 o 1 where χ l represents the departure of leaf angles from a random distribution its value under different pfts was taken from dorman and sellers 1989 and listed in table a 3 according to the stefan boltzmann law we can derive the following relationship among t c t g and land surface temperature t sfc k 10 ε eff σ t sfc 4 1 ε v 1 ε g ε v σ t c 4 ε v σ t c 4 1 ε v ε g σ t g 4 f veg ε g σ t g 4 1 f veg with 11 ε eff f veg ε g 1 ε v ε v ε v 1 ε v 1 ε g 1 f veg ε g the formulations of the energy flux components for the vegetation canopy and soil ground are summarized in table 1 et is estimated as the sum of tr and e there are two unknown variables t c and t g and they can be computed by iteratively solving eqs 1 and 10 the above iteration requires the calculation of four resistances aerodynamic resistance r a leaf boundary layer resistance r b soil surface resistance r soil and stomatal resistance r s the r a is estimated following the m o similarity theory and considering the roughness length parameterization under different vegetation coverages the detailed solutions can be found in chen et al 2013 r b is calculated based on k theory using the ragrb module of noah mp the soil surface resistance r soil is parameterized as a function of soil water content θ according to the scheme of hu and jia 2015 12 r soil r soil m i n θ 3 w i t h θ θ θ min θ s θ min where the porosity can be calculated by θ s 0 489 0 00126 s a n d with sand denotes the mass content of sand and r soil min is taken as 50 s m the module of r s estimation where there are many pft specific empirical parameters will be developed by introducing the eco evolutionary optimality principle in section 3 2 3 2 estimation of stomatal resistance 3 2 1 two schemes for the stomatal resistance stomata control both the transpiration and photosynthesis processes of plants usually the estimation of stomatal resistance r s is complicated with a large number of parameterizations involved the eeoet model provides two commonly used methods as options for the r s calculation in the noah mp r s is determined by the ball berry method ball et al 1987 hereafter b b presented as 13 1 r s m gpp c s h s p air 1 r s m a x 14 c s c o 2 1 37 r b g p p r d where h s denotes the relative humidity of the air and r s m a x 2000 s m is the maximum stomatal resistance m is an empirical parameter to relate tr with c o 2 its value is from a look up table in noah mp see table a 3 a larger m indicates more water loss from the tr process when producing the same carbon mass c s p a is the c o 2 partial pressure at the leaf surface derived from fick s law r d μ m o l c o 2 m 2 s is the leaf respiration and gpp μ m o l c o 2 m 2 s is the photosynthesis rate as the other option the r s can also be determined by fick s law to guarantee the mass conservation of c o 2 15 1 r s 1 6 gpp r d c s c i the calculation of gpp requires the rate of electron transport j μ m o l e l e c t r o n s m 2 s maximum rate of carboxylation v cmax μ m o l c o 2 m 2 s and leaf internal c o 2 partial pressure c i pa r d f d v cmax is proportional to v cmax with f d of 0 015 for c3 plants and 0 025 for c4 plants 3 2 2 eco evolutionary optimality eeo principle in noah mp gpp v cmax and c i are determined simultaneously through numerical iteration however there are as many as 10 free parameters relating to each pft during the computation of gpp v cmax and c i here we introduce the p model based on the eeo principle to simplify this calculation process and reduce pft related parameters in the gpp estimation photosynthetic ability is dominated by two limitations light limitation wj and carboxylate limitation or rubisco limitation wc in the p model the gpp is given as the minimum of these factors as 16 gpp m i n w j w c where wj and wc are calculated as follows 17 wj c i γ c i 2 γ j 4 for c3 j 4 for c4 18 wc c i γ c i k c 1 o 2 k o v cmax for c3 v cmax for c4 where γ p a denotes the photorespiratory compensation point of c o 2 bernacchi et al 2001 the oxygen partial pressure o 2 pa equals 0 209 p air k c and k o are the michaelis menten constants for c o 2 and o 2 respectively unlike the noah mp plants are divided into two categories c3 and c4 to represent their photosynthetic pathways in the p model when plants adapt to a changing environment the costs associated with maintaining transpiration and carboxylation capacity are balanced wang et al 2017 based on the acclimation mechanism the j v cmax and c i are treated as functions of environmental variables without any calibrated parameters 19 j 4 i abs φ 0 1 4 i abs φ 0 j max 2 20 j max 4 φ 0 β i abs 1 1 c c i 2 γ c i γ 2 3 1 21 v cmax φ 0 i abs c i k c i 2 γ β 1 c c i 2 γ c i γ 2 3 for c3 φ 0 i abs β 1 c 2 3 for c4 22 c i γ c a γ ξ ξ vpd for c3 0 65 c a for c4 23 ξ 146 k γ 1 6 η 24 φ 0 0 352 0 021 t a 0 00034 t a 2 8 for c3 0 008 0 00375 t a 0 58 10 4 t a 2 for c4 where i abs μ m o l p h o t o n m 2 s 1 is the absorbed photosynthetically active radiation and equals 1 e k l a i p p f d ppfd μ m o l p h o t o n m 2 s 1 is the photosynthetic photon flux density j max μ m o l e l e c t r o n s m 2 s is the maximum rate of electron transport the michaelis menten coefficient for photosynthesis k p a is a function of t air and its solution can be found in farquhar et al 1980 the intrinsic quantum yield parameter φ 0 is modeled as temperature dependent c 0 41 is proportional to the unit carbon cost for the maintenance of electron transport capacity and c a p a is the ambient c o 2 partial pressure the parameter ξ denotes the sensitivity of c i c a to the vapor pressure saturation deficit vpd hpa which is similar to the key parameter in medlyn et al 2011 c i c a was set to a constant for c4 plants tan et al 2021 here the typical value of c i c a for c4 plants was given as 0 65 according to the work in morison and gifford 1983 η is the viscosity of water relative to the value at 25 c huber et al 2009 the soil moisture stress β was expressed as a power function of relative soil water content keenan et al 2009 and the power q is tentatively set to 0 2 25 β θ θ min θ s θ min q the β affects transpiration through a biochemical limitation it reduces v cmax and j max during water stressed periods keenan et al 2010 it should be noted that the stress is not applied to forest sites in this study we tentatively set β to 1 because forests have deep roots to take up the soil water at a deeper layer even in a relatively dry period the energy balance components absorb the errors in β through a complementary effect between tr and e more less tr reduces increases the water vapor gradient between the canopy air and soil surface and further inhibits promotes e from the soil surface therefore the β little affects the et estimates in forests except during extremely dry years another reason is that the observing depth of soil moisture is too shallow to provide stress information in forests in noah mp 10 pft specific parameters are used to estimate gpp while the p model uses two of them and prescribes them as constants shown in table a 4 the original version of the p model wang et al 2017 stocker et al 2020 is applicable at a weekly scale while the noah mp usually simulates at sub daily time scales a new advance in the eeo principle has been made mengoli et al 2022 allowing the estimation of gpp at sub daily scales and pointing out that the j max and v cmax tend to acclimate to the midday meteorological conditions of the last 15 days the instantaneous responses of j max and v cmax were adjusted by the exponential moving average equation the detailed process can be found in mengoli et al 2022 as such the schemes of gpp in the noah mp can be substituted with those in the p model in this way gpp can be calculated without numerical iteration and no pft specific parameter is required to estimate gpp the number of pft specific parameters of the r s estimation in the noah mp schemes is reduced from 10 to no more than one if eq 13 is used only one parameter associated with the pft is retained that is the parameter m this parameter can be further removed if eq 15 is applied therefore the r s dependence on pft related parameters is significantly reduced 3 3 sensitivity of the eeoet model to inputs in practical applications the uncertainty of inputs mainly comes from the retrieval of t sfc and θ and meteorological forcing data thus it is important to understand the model s sensitivity to these inputs hu and jia 2015 investigated the sensitivity of the etmonitor model a stomatal resistance based model to inputs analogous to that work a sensitivity test was performed assuming the same meteorological conditions as the work in hu and jia 2015 the sensitivity of the eeoet model was compared with the sebs model a single source temperature based model su 2002 and the results of hu and jia 2015 the sensitivity of et to a parameter s p is defined as 26 s p 1 2 e t 0 9 r e t 1 1 r e t r where e t r is the et calculated by the input variables that are equal to the reference value p r e t 0 9 r and e t 1 1 r denote the et values calculated by the input variables that are equal to 0 9 p r and 1 1 p r respectively however for t air t sfc e t 0 9 r and e t 1 1 r denote the et values calculated by t air 1 k and t air 1 k t sfc 1 k and t sfc 1 k table 2 shows the sensitivity of the et estimation to main inputs among those inputs the energy related variables significantly influence et estimation because t sfc and u are used for the calculations of et and sensible heat their uncertainties are transferred into the energy balance components as a result the sensitivity of the eeoet model to t sfc 2 8 and u 0 7 is lower than that of the single source temperature based model θ is treated as one of the most uncertain inputs its 10 change causes an 5 3 change in et for the etmonitor model while it only causes a 3 7 change for the eeoet model therefore the lower sensitivity to the parameters for the eeoet model brings more stability in the et estimates when applied to regional or large scales 4 results to understand the model s performance and applicability under different pfts the eeoet model was verified in two parts qualitative evaluation section 4 1 and quantitative validation section 4 2 the qualitative evaluation focused on evaluating the model s ability to partition thermal information and et while the quantitative validation focused on the validation of model performance the impact of surface heterogeneity on the validation is presented in section 4 3 4 1 qualitative evaluation of estimated temperature and et components to exhibit the estimated results nine typical sites were selected from the nine pfts the selection followed the principle that 1 the validated statistics should be close to the median of the corresponding pft and 2 for the convenience of the exhibition the data records should span more than two years using the developed eeoet model t sfc was divided into the canopy temperature t c k and ground temperature t g k as shown in fig s4 the contributions of the canopy and soil to t sfc are diverse for different pfts the difference between t c and t sfc is small when lai is high while the difference between t g and t sfc is small when lai is low for dense vegetation such as croplands and forests there is a negative correlation between t g t sfc and lai which means that increased shadows make the ground cooler for relatively sparse vegetation such as grasslands t c t sfc is larger when lai is low this indicates that as the vegetation becomes denser the canopy s contribution becomes greater while the soil s contribution decreases and vice versa the two year time series of transpiration tr evaporation e and lai fig s5 shows that the trends of tr and lai are similar and almost synchronous which illustrates that tr is significantly influenced by vegetation growth the value of e is very small under dry conditions such as fig s5f with low θ but et can still proceed via the tr process for tall and dense vegetation fig s5b where lai is high et is dominated by tr however for short and sparse vegetation as fig s5h e and tr are comparable to each other under wet conditions before the growing season negative value of evaporation occurs at some sites which correspond to condensation on the soil surface due to moist air 4 2 validation of eeoet estimated daily et the fluxnet dataset provides ec observation records in this study daily et observations with daily precipitation 0 mm were used for validation the validation statistics for 74 sites are presented in table s2 in the supplementary information fig 4 shows the validated results including the medians of r mb and rmse for each pft except for cro the eeoet model performs well for various pfts for the b b method r ranges from 0 72 gra to 0 90 mf and rmse ranges from 16 6 w m 2 osh to 40 0 w m 2 ebf for the fick s law r ranges from 0 67 gra to 0 89 mf and rmse ranges from 14 7 w m 2 osh to 40 5 w m 2 ebf overall the performance of the eeoet model is reasonable the validation was further compared with previous studies that used fluxnet data to estimate and validate daily et as seen in fig 5 the eeoet model with fewer empirical parameters and a complete mechanism provides a comparable performance to the other two models the sith model with four pft related parameters calibrated for each pft performs well with the lowest mb 0 58 w m 2 and rmse 21 4 w m 2 due to the close correlation between environmental variables air humidity and t air and et the pt jpl has a high r value of 0 82 however the determination of environmental constraints in the pt jpl model lacks an ecophysiological mechanism it overestimates et for most pfts with mb and rmse values of 9 8 w m 2 and 34 2 w m 2 respectively the poor performance of the pt jpl model was also found in forests in several studies ershadi et al 2014 yao et al 2021 the r mb and rmse of the eeoet model of the two options are comparable with values of 0 75 2 5 w m 2 and 28 5 w m 2 for the b b method and 0 71 2 0 w m 2 and 31 3 w m 2 for the fick s law respectively the eeoet model performs better in forests dbf enf ebf and mf and shrubland but worse in gra and cro for some grasslands and savannas in dry and arid regions such as australia and africa the classification of plants c3 dominated or c4 dominated usually changes with the season thus the fixed plant classification would probably lead to some errors in such regions although the rainy days p 0 mm were masked the contribution of rainfall interception to et can still exist when there are frequent rains because the intercepted rainfall remains longer in the dense canopy such as forests and mature croplands there are some underestimations of et when it rains frequently for shrublands and grasslands most sites are located in arid and semi arid regions the uncertainty of the θ related parameterization schemes such as the soil surface resistance and soil moisture stress probably causes errors in et estimation this implies that more work should be done to improve the estimation of θ related parameters in the future overall the performance of the b b method is slightly better than fick s law the probable reason is that the uncertainties in the r d parameterization scheme may degrade the model s performance to some extent drake et al 2016 in the application the uncertainty in r d estimation is as high as 30 huntingford et al 2017 yin et al 2011 and the resulting deviation in r s estimated by fick s law is 23 5 while the difference between the r s estimated by the b b method and fick s law is 7 6 nevertheless the derivation of the p model already implicitly assumes a stomatal relationship using fick s law to calculate r s guarantees not only the mass conservation of c o 2 but also the consistency in theory from the perspective of development potential the eeoet model with fick s law is more suitable once a reliable r d parameterization scheme is given we believe that fick s law will provide et estimation with higher accuracy in the future 4 3 impact of surface heterogeneity although a great effort was made to ensure spatial representativeness of the observations when setting up the instruments spatial heterogeneity at the sub pixel scale may cause uncertainties in the validation results liu et al 2016 those sites with a homogeneous extent much smaller than 0 05 0 05 were labeled as focus sites in this study and detailed descriptions for those sites are listed in table s3 it should be pointed out that all cro sites were considered focus sites because of the limited area of croplands to illustrate the influence of heterogeneous surfaces the validation of the eeoet model was compared to the results estimated by the lai yuan and glass fvc products at 500 m as seen from fig 6 the estimation based on 500 m lai and fvc products generally performs better than those based on 0 05 products the us crt site is located in curtice ohio an agriculture dominated region with more than 70 of the area covered by croplands thus the spatial resolution has little effect on the results however the performance at sites it bci and it ca2 sites is unsatisfactory which is also found in other models zhu et al 2019 zhang et al 2019 for site it bci the poor performance is caused by the observed error in longwave radiation after july 2010 see fig s3 in the supplementary information for site it ca2 too many anthropogenic factors sprinkler irrigation herbicide and rotation plantation result in poor performance sabbatini et al 2016 the relatively poor performance of cro could be partly explained by the mismatch of spatial representativeness since the vegetation related parameters play important roles in the energy partition and the temperature solution the bias of the lai and f veg product affects the partitioning of et components tang et al 2011 in future applications at regional scales the effect of surface heterogeneity should be considered 5 discussions 5 1 effectiveness of introducing the eeo principle the eeoet model contains two core parts one is to estimate canopy temperature and under canopy ground temperature based on single land surface temperature information and the energy budget equations in the noah mp land surface model the other is the improvement of the gpp calculation based on the eeo principle does the introduction of eeo principle reduce the pft specific parameters at the cost of degrading model performance to illustrate the effectiveness of each part we compared the performance of the model using only the first part and both parts fig 7 exhibits the model s performance before and after introducing the eeo principle blue represents the results based on photosynthetic parameter values from look up tables and the original schemes in noah mp while red represents the results with parameter values derived from the eeo principle the optimal values of the maximum rate of carboxylation at 25 c for noah mp were obtained from work by kattge et al 2009 with the look up tables in noah mp the first part of the model generally provides good et estimations the estimate is further improved using the eeo principle with higher r values less negative bias and slightly lower rmse therefore introducing the eeo principle not only reduces the number of pft specific parameters and simplifies the gpp calculation but also improves the model s performance 5 2 model uncertainty due to diurnal variation for the convenience of inter comparison the estimation and validation results were based on the daily data however the diurnal variation in the heat transfer is asymmetrical and the contribution of daytime to daily et is larger than that of nighttime yang et al 2009 when averaging the sub daily meteorological data daily the diurnal cycle of the heat transfer or aerodynamic resistance is erased similar to the hypothesis that the evaporative fraction during a day is a constant the contributions of daytime and nighttime are treated as equal in practical applications the influence of the diurnal cycle is usually ignored and the daily meteorological data are directly input into models this will bring a typical underestimation for daily et to illustrate the effect of the diurnal cycle we selected site it sr2 located in the enf with strong diurnal variation in energy transfer as an example here the spatial resolution of lai and f veg is 500 m the half hourly meteorological data from fluxnet were used to calculate et at a sub daily scale the comparison between the estimated et daily and sub daily is presented in table s4 daily denotes the results estimated by the daily average meteorological data daily hh is the daily results assembled by half hourly results noticeably when using half hourly inputs the underestimation is reduced with higher r 0 90 and lower mb 2 3 w m 2 values this partially explains the negative biases in figs 5 7 the results also imply that the effect of the diurnal cycle cannot be ignored and it should be considered by using sub daily observations or adjusting the daily stability parameters in practical applications polar orbiting satellites e g modis with four observations per day and geostationary satellites freitas et al 2012 will enable sub daily estimation in future applications in the past sub daily meteorological forcing data could be obtained from reanalysis products but the et models were still limited by the difficulty in continuous lst retrievals from satellites which are strongly affected by cloud contamination currently machine learning wu et al 2019 statistical approach jia et al 2022 zhang et al 2021 and microwave remote sensing techniques sun et al 2019 xu and cheng 2021 make it feasible to observe lst and estimate et at daily or sub daily scales holmes et al 2018 6 conclusions in this study an eco evolutionary optimality based et model eeoet was developed by integrating a gross primary production model and some schemes used in a land surface model the core components include 1 the energy partitioning between the canopy and soil from the noah mp schemes which is able to allocate the radiative fluxes determine the temperature and energy balance components in the two media and 2 the calculation of gpp from the p model which is the basis of the energy partitioning module 1 and significantly decreases the number of pft specific empirical parameters from 10 to no more than two the estimated et was validated using measurements from 74 fluxnet sites the results show that the eeoet model provides reasonable et estimations for different pfts with an enhanced mechanism and fewer pft specific empirical parameters without any calibration the eeoet model shows comparable performance to other models with more tuned parameters or more empirical processes the advantages of this model are as follows 1 it makes use of lst whose retrieval algorithm is mature in remote sensing microwave remote sensing technology makes it feasible to retrieve lst under all weather conditions therefore the model can be applied to spatially and temporally continuous et estimation 2 there is less dependence of the transpiration on empirical pft specific parameters and higher applicability conventional et models have many empirical parameters where there is a sparse observation or complex terrain the quality of forcing data always becomes poor and the calibrated parameters are consequently inaccurate based on a universal principle the eeoet model determines three key variables in gpp estimates j v cmax and c i from environmental conditions instead of numerous pft specific parameters and thus significantly reduces the number of pft specific parameters to no more than two 3 previous temperature based et models usually estimate et by treating it as the residual of the energy balance equation which results in higher model sensitivity to inputs in the eeoet model concurrent calculation of the energy components makes the estimated results less sensitive to inputs 4 common two source et models require the directional radiometric surface temperature for the same object from two or even more angles although the performance of such methods has been reported as reasonable on a regional scale based on geostationary satellite or airborne observations anderson et al 2005 geng et al 2022 morillas et al 2013 song et al 2020 it seems impractical to apply at global scales in contrast the eeoet model adopts energy partitioning schemes from a land surface model to derive canopy temperature and soil surface temperature from a single lst input this makes the model more widely applicable 5 although existing two source models avoid the computation of stomatal resistance two uncertain elements are introduced instead the priestley taylor coefficient and soil heat flux song et al 2016 and the estimation of transpiration does not consider ecophysiological effects the eeoet model attempts to incorporate additional mechanisms describing the vegetation acclimation adaption to environments which are often ignored in existing remote sensing based et models in this way the model may have great potential in analyzing vegetation dynamics e g investigating the response of carbon and water flux to climate change especially in those regions covered by dense vegetation this research demonstrates the concept of integrating the eeo principle and land processes to estimate et there remain some issues for practical applications such as the effect of the diurnal cycle and the contribution of canopy evaporation although fick s law is more physical and simpler in r s estimation the uncertainty of leaf respiration hinders its performance the errors in soil moisture stress strongly affect the accuracy of et estimation in areas where there is dry and covered by relatively dense vegetation hence establishing reliable schemes of respiration and soil moisture stress is beneficial to enhancing the mechanism of the model further and reducing pft specific parameters in the future credit authorship contribution statement mijun zou conceptualization software validation formal analysis investigation data curation writing original draft writing review editing visualization funding acquisition kun yang conceptualization methodology investigation writing original draft writing review editing supervision funding acquisition hui lu methodology validation writing original draft yanghang ren methodology formal analysis writing original draft writing review editing jing sun formal analysis investigation writing original draft writing review editing han wang methodology writing original draft shen tan resources writing original draft long zhao writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this research was supported by the national natural science foundation of china grant no 42105122 basic science center for tibetan plateau earth system of national natural science foundation of china grant no 41988101 and the international partnership program of chinese academy of sciences grant no 183311kysb20200015 the fluxnet2015 dataset can be obtained from https fluxnet org data fluxnet2015 dataset the lai dataset used in the calculation is now available at http globalchange bnu edu cn research lai the glass fvc product was downloaded from http www glass umd edu index html the global gsde dataset was released at http www tpdc ac cn zh hans data 2e46eb77 3ca2 4b90 9a42 fd49f10630d4 appendix a supplementary data appendix b supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128855 appendix b supplementary data the following are the supplementary data to this article supplementary data 1 
2623,availability of skillful precipitation forecast is crucial for regions such as the himalayas which directly influence millions of people in the indian subcontinent the deterministic raw forecasts obtained from the numerical weather prediction nwp models are often biased in this work we present a novel approach of considering the spatial mismatch between the precipitation forecast and observation data in developing a statistical model to deal with the mismatch in the spatial scale a famous alternative approach could be spatial downscaling and bias correction sdbc we attempt to blend the traditional approach of sdbc with a multiple point geostatistics mps approach to generate better skilled forecasts we consider the slope aspect and other topographical variables along with the nwp model output and observation data in a multivariate setup of the mps with sdbc model to generate skillful forecast ensembles we evaluate the daily generated 25 ensemble forecast members at avalanche and glacier sites the generated multiple forecast members allow us to assess the uncertainty in the precipitation forecast the outcome of the study would be helpful to water resource managers disaster relief authorities avalanche forecast agencies and climate change experts for the sustainable development of the himalayas keywords multiple point statistics mps precipitation forecast himalayas spatial downscaling and bias correction avalanche glaciers data availability data will be made available on request 1 introduction the medium range quantitative precipitation forecasts qpfs obtained from the numerical weather prediction nwp models predict the possible amount of precipitation over a certain region a few days in advance froude 2010 verdin et al 2016 traditionally the nwp models produce deterministic forecast which is single valued and represents the best estimate of future weather the deterministic forecasts are often considered unreliable as they do not take into account the uncertainty involved with precipitation and the errors in defining the initial conditions of the nwp model jha et al 2018 zhao et al 2021 therefore users like to have several forecast members ensemble from the nwp model based on varying initial conditions cuo et al 2011 hagelin et al 2017 however due to the high computational cost involved it becomes unfeasible to generate a large number of ensembles at fine spatial resolution availability of reliable precipitation forecasts is crucial especially in regions such as the himalayas since the snow and glaciers present in the region are a major source of fresh water for the millions of people living downstream moreover precipitation induced natural hazards such as flash floods avalanches etc take place frequently in the region joseph et al 2015 rakesh and kutty 2021 a reliable forecast of an impending precipitation event a few days in advance will help in decision support effective planning and management of water resources socio economic activities or emergency services to mitigate the impacts of a hazard singhal and jha 2021a singhal et al 2022b in the mountainous regions the raw forecast from an nwp model is likely to have limitations due to inaccurate model formulations sub grid scale parameterization and the presence of complex topography and orography das et al 2003 panziera et al 2011 chawla et al 2018 singh and kumar 2021 it is essential that the errors contained in the raw forecasts obtained from the nwp models are corrected before using them for operational purposes in the past several error correction methods have been developed and employed to improve the accuracy of the raw nwp forecasts li et al 2017b approaches such as the rank histogram calibration method hamill and colucci 1998 and quantile mapping gudmundsson et al 2012 samal and jha 2022 are easier to implement and cost effective for operational purposes however they have limitations in correcting the forecasts zhao et al 2017 another group of error correction methods is based on regression models including logistic regression messner et al 2014 and quantile regression friederichs and hense 2007 in recent years a popular group of error correction methods has been developed based on the joint probability of forecasts and long historical observations in such an approach a joint probability distribution is established between the forecast data predictors and the corresponding observations predictands to produce calibrated forecasts wang et al 2009 robertson 2013 shrestha et al 2015 although a variety of error correction methods have been used to obtain skillful raw forecasts to the best of our knowledge the efficacy of any geostatistical model capable of spatially correlating variables is yet to be explored multiple point geostatistics mps is a popular geostatistical concept based model which aims to simulate and reproduce the spatial patterns contained in a multivariate training dataset called the training image ti the ti represents prior information of the study area generally at both coarse and fine spatial resolutions the model derives patterns from the ti to simulate random fields of a simulation grid sg upon successful matching of the patterns between ti with sg certain pixels of sg is already filled with information known as the conditioning data cd cd along with several covariates assist in the proper matching of patterns in the last two decades mps has gained credibility in diverse research areas because of its ability to reproduce reliable spatial patterns and quantify spatial uncertainty by generating several realizations zuo et al 2020 for instance jha et al 2013a used the mps approach to downscale seasonal maps of environmental variables such as latent heat flux surface temperature and soil moisture again jha et al 2015 applied mps to downscale precipitation and temperature for the year 2005 while using 20 years of wrf output as a training image 1985 2004 in southeastern australia dembélé et al 2019 proposed an mps based framework for gap filling of streamflow data in the complex volta river basin of west africa recently singhal and jha 2021b used twelve years of wrf output 2001 2012 to obtain fine resolution precipitation and temperature for the year 2013 in a gridbox at districts and point locations over the northwest himalayas singhal et al 2022a further explored the potential of mps over the northwest himalayas this time to spatially extrapolate the downscaled wrf data of precipitation and temperature to a larger domain by using the training data of a smaller domain in most of the studies which apply mps the coarse and fine resolution information present in the ti is derived from the same source to obtain superior reproduction of patterns however in this study we explore the efficacy of mps in simulating the spatially connected patterns of precipitation when precipitation datasets from two different sources and at different spatial resolution are used to construct the ti further to reduce the inherent inconsistency between the spatial features of the two data sources data smoothening and bias correction methods are also applied details of which we see later among the several algorithms developed under the broader concept of mps we select the direct sampling ds algorithm developed by mariethoz et al 2010 for this study the advantages of using ds are 1 both univariate and multivariate simulations of categorical and continuous variables are well handled straubhaar and renard 2021 2 there is no need to store spatial patterns in a database prior to the simulations as ds extracts the samples directly from the ti van der grijp et al 2021 3 ds allows co simulation either between the same type of variables e g continuous and continuous or different type of variables e g categorical and continuous by using different sources of information talebi et al 2019 selia et al 2022 the idea in this study is to use two different sources of precipitation information in the form of a continuous variable and apply the ds algorithm to reproduce the patterns containing the spatial characteristics of both information in this work we construct multivariate training images using two different sources of precipitation along with several covariates and co simulate the spatially connected precipitation patterns previous works which apply mps ensured that the spatial features of model output and the observation data be similar however such an ideal condition generally does not exist since the nwp models are set up based on several assumptions in our case one of the sources of data is a satellite derived precipitation product from integrated multi satellite retrievals for gpm imerg while the other data is a deterministic precipitation forecast obtained from the european centre for medium range weather forecasts ecmwf which is a global nwp model the importance lies in creating the training images using two precipitation sources since mps requires data at two spatial resolutions utilizing the data from two different sources is advantageous as data at two different spatial resolution may not be available from the same agency for a long time please note that for an easier representation of both datasets we refer to the satellite precipitation product as imerg and the forecast model output as ecmwf hereafter in this study both the data are derived in a common time period and a common spatial domain which is utilized to estimate the corresponding forecast data at each lead time in another time period in the same spatial domain further since the precipitation characteristics of satellite derived precipitation and that derived from a forecast model are generally different we also apply statistical correction methods such as the spatial moving average and spatial downscaling and bias correction sdbc to make them comparable further we apply the ds technique to generate 25 daily ensemble members of the improved precipitation forecast at the spatial resolution of 0 1 0 1 at the lead times lt of 1 3 and 5 days imerg is considered as the observation data in this study since the data from the rain gauges are generally unavailable in the region over regions such as the himalayas the satellite derived rainfall products are generally considered as the substitute for the ground based observatories murali krishna et al 2017 sharma et al 2020b the specific objectives of the study are a to address the mismatch between the patterns of the model derived ecmwf forecast and the satellite derived imerg observation data using the statistical correction measures such as the spatial moving average and sdbc approach b to apply the spatial moving average and sdbc approach to develop pattern enriched training images which can reproduce more accurate precipitation features c to select the different types of covariates topographical vegetative locational and weather related which can be best utilized to enhance the identification of regions having similar patterns over the complex northwest himalayas d to construct various multivariate training images including precipitation and other selected covariates which represents the spatial relationship among them e to stochastically relate the ecmwf and imerg datasets by applying the mps based statistical approach to generate future skillful ensemble forecasts which closely mimics the future imerg data the study is significant as it statistically generates ensemble of precipitation forecasts taking into account the complex topographical features of the himalayan region moreover the approach provides ensemble of forecast at point sites of avalanches and glaciers which is important for the overall hydrology of the himalayas the rest of the paper is organized as follows section 2 describes the study area and datasets used in the study the methods and experimental runs are explained in section 3 in section 4 the results are presented followed by the discussion of the results in section 5 section 6 deals with conclusions regarding the efficacy of the ds simulations in generating skillful precipitation forecasts 2 study area and datasets 2 1 study area the study area selected for this study is a spatial domain of 61 61 grids having a regular spacing of 0 1 10 km located over the northwest himalayas including parts of the tibetan plateau the area lies between 27on to 33on latitude and 75oe to 81oe longitude fig 1 a shows the location of the study area with its enlarged view presented in fig 1 b along with the sites of avalanches and glaciers considered in this study the area represents a high gradient in elevation which ranges between 100 6900 m the reasons for selecting the study area are 1 the area has historically been prone to heavy precipitation during the summer monsoon months of june july august and september jjas owing to the complex geographical location the presence of orography influences the characteristics of precipitation in the region 2 the region is home to hundreds of glaciers from where many important rivers originate 3 several areas are vulnerable to landslides avalanches and flash floods which cause large destruction of life and property the availability of a reliable precipitation forecast could be crucial in mitigating the losses 2 2 datasets two precipitation datasets are used in this study the first one is the deterministic precipitation forecast obtained from the ecmwf model for the period of 2007 to 2019 excluding the data for the year 2017 a total of 12 years the forecast for the year 2017 is currently not available on the tigge portal the data is interpolated to 0 25 0 25 spatial resolution using the bilinear interpolation at the portal itself the temporal resolution is daily at five day lead times the ecmwf forecast data is a worldwide popular dataset and several studies have used it in a variety of hydrological purposes fan et al 2015 li et al 2017a dias et al 2018 liu et al 2021 the second precipitation data used in the study is imerg which is a widely used satellite derived precipitation product several studies have used imerg in their studies over the himalayan region and found it reliable murali krishna et al 2017 sunilkumar et al 2019 ouyang et al 2020 sharma et al 2020b 2020a kumar et al 2021 the advantage with imerg data is the high temporal resolution and wide data coverage which is crucial for mountainous regions sharifi et al 2016 it is available at a spatial resolution of 0 1 0 1 and a temporal resolution of half hour we aggregate the half hourly data for the period from 2007 to 2019 to obtain the daily data at the same spatial scale we leave out the data for the year 2017 from imerg to make it consistent with that of the ecmwf forecast both datasets are obtained for the monsoon season i e jjas fig 2 shows the mismatch between the accumulated precipitation pattern of the imerg and ecmwf data for a sample month of june 2019 the primary reason for such a difference is that the precipitation data are obtained from two different sources one observation and the other forecast apart from the precipitation datasets we also use fine resolution static data called covariates related to certain environmental factors as shown in fig 1 c the data of elevation leaf area index and vegetation fraction are obtained from the har v2 dataset while the data for slope and aspect is derived from the elevation data using the arcgis software 3 methods this section presents the details of the statistical correction measures a brief overview of the ds algorithm the development of the various training images using the statistical correction measures and the description of the experimental set up followed in the study 3 1 statistical correction measures 3 1 1 spatial moving average in the spatial moving average approach a specific window of grids is selected to average the values contained in the grids of the window jha et al 2013c as a result the spatial field of the selected grids is smoothened thus reducing the variability in data this study applies the spatial moving average approach to the fine resolution imerg data to make its spatial field coherent with the coarse resolution spatial field of the ecmwf forecasts the spatial moving average approach is subsequently utilized in developing two kinds of ti as shown in fig 3 a2 and a4 3 1 2 statistical downscaling and bias correction sdbc the sdbc method involves statistical downscaling of the precipitation data to the finer spatial resolution prior to correcting the bias ahmed et al 2013 at point scale average precipitation scaling factors are found suitable to reduce the mismatch between precipitation from two different sources lutz et al 2014 chandel and ghosh 2021 however for spatial downscaling of gridded datsasets sdbc approach has been widely used in this study the sdbc approach is applied to the ecmwf forecast data as illustrated in fig 3 b to begin with the ecmwf forecast originally at 0 25 0 25 spatial resolution is interpolated to a finer resolution of 0 1 0 1 using linear interpolation the interpolated ecmwf data is then downscaled using a multiplicative correction factor obtained using the imerg data further the downscaled data is bias corrected using the quantile quantile mapping approach sennikovs and bethers 2009 it is worth mentioning here that the observation data is used twice in our approach first time at the time of estimating the correction factor between ecmwf at 25 km and imerg interpolated to 25 km and secondly while applying the bias correction between modified ecmwf at 10 km and imerg at 10 km since we are dealing with a spatial data it is expected to have different correction factor at every grid it would not be sufficient to simply multiply the data at coarser resolution ecmwf at 25 km spatial resolution with a correction factor especially when we don t have any observation data in the study area there was still a mismatch between the probability distribution of the two data modified ecmwf at 10 km and imerg at 10 km therefore we also needed to perform bias correction using a qualitile qunatile mapping approach the quantile quantile approach first determines a transfer function δ the transfer function is determined based on the deviation between the inverse of observed cumulative distribution function cdf of the variable of interest and the obtained model data the obtained transfer function is further multiplied with the cdf of the model data the equations involved in the quantile quantile approach are presented below 1 δ f 0 1 f m c a l x m c a l α m c a l β m c a l α o c a l β o c a l x m v a l 2 x bc v a l x m v a l δ f m v a l where fm cal and fo represents a cdf of the model data and the observed data respectively α and β represent the statistical distribution parameters of the data set for example α and β are mean and variance in case of normal distribution and shape and scale parameter in case of gamma distribution here δ is a transfer function for the model data xm which is calculated using the observed data 3 2 overview of the ds algorithm the primary aim of the ds algorithm is to fill the uninformed values of the simulation grid based on the neighbouring informed values or conditioning data to this end the algorithm relies on two basic components 1 identifying the data event of conditioning data already present in the simulation grid and 2 searching for a similar pattern as in the data event in the ti upon successful searching of the data event the resultant value is retrieved from the ti and transferred to the corresponding target pixel uninformed location in the sg for more details about the working principle of the ds algorithm please refer to mariethoz et al 2010 and the deesse 2017 documentation http www randlab org here we limit ourselves to exploring the efficacy of the algorithm in generating reliable precipitation forecasts using training data from two different sources 3 3 development of statistically corrected tis and working of ds in this study we develop different types of tis to incorporate the difference between the spatial features of precipitation obtained from a forecast model ecmwf data and an observation satellite imerg data to account for the mismatch in the spatial features from both precipitation datasets statistical correction measures are applied to develop the tis the types of tis developed in this study are a ti from raw ecmwf and imerg data b spatially smoothened ti using the spatial moving average approach on the imerg data c ti developed by applying the sdbc approach to the ecmwf forecast data and d ti developed by combining both the spatial moving average method and the sdbc approach the objective of developing the various tis especially using statistical measures is to obtain greater accuracy in the matching of patterns and superior reproduction of patterns a sample of the pixel based simulation by the ds algorithm using the various types of tis is illustrated in fig 3 c e a simulation grid is shown in fig 3 c1 consisting of the conditioning data from both ecmwf and imerg datasets from the conditioning data we select a data event containing the n closest informed pixels from both the precipitation sources as represented in fig 3 c2 here the central uninformed pixel x is the target pixel for which the sample simulation is performed next a comparable pattern to the data event is searched in the tis as represented in fig 3 d within a certain pre defined distance threshold in fig 3 d1 we observe that the patterns between the data event and the raw ti do not match well hence the patterns are searched in the smoothened ti fig 3 d2 the patterns match reasonably well when they are compared to the smoothened ti however it remains unsatisfactory a similar case is observed when the ds algorithm attempts to resample the patterns from the sdbc ti fig 3 d3 the patterns of the data event exactly match when they are compared to the patterns of the ti developed using the combination of spatial moving average and the sdbc approach smoothened sdbc ti as represented in fig 3 d4 due to the successful matching of patterns the central value y from the smoothened sdbc ti belonging to ecmwf is transferred to the corresponding location in sg fig 3f a similar sequence of steps is repeated until all the uninformed pixels are filled with values in this study we use the manhattan distance function to define the search neighborhood mariethoz et al 2012 jha et al 2013b singhal and jha 2021b singhal et al 2022a further in the ds algorithm the quality of simulation and optimum cpu run time depends upon the specification of certain parameters table 1 lists the parameters and their values used in this study similar to those in singhal and jha 2021b singhal et al 2022a however a sensitivity analysis was undertaken using multiple combinations of weights 1 0 1 and 0 01 to infer any change in the quality of simulations results for the sensitivity analysis do not indicate a significant difference in the results 3 4 arrangement of training images conditioning data and covariates the working of the ds algorithm requires the input dataset in the form of training images and conditioning data the ti contains data for all the years except for the target year the data of the target year at the coarse resolution is contained in the conditioning data to simplify suppose we have m years of data in that case the ti contains the data for m 1 years and the conditioning data for the mth year however any year between 1 to m year can be selected as the target year and consequently the data for that year is contained in the conditioning data further the ti contains data at both coarse p25 and fine p10 spatial resolution while the conditioning data comprises only the coarse resolution data the forecast data from ecmwf at each of the three lead times days 1 3 and 5 is denoted as p25 while the imerg is denoted as p10 in this study the data of each of the three lead times from ecmwf is used to construct a ti thus implying that three distinct tis are constructed for simulation in each ti the ecmwf data of a particular lead time is present along with the daily imerg data generally the spatial features of precipitation obtained from two different sources even for the same duration are different and hence applications of ds in hydrological sciences use a single data source for both coarse and fine resolutions however in this study we use the two aforementioned data sources to construct the ti the ti is composed of the data from 2007 to 2018 11 years while the cd is formed using the data for a single year i e 2019 the year 2019 is the target year for which the simulations will be carried out furthermore in order to assist in greater resampling of patterns from the ti we provide some additional information to the model in the form of static variables called covariates covariates also help in addressing the non stationarity in the ti especially over the northwest himalayas where several factors determine the occurrence of precipitation we use nine covariates in this study divided into four groups the groups are topographical covariates elevation slope and aspect vegetative covariates leaf area index and vegetative fraction locational covariates latitude and longitude and weather covariates p25 and p10 consequently precipitation forecasts are obtained for the year 2019 at 10 km spatial resolution assuming that the forecast data ecmwf is not available for that year 3 5 experimental design in this study we co simulate the daily precipitation data from ecmwf and imerg to perform four experiments as illustrated in fig 4 in each experiment three tis are constructed each pertaining to the precipitation of a different lead time a total of 12 experimental runs 4 experiments 3 lead times 12 runs are performed in the study each run is represented by the run number followed by the experiment number and the day of the lead time for example run1 exp1 lt1 denotes run number 1 of experiment number 1 dealing with the results for the first day lead time in each run the tis comprise 11 years of data 2007 2018 except 2017 from both ecmwf p25 and imerg p10 while the cd comprises only the ecmwf data for the target year the ds algorithm uses the patterns of tis and cd to estimate an ensemble containing 25 members of the daily ecmwf data for the monsoon season of the target year i e 2019 at 10 km spatial resolution the basic aim of the experiments is to obtain an improved and skillful daily ensemble of ecmwf forecasts whose spatial features closely resemble with those of the imerg data apart from the spatial evaluation we also test the algorithm s efficacy to generate reliable forecast data at point sites to this end we select ten sites each of avalanches and glaciers located over the north west himalayas further the co simulated forecast data at both spatial domain and point sites is verified with the available imerg data for the year 2019 using spatial maps and error statistics three error statistics are applied for the verification of obtained results which are root mean square error rmse mean absolute error mae and percentage bias pbias as listed below in eq 3 4 and 5 3 rmse 1 n i 1 n ob s i s i m i 2 4 mae 1 n i 1 n o b s i s i m i 5 pbias i 1 n s i m i o b s i 100 i 1 n o b s i 4 results the results obtained from the 12 experimental runs are presented in this section we analyse the simulated spatial patterns of ecmwf with respect to the reference imerg data followed by the evaluation of the simulation accuracy through error statistics next we focus on the results obtained at point sites of avalanches and glaciers we examine the extent of agreement between the time series of reference and the simulated forecast at each selected site along with the evaluation using error statistics in each of the experiments an ensemble comprising 25 members is generated which helps in considering the uncertainty involved with precipitation 4 1 qualitative evaluation of results in the spatial domain here we evaluate the performance of the ds algorithm to simulate the daily raw ecmwf forecast data for the monsoon months jjas of the year 2019 the results are presented at the monthly timescale however they are simulated daily we obtain the monthly results upon accumulating the daily results for each month 4 1 1 results from experiment 1 runs 1 3 the simulated spatial patterns of the precipitation forecast from experiment 1 runs 1 3 are shown in fig 5 the experiment deals with simulating the precipitation forecast using the imerg data without applying any statistical correction method in other words the experimental runs 1 3 do not generate improved precipitation forecasts instead it attempts to downscale the raw ecmwf having the spatial characteristics of the imerg data the results from the generation of improved precipitation forecasts are presented in experiments 2 4 please note that runs 1 3 correspond to the simulations for the forecast lead time 1 3 and 5 days respectively fig 5 a1 a4 represents the spatial patterns of the reference imerg data while b1 b4 c1 c4 and d1 d4 represent the raw model simulations from runs 1 2 and 3 respectively the focus in each run is to reproduce reasonably similar spatial patterns of the forecast when compared to those of the imerg data from fig 5 we observe that the algorithm is able to recognize the development of patterns in similar areas as of the reference however it is unable to estimate the patterns reasonably well results show that the patterns are better simulated for the months of july and august while they are underestimated for the months of june and september in terms of lead time we observe minor variations in the simulated patterns for different months for instance in the month of june all the lead times underestimate the simulated raw forecast out of which lt 5 run 3 seems to perform better for july the spatial patterns are reasonably similar for all three lead times moreover for august the simulated patterns lack spatial continuity and seem to be fragmented except for lt 3 run 2 where we observe reasonable continuity further in the case of september there is no clear indication of any lead time performing well enough and hence none of the experimental runs could simulate the raw forecast satisfactorily 4 1 2 results from experiment 2 runs 4 6 the simulated spatial patterns from experiment 2 runs 4 6 are represented in fig 6 it is worth repeating here that in these runs imerg data was smoothened using a moving window see fig 4 for more details about experiments fig 6 a1 a4 represents the reference imerg data while b1 b4 c1 c4 and d1 d4 represent the model simulations upon using the spatial window of moving average from runs 4 5 and 6 respectively results show that the spatially averaged simulations are spatially more homogenized and continuous as compared to the raw simulations moreover we observe that the spatial patterns of precipitation have improved for each month when compared to the reference with the most significant improvement observed for the month of september in september we see the development of precipitation patterns which were either absent in previous runs or were spatially fragmented in terms of the lead time we do not observe considerable changes in the simulations however minor variations in the magnitude of precipitation can be noticed for the months of august and september in both the months the magnitude increases in lt 3 run 5 and lt 4 run 6 when compared to lt 1 run 4 4 1 3 results from experiment 3 runs 7 9 fig 7 shows the simulated spatial patterns from experiment 3 runs 7 9 note that the input data was bias corrected using the sdbc approach see fig 4 for more details fig 7 a1 a4 represents the reference imerg data while b1 b4 c1 c4 and d1 d4 represent the model simulations upon bias correction from runs 7 8 and 9 respectively results show that the simulations improve upon applying the statistical downscaling and bias correction method however the improvements are not very significant when compared to the raw simulations for instance underestimations in values are evident for the month of june and september while the patterns for july and august are spatially discontinuous when compared to the reference imerg data 4 1 4 results from experiment 4 runs 10 12 in experiment 2 runs 4 6 the ds algorithm was used to obtain results after spatially averaging the imerg data present in the ti while in the experiment 3 runs 7 9 results were obtained after applying the sdbc approach to the same imerg data in experiment 4 runs 10 12 we blend both the experiments 2 and 3 as we apply the sdbc approach to the ecmwf data using the spatially averaged imerg data fig 8 represents the simulated spatial patterns from runs 10 12 where a1 a4 represents the reference imerg data while b1 b4 c1 c4 and d1 d4 represent the model simulations from runs 10 11 and 12 respectively visual inspection of fig 8 indicates that the simulated patterns have significantly improved and denote greater resemblance with the patterns of the reference imerg data we also observe that the results overcome the limitations displayed by the previous experiments in which the spatial patterns appeared to be fragmented and underestimated when compared to the reference for instance in the months of july and august the simulated patterns closely resemble the patterns of the reference data moreover changes in the lead time bring variations to the results in the case of july we see minor variations in the simulated patterns with lt 1 run 10 getting closest to the reference in august significant variations are evident in the lead times with lt 1 run 10 and lt 5 run 12 performing reasonably well in september too we find that ds is able to reproduce the patterns reasonably better than in the previous experiments with lt 1 run 10 showing reliable patterns although underestimated however in june we observed the same trend where ds is unable to replicate the reference patterns in the simulations across all the experimental runs 4 2 quantitative evaluation of results in the spatial domain in this section we perform a quantitative evaluation of the accuracy of the simulated results using error statistics the error estimates from each experiment are presented in fig 9 to understand the variations in the error values we show the spatial plot of pixel wise pbias in figure s1 of the supplementary material moreover we also plot the continuous ranked probability scores crps for each experimental run and present the same in figure s2 of the supplementary material please note that the errors are calculated for each of the 25 daily forecast ensemble members with respect to the reference and the mean monthly error values are presented 4 2 1 results for lt 1 runs 1 4 7 and 10 the idea here is to compare the results of lt 1 obtained from all four experiments the run1 exp1 lt1 deals with simulations of raw forecasts without the use of any statistical correction measure the evaluation will suggest if using statistical correction measures improve the quality of simulation generated by the ds algorithm for lt 1 results show consistent low error values for the months of june and september while higher values for july and august fig 9 as evident from fig 9 rmse values are highest in run 1 except for the month of july where run 7 shows a higher value 12 40 mm compared to run1 exp1 lt1 the values show a significant decrease for all the months in run4 exp2 lt1 however they increase again in run7 exp3 lt1 again the values show a decrease in run10 exp4 lt1 specifically in june 3 47 mm and september 7 28 mm overall in terms of rmse results suggest that run4 exp2 lt1 simulates better for the months of july and august while run10 exp4 lt1 simulates better for june and september moreover in the case of mae we observe that run1 exp1 lt1 seems to perform the best for all the months despite the fact that no statistical correction measure is applied therein further in the case of pbias the values are slightly overestimated in run1 exp1 lt1 for june pbias 13 40 while they are underestimated for the other three months in run4 exp2 lt1 pbias values show a substantial rise especially for the months of june and september thus denoting considerable overestimation of results further in run7 exp3 lt1 the values again decrease however they are significantly underestimated when compared to the previous runs in run10 exp4 lt1 we observe that for the month of june the pbias is slightly overestimated pbias 42 12 however the values are within a narrow range for all other months close to zero suggesting that the ds algorithm has performed reasonably well in run10 exp4 lt1 overall for lt 1 we find that applying statistical correction measures reduces the probability of errors out of all the runs run10 exp4 lt1 which involves both bias correction and spatial averaging performs the best 4 2 2 results for lt 3 runs 2 5 8 and 11 in the case of lt 3 we observe that run2 exp1 lt3 estimates the highest rmse values in the months of june and july while run8 exp3 lt3 shows the highest rmse in august and september see fig 9 similar to the trend observed in lt 1 the values decrease in run5 exp2 lt3 compared to run2 exp1 lt3 and again increase in run8 exp3 lt3 the lowest rmse values are estimated in run11 exp4 lt3 for all four months moreover in the case of mae the result show no clear trend of a particular experiment performing well enough for instance in june run8 exp3 lt3 shows the least mae 1 64 mm although the value is very close to the raw simulations run2 exp1 lt3 similarly in july run5 exp2 lt3 and run8 exp3 lt3 both show similar values 7 22 mm which is very close to the raw simulations of run2 exp1 lt3 7 23 mm in september run8 exp3 lt3 shows the least mae further in the case of pbias we find that the value is slightly overestimated in june pbias 33 76 while it is underestimated for all the other three months in run5 exp2 lt3 the values are highly overestimated for june and september while they are close to zero for july and august moreover in run8 exp3 lt3 the values decrease for june pbias 15 48 and september pbias 29 32 however the values are underestimated for the months of july and august among all the experimental runs run11 exp4 lt3 seems to estimate the most acceptable range of pbias values compared to run2 exp1 lt3 we notice that pbias is slightly increased in run11 exp4 lt3 for the month of june pbias 57 45 nevertheless all the other months show a significant decrease in the values overall for lt 3 we find that run11 exp4 lt3 estimates the most reliable results since two out of the three error statistics suggest lower values 4 2 3 results for lt 5 runs 3 6 9 and 12 in the case of lt 5 results show that the rmse values are highest in run3 exp1 lt5 for the months of june 3 66 mm and july 13 52 mm while they are highest in run9 exp3 lt5 for august 13 48 mm and september 8 28 mm rmse values are found to be lowest in run12 exp4 lt5 for all four months results from the previous two lead times lt 1 and lt 3 also suggested that simulations from exp 4 estimated the least rmse moreover in the case of mae we notice that run6 exp2 lt5 estimates the highest mae values for all four months run9 exp3 lt5 shows the lowest mae for june and july while run3 exp1 lt5 shows the lowest for august and september thus indicating that no particular experiment could produce reliable results using mae as the test statistic further in terms of pbias the trend appears similar to those observed in lt 1 and lt 3 for instance similar to the results of the previous lead times pbias values show overestimation in june and underestimation in the following months further the value increases sharply for june and september in run6 exp2 lt5 while dropping down significantly for july and august the values further decrease in run9 exp3 lt5 however they remain in an acceptable range closer to zero in run12 exp4 lt5 we find that the pbias values are much closer to zero as compared to those in run9 exp3 lt5 except for june overall for lt 5 results indicate that rmse and pbias values are much lower in run12 exp4 lt5 when compared to the values estimated in other experimental runs suggesting reasonably accurate performance by the algorithm 4 3 evaluation of results at point sites in this section we focus on simulating skillful daily precipitation forecast at ten selected point sites each of avalanches avasite and glaciers gsite at the three lead times for the year 2019 the estimated time series is verified using the corresponding imerg data of the same year both qualitatively and quantitatively for the qualitative evaluation we plot the respective time series while rmse and pbias are used for the quantitative assessment please note that in the case of point sites we present the results only from experiment 3 and experiment 4 since the two experiments showed reasonably good performance in simulating the forecast data in the spatial domain the time series plots from experiment 1 and 2 for avalanches shown in figures s3 and s4 and glaciers shown in figures s5 and s6 are presented in the supplementary material 4 3 1 qualitative results at avalanche sites from experiment 3 and 4 fig 10 presents the time series plot of the daily simulated precipitation forecast for the monsoon season at the five selected odd numbered avalanche sites for lt 1 lt 3 and lt 5 under experiment 3 and 4 for brevity we present the results of the even numbered locations in figure s7 of the supplementary material in experiment 3 the ti comprises the statistically downscaled and bias corrected ecmwf forecast using the raw imerg as p10 while p25 comprises the raw ecmwf data see fig 4 for more details each subplot in fig 10 includes the daily reference data 25 ensemble members of the simulated forecast and the mean of the ensemble results show that at avasite 1 the ensemble as well as it s mean is able to coincide well with the reference especially for lt 1 and lt 5 for lt 3 we find that the mean of the ensemble is unable to capture the higher peaks rather well we observe this trend to follow in the subsequent avalanche sites as well where the simulations for lt 1 and lt 5 perform considerably better than those for lt 3 at avasite 3 the simulated forecast is well able to capture the temporal variations in the precipitation data and the higher peaks are well reproduced for lt 1 and lt 5 the simulations for lt 5 perform relatively better than those for lt 1 and lt 3 at avasite 5 at avasite 7 we observe a slight underestimation in the mean of the ensemble however the ensemble is able to capture the reference time series well further at avasite 9 results suggest that the ensembles overestimate the simulations although the location of peaks is reasonably well captured for both lt 1 and lt 5 further in experiment 4 the statistically downscaled and bias corrected ecmwf forecast using the smoothened imerg is used as p10 in the ti whereas the raw ecmwf data forms the p25 and cd similar to the results in experiment 3 we observe in experiment 4 that simulations for lt 1 and lt 5 perform relatively better than lt 3 at almost all the avalanche sites specifically at avasite 1 we observe that even though the mean of the ensemble is unable to capture all the high peaks the ensemble members are able to coincide with the peaks quite well similarly for avasite 3 the mean ensemble peak is only able to match some of the high peaks however the ensemble members perform reasonably well simulations also show that the ensemble could also match one of the high peaks 100 mm formed primarily due to a possible extreme precipitation event as observed in lt 1 and lt 5 further at the avasite 5 we find that extreme events occur rarely and hence both the ensemble as well as its mean perform reasonably well to match the reference peaks lt 1 and lt 5 at avasite 7 the ensemble mean performs well in lt 1 however the performance deteriorates in the following lead times moreover the ensemble shows slight overestimation especially on days when precipitation is significantly low close to zero at avasite 9 results show that except for one peak 20 mm all other peaks are suitably matched by the simulations for all three lead times 4 3 2 qualitative results at glacier sites from experiment 3 and 4 the time series plot of daily simulated precipitation forecast for the monsoon season at the five selected odd numbered glacier sites for lt 1 lt 3 and lt 5 under experiment 3 and 4 is presented in fig 11 similar to the case of avalanche sites for brevity we present the results at the even numbered glacier sites in figure s8 of the supplementary material results show that at gsite 1 the mean of the ensemble does reasonably well to match the time series of the reference especially for lt 1 and lt 5 at gsite 3 we observe a few intermediate to high precipitation peaks present in the reference it is evident from fig 11 that the ensemble mean underestimated the peaks of the reference however we notice that the peaks are very well matched by the ensemble members for all three lead times moreover at gsite 5 the ensemble tend to overestimate precipitation for low and intermediate peaks however the extreme precipitation peak 110 mm is well captured in all three lead times at the gsite 7 the high peaks reproduced by the ensemble do not exactly match with the reference but may either be simulated a few days in advance or in delay further for gsite 9 the mean is able to coincide with the smaller and intermediate peaks but shows limitations in matching the high peaks the ensemble members are able to reproduce a few peaks however they may not be entirely accurate in experiment 4 we observe that there is more spread in the ensemble as compared to those obtained from experiment 3 at all the glacier sites and for all three lead times specifically at gsite 1 we notice that both the mean as well as the ensemble are able to match the peaks reasonably well for the lead times except for the last peak 45 mm at gsite 3 however the ensemble mean is not able to match the high peaks nevertheless the ensemble members seem to capture them quite well gsite 5 shows an extreme precipitation peak 110 mm which remains unmatched both by the ensemble mean and their members the small and intermediate peaks are captured by the ensemble satisfactorily for lt 1 and lt 5 gsite 7 show a similar pattern of precipitation owing to the closeness of their location simulations show that although small peaks are well reproduced the ensemble as well as its mean shows limited performance in matching the majority of the peaks at both sites and for all the lead times further at gsite 9 we notice that the two distinct higher peaks are not well simulated however the majority of the other peaks are satisfactorily reproduced 4 3 3 quantitative results at avalanche sites from experiment 3 and 4 here we perform the quantitative evaluation of the daily simulated precipitation forecast data at the avalanche sites under experiment 3 and 4 for the three lead times mean rmse and pbias values are presented in fig 12 a results from both experiments show that the rmse values are fairly low at all the avalanche sites specifically from experiment 3 the lowest rmse value is observed at avasite 9 0 76 mm for exp3 lt5 while the highest value is at avasite 2 5 21 mm for the same lead time further from experiment 4 the sites for the lowest and highest rmse values remain the same with the lowest rmse calculated at avasite 9 1 16 mm in exp4 lt1 and the highest for avasite 2 5 63 mm in exp4 lt5 further upon comparison of the results from the two experiments we find that experiment 3 performs relatively better than experiment 4 across all the avalanche sites and for all three lead times in the case of pbias large fluctuations are evident in the values among the avalanche sites for all three lead times specifically results from exp3 lt1 and exp3 lt5 perform better than exp3 lt3 as the latter estimates higher pbias moreover we notice that the pbias values change significantly for individual sites with the change in lead times for instance for lt 1 the pbias closest to zero is estimated at avasite 1 4 39 for lt 3 at avasite 5 3 34 while for lt 5 at site avasite 9 1 22 however such a distinction is absent for the results obtained from experiment 4 since for all the three lead times avasite 7 shows the pbias values closest to zero 5 02 3 83 and 3 84 respectively in both experiments the highest pbias is observed at avasite 1 for lt 5 further upon comparison of the results for the different lead times from the two experiments we find that experiment 3 performs better than experiment 4 for instance results suggest that the simulated forecast from experiment 3 is comparatively more reliable at 70 of the sites for lt 1 at 60 of the sites for lt 3 and at 80 of the sites for lt 5 the aforementioned inference reiterates the fact that the mean of the ensemble better coincided with the reference in experiment 3 4 3 4 quantitative results at glacier sites from experiment 3 and 4 the values of mean rmse and pbias calculated for the three lead times under exp 3 and exp 4 at the glacier sites are presented in fig 12 b the values are calculated based on the deviation of the mean of the ensemble with the reference results from both the experiments suggest that the highest mean rmse is estimated at gsite 10 for all three lead times 7 05 7 24 and 8 33 mm while the lowest value is estimated at gsite 4 1 14 0 91 and 1 09 the highest value is obtained from exp3 lt5 while the lowest value is from exp3 lt3 specifically under experiment 3 we observe that all three lead times perform well however lt 3 performs better than the other two lead times further results show that rmse values are higher from exp 4 for all three lead times as compared to those of experiment 3 among all the lead times values for lt 3 are the lowest moreover between the rmse values of avalanches and glacier sites we find that the values are higher for the glacier sites further in the case of pbias we notice that the values are high for some sites whereas they are quite low for others for instance under experiment 3 the highest pbias is found to be 72 51 at gsite 5 exp3 lt3 while the pbias closest to zero is at gsite 9 again for exp3 lt3 8 42 under experiment 4 the highest value increases to 91 53 at gsite 5 exp4 lt5 while the lowest value is estimated to be 16 87 at gsite 1 again for exp4 lt5 moreover under both the experiments and among all the three lead times we find that the results for lt 3 are more reliable and accurate than those for the other two lead times for instance under exp 3 we notice that at 80 of the sites simulated forecasts for lt 3 are more reliable than lt 1 and lt 5 under experiment 4 too results for lt 3 are better than the other two lead times at 50 of the sites further when we compare the performance of the simulated data at individual sites from both experiments we observe experiment 3 to perform better for instance under experiment 3 the simulated results are more reliable at 80 of the sites for lt 1 and lt 3 and 70 of the sites for lt 5 this inference suggests that similar to the avalanche sites the simulated forecast obtained at the glacier sites is more reliable under experiment 3 than those obtained under experiment 4 5 discussions the primary aim of this work is to generate future skillful ensemble forecasts by stochastically relating the model derived ecmwf precipitation forecast and the satellite derived imerg observation data since the forecast and the observation precipitation are obtained from different sources it leads to a mismatch in the spatial features between the two datasets sun et al 2018 li et al 2020 to account for the spatial mismatch we apply statistical correction approaches such as the spatial moving average and sdbc to develop pattern enriched multivariate training images the training images include the daily data of precipitation along with the static values of the topographical locational and vegetative covariates the mps based statistical approach is applied to identify extract and reproduce sufficient spatial patterns from the developed multivariate training images to this end we undertake four experiments comprising 12 experimental runs with the aim of generating improved and skillful ensemble forecasts over the northwest himalayas direct sampling one of the algorithms developed under mps is applied to simulate precipitation both in the spatial domain section 4 1 and at point sites of avalanches and glaciers section 4 3 specifically in the spatial domain results suggest that experiment 4 runs 10 12 simulates the precipitation forecast reasonably well both qualitatively and quantitatively in comparison to the other experiments the primary reason for the improved performance in experiment 4 is that the ecmwf data present in the ti is statistically downscaled and bias corrected using the smoothened imerg data bias correcting the precipitation forecast has been known to improve its reliability significantly well wang et al 2009 shah et al 2017 tiwari et al 2021 further we observe that the results obtained under experiment 3 runs 7 9 which involves bias correcting the ecmwf forecast using the raw imerg data are also satisfactory the ds algorithm is found to generate relatively inconsistent spatial patterns either overestimated or underestimated when experiments comprising the raw imerg experiment 1 runs 1 3 and spatially smoothened imerg experiment 2 runs 4 6 are undertaken this suggests that the statistical correction measures effectively assist the ds algorithm in reproducing the skillful forecast in the context of lead times the error estimators especially rmse and mae show minor variations in all the experimental runs however the pbias estimates indicate a definite trend as they show that the simulations for lt 1 are generally more reliable than the other two lead times in terms of monthly evaluation of results we observed that the rmse and mae values are significantly higher for july and august while they are lowest for june followed by september one of the reasons for higher error for july and august could be the heavier amount of precipitation observed during the two months 500 mm reproducing accurate heavy precipitation amounts is a difficult challenge for models especially over high mountainous regions such as the himalayas where orography plays a major role karki et al 2018 wang et al 2020 in the case of point sites results show that the simulated ensemble forecast is able to capture the temporal variability of the reference precipitation reasonably well we observe that either the mean of the ensemble or the 25 ensemble members coincide with the reference at most of the avalanche and glacier sites specifically at the avalanche sites the error values indicate that the simulations under experiment 3 perform relatively better than experiment 4 it is noteworthy here that for the spatial domain simulations under experiment 4 were found to be more reliable such a disparity between the results is possible because the error values may be homogenized for the spatial domain which consists of a total of 61 61 3721 grids moreover it is observed that the mean of the ensemble performs better under experiment 3 while the spread of the ensemble captures the reference time series comparatively better under experiment 4 in terms of the lead times simulations for lt 1 and lt 5 perform relatively better than those for lt 3 at the avalanche sites under both experiments also we observe that the ds algorithm is limited in capturing the high precipitation peaks as a result of extreme precipitation events singhal and jha 2021b the lack of availability of the high peak information in the training image limits the ability of the ds algorithm to capture them efficiently oriani et al 2014 jha et al 2015 further similar to the observation made for the avalanche sites at the glacier sites too experiment 3 performs relatively better than experiment 4 however in terms of the lead times results indicate that simulations for lt 3 are more reliable at the glacier sites than those for lt 1 and lt 5 such an anomaly in the performance of different lead times at the point sites is difficult to understand however it may be attributed to the complex topography and local climate physics of the himalayas where several complicated factors govern the precipitation outcomes overall the study is significant as it applies a statistical approach to effectively generate reliable and skillful ecmwf precipitation forecast with ensemble at various lead times over the much complicated region of the northwest himalayas moreover the ds algorithm exhibits plausible efficacy in estimating the forecast data at a spatial gridbox and also at crucial point sites of avalanches and glaciers the results can be beneficial for further studies over high mountain ranges such as the himalayas for forecasting avalanches and for understanding the hydro glaciology of critical glaciers especially in the context of climate change 6 conclusions in this study we statistically generate a reliable and skillful daily ensemble of ecmwf forecasts for the target year 2019 which mimic the future observation data the generated forecasts contain an ensemble of 25 members which takes care of the uncertainty involved with precipitation in previous studies related to mps the training image is generally composed of the same data source for both the coarse and fine resolution information which is not always possible in the present study we address the challenge of using two different sources of precipitation information model generated ecmwf and satellite derived imerg in the training image to co simulate the spatially connected precipitation patterns such that the simulation includes the spatial characteristics of both information to this end statistical correction measures such as the spatial moving average and sdbc are applied to generate pattern enriched multivariate training images the ti contains the imerg data at 10 km while the ecmwf forecast data at 25 km spatial resolution for the period of 2007 2018 excluding 2017 due to data unavailability the results suggest that the ds algorithm is able to reproduce the spatial patterns of the daily forecast data at each lead time by overcoming the non stationarity of the rain fields the inherent bias involved with precipitation forecast and the orographic influence present in the study area we show that using statistical correction measures such as i spatial moving average and ii spatial downscaling and bias correction helps in generating improved ensemble forecast data the experiments which involves the simulations containing only the raw ecmwf forecast depict less homogenous and fragmented patterns which subsequently show improvement after applying the correction measures compared to the raw simulations rmse and mae values show a slight improvement in the results from experiment 4 while the pbias value exhibits considerable improvement the improvement is evident for all the lead times especially in experiment 3 and 4 at the point sites we notice small variabilities in results when compared to those with the spatial domain at the point sites results show that experiment 3 performs relatively better than experiment 4 specifically at the avalanche sites results for lt 1 and lt 5 are more reliable compared to those for lt 3 however at the glacier sites all three lead times especially lt 3 perform well at both the sites the mean of the ensemble is efficient in matching the reference in experiment 3 while the spread of the ensemble is greater and hence much skilled in capturing the inconsistent nature of precipitation in experiment 4 in summary the work focusses on stochastically generating future skillful ensemble forecasts which closely mimics the future observation data the primary objective is to use two different sources of precipitation one satellite derived imerg and the other forecast model derived ecmwf in order to generate a reliable and accurate forecast product for the future the application involves creating training images using two precipitation sources which is advantageous as the data at two different spatial resolutions may not always be available from one agency for a long time the approach illustrated in this study presents a novel avenue for statistically generating an easy cost effective and reliable precipitation forecast containing ensemble in complicated regions around the world further the approach successfully estimates the forecast data at crucial point sites such as of avalanches and glaciers which is significant considering the current implications of climate change over such locations the application of the mps model in hydro meteorological studies is planned to be explored further future research will focus on using direct point observation data such as of the rain gauges in ds to generate interpolated training images also the temporal downscaling of observation as well as the forecast precipitation data can be performed considering the importance of such data at a fine temporal resolution over the himalayas credit authorship contribution statement akshay singhal conceptualization formal analysis writing original draft investigation funding acquisition validation visualization athul cheriyamparambil data curation formal analysis investigation visualization nibedita samal methodology validation visualization sanjeev k jha conceptualization methodology writing review editing investigation supervision validation funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the code for the ds algorithm used in this study was developed by the randlab team at the university of neuchâtel switzerland http www randlab org and it was obtained from dr gregoire mariethoz institute of earth surface dynamics university of lausanne we acknowledge the department of science and technology government of india for the financial support provided to mr akshay singhal for his doctoral work under the dst inspire scheme dst inspire 03 2019 001343 if 190257 we also thank the scheme for transformational and advanced research in sciences ministry of education moe stars grant number stars apr2019 ds 391 fs and the science and engineering research board serb department of science and technology government of india project number crg 2018 000649 for the research support it awarded to sanjeev kumar jha we thank four anonymous reviewers for their valuable comments data availability statement the imerg data used in the study is publicly available at https disc gsfc nasa gov dataset 20s gpm 3imergm 06 summary 20keywords imerg the ecmwf forecast data can be obtained from https apps ecmwf int datasets data tigge levtype sfc type cf the har v2 data is available at https www klima tu berlin de index php show daten har appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128795 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2623,availability of skillful precipitation forecast is crucial for regions such as the himalayas which directly influence millions of people in the indian subcontinent the deterministic raw forecasts obtained from the numerical weather prediction nwp models are often biased in this work we present a novel approach of considering the spatial mismatch between the precipitation forecast and observation data in developing a statistical model to deal with the mismatch in the spatial scale a famous alternative approach could be spatial downscaling and bias correction sdbc we attempt to blend the traditional approach of sdbc with a multiple point geostatistics mps approach to generate better skilled forecasts we consider the slope aspect and other topographical variables along with the nwp model output and observation data in a multivariate setup of the mps with sdbc model to generate skillful forecast ensembles we evaluate the daily generated 25 ensemble forecast members at avalanche and glacier sites the generated multiple forecast members allow us to assess the uncertainty in the precipitation forecast the outcome of the study would be helpful to water resource managers disaster relief authorities avalanche forecast agencies and climate change experts for the sustainable development of the himalayas keywords multiple point statistics mps precipitation forecast himalayas spatial downscaling and bias correction avalanche glaciers data availability data will be made available on request 1 introduction the medium range quantitative precipitation forecasts qpfs obtained from the numerical weather prediction nwp models predict the possible amount of precipitation over a certain region a few days in advance froude 2010 verdin et al 2016 traditionally the nwp models produce deterministic forecast which is single valued and represents the best estimate of future weather the deterministic forecasts are often considered unreliable as they do not take into account the uncertainty involved with precipitation and the errors in defining the initial conditions of the nwp model jha et al 2018 zhao et al 2021 therefore users like to have several forecast members ensemble from the nwp model based on varying initial conditions cuo et al 2011 hagelin et al 2017 however due to the high computational cost involved it becomes unfeasible to generate a large number of ensembles at fine spatial resolution availability of reliable precipitation forecasts is crucial especially in regions such as the himalayas since the snow and glaciers present in the region are a major source of fresh water for the millions of people living downstream moreover precipitation induced natural hazards such as flash floods avalanches etc take place frequently in the region joseph et al 2015 rakesh and kutty 2021 a reliable forecast of an impending precipitation event a few days in advance will help in decision support effective planning and management of water resources socio economic activities or emergency services to mitigate the impacts of a hazard singhal and jha 2021a singhal et al 2022b in the mountainous regions the raw forecast from an nwp model is likely to have limitations due to inaccurate model formulations sub grid scale parameterization and the presence of complex topography and orography das et al 2003 panziera et al 2011 chawla et al 2018 singh and kumar 2021 it is essential that the errors contained in the raw forecasts obtained from the nwp models are corrected before using them for operational purposes in the past several error correction methods have been developed and employed to improve the accuracy of the raw nwp forecasts li et al 2017b approaches such as the rank histogram calibration method hamill and colucci 1998 and quantile mapping gudmundsson et al 2012 samal and jha 2022 are easier to implement and cost effective for operational purposes however they have limitations in correcting the forecasts zhao et al 2017 another group of error correction methods is based on regression models including logistic regression messner et al 2014 and quantile regression friederichs and hense 2007 in recent years a popular group of error correction methods has been developed based on the joint probability of forecasts and long historical observations in such an approach a joint probability distribution is established between the forecast data predictors and the corresponding observations predictands to produce calibrated forecasts wang et al 2009 robertson 2013 shrestha et al 2015 although a variety of error correction methods have been used to obtain skillful raw forecasts to the best of our knowledge the efficacy of any geostatistical model capable of spatially correlating variables is yet to be explored multiple point geostatistics mps is a popular geostatistical concept based model which aims to simulate and reproduce the spatial patterns contained in a multivariate training dataset called the training image ti the ti represents prior information of the study area generally at both coarse and fine spatial resolutions the model derives patterns from the ti to simulate random fields of a simulation grid sg upon successful matching of the patterns between ti with sg certain pixels of sg is already filled with information known as the conditioning data cd cd along with several covariates assist in the proper matching of patterns in the last two decades mps has gained credibility in diverse research areas because of its ability to reproduce reliable spatial patterns and quantify spatial uncertainty by generating several realizations zuo et al 2020 for instance jha et al 2013a used the mps approach to downscale seasonal maps of environmental variables such as latent heat flux surface temperature and soil moisture again jha et al 2015 applied mps to downscale precipitation and temperature for the year 2005 while using 20 years of wrf output as a training image 1985 2004 in southeastern australia dembélé et al 2019 proposed an mps based framework for gap filling of streamflow data in the complex volta river basin of west africa recently singhal and jha 2021b used twelve years of wrf output 2001 2012 to obtain fine resolution precipitation and temperature for the year 2013 in a gridbox at districts and point locations over the northwest himalayas singhal et al 2022a further explored the potential of mps over the northwest himalayas this time to spatially extrapolate the downscaled wrf data of precipitation and temperature to a larger domain by using the training data of a smaller domain in most of the studies which apply mps the coarse and fine resolution information present in the ti is derived from the same source to obtain superior reproduction of patterns however in this study we explore the efficacy of mps in simulating the spatially connected patterns of precipitation when precipitation datasets from two different sources and at different spatial resolution are used to construct the ti further to reduce the inherent inconsistency between the spatial features of the two data sources data smoothening and bias correction methods are also applied details of which we see later among the several algorithms developed under the broader concept of mps we select the direct sampling ds algorithm developed by mariethoz et al 2010 for this study the advantages of using ds are 1 both univariate and multivariate simulations of categorical and continuous variables are well handled straubhaar and renard 2021 2 there is no need to store spatial patterns in a database prior to the simulations as ds extracts the samples directly from the ti van der grijp et al 2021 3 ds allows co simulation either between the same type of variables e g continuous and continuous or different type of variables e g categorical and continuous by using different sources of information talebi et al 2019 selia et al 2022 the idea in this study is to use two different sources of precipitation information in the form of a continuous variable and apply the ds algorithm to reproduce the patterns containing the spatial characteristics of both information in this work we construct multivariate training images using two different sources of precipitation along with several covariates and co simulate the spatially connected precipitation patterns previous works which apply mps ensured that the spatial features of model output and the observation data be similar however such an ideal condition generally does not exist since the nwp models are set up based on several assumptions in our case one of the sources of data is a satellite derived precipitation product from integrated multi satellite retrievals for gpm imerg while the other data is a deterministic precipitation forecast obtained from the european centre for medium range weather forecasts ecmwf which is a global nwp model the importance lies in creating the training images using two precipitation sources since mps requires data at two spatial resolutions utilizing the data from two different sources is advantageous as data at two different spatial resolution may not be available from the same agency for a long time please note that for an easier representation of both datasets we refer to the satellite precipitation product as imerg and the forecast model output as ecmwf hereafter in this study both the data are derived in a common time period and a common spatial domain which is utilized to estimate the corresponding forecast data at each lead time in another time period in the same spatial domain further since the precipitation characteristics of satellite derived precipitation and that derived from a forecast model are generally different we also apply statistical correction methods such as the spatial moving average and spatial downscaling and bias correction sdbc to make them comparable further we apply the ds technique to generate 25 daily ensemble members of the improved precipitation forecast at the spatial resolution of 0 1 0 1 at the lead times lt of 1 3 and 5 days imerg is considered as the observation data in this study since the data from the rain gauges are generally unavailable in the region over regions such as the himalayas the satellite derived rainfall products are generally considered as the substitute for the ground based observatories murali krishna et al 2017 sharma et al 2020b the specific objectives of the study are a to address the mismatch between the patterns of the model derived ecmwf forecast and the satellite derived imerg observation data using the statistical correction measures such as the spatial moving average and sdbc approach b to apply the spatial moving average and sdbc approach to develop pattern enriched training images which can reproduce more accurate precipitation features c to select the different types of covariates topographical vegetative locational and weather related which can be best utilized to enhance the identification of regions having similar patterns over the complex northwest himalayas d to construct various multivariate training images including precipitation and other selected covariates which represents the spatial relationship among them e to stochastically relate the ecmwf and imerg datasets by applying the mps based statistical approach to generate future skillful ensemble forecasts which closely mimics the future imerg data the study is significant as it statistically generates ensemble of precipitation forecasts taking into account the complex topographical features of the himalayan region moreover the approach provides ensemble of forecast at point sites of avalanches and glaciers which is important for the overall hydrology of the himalayas the rest of the paper is organized as follows section 2 describes the study area and datasets used in the study the methods and experimental runs are explained in section 3 in section 4 the results are presented followed by the discussion of the results in section 5 section 6 deals with conclusions regarding the efficacy of the ds simulations in generating skillful precipitation forecasts 2 study area and datasets 2 1 study area the study area selected for this study is a spatial domain of 61 61 grids having a regular spacing of 0 1 10 km located over the northwest himalayas including parts of the tibetan plateau the area lies between 27on to 33on latitude and 75oe to 81oe longitude fig 1 a shows the location of the study area with its enlarged view presented in fig 1 b along with the sites of avalanches and glaciers considered in this study the area represents a high gradient in elevation which ranges between 100 6900 m the reasons for selecting the study area are 1 the area has historically been prone to heavy precipitation during the summer monsoon months of june july august and september jjas owing to the complex geographical location the presence of orography influences the characteristics of precipitation in the region 2 the region is home to hundreds of glaciers from where many important rivers originate 3 several areas are vulnerable to landslides avalanches and flash floods which cause large destruction of life and property the availability of a reliable precipitation forecast could be crucial in mitigating the losses 2 2 datasets two precipitation datasets are used in this study the first one is the deterministic precipitation forecast obtained from the ecmwf model for the period of 2007 to 2019 excluding the data for the year 2017 a total of 12 years the forecast for the year 2017 is currently not available on the tigge portal the data is interpolated to 0 25 0 25 spatial resolution using the bilinear interpolation at the portal itself the temporal resolution is daily at five day lead times the ecmwf forecast data is a worldwide popular dataset and several studies have used it in a variety of hydrological purposes fan et al 2015 li et al 2017a dias et al 2018 liu et al 2021 the second precipitation data used in the study is imerg which is a widely used satellite derived precipitation product several studies have used imerg in their studies over the himalayan region and found it reliable murali krishna et al 2017 sunilkumar et al 2019 ouyang et al 2020 sharma et al 2020b 2020a kumar et al 2021 the advantage with imerg data is the high temporal resolution and wide data coverage which is crucial for mountainous regions sharifi et al 2016 it is available at a spatial resolution of 0 1 0 1 and a temporal resolution of half hour we aggregate the half hourly data for the period from 2007 to 2019 to obtain the daily data at the same spatial scale we leave out the data for the year 2017 from imerg to make it consistent with that of the ecmwf forecast both datasets are obtained for the monsoon season i e jjas fig 2 shows the mismatch between the accumulated precipitation pattern of the imerg and ecmwf data for a sample month of june 2019 the primary reason for such a difference is that the precipitation data are obtained from two different sources one observation and the other forecast apart from the precipitation datasets we also use fine resolution static data called covariates related to certain environmental factors as shown in fig 1 c the data of elevation leaf area index and vegetation fraction are obtained from the har v2 dataset while the data for slope and aspect is derived from the elevation data using the arcgis software 3 methods this section presents the details of the statistical correction measures a brief overview of the ds algorithm the development of the various training images using the statistical correction measures and the description of the experimental set up followed in the study 3 1 statistical correction measures 3 1 1 spatial moving average in the spatial moving average approach a specific window of grids is selected to average the values contained in the grids of the window jha et al 2013c as a result the spatial field of the selected grids is smoothened thus reducing the variability in data this study applies the spatial moving average approach to the fine resolution imerg data to make its spatial field coherent with the coarse resolution spatial field of the ecmwf forecasts the spatial moving average approach is subsequently utilized in developing two kinds of ti as shown in fig 3 a2 and a4 3 1 2 statistical downscaling and bias correction sdbc the sdbc method involves statistical downscaling of the precipitation data to the finer spatial resolution prior to correcting the bias ahmed et al 2013 at point scale average precipitation scaling factors are found suitable to reduce the mismatch between precipitation from two different sources lutz et al 2014 chandel and ghosh 2021 however for spatial downscaling of gridded datsasets sdbc approach has been widely used in this study the sdbc approach is applied to the ecmwf forecast data as illustrated in fig 3 b to begin with the ecmwf forecast originally at 0 25 0 25 spatial resolution is interpolated to a finer resolution of 0 1 0 1 using linear interpolation the interpolated ecmwf data is then downscaled using a multiplicative correction factor obtained using the imerg data further the downscaled data is bias corrected using the quantile quantile mapping approach sennikovs and bethers 2009 it is worth mentioning here that the observation data is used twice in our approach first time at the time of estimating the correction factor between ecmwf at 25 km and imerg interpolated to 25 km and secondly while applying the bias correction between modified ecmwf at 10 km and imerg at 10 km since we are dealing with a spatial data it is expected to have different correction factor at every grid it would not be sufficient to simply multiply the data at coarser resolution ecmwf at 25 km spatial resolution with a correction factor especially when we don t have any observation data in the study area there was still a mismatch between the probability distribution of the two data modified ecmwf at 10 km and imerg at 10 km therefore we also needed to perform bias correction using a qualitile qunatile mapping approach the quantile quantile approach first determines a transfer function δ the transfer function is determined based on the deviation between the inverse of observed cumulative distribution function cdf of the variable of interest and the obtained model data the obtained transfer function is further multiplied with the cdf of the model data the equations involved in the quantile quantile approach are presented below 1 δ f 0 1 f m c a l x m c a l α m c a l β m c a l α o c a l β o c a l x m v a l 2 x bc v a l x m v a l δ f m v a l where fm cal and fo represents a cdf of the model data and the observed data respectively α and β represent the statistical distribution parameters of the data set for example α and β are mean and variance in case of normal distribution and shape and scale parameter in case of gamma distribution here δ is a transfer function for the model data xm which is calculated using the observed data 3 2 overview of the ds algorithm the primary aim of the ds algorithm is to fill the uninformed values of the simulation grid based on the neighbouring informed values or conditioning data to this end the algorithm relies on two basic components 1 identifying the data event of conditioning data already present in the simulation grid and 2 searching for a similar pattern as in the data event in the ti upon successful searching of the data event the resultant value is retrieved from the ti and transferred to the corresponding target pixel uninformed location in the sg for more details about the working principle of the ds algorithm please refer to mariethoz et al 2010 and the deesse 2017 documentation http www randlab org here we limit ourselves to exploring the efficacy of the algorithm in generating reliable precipitation forecasts using training data from two different sources 3 3 development of statistically corrected tis and working of ds in this study we develop different types of tis to incorporate the difference between the spatial features of precipitation obtained from a forecast model ecmwf data and an observation satellite imerg data to account for the mismatch in the spatial features from both precipitation datasets statistical correction measures are applied to develop the tis the types of tis developed in this study are a ti from raw ecmwf and imerg data b spatially smoothened ti using the spatial moving average approach on the imerg data c ti developed by applying the sdbc approach to the ecmwf forecast data and d ti developed by combining both the spatial moving average method and the sdbc approach the objective of developing the various tis especially using statistical measures is to obtain greater accuracy in the matching of patterns and superior reproduction of patterns a sample of the pixel based simulation by the ds algorithm using the various types of tis is illustrated in fig 3 c e a simulation grid is shown in fig 3 c1 consisting of the conditioning data from both ecmwf and imerg datasets from the conditioning data we select a data event containing the n closest informed pixels from both the precipitation sources as represented in fig 3 c2 here the central uninformed pixel x is the target pixel for which the sample simulation is performed next a comparable pattern to the data event is searched in the tis as represented in fig 3 d within a certain pre defined distance threshold in fig 3 d1 we observe that the patterns between the data event and the raw ti do not match well hence the patterns are searched in the smoothened ti fig 3 d2 the patterns match reasonably well when they are compared to the smoothened ti however it remains unsatisfactory a similar case is observed when the ds algorithm attempts to resample the patterns from the sdbc ti fig 3 d3 the patterns of the data event exactly match when they are compared to the patterns of the ti developed using the combination of spatial moving average and the sdbc approach smoothened sdbc ti as represented in fig 3 d4 due to the successful matching of patterns the central value y from the smoothened sdbc ti belonging to ecmwf is transferred to the corresponding location in sg fig 3f a similar sequence of steps is repeated until all the uninformed pixels are filled with values in this study we use the manhattan distance function to define the search neighborhood mariethoz et al 2012 jha et al 2013b singhal and jha 2021b singhal et al 2022a further in the ds algorithm the quality of simulation and optimum cpu run time depends upon the specification of certain parameters table 1 lists the parameters and their values used in this study similar to those in singhal and jha 2021b singhal et al 2022a however a sensitivity analysis was undertaken using multiple combinations of weights 1 0 1 and 0 01 to infer any change in the quality of simulations results for the sensitivity analysis do not indicate a significant difference in the results 3 4 arrangement of training images conditioning data and covariates the working of the ds algorithm requires the input dataset in the form of training images and conditioning data the ti contains data for all the years except for the target year the data of the target year at the coarse resolution is contained in the conditioning data to simplify suppose we have m years of data in that case the ti contains the data for m 1 years and the conditioning data for the mth year however any year between 1 to m year can be selected as the target year and consequently the data for that year is contained in the conditioning data further the ti contains data at both coarse p25 and fine p10 spatial resolution while the conditioning data comprises only the coarse resolution data the forecast data from ecmwf at each of the three lead times days 1 3 and 5 is denoted as p25 while the imerg is denoted as p10 in this study the data of each of the three lead times from ecmwf is used to construct a ti thus implying that three distinct tis are constructed for simulation in each ti the ecmwf data of a particular lead time is present along with the daily imerg data generally the spatial features of precipitation obtained from two different sources even for the same duration are different and hence applications of ds in hydrological sciences use a single data source for both coarse and fine resolutions however in this study we use the two aforementioned data sources to construct the ti the ti is composed of the data from 2007 to 2018 11 years while the cd is formed using the data for a single year i e 2019 the year 2019 is the target year for which the simulations will be carried out furthermore in order to assist in greater resampling of patterns from the ti we provide some additional information to the model in the form of static variables called covariates covariates also help in addressing the non stationarity in the ti especially over the northwest himalayas where several factors determine the occurrence of precipitation we use nine covariates in this study divided into four groups the groups are topographical covariates elevation slope and aspect vegetative covariates leaf area index and vegetative fraction locational covariates latitude and longitude and weather covariates p25 and p10 consequently precipitation forecasts are obtained for the year 2019 at 10 km spatial resolution assuming that the forecast data ecmwf is not available for that year 3 5 experimental design in this study we co simulate the daily precipitation data from ecmwf and imerg to perform four experiments as illustrated in fig 4 in each experiment three tis are constructed each pertaining to the precipitation of a different lead time a total of 12 experimental runs 4 experiments 3 lead times 12 runs are performed in the study each run is represented by the run number followed by the experiment number and the day of the lead time for example run1 exp1 lt1 denotes run number 1 of experiment number 1 dealing with the results for the first day lead time in each run the tis comprise 11 years of data 2007 2018 except 2017 from both ecmwf p25 and imerg p10 while the cd comprises only the ecmwf data for the target year the ds algorithm uses the patterns of tis and cd to estimate an ensemble containing 25 members of the daily ecmwf data for the monsoon season of the target year i e 2019 at 10 km spatial resolution the basic aim of the experiments is to obtain an improved and skillful daily ensemble of ecmwf forecasts whose spatial features closely resemble with those of the imerg data apart from the spatial evaluation we also test the algorithm s efficacy to generate reliable forecast data at point sites to this end we select ten sites each of avalanches and glaciers located over the north west himalayas further the co simulated forecast data at both spatial domain and point sites is verified with the available imerg data for the year 2019 using spatial maps and error statistics three error statistics are applied for the verification of obtained results which are root mean square error rmse mean absolute error mae and percentage bias pbias as listed below in eq 3 4 and 5 3 rmse 1 n i 1 n ob s i s i m i 2 4 mae 1 n i 1 n o b s i s i m i 5 pbias i 1 n s i m i o b s i 100 i 1 n o b s i 4 results the results obtained from the 12 experimental runs are presented in this section we analyse the simulated spatial patterns of ecmwf with respect to the reference imerg data followed by the evaluation of the simulation accuracy through error statistics next we focus on the results obtained at point sites of avalanches and glaciers we examine the extent of agreement between the time series of reference and the simulated forecast at each selected site along with the evaluation using error statistics in each of the experiments an ensemble comprising 25 members is generated which helps in considering the uncertainty involved with precipitation 4 1 qualitative evaluation of results in the spatial domain here we evaluate the performance of the ds algorithm to simulate the daily raw ecmwf forecast data for the monsoon months jjas of the year 2019 the results are presented at the monthly timescale however they are simulated daily we obtain the monthly results upon accumulating the daily results for each month 4 1 1 results from experiment 1 runs 1 3 the simulated spatial patterns of the precipitation forecast from experiment 1 runs 1 3 are shown in fig 5 the experiment deals with simulating the precipitation forecast using the imerg data without applying any statistical correction method in other words the experimental runs 1 3 do not generate improved precipitation forecasts instead it attempts to downscale the raw ecmwf having the spatial characteristics of the imerg data the results from the generation of improved precipitation forecasts are presented in experiments 2 4 please note that runs 1 3 correspond to the simulations for the forecast lead time 1 3 and 5 days respectively fig 5 a1 a4 represents the spatial patterns of the reference imerg data while b1 b4 c1 c4 and d1 d4 represent the raw model simulations from runs 1 2 and 3 respectively the focus in each run is to reproduce reasonably similar spatial patterns of the forecast when compared to those of the imerg data from fig 5 we observe that the algorithm is able to recognize the development of patterns in similar areas as of the reference however it is unable to estimate the patterns reasonably well results show that the patterns are better simulated for the months of july and august while they are underestimated for the months of june and september in terms of lead time we observe minor variations in the simulated patterns for different months for instance in the month of june all the lead times underestimate the simulated raw forecast out of which lt 5 run 3 seems to perform better for july the spatial patterns are reasonably similar for all three lead times moreover for august the simulated patterns lack spatial continuity and seem to be fragmented except for lt 3 run 2 where we observe reasonable continuity further in the case of september there is no clear indication of any lead time performing well enough and hence none of the experimental runs could simulate the raw forecast satisfactorily 4 1 2 results from experiment 2 runs 4 6 the simulated spatial patterns from experiment 2 runs 4 6 are represented in fig 6 it is worth repeating here that in these runs imerg data was smoothened using a moving window see fig 4 for more details about experiments fig 6 a1 a4 represents the reference imerg data while b1 b4 c1 c4 and d1 d4 represent the model simulations upon using the spatial window of moving average from runs 4 5 and 6 respectively results show that the spatially averaged simulations are spatially more homogenized and continuous as compared to the raw simulations moreover we observe that the spatial patterns of precipitation have improved for each month when compared to the reference with the most significant improvement observed for the month of september in september we see the development of precipitation patterns which were either absent in previous runs or were spatially fragmented in terms of the lead time we do not observe considerable changes in the simulations however minor variations in the magnitude of precipitation can be noticed for the months of august and september in both the months the magnitude increases in lt 3 run 5 and lt 4 run 6 when compared to lt 1 run 4 4 1 3 results from experiment 3 runs 7 9 fig 7 shows the simulated spatial patterns from experiment 3 runs 7 9 note that the input data was bias corrected using the sdbc approach see fig 4 for more details fig 7 a1 a4 represents the reference imerg data while b1 b4 c1 c4 and d1 d4 represent the model simulations upon bias correction from runs 7 8 and 9 respectively results show that the simulations improve upon applying the statistical downscaling and bias correction method however the improvements are not very significant when compared to the raw simulations for instance underestimations in values are evident for the month of june and september while the patterns for july and august are spatially discontinuous when compared to the reference imerg data 4 1 4 results from experiment 4 runs 10 12 in experiment 2 runs 4 6 the ds algorithm was used to obtain results after spatially averaging the imerg data present in the ti while in the experiment 3 runs 7 9 results were obtained after applying the sdbc approach to the same imerg data in experiment 4 runs 10 12 we blend both the experiments 2 and 3 as we apply the sdbc approach to the ecmwf data using the spatially averaged imerg data fig 8 represents the simulated spatial patterns from runs 10 12 where a1 a4 represents the reference imerg data while b1 b4 c1 c4 and d1 d4 represent the model simulations from runs 10 11 and 12 respectively visual inspection of fig 8 indicates that the simulated patterns have significantly improved and denote greater resemblance with the patterns of the reference imerg data we also observe that the results overcome the limitations displayed by the previous experiments in which the spatial patterns appeared to be fragmented and underestimated when compared to the reference for instance in the months of july and august the simulated patterns closely resemble the patterns of the reference data moreover changes in the lead time bring variations to the results in the case of july we see minor variations in the simulated patterns with lt 1 run 10 getting closest to the reference in august significant variations are evident in the lead times with lt 1 run 10 and lt 5 run 12 performing reasonably well in september too we find that ds is able to reproduce the patterns reasonably better than in the previous experiments with lt 1 run 10 showing reliable patterns although underestimated however in june we observed the same trend where ds is unable to replicate the reference patterns in the simulations across all the experimental runs 4 2 quantitative evaluation of results in the spatial domain in this section we perform a quantitative evaluation of the accuracy of the simulated results using error statistics the error estimates from each experiment are presented in fig 9 to understand the variations in the error values we show the spatial plot of pixel wise pbias in figure s1 of the supplementary material moreover we also plot the continuous ranked probability scores crps for each experimental run and present the same in figure s2 of the supplementary material please note that the errors are calculated for each of the 25 daily forecast ensemble members with respect to the reference and the mean monthly error values are presented 4 2 1 results for lt 1 runs 1 4 7 and 10 the idea here is to compare the results of lt 1 obtained from all four experiments the run1 exp1 lt1 deals with simulations of raw forecasts without the use of any statistical correction measure the evaluation will suggest if using statistical correction measures improve the quality of simulation generated by the ds algorithm for lt 1 results show consistent low error values for the months of june and september while higher values for july and august fig 9 as evident from fig 9 rmse values are highest in run 1 except for the month of july where run 7 shows a higher value 12 40 mm compared to run1 exp1 lt1 the values show a significant decrease for all the months in run4 exp2 lt1 however they increase again in run7 exp3 lt1 again the values show a decrease in run10 exp4 lt1 specifically in june 3 47 mm and september 7 28 mm overall in terms of rmse results suggest that run4 exp2 lt1 simulates better for the months of july and august while run10 exp4 lt1 simulates better for june and september moreover in the case of mae we observe that run1 exp1 lt1 seems to perform the best for all the months despite the fact that no statistical correction measure is applied therein further in the case of pbias the values are slightly overestimated in run1 exp1 lt1 for june pbias 13 40 while they are underestimated for the other three months in run4 exp2 lt1 pbias values show a substantial rise especially for the months of june and september thus denoting considerable overestimation of results further in run7 exp3 lt1 the values again decrease however they are significantly underestimated when compared to the previous runs in run10 exp4 lt1 we observe that for the month of june the pbias is slightly overestimated pbias 42 12 however the values are within a narrow range for all other months close to zero suggesting that the ds algorithm has performed reasonably well in run10 exp4 lt1 overall for lt 1 we find that applying statistical correction measures reduces the probability of errors out of all the runs run10 exp4 lt1 which involves both bias correction and spatial averaging performs the best 4 2 2 results for lt 3 runs 2 5 8 and 11 in the case of lt 3 we observe that run2 exp1 lt3 estimates the highest rmse values in the months of june and july while run8 exp3 lt3 shows the highest rmse in august and september see fig 9 similar to the trend observed in lt 1 the values decrease in run5 exp2 lt3 compared to run2 exp1 lt3 and again increase in run8 exp3 lt3 the lowest rmse values are estimated in run11 exp4 lt3 for all four months moreover in the case of mae the result show no clear trend of a particular experiment performing well enough for instance in june run8 exp3 lt3 shows the least mae 1 64 mm although the value is very close to the raw simulations run2 exp1 lt3 similarly in july run5 exp2 lt3 and run8 exp3 lt3 both show similar values 7 22 mm which is very close to the raw simulations of run2 exp1 lt3 7 23 mm in september run8 exp3 lt3 shows the least mae further in the case of pbias we find that the value is slightly overestimated in june pbias 33 76 while it is underestimated for all the other three months in run5 exp2 lt3 the values are highly overestimated for june and september while they are close to zero for july and august moreover in run8 exp3 lt3 the values decrease for june pbias 15 48 and september pbias 29 32 however the values are underestimated for the months of july and august among all the experimental runs run11 exp4 lt3 seems to estimate the most acceptable range of pbias values compared to run2 exp1 lt3 we notice that pbias is slightly increased in run11 exp4 lt3 for the month of june pbias 57 45 nevertheless all the other months show a significant decrease in the values overall for lt 3 we find that run11 exp4 lt3 estimates the most reliable results since two out of the three error statistics suggest lower values 4 2 3 results for lt 5 runs 3 6 9 and 12 in the case of lt 5 results show that the rmse values are highest in run3 exp1 lt5 for the months of june 3 66 mm and july 13 52 mm while they are highest in run9 exp3 lt5 for august 13 48 mm and september 8 28 mm rmse values are found to be lowest in run12 exp4 lt5 for all four months results from the previous two lead times lt 1 and lt 3 also suggested that simulations from exp 4 estimated the least rmse moreover in the case of mae we notice that run6 exp2 lt5 estimates the highest mae values for all four months run9 exp3 lt5 shows the lowest mae for june and july while run3 exp1 lt5 shows the lowest for august and september thus indicating that no particular experiment could produce reliable results using mae as the test statistic further in terms of pbias the trend appears similar to those observed in lt 1 and lt 3 for instance similar to the results of the previous lead times pbias values show overestimation in june and underestimation in the following months further the value increases sharply for june and september in run6 exp2 lt5 while dropping down significantly for july and august the values further decrease in run9 exp3 lt5 however they remain in an acceptable range closer to zero in run12 exp4 lt5 we find that the pbias values are much closer to zero as compared to those in run9 exp3 lt5 except for june overall for lt 5 results indicate that rmse and pbias values are much lower in run12 exp4 lt5 when compared to the values estimated in other experimental runs suggesting reasonably accurate performance by the algorithm 4 3 evaluation of results at point sites in this section we focus on simulating skillful daily precipitation forecast at ten selected point sites each of avalanches avasite and glaciers gsite at the three lead times for the year 2019 the estimated time series is verified using the corresponding imerg data of the same year both qualitatively and quantitatively for the qualitative evaluation we plot the respective time series while rmse and pbias are used for the quantitative assessment please note that in the case of point sites we present the results only from experiment 3 and experiment 4 since the two experiments showed reasonably good performance in simulating the forecast data in the spatial domain the time series plots from experiment 1 and 2 for avalanches shown in figures s3 and s4 and glaciers shown in figures s5 and s6 are presented in the supplementary material 4 3 1 qualitative results at avalanche sites from experiment 3 and 4 fig 10 presents the time series plot of the daily simulated precipitation forecast for the monsoon season at the five selected odd numbered avalanche sites for lt 1 lt 3 and lt 5 under experiment 3 and 4 for brevity we present the results of the even numbered locations in figure s7 of the supplementary material in experiment 3 the ti comprises the statistically downscaled and bias corrected ecmwf forecast using the raw imerg as p10 while p25 comprises the raw ecmwf data see fig 4 for more details each subplot in fig 10 includes the daily reference data 25 ensemble members of the simulated forecast and the mean of the ensemble results show that at avasite 1 the ensemble as well as it s mean is able to coincide well with the reference especially for lt 1 and lt 5 for lt 3 we find that the mean of the ensemble is unable to capture the higher peaks rather well we observe this trend to follow in the subsequent avalanche sites as well where the simulations for lt 1 and lt 5 perform considerably better than those for lt 3 at avasite 3 the simulated forecast is well able to capture the temporal variations in the precipitation data and the higher peaks are well reproduced for lt 1 and lt 5 the simulations for lt 5 perform relatively better than those for lt 1 and lt 3 at avasite 5 at avasite 7 we observe a slight underestimation in the mean of the ensemble however the ensemble is able to capture the reference time series well further at avasite 9 results suggest that the ensembles overestimate the simulations although the location of peaks is reasonably well captured for both lt 1 and lt 5 further in experiment 4 the statistically downscaled and bias corrected ecmwf forecast using the smoothened imerg is used as p10 in the ti whereas the raw ecmwf data forms the p25 and cd similar to the results in experiment 3 we observe in experiment 4 that simulations for lt 1 and lt 5 perform relatively better than lt 3 at almost all the avalanche sites specifically at avasite 1 we observe that even though the mean of the ensemble is unable to capture all the high peaks the ensemble members are able to coincide with the peaks quite well similarly for avasite 3 the mean ensemble peak is only able to match some of the high peaks however the ensemble members perform reasonably well simulations also show that the ensemble could also match one of the high peaks 100 mm formed primarily due to a possible extreme precipitation event as observed in lt 1 and lt 5 further at the avasite 5 we find that extreme events occur rarely and hence both the ensemble as well as its mean perform reasonably well to match the reference peaks lt 1 and lt 5 at avasite 7 the ensemble mean performs well in lt 1 however the performance deteriorates in the following lead times moreover the ensemble shows slight overestimation especially on days when precipitation is significantly low close to zero at avasite 9 results show that except for one peak 20 mm all other peaks are suitably matched by the simulations for all three lead times 4 3 2 qualitative results at glacier sites from experiment 3 and 4 the time series plot of daily simulated precipitation forecast for the monsoon season at the five selected odd numbered glacier sites for lt 1 lt 3 and lt 5 under experiment 3 and 4 is presented in fig 11 similar to the case of avalanche sites for brevity we present the results at the even numbered glacier sites in figure s8 of the supplementary material results show that at gsite 1 the mean of the ensemble does reasonably well to match the time series of the reference especially for lt 1 and lt 5 at gsite 3 we observe a few intermediate to high precipitation peaks present in the reference it is evident from fig 11 that the ensemble mean underestimated the peaks of the reference however we notice that the peaks are very well matched by the ensemble members for all three lead times moreover at gsite 5 the ensemble tend to overestimate precipitation for low and intermediate peaks however the extreme precipitation peak 110 mm is well captured in all three lead times at the gsite 7 the high peaks reproduced by the ensemble do not exactly match with the reference but may either be simulated a few days in advance or in delay further for gsite 9 the mean is able to coincide with the smaller and intermediate peaks but shows limitations in matching the high peaks the ensemble members are able to reproduce a few peaks however they may not be entirely accurate in experiment 4 we observe that there is more spread in the ensemble as compared to those obtained from experiment 3 at all the glacier sites and for all three lead times specifically at gsite 1 we notice that both the mean as well as the ensemble are able to match the peaks reasonably well for the lead times except for the last peak 45 mm at gsite 3 however the ensemble mean is not able to match the high peaks nevertheless the ensemble members seem to capture them quite well gsite 5 shows an extreme precipitation peak 110 mm which remains unmatched both by the ensemble mean and their members the small and intermediate peaks are captured by the ensemble satisfactorily for lt 1 and lt 5 gsite 7 show a similar pattern of precipitation owing to the closeness of their location simulations show that although small peaks are well reproduced the ensemble as well as its mean shows limited performance in matching the majority of the peaks at both sites and for all the lead times further at gsite 9 we notice that the two distinct higher peaks are not well simulated however the majority of the other peaks are satisfactorily reproduced 4 3 3 quantitative results at avalanche sites from experiment 3 and 4 here we perform the quantitative evaluation of the daily simulated precipitation forecast data at the avalanche sites under experiment 3 and 4 for the three lead times mean rmse and pbias values are presented in fig 12 a results from both experiments show that the rmse values are fairly low at all the avalanche sites specifically from experiment 3 the lowest rmse value is observed at avasite 9 0 76 mm for exp3 lt5 while the highest value is at avasite 2 5 21 mm for the same lead time further from experiment 4 the sites for the lowest and highest rmse values remain the same with the lowest rmse calculated at avasite 9 1 16 mm in exp4 lt1 and the highest for avasite 2 5 63 mm in exp4 lt5 further upon comparison of the results from the two experiments we find that experiment 3 performs relatively better than experiment 4 across all the avalanche sites and for all three lead times in the case of pbias large fluctuations are evident in the values among the avalanche sites for all three lead times specifically results from exp3 lt1 and exp3 lt5 perform better than exp3 lt3 as the latter estimates higher pbias moreover we notice that the pbias values change significantly for individual sites with the change in lead times for instance for lt 1 the pbias closest to zero is estimated at avasite 1 4 39 for lt 3 at avasite 5 3 34 while for lt 5 at site avasite 9 1 22 however such a distinction is absent for the results obtained from experiment 4 since for all the three lead times avasite 7 shows the pbias values closest to zero 5 02 3 83 and 3 84 respectively in both experiments the highest pbias is observed at avasite 1 for lt 5 further upon comparison of the results for the different lead times from the two experiments we find that experiment 3 performs better than experiment 4 for instance results suggest that the simulated forecast from experiment 3 is comparatively more reliable at 70 of the sites for lt 1 at 60 of the sites for lt 3 and at 80 of the sites for lt 5 the aforementioned inference reiterates the fact that the mean of the ensemble better coincided with the reference in experiment 3 4 3 4 quantitative results at glacier sites from experiment 3 and 4 the values of mean rmse and pbias calculated for the three lead times under exp 3 and exp 4 at the glacier sites are presented in fig 12 b the values are calculated based on the deviation of the mean of the ensemble with the reference results from both the experiments suggest that the highest mean rmse is estimated at gsite 10 for all three lead times 7 05 7 24 and 8 33 mm while the lowest value is estimated at gsite 4 1 14 0 91 and 1 09 the highest value is obtained from exp3 lt5 while the lowest value is from exp3 lt3 specifically under experiment 3 we observe that all three lead times perform well however lt 3 performs better than the other two lead times further results show that rmse values are higher from exp 4 for all three lead times as compared to those of experiment 3 among all the lead times values for lt 3 are the lowest moreover between the rmse values of avalanches and glacier sites we find that the values are higher for the glacier sites further in the case of pbias we notice that the values are high for some sites whereas they are quite low for others for instance under experiment 3 the highest pbias is found to be 72 51 at gsite 5 exp3 lt3 while the pbias closest to zero is at gsite 9 again for exp3 lt3 8 42 under experiment 4 the highest value increases to 91 53 at gsite 5 exp4 lt5 while the lowest value is estimated to be 16 87 at gsite 1 again for exp4 lt5 moreover under both the experiments and among all the three lead times we find that the results for lt 3 are more reliable and accurate than those for the other two lead times for instance under exp 3 we notice that at 80 of the sites simulated forecasts for lt 3 are more reliable than lt 1 and lt 5 under experiment 4 too results for lt 3 are better than the other two lead times at 50 of the sites further when we compare the performance of the simulated data at individual sites from both experiments we observe experiment 3 to perform better for instance under experiment 3 the simulated results are more reliable at 80 of the sites for lt 1 and lt 3 and 70 of the sites for lt 5 this inference suggests that similar to the avalanche sites the simulated forecast obtained at the glacier sites is more reliable under experiment 3 than those obtained under experiment 4 5 discussions the primary aim of this work is to generate future skillful ensemble forecasts by stochastically relating the model derived ecmwf precipitation forecast and the satellite derived imerg observation data since the forecast and the observation precipitation are obtained from different sources it leads to a mismatch in the spatial features between the two datasets sun et al 2018 li et al 2020 to account for the spatial mismatch we apply statistical correction approaches such as the spatial moving average and sdbc to develop pattern enriched multivariate training images the training images include the daily data of precipitation along with the static values of the topographical locational and vegetative covariates the mps based statistical approach is applied to identify extract and reproduce sufficient spatial patterns from the developed multivariate training images to this end we undertake four experiments comprising 12 experimental runs with the aim of generating improved and skillful ensemble forecasts over the northwest himalayas direct sampling one of the algorithms developed under mps is applied to simulate precipitation both in the spatial domain section 4 1 and at point sites of avalanches and glaciers section 4 3 specifically in the spatial domain results suggest that experiment 4 runs 10 12 simulates the precipitation forecast reasonably well both qualitatively and quantitatively in comparison to the other experiments the primary reason for the improved performance in experiment 4 is that the ecmwf data present in the ti is statistically downscaled and bias corrected using the smoothened imerg data bias correcting the precipitation forecast has been known to improve its reliability significantly well wang et al 2009 shah et al 2017 tiwari et al 2021 further we observe that the results obtained under experiment 3 runs 7 9 which involves bias correcting the ecmwf forecast using the raw imerg data are also satisfactory the ds algorithm is found to generate relatively inconsistent spatial patterns either overestimated or underestimated when experiments comprising the raw imerg experiment 1 runs 1 3 and spatially smoothened imerg experiment 2 runs 4 6 are undertaken this suggests that the statistical correction measures effectively assist the ds algorithm in reproducing the skillful forecast in the context of lead times the error estimators especially rmse and mae show minor variations in all the experimental runs however the pbias estimates indicate a definite trend as they show that the simulations for lt 1 are generally more reliable than the other two lead times in terms of monthly evaluation of results we observed that the rmse and mae values are significantly higher for july and august while they are lowest for june followed by september one of the reasons for higher error for july and august could be the heavier amount of precipitation observed during the two months 500 mm reproducing accurate heavy precipitation amounts is a difficult challenge for models especially over high mountainous regions such as the himalayas where orography plays a major role karki et al 2018 wang et al 2020 in the case of point sites results show that the simulated ensemble forecast is able to capture the temporal variability of the reference precipitation reasonably well we observe that either the mean of the ensemble or the 25 ensemble members coincide with the reference at most of the avalanche and glacier sites specifically at the avalanche sites the error values indicate that the simulations under experiment 3 perform relatively better than experiment 4 it is noteworthy here that for the spatial domain simulations under experiment 4 were found to be more reliable such a disparity between the results is possible because the error values may be homogenized for the spatial domain which consists of a total of 61 61 3721 grids moreover it is observed that the mean of the ensemble performs better under experiment 3 while the spread of the ensemble captures the reference time series comparatively better under experiment 4 in terms of the lead times simulations for lt 1 and lt 5 perform relatively better than those for lt 3 at the avalanche sites under both experiments also we observe that the ds algorithm is limited in capturing the high precipitation peaks as a result of extreme precipitation events singhal and jha 2021b the lack of availability of the high peak information in the training image limits the ability of the ds algorithm to capture them efficiently oriani et al 2014 jha et al 2015 further similar to the observation made for the avalanche sites at the glacier sites too experiment 3 performs relatively better than experiment 4 however in terms of the lead times results indicate that simulations for lt 3 are more reliable at the glacier sites than those for lt 1 and lt 5 such an anomaly in the performance of different lead times at the point sites is difficult to understand however it may be attributed to the complex topography and local climate physics of the himalayas where several complicated factors govern the precipitation outcomes overall the study is significant as it applies a statistical approach to effectively generate reliable and skillful ecmwf precipitation forecast with ensemble at various lead times over the much complicated region of the northwest himalayas moreover the ds algorithm exhibits plausible efficacy in estimating the forecast data at a spatial gridbox and also at crucial point sites of avalanches and glaciers the results can be beneficial for further studies over high mountain ranges such as the himalayas for forecasting avalanches and for understanding the hydro glaciology of critical glaciers especially in the context of climate change 6 conclusions in this study we statistically generate a reliable and skillful daily ensemble of ecmwf forecasts for the target year 2019 which mimic the future observation data the generated forecasts contain an ensemble of 25 members which takes care of the uncertainty involved with precipitation in previous studies related to mps the training image is generally composed of the same data source for both the coarse and fine resolution information which is not always possible in the present study we address the challenge of using two different sources of precipitation information model generated ecmwf and satellite derived imerg in the training image to co simulate the spatially connected precipitation patterns such that the simulation includes the spatial characteristics of both information to this end statistical correction measures such as the spatial moving average and sdbc are applied to generate pattern enriched multivariate training images the ti contains the imerg data at 10 km while the ecmwf forecast data at 25 km spatial resolution for the period of 2007 2018 excluding 2017 due to data unavailability the results suggest that the ds algorithm is able to reproduce the spatial patterns of the daily forecast data at each lead time by overcoming the non stationarity of the rain fields the inherent bias involved with precipitation forecast and the orographic influence present in the study area we show that using statistical correction measures such as i spatial moving average and ii spatial downscaling and bias correction helps in generating improved ensemble forecast data the experiments which involves the simulations containing only the raw ecmwf forecast depict less homogenous and fragmented patterns which subsequently show improvement after applying the correction measures compared to the raw simulations rmse and mae values show a slight improvement in the results from experiment 4 while the pbias value exhibits considerable improvement the improvement is evident for all the lead times especially in experiment 3 and 4 at the point sites we notice small variabilities in results when compared to those with the spatial domain at the point sites results show that experiment 3 performs relatively better than experiment 4 specifically at the avalanche sites results for lt 1 and lt 5 are more reliable compared to those for lt 3 however at the glacier sites all three lead times especially lt 3 perform well at both the sites the mean of the ensemble is efficient in matching the reference in experiment 3 while the spread of the ensemble is greater and hence much skilled in capturing the inconsistent nature of precipitation in experiment 4 in summary the work focusses on stochastically generating future skillful ensemble forecasts which closely mimics the future observation data the primary objective is to use two different sources of precipitation one satellite derived imerg and the other forecast model derived ecmwf in order to generate a reliable and accurate forecast product for the future the application involves creating training images using two precipitation sources which is advantageous as the data at two different spatial resolutions may not always be available from one agency for a long time the approach illustrated in this study presents a novel avenue for statistically generating an easy cost effective and reliable precipitation forecast containing ensemble in complicated regions around the world further the approach successfully estimates the forecast data at crucial point sites such as of avalanches and glaciers which is significant considering the current implications of climate change over such locations the application of the mps model in hydro meteorological studies is planned to be explored further future research will focus on using direct point observation data such as of the rain gauges in ds to generate interpolated training images also the temporal downscaling of observation as well as the forecast precipitation data can be performed considering the importance of such data at a fine temporal resolution over the himalayas credit authorship contribution statement akshay singhal conceptualization formal analysis writing original draft investigation funding acquisition validation visualization athul cheriyamparambil data curation formal analysis investigation visualization nibedita samal methodology validation visualization sanjeev k jha conceptualization methodology writing review editing investigation supervision validation funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the code for the ds algorithm used in this study was developed by the randlab team at the university of neuchâtel switzerland http www randlab org and it was obtained from dr gregoire mariethoz institute of earth surface dynamics university of lausanne we acknowledge the department of science and technology government of india for the financial support provided to mr akshay singhal for his doctoral work under the dst inspire scheme dst inspire 03 2019 001343 if 190257 we also thank the scheme for transformational and advanced research in sciences ministry of education moe stars grant number stars apr2019 ds 391 fs and the science and engineering research board serb department of science and technology government of india project number crg 2018 000649 for the research support it awarded to sanjeev kumar jha we thank four anonymous reviewers for their valuable comments data availability statement the imerg data used in the study is publicly available at https disc gsfc nasa gov dataset 20s gpm 3imergm 06 summary 20keywords imerg the ecmwf forecast data can be obtained from https apps ecmwf int datasets data tigge levtype sfc type cf the har v2 data is available at https www klima tu berlin de index php show daten har appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 128795 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
2624,watershed scale streamflow routing models play a key role in real time flood forecasting flood risk evaluation and water resource management but the accuracy of modeled streamflow depends on both the spatial resolution and the accuracy of the runoff data used as the model forcing the production of new higher resolution runoff datasets therefore motivates an evaluation of the relative improvement in streamflow model performance this study evaluates streamflow routing output for the mississippi river basin with the simulations driven by three different runoff products from the european centre for medium range weather forecasts the first runoff product is the era interim surface and subsurface runoff dataset erai which was projected to a grid with a resolution of 39 km at the equator second this study considers the era5 reanalysis dataset era5 25km placed on a quarter degree grid 25 km resolution at the equator the simulations which generated era5 25km included land atmosphere coupling and land data assimilation the third runoff product is the era5 land dataset era5l 9km which was produced in an offline simulation at 9 km resolution without land atmosphere coupling or land data assimilation forced by the coarser era5 meteorological input for each runoff input streamflow was simulated by applying the routing application for parallel computation of discharge rapid model to the vectorized nhdplus stream network which comprised 1 2 million reaches within the study area comparison of modeled and measured daily and monthly mean discharge from 60 usgs gages reveals several broad trends streamflow simulated using the erai runoff tends to generate an earlier peak monthly discharge while peak discharge from the era5l 9km runoff systematically exceeds peak discharge from the era5 25km runoff basin aggregated model performance varies by metric with discharge simulated using the era5 25km runoff having the smallest median root mean square error even as the discharge modeled using era5l 9km runoff has the smallest median kling gupta efficiency model performance also varies spatially with all three simulations exhibiting the least accurate results in the western region of the mississippi river basin and by drainage area with more accurate results generally obtained for larger drainages these results suggest that streamflow model accuracy will benefit from the use of either era5 25km or era5l 9km runoff in place of erai however the selection of era5 25km versus era5l 9km depends on regional considerationsas well as which components of model performance are most critical to the user keywords streamflow routing mississippi river basin ecmwf era reanalysis rapid data availability all data for this project are available at the websites listed in the acknowledgments 1 introduction space and time varying estimation of hydrological conditions is critical for characterizing flow variability in riverine systems yet spatiotemporal gaps in global river discharge data comprise a major challenge to monitoring river conditions and predicting extreme events such as floods and droughts large scale streamflow routing models coupled with runoff generated from land surface models offer spatially and temporally continuous and consistent flow estimates that can supplement point observation data available over fixed time periods another primary use of river routing models concerns real time flood forecasting based on measured or modeled atmospheric inputs e g cloke and pappenberger 2009 lin et al 2018 qiao et al 2019 salas et al 2018 along with flood risk evaluation for hypothetical rainfall scenarios kling et al 2012 lytle et al 2020 such model results are particularly valuable in data poor regions which preclude statistical analyses of flood recurrence continental scale streamflow models are also imperative for water resource management particularly in transboundary watersheds e g de condappa and chaponnière 2009 döll et al 2003 eldardiry and hossain 2019 sikder et al 2019 and for predicting fluxes of particulate or dissolved material through large river systems e g bartosova et al 2021 jiang et al 2019 tavakoly et al 2019 zhang et al 2018 the accuracy of predicted streamflow is heavily dependent on the accuracy of the land atmosphere forcing and or assimilated data e g kabir et al 2022 this includes modeled or measured atmospheric input as well as the state variables within the land surface model lsm which convert atmospheric input into the local runoff values which force the streamflow routing model among global estimates of runoff e g beck et al 2017 döll et al 2003 lin et al 2019 yang et al 2021 long term and near real time runoff datasets produced by the european centre for medium range weather forecasts ecmwf are fully operational products at the global scale and include runoff fields harrigan et al 2020 evaluated the latest ecmwf atmospheric reanalysis era5 runoff products by comparing simulated streamflow results from the global flood awareness system glofas alfieri et al 2020 at the global scale their global streamflow evaluation of routed era5 runoff was considered satisfactory at 86 of stations however although their evaluation quantified the overall performance of the runoff product they called for further comprehensive regional evaluation of the era5 reanalysis dataset harrigan et al 2020 when streamflow routing models are used operationally for real time flood forecasting e g wahl et al 2016 it is necessary to understand which input datasets generate the most accurate streamflow output at local sub basin and basinwide spatial scales motivated by the recent availability of new reanalysis products such as the era5 suite from the ecmwf and the call for further evaluation of these products harrigan et al 2020 the goal of this study is to perform a basinwide evaluation of streamflow simulations driven by globally available reanalysis runoff datasets for this purpose the present study focuses on the effect of varying the reanalysis generated lsm runoff on streamflow simulations within a vector based continental scale river network to ensure reasonable comparison of the runoff s influence on simulated streamflow all other model parameters are constant between the various simulations streamflow model performance is evaluated for gages representing a broad range of drainage areas area 10 2 km 2 to 10 6 km 2 three different products were considered for evaluation in the present study the first is the ecmwf s re analysis interim erai runoff dataset for operational interests this product was projected to a t511 gaussian grid 39 km at the equator from a native tl255 gaussian grid 79 km at the equator see documentation from ecmwf 2010 the second product is version 5 of the ecmwf s fully coupled re analysis dataset era5 hersbach et al 2020 projected to an operational quarter degree grid 25 km at the equator from a native tl639 gaussian grid 31 km at the equator ecmwf 2016 the third product considered in this study is runoff from the era5 land dataset muñoz sabater et al 2021 this product was maintained at its native e g with respect to topographic treatment grid of 0 1 degree 9 km at equator ecmwf 2018 although intuition suggests that newer runoff products should display improved accuracy these results are not guaranteed for example a previous study by mahto and mishra 2019 found that erai runoff had a smaller median percent bias and a smaller root mean square error than era5 runoff for the indian subcontinent for consistency throughout this paper the three runoff forcings are hereafter abbreviated erai for era interim era5 25 km for the 25 km coupled era5 reanalysis and era5l 9 km for the era5 land rerun the paper proceeds as follows section 2 describes the hydrologic characteristics of the mississippi river basin mrb which is the test case used in this study section 3 details the methodology for the streamflow calculations including the routing model hydrography dataset and details concerning each of the three runoff datasets that will be evaluated as possible forcings to simulate streamflow section 4 then compares the accuracy of streamflow models forced by erai era5 25 km and era5l 9 km with respect to geographic location within the mrb and also with respect to drainage area 2 study area this study evaluates discharge routed through the mississippi river basin mrb which was selected for this study because of its importance to national and global interests the mrb is critical for the waterborne transport of industrial and agricultural products e g grossardt et al 2014 for example it has been estimated that over 25 of the global grain and seed trade is shipped from inland ports within the mrb fruin 1995 the system is additionally an important source of hydropower bonnet et al 2015 and drinking water for millions of people national research council 2007 the mrb was also selected because its large size causes the streamflow calculations to be computationally demanding globally only the amazon and nile rivers exceed the mississippi s channelized length and the mississippi s drainage area of 3 2 1 0 6 km 2 is exceeded only by the amazon congo and nile basins schumm and winkley 1994 knox 2007 tools to facilitate efficient hydrologic modeling for various end uses are still in active development e g david et al 2013a b 2015 and this study represents ongoing testing to evaluate the performance of these methods methods for calculating discharge in continental scale basins like the mrb must produce accurate results across diverse topographies climatological conditions and spatial scales the study area encompasses a wide range of environments in which relative streamflow model performance can be evaluated for example topography varies greatly across the basin with channel slopes ranging from order of 1 0 1 in the uplands to order of 10 5 at the mouth hydrologic conditions are also heterogeneous with climatic zones varying from semi arid to subtropical e g peel et al 2007 mean annual precipitation is as low as 250 mm in the missouri river tributary basin see fig 1 and as high as 1500 mm near the mouth wohl 2007 major floods in the northern mrb above keokuk iowa fig 1 have historically been snowmelt generated whereas flooding to the south is generally caused by rainfall olsen et al 1999 and extreme weather events such as hurricanes streamflow in the mrb is strongly influenced by reservoirs and irrigation although methods exist to model the effects of reservoirs on streamflow e g tavakoly et al 2021 vanderkelen et al 2022 reservoir routing is not implemented in the present study however because an identical model setup is used for all three simulations it is still possible to evaluate the relative influence of different runoff products on the streamflow routing results which is the primary objective of this paper such results are of particular value from an operational perspective e g wahl et al 2016 especially when streamflow routing models are used for real time flood forecasting without the availability of accurate reservoir outflow parameterization a further discussion of streamflow model performance in unregulated versus regulated catchments is provided in section 4 4 3 methods 3 1 streamflow routing model for this study the routing application for parallel computation of discharge model rapid david et al 2011 was implemented to simulate streamflow for the mrb the rapid model is fully parallelized and solves a matrix form of the muskingum equation in vector based river networks recent studies describe the advantages of using vector based river networks to simulate streamflow in large river systems e g david et al 2011 lin et al 2018 qiao et al 2019 tavakoly et al 2017 2021 yamazaki et al 2013 yang et al 2021 the vector based streamlines represent the actual location of rivers in the basins of interest the vector representation also allows for accurate positioning of water bodies such as lakes and reservoirs within the river system more importantly using mapped hydrography in the river model is crucial for identifying flooded regions in the study area tavakoly et al 2021 runoff is the main dynamic input in the rapid model the simulations were initialized with discharge q t 0 0 m 3 s for all reaches and streamflow was then forced by surface and subsurface runoff from the gridded ecmwf lsm the runoff variable is defined as the depth of water accumulated in a lsm grid cell during a time interval δ t and was converted into a volumetric non channelized inflow by taking the product of the runoff and the area of the catchment david et al 2013b for catchments which intersected multiple lsm grid cells the non channelized inflow was calculated using the area weighted average of the runoff values a detailed example of this areal weighting is available in the paper by tavakoly et al 2017 the geospatial river network for this study was based on version 2 of the medium resolution national hydrography dataset hereafter nhdplusv2 mckay et al 2014 moore and dewald 2016 a major benefit of nhdplusv2 is the positional accuracy of the stream channels which has been manually verified the geospatial data were provided as gis shapefiles in which each stream reach and the corresponding catchment have a distinct numeric identifier comid channel network connectivity was recorded both by the geospatial position of the reach endpoints as well as by recording the comid of the immediate downstream reach in the shapefile attribute table reach length and slope also were calculated using gis software and stored in the attribute table tavakoly et al 2017 within nhdplusv2 the mrb is comprised of 1 240 697 individual reaches with an average length of 1 9 km and an average catchment area of 2 7 km 2 the mouth has a strahler order of 10 rapid was calibrated using the method described by tavakoly et al 2017 which updates initial muskingum parameters by minimizing the difference between observed and modeled streamflow two years of variable infiltration capacity vic runoff and data from 34 usgs stream gauges were used to perform the calibration to ensure that the streamflow results for the present study would not be biased by differences in muskingum parameters no additional calibration was performed for the three input runoff datasets rather identical muskingum parameters as calculated by tavakoly et al 2017 for the vic runoff were used for all three streamflow simulations the efficacy of the rapid model for computing streamflow in major river networks is illustrated by several recent large scale implementations in the mrb tavakoly et al 2017 2021 the mekong river basin sikder et al 2019 and the ganges brahmaputra basin purdy et al 2019 sikder et al 2019 rapid has also been implemented for global scale river modeling lin et al 2019 qiao et al 2019 ridgill et al 2021 yang et al 2021 3 2 runoff data runoff data generated by the ecmwf reanalyses was used as forcing to simulate streamflow the reanalyses share in common the land atmosphere ocean modeling framework integrated forecast system or ifs though the framework evolved from reanalysis to reanalysis additional details on the ifs framework are available in the report by ecmwf 2016 3 2 1 era interim the era interim runoff data hereafter erai were produced by ecmwf using the earlier erai atmospheric forcing in conjunction with the htessel land surface model berrisford et al 2011 dee et al 2011 a study by beck et al 2017 which forced the htessel lsm with erai meteorological input found that the mean annual runoff predicted by htessel erai was lower than the measured value for the majority of small watersheds area 1 0 4 km 2 in the mrb additionally the timing of peak runoff due to snowmelt was systematically early for north america however the cited study modified precipitation fields with respect to different biases it should be noted that another ecmwf product the era interim land re analysis erai land includes a precipitation bias correction as documented by balsamo et al 2015 erai land may be a benchmark forcing dataset worth evaluating in future studies however its available temporal coverage only extends through 2010 which precluded its consideration within the present study 3 2 2 era5 the production of ecmwf s latest reanalysis era5 started in 2016 hersbach et al 2020 the updated product has higher spatial and temporal resolution than the earlier erai dataset and benefits from a decade of model physics and other developments the era5 integrated forecast system model ifs is run on a gaussian grid tl639 or about 31 km at the equator for the present study the era5 runoff data were interpolated onto a quarter degree cartesian grid measuring approximately 25 km at the equator although era5 is a fully coupled simulation which benefits from the continuous interaction between land and atmosphere it can also be impacted by idiosyncrasies of its land data assimilation process these include mass balance violations inherent in e g the addition or removal of snowpack when the data assimilation algorithm incorporates measured values into the model output important ramifications of the assimilation process include non negligible biases in cold regions zsoter et al 2019 for a study of india mahto and mishra 2019 concluded that era5 runoff was more accurate than the erai runoff based on r 2 and an overall performance score defined by graham et al 2019 although erai runoff had a smaller median percent bias and a smaller root mean square error than era5 runoff nevertheless streamflows exceeding the 95 th percentile had a smaller percent bias when forced by era5 a comparable study evaluating era5 versus erai runoff accuracy in north america has not been performed beck et al 2019 found that era5 precipitation was more accurate than erai precipitation in the united states based on kling gupta efficiency kling et al 2012 with the greatest differences between the two datasets occurring in the mountainous western regions of the country however considering the complex relationship between precipitation and runoff linsley 1967 peel and mcmahon 2020 these results do not guarantee that the era5 runoff is superior to erai runoff in the mrb 3 2 3 era5 land the third runoff dataset used in this study is a product of the ecmwf s re run of era5 at higher land fidelity documentation from ecmwf 2018 see also muñoz sabater et al 2021 improvements relative to the original coupled era5 model include higher resolution and physics enhancements the era5 land output is driven by yet uncoupled from the ecmwf s integrated forecast system ifs atmospheric model and no land data assimilation is incorporated however it benefits from its relatively fine topographic scales and orographic temperature correction the absence of land data assimilation causes era5 land to experience both improvements and degradations relative to era5 depending on when and where a particular metric is considered the era5 land runoff data used in this study are from the ecmwf s cartesian 0 1 degree grid which was projected from the native grid measuring 9 km at the equator 3 3 stream gage data a total of 60 united states geological survey usgs stream gages were selected for comparison with the model results fig 1 this sample size was considered large enough for comparing median model performance values e g krzywinski and altman 2014 while still accommodating the computational limitations associated with a larger dataset the gages were chosen to overlap with the results of tavakoly et al 2017 while also encompassing a wide range of drainage areas climates and topographies the smallest drainage in the dataset is the upper twin creek gage near mcgaw ohio with a usgs reported drainage area of 31 6 km 2 and a nhdplusv2 stream order of 3 the largest area corresponds to the mississippi river gage at vicksburg mississippi which has a usgs reported drainage area of 2 96 1 0 6 km 2 and a nhdplusv2 stream order of 10 gages downstream of vicksburg are not considered in this study to avoid the complications of tidal oscillations backwater dynamics and deltaic flow bifurcations which are not represented by the rapid model because reservoir flow routing affects the accuracy of rapid output salas et al 2018 tavakoly et al 2017 better model results are anticipated for unregulated drainages the number of reservoirs upstream of each usgs gage was determined by intersecting a point shapefile of global reservoir locations with the nhdplusv2 stream network using gis software the stream reach nearest to the reservoir location was flagged as containing a reservoir and the total number of flagged reaches upstream of each usgs gage was then counted and recorded out of the 60 drainages considered in this study 30 contain no mapped reservoirs the largest unregulated basin is the little missouri river gage near watford city north dakota which has a usgs reported drainage area of 2 15 1 0 4 km 2 and a nhdplusv2 stream order of 6 gages with no reservoirs upstream are shown as ecru colored points in fig 2 in contrast a total of 613 reservoirs were counted upstream of the vicksburg gage after downloading the discharge time series from the usgs website the data were processed to generate daily average discharge for each gage the duration and continuity of the datasets varied between locations with missing discharge measurements due to ice coverage sensor malfunction or any other reason recorded as no data values to ensure adequate data for robust analysis this study only included usgs gages with at least 5475 valid daily measurements the equivalent of 15 years of daily data if sampling was uninterrupted 3 4 study design the study proceeded as follows first discharge in the mrb was modeled using the nhdplusv2 hydrography and the three ecmwf runoff products erai era5 25 km and era5l 9 km for the 34 year period of record between 1 jan 1981 and 31 dec 2014 because the goal of the study was to compare the utility of various ecmwf runoff products for simulating streamflow the rapid model parameters were held constant for all three simulations to avoid any complicating influences on the streamflow results the simulated discharge was then compared to the usgs gage data to determine which runoff produced the most accurate streamflow values all model performance statistics omit the first six months of simulation to allow for model spinup so the results presented in this paper correspond to streamflow between 1 jul 1981 and 31 dec 2014 the six month spinup time is extremely conservative considering the 25 day flow concentration time used in prior studies of the mrb lewis et al 2019 and the 3 month spinup time identified for the comparably sized amazon basin emery et al 2020 model accuracy is analyzed using aggregated performance metrics for the entire mrb in addition regional variations in performance were evaluated for the following usgs huc 2 seaber et al 1987 basin subdivisions the missouri river basin 18 validation gages the arkansas white red basin 14 gages the upper mississippi basin 10 gages the ohio and tennessee basins 11 gages and the lower mississippi basin 7 gages note that the ohio basin and the tennessee basin are separate huc 2 regions under the usgs classification but they were merged into a single analysis region for this study due to the tennessee basin s comparatively small size the boundaries of these regions are shown as black lines in fig 1 model output is compared to daily average usgs discharge q using the percent bias pearson s correlation coefficient kling gupta efficiency variability score γ and normalized root mean square error these performance calculations include all available usgs data between 1 jul 1981 and 31 dec 2014 given n days of data from a time series of simulated discharge values q s t with corresponding observations q o t the percent bias is defined as 1 pbias i 1 n q s t i q o t i i 1 n q o t i 100 values of pbias 0 indicate that the model tends to overpredict daily streamflow whereas pbias 0 indicates a tendency towards underprediction a bias of 20 pbias 25 is considered acceptable for uncalibrated streamflow routing models adapted from moriasi et al 2011 salas et al 2018 pearson s correlation coefficient is calculated as 2 ρ 1 n 1 i 1 n q s t i μ s σ s q o t i μ o σ o here μ is the mean of the subscripted time series and σ is the standard deviation a value of ρ 1 indicates a perfect correlation between the measured and modeled daily streamflow whereas ρ 0 when there is no correlation between the two time series the kling gupta efficiency gupta et al 2009 kling et al 2012 is calculated as 3 kge 1 ρ 1 2 β 1 2 γ 1 2 1 2 with β μ s μ o and γ σ s μ o σ o μ s the three squared terms in the kge respectively account for the impacts of correlation bias and variability on overall streamflow model performance following tavakoly et al 2017 acceptable model performance is characterized by kge 0 4 and model performance is considered good when kge 0 6 finally the normalized root mean square error is calculated as 4 nrmse 1 n i 1 n q s t i q o t i 2 1 2 μ o a nrmse of 0 indicates perfect model performance relative to measured daily streamflow to evaluate seasonal trends in performance this study also compares measured and modeled monthly mean discharge at several gages for clarity this monthly averaging is symbolized by q with the symbol q reserved for daily discharge values the monthly mean is defined as the average of all daily values timestamped within a given month to ensure that each month is equally represented this analysis is constrained to data timestamped from 1 jan 1982 to 31 dec 2014 for example the monthly mean discharge for january is defined as the mean of all daily values from january 1982 january 1983 etc up through january 2014 finally model performance was evaluated based on a comparison of usgs derived and model derived recurrence intervals following the method of abramowitz and stegun 1964 equation 26 2 23 with parameters from kite 1977 for the usgs data the recurrence intervals are based on maximum annual flow for all years with a mostly complete usgs record between 1981 and 2014 if daily data were missing from the usgs record the corresponding dates were also discarded from the simulated discharge to account for the possibility that peak flow had not been measured for the m year recurrence interval with measured return flow q m o and simulated return flow q m s in m 3 s the accuracy of return flow is quantified by the percent error 5 pcterr m q m s q m o q m o 100 4 results and discussion 4 1 comparison of hydrographs daily hydrographs from six mainstem channels in the mrb are shown in fig 3 these plots emphasize the spatiotemporal variability of the streamflow model performance for the missouri river at omaha ne fig 3a all three runoff inputs generate a significant overprediction of the flood discharge which is interpreted as a consequence of four large capacity reservoirs see tavakoly et al 2017 that were not represented in the streamflow routing however because all three streamflow simulations used identical configurations and parameters this plot provides insight into relative inflow variations among the three forcing datasets in 2000 2001 and 2003 the erai runoff generated the largest magnitude flood discharge whereas the era5 25 km and era5l 9 km runoff inputs generated larger floods from 2005 2009 in contrast for the mississippi river at keokuk ia fig 3b the erai runoff input generated the largest flood discharge in most years while the era5 25 km and era5l 9 km forcings consistently generated smaller peak flow rates because the keokuk gaging site is not proximal to any major reservoirs errors in modeled streamflow at this location may be interpreted as errors in the input runoff upstream of keokuk measured peak discharge for the ohio river at metropolis il exceeds modeled peak discharge for all three runoff datasets during all years plotted in fig 3c the usgs gage data from metropolis also display a high frequency variability which is absent from all three streamflow simulations considering the proximity of several large reservoirs to the metropolis gage it is likely that flow regulation is partly responsible for differences between measured and simulated streamflow at this location however it should also be noted that the simulated total volume of water i e the time integrated discharge flowing past the metropolis gage is substantially smaller than the measured total volume for the 10 year period shown in fig 3c the erai runoff underpredicts the total volume of water by 40 the era5 25 km runoff underpredicts the total volume of water by 35 and the era5l 9 km runoff underpredicts the total volume of water by 23 over the full study duration 1 jul 1981 to 31 dec 2014 the underprediction of total volume is 31 for the erai forced streamflow model 31 for era5 25 km and 17 for era5l 9 km the persistence of these errors over multiple decades suggests that discrepancies between measured and simulated streamflow at this location are not due to release of impounded water but rather due to a regional underprediction of runoff by the ecmwf lsms usgs recorded streamflow from the arkansas river near little rock ar and the red river at spring bank ar also displays several large peaks in each calendar year fig 3d and e the streamflow output derived from the era5 25 km and era5l 9 km runoff reproduces this high frequency variability but the erai forced streamflow results for the little rock and spring bank gages have less frequent floods which are up to an order of magnitude smaller than the measured peak discharge these relative differences in streamflow model performance must be a consequence of varying accuracy among the three runoff datasets in particular fig 3d and e suggest that there are significant differences in the accuracy of era5 25 km and era5l 9 km runoff versus erai runoff in the arkansas white red river basin this is a more arid region where streamflow is strongly influenced by individual precipitation events causing geographically misplaced or missized rainfall to generate more incoherent hydrographs relative to the gaged curves for this study the gage nearest the mouth is the mississippi river at vicksburg ms a comparison of measured and simulated hydrographs from this location fig 3f indicates temporal variability in model performance in most instances the peak flow rate is underpredicted for streamflow simulated from erai era5 25 km and era5l 9 km runoff however the erai forced streamflow model overpredicts peak flood discharge in early 2005 the streamflow model results also display reduced overall accuracy in the latter half of the record for the vicksburg gage this is most evident in the underprediction of the flow rate from 2006 2009 especially for the erai forced model results the spatial variability in model performance is also apparent in the monthly averages q shown in fig 4 all runoff inputs overpredict peak flow for the strongly reservoir influenced missouri river at omaha ne while the three runoff datasets vary between over and underprediction at the other sites for example the erai forced discharge is positively biased for the mississippi river at keokuk ia but negatively biased for the arkansas river near little rock and the red river at spring bank the performance of streamflow simulations forced by the two era5 runoff products is also spatially variable but discharge simulated from era5l 9 km runoff is always greater in magnitude than the discharge simulated from era5 25 km runoff fig 4 also elucidates the runoff models varying ability to accurately predict peak discharge timing the erai runoff product generates an earlier peak discharge than era5 25 km or era5l 9 km for all sites except the arkansas river near little rock moreover the month of peak discharge predicted by the two era5 datasets is later than the known month for all six gages for example the usgs gage data indicate that q peaks in may for the mississippi river at vicksburg but the era5l 9 km and era5 25 km runoff products generate predictions of maximum q in june an extreme case is the missouri river at omaha where the usgs data peak in june the era5 25 km forced values achieve their maximum in august and the era5l 9 km forced values peak in september the geographic variability in the magnitude and timing of peak flow may be partly attributed to the proximity of unmodeled upstream reservoirs this is especially anticipated for gages such as the missouri river at omaha ne which is immediately downstream of a major reservoir however because reservoir routing was omitted from all three simulations differences in peak flow magnitude and timing also indicate differences in the behavior of the underlying lsms for example beck et al 2017 noted that peak runoff due to snowmelt is systematically early for the erai product which may contribute to the tendency for erai forced streamflow to achieve peak q earlier than era5 forced streamflow in fig 4 4 2 bulk distribution of performance metrics whereas section 4 1 considered results from six mainstem gages the following results evaluate aggregated model performance at all 60 gages shown in fig 1 the distributions of nrmse for discharge forced by era5 25 km and era5l 9 km are similar with median values of 1 47 and 1 56 respectively fig 5a the erai forced discharge has a higher median nrmse of 2 12 and a broader interquartile range than either of the era5 forced distributions this indicates that smaller errors between measured and modeled discharge can be expected on average for streamflow forced by the era5 runoff product the sign of these errors is characterized by pbias all three runoff products generate a median streamflow pbias below 0 for the full set of 60 gages although certain individual gages display a positive pbias among the three ecmwf inputs streamflow forced by the era5l 9 km runoff has the smallest magnitude median pbias of 7 although several outliers are present the median pbias for discharge simulated from the era5 25 km runoff is slightly larger in magnitude but the distribution of pbias values is narrower than observed for era5l 9 km the erai results also display a small magnitude median pbias but a broader range of values within the second and third quartiles notably the era5 25 km negative bias is consistent with mrb results from previous work using glofas era5 harrigan et al 2020 the variability metric γ which is defined in eq 3 measures the ratio of the mean normalized model standard deviation to the mean normalized observation standard deviation among the three runoff inputs considered in this paper streamflow simulated from the erai runoff displays the largest range of γ values fig 5c while streamflow simulated from the era5l 9 km runoff has the narrowest γ distribution although the interquartile range of the era5l 9 km γ distributions appears approximately symmetric about the optimal value of γ 1 it should be noted that values below 1 must be inverted prior to direct comparison with values above 1 for example a value of γ 0 5 indicates that the mean normalized observation standard deviation is twice as large as the mean normalized model standard deviation whereas a value of γ 2 indicates that the mean normalized model standard deviation is twice as large as the mean normalized observation standard deviation consequently fig 5c indicates that all three runoff inputs generate discharge predictions which fluctuate less γ 1 on average than the corresponding gage measurements as with the nrmse pbias and γ metrics the erai forced discharge displays the worst performance when measured by the correlation coefficient fig 5d the median value is ρ 0 36 and one of the 60 gages taylor arroyo near thatcher colorado displays ρ 0 the difference between the ρ distributions for the era5 25 km and era5l 9 km output is minimal the median values are ρ 0 51 and ρ 0 54 respectively and the distributions span a similar range of values however the second and third quartiles indicate slightly higher correlations for the era5l 9 km forced discharge interpretation of the kge is less straightforward than the interpretation of the other four metrics the erai forced output displays the worst median kge value of 0 05 fig 5e discharge simulated from the era5l 9 km runoff product has the highest median kge of 0 38 however streamflow simulated from the era5 25 km runoff has the largest maximum kge of 0 75 and a slightly smaller interquartile range than for era5l 9 km under the classification scheme of tavakoly et al 2017 model performance is characterized as acceptable when kge 0 4 consequently fewer than half of the stream gages are considered to have acceptable model performance as measured by kge when the streamflow model is forced by any of the three runoff products as described in section 3 3 the usgs gage data varied in duration and continuity all gages considered in this study have a minimum of 5475 daily streamflow measurements 15 years of data if sampling is continuous but gages with no missing data may have as many as 12 237 measurements between 1 jul 1981 and 31 dec 2014 to evaluate the performance metrics sensitivity to gage data duration the metrics were recalculated after randomly downsampling all usgs time series to exactly 5475 measurements as shown in figs 5f through 5j this sensitivity test generated minimal change in the distribution of nrmse pbias γ ρ or kge in particular the relative accuracy of the median values remained the same regardless of whether the performance metrics were calculated using all available usgs data or a randomly downsampled subset 4 3 spatial distribution of model performance as addressed in section 4 1 streamflow model performance varies by location to further examine spatial patterns in model accuracy figs 6 and 7 map the values of ρ pbias γ kge and nrmse for the 60 usgs gages the minimum median and maximum values of these metrics are also tabulated by huc 2 region in table 1 it was previously noted that streamflow simulated from the erai runoff tends to display lower correlations between measured and modeled values relative to streamflow simulated from the era5 25 km or era5l 9 km runoff products fig 6 visually emphasizes the low ρ values for the erai forced streamflow results and further suggests the absence of any spatial trends in correlation in contrast streamflow simulated from the era5 25 km and era5l 9 km runoff tends to display lower values of ρ in the western portion of the basin and higher values of ρ in the southeast although there are some locations where ρ 0 75 along the western basin boundary the absolute minimum value of ρ occurs in the arkansas white red river region for streamflow simulated from all three runoff products ρ min 0 01 for erai 0 08 for era5 25 km and 0 08 for era5l 9 km see table 1 but the lowest median ρ occurs in the missouri river basin for all three simulations ρ med 0 29 for erai 0 41 for era5 25 km and 0 44 for era5l 9 km see table 1 the highest median correlation occurs in the upper mississippi basin for streamflow from the erai runoff ρ med 0 43 and in the lower mississippi basin for streamflow from the era5 25 km and era5l 9 km runoff ρ med 0 56 and 0 57 respectively despite these general tendencies for lower correlations in the west the absolute maximum value of ρ occurs in the missouri river basin for streamflow simulated from both the era5 25 km and era5l 9 km runoff products ρ max 0 84 and 0 86 respectively regional trends in pbias are qualitatively similar among streamflow simulated from all three runoff datasets fig 6 maximum pbias always occurs in the arkansas red white region pbias max 289 for era5 25 km 381 for era5l 9 km and 2123 for erai see table 1 the smallest magnitude pbias values consistently occur in the eastern portion of the study area in the ohio and tennessee regions the median pbias values are pbias med 33 for era5 25 km 19 for erai and 15 for era5l 9 km notably 9 of the 11 gages in the ohio and tennessee regions display 20 pbias 25 when simulated from era5l 9 km runoff this range of pbias values is considered good under the classification scheme of moriasi et al 2011 and salas et al 2018 suggesting that the era5l 9 km runoff is particularly well suited for predicting unbiased streamflow in the easternmost region of the mrb for streamflow simulated from the era5 25 km and era5l 9 km runoff products the variability metric γ is uniformly within the range of 0 5 γ 2 for all gages east of 95 w longitude fig 6 see fig 1 for coordinate grid the variability also falls within this range for erai forced streamflow in the upper mississippi basin and most of the ohio and tennessee basins however there are several gages with 0 1 γ 0 5 in the south central portion of the mrb all of which are catchments with drainage area 1 0 4 km 2 extreme values of γ are most common in the arkansas white red and missouri river basins the most extreme γ value for the erai forced streamflow simulation is γ min 0 08 table 1 at taylor arroyo near thatcher colorado indicating that measured discharge displays 10 times higher variability than modeled discharge at this location meanwhile the streamflow simulations forced by era5 25 km and era5l 9 km runoff each have one instance in the missouri river basin where modeled discharge is 10 times more variable than measured discharge however fig 5 emphasizes that the mean normalized model standard deviation is within a factor of 2 of the mean normalized measurement standard deviation for the vast majority of streamflow results simulated from the era5 25 km and era5l 9 km runoff products fig 7 suggests a broad spatial pattern of increasing kge values from west to east across the mrb perhaps reflecting similar spatial trends of high to low magnitude pbias the absolute minimum kge occurs in the arkansas white red river basin for erai kge min 20 3 table 1 and in the missouri river basin for era5 25 km and era5l 9 km kge min 8 7 for streamflow simulated from both runoff products the smallest median kge values also occur in the missouri river basin for streamflow from all three runoff inputs kge med 0 59 for erai 0 15 for era5 25 km and 0 13 for era5l 9 km the highest median kge values are found in the ohio and tennessee river basin for erai forced streamflow kge med 0 26 in the lower mississippi basin for era5 25 km forced streamflow kge med 0 43 and in the upper mississippi basin for era5l 9 km forced streamflow kge med 0 45 despite this tendency for kge to be lower in the west and higher in the east individual gages deviate from the overall spatial trend this is illustrated for example by the occurrence of the absolute maximum kge value in the missouri river basin for streamflow simulated from era5 25 km runoff kge max 0 75 for the north platte river above seminoe reservoir wy and in the arkansas white red river basin for streamflow simulated from era5l 9 km runoff kge max 0 72 for the red river near spring bank ar like the kge the nrmse broadly improves from west to east fig 7 the absolute maximum nrmse values occur in the arkansas white red region for streamflow simulated from all three runoff products nrmse max 47 5 for erai 20 7 for era5 25 km and 23 2 for era5l 9 km table 1 meanwhile the smallest median nrmse always occurs in the ohio and tennessee basin nrmse med 1 14 for erai 1 00 for era5 25 km and 1 10 for era5l 9 km with median nrmse in the upper mississippi basin also being comparably low for all three runoff inputs the smallest normalized error of nrmse min 0 52 for erai 0 51 for era5 25 km and 0 47 for era5l 9 km corresponds to streamflow for the mississippi river at vicksburg which is the gage nearest the mouth of the network this result is of particular interest because it suggests that large errors in upstream reaches do not accumulate into an even larger error near the mouth when measured by the nrmse rather local streamflow errors due to e g inaccurate runoff input or the omission of reservoir routing effects appear to have limited influence on nrmse for reaches which are far downstream the results in figs 6 7 and table 1 are generally consistent with the findings of previous studies despite the absence of a one to one relationship between precipitation and runoff it is anticipated that inaccurate precipitation will challenge the lsm s ability to generate accurate runoff and therefore the streamflow model s ability to generate accurate discharge as has been observed in studies of other basins see kabir et al 2022 although it is difficult to validate precipitation performance due to measurement uncertainty and inconsistent gage density beck et al 2019 reported that era5 precipitation displays higher kge values than erai precipitation for the entire mrb with the exception of isolated regions of the rocky mountains in other words era5 precipitation is generally more accurate than erai precipitation for all gages east of 103 w longitude see fig 1 for coordinate grid other studies also indicate similar west east gradients in performance for example tarek et al 2020 noted apparently high precipitation biases in the western mrb and low biases in the east it is therefore conceivable that the more accurate discharge predictions from the era5 forced streamflow model particularly in the eastern portion of the mrb may be related to improvements in the ecmwf atmospheric model between the release of erai and era5 an earlier paper by tavakoly et al 2017 modeled streamflow using the nhdplusv2 network in conjunction with variable infiltration capacity vic runoff that study noted extremely low kge values for vic forced discharge in the arkansas white red river region of the mrb which was attributed to streamflow interactions with the high plains aquifer e g jachens et al 2021 tavakoly et al 2017 also found that the most accurate kge values for vic forced discharge occurred in the ohio and tennessee basins although there are site specific deviations the present study likewise indicates a tendency for better streamflow model performance in the eastern half of the mrb the spatial distribution of performance for rapid simulated streamflow using the era5 25 km runoff product is also generally consistent with spatial trends in streamflow performance from the era5 forced lisflood model harrigan et al 2020 which uses a gridded channel network representation similar to the results in fig 7 harrigan et al 2020 observed a broad west to east improvement in kge for era5 forced discharge in the mrb however harrigan et al 2020 obtained slightly higher kge values overall with the majority of gages in the ohio and tennessee region displaying kge 0 4 and many with kge 0 6 in contrast the present study obtained a median kge of 0 37 with a maximum of 0 54 for streamflow simulated using the era5 25 km runoff product in the ohio and tennessee region of the mrb this may be due to the inclusion of poorly performing small catchments see section 4 4 in the present study whereas harrigan et al 2020 limited their analysis to drainage areas exceeding 500 km 2 4 4 effect of drainage area on model performance as a broad generalization streamflow model performance improves with increasing drainage area fig 8 although there is considerable scatter the nrmse decreases as drainage area increases while the correlation coefficient ρ and the kge both increase with increasing drainage area for the streamflow simulations using erai runoff the variability also shifts from γ 1 for small drainage areas i e modeled streamflow variability smaller than measured streamflow variability to γ 1 for large drainage areas modeled streamflow variability larger than measured variability however the relationship between γ and drainage area is less pronounced when discharge is simulated using the era5 25 km and era5l 9 km runoff products a possible interpretation of these results is that the improved positional accuracy of a smaller runoff grid may lead to a more accurate model representation of the measured variability in streamflow out of the five metrics considered only the pbias displays no clear relationship with drainage area for any of the runoff forcings considering that the kge quantifies the combined effect of correlation bias and variability on overall model performance eq 3 evaluating patterns in the individual kge components provides insight into the cause of improved model performance in the large drainages in particular it should be noted that the relationship between ρ and drainage area fig 8 is more pronounced than the relationship between pbias and drainage area or the relationship between γ and drainage area this suggests that the improvement in kge for large basins is primarily driven by improvements to the correlation between measured and modeled discharge poor model performance in small catchments may be related to the spatial scale of runoff errors relative to total catchment size for example blöschl et al 2007 noted that land cover changes tend to be a local phenomenon which have the greatest overall impact on small catchments uncertainties in land cover within the lsm will affect the modeled runoff and the resulting errors in input runoff will have a proportionally larger impact on simulated streamflow when runoff is averaged over a small area this type of scale dependent streamflow model performance due to small scale landscape heterogeneity was previously noted by gharari et al 2020 also of note is that smaller catchment areas particularly in arid regions with strong meteorological gradients may be more susceptible to misplaced rainfall of inaccurate intensity within gridded atmospheric models tang et al 2021 this effect may then generate poor performance statistics in the smallest drainages in addition the relationship between ρ and drainage area may be attributed to flood attenuation as the wave travels downstream the muskingum method is based on a numerical approximation to the diffusive wave equation e g xiaofang et al 2008 as flow propagates through the channel network diffusion will smooth irregularities in upstream discharge caused by errors in the input runoff e g garbrecht 1991 as a result poor correlations between measured and modeled discharge in headwater catchments are likely to improve in the higher order reaches for this study the rapid model was run without incorporating reservoir routing considering that some earlier studies have observed improvements in simulated streamflow performance when reservoir effects were modeled salas et al 2018 tavakoly et al 2017 2021 zajac et al 2017 it is reasonable to expect a priori that more accurate results will be obtained for gages with no reservoirs upstream contrary to the expected behavior fig 8 indicates that better results are obtained on average for the 30 gages with one or more reservoirs upstream because all gages in the dataset with a drainage area 2 15 1 0 4 km 2 are regulated this phenomenon may be attributed to the positive correlation between model performance and basin size it is possible that further improvements in model performance could be obtained by including reservoir routing in the streamflow simulations although incorporating reservoir routing may also increase uncertainty in the performance statistics e g zajac et al 2017 if the necessary reservoir parameters are poorly constrained nevertheless fig 8 may be interpreted to indicate that poor model performance as measured by ρ and kge due to small basin size supersedes poor model performance due to the lack of reservoir routing the results in fig 8 are generally consistent with the results of earlier studies albergel et al 2018 previously reported that streamflow simulated using both erai and era5 runoff tends towards negative biases for basin areas exceeding 1 0 4 km 2 in the continental united states the large basins area 1 0 4 km 2 from the present study have a median streamflow pbias of 18 using the era5 25 km runoff 1 using the era5l 9 km runoff and 10 using the erai runoff because albergel et al 2018 used a different flow routing model ctrip than the present study a possible interpretation of these results is that the tendency towards negatively biased discharge is a consequence of negative biases in the input runoff rather than an artifact of the flow routing model the especially negative biases in streamflow simulated using the erai and era5 25 km runoff products may also be an artifact of their data assimilation scheme which reduces snow depth error via mass removal zsoter et al 2019 4 5 recurrence intervals the error distributions for the 2 year 10 year and 20 year flood discharge are shown in fig 9 all recurrence intervals for streamflow simulated using the erai runoff product have a negative median percent error pcterr that is the modeled flood discharge is typically smaller than the measured flood discharge regardless of flood magnitude this is consistent with the negative median pbias for the daily discharge values simulated using erai runoff the median percent errors for q 2 q 10 and q 20 are smaller in magnitude but still negative when the era5 25 km runoff is used as input for the streamflow model for streamflow simulated using era5l 9 km runoff the median pcterr is also near zero for q 2 q 10 and q 20 however the positive tail for the era5l 9 km distributions is always longer than the tail of the era5 25 km distributions this indicates that streamflow simulations using era5l 9 km runoff have a greater likelihood of overpredicting the flood discharge compared to streamflow simulations using era5 25 km runoff which is consistent with the hydrograph comparisons from section 4 1 spatial patterns of error in flood discharge fig 10 mirror spatial patterns in pbias for daily q fig 6 for discharge simulated using erai runoff large positive values of pcterr 2 yr and pcterr 20 yr are concentrated in the missouri river basin and along the western boundary of the arkansas white red basin whereas large negative values of pcterr 2 yr and pcterr 20 yr occur in the ohio and tennessee basins the lower mississippi basin the eastern half of the arkansas white red basin and the southeastern portion of the missouri river basin this pattern of positive pcterr values in the west and negative pcterr in the east persists for flood discharge magnitudes generated by era5 25 km and era5l 9 km runoff however the quantity of gages with pcterr 50 is smaller for the era5l 9 km results in particular the majority of gages in the ohio and tennessee basin have 50 pcterr 2 yr 20 and 50 pcterr 20 yr 20 in summary the results in fig 10 indicate that modeled return flow is more likely to exceed the gage derived return flow in the western portion of the mrb while gage derived return flow is more likely to exceed the modeled return flow in the eastern mrb although the magnitude of the error depends on which runoff product is selected as a forcing to simulate streamflow considering that the recurrence intervals are directly calculated from the discharge time series it is reasonable that peak flood discharge is overestimated in the western half of the mrb where pbias tends to be positive however this result was not guaranteed due to the possibility of differing flow probability distribution shapes in different regions of the study area it should also be noted that there are several gages where q 2 is overpredicted by the model while q 20 is underpredicted or vice versa 5 conclusion in response to a call for more comprehensive evaluation of lsm reanalysis products harrigan et al 2020 this paper evaluated the performance of streamflow routing in the mississippi river basin mrb forced by three runoff products from the european centre for medium range weather forecasting ecmwf the erai runoff dataset the era5 25 km reanalysis runoff which includes data assimilation and the 9 km era5 land runoff product aggregated streamflow results from 60 gages across the mrb suggest that streamflow simulated using the two era5 runoff products is consistently more accurate than streamflow simulated using the erai runoff the era5 25 km and era5l 9 km performance metrics have similar median values and the classification of a best performing runoff product for simulating streamflow depends on which metric nrmse pbias γ ρ or kge is considered across the mrb there is a broad tendency for poor performance in the western regions missouri river basin and arkansas white red basin and improved performance towards the east ohio and tennessee basins for streamflow forced by all three runoff products large positive percent errors in the 2 year 10 year and 20 year flood discharge tend to occur in the western portion of the mrb whereas the percent error in return flow is more likely to be negative in the eastern mrb this study strongly suggests that streamflow routing results improve overall within the mrb and perhaps elsewhere when either of the era5 runoff products are used in place of erai runoff identifying whether era5 25 km or era5l 9 km is the better forcing may be dependent on the geographic region period of record the and performance metric of interest although the effects of reservoirs and irrigation were not modeled this comparison of streamflow results driven by the three runoff products is still valid because the associated errors have an identical influence on all three simulations the selection of which performance metric to optimize will depend on which aspects of model performance are most critical to a specific model application in the present study inherent challenges related to stream gauge record overlap and spatiotemporal density limit the breadth of conclusions that can be drawn about a large climatologically diverse basin however the following generalizations follow from the results presented in this paper 1 the median values of nrmse pbias ρ and kge along with the percent error in 2 10 and 20 year return interval flows were slightly nearer to optimal for the era5l 9 km forcing this bolsters confidence that using era5l 9 km runoff generates an overall improvement relative to era5 25 km runoff nevertheless the median model variability was slightly better when forced by era5 25 km and it is not possible to establish true statistical significance for any of the metrics considered 2 both era5 runoff datasets generally appear to outperform erai runoff for similar reasons the median values of nrmse variability ρ and kge along with percent error of return interval flows were all slightly nearer to optimal for the era5 forcing however the median pbias was nearest to 0 for the erai forcing as in the previous conclusion true statistical significance for any of these metrics is difficult to establish 3 although no significant differences between era5 25 km and era5l 9 km were observed when considering the mrb data in aggregate there is evidence that era5l 9 km may be preferable to era5 25 km for generating less biased streamflow less biased return periods and higher kge values in the ohio and tennessee regions of the mrb 4 increased spatiotemporal coverage of the validation gages would be beneficial for addressing temporal mismatches such as differences in record length freeze thaw complications etc augmenting the present dataset could yield more significant differences between the forcings especially regionally and permit more detailed spatiotemporal fine graining 5 considering that none of the forcing datasets is clearly superior for all metrics conditions and locations e g in the western portion of the study area there could be value in streamflow prediction involving ensembles of forcing in such a scenario a variety of runoff products might inform a streamflow performance index derived from metrics concerning particular regions and conditions this performance index could then guide the user to select blends of ensemble members for particular end uses credit authorship contribution statement r l bain methodology formal analysis investigation writing original draft writing review editing visualization m j shaw methodology software formal analysis investigation writing review editing m p geheran software writing review editing a a tavakoly conceptualization writing review editing supervision project administration funding acquisition m d wahl conceptualization writing review editing supervision project administration funding acquisition e zsoter writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this project was partially funded as collaborative research between the u s army engineer research and development center noaa s national water center united states and the u s army corps of engineers regional sediment management program runoff data are available from the european centre for medium range weather forecasts https www ecmwf int daily discharge time series data were provided courtesy of usgs nwis http nwis waterdata usgs gov nwis dvstat referred module sw the authors are grateful for reviews from shervan gharari and the editorial board whose feedback improved the quality of the original manuscript 
2624,watershed scale streamflow routing models play a key role in real time flood forecasting flood risk evaluation and water resource management but the accuracy of modeled streamflow depends on both the spatial resolution and the accuracy of the runoff data used as the model forcing the production of new higher resolution runoff datasets therefore motivates an evaluation of the relative improvement in streamflow model performance this study evaluates streamflow routing output for the mississippi river basin with the simulations driven by three different runoff products from the european centre for medium range weather forecasts the first runoff product is the era interim surface and subsurface runoff dataset erai which was projected to a grid with a resolution of 39 km at the equator second this study considers the era5 reanalysis dataset era5 25km placed on a quarter degree grid 25 km resolution at the equator the simulations which generated era5 25km included land atmosphere coupling and land data assimilation the third runoff product is the era5 land dataset era5l 9km which was produced in an offline simulation at 9 km resolution without land atmosphere coupling or land data assimilation forced by the coarser era5 meteorological input for each runoff input streamflow was simulated by applying the routing application for parallel computation of discharge rapid model to the vectorized nhdplus stream network which comprised 1 2 million reaches within the study area comparison of modeled and measured daily and monthly mean discharge from 60 usgs gages reveals several broad trends streamflow simulated using the erai runoff tends to generate an earlier peak monthly discharge while peak discharge from the era5l 9km runoff systematically exceeds peak discharge from the era5 25km runoff basin aggregated model performance varies by metric with discharge simulated using the era5 25km runoff having the smallest median root mean square error even as the discharge modeled using era5l 9km runoff has the smallest median kling gupta efficiency model performance also varies spatially with all three simulations exhibiting the least accurate results in the western region of the mississippi river basin and by drainage area with more accurate results generally obtained for larger drainages these results suggest that streamflow model accuracy will benefit from the use of either era5 25km or era5l 9km runoff in place of erai however the selection of era5 25km versus era5l 9km depends on regional considerationsas well as which components of model performance are most critical to the user keywords streamflow routing mississippi river basin ecmwf era reanalysis rapid data availability all data for this project are available at the websites listed in the acknowledgments 1 introduction space and time varying estimation of hydrological conditions is critical for characterizing flow variability in riverine systems yet spatiotemporal gaps in global river discharge data comprise a major challenge to monitoring river conditions and predicting extreme events such as floods and droughts large scale streamflow routing models coupled with runoff generated from land surface models offer spatially and temporally continuous and consistent flow estimates that can supplement point observation data available over fixed time periods another primary use of river routing models concerns real time flood forecasting based on measured or modeled atmospheric inputs e g cloke and pappenberger 2009 lin et al 2018 qiao et al 2019 salas et al 2018 along with flood risk evaluation for hypothetical rainfall scenarios kling et al 2012 lytle et al 2020 such model results are particularly valuable in data poor regions which preclude statistical analyses of flood recurrence continental scale streamflow models are also imperative for water resource management particularly in transboundary watersheds e g de condappa and chaponnière 2009 döll et al 2003 eldardiry and hossain 2019 sikder et al 2019 and for predicting fluxes of particulate or dissolved material through large river systems e g bartosova et al 2021 jiang et al 2019 tavakoly et al 2019 zhang et al 2018 the accuracy of predicted streamflow is heavily dependent on the accuracy of the land atmosphere forcing and or assimilated data e g kabir et al 2022 this includes modeled or measured atmospheric input as well as the state variables within the land surface model lsm which convert atmospheric input into the local runoff values which force the streamflow routing model among global estimates of runoff e g beck et al 2017 döll et al 2003 lin et al 2019 yang et al 2021 long term and near real time runoff datasets produced by the european centre for medium range weather forecasts ecmwf are fully operational products at the global scale and include runoff fields harrigan et al 2020 evaluated the latest ecmwf atmospheric reanalysis era5 runoff products by comparing simulated streamflow results from the global flood awareness system glofas alfieri et al 2020 at the global scale their global streamflow evaluation of routed era5 runoff was considered satisfactory at 86 of stations however although their evaluation quantified the overall performance of the runoff product they called for further comprehensive regional evaluation of the era5 reanalysis dataset harrigan et al 2020 when streamflow routing models are used operationally for real time flood forecasting e g wahl et al 2016 it is necessary to understand which input datasets generate the most accurate streamflow output at local sub basin and basinwide spatial scales motivated by the recent availability of new reanalysis products such as the era5 suite from the ecmwf and the call for further evaluation of these products harrigan et al 2020 the goal of this study is to perform a basinwide evaluation of streamflow simulations driven by globally available reanalysis runoff datasets for this purpose the present study focuses on the effect of varying the reanalysis generated lsm runoff on streamflow simulations within a vector based continental scale river network to ensure reasonable comparison of the runoff s influence on simulated streamflow all other model parameters are constant between the various simulations streamflow model performance is evaluated for gages representing a broad range of drainage areas area 10 2 km 2 to 10 6 km 2 three different products were considered for evaluation in the present study the first is the ecmwf s re analysis interim erai runoff dataset for operational interests this product was projected to a t511 gaussian grid 39 km at the equator from a native tl255 gaussian grid 79 km at the equator see documentation from ecmwf 2010 the second product is version 5 of the ecmwf s fully coupled re analysis dataset era5 hersbach et al 2020 projected to an operational quarter degree grid 25 km at the equator from a native tl639 gaussian grid 31 km at the equator ecmwf 2016 the third product considered in this study is runoff from the era5 land dataset muñoz sabater et al 2021 this product was maintained at its native e g with respect to topographic treatment grid of 0 1 degree 9 km at equator ecmwf 2018 although intuition suggests that newer runoff products should display improved accuracy these results are not guaranteed for example a previous study by mahto and mishra 2019 found that erai runoff had a smaller median percent bias and a smaller root mean square error than era5 runoff for the indian subcontinent for consistency throughout this paper the three runoff forcings are hereafter abbreviated erai for era interim era5 25 km for the 25 km coupled era5 reanalysis and era5l 9 km for the era5 land rerun the paper proceeds as follows section 2 describes the hydrologic characteristics of the mississippi river basin mrb which is the test case used in this study section 3 details the methodology for the streamflow calculations including the routing model hydrography dataset and details concerning each of the three runoff datasets that will be evaluated as possible forcings to simulate streamflow section 4 then compares the accuracy of streamflow models forced by erai era5 25 km and era5l 9 km with respect to geographic location within the mrb and also with respect to drainage area 2 study area this study evaluates discharge routed through the mississippi river basin mrb which was selected for this study because of its importance to national and global interests the mrb is critical for the waterborne transport of industrial and agricultural products e g grossardt et al 2014 for example it has been estimated that over 25 of the global grain and seed trade is shipped from inland ports within the mrb fruin 1995 the system is additionally an important source of hydropower bonnet et al 2015 and drinking water for millions of people national research council 2007 the mrb was also selected because its large size causes the streamflow calculations to be computationally demanding globally only the amazon and nile rivers exceed the mississippi s channelized length and the mississippi s drainage area of 3 2 1 0 6 km 2 is exceeded only by the amazon congo and nile basins schumm and winkley 1994 knox 2007 tools to facilitate efficient hydrologic modeling for various end uses are still in active development e g david et al 2013a b 2015 and this study represents ongoing testing to evaluate the performance of these methods methods for calculating discharge in continental scale basins like the mrb must produce accurate results across diverse topographies climatological conditions and spatial scales the study area encompasses a wide range of environments in which relative streamflow model performance can be evaluated for example topography varies greatly across the basin with channel slopes ranging from order of 1 0 1 in the uplands to order of 10 5 at the mouth hydrologic conditions are also heterogeneous with climatic zones varying from semi arid to subtropical e g peel et al 2007 mean annual precipitation is as low as 250 mm in the missouri river tributary basin see fig 1 and as high as 1500 mm near the mouth wohl 2007 major floods in the northern mrb above keokuk iowa fig 1 have historically been snowmelt generated whereas flooding to the south is generally caused by rainfall olsen et al 1999 and extreme weather events such as hurricanes streamflow in the mrb is strongly influenced by reservoirs and irrigation although methods exist to model the effects of reservoirs on streamflow e g tavakoly et al 2021 vanderkelen et al 2022 reservoir routing is not implemented in the present study however because an identical model setup is used for all three simulations it is still possible to evaluate the relative influence of different runoff products on the streamflow routing results which is the primary objective of this paper such results are of particular value from an operational perspective e g wahl et al 2016 especially when streamflow routing models are used for real time flood forecasting without the availability of accurate reservoir outflow parameterization a further discussion of streamflow model performance in unregulated versus regulated catchments is provided in section 4 4 3 methods 3 1 streamflow routing model for this study the routing application for parallel computation of discharge model rapid david et al 2011 was implemented to simulate streamflow for the mrb the rapid model is fully parallelized and solves a matrix form of the muskingum equation in vector based river networks recent studies describe the advantages of using vector based river networks to simulate streamflow in large river systems e g david et al 2011 lin et al 2018 qiao et al 2019 tavakoly et al 2017 2021 yamazaki et al 2013 yang et al 2021 the vector based streamlines represent the actual location of rivers in the basins of interest the vector representation also allows for accurate positioning of water bodies such as lakes and reservoirs within the river system more importantly using mapped hydrography in the river model is crucial for identifying flooded regions in the study area tavakoly et al 2021 runoff is the main dynamic input in the rapid model the simulations were initialized with discharge q t 0 0 m 3 s for all reaches and streamflow was then forced by surface and subsurface runoff from the gridded ecmwf lsm the runoff variable is defined as the depth of water accumulated in a lsm grid cell during a time interval δ t and was converted into a volumetric non channelized inflow by taking the product of the runoff and the area of the catchment david et al 2013b for catchments which intersected multiple lsm grid cells the non channelized inflow was calculated using the area weighted average of the runoff values a detailed example of this areal weighting is available in the paper by tavakoly et al 2017 the geospatial river network for this study was based on version 2 of the medium resolution national hydrography dataset hereafter nhdplusv2 mckay et al 2014 moore and dewald 2016 a major benefit of nhdplusv2 is the positional accuracy of the stream channels which has been manually verified the geospatial data were provided as gis shapefiles in which each stream reach and the corresponding catchment have a distinct numeric identifier comid channel network connectivity was recorded both by the geospatial position of the reach endpoints as well as by recording the comid of the immediate downstream reach in the shapefile attribute table reach length and slope also were calculated using gis software and stored in the attribute table tavakoly et al 2017 within nhdplusv2 the mrb is comprised of 1 240 697 individual reaches with an average length of 1 9 km and an average catchment area of 2 7 km 2 the mouth has a strahler order of 10 rapid was calibrated using the method described by tavakoly et al 2017 which updates initial muskingum parameters by minimizing the difference between observed and modeled streamflow two years of variable infiltration capacity vic runoff and data from 34 usgs stream gauges were used to perform the calibration to ensure that the streamflow results for the present study would not be biased by differences in muskingum parameters no additional calibration was performed for the three input runoff datasets rather identical muskingum parameters as calculated by tavakoly et al 2017 for the vic runoff were used for all three streamflow simulations the efficacy of the rapid model for computing streamflow in major river networks is illustrated by several recent large scale implementations in the mrb tavakoly et al 2017 2021 the mekong river basin sikder et al 2019 and the ganges brahmaputra basin purdy et al 2019 sikder et al 2019 rapid has also been implemented for global scale river modeling lin et al 2019 qiao et al 2019 ridgill et al 2021 yang et al 2021 3 2 runoff data runoff data generated by the ecmwf reanalyses was used as forcing to simulate streamflow the reanalyses share in common the land atmosphere ocean modeling framework integrated forecast system or ifs though the framework evolved from reanalysis to reanalysis additional details on the ifs framework are available in the report by ecmwf 2016 3 2 1 era interim the era interim runoff data hereafter erai were produced by ecmwf using the earlier erai atmospheric forcing in conjunction with the htessel land surface model berrisford et al 2011 dee et al 2011 a study by beck et al 2017 which forced the htessel lsm with erai meteorological input found that the mean annual runoff predicted by htessel erai was lower than the measured value for the majority of small watersheds area 1 0 4 km 2 in the mrb additionally the timing of peak runoff due to snowmelt was systematically early for north america however the cited study modified precipitation fields with respect to different biases it should be noted that another ecmwf product the era interim land re analysis erai land includes a precipitation bias correction as documented by balsamo et al 2015 erai land may be a benchmark forcing dataset worth evaluating in future studies however its available temporal coverage only extends through 2010 which precluded its consideration within the present study 3 2 2 era5 the production of ecmwf s latest reanalysis era5 started in 2016 hersbach et al 2020 the updated product has higher spatial and temporal resolution than the earlier erai dataset and benefits from a decade of model physics and other developments the era5 integrated forecast system model ifs is run on a gaussian grid tl639 or about 31 km at the equator for the present study the era5 runoff data were interpolated onto a quarter degree cartesian grid measuring approximately 25 km at the equator although era5 is a fully coupled simulation which benefits from the continuous interaction between land and atmosphere it can also be impacted by idiosyncrasies of its land data assimilation process these include mass balance violations inherent in e g the addition or removal of snowpack when the data assimilation algorithm incorporates measured values into the model output important ramifications of the assimilation process include non negligible biases in cold regions zsoter et al 2019 for a study of india mahto and mishra 2019 concluded that era5 runoff was more accurate than the erai runoff based on r 2 and an overall performance score defined by graham et al 2019 although erai runoff had a smaller median percent bias and a smaller root mean square error than era5 runoff nevertheless streamflows exceeding the 95 th percentile had a smaller percent bias when forced by era5 a comparable study evaluating era5 versus erai runoff accuracy in north america has not been performed beck et al 2019 found that era5 precipitation was more accurate than erai precipitation in the united states based on kling gupta efficiency kling et al 2012 with the greatest differences between the two datasets occurring in the mountainous western regions of the country however considering the complex relationship between precipitation and runoff linsley 1967 peel and mcmahon 2020 these results do not guarantee that the era5 runoff is superior to erai runoff in the mrb 3 2 3 era5 land the third runoff dataset used in this study is a product of the ecmwf s re run of era5 at higher land fidelity documentation from ecmwf 2018 see also muñoz sabater et al 2021 improvements relative to the original coupled era5 model include higher resolution and physics enhancements the era5 land output is driven by yet uncoupled from the ecmwf s integrated forecast system ifs atmospheric model and no land data assimilation is incorporated however it benefits from its relatively fine topographic scales and orographic temperature correction the absence of land data assimilation causes era5 land to experience both improvements and degradations relative to era5 depending on when and where a particular metric is considered the era5 land runoff data used in this study are from the ecmwf s cartesian 0 1 degree grid which was projected from the native grid measuring 9 km at the equator 3 3 stream gage data a total of 60 united states geological survey usgs stream gages were selected for comparison with the model results fig 1 this sample size was considered large enough for comparing median model performance values e g krzywinski and altman 2014 while still accommodating the computational limitations associated with a larger dataset the gages were chosen to overlap with the results of tavakoly et al 2017 while also encompassing a wide range of drainage areas climates and topographies the smallest drainage in the dataset is the upper twin creek gage near mcgaw ohio with a usgs reported drainage area of 31 6 km 2 and a nhdplusv2 stream order of 3 the largest area corresponds to the mississippi river gage at vicksburg mississippi which has a usgs reported drainage area of 2 96 1 0 6 km 2 and a nhdplusv2 stream order of 10 gages downstream of vicksburg are not considered in this study to avoid the complications of tidal oscillations backwater dynamics and deltaic flow bifurcations which are not represented by the rapid model because reservoir flow routing affects the accuracy of rapid output salas et al 2018 tavakoly et al 2017 better model results are anticipated for unregulated drainages the number of reservoirs upstream of each usgs gage was determined by intersecting a point shapefile of global reservoir locations with the nhdplusv2 stream network using gis software the stream reach nearest to the reservoir location was flagged as containing a reservoir and the total number of flagged reaches upstream of each usgs gage was then counted and recorded out of the 60 drainages considered in this study 30 contain no mapped reservoirs the largest unregulated basin is the little missouri river gage near watford city north dakota which has a usgs reported drainage area of 2 15 1 0 4 km 2 and a nhdplusv2 stream order of 6 gages with no reservoirs upstream are shown as ecru colored points in fig 2 in contrast a total of 613 reservoirs were counted upstream of the vicksburg gage after downloading the discharge time series from the usgs website the data were processed to generate daily average discharge for each gage the duration and continuity of the datasets varied between locations with missing discharge measurements due to ice coverage sensor malfunction or any other reason recorded as no data values to ensure adequate data for robust analysis this study only included usgs gages with at least 5475 valid daily measurements the equivalent of 15 years of daily data if sampling was uninterrupted 3 4 study design the study proceeded as follows first discharge in the mrb was modeled using the nhdplusv2 hydrography and the three ecmwf runoff products erai era5 25 km and era5l 9 km for the 34 year period of record between 1 jan 1981 and 31 dec 2014 because the goal of the study was to compare the utility of various ecmwf runoff products for simulating streamflow the rapid model parameters were held constant for all three simulations to avoid any complicating influences on the streamflow results the simulated discharge was then compared to the usgs gage data to determine which runoff produced the most accurate streamflow values all model performance statistics omit the first six months of simulation to allow for model spinup so the results presented in this paper correspond to streamflow between 1 jul 1981 and 31 dec 2014 the six month spinup time is extremely conservative considering the 25 day flow concentration time used in prior studies of the mrb lewis et al 2019 and the 3 month spinup time identified for the comparably sized amazon basin emery et al 2020 model accuracy is analyzed using aggregated performance metrics for the entire mrb in addition regional variations in performance were evaluated for the following usgs huc 2 seaber et al 1987 basin subdivisions the missouri river basin 18 validation gages the arkansas white red basin 14 gages the upper mississippi basin 10 gages the ohio and tennessee basins 11 gages and the lower mississippi basin 7 gages note that the ohio basin and the tennessee basin are separate huc 2 regions under the usgs classification but they were merged into a single analysis region for this study due to the tennessee basin s comparatively small size the boundaries of these regions are shown as black lines in fig 1 model output is compared to daily average usgs discharge q using the percent bias pearson s correlation coefficient kling gupta efficiency variability score γ and normalized root mean square error these performance calculations include all available usgs data between 1 jul 1981 and 31 dec 2014 given n days of data from a time series of simulated discharge values q s t with corresponding observations q o t the percent bias is defined as 1 pbias i 1 n q s t i q o t i i 1 n q o t i 100 values of pbias 0 indicate that the model tends to overpredict daily streamflow whereas pbias 0 indicates a tendency towards underprediction a bias of 20 pbias 25 is considered acceptable for uncalibrated streamflow routing models adapted from moriasi et al 2011 salas et al 2018 pearson s correlation coefficient is calculated as 2 ρ 1 n 1 i 1 n q s t i μ s σ s q o t i μ o σ o here μ is the mean of the subscripted time series and σ is the standard deviation a value of ρ 1 indicates a perfect correlation between the measured and modeled daily streamflow whereas ρ 0 when there is no correlation between the two time series the kling gupta efficiency gupta et al 2009 kling et al 2012 is calculated as 3 kge 1 ρ 1 2 β 1 2 γ 1 2 1 2 with β μ s μ o and γ σ s μ o σ o μ s the three squared terms in the kge respectively account for the impacts of correlation bias and variability on overall streamflow model performance following tavakoly et al 2017 acceptable model performance is characterized by kge 0 4 and model performance is considered good when kge 0 6 finally the normalized root mean square error is calculated as 4 nrmse 1 n i 1 n q s t i q o t i 2 1 2 μ o a nrmse of 0 indicates perfect model performance relative to measured daily streamflow to evaluate seasonal trends in performance this study also compares measured and modeled monthly mean discharge at several gages for clarity this monthly averaging is symbolized by q with the symbol q reserved for daily discharge values the monthly mean is defined as the average of all daily values timestamped within a given month to ensure that each month is equally represented this analysis is constrained to data timestamped from 1 jan 1982 to 31 dec 2014 for example the monthly mean discharge for january is defined as the mean of all daily values from january 1982 january 1983 etc up through january 2014 finally model performance was evaluated based on a comparison of usgs derived and model derived recurrence intervals following the method of abramowitz and stegun 1964 equation 26 2 23 with parameters from kite 1977 for the usgs data the recurrence intervals are based on maximum annual flow for all years with a mostly complete usgs record between 1981 and 2014 if daily data were missing from the usgs record the corresponding dates were also discarded from the simulated discharge to account for the possibility that peak flow had not been measured for the m year recurrence interval with measured return flow q m o and simulated return flow q m s in m 3 s the accuracy of return flow is quantified by the percent error 5 pcterr m q m s q m o q m o 100 4 results and discussion 4 1 comparison of hydrographs daily hydrographs from six mainstem channels in the mrb are shown in fig 3 these plots emphasize the spatiotemporal variability of the streamflow model performance for the missouri river at omaha ne fig 3a all three runoff inputs generate a significant overprediction of the flood discharge which is interpreted as a consequence of four large capacity reservoirs see tavakoly et al 2017 that were not represented in the streamflow routing however because all three streamflow simulations used identical configurations and parameters this plot provides insight into relative inflow variations among the three forcing datasets in 2000 2001 and 2003 the erai runoff generated the largest magnitude flood discharge whereas the era5 25 km and era5l 9 km runoff inputs generated larger floods from 2005 2009 in contrast for the mississippi river at keokuk ia fig 3b the erai runoff input generated the largest flood discharge in most years while the era5 25 km and era5l 9 km forcings consistently generated smaller peak flow rates because the keokuk gaging site is not proximal to any major reservoirs errors in modeled streamflow at this location may be interpreted as errors in the input runoff upstream of keokuk measured peak discharge for the ohio river at metropolis il exceeds modeled peak discharge for all three runoff datasets during all years plotted in fig 3c the usgs gage data from metropolis also display a high frequency variability which is absent from all three streamflow simulations considering the proximity of several large reservoirs to the metropolis gage it is likely that flow regulation is partly responsible for differences between measured and simulated streamflow at this location however it should also be noted that the simulated total volume of water i e the time integrated discharge flowing past the metropolis gage is substantially smaller than the measured total volume for the 10 year period shown in fig 3c the erai runoff underpredicts the total volume of water by 40 the era5 25 km runoff underpredicts the total volume of water by 35 and the era5l 9 km runoff underpredicts the total volume of water by 23 over the full study duration 1 jul 1981 to 31 dec 2014 the underprediction of total volume is 31 for the erai forced streamflow model 31 for era5 25 km and 17 for era5l 9 km the persistence of these errors over multiple decades suggests that discrepancies between measured and simulated streamflow at this location are not due to release of impounded water but rather due to a regional underprediction of runoff by the ecmwf lsms usgs recorded streamflow from the arkansas river near little rock ar and the red river at spring bank ar also displays several large peaks in each calendar year fig 3d and e the streamflow output derived from the era5 25 km and era5l 9 km runoff reproduces this high frequency variability but the erai forced streamflow results for the little rock and spring bank gages have less frequent floods which are up to an order of magnitude smaller than the measured peak discharge these relative differences in streamflow model performance must be a consequence of varying accuracy among the three runoff datasets in particular fig 3d and e suggest that there are significant differences in the accuracy of era5 25 km and era5l 9 km runoff versus erai runoff in the arkansas white red river basin this is a more arid region where streamflow is strongly influenced by individual precipitation events causing geographically misplaced or missized rainfall to generate more incoherent hydrographs relative to the gaged curves for this study the gage nearest the mouth is the mississippi river at vicksburg ms a comparison of measured and simulated hydrographs from this location fig 3f indicates temporal variability in model performance in most instances the peak flow rate is underpredicted for streamflow simulated from erai era5 25 km and era5l 9 km runoff however the erai forced streamflow model overpredicts peak flood discharge in early 2005 the streamflow model results also display reduced overall accuracy in the latter half of the record for the vicksburg gage this is most evident in the underprediction of the flow rate from 2006 2009 especially for the erai forced model results the spatial variability in model performance is also apparent in the monthly averages q shown in fig 4 all runoff inputs overpredict peak flow for the strongly reservoir influenced missouri river at omaha ne while the three runoff datasets vary between over and underprediction at the other sites for example the erai forced discharge is positively biased for the mississippi river at keokuk ia but negatively biased for the arkansas river near little rock and the red river at spring bank the performance of streamflow simulations forced by the two era5 runoff products is also spatially variable but discharge simulated from era5l 9 km runoff is always greater in magnitude than the discharge simulated from era5 25 km runoff fig 4 also elucidates the runoff models varying ability to accurately predict peak discharge timing the erai runoff product generates an earlier peak discharge than era5 25 km or era5l 9 km for all sites except the arkansas river near little rock moreover the month of peak discharge predicted by the two era5 datasets is later than the known month for all six gages for example the usgs gage data indicate that q peaks in may for the mississippi river at vicksburg but the era5l 9 km and era5 25 km runoff products generate predictions of maximum q in june an extreme case is the missouri river at omaha where the usgs data peak in june the era5 25 km forced values achieve their maximum in august and the era5l 9 km forced values peak in september the geographic variability in the magnitude and timing of peak flow may be partly attributed to the proximity of unmodeled upstream reservoirs this is especially anticipated for gages such as the missouri river at omaha ne which is immediately downstream of a major reservoir however because reservoir routing was omitted from all three simulations differences in peak flow magnitude and timing also indicate differences in the behavior of the underlying lsms for example beck et al 2017 noted that peak runoff due to snowmelt is systematically early for the erai product which may contribute to the tendency for erai forced streamflow to achieve peak q earlier than era5 forced streamflow in fig 4 4 2 bulk distribution of performance metrics whereas section 4 1 considered results from six mainstem gages the following results evaluate aggregated model performance at all 60 gages shown in fig 1 the distributions of nrmse for discharge forced by era5 25 km and era5l 9 km are similar with median values of 1 47 and 1 56 respectively fig 5a the erai forced discharge has a higher median nrmse of 2 12 and a broader interquartile range than either of the era5 forced distributions this indicates that smaller errors between measured and modeled discharge can be expected on average for streamflow forced by the era5 runoff product the sign of these errors is characterized by pbias all three runoff products generate a median streamflow pbias below 0 for the full set of 60 gages although certain individual gages display a positive pbias among the three ecmwf inputs streamflow forced by the era5l 9 km runoff has the smallest magnitude median pbias of 7 although several outliers are present the median pbias for discharge simulated from the era5 25 km runoff is slightly larger in magnitude but the distribution of pbias values is narrower than observed for era5l 9 km the erai results also display a small magnitude median pbias but a broader range of values within the second and third quartiles notably the era5 25 km negative bias is consistent with mrb results from previous work using glofas era5 harrigan et al 2020 the variability metric γ which is defined in eq 3 measures the ratio of the mean normalized model standard deviation to the mean normalized observation standard deviation among the three runoff inputs considered in this paper streamflow simulated from the erai runoff displays the largest range of γ values fig 5c while streamflow simulated from the era5l 9 km runoff has the narrowest γ distribution although the interquartile range of the era5l 9 km γ distributions appears approximately symmetric about the optimal value of γ 1 it should be noted that values below 1 must be inverted prior to direct comparison with values above 1 for example a value of γ 0 5 indicates that the mean normalized observation standard deviation is twice as large as the mean normalized model standard deviation whereas a value of γ 2 indicates that the mean normalized model standard deviation is twice as large as the mean normalized observation standard deviation consequently fig 5c indicates that all three runoff inputs generate discharge predictions which fluctuate less γ 1 on average than the corresponding gage measurements as with the nrmse pbias and γ metrics the erai forced discharge displays the worst performance when measured by the correlation coefficient fig 5d the median value is ρ 0 36 and one of the 60 gages taylor arroyo near thatcher colorado displays ρ 0 the difference between the ρ distributions for the era5 25 km and era5l 9 km output is minimal the median values are ρ 0 51 and ρ 0 54 respectively and the distributions span a similar range of values however the second and third quartiles indicate slightly higher correlations for the era5l 9 km forced discharge interpretation of the kge is less straightforward than the interpretation of the other four metrics the erai forced output displays the worst median kge value of 0 05 fig 5e discharge simulated from the era5l 9 km runoff product has the highest median kge of 0 38 however streamflow simulated from the era5 25 km runoff has the largest maximum kge of 0 75 and a slightly smaller interquartile range than for era5l 9 km under the classification scheme of tavakoly et al 2017 model performance is characterized as acceptable when kge 0 4 consequently fewer than half of the stream gages are considered to have acceptable model performance as measured by kge when the streamflow model is forced by any of the three runoff products as described in section 3 3 the usgs gage data varied in duration and continuity all gages considered in this study have a minimum of 5475 daily streamflow measurements 15 years of data if sampling is continuous but gages with no missing data may have as many as 12 237 measurements between 1 jul 1981 and 31 dec 2014 to evaluate the performance metrics sensitivity to gage data duration the metrics were recalculated after randomly downsampling all usgs time series to exactly 5475 measurements as shown in figs 5f through 5j this sensitivity test generated minimal change in the distribution of nrmse pbias γ ρ or kge in particular the relative accuracy of the median values remained the same regardless of whether the performance metrics were calculated using all available usgs data or a randomly downsampled subset 4 3 spatial distribution of model performance as addressed in section 4 1 streamflow model performance varies by location to further examine spatial patterns in model accuracy figs 6 and 7 map the values of ρ pbias γ kge and nrmse for the 60 usgs gages the minimum median and maximum values of these metrics are also tabulated by huc 2 region in table 1 it was previously noted that streamflow simulated from the erai runoff tends to display lower correlations between measured and modeled values relative to streamflow simulated from the era5 25 km or era5l 9 km runoff products fig 6 visually emphasizes the low ρ values for the erai forced streamflow results and further suggests the absence of any spatial trends in correlation in contrast streamflow simulated from the era5 25 km and era5l 9 km runoff tends to display lower values of ρ in the western portion of the basin and higher values of ρ in the southeast although there are some locations where ρ 0 75 along the western basin boundary the absolute minimum value of ρ occurs in the arkansas white red river region for streamflow simulated from all three runoff products ρ min 0 01 for erai 0 08 for era5 25 km and 0 08 for era5l 9 km see table 1 but the lowest median ρ occurs in the missouri river basin for all three simulations ρ med 0 29 for erai 0 41 for era5 25 km and 0 44 for era5l 9 km see table 1 the highest median correlation occurs in the upper mississippi basin for streamflow from the erai runoff ρ med 0 43 and in the lower mississippi basin for streamflow from the era5 25 km and era5l 9 km runoff ρ med 0 56 and 0 57 respectively despite these general tendencies for lower correlations in the west the absolute maximum value of ρ occurs in the missouri river basin for streamflow simulated from both the era5 25 km and era5l 9 km runoff products ρ max 0 84 and 0 86 respectively regional trends in pbias are qualitatively similar among streamflow simulated from all three runoff datasets fig 6 maximum pbias always occurs in the arkansas red white region pbias max 289 for era5 25 km 381 for era5l 9 km and 2123 for erai see table 1 the smallest magnitude pbias values consistently occur in the eastern portion of the study area in the ohio and tennessee regions the median pbias values are pbias med 33 for era5 25 km 19 for erai and 15 for era5l 9 km notably 9 of the 11 gages in the ohio and tennessee regions display 20 pbias 25 when simulated from era5l 9 km runoff this range of pbias values is considered good under the classification scheme of moriasi et al 2011 and salas et al 2018 suggesting that the era5l 9 km runoff is particularly well suited for predicting unbiased streamflow in the easternmost region of the mrb for streamflow simulated from the era5 25 km and era5l 9 km runoff products the variability metric γ is uniformly within the range of 0 5 γ 2 for all gages east of 95 w longitude fig 6 see fig 1 for coordinate grid the variability also falls within this range for erai forced streamflow in the upper mississippi basin and most of the ohio and tennessee basins however there are several gages with 0 1 γ 0 5 in the south central portion of the mrb all of which are catchments with drainage area 1 0 4 km 2 extreme values of γ are most common in the arkansas white red and missouri river basins the most extreme γ value for the erai forced streamflow simulation is γ min 0 08 table 1 at taylor arroyo near thatcher colorado indicating that measured discharge displays 10 times higher variability than modeled discharge at this location meanwhile the streamflow simulations forced by era5 25 km and era5l 9 km runoff each have one instance in the missouri river basin where modeled discharge is 10 times more variable than measured discharge however fig 5 emphasizes that the mean normalized model standard deviation is within a factor of 2 of the mean normalized measurement standard deviation for the vast majority of streamflow results simulated from the era5 25 km and era5l 9 km runoff products fig 7 suggests a broad spatial pattern of increasing kge values from west to east across the mrb perhaps reflecting similar spatial trends of high to low magnitude pbias the absolute minimum kge occurs in the arkansas white red river basin for erai kge min 20 3 table 1 and in the missouri river basin for era5 25 km and era5l 9 km kge min 8 7 for streamflow simulated from both runoff products the smallest median kge values also occur in the missouri river basin for streamflow from all three runoff inputs kge med 0 59 for erai 0 15 for era5 25 km and 0 13 for era5l 9 km the highest median kge values are found in the ohio and tennessee river basin for erai forced streamflow kge med 0 26 in the lower mississippi basin for era5 25 km forced streamflow kge med 0 43 and in the upper mississippi basin for era5l 9 km forced streamflow kge med 0 45 despite this tendency for kge to be lower in the west and higher in the east individual gages deviate from the overall spatial trend this is illustrated for example by the occurrence of the absolute maximum kge value in the missouri river basin for streamflow simulated from era5 25 km runoff kge max 0 75 for the north platte river above seminoe reservoir wy and in the arkansas white red river basin for streamflow simulated from era5l 9 km runoff kge max 0 72 for the red river near spring bank ar like the kge the nrmse broadly improves from west to east fig 7 the absolute maximum nrmse values occur in the arkansas white red region for streamflow simulated from all three runoff products nrmse max 47 5 for erai 20 7 for era5 25 km and 23 2 for era5l 9 km table 1 meanwhile the smallest median nrmse always occurs in the ohio and tennessee basin nrmse med 1 14 for erai 1 00 for era5 25 km and 1 10 for era5l 9 km with median nrmse in the upper mississippi basin also being comparably low for all three runoff inputs the smallest normalized error of nrmse min 0 52 for erai 0 51 for era5 25 km and 0 47 for era5l 9 km corresponds to streamflow for the mississippi river at vicksburg which is the gage nearest the mouth of the network this result is of particular interest because it suggests that large errors in upstream reaches do not accumulate into an even larger error near the mouth when measured by the nrmse rather local streamflow errors due to e g inaccurate runoff input or the omission of reservoir routing effects appear to have limited influence on nrmse for reaches which are far downstream the results in figs 6 7 and table 1 are generally consistent with the findings of previous studies despite the absence of a one to one relationship between precipitation and runoff it is anticipated that inaccurate precipitation will challenge the lsm s ability to generate accurate runoff and therefore the streamflow model s ability to generate accurate discharge as has been observed in studies of other basins see kabir et al 2022 although it is difficult to validate precipitation performance due to measurement uncertainty and inconsistent gage density beck et al 2019 reported that era5 precipitation displays higher kge values than erai precipitation for the entire mrb with the exception of isolated regions of the rocky mountains in other words era5 precipitation is generally more accurate than erai precipitation for all gages east of 103 w longitude see fig 1 for coordinate grid other studies also indicate similar west east gradients in performance for example tarek et al 2020 noted apparently high precipitation biases in the western mrb and low biases in the east it is therefore conceivable that the more accurate discharge predictions from the era5 forced streamflow model particularly in the eastern portion of the mrb may be related to improvements in the ecmwf atmospheric model between the release of erai and era5 an earlier paper by tavakoly et al 2017 modeled streamflow using the nhdplusv2 network in conjunction with variable infiltration capacity vic runoff that study noted extremely low kge values for vic forced discharge in the arkansas white red river region of the mrb which was attributed to streamflow interactions with the high plains aquifer e g jachens et al 2021 tavakoly et al 2017 also found that the most accurate kge values for vic forced discharge occurred in the ohio and tennessee basins although there are site specific deviations the present study likewise indicates a tendency for better streamflow model performance in the eastern half of the mrb the spatial distribution of performance for rapid simulated streamflow using the era5 25 km runoff product is also generally consistent with spatial trends in streamflow performance from the era5 forced lisflood model harrigan et al 2020 which uses a gridded channel network representation similar to the results in fig 7 harrigan et al 2020 observed a broad west to east improvement in kge for era5 forced discharge in the mrb however harrigan et al 2020 obtained slightly higher kge values overall with the majority of gages in the ohio and tennessee region displaying kge 0 4 and many with kge 0 6 in contrast the present study obtained a median kge of 0 37 with a maximum of 0 54 for streamflow simulated using the era5 25 km runoff product in the ohio and tennessee region of the mrb this may be due to the inclusion of poorly performing small catchments see section 4 4 in the present study whereas harrigan et al 2020 limited their analysis to drainage areas exceeding 500 km 2 4 4 effect of drainage area on model performance as a broad generalization streamflow model performance improves with increasing drainage area fig 8 although there is considerable scatter the nrmse decreases as drainage area increases while the correlation coefficient ρ and the kge both increase with increasing drainage area for the streamflow simulations using erai runoff the variability also shifts from γ 1 for small drainage areas i e modeled streamflow variability smaller than measured streamflow variability to γ 1 for large drainage areas modeled streamflow variability larger than measured variability however the relationship between γ and drainage area is less pronounced when discharge is simulated using the era5 25 km and era5l 9 km runoff products a possible interpretation of these results is that the improved positional accuracy of a smaller runoff grid may lead to a more accurate model representation of the measured variability in streamflow out of the five metrics considered only the pbias displays no clear relationship with drainage area for any of the runoff forcings considering that the kge quantifies the combined effect of correlation bias and variability on overall model performance eq 3 evaluating patterns in the individual kge components provides insight into the cause of improved model performance in the large drainages in particular it should be noted that the relationship between ρ and drainage area fig 8 is more pronounced than the relationship between pbias and drainage area or the relationship between γ and drainage area this suggests that the improvement in kge for large basins is primarily driven by improvements to the correlation between measured and modeled discharge poor model performance in small catchments may be related to the spatial scale of runoff errors relative to total catchment size for example blöschl et al 2007 noted that land cover changes tend to be a local phenomenon which have the greatest overall impact on small catchments uncertainties in land cover within the lsm will affect the modeled runoff and the resulting errors in input runoff will have a proportionally larger impact on simulated streamflow when runoff is averaged over a small area this type of scale dependent streamflow model performance due to small scale landscape heterogeneity was previously noted by gharari et al 2020 also of note is that smaller catchment areas particularly in arid regions with strong meteorological gradients may be more susceptible to misplaced rainfall of inaccurate intensity within gridded atmospheric models tang et al 2021 this effect may then generate poor performance statistics in the smallest drainages in addition the relationship between ρ and drainage area may be attributed to flood attenuation as the wave travels downstream the muskingum method is based on a numerical approximation to the diffusive wave equation e g xiaofang et al 2008 as flow propagates through the channel network diffusion will smooth irregularities in upstream discharge caused by errors in the input runoff e g garbrecht 1991 as a result poor correlations between measured and modeled discharge in headwater catchments are likely to improve in the higher order reaches for this study the rapid model was run without incorporating reservoir routing considering that some earlier studies have observed improvements in simulated streamflow performance when reservoir effects were modeled salas et al 2018 tavakoly et al 2017 2021 zajac et al 2017 it is reasonable to expect a priori that more accurate results will be obtained for gages with no reservoirs upstream contrary to the expected behavior fig 8 indicates that better results are obtained on average for the 30 gages with one or more reservoirs upstream because all gages in the dataset with a drainage area 2 15 1 0 4 km 2 are regulated this phenomenon may be attributed to the positive correlation between model performance and basin size it is possible that further improvements in model performance could be obtained by including reservoir routing in the streamflow simulations although incorporating reservoir routing may also increase uncertainty in the performance statistics e g zajac et al 2017 if the necessary reservoir parameters are poorly constrained nevertheless fig 8 may be interpreted to indicate that poor model performance as measured by ρ and kge due to small basin size supersedes poor model performance due to the lack of reservoir routing the results in fig 8 are generally consistent with the results of earlier studies albergel et al 2018 previously reported that streamflow simulated using both erai and era5 runoff tends towards negative biases for basin areas exceeding 1 0 4 km 2 in the continental united states the large basins area 1 0 4 km 2 from the present study have a median streamflow pbias of 18 using the era5 25 km runoff 1 using the era5l 9 km runoff and 10 using the erai runoff because albergel et al 2018 used a different flow routing model ctrip than the present study a possible interpretation of these results is that the tendency towards negatively biased discharge is a consequence of negative biases in the input runoff rather than an artifact of the flow routing model the especially negative biases in streamflow simulated using the erai and era5 25 km runoff products may also be an artifact of their data assimilation scheme which reduces snow depth error via mass removal zsoter et al 2019 4 5 recurrence intervals the error distributions for the 2 year 10 year and 20 year flood discharge are shown in fig 9 all recurrence intervals for streamflow simulated using the erai runoff product have a negative median percent error pcterr that is the modeled flood discharge is typically smaller than the measured flood discharge regardless of flood magnitude this is consistent with the negative median pbias for the daily discharge values simulated using erai runoff the median percent errors for q 2 q 10 and q 20 are smaller in magnitude but still negative when the era5 25 km runoff is used as input for the streamflow model for streamflow simulated using era5l 9 km runoff the median pcterr is also near zero for q 2 q 10 and q 20 however the positive tail for the era5l 9 km distributions is always longer than the tail of the era5 25 km distributions this indicates that streamflow simulations using era5l 9 km runoff have a greater likelihood of overpredicting the flood discharge compared to streamflow simulations using era5 25 km runoff which is consistent with the hydrograph comparisons from section 4 1 spatial patterns of error in flood discharge fig 10 mirror spatial patterns in pbias for daily q fig 6 for discharge simulated using erai runoff large positive values of pcterr 2 yr and pcterr 20 yr are concentrated in the missouri river basin and along the western boundary of the arkansas white red basin whereas large negative values of pcterr 2 yr and pcterr 20 yr occur in the ohio and tennessee basins the lower mississippi basin the eastern half of the arkansas white red basin and the southeastern portion of the missouri river basin this pattern of positive pcterr values in the west and negative pcterr in the east persists for flood discharge magnitudes generated by era5 25 km and era5l 9 km runoff however the quantity of gages with pcterr 50 is smaller for the era5l 9 km results in particular the majority of gages in the ohio and tennessee basin have 50 pcterr 2 yr 20 and 50 pcterr 20 yr 20 in summary the results in fig 10 indicate that modeled return flow is more likely to exceed the gage derived return flow in the western portion of the mrb while gage derived return flow is more likely to exceed the modeled return flow in the eastern mrb although the magnitude of the error depends on which runoff product is selected as a forcing to simulate streamflow considering that the recurrence intervals are directly calculated from the discharge time series it is reasonable that peak flood discharge is overestimated in the western half of the mrb where pbias tends to be positive however this result was not guaranteed due to the possibility of differing flow probability distribution shapes in different regions of the study area it should also be noted that there are several gages where q 2 is overpredicted by the model while q 20 is underpredicted or vice versa 5 conclusion in response to a call for more comprehensive evaluation of lsm reanalysis products harrigan et al 2020 this paper evaluated the performance of streamflow routing in the mississippi river basin mrb forced by three runoff products from the european centre for medium range weather forecasting ecmwf the erai runoff dataset the era5 25 km reanalysis runoff which includes data assimilation and the 9 km era5 land runoff product aggregated streamflow results from 60 gages across the mrb suggest that streamflow simulated using the two era5 runoff products is consistently more accurate than streamflow simulated using the erai runoff the era5 25 km and era5l 9 km performance metrics have similar median values and the classification of a best performing runoff product for simulating streamflow depends on which metric nrmse pbias γ ρ or kge is considered across the mrb there is a broad tendency for poor performance in the western regions missouri river basin and arkansas white red basin and improved performance towards the east ohio and tennessee basins for streamflow forced by all three runoff products large positive percent errors in the 2 year 10 year and 20 year flood discharge tend to occur in the western portion of the mrb whereas the percent error in return flow is more likely to be negative in the eastern mrb this study strongly suggests that streamflow routing results improve overall within the mrb and perhaps elsewhere when either of the era5 runoff products are used in place of erai runoff identifying whether era5 25 km or era5l 9 km is the better forcing may be dependent on the geographic region period of record the and performance metric of interest although the effects of reservoirs and irrigation were not modeled this comparison of streamflow results driven by the three runoff products is still valid because the associated errors have an identical influence on all three simulations the selection of which performance metric to optimize will depend on which aspects of model performance are most critical to a specific model application in the present study inherent challenges related to stream gauge record overlap and spatiotemporal density limit the breadth of conclusions that can be drawn about a large climatologically diverse basin however the following generalizations follow from the results presented in this paper 1 the median values of nrmse pbias ρ and kge along with the percent error in 2 10 and 20 year return interval flows were slightly nearer to optimal for the era5l 9 km forcing this bolsters confidence that using era5l 9 km runoff generates an overall improvement relative to era5 25 km runoff nevertheless the median model variability was slightly better when forced by era5 25 km and it is not possible to establish true statistical significance for any of the metrics considered 2 both era5 runoff datasets generally appear to outperform erai runoff for similar reasons the median values of nrmse variability ρ and kge along with percent error of return interval flows were all slightly nearer to optimal for the era5 forcing however the median pbias was nearest to 0 for the erai forcing as in the previous conclusion true statistical significance for any of these metrics is difficult to establish 3 although no significant differences between era5 25 km and era5l 9 km were observed when considering the mrb data in aggregate there is evidence that era5l 9 km may be preferable to era5 25 km for generating less biased streamflow less biased return periods and higher kge values in the ohio and tennessee regions of the mrb 4 increased spatiotemporal coverage of the validation gages would be beneficial for addressing temporal mismatches such as differences in record length freeze thaw complications etc augmenting the present dataset could yield more significant differences between the forcings especially regionally and permit more detailed spatiotemporal fine graining 5 considering that none of the forcing datasets is clearly superior for all metrics conditions and locations e g in the western portion of the study area there could be value in streamflow prediction involving ensembles of forcing in such a scenario a variety of runoff products might inform a streamflow performance index derived from metrics concerning particular regions and conditions this performance index could then guide the user to select blends of ensemble members for particular end uses credit authorship contribution statement r l bain methodology formal analysis investigation writing original draft writing review editing visualization m j shaw methodology software formal analysis investigation writing review editing m p geheran software writing review editing a a tavakoly conceptualization writing review editing supervision project administration funding acquisition m d wahl conceptualization writing review editing supervision project administration funding acquisition e zsoter writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this project was partially funded as collaborative research between the u s army engineer research and development center noaa s national water center united states and the u s army corps of engineers regional sediment management program runoff data are available from the european centre for medium range weather forecasts https www ecmwf int daily discharge time series data were provided courtesy of usgs nwis http nwis waterdata usgs gov nwis dvstat referred module sw the authors are grateful for reviews from shervan gharari and the editorial board whose feedback improved the quality of the original manuscript 
