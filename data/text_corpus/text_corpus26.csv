index,text
130,groundwater contamination causes significant groundwater supply risks that severely affect humans and livestock especially in the era of climate change consequently the need to develop and optimize remediation strategies such as pump and treat is indispensable an effective and efficient strategy can reduce the spread of contaminants and cost of clean up however developing such a strategy is challenging due to the inherent uncertainty and sequential nature of the problem for example taking actions such as drilling wells is interwoven with information gathering over time in this paper we formulate the groundwater remediation planning and decision problem as a partially observable markov decision process pomdp a pomdp formulation allows planning by optimizing the trade off between information gathering and the performance of possible future scenarios we use a state of the art pomdp solver called despot for planning remediation strategies the results show that despot can yield much better remediation strategies than hand crafted heuristics and optimization methods the superior performance of despot is due to the incorporation of both previous information and future reward into the current decision we also demonstrate the robustness of the pomdp formulation to measurement error keywords pomdps belief updates particle filter bayesian inversion model predictive control closed loop optimization sequential decision making groundwater management particle swarm optimization pso 1 introduction groundwater is one of the most significant sources of water not only for drinking but also for agricultural irrigation industrial use and recharge for lakes and wetlands usgs estimated use of water in the united states in 2000 www document url accessed 12 01 2021 about 70 of groundwater withdrawn worldwide is used for irrigation and about half the drinking water comes from groundwater famiglietti and james 2014 gleeson et al 2016 2011 mukherjee et al 2021 as a result of population growth and climate change demand for groundwater has grown in the united states the withdrawal volumes from 1950 to 2015 increased by almost 250 from 34 billion barrels to about 82 billion barrels of water per year usgs trends in water use in the united states 1950 to 2015 www document url accessed 12 01 2021 groundwater contamination represents significant risk to the water supply because contaminated groundwater can severely affect humans and livestock in addition the higher demand for groundwater amplifies the problem of groundwater contamination because the higher withdrawal rates result in higher pressure differences in aquifers which accelerates the transport of contaminants towards drinking water wells the national research council reported in 2013 alternatives for managing the nation s complex contaminated groundwater sites 2013 that the collective groundwater remediations in the us could cost up to 127 billion usd indicating the critical need for optimized groundwater remediation strategies depending on the source of contamination remediation may involve chemical biological or physical techniques while chemical and biological techniques convert pollutants into harmless products physical techniques aim to remove the pollutants a widely used and practical remediation technique is pump and treat p t which withdraws pollutants from aquifers via extraction wells and then separates the pollutant from the groundwater in surface facilities matott et al 2006 a p t operation is a complex task that can severely increase the remediation performance and clean up time a poorly planned approach can increase the contaminant spread and the required clean up time and cost some of the main decisions for such an operation are the location and number of the extraction wells pumping rates and completion intervals those decisions are sequential in nature for example extraction or injection wells are drilled in sequence and their corresponding extraction and injection rates can be changed over time many other groundwater management problems are sequential in nature groundwater management decisions are challenging because forecasting the temporal and spatial distribution of the contamination requires the careful placement and operation of extraction wells in addition predicting subsurface flow is challenging because of many subsurface uncertainties numerical models of physical flow and chemical transport can aid in prediction the main challenge in generating predictions of spatial and temporal head and contaminant distribution used for decision making lies in the construction of the subsurface models uncertainties of the subsurface result from imperfect information important model variables are only partially observable storage lithology hydraulic conductivity and hence need to be estimated boundary conditions of a groundwater system can only be inferred imperfectly from limited head measurements zhang et al 2014 the recent increase in accessibility to computational resources makes methods involving numerical simulation models in combination with optimization algorithms s o more attractive because numerical simulation models represent the groundwater reservoir more realistically the simulator is used to predict the spatial temporal contaminant distribution while the optimizer is used to find an optimum set of decision variables such as well location or extraction rate that minimize a specified objective function possibly with constraints to solve decision problems such as p t tasks many scholars have adopted the idea of static optimization also known as one shot optimization which optimizes for a sequence of actions once and then blindly executes those actions chang et al 2007 huang and mayer 1997 mategaonkar and eldho 2012 matott et al 2006 mckinney and lin 1996 piscopo et al 2015 a variety of different optimization algorithms have been used for groundwater remediation in the static s o domain such as simulated annealing dougherty and marryott 1991 genetic optimization mckinney and lin 1996 and hybrid approaches yang et al 2013 fu and wen 2017 considering the variety of metrics of interest in real world applications that need to be optimized simultaneously the optimization in groundwater remediation can also be formulated as a multi objective problem for example piscopo et al 2015 show the balance of the performance of contaminant degradation with efficiency the problem with static optimization is that even though new information is available at every step that an action is executed this information is not considered during the optimization process an alternative is to use model predictive control mpc where plans are sequentially reoptimized in response to new information borrelli et al 2017 because most subsurface problems include many sources of uncertainty it is especially important to gather information to reduce the uncertainty and update belief at each step jansen et al 2009 zimmer et al 2015 jahandideh and jafarpour 2019 however a major limitation with mpc is that it does not reason about potential future information during the planning period in contrast a markov decision process mdp and a partially observable markov decision process pomdp formulation take future information gain into account during planning in the related field of oil and gas reservoir management the sequential decision problem of placing wells and optimizing injection rates was formulated as a mdp de paola et al 2020 and a pomdp torrado et al 2017 however in their work there is no performance comparison between their approaches and the conventional state of the art optimization approaches such as the one shot optimization and the mpc optimization using belief updates in this work we formulate the groundwater remediation planning problem as a pomdp first we show how defining a groundwater management problem as a pomdp results in an optimization problem that accounts for future information gain to maximize the total utility of all decisions second we present a method to solve the decision problem using the online pomdp solver despot though we present the formulation and solution for the p t planning task the proposed methods can be used for any groundwater management task that can be represented in the same formalism compared to static optimization and mpc depsot results in better decisions because it takes into account the availability of future information we provide a general formulation of the groundwater management problem that can be easily extended with other possible actions or reward functions 2 partially observable markov decision processes markov decision processes can be viewed as a standard representation of sequential decision making problems kaelbling et al 1998 an mdp is defined by the following five components bertsekas 2012 state space s a set of possible states of the environment action space a a set of possible actions transition model t a conditional distribution over the environment state s after having taken action a from state s it is often written as a conditional distribution over the next state s from the current state s after executing the action a t s s a the transition model in an mdp assumes that the next state distribution only depends on the current state and action reward function r the reward function returns the expected reward for taking action a in the current state s denoted r s a discounted factor γ the discounted factor is applied to the reward at each time step γ 0 1 the goal in solving a sequential decision problem is to choose actions that maximizes the discounted return defined as t 1 γ t 1 r t where rt is the reward received at step t an mdp policy is a function that maps a state s to an action a π s the value of a state under a policy is the expected return when following that policy from the given state and all subsequent states the value is defined as u t π s t 1 t γ t 1 r s t π s t where the expectation is taken over states sampled from the transition function an optimal policy is one that returns the action that results in the maximum expected value for each state in many sequential decision making approaches a policy is learned through interacting with a simulation a key assumption made in an mdp is that the current state is known in many problems however the state may not be known precisely but is instead observed with noisy measurements for example in a groundwater management problem the porosity of the reservoir state may not be exactly known but can be imperfectly inferred from noisy seismographic measurements noisy measurements such problems are referred to as partially observable a framework called partially observable markov decision processes pomdps captures this idea kochenderfer 2015 the pomdp formalism is an extension of the mdp in addition to the state action transition model t and reward function r defining the mdp a pomdp is defined by including the following two additional elements observation space o a set of possible observations that an agent can perceive from the environment observation model o a conditional distribution over the observation received after taking action a from state s and transitioning to state s o o a s because the state of the world is unknown pomdps are often solved by planning over the space of possible beliefs a belief is a probability distribution over states where b s represents the probability assigned to being in state s the agent starts with an initial belief b that represents any prior information about the current state the agent then obtains an updated belief b from bayes rule after taking action a and observing o b s p s b a o o o s a s s t s s a b s this update is shown for a discrete state space an equivalent update can be calculated for continuous spaces by integrating over the state space in place of the summation approximate bayesian updates may also be used for example with particle filtering approaches arulampalam et al 2002 the goal for an agent in a pomdp is to maximize the expected discounted return 3 groundwater problem formulation the purpose of our work is to illustrate the potential of the pomdp formulation in groundwater management a synthetic case with all elements of a sequential decision making problem is used for that purpose using a synthetic case is advantageous because the true state ground truth of the reservoir can be fully known therefore the results from the true state can be compared with results obtained from algorithms we use the observations obtained after drilling a well to update a model the synthetic model enables us to go through several drilling cycles by using the ground truth to generate those observations the synthetic case is a two dimensional heterogeneous groundwater system the domain is 100 meters in the east west and the north south extension discretized with 25 grid blocks in each lateral dimension both the eastern and western boundaries are open to flow while the reservoir is confined at the northern and southern boundaries the aquifer has a thickness of 25 meters and is bounded below by an impermeable layer the aquifer is fully saturated the introduced aqueous contaminant in our illustration case is fully miscible and does not react with the in situ fluid or the rock this work uses modflow mcdonald and harbaugh 1988 to solve for flow and mt3dms zheng et al 1999 to predict contaminant concentration for each grid block it is important to mention that the physical forward models can be exchanged for any other physical forward model without changing any of the problem formulations presented later the contaminant source is in the western part of the aquifer we consider two different problem environments one with a single extraction well and a second with two extraction wells the contaminant is being continuously injected at a concentration level of 10 mass per volume ml 3 at an injection rate of 500 volume per time l3t 1 whereas the well is extracting at a constant rate of 100 volume per time l3t 1 both well controls do not change over time without any remediation work for example the contaminant breaks through at the extraction well approximately 11 days after initial contamination and reaches a maximum level after 300 days for the single extraction well environment fig 1 shows the groundwater reservoir with and without p t on day 400 we define the problem of sequentially placing wells for p t as a formal sequential decision making problem the goal is to minimize the concentration of the contaminant at the extraction well while satisfying constraints more specifically we aim to optimize the sequential placement of remediation wells of a p t operation to minimize the average contaminant concentration during the operation period between 100 and 400 days for simplicity we keep the number of remediation wells and time of drilling fixed the first well is drilled at 100 days the second at 200 days and the third at 300 days two of the remediation wells are operated at an extraction rate of 100 l3t 1 and one at 200 l3t 1 to make the illustration case more realistic and challenging the injector is operated at 500 l3t 1 for the entire 400 days again well controls do not change over time we also introduce noisy measurements of the contaminant to assess how measurement accuracy affects decisions 3 1 state space the state defines the environment under investigation the state space is a collection of possible realizations where each state represents porosity and hydraulic conductivity for each grid block in addition to the geological realizations the locations of the remediation wells are part of the state definition 3 2 action space the action space is defined by the possible locations where a remediation well can be placed we decided to only include every other grid location in the feasible set of drilling locations because remediation wells are usually not drilled right next to each other blue shaded grid blocks in fig 2 additionally we exclude the vicinity around existing wells red and green shaded areas in fig 2 from the action space it is essential to recognize the complexity of the curse of history in this groundwater case for example given roughly 300 possible drilling locations and three decision steps the combinatorial problem results in approximately 3003 possible action combinations 3 3 transition model in the presented groundwater case drilling remediation well cannot change any geological properties therefore the transition model for the geological states is s g e o s g e o however the transition model for the well location state is adding the location of the currently placed remediation well to the existing remediation well locations both transition models are deterministic 3 4 reward function the reward function encodes preferences that guide the agent in finding an optimal solution the objective function on the other hand is the sum of the reward over all time steps we define the reward function using the average contaminant concentration from the extraction well in the case of single extraction well the reward function takes the average contaminant concentration in the case of two extraction wells the reward function takes the maximum average contaminant concentration between the two extraction wells fig 3 shows the reward function the abscissa represents the contaminant concentration in the extraction well and the ordinate represents the corresponding reward the reward is not directly a function of the state but is a function of the contaminant concentration the reason for this is that for a given state geological realization and well locations the modflow mt3dms simulator outputs deterministic concentration levels for all wells and time steps we decided to shape the reward function as a cosine function because high concentrations of contaminant should be avoided the reward function maps high concentrations into lower rewards on the other end of the spectrum very low contaminant concentrations are more desirable and therefore are mapped into higher rewards for concentrations in the middle the reward function is almost linear in more general settings a reward function does not need to be a monotonic function and can be defined over many properties of interest 3 5 belief because we do not fully observe the aquifer system the problem is defined as a partially observable markov decision process consequently we need to define a belief over the state we define distributions over the unknown subsurface model parameters as summarized in table 1 in practice these distributions will be estimated by experts using data from for example pumping test and geophysical analyses in our experiments we generate 100 geological realizations using sequential gaussian simulations deutsch and journel 1998 we assume that this ensemble of 100 realizations defines the set of possible models and represents all information available at the start of the problem as similarly done in ensemble methods such as enkf kalman 1960 evensen 2003 wen and chen 2005 2006 hendricks franssen and kinzelbach 2008 we then define the initial belief as a uniform distribution over the 100 realizations the size of state grows exponentially with the number of state variables namely curse of dimensionality in this case the number of possible belief states equals to the number of possible geological realizations times the number of the possible well locations in the case of the single well only the main angle of the hydraulic conductivity is used to generate 100 realizations in the two extraction wells case the parameters in table 1 are used to generate 100 realizations the way we treat the one hundred realizations is by attributing to them multiple indicator random variables ik 1 if realization k is chosen ik 0 elsewhere we assign a prior probability to each indicator random variable as p i k 1 1 n where n 100 fig 4 shows 3 out of 100 realizations 3 6 observation space and observation model the observation space comprises the measured contaminant concentration at the extraction well s the contaminant concentration is computed by the modflow mt3dms simulator observation model given the current state 3 7 belief update we perform belief updates using a customized particle filter the specific steps of the customized particle filter are shown in algorithm 1 the algorithm starts to sample particles of uncertain variable θ conductivity direction or geological realization from a uniform prior π belief it collects the concentration vector y conc from the extraction well s based on a sampled particle an example of the concentration response in the extraction well can be seen in fig 10 the mismatch based on the ℓ1 norm t y c o n c t y o b s t during the operation period is then calculated and appended to y mismatch where y obs is the observed concentration vector based on underlying ground truth the algorithm finally uses the exponential likelihood exp y mismatch 0 1 to compute weights for each particle 4 solution methods this section introduces four different solution methods for solving the presented groundwater management problem 4 1 heuristic solution the heuristic solution presents the baseline of comparison for the different approaches in the absence of subsurface groundwater models or the lack of optimization tools human experts guided by their knowledge in physics and experience in the field will decide on the location of remediation wells as a heuristic solution we elaborate on the heuristic solutions based on human intuition in the result section because they fully depend upon specific problem environments 4 2 pso one shot particle swarm optimization pso is a stochastic population based optimization algorithm as opposed to traditional single point optimization methods pso uses a set of points to search a minimum of a given problem each point or particle in the set is a potential solution pso starts with randomly initialized particles to find a minimum each particle moves around in the problem defined searching space based on two values the best solution it has found x best i and the best solution that has been found by any particle xbest at each iteration particles update their positions and velocities with following equations kochenderfer and wheeler 2019 x i x i v i v i w v i c 1 r 1 x b e s t i x i c 2 r 2 x b e s t x i where w balances between global and local minimums larger w tends to make the algorithm converge to global minimums r 1 and r 2 are sampled randomly from u 0 1 to ensure the stochasticity c 1 and c 2 are acceleration parameters large values of c 1 and c 2 allow the algorithm to exploit the areas around x best i and xbest koohi and groza 2014 we use pso to optimize for a sequence of remediation well locations without updating belief on the underlying conductivity direction or geological realization we name this solution method as pso one shot because all well location decisions are made before the first well is drilled pso one shot randomly samples particles of all three remediation wells from the feasible actions as shown in fig 2 and finds the combination that minimizes the objective function the objective function for pso one shot is to minimize the average contaminant concentration from the extraction well during the operation period from 100 days to 400 days in the case of two extraction wells the objective function minimizes the maximum average contaminant concentration between the two extraction wells during the operation period 4 3 pso mpc we formulate pso under the model predictive control mpc formulation called pso mpc as the third solution method pso mpc updates the belief with the observations obtained from the previously drilled well and reoptimize with an updated belief at each step it accounts for future actions without considering feedback from the environment though pso mpc starts to optimize all three remediation wells but only the first well is determined before the first belief update once the first well is chosen the algorithm optimizes the rest two remediation wells along with the determined first well based on an updated belief the second well is then chosen before the second belief update pso mpc repeats the same manner and stops after all three remediation wells have been placed this process is demonstrated as a dynamic decision network shown in fig 5 during the optimization pso mpc shares the same objective function as pso one shot 4 4 despot there are many methods for solving mdps and pomdps exact methods are generally computationally intractable for most practical problems as the number of possible paths grows exponentially with the length of the required action sequence madani et al 2003 papadimitriou and tsitsiklis 1987 exact methods generally cannot be defined for continuous pomdps some approximate methods instead search for optimal policies by sparsely sampling trajectories from the full set many approximate methods have been developed such as monte carlo tree search mcts chaslot et al 2008 and determinized sparse partially observable tree despot search ye et al 2017 due to the large action and observation spaces of our illustration case the planning algorithm we deployed in this paper is despot additionally this algorithm choice is driven by the deterministic contamination response of the groundwater simulator given specific remediation well locations mcts uses the upper confidence bound applied to trees uct algorithm kocsis and szepesvari 2006 to trade off exploration and exploitation which can be overly greedy ye et al 2017 we will review despot in this section the despot agent searches for the best action based on the current belief executes the action and updates the belief based on the resulting observations somani et al 2013 the agent will repeat this process with an updated belief this sequence of alternating between taking an action and searching for the best next action is called online planning despot is a state of the art online pomdp solver a general framework for searching for an optimal policy in online pomdp planning is with belief trees ross et al 2008 a belief tree shown in fig 6 starts with the initial belief represented as a root node the root will then recursively expand based on all possible actions resulting observations and updated beliefs up to depth d each node in the belief tree represents a belief therefore the size of the belief tree grows exponentially with depth and yielding o a d d belief nodes where a and are the number of possible actions and observations respectively despot avoids this exponential growth curse of dimensionality and curse of history by sparsely sampling both states and observations thus forming a sparse belief tree the determinization of despot as its name suggests results from a sparse belief tree that consists of fixed state action and observation pairs the determinization is realized by a set of sequences of uniformly sampled numbers between 0 and 1 a sequence of numbers is also called a scenario given an action sequence and an initial sampled state a scenario determines a unique trajectory of states and observations by controlling the stochasticity of the transition and observation models in other words a uniformly sampled number in a scenario can map a state action pair s a to the successor state observation pair s o according to a deterministic function the determinized sparse belief tree is shown in fig 7 despot contains all actions but it limits the included observations to those sampled from the scenarios therefore the despot reduces the size of the belief tree to o a d k where k is the number of sampled scenarios since a despot will be truncated to a user defined maximum depth d we will get an approximation of an optimal policy by searching the truncated tree the recursive bellman equation shown below applied at each internal node to get the maximum value function on the current belief u b max a a s s b s r s a γ o o o o b a u b the action at the root node that maximizes the value function will be chosen and executed besides sampling scenarios to speed up lookahead search despot also incorporates a user defined upper bound and a default policy as a lower bound estimate on optimal value at each leaf node the lower and upper bounds help to rule out subtrees based on their optimal values we run despot in anytime mode so the full despot is not constructed fig 8 demonstrates the planning and optimization processes of despot as a dynamic decision network for solving a pomdp problem 5 results table 2 summarizes the results from four different solution methods involving a single extraction well in addition to total expected reward and the objective function we introduce an additional metric to analyze performance shown in the second row of table 2 the first row is the average concentration of contaminations from the extraction well during the remediation period from day 100 to 400 the second row is the cumulative extracted contaminations from the extraction well during the remediation period appendix a 1 includes the decisions on the remediation well locations associated with table 2 all approaches perform similarly in this scenario the following sections will show that despot brings a significant benefit in more realistic and complex scenarios we increase the complexity of the problem with two extraction wells that are located on either side of the contaminant source because both extraction wells are equally important in terms of low contaminant concentration we cannot favor a particular extraction well and neglect the other due to the fact the extraction wells are in different directions from the contaminant source one towards the north and the second towards the east the belief over the underlying hydraulic conductivity field becomes a more important factor for example in the case of the main hydraulic conductivity direction being north south the northern extraction well will pump the most contaminant consequently the remediation wells would need to focus on the northern part to keep the contaminant levels low 5 1 heuristic solution a heuristic solution is to put two remediation wells around the northern extraction well and a single remediation well in front of the eastern extraction well shown in fig 9 the intuition is that the northern extraction well is spatially closer to the contaminant source therefore the contaminant is more likely to be drawn into the northern extraction well first fig 10 shows the concentration profiles for both extraction wells we observe a kink in the concentration levels when a remediation well is drilled the maximum average concentration between two extraction wells during the operation period is 3 825 corresponding to a reward of 3 61 after the first remediation well is drilled we can observe a small reduction of concentration of contaminations the combination of continuous injection of contaminations and the first remediation well location results in an immediate increase in concentration on both extraction wells additional subsequent remediation wells can reduce the contaminant concentration levels of the extraction wells 5 2 pso one shot solution pso one shot optimization leads to a similar strategy as the heuristic solution two remediation wells are placed to protect the northern extraction well and one remediation well is placed for the eastern extraction well shown in fig 11 the concentration curves of the pso one shot solution are shown in fig 12 the maximum average concentration between the two extraction wells is 3 617 which results a reward of 4 21 5 3 pso mpc solution in the case of two extraction wells pso mpc has its belief on the geological realizations the algorithm starts with a uniform prior over 100 geological realizations the 3 iterations of belief updates are shown in the fig 13 at the first iteration the algorithm has a relatively strong belief on the geological realization with index 40 however the underlying truth in this case is the geological realization number 55 at iteration 2 and iteration 3 pso mpc quickly corrects its belief after collecting more observations in terms of well placements fig 14 pso mpc places the first remediation well underneath the northern extraction well the second remediation well is placed in the north of the contaminant source the algorithm remediates the eastern extraction well by placing the last remediation well in front of it pso mpc remediation strategy reduces the max average concentration during the operation period to 3 09 fig 15 this concentration has a reward of 5 65 5 4 despot solution with a uniform prior belief on 100 geological maps after collecting the first observation depsot significantly reduced geological uncertainties fig 16 collecting further observations iteration 2 and iteration 3 from fig 16 despot is almost certain that geological realization number 55 is the underlying truth as shown in fig 17 despot places the first remediation well between the northern extraction well and the contaminant source the agent places both the second and third well in front of the eastern extraction well as the predominant extension of the contaminant is in the eastern direction the performance of the remediation strategy from despot is shown in fig 18 after the first action both concentration curves quickly drop down the maximum average concentration of two extraction wells during the operation period is 2 083 the reward is then 5 66 given the max average concentration table 3 summarizes the results of the two extraction wells case the first row is the maximum average concentration of contaminations between the two extraction wells during the remediation period from day 100 to 400 the second row is the maximum cumulative extracted contaminations between the two extraction wells during the remediation period in both cases despot performs best 6 discussion this section discusses the performance of the different approaches we discuss the differences between the case with a single extraction well and the more complex case with two extraction wells and the consequences for future applications 6 1 two extractions wells the two extraction wells are positioned in different directions using the same number of remediation wells leading to a more complex decision scenario the placement of remediation wells needs to balance the protection strategy to not favor a given extraction well over the other one therefore knowing the underlying hydraulic conductivity direction for example is more critical than in the case of a single extraction well in contrast to the expert solution the one shot optimization places all three wells closely together around the northern extraction well fig 11 as a result the one shot optimization approach yields in a 5 4 percent better solution than the heuristic solution table 3 the absence of a remediation well in front of the eastern extraction well seems counter intuitive but the group of remediation wells limits the contaminant flow towards the east fig 19 additionally the remediation wells create a barrier between the northern well and the contaminant source the pso mpc approach performs better than the heuristic solution and the one shot optimization the reason for this improvement is that pso mpc reduces uncertainty in the geological realizations using belief updates notice the high conductivity streak that connects the contaminant source and the eastern extraction well in fig 19 knowledge of the position of the high hydraulic conductivity streak obtained from partial observations concentration is important to block contaminant flow towards the eastern well fig 20 in contrast with pso mpc despot placed two remediation wells within the east west conductivity streak and only one remediation well in the northern part despot placed the single remediation well in the northern part because there is a low hydraulic conductivity band between the contaminant source and the northern extraction well fig 21 the band limits fluid flow into the norther direction the two remediation wells placed in the high conductivity streak serve two purposes the second well is placed close to the eastern extraction well to reduce the contaminant that has already reached the eastern well the third well is also placed in the streak but closer to the contamination source as a booster to further control the spread of the contaminant the improved performance of despot is due to the accounting future information pso mpc only takes a single sample into account when computing expected future reward despot chooses the first well to gather information to improve the choice of future actions in contrast the optimization framework does not reason about future uncertainty reduction when making a decision the pso algorithm randomly samples potential action sequence but despot searches for the solutions based on the despot tree structure allowing it to focus on promising action branches 6 2 generalization to real world scenario the performance difference between despot and other solutions becomes much more significant in the case of two extraction wells than in the simple scenario the scenarios using one and two extraction wells demonstrate that despot can perform better in a more complex environment many real world applications may include many more remediation and extraction wells and have additional complexities from both geological and engineering uncertainties such as geochemical reactions between fluid and rock as well as the timing at which remediation wells are drilled consequently problem formulations of these real world applications result in a significantly larger action and state space additionally most of the time these applications are associated with long time horizons therefore it is important to be able to efficiently and effectively search the space of solutions 6 3 accounting for inaccurate observations in addition to efficiently solving complex problems our solution approach can also be easily adapted and expanded one possible extension is the introduction of noisy observations taking measurements in the field comes with choosing measurement accuracy and assessing how that accuracy affects decisions to illustrate how a pomdp framework performs under inaccurate measurements we added a gaussian noise on the concentration observations the gaussian noise has 0 mean and 0 1 variance this choice of the gaussian noise makes about 10 percent of geological realizations indistinguishable since our focus is to illustrate the application and the corresponding potential of a pomdp framework we chose this variance for real world applications measurement device specifications can guide the variance choice inaccurate measurements reduces despot performance by about 2 7 percent and pso mpc by about 1 8 percent in terms of max average concentration table 4 in despot the third remediation well is located closer to the eastern extraction well than in the non noisy case as shown in fig 22 notice the difference between the belief updates in figs 16 and 23 noise impacts the belief update reducing the confidence despot has in the geological map index 55 underlying truth having less accurate knowledge of the underlying geological model consequently affects decision quality although the performance of the algorithm was impaired by noise despot still performs better than all other approaches table 4 6 4 computational time to compare optimization formulations with pomdp we make all solution approaches take approximately the same time representing about 18 hours of running time on the same single core cpu 2 4 ghz intel core i9 specifically we use a particle size of 250 for pso and 50 sampled scenarios in despot in addition all approaches run on 100 geological realizations 7 conclusions this paper showed how to model a pump and treat sequential decision problem in a groundwater application as a pomdp we defined the necessary components of the pomdp framework for a synthetic groundwater application we analyzed the value of reasoning about future beliefs as done using despot to our knowledge this is also the first time that a pomdp framework in a subsurface application is compared with both a hand crafted heuristic solution and optimization approach we incorporate both conventional one shot optimization and mpc optimization with belief updates we demonstrated the importance of gathering information to make effective sequential decisions in this paper the information for belief updates came from the concentration measurements from the extraction wells however the pomdp framework with belief updates can be easily adapted to other sources of information such as head measurements or tracer tests we also demonstrated the robustness of the pomdp framework to inaccurate measurements and its adaptability the formulation can be extended to include the injection rate into the action space and financial costs into the reward function in the groundwater case studied in this paper the states are comprised as geological realizations but the formulation can be easily changed to use the geological model parameters as the state we illustrated that despot exceeds the performance of all other solutions under various scenarios in complex environments the pomdp framework outperforms other solutions by a large margin despot achieves this performance by efficiently and effectively reasoning about large state action and observation spaces that typically characterize subsurface applications we think that the pomdp framework is a powerful tool for making complex real world groundwater decisions under uncertainty moreover because of its generality the framework can be easily adapted to other groundwater applications such as groundwater management or recommending groundwater remedies credit authorship contribution statement yizheng wang conceptualization methodology software formal analysis investigation data curation validation visualization writing original draft writing review editing markus zechner conceptualization methodology software validation visualization data curation writing original draft writing review editing john michael mern conceptualization methodology visualization writing review editing mykel j kochenderfer conceptualization methodology writing review editing supervision jef karel caers conceptualization methodology writing review editing project administration supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a 1 results for protecting single extraction well in the following section we will present the results for the test case with a single extraction well in the plots figs 24 27 s and e stand for the contaminant source and extraction well respectively the numbers represent the sequence for drilling the remediation wells 
130,groundwater contamination causes significant groundwater supply risks that severely affect humans and livestock especially in the era of climate change consequently the need to develop and optimize remediation strategies such as pump and treat is indispensable an effective and efficient strategy can reduce the spread of contaminants and cost of clean up however developing such a strategy is challenging due to the inherent uncertainty and sequential nature of the problem for example taking actions such as drilling wells is interwoven with information gathering over time in this paper we formulate the groundwater remediation planning and decision problem as a partially observable markov decision process pomdp a pomdp formulation allows planning by optimizing the trade off between information gathering and the performance of possible future scenarios we use a state of the art pomdp solver called despot for planning remediation strategies the results show that despot can yield much better remediation strategies than hand crafted heuristics and optimization methods the superior performance of despot is due to the incorporation of both previous information and future reward into the current decision we also demonstrate the robustness of the pomdp formulation to measurement error keywords pomdps belief updates particle filter bayesian inversion model predictive control closed loop optimization sequential decision making groundwater management particle swarm optimization pso 1 introduction groundwater is one of the most significant sources of water not only for drinking but also for agricultural irrigation industrial use and recharge for lakes and wetlands usgs estimated use of water in the united states in 2000 www document url accessed 12 01 2021 about 70 of groundwater withdrawn worldwide is used for irrigation and about half the drinking water comes from groundwater famiglietti and james 2014 gleeson et al 2016 2011 mukherjee et al 2021 as a result of population growth and climate change demand for groundwater has grown in the united states the withdrawal volumes from 1950 to 2015 increased by almost 250 from 34 billion barrels to about 82 billion barrels of water per year usgs trends in water use in the united states 1950 to 2015 www document url accessed 12 01 2021 groundwater contamination represents significant risk to the water supply because contaminated groundwater can severely affect humans and livestock in addition the higher demand for groundwater amplifies the problem of groundwater contamination because the higher withdrawal rates result in higher pressure differences in aquifers which accelerates the transport of contaminants towards drinking water wells the national research council reported in 2013 alternatives for managing the nation s complex contaminated groundwater sites 2013 that the collective groundwater remediations in the us could cost up to 127 billion usd indicating the critical need for optimized groundwater remediation strategies depending on the source of contamination remediation may involve chemical biological or physical techniques while chemical and biological techniques convert pollutants into harmless products physical techniques aim to remove the pollutants a widely used and practical remediation technique is pump and treat p t which withdraws pollutants from aquifers via extraction wells and then separates the pollutant from the groundwater in surface facilities matott et al 2006 a p t operation is a complex task that can severely increase the remediation performance and clean up time a poorly planned approach can increase the contaminant spread and the required clean up time and cost some of the main decisions for such an operation are the location and number of the extraction wells pumping rates and completion intervals those decisions are sequential in nature for example extraction or injection wells are drilled in sequence and their corresponding extraction and injection rates can be changed over time many other groundwater management problems are sequential in nature groundwater management decisions are challenging because forecasting the temporal and spatial distribution of the contamination requires the careful placement and operation of extraction wells in addition predicting subsurface flow is challenging because of many subsurface uncertainties numerical models of physical flow and chemical transport can aid in prediction the main challenge in generating predictions of spatial and temporal head and contaminant distribution used for decision making lies in the construction of the subsurface models uncertainties of the subsurface result from imperfect information important model variables are only partially observable storage lithology hydraulic conductivity and hence need to be estimated boundary conditions of a groundwater system can only be inferred imperfectly from limited head measurements zhang et al 2014 the recent increase in accessibility to computational resources makes methods involving numerical simulation models in combination with optimization algorithms s o more attractive because numerical simulation models represent the groundwater reservoir more realistically the simulator is used to predict the spatial temporal contaminant distribution while the optimizer is used to find an optimum set of decision variables such as well location or extraction rate that minimize a specified objective function possibly with constraints to solve decision problems such as p t tasks many scholars have adopted the idea of static optimization also known as one shot optimization which optimizes for a sequence of actions once and then blindly executes those actions chang et al 2007 huang and mayer 1997 mategaonkar and eldho 2012 matott et al 2006 mckinney and lin 1996 piscopo et al 2015 a variety of different optimization algorithms have been used for groundwater remediation in the static s o domain such as simulated annealing dougherty and marryott 1991 genetic optimization mckinney and lin 1996 and hybrid approaches yang et al 2013 fu and wen 2017 considering the variety of metrics of interest in real world applications that need to be optimized simultaneously the optimization in groundwater remediation can also be formulated as a multi objective problem for example piscopo et al 2015 show the balance of the performance of contaminant degradation with efficiency the problem with static optimization is that even though new information is available at every step that an action is executed this information is not considered during the optimization process an alternative is to use model predictive control mpc where plans are sequentially reoptimized in response to new information borrelli et al 2017 because most subsurface problems include many sources of uncertainty it is especially important to gather information to reduce the uncertainty and update belief at each step jansen et al 2009 zimmer et al 2015 jahandideh and jafarpour 2019 however a major limitation with mpc is that it does not reason about potential future information during the planning period in contrast a markov decision process mdp and a partially observable markov decision process pomdp formulation take future information gain into account during planning in the related field of oil and gas reservoir management the sequential decision problem of placing wells and optimizing injection rates was formulated as a mdp de paola et al 2020 and a pomdp torrado et al 2017 however in their work there is no performance comparison between their approaches and the conventional state of the art optimization approaches such as the one shot optimization and the mpc optimization using belief updates in this work we formulate the groundwater remediation planning problem as a pomdp first we show how defining a groundwater management problem as a pomdp results in an optimization problem that accounts for future information gain to maximize the total utility of all decisions second we present a method to solve the decision problem using the online pomdp solver despot though we present the formulation and solution for the p t planning task the proposed methods can be used for any groundwater management task that can be represented in the same formalism compared to static optimization and mpc depsot results in better decisions because it takes into account the availability of future information we provide a general formulation of the groundwater management problem that can be easily extended with other possible actions or reward functions 2 partially observable markov decision processes markov decision processes can be viewed as a standard representation of sequential decision making problems kaelbling et al 1998 an mdp is defined by the following five components bertsekas 2012 state space s a set of possible states of the environment action space a a set of possible actions transition model t a conditional distribution over the environment state s after having taken action a from state s it is often written as a conditional distribution over the next state s from the current state s after executing the action a t s s a the transition model in an mdp assumes that the next state distribution only depends on the current state and action reward function r the reward function returns the expected reward for taking action a in the current state s denoted r s a discounted factor γ the discounted factor is applied to the reward at each time step γ 0 1 the goal in solving a sequential decision problem is to choose actions that maximizes the discounted return defined as t 1 γ t 1 r t where rt is the reward received at step t an mdp policy is a function that maps a state s to an action a π s the value of a state under a policy is the expected return when following that policy from the given state and all subsequent states the value is defined as u t π s t 1 t γ t 1 r s t π s t where the expectation is taken over states sampled from the transition function an optimal policy is one that returns the action that results in the maximum expected value for each state in many sequential decision making approaches a policy is learned through interacting with a simulation a key assumption made in an mdp is that the current state is known in many problems however the state may not be known precisely but is instead observed with noisy measurements for example in a groundwater management problem the porosity of the reservoir state may not be exactly known but can be imperfectly inferred from noisy seismographic measurements noisy measurements such problems are referred to as partially observable a framework called partially observable markov decision processes pomdps captures this idea kochenderfer 2015 the pomdp formalism is an extension of the mdp in addition to the state action transition model t and reward function r defining the mdp a pomdp is defined by including the following two additional elements observation space o a set of possible observations that an agent can perceive from the environment observation model o a conditional distribution over the observation received after taking action a from state s and transitioning to state s o o a s because the state of the world is unknown pomdps are often solved by planning over the space of possible beliefs a belief is a probability distribution over states where b s represents the probability assigned to being in state s the agent starts with an initial belief b that represents any prior information about the current state the agent then obtains an updated belief b from bayes rule after taking action a and observing o b s p s b a o o o s a s s t s s a b s this update is shown for a discrete state space an equivalent update can be calculated for continuous spaces by integrating over the state space in place of the summation approximate bayesian updates may also be used for example with particle filtering approaches arulampalam et al 2002 the goal for an agent in a pomdp is to maximize the expected discounted return 3 groundwater problem formulation the purpose of our work is to illustrate the potential of the pomdp formulation in groundwater management a synthetic case with all elements of a sequential decision making problem is used for that purpose using a synthetic case is advantageous because the true state ground truth of the reservoir can be fully known therefore the results from the true state can be compared with results obtained from algorithms we use the observations obtained after drilling a well to update a model the synthetic model enables us to go through several drilling cycles by using the ground truth to generate those observations the synthetic case is a two dimensional heterogeneous groundwater system the domain is 100 meters in the east west and the north south extension discretized with 25 grid blocks in each lateral dimension both the eastern and western boundaries are open to flow while the reservoir is confined at the northern and southern boundaries the aquifer has a thickness of 25 meters and is bounded below by an impermeable layer the aquifer is fully saturated the introduced aqueous contaminant in our illustration case is fully miscible and does not react with the in situ fluid or the rock this work uses modflow mcdonald and harbaugh 1988 to solve for flow and mt3dms zheng et al 1999 to predict contaminant concentration for each grid block it is important to mention that the physical forward models can be exchanged for any other physical forward model without changing any of the problem formulations presented later the contaminant source is in the western part of the aquifer we consider two different problem environments one with a single extraction well and a second with two extraction wells the contaminant is being continuously injected at a concentration level of 10 mass per volume ml 3 at an injection rate of 500 volume per time l3t 1 whereas the well is extracting at a constant rate of 100 volume per time l3t 1 both well controls do not change over time without any remediation work for example the contaminant breaks through at the extraction well approximately 11 days after initial contamination and reaches a maximum level after 300 days for the single extraction well environment fig 1 shows the groundwater reservoir with and without p t on day 400 we define the problem of sequentially placing wells for p t as a formal sequential decision making problem the goal is to minimize the concentration of the contaminant at the extraction well while satisfying constraints more specifically we aim to optimize the sequential placement of remediation wells of a p t operation to minimize the average contaminant concentration during the operation period between 100 and 400 days for simplicity we keep the number of remediation wells and time of drilling fixed the first well is drilled at 100 days the second at 200 days and the third at 300 days two of the remediation wells are operated at an extraction rate of 100 l3t 1 and one at 200 l3t 1 to make the illustration case more realistic and challenging the injector is operated at 500 l3t 1 for the entire 400 days again well controls do not change over time we also introduce noisy measurements of the contaminant to assess how measurement accuracy affects decisions 3 1 state space the state defines the environment under investigation the state space is a collection of possible realizations where each state represents porosity and hydraulic conductivity for each grid block in addition to the geological realizations the locations of the remediation wells are part of the state definition 3 2 action space the action space is defined by the possible locations where a remediation well can be placed we decided to only include every other grid location in the feasible set of drilling locations because remediation wells are usually not drilled right next to each other blue shaded grid blocks in fig 2 additionally we exclude the vicinity around existing wells red and green shaded areas in fig 2 from the action space it is essential to recognize the complexity of the curse of history in this groundwater case for example given roughly 300 possible drilling locations and three decision steps the combinatorial problem results in approximately 3003 possible action combinations 3 3 transition model in the presented groundwater case drilling remediation well cannot change any geological properties therefore the transition model for the geological states is s g e o s g e o however the transition model for the well location state is adding the location of the currently placed remediation well to the existing remediation well locations both transition models are deterministic 3 4 reward function the reward function encodes preferences that guide the agent in finding an optimal solution the objective function on the other hand is the sum of the reward over all time steps we define the reward function using the average contaminant concentration from the extraction well in the case of single extraction well the reward function takes the average contaminant concentration in the case of two extraction wells the reward function takes the maximum average contaminant concentration between the two extraction wells fig 3 shows the reward function the abscissa represents the contaminant concentration in the extraction well and the ordinate represents the corresponding reward the reward is not directly a function of the state but is a function of the contaminant concentration the reason for this is that for a given state geological realization and well locations the modflow mt3dms simulator outputs deterministic concentration levels for all wells and time steps we decided to shape the reward function as a cosine function because high concentrations of contaminant should be avoided the reward function maps high concentrations into lower rewards on the other end of the spectrum very low contaminant concentrations are more desirable and therefore are mapped into higher rewards for concentrations in the middle the reward function is almost linear in more general settings a reward function does not need to be a monotonic function and can be defined over many properties of interest 3 5 belief because we do not fully observe the aquifer system the problem is defined as a partially observable markov decision process consequently we need to define a belief over the state we define distributions over the unknown subsurface model parameters as summarized in table 1 in practice these distributions will be estimated by experts using data from for example pumping test and geophysical analyses in our experiments we generate 100 geological realizations using sequential gaussian simulations deutsch and journel 1998 we assume that this ensemble of 100 realizations defines the set of possible models and represents all information available at the start of the problem as similarly done in ensemble methods such as enkf kalman 1960 evensen 2003 wen and chen 2005 2006 hendricks franssen and kinzelbach 2008 we then define the initial belief as a uniform distribution over the 100 realizations the size of state grows exponentially with the number of state variables namely curse of dimensionality in this case the number of possible belief states equals to the number of possible geological realizations times the number of the possible well locations in the case of the single well only the main angle of the hydraulic conductivity is used to generate 100 realizations in the two extraction wells case the parameters in table 1 are used to generate 100 realizations the way we treat the one hundred realizations is by attributing to them multiple indicator random variables ik 1 if realization k is chosen ik 0 elsewhere we assign a prior probability to each indicator random variable as p i k 1 1 n where n 100 fig 4 shows 3 out of 100 realizations 3 6 observation space and observation model the observation space comprises the measured contaminant concentration at the extraction well s the contaminant concentration is computed by the modflow mt3dms simulator observation model given the current state 3 7 belief update we perform belief updates using a customized particle filter the specific steps of the customized particle filter are shown in algorithm 1 the algorithm starts to sample particles of uncertain variable θ conductivity direction or geological realization from a uniform prior π belief it collects the concentration vector y conc from the extraction well s based on a sampled particle an example of the concentration response in the extraction well can be seen in fig 10 the mismatch based on the ℓ1 norm t y c o n c t y o b s t during the operation period is then calculated and appended to y mismatch where y obs is the observed concentration vector based on underlying ground truth the algorithm finally uses the exponential likelihood exp y mismatch 0 1 to compute weights for each particle 4 solution methods this section introduces four different solution methods for solving the presented groundwater management problem 4 1 heuristic solution the heuristic solution presents the baseline of comparison for the different approaches in the absence of subsurface groundwater models or the lack of optimization tools human experts guided by their knowledge in physics and experience in the field will decide on the location of remediation wells as a heuristic solution we elaborate on the heuristic solutions based on human intuition in the result section because they fully depend upon specific problem environments 4 2 pso one shot particle swarm optimization pso is a stochastic population based optimization algorithm as opposed to traditional single point optimization methods pso uses a set of points to search a minimum of a given problem each point or particle in the set is a potential solution pso starts with randomly initialized particles to find a minimum each particle moves around in the problem defined searching space based on two values the best solution it has found x best i and the best solution that has been found by any particle xbest at each iteration particles update their positions and velocities with following equations kochenderfer and wheeler 2019 x i x i v i v i w v i c 1 r 1 x b e s t i x i c 2 r 2 x b e s t x i where w balances between global and local minimums larger w tends to make the algorithm converge to global minimums r 1 and r 2 are sampled randomly from u 0 1 to ensure the stochasticity c 1 and c 2 are acceleration parameters large values of c 1 and c 2 allow the algorithm to exploit the areas around x best i and xbest koohi and groza 2014 we use pso to optimize for a sequence of remediation well locations without updating belief on the underlying conductivity direction or geological realization we name this solution method as pso one shot because all well location decisions are made before the first well is drilled pso one shot randomly samples particles of all three remediation wells from the feasible actions as shown in fig 2 and finds the combination that minimizes the objective function the objective function for pso one shot is to minimize the average contaminant concentration from the extraction well during the operation period from 100 days to 400 days in the case of two extraction wells the objective function minimizes the maximum average contaminant concentration between the two extraction wells during the operation period 4 3 pso mpc we formulate pso under the model predictive control mpc formulation called pso mpc as the third solution method pso mpc updates the belief with the observations obtained from the previously drilled well and reoptimize with an updated belief at each step it accounts for future actions without considering feedback from the environment though pso mpc starts to optimize all three remediation wells but only the first well is determined before the first belief update once the first well is chosen the algorithm optimizes the rest two remediation wells along with the determined first well based on an updated belief the second well is then chosen before the second belief update pso mpc repeats the same manner and stops after all three remediation wells have been placed this process is demonstrated as a dynamic decision network shown in fig 5 during the optimization pso mpc shares the same objective function as pso one shot 4 4 despot there are many methods for solving mdps and pomdps exact methods are generally computationally intractable for most practical problems as the number of possible paths grows exponentially with the length of the required action sequence madani et al 2003 papadimitriou and tsitsiklis 1987 exact methods generally cannot be defined for continuous pomdps some approximate methods instead search for optimal policies by sparsely sampling trajectories from the full set many approximate methods have been developed such as monte carlo tree search mcts chaslot et al 2008 and determinized sparse partially observable tree despot search ye et al 2017 due to the large action and observation spaces of our illustration case the planning algorithm we deployed in this paper is despot additionally this algorithm choice is driven by the deterministic contamination response of the groundwater simulator given specific remediation well locations mcts uses the upper confidence bound applied to trees uct algorithm kocsis and szepesvari 2006 to trade off exploration and exploitation which can be overly greedy ye et al 2017 we will review despot in this section the despot agent searches for the best action based on the current belief executes the action and updates the belief based on the resulting observations somani et al 2013 the agent will repeat this process with an updated belief this sequence of alternating between taking an action and searching for the best next action is called online planning despot is a state of the art online pomdp solver a general framework for searching for an optimal policy in online pomdp planning is with belief trees ross et al 2008 a belief tree shown in fig 6 starts with the initial belief represented as a root node the root will then recursively expand based on all possible actions resulting observations and updated beliefs up to depth d each node in the belief tree represents a belief therefore the size of the belief tree grows exponentially with depth and yielding o a d d belief nodes where a and are the number of possible actions and observations respectively despot avoids this exponential growth curse of dimensionality and curse of history by sparsely sampling both states and observations thus forming a sparse belief tree the determinization of despot as its name suggests results from a sparse belief tree that consists of fixed state action and observation pairs the determinization is realized by a set of sequences of uniformly sampled numbers between 0 and 1 a sequence of numbers is also called a scenario given an action sequence and an initial sampled state a scenario determines a unique trajectory of states and observations by controlling the stochasticity of the transition and observation models in other words a uniformly sampled number in a scenario can map a state action pair s a to the successor state observation pair s o according to a deterministic function the determinized sparse belief tree is shown in fig 7 despot contains all actions but it limits the included observations to those sampled from the scenarios therefore the despot reduces the size of the belief tree to o a d k where k is the number of sampled scenarios since a despot will be truncated to a user defined maximum depth d we will get an approximation of an optimal policy by searching the truncated tree the recursive bellman equation shown below applied at each internal node to get the maximum value function on the current belief u b max a a s s b s r s a γ o o o o b a u b the action at the root node that maximizes the value function will be chosen and executed besides sampling scenarios to speed up lookahead search despot also incorporates a user defined upper bound and a default policy as a lower bound estimate on optimal value at each leaf node the lower and upper bounds help to rule out subtrees based on their optimal values we run despot in anytime mode so the full despot is not constructed fig 8 demonstrates the planning and optimization processes of despot as a dynamic decision network for solving a pomdp problem 5 results table 2 summarizes the results from four different solution methods involving a single extraction well in addition to total expected reward and the objective function we introduce an additional metric to analyze performance shown in the second row of table 2 the first row is the average concentration of contaminations from the extraction well during the remediation period from day 100 to 400 the second row is the cumulative extracted contaminations from the extraction well during the remediation period appendix a 1 includes the decisions on the remediation well locations associated with table 2 all approaches perform similarly in this scenario the following sections will show that despot brings a significant benefit in more realistic and complex scenarios we increase the complexity of the problem with two extraction wells that are located on either side of the contaminant source because both extraction wells are equally important in terms of low contaminant concentration we cannot favor a particular extraction well and neglect the other due to the fact the extraction wells are in different directions from the contaminant source one towards the north and the second towards the east the belief over the underlying hydraulic conductivity field becomes a more important factor for example in the case of the main hydraulic conductivity direction being north south the northern extraction well will pump the most contaminant consequently the remediation wells would need to focus on the northern part to keep the contaminant levels low 5 1 heuristic solution a heuristic solution is to put two remediation wells around the northern extraction well and a single remediation well in front of the eastern extraction well shown in fig 9 the intuition is that the northern extraction well is spatially closer to the contaminant source therefore the contaminant is more likely to be drawn into the northern extraction well first fig 10 shows the concentration profiles for both extraction wells we observe a kink in the concentration levels when a remediation well is drilled the maximum average concentration between two extraction wells during the operation period is 3 825 corresponding to a reward of 3 61 after the first remediation well is drilled we can observe a small reduction of concentration of contaminations the combination of continuous injection of contaminations and the first remediation well location results in an immediate increase in concentration on both extraction wells additional subsequent remediation wells can reduce the contaminant concentration levels of the extraction wells 5 2 pso one shot solution pso one shot optimization leads to a similar strategy as the heuristic solution two remediation wells are placed to protect the northern extraction well and one remediation well is placed for the eastern extraction well shown in fig 11 the concentration curves of the pso one shot solution are shown in fig 12 the maximum average concentration between the two extraction wells is 3 617 which results a reward of 4 21 5 3 pso mpc solution in the case of two extraction wells pso mpc has its belief on the geological realizations the algorithm starts with a uniform prior over 100 geological realizations the 3 iterations of belief updates are shown in the fig 13 at the first iteration the algorithm has a relatively strong belief on the geological realization with index 40 however the underlying truth in this case is the geological realization number 55 at iteration 2 and iteration 3 pso mpc quickly corrects its belief after collecting more observations in terms of well placements fig 14 pso mpc places the first remediation well underneath the northern extraction well the second remediation well is placed in the north of the contaminant source the algorithm remediates the eastern extraction well by placing the last remediation well in front of it pso mpc remediation strategy reduces the max average concentration during the operation period to 3 09 fig 15 this concentration has a reward of 5 65 5 4 despot solution with a uniform prior belief on 100 geological maps after collecting the first observation depsot significantly reduced geological uncertainties fig 16 collecting further observations iteration 2 and iteration 3 from fig 16 despot is almost certain that geological realization number 55 is the underlying truth as shown in fig 17 despot places the first remediation well between the northern extraction well and the contaminant source the agent places both the second and third well in front of the eastern extraction well as the predominant extension of the contaminant is in the eastern direction the performance of the remediation strategy from despot is shown in fig 18 after the first action both concentration curves quickly drop down the maximum average concentration of two extraction wells during the operation period is 2 083 the reward is then 5 66 given the max average concentration table 3 summarizes the results of the two extraction wells case the first row is the maximum average concentration of contaminations between the two extraction wells during the remediation period from day 100 to 400 the second row is the maximum cumulative extracted contaminations between the two extraction wells during the remediation period in both cases despot performs best 6 discussion this section discusses the performance of the different approaches we discuss the differences between the case with a single extraction well and the more complex case with two extraction wells and the consequences for future applications 6 1 two extractions wells the two extraction wells are positioned in different directions using the same number of remediation wells leading to a more complex decision scenario the placement of remediation wells needs to balance the protection strategy to not favor a given extraction well over the other one therefore knowing the underlying hydraulic conductivity direction for example is more critical than in the case of a single extraction well in contrast to the expert solution the one shot optimization places all three wells closely together around the northern extraction well fig 11 as a result the one shot optimization approach yields in a 5 4 percent better solution than the heuristic solution table 3 the absence of a remediation well in front of the eastern extraction well seems counter intuitive but the group of remediation wells limits the contaminant flow towards the east fig 19 additionally the remediation wells create a barrier between the northern well and the contaminant source the pso mpc approach performs better than the heuristic solution and the one shot optimization the reason for this improvement is that pso mpc reduces uncertainty in the geological realizations using belief updates notice the high conductivity streak that connects the contaminant source and the eastern extraction well in fig 19 knowledge of the position of the high hydraulic conductivity streak obtained from partial observations concentration is important to block contaminant flow towards the eastern well fig 20 in contrast with pso mpc despot placed two remediation wells within the east west conductivity streak and only one remediation well in the northern part despot placed the single remediation well in the northern part because there is a low hydraulic conductivity band between the contaminant source and the northern extraction well fig 21 the band limits fluid flow into the norther direction the two remediation wells placed in the high conductivity streak serve two purposes the second well is placed close to the eastern extraction well to reduce the contaminant that has already reached the eastern well the third well is also placed in the streak but closer to the contamination source as a booster to further control the spread of the contaminant the improved performance of despot is due to the accounting future information pso mpc only takes a single sample into account when computing expected future reward despot chooses the first well to gather information to improve the choice of future actions in contrast the optimization framework does not reason about future uncertainty reduction when making a decision the pso algorithm randomly samples potential action sequence but despot searches for the solutions based on the despot tree structure allowing it to focus on promising action branches 6 2 generalization to real world scenario the performance difference between despot and other solutions becomes much more significant in the case of two extraction wells than in the simple scenario the scenarios using one and two extraction wells demonstrate that despot can perform better in a more complex environment many real world applications may include many more remediation and extraction wells and have additional complexities from both geological and engineering uncertainties such as geochemical reactions between fluid and rock as well as the timing at which remediation wells are drilled consequently problem formulations of these real world applications result in a significantly larger action and state space additionally most of the time these applications are associated with long time horizons therefore it is important to be able to efficiently and effectively search the space of solutions 6 3 accounting for inaccurate observations in addition to efficiently solving complex problems our solution approach can also be easily adapted and expanded one possible extension is the introduction of noisy observations taking measurements in the field comes with choosing measurement accuracy and assessing how that accuracy affects decisions to illustrate how a pomdp framework performs under inaccurate measurements we added a gaussian noise on the concentration observations the gaussian noise has 0 mean and 0 1 variance this choice of the gaussian noise makes about 10 percent of geological realizations indistinguishable since our focus is to illustrate the application and the corresponding potential of a pomdp framework we chose this variance for real world applications measurement device specifications can guide the variance choice inaccurate measurements reduces despot performance by about 2 7 percent and pso mpc by about 1 8 percent in terms of max average concentration table 4 in despot the third remediation well is located closer to the eastern extraction well than in the non noisy case as shown in fig 22 notice the difference between the belief updates in figs 16 and 23 noise impacts the belief update reducing the confidence despot has in the geological map index 55 underlying truth having less accurate knowledge of the underlying geological model consequently affects decision quality although the performance of the algorithm was impaired by noise despot still performs better than all other approaches table 4 6 4 computational time to compare optimization formulations with pomdp we make all solution approaches take approximately the same time representing about 18 hours of running time on the same single core cpu 2 4 ghz intel core i9 specifically we use a particle size of 250 for pso and 50 sampled scenarios in despot in addition all approaches run on 100 geological realizations 7 conclusions this paper showed how to model a pump and treat sequential decision problem in a groundwater application as a pomdp we defined the necessary components of the pomdp framework for a synthetic groundwater application we analyzed the value of reasoning about future beliefs as done using despot to our knowledge this is also the first time that a pomdp framework in a subsurface application is compared with both a hand crafted heuristic solution and optimization approach we incorporate both conventional one shot optimization and mpc optimization with belief updates we demonstrated the importance of gathering information to make effective sequential decisions in this paper the information for belief updates came from the concentration measurements from the extraction wells however the pomdp framework with belief updates can be easily adapted to other sources of information such as head measurements or tracer tests we also demonstrated the robustness of the pomdp framework to inaccurate measurements and its adaptability the formulation can be extended to include the injection rate into the action space and financial costs into the reward function in the groundwater case studied in this paper the states are comprised as geological realizations but the formulation can be easily changed to use the geological model parameters as the state we illustrated that despot exceeds the performance of all other solutions under various scenarios in complex environments the pomdp framework outperforms other solutions by a large margin despot achieves this performance by efficiently and effectively reasoning about large state action and observation spaces that typically characterize subsurface applications we think that the pomdp framework is a powerful tool for making complex real world groundwater decisions under uncertainty moreover because of its generality the framework can be easily adapted to other groundwater applications such as groundwater management or recommending groundwater remedies credit authorship contribution statement yizheng wang conceptualization methodology software formal analysis investigation data curation validation visualization writing original draft writing review editing markus zechner conceptualization methodology software validation visualization data curation writing original draft writing review editing john michael mern conceptualization methodology visualization writing review editing mykel j kochenderfer conceptualization methodology writing review editing supervision jef karel caers conceptualization methodology writing review editing project administration supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper appendix a 1 results for protecting single extraction well in the following section we will present the results for the test case with a single extraction well in the plots figs 24 27 s and e stand for the contaminant source and extraction well respectively the numbers represent the sequence for drilling the remediation wells 
131,quantitative descriptions of the temporal and spatial variations of volumetric water content and total water potential in unsaturated soils have for more than nine decades focused on diffusive mechanisms as represented by the richards equation richards 1931 however recent laboratory studies lo et al 2017 have revealed short time transient behavior of water in non deforming unsaturated soils that is distinctly oscillatory not diffusive in this paper we establish a theoretical framework to generalize the richards equation in a systematic way to account for non diffusive mechanisms giving rise to oscillatory behavior in the water content and total water potential a partial differential equation is developed with the total water potential as the dependent variable based on the coupling of mass and linear momentum balance within the continuum theory of mixtures this new differential equation becomes equivalent to the richards equation when non diffusive mechanisms can be neglected but when this condition is not met the governing equation describes damped propagating wave behavior of the total water potential this dynamic wave differs from a poroelastic wave in respect to solid framework motions and wave speed as well as time and length scales for a rigid homogeneous unsaturated soil the governing equation reduces to the telegraph equation which can be solved analytically an inherent feature of our approach is the appearance of natural time and length scales characteristic of total water potential waves consideration of these natural scales for three representative soils of differing texture helps to prescribe more precisely the domain of applicability of the richards equation keywords dynamic water potential waves unsaturated soils natural time scale natural length scale 1 introduction the traditional mathematical description of transient variations in the matric potential and volumetric water content in rigid homogenous unsaturated soils is underpinned by an elliptic parabolic differential equation the richards equation which is derived by combining the empirical buckingham darcy flux law with the equation of continuity richards 1931 swartzendruber 1969 warrick 2003 the physics underlying this famous differential equation involves a diffusion type process as the sole mechanism driving the flow of water however for more than seven decades limitations on the general applicability of the richards equation to interpret unsaturated flow phenomena in laboratory and field experiments have been reported to emerge either at certain length and time scales or for certain flow problems e g kirkham and feng 1949 nielsen et al 1962 applying methods of non equilibrium statistical mechanics sposito 1980 derived an exact equation of linear momentum balance for water flowing in a rigid homogenous unsaturated soil showing that it led to the richards equation if the water mass density and water mass flux density constituted a complete set of coupled dynamical variables to describe water flow and if the time scale over which they varied was much longer than that over which other dynamical variables varied notably the water energy density torres et al 1998 reported from two field experiments that as soils approach saturation a sudden increase in rainfall intensity creates not only a slight variation in hydraulic head gradient but also a considerable change in hydraulic conductivity the physical basis of this phenomenon was believed to be the presence of a rapidly advancing acoustic wave on a basis of a series of laboratory experiments lo et al 2017 have recently documented that the soil matric potential may exhibit transient variations within a very short time frame due to acoustic wave excitation over a range of seismic frequencies thus leading to a rapid change of water content in unsaturated soil notably the soil solid framework was not observed to undergo deformations in contradiction to the basic premise of poroelasticity that the solid framework does deform accordingly the wave observed by lo et al 2017 should be fundamentally different from a poroelastic wave the principal objective of the present study is to establish a theoretical framework to generalize the richards equation in a systematic way to account for mechanisms underlying the short time wave behavior discussed above a new partial differential equation for water flow in rigid homogeneous unsaturated soils that is second order in both the time and space domains is derived involving coupled water mass density and water mass flux density variables using the continuum theory of mixtures lo et al 2002 2014 instead of non equilibrium statistical mechanics sposito 1980 when certain physical conditions are met to be discussed our governing partial differential equation reduces to the richards equation when these conditions are not met the governing equation becomes a telegraph equation with the total water potential as the dependent variable thus describing a damped propagating total water potential wave this partial differential equation is invariant under scaling transformations and therefore its general solution can be explored using symmetry analysis leading to the conclusion that this solution has the form of a bessel function of order zero symmetry analysis also provides a natural time scale natural length scale and associated wave speed to characterize dynamical water potential wave processes as illustrative examples numerical calculations are performed to evaluate these characteristic parameters for three soils of differing texture 2 linearized balance laws employing the continuum theory of mixtures truesdell 1984 lo et al 2002 formulated a set of macroscopic differential equations for mass and momentum balance during two phase immiscible fluid flows in a porous medium 2 1 conservation of mass 1 1 d α ρ α θ α d t ρ α θ α v α 0 α s 1 2 2 2 conservation of momentum 1 fluid phases ρ ξ θ ξ d ξ v ξ d t θ ξ p ξ λ ξ d ξ δ 2 μ ξ d ξ ρ ξ θ ξ g β 1 2 r ξ β v β s 1 2 β 1 2 a ξ β a β s α s 1 2 π ξ α t α 0 ξ 1 2 2 solid phase 1 3 ρ s θ s d s v s d t t s ρ s θ s g ξ 1 2 p ξ θ ξ ξ 1 2 β 1 2 r ξ β v β s ξ 1 2 β 1 2 a ξ β a β s ξ 1 2 α s 1 2 π ξ α t α 0 where ρ α denotes the material density of phase α the subscript α designating three immiscible phases the solid α s the nonwetting fluid α 1 fluid 1 and the wetting fluid α 2 fluid 2 θ α signifies the volumetric content of phase α ρ α θ α thus referring to its partial density v α and a α represent the velocity and acceleration of phase α respectively d ξ expresses the rate of deformation tensor or stretching tensor of fluid phase ξ ξ 1 2 d ξ indicates its volumetric strain rate equal to the trace of d α p ξ symbolizes the pore pressure of fluid phase ξ δ is the unit tensor λ ξ and μ ξ are scalar coefficients associated with macroscopic viscous properties of fluid phase ξ t α is the temperature of phase α g is the gravitational acceleration r ξ β is the isotropic tensor associated with viscous drag whereas a ξ β is that pertinent to inertial drag π ξ α is the isotropic tensor related to heat transfer v β s v β v s is characterized to as the velocity of the phase β relative to that of the solid phase and a β s a β a s is the relative acceleration vector let us consider an incompressible wetting fluid ρ 2 constant moving through a rigid v s 0 porous medium and follow conventional simplifying assumptions often adopted to analyze flow and transport in porous media gray 1983 1 the fluid phases are macroscopically inviscid λ ζ μ ζ 0 2 temperature gradients are neglected t α 0 3 mechanical coupling caused by inertial drag is neglected a ξ β 0 4 viscous drag arising from the interaction between the two interstitial fluids due to their velocity differences is negligibly small r 12 r 21 0 5 the pressure gradient required to drive the flow of the non wetting fluid is ignored p 1 v 1 0 implying that the non wetting fluid remains always at atmospheric pressure and is free to escape from or enter into the porous medium and 6 r 22 is diagonal with the same principal axes accordingly eq 1 can be reduced to 2 3 conservation of mass 2 1 θ 2 t θ 2 v 2 0 2 3 1 conservation of momentum 2 2 d v 2 d t p 2 ρ 2 g r 22 ρ 2 θ 2 v 2 where r 22 θ 2 2 η 2 k s k r 2 designates the viscous coupling parameter with η 2 denoting the dynamic shear viscosity of the wetting fluid henceforth termed water ks symbolizing the intrinsic permeability of the porous medium and k r2 indicating the relative permeability of the medium to water de marsily 1986 the consequence of the first assumption 1 is that the macroscopic velocity profile of fluid flow is uniform perpendicular to the flow direction bear 1988 the second assumption 2 is justified if we are concerned only with isothermal conditions the assumptions 3 5 are commonly made in the description of two phase fluid flow in subsurface hydrology dullien 1992 if the coordinate system is oriented along the principal axes the diagonal representation of r 22 in the last assumption 6 is valid the total water potential φ2 l 2 t 2 in an unsaturated soil is defined as 3 φ 2 p 2 ρ 2 g z ψ 2 g z where ψ 2 p 2 ρ 2 attributed to capillary and adsorptive forces acting among liquid gas and solid phases is the matric potential hubbert 1940 introducing eq 3 into eq 2 2 we find 4 d v 2 d t φ 2 b θ 2 v 2 where the parameter b is given by b θ 2 r 22 ρ 2 θ 2 2 η 2 k s k r 2 ρ 2 g k 2 θ 2 t 1 k 2 θ 2 expressing the hydraulic conductivity of water at a given volumetric water content which is inversely related to b θ 2 because we are dealing with a porous medium permeated by two viscous immiscible fluids experiencing small disturbances due to water potential perturbations we consider small deviations from the equilibrium distribution of the total water potential φ 2 z this linearization scheme has been widely applied for modeling fluid flows and solid framework deformations in unsaturated soils e g brutsaert 1964 tuncay and corapcioglu 1997 lewise and schrefler 1998 wang 2000 verruijt 2014 mathias and butler 2018 therefore the value of a physical property induced in the current disturbed configuration can be regarded as the value in the reference undisturbed configuration taken as the unperturbed state before changes in total water potential denoted by a superscript 0 plus a small difference between the current and reference values denoted by capital delta δ e g θ 2 θ 2 0 δ θ 2 and φ 2 φ 2 0 δ φ 2 where θ 2 0 z and φ 2 0 z are functions only of the vertical coordinate z in this small deviation regime it remains accurate to neglect products of small quantities i e solely first order terms are retained lighthill 1978 biot 1962 lo et al 2005 accordingly eqs 2 1 and 4 can be linearized 2 3 2 conservation of mass 5 1 δ θ 2 t θ 2 0 v 2 v 2 θ 2 0 0 2 3 3 conservation of momentum 5 2 v 2 t δ φ 2 b 0 θ 2 0 v 2 sposito 1980 derived a formal solution of eq 5 2 after rewriting it as 6 v 2 t 1 τ θ 2 0 v 2 τ θ 2 0 δ φ 2 where τ θ 2 0 1 b 0 θ 2 0 k 2 θ 2 0 g θ 2 0 is a constant having the units of time t the formal solution of eq 6 is then 7 v 2 exp t τ exp t τ δ φ 2 d t v 2 0 the partial integration 8 exp t τ δ φ 2 d t τ exp t τ δ φ 2 τ exp t τ δ φ 2 t d t allows eq 7 to be rewritten in a more physically transparent form 9 v 2 τ δ φ 2 v 2 0 exp t τ τ exp t τ exp t τ δ φ 2 t d t eq 9 reveals that the water velocity in eq 5 2 is the sum of three components the first being equivalent to the buckingham darcy flux law the second involving the initial condition and the third depending on the time derivative of the gradient of the total water potential sposito 1980 considered the case in which δ φ 2 is imposed instantaneously and then remains constant so that the third term on the right side of eq 9 vanishes and the water velocity is described accurately by the buckingham darcy flux law for times much larger than τ however if instead one considers time intervals comparable to τ and a non constant total water potential the neglected term in eq 9 must be taken into account thus eq 9 constitutes a generalization of the results of sposito 1980 to take into account the physical effects of a time varying gradient of the total water potential for example lo et al 2017 demonstrated experimentally that the matric potential may double within 6 ms i e frequency 150 hz under acoustic wave excitation at higher water saturations if a constant drainage flow rate is maintained such a change may induce a significant variation in water content 3 water storativity eq 5 contains both δφ2 and δθ 2 as dependent variables therefore to explore general solutions it is useful to derive a closure relation that links δφ2 to δθ 2 following lo et al 2005 an effective water storativity factor m is defined as the inverse slope of the water retention curve 10 m s 2 p 2 1 ϕ θ 2 p 2 where s 2 θ 2 ϕ refers to the relative water saturation and ϕ represents the porosity eq 10 is a general expression to extend the concept of specific storage in saturated soils to unsaturated soils bear 1988 an analogous parameter the differential water capacity is defined as the derivative of θ 2 with respect to the matric head θ 2 h 2 g θ 2 ψ 2 where h 2 ψ 2 g is the matric head the water capacity is introduced to develop an h 2 based formulation of the richards equation i e the matric head h 2 as the dependent variable jury et al 1991 by virtue of eq 3 eq 10 can be recast as 11 φ 2 g z t 1 ϕ ρ 2 m θ 2 t the linearized form of eq 11 is 12 δ φ 2 t 1 ϕ ρ 2 m 0 δ θ 2 t which gives rise to a relationship connecting δφ2 to δθ 2 in eq 12 m 0 is the undisturbed effective water storativity given by 13 m 0 s 2 0 p 2 0 1 ϕ ρ 2 θ 2 0 ψ 2 0 eq 13 can be written in a more physically transparent form 14 ψ 2 0 θ 2 0 c 0 2 where c 0 1 ϕ ρ 2 m 0 has the units of speed lt 1 in the equilibrium state the total water potential is independent of position φ 2 0 0 this implies by eq 3 the well known equilibrium relationship 15 d ψ 2 0 d z g since the matric potential in unsaturated soils is a function of volumetric water content at constant temperature and applied pressure one can rearrange eq 15 after using the chain rule for derivatives 16 ψ 2 0 θ 2 0 θ 2 0 z g which is known as the buckingham equation sposito 1986 in view of eq 14 eq 16 takes the alternative form 17 d θ 2 0 d z g d θ 2 0 d ψ 2 0 g c 0 2 eq 17 confirms that θ 2 0 is a function of z alone i e θ 2 0 z 4 equation of motion replacing the first and third terms in eq 5 1 using eqs 12 and 17 respectively we obtain 18 1 c 0 2 δ φ 2 t θ 2 0 v 2 w g c 0 2 0 where w v 2 z is the component of v 2 in the vertical z direction henceforth termed water seepage velocity eq 18 can be reorganized as 19 v 2 1 c 0 2 θ 2 0 w g δ φ 2 t taking the time derivatives of both sides of eq 19 one finds 20 v 2 t 1 c 0 2 θ 2 0 2 δ φ 2 t 2 g w t we next apply the divergence to both sides of eq 5 2 and incorporate eqs 5 1 12 and 20 into the result 21 2 δ φ 2 1 c 0 2 θ 2 0 2 δ φ 2 t 2 g w t b 0 c 0 2 δ φ 2 t θ 2 0 v 2 b 0 where c 0 b 0 and θ 2 0 are non uniform coefficients eq 21 is a comprehensive partial differential equation describing dynamical variations in the total water potential in unsaturated soils as specialized to purely diffusive phenomena i e ignoring second order time derivatives the second and third terms eq 21 becomes equivalent to the richards equation 1 c 0 2 δ φ 2 t 1 b 0 2 δ φ 2 θ 2 0 v 2 b 0 1 b 0 b 0 θ 2 0 v 2 θ 2 0 v 2 b 0 22 θ 2 0 v 2 1 b 0 δ φ 2 to achieve eq 22 the non inertial form of eq 5 2 has been employed by setting its left side equal to 0 thus eq 21 generalizes the richards equation to account for inertial effects 5 water seepage gravitational and total water potential accelerations to examine quantitatively the extent to which and how inertial effects have an impact on water movement through unsaturated soils we define a dimensionless parameter e to characterize the magnitude of the third term relative to the second term in eq 21 i e e g w t 2 δ φ 2 t 2 two different accelerations are involved in defining the parameter e the numerator represents water seepage gravitational acceleration the square root of the product of gravitational and water seepage acceleration whereas the denominator is the acceleration of total water potential as a consequence eq 21 can be expressed 23 2 δ φ 2 1 e 2 c 0 2 θ 2 0 2 δ φ 2 t 2 b 0 c 0 2 δ φ 2 t θ 2 0 v 2 b 0 when e 2 1 eq 23 becomes 24 2 δ φ 2 1 c 0 2 θ 2 0 2 δ φ 2 t 2 b 0 c 0 2 δ φ 2 t θ 2 0 v 2 b 0 by contrast whene 2 1 eq 23 becomes 25 1 c 0 2 δ φ 2 t 1 b 0 δ φ 2 1 b 0 c 0 2 θ 2 0 g w t which yields a form of the richards equation the sum of the first and second terms in eq 21 to incorporate the water seepage gravitational acceleration when e 2 1 eq 23 reproduces the richards equation 6 telegraph equation the analytical solution of eq 23 for general boundary and initial conditions is not available but analytical results are possible for particular assumptions boundary conditions and initial conditions these solutions are useful and reliable because they are exact and can not only be used to verify new computational models but also to provide physical insight into time and length scales for a porous medium that is homogeneous in the reference configuration all physical quantities evaluated are uniform e g b 0 0 this causes the last term in eq 24 to vanish in which case it becomes 26 2 δ φ 2 1 c 0 2 θ 2 0 2 δ φ 2 t 2 b 0 c 0 2 δ φ 2 t eq 26 is a well known partial differential equation the telegraph equation it provides an analytical framework for modeling dynamical changes in total water potential in unsaturated soils whenever its acceleration dominates the seepage gravitational acceleration eq 26 indicates that spatial and temporal variations in total water potential are governed by a propagating wave with dissipation caused by viscosity as an aside we note that it is commonly assumed one dimensional vertical flow to dominant for most situations of practical interest in subsurface hydrology such as infiltration even though in reality the flow is three dimensional if eq 26 is restricted to the z direction one can write 27 2 δ φ 2 z 2 1 c 0 2 θ 2 0 2 δ φ 2 t 2 b 0 c 0 2 δ φ 2 t accordingly it can be shown that besides δφ2 the vertical component of v 2 the water seepage velocity w also satisfies the telegraph equation if c 0 and θ 2 0 are uniform this can be seen by revisiting the linearized mass balance equation eq 5 1 under the one dimensional z condition with the assistance of eq 12 28 1 c 0 2 δ φ 2 t θ 2 0 w z in the same spirit the momentum balance law eq 5 2 in a linearized form for a one dimensional z representation is 29 δ φ 2 z w t b 0 θ 2 0 w 0 taking time derivatives of both sides of eq 29 one obtains 30 2 δ φ 2 z t 2 w t 2 b 0 θ 2 0 w t 0 combination of eqs 28 and 30 to remove the term δ φ 2 t gives rise to the expression 31 z c 0 2 θ 2 0 w z 2 w t 2 b 0 θ 2 0 w t 0 if c 0 and θ 2 0 are presumed to be uniform eq 31 reduces to 32 2 w z 2 1 c 0 2 θ 2 0 2 w t 2 b 0 c 0 2 w t 7 natural time and length scales eq 26 indicates that the speed of wave propagation associated with δφ2 is v θ 2 0 c 0 θ 2 0 when v θ 2 0 eq 26 reduces to a diffusion equation with the diffusivity being d θ 2 0 c 0 2 b 0 given eq 14 the parameter c 0 can be evaluated as 33 c 0 2 ψ 2 0 θ 2 0 g h 2 0 θ 2 0 θ 2 0 therefore the wave speed and diffusivity associated with the total water potential in unsaturated soils can be respectively represented in terms of the matric head by 34 v θ 2 0 g θ 2 0 h 2 0 θ 2 0 θ 2 0 35 d θ 2 0 k 2 θ 2 0 h 2 0 θ 2 0 θ 2 0 eq 35 is the well known definition of the soil water diffusivity jury et al 1991 eqs 27 and 32 both allow the definition of a natural length scale λ and a natural time scale τ which can be applied to make these two differential equations dimensionless inspection of eqs 27 and 32 shows that the coefficients 1 c 0 2 θ 2 0 and b 0 c 0 2 on the right side can be equated to τ 2 λ 2 and τ λ 2 respectively doing this and then solving the two resulting expressions one obtains 36 1 λ θ 2 0 c 0 b 0 1 θ 2 0 36 2 τ θ 2 0 1 b 0 θ 2 0 k 2 θ 2 0 g θ 2 0 which implies also that λ c 0 τ θ 2 0 v θ 2 0 τ the natural time scale defined in eq 36 2 is identical to the time constant deduced by sposito 1980 in his investigation of the domain of applicability of the buckingham darcy flux law using the first two terms on the right side of eq 9 let us now define the dimensionless variables z z λ and t t τ such that eq 27 takes the form 37 2 δ φ 2 z 2 2 δ φ 2 t 2 δ φ 2 t the general solution of this linear telegraph equation is 38 δ φ 2 z t exp b 0 θ 2 0 t 2 j 0 1 2 b 0 2 θ 2 0 z 2 c 0 2 θ 2 0 t 2 where j 0 is the bessel function of order zero appendix a provides a derivation of this solution by means of a symmetry analysis physically the term involving the bessel function in eq 38 represents a progressive wave however there is also a damping factor controlled by the exponential term with a damping coefficient equal to one half the inverse of the natural time scale this result explicitly indicates that water total potential propagates as a wave through unsaturated soils but attenuates due to friction caused by the flow resistance b 0 8 illustrative examples data on soil hydraulic properties are essential to examine the physical behavior of the speed v θ 2 0 natural time scale τ θ 2 0 and natural length scale λ θ 2 0 of total water potential waves in unsaturated soils to evaluate these physical parameters the relationship between the relative permeability k r2 and the water saturation s 2 and that between the matric head h 2 and the water saturation s 2 must be known the well known van genuchten 1980 mualem 1976 model was employed to calculate these relationships 39 1 1 χ h 2 n m s 2 e θ 2 θ 2 r θ 2 s θ 2 r 39 2 k r 1 s 2 e 1 s 2 e λ 1 s 2 e 1 m 2 m 39 3 k r 2 s 2 e s 2 e λ 1 1 s 2 e 1 m m 2 where λ is the pore connectivity parameter n and m are model parameters obtained by fitting experimental data m 1 1 n while θ 2 r and θ 2 s are the residual and saturated volumetric water contents respectively van genuchten 1980 we have set the water saturation s 2 equal to the effective water saturation s 2 e in eq 39 eq 39 1 implies that the derivative of h 2 with respect to θ 2 is 40 d θ 2 d h 2 χ m ϕ 1 m s 2 1 m 1 s 2 1 m m it should be noted that to model the natural time and length scales for a wide range of soils sufficient soil hydraulic data must be available along with an inverse optimization of the van genuchten mualem model parameters in the current study three unsaturated soils with differing texture coarse sand columbia fine sandy loam and clay were selected from papers by chen et al 1999 carsel and parrish 1988 as well as sacha et al 2019 to develop three illustrative examples the soil hydraulic data necessary for numerical computations using eqs 34 and 36 are listed in table 1 where the fitting parameters in the van genuchten mualem model for the relationships in eq 30 are also presented our numerical calculations were coded in matlab for the range of water saturation s 2 from 0 01 to 0 99 since these hydraulic characteristics and fitting parameters were reported experimentally from studies of field soils our results should capture the general characteristics expected for water potential waves in unsaturated soils wave speed together with the natural length and time scales experimental data to validate directly our calculations based on eqs 34 and 36 are not yet available but the reliability of our result in eqs 34 and 36 can be demonstrated from a model perspective by developing a general relationship between the natural time and length scales 41 τ λ 2 b 0 c 0 2 g k 2 θ 2 0 θ 2 0 ψ 2 0 1 k 2 θ 2 0 θ 2 0 h 2 0 eq 41 recovers a result obtained by roth 2008 see also or et al 2015 who scaled the richards equation without considering natural time and length scales fig 1 illustrates the dependence of the wave speed eq 34 on water saturation for the three soils at a given water saturation the total water potential wave propagates with increasing speed as the soil texture becomes more clayey according to eq 34 this wave is physically related to changes in matric potential thus it is a new mode essentially different from the third compressional wave p3 arising in the theory of poroelasticity e g brutsaert 1964 lo et al 2009 2010 lo and sposito 2013 with reference to clay the total water potential wave speed and water saturation have an inverse relationship but for coarse sand and columbia fine sandy loam the total water potential wave speed initially decreases with water saturation to attain a minimum then increases the trends shown in fig 1 can be physically interpreted by revisiting eq 34 indicating that the parameter c 0 the slope of the curve of matric potential with respect to water saturation as defined in eq 33 should be a dominant factor the relationship between c 0 and water saturation in these three soils is graphically illustrated in fig 2 which shows trends very similar to the wave speed in fig 1 figs 3 and 4 show the natural time eq 36 2 and length scales eq 36 1 of the total water potential wave as a function of water saturation with both parameters showing an increase as water saturation increases fig 3 indicates that irrespective of soil texture the natural time scale remains less than 0 1 ms in excellent agreement with the time constants reported in fig 1 of sposito 1980 for three soils with differing textures that are not the same as those investigated here we note that roth 2008 considered a length scale valid for a diffusion process and then based on eq 39 concluded the resulting time scale to take a greater value in the dry range than in the wet range however an inverse tendency is observed in fig 3 which is directly calculated from eq 36 2 without limitation on the value of λ fig 4 shows that the natural length scale remains below 0 1 mm table 2 summarizes the maximum natural time scale natural length scale and wave speed found for the three soils an inference from table 2 is that the total water potential wave dies out quickly within a very short distance so that the richards equation would remain accurate to model water movement in unsaturated soils over time intervals that are long compared to τ as was also concluded by sposito 1980 table 2 shows that the natural time scale lies in the range of 0 1 ms to 10 ns for three soils of differing texture we examined an important practical consequence of this result is that total water potential acceleration becomes dominant as the potential varies during an interval with the frequency spectrum of 10 khz 100 mhz due to non equilibrium flow effects the time required for the redistribution of fluids in unsaturated soils to accommodate fluid pressure perturbation would be comparable with or greater than the time necessary to validate the flow conditions on which the buckingham darcy flux law depends hassanizadeh and gray 1993 barenblatt et al 2003 aryana and kovscek 2013 wang et al 2019 sun et al 2021 therefore if the frequency of dynamic wave propagation is high enough to ensure that the next pressure increment occurs before the full decay of the previous pressure this would enhance the non equilibrium flow effect causing a much longer redistribution time to reach local phase equilibrium on the other hand whenever the water seepage gravitational acceleration is greater than the total water potential acceleration the dynamics of soil water must be described instead by eq 25 thus a major conclusion to be drawn is that in this regime buckingham darcy flow breaks down and the transient terms in eq 9 become important 9 conclusions one of the essential significances lying in the current study is contained in eq 21 under conventional assumptions that typically underpin subsurface hydrological processes eq 21 provides a complete mathematical description of the temporal and spatial evolution of the total water potential governing flow though unsaturated soils this partial differential equation features two accelerations one associated with the water seepage gravitational acceleration the square root of the product of seepage acceleration and gravitational acceleration and one related to the total water potential acceleration second order time derivative of the total water potential which leads to a unified classification scheme to determine whether inertial effects must be taken into account in order to model water movement through unsaturated soils when the two accelerations possess the same order of magnitude eq 21 becomes equivalent to the richards equation since they offset inertial effects thus the buckingham darcy flow law is a special case that develops when inertial effects are neglected as discussed below eq 9 however if the water seepage gravitational acceleration is less than the total water potential acceleration a consequence of eq 21 is eq 26 the telegraph equation describing a total water potential wave through a homogeneous porous medium the closed form analytical solution of the one dimensional telegraph equation eq 27 takes the form of a bessel function of order zero inherent in eq 26 is the existence of natural time and length scales for a temporally damped propagating total water potential wave with the traveling wave speed ranging broadly from 10 to 1012 m s we have demonstrated in both theoretical and numerical manners that this wave has the distinct propagation characteristics from the poroelastic wave table 3 if the water seepage gravitational acceleration is greater than the total water potential acceleration the movement of water through unsaturated soils must be modeled by eq 25 and in turn the richards equation is never applicable because inertial effects have become dominant especially at higher water saturation consistent with the behavior observed in the field by torres et al 1998 credit authorship contribution statement weicheng lo conceptualization methodology formal analysis writing original draft supervision garrison sposito conceptualization methodology validation writing review editing tsai hsuan lin visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments gratitude is expressed by the first author for financial support from the ministry of science and technology taiwan under contract no most 106 2221 e 006 059 my2 the second author acknowledges the privilege of having known l a richards and receiving from him a signed copy of his seminal paper published 91 years ago appendix a derivation of eq 38 using symmetry analysis one route to solving eq 37 is by analyzing its symmetry properties particularly its scale invariance through the use of lie group theory scale invariance of the richards equation as well as broad insights into scale invariance for river networks subsurface flow and transport and other hydrologic processes are discussed in a volume edited by sposito 1998 application of symmetry analysis ibragimov 1994 indicates that eq 37 is invariant under shifts of t or z by a constant scaling of δφ2 and linear combination of z and t such that z 2 t 2 is equal to a constant the corresponding symmetry operators are a1 1 x 1 t a1 2 x 2 z a1 3 x 2 δ φ 2 δ φ 2 a1 4 x 4 z t t z 1 2 z δ φ 2 δ φ 2 however among the four symmetry operators only the operator x 4 leads to a non trivial solution for δφ2 z t the corresponding invariant solution δφ2 f z t of eq 37 therefore satisfies the constraint ibragimov 1994 a2 x 4 δ φ 2 f z t 0 eq a1 4 may be applied to write eq a2 in the explicit form a3 1 2 z f z f t t f z 0 the solution of eq a3 can be determined by formulating the following characteristic equation a4 d z t d t z d δ φ 2 1 2 z δ φ 2 which has two invariants a5 1 s 1 a z 2 t 2 a5 2 s 2 δ φ 2 exp t 2 in eq a5 1 a is an arbitrary constant thus the solution for δφ2 z t can be defined by the general invariant form a6 δ φ 2 z t exp t 2 f η where η a z 2 t 2 accordingly the partial derivatives of δφ2 z t with respect to z and t can be deduced in terms of f η a7 1 2 δ φ 2 z 2 2 a f η 4 a 2 z 2 f η exp t 2 a7 2 δ φ 2 t 1 2 f η 2 a t f η exp t 2 a7 3 2 δ φ 2 t 2 1 4 f η 2 a t f η 2 a f η 4 a 2 t 2 f η exp t 2 and eq 37 is equivalent to 2 a f η 4 a 2 z 2 f η 1 4 f η 2 a t f η 2 a f η 4 a 2 t 2 f η a8 1 2 f η 2 a t f η where a prime denotes differentiation with respect to η this equation emerges directly from substitution of eq a7 into eq 37 reorganizing eq a8 we obtain an ordinary differential equation a9 4 a η f η 4 a f η 1 4 f η 0 since a is an arbitrary constant let us choose a 1 4 to make eq a9 a10 η f η f η 1 4 f η 0 this ordinary differential equation is solved by the bessel function of order zero j 0 which implies the solution for f η is abramowitz and stegun 1972 a11 f η j 0 η j 0 1 2 z 2 t 2 consequently according to eq a6 the solution for δφ2 z t can be expressed a12 1 δ φ 2 z t exp t 2 j 0 1 2 z 2 t 2 or in terms of the unscaled independent variables a12 2 δ φ 2 z t exp b 0 θ 2 0 t 2 j 0 1 2 b 0 2 θ 2 0 z 2 c 0 2 θ 2 0 t 2 
131,quantitative descriptions of the temporal and spatial variations of volumetric water content and total water potential in unsaturated soils have for more than nine decades focused on diffusive mechanisms as represented by the richards equation richards 1931 however recent laboratory studies lo et al 2017 have revealed short time transient behavior of water in non deforming unsaturated soils that is distinctly oscillatory not diffusive in this paper we establish a theoretical framework to generalize the richards equation in a systematic way to account for non diffusive mechanisms giving rise to oscillatory behavior in the water content and total water potential a partial differential equation is developed with the total water potential as the dependent variable based on the coupling of mass and linear momentum balance within the continuum theory of mixtures this new differential equation becomes equivalent to the richards equation when non diffusive mechanisms can be neglected but when this condition is not met the governing equation describes damped propagating wave behavior of the total water potential this dynamic wave differs from a poroelastic wave in respect to solid framework motions and wave speed as well as time and length scales for a rigid homogeneous unsaturated soil the governing equation reduces to the telegraph equation which can be solved analytically an inherent feature of our approach is the appearance of natural time and length scales characteristic of total water potential waves consideration of these natural scales for three representative soils of differing texture helps to prescribe more precisely the domain of applicability of the richards equation keywords dynamic water potential waves unsaturated soils natural time scale natural length scale 1 introduction the traditional mathematical description of transient variations in the matric potential and volumetric water content in rigid homogenous unsaturated soils is underpinned by an elliptic parabolic differential equation the richards equation which is derived by combining the empirical buckingham darcy flux law with the equation of continuity richards 1931 swartzendruber 1969 warrick 2003 the physics underlying this famous differential equation involves a diffusion type process as the sole mechanism driving the flow of water however for more than seven decades limitations on the general applicability of the richards equation to interpret unsaturated flow phenomena in laboratory and field experiments have been reported to emerge either at certain length and time scales or for certain flow problems e g kirkham and feng 1949 nielsen et al 1962 applying methods of non equilibrium statistical mechanics sposito 1980 derived an exact equation of linear momentum balance for water flowing in a rigid homogenous unsaturated soil showing that it led to the richards equation if the water mass density and water mass flux density constituted a complete set of coupled dynamical variables to describe water flow and if the time scale over which they varied was much longer than that over which other dynamical variables varied notably the water energy density torres et al 1998 reported from two field experiments that as soils approach saturation a sudden increase in rainfall intensity creates not only a slight variation in hydraulic head gradient but also a considerable change in hydraulic conductivity the physical basis of this phenomenon was believed to be the presence of a rapidly advancing acoustic wave on a basis of a series of laboratory experiments lo et al 2017 have recently documented that the soil matric potential may exhibit transient variations within a very short time frame due to acoustic wave excitation over a range of seismic frequencies thus leading to a rapid change of water content in unsaturated soil notably the soil solid framework was not observed to undergo deformations in contradiction to the basic premise of poroelasticity that the solid framework does deform accordingly the wave observed by lo et al 2017 should be fundamentally different from a poroelastic wave the principal objective of the present study is to establish a theoretical framework to generalize the richards equation in a systematic way to account for mechanisms underlying the short time wave behavior discussed above a new partial differential equation for water flow in rigid homogeneous unsaturated soils that is second order in both the time and space domains is derived involving coupled water mass density and water mass flux density variables using the continuum theory of mixtures lo et al 2002 2014 instead of non equilibrium statistical mechanics sposito 1980 when certain physical conditions are met to be discussed our governing partial differential equation reduces to the richards equation when these conditions are not met the governing equation becomes a telegraph equation with the total water potential as the dependent variable thus describing a damped propagating total water potential wave this partial differential equation is invariant under scaling transformations and therefore its general solution can be explored using symmetry analysis leading to the conclusion that this solution has the form of a bessel function of order zero symmetry analysis also provides a natural time scale natural length scale and associated wave speed to characterize dynamical water potential wave processes as illustrative examples numerical calculations are performed to evaluate these characteristic parameters for three soils of differing texture 2 linearized balance laws employing the continuum theory of mixtures truesdell 1984 lo et al 2002 formulated a set of macroscopic differential equations for mass and momentum balance during two phase immiscible fluid flows in a porous medium 2 1 conservation of mass 1 1 d α ρ α θ α d t ρ α θ α v α 0 α s 1 2 2 2 conservation of momentum 1 fluid phases ρ ξ θ ξ d ξ v ξ d t θ ξ p ξ λ ξ d ξ δ 2 μ ξ d ξ ρ ξ θ ξ g β 1 2 r ξ β v β s 1 2 β 1 2 a ξ β a β s α s 1 2 π ξ α t α 0 ξ 1 2 2 solid phase 1 3 ρ s θ s d s v s d t t s ρ s θ s g ξ 1 2 p ξ θ ξ ξ 1 2 β 1 2 r ξ β v β s ξ 1 2 β 1 2 a ξ β a β s ξ 1 2 α s 1 2 π ξ α t α 0 where ρ α denotes the material density of phase α the subscript α designating three immiscible phases the solid α s the nonwetting fluid α 1 fluid 1 and the wetting fluid α 2 fluid 2 θ α signifies the volumetric content of phase α ρ α θ α thus referring to its partial density v α and a α represent the velocity and acceleration of phase α respectively d ξ expresses the rate of deformation tensor or stretching tensor of fluid phase ξ ξ 1 2 d ξ indicates its volumetric strain rate equal to the trace of d α p ξ symbolizes the pore pressure of fluid phase ξ δ is the unit tensor λ ξ and μ ξ are scalar coefficients associated with macroscopic viscous properties of fluid phase ξ t α is the temperature of phase α g is the gravitational acceleration r ξ β is the isotropic tensor associated with viscous drag whereas a ξ β is that pertinent to inertial drag π ξ α is the isotropic tensor related to heat transfer v β s v β v s is characterized to as the velocity of the phase β relative to that of the solid phase and a β s a β a s is the relative acceleration vector let us consider an incompressible wetting fluid ρ 2 constant moving through a rigid v s 0 porous medium and follow conventional simplifying assumptions often adopted to analyze flow and transport in porous media gray 1983 1 the fluid phases are macroscopically inviscid λ ζ μ ζ 0 2 temperature gradients are neglected t α 0 3 mechanical coupling caused by inertial drag is neglected a ξ β 0 4 viscous drag arising from the interaction between the two interstitial fluids due to their velocity differences is negligibly small r 12 r 21 0 5 the pressure gradient required to drive the flow of the non wetting fluid is ignored p 1 v 1 0 implying that the non wetting fluid remains always at atmospheric pressure and is free to escape from or enter into the porous medium and 6 r 22 is diagonal with the same principal axes accordingly eq 1 can be reduced to 2 3 conservation of mass 2 1 θ 2 t θ 2 v 2 0 2 3 1 conservation of momentum 2 2 d v 2 d t p 2 ρ 2 g r 22 ρ 2 θ 2 v 2 where r 22 θ 2 2 η 2 k s k r 2 designates the viscous coupling parameter with η 2 denoting the dynamic shear viscosity of the wetting fluid henceforth termed water ks symbolizing the intrinsic permeability of the porous medium and k r2 indicating the relative permeability of the medium to water de marsily 1986 the consequence of the first assumption 1 is that the macroscopic velocity profile of fluid flow is uniform perpendicular to the flow direction bear 1988 the second assumption 2 is justified if we are concerned only with isothermal conditions the assumptions 3 5 are commonly made in the description of two phase fluid flow in subsurface hydrology dullien 1992 if the coordinate system is oriented along the principal axes the diagonal representation of r 22 in the last assumption 6 is valid the total water potential φ2 l 2 t 2 in an unsaturated soil is defined as 3 φ 2 p 2 ρ 2 g z ψ 2 g z where ψ 2 p 2 ρ 2 attributed to capillary and adsorptive forces acting among liquid gas and solid phases is the matric potential hubbert 1940 introducing eq 3 into eq 2 2 we find 4 d v 2 d t φ 2 b θ 2 v 2 where the parameter b is given by b θ 2 r 22 ρ 2 θ 2 2 η 2 k s k r 2 ρ 2 g k 2 θ 2 t 1 k 2 θ 2 expressing the hydraulic conductivity of water at a given volumetric water content which is inversely related to b θ 2 because we are dealing with a porous medium permeated by two viscous immiscible fluids experiencing small disturbances due to water potential perturbations we consider small deviations from the equilibrium distribution of the total water potential φ 2 z this linearization scheme has been widely applied for modeling fluid flows and solid framework deformations in unsaturated soils e g brutsaert 1964 tuncay and corapcioglu 1997 lewise and schrefler 1998 wang 2000 verruijt 2014 mathias and butler 2018 therefore the value of a physical property induced in the current disturbed configuration can be regarded as the value in the reference undisturbed configuration taken as the unperturbed state before changes in total water potential denoted by a superscript 0 plus a small difference between the current and reference values denoted by capital delta δ e g θ 2 θ 2 0 δ θ 2 and φ 2 φ 2 0 δ φ 2 where θ 2 0 z and φ 2 0 z are functions only of the vertical coordinate z in this small deviation regime it remains accurate to neglect products of small quantities i e solely first order terms are retained lighthill 1978 biot 1962 lo et al 2005 accordingly eqs 2 1 and 4 can be linearized 2 3 2 conservation of mass 5 1 δ θ 2 t θ 2 0 v 2 v 2 θ 2 0 0 2 3 3 conservation of momentum 5 2 v 2 t δ φ 2 b 0 θ 2 0 v 2 sposito 1980 derived a formal solution of eq 5 2 after rewriting it as 6 v 2 t 1 τ θ 2 0 v 2 τ θ 2 0 δ φ 2 where τ θ 2 0 1 b 0 θ 2 0 k 2 θ 2 0 g θ 2 0 is a constant having the units of time t the formal solution of eq 6 is then 7 v 2 exp t τ exp t τ δ φ 2 d t v 2 0 the partial integration 8 exp t τ δ φ 2 d t τ exp t τ δ φ 2 τ exp t τ δ φ 2 t d t allows eq 7 to be rewritten in a more physically transparent form 9 v 2 τ δ φ 2 v 2 0 exp t τ τ exp t τ exp t τ δ φ 2 t d t eq 9 reveals that the water velocity in eq 5 2 is the sum of three components the first being equivalent to the buckingham darcy flux law the second involving the initial condition and the third depending on the time derivative of the gradient of the total water potential sposito 1980 considered the case in which δ φ 2 is imposed instantaneously and then remains constant so that the third term on the right side of eq 9 vanishes and the water velocity is described accurately by the buckingham darcy flux law for times much larger than τ however if instead one considers time intervals comparable to τ and a non constant total water potential the neglected term in eq 9 must be taken into account thus eq 9 constitutes a generalization of the results of sposito 1980 to take into account the physical effects of a time varying gradient of the total water potential for example lo et al 2017 demonstrated experimentally that the matric potential may double within 6 ms i e frequency 150 hz under acoustic wave excitation at higher water saturations if a constant drainage flow rate is maintained such a change may induce a significant variation in water content 3 water storativity eq 5 contains both δφ2 and δθ 2 as dependent variables therefore to explore general solutions it is useful to derive a closure relation that links δφ2 to δθ 2 following lo et al 2005 an effective water storativity factor m is defined as the inverse slope of the water retention curve 10 m s 2 p 2 1 ϕ θ 2 p 2 where s 2 θ 2 ϕ refers to the relative water saturation and ϕ represents the porosity eq 10 is a general expression to extend the concept of specific storage in saturated soils to unsaturated soils bear 1988 an analogous parameter the differential water capacity is defined as the derivative of θ 2 with respect to the matric head θ 2 h 2 g θ 2 ψ 2 where h 2 ψ 2 g is the matric head the water capacity is introduced to develop an h 2 based formulation of the richards equation i e the matric head h 2 as the dependent variable jury et al 1991 by virtue of eq 3 eq 10 can be recast as 11 φ 2 g z t 1 ϕ ρ 2 m θ 2 t the linearized form of eq 11 is 12 δ φ 2 t 1 ϕ ρ 2 m 0 δ θ 2 t which gives rise to a relationship connecting δφ2 to δθ 2 in eq 12 m 0 is the undisturbed effective water storativity given by 13 m 0 s 2 0 p 2 0 1 ϕ ρ 2 θ 2 0 ψ 2 0 eq 13 can be written in a more physically transparent form 14 ψ 2 0 θ 2 0 c 0 2 where c 0 1 ϕ ρ 2 m 0 has the units of speed lt 1 in the equilibrium state the total water potential is independent of position φ 2 0 0 this implies by eq 3 the well known equilibrium relationship 15 d ψ 2 0 d z g since the matric potential in unsaturated soils is a function of volumetric water content at constant temperature and applied pressure one can rearrange eq 15 after using the chain rule for derivatives 16 ψ 2 0 θ 2 0 θ 2 0 z g which is known as the buckingham equation sposito 1986 in view of eq 14 eq 16 takes the alternative form 17 d θ 2 0 d z g d θ 2 0 d ψ 2 0 g c 0 2 eq 17 confirms that θ 2 0 is a function of z alone i e θ 2 0 z 4 equation of motion replacing the first and third terms in eq 5 1 using eqs 12 and 17 respectively we obtain 18 1 c 0 2 δ φ 2 t θ 2 0 v 2 w g c 0 2 0 where w v 2 z is the component of v 2 in the vertical z direction henceforth termed water seepage velocity eq 18 can be reorganized as 19 v 2 1 c 0 2 θ 2 0 w g δ φ 2 t taking the time derivatives of both sides of eq 19 one finds 20 v 2 t 1 c 0 2 θ 2 0 2 δ φ 2 t 2 g w t we next apply the divergence to both sides of eq 5 2 and incorporate eqs 5 1 12 and 20 into the result 21 2 δ φ 2 1 c 0 2 θ 2 0 2 δ φ 2 t 2 g w t b 0 c 0 2 δ φ 2 t θ 2 0 v 2 b 0 where c 0 b 0 and θ 2 0 are non uniform coefficients eq 21 is a comprehensive partial differential equation describing dynamical variations in the total water potential in unsaturated soils as specialized to purely diffusive phenomena i e ignoring second order time derivatives the second and third terms eq 21 becomes equivalent to the richards equation 1 c 0 2 δ φ 2 t 1 b 0 2 δ φ 2 θ 2 0 v 2 b 0 1 b 0 b 0 θ 2 0 v 2 θ 2 0 v 2 b 0 22 θ 2 0 v 2 1 b 0 δ φ 2 to achieve eq 22 the non inertial form of eq 5 2 has been employed by setting its left side equal to 0 thus eq 21 generalizes the richards equation to account for inertial effects 5 water seepage gravitational and total water potential accelerations to examine quantitatively the extent to which and how inertial effects have an impact on water movement through unsaturated soils we define a dimensionless parameter e to characterize the magnitude of the third term relative to the second term in eq 21 i e e g w t 2 δ φ 2 t 2 two different accelerations are involved in defining the parameter e the numerator represents water seepage gravitational acceleration the square root of the product of gravitational and water seepage acceleration whereas the denominator is the acceleration of total water potential as a consequence eq 21 can be expressed 23 2 δ φ 2 1 e 2 c 0 2 θ 2 0 2 δ φ 2 t 2 b 0 c 0 2 δ φ 2 t θ 2 0 v 2 b 0 when e 2 1 eq 23 becomes 24 2 δ φ 2 1 c 0 2 θ 2 0 2 δ φ 2 t 2 b 0 c 0 2 δ φ 2 t θ 2 0 v 2 b 0 by contrast whene 2 1 eq 23 becomes 25 1 c 0 2 δ φ 2 t 1 b 0 δ φ 2 1 b 0 c 0 2 θ 2 0 g w t which yields a form of the richards equation the sum of the first and second terms in eq 21 to incorporate the water seepage gravitational acceleration when e 2 1 eq 23 reproduces the richards equation 6 telegraph equation the analytical solution of eq 23 for general boundary and initial conditions is not available but analytical results are possible for particular assumptions boundary conditions and initial conditions these solutions are useful and reliable because they are exact and can not only be used to verify new computational models but also to provide physical insight into time and length scales for a porous medium that is homogeneous in the reference configuration all physical quantities evaluated are uniform e g b 0 0 this causes the last term in eq 24 to vanish in which case it becomes 26 2 δ φ 2 1 c 0 2 θ 2 0 2 δ φ 2 t 2 b 0 c 0 2 δ φ 2 t eq 26 is a well known partial differential equation the telegraph equation it provides an analytical framework for modeling dynamical changes in total water potential in unsaturated soils whenever its acceleration dominates the seepage gravitational acceleration eq 26 indicates that spatial and temporal variations in total water potential are governed by a propagating wave with dissipation caused by viscosity as an aside we note that it is commonly assumed one dimensional vertical flow to dominant for most situations of practical interest in subsurface hydrology such as infiltration even though in reality the flow is three dimensional if eq 26 is restricted to the z direction one can write 27 2 δ φ 2 z 2 1 c 0 2 θ 2 0 2 δ φ 2 t 2 b 0 c 0 2 δ φ 2 t accordingly it can be shown that besides δφ2 the vertical component of v 2 the water seepage velocity w also satisfies the telegraph equation if c 0 and θ 2 0 are uniform this can be seen by revisiting the linearized mass balance equation eq 5 1 under the one dimensional z condition with the assistance of eq 12 28 1 c 0 2 δ φ 2 t θ 2 0 w z in the same spirit the momentum balance law eq 5 2 in a linearized form for a one dimensional z representation is 29 δ φ 2 z w t b 0 θ 2 0 w 0 taking time derivatives of both sides of eq 29 one obtains 30 2 δ φ 2 z t 2 w t 2 b 0 θ 2 0 w t 0 combination of eqs 28 and 30 to remove the term δ φ 2 t gives rise to the expression 31 z c 0 2 θ 2 0 w z 2 w t 2 b 0 θ 2 0 w t 0 if c 0 and θ 2 0 are presumed to be uniform eq 31 reduces to 32 2 w z 2 1 c 0 2 θ 2 0 2 w t 2 b 0 c 0 2 w t 7 natural time and length scales eq 26 indicates that the speed of wave propagation associated with δφ2 is v θ 2 0 c 0 θ 2 0 when v θ 2 0 eq 26 reduces to a diffusion equation with the diffusivity being d θ 2 0 c 0 2 b 0 given eq 14 the parameter c 0 can be evaluated as 33 c 0 2 ψ 2 0 θ 2 0 g h 2 0 θ 2 0 θ 2 0 therefore the wave speed and diffusivity associated with the total water potential in unsaturated soils can be respectively represented in terms of the matric head by 34 v θ 2 0 g θ 2 0 h 2 0 θ 2 0 θ 2 0 35 d θ 2 0 k 2 θ 2 0 h 2 0 θ 2 0 θ 2 0 eq 35 is the well known definition of the soil water diffusivity jury et al 1991 eqs 27 and 32 both allow the definition of a natural length scale λ and a natural time scale τ which can be applied to make these two differential equations dimensionless inspection of eqs 27 and 32 shows that the coefficients 1 c 0 2 θ 2 0 and b 0 c 0 2 on the right side can be equated to τ 2 λ 2 and τ λ 2 respectively doing this and then solving the two resulting expressions one obtains 36 1 λ θ 2 0 c 0 b 0 1 θ 2 0 36 2 τ θ 2 0 1 b 0 θ 2 0 k 2 θ 2 0 g θ 2 0 which implies also that λ c 0 τ θ 2 0 v θ 2 0 τ the natural time scale defined in eq 36 2 is identical to the time constant deduced by sposito 1980 in his investigation of the domain of applicability of the buckingham darcy flux law using the first two terms on the right side of eq 9 let us now define the dimensionless variables z z λ and t t τ such that eq 27 takes the form 37 2 δ φ 2 z 2 2 δ φ 2 t 2 δ φ 2 t the general solution of this linear telegraph equation is 38 δ φ 2 z t exp b 0 θ 2 0 t 2 j 0 1 2 b 0 2 θ 2 0 z 2 c 0 2 θ 2 0 t 2 where j 0 is the bessel function of order zero appendix a provides a derivation of this solution by means of a symmetry analysis physically the term involving the bessel function in eq 38 represents a progressive wave however there is also a damping factor controlled by the exponential term with a damping coefficient equal to one half the inverse of the natural time scale this result explicitly indicates that water total potential propagates as a wave through unsaturated soils but attenuates due to friction caused by the flow resistance b 0 8 illustrative examples data on soil hydraulic properties are essential to examine the physical behavior of the speed v θ 2 0 natural time scale τ θ 2 0 and natural length scale λ θ 2 0 of total water potential waves in unsaturated soils to evaluate these physical parameters the relationship between the relative permeability k r2 and the water saturation s 2 and that between the matric head h 2 and the water saturation s 2 must be known the well known van genuchten 1980 mualem 1976 model was employed to calculate these relationships 39 1 1 χ h 2 n m s 2 e θ 2 θ 2 r θ 2 s θ 2 r 39 2 k r 1 s 2 e 1 s 2 e λ 1 s 2 e 1 m 2 m 39 3 k r 2 s 2 e s 2 e λ 1 1 s 2 e 1 m m 2 where λ is the pore connectivity parameter n and m are model parameters obtained by fitting experimental data m 1 1 n while θ 2 r and θ 2 s are the residual and saturated volumetric water contents respectively van genuchten 1980 we have set the water saturation s 2 equal to the effective water saturation s 2 e in eq 39 eq 39 1 implies that the derivative of h 2 with respect to θ 2 is 40 d θ 2 d h 2 χ m ϕ 1 m s 2 1 m 1 s 2 1 m m it should be noted that to model the natural time and length scales for a wide range of soils sufficient soil hydraulic data must be available along with an inverse optimization of the van genuchten mualem model parameters in the current study three unsaturated soils with differing texture coarse sand columbia fine sandy loam and clay were selected from papers by chen et al 1999 carsel and parrish 1988 as well as sacha et al 2019 to develop three illustrative examples the soil hydraulic data necessary for numerical computations using eqs 34 and 36 are listed in table 1 where the fitting parameters in the van genuchten mualem model for the relationships in eq 30 are also presented our numerical calculations were coded in matlab for the range of water saturation s 2 from 0 01 to 0 99 since these hydraulic characteristics and fitting parameters were reported experimentally from studies of field soils our results should capture the general characteristics expected for water potential waves in unsaturated soils wave speed together with the natural length and time scales experimental data to validate directly our calculations based on eqs 34 and 36 are not yet available but the reliability of our result in eqs 34 and 36 can be demonstrated from a model perspective by developing a general relationship between the natural time and length scales 41 τ λ 2 b 0 c 0 2 g k 2 θ 2 0 θ 2 0 ψ 2 0 1 k 2 θ 2 0 θ 2 0 h 2 0 eq 41 recovers a result obtained by roth 2008 see also or et al 2015 who scaled the richards equation without considering natural time and length scales fig 1 illustrates the dependence of the wave speed eq 34 on water saturation for the three soils at a given water saturation the total water potential wave propagates with increasing speed as the soil texture becomes more clayey according to eq 34 this wave is physically related to changes in matric potential thus it is a new mode essentially different from the third compressional wave p3 arising in the theory of poroelasticity e g brutsaert 1964 lo et al 2009 2010 lo and sposito 2013 with reference to clay the total water potential wave speed and water saturation have an inverse relationship but for coarse sand and columbia fine sandy loam the total water potential wave speed initially decreases with water saturation to attain a minimum then increases the trends shown in fig 1 can be physically interpreted by revisiting eq 34 indicating that the parameter c 0 the slope of the curve of matric potential with respect to water saturation as defined in eq 33 should be a dominant factor the relationship between c 0 and water saturation in these three soils is graphically illustrated in fig 2 which shows trends very similar to the wave speed in fig 1 figs 3 and 4 show the natural time eq 36 2 and length scales eq 36 1 of the total water potential wave as a function of water saturation with both parameters showing an increase as water saturation increases fig 3 indicates that irrespective of soil texture the natural time scale remains less than 0 1 ms in excellent agreement with the time constants reported in fig 1 of sposito 1980 for three soils with differing textures that are not the same as those investigated here we note that roth 2008 considered a length scale valid for a diffusion process and then based on eq 39 concluded the resulting time scale to take a greater value in the dry range than in the wet range however an inverse tendency is observed in fig 3 which is directly calculated from eq 36 2 without limitation on the value of λ fig 4 shows that the natural length scale remains below 0 1 mm table 2 summarizes the maximum natural time scale natural length scale and wave speed found for the three soils an inference from table 2 is that the total water potential wave dies out quickly within a very short distance so that the richards equation would remain accurate to model water movement in unsaturated soils over time intervals that are long compared to τ as was also concluded by sposito 1980 table 2 shows that the natural time scale lies in the range of 0 1 ms to 10 ns for three soils of differing texture we examined an important practical consequence of this result is that total water potential acceleration becomes dominant as the potential varies during an interval with the frequency spectrum of 10 khz 100 mhz due to non equilibrium flow effects the time required for the redistribution of fluids in unsaturated soils to accommodate fluid pressure perturbation would be comparable with or greater than the time necessary to validate the flow conditions on which the buckingham darcy flux law depends hassanizadeh and gray 1993 barenblatt et al 2003 aryana and kovscek 2013 wang et al 2019 sun et al 2021 therefore if the frequency of dynamic wave propagation is high enough to ensure that the next pressure increment occurs before the full decay of the previous pressure this would enhance the non equilibrium flow effect causing a much longer redistribution time to reach local phase equilibrium on the other hand whenever the water seepage gravitational acceleration is greater than the total water potential acceleration the dynamics of soil water must be described instead by eq 25 thus a major conclusion to be drawn is that in this regime buckingham darcy flow breaks down and the transient terms in eq 9 become important 9 conclusions one of the essential significances lying in the current study is contained in eq 21 under conventional assumptions that typically underpin subsurface hydrological processes eq 21 provides a complete mathematical description of the temporal and spatial evolution of the total water potential governing flow though unsaturated soils this partial differential equation features two accelerations one associated with the water seepage gravitational acceleration the square root of the product of seepage acceleration and gravitational acceleration and one related to the total water potential acceleration second order time derivative of the total water potential which leads to a unified classification scheme to determine whether inertial effects must be taken into account in order to model water movement through unsaturated soils when the two accelerations possess the same order of magnitude eq 21 becomes equivalent to the richards equation since they offset inertial effects thus the buckingham darcy flow law is a special case that develops when inertial effects are neglected as discussed below eq 9 however if the water seepage gravitational acceleration is less than the total water potential acceleration a consequence of eq 21 is eq 26 the telegraph equation describing a total water potential wave through a homogeneous porous medium the closed form analytical solution of the one dimensional telegraph equation eq 27 takes the form of a bessel function of order zero inherent in eq 26 is the existence of natural time and length scales for a temporally damped propagating total water potential wave with the traveling wave speed ranging broadly from 10 to 1012 m s we have demonstrated in both theoretical and numerical manners that this wave has the distinct propagation characteristics from the poroelastic wave table 3 if the water seepage gravitational acceleration is greater than the total water potential acceleration the movement of water through unsaturated soils must be modeled by eq 25 and in turn the richards equation is never applicable because inertial effects have become dominant especially at higher water saturation consistent with the behavior observed in the field by torres et al 1998 credit authorship contribution statement weicheng lo conceptualization methodology formal analysis writing original draft supervision garrison sposito conceptualization methodology validation writing review editing tsai hsuan lin visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments gratitude is expressed by the first author for financial support from the ministry of science and technology taiwan under contract no most 106 2221 e 006 059 my2 the second author acknowledges the privilege of having known l a richards and receiving from him a signed copy of his seminal paper published 91 years ago appendix a derivation of eq 38 using symmetry analysis one route to solving eq 37 is by analyzing its symmetry properties particularly its scale invariance through the use of lie group theory scale invariance of the richards equation as well as broad insights into scale invariance for river networks subsurface flow and transport and other hydrologic processes are discussed in a volume edited by sposito 1998 application of symmetry analysis ibragimov 1994 indicates that eq 37 is invariant under shifts of t or z by a constant scaling of δφ2 and linear combination of z and t such that z 2 t 2 is equal to a constant the corresponding symmetry operators are a1 1 x 1 t a1 2 x 2 z a1 3 x 2 δ φ 2 δ φ 2 a1 4 x 4 z t t z 1 2 z δ φ 2 δ φ 2 however among the four symmetry operators only the operator x 4 leads to a non trivial solution for δφ2 z t the corresponding invariant solution δφ2 f z t of eq 37 therefore satisfies the constraint ibragimov 1994 a2 x 4 δ φ 2 f z t 0 eq a1 4 may be applied to write eq a2 in the explicit form a3 1 2 z f z f t t f z 0 the solution of eq a3 can be determined by formulating the following characteristic equation a4 d z t d t z d δ φ 2 1 2 z δ φ 2 which has two invariants a5 1 s 1 a z 2 t 2 a5 2 s 2 δ φ 2 exp t 2 in eq a5 1 a is an arbitrary constant thus the solution for δφ2 z t can be defined by the general invariant form a6 δ φ 2 z t exp t 2 f η where η a z 2 t 2 accordingly the partial derivatives of δφ2 z t with respect to z and t can be deduced in terms of f η a7 1 2 δ φ 2 z 2 2 a f η 4 a 2 z 2 f η exp t 2 a7 2 δ φ 2 t 1 2 f η 2 a t f η exp t 2 a7 3 2 δ φ 2 t 2 1 4 f η 2 a t f η 2 a f η 4 a 2 t 2 f η exp t 2 and eq 37 is equivalent to 2 a f η 4 a 2 z 2 f η 1 4 f η 2 a t f η 2 a f η 4 a 2 t 2 f η a8 1 2 f η 2 a t f η where a prime denotes differentiation with respect to η this equation emerges directly from substitution of eq a7 into eq 37 reorganizing eq a8 we obtain an ordinary differential equation a9 4 a η f η 4 a f η 1 4 f η 0 since a is an arbitrary constant let us choose a 1 4 to make eq a9 a10 η f η f η 1 4 f η 0 this ordinary differential equation is solved by the bessel function of order zero j 0 which implies the solution for f η is abramowitz and stegun 1972 a11 f η j 0 η j 0 1 2 z 2 t 2 consequently according to eq a6 the solution for δφ2 z t can be expressed a12 1 δ φ 2 z t exp t 2 j 0 1 2 z 2 t 2 or in terms of the unscaled independent variables a12 2 δ φ 2 z t exp b 0 θ 2 0 t 2 j 0 1 2 b 0 2 θ 2 0 z 2 c 0 2 θ 2 0 t 2 
132,the time step of an explicit time integration scheme for solving time dependent hyperbolic partial differential equations in a finite volume method fvm framework is restricted by the courant friedrichs lewy cfl criterion conventional time stepping integrates all grid cells with the same time step this causes unnecessary computational costs when wave speeds and or grid spacing vary considerably throughout the domain and a few critical cells dictate the global time step although most cells could be advanced with a much larger time step adaptive time stepping overcomes this issue by allowing different local time step sizes for each grid cell the adaptive conservative time integration acti scheme is a recently developed adaptive time stepping method which relies on local time steps that are equal to the largest time step divided by powers of two this work extends the acti scheme to tracer transport in fractured porous media when fluid velocity within highly permeable fractures is higher than in the rock matrix and local grid refinement is applied around fractures the cfl restriction would require prohibitively small time steps in the vicinity of fractures for two dimensional discrete fracture and matrix models of fracture patterns we demonstrate that acti reduces the computational cost by orders of magnitude compared to global time stepping while retaining solution accuracy empirically we show that acti is stable in combination with a first order explicit flux discretization scheme since combination with a standard higher order muscl scheme can lead to spurious oscillations in the solution we propose a modified muscl scheme relying on advection of an inclined reconstruction muscl air keywords adaptive time stepping sub time steps cfl fractured porous media scalar transport higher order flux scheme 1 introduction understanding flow and transport in porous media is crucial for accurate performance prediction and risk assessment in many subsurface applications such as groundwater contamination flury et al 1994 bear and cheng 2010 geothermal pruess 2002 kumagai et al 2004 and hydrocarbon reservoirs parker 1989 nuclear waste disposal tsang et al 2015 or geological carbon sequestration bui et al 2018 fractures are naturally present in many brittle reservoir rocks or they can be artificially induced e g during reservoir stimulation of an enhanced geothermal system they can form highly conductive flow paths which control flow and consequently also transport therefore accurate simulation of flow and transport in and around the fractures is important berre et al 2018 when solving time dependent hyperbolic partial differential equations pdes with a finite volume method fvm time is traditionally advanced with a global time step i e in spatially uniform time intervals the time integration technique is either explicit if the unknown variables of the current time step only depend on quantities already calculated previously or implicit if the unknown variables also depend on quantities still to be calculated at the current time step for both schemes the size of the integration time step is bounded the courant friedrichs lewy cfl criterion restricts the integration time step for explicit schemes in order to guarantee stability courant et al 1928 implicit schemes generally allow larger integration time steps there even exist unconditionally stable implicit schemes for pdes with s shaped flux functions jenny et al 2009 however the integration time step is limited by the desired accuracy when grid cell size or wave speed e g advection speed of a tracer vary significantly throughout the domain the optimal time step of each grid cell can vary over several orders of magnitudes as a result a small number of grid cells dictate the global time step while many grid cells are advanced in time with an integration step much smaller than necessary one example of such a system is flow through fractured porous media where the permeability and subsequently also the flow velocity can be several orders of magnitude higher in the fractures than in the rock matrix matthäi and belayneh 2004 geiger et al 2004 transport of tracers contaminates and other dissolved chemicals in water saturated fractured porous media is often anomalous edery et al 2016 good spatial resolution in the vicinity of highly conductive fractures is required to accurately capture flow and transport in these areas and calculate detailed breakthrough curves with global time stepping it is extremely costly to solve transport in such systems especially when considering a reasonable domain size therefore more efficient time integration schemes are needed various local time stepping methods have been developed to improve the efficiency of time integration and to reduce the computational cost for such systems and applications those methods allow individual time steps for each grid cell under the constraint of a local cfl criterion osher and sanders 1983 presented one of the first local time stepping methods their method relies on a conservative predictor corrector scheme and they proved convergence for one dimensional non linear scalar conservation laws dawson and kirby 2001 extended the method to a higher order time stepping scheme berger and oliger 1984 introduced a conservative interface equation to pass information between coarse and refined grids that are overlain in regions where a more accurate solution is required their method automatically takes smaller time steps in those refined regions and integrates the grids independently allowing higher order time integration zhang et al 1994 applies local time stepping only to the flux calculation dawson 1995 introduced a local time stepping method that enforces flux continuity across the cell interfaces pervaiz and baron 1989 kleb et al 1992 and jenny 2020 use local time steps which relate to each other by factors of powers of two however the time variable that determines the sequence in which the cells are integrated is different kleb et al 1992 integrate the cells with the lowest current time first while pervaiz and baron 1989 advance cells according to their current time plus half of their local time step jenny 2020 updates those cells first whose next time i e their current time plus one local time step is lowest with the additional constraint that cells with a larger time step are never ahead of ones with a smaller time step similar to dawson 1995 this method accumulates the flux through the interface between two cells with different local time steps when it is calculated for the cell with the smaller time step the accumulated flux is used later for updating the cell with the larger time step therefore this method is conservative by design kulka and jenny 2022 extended the method to unsteady compressible flow related approaches include discrete event simulation des which is a totally asynchronous time stepping method nutaro et al 2003 shao et al 2019 and multirate methods which integrate each component of the system using a different time step constantinescu and sandu 2007 delpopolo carciopolo et al 2019 2020 this work extends the method of jenny 2020 to tracer transport in fractured porous media and applies it to two dimensional models where we compare accuracy and computational cost of acti with those of global time stepping furthermore we empirically investigate the stability of several flux discretization schemes when they are combined with acti this paper is organized as follows section 2 introduces our solver for hyperbolic scalar transport equations including different schemes for numerical flux discretization and discusses the adaptive time stepping method in section 3 we present the results of the two dimensional test cases we demonstrate a considerable reduction of computational cost when using acti as compared to global time stepping 2 method in this section we first describe our transport solver and then introduce the adaptive conservative time integration acti scheme 2 1 transport we consider the hyperbolic scalar transport equation for porous media 1 ϕ c t q c q source c source 0 where c denotes the concentration of the scalar tracer q the volumetric flux density also called darcy velocity and ϕ the porosity here the advection speed is approximated as the pore velocity a q ϕ note that eq 1 is not in its conservative form and we neglect diffusion we discretize eq 1 with a cell centred fvm using a cartesian grid and obtain concentration values at the time t n 1 t n δ t for a two dimensional case with 2 c i j n 1 c i j n δ t ϕ i j f i 1 2 j n n 1 f i 1 2 j n n 1 h x i j f i j 1 2 n n 1 f i j 1 2 n n 1 h y i j q source c source where the subscripts i and j denote the cell indices in the first and second direction respectively and the superscript n the time index h x and h y are the size of the grid cell in x and y direction respectively the fluxes f n n 1 can be discretized with a wide variety of numerical schemes in this work we explore four different explicit schemes one of which is of first spatial order and the other three of higher order in the following we focus on the flux through the right interface of cell ω i j that is 3 f i 1 2 j n n 1 q i 1 2 j c i 1 2 j n n 1 all other fluxes are obtained analogously the concentration at the right interface is approximated as 4 c i 1 2 j n n 1 c i j n β 1 σ 1 i j h x i j 2 β 2 σ 1 i j q i 1 2 j ϕ i 1 2 j δ t 2 β 3 σ 2 i j q 2 i j ϕ i j δ t 2 if q i 1 2 j 0 c i 1 j n β 1 σ 1 i 1 j h x i 1 j 2 β 2 σ 1 i 1 j q i 1 2 j ϕ i 1 2 j δ t 2 β 3 σ 2 i 1 j q 2 i 1 j ϕ i 1 j δ t 2 otherwise where the parameters β 1 β 2 and β 3 determine the flux scheme for β 1 β 2 β 3 0 eq 4 reduces to the first order explicit upwind scheme β 1 1 gives a higher order scheme where β 2 β 3 0 corresponds to a muscl upwind scheme without slope advection β 2 1 and β 3 0 to a muscl with slope advection leveque 2002 and β 2 β 3 1 to a muscl scheme with advection of inclined reconstruction muscl air jenny 2020 in section 3 1 we show the superiority of muscl air over the other two muscl schemes therefore we use muscl air along with the 1st order scheme for the most part of this work in eq 4 σ 1 and σ 2 are the slope components normal and parallel to the interface respectively for the former we use the koren limiter koren 1993 which is defined as 5 σ 1 σ 1 s 1 s 2 s 2 max min min s 2 2 s 1 3 s 2 2 2 s 1 s 2 0 where for q i 1 2 j 0 6 s 1 i j 2 c i 1 j c i j h x i 1 j h x i j and s 2 i j 2 c i j c i 1 j h x i j h x i 1 j the slope component parallel to the interface for q i 1 2 j 0 is calculated as 7 σ 2 i j 2 c i j c i j 1 h y i j h y i j 1 if q 2 i j 1 2 q i j 1 2 q i j 1 2 0 2 c i j 1 c i j h y i j 1 h y i j otherwise all other slopes are obtained analogously for explicit schemes the size of the integration time step δ t is limited by the cfl criterion courant et al 1928 in this work we use the formula for donor cell upwind 8 a 1 δ t h 1 a 2 δ t h 2 c f l max proposed by leveque 2002 2 2 adaptive conservative time integration acti the adaptive conservative time integration acti algorithm proposed by jenny 2020 uses local time steps of size 9 δ t i δ t max 2 l i equal to the maximum desired time step size divided by powers of two grid cells are synchronized after each maximum step the integer variable l i 0 denotes the time refinement level of a particular grid cell where a high level corresponds to a small local time step for every grid cell i we choose the lowest possible level l i that still satisfies the local cfl criterion i e 10 δ t i δ t max 2 l i δ t i c f l c f l max a 1 i h 1 i a 2 i h 2 i 1 δ t max 2 l i 1 the sequence in which the grid cells are advanced in time is such that the time difference between cells is minimal and a cell with a larger local time step is never ahead of a cell with a smaller time step when a cell i is advanced further in time than its neighbour j which implies δ t i δ t j the corresponding flux between them is stored and recalled later when the neighbouring cell catches up that is 11 δ t j f i j t t δ t j δ t i m 1 δ t j δ t i f j i t m 1 δ t i t m δ t i therefore strict conservation at the global time resolution is guaranteed when we calculate the flux with a muscl scheme we need to account for the potential time difference between cells where the characteristic line originates from the adjacent cell we therefore replace δ t 2 in the second line of eq 4 with δ t i j 2 t i j t i 1 j as this does not deal with potential time differences between cells that are used for the calculation of the slope components σ 1 and σ 2 fig 1 the slopes might be estimated imprecisely near the interface between different levels this might lead to a loss of accuracy in the higher order schemes this issue does not occur with the 1st order scheme since there only the concentration value from the upwind cell determines the concentration at the cell interface it will be shown that related inaccuracies are only local and do not affect overall simulation results in this work we only consider 2d test cases since dimensional splitting is used in the discretization of eq 1 it is straightforward to extend the framework to 3d cartesian grids in essence an additional term for the third dimension would appear in the cfl criterion eq 8 and a second slope component parallel to the interface is required in muscl air a pseudo code representation of the acti algorithm is presented in appendix a the acti scheme as presented in algorithm 1 does not make any assumptions on the dimensionality of the problem 2 3 test cases in this study we only consider single phase flow in a horizontal layer of a fractured porous medium where we can neglect the influence of gravity we obtain the steady state volumetric flux density q from the variation of pressure p with darcy s law as 12 q k μ p where k and μ are the permeability tensor of the porous medium and the dynamic fluid viscosity we assume that the fluid and the porous material are incompressible i e q q source which results in the elliptic pressure equation 13 k μ p q source 0 here q source 0 corresponds to fluid injection and q source 0 to fluid extraction we discretize eq 13 with the fvm and use a direct solver we then inject a tracer which follows the flow perfectly and does not alter the pressure field we compare the concentration fields obtained with acti to the ones obtained from global time stepping we study three test cases one without any fractures one with a synthetic fracture network and one with a single fracture and local grid refinement table 1 all fractures are straight grid aligned and embedded in a porous matrix with constant and isotropic permeability k m and porosity ϕ m for the latter two cases we assume that the hydraulic aperture a f is constant over the length of a fracture and we calculate fracture permeability from plane poiseuille flow between parallel plates in all test cases we use volume flow boundary conditions at the inlet and pressure boundary conditions at the outlets initially the concentration field is zero everywhere at t 0 we start injecting a tracer with concentration c 1 through the inlet table 2 lists the parameter values used in all simulations of this study 3 results 3 1 test case 1 uniform matrix without any fractures first we study the stability of the four flux schemes presented in section 2 1 for a relatively small test case with uniform permeability and porosity in this test case the fluid enters the domain through the left boundary with q left 1 10 5 m s and leaves the domain at the top right corner through a sink of size 0 1 0 1 m 2 fig 2 tracer is injected at three boundary segments of length 0 1 m on the left boundary and tracked over time the transport is calculated for three different cfl values c f l max 0 3 0 5 0 9 for the 1st order scheme the concentration fields calculated with acti agree very well with the ones obtained by global time stepping see fig 3 concentration fields are shown only for c f l max 0 9 as the results are very similar for all c f l max values as expected the concentration front gets much sharper with the muscl schemes than with the 1st order scheme fig 4 for global time stepping all three muscl schemes produce very similar results independent of the choice of c f l max for acti on the other hand spurious oscillations arise in the concentration fields if muscl without slope advection is employed those oscillations are less pronounced if muscl with slope advection is used and they generally grow with increasing c f l max yet muscl air with acti produces stable results that are practically identical to the ones obtained with global time stepping for all three c f l max values as expected global time stepping is stable for all four flux schemes because local cfl is tiny in a large portion of the domain fig 5a only the cells near the point sink have a local cfl number close to c f l max therefore global time stepping provides a certain margin for error in the time discretization scheme with acti on the other hand all cells have a local cfl number higher than half of c f l max fig 5b hence acti is less forgiving than global time stepping and we need to pay special attention to the discretization scheme with this test case we demonstrate that the 1st order scheme is suitable for combination with acti of the three higher order flux reconstruction schemes only muscl air performs well in combination with acti muscl without and with slope advection on the other hand become unstable when combined with acti and c f l max close to one we presume that the instabilities seen for muscl without slope advection arise because it estimates the concentration values at the cell interfaces inaccurately for a piecewise linear reconstruction the exact solution of the interface value averaged over a time step is equal to the interface value at half of the time step see reconstruct evolve average rea algorithm in e g leveque 2002 however muscl without slope advection uses the value at the beginning of the time step muscl with slope advection estimates the concentration values at the cell interfaces correctly but it does not account for diagonal flow consequently the scheme is stable in regions where the flow is approximately parallel to the grid lines but unstable in regions where the flow is not aligned it is possible to stabilize these schemes at a lower c f l max or by using a more diffusive limiter see appendix b for an example with the minmod limiter some of the instabilities shown in fig 4 coincide with contour lines of the levels however level jumps are unlikely to be a dominant factor causing these instabilities because they remain at the same location when the contour lines are shifted by increasing or decreasing c f l max in the remaining part of this analysis we use only the 1st order scheme and muscl air and set c f l max 0 5 this value is chosen empirically because a rigorous stability analysis for adaptive time stepping in two dimensional models with variable porosity and or grid spacing is beyond the scope of this work 3 2 test case 2 fracture network our second test case is a synthetic two dimensional fracture network fig 6a consisting of 9 horizontal and 13 vertical fractures with a hydraulic aperture of 1mm this fracture network which was also used in a previous publication liem and jenny 2020 is chosen purely for demonstration purposes and represents a simplified model of large scale fractures we discretized the domain with a equidistant cartesian grid where the grid spacing in horizontal and vertical directions is 500 times larger than the hydraulic aperture of the fractures fig 6b the effect of the fractures is accounted for by upscaling for grid cells which intersect with fractures we calculate upscaled permeability values using the analytical equations derived by kasap and lake 1990 and upscaled porosity values by volume averaging fig 6c e the process of this upscaling is described in detail in liem and jenny 2020 table 3 lists the resulting upscaled values alongside other parameter values applied to the fracture model in this test case we use a point source at the lower left corner and sinks at all other corners the source and sinks have a size of 2 5 2 5 m 2 and consist of 25 grid cells each the resulting flow field is visualized in fig 7a as the logarithm of the magnitude of the normalized steady state volumetric flux density log 10 q q m a x along with streamlines in the following we use the term velocity instead of the volumetric flux density as expected the highest velocities occur within the fractures and near the source and sinks we observe several stagnation points in the matrix which lie either next to fractures or at the domain boundary fig 7b shows the corresponding histogram most cells have a velocity which is around three orders of magnitude smaller than the maximum velocity and only a few cells experience a high velocity we expect that acti gives considerable speed benefits in a setup with such a velocity distribution acti partitions the grid cells into 13 levels 0 l i 12 fig 8a which means that the smallest time step is δ t max 2 12 3 52 min if we use global time integration the global time step obtained from the cfl criterion is 4 04min note that this value is slightly larger than the minimum local time step in the case with acti since there the local time steps are restricted to the maximal time step divided by powers of two with acti most grid cells have a local cfl number between 0 25 and 0 5 fig 8b grid cells with a local cfl number below 0 25 are coloured in red and could be integrated with double the maximal time step or even more however we would not gain much because there are only a few of those cells the local cfl number for global time stepping is tiny for most of the domain fig 8c the resulting concentration fields calculated with acti and with global time stepping agree very well fig 9 most importantly the concentration front is exact at the same location for the 1st order scheme we even obtain slightly sharper concentration fronts with acti than with global time stepping since higher local cfl numbers are beneficial for explicit schemes note that they are limited to 0 5 in this test case with muscl air there are a few locations where the concentration field differs all of them lie in regions where the fluid flow crosses a fracture muscl air shows more pronounced numerical errors in these specific areas if the local cfl number is large however these differences are only local and do not grow over time for both flux schemes acti and global time stepping produce almost identical arrival curves at the three sinks fig 10 shows the arrival curve at the sink in the bottom right corner the largest differences occur for the 1st order scheme and are due to the sharper concentration front with acti if we use acti instead of global time stepping for this test case 59 times fewer flux calculations and 75 times fewer cell updates are needed those values are directly related to the time refinement levels 8 a the computational time is reduced likewise by a factor of 61 for the 1st order scheme and 59 for muscl air fig 11 here we ran 600 separate simulations each of which calculated tracer transport for a time period of δ t max once with acti and once with global time stepping to obtain mean and standard deviation of the ratio of computational time the computational time scales roughly with the number of flux calculations since this is the most expensive part of the simulation 3 3 test case 3 single fracture with local grid refinement our third test case consists of a single horizontal fracture fig 12a in this case we discretize the domain with a cartesian grid with gradual refinement perpendicular to the fracture such that the fracture contains 50 grid cells across fig 12b the height of the smallest grid cells is 1250 times smaller than the one of the largest ones in this test case inflow occurs through the left and outflow through the right boundary table 4 lists the parameter values of this test case fig 13a shows the resulting flow field here the highest velocities occur within the fracture and close to its tips the lowest velocities are obtained at the stagnation points in the matrix just next to the midpoint of the fracture the corresponding histogram fig 13b reveals that most cells have a velocity which is around three orders of magnitude smaller than the maximum velocity this narrow peak in the histogram is due to the far field again we expect that acti performs well for such a broad velocity spectrum since the highest velocities coincide with regions where the grid is refined we expect a huge performance increase with acti for this setup acti divides the grid cells into 15 levels fig 14a and the smallest local time step is δ t max 2 14 0 0366 s as expected cells with a high level i e small local time step are located in the high permeable fracture where the grid resolution is maximal for global time integration the time step obtained from the cfl criterion is 0 0391 s with acti the local cfl number is between 0 25 and 0 5 in all cells fig 14b whereas it is tiny in most of the domain for global time stepping fig 14c the concentration fields calculated with acti and with global time stepping are very similar fig 15 like in the previous test case the concentration front is exactly at the same location for the 1st order scheme the concentration front is again slightly sharper with acti than for global time stepping this is also visible in the arrival curves fig 16 in addition this test case nicely illustrates that the concentration front is much sharper with muscl air as compared to the 1st order scheme the computation time with acti is around 80 times less than with global time stepping fig 17 the numbers of flux calculations and cell updates are reduced by a similar factor this speed up allows us to obtain the concentration fields shown in fig 15 after only 1 5 h instead of 5 days as in the case with global time stepping 4 discussion and conclusions in this study we have extended the adaptive conservative time integration acti scheme to transport of a scalar tracer concentration in a fractured porous media and showed empirically that it produces accurate results at a much lower computational cost in our test cases we obtained impressive speed up factors up to around 80 as compared to global time stepping these speed up factors stem from a comparable reduction of the number of flux calculations and cell updates although we only used two idealized continuum models of fractured permeable rock in this study one with a simplified synthetic fracture network and one with a single fracture and local grid refinement we expect that our findings are applicable to more realistic cases since the fractures are represented as heterogeneities in the matrix either by upscaling or resolving them the framework can be applied to any porous media where such permeability and porosity fields are available essentially acti performs particularly well if only a few cells require a very small time step while most cells can be integrated with a much larger time step such huge differences in the local time step requirement can arise from channelling along nested preferential flow paths as well as from variable grid refinement the acti scheme is easy to implement and can be used with any explicit transport scheme it works very well in combination with the first order upwind scheme that is still widely used in many applications if we combine acti with a higher order flux scheme in order to get sharper concentration fronts we need to pay special attention to the stability of this scheme a flux scheme that is stable for global time stepping is not necessarily stable in combination with acti due to the higher local cfl numbers in this study we empirically showed that the muscl scheme with advection of inclined reconstruction muscl air fulfils this requirement future work is required to analytically investigate the stability of higher order schemes in combination with acti in practice the lower computational cost of acti compared to conventional global time stepping means that for given computational resources acti allows for more accurate solutions as can be achieved by using a higher order flux scheme and or a finer spatial grid resolution this is essential when sharp concentration fronts are present and numerical dispersion must be kept to a minimum one example indicated by a very high péclet number is advection dominated transport at the reservoir scale another example is non diffusive non reactive tracer transport in a viscous fluid as characterized by a high schmidt number almost no mixing would occur within a fracture if the flow was laminar and creeping as famously demonstrated by the taylor couette flow reversibility this effect can only be captured if the grid is sufficiently refined within the fracture test case 3 demonstrates such a situation where we obtain a sharp concentration front at the exit of the fracture by using 50 grid cells across the fracture aperture and a higher order flux scheme however the precipitation of minerals by fluid mixing within fractures is one of the reasons why one finds high grade ore mineralization within them e g phillips 1990 in test case 2 we represent the fractures with a single pixel row which corresponds to the case of perfect mixing across the fracture aperture consequently the concentration front at the exit of fractures is less sharp with adaptive time stepping methods such as acti explicit time integration schemes become more attractive as an alternative to the widely used usually first order implicit schemes therefore future work should contrast and compare accuracy and computational costs of explicit schemes using acti with implicit schemes and related implementation dependencies of the two methods thus far we only considered 2d test cases with cartesian grids however it is straightforward to extend the acti scheme to 3d and unstructured grids where acti might have even greater benefits especially when using spatially adaptive grid refinement acti is therefore a promising tool to efficiently calculate transport in various sub surface applications such as geothermal or hydrocarbon reservoirs carbon dioxide sequestration wastewater injection and groundwater flow here we considered idealized test cases targeting tracer transport in fractured porous media but acti should also be applicable to multi phase flow or sequentially coupled flow and transport problems credit authorship contribution statement michael liem conceptualization methodology software formal analysis writing original draft stephan matthai conceptualization methodology writing review editing supervision patrick jenny conceptualization methodology writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements michael liem and patrick jenny acknowledge the financial support by the swiss national science foundation through grant number snf200021 178922 1 the funding sources are not involved in the study design the preparation of the article and decisions related to its publication the authors thank giulia conti and ranit monga eth zurich for constructive discussions the authors also thank the three anonymous reviewers for their valuable comments and suggestions appendix a acti algorithm algorithm 1 delineates the acti scheme as presented in jenny 2020 in this work we consider transport only in steady state velocity fields hence we need to calculate the local time steps only once at the beginning appendix b influence of slope limiter muscl without slope advection and muscl with slope advection show spurious oscillations in the tracer concentration when combined with acti however stability of these flux schemes can be attained by choosing a more diffusive limiter fig b 1 shows concentration fields obtained with the minmod limiter compared to the fields obtained with the koren limiter and the same c f l max values fig 4 the spurious oscillations are substantially reduced albeit at the cost of slightly more diffusive concentration fronts 
132,the time step of an explicit time integration scheme for solving time dependent hyperbolic partial differential equations in a finite volume method fvm framework is restricted by the courant friedrichs lewy cfl criterion conventional time stepping integrates all grid cells with the same time step this causes unnecessary computational costs when wave speeds and or grid spacing vary considerably throughout the domain and a few critical cells dictate the global time step although most cells could be advanced with a much larger time step adaptive time stepping overcomes this issue by allowing different local time step sizes for each grid cell the adaptive conservative time integration acti scheme is a recently developed adaptive time stepping method which relies on local time steps that are equal to the largest time step divided by powers of two this work extends the acti scheme to tracer transport in fractured porous media when fluid velocity within highly permeable fractures is higher than in the rock matrix and local grid refinement is applied around fractures the cfl restriction would require prohibitively small time steps in the vicinity of fractures for two dimensional discrete fracture and matrix models of fracture patterns we demonstrate that acti reduces the computational cost by orders of magnitude compared to global time stepping while retaining solution accuracy empirically we show that acti is stable in combination with a first order explicit flux discretization scheme since combination with a standard higher order muscl scheme can lead to spurious oscillations in the solution we propose a modified muscl scheme relying on advection of an inclined reconstruction muscl air keywords adaptive time stepping sub time steps cfl fractured porous media scalar transport higher order flux scheme 1 introduction understanding flow and transport in porous media is crucial for accurate performance prediction and risk assessment in many subsurface applications such as groundwater contamination flury et al 1994 bear and cheng 2010 geothermal pruess 2002 kumagai et al 2004 and hydrocarbon reservoirs parker 1989 nuclear waste disposal tsang et al 2015 or geological carbon sequestration bui et al 2018 fractures are naturally present in many brittle reservoir rocks or they can be artificially induced e g during reservoir stimulation of an enhanced geothermal system they can form highly conductive flow paths which control flow and consequently also transport therefore accurate simulation of flow and transport in and around the fractures is important berre et al 2018 when solving time dependent hyperbolic partial differential equations pdes with a finite volume method fvm time is traditionally advanced with a global time step i e in spatially uniform time intervals the time integration technique is either explicit if the unknown variables of the current time step only depend on quantities already calculated previously or implicit if the unknown variables also depend on quantities still to be calculated at the current time step for both schemes the size of the integration time step is bounded the courant friedrichs lewy cfl criterion restricts the integration time step for explicit schemes in order to guarantee stability courant et al 1928 implicit schemes generally allow larger integration time steps there even exist unconditionally stable implicit schemes for pdes with s shaped flux functions jenny et al 2009 however the integration time step is limited by the desired accuracy when grid cell size or wave speed e g advection speed of a tracer vary significantly throughout the domain the optimal time step of each grid cell can vary over several orders of magnitudes as a result a small number of grid cells dictate the global time step while many grid cells are advanced in time with an integration step much smaller than necessary one example of such a system is flow through fractured porous media where the permeability and subsequently also the flow velocity can be several orders of magnitude higher in the fractures than in the rock matrix matthäi and belayneh 2004 geiger et al 2004 transport of tracers contaminates and other dissolved chemicals in water saturated fractured porous media is often anomalous edery et al 2016 good spatial resolution in the vicinity of highly conductive fractures is required to accurately capture flow and transport in these areas and calculate detailed breakthrough curves with global time stepping it is extremely costly to solve transport in such systems especially when considering a reasonable domain size therefore more efficient time integration schemes are needed various local time stepping methods have been developed to improve the efficiency of time integration and to reduce the computational cost for such systems and applications those methods allow individual time steps for each grid cell under the constraint of a local cfl criterion osher and sanders 1983 presented one of the first local time stepping methods their method relies on a conservative predictor corrector scheme and they proved convergence for one dimensional non linear scalar conservation laws dawson and kirby 2001 extended the method to a higher order time stepping scheme berger and oliger 1984 introduced a conservative interface equation to pass information between coarse and refined grids that are overlain in regions where a more accurate solution is required their method automatically takes smaller time steps in those refined regions and integrates the grids independently allowing higher order time integration zhang et al 1994 applies local time stepping only to the flux calculation dawson 1995 introduced a local time stepping method that enforces flux continuity across the cell interfaces pervaiz and baron 1989 kleb et al 1992 and jenny 2020 use local time steps which relate to each other by factors of powers of two however the time variable that determines the sequence in which the cells are integrated is different kleb et al 1992 integrate the cells with the lowest current time first while pervaiz and baron 1989 advance cells according to their current time plus half of their local time step jenny 2020 updates those cells first whose next time i e their current time plus one local time step is lowest with the additional constraint that cells with a larger time step are never ahead of ones with a smaller time step similar to dawson 1995 this method accumulates the flux through the interface between two cells with different local time steps when it is calculated for the cell with the smaller time step the accumulated flux is used later for updating the cell with the larger time step therefore this method is conservative by design kulka and jenny 2022 extended the method to unsteady compressible flow related approaches include discrete event simulation des which is a totally asynchronous time stepping method nutaro et al 2003 shao et al 2019 and multirate methods which integrate each component of the system using a different time step constantinescu and sandu 2007 delpopolo carciopolo et al 2019 2020 this work extends the method of jenny 2020 to tracer transport in fractured porous media and applies it to two dimensional models where we compare accuracy and computational cost of acti with those of global time stepping furthermore we empirically investigate the stability of several flux discretization schemes when they are combined with acti this paper is organized as follows section 2 introduces our solver for hyperbolic scalar transport equations including different schemes for numerical flux discretization and discusses the adaptive time stepping method in section 3 we present the results of the two dimensional test cases we demonstrate a considerable reduction of computational cost when using acti as compared to global time stepping 2 method in this section we first describe our transport solver and then introduce the adaptive conservative time integration acti scheme 2 1 transport we consider the hyperbolic scalar transport equation for porous media 1 ϕ c t q c q source c source 0 where c denotes the concentration of the scalar tracer q the volumetric flux density also called darcy velocity and ϕ the porosity here the advection speed is approximated as the pore velocity a q ϕ note that eq 1 is not in its conservative form and we neglect diffusion we discretize eq 1 with a cell centred fvm using a cartesian grid and obtain concentration values at the time t n 1 t n δ t for a two dimensional case with 2 c i j n 1 c i j n δ t ϕ i j f i 1 2 j n n 1 f i 1 2 j n n 1 h x i j f i j 1 2 n n 1 f i j 1 2 n n 1 h y i j q source c source where the subscripts i and j denote the cell indices in the first and second direction respectively and the superscript n the time index h x and h y are the size of the grid cell in x and y direction respectively the fluxes f n n 1 can be discretized with a wide variety of numerical schemes in this work we explore four different explicit schemes one of which is of first spatial order and the other three of higher order in the following we focus on the flux through the right interface of cell ω i j that is 3 f i 1 2 j n n 1 q i 1 2 j c i 1 2 j n n 1 all other fluxes are obtained analogously the concentration at the right interface is approximated as 4 c i 1 2 j n n 1 c i j n β 1 σ 1 i j h x i j 2 β 2 σ 1 i j q i 1 2 j ϕ i 1 2 j δ t 2 β 3 σ 2 i j q 2 i j ϕ i j δ t 2 if q i 1 2 j 0 c i 1 j n β 1 σ 1 i 1 j h x i 1 j 2 β 2 σ 1 i 1 j q i 1 2 j ϕ i 1 2 j δ t 2 β 3 σ 2 i 1 j q 2 i 1 j ϕ i 1 j δ t 2 otherwise where the parameters β 1 β 2 and β 3 determine the flux scheme for β 1 β 2 β 3 0 eq 4 reduces to the first order explicit upwind scheme β 1 1 gives a higher order scheme where β 2 β 3 0 corresponds to a muscl upwind scheme without slope advection β 2 1 and β 3 0 to a muscl with slope advection leveque 2002 and β 2 β 3 1 to a muscl scheme with advection of inclined reconstruction muscl air jenny 2020 in section 3 1 we show the superiority of muscl air over the other two muscl schemes therefore we use muscl air along with the 1st order scheme for the most part of this work in eq 4 σ 1 and σ 2 are the slope components normal and parallel to the interface respectively for the former we use the koren limiter koren 1993 which is defined as 5 σ 1 σ 1 s 1 s 2 s 2 max min min s 2 2 s 1 3 s 2 2 2 s 1 s 2 0 where for q i 1 2 j 0 6 s 1 i j 2 c i 1 j c i j h x i 1 j h x i j and s 2 i j 2 c i j c i 1 j h x i j h x i 1 j the slope component parallel to the interface for q i 1 2 j 0 is calculated as 7 σ 2 i j 2 c i j c i j 1 h y i j h y i j 1 if q 2 i j 1 2 q i j 1 2 q i j 1 2 0 2 c i j 1 c i j h y i j 1 h y i j otherwise all other slopes are obtained analogously for explicit schemes the size of the integration time step δ t is limited by the cfl criterion courant et al 1928 in this work we use the formula for donor cell upwind 8 a 1 δ t h 1 a 2 δ t h 2 c f l max proposed by leveque 2002 2 2 adaptive conservative time integration acti the adaptive conservative time integration acti algorithm proposed by jenny 2020 uses local time steps of size 9 δ t i δ t max 2 l i equal to the maximum desired time step size divided by powers of two grid cells are synchronized after each maximum step the integer variable l i 0 denotes the time refinement level of a particular grid cell where a high level corresponds to a small local time step for every grid cell i we choose the lowest possible level l i that still satisfies the local cfl criterion i e 10 δ t i δ t max 2 l i δ t i c f l c f l max a 1 i h 1 i a 2 i h 2 i 1 δ t max 2 l i 1 the sequence in which the grid cells are advanced in time is such that the time difference between cells is minimal and a cell with a larger local time step is never ahead of a cell with a smaller time step when a cell i is advanced further in time than its neighbour j which implies δ t i δ t j the corresponding flux between them is stored and recalled later when the neighbouring cell catches up that is 11 δ t j f i j t t δ t j δ t i m 1 δ t j δ t i f j i t m 1 δ t i t m δ t i therefore strict conservation at the global time resolution is guaranteed when we calculate the flux with a muscl scheme we need to account for the potential time difference between cells where the characteristic line originates from the adjacent cell we therefore replace δ t 2 in the second line of eq 4 with δ t i j 2 t i j t i 1 j as this does not deal with potential time differences between cells that are used for the calculation of the slope components σ 1 and σ 2 fig 1 the slopes might be estimated imprecisely near the interface between different levels this might lead to a loss of accuracy in the higher order schemes this issue does not occur with the 1st order scheme since there only the concentration value from the upwind cell determines the concentration at the cell interface it will be shown that related inaccuracies are only local and do not affect overall simulation results in this work we only consider 2d test cases since dimensional splitting is used in the discretization of eq 1 it is straightforward to extend the framework to 3d cartesian grids in essence an additional term for the third dimension would appear in the cfl criterion eq 8 and a second slope component parallel to the interface is required in muscl air a pseudo code representation of the acti algorithm is presented in appendix a the acti scheme as presented in algorithm 1 does not make any assumptions on the dimensionality of the problem 2 3 test cases in this study we only consider single phase flow in a horizontal layer of a fractured porous medium where we can neglect the influence of gravity we obtain the steady state volumetric flux density q from the variation of pressure p with darcy s law as 12 q k μ p where k and μ are the permeability tensor of the porous medium and the dynamic fluid viscosity we assume that the fluid and the porous material are incompressible i e q q source which results in the elliptic pressure equation 13 k μ p q source 0 here q source 0 corresponds to fluid injection and q source 0 to fluid extraction we discretize eq 13 with the fvm and use a direct solver we then inject a tracer which follows the flow perfectly and does not alter the pressure field we compare the concentration fields obtained with acti to the ones obtained from global time stepping we study three test cases one without any fractures one with a synthetic fracture network and one with a single fracture and local grid refinement table 1 all fractures are straight grid aligned and embedded in a porous matrix with constant and isotropic permeability k m and porosity ϕ m for the latter two cases we assume that the hydraulic aperture a f is constant over the length of a fracture and we calculate fracture permeability from plane poiseuille flow between parallel plates in all test cases we use volume flow boundary conditions at the inlet and pressure boundary conditions at the outlets initially the concentration field is zero everywhere at t 0 we start injecting a tracer with concentration c 1 through the inlet table 2 lists the parameter values used in all simulations of this study 3 results 3 1 test case 1 uniform matrix without any fractures first we study the stability of the four flux schemes presented in section 2 1 for a relatively small test case with uniform permeability and porosity in this test case the fluid enters the domain through the left boundary with q left 1 10 5 m s and leaves the domain at the top right corner through a sink of size 0 1 0 1 m 2 fig 2 tracer is injected at three boundary segments of length 0 1 m on the left boundary and tracked over time the transport is calculated for three different cfl values c f l max 0 3 0 5 0 9 for the 1st order scheme the concentration fields calculated with acti agree very well with the ones obtained by global time stepping see fig 3 concentration fields are shown only for c f l max 0 9 as the results are very similar for all c f l max values as expected the concentration front gets much sharper with the muscl schemes than with the 1st order scheme fig 4 for global time stepping all three muscl schemes produce very similar results independent of the choice of c f l max for acti on the other hand spurious oscillations arise in the concentration fields if muscl without slope advection is employed those oscillations are less pronounced if muscl with slope advection is used and they generally grow with increasing c f l max yet muscl air with acti produces stable results that are practically identical to the ones obtained with global time stepping for all three c f l max values as expected global time stepping is stable for all four flux schemes because local cfl is tiny in a large portion of the domain fig 5a only the cells near the point sink have a local cfl number close to c f l max therefore global time stepping provides a certain margin for error in the time discretization scheme with acti on the other hand all cells have a local cfl number higher than half of c f l max fig 5b hence acti is less forgiving than global time stepping and we need to pay special attention to the discretization scheme with this test case we demonstrate that the 1st order scheme is suitable for combination with acti of the three higher order flux reconstruction schemes only muscl air performs well in combination with acti muscl without and with slope advection on the other hand become unstable when combined with acti and c f l max close to one we presume that the instabilities seen for muscl without slope advection arise because it estimates the concentration values at the cell interfaces inaccurately for a piecewise linear reconstruction the exact solution of the interface value averaged over a time step is equal to the interface value at half of the time step see reconstruct evolve average rea algorithm in e g leveque 2002 however muscl without slope advection uses the value at the beginning of the time step muscl with slope advection estimates the concentration values at the cell interfaces correctly but it does not account for diagonal flow consequently the scheme is stable in regions where the flow is approximately parallel to the grid lines but unstable in regions where the flow is not aligned it is possible to stabilize these schemes at a lower c f l max or by using a more diffusive limiter see appendix b for an example with the minmod limiter some of the instabilities shown in fig 4 coincide with contour lines of the levels however level jumps are unlikely to be a dominant factor causing these instabilities because they remain at the same location when the contour lines are shifted by increasing or decreasing c f l max in the remaining part of this analysis we use only the 1st order scheme and muscl air and set c f l max 0 5 this value is chosen empirically because a rigorous stability analysis for adaptive time stepping in two dimensional models with variable porosity and or grid spacing is beyond the scope of this work 3 2 test case 2 fracture network our second test case is a synthetic two dimensional fracture network fig 6a consisting of 9 horizontal and 13 vertical fractures with a hydraulic aperture of 1mm this fracture network which was also used in a previous publication liem and jenny 2020 is chosen purely for demonstration purposes and represents a simplified model of large scale fractures we discretized the domain with a equidistant cartesian grid where the grid spacing in horizontal and vertical directions is 500 times larger than the hydraulic aperture of the fractures fig 6b the effect of the fractures is accounted for by upscaling for grid cells which intersect with fractures we calculate upscaled permeability values using the analytical equations derived by kasap and lake 1990 and upscaled porosity values by volume averaging fig 6c e the process of this upscaling is described in detail in liem and jenny 2020 table 3 lists the resulting upscaled values alongside other parameter values applied to the fracture model in this test case we use a point source at the lower left corner and sinks at all other corners the source and sinks have a size of 2 5 2 5 m 2 and consist of 25 grid cells each the resulting flow field is visualized in fig 7a as the logarithm of the magnitude of the normalized steady state volumetric flux density log 10 q q m a x along with streamlines in the following we use the term velocity instead of the volumetric flux density as expected the highest velocities occur within the fractures and near the source and sinks we observe several stagnation points in the matrix which lie either next to fractures or at the domain boundary fig 7b shows the corresponding histogram most cells have a velocity which is around three orders of magnitude smaller than the maximum velocity and only a few cells experience a high velocity we expect that acti gives considerable speed benefits in a setup with such a velocity distribution acti partitions the grid cells into 13 levels 0 l i 12 fig 8a which means that the smallest time step is δ t max 2 12 3 52 min if we use global time integration the global time step obtained from the cfl criterion is 4 04min note that this value is slightly larger than the minimum local time step in the case with acti since there the local time steps are restricted to the maximal time step divided by powers of two with acti most grid cells have a local cfl number between 0 25 and 0 5 fig 8b grid cells with a local cfl number below 0 25 are coloured in red and could be integrated with double the maximal time step or even more however we would not gain much because there are only a few of those cells the local cfl number for global time stepping is tiny for most of the domain fig 8c the resulting concentration fields calculated with acti and with global time stepping agree very well fig 9 most importantly the concentration front is exact at the same location for the 1st order scheme we even obtain slightly sharper concentration fronts with acti than with global time stepping since higher local cfl numbers are beneficial for explicit schemes note that they are limited to 0 5 in this test case with muscl air there are a few locations where the concentration field differs all of them lie in regions where the fluid flow crosses a fracture muscl air shows more pronounced numerical errors in these specific areas if the local cfl number is large however these differences are only local and do not grow over time for both flux schemes acti and global time stepping produce almost identical arrival curves at the three sinks fig 10 shows the arrival curve at the sink in the bottom right corner the largest differences occur for the 1st order scheme and are due to the sharper concentration front with acti if we use acti instead of global time stepping for this test case 59 times fewer flux calculations and 75 times fewer cell updates are needed those values are directly related to the time refinement levels 8 a the computational time is reduced likewise by a factor of 61 for the 1st order scheme and 59 for muscl air fig 11 here we ran 600 separate simulations each of which calculated tracer transport for a time period of δ t max once with acti and once with global time stepping to obtain mean and standard deviation of the ratio of computational time the computational time scales roughly with the number of flux calculations since this is the most expensive part of the simulation 3 3 test case 3 single fracture with local grid refinement our third test case consists of a single horizontal fracture fig 12a in this case we discretize the domain with a cartesian grid with gradual refinement perpendicular to the fracture such that the fracture contains 50 grid cells across fig 12b the height of the smallest grid cells is 1250 times smaller than the one of the largest ones in this test case inflow occurs through the left and outflow through the right boundary table 4 lists the parameter values of this test case fig 13a shows the resulting flow field here the highest velocities occur within the fracture and close to its tips the lowest velocities are obtained at the stagnation points in the matrix just next to the midpoint of the fracture the corresponding histogram fig 13b reveals that most cells have a velocity which is around three orders of magnitude smaller than the maximum velocity this narrow peak in the histogram is due to the far field again we expect that acti performs well for such a broad velocity spectrum since the highest velocities coincide with regions where the grid is refined we expect a huge performance increase with acti for this setup acti divides the grid cells into 15 levels fig 14a and the smallest local time step is δ t max 2 14 0 0366 s as expected cells with a high level i e small local time step are located in the high permeable fracture where the grid resolution is maximal for global time integration the time step obtained from the cfl criterion is 0 0391 s with acti the local cfl number is between 0 25 and 0 5 in all cells fig 14b whereas it is tiny in most of the domain for global time stepping fig 14c the concentration fields calculated with acti and with global time stepping are very similar fig 15 like in the previous test case the concentration front is exactly at the same location for the 1st order scheme the concentration front is again slightly sharper with acti than for global time stepping this is also visible in the arrival curves fig 16 in addition this test case nicely illustrates that the concentration front is much sharper with muscl air as compared to the 1st order scheme the computation time with acti is around 80 times less than with global time stepping fig 17 the numbers of flux calculations and cell updates are reduced by a similar factor this speed up allows us to obtain the concentration fields shown in fig 15 after only 1 5 h instead of 5 days as in the case with global time stepping 4 discussion and conclusions in this study we have extended the adaptive conservative time integration acti scheme to transport of a scalar tracer concentration in a fractured porous media and showed empirically that it produces accurate results at a much lower computational cost in our test cases we obtained impressive speed up factors up to around 80 as compared to global time stepping these speed up factors stem from a comparable reduction of the number of flux calculations and cell updates although we only used two idealized continuum models of fractured permeable rock in this study one with a simplified synthetic fracture network and one with a single fracture and local grid refinement we expect that our findings are applicable to more realistic cases since the fractures are represented as heterogeneities in the matrix either by upscaling or resolving them the framework can be applied to any porous media where such permeability and porosity fields are available essentially acti performs particularly well if only a few cells require a very small time step while most cells can be integrated with a much larger time step such huge differences in the local time step requirement can arise from channelling along nested preferential flow paths as well as from variable grid refinement the acti scheme is easy to implement and can be used with any explicit transport scheme it works very well in combination with the first order upwind scheme that is still widely used in many applications if we combine acti with a higher order flux scheme in order to get sharper concentration fronts we need to pay special attention to the stability of this scheme a flux scheme that is stable for global time stepping is not necessarily stable in combination with acti due to the higher local cfl numbers in this study we empirically showed that the muscl scheme with advection of inclined reconstruction muscl air fulfils this requirement future work is required to analytically investigate the stability of higher order schemes in combination with acti in practice the lower computational cost of acti compared to conventional global time stepping means that for given computational resources acti allows for more accurate solutions as can be achieved by using a higher order flux scheme and or a finer spatial grid resolution this is essential when sharp concentration fronts are present and numerical dispersion must be kept to a minimum one example indicated by a very high péclet number is advection dominated transport at the reservoir scale another example is non diffusive non reactive tracer transport in a viscous fluid as characterized by a high schmidt number almost no mixing would occur within a fracture if the flow was laminar and creeping as famously demonstrated by the taylor couette flow reversibility this effect can only be captured if the grid is sufficiently refined within the fracture test case 3 demonstrates such a situation where we obtain a sharp concentration front at the exit of the fracture by using 50 grid cells across the fracture aperture and a higher order flux scheme however the precipitation of minerals by fluid mixing within fractures is one of the reasons why one finds high grade ore mineralization within them e g phillips 1990 in test case 2 we represent the fractures with a single pixel row which corresponds to the case of perfect mixing across the fracture aperture consequently the concentration front at the exit of fractures is less sharp with adaptive time stepping methods such as acti explicit time integration schemes become more attractive as an alternative to the widely used usually first order implicit schemes therefore future work should contrast and compare accuracy and computational costs of explicit schemes using acti with implicit schemes and related implementation dependencies of the two methods thus far we only considered 2d test cases with cartesian grids however it is straightforward to extend the acti scheme to 3d and unstructured grids where acti might have even greater benefits especially when using spatially adaptive grid refinement acti is therefore a promising tool to efficiently calculate transport in various sub surface applications such as geothermal or hydrocarbon reservoirs carbon dioxide sequestration wastewater injection and groundwater flow here we considered idealized test cases targeting tracer transport in fractured porous media but acti should also be applicable to multi phase flow or sequentially coupled flow and transport problems credit authorship contribution statement michael liem conceptualization methodology software formal analysis writing original draft stephan matthai conceptualization methodology writing review editing supervision patrick jenny conceptualization methodology writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements michael liem and patrick jenny acknowledge the financial support by the swiss national science foundation through grant number snf200021 178922 1 the funding sources are not involved in the study design the preparation of the article and decisions related to its publication the authors thank giulia conti and ranit monga eth zurich for constructive discussions the authors also thank the three anonymous reviewers for their valuable comments and suggestions appendix a acti algorithm algorithm 1 delineates the acti scheme as presented in jenny 2020 in this work we consider transport only in steady state velocity fields hence we need to calculate the local time steps only once at the beginning appendix b influence of slope limiter muscl without slope advection and muscl with slope advection show spurious oscillations in the tracer concentration when combined with acti however stability of these flux schemes can be attained by choosing a more diffusive limiter fig b 1 shows concentration fields obtained with the minmod limiter compared to the fields obtained with the koren limiter and the same c f l max values fig 4 the spurious oscillations are substantially reduced albeit at the cost of slightly more diffusive concentration fronts 
133,a semi analytical solution of richards equation for two layered one dimensional soil t aryeni v ginting department of mathematics statistics university of wyoming laramie wy 82071 usa department of mathematics statistics university of wyoming laramie wy 82071 usa department of mathematics statistics university of wyoming laramie wy 82071 usa corresponding author a semi analytical solution of the richards equation posed on a two layered one dimensional soil supplied with various boundary conditions is derived under a constraint that the constitutive relations are exponentially dependent on the pressure head it allows for a transformation of the richards equation into a linear parabolic partial differential equation that governs a spatial temporal function that represents the hydraulic conductivity the procedure is proceeded with expressing this function as a linear combination of a set of eigenfunctions associated with a novel sturm liouville problem that reflects the layer system and an auxiliary function that depends only on the spatial variable and the pressure head at the interface at the time of interest all the relevant coefficients in the representation satisfy a nonlinear differential algebraic system gathered from imposing the continuity of the pressure head and its flux at the interface two different approximations of the derivatives yield algebraic systems to be solved by the newton method of iteration several pertinent numerical experiments demonstrating the approach are discussed and compared with the standard finite volume method keywords richards equation interface problem semi analytical eigenfunction 1 introduction a realistic capability to accurately predict the dynamics of moisture content in the vadose zone must often include the spatial heterogeneity of the soil often modeled by a multi layered system to the best of the authors knowledge there are only two manuscripts that rigorously discussed analytical solutions of the so called mixed form of richards equation in a multi layered soil see srivastava and jim yeh 1991 and luca and cepeda 2016 both of these references assume exponential constitutive relations as described by gardner 1958 that allows for a transformation of the original problem into a linear initial boundary value problem that governs the dynamics of spatial value of the hydraulic conductivity after this operation srivastava and jim yeh 1991 utilize the laplace transform and its inverse using residue theorem to obtain an analytical solution of the hydraulic conductivity as a function of depth and time in luca and cepeda 2016 the solution of the transformed problem is expressed as an eigenfunction expansion plus a steady state solution a fictitious length is to be calculated to take into effect the change at the interface of the layers other than the above references solutions of richards equation in layered soils have mainly relied on various numerical approximations where virtually there is no more restriction on the type of constitutive relations to model the layers behaviors standard finite difference finite volume and finite element techniques have been extensively employed for solving richards equation see for example haverkamp et al 1977 eymard et al 1999 cumming et al 2011 and brunone et al 2003 one main drawback in many of these numerical methods is the absence of a natural way to impose continuity of the flux at the interface due to its discontinuity the hydraulic conductivity at the interface is represented as a certain average of its neighboring layers see for example romano et al 1998 and liu et al 2017 suo et al 2019 in berardi et al 2018 a filippov framework is used to treat the discontinuity in the model see also al maktoumi et al 2015 lee et al 2020 mohammadzadeh habili and heidarpour 2015 for methods that employ the green ampt approach other than the above standard techniques marinelli and durnford 1998 applies a finite difference to the time derivative in richards equation resulting in an ode that is to be solved by a runge kutta solver in combination with a shooting method to impose the boundary conditions in this paper we derive a semi analytical solution to richards equation see richards 1931 for a two layered one dimensional soil under the assumption that the constitutive model as applied to the porous medium in each layer follows an exponential relation to the pressure head see the model in gardner 1958 as in srivastava and jim yeh 1991 and luca and cepeda 2016 the assumed relations allow for the transformation of richards equation into a linear parabolic partial differential equation governing the hydraulic conductivity as function of spatial and temporal variables from this linear differential operator a set of eigenpairs is constructed where each eigenfunction is continuous over the soil span and satisfies a certain flux continuity condition at the interface that takes into account the discontinuity in the capillary rise coefficient furthermore under a scalar product that is designed to incorporate the discontinuity caused by the coefficients it is shown that eigenfunctions form an orthogonal set continuity constraints for the pressure head and its flux at the interface of the layers are appropriately transformed into a set of constraints of the hydraulic conductivity that is viewed as a function of depth and time this function is to be expressed as a linear combination of the eigenfunctions and an auxiliary function whose parameters depend on the pressure head at the layer interface which in turns changes in time each of the eigenpairs is governed by a sturm liouville problem that takes into account the two layered nature of the soil all relevant unknown parameters in the solution representation are governed by an initial value problem that involves a system of nonlinear differential algebraic equations daes one major limitation of the solution proposed by srivastava and jim yeh 1991 is that it is only valid when α 1 α 2 i e the model assumes the same capillary rise between the two layers their manuscript does not give any indication on how to handle different capillary rise in this respect we would like to suggest that the proposed semi analytical approach gives a considerable advantage over that of srivastava and jim yeh 1991 because it allows for different capillary rise between the two layers furthermore unlike the model of luca and cepeda 2016 the proposed semi analytical approach utilizes a genuine set of eigenfunctions that captures the effect of discontinuity in the parameters also the auxiliary function in the solution is allowed to depend on time to take into account the dynamics of the pressure head at the interface two approximations are considered for the aforementioned daes to construct the solution of the problem the first approximation relies on an assumption that the infiltration process is still at an early stage or near a steady state this yields a system of nonlinear algebraic equations that can be solved by newton s method of iteration at any fixed time instance the second approximation utilizes a finite difference to approximate the derivative in the differential algebraic system unlike the former this latter approach results in a system of nonlinear algebraic equations that is recursive in time for which a time marching is warranted where at each time instance the newton s method iteration is used posing exponential constitutive relations as described in gardner 1958 may limit the applicability of any analytical semi analytical solutions that are based on this assumption in response refs rucker et al 2005 and ghezzehei et al 2007 have discussed some procedures to transform van genuchten type constitutive relations to gardner s model after which any analytical solution based on the model can be utilized admittedly numerical solution techniques are the most reliable alternatives for solving richards equation with more realistic constitutive relations however to establish its robustness and reliability testing any numerical approximation against a set of benchmark problems for which analytical solutions are available is deemed necessary contribution of the present investigation is placed in the latter aspect more specifically the authors are currently looking into a potential application of generalized finite element methods see for example babuška and banerjee 2012 babuška et al 2017 kergrene et al 2016 gupta et al 2013 deng and calo 2020 for solving richards equation on layered soil system see aryeni et al 2022 for a recent application to quasilinear two point bvp in the upcoming work the semi analytical solution in this paper will be used to test these methods the remainder of this paper is organized as follows section 2 describes the so called mixed form richards equation posed on the two layer soil along with the assumption of exponential constitutive relations transformation of the equation into a linear parabolic partial differential equation is shown in section 3 which includes the transformed boundary conditions construction of a set of eigenvalues and eigenfunctions that is based on the linear differential operator is described in section 4 in section 5 an efficient procedure for calculating the eigenvalues is presented the actual semi analytical solution is derived in section 6 which describes the nonlinear algebraic system governing the coefficients in the solution a brief discussion of the convergence of the solution is offered in section 7 in section 8 we list the relevant components of the solution when a different set of boundary conditions is supplied specifically when an infiltration rate a neumann condition is imposed on the soil s surface some numerical experiments are discussed in section 9 section 10 gives a conclusion and briefly lists some future work 2 richards equation on two layered soil with exponential constitutive relations let ω 0 l be a two layered one dimensional domain i e and for a given interface γ ω let ω 1 0 γ is the first layer and ω 2 γ l is the second layer and ω ω 1 ω 2 γ let θ 0 0 1 and κ 0 0 be defined as 2 1 θ u θ r 1 θ s 1 θ r 1 exp α 1 u in ω 1 θ r 2 θ s 2 θ r 2 exp α 2 u in ω 2 κ u k s 1 exp α 1 u in ω 1 k s 2 exp α 2 u in ω 2 where θ s j and θ r j j 1 2 are chosen so that θ u 0 1 k s j 0 and α j 0 j 1 2 given a τ 0 we want to find u τ a continuous function in ω that is governed by 2 2 θ u z τ t z κ u z τ z u z τ z 0 z ω z γ u 0 τ g 0 u l τ g l κ u z τ z u z τ z z γ κ u z τ z u z τ z z γ supplied with an initial condition 2 3 lim τ 0 u z τ u 0 z for a given initial pressure head u 0 which is assumed to be continuous in ω the last equation in 2 2 signifies continuity of the flux at the interface of the layers 3 transformation into a linear problem suppose r τ ω r is defined as r z τ k s 1 exp α 1 u z τ z ω 1 k s 2 exp α 2 u z τ z ω 2 by evaluating various relevant derivatives using the chain rule of differentiation and the constitutive relations 2 1 2 2 is transformed into finding r τ square integrable function in ω and ζ τ r that are governed by 3 1 r z τ t 1 α j b j 2 r z τ z 2 1 b j r z τ z 0 z ω j j 1 2 r 0 τ k s 1 exp α 1 g 0 r l τ k s 2 exp α 2 g l r γ τ k s 1 exp α 1 ζ τ r γ τ k s 2 exp α 2 ζ τ 1 α 1 r γ τ z r γ τ 1 α 2 r γ τ z r γ τ where b j θ s j θ r j k s j j 1 2 the problem is supplied with an initial condition 3 2 lim τ 0 r z τ κ u 0 z k s 1 exp α 1 u 0 z z ω 1 k s 2 exp α 2 u 0 z z ω 2 here we interpret ζ τ as the value of u γ τ 4 construction of a set of eigenpairs let ϕ n a continuous function in ω and λ n 0 be governed by 4 1 1 α j b j ϕ n z 1 b j ϕ n z λ n ϕ n z z ω j j 1 2 ϕ n 0 0 ϕ n l 0 1 α 1 ϕ n γ 1 α 2 ϕ n γ this is an example of a sturm liouville problem that includes the two layered nature of the soil each ode has constant coefficients so the corresponding characteristic equation is r 2 α j r b j α j λ n 0 having roots r j 1 2 α j 2 ν j n where ν j n α j 2 1 4 b j α j 1 λ n we assume that the given soil data corresponds to the nontrivial case 1 4 b j α j 1 λ n 0 j 1 2 which produces complex roots see the appendix for a list of two other possible nontrivial eigenfunctions for this case 4 2 ϕ n z exp 0 5 α 1 z a 1 cos μ 1 n z a 2 sin μ 1 n z z ω 1 exp 0 5 α 2 z b 1 cos μ 2 n l z b 2 sin μ 2 n l z z ω 2 where 4 3 μ j n α j 2 4 b j α j 1 λ n 1 notice that μ j n 2 μ j m 2 b j α j λ n λ m so μ j n μ j m as long as λ n λ m furthermore since λ n is unique for a fixed positive integer n solving for λ n in 4 3 for each j and equate the two equations yield μ 1 n 2 b 1 α 1 α 1 4 b 1 μ 2 n 2 b 2 α 2 α 2 4 b 2 imposing the boundary condition at z 0 and z l we get a 1 0 and b 1 0 by continuity of ϕ n at γ we have ϕ n γ ϕ n γ and thus 4 4 a 2 exp 0 5 α 1 γ sin μ 1 n γ b 2 exp 0 5 α 2 γ sin μ 2 n l γ 0 imposing continuity of the flux at γ i e third equation in 4 1 and using ϕ n γ ϕ n γ we get 4 5 a 2 exp 0 5 α 1 γ μ 1 n α 1 cos μ 1 n γ b 2 exp 0 5 α 2 γ μ 2 n α 2 cos μ 2 n l γ 0 in order to get a nontrivial solution we must have a 2 0 and b 2 0 this can occur only if 4 4 and 4 5 are linearly dependent which is guaranteed when μ 1 n μ 2 n satisfies 4 6 μ 2 n sin μ 1 n γ cos μ 2 n l γ α 2 μ 1 n sin μ 2 n l γ cos μ 1 n γ α 1 0 assuming sin μ 1 n γ 0 4 4 implies a 2 b 2 exp 0 5 α 2 α 1 γ sin μ 2 n l γ sin μ 1 n γ which can then be used in 4 2 to get 4 7 ϕ n z β n exp 0 5 α 2 α 1 γ 0 5 α 1 z sin μ 1 n z z ω 1 exp 0 5 α 2 z sin μ 2 n l z z ω 2 where β n sin μ 2 n l γ sin μ 1 n γ here without loss of generality we have assumed that b 2 1 given f h square integrable functions in ω define the following scalar product 4 8 f h f h γ f h γ where f h γ b 1 0 γ f z h z exp α 2 α 1 γ α 1 z d z and f h γ b 2 γ l f z h z exp α 2 z d z indeed this satisfies all axioms of scalar product also because exp α 2 α 1 γ exp α 2 α 1 γ α 1 z exp α 2 γ z 0 γ exp α 2 γ exp α 2 z exp α 2 l z γ l we can deduce that 4 9 c min ω f z 2 d z f f c max ω f z 2 d z where c min min b 1 b 2 exp α 2 l c max max b 1 b 2 exp α 2 γ this last inequality confirms that generates a norm for any square integrable function in ω with this scalar product we claim that ϕ n n 1 is orthogonal i e ϕ n ϕ m 0 for n m for this purpose the following identity is needed 4 10 1 α j b j d d z ϕ n exp α j z 1 exp α j z 1 α j b j ϕ n 1 b j ϕ n λ n ϕ n exp α j z which is obtained from an application of the quotient rule of differentiation and using the ode in 4 1 using 4 10 along with an application of integration by parts and ϕ m 0 0 4 11 λ n ϕ n ϕ m γ b 1 exp α 2 α 1 γ 0 γ λ n ϕ n ϕ m exp α 1 z d z 1 exp α 2 α 1 γ 1 α 1 0 γ d d z ϕ n exp α 1 z ϕ m d z 1 exp α 2 α 1 γ 1 α 1 ϕ n γ ϕ m γ exp α 1 γ 0 γ ϕ n ϕ m exp α 1 z d z by appropriate rearrangement this last equation implies 4 12 λ m ϕ n ϕ m γ 1 exp α 2 α 1 γ 1 α 1 ϕ m γ ϕ n γ exp α 1 γ 0 γ ϕ m ϕ n exp α 1 z d z using 4 11 and 4 12 4 13 λ m λ n ϕ n ϕ m γ ϕ m γ ϕ n γ α 1 exp α 2 γ ϕ n γ ϕ m γ α 1 exp α 2 γ in a similar fashion we obtain 4 14 λ m λ n ϕ n ϕ m γ ϕ m γ ϕ n γ α 2 exp α 2 γ ϕ n γ ϕ m γ α 2 exp α 2 γ using 4 13 and 4 14 and invoking the continuity of ϕ n and its flux at γ λ m λ n ϕ n ϕ m λ m λ n ϕ n ϕ m γ λ m λ n ϕ n ϕ m γ 0 since λ m λ n this establishes the orthogonality of ϕ n n 1 with respect to the scalar product in 4 8 5 an algorithm to calculate the eigenvalues this section proposes a procedure for calculating the eigenvalues to simplify the notation let σ 1 n μ 1 n γ σ 2 n μ 2 n l γ δ 1 1 α 1 γ δ 2 1 α 2 l γ upon utilizing 4 6 and employing product to sum trigonometric identities the unknowns σ 1 n σ 2 n satisfy 0 δ 2 σ 2 n sin σ 1 n cos σ 2 n δ 1 σ 1 n sin σ 2 n cos σ 1 n δ 2 σ 2 n δ 1 σ 1 n 2 sin σ 1 n σ 2 n δ 2 σ 2 n δ 1 σ 1 n 2 sin σ 1 n σ 2 n or sin σ 1 n σ 2 n δ 1 σ 1 n δ 2 σ 2 n δ 1 σ 1 n δ 2 σ 2 n sin σ 1 n σ 2 n notice also that λ n 4 μ j n 2 α j 2 1 4 b j α j 1 4 δ j 2 σ j n 2 1 4 b j α j 1 for j 1 2 so σ 2 n 2 a σ 1 n 2 b where a δ 1 2 b 2 α 2 1 δ 2 2 b 1 α 1 1 α 2 b 2 l γ 2 α 1 b 1 γ 2 0 b b 2 α 2 1 b 1 α 1 1 4 δ 2 2 b 1 α 1 1 without loss of generality assume that b 0 then σ 1 n σ 2 n σ 1 n 1 a b σ 1 n 2 σ 1 n σ 2 n σ 1 n 1 a b σ 1 n 2 δ 1 σ 1 n δ 2 σ 2 n δ 1 σ 1 n δ 2 σ 2 n δ 1 δ 2 a b σ 1 n 2 δ 1 δ 2 a b σ 1 n 2 r n with r n 1 furthermore using the above relations we set x n σ 1 n σ 2 n and p n x n σ 1 n σ 2 n where p n 1 a b σ 1 n 2 1 a b σ 1 n 2 with p n 1 thus we want to find x n 0 such that 5 1 sin x n r n sin p n x n 0 remark 1 notice that r n r δ 1 δ 2 a δ 1 δ 2 a a n d p n p 1 a 1 a a s σ 1 n thus x n x as σ 1 n with x governed by sin x r sin p x 0 where r 1 and p 1 a closer inspection of the two curves show that any x lies in ℓ π ℓ 1 π for some nonnegative integer ℓ the above remark gives a motivation for a possible initial guess to be used in a variant of newton s method of iteration to find x n 0 that satisfies 5 1 the procedure is listed in algorithm 1 remark 2 when b 0 then we may use the relation σ 1 n 2 1 a σ 2 n 2 b a a σ 2 n 2 b and it can be shown that x n σ 1 n σ 2 n satisfies sin x n r n sin p n x n 0 where r n δ 2 δ 1 a b σ 2 n 2 δ 2 δ 1 a b σ 2 n 2 p n 1 a b σ 2 n 2 1 a b σ 2 n 2 algorithm 1 can be appropriately modified for this case 6 solution strategy let ρ τ be a square integrable function in ω that is governed by 6 1 1 α j b j 2 ρ z τ z 2 1 b j ρ z τ z 0 in ω j j 1 2 ρ 0 τ k s 1 exp α 1 g 0 ρ l τ k s 2 exp α 2 g l the general solution to the differential equation in 6 1 is 6 2 ρ z τ c 1 τ c 2 τ exp α 1 z z ω 1 d 1 τ d 2 τ exp α 2 z l z ω 2 we then formally write 6 3 r z τ n 1 c n τ exp λ n τ ϕ n z ρ z τ using the last equation in 3 1 and taking advantage of the last equation in 4 1 yields 6 4 1 α 1 ρ z γ τ ρ γ τ 1 α 2 ρ z γ τ ρ γ τ and thus c 1 τ d 1 τ using this fact when imposing the boundary condition of ρ τ at z 0 and z l 6 5 c 1 τ c 2 τ k s 1 exp α 1 g 0 d 2 τ c 2 τ k s 2 exp α 2 g l k s 1 exp α 1 g 0 d 1 τ c 2 τ k s 1 exp α 1 g 0 the third and fourth equations in 3 1 yield 6 6 n 1 c n τ exp λ n τ ϕ n γ m 1 c 2 τ f 1 ζ τ n 1 c n τ exp λ n τ ϕ n γ m 2 c 2 τ f 2 ζ τ where m 1 exp α 1 γ 1 m 2 exp α 2 γ l 1 f 1 ζ k s 1 exp α 1 ζ exp α 1 g 0 f 2 ζ k s 2 exp α 2 ζ exp α 2 g l γ l k s 1 exp α 1 g 0 1 exp α 2 γ l currently there are 3 unknowns namely c n τ c 2 τ ζ τ and two equations in 6 6 to provide the additional equation we take various derivatives of r in 6 3 put them back into the pde i e imposing the first equation in 3 1 perform appropriate rearrangement and use the ode in 4 1 to get n 1 c n τ exp λ n τ ϕ n z ρ z τ t 0 z γ due to the orthogonality of the eigenfunctions this then implies c n τ exp λ n τ ρ n τ where ρ n τ ρ τ ϕ n ϕ n ϕ n p 1 n c 1 τ p 2 n c 2 τ q 1 n d 1 τ q 2 n d 2 τ i n c 2 τ j n and p 1 n 1 ϕ n γ ϕ n ϕ n p 2 n exp α 1 z ϕ n γ ϕ n ϕ n q 1 n 1 ϕ n γ ϕ n ϕ n q 2 n exp α 2 z l ϕ n γ ϕ n ϕ n i n p 2 n q 2 n p 1 n q 1 n j n p 1 n q 1 n k s 1 exp α 1 g 0 q 2 n k s 2 exp α 2 g l k s 1 exp α 1 g 0 thus ρ n τ i n c 2 τ by utilizing the initial condition 3 2 in 6 3 we set 6 7 c n 0 κ u 0 ρ 0 ϕ n ϕ n ϕ n κ n ρ n 0 κ n i n c 2 0 j n where κ n κ u 0 ϕ n ϕ n ϕ n the complete representation of r z τ and ζ τ are achieved once 6 8 c n τ c 2 τ ζ τ are calculated from the following initial value problem involving a system of differential algebraic equations 6 9 c n τ exp λ n τ i n c 2 τ c n 0 i n c 2 0 κ n j n n 1 c n τ exp λ n τ ϕ n γ m 1 c 2 τ f 1 ζ τ n 1 c n τ exp λ n τ ϕ n γ m 2 c 2 τ f 2 ζ τ in the next two subsections we discuss two different approximations 6 1 first approximation notice that exp λ n τ 1 at the initial stage of the infiltration i e when τ is still near 0 with this condition the ode in 6 9 implies c n τ i n c 2 τ which further yields c n τ i n c 2 τ constant from the initial condition we conclude that 6 10 c n τ i n c 2 τ κ n j n this approximation can be inserted to the second and third equations in 6 9 to yield a system of algebraic equations governing c 2 τ ζ τ 6 11 s τ m 1 c 2 τ q τ f 1 ζ τ s τ m 2 c 2 τ q τ f 2 ζ τ where s τ n 1 i n exp λ n τ ϕ n γ and q τ n 1 κ n j n exp λ n τ ϕ n γ furthermore as the infiltration reaches a steady state i e as τ it can be inferred that s τ 0 and q τ 0 this means that 6 11 can still be used the above approach may not be suitable for middle range τ i e for infiltration stage that is transient in between the initial stage and the steady state for that the next approximation is appropriate 6 2 second approximation we perform the following finite difference approximation c n τ exp λ n τ c n τ c n τ δ τ δ τ exp λ n τ i n c 2 τ i n c 2 τ c 2 τ δ τ δ τ so that 6 12 c n τ exp λ n τ i n c 2 τ c n τ δ τ exp λ n τ i n c 2 τ δ τ for τ 0 and δ τ 0 we solve the following algebraic systems 6 13 s m 1 c 2 τ q τ f 1 ζ τ s m 2 c 2 τ q τ f 2 ζ τ where s n 1 i n ϕ n γ and q τ n 1 c n τ δ τ exp λ n τ ϕ n γ s c 2 τ δ τ for τ 0 we solve s m 1 c 2 0 n 1 κ n j n ϕ n γ f 1 ζ 0 s m 2 c 2 0 n 1 κ n j n ϕ n γ f 2 ζ 0 in practice for either of these approximations one must use a truncated version of the representation namely a finite series with a fixed number of terms n the whole procedure is laid out in algorithm 2 7 a brief discussion on the convergence of the solution according to algorithm 2 there are several sources of errors committed in the procedure the first one is due to the finite number n of eigenfunctions used in the representation the second one relates to the treatments that distinguishes the first and second approximations in this case early stage infiltration assumption versus finite difference for derivative the third one is on the recognition that the algebraic system in either of the approximations is nonlinear for which an iterative technique must be employed ignoring the latter we first would like to see what happen when n first we see that r n z τ already satisfies the pde and the respective conditions in 3 1 however it does not exactly satisfy the initial condition 3 2 thus error associated with the finite number of terms in the eigenfunctions expansion is originated from the discrepancy in the initial condition 7 14 e n κ u 0 n 1 n c n 0 ϕ n ρ 0 0 taking the scalar product 0 e n e n κ u 0 ρ 0 κ u 0 ρ 0 n 1 n c n 0 2 ϕ n ϕ n where 6 7 and the orthogonality of ϕ n have been used this yields n 1 n c n 0 2 ϕ n ϕ n κ u 0 ρ 0 κ u 0 ρ 0 c max ω κ u 0 z ρ z 0 2 d z this indicates that as n is made larger the series in the representation of r n remains bounded and converges to its supremum as n which is κ u 0 ρ 0 the error associated with using truncated series to represent the initial condition is propagated in time however it is expected that this error should diminish as τ i e as the solution approaches its steady state furthermore the finite difference in the second approximation has a truncation error with respect to δ t so that c n τ c n τ δ τ δ τ exp λ n τ c n τ exp λ n τ o δ τ i n c 2 τ c 2 τ δ τ δ τ i n c 2 τ o δ τ thus the error in the second approximation is expected to asymptotically behave as o n r o δ τ for some r 0 this means the second approximation can be made as accurate as one wishes by increasing n and by reducing δ t this is not the case in the first approximation while it is possible to reduce the error component from the truncation in the representation by making n larger the assumption exp λ n τ 1 will be considerably violated as τ is further away from 0 and cannot be remedied 8 problem with different boundary conditions the solution strategy laid out in the previous sections is immediately applicable when richards equation is supplied with different boundary conditions in this section we list the corresponding results when the boundary conditions are 8 1 κ u z u z 0 t g 0 and u l t g l the eigenfunction ϕ n now satisfies the boundary conditions 1 α 1 ϕ n 0 ϕ n 0 0 and ϕ n l 0 which yields ϕ n z β n exp 0 5 α 2 α 1 γ 0 5 α 1 z 2 μ 1 n α 1 cos μ 1 n z sin μ 1 n z z ω 1 exp 0 5 α 2 z sin μ 2 n l z z ω 2 where β n sin μ 2 n l γ 2 μ 1 n α 1 cos μ 1 n γ sin μ 1 n γ setting σ 1 n μ 1 n γ and σ 2 n μ 2 n l γ σ 1 n σ 2 n is governed by δ 2 σ 2 n sin σ 1 n cos σ 2 n δ 1 σ 1 n cos σ 1 n sin σ 2 n 2 δ 1 σ 1 n δ 2 σ 2 n cos σ 1 n cos σ 2 n δ 1 σ 1 n sin σ 1 n sin σ 2 n 0 furthermore defining x n σ 1 n σ 2 n it is governed by sin x n ψ n r n sin p n x n ψ n where r n and p n are as in algorithm 1 and ψ n tan 1 σ 1 n δ 1 2 notice that ψ n π 2 as σ 1 n and upon inspection of the two curves we may use n 1 π π 2 as initial guess for x n n 1 the function ρ τ expressed in 6 2 will have to satisfy 1 α 1 ρ z 0 τ ρ 0 τ g 0 and ρ l τ k s 2 exp α 2 g l imposing this and 6 4 we get c 1 τ g 0 d 1 τ g 0 d 2 τ g 0 k s 2 exp α 2 g l lastly we obtain c n τ c 2 τ ζ τ from solving 6 9 where in this case m 1 exp α 1 γ m 2 0 f 1 ζ k s 1 exp α 1 ζ g 0 f 2 ζ k s 2 exp α 2 ζ g 0 g 0 k s 2 exp α 2 g l exp α 2 γ l i n p 2 n j n p 1 n q 1 n g 0 q 2 n g 0 k s 2 exp α 2 g l 9 examples and discussions in this section we give several examples of richards equation in two layered soils that have exponential constitutive relations as described in the previous section details of the physical data are given in table 1 a validation of this semi analytical procedure is conducted by comparing the results with a numerical technique performed by finite volume finite difference method on dense spatial and temporal grids the one dimensional soil is discretized into 1000 intervals where the interface location is placed at the nodal points given τ 0 the time span 0 τ is discretized into 5000 time intervals the resulting nonlinear algebraic equations are solved using the modified picard iteration as described in celia et al 1990 as listed in table 1 there are two boundary conditions we observe here the first three examples use boundary conditions given in 2 2 and the remaining examples use boundary condition given in 8 1 the eigenfunction representation is given in fig 1 to see how they behave with respect to different boundary conditions the profiles of the pressure head u and the water content θ to these examples at several τ are shown in figs 2 to 7 in which the semi analytic solutions are plotted by using n 10 000 of eigenfunctions and the first approximation 6 11 is utilized the initial pressure head profile for example 1 is assumed to be a linear function that honor the pressure values at the boundary i e 9 2 u 0 z g l g 0 z l g 0 meanwhile the initial condition for examples 2 and 3 is a constant function as given in table 1 for examples 4 and 5 the initial pressure is also assumed to be linear a different treatment is done for examples 6 and 7 where in this case the effect of the interface is considered to be involved at the initial time the initial pressure for examples 6 and 7 is assumed to be a steady state profile with the infiltration rate i r 0 01 m h and i r 0 1 cm h respectively resulting in 9 3 u 0 z 1 α 1 ln i r c 2 0 exp α 1 z k s 1 z ω 1 1 α 2 ln i r d 2 0 exp α 2 z l k s 2 z ω 2 where d 2 0 i r k s 2 exp α 2 g l c 2 0 exp α 1 γ k s 1 i r d 2 0 exp α 2 γ l k s 2 α 1 α 2 i r the infiltration rate is then increased for time greater than zero it is observed from figs 2 to 7 that in general the semi analytical procedure constructed from the first approximation 6 11 produces solutions that are in a good agreement with the finite volume method simulation there is a noticeable discrepancy at several transient time instances which is attributed to the fact that the assumption exp λ n τ 1 does not hold anymore nonetheless this discrepancy can be alleviated by using the second approximation 6 13 and the solutions match really well the finite volume solutions as seen in those figures the error of the hydraulic conductivity is recorded by calculating the discrepancy in the initial condition due to the finite number n of eigenfunctions that is used in the representation as discussed in section 7 fig 8 shows the norm error of e n where is a usual norm for any square integrable functions in ω generated from 4 9 the number of eigenfunctions are n 250 500 1000 2000 4000 8000 16 000 these errors show a convergence rate 1 5 as n gets larger but the rate of convergence is lower in examples 2 and 3 due to the incompatibility of the initial conditions and the boundary values the computational times are recorded in table 2 as to compare the average amount of time needed to produce the figures of the pressure head profiles these solutions were run from a computer with processor intel r core tm i5 10500 3 10 ghz apparently the semi analytical procedure only needs about one second to obtain the similar quality of the overkill solutions produced by finite volume method indeed it is more desirable in terms of time efficiency lastly we calculate the relative difference to observe the time history of discrepancy between the semi analytical solution and the finite volume solution of pressure head define relative difference at τ u n τ fvm sol τ fvm sol τ 100 fig 9 shows the relative difference of the pressure head for all examples at some fixed τ until it reaches a steady state condition the plots in this figure demonstrates a consistent behavior of the semi analytical solution procedure in general the first approximation works reasonably well as indicated by the relative differences to the fvm numerical simulations that are below 5 except for example 4 which is a drainage case as expected the larger amount of relative differences is in particular occurring at the transient stage where the assumption exp λ n τ 1 is no longer maintained however especially when τ is still closer to 0 the first approximation exhibits a very similar quality to any second approximation in which time derivative is incorporated into the system since inclusion of the derivative entails a time marching which makes the procedure more expensive it can be argued that the first approximation would strike a balance between accuracy and efficiency for finding solutions at such τ similar behavior is true when τ is approaching the steady state still one can find the advantage of using the second approximation when τ represents a transient stage where discrepancy associated with the first approximation cannot be alleviated as shown by the three cases of δ τ in each plot it is a possible to reduce the discrepancy consistently by reducing this time step this is specifically more relevant in example 4 which models a drainage clearly the first approximation does not quite perform as well as in the other examples however the second approximation has the capability to decrease the discrepancy in example 4 it should be noted that modeling drainage can be quite challenging due to the possibility of entering a degenerate regime for which standard simulations can fail in the interest of lending an enhanced credibility to the proposed semi analytical approach we provide example 7 with α 1 α 2 in fig 10 that compares the approach of srivastava and jim yeh 1991 and the overkill finite volume the profiles in this figure confirm that indeed the proposed semi analytical approach matches very well the other solutions 10 conclusion and future work the development in this paper is motivated by the need for some benchmark richards equation problems on layered soil for which analytical solutions can be constructed this in particular is beneficial in testing the robustness and reliability of some numerical methods that are designed for problems of this type comparison of the developed strategy with a standard finite volume approximation indicates a close similarity of the solutions the strategy is flexible to different boundary conditions several items are to be investigated in the future albeit the mathematical intricacies it is expected that the proposed method can be straightforwardly derived to handle infiltration in a soil having more than two layers it is of interest to see how the proposed method can be adapted to handle boundary conditions with time varying boundary values as alluded to in the introduction the authors are currently investigating the application of generalized finite element methods to approximate solution of richards equation on layered soil system availability of analytical solutions as presented in this paper is instrumental in establishing the accuracy of these numerical methods declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment all authors approved the version of the manuscript to be published appendix other nontrivial eigenfunctions recall the derivation in section 4 for solving 4 1 is based on the assumption that 1 4 b j α j 1 λ n 0 for j 1 2 a direct calculation would confirm that cases when 1 4 b j α j 1 λ n 0 for j 1 2 yield only a trivial solution i e ϕ n 0 in ω in what follows we list two other possible nontrivial eigenfunctions that may occur depending on the soil data configuration following the derivation in section 4 we use ν j n α j 2 1 4 b j α j 1 λ n and μ j n α j 2 4 b j α j 1 λ n 1 j 1 2 a 1 case 1 4 b 2 α 2 1 λ n 0 and 1 4 b 1 α 1 1 λ n 0 this yields μ 1 n 0 and ν 2 n 0 and α 1 4 b 1 λ n α 2 4 b 2 the solution of 4 1 is ϕ n z c 2 exp 0 5 α 1 z sin μ 1 n z z ω 1 d 2 exp 0 5 α 2 z sinh ν 2 n l z z ω 2 imposing the continuity of the solution and its flux at γ yields a linear system governing c 2 d 2 c 2 exp 0 5 α 1 γ sin μ 1 n γ d 2 exp 0 5 α 2 γ sinh ν 2 n l γ 0 c 2 μ 1 n α 1 exp 0 5 α 1 γ cos μ 1 n γ d 2 ν 2 n α 2 exp 0 5 α 2 γ cosh ν 2 n l γ 0 whose determinant is det exp 0 5 α 1 α 2 γ ν 2 n α 2 sin μ 1 n γ cosh ν 2 n l γ μ 1 n α 1 cos μ 1 n γ sinh ν 2 n l γ since l γ we have sinh ν 2 n l γ 0 and cosh ν 2 n l γ 0 so it is possible for the determinant to be zero when there is μ 1 n γ such that sin μ 1 n γ and cos μ 1 n γ have different sign in particular for any m 0 1 2 π 2 2 m π α 1 γ 2 4 b 1 α 1 1 λ n 1 2 m 1 π or 3 π 2 2 m π α 1 γ 2 4 b 1 α 1 1 λ n 1 2 m 1 π under the constraint that α 1 4 b 1 λ n α 2 4 b 2 a 2 case 1 4 b 2 α 2 1 λ n 0 and 1 4 b 1 α 1 1 λ n 0 this yields ν 1 n 0 and μ 2 n 0 and α 2 4 b 2 λ n α 1 4 b 1 the solution of 4 1 is ϕ n z c 2 exp 0 5 α 1 z sinh ν 1 n z z ω 1 d 2 exp 0 5 α 2 z sin μ 2 n l z z ω 2 imposing the continuity of the solution and its flux at γ yields a linear system governing c 2 d 2 c 2 exp 0 5 α 1 γ sinh ν 1 n γ d 2 exp 0 5 α 2 γ sin μ 2 n l γ 0 c 2 ν 1 n α 1 exp 0 5 α 1 γ cosh ν 1 n γ d 2 μ 2 n α 2 exp 0 5 α 2 γ cos μ 2 n l γ 0 whose determinant is det exp 0 5 α 1 α 2 γ μ 2 n α 2 sinh ν 1 n γ cos μ 2 n l γ ν 1 n α 1 cosh ν 1 n γ sin μ 2 n l γ it is possible for the determinant to be zero when there is μ 2 n l γ such that sin μ 2 n l γ and cos μ 2 n l γ have the different sign in particular for any m 0 1 2 π 2 2 m π α 2 l γ 2 4 b 2 α 2 1 λ n 1 2 m 1 π or 3 π 2 2 m π α 2 l γ 2 4 b 2 α 2 1 λ n 1 2 m 1 π under the constraint that α 2 4 b 2 λ n α 1 4 b 1 
133,a semi analytical solution of richards equation for two layered one dimensional soil t aryeni v ginting department of mathematics statistics university of wyoming laramie wy 82071 usa department of mathematics statistics university of wyoming laramie wy 82071 usa department of mathematics statistics university of wyoming laramie wy 82071 usa corresponding author a semi analytical solution of the richards equation posed on a two layered one dimensional soil supplied with various boundary conditions is derived under a constraint that the constitutive relations are exponentially dependent on the pressure head it allows for a transformation of the richards equation into a linear parabolic partial differential equation that governs a spatial temporal function that represents the hydraulic conductivity the procedure is proceeded with expressing this function as a linear combination of a set of eigenfunctions associated with a novel sturm liouville problem that reflects the layer system and an auxiliary function that depends only on the spatial variable and the pressure head at the interface at the time of interest all the relevant coefficients in the representation satisfy a nonlinear differential algebraic system gathered from imposing the continuity of the pressure head and its flux at the interface two different approximations of the derivatives yield algebraic systems to be solved by the newton method of iteration several pertinent numerical experiments demonstrating the approach are discussed and compared with the standard finite volume method keywords richards equation interface problem semi analytical eigenfunction 1 introduction a realistic capability to accurately predict the dynamics of moisture content in the vadose zone must often include the spatial heterogeneity of the soil often modeled by a multi layered system to the best of the authors knowledge there are only two manuscripts that rigorously discussed analytical solutions of the so called mixed form of richards equation in a multi layered soil see srivastava and jim yeh 1991 and luca and cepeda 2016 both of these references assume exponential constitutive relations as described by gardner 1958 that allows for a transformation of the original problem into a linear initial boundary value problem that governs the dynamics of spatial value of the hydraulic conductivity after this operation srivastava and jim yeh 1991 utilize the laplace transform and its inverse using residue theorem to obtain an analytical solution of the hydraulic conductivity as a function of depth and time in luca and cepeda 2016 the solution of the transformed problem is expressed as an eigenfunction expansion plus a steady state solution a fictitious length is to be calculated to take into effect the change at the interface of the layers other than the above references solutions of richards equation in layered soils have mainly relied on various numerical approximations where virtually there is no more restriction on the type of constitutive relations to model the layers behaviors standard finite difference finite volume and finite element techniques have been extensively employed for solving richards equation see for example haverkamp et al 1977 eymard et al 1999 cumming et al 2011 and brunone et al 2003 one main drawback in many of these numerical methods is the absence of a natural way to impose continuity of the flux at the interface due to its discontinuity the hydraulic conductivity at the interface is represented as a certain average of its neighboring layers see for example romano et al 1998 and liu et al 2017 suo et al 2019 in berardi et al 2018 a filippov framework is used to treat the discontinuity in the model see also al maktoumi et al 2015 lee et al 2020 mohammadzadeh habili and heidarpour 2015 for methods that employ the green ampt approach other than the above standard techniques marinelli and durnford 1998 applies a finite difference to the time derivative in richards equation resulting in an ode that is to be solved by a runge kutta solver in combination with a shooting method to impose the boundary conditions in this paper we derive a semi analytical solution to richards equation see richards 1931 for a two layered one dimensional soil under the assumption that the constitutive model as applied to the porous medium in each layer follows an exponential relation to the pressure head see the model in gardner 1958 as in srivastava and jim yeh 1991 and luca and cepeda 2016 the assumed relations allow for the transformation of richards equation into a linear parabolic partial differential equation governing the hydraulic conductivity as function of spatial and temporal variables from this linear differential operator a set of eigenpairs is constructed where each eigenfunction is continuous over the soil span and satisfies a certain flux continuity condition at the interface that takes into account the discontinuity in the capillary rise coefficient furthermore under a scalar product that is designed to incorporate the discontinuity caused by the coefficients it is shown that eigenfunctions form an orthogonal set continuity constraints for the pressure head and its flux at the interface of the layers are appropriately transformed into a set of constraints of the hydraulic conductivity that is viewed as a function of depth and time this function is to be expressed as a linear combination of the eigenfunctions and an auxiliary function whose parameters depend on the pressure head at the layer interface which in turns changes in time each of the eigenpairs is governed by a sturm liouville problem that takes into account the two layered nature of the soil all relevant unknown parameters in the solution representation are governed by an initial value problem that involves a system of nonlinear differential algebraic equations daes one major limitation of the solution proposed by srivastava and jim yeh 1991 is that it is only valid when α 1 α 2 i e the model assumes the same capillary rise between the two layers their manuscript does not give any indication on how to handle different capillary rise in this respect we would like to suggest that the proposed semi analytical approach gives a considerable advantage over that of srivastava and jim yeh 1991 because it allows for different capillary rise between the two layers furthermore unlike the model of luca and cepeda 2016 the proposed semi analytical approach utilizes a genuine set of eigenfunctions that captures the effect of discontinuity in the parameters also the auxiliary function in the solution is allowed to depend on time to take into account the dynamics of the pressure head at the interface two approximations are considered for the aforementioned daes to construct the solution of the problem the first approximation relies on an assumption that the infiltration process is still at an early stage or near a steady state this yields a system of nonlinear algebraic equations that can be solved by newton s method of iteration at any fixed time instance the second approximation utilizes a finite difference to approximate the derivative in the differential algebraic system unlike the former this latter approach results in a system of nonlinear algebraic equations that is recursive in time for which a time marching is warranted where at each time instance the newton s method iteration is used posing exponential constitutive relations as described in gardner 1958 may limit the applicability of any analytical semi analytical solutions that are based on this assumption in response refs rucker et al 2005 and ghezzehei et al 2007 have discussed some procedures to transform van genuchten type constitutive relations to gardner s model after which any analytical solution based on the model can be utilized admittedly numerical solution techniques are the most reliable alternatives for solving richards equation with more realistic constitutive relations however to establish its robustness and reliability testing any numerical approximation against a set of benchmark problems for which analytical solutions are available is deemed necessary contribution of the present investigation is placed in the latter aspect more specifically the authors are currently looking into a potential application of generalized finite element methods see for example babuška and banerjee 2012 babuška et al 2017 kergrene et al 2016 gupta et al 2013 deng and calo 2020 for solving richards equation on layered soil system see aryeni et al 2022 for a recent application to quasilinear two point bvp in the upcoming work the semi analytical solution in this paper will be used to test these methods the remainder of this paper is organized as follows section 2 describes the so called mixed form richards equation posed on the two layer soil along with the assumption of exponential constitutive relations transformation of the equation into a linear parabolic partial differential equation is shown in section 3 which includes the transformed boundary conditions construction of a set of eigenvalues and eigenfunctions that is based on the linear differential operator is described in section 4 in section 5 an efficient procedure for calculating the eigenvalues is presented the actual semi analytical solution is derived in section 6 which describes the nonlinear algebraic system governing the coefficients in the solution a brief discussion of the convergence of the solution is offered in section 7 in section 8 we list the relevant components of the solution when a different set of boundary conditions is supplied specifically when an infiltration rate a neumann condition is imposed on the soil s surface some numerical experiments are discussed in section 9 section 10 gives a conclusion and briefly lists some future work 2 richards equation on two layered soil with exponential constitutive relations let ω 0 l be a two layered one dimensional domain i e and for a given interface γ ω let ω 1 0 γ is the first layer and ω 2 γ l is the second layer and ω ω 1 ω 2 γ let θ 0 0 1 and κ 0 0 be defined as 2 1 θ u θ r 1 θ s 1 θ r 1 exp α 1 u in ω 1 θ r 2 θ s 2 θ r 2 exp α 2 u in ω 2 κ u k s 1 exp α 1 u in ω 1 k s 2 exp α 2 u in ω 2 where θ s j and θ r j j 1 2 are chosen so that θ u 0 1 k s j 0 and α j 0 j 1 2 given a τ 0 we want to find u τ a continuous function in ω that is governed by 2 2 θ u z τ t z κ u z τ z u z τ z 0 z ω z γ u 0 τ g 0 u l τ g l κ u z τ z u z τ z z γ κ u z τ z u z τ z z γ supplied with an initial condition 2 3 lim τ 0 u z τ u 0 z for a given initial pressure head u 0 which is assumed to be continuous in ω the last equation in 2 2 signifies continuity of the flux at the interface of the layers 3 transformation into a linear problem suppose r τ ω r is defined as r z τ k s 1 exp α 1 u z τ z ω 1 k s 2 exp α 2 u z τ z ω 2 by evaluating various relevant derivatives using the chain rule of differentiation and the constitutive relations 2 1 2 2 is transformed into finding r τ square integrable function in ω and ζ τ r that are governed by 3 1 r z τ t 1 α j b j 2 r z τ z 2 1 b j r z τ z 0 z ω j j 1 2 r 0 τ k s 1 exp α 1 g 0 r l τ k s 2 exp α 2 g l r γ τ k s 1 exp α 1 ζ τ r γ τ k s 2 exp α 2 ζ τ 1 α 1 r γ τ z r γ τ 1 α 2 r γ τ z r γ τ where b j θ s j θ r j k s j j 1 2 the problem is supplied with an initial condition 3 2 lim τ 0 r z τ κ u 0 z k s 1 exp α 1 u 0 z z ω 1 k s 2 exp α 2 u 0 z z ω 2 here we interpret ζ τ as the value of u γ τ 4 construction of a set of eigenpairs let ϕ n a continuous function in ω and λ n 0 be governed by 4 1 1 α j b j ϕ n z 1 b j ϕ n z λ n ϕ n z z ω j j 1 2 ϕ n 0 0 ϕ n l 0 1 α 1 ϕ n γ 1 α 2 ϕ n γ this is an example of a sturm liouville problem that includes the two layered nature of the soil each ode has constant coefficients so the corresponding characteristic equation is r 2 α j r b j α j λ n 0 having roots r j 1 2 α j 2 ν j n where ν j n α j 2 1 4 b j α j 1 λ n we assume that the given soil data corresponds to the nontrivial case 1 4 b j α j 1 λ n 0 j 1 2 which produces complex roots see the appendix for a list of two other possible nontrivial eigenfunctions for this case 4 2 ϕ n z exp 0 5 α 1 z a 1 cos μ 1 n z a 2 sin μ 1 n z z ω 1 exp 0 5 α 2 z b 1 cos μ 2 n l z b 2 sin μ 2 n l z z ω 2 where 4 3 μ j n α j 2 4 b j α j 1 λ n 1 notice that μ j n 2 μ j m 2 b j α j λ n λ m so μ j n μ j m as long as λ n λ m furthermore since λ n is unique for a fixed positive integer n solving for λ n in 4 3 for each j and equate the two equations yield μ 1 n 2 b 1 α 1 α 1 4 b 1 μ 2 n 2 b 2 α 2 α 2 4 b 2 imposing the boundary condition at z 0 and z l we get a 1 0 and b 1 0 by continuity of ϕ n at γ we have ϕ n γ ϕ n γ and thus 4 4 a 2 exp 0 5 α 1 γ sin μ 1 n γ b 2 exp 0 5 α 2 γ sin μ 2 n l γ 0 imposing continuity of the flux at γ i e third equation in 4 1 and using ϕ n γ ϕ n γ we get 4 5 a 2 exp 0 5 α 1 γ μ 1 n α 1 cos μ 1 n γ b 2 exp 0 5 α 2 γ μ 2 n α 2 cos μ 2 n l γ 0 in order to get a nontrivial solution we must have a 2 0 and b 2 0 this can occur only if 4 4 and 4 5 are linearly dependent which is guaranteed when μ 1 n μ 2 n satisfies 4 6 μ 2 n sin μ 1 n γ cos μ 2 n l γ α 2 μ 1 n sin μ 2 n l γ cos μ 1 n γ α 1 0 assuming sin μ 1 n γ 0 4 4 implies a 2 b 2 exp 0 5 α 2 α 1 γ sin μ 2 n l γ sin μ 1 n γ which can then be used in 4 2 to get 4 7 ϕ n z β n exp 0 5 α 2 α 1 γ 0 5 α 1 z sin μ 1 n z z ω 1 exp 0 5 α 2 z sin μ 2 n l z z ω 2 where β n sin μ 2 n l γ sin μ 1 n γ here without loss of generality we have assumed that b 2 1 given f h square integrable functions in ω define the following scalar product 4 8 f h f h γ f h γ where f h γ b 1 0 γ f z h z exp α 2 α 1 γ α 1 z d z and f h γ b 2 γ l f z h z exp α 2 z d z indeed this satisfies all axioms of scalar product also because exp α 2 α 1 γ exp α 2 α 1 γ α 1 z exp α 2 γ z 0 γ exp α 2 γ exp α 2 z exp α 2 l z γ l we can deduce that 4 9 c min ω f z 2 d z f f c max ω f z 2 d z where c min min b 1 b 2 exp α 2 l c max max b 1 b 2 exp α 2 γ this last inequality confirms that generates a norm for any square integrable function in ω with this scalar product we claim that ϕ n n 1 is orthogonal i e ϕ n ϕ m 0 for n m for this purpose the following identity is needed 4 10 1 α j b j d d z ϕ n exp α j z 1 exp α j z 1 α j b j ϕ n 1 b j ϕ n λ n ϕ n exp α j z which is obtained from an application of the quotient rule of differentiation and using the ode in 4 1 using 4 10 along with an application of integration by parts and ϕ m 0 0 4 11 λ n ϕ n ϕ m γ b 1 exp α 2 α 1 γ 0 γ λ n ϕ n ϕ m exp α 1 z d z 1 exp α 2 α 1 γ 1 α 1 0 γ d d z ϕ n exp α 1 z ϕ m d z 1 exp α 2 α 1 γ 1 α 1 ϕ n γ ϕ m γ exp α 1 γ 0 γ ϕ n ϕ m exp α 1 z d z by appropriate rearrangement this last equation implies 4 12 λ m ϕ n ϕ m γ 1 exp α 2 α 1 γ 1 α 1 ϕ m γ ϕ n γ exp α 1 γ 0 γ ϕ m ϕ n exp α 1 z d z using 4 11 and 4 12 4 13 λ m λ n ϕ n ϕ m γ ϕ m γ ϕ n γ α 1 exp α 2 γ ϕ n γ ϕ m γ α 1 exp α 2 γ in a similar fashion we obtain 4 14 λ m λ n ϕ n ϕ m γ ϕ m γ ϕ n γ α 2 exp α 2 γ ϕ n γ ϕ m γ α 2 exp α 2 γ using 4 13 and 4 14 and invoking the continuity of ϕ n and its flux at γ λ m λ n ϕ n ϕ m λ m λ n ϕ n ϕ m γ λ m λ n ϕ n ϕ m γ 0 since λ m λ n this establishes the orthogonality of ϕ n n 1 with respect to the scalar product in 4 8 5 an algorithm to calculate the eigenvalues this section proposes a procedure for calculating the eigenvalues to simplify the notation let σ 1 n μ 1 n γ σ 2 n μ 2 n l γ δ 1 1 α 1 γ δ 2 1 α 2 l γ upon utilizing 4 6 and employing product to sum trigonometric identities the unknowns σ 1 n σ 2 n satisfy 0 δ 2 σ 2 n sin σ 1 n cos σ 2 n δ 1 σ 1 n sin σ 2 n cos σ 1 n δ 2 σ 2 n δ 1 σ 1 n 2 sin σ 1 n σ 2 n δ 2 σ 2 n δ 1 σ 1 n 2 sin σ 1 n σ 2 n or sin σ 1 n σ 2 n δ 1 σ 1 n δ 2 σ 2 n δ 1 σ 1 n δ 2 σ 2 n sin σ 1 n σ 2 n notice also that λ n 4 μ j n 2 α j 2 1 4 b j α j 1 4 δ j 2 σ j n 2 1 4 b j α j 1 for j 1 2 so σ 2 n 2 a σ 1 n 2 b where a δ 1 2 b 2 α 2 1 δ 2 2 b 1 α 1 1 α 2 b 2 l γ 2 α 1 b 1 γ 2 0 b b 2 α 2 1 b 1 α 1 1 4 δ 2 2 b 1 α 1 1 without loss of generality assume that b 0 then σ 1 n σ 2 n σ 1 n 1 a b σ 1 n 2 σ 1 n σ 2 n σ 1 n 1 a b σ 1 n 2 δ 1 σ 1 n δ 2 σ 2 n δ 1 σ 1 n δ 2 σ 2 n δ 1 δ 2 a b σ 1 n 2 δ 1 δ 2 a b σ 1 n 2 r n with r n 1 furthermore using the above relations we set x n σ 1 n σ 2 n and p n x n σ 1 n σ 2 n where p n 1 a b σ 1 n 2 1 a b σ 1 n 2 with p n 1 thus we want to find x n 0 such that 5 1 sin x n r n sin p n x n 0 remark 1 notice that r n r δ 1 δ 2 a δ 1 δ 2 a a n d p n p 1 a 1 a a s σ 1 n thus x n x as σ 1 n with x governed by sin x r sin p x 0 where r 1 and p 1 a closer inspection of the two curves show that any x lies in ℓ π ℓ 1 π for some nonnegative integer ℓ the above remark gives a motivation for a possible initial guess to be used in a variant of newton s method of iteration to find x n 0 that satisfies 5 1 the procedure is listed in algorithm 1 remark 2 when b 0 then we may use the relation σ 1 n 2 1 a σ 2 n 2 b a a σ 2 n 2 b and it can be shown that x n σ 1 n σ 2 n satisfies sin x n r n sin p n x n 0 where r n δ 2 δ 1 a b σ 2 n 2 δ 2 δ 1 a b σ 2 n 2 p n 1 a b σ 2 n 2 1 a b σ 2 n 2 algorithm 1 can be appropriately modified for this case 6 solution strategy let ρ τ be a square integrable function in ω that is governed by 6 1 1 α j b j 2 ρ z τ z 2 1 b j ρ z τ z 0 in ω j j 1 2 ρ 0 τ k s 1 exp α 1 g 0 ρ l τ k s 2 exp α 2 g l the general solution to the differential equation in 6 1 is 6 2 ρ z τ c 1 τ c 2 τ exp α 1 z z ω 1 d 1 τ d 2 τ exp α 2 z l z ω 2 we then formally write 6 3 r z τ n 1 c n τ exp λ n τ ϕ n z ρ z τ using the last equation in 3 1 and taking advantage of the last equation in 4 1 yields 6 4 1 α 1 ρ z γ τ ρ γ τ 1 α 2 ρ z γ τ ρ γ τ and thus c 1 τ d 1 τ using this fact when imposing the boundary condition of ρ τ at z 0 and z l 6 5 c 1 τ c 2 τ k s 1 exp α 1 g 0 d 2 τ c 2 τ k s 2 exp α 2 g l k s 1 exp α 1 g 0 d 1 τ c 2 τ k s 1 exp α 1 g 0 the third and fourth equations in 3 1 yield 6 6 n 1 c n τ exp λ n τ ϕ n γ m 1 c 2 τ f 1 ζ τ n 1 c n τ exp λ n τ ϕ n γ m 2 c 2 τ f 2 ζ τ where m 1 exp α 1 γ 1 m 2 exp α 2 γ l 1 f 1 ζ k s 1 exp α 1 ζ exp α 1 g 0 f 2 ζ k s 2 exp α 2 ζ exp α 2 g l γ l k s 1 exp α 1 g 0 1 exp α 2 γ l currently there are 3 unknowns namely c n τ c 2 τ ζ τ and two equations in 6 6 to provide the additional equation we take various derivatives of r in 6 3 put them back into the pde i e imposing the first equation in 3 1 perform appropriate rearrangement and use the ode in 4 1 to get n 1 c n τ exp λ n τ ϕ n z ρ z τ t 0 z γ due to the orthogonality of the eigenfunctions this then implies c n τ exp λ n τ ρ n τ where ρ n τ ρ τ ϕ n ϕ n ϕ n p 1 n c 1 τ p 2 n c 2 τ q 1 n d 1 τ q 2 n d 2 τ i n c 2 τ j n and p 1 n 1 ϕ n γ ϕ n ϕ n p 2 n exp α 1 z ϕ n γ ϕ n ϕ n q 1 n 1 ϕ n γ ϕ n ϕ n q 2 n exp α 2 z l ϕ n γ ϕ n ϕ n i n p 2 n q 2 n p 1 n q 1 n j n p 1 n q 1 n k s 1 exp α 1 g 0 q 2 n k s 2 exp α 2 g l k s 1 exp α 1 g 0 thus ρ n τ i n c 2 τ by utilizing the initial condition 3 2 in 6 3 we set 6 7 c n 0 κ u 0 ρ 0 ϕ n ϕ n ϕ n κ n ρ n 0 κ n i n c 2 0 j n where κ n κ u 0 ϕ n ϕ n ϕ n the complete representation of r z τ and ζ τ are achieved once 6 8 c n τ c 2 τ ζ τ are calculated from the following initial value problem involving a system of differential algebraic equations 6 9 c n τ exp λ n τ i n c 2 τ c n 0 i n c 2 0 κ n j n n 1 c n τ exp λ n τ ϕ n γ m 1 c 2 τ f 1 ζ τ n 1 c n τ exp λ n τ ϕ n γ m 2 c 2 τ f 2 ζ τ in the next two subsections we discuss two different approximations 6 1 first approximation notice that exp λ n τ 1 at the initial stage of the infiltration i e when τ is still near 0 with this condition the ode in 6 9 implies c n τ i n c 2 τ which further yields c n τ i n c 2 τ constant from the initial condition we conclude that 6 10 c n τ i n c 2 τ κ n j n this approximation can be inserted to the second and third equations in 6 9 to yield a system of algebraic equations governing c 2 τ ζ τ 6 11 s τ m 1 c 2 τ q τ f 1 ζ τ s τ m 2 c 2 τ q τ f 2 ζ τ where s τ n 1 i n exp λ n τ ϕ n γ and q τ n 1 κ n j n exp λ n τ ϕ n γ furthermore as the infiltration reaches a steady state i e as τ it can be inferred that s τ 0 and q τ 0 this means that 6 11 can still be used the above approach may not be suitable for middle range τ i e for infiltration stage that is transient in between the initial stage and the steady state for that the next approximation is appropriate 6 2 second approximation we perform the following finite difference approximation c n τ exp λ n τ c n τ c n τ δ τ δ τ exp λ n τ i n c 2 τ i n c 2 τ c 2 τ δ τ δ τ so that 6 12 c n τ exp λ n τ i n c 2 τ c n τ δ τ exp λ n τ i n c 2 τ δ τ for τ 0 and δ τ 0 we solve the following algebraic systems 6 13 s m 1 c 2 τ q τ f 1 ζ τ s m 2 c 2 τ q τ f 2 ζ τ where s n 1 i n ϕ n γ and q τ n 1 c n τ δ τ exp λ n τ ϕ n γ s c 2 τ δ τ for τ 0 we solve s m 1 c 2 0 n 1 κ n j n ϕ n γ f 1 ζ 0 s m 2 c 2 0 n 1 κ n j n ϕ n γ f 2 ζ 0 in practice for either of these approximations one must use a truncated version of the representation namely a finite series with a fixed number of terms n the whole procedure is laid out in algorithm 2 7 a brief discussion on the convergence of the solution according to algorithm 2 there are several sources of errors committed in the procedure the first one is due to the finite number n of eigenfunctions used in the representation the second one relates to the treatments that distinguishes the first and second approximations in this case early stage infiltration assumption versus finite difference for derivative the third one is on the recognition that the algebraic system in either of the approximations is nonlinear for which an iterative technique must be employed ignoring the latter we first would like to see what happen when n first we see that r n z τ already satisfies the pde and the respective conditions in 3 1 however it does not exactly satisfy the initial condition 3 2 thus error associated with the finite number of terms in the eigenfunctions expansion is originated from the discrepancy in the initial condition 7 14 e n κ u 0 n 1 n c n 0 ϕ n ρ 0 0 taking the scalar product 0 e n e n κ u 0 ρ 0 κ u 0 ρ 0 n 1 n c n 0 2 ϕ n ϕ n where 6 7 and the orthogonality of ϕ n have been used this yields n 1 n c n 0 2 ϕ n ϕ n κ u 0 ρ 0 κ u 0 ρ 0 c max ω κ u 0 z ρ z 0 2 d z this indicates that as n is made larger the series in the representation of r n remains bounded and converges to its supremum as n which is κ u 0 ρ 0 the error associated with using truncated series to represent the initial condition is propagated in time however it is expected that this error should diminish as τ i e as the solution approaches its steady state furthermore the finite difference in the second approximation has a truncation error with respect to δ t so that c n τ c n τ δ τ δ τ exp λ n τ c n τ exp λ n τ o δ τ i n c 2 τ c 2 τ δ τ δ τ i n c 2 τ o δ τ thus the error in the second approximation is expected to asymptotically behave as o n r o δ τ for some r 0 this means the second approximation can be made as accurate as one wishes by increasing n and by reducing δ t this is not the case in the first approximation while it is possible to reduce the error component from the truncation in the representation by making n larger the assumption exp λ n τ 1 will be considerably violated as τ is further away from 0 and cannot be remedied 8 problem with different boundary conditions the solution strategy laid out in the previous sections is immediately applicable when richards equation is supplied with different boundary conditions in this section we list the corresponding results when the boundary conditions are 8 1 κ u z u z 0 t g 0 and u l t g l the eigenfunction ϕ n now satisfies the boundary conditions 1 α 1 ϕ n 0 ϕ n 0 0 and ϕ n l 0 which yields ϕ n z β n exp 0 5 α 2 α 1 γ 0 5 α 1 z 2 μ 1 n α 1 cos μ 1 n z sin μ 1 n z z ω 1 exp 0 5 α 2 z sin μ 2 n l z z ω 2 where β n sin μ 2 n l γ 2 μ 1 n α 1 cos μ 1 n γ sin μ 1 n γ setting σ 1 n μ 1 n γ and σ 2 n μ 2 n l γ σ 1 n σ 2 n is governed by δ 2 σ 2 n sin σ 1 n cos σ 2 n δ 1 σ 1 n cos σ 1 n sin σ 2 n 2 δ 1 σ 1 n δ 2 σ 2 n cos σ 1 n cos σ 2 n δ 1 σ 1 n sin σ 1 n sin σ 2 n 0 furthermore defining x n σ 1 n σ 2 n it is governed by sin x n ψ n r n sin p n x n ψ n where r n and p n are as in algorithm 1 and ψ n tan 1 σ 1 n δ 1 2 notice that ψ n π 2 as σ 1 n and upon inspection of the two curves we may use n 1 π π 2 as initial guess for x n n 1 the function ρ τ expressed in 6 2 will have to satisfy 1 α 1 ρ z 0 τ ρ 0 τ g 0 and ρ l τ k s 2 exp α 2 g l imposing this and 6 4 we get c 1 τ g 0 d 1 τ g 0 d 2 τ g 0 k s 2 exp α 2 g l lastly we obtain c n τ c 2 τ ζ τ from solving 6 9 where in this case m 1 exp α 1 γ m 2 0 f 1 ζ k s 1 exp α 1 ζ g 0 f 2 ζ k s 2 exp α 2 ζ g 0 g 0 k s 2 exp α 2 g l exp α 2 γ l i n p 2 n j n p 1 n q 1 n g 0 q 2 n g 0 k s 2 exp α 2 g l 9 examples and discussions in this section we give several examples of richards equation in two layered soils that have exponential constitutive relations as described in the previous section details of the physical data are given in table 1 a validation of this semi analytical procedure is conducted by comparing the results with a numerical technique performed by finite volume finite difference method on dense spatial and temporal grids the one dimensional soil is discretized into 1000 intervals where the interface location is placed at the nodal points given τ 0 the time span 0 τ is discretized into 5000 time intervals the resulting nonlinear algebraic equations are solved using the modified picard iteration as described in celia et al 1990 as listed in table 1 there are two boundary conditions we observe here the first three examples use boundary conditions given in 2 2 and the remaining examples use boundary condition given in 8 1 the eigenfunction representation is given in fig 1 to see how they behave with respect to different boundary conditions the profiles of the pressure head u and the water content θ to these examples at several τ are shown in figs 2 to 7 in which the semi analytic solutions are plotted by using n 10 000 of eigenfunctions and the first approximation 6 11 is utilized the initial pressure head profile for example 1 is assumed to be a linear function that honor the pressure values at the boundary i e 9 2 u 0 z g l g 0 z l g 0 meanwhile the initial condition for examples 2 and 3 is a constant function as given in table 1 for examples 4 and 5 the initial pressure is also assumed to be linear a different treatment is done for examples 6 and 7 where in this case the effect of the interface is considered to be involved at the initial time the initial pressure for examples 6 and 7 is assumed to be a steady state profile with the infiltration rate i r 0 01 m h and i r 0 1 cm h respectively resulting in 9 3 u 0 z 1 α 1 ln i r c 2 0 exp α 1 z k s 1 z ω 1 1 α 2 ln i r d 2 0 exp α 2 z l k s 2 z ω 2 where d 2 0 i r k s 2 exp α 2 g l c 2 0 exp α 1 γ k s 1 i r d 2 0 exp α 2 γ l k s 2 α 1 α 2 i r the infiltration rate is then increased for time greater than zero it is observed from figs 2 to 7 that in general the semi analytical procedure constructed from the first approximation 6 11 produces solutions that are in a good agreement with the finite volume method simulation there is a noticeable discrepancy at several transient time instances which is attributed to the fact that the assumption exp λ n τ 1 does not hold anymore nonetheless this discrepancy can be alleviated by using the second approximation 6 13 and the solutions match really well the finite volume solutions as seen in those figures the error of the hydraulic conductivity is recorded by calculating the discrepancy in the initial condition due to the finite number n of eigenfunctions that is used in the representation as discussed in section 7 fig 8 shows the norm error of e n where is a usual norm for any square integrable functions in ω generated from 4 9 the number of eigenfunctions are n 250 500 1000 2000 4000 8000 16 000 these errors show a convergence rate 1 5 as n gets larger but the rate of convergence is lower in examples 2 and 3 due to the incompatibility of the initial conditions and the boundary values the computational times are recorded in table 2 as to compare the average amount of time needed to produce the figures of the pressure head profiles these solutions were run from a computer with processor intel r core tm i5 10500 3 10 ghz apparently the semi analytical procedure only needs about one second to obtain the similar quality of the overkill solutions produced by finite volume method indeed it is more desirable in terms of time efficiency lastly we calculate the relative difference to observe the time history of discrepancy between the semi analytical solution and the finite volume solution of pressure head define relative difference at τ u n τ fvm sol τ fvm sol τ 100 fig 9 shows the relative difference of the pressure head for all examples at some fixed τ until it reaches a steady state condition the plots in this figure demonstrates a consistent behavior of the semi analytical solution procedure in general the first approximation works reasonably well as indicated by the relative differences to the fvm numerical simulations that are below 5 except for example 4 which is a drainage case as expected the larger amount of relative differences is in particular occurring at the transient stage where the assumption exp λ n τ 1 is no longer maintained however especially when τ is still closer to 0 the first approximation exhibits a very similar quality to any second approximation in which time derivative is incorporated into the system since inclusion of the derivative entails a time marching which makes the procedure more expensive it can be argued that the first approximation would strike a balance between accuracy and efficiency for finding solutions at such τ similar behavior is true when τ is approaching the steady state still one can find the advantage of using the second approximation when τ represents a transient stage where discrepancy associated with the first approximation cannot be alleviated as shown by the three cases of δ τ in each plot it is a possible to reduce the discrepancy consistently by reducing this time step this is specifically more relevant in example 4 which models a drainage clearly the first approximation does not quite perform as well as in the other examples however the second approximation has the capability to decrease the discrepancy in example 4 it should be noted that modeling drainage can be quite challenging due to the possibility of entering a degenerate regime for which standard simulations can fail in the interest of lending an enhanced credibility to the proposed semi analytical approach we provide example 7 with α 1 α 2 in fig 10 that compares the approach of srivastava and jim yeh 1991 and the overkill finite volume the profiles in this figure confirm that indeed the proposed semi analytical approach matches very well the other solutions 10 conclusion and future work the development in this paper is motivated by the need for some benchmark richards equation problems on layered soil for which analytical solutions can be constructed this in particular is beneficial in testing the robustness and reliability of some numerical methods that are designed for problems of this type comparison of the developed strategy with a standard finite volume approximation indicates a close similarity of the solutions the strategy is flexible to different boundary conditions several items are to be investigated in the future albeit the mathematical intricacies it is expected that the proposed method can be straightforwardly derived to handle infiltration in a soil having more than two layers it is of interest to see how the proposed method can be adapted to handle boundary conditions with time varying boundary values as alluded to in the introduction the authors are currently investigating the application of generalized finite element methods to approximate solution of richards equation on layered soil system availability of analytical solutions as presented in this paper is instrumental in establishing the accuracy of these numerical methods declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment all authors approved the version of the manuscript to be published appendix other nontrivial eigenfunctions recall the derivation in section 4 for solving 4 1 is based on the assumption that 1 4 b j α j 1 λ n 0 for j 1 2 a direct calculation would confirm that cases when 1 4 b j α j 1 λ n 0 for j 1 2 yield only a trivial solution i e ϕ n 0 in ω in what follows we list two other possible nontrivial eigenfunctions that may occur depending on the soil data configuration following the derivation in section 4 we use ν j n α j 2 1 4 b j α j 1 λ n and μ j n α j 2 4 b j α j 1 λ n 1 j 1 2 a 1 case 1 4 b 2 α 2 1 λ n 0 and 1 4 b 1 α 1 1 λ n 0 this yields μ 1 n 0 and ν 2 n 0 and α 1 4 b 1 λ n α 2 4 b 2 the solution of 4 1 is ϕ n z c 2 exp 0 5 α 1 z sin μ 1 n z z ω 1 d 2 exp 0 5 α 2 z sinh ν 2 n l z z ω 2 imposing the continuity of the solution and its flux at γ yields a linear system governing c 2 d 2 c 2 exp 0 5 α 1 γ sin μ 1 n γ d 2 exp 0 5 α 2 γ sinh ν 2 n l γ 0 c 2 μ 1 n α 1 exp 0 5 α 1 γ cos μ 1 n γ d 2 ν 2 n α 2 exp 0 5 α 2 γ cosh ν 2 n l γ 0 whose determinant is det exp 0 5 α 1 α 2 γ ν 2 n α 2 sin μ 1 n γ cosh ν 2 n l γ μ 1 n α 1 cos μ 1 n γ sinh ν 2 n l γ since l γ we have sinh ν 2 n l γ 0 and cosh ν 2 n l γ 0 so it is possible for the determinant to be zero when there is μ 1 n γ such that sin μ 1 n γ and cos μ 1 n γ have different sign in particular for any m 0 1 2 π 2 2 m π α 1 γ 2 4 b 1 α 1 1 λ n 1 2 m 1 π or 3 π 2 2 m π α 1 γ 2 4 b 1 α 1 1 λ n 1 2 m 1 π under the constraint that α 1 4 b 1 λ n α 2 4 b 2 a 2 case 1 4 b 2 α 2 1 λ n 0 and 1 4 b 1 α 1 1 λ n 0 this yields ν 1 n 0 and μ 2 n 0 and α 2 4 b 2 λ n α 1 4 b 1 the solution of 4 1 is ϕ n z c 2 exp 0 5 α 1 z sinh ν 1 n z z ω 1 d 2 exp 0 5 α 2 z sin μ 2 n l z z ω 2 imposing the continuity of the solution and its flux at γ yields a linear system governing c 2 d 2 c 2 exp 0 5 α 1 γ sinh ν 1 n γ d 2 exp 0 5 α 2 γ sin μ 2 n l γ 0 c 2 ν 1 n α 1 exp 0 5 α 1 γ cosh ν 1 n γ d 2 μ 2 n α 2 exp 0 5 α 2 γ cos μ 2 n l γ 0 whose determinant is det exp 0 5 α 1 α 2 γ μ 2 n α 2 sinh ν 1 n γ cos μ 2 n l γ ν 1 n α 1 cosh ν 1 n γ sin μ 2 n l γ it is possible for the determinant to be zero when there is μ 2 n l γ such that sin μ 2 n l γ and cos μ 2 n l γ have the different sign in particular for any m 0 1 2 π 2 2 m π α 2 l γ 2 4 b 2 α 2 1 λ n 1 2 m 1 π or 3 π 2 2 m π α 2 l γ 2 4 b 2 α 2 1 λ n 1 2 m 1 π under the constraint that α 2 4 b 2 λ n α 1 4 b 1 
134,although global and catchment scale hydrological models are often shown to accurately simulate long term runoff time series far less is known about their suitability for capturing hydrological extremes such as droughts here we evaluated simulations of hydrological droughts from nine catchment scale hydrological models chms and eight global scale hydrological models ghms for eight large catchments upper amazon lena upper mississippi upper niger rhine tagus upper yangtze and upper yellow the simulations were conducted within the framework of phase 2a of the inter sectoral impact model intercomparison project isimip2a we evaluated the ability of the chms ghms and their respective ensemble means ens chm and ens ghm to simulate observed hydrological droughts of at least one month duration over 31 years 1971 2001 hydrological drought events were identified from runoff deficits and the standardised runoff index sri in all catchments the chms performed relatively better than the ghms for simulating monthly runoff deficits the number of drought events identified under different drought categories i e sri values of 1 to 1 49 1 5 to 1 99 and 2 varied significantly between models all the models as well as the two ensemble means have limited abilities to accurately simulate drought events in all eight catchments in terms of their occurrence and magnitude overall there are opportunities to improve both chms and ghms for better characterisation of hydrological droughts keywords global hydrological models catchment hydrological models hydrological droughts model evaluation model validation isimip 1 introduction a drought is an event where water availability is lower than normal resulting in a failure to fulfil the water demands of different natural systems and socioeconomic sectors wmo 1986 from 1991 to 2005 950 million people were affected by droughts worldwide and economic damage of 100 billion us dollars was reported un and unisdr undp i 2009 droughts are usually the consequence of a prolonged period of below normal precipitation that also affects many other environmental climate and socio economic variables lloyd hughes 2014 van loon 2015 drought can be difficult to identify in space and time which makes it one of the most complex natural hazard wilhite 1993 wilhite et al 2000 researchers managers and policy makers quantify drought events using drought indices based on climate data reviewed in heim 2002 keyantash and dracup 2002 mishra and singh 2010 whilst precipitation is a key input to calculate these indices other climate and environmental variables that affect water storage and availability are also significant droughts are complex natural disasters as their onset and magnitude are related to the interaction between many hydrological and climatological processes droughts can be classified into different types namely meteorological hydrological agricultural and socioeconomic droughts meteorological droughts represent below normal precipitation and are mainly presented by precipitation driven indices such as the standardised precipitation index spi mckee et al 1993 regional drought area index rdai fleig et al 2011 and effective drought index edi byun and wilhite 1999 in contrast hydrological droughts define effects on freshwater storage which are represented by indices that use stream flows reservoir levels groundwater levels or other similar variables hydrological droughts are often closely related to meteorological droughts and can also be exacerbated by environmental changes anthropogenic activities and mismanagement of water resources tallaksen et al 2004 studies on hydrological droughts at global or continental scales increasingly use land surface models lsms global hydrological models ghms and catchment scale hydrological models chms to quantify and predict drought events gosling zaherpour et al 2017 hattermann et al 2017 ghms lsms and chms have been widely used to model flood hazards and risk arnell and gosling 2016 climate change mitigation irvine et al 2017 forecasting at shorter time scales emerton et al 2016 and food security elliott et al 2014 the use of these models to study droughts is also relatively common van huijgevoort et al 2013 prudhomme et al 2014 but there is relatively less information on the performance of the models for simulating drought given the societal significance of drought prediction under climate change scenarios pokhrel et al 2021 using these tools and the influence of results on climate change adaptation and mitigation decision making it is critical to understand their strengths and limitations when specifically focusing on drought assessment and prediction whilst some studies have assessed the ability of multiple chms huang et al 2017 and ghms zaherpour et al 2018 to simulate historical low flows there has to date been no study that compares the performance of chms and ghms with a focus on drought characteristics thus the main novelty of this study is that it is the first cross scale model evaluation of drought event frequency intensity severity and duration together referred to as droughts hereafter this was achieved through the computation of observed and simulated runoff deficits and the standardised runoff index sri the main objective of this study was to systematically evaluate the performance of several global scale and catchment scale hydrological models to simulate droughts we also discuss the opportunities for improving the simulation of drought events by both ghms and chms 2 data 2 1 study catchments eight large 65 000 km2 catchments were selected to cover diverse climate zones and hydrological systems around the globe these were the upper amazon lena upper mississippi upper niger rhine tagus upper yangtze and upper yellow fig 1 the same eight catchments used in previous ghm chm comparisons gosling et al 2017 hattermann et al 2017 for the analysis only the upper part of the amazon mississippi niger yangtze and yellow were modelled due to their complicated geomorphological structure and human alterations further downstream krysanova and hattermann 2017 catchment boundaries were defined according to drainage direction maps at 30 ddm30 döll and lehner 2002 for the ghms and chms and according to the global runoff data centre grdc http grdc bafg de for the observed data 2 2 models and input data we used chm and ghm simulations from isimip2a gosling et al 2017 to identify historical drought events from their respective monthly runoff simulations and evaluated how these droughts compared to the observed record the simulations are the most up to date opportunity that exists to robustly and consistently compare the performance of several chms and ghms simulated runoff data from nine chms and eight ghms along with corresponding observed runoff data from the grdc for 1971 2001 were used in this study observed monthly runoff data was acquired from the most downstream gauge in the grdc catalogue for each catchment all ghms and chms were run with daily input climate data from watch era 40 weedon et al 2011 for the period 1971 2001 which we aggregated to monthly temporal resolution output from the models is openly available from the earth system grid federation esgf https esg pik potsdam de search isimip for the ghms gosling et al 2017 and the chms krysanova et al 2017 all the ghms provided outputs for all catchments however the number of chms with simulated runoff varied by catchment table 1 following the method described by haddeland et al 2011 monthly observed and simulated runoff data was converted to catchment mean monthly runoff by using the area upstream of the gauge according to the ddm30 river network thus an area correction factor was applied to the grdc runoff data to account for the fact that the river network which is at 0 5 spatial resolution may not perfectly overlap with the grdc river catchment boundaries table 1 both chms and ghms simulate the full hydrological cycle with predominantly daily precipitation and temperature as input data all the ghms simulated hydrological processes at a spatial resolution of 0 5 x 0 5 across the global land surface in contrast chms operated using various approaches three chms run on a grid mhm vic watergap3 four by splitting the catchment into sub catchments and smaller hydrological response units hbv hype swat swim and one by considering the whole catchment as a single entity hymod the ghms were not calibrated to catchment specific conditions except watergap2 which was calibrated against long term average annual streamflow for 1319 gauges worldwide while the chms were calibrated and the performance of the calibration evaluated in a separate validation period using the watch era 40 climate forcing data huang et al 2017 in addition to the individual model results we calculated the corresponding ensemble mean using monthly runoff values for the ghms denoted ens ghm and chms ens chm for every catchment and included them in the analysis sm 1 all the calculations of runoff deficits and sri for ens ghm and ens chm are based on ensemble monthly runoff values for the purposes of this study all the models were treated as independent even though some of the models employ similar model parameterisations for some hydrological processes no hydrological model was excluded or weighted based on their ability to simulate runoff 3 method 3 1 runoff deficit we calculated runoff deficit values based on a variable threshold and compared the simulated runoff deficit with observed values the threshold was defined as the 80th exceedance percentile runoff for each month separately a value between the 70th and 95th percentile commonly used for perennial rivers hisdal et al 2001 andreadis et al 2005 fleig et al 2006 tallaksen et al 2009 van loon 2015 a positive runoff deficit indicates dry conditions i e when the runoff falls below the threshold value 3 2 standardised runoff index sri several standardised indices have been developed for identifying hydrological droughts such as the palmer hydrological drought index pdhi jacobi et al 2013 water supply index wsi garen 1993 and standardised streamflow runoff index ssi sri vicente serrano et al 2012 in comparison with phdi and wsi ssi is more commonly accepted because it is simple to calculate can be used on various time scales and requires fewer inputs ssi is extensively used in many studies shukla and wood 2008 vicente serrano et al 2012 wu et al 2018 liu et al 2019 calculation of ssi sri is similar to that of standardised precipitation index spi proposed by mckee et al 1993b but considering runoff instead of precipitation the sri values are determined based on long term runoff records preferably 30 years by aggregating the monthly runoff over an accumulation period 1 3 6 12 or 24 months the new series formed after accumulation 1 month for this study is then fitted to a probability distribution that subsequently is transformed to a normal distribution such that the mean sri is zero we tested three different probability distributions gamma normal and weibull to see which had the best fit to observed runoff the gamma distribution was the best fit for all eight catchments sm 2 and was used for all the sri calculations the spei package in r beguería and vicente serrano 2017 was used for the calculations of sri spei i e standardized precipitation evapotranspiration index package facilitates computation of spi and other variants of spi sri in our study by providing defined functions that can be used directly in the r working environment any positive sri values indicate runoff values greater than the mean monthly runoff and vice versa sri values less than 1 were considered to indicate drought conditions these drought conditions were categorised based on sri values into three drought categories moderate severe and extreme droughts sri values from 1 to 1 49 indicate moderate drought from 1 5 to 1 99 severe drought and all the sri values less than 2 indicate extreme drought mckee et al 1993a lloyd hughes and saunders 2002 mishra et al 2007 bloomfield and marchant 2013 wasko et al 2021 3 3 drought characteristics and performance evaluation sri drought events drought events based on sri values were defined as temporally continuous sri values 1 lasting until the sri is above 1 again runoff deficit drought events drought events based on runoff deficit values were defined as temporally continuous positive runoff deficit values lasting until it is zero or less we calculated three drought characteristics for both runoff deficit and sri drought events from the observed and simulated data drought intensity or severity in case of runoff deficit drought events drought duration and frequency of drought events run theory yevjevich and ica yevjevich 1967 was used for the extraction of drought characteristics from the sri and runoff deficit time series the run theory method is based on a threshold level approach which considers the statistical properties of runs here length of negative or positive deviations in sri or runoff deficit values respectively above or below a given threshold level the drought duration in months was taken as the period in months for which the sri remained less than a threshold value of 1 or runoff deficit was greater than a threshold value of 0 the minimum sri value in the drought period was used as the drought intensity for sri drought events while the collective sum of all positive runoff deficits over the drought period was taken as drought severity for runoff deficit drought events we used the coefficient of determination i e the square of pearson product moment correlation coefficient r2 and the nash sutcliffe efficiency coefficient nse nash and sutcliffe 1970 to evaluate the goodness of fit between observed and simulated runoff deficits and sri values for each chm ghm and the ens chm and ens ghm r2 indicated the strength of relationship between the simulated and observed runoff and nse indicated the models efficiency range ꝏ 1 nse values approaching 1 indicate a perfect match of simulated and observed runoff values while negative values show that the observed mean is a better predictor than the model 4 results 4 1 comparison of observed and simulated runoff deficits table 2 shows the r2 and nse values for all the chms and ghms as well as the ens chm and ens ghm an r2 value 0 7 was interpreted as satisfactory model performance as was an nse 0 70 following moriasi et al 2007 2015 for all eight catchments the chms were better than ghms for the estimation of monthly runoff deficits because the r2 values for ens chm were higher than those for ens ghm both ensembles performed well in four catchments according to r2 because the ens chm and ens ghm r2 values were greater than 0 7 moriasi et al 2007 2015 the upper mississippi rhine tagus and upper yellow nse values for ens chm were greater than 0 7 for five catchments and closer to 1 for the rhine and tagus catchments while for ens ghm only two catchments upper mississippi and tagus had nse values greater than 0 7 all individual chms that simulated runoff for the rhine tagus and upper yangtze catchments had r2 and nse values 0 70 except watergap3 for the tagus catchment achieving 0 77 r2 and 0 60 nse both the r2 and nse values were 0 70 for all other catchments the only exception being mhm for the upper mississippi and upper yellow catchments none of the individual chms or ghms had consistently satisfactory r2 and nse values across all catchments the rhine and tagus catchments had individual ghms with r2 values 0 70 for over half the models but with unsatisfactory nse values in addition the upper amazon lena and upper niger catchments had no individual ghms with r2 or nse values 0 70 individual ghms showed good performance in the tagus catchment where both indicators were 0 70 4 2 comparison of observed and simulated sri r2 and nse values for the sri series are displayed in table 3 both r2 and nse vary widely across all catchments for both chms and ghms the r2 values of the ensemble series varied between 0 18 ens ghm upper niger and 0 94 ens chm rhine while the nse ranged from 0 14 ens ghm upper niger to 0 95 ens chm rhine for only three catchments ens chm had r2 and nse values 0 70 and ens ghm for only two the catchments where most of the models both chms and ghms performed well were the upper mississippi and rhine both with r2 and nse values for ens chm and ens ghm 0 85 for both these catchments individual models always achieved r2 0 50 and nse values 0 40 no individual chm or ghm achieved r2 and nse values 0 7 for the other six catchments with the exception of hbv for the tagus catchment r2 0 75 and nse 0 74 the catchment where all the models performed the worst was the upper niger where no individual ghm or chm except swim achieved an r2 value 0 35 and nse values were always close to or below zero 4 3 evaluation of the frequency of drought events table 4 presents the number of runoff deficit and sri drought events identified from the observed and simulated runoff ens chm and ens ghm for all eight catchments the total number of individual drought events identified by ens ghm and ens chm were comparable in most catchments for all eight catchments 136 individual sri drought events were identified from the observed data and the ensemble models successfully simulated 133 and 123 drought events for ens ghm and ens chm respectively similarly ens ghm and ens chm successfully simulated 233 and 220 individual drought events respectively from 244 individual runoff deficit drought events identified from observed records ens chm and ens ghm performed similarly in their estimation of the number of drought events for most catchments with five catchments differing by 6 or less runoff deficit drought events and only by 2 or less sri drought events for half of the catchments the number of sri drought events estimated by the ens ghm was closer to the observed data than the ens chm simulations while for observed runoff deficit drought events estimation by the ens chm was better in the majority of catchments despite the comparable estimates of the total number of sri and runoff deficit drought events across most catchments both ens chm and ens ghm struggled in estimating the frequency of droughts within sri drought categories both ens chm and ens ghm underestimated the number of extreme sri droughts 2 in the upper amazon upper niger and tagus catchments while in the upper yellow catchment ens chm and ens ghm both overestimated the number of extreme sri droughts showing 3 and 4 extreme events respectively when no such sri drought events were identified in the observed data 4 4 evaluation of drought intensity fig 2 and sm 3 supplementary materials show extreme sri and severe runoff deficit drought events respectively and the performance of individual models in representing these events with regards to drought intensity or severity along with drought duration substantial variation was seen in the ability of individual chms and ghms to simulate drought intensity or severity the over or under estimation of drought intensity in fig 2 drought severity in sm 3 shown as colour coded cells from shades of green to brown is based on the difference in estimated and observed drought intensity or severity there are marked differences across catchments in whether the models over or under estimated the intensity or severity of observed droughts and in the ability to simulate the very occurrence of an observed drought itself we observed cases where ensemble models simulated a drought that never occurred in the observed record and cases where a model fails to simulate a drought that occurred in the observed record in most catchments for extreme sri and severe runoff deficit drought events out of the 27 observed extreme sri drought events across all catchments ens chm and ens ghm failed to identify 1 and 3 drought events respectively in total 14 extreme sri drought events were identified by the models which were not observed shaded grey under observed in fig 2 and 5 of these events were identified by both ens chm and ens ghm for the upper amazon individual chms and ghms performed similarly with most models under estimating drought intensity for 6 of the observed extreme sri drought events for one event in the upper amazon an observed sri drought event went undetected by 10 out of 17 models all the individual models did not accurately simulate hydrological conditions in the upper yellow catchment with 4 extreme drought events simulated that were not observed in reality model performance is more nuanced in the other catchments with some observed droughts within a catchment under estimated and other events over estimated upper niger rhine and upper yangtze ens chm and ens ghm each failed to identify 12 drought events across all eight catchments from 70 observed severe runoff deficit droughts sm 3 supplementary material in addition to 70 observed severe runoff deficit drought events 19 additional runoff deficit drought events were identified by the models which were not observed and 9 of these additional events were identified as severe runoff deficit drought events by both ens ghm and ens chm performance of chms and ghms was analogous in estimating drought severity across all catchments however there were fewer cases in chms than ghms where observed severe runoff deficit drought events were identified only by one individual model two runoff deficit drought events went undetected by all individual models in the upper yellow catchment 4 5 evaluation of drought duration for all the observed runoff deficit and sri drought events independently under each drought category i e moderate severe and extreme for sri droughts events we calculated the absolute error in drought duration for each model the mean of all the absolute errors under each drought category for sri droughts events for a model yielded the mean absolute error mae for that model figs 3 and 4 shows the mae values for sri under the three drought categories and runoff deficit drought events respectively from the ens chm and ens ghm for every catchment along with their respective mean observed drought duration sm 4 supplementary materials presents mae values for the individual models averaged across all catchments for both sri and runoff deficit drought events for sri droughts the largest total mae i e the mae summed across the three drought categories was seen for upper niger for both ensembles followed by upper mississippi for ens chm and upper amazon for ens ghm fig 3 both ensembles display mae s smaller than all individual models sm 4 for extreme sri droughts across all three drought categories the models simulate drought duration for extreme sri droughts better than for lower intensity sri droughts fig 3 however for sri drought events overall both the chms and ghms struggle to accurately model drought duration with mae consistently 1 month sm 4 for runoff deficit droughts the mae was similar between ens chm and ens ghm except for the lena with a difference of 1 month between the two ensembles fig 4 maes were generally lower for runoff deficit droughts than for sri droughts 5 discussion the aim of this study was to assess the performance of chms and ghms in simulating observed drought events using runoff deficit and sri as indicators of hydrological drought no two drought events are the same and as such drought events cannot be judged based on a single characteristic here we used three characteristics the intensity or severity duration and frequency of drought events we used r2 and nse to judge the ability of the models and their ensemble means to replicate observed monthly runoff deficits and sri 5 1 comparison of chm and ghm performance different thresholds defining runoff deficit droughts for each catchment meant there were not standard drought classes which limited the distinctive analysis of drought occurrences frequency of runoff deficit drought events was higher than that of sri drought events table 4 which resulted in almost consistent mean observed drought duration and very less variation was seen in the mae between ens chm and ens ghm across all catchments there was a marked difference in performance of chms and ghms when estimating drought intensity and duration with the sri this is owing to the data used for identifying simulated drought events which here is simulated monthly runoff data the accuracy of the sri computation is directly proportional to the quality of data used for its calculation hayes et al 1999 huang et al 2017 reported that chms accurately reproduced monthly runoff seasonal dynamics moderate or high flows but simulations of low flows were problematic in most catchments zaherpour et al 2018 found that the majority of ghms overestimated low flows considerably more than they overestimated high flows and that ghms overestimated minimum flow return periods the majority of the ghms showed a tendency for overestimating monthly runoff with a wider magnitude range veldkamp et al 2018 previous studies highlight that this wider spread around ensembles in every catchment is due to the structure of ghms haddeland et al 2011 gudmundsson et al 2012 physical processes such as transmission losses having less presence in the ghms is one main reason for some of the differences between simulated and observed runoff gosling and arnell 2011 in addition evapotranspiration simulation has been reported to vary widely among the ghms wartenburger et al 2018 5 2 performance of the ensemble means although the r2 and nse values for the sri series are less than satisfactory for many individual ghms and chms across catchments the ensemble models were better at estimating drought frequency for most of the catchments moreover both the ensembles display overall a better performance compared to the individual models that make up each respective ensemble and showed comparable outputs runoff deficit and sri values despite the ghms having a wider spread across the ensemble although the ghms used the same climate forcing they used different formulations to compute potential evapotranspiration telteu et al 2021 which contributes to differences in simulated runoff between the ghms beck et al 2017 for monthly runoff deficits the ens ghm outperformed individual ghms because the individual models over or under estimated low flow conditions the computation of an ensemble mean for the ghms essentially balances out the over and under estimation of runoff deficits by individual models however the use of a large number of models does not necessarily ensure better performance of the ensemble mean for the upper amazon upper mississippi and rhine where the number of models used for the ensemble calculation was higher the performance of the ens chm was better at estimating drought frequency but showed higher mae for drought duration with exception of the rhine 5 3 implications for model calibration the performance of watergap2 for runoff deficit estimation was similar to the other ghms despite watergap2 being the only ghm to be calibrated with long term annual river discharge it did not perform noticeably better than other ghms and independent of calibration the identification of hydrological extremes was not satisfactory across all models this suggests that it is important to calibrate models with high temporal resolution data that allows extreme events to be accounted for in the calibration process the use of multiple criteria during model calibration specifically for low or no flow could be helpful krysanova et al 2018 5 4 representation of processes and quality of observed data our results indicate relatively better performances of ghms for runoff deficits and sri patterns in the upper mississippi and rhine compared to other catchments furthermore none of the ghms missed any observed sri drought events while only few ghms failed to simulate observed runoff deficit drought events however tendency of ghms across all catchments towards simulating drought events that were not observed can be attributed to a dry bias introduced by the choice of potential evapotranspiration formulation for individual models for example pcr globwb consistently appeared near the dry end of ens ghm perhaps because it includes a temperature based evaporation formulation hamon that has been shown to induce a large bias when applied outside its calibration range milly and dunne 2017 in general for ghms it is difficult to estimate a drought event at the right time because multiple errors propagate from the inputs meteorological parameters and some ghms struggle to capture the magnitude and timing of processes like abstraction losses and snowmelt accurately which is likely to have an impact on drought timing initiation and duration of drought events for chms large biases have been reported in simulating low flow conditions across majority of the catchments we studied especially the upper yangtze huang et al 2017 inaccuracies of low flow observations may be a factor affecting the estimation of observed drought conditions as might river ice in some catchments while the inability of individual chms to replicate low flow or no flow may be due to the choice of objective functions for calibration of the chms huang et al 2017 similarities in performance of both sets of individual models in the upper amazon lena tagus and upper yangtze catchments for drought events in and sm 3 supplementary materials can likely be attributed towards the quality of the meteorological data used for simulations some studies have reported watch era 40 data to be unreliable due to inaccuracies in observed precipitation records caused by fog mist strauch et al 2017 watergap3 among all chms comparatively showed the weakest performance which may be attributed to fewer parameters used for model calibration compared to other chms 6 conclusion our study focused upon the effectiveness of catchment and global scale hydrological models to estimate drought conditions at the catchment scale for 8 large catchments we found comparably lower performance by most ghms in simulating monthly runoff deficits while chms and ghms were similar in estimating sri both sets of models show limited ability to simulate the finer more granular and detailed characteristics intensity or severity duration and frequency of observed droughts but the ensembles performed better compared to the individual models that make up each respective ensemble whilst the ens chm and ens ghm simulated drought frequency well for runoff deficit and sri drought events marked differences were observed in ability to simulate the occurrence of observed and simulated drought events not simulating several observed drought events and simulating drought events out of observed records for both the ensembles the error is overall smallest for duration of extreme sri droughts across all three drought categories however it can also be concluded that both chms and ghms struggled in accurately modelling drought duration for moderate and severe sri drought categories we believe that there is still room for improvement in runoff simulations to facilitate drought identification and accurate estimation of drought characteristics credit authorship contribution statement amit kumar investigation data curation writing original draft simon n gosling methodology data curation writing original draft writing review editing matthew f johnson methodology data curation writing original draft writing review editing matthew d jones methodology writing original draft writing review editing jamal zaherpour data curation writing original draft writing review editing rohini kumar writing original draft writing review editing guoyong leng writing original draft writing review editing hannes müller schmied writing original draft writing review editing jenny kupzig writing original draft writing review editing lutz breuer writing original draft writing review editing naota hanasaki writing original draft writing review editing qiuhong tang writing original draft writing review editing sebastian ostberg writing original draft writing review editing tobias stacke writing original draft writing review editing yadu pokhrel writing original draft writing review editing yoshihide wada writing original draft writing review editing yoshimitsu masaki writing original draft writing review editing declaration of competing interest the authors declare no conflict of interest funding the research was funded by the university of nottingham vice chancellor s scholarship for research excellence international availability of data and material output from the models used for this study are openly available from the earth system grid federation esgf https esg pik potsdam de search isimip for the ghms gosling et al 2017 and the chms krysanova et al 2017 code availability not applicable supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104212 appendix supplementary materials image application 1 
134,although global and catchment scale hydrological models are often shown to accurately simulate long term runoff time series far less is known about their suitability for capturing hydrological extremes such as droughts here we evaluated simulations of hydrological droughts from nine catchment scale hydrological models chms and eight global scale hydrological models ghms for eight large catchments upper amazon lena upper mississippi upper niger rhine tagus upper yangtze and upper yellow the simulations were conducted within the framework of phase 2a of the inter sectoral impact model intercomparison project isimip2a we evaluated the ability of the chms ghms and their respective ensemble means ens chm and ens ghm to simulate observed hydrological droughts of at least one month duration over 31 years 1971 2001 hydrological drought events were identified from runoff deficits and the standardised runoff index sri in all catchments the chms performed relatively better than the ghms for simulating monthly runoff deficits the number of drought events identified under different drought categories i e sri values of 1 to 1 49 1 5 to 1 99 and 2 varied significantly between models all the models as well as the two ensemble means have limited abilities to accurately simulate drought events in all eight catchments in terms of their occurrence and magnitude overall there are opportunities to improve both chms and ghms for better characterisation of hydrological droughts keywords global hydrological models catchment hydrological models hydrological droughts model evaluation model validation isimip 1 introduction a drought is an event where water availability is lower than normal resulting in a failure to fulfil the water demands of different natural systems and socioeconomic sectors wmo 1986 from 1991 to 2005 950 million people were affected by droughts worldwide and economic damage of 100 billion us dollars was reported un and unisdr undp i 2009 droughts are usually the consequence of a prolonged period of below normal precipitation that also affects many other environmental climate and socio economic variables lloyd hughes 2014 van loon 2015 drought can be difficult to identify in space and time which makes it one of the most complex natural hazard wilhite 1993 wilhite et al 2000 researchers managers and policy makers quantify drought events using drought indices based on climate data reviewed in heim 2002 keyantash and dracup 2002 mishra and singh 2010 whilst precipitation is a key input to calculate these indices other climate and environmental variables that affect water storage and availability are also significant droughts are complex natural disasters as their onset and magnitude are related to the interaction between many hydrological and climatological processes droughts can be classified into different types namely meteorological hydrological agricultural and socioeconomic droughts meteorological droughts represent below normal precipitation and are mainly presented by precipitation driven indices such as the standardised precipitation index spi mckee et al 1993 regional drought area index rdai fleig et al 2011 and effective drought index edi byun and wilhite 1999 in contrast hydrological droughts define effects on freshwater storage which are represented by indices that use stream flows reservoir levels groundwater levels or other similar variables hydrological droughts are often closely related to meteorological droughts and can also be exacerbated by environmental changes anthropogenic activities and mismanagement of water resources tallaksen et al 2004 studies on hydrological droughts at global or continental scales increasingly use land surface models lsms global hydrological models ghms and catchment scale hydrological models chms to quantify and predict drought events gosling zaherpour et al 2017 hattermann et al 2017 ghms lsms and chms have been widely used to model flood hazards and risk arnell and gosling 2016 climate change mitigation irvine et al 2017 forecasting at shorter time scales emerton et al 2016 and food security elliott et al 2014 the use of these models to study droughts is also relatively common van huijgevoort et al 2013 prudhomme et al 2014 but there is relatively less information on the performance of the models for simulating drought given the societal significance of drought prediction under climate change scenarios pokhrel et al 2021 using these tools and the influence of results on climate change adaptation and mitigation decision making it is critical to understand their strengths and limitations when specifically focusing on drought assessment and prediction whilst some studies have assessed the ability of multiple chms huang et al 2017 and ghms zaherpour et al 2018 to simulate historical low flows there has to date been no study that compares the performance of chms and ghms with a focus on drought characteristics thus the main novelty of this study is that it is the first cross scale model evaluation of drought event frequency intensity severity and duration together referred to as droughts hereafter this was achieved through the computation of observed and simulated runoff deficits and the standardised runoff index sri the main objective of this study was to systematically evaluate the performance of several global scale and catchment scale hydrological models to simulate droughts we also discuss the opportunities for improving the simulation of drought events by both ghms and chms 2 data 2 1 study catchments eight large 65 000 km2 catchments were selected to cover diverse climate zones and hydrological systems around the globe these were the upper amazon lena upper mississippi upper niger rhine tagus upper yangtze and upper yellow fig 1 the same eight catchments used in previous ghm chm comparisons gosling et al 2017 hattermann et al 2017 for the analysis only the upper part of the amazon mississippi niger yangtze and yellow were modelled due to their complicated geomorphological structure and human alterations further downstream krysanova and hattermann 2017 catchment boundaries were defined according to drainage direction maps at 30 ddm30 döll and lehner 2002 for the ghms and chms and according to the global runoff data centre grdc http grdc bafg de for the observed data 2 2 models and input data we used chm and ghm simulations from isimip2a gosling et al 2017 to identify historical drought events from their respective monthly runoff simulations and evaluated how these droughts compared to the observed record the simulations are the most up to date opportunity that exists to robustly and consistently compare the performance of several chms and ghms simulated runoff data from nine chms and eight ghms along with corresponding observed runoff data from the grdc for 1971 2001 were used in this study observed monthly runoff data was acquired from the most downstream gauge in the grdc catalogue for each catchment all ghms and chms were run with daily input climate data from watch era 40 weedon et al 2011 for the period 1971 2001 which we aggregated to monthly temporal resolution output from the models is openly available from the earth system grid federation esgf https esg pik potsdam de search isimip for the ghms gosling et al 2017 and the chms krysanova et al 2017 all the ghms provided outputs for all catchments however the number of chms with simulated runoff varied by catchment table 1 following the method described by haddeland et al 2011 monthly observed and simulated runoff data was converted to catchment mean monthly runoff by using the area upstream of the gauge according to the ddm30 river network thus an area correction factor was applied to the grdc runoff data to account for the fact that the river network which is at 0 5 spatial resolution may not perfectly overlap with the grdc river catchment boundaries table 1 both chms and ghms simulate the full hydrological cycle with predominantly daily precipitation and temperature as input data all the ghms simulated hydrological processes at a spatial resolution of 0 5 x 0 5 across the global land surface in contrast chms operated using various approaches three chms run on a grid mhm vic watergap3 four by splitting the catchment into sub catchments and smaller hydrological response units hbv hype swat swim and one by considering the whole catchment as a single entity hymod the ghms were not calibrated to catchment specific conditions except watergap2 which was calibrated against long term average annual streamflow for 1319 gauges worldwide while the chms were calibrated and the performance of the calibration evaluated in a separate validation period using the watch era 40 climate forcing data huang et al 2017 in addition to the individual model results we calculated the corresponding ensemble mean using monthly runoff values for the ghms denoted ens ghm and chms ens chm for every catchment and included them in the analysis sm 1 all the calculations of runoff deficits and sri for ens ghm and ens chm are based on ensemble monthly runoff values for the purposes of this study all the models were treated as independent even though some of the models employ similar model parameterisations for some hydrological processes no hydrological model was excluded or weighted based on their ability to simulate runoff 3 method 3 1 runoff deficit we calculated runoff deficit values based on a variable threshold and compared the simulated runoff deficit with observed values the threshold was defined as the 80th exceedance percentile runoff for each month separately a value between the 70th and 95th percentile commonly used for perennial rivers hisdal et al 2001 andreadis et al 2005 fleig et al 2006 tallaksen et al 2009 van loon 2015 a positive runoff deficit indicates dry conditions i e when the runoff falls below the threshold value 3 2 standardised runoff index sri several standardised indices have been developed for identifying hydrological droughts such as the palmer hydrological drought index pdhi jacobi et al 2013 water supply index wsi garen 1993 and standardised streamflow runoff index ssi sri vicente serrano et al 2012 in comparison with phdi and wsi ssi is more commonly accepted because it is simple to calculate can be used on various time scales and requires fewer inputs ssi is extensively used in many studies shukla and wood 2008 vicente serrano et al 2012 wu et al 2018 liu et al 2019 calculation of ssi sri is similar to that of standardised precipitation index spi proposed by mckee et al 1993b but considering runoff instead of precipitation the sri values are determined based on long term runoff records preferably 30 years by aggregating the monthly runoff over an accumulation period 1 3 6 12 or 24 months the new series formed after accumulation 1 month for this study is then fitted to a probability distribution that subsequently is transformed to a normal distribution such that the mean sri is zero we tested three different probability distributions gamma normal and weibull to see which had the best fit to observed runoff the gamma distribution was the best fit for all eight catchments sm 2 and was used for all the sri calculations the spei package in r beguería and vicente serrano 2017 was used for the calculations of sri spei i e standardized precipitation evapotranspiration index package facilitates computation of spi and other variants of spi sri in our study by providing defined functions that can be used directly in the r working environment any positive sri values indicate runoff values greater than the mean monthly runoff and vice versa sri values less than 1 were considered to indicate drought conditions these drought conditions were categorised based on sri values into three drought categories moderate severe and extreme droughts sri values from 1 to 1 49 indicate moderate drought from 1 5 to 1 99 severe drought and all the sri values less than 2 indicate extreme drought mckee et al 1993a lloyd hughes and saunders 2002 mishra et al 2007 bloomfield and marchant 2013 wasko et al 2021 3 3 drought characteristics and performance evaluation sri drought events drought events based on sri values were defined as temporally continuous sri values 1 lasting until the sri is above 1 again runoff deficit drought events drought events based on runoff deficit values were defined as temporally continuous positive runoff deficit values lasting until it is zero or less we calculated three drought characteristics for both runoff deficit and sri drought events from the observed and simulated data drought intensity or severity in case of runoff deficit drought events drought duration and frequency of drought events run theory yevjevich and ica yevjevich 1967 was used for the extraction of drought characteristics from the sri and runoff deficit time series the run theory method is based on a threshold level approach which considers the statistical properties of runs here length of negative or positive deviations in sri or runoff deficit values respectively above or below a given threshold level the drought duration in months was taken as the period in months for which the sri remained less than a threshold value of 1 or runoff deficit was greater than a threshold value of 0 the minimum sri value in the drought period was used as the drought intensity for sri drought events while the collective sum of all positive runoff deficits over the drought period was taken as drought severity for runoff deficit drought events we used the coefficient of determination i e the square of pearson product moment correlation coefficient r2 and the nash sutcliffe efficiency coefficient nse nash and sutcliffe 1970 to evaluate the goodness of fit between observed and simulated runoff deficits and sri values for each chm ghm and the ens chm and ens ghm r2 indicated the strength of relationship between the simulated and observed runoff and nse indicated the models efficiency range ꝏ 1 nse values approaching 1 indicate a perfect match of simulated and observed runoff values while negative values show that the observed mean is a better predictor than the model 4 results 4 1 comparison of observed and simulated runoff deficits table 2 shows the r2 and nse values for all the chms and ghms as well as the ens chm and ens ghm an r2 value 0 7 was interpreted as satisfactory model performance as was an nse 0 70 following moriasi et al 2007 2015 for all eight catchments the chms were better than ghms for the estimation of monthly runoff deficits because the r2 values for ens chm were higher than those for ens ghm both ensembles performed well in four catchments according to r2 because the ens chm and ens ghm r2 values were greater than 0 7 moriasi et al 2007 2015 the upper mississippi rhine tagus and upper yellow nse values for ens chm were greater than 0 7 for five catchments and closer to 1 for the rhine and tagus catchments while for ens ghm only two catchments upper mississippi and tagus had nse values greater than 0 7 all individual chms that simulated runoff for the rhine tagus and upper yangtze catchments had r2 and nse values 0 70 except watergap3 for the tagus catchment achieving 0 77 r2 and 0 60 nse both the r2 and nse values were 0 70 for all other catchments the only exception being mhm for the upper mississippi and upper yellow catchments none of the individual chms or ghms had consistently satisfactory r2 and nse values across all catchments the rhine and tagus catchments had individual ghms with r2 values 0 70 for over half the models but with unsatisfactory nse values in addition the upper amazon lena and upper niger catchments had no individual ghms with r2 or nse values 0 70 individual ghms showed good performance in the tagus catchment where both indicators were 0 70 4 2 comparison of observed and simulated sri r2 and nse values for the sri series are displayed in table 3 both r2 and nse vary widely across all catchments for both chms and ghms the r2 values of the ensemble series varied between 0 18 ens ghm upper niger and 0 94 ens chm rhine while the nse ranged from 0 14 ens ghm upper niger to 0 95 ens chm rhine for only three catchments ens chm had r2 and nse values 0 70 and ens ghm for only two the catchments where most of the models both chms and ghms performed well were the upper mississippi and rhine both with r2 and nse values for ens chm and ens ghm 0 85 for both these catchments individual models always achieved r2 0 50 and nse values 0 40 no individual chm or ghm achieved r2 and nse values 0 7 for the other six catchments with the exception of hbv for the tagus catchment r2 0 75 and nse 0 74 the catchment where all the models performed the worst was the upper niger where no individual ghm or chm except swim achieved an r2 value 0 35 and nse values were always close to or below zero 4 3 evaluation of the frequency of drought events table 4 presents the number of runoff deficit and sri drought events identified from the observed and simulated runoff ens chm and ens ghm for all eight catchments the total number of individual drought events identified by ens ghm and ens chm were comparable in most catchments for all eight catchments 136 individual sri drought events were identified from the observed data and the ensemble models successfully simulated 133 and 123 drought events for ens ghm and ens chm respectively similarly ens ghm and ens chm successfully simulated 233 and 220 individual drought events respectively from 244 individual runoff deficit drought events identified from observed records ens chm and ens ghm performed similarly in their estimation of the number of drought events for most catchments with five catchments differing by 6 or less runoff deficit drought events and only by 2 or less sri drought events for half of the catchments the number of sri drought events estimated by the ens ghm was closer to the observed data than the ens chm simulations while for observed runoff deficit drought events estimation by the ens chm was better in the majority of catchments despite the comparable estimates of the total number of sri and runoff deficit drought events across most catchments both ens chm and ens ghm struggled in estimating the frequency of droughts within sri drought categories both ens chm and ens ghm underestimated the number of extreme sri droughts 2 in the upper amazon upper niger and tagus catchments while in the upper yellow catchment ens chm and ens ghm both overestimated the number of extreme sri droughts showing 3 and 4 extreme events respectively when no such sri drought events were identified in the observed data 4 4 evaluation of drought intensity fig 2 and sm 3 supplementary materials show extreme sri and severe runoff deficit drought events respectively and the performance of individual models in representing these events with regards to drought intensity or severity along with drought duration substantial variation was seen in the ability of individual chms and ghms to simulate drought intensity or severity the over or under estimation of drought intensity in fig 2 drought severity in sm 3 shown as colour coded cells from shades of green to brown is based on the difference in estimated and observed drought intensity or severity there are marked differences across catchments in whether the models over or under estimated the intensity or severity of observed droughts and in the ability to simulate the very occurrence of an observed drought itself we observed cases where ensemble models simulated a drought that never occurred in the observed record and cases where a model fails to simulate a drought that occurred in the observed record in most catchments for extreme sri and severe runoff deficit drought events out of the 27 observed extreme sri drought events across all catchments ens chm and ens ghm failed to identify 1 and 3 drought events respectively in total 14 extreme sri drought events were identified by the models which were not observed shaded grey under observed in fig 2 and 5 of these events were identified by both ens chm and ens ghm for the upper amazon individual chms and ghms performed similarly with most models under estimating drought intensity for 6 of the observed extreme sri drought events for one event in the upper amazon an observed sri drought event went undetected by 10 out of 17 models all the individual models did not accurately simulate hydrological conditions in the upper yellow catchment with 4 extreme drought events simulated that were not observed in reality model performance is more nuanced in the other catchments with some observed droughts within a catchment under estimated and other events over estimated upper niger rhine and upper yangtze ens chm and ens ghm each failed to identify 12 drought events across all eight catchments from 70 observed severe runoff deficit droughts sm 3 supplementary material in addition to 70 observed severe runoff deficit drought events 19 additional runoff deficit drought events were identified by the models which were not observed and 9 of these additional events were identified as severe runoff deficit drought events by both ens ghm and ens chm performance of chms and ghms was analogous in estimating drought severity across all catchments however there were fewer cases in chms than ghms where observed severe runoff deficit drought events were identified only by one individual model two runoff deficit drought events went undetected by all individual models in the upper yellow catchment 4 5 evaluation of drought duration for all the observed runoff deficit and sri drought events independently under each drought category i e moderate severe and extreme for sri droughts events we calculated the absolute error in drought duration for each model the mean of all the absolute errors under each drought category for sri droughts events for a model yielded the mean absolute error mae for that model figs 3 and 4 shows the mae values for sri under the three drought categories and runoff deficit drought events respectively from the ens chm and ens ghm for every catchment along with their respective mean observed drought duration sm 4 supplementary materials presents mae values for the individual models averaged across all catchments for both sri and runoff deficit drought events for sri droughts the largest total mae i e the mae summed across the three drought categories was seen for upper niger for both ensembles followed by upper mississippi for ens chm and upper amazon for ens ghm fig 3 both ensembles display mae s smaller than all individual models sm 4 for extreme sri droughts across all three drought categories the models simulate drought duration for extreme sri droughts better than for lower intensity sri droughts fig 3 however for sri drought events overall both the chms and ghms struggle to accurately model drought duration with mae consistently 1 month sm 4 for runoff deficit droughts the mae was similar between ens chm and ens ghm except for the lena with a difference of 1 month between the two ensembles fig 4 maes were generally lower for runoff deficit droughts than for sri droughts 5 discussion the aim of this study was to assess the performance of chms and ghms in simulating observed drought events using runoff deficit and sri as indicators of hydrological drought no two drought events are the same and as such drought events cannot be judged based on a single characteristic here we used three characteristics the intensity or severity duration and frequency of drought events we used r2 and nse to judge the ability of the models and their ensemble means to replicate observed monthly runoff deficits and sri 5 1 comparison of chm and ghm performance different thresholds defining runoff deficit droughts for each catchment meant there were not standard drought classes which limited the distinctive analysis of drought occurrences frequency of runoff deficit drought events was higher than that of sri drought events table 4 which resulted in almost consistent mean observed drought duration and very less variation was seen in the mae between ens chm and ens ghm across all catchments there was a marked difference in performance of chms and ghms when estimating drought intensity and duration with the sri this is owing to the data used for identifying simulated drought events which here is simulated monthly runoff data the accuracy of the sri computation is directly proportional to the quality of data used for its calculation hayes et al 1999 huang et al 2017 reported that chms accurately reproduced monthly runoff seasonal dynamics moderate or high flows but simulations of low flows were problematic in most catchments zaherpour et al 2018 found that the majority of ghms overestimated low flows considerably more than they overestimated high flows and that ghms overestimated minimum flow return periods the majority of the ghms showed a tendency for overestimating monthly runoff with a wider magnitude range veldkamp et al 2018 previous studies highlight that this wider spread around ensembles in every catchment is due to the structure of ghms haddeland et al 2011 gudmundsson et al 2012 physical processes such as transmission losses having less presence in the ghms is one main reason for some of the differences between simulated and observed runoff gosling and arnell 2011 in addition evapotranspiration simulation has been reported to vary widely among the ghms wartenburger et al 2018 5 2 performance of the ensemble means although the r2 and nse values for the sri series are less than satisfactory for many individual ghms and chms across catchments the ensemble models were better at estimating drought frequency for most of the catchments moreover both the ensembles display overall a better performance compared to the individual models that make up each respective ensemble and showed comparable outputs runoff deficit and sri values despite the ghms having a wider spread across the ensemble although the ghms used the same climate forcing they used different formulations to compute potential evapotranspiration telteu et al 2021 which contributes to differences in simulated runoff between the ghms beck et al 2017 for monthly runoff deficits the ens ghm outperformed individual ghms because the individual models over or under estimated low flow conditions the computation of an ensemble mean for the ghms essentially balances out the over and under estimation of runoff deficits by individual models however the use of a large number of models does not necessarily ensure better performance of the ensemble mean for the upper amazon upper mississippi and rhine where the number of models used for the ensemble calculation was higher the performance of the ens chm was better at estimating drought frequency but showed higher mae for drought duration with exception of the rhine 5 3 implications for model calibration the performance of watergap2 for runoff deficit estimation was similar to the other ghms despite watergap2 being the only ghm to be calibrated with long term annual river discharge it did not perform noticeably better than other ghms and independent of calibration the identification of hydrological extremes was not satisfactory across all models this suggests that it is important to calibrate models with high temporal resolution data that allows extreme events to be accounted for in the calibration process the use of multiple criteria during model calibration specifically for low or no flow could be helpful krysanova et al 2018 5 4 representation of processes and quality of observed data our results indicate relatively better performances of ghms for runoff deficits and sri patterns in the upper mississippi and rhine compared to other catchments furthermore none of the ghms missed any observed sri drought events while only few ghms failed to simulate observed runoff deficit drought events however tendency of ghms across all catchments towards simulating drought events that were not observed can be attributed to a dry bias introduced by the choice of potential evapotranspiration formulation for individual models for example pcr globwb consistently appeared near the dry end of ens ghm perhaps because it includes a temperature based evaporation formulation hamon that has been shown to induce a large bias when applied outside its calibration range milly and dunne 2017 in general for ghms it is difficult to estimate a drought event at the right time because multiple errors propagate from the inputs meteorological parameters and some ghms struggle to capture the magnitude and timing of processes like abstraction losses and snowmelt accurately which is likely to have an impact on drought timing initiation and duration of drought events for chms large biases have been reported in simulating low flow conditions across majority of the catchments we studied especially the upper yangtze huang et al 2017 inaccuracies of low flow observations may be a factor affecting the estimation of observed drought conditions as might river ice in some catchments while the inability of individual chms to replicate low flow or no flow may be due to the choice of objective functions for calibration of the chms huang et al 2017 similarities in performance of both sets of individual models in the upper amazon lena tagus and upper yangtze catchments for drought events in and sm 3 supplementary materials can likely be attributed towards the quality of the meteorological data used for simulations some studies have reported watch era 40 data to be unreliable due to inaccuracies in observed precipitation records caused by fog mist strauch et al 2017 watergap3 among all chms comparatively showed the weakest performance which may be attributed to fewer parameters used for model calibration compared to other chms 6 conclusion our study focused upon the effectiveness of catchment and global scale hydrological models to estimate drought conditions at the catchment scale for 8 large catchments we found comparably lower performance by most ghms in simulating monthly runoff deficits while chms and ghms were similar in estimating sri both sets of models show limited ability to simulate the finer more granular and detailed characteristics intensity or severity duration and frequency of observed droughts but the ensembles performed better compared to the individual models that make up each respective ensemble whilst the ens chm and ens ghm simulated drought frequency well for runoff deficit and sri drought events marked differences were observed in ability to simulate the occurrence of observed and simulated drought events not simulating several observed drought events and simulating drought events out of observed records for both the ensembles the error is overall smallest for duration of extreme sri droughts across all three drought categories however it can also be concluded that both chms and ghms struggled in accurately modelling drought duration for moderate and severe sri drought categories we believe that there is still room for improvement in runoff simulations to facilitate drought identification and accurate estimation of drought characteristics credit authorship contribution statement amit kumar investigation data curation writing original draft simon n gosling methodology data curation writing original draft writing review editing matthew f johnson methodology data curation writing original draft writing review editing matthew d jones methodology writing original draft writing review editing jamal zaherpour data curation writing original draft writing review editing rohini kumar writing original draft writing review editing guoyong leng writing original draft writing review editing hannes müller schmied writing original draft writing review editing jenny kupzig writing original draft writing review editing lutz breuer writing original draft writing review editing naota hanasaki writing original draft writing review editing qiuhong tang writing original draft writing review editing sebastian ostberg writing original draft writing review editing tobias stacke writing original draft writing review editing yadu pokhrel writing original draft writing review editing yoshihide wada writing original draft writing review editing yoshimitsu masaki writing original draft writing review editing declaration of competing interest the authors declare no conflict of interest funding the research was funded by the university of nottingham vice chancellor s scholarship for research excellence international availability of data and material output from the models used for this study are openly available from the earth system grid federation esgf https esg pik potsdam de search isimip for the ghms gosling et al 2017 and the chms krysanova et al 2017 code availability not applicable supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2022 104212 appendix supplementary materials image application 1 
