index,text
25050,animals must balance their rates of energetic intake and expenditure while foraging several mathematical models have been put forward as energetically optimal foraging strategies when the food environment is sparse i e the distance between food patches in the environment is much larger than the distance from which the forager can perceive food in particular lévy walks with a power law exponent approaching 1 are considered optimal for destructive foragers however these models have yet to explore the role of sensory perception in foraging success as the distance between food patches approaches the distance from which the forager can perceive food here we used an agent based modeling approach to address this question our results concur that lower values of the power law exponent i e values approaching 1 result in the most food found but in contrast to previous studies we note that in many cases lower exponents are not optimal when we consider food found per unit distance traveled for example higher values of the exponent resulted in comparable or higher foraging success relative to lower values when the forager s range of sensory perception was restricted to an angle 30 from its current heading in addition we find that sensory perception has a larger effect on foraging success than the power law exponent these results suggest that a deeper examination of how animals perceive food sources from a distance may affect longstanding assumptions regarding the optimality of lévy walk foraging patterns and lend support to the developing theoretical shift towards models that place increasing emphasis on how organisms interact with their environments keywords agent based model destructive foraging environmental heterogeneity lévy walk optimal search sensory perception 1 introduction all animals must find food in an energetically feasible manner in order to survive optimal foraging theory oft holds that animals seek to maximize their net rate of energy intake the difference between their energetic benefit in terms of calories nutrients etc and their energetic expenditure over time while searching for handling consuming and digesting food macarthur pianka 1966 oft transformed the field of foraging ecology stimulating both empirical and theoretical work on diet patch selection and residence time pyke 1984 however the issue of how animals should optimally move between food patches was initially underrepresented in the literature pyke 1978 1984 2015 but see cody 1971 root kareiva 1984 siniff jesson 1969 smith 1973 researchers observed that animals across taxa performed area restricted search ars they responded to encounters with food patches by transitioning from a rapid directed movement regime to one that was slow and tortuous e g banks 1957 benhamou bovet 1989 bond 1980 fielden et al 1990 hassell may 1973 mueller et al 2011 pyke 1978 thomas 1974 weimerskirch et al 2002 white et al 1984 but a true synthesis of optimal movement between food patches remained incomplete initial efforts to provide a theoretical basis for the observed ars patterns drew from simple random walk srw models cody 1971 kareiva and shigesada 1983 pyke 1978 siniff and jesson 1969 smith 1973 turchin 1998 viswanathan et al 2011 in which an animal s trajectory is discretized into a series of linear steps the step lengths are drawn from an exponential distribution and the step directions are chosen at random resulting in a forager whose mean squared displacement grows linearly with time and whose changes in direction are uncorrelated dray et al 2010 pyke 2015 viswanathan et al 2011 correlated random walk crw models elaborated on srws benhamou 2007 codling et al 2008 by incorporating some degree of correlation between the directions of successive steps this adjustment helped simulate the directional persistence that is characteristic of the movements of most organisms pyke 2015 most recently lévy walks also called lévy flights have been proposed as an alternative optimal search strategy viswanathan et al 1999 2000 one way in which lévy walks differ from srws and crws is that the length of each step is chosen from a probability distribution given by the power law distribution 1 p x c x α where c is a normalizing constant x is the step length and α 1 viswanathan et al 2000 1999 as α increases beyond 3 the lévy walk converges on brownian motion when α 3 a lévy walker has higher probabilities of taking very long steps than does a simple or correlated random walker in 1999 viswanathan et al proposed the lévy flight foraging hypothesis lffh which suggests that lévy walks with particular values of α should maximize the quantity of food found per distance traveled over time for foragers in environments with sparse randomly distributed food patches viswanathan et al 1999 2000 in the case of nondestructive foraging where food patches returned instantaneously to their ungrazed state after an encounter with a forager α 2 was optimal in the case of destructive foraging where food patches were completely depleted after an encounter with a forager an α value approaching 1 was optimal numerous subsequent studies found that a power law with an exponent of 2 best modeled in situ foraging behavior in a wide variety of taxa apparently in support of the lffh e g bartumeus et al 2010 de jager et al 2011 franks et al 2010 raichlen et al 2013 reynolds et al 2014 seuront stanley 2014 sims et al 2008 however other researchers reported contrasting results reynolds 2015 and raised concerns regarding the statistical procedures required to accurately identify power law distributions in empirical data clauset et al 2009 edwards 2008 edwards et al 2007 when more accurate procedures were used the outcomes of many studies in support of the lffh were overturned clauset et al 2009 edwards 2008 edwards et al 2007 for example the foraging times of unfenced deer dama dama were initially found to conform to a power law with α 2 edwards et al 2007 however reanalysis of the dataset using maximum likelihood and akaike weights found that deer foraging times were better modeled by an exponential rather than a power law distribution the same research team determined that bumblebee bombus terricola flight distances could be reasonably fit to a power law distribution however they recalculated α to be 3 68 rather than the original value of 3 5 in high food areas and 2 2 rather than the original value of 2 0 in low food areas edwards et al 2007 while it is critical that ecologists employ accurate statistical techniques to analyze their data it remains unclear to what extent changes in calculated α values actually reflect significant changes in the energy budgets of foraging animals for example in a biological system animals whose movements are best modeled by values of α that differ only slightly may experience negligible changes in foraging success with respect to long term fitness in addition α values do little to reveal the underlying mechanisms animals use when searching for food it is reasonable then to question how substantial changes to calculated α values must be to reflect changes in underlying mechanisms that result in the evolution of optimal foraging behavior in evaluating these mechanisms one must consider the assumptions of the lffh and the fact that they commonly have not been met by the species and systems used to test the hypothesis in empirical studies pyke 2015 reynolds 2015 viswanathan et al 1999 2000 assumed that the directions of successive animal movements were uncorrelated however even very simple organisms tend to exhibit directional persistence pyke 2015 additionally researchers have debated whether destructive or non destructive foraging is the more realistic assumption pyke 2015 and some have explored the effects of nondestructive foraging when food resources fully renew after some time lag raposo et al 2003 santos et al 2004 third the lffh specifically applies to organisms whose radius of sensory perception rv in viswanathan et al 1999 2000 is much less than the average distance traveled between food patches in their environment λ in viswanathan et al 1999 2000 while a movement strategy modeled by a power law with α 2 might be optimal when λ rv it is unclear how that optimal strategy shifts as λ approaches rv although numerous authors have stated that the influence of α on foraging efficiency should decrease as rv λ approaches 1 e g bartumeus et al 2008a james et al 2011 viswanathan et al 1999 2000 this has not been explicitly investigated finally an optimal movement strategy may be influenced by other factors not considered by viswanathan et al 1999 2000 and other similar studies for example many animals do not perceive food patches equally well in all directions rather they tend to perceive food patches that are in front of them where the majority of their sensory organs are located olden et al 2004 pelseneer 1906 zollner lima 1999 in many studies of foraging behavior see for example cody 1971 siniff jesson 1969 turchin 1998 viswanathan et al 1999 agent based models abms have provided valuable supplements to purely analytical and empirical investigations abms are flexible modeling frameworks that examine the properties that emerge from the actions of individual agents railsback and grimm 2011 tang and bennett 2010 in the context of foraging behavior agents search for food on a simulated landscape using a set of rules that may depend on the agent s internal psychological or physiological state nearby landscape features interactions with other agents and a set of navigational strategies nathan et al 2008 tang and bennett 2010 in this study we used an agent based modeling framework to simulate destructive foraging during single foraging bouts we sought to address three questions 1 which factor sensory perception or foraging movement pattern as summarized by the power law exponent α has the most influence on destructive foraging success across a range of food distributions 2 how does the influence of α on destructive foraging success change as the forager s range of sensory perception approaches and exceeds the distance between food patches 3 taking both foraging movement pattern and sensory perception into account can our model produce testable hypotheses regarding expected foraging behaviors in a model organism due in part to its prominence in the literature we expected that animal movement patterns would have the most influence on destructive foraging success with smaller α values resulting in greater success than larger ones however we also expected that food availability and sensory perception would interact with animal movements with larger values of both factors resulting in more foraging success than smaller values we anticipated that α would have the largest effect on foraging success when the forager s range of sensory perception was much less than the distance between food patches in its landscape and that this effect would become negligible as the forager s range of sensory perception approached and exceeded this distance finally we expected that our model would allow us to generate testable hypotheses about foraging behavior in a model organism the intertidal limpet patella vulgata linnaeus 2 materials and methods 2 1 model description to simulate single foraging bouts we used an agent based modeling framework varying the α value of the power law distribution used to model animal foraging movements hereafter referred to as foraging strategy the sensory abilities of the forager and the food distribution of the landscape 2 1 1 landscape generation we generated landscapes with food distributions that ranged from relatively sparse 1 food cover to relatively plentiful 15 food cover these values are within the range determined to be realistic and relevant by previous studies e g with king 1999 to do this we created 32 2 dimensional bounded landscapes and initialized each with an empty 500 500 grid of squares we then randomly added non overlapping food patches with side lengths μ of 1 2 5 or 10 grid units until the desired percent food cover was achieved the average minimum nearest neighbor distance between food patches on the resulting landscapes ranged from 0 60 to 50 82 grid units see table s 1 for details 2 1 2 forager characteristics each agent or forager was initialized with three inherent properties that governed its movements r and θ table 1 each forager drew its step lengths from a power law distribution eq 1 in this distribution the exponent α controls the size of the tail as α increases the size of the tail decreases as does the probability of the forager taking very long steps fig s 1 two parameters r and θ governed the ability of the forager to perceive food patches in its environment r is the forager s radius of sensory perception the direction of perception θ analogous to perceptual horizon in olden et al 2004 was limited to the forager s current heading plus or minus θ 2 θ 60 produced an anterior bias in perception while θ 360 produced no bias these values represented minimum and maximum cases the parameter values used in our simulations are summarized in table 1 2 1 3 simulating movement and food consumption our simulations were implemented in python 2 7 9 at the beginning of each simulation a single forager was randomly placed on a food free square in a landscape initial exploratory simulations determined that t 1000 time steps were sufficient to produce consistent results for each time step fig 1 1 the forager s maximum traveling distance x was drawn from a power law distribution with parameter α 2 the forager searched for food within the constraints of its range r and angle θ of sensory perception during the first time step the forager s angle of sensory perception was defined relative to an initial heading that was drawn randomly from a uniform distribution 3 if the forager could perceive a food square then it selected that square as its desired destination and moved toward it if the distance to this square was less than x the forager moved directly to the square and consumed the food otherwise the forager moved a distance x along the line connecting its current position and the desired position if the forager could perceive more than one food square it moved toward the nearest one in all of the above situations the forager s heading was redefined as the angle connecting the forager and the food square 4 if the forager could not perceive a food square it randomly chose a heading from one of two opposite facing von mises distributions fig 1 this strategy reflected the fact that animals tend to continue moving forward along their current path pyke 2015 but also occasionally reverse direction the von mises distribution closely approximates a normal distribution on a circle the probability of the forager drawing a heading of angle ϕ was defined as p φ h κ c κ e κ cos φ h where h is the angle the distribution is centered on κ is the concentration parameter describing how much of the distribution is aggregated around h and c κ is a normalizing constant with probability p the forager s heading was drawn from a von mises distribution centered on its current heading with concentration parameter k1 and with probability 1 p the forager s heading was drawn from a von mises distribution centered on the heading directly opposite from its current one with concentration parameter k2 table 1 the forager then moved incrementally along the chosen heading until a distance x was reached if the forager perceived a food square along its path of travel it stopped at the intermediate location food squares did not regenerate after consumption i e foraging was destructive we ran the above simulation 10 times on each of the 32 landscapes for every possible combination of the parameters α r and θ listed in table 1 2 1 4 simulation output after each simulation the track of the forager was recorded and two response variables were measured the total amount of food found f and the benefit cost ratio bcr f is the number of times a forager landed on and consumed a food patch bcr is a measure of foraging efficiency houston and mcnamara 2014 that in our case increases monotonically with the forager s net rate of energetic intake appendix b and is defined as the food gained by the forager per unit distance traveled over time or 2 b c r f t d t f d where d is the total distance traveled along the forager s path during the simulation and t 1000 time steps we used benefit cost ratio rather than cost benefit ratio because some simulations resulted in f 0 2 2 effect size of model factors to determine how the parameters in our simulations landscape α r and θ affected our two response metrics f and bcr we performed a five factor analysis of variance anova and a multiple linear regression with all interactions considered we designed our landscapes with two free variables percent cover pc and patch side length μ table 1 we performed anovas for each response metric over these two landscape parameters as well as the movement parameters α r and θ pc μ α and r were represented as continuous fixed factors while θ was represented as a categorical fixed factor all factors were centered by subtracting their mean value in modeling studies like ours it is possible to perform enough simulations to achieve any level of statistical significance white et al 2014 therefore instead of reporting anova f statistics and regression p values we reported the proportion of variation in each response metric explained by each factor and provided the estimated regression coefficients for each factor as a measure of effect size to explore how the influence of α on foraging success changed as the ratio of range of sensory perception to distance between food patches shifted from 0 to greater than 1 we first calculated the average minimum nearest neighbor distance nnd between patches for each of our 32 landscapes table s 1 we chose to use the average minimum nearest neighbor distance rather than the mean free path because we believed the former value would be more relevant to a forager moving from patch to patch we then calculated r nnd for each of our simulations a value analogous to rv λ in viswanathan et al 1999 2000 next for ease of visualization we divided this continuous variable into five categories the first four of these were determined by the quartiles of the ratio r nnd 0 r nnd 0 18 0 18 r nnd 0 73 0 73 r nnd 2 42 and r nnd 2 42 the fifth category contained all simulations in which r 0 and thus r nnd 0 these and subsequent analyses were performed in r 3 3 0 2 3 model fitting to simulated data to better understand the relationships between our five parameters and two response variables we chose to summarize the response variables as functions of the parameters the goal of this analysis was not to claim that these functional forms represent underlying mechanisms but rather to condense the behavior of the response variables into simple yet comprehensive representations to do this we investigated how the relationship between the amount of food found by a forager f and the percent cover of food in a landscape pc varied with simulated movement parameters α r and θ and patch size μ in general the relationship between f and pc followed a linear logarithmic functional form appendix c we then used linear regression to explore how changes in simulated movement parameters influenced the shape of the linear logarithmic fit 2 3 1 food found we demonstrate in appendix c that for both a forager with no sensory perception in any landscape and a forager with poor sensory perception in a sparse landscape we would expect f to be linear with respect to pc however for a forager with strong sensory perception in a dense landscape we would expect f to exhibit sublinear behavior with respect to pc because increasing food availability in this scenario will only marginally increase the probability of finding food based on these expectations we chose to compare linear logarithmic and piecewise linear logarithmic functions of f with respect to pc and found that the piecewise function was best as determined by the coefficient of determination r2 see appendix c the piecewise lin log function was defined as 4 f p c a p c f o r p c c b l o g p c c a c f o r p c c where a and b are coefficients to be fit and c is the point of transition between linear behavior and logarithmic behavior we fit a and b for fixed values of c over the entire range of pc values in steps of 0 01 choosing the value of c that minimized the root mean squared error of the fit fig 2 a variance on the estimate of c was approximated by bootstrapping n 200 to explore the relative roles of α r μ and θ in determining a b and c we performed multiple linear regressions with α r and μ as fixed continuous factors and θ as a fixed categorical factor purely additive models were used 2 3 2 benefit cost ratio eq 4 summarizes the behavior of f with respect to pc μ α r and we show in appendix a that bcr can be approximated as a function of f and α and so the behavior of bcr with respect to pc μ r and θ can be deduced directly from the behavior of f 2 4 hypothesis generation our final aim was to use pre existing data from a well studied model organism to generate testable hypotheses about that organism s foraging behavior to be a good fit to our model we required an animal with limited memory that forages for sessile food items in a 2 dimensional environment we chose to use the intertidal common limpet patella vulgata p vulgata lives on temperate rocky shores on the west coast of northern europe and can reach 25 mm in shell length hill 2008 it clings to the rock on which it lives with a large muscular foot and much like a terrestrial snail locomotes by undulating over a layer of secreted pedal mucus cook 1969 it forages for both microscopic and macroscopic algae during high tide cook 1969 and travels an average path distance of 0 4 m during foraging hartnoll and wright 1977 because of its relatively simple neurological structure 3 major paired ganglia located throughout the body pelseneer 1906 it is generally assumed that p vulgata s foraging patterns are not determined by memory in addition a recent study examined the step length distributions of 15 individual p vulgata during 9 nocturnal low tides and fit their step lengths to exponential power law and three and four tier weierstrassian lévy walk wlw models reynolds et al 2017 of the distributions that we consider here the authors found that a power law with an exponent near 1 was the best model this suggests that p vulgata is a good fit to our agent based model and provides us with some background information with which to form further hypotheses for example p vulgata s range of sensory perception and the food distribution in its habitat remain uncharacterized there is sufficient energetic data available in the existing literature to convert the bcr values from our simulations into values specific to p vulgata according to burrows et al burrows et al 2000 the standing crop of microalgae available to p vulgata individuals has an energetic content between 0 1 and 0 5 j mm2 if we set the scale of our landscapes to 0 5 m x 0 5 m then each square in the grid is 1 mm x 1 mm and this energetic content yields 0 1 0 5 j per square of food consumed additionally davies et al davies et al 1990 calculated that 23 of consumed energy is employed in mucus production the primary cost of limpet locomotion they also found the energetic content of mucus to be 8 984 kj g finally davies williams davies williams 1995 found that a closely related intertidal limpet cellana grata produces between 2 1 and 15 2 μg of mucus per millimeter traveled if we assume that food was high quality and travel required little mucus then our rescaled bcr value is 8 b c r p v u l g a t a f 0 5 0 23 d 2 1 8 984 if we assume that food was low quality and travel required little mucus then our rescaled bcr value is 9 b c r p v u l g a t a f 0 1 0 23 d 2 1 8 984 after converting bcr to values relevant to p vulgata we examined the foraging parameters pc μ α r and θ that resulted in energetically viable behavior b c r p v u l g a t a 1 there were no viable bcr values for scenarios in which travel required large quantities of mucus 15 2 μg mm 3 results 3 1 effects of model parameters in general food found f increased with increasing food availability pc and μ within this framework we expected that foraging strategy α would have the largest effect on foraging success followed by radius r and angle θ of sensory perception instead r was the largest contributor to variation in f fig 3 as expected larger r values resulted in larger quantities of food found fig 4 the power law exponent α was the next largest contributor with smaller α values generally resulting in more food found finally θ contributed the least amount of variation increasing θ from 60 to 360 increased the quantity of food found the main effects of pc μ α r and θ explained 63 66 of the variance in f interaction terms explained only an additional 2 22 bcr also increased with increasing percent cover pc fig 3 as was the case with food found radius of sensory perception r contributed most to variation in bcr and bcr increased with increasing r angle of sensory perception θ was the second largest contributor to variation but increasing θ from 60 to 360 only increased bcr when μ or r were large and α was small fig 4 finally α contributed the least amount of variation to bcr when r 0 smaller α values resulted in larger bcr however contrary to expectations larger values of α were best when r 0 the main effects of pc μ α r and θ explained 66 95 of the variance in bcr interaction terms explained an additional 8 01 we expected that lower values of α would result in larger benefit cost ratios when r nnd was near 0 but that this trend would disappear as r nnd approached and exceeded 1 to evaluate this hypothesis we plotted bcr as a linear function of α for each value of μ and θ and each category of r nnd fig 5 we found that α 1 1 did indeed maximize bcr when 0 018 r nnd 0 12 and that the slope of the relationship between bcr and α became more negative as μ and θ increased from 60 to 360 table s 2 we also expected that the slope of the relationship between bcr and α would approach 0 as r nnd approached and exceeded 1 in general when θ 360 the data conformed to this hypothesis however slopes did not increase monotonically with r nnd instead slopes of intermediate values of r nnd 0 12 r nnd 0 73 0 73 r nnd 2 42 tended to be more negative than those at the lowest values when θ 60 and μ 5 the slopes of the relationships between bcr and α were statistically indistinguishable from 0 table s 2 when μ 5 slopes were largest when r nnd exceeded 1 and were positive i e α 3 outperformed α 1 1 3 2 functional form analysis 3 2 1 food found our analysis of food found f using eq 4 allowed us to address how pc μ α r and θ affected the shape of the relationship between f and pc the transition point between linear and logarithmic behavior c of each fit to our model data increased as α increased and decreased as r increased θ and μ had no significant effect fig 2b our linear regression of c on r α μ and θ yielded coefficients of 0 26 p 0 001 2 00 p 0 001 0 001 p 0 981 and 0 04 p 0 919 respectively the slope of each lin log fit decreased with increasing α and increased with increasing r μ and θ fig 2c our linear regression of a on r α μ and θ yielded coefficients of 17 03 p 0 001 211 49 p 0 001 12 02 p 0 001 and 92 91 p 0 001 respectively finally the log coefficient b increased with higher values of α r μ and θ had no significant effect our linear regression of b on r α μ and θ yielded coefficients of 0 15 p 0 81 49 66 p 0 001 1 74 p 0 14 and 2 87 p 0 73 respectively 3 2 2 benefit cost ratio as bcr can be approximated as a function of f and α in which bcr increases monotonically with f for a given α value appendix a we did not conduct an additional analysis of bcr as a function of pc 3 3 hypotheses regarding p vulgata foraging when we assumed low food quality and low cost of travel after averaging across replicate simulations we obtained 27 combinations of pc μ α r and θ that resulted in energetically viable foraging b c r p v u l g a t a 1 in this scenario foragers required θ 360 and relatively high pc 9 or greater μ 5 or greater and r 10 or greater to be viable however all α values were indistinguishably effective when we assumed high food quality and low cost of travel after averaging across replicate simulations we obtained 1 339 combinations of parameters that resulted in energetic viability of these simulations none included r 0 fig 6 however for foragers with r 0 viable simulations existed for all pc values foragers with θ 360 were able to forage more effectively at lower pc especially if α was also low and the landscape had large food patches however for foragers with θ 60 all α values were indistinguishably effective especially if r was large greater than 5 and the landscape had smaller food patches 4 discussion our results suggest that a forager s movement strategy as defined by the power law exponent α is the least important contributor to foraging success when the energetic costs of movement are taken into account bcr instead food availability pc and the forager s range of sensory perception r are the most important quantities to consider in addition the degree to which α affects bcr depends on the size of food patches μ the forager s angle of sensory perception θ and the ratio of the forager s range of sensory perception to the distance between food patches r nnd in general α matters most when food patches are large the forager s angle of sensory perception is unbiased and r nnd is approximately between 0 and 2 finally when appropriately parameterized our model generates testable hypotheses on how animals may optimally interact with their environments while foraging taking into account food distribution range of sensory perception and energetic expenditures 4 1 effect of model parameters on foraging success our linear regression and analysis of variance results indicate that the power law exponent α should be given reduced emphasis in future studies characterizing the optimal foraging of animals quantifying α as a measure of optimality in foraging behavior is a simple and general approach that is understandably compelling because it is relatively easy to measure from animal track data which is becoming increasingly available wilmers et al 2015 in addition other methods to infer underlying behaviors from these data are still very much in development dodge et al 2013 fleming et al 2016 jonsen et al 2005 warwick evans et al 2015 measuring the exponent α provides a simple starting point and a general theoretical framework from which to form further hypotheses however we believe it may be misleading to evaluate the optimality of an animal s foraging strategy purely based on its exponent s value our data suggest that it would be more informative to characterize an animal s foraging environment and its ability to perceive food sources from a distance in addition to its movement patterns our model is distinct from viswanathan et al s original simulation viswanathan et al 1999 2000 in several ways we incorporated correlated turn angles and variation in food availability food patch size and range and angle of sensory perception a prior study found that broader turn angle distributions and turn angles that were more correlated through time resulted in increased foraging efficiency bartumeus et al 2008a based on this our use of a narrower turn angle distribution and turn angles that were correlated across successive time steps should have decreased and increased foraging efficiency respectively however since these changes were applied across all of our simulations the effects of turn angle distribution and correlation should be systematic and our results that consider the relative effects of pc μ α r and θ should remain comparable with prior work with respect to variation in food availability bartumeus et al 2008b determined that increasing food availability decreased the degree to which an α value near 1 outperformed α 3 they also found that the degree to which α near 1 outperformed α 3 was decreased when food patches were smaller relative to the forager s range of sensory perception our results corroborate both of these findings variation in angle of sensory perception has not previously been explored in the literature it has generally been assumed that all animals perceive food equally well in all directions e g bartumeus et al 2008a pyke 2015 viswanathan et al 1999 2000 however recent work has called for the incorporation of anisotropic and even context dependent perceptual ranges in foraging models olden et al 2004 we found that narrowing a forager s angle of sensory perception from 360 to 60 resulted in an overall decrease in bcr especially when patch sizes were larger and α values were smaller it is important to note that we did not test the effects of intermediate values of θ and therefore cannot fully define the relationship between it and bcr however this result remains worthy of consideration because many animals do not sense their environments equally well in all directions but rather have most of their sensory structures located anteriorly pelseneer 1906 given the impact of a reduced angle of sensory perception on foraging success it may be an informative addition to future simulations it has long been acknowledged that the ratio of radius of sensory perception to the distance foragers must travel between food patches r nnd in our case is an important indicator of foraging success e g benhamou 2007 raposo et al 2003 santos et al 2004 viswanathan et al 1999 2000 2011 and others essentially when this ratio is greater than or equal to 1 the forager should be able to perceive its next food patch from its current location however prior studies have only reported results from a limited range of ratios from approximately 1 104 to 1 10 bartumeus et al 2008a 2008b viswanathan et al 1999 2000 from this earlier work researchers concluded that α has the largest effect on foraging success at small ratios and that this effect becomes negligible as α approaches 1 bartumeus et al 2008a 2008b santos et al 2004 viswanathan et al 1999 2000 in this study we chose to explore this relationship explicitly testing r nnd values between approximately 0 02 and 34 our results generally confirmed prior work the slope of a linear regression of bcr against α becomes less negative and approaches 0 as r nnd increases however this increase in slope was nonlinear and in some cases α 3 outperformed α 1 1 in particular this occurred when r nnd was large and angle of sensory perception was anteriorly biased these results suggest that there are intermediate r nnd ratios where α values are more or less important to foraging success and that the assumption that all α values are always equally effective when r nnd 1 is inaccurate 4 2 hypothesis generation our model was designed to explore the relative contributions of foraging strategy power law exponent and range of sensory perception r θ to foraging success in a range of simulated environments but it can also be used as a hypothesis generation mechanism for particular organisms and environments to illustrate this we used existing data on the energetics of the intertidal limpet patella vulgata to parameterize our model we were able to hypothesize given a range of food qualities and energetic movement costs under which food distributions and foraging strategies p vulgata might be energetically viable b c r p v u l g a t a 1 because the foraging strategies of p vulgata have recently been characterized reynolds et al 2017 we can compare our results with empirical data reynolds et al 2017 examined the step length distributions of 15 individual p vulgata during 9 nocturnal low tides and fit them to exponential power law and three and four tier weierstrassian lévy walk wlw models of these distributions the three tier wlw model was the best fit to the data wlw models are outside the scope of this study however of the models we consider here reynolds et al 2017 determined that a power law with α 1 was best for this α value and a small patch size μ 1 our model suggests that p vulgata foraging would be energetically viable at r 2 and pc 15 or at r 10 and pc 3 regardless of angle of sensory perception increasing patch size would generally lower the pc at which foraging becomes viable and when patches are large μ 10 θ 360 would allow for viable foraging at lower pc even when r is small note that scenarios in which θ 60 are likely better models of p vulgata foraging success limpets like many other animals possess an anterior concentration of sensory structures and may not be able to perceive food equally well in all directions however our data show that θ 360 would generally allow p vulgata to be energetically viable with less food in its environment it is possible that these observations represent a trade off between the benefit of finding more food when θ 360 and the cost of supporting for instance sensory structures that are more equally distributed across the body we observed no scenarios in which a high energetic cost of limpet movement 15 2 μg mucus mm was energetically viable however our results represent the worst case scenario in terms of the energetics of limpet movement many species including p vulgata have been observed following mucus trails previously laid down by themselves by conspecifics and even by members of other limpet species chelazzi et al 1988 cook et al 1969 cook 1969 davies hawkins 1998 denny 1989 funke 1968 ng et al 2013 these mucus trails may substantially reduce the energetics of limpet movement davies blackwell davies blackwell 2007 for example found that energy expended on mucus decreased by 70 in the littorine snail littorina littorea when they were following a freshly laid trail in addition connor connor 1986 estimated that mucus trails generated by lottia gigantea l scabra and l digitalis persevere in the rocky wave swept intertidal environment for at least 7 days as such our results should be taken as a worst case scenario 15 2 μg mucus mm may very well be reduced to an energetically viable value when the prevalence of trail following the density of limpets and the persistence of mucus trails are taken into account 4 3 functional form analysis 4 3 1 food found a lin log model for food found as a function of percent cover suggested that foragers exhibited two movement modes one where food found f was linear with respect to percent cover pc and pc was low and one where f was sublinear approximately logarithmic with respect to pc and pc was high the first movement mode s linear accumulation of food was likely a signature of correlated random walk behavior see appendix c when pc was low e g 1 and patch size was large e g 10 units per side the average distance from a patch to its nearest neighbor was about 45 grid units this distance was farther than the distance from which any of our foragers could perceive food r nnd 1 meaning that at least one random step was likely to occur between food patches the smaller the values of r and θ the more random steps had to be taken between food patches α controlled the size of these random steps and therefore also played a significant role the second movement mode s logarithmic accumulation of food may indicate diminishing returns in this mode pc was relatively high and foragers with r 0 were likely to perceive the next food patch from the current one because of this adding more food squares to the landscape had a lower chance of increasing f than if the forager were performing a simple random walk visualizing tracks from foragers on high and low pc landscapes provided some evidence for this two mode mechanistic explanation of our results fig 7 however it is possible that f may not retain this lin log behavior at pc values greater than those explored in this study 4 3 2 benefit cost ratio we show in appendix a that bcr can be approximated as a function of f and α and so the behavior of bcr with respect to pc μ r and θ can be deduced directly from the behavior of f increasing r and μ or decreasing α therefore will increase bcr at low pc increasing r or decreasing α will increase the transition point between the two functions and increasing α will increase bcr at high pc however bcr also depends on the average step length used by the forager k α in equation a 1 this term counteracts the effect of α increasing bcr for smaller average step lengths and decreasing it for larger average step lengths the opposing effects of α and average step length result in a decreased influence of α on bcr relative to its influence on f 5 conclusions our agent based model allowed us to explore the relative roles of the power law exponent and sensory perception in efficient foraging but it did so by making a variety of assumptions about foragers and environmental features that may or may not apply to specific systems in particular our model is well suited for animals that lack spatial memory and forage in environments that can be approximated as 2 dimensional the assumption of memorylessness is common especially in invertebrate systems and many terrestrial and benthic marine and freshwater habitats can be considered 2 dimensional however these assumptions and others implicit in our model can be easily altered to suit a variety of research agendas this is the ultimate power of exploratory agent based models abms they are flexible can be tailored to specific systems and allow for the cycles of hypothesis generation and testing required to move from observations of animal movement to mechanistic explanations this repetitive testing is crucial in a field of study where it is increasingly clear that one simple model will not fit all cases nathan et al 2008 pyke 2015 in this study we conclude that lower values of the power law exponent maximize food found but that the effect of the exponent on benefit cost ratio depends strongly on food availability food patch size the forager s range of sensory perception and whether that range is anteriorly biased we also suggest that sensory abilities may play a more prominent role in determining foraging success than has previously been acknowledged in the literature these conclusions lend support to a developing paradigm shift in movement ecology researchers are increasingly moving away from simple probabilistic movement models and exploring agent based and inferential methods that place more emphasis on how organisms interact with their environments benhamou 2007 cody 1971 nathan et al 2008 plank james 2008 pyke 2015 reynolds 2009 reynolds 2015 reynolds 2018 siniff jesson 1969 in these models the internal state of the forager is constantly updated with information gleaned from biotic and abiotic features in the environment and movement patterns including those that appear to be lévy or lévy like are emergent properties of this information as this new paradigm develops simple models like the one presented here will serve as versatile testing grounds in an iterative hypothesis driven experimental process to help determine the key features of organismal movement credit authorship contribution statement diana e lascala gruenewald conceptualization methodology formal analysis data curation writing original draft writing review editing visualization project administration rohan s mehta methodology validation formal analysis writing original draft writing review editing visualization yu liu methodology software writing original draft mark w denny resources supervision writing review editing funding acquisition acknowledgments we would like to acknowledge the santa fe institute s complex systems summer school class of 2014 for their participation in the early development of the ideas for this project g de leo j watanabe and p roopnarine for their comments on early drafts of our manuscript and f king for her help collecting the field data that in part informed our model our work was funded by nsf ios 1655529 appendix a a 1 benefit cost ratio in terms of food found benefit cost ratio bcr as defined by eq 2 can be written as a function of food found f each of our simulations contained t 1000 time steps and during each time step a forager could move between food squares i e feeding steps between food free squares i e foraging steps or between food and food free squares the total distance traveled by the forager is the sum of the distance traveled while feeding and the distance traveled while foraging if we ignore steps that occur between food and food free squares the number of feeding steps will be approximately equal to f the number of times a food square was encountered except for the rare case in which a forager moves between two food patches in a single step the distance traveled per feeding step is approximately 1 and the distance traveled while feeding is approximately equal to f the distance traveled while foraging is equal to the average step length drawn from the step length distribution truncated by the detection of food patches multiplied by the number of foraging steps 1000 f the average step length is a function only of α and does not theoretically exist for the smallest values of α 1 1 1 3 and 1 5 however the finite landscape boundary and number of steps drawn from each theoretical distribution result in a defined mean k α thus bcr can be written as a1 b c r 1 1 1000 f 1 k α both k α and f decrease with increasing α additionally eq 2 indicates that bcr increases with increasing f but decreases with increasing k α the effect of α itself on bcr cannot be determined by this method because bcr increases with increasing f the effects of percent cover pc patch size μ radius of sensory perception r and angle of sensory perception θ on bcr should be the same as on f appendix b b 1 net rate of energy gain in terms of bcr in oft the net rate of energy gain nreg is defined as s6 n r e g e n e r g y g a i n e d t i m e e n e r g y l o s t t i m e if we assume our foragers travel at a constant speed s then our simulation requires one unit of time for each food square found f plus the amount of time it takes to travel path length d at speed s energy gained in our simulation is proportional to f and energy lost is proportional to d thus the net rate of energy gain in our simulation is s7 n r e g f d s d d s s b c r 1 this function monotonically increases with bcr note that if one unit of distance travelled costs r units of food found then the net rate of energy gain is s8 n r e g f s d r s s b c r r 1 which still increases monotonically with bcr appendix c c 1 rationale for a linear f pc consider a forager with no sensory perception r 0 that takes large steps with no directional bias θ 360 on a large landscape such that its behavior is approximately nondestructive the probability that this forager will find food during its next step is approximately independent of whether or not it found food during the previous step the probability that food is found during the next time step is approximately equal to the food density of the landscape thus the amount of food found by a forager in t foraging steps is the total number of landscape sites visited t 1000 multiplied by the probability that each landscape site has food pc 100 thus in this situation food found f increases linearly with percent cover pc with a slope of 10 we plotted f as a function of pc for all simulations in which the forager had no sensory perception r 0 and observed the predicted linear behavior fig a1 we found that our predicted slope of 10 best matched simulations of foragers with smaller values of α this makes sense because smaller values of α result in higher probabilities of drawing larger step lengths which more closely matches our assumptions for linearity and makes it less likely for a forager to revisit a consumed food patch c 2 rationale for a logarithmic f pc for foragers with sensory perception r 0 we expected to see diminishing returns for increasing values of pc these foragers do not need to explore large areas of the landscape and instead tend to fully consume a small area such that adding more food to the landscape does not improve their foraging efficiency as much as it would a forager lacking sensory perception r 0 thus we would expect to find a sublinear relationship between food found f and pc we plotted f as a function of pc for all simulations in which the forager had sensory perception r 0 and observed the predicted logarithmic behavior see for example fig a1 b we found that the logarithmic form best fit the data from foragers with strong sensory perception r 10 20 this makes sense because we would expect a stronger deviation for a linear pattern to be associated with a stronger deviation from the conditions that should yield that pattern that is deviation from r 0 c 3 lin log curve fitting and model selection based on the above analytical analyses and our observations of the data we decided that a linear logarithmic piecewise function or lin log would be a good alternative to purely linear and purely logarithmic models we fit linear logarithmic and lin log functions to f pc for each combination of pc α r μ and θ we considered then we compared the goodness of fit between all three models fig a1c we selected the coefficient of determination r² as our goodness of fit measure we did not penalize for model flexibility e g by using the akaike information criterion because our goal was purely to summarize our data and therefore there was no reason to prefer a less flexible model see appendix d supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 02 015 appendix d supplementary data the following is supplementary data to this article 
25050,animals must balance their rates of energetic intake and expenditure while foraging several mathematical models have been put forward as energetically optimal foraging strategies when the food environment is sparse i e the distance between food patches in the environment is much larger than the distance from which the forager can perceive food in particular lévy walks with a power law exponent approaching 1 are considered optimal for destructive foragers however these models have yet to explore the role of sensory perception in foraging success as the distance between food patches approaches the distance from which the forager can perceive food here we used an agent based modeling approach to address this question our results concur that lower values of the power law exponent i e values approaching 1 result in the most food found but in contrast to previous studies we note that in many cases lower exponents are not optimal when we consider food found per unit distance traveled for example higher values of the exponent resulted in comparable or higher foraging success relative to lower values when the forager s range of sensory perception was restricted to an angle 30 from its current heading in addition we find that sensory perception has a larger effect on foraging success than the power law exponent these results suggest that a deeper examination of how animals perceive food sources from a distance may affect longstanding assumptions regarding the optimality of lévy walk foraging patterns and lend support to the developing theoretical shift towards models that place increasing emphasis on how organisms interact with their environments keywords agent based model destructive foraging environmental heterogeneity lévy walk optimal search sensory perception 1 introduction all animals must find food in an energetically feasible manner in order to survive optimal foraging theory oft holds that animals seek to maximize their net rate of energy intake the difference between their energetic benefit in terms of calories nutrients etc and their energetic expenditure over time while searching for handling consuming and digesting food macarthur pianka 1966 oft transformed the field of foraging ecology stimulating both empirical and theoretical work on diet patch selection and residence time pyke 1984 however the issue of how animals should optimally move between food patches was initially underrepresented in the literature pyke 1978 1984 2015 but see cody 1971 root kareiva 1984 siniff jesson 1969 smith 1973 researchers observed that animals across taxa performed area restricted search ars they responded to encounters with food patches by transitioning from a rapid directed movement regime to one that was slow and tortuous e g banks 1957 benhamou bovet 1989 bond 1980 fielden et al 1990 hassell may 1973 mueller et al 2011 pyke 1978 thomas 1974 weimerskirch et al 2002 white et al 1984 but a true synthesis of optimal movement between food patches remained incomplete initial efforts to provide a theoretical basis for the observed ars patterns drew from simple random walk srw models cody 1971 kareiva and shigesada 1983 pyke 1978 siniff and jesson 1969 smith 1973 turchin 1998 viswanathan et al 2011 in which an animal s trajectory is discretized into a series of linear steps the step lengths are drawn from an exponential distribution and the step directions are chosen at random resulting in a forager whose mean squared displacement grows linearly with time and whose changes in direction are uncorrelated dray et al 2010 pyke 2015 viswanathan et al 2011 correlated random walk crw models elaborated on srws benhamou 2007 codling et al 2008 by incorporating some degree of correlation between the directions of successive steps this adjustment helped simulate the directional persistence that is characteristic of the movements of most organisms pyke 2015 most recently lévy walks also called lévy flights have been proposed as an alternative optimal search strategy viswanathan et al 1999 2000 one way in which lévy walks differ from srws and crws is that the length of each step is chosen from a probability distribution given by the power law distribution 1 p x c x α where c is a normalizing constant x is the step length and α 1 viswanathan et al 2000 1999 as α increases beyond 3 the lévy walk converges on brownian motion when α 3 a lévy walker has higher probabilities of taking very long steps than does a simple or correlated random walker in 1999 viswanathan et al proposed the lévy flight foraging hypothesis lffh which suggests that lévy walks with particular values of α should maximize the quantity of food found per distance traveled over time for foragers in environments with sparse randomly distributed food patches viswanathan et al 1999 2000 in the case of nondestructive foraging where food patches returned instantaneously to their ungrazed state after an encounter with a forager α 2 was optimal in the case of destructive foraging where food patches were completely depleted after an encounter with a forager an α value approaching 1 was optimal numerous subsequent studies found that a power law with an exponent of 2 best modeled in situ foraging behavior in a wide variety of taxa apparently in support of the lffh e g bartumeus et al 2010 de jager et al 2011 franks et al 2010 raichlen et al 2013 reynolds et al 2014 seuront stanley 2014 sims et al 2008 however other researchers reported contrasting results reynolds 2015 and raised concerns regarding the statistical procedures required to accurately identify power law distributions in empirical data clauset et al 2009 edwards 2008 edwards et al 2007 when more accurate procedures were used the outcomes of many studies in support of the lffh were overturned clauset et al 2009 edwards 2008 edwards et al 2007 for example the foraging times of unfenced deer dama dama were initially found to conform to a power law with α 2 edwards et al 2007 however reanalysis of the dataset using maximum likelihood and akaike weights found that deer foraging times were better modeled by an exponential rather than a power law distribution the same research team determined that bumblebee bombus terricola flight distances could be reasonably fit to a power law distribution however they recalculated α to be 3 68 rather than the original value of 3 5 in high food areas and 2 2 rather than the original value of 2 0 in low food areas edwards et al 2007 while it is critical that ecologists employ accurate statistical techniques to analyze their data it remains unclear to what extent changes in calculated α values actually reflect significant changes in the energy budgets of foraging animals for example in a biological system animals whose movements are best modeled by values of α that differ only slightly may experience negligible changes in foraging success with respect to long term fitness in addition α values do little to reveal the underlying mechanisms animals use when searching for food it is reasonable then to question how substantial changes to calculated α values must be to reflect changes in underlying mechanisms that result in the evolution of optimal foraging behavior in evaluating these mechanisms one must consider the assumptions of the lffh and the fact that they commonly have not been met by the species and systems used to test the hypothesis in empirical studies pyke 2015 reynolds 2015 viswanathan et al 1999 2000 assumed that the directions of successive animal movements were uncorrelated however even very simple organisms tend to exhibit directional persistence pyke 2015 additionally researchers have debated whether destructive or non destructive foraging is the more realistic assumption pyke 2015 and some have explored the effects of nondestructive foraging when food resources fully renew after some time lag raposo et al 2003 santos et al 2004 third the lffh specifically applies to organisms whose radius of sensory perception rv in viswanathan et al 1999 2000 is much less than the average distance traveled between food patches in their environment λ in viswanathan et al 1999 2000 while a movement strategy modeled by a power law with α 2 might be optimal when λ rv it is unclear how that optimal strategy shifts as λ approaches rv although numerous authors have stated that the influence of α on foraging efficiency should decrease as rv λ approaches 1 e g bartumeus et al 2008a james et al 2011 viswanathan et al 1999 2000 this has not been explicitly investigated finally an optimal movement strategy may be influenced by other factors not considered by viswanathan et al 1999 2000 and other similar studies for example many animals do not perceive food patches equally well in all directions rather they tend to perceive food patches that are in front of them where the majority of their sensory organs are located olden et al 2004 pelseneer 1906 zollner lima 1999 in many studies of foraging behavior see for example cody 1971 siniff jesson 1969 turchin 1998 viswanathan et al 1999 agent based models abms have provided valuable supplements to purely analytical and empirical investigations abms are flexible modeling frameworks that examine the properties that emerge from the actions of individual agents railsback and grimm 2011 tang and bennett 2010 in the context of foraging behavior agents search for food on a simulated landscape using a set of rules that may depend on the agent s internal psychological or physiological state nearby landscape features interactions with other agents and a set of navigational strategies nathan et al 2008 tang and bennett 2010 in this study we used an agent based modeling framework to simulate destructive foraging during single foraging bouts we sought to address three questions 1 which factor sensory perception or foraging movement pattern as summarized by the power law exponent α has the most influence on destructive foraging success across a range of food distributions 2 how does the influence of α on destructive foraging success change as the forager s range of sensory perception approaches and exceeds the distance between food patches 3 taking both foraging movement pattern and sensory perception into account can our model produce testable hypotheses regarding expected foraging behaviors in a model organism due in part to its prominence in the literature we expected that animal movement patterns would have the most influence on destructive foraging success with smaller α values resulting in greater success than larger ones however we also expected that food availability and sensory perception would interact with animal movements with larger values of both factors resulting in more foraging success than smaller values we anticipated that α would have the largest effect on foraging success when the forager s range of sensory perception was much less than the distance between food patches in its landscape and that this effect would become negligible as the forager s range of sensory perception approached and exceeded this distance finally we expected that our model would allow us to generate testable hypotheses about foraging behavior in a model organism the intertidal limpet patella vulgata linnaeus 2 materials and methods 2 1 model description to simulate single foraging bouts we used an agent based modeling framework varying the α value of the power law distribution used to model animal foraging movements hereafter referred to as foraging strategy the sensory abilities of the forager and the food distribution of the landscape 2 1 1 landscape generation we generated landscapes with food distributions that ranged from relatively sparse 1 food cover to relatively plentiful 15 food cover these values are within the range determined to be realistic and relevant by previous studies e g with king 1999 to do this we created 32 2 dimensional bounded landscapes and initialized each with an empty 500 500 grid of squares we then randomly added non overlapping food patches with side lengths μ of 1 2 5 or 10 grid units until the desired percent food cover was achieved the average minimum nearest neighbor distance between food patches on the resulting landscapes ranged from 0 60 to 50 82 grid units see table s 1 for details 2 1 2 forager characteristics each agent or forager was initialized with three inherent properties that governed its movements r and θ table 1 each forager drew its step lengths from a power law distribution eq 1 in this distribution the exponent α controls the size of the tail as α increases the size of the tail decreases as does the probability of the forager taking very long steps fig s 1 two parameters r and θ governed the ability of the forager to perceive food patches in its environment r is the forager s radius of sensory perception the direction of perception θ analogous to perceptual horizon in olden et al 2004 was limited to the forager s current heading plus or minus θ 2 θ 60 produced an anterior bias in perception while θ 360 produced no bias these values represented minimum and maximum cases the parameter values used in our simulations are summarized in table 1 2 1 3 simulating movement and food consumption our simulations were implemented in python 2 7 9 at the beginning of each simulation a single forager was randomly placed on a food free square in a landscape initial exploratory simulations determined that t 1000 time steps were sufficient to produce consistent results for each time step fig 1 1 the forager s maximum traveling distance x was drawn from a power law distribution with parameter α 2 the forager searched for food within the constraints of its range r and angle θ of sensory perception during the first time step the forager s angle of sensory perception was defined relative to an initial heading that was drawn randomly from a uniform distribution 3 if the forager could perceive a food square then it selected that square as its desired destination and moved toward it if the distance to this square was less than x the forager moved directly to the square and consumed the food otherwise the forager moved a distance x along the line connecting its current position and the desired position if the forager could perceive more than one food square it moved toward the nearest one in all of the above situations the forager s heading was redefined as the angle connecting the forager and the food square 4 if the forager could not perceive a food square it randomly chose a heading from one of two opposite facing von mises distributions fig 1 this strategy reflected the fact that animals tend to continue moving forward along their current path pyke 2015 but also occasionally reverse direction the von mises distribution closely approximates a normal distribution on a circle the probability of the forager drawing a heading of angle ϕ was defined as p φ h κ c κ e κ cos φ h where h is the angle the distribution is centered on κ is the concentration parameter describing how much of the distribution is aggregated around h and c κ is a normalizing constant with probability p the forager s heading was drawn from a von mises distribution centered on its current heading with concentration parameter k1 and with probability 1 p the forager s heading was drawn from a von mises distribution centered on the heading directly opposite from its current one with concentration parameter k2 table 1 the forager then moved incrementally along the chosen heading until a distance x was reached if the forager perceived a food square along its path of travel it stopped at the intermediate location food squares did not regenerate after consumption i e foraging was destructive we ran the above simulation 10 times on each of the 32 landscapes for every possible combination of the parameters α r and θ listed in table 1 2 1 4 simulation output after each simulation the track of the forager was recorded and two response variables were measured the total amount of food found f and the benefit cost ratio bcr f is the number of times a forager landed on and consumed a food patch bcr is a measure of foraging efficiency houston and mcnamara 2014 that in our case increases monotonically with the forager s net rate of energetic intake appendix b and is defined as the food gained by the forager per unit distance traveled over time or 2 b c r f t d t f d where d is the total distance traveled along the forager s path during the simulation and t 1000 time steps we used benefit cost ratio rather than cost benefit ratio because some simulations resulted in f 0 2 2 effect size of model factors to determine how the parameters in our simulations landscape α r and θ affected our two response metrics f and bcr we performed a five factor analysis of variance anova and a multiple linear regression with all interactions considered we designed our landscapes with two free variables percent cover pc and patch side length μ table 1 we performed anovas for each response metric over these two landscape parameters as well as the movement parameters α r and θ pc μ α and r were represented as continuous fixed factors while θ was represented as a categorical fixed factor all factors were centered by subtracting their mean value in modeling studies like ours it is possible to perform enough simulations to achieve any level of statistical significance white et al 2014 therefore instead of reporting anova f statistics and regression p values we reported the proportion of variation in each response metric explained by each factor and provided the estimated regression coefficients for each factor as a measure of effect size to explore how the influence of α on foraging success changed as the ratio of range of sensory perception to distance between food patches shifted from 0 to greater than 1 we first calculated the average minimum nearest neighbor distance nnd between patches for each of our 32 landscapes table s 1 we chose to use the average minimum nearest neighbor distance rather than the mean free path because we believed the former value would be more relevant to a forager moving from patch to patch we then calculated r nnd for each of our simulations a value analogous to rv λ in viswanathan et al 1999 2000 next for ease of visualization we divided this continuous variable into five categories the first four of these were determined by the quartiles of the ratio r nnd 0 r nnd 0 18 0 18 r nnd 0 73 0 73 r nnd 2 42 and r nnd 2 42 the fifth category contained all simulations in which r 0 and thus r nnd 0 these and subsequent analyses were performed in r 3 3 0 2 3 model fitting to simulated data to better understand the relationships between our five parameters and two response variables we chose to summarize the response variables as functions of the parameters the goal of this analysis was not to claim that these functional forms represent underlying mechanisms but rather to condense the behavior of the response variables into simple yet comprehensive representations to do this we investigated how the relationship between the amount of food found by a forager f and the percent cover of food in a landscape pc varied with simulated movement parameters α r and θ and patch size μ in general the relationship between f and pc followed a linear logarithmic functional form appendix c we then used linear regression to explore how changes in simulated movement parameters influenced the shape of the linear logarithmic fit 2 3 1 food found we demonstrate in appendix c that for both a forager with no sensory perception in any landscape and a forager with poor sensory perception in a sparse landscape we would expect f to be linear with respect to pc however for a forager with strong sensory perception in a dense landscape we would expect f to exhibit sublinear behavior with respect to pc because increasing food availability in this scenario will only marginally increase the probability of finding food based on these expectations we chose to compare linear logarithmic and piecewise linear logarithmic functions of f with respect to pc and found that the piecewise function was best as determined by the coefficient of determination r2 see appendix c the piecewise lin log function was defined as 4 f p c a p c f o r p c c b l o g p c c a c f o r p c c where a and b are coefficients to be fit and c is the point of transition between linear behavior and logarithmic behavior we fit a and b for fixed values of c over the entire range of pc values in steps of 0 01 choosing the value of c that minimized the root mean squared error of the fit fig 2 a variance on the estimate of c was approximated by bootstrapping n 200 to explore the relative roles of α r μ and θ in determining a b and c we performed multiple linear regressions with α r and μ as fixed continuous factors and θ as a fixed categorical factor purely additive models were used 2 3 2 benefit cost ratio eq 4 summarizes the behavior of f with respect to pc μ α r and we show in appendix a that bcr can be approximated as a function of f and α and so the behavior of bcr with respect to pc μ r and θ can be deduced directly from the behavior of f 2 4 hypothesis generation our final aim was to use pre existing data from a well studied model organism to generate testable hypotheses about that organism s foraging behavior to be a good fit to our model we required an animal with limited memory that forages for sessile food items in a 2 dimensional environment we chose to use the intertidal common limpet patella vulgata p vulgata lives on temperate rocky shores on the west coast of northern europe and can reach 25 mm in shell length hill 2008 it clings to the rock on which it lives with a large muscular foot and much like a terrestrial snail locomotes by undulating over a layer of secreted pedal mucus cook 1969 it forages for both microscopic and macroscopic algae during high tide cook 1969 and travels an average path distance of 0 4 m during foraging hartnoll and wright 1977 because of its relatively simple neurological structure 3 major paired ganglia located throughout the body pelseneer 1906 it is generally assumed that p vulgata s foraging patterns are not determined by memory in addition a recent study examined the step length distributions of 15 individual p vulgata during 9 nocturnal low tides and fit their step lengths to exponential power law and three and four tier weierstrassian lévy walk wlw models reynolds et al 2017 of the distributions that we consider here the authors found that a power law with an exponent near 1 was the best model this suggests that p vulgata is a good fit to our agent based model and provides us with some background information with which to form further hypotheses for example p vulgata s range of sensory perception and the food distribution in its habitat remain uncharacterized there is sufficient energetic data available in the existing literature to convert the bcr values from our simulations into values specific to p vulgata according to burrows et al burrows et al 2000 the standing crop of microalgae available to p vulgata individuals has an energetic content between 0 1 and 0 5 j mm2 if we set the scale of our landscapes to 0 5 m x 0 5 m then each square in the grid is 1 mm x 1 mm and this energetic content yields 0 1 0 5 j per square of food consumed additionally davies et al davies et al 1990 calculated that 23 of consumed energy is employed in mucus production the primary cost of limpet locomotion they also found the energetic content of mucus to be 8 984 kj g finally davies williams davies williams 1995 found that a closely related intertidal limpet cellana grata produces between 2 1 and 15 2 μg of mucus per millimeter traveled if we assume that food was high quality and travel required little mucus then our rescaled bcr value is 8 b c r p v u l g a t a f 0 5 0 23 d 2 1 8 984 if we assume that food was low quality and travel required little mucus then our rescaled bcr value is 9 b c r p v u l g a t a f 0 1 0 23 d 2 1 8 984 after converting bcr to values relevant to p vulgata we examined the foraging parameters pc μ α r and θ that resulted in energetically viable behavior b c r p v u l g a t a 1 there were no viable bcr values for scenarios in which travel required large quantities of mucus 15 2 μg mm 3 results 3 1 effects of model parameters in general food found f increased with increasing food availability pc and μ within this framework we expected that foraging strategy α would have the largest effect on foraging success followed by radius r and angle θ of sensory perception instead r was the largest contributor to variation in f fig 3 as expected larger r values resulted in larger quantities of food found fig 4 the power law exponent α was the next largest contributor with smaller α values generally resulting in more food found finally θ contributed the least amount of variation increasing θ from 60 to 360 increased the quantity of food found the main effects of pc μ α r and θ explained 63 66 of the variance in f interaction terms explained only an additional 2 22 bcr also increased with increasing percent cover pc fig 3 as was the case with food found radius of sensory perception r contributed most to variation in bcr and bcr increased with increasing r angle of sensory perception θ was the second largest contributor to variation but increasing θ from 60 to 360 only increased bcr when μ or r were large and α was small fig 4 finally α contributed the least amount of variation to bcr when r 0 smaller α values resulted in larger bcr however contrary to expectations larger values of α were best when r 0 the main effects of pc μ α r and θ explained 66 95 of the variance in bcr interaction terms explained an additional 8 01 we expected that lower values of α would result in larger benefit cost ratios when r nnd was near 0 but that this trend would disappear as r nnd approached and exceeded 1 to evaluate this hypothesis we plotted bcr as a linear function of α for each value of μ and θ and each category of r nnd fig 5 we found that α 1 1 did indeed maximize bcr when 0 018 r nnd 0 12 and that the slope of the relationship between bcr and α became more negative as μ and θ increased from 60 to 360 table s 2 we also expected that the slope of the relationship between bcr and α would approach 0 as r nnd approached and exceeded 1 in general when θ 360 the data conformed to this hypothesis however slopes did not increase monotonically with r nnd instead slopes of intermediate values of r nnd 0 12 r nnd 0 73 0 73 r nnd 2 42 tended to be more negative than those at the lowest values when θ 60 and μ 5 the slopes of the relationships between bcr and α were statistically indistinguishable from 0 table s 2 when μ 5 slopes were largest when r nnd exceeded 1 and were positive i e α 3 outperformed α 1 1 3 2 functional form analysis 3 2 1 food found our analysis of food found f using eq 4 allowed us to address how pc μ α r and θ affected the shape of the relationship between f and pc the transition point between linear and logarithmic behavior c of each fit to our model data increased as α increased and decreased as r increased θ and μ had no significant effect fig 2b our linear regression of c on r α μ and θ yielded coefficients of 0 26 p 0 001 2 00 p 0 001 0 001 p 0 981 and 0 04 p 0 919 respectively the slope of each lin log fit decreased with increasing α and increased with increasing r μ and θ fig 2c our linear regression of a on r α μ and θ yielded coefficients of 17 03 p 0 001 211 49 p 0 001 12 02 p 0 001 and 92 91 p 0 001 respectively finally the log coefficient b increased with higher values of α r μ and θ had no significant effect our linear regression of b on r α μ and θ yielded coefficients of 0 15 p 0 81 49 66 p 0 001 1 74 p 0 14 and 2 87 p 0 73 respectively 3 2 2 benefit cost ratio as bcr can be approximated as a function of f and α in which bcr increases monotonically with f for a given α value appendix a we did not conduct an additional analysis of bcr as a function of pc 3 3 hypotheses regarding p vulgata foraging when we assumed low food quality and low cost of travel after averaging across replicate simulations we obtained 27 combinations of pc μ α r and θ that resulted in energetically viable foraging b c r p v u l g a t a 1 in this scenario foragers required θ 360 and relatively high pc 9 or greater μ 5 or greater and r 10 or greater to be viable however all α values were indistinguishably effective when we assumed high food quality and low cost of travel after averaging across replicate simulations we obtained 1 339 combinations of parameters that resulted in energetic viability of these simulations none included r 0 fig 6 however for foragers with r 0 viable simulations existed for all pc values foragers with θ 360 were able to forage more effectively at lower pc especially if α was also low and the landscape had large food patches however for foragers with θ 60 all α values were indistinguishably effective especially if r was large greater than 5 and the landscape had smaller food patches 4 discussion our results suggest that a forager s movement strategy as defined by the power law exponent α is the least important contributor to foraging success when the energetic costs of movement are taken into account bcr instead food availability pc and the forager s range of sensory perception r are the most important quantities to consider in addition the degree to which α affects bcr depends on the size of food patches μ the forager s angle of sensory perception θ and the ratio of the forager s range of sensory perception to the distance between food patches r nnd in general α matters most when food patches are large the forager s angle of sensory perception is unbiased and r nnd is approximately between 0 and 2 finally when appropriately parameterized our model generates testable hypotheses on how animals may optimally interact with their environments while foraging taking into account food distribution range of sensory perception and energetic expenditures 4 1 effect of model parameters on foraging success our linear regression and analysis of variance results indicate that the power law exponent α should be given reduced emphasis in future studies characterizing the optimal foraging of animals quantifying α as a measure of optimality in foraging behavior is a simple and general approach that is understandably compelling because it is relatively easy to measure from animal track data which is becoming increasingly available wilmers et al 2015 in addition other methods to infer underlying behaviors from these data are still very much in development dodge et al 2013 fleming et al 2016 jonsen et al 2005 warwick evans et al 2015 measuring the exponent α provides a simple starting point and a general theoretical framework from which to form further hypotheses however we believe it may be misleading to evaluate the optimality of an animal s foraging strategy purely based on its exponent s value our data suggest that it would be more informative to characterize an animal s foraging environment and its ability to perceive food sources from a distance in addition to its movement patterns our model is distinct from viswanathan et al s original simulation viswanathan et al 1999 2000 in several ways we incorporated correlated turn angles and variation in food availability food patch size and range and angle of sensory perception a prior study found that broader turn angle distributions and turn angles that were more correlated through time resulted in increased foraging efficiency bartumeus et al 2008a based on this our use of a narrower turn angle distribution and turn angles that were correlated across successive time steps should have decreased and increased foraging efficiency respectively however since these changes were applied across all of our simulations the effects of turn angle distribution and correlation should be systematic and our results that consider the relative effects of pc μ α r and θ should remain comparable with prior work with respect to variation in food availability bartumeus et al 2008b determined that increasing food availability decreased the degree to which an α value near 1 outperformed α 3 they also found that the degree to which α near 1 outperformed α 3 was decreased when food patches were smaller relative to the forager s range of sensory perception our results corroborate both of these findings variation in angle of sensory perception has not previously been explored in the literature it has generally been assumed that all animals perceive food equally well in all directions e g bartumeus et al 2008a pyke 2015 viswanathan et al 1999 2000 however recent work has called for the incorporation of anisotropic and even context dependent perceptual ranges in foraging models olden et al 2004 we found that narrowing a forager s angle of sensory perception from 360 to 60 resulted in an overall decrease in bcr especially when patch sizes were larger and α values were smaller it is important to note that we did not test the effects of intermediate values of θ and therefore cannot fully define the relationship between it and bcr however this result remains worthy of consideration because many animals do not sense their environments equally well in all directions but rather have most of their sensory structures located anteriorly pelseneer 1906 given the impact of a reduced angle of sensory perception on foraging success it may be an informative addition to future simulations it has long been acknowledged that the ratio of radius of sensory perception to the distance foragers must travel between food patches r nnd in our case is an important indicator of foraging success e g benhamou 2007 raposo et al 2003 santos et al 2004 viswanathan et al 1999 2000 2011 and others essentially when this ratio is greater than or equal to 1 the forager should be able to perceive its next food patch from its current location however prior studies have only reported results from a limited range of ratios from approximately 1 104 to 1 10 bartumeus et al 2008a 2008b viswanathan et al 1999 2000 from this earlier work researchers concluded that α has the largest effect on foraging success at small ratios and that this effect becomes negligible as α approaches 1 bartumeus et al 2008a 2008b santos et al 2004 viswanathan et al 1999 2000 in this study we chose to explore this relationship explicitly testing r nnd values between approximately 0 02 and 34 our results generally confirmed prior work the slope of a linear regression of bcr against α becomes less negative and approaches 0 as r nnd increases however this increase in slope was nonlinear and in some cases α 3 outperformed α 1 1 in particular this occurred when r nnd was large and angle of sensory perception was anteriorly biased these results suggest that there are intermediate r nnd ratios where α values are more or less important to foraging success and that the assumption that all α values are always equally effective when r nnd 1 is inaccurate 4 2 hypothesis generation our model was designed to explore the relative contributions of foraging strategy power law exponent and range of sensory perception r θ to foraging success in a range of simulated environments but it can also be used as a hypothesis generation mechanism for particular organisms and environments to illustrate this we used existing data on the energetics of the intertidal limpet patella vulgata to parameterize our model we were able to hypothesize given a range of food qualities and energetic movement costs under which food distributions and foraging strategies p vulgata might be energetically viable b c r p v u l g a t a 1 because the foraging strategies of p vulgata have recently been characterized reynolds et al 2017 we can compare our results with empirical data reynolds et al 2017 examined the step length distributions of 15 individual p vulgata during 9 nocturnal low tides and fit them to exponential power law and three and four tier weierstrassian lévy walk wlw models of these distributions the three tier wlw model was the best fit to the data wlw models are outside the scope of this study however of the models we consider here reynolds et al 2017 determined that a power law with α 1 was best for this α value and a small patch size μ 1 our model suggests that p vulgata foraging would be energetically viable at r 2 and pc 15 or at r 10 and pc 3 regardless of angle of sensory perception increasing patch size would generally lower the pc at which foraging becomes viable and when patches are large μ 10 θ 360 would allow for viable foraging at lower pc even when r is small note that scenarios in which θ 60 are likely better models of p vulgata foraging success limpets like many other animals possess an anterior concentration of sensory structures and may not be able to perceive food equally well in all directions however our data show that θ 360 would generally allow p vulgata to be energetically viable with less food in its environment it is possible that these observations represent a trade off between the benefit of finding more food when θ 360 and the cost of supporting for instance sensory structures that are more equally distributed across the body we observed no scenarios in which a high energetic cost of limpet movement 15 2 μg mucus mm was energetically viable however our results represent the worst case scenario in terms of the energetics of limpet movement many species including p vulgata have been observed following mucus trails previously laid down by themselves by conspecifics and even by members of other limpet species chelazzi et al 1988 cook et al 1969 cook 1969 davies hawkins 1998 denny 1989 funke 1968 ng et al 2013 these mucus trails may substantially reduce the energetics of limpet movement davies blackwell davies blackwell 2007 for example found that energy expended on mucus decreased by 70 in the littorine snail littorina littorea when they were following a freshly laid trail in addition connor connor 1986 estimated that mucus trails generated by lottia gigantea l scabra and l digitalis persevere in the rocky wave swept intertidal environment for at least 7 days as such our results should be taken as a worst case scenario 15 2 μg mucus mm may very well be reduced to an energetically viable value when the prevalence of trail following the density of limpets and the persistence of mucus trails are taken into account 4 3 functional form analysis 4 3 1 food found a lin log model for food found as a function of percent cover suggested that foragers exhibited two movement modes one where food found f was linear with respect to percent cover pc and pc was low and one where f was sublinear approximately logarithmic with respect to pc and pc was high the first movement mode s linear accumulation of food was likely a signature of correlated random walk behavior see appendix c when pc was low e g 1 and patch size was large e g 10 units per side the average distance from a patch to its nearest neighbor was about 45 grid units this distance was farther than the distance from which any of our foragers could perceive food r nnd 1 meaning that at least one random step was likely to occur between food patches the smaller the values of r and θ the more random steps had to be taken between food patches α controlled the size of these random steps and therefore also played a significant role the second movement mode s logarithmic accumulation of food may indicate diminishing returns in this mode pc was relatively high and foragers with r 0 were likely to perceive the next food patch from the current one because of this adding more food squares to the landscape had a lower chance of increasing f than if the forager were performing a simple random walk visualizing tracks from foragers on high and low pc landscapes provided some evidence for this two mode mechanistic explanation of our results fig 7 however it is possible that f may not retain this lin log behavior at pc values greater than those explored in this study 4 3 2 benefit cost ratio we show in appendix a that bcr can be approximated as a function of f and α and so the behavior of bcr with respect to pc μ r and θ can be deduced directly from the behavior of f increasing r and μ or decreasing α therefore will increase bcr at low pc increasing r or decreasing α will increase the transition point between the two functions and increasing α will increase bcr at high pc however bcr also depends on the average step length used by the forager k α in equation a 1 this term counteracts the effect of α increasing bcr for smaller average step lengths and decreasing it for larger average step lengths the opposing effects of α and average step length result in a decreased influence of α on bcr relative to its influence on f 5 conclusions our agent based model allowed us to explore the relative roles of the power law exponent and sensory perception in efficient foraging but it did so by making a variety of assumptions about foragers and environmental features that may or may not apply to specific systems in particular our model is well suited for animals that lack spatial memory and forage in environments that can be approximated as 2 dimensional the assumption of memorylessness is common especially in invertebrate systems and many terrestrial and benthic marine and freshwater habitats can be considered 2 dimensional however these assumptions and others implicit in our model can be easily altered to suit a variety of research agendas this is the ultimate power of exploratory agent based models abms they are flexible can be tailored to specific systems and allow for the cycles of hypothesis generation and testing required to move from observations of animal movement to mechanistic explanations this repetitive testing is crucial in a field of study where it is increasingly clear that one simple model will not fit all cases nathan et al 2008 pyke 2015 in this study we conclude that lower values of the power law exponent maximize food found but that the effect of the exponent on benefit cost ratio depends strongly on food availability food patch size the forager s range of sensory perception and whether that range is anteriorly biased we also suggest that sensory abilities may play a more prominent role in determining foraging success than has previously been acknowledged in the literature these conclusions lend support to a developing paradigm shift in movement ecology researchers are increasingly moving away from simple probabilistic movement models and exploring agent based and inferential methods that place more emphasis on how organisms interact with their environments benhamou 2007 cody 1971 nathan et al 2008 plank james 2008 pyke 2015 reynolds 2009 reynolds 2015 reynolds 2018 siniff jesson 1969 in these models the internal state of the forager is constantly updated with information gleaned from biotic and abiotic features in the environment and movement patterns including those that appear to be lévy or lévy like are emergent properties of this information as this new paradigm develops simple models like the one presented here will serve as versatile testing grounds in an iterative hypothesis driven experimental process to help determine the key features of organismal movement credit authorship contribution statement diana e lascala gruenewald conceptualization methodology formal analysis data curation writing original draft writing review editing visualization project administration rohan s mehta methodology validation formal analysis writing original draft writing review editing visualization yu liu methodology software writing original draft mark w denny resources supervision writing review editing funding acquisition acknowledgments we would like to acknowledge the santa fe institute s complex systems summer school class of 2014 for their participation in the early development of the ideas for this project g de leo j watanabe and p roopnarine for their comments on early drafts of our manuscript and f king for her help collecting the field data that in part informed our model our work was funded by nsf ios 1655529 appendix a a 1 benefit cost ratio in terms of food found benefit cost ratio bcr as defined by eq 2 can be written as a function of food found f each of our simulations contained t 1000 time steps and during each time step a forager could move between food squares i e feeding steps between food free squares i e foraging steps or between food and food free squares the total distance traveled by the forager is the sum of the distance traveled while feeding and the distance traveled while foraging if we ignore steps that occur between food and food free squares the number of feeding steps will be approximately equal to f the number of times a food square was encountered except for the rare case in which a forager moves between two food patches in a single step the distance traveled per feeding step is approximately 1 and the distance traveled while feeding is approximately equal to f the distance traveled while foraging is equal to the average step length drawn from the step length distribution truncated by the detection of food patches multiplied by the number of foraging steps 1000 f the average step length is a function only of α and does not theoretically exist for the smallest values of α 1 1 1 3 and 1 5 however the finite landscape boundary and number of steps drawn from each theoretical distribution result in a defined mean k α thus bcr can be written as a1 b c r 1 1 1000 f 1 k α both k α and f decrease with increasing α additionally eq 2 indicates that bcr increases with increasing f but decreases with increasing k α the effect of α itself on bcr cannot be determined by this method because bcr increases with increasing f the effects of percent cover pc patch size μ radius of sensory perception r and angle of sensory perception θ on bcr should be the same as on f appendix b b 1 net rate of energy gain in terms of bcr in oft the net rate of energy gain nreg is defined as s6 n r e g e n e r g y g a i n e d t i m e e n e r g y l o s t t i m e if we assume our foragers travel at a constant speed s then our simulation requires one unit of time for each food square found f plus the amount of time it takes to travel path length d at speed s energy gained in our simulation is proportional to f and energy lost is proportional to d thus the net rate of energy gain in our simulation is s7 n r e g f d s d d s s b c r 1 this function monotonically increases with bcr note that if one unit of distance travelled costs r units of food found then the net rate of energy gain is s8 n r e g f s d r s s b c r r 1 which still increases monotonically with bcr appendix c c 1 rationale for a linear f pc consider a forager with no sensory perception r 0 that takes large steps with no directional bias θ 360 on a large landscape such that its behavior is approximately nondestructive the probability that this forager will find food during its next step is approximately independent of whether or not it found food during the previous step the probability that food is found during the next time step is approximately equal to the food density of the landscape thus the amount of food found by a forager in t foraging steps is the total number of landscape sites visited t 1000 multiplied by the probability that each landscape site has food pc 100 thus in this situation food found f increases linearly with percent cover pc with a slope of 10 we plotted f as a function of pc for all simulations in which the forager had no sensory perception r 0 and observed the predicted linear behavior fig a1 we found that our predicted slope of 10 best matched simulations of foragers with smaller values of α this makes sense because smaller values of α result in higher probabilities of drawing larger step lengths which more closely matches our assumptions for linearity and makes it less likely for a forager to revisit a consumed food patch c 2 rationale for a logarithmic f pc for foragers with sensory perception r 0 we expected to see diminishing returns for increasing values of pc these foragers do not need to explore large areas of the landscape and instead tend to fully consume a small area such that adding more food to the landscape does not improve their foraging efficiency as much as it would a forager lacking sensory perception r 0 thus we would expect to find a sublinear relationship between food found f and pc we plotted f as a function of pc for all simulations in which the forager had sensory perception r 0 and observed the predicted logarithmic behavior see for example fig a1 b we found that the logarithmic form best fit the data from foragers with strong sensory perception r 10 20 this makes sense because we would expect a stronger deviation for a linear pattern to be associated with a stronger deviation from the conditions that should yield that pattern that is deviation from r 0 c 3 lin log curve fitting and model selection based on the above analytical analyses and our observations of the data we decided that a linear logarithmic piecewise function or lin log would be a good alternative to purely linear and purely logarithmic models we fit linear logarithmic and lin log functions to f pc for each combination of pc α r μ and θ we considered then we compared the goodness of fit between all three models fig a1c we selected the coefficient of determination r² as our goodness of fit measure we did not penalize for model flexibility e g by using the akaike information criterion because our goal was purely to summarize our data and therefore there was no reason to prefer a less flexible model see appendix d supplementary data supplementary material related to this article can be found in the online version at doi https doi org 10 1016 j ecolmodel 2019 02 015 appendix d supplementary data the following is supplementary data to this article 
25051,algal atypical productivity also called eutrophication is a process where the phosphorus content in the water together with aquatic flora increases causing high chlorophyll levels and affecting the water quality and its possible applications therefore it is important to be able to anticipate such circumstance to avoid subsequent hazards in this paper a model that estimates the conditions where an abnormal growth of algae in reservoirs and lakes takes place is built this method combines artificial bee colony and support vector machines algorithms to predict the eutrophication taking into account physical chemical and biological data sampled in the englishmen lake and posterior analysis in a laboratory the support vector machines parameters are tuned by means of the artificial bee colony algorithm improving the accuracy of the procedure for comparison sake two other methods have been used to construct additional models the m5 model tree and multilayer perceptron network two objectives are covered by this study the forecasting of the algal proliferation by means of the model and the ranking of the relative importance of the independent variables indeed coefficients of determination of 0 92 for the chlorophyll and 0 90 for the total phosphorus concentrations were obtained using this hybrid method that optimizes the regression parameters furthermore the results obtained with m5 model tree and multilayer perceptron network techniques were clearly worse finally conclusions of this work are drawn in the final section keywords support vector machine svm artificial bee colony abc artificial neural networks anns m5 model tree algal atypical productivity in lakes regression analysis 1 introduction algal atypical proliferation also known as eutrophication has become one of the main issues for the water quality standards due to the damage caused by the overabundance of nutrients that modifies the right balance of the natural ecosystem in lakes and rivers reynolds 2006 it has various negative effects causes the color taste transparency and odor of lake water to change reduces the lake biodiversity and also results in supersaturation and deficits of oxygen in the surface water and bottom water layers respectively thus eutrophication is a type of water pollution due to the increase of nutrients in the water particularly phosphorus p and nitrogen n that causes the diminishing of the oxygen dissolved in the water turbidity growth of toxic alga and loss of aquatic flora and fauna species takaara et al 2010 specifically phosphorus is a necessary nutrient for plants to live and is the limiting factor for plant growth in most freshwater ecosystems scholten et al 2006 ansari and gill 2016 the availability of phosphorus generally promotes excessive plant growth and decay favoring simple algae and plankton over other more complicated plants and causes a severe reduction in water quality therefore these blooms are usually due to alterations in the physical chemical conditions in water bodies álvarez cobelas and arauzo 2006 paerl et al 2011 an additional important factor in water algal anomalous productivity is chlorophyll a chl a because it is an algae and macrophytes pigment and thus it is relevant in the process of algae growth gibson et al 2000 chen et al 2003 the progression of eutrophication symptoms is well described bricker et al 2003 reynolds 2006 and most eutrophication assessment methods recognize that the immediate biological response is increased primary production reflected as increased chlorophyll a chl a ferreira et al 2007 xiao et al 2007 apart from these variables other environmental factors such as water temperature ph dissolved oxygen secchi depth ammonium nitrogen etc can also highly affect the degree of algal proliferation wang et al 2008 in light of the complicated origins of algal abnormal growth for real water environment the development of quantitative relationships between a variety of environmental factors and eutrophic indicators is highly desirable for formulating strategies for the prevention of algae bloom the gathering of data for the study of algal abnormal growth can be done within a monitoring program kitsiou and karydis 2011 or as a particular project such data must contain ecological indicators karydis 2009 because they form the basis of a scoring system to characterize the trophic status reynolds 2006 especially for the implementation of the water framework directive wfd directive 2000 60 ec 2000directive 2000directive 2000 60 ec 2000 in this sense the analysis should include the estimation of the biovolumes hillebrand et al 1999 also algal abnormal productivity is a critical environmental problem in water bodies e g the englishmen lake see fig 1 because eutrophication affects the ecosystem health in particular the englishmen lake is prone to algal proliferation that produce hypoxia with all its associates processes díaz and rosenberg 2011 and growth of toxic alga moreover the complex mechanism of the algal abnormal growth has not been solved yet due to the nonlinear response of water quality for nutrient loading charpa 1997 however the fact is that the reduction of nutrient loads is essential to improve the water quality and ecological restoration of water bodies in this study we have used with success the application of support vector machines svms hybridized with artificial bee colony abc and for comparative purposes m5 model tree and multilayer perceptron mlp to estimate the eutrophication state in englishmen lake comparing the results obtained on the one hand the svm approach is and is a method that is based on the statistical learning theory that can be used for the estimation of relevant variables in very different fields álvarez antón et al 2013 cortes and vapnik 1995 hansen and wang 2005 hastie et al 2003 vapnik 1998 svms is used for classification and regression for multivariate functions with high degree of accuracy the structural risk minimization and statistical learning theory form the theoretical base of svm kecman 2005 furthermore a multilayer perceptron is a particular feedforward artificial neural network that is able to perform regressions the statistical learning theory also provides the foundations of mlps which have been used in very different areas fine 1999 hassoun 2003 haykin 1999 mlp trains the network using backpropagation mlp is a adaptation of the classic linear perceptron and it is able to process data nonlinearly separable the artificial bee colony abc technique was used to optimize the kernel svm hyperparameters the artificial bee colony algorithm is a swarm intelligence optimization method founded in the behavior of bee swarms in the search of food similar to other evolutionary computation algorithms such as particle swarm optimization pso clerc 2006 eberhart et al 2001 olsson 2011 or ant colony optimization dorigo and stützle 2004 abc exploits the model of social sharing of information karaboga and basturk 2007 simon 2013 yang et al 2013 according to previous studies the svm method has proven to be effective in the modeling of natural parameters and has been successfully used in the environmental problems such as the assessment of air quality garcía nieto et al 2013 the modeling of forest garcía nieto et al 2012 or the estimation of solar radiation zeng and qiao 2013 additionally the m5 model tree is a regressor based on decision trees m5 tree was invented by j r quinlan quinlan 1992 m5 tree falls within the cart tree breiman et al 1984 type of algorithms because it chooses as impurity function the mean squared error it differs from the cart model in that it builds multivariate linear regression model and it does not attach a constant to the leaf node the m5 model tree is thus analogous to piecewise linear functions another advantage of m5 over cart is that the generated models are much smaller but more accurate quinlan 1992 in summary the organization of this paper is as follows materials methods and dataset are described in section 2 the results of the svm model hybridized with abc are presented discussed and compared with the mlp technique and m5 model tree in section 3 finally the main conclusions of this research work are exposed in section 4 2 materials and methods 2 1 study area the englishmen lake is a water body located in the camargo municipality autonomous community of cantabria spain 5 5 km away from the port city of santander fig 1 c it was created for an old mining exploitation it now collects water from the surrounding water table and has naturally evolved into a lake of high ecological value as winter migratory birds e g anser anser make use of it the study area is located on the eastern edge of the asturian massif from the stratigraphic point of view the materials with the highest permeability values in this study area are the quaternary deposits and the terraces located on the slopes in addition to the calcareous formations in the area two aquifers have been differentiated the quaternary detritic aquifer and the jurassic calcareous aquifer the first is mainly made up of sands gravels and silts with an average thickness between 6 and 8 m the jurassic calcareous aquifer includes the carbonated formations of the upper lias between both aquifers there is a direct water connection so that the discharge of the calcareous aquifer takes place through the quaternary aquifer these aquifers belong to the puerto del escudo underground water body with minimum storage capacity for the entire water body is about 68 5 10 6 m3 the englishmen lake occupies a water area of 13 6 10 4 m2 and has a maximum depth of 6 m 2 2 experimental dataset the data for the analyses were collected from 2006 to 2014 from samples taken from englishmen lake resulting in 244 different processed samples it gives quantitative information about the phytoplankton species specifically samples were usually taken more than once per month and the protocols of the spanish ministry of agriculture fishing food and environment were followed world health organization 1998 willame et al 2005 the sampling is taken with a niskin bottle in the greatest depth point of the lake being this found using a depth gauge the niskin bottle is an evolution of the nansen bottle it is a tube open at both ends with a cap at each one that can be applied with a tensioned elastic rope samples are taken at different depths within the zone that is exposed to enough sunlight for photosynthesis to happen which is called the euphotic zone this zone is defined with the secchi disk that determines the secchi depth as that where the secchi disk cannot be viewed due to the turbidity of the water this depth is an indicator of the transparency of the water the biological data were calculated from five subsamples taken at equal intervals of depth in the euphotic zone brönmark and hansson 2005 in this study the physical chemical variables measured in limnological studies were used gault and marler 2009 negro et al 2000 they were analyzed in an iso 17025 accredited laboratory and the standard procedures for the examination of water and wastewater were followed american public health association 2005 the objective of this work is to study the relationship between algal atypical proliferation indicators and the independent variables there are many physical chemical and biological variables involved in the eutrophication of a lake thus the first step is the selection of the variables for the model an expert criterion was used in this work the estimated variables are related to the algae proliferation that are used to evaluate algal anomalous algal growth in water bodies chlorophyll concentration chl a μg l and total phosphorus mg p l chlorophyll concentration is biomolecule directly related to photosynthesis the process where energy from light is obtained total phosphorus is a nutrient for aquatic organisms the independent variables are biological parameters euglenophytes mm3 l see fig 2 a cyanobacteria mm3 l see fig 2 b dinophlagellata mm3 l see fig 2 c chlorophytes mm3 l see fig 2 d diatoms mm3 l see fig 2 e chrysophytes mm3 l see fig 2 f and cryptophytes mm3 l see fig 2 g physical chemical parameters dissolved oxygen concentration mg o2 l turbidity ntu nitrate concentration mg no3 l ammonium ion concentration mg l conductivity μs cm water temperature ºc and ph 2 3 computational procedure 2 3 1 support vector machine svm method support vector machines are used for classification and regression and belong to the supervised learning methods cristianini and shawe taylor 2000 schölkopf et al 2000 the svms were intended for classification and only later they were generalized for regression problems chen et al 2013 nikoo and mahjouri 2013 ortiz garcía et al 2010 pal and goel 2007 shrestla and shukla 2015 zeng and qiao 2013 being then called support vector regression svr the svr model does not use the whole training data because the cost function ignores within a threshold ε the samples too close to the model if the data is non linear but separable the kernel trick can be used many regression problems cannot be linearly treated in the space of the independent values x but can be translated to a higher dimensionality feature space if a suitable mapping x ψ x is given cristianini and shawe taylor 2000 ortiz garcía et al 2010 schölkopf et al 2000 shrestla and shukla 2015 where an adequate regression can be obtained in svr we wish to predict a real valued output y for the observed value t so that our training data is a set of l points of the form x i t i where i 1 2 l y ℜ x ℜ d cristianini and shawe taylor 2000 nikoo and mahjouri 2013 ortiz garcía et al 2010 pal and goel 2007 schölkopf et al 2000 shrestla and shukla 2015 steinwart and christmann 2008 so that 2 y i w x i b where denotes the dot product x i is a d dimensional real input vector w is a vector normal to the maximum margin hyperplane and yi is the predicted output value the parameter b w is used to determine the offset of this plane from the origin and along the normal vector w the svr uses a penalty function where the error of corresponding to the predicted value y i is not taken into account if it is less than a distance ε away from the observed value t i i e if t i y i ε we can see in fig 3 the region where y i ε i that is called ε insensitive tube also the dependent variables outside the tube are placed in one of two slack variable penalties depending on whether they are above ξ or below ξ the tube with ξ 0 ξ 0 i 3 t i y i ε ξ 4 t i y i ε ξ we are trying to find a function that can accurately estimate new values from a set of new independent variables to this aim the svm model is trained in the so called training set at this stage the error function is sequentially optimized two different types of error functions are defines and consequently to kind of svm models can be defined a regression svm type 1 also known as ε svm regression for this type of svm we have to solve an optimization problem minimizing the following general risk function cristianini and shawe taylor 2000 hansen and wang 2005 heddam and kisi 2018 schölkopf et al 2000 steinwart and christmann 2008 5 r w b ξ 1 2 w 2 c i 1 l ξ i ξ i where c is the penalization or cost parameter to control the training errors that is to say c measures a trade off between the empirical error and the model complexity and subject to 6 w ψ x i b y i ε ξ i y i w ψ x i b ε ξ i ξ i ξ i 0 i 1 l regression svm type 2 also known as ν svm regression for this svm model it is necessary to solve the following optimization problem minimizing the following general risk function cristianini and shawe taylor 2000 hansen and wang 2005 heddam and kisi 2018 schölkopf et al 2000 steinwart and christmann 2008 7 r w b ξ 1 2 w 2 c ν ε 1 l i 1 l ξ i ξ i being c again the penalty parameter indeed c determines the trade off between the margin model flatness and the magnitude of the slack variables training error and subject to 8 w ψ x i b y i ε ξ i y i w ψ x i b ε ξ i ξ i ξ i 0 i 1 l where ψ x z is a mapping of the independent variables space into a larger dimension space z where an inner product is defined using a positive definite function k kernel trick hansen and wang 2005 schölkopf et al 2000 steinwart and christmann 2008 9 ψ x ψ x i ψ i x ψ i x k x x in fact if a function satisfies mercer s condition chen et al 2013 hansen and wang 2005 steinwart and christmann 2008 then it is an allowable support vector kernel furthermore as this problem is quadratic with linear constraints the optimality conditions of karush kuhn tucker are necessary and sufficient and the solution which is a linear combination of a subset of sample points denominated support vectors s v can be obtained from the dual problem as follows 10 w s v β i ψ x i f w b x s v β i ψ x i ψ x b s v β i k x i x b it is important to select an appropriate kernel function because the kernel function defines the space in which the dataset is regressed examples of kernel functions rbf radial basis function 11 k x i x j e σ x i x j 2 polynomial 12 k x i x j σ x i x j a b sigmoid 13 k x i x j tanh σ x i x j a being a b and σ the kernel parameters 2 3 2 the artificial bee colony abc algorithm the algorithm artificial bee colony abc is swarm intelligence optimization algorithm that relies in the behaviour of bee swarms searching for food sources karaboga and basturk 2007 karaboga and akay 2009 karaboga and gorkemli 2014 simon 2013 yang et al 2013 in this evolutionary algorithm a population of possible solutions evolves with the iterations toward the optimum using a strategy that involves some random component karaboga and basturk 2007 karaboga and akay 2009 karaboga and gorkemli 2014 artificial bee colony algorithm is a swarm based algorithms which is characterized by the sharing of information between the individuals in the swarm or population indeed the bee colony has three groups of bees employed onlookers and scouts an employed bee is assigned to a food the so called employed bees fly to their food source and return to inform the hive with a dance onlookers choose food sources depending on dances if the food source is not good enough it is abandoned and the employed bee becomes a scout and searches a new food source therefore abc considers three phases karaboga and basturk 2007 simon 2013 yang et al 2013 searching or the employee bee phase the process to find nectar source that is to say each food source is foraged by employee bees recruiting or the onlooker bee phase they choose a food source watching the dance of employed bees within the hive the foraging is supervised and sometimes corrected by the onlooker abandon or the scout bee phase the depleted sources are discarded and the scout bees search for new food sources the n food sources the vectors p i represent the possible set of parameters it is a position in the space of possible solutions the dimension of the food source is the number of parameters we are optimizing the food sources are initialized randomly in a plausible hypercube and their fitness is evaluated if f is the objective function the fitness of a food source is see fig 4 14 f i t n e s s f p i 1 1 f p i i f f p i 0 1 f p i i f f p i 0 i 1 n as the objective function decreases the fitness function increases we are minimizing if we want to maximize a function g the objective function must be f g and then a maximum of g is a minimum of f 2 3 2 1 the employee bee phase in this phase the employee bees searches food sources introduces a tentative variation of every i food source following the equation karaboga and basturk 2007 simon 2013 yang et al 2013 15 v i j p i j r i j p k j p i j where j is one of the parameters chosen randomly that we are trying to modify k a food source different from i also randomly chosen and rij a real number drawn from 1 1 once v i j has been computed its fitness is calculated if it is higher than the fitness f p i j its value is swapped with v i j and the trial counter is reinitialized if it is smaller the trial counter is increased and there is no change in this food source 2 3 2 2 the onlooker bee phase we draw a number r i in 0 1 for each food source p i we try to change one parameter in the food source if r i p r o b i we compute p r o b i from the fitness of the food source karaboga and basturk 2007 simon 2013 yang et al 2013 16 p r o b i 0 9 f i t n e s s f p i max k 1 n f i t n e s s f p k 0 1 2 3 2 3 the scout bee phase a food source is abandoned if given a number of trials it does not improve its fitness once a food source is discarded a new one is chosen randomly for each iteration the provisional optimum is the food source with the highest fitness karaboga and basturk 2007 simon 2013 yang et al 2013 this continues until a stopping condition is satisfied in the present case the stopping condition has been a maximum number of iterations and a difference of fitness for the best food source between consecutive iterations under a threshold for a fixed number of iterations 2 4 neural network multilayer perceptron neural network models were inspired by the biological neuron model based on the work of the psychiatrist warren mcculloch and the mathematician walter pitts in the 1940s fine 1999 haykin 1999 the multilayer perceptron mlp consists of an input layer an output layer and also in between some hidden layers with nonlinearly activating nodes fine 1999 the nodes in each layer connect with a certain weight w i j synaptic weight to all the nodes in the next layer perceptron learning occurs through changes in the connection weights after items of data are processed that depend on the error in the output compared to the expected result this is an example of supervised learning and it is performed through backpropagation a generalization of the least mean squares algorithm in the linear perceptron a multilayer perceptron mlp is a feedforward artificial neural network able to perform regressions and is a modified linear perceptron in studying the functional model of neural networks we focus on feedforward networks whose architecture can be represented in an acyclic manner so that each node is not backpropagated as shown in fig 5 with specific activation functions and weights with fixed values the network create the function f x r n y r c that can be expressed fine 1999 haykin 1999 17 f x ϕ ψ x ϕ ψ x ϕ x r n u r m ψ u r m y r c where u the characteristics space that is the space of hidden variables given the architecture fine 1999 haykin 1999 ψ j x ψ w j t x w j 0 ψ is the hidden layer unit activation function where w j r n is the vector of parameters for the units and w j 0 r is its threshold value the ψ function can be hyperbolic tangent logistical or sigmoid ϕ j u ϕ c j t u c j 0 ϕ is the activation function for the output layer units and c j r m is the vector that contains the weights for the units being c j 0 r is its threshold value the identity function any dichotomous or heaviside function are usually used as activation function ϕ and thus the mlp implemented function is fine 1999 haykin 1999 18 f x j 1 m c j ψ w j t x w j 0 c 0 2 5 m5 model tree m5 model tree was developed from binary decision tree linear regression functions are found at the terminal leaf nodes with relationship between predictor and predicted variables quinlan 1992 it differs from decision tree in that it can also be used for numerical data mitchell 1997 quinlan 1992 m5 model tree generation has two steps rahimikhoob et al 2013 solomatine and xue 2004 first data are split into subsets and then a decision tree is created the standard deviation reduction sdr is used for splitting the data and can be calculated as pal and deswal 2009 heddam and kisi 2018 19 s d r s d t t i t s d t i where sd is the standard deviation t i is a subset of samples with the ith outcome of the set and t is the set of samples in the node rahimikhoob et al 2013 the splitting criterion depends on calculating the expected reduction in this error due to the testing of each attribute at that node after the splitting the data in child nodes have less error in compared to parent nodes m5tree keeps the one that optimizes the expected error reduction after trying all the possible splits this division can generate a huge tree like structure with poor generalization ability to overcome this problem the over grown tree is pruned and the linear regression functions replaced this method increases the variables space into areas subspaces and constructs a linear regression model for each one pal 2006 further details of an m5tree can be obtained from quinlan quinlan 1992 2 6 the goodness of fit of this approach the coefficient of determination r 2 was the metric used for the goodness of fit for each observed value t i in the data there is an associated modelled value y i called predicted values the variability of the data is measured with different formulas wasserman 2003 s s t o t i 1 n t i t 2 the total sum of squares directly related with the sample variance s s e r r i 1 n t i y i 2 the residual sum of squares s s r e g i 1 n y i t 2 the explained sum of squares where t is the mean of the n samples 20 t 1 n i 1 n t i the coefficient of determination is defined as 21 r 2 1 s s e r r s s t o t if the coefficient of determination equals 1 0 it would mean that the predicted values coincide with the observed ones two additional criteria considered in this study were the root mean square error rmse and mean absolute error mae hastie et al 2003 wasserman 2003 these statistics are also used frequently to evaluate the forecasting capability of a mathematical model indeed the root mean square error rmse and mean absolute error mae are given by the expressions freedman et al 2007 wasserman 2003 22 rmse i 1 n t i y i 2 n 23 mae i 1 n t i y i n if the root mean square error rmse has a value of zero it means that there is no difference between the predicted and observed data mean absolute error mae is the average vertical distance between each point and the identity line mae is also the average horizontal distance between each point and the identity line mae has a clear interpretation as the average absolute difference between t i and y i 3 analysis of results and discussion the physical chemical can be seen in table 1 and the biological variables are shown in table 2 allman and rhodes 2003 the number of input variables in the abc svm m5 model tree and mlp model was 15 see tables 1 and 2 the predicted variables chl a and total phosphorus have been measured in μg l and mg p l allman and rhodes 2003 barnes and chu 2010 respectively in this study three different models have been constructed specifically in this research the novel hybrid abc svm m5 model tree and mlp with predicted variables the chl a and total phosphorus and predictor variables the other sixteen biological and physical chemical parameters input variables using the coefficient of determination r 2 as criterion to assess the success of each model also the svm methods depend on the svm hyperparameters ε that characterizes the ε insensitive tube the regularization factor c see eqs 5 and 7 a b and σ that are the parameters of kernel to improve the defect hyperparameters some of the methods commonly used are cristianini and shawe taylor 2000 hansen and wang 2005 wu 2009 random search grid search genetic algorithms particle swarm optimization pso and so on usually the traditional way of performing hyperparameter optimization has been grid search or a parameter sweep which is simply an exhaustive searching through a manually specified subset of the hyperparameter space of a learning algorithm indeed the grid search is a brute force method and as such almost any optimization method improves its efficiency in this research work the artificial bee colony abc algorithm was applied olsson 2011 thus we have chosen abc optimization technique as an efficient and simple technique álvarez antón et al 2013 fine 1999 haykin 1999 kecman 2005 for adjusting the svr parameters fig 6 shows the flowchart of this abc svm model the food sources x i are vectors that consist in sets of hyperparameters to adjust for instance x i c i ε i σ i is the set of parameters associated with svm with the rbf kerne in this study we have 20 food sources we initialize their values randomly in the first iteration following the equations that regulate the abc algorithm described previously the food sources are updated in each step the cost function value for each set of hyperparameters is computed the cost function value is the minus ten cross validation efron and tibshirani 1997 picard and cook 1984 with this aim the set of samples is split in 10 sets the svm is trained with a set consisting of 9 of this subsets and a model is built this model is tested with the remaining set and the corresponding coefficient of determination is calculated this process is done for each of the 10 sets and when the full cycle is completed each food source is associated with its corresponding mean coefficient of determination if the termination criteria are satisfied the global best x i that is the food source with the best fitness is the set of optimized parameters álvarez antón et al 2013 hastie et al 2003 libsvm library chang and lin 2011 has been used to construct the regression model and the parameters have been optimized with the abc technique using the abc version for matlab karaboga and basturk 2007 abc is used to optimize the svm hyperparameters the abc looks for the best hyperparameters i e for rbf kernel c σ and ε computing the fitness in every iteration where the fitness factor is constructed using the coefficient of determination r 2 as significant changes in the regression only take place when there is a change in the magnitude order of the parameters the parameters have been considered powers of ten and the searching space has been that of the exponents that is for instance in the rbf kernel case the searching space has been 6 4 10 4 20 4 and then c values move in the interval 10 6 10 4 σ values vary in 10 10 10 4 and finally ε values are drawn from 10 20 10 4 the number of food sources has been 20 and the stopping criterion is met if there is no improvement within a threshold of 10 6 of in the r 2 after ten iterations with a limit for the number of iterations equal to 500 table 3 shows the optimal hyperparameters obtained with the abc svm models for the total phosphorus an imac with a cpu intel core i5 4570 at 3 2 ghz with 8 gb of ram was used taking 149 s to obtain the chlorophyll model and 806 s for the total phosphorus model for comparison purposes m5 tree and a multilayer perceptron mlp models have been built for the total phosphorus as output variable in order to predict the algal anomalous growth in the englishmen lake an artificial neural network ann see fig 5 is constructed using three different parameters fine 1999 haykin 1999 the learning rate that regulates the update of the interconnection weights the number of hidden layers the momentum factor that controls the oscillation of weight changes of the ann and the activation function that converts a neuron s weighted input to its output the obtained ann optimal parameters for the multilayer perceptron mlp appears in table 4 table 5 shows the coefficients of determination and correlation for the abc rbf svm model multilayer perceptron and m5 tree model fitted for the total phosphorus in this study the svm with the rbf kernel function gets the highest goodness of fit for estimating the total phosphorus to assess the state of eutrophication with a coefficient of determination r 2 equal to 0 90 and a correlation coefficient r of 0 95 these results mean a good agreement is obtained between predicted and observed data following the same methodology for the second dependent variable chlorophyll concentration we have obtained the results shown below indeed table 6 shows the optimal hyperparameters obtained with the abc svm models for the chlorophyll concentration additionally another multilayer perceptron mlp and another m5 tree model were built for the chlorophyll output variable in order to predict the algal atypical proliferation in the englishmen the ann optimal parameters for this same variable using multilayer perceptron mlp are shown in table 7 table 8 shows the determination and correlation coefficients for abc rbf svm mlp and m5 tree models for the chl a variable similarly taking into account our previous statistical calculations again the abc rbf svm is the model with higher goodness of fit for estimating the chlorophyll concentration to predict the algal anomalous growth with a coefficient of determination r 2 equal to 0 92 and a correlation coefficient r equal to 0 96 an also there is a good agreement between the model and the observed data the nine input variables for the total phosphorus first output variable have been ranked by their importance in this complex nonlinear problem and this ranking is shown in table 9 and fig 7 in the same way the fifteen predictor variables in the chlorophyll concentration model importance ranking is shown in table 10 and fig 8 finally this work estimates the total phosphorus using the abc rbf svm model quite accurately fig 9 shows the comparison between observed and predicted total with m5 tree mlp and abc rbf svm models thus a svm model with a abc optimization method is a good choice to achieve a good approximation to the nonlinearities in this regression problem similarly fig 10 shows the comparison between observed and predicted chlorophyll concentration values with m5 tree mlp and abc rbf svm models again abc svm model is a good choice to achieve a very effective approach to the algal abnormal growth in water bodies such as the englishmen lake 4 conclusions from the experimental and numerical results the following conclusions can be drawn firstly algal abnormal growth or eutrophication is a very prevailing and severe problem in water bodies such as reservoirs and lakes the assessment methods that use sampling and the following analysis are expensive thus an alternative technique such as the abc rbf svm method is a good option to study the algal atypical productivity in the englishmen lake secondly an abc rbf svm model successfully predicts the algal anomalous concentration from the other and easier to measure input variables lowering the costs of its assessment thirdly a coefficient of determination of 0 90 was obtained for the abc rbf svm model that estimates the total phosphorus indeed the predicted values match consistently the values in the dataset of observed total phosphorus see fig 7 also a coefficient of determination of 0 92 was obtained for the abc rbf svm model that predicts the chlorophyll concentration thus the estimated results for the algal growth corresponding to this output variable are in accordance with the dataset fourthly predictor variables of the algal atypical growth have been ranked in order of relative importance this is one of the main findings of this work being water temperature variable the most important in the estimation of the total phosphorus on the other hand the euglenophytes plays a significant role in the chlorophyll concentration also important variables in the prediction of total phosphorus and chlorophyll concentration are the turbidity and dinophlagellata concentration respectively finally the hyperparameters affects significantly the final model and its setting is fundamental in summary other eutrophication processes with the same or different pollution sources can benefit from the use of these techniques but it must always be taken into account the particular circumstances of each location regarding the applicability and transferability of the established model since the cantabrian basin authority manages a specific geographical area with relatively homogeneous environmental conditions atlantic climate for similar lakes in this geographical area the predictions are expected to be valid within the scope of this particular geographical area thus an abc svm model is a good approach to the prediction of algal abnormal productivity in water bodies acknowledgements authors acknowledge the support by the cantabrian basin authority spanish ministry of agriculture fishing food and environment that provided the pollutant data in the englishmen lake located in autonomous community of cantabria northern spain additionally we thank anthony ashworth for his revision of the english in the manuscript 
25051,algal atypical productivity also called eutrophication is a process where the phosphorus content in the water together with aquatic flora increases causing high chlorophyll levels and affecting the water quality and its possible applications therefore it is important to be able to anticipate such circumstance to avoid subsequent hazards in this paper a model that estimates the conditions where an abnormal growth of algae in reservoirs and lakes takes place is built this method combines artificial bee colony and support vector machines algorithms to predict the eutrophication taking into account physical chemical and biological data sampled in the englishmen lake and posterior analysis in a laboratory the support vector machines parameters are tuned by means of the artificial bee colony algorithm improving the accuracy of the procedure for comparison sake two other methods have been used to construct additional models the m5 model tree and multilayer perceptron network two objectives are covered by this study the forecasting of the algal proliferation by means of the model and the ranking of the relative importance of the independent variables indeed coefficients of determination of 0 92 for the chlorophyll and 0 90 for the total phosphorus concentrations were obtained using this hybrid method that optimizes the regression parameters furthermore the results obtained with m5 model tree and multilayer perceptron network techniques were clearly worse finally conclusions of this work are drawn in the final section keywords support vector machine svm artificial bee colony abc artificial neural networks anns m5 model tree algal atypical productivity in lakes regression analysis 1 introduction algal atypical proliferation also known as eutrophication has become one of the main issues for the water quality standards due to the damage caused by the overabundance of nutrients that modifies the right balance of the natural ecosystem in lakes and rivers reynolds 2006 it has various negative effects causes the color taste transparency and odor of lake water to change reduces the lake biodiversity and also results in supersaturation and deficits of oxygen in the surface water and bottom water layers respectively thus eutrophication is a type of water pollution due to the increase of nutrients in the water particularly phosphorus p and nitrogen n that causes the diminishing of the oxygen dissolved in the water turbidity growth of toxic alga and loss of aquatic flora and fauna species takaara et al 2010 specifically phosphorus is a necessary nutrient for plants to live and is the limiting factor for plant growth in most freshwater ecosystems scholten et al 2006 ansari and gill 2016 the availability of phosphorus generally promotes excessive plant growth and decay favoring simple algae and plankton over other more complicated plants and causes a severe reduction in water quality therefore these blooms are usually due to alterations in the physical chemical conditions in water bodies álvarez cobelas and arauzo 2006 paerl et al 2011 an additional important factor in water algal anomalous productivity is chlorophyll a chl a because it is an algae and macrophytes pigment and thus it is relevant in the process of algae growth gibson et al 2000 chen et al 2003 the progression of eutrophication symptoms is well described bricker et al 2003 reynolds 2006 and most eutrophication assessment methods recognize that the immediate biological response is increased primary production reflected as increased chlorophyll a chl a ferreira et al 2007 xiao et al 2007 apart from these variables other environmental factors such as water temperature ph dissolved oxygen secchi depth ammonium nitrogen etc can also highly affect the degree of algal proliferation wang et al 2008 in light of the complicated origins of algal abnormal growth for real water environment the development of quantitative relationships between a variety of environmental factors and eutrophic indicators is highly desirable for formulating strategies for the prevention of algae bloom the gathering of data for the study of algal abnormal growth can be done within a monitoring program kitsiou and karydis 2011 or as a particular project such data must contain ecological indicators karydis 2009 because they form the basis of a scoring system to characterize the trophic status reynolds 2006 especially for the implementation of the water framework directive wfd directive 2000 60 ec 2000directive 2000directive 2000 60 ec 2000 in this sense the analysis should include the estimation of the biovolumes hillebrand et al 1999 also algal abnormal productivity is a critical environmental problem in water bodies e g the englishmen lake see fig 1 because eutrophication affects the ecosystem health in particular the englishmen lake is prone to algal proliferation that produce hypoxia with all its associates processes díaz and rosenberg 2011 and growth of toxic alga moreover the complex mechanism of the algal abnormal growth has not been solved yet due to the nonlinear response of water quality for nutrient loading charpa 1997 however the fact is that the reduction of nutrient loads is essential to improve the water quality and ecological restoration of water bodies in this study we have used with success the application of support vector machines svms hybridized with artificial bee colony abc and for comparative purposes m5 model tree and multilayer perceptron mlp to estimate the eutrophication state in englishmen lake comparing the results obtained on the one hand the svm approach is and is a method that is based on the statistical learning theory that can be used for the estimation of relevant variables in very different fields álvarez antón et al 2013 cortes and vapnik 1995 hansen and wang 2005 hastie et al 2003 vapnik 1998 svms is used for classification and regression for multivariate functions with high degree of accuracy the structural risk minimization and statistical learning theory form the theoretical base of svm kecman 2005 furthermore a multilayer perceptron is a particular feedforward artificial neural network that is able to perform regressions the statistical learning theory also provides the foundations of mlps which have been used in very different areas fine 1999 hassoun 2003 haykin 1999 mlp trains the network using backpropagation mlp is a adaptation of the classic linear perceptron and it is able to process data nonlinearly separable the artificial bee colony abc technique was used to optimize the kernel svm hyperparameters the artificial bee colony algorithm is a swarm intelligence optimization method founded in the behavior of bee swarms in the search of food similar to other evolutionary computation algorithms such as particle swarm optimization pso clerc 2006 eberhart et al 2001 olsson 2011 or ant colony optimization dorigo and stützle 2004 abc exploits the model of social sharing of information karaboga and basturk 2007 simon 2013 yang et al 2013 according to previous studies the svm method has proven to be effective in the modeling of natural parameters and has been successfully used in the environmental problems such as the assessment of air quality garcía nieto et al 2013 the modeling of forest garcía nieto et al 2012 or the estimation of solar radiation zeng and qiao 2013 additionally the m5 model tree is a regressor based on decision trees m5 tree was invented by j r quinlan quinlan 1992 m5 tree falls within the cart tree breiman et al 1984 type of algorithms because it chooses as impurity function the mean squared error it differs from the cart model in that it builds multivariate linear regression model and it does not attach a constant to the leaf node the m5 model tree is thus analogous to piecewise linear functions another advantage of m5 over cart is that the generated models are much smaller but more accurate quinlan 1992 in summary the organization of this paper is as follows materials methods and dataset are described in section 2 the results of the svm model hybridized with abc are presented discussed and compared with the mlp technique and m5 model tree in section 3 finally the main conclusions of this research work are exposed in section 4 2 materials and methods 2 1 study area the englishmen lake is a water body located in the camargo municipality autonomous community of cantabria spain 5 5 km away from the port city of santander fig 1 c it was created for an old mining exploitation it now collects water from the surrounding water table and has naturally evolved into a lake of high ecological value as winter migratory birds e g anser anser make use of it the study area is located on the eastern edge of the asturian massif from the stratigraphic point of view the materials with the highest permeability values in this study area are the quaternary deposits and the terraces located on the slopes in addition to the calcareous formations in the area two aquifers have been differentiated the quaternary detritic aquifer and the jurassic calcareous aquifer the first is mainly made up of sands gravels and silts with an average thickness between 6 and 8 m the jurassic calcareous aquifer includes the carbonated formations of the upper lias between both aquifers there is a direct water connection so that the discharge of the calcareous aquifer takes place through the quaternary aquifer these aquifers belong to the puerto del escudo underground water body with minimum storage capacity for the entire water body is about 68 5 10 6 m3 the englishmen lake occupies a water area of 13 6 10 4 m2 and has a maximum depth of 6 m 2 2 experimental dataset the data for the analyses were collected from 2006 to 2014 from samples taken from englishmen lake resulting in 244 different processed samples it gives quantitative information about the phytoplankton species specifically samples were usually taken more than once per month and the protocols of the spanish ministry of agriculture fishing food and environment were followed world health organization 1998 willame et al 2005 the sampling is taken with a niskin bottle in the greatest depth point of the lake being this found using a depth gauge the niskin bottle is an evolution of the nansen bottle it is a tube open at both ends with a cap at each one that can be applied with a tensioned elastic rope samples are taken at different depths within the zone that is exposed to enough sunlight for photosynthesis to happen which is called the euphotic zone this zone is defined with the secchi disk that determines the secchi depth as that where the secchi disk cannot be viewed due to the turbidity of the water this depth is an indicator of the transparency of the water the biological data were calculated from five subsamples taken at equal intervals of depth in the euphotic zone brönmark and hansson 2005 in this study the physical chemical variables measured in limnological studies were used gault and marler 2009 negro et al 2000 they were analyzed in an iso 17025 accredited laboratory and the standard procedures for the examination of water and wastewater were followed american public health association 2005 the objective of this work is to study the relationship between algal atypical proliferation indicators and the independent variables there are many physical chemical and biological variables involved in the eutrophication of a lake thus the first step is the selection of the variables for the model an expert criterion was used in this work the estimated variables are related to the algae proliferation that are used to evaluate algal anomalous algal growth in water bodies chlorophyll concentration chl a μg l and total phosphorus mg p l chlorophyll concentration is biomolecule directly related to photosynthesis the process where energy from light is obtained total phosphorus is a nutrient for aquatic organisms the independent variables are biological parameters euglenophytes mm3 l see fig 2 a cyanobacteria mm3 l see fig 2 b dinophlagellata mm3 l see fig 2 c chlorophytes mm3 l see fig 2 d diatoms mm3 l see fig 2 e chrysophytes mm3 l see fig 2 f and cryptophytes mm3 l see fig 2 g physical chemical parameters dissolved oxygen concentration mg o2 l turbidity ntu nitrate concentration mg no3 l ammonium ion concentration mg l conductivity μs cm water temperature ºc and ph 2 3 computational procedure 2 3 1 support vector machine svm method support vector machines are used for classification and regression and belong to the supervised learning methods cristianini and shawe taylor 2000 schölkopf et al 2000 the svms were intended for classification and only later they were generalized for regression problems chen et al 2013 nikoo and mahjouri 2013 ortiz garcía et al 2010 pal and goel 2007 shrestla and shukla 2015 zeng and qiao 2013 being then called support vector regression svr the svr model does not use the whole training data because the cost function ignores within a threshold ε the samples too close to the model if the data is non linear but separable the kernel trick can be used many regression problems cannot be linearly treated in the space of the independent values x but can be translated to a higher dimensionality feature space if a suitable mapping x ψ x is given cristianini and shawe taylor 2000 ortiz garcía et al 2010 schölkopf et al 2000 shrestla and shukla 2015 where an adequate regression can be obtained in svr we wish to predict a real valued output y for the observed value t so that our training data is a set of l points of the form x i t i where i 1 2 l y ℜ x ℜ d cristianini and shawe taylor 2000 nikoo and mahjouri 2013 ortiz garcía et al 2010 pal and goel 2007 schölkopf et al 2000 shrestla and shukla 2015 steinwart and christmann 2008 so that 2 y i w x i b where denotes the dot product x i is a d dimensional real input vector w is a vector normal to the maximum margin hyperplane and yi is the predicted output value the parameter b w is used to determine the offset of this plane from the origin and along the normal vector w the svr uses a penalty function where the error of corresponding to the predicted value y i is not taken into account if it is less than a distance ε away from the observed value t i i e if t i y i ε we can see in fig 3 the region where y i ε i that is called ε insensitive tube also the dependent variables outside the tube are placed in one of two slack variable penalties depending on whether they are above ξ or below ξ the tube with ξ 0 ξ 0 i 3 t i y i ε ξ 4 t i y i ε ξ we are trying to find a function that can accurately estimate new values from a set of new independent variables to this aim the svm model is trained in the so called training set at this stage the error function is sequentially optimized two different types of error functions are defines and consequently to kind of svm models can be defined a regression svm type 1 also known as ε svm regression for this type of svm we have to solve an optimization problem minimizing the following general risk function cristianini and shawe taylor 2000 hansen and wang 2005 heddam and kisi 2018 schölkopf et al 2000 steinwart and christmann 2008 5 r w b ξ 1 2 w 2 c i 1 l ξ i ξ i where c is the penalization or cost parameter to control the training errors that is to say c measures a trade off between the empirical error and the model complexity and subject to 6 w ψ x i b y i ε ξ i y i w ψ x i b ε ξ i ξ i ξ i 0 i 1 l regression svm type 2 also known as ν svm regression for this svm model it is necessary to solve the following optimization problem minimizing the following general risk function cristianini and shawe taylor 2000 hansen and wang 2005 heddam and kisi 2018 schölkopf et al 2000 steinwart and christmann 2008 7 r w b ξ 1 2 w 2 c ν ε 1 l i 1 l ξ i ξ i being c again the penalty parameter indeed c determines the trade off between the margin model flatness and the magnitude of the slack variables training error and subject to 8 w ψ x i b y i ε ξ i y i w ψ x i b ε ξ i ξ i ξ i 0 i 1 l where ψ x z is a mapping of the independent variables space into a larger dimension space z where an inner product is defined using a positive definite function k kernel trick hansen and wang 2005 schölkopf et al 2000 steinwart and christmann 2008 9 ψ x ψ x i ψ i x ψ i x k x x in fact if a function satisfies mercer s condition chen et al 2013 hansen and wang 2005 steinwart and christmann 2008 then it is an allowable support vector kernel furthermore as this problem is quadratic with linear constraints the optimality conditions of karush kuhn tucker are necessary and sufficient and the solution which is a linear combination of a subset of sample points denominated support vectors s v can be obtained from the dual problem as follows 10 w s v β i ψ x i f w b x s v β i ψ x i ψ x b s v β i k x i x b it is important to select an appropriate kernel function because the kernel function defines the space in which the dataset is regressed examples of kernel functions rbf radial basis function 11 k x i x j e σ x i x j 2 polynomial 12 k x i x j σ x i x j a b sigmoid 13 k x i x j tanh σ x i x j a being a b and σ the kernel parameters 2 3 2 the artificial bee colony abc algorithm the algorithm artificial bee colony abc is swarm intelligence optimization algorithm that relies in the behaviour of bee swarms searching for food sources karaboga and basturk 2007 karaboga and akay 2009 karaboga and gorkemli 2014 simon 2013 yang et al 2013 in this evolutionary algorithm a population of possible solutions evolves with the iterations toward the optimum using a strategy that involves some random component karaboga and basturk 2007 karaboga and akay 2009 karaboga and gorkemli 2014 artificial bee colony algorithm is a swarm based algorithms which is characterized by the sharing of information between the individuals in the swarm or population indeed the bee colony has three groups of bees employed onlookers and scouts an employed bee is assigned to a food the so called employed bees fly to their food source and return to inform the hive with a dance onlookers choose food sources depending on dances if the food source is not good enough it is abandoned and the employed bee becomes a scout and searches a new food source therefore abc considers three phases karaboga and basturk 2007 simon 2013 yang et al 2013 searching or the employee bee phase the process to find nectar source that is to say each food source is foraged by employee bees recruiting or the onlooker bee phase they choose a food source watching the dance of employed bees within the hive the foraging is supervised and sometimes corrected by the onlooker abandon or the scout bee phase the depleted sources are discarded and the scout bees search for new food sources the n food sources the vectors p i represent the possible set of parameters it is a position in the space of possible solutions the dimension of the food source is the number of parameters we are optimizing the food sources are initialized randomly in a plausible hypercube and their fitness is evaluated if f is the objective function the fitness of a food source is see fig 4 14 f i t n e s s f p i 1 1 f p i i f f p i 0 1 f p i i f f p i 0 i 1 n as the objective function decreases the fitness function increases we are minimizing if we want to maximize a function g the objective function must be f g and then a maximum of g is a minimum of f 2 3 2 1 the employee bee phase in this phase the employee bees searches food sources introduces a tentative variation of every i food source following the equation karaboga and basturk 2007 simon 2013 yang et al 2013 15 v i j p i j r i j p k j p i j where j is one of the parameters chosen randomly that we are trying to modify k a food source different from i also randomly chosen and rij a real number drawn from 1 1 once v i j has been computed its fitness is calculated if it is higher than the fitness f p i j its value is swapped with v i j and the trial counter is reinitialized if it is smaller the trial counter is increased and there is no change in this food source 2 3 2 2 the onlooker bee phase we draw a number r i in 0 1 for each food source p i we try to change one parameter in the food source if r i p r o b i we compute p r o b i from the fitness of the food source karaboga and basturk 2007 simon 2013 yang et al 2013 16 p r o b i 0 9 f i t n e s s f p i max k 1 n f i t n e s s f p k 0 1 2 3 2 3 the scout bee phase a food source is abandoned if given a number of trials it does not improve its fitness once a food source is discarded a new one is chosen randomly for each iteration the provisional optimum is the food source with the highest fitness karaboga and basturk 2007 simon 2013 yang et al 2013 this continues until a stopping condition is satisfied in the present case the stopping condition has been a maximum number of iterations and a difference of fitness for the best food source between consecutive iterations under a threshold for a fixed number of iterations 2 4 neural network multilayer perceptron neural network models were inspired by the biological neuron model based on the work of the psychiatrist warren mcculloch and the mathematician walter pitts in the 1940s fine 1999 haykin 1999 the multilayer perceptron mlp consists of an input layer an output layer and also in between some hidden layers with nonlinearly activating nodes fine 1999 the nodes in each layer connect with a certain weight w i j synaptic weight to all the nodes in the next layer perceptron learning occurs through changes in the connection weights after items of data are processed that depend on the error in the output compared to the expected result this is an example of supervised learning and it is performed through backpropagation a generalization of the least mean squares algorithm in the linear perceptron a multilayer perceptron mlp is a feedforward artificial neural network able to perform regressions and is a modified linear perceptron in studying the functional model of neural networks we focus on feedforward networks whose architecture can be represented in an acyclic manner so that each node is not backpropagated as shown in fig 5 with specific activation functions and weights with fixed values the network create the function f x r n y r c that can be expressed fine 1999 haykin 1999 17 f x ϕ ψ x ϕ ψ x ϕ x r n u r m ψ u r m y r c where u the characteristics space that is the space of hidden variables given the architecture fine 1999 haykin 1999 ψ j x ψ w j t x w j 0 ψ is the hidden layer unit activation function where w j r n is the vector of parameters for the units and w j 0 r is its threshold value the ψ function can be hyperbolic tangent logistical or sigmoid ϕ j u ϕ c j t u c j 0 ϕ is the activation function for the output layer units and c j r m is the vector that contains the weights for the units being c j 0 r is its threshold value the identity function any dichotomous or heaviside function are usually used as activation function ϕ and thus the mlp implemented function is fine 1999 haykin 1999 18 f x j 1 m c j ψ w j t x w j 0 c 0 2 5 m5 model tree m5 model tree was developed from binary decision tree linear regression functions are found at the terminal leaf nodes with relationship between predictor and predicted variables quinlan 1992 it differs from decision tree in that it can also be used for numerical data mitchell 1997 quinlan 1992 m5 model tree generation has two steps rahimikhoob et al 2013 solomatine and xue 2004 first data are split into subsets and then a decision tree is created the standard deviation reduction sdr is used for splitting the data and can be calculated as pal and deswal 2009 heddam and kisi 2018 19 s d r s d t t i t s d t i where sd is the standard deviation t i is a subset of samples with the ith outcome of the set and t is the set of samples in the node rahimikhoob et al 2013 the splitting criterion depends on calculating the expected reduction in this error due to the testing of each attribute at that node after the splitting the data in child nodes have less error in compared to parent nodes m5tree keeps the one that optimizes the expected error reduction after trying all the possible splits this division can generate a huge tree like structure with poor generalization ability to overcome this problem the over grown tree is pruned and the linear regression functions replaced this method increases the variables space into areas subspaces and constructs a linear regression model for each one pal 2006 further details of an m5tree can be obtained from quinlan quinlan 1992 2 6 the goodness of fit of this approach the coefficient of determination r 2 was the metric used for the goodness of fit for each observed value t i in the data there is an associated modelled value y i called predicted values the variability of the data is measured with different formulas wasserman 2003 s s t o t i 1 n t i t 2 the total sum of squares directly related with the sample variance s s e r r i 1 n t i y i 2 the residual sum of squares s s r e g i 1 n y i t 2 the explained sum of squares where t is the mean of the n samples 20 t 1 n i 1 n t i the coefficient of determination is defined as 21 r 2 1 s s e r r s s t o t if the coefficient of determination equals 1 0 it would mean that the predicted values coincide with the observed ones two additional criteria considered in this study were the root mean square error rmse and mean absolute error mae hastie et al 2003 wasserman 2003 these statistics are also used frequently to evaluate the forecasting capability of a mathematical model indeed the root mean square error rmse and mean absolute error mae are given by the expressions freedman et al 2007 wasserman 2003 22 rmse i 1 n t i y i 2 n 23 mae i 1 n t i y i n if the root mean square error rmse has a value of zero it means that there is no difference between the predicted and observed data mean absolute error mae is the average vertical distance between each point and the identity line mae is also the average horizontal distance between each point and the identity line mae has a clear interpretation as the average absolute difference between t i and y i 3 analysis of results and discussion the physical chemical can be seen in table 1 and the biological variables are shown in table 2 allman and rhodes 2003 the number of input variables in the abc svm m5 model tree and mlp model was 15 see tables 1 and 2 the predicted variables chl a and total phosphorus have been measured in μg l and mg p l allman and rhodes 2003 barnes and chu 2010 respectively in this study three different models have been constructed specifically in this research the novel hybrid abc svm m5 model tree and mlp with predicted variables the chl a and total phosphorus and predictor variables the other sixteen biological and physical chemical parameters input variables using the coefficient of determination r 2 as criterion to assess the success of each model also the svm methods depend on the svm hyperparameters ε that characterizes the ε insensitive tube the regularization factor c see eqs 5 and 7 a b and σ that are the parameters of kernel to improve the defect hyperparameters some of the methods commonly used are cristianini and shawe taylor 2000 hansen and wang 2005 wu 2009 random search grid search genetic algorithms particle swarm optimization pso and so on usually the traditional way of performing hyperparameter optimization has been grid search or a parameter sweep which is simply an exhaustive searching through a manually specified subset of the hyperparameter space of a learning algorithm indeed the grid search is a brute force method and as such almost any optimization method improves its efficiency in this research work the artificial bee colony abc algorithm was applied olsson 2011 thus we have chosen abc optimization technique as an efficient and simple technique álvarez antón et al 2013 fine 1999 haykin 1999 kecman 2005 for adjusting the svr parameters fig 6 shows the flowchart of this abc svm model the food sources x i are vectors that consist in sets of hyperparameters to adjust for instance x i c i ε i σ i is the set of parameters associated with svm with the rbf kerne in this study we have 20 food sources we initialize their values randomly in the first iteration following the equations that regulate the abc algorithm described previously the food sources are updated in each step the cost function value for each set of hyperparameters is computed the cost function value is the minus ten cross validation efron and tibshirani 1997 picard and cook 1984 with this aim the set of samples is split in 10 sets the svm is trained with a set consisting of 9 of this subsets and a model is built this model is tested with the remaining set and the corresponding coefficient of determination is calculated this process is done for each of the 10 sets and when the full cycle is completed each food source is associated with its corresponding mean coefficient of determination if the termination criteria are satisfied the global best x i that is the food source with the best fitness is the set of optimized parameters álvarez antón et al 2013 hastie et al 2003 libsvm library chang and lin 2011 has been used to construct the regression model and the parameters have been optimized with the abc technique using the abc version for matlab karaboga and basturk 2007 abc is used to optimize the svm hyperparameters the abc looks for the best hyperparameters i e for rbf kernel c σ and ε computing the fitness in every iteration where the fitness factor is constructed using the coefficient of determination r 2 as significant changes in the regression only take place when there is a change in the magnitude order of the parameters the parameters have been considered powers of ten and the searching space has been that of the exponents that is for instance in the rbf kernel case the searching space has been 6 4 10 4 20 4 and then c values move in the interval 10 6 10 4 σ values vary in 10 10 10 4 and finally ε values are drawn from 10 20 10 4 the number of food sources has been 20 and the stopping criterion is met if there is no improvement within a threshold of 10 6 of in the r 2 after ten iterations with a limit for the number of iterations equal to 500 table 3 shows the optimal hyperparameters obtained with the abc svm models for the total phosphorus an imac with a cpu intel core i5 4570 at 3 2 ghz with 8 gb of ram was used taking 149 s to obtain the chlorophyll model and 806 s for the total phosphorus model for comparison purposes m5 tree and a multilayer perceptron mlp models have been built for the total phosphorus as output variable in order to predict the algal anomalous growth in the englishmen lake an artificial neural network ann see fig 5 is constructed using three different parameters fine 1999 haykin 1999 the learning rate that regulates the update of the interconnection weights the number of hidden layers the momentum factor that controls the oscillation of weight changes of the ann and the activation function that converts a neuron s weighted input to its output the obtained ann optimal parameters for the multilayer perceptron mlp appears in table 4 table 5 shows the coefficients of determination and correlation for the abc rbf svm model multilayer perceptron and m5 tree model fitted for the total phosphorus in this study the svm with the rbf kernel function gets the highest goodness of fit for estimating the total phosphorus to assess the state of eutrophication with a coefficient of determination r 2 equal to 0 90 and a correlation coefficient r of 0 95 these results mean a good agreement is obtained between predicted and observed data following the same methodology for the second dependent variable chlorophyll concentration we have obtained the results shown below indeed table 6 shows the optimal hyperparameters obtained with the abc svm models for the chlorophyll concentration additionally another multilayer perceptron mlp and another m5 tree model were built for the chlorophyll output variable in order to predict the algal atypical proliferation in the englishmen the ann optimal parameters for this same variable using multilayer perceptron mlp are shown in table 7 table 8 shows the determination and correlation coefficients for abc rbf svm mlp and m5 tree models for the chl a variable similarly taking into account our previous statistical calculations again the abc rbf svm is the model with higher goodness of fit for estimating the chlorophyll concentration to predict the algal anomalous growth with a coefficient of determination r 2 equal to 0 92 and a correlation coefficient r equal to 0 96 an also there is a good agreement between the model and the observed data the nine input variables for the total phosphorus first output variable have been ranked by their importance in this complex nonlinear problem and this ranking is shown in table 9 and fig 7 in the same way the fifteen predictor variables in the chlorophyll concentration model importance ranking is shown in table 10 and fig 8 finally this work estimates the total phosphorus using the abc rbf svm model quite accurately fig 9 shows the comparison between observed and predicted total with m5 tree mlp and abc rbf svm models thus a svm model with a abc optimization method is a good choice to achieve a good approximation to the nonlinearities in this regression problem similarly fig 10 shows the comparison between observed and predicted chlorophyll concentration values with m5 tree mlp and abc rbf svm models again abc svm model is a good choice to achieve a very effective approach to the algal abnormal growth in water bodies such as the englishmen lake 4 conclusions from the experimental and numerical results the following conclusions can be drawn firstly algal abnormal growth or eutrophication is a very prevailing and severe problem in water bodies such as reservoirs and lakes the assessment methods that use sampling and the following analysis are expensive thus an alternative technique such as the abc rbf svm method is a good option to study the algal atypical productivity in the englishmen lake secondly an abc rbf svm model successfully predicts the algal anomalous concentration from the other and easier to measure input variables lowering the costs of its assessment thirdly a coefficient of determination of 0 90 was obtained for the abc rbf svm model that estimates the total phosphorus indeed the predicted values match consistently the values in the dataset of observed total phosphorus see fig 7 also a coefficient of determination of 0 92 was obtained for the abc rbf svm model that predicts the chlorophyll concentration thus the estimated results for the algal growth corresponding to this output variable are in accordance with the dataset fourthly predictor variables of the algal atypical growth have been ranked in order of relative importance this is one of the main findings of this work being water temperature variable the most important in the estimation of the total phosphorus on the other hand the euglenophytes plays a significant role in the chlorophyll concentration also important variables in the prediction of total phosphorus and chlorophyll concentration are the turbidity and dinophlagellata concentration respectively finally the hyperparameters affects significantly the final model and its setting is fundamental in summary other eutrophication processes with the same or different pollution sources can benefit from the use of these techniques but it must always be taken into account the particular circumstances of each location regarding the applicability and transferability of the established model since the cantabrian basin authority manages a specific geographical area with relatively homogeneous environmental conditions atlantic climate for similar lakes in this geographical area the predictions are expected to be valid within the scope of this particular geographical area thus an abc svm model is a good approach to the prediction of algal abnormal productivity in water bodies acknowledgements authors acknowledge the support by the cantabrian basin authority spanish ministry of agriculture fishing food and environment that provided the pollutant data in the englishmen lake located in autonomous community of cantabria northern spain additionally we thank anthony ashworth for his revision of the english in the manuscript 
25052,landscape models are comprehensive tools that allow for an understanding of landscape dynamics and a means of deriving future projections in the context of global change vegetation and ecological processes such as growth death or regeneration are essential components of forest landscape dynamics but their inclusion in landscape level modelling frameworks is not straightforward as there is a trade off between model feasibility desirable complexity and the inclusion of relevant ecological processes if models are to project future landscape dynamics climatic influence on vegetation processes needs to be integrated however this usually leads to a major increment in model complexity here a post fire regeneration model in terms of tree species and a growth model in terms of basal areas is presented for mediterranean forests including climate influences on such processes the model captures vegetation dynamics at the stand level and accounts for post fire regeneration and vegetation growth at the landscape level with inclusion of the dynamically influencing effect of climate the model was calibrated with 7709 inventory data plots and validated with 233 burned plots in the mediterranean region of catalonia ne spain results show that our model is able to accurately predict tree species post fire regeneration and biomass growth they also show that integration of climatic information represents a significant improvement on the predictive accuracy of the model overall this study presents a generic approach to extend local vegetation dynamics information to the landscape level furthermore allowing the projection of vegetation dynamics under changing climatic conditions keywords landscape model scaling vegetation dynamics disturbance biomass climate change 1 introduction landscapes are heterogeneous and dynamic systems resulting from the interaction of natural and human influences understanding and anticipating landscape dynamics is a key challenge for ecology and environmental sciences especially in a time of unprecedented environmental change keane et al 2015 landscape models are simplifications of reality that attempt to capture the patterns and processes of landscape dynamics in quantitative tools baker and robinson 2010 bugmann 2001 they allow for an understanding of current landscape dynamics and for projecting future states baker 1989 daniel et al 2016 sklar and costanza 1991 vegetation processes are an essential component of forest landscape dynamics identifying the appropriate scale at which each particular process should be modelled is crucial levin 1992 rammer and seidl 2019 tree based and stand level models simulate specific ecological and demographic processes such as post disturbance regeneration growth recruitment and mortality using as the basic unit of simulation individual organisms and forest stands respectively álvarez gonzález et al 1999 baker and robinson 2010 bugmann 2001 keane et al 2004 scheller and mladenoff 2004 trasobares et al 2004 however both models present computational and data requirements which are often too complex to apply over large areas keane et al 2015 and usually are not designed to capture explicit feedback between vegetation and landscape level disturbances such as fire forest management or insect pest outbreaks to work at the landscape level and achieving an accurate representation of the dynamics at the same time might require the incorporation of vegetation dynamics information at the stand level indeed explicit incorporation of vegetation processes information allows the emergence of system dynamics that cannot be generated using empirical models which impose deterministic landscape trajectories keane et al 2015 therefore landscape models need to incorporate local and stand level processes to efficiently apply vegetation dynamics on a wider scale and circumvent the huge data and computational requirement commonly required by tree based and stand level modelling frameworks landscape dynamic models have been largely used to understand the interactions between vegetation structure and landscape level disturbances bugmann and solomon 2014 scheller and mladenoff 2004 fire is one such landscape level driver that influences and is influenced by vegetation patterns keane et al 2004 millington et al 2009 a large body of modelling studies mostly known as fire succession models have focused on fire dynamics at the landscape level and its consequences on forest structure composition and biodiversity boychuk et al 1997 brotons et al 2013 he and mladenoff 2005 miller and ager 2013 millington et al 2009 since plant species have different adaptations to fire either resistance mechanisms e g the thick bark of quercus suber pausas 2015 pellegrini et al 2017 or post fire regeneration mechanisms such as resprouting e g quercus sp or pseudotsuga menziesii bryan and lanner 1981 hodgkinson 1998 or serotinity e g pinus halepensis pinus pinaster or some eucalyptus sp millington et al 2009 rodrigo et al 2004 turner et al 1998 the inclusion of such traits in fire succession models become crucial when studying forest regeneration after fire predicting the recovering species is important but also the capacity to generate new biomass plays also an essential role for many fields derived from this data e g biofuel or wood extraction lindner et al 2010 pausas 1999 therefore including vegetation growth after fire is a prerequisite to build holistic vegetation models concurrently there are also reciprocal effects from forest structure and composition determined by post fire regeneration pathways and vegetation growth to fire behaviour loepfe et al 2011 millington et al 2009 climate plays a key role in most vegetation and ecological processes such as growth afforestation establishment and mortality clark et al 2001 keane et al 2015 moreover climate acts as an external driving factor for natural disturbances such as fire or pest outbreaks pechony and shindell 2010 seidl et al 2015 to deal with direct and indirect climatic effects on vegetation dynamics vegetation models should consider such influences and be designed to integrate climate information keane et al 2015 laubhann et al 2009 however in the context of climate change past and present climatic conditions might not be enough to predict future vegetation dynamics therefore the integration of climatic information into vegetation models needs to be dynamic otherwise models are relegated to be only descriptive of present day situations matala et al 2006 root and schneider 2002 even so the inclusion of climatic information in landscape models is challenging in a context where reduction of design complexity and data burden in modelling is also needed in this study we aimed to simulate emergent stand level vegetation processes that are explicitly influenced by climate and fire in a landscape level compatible framework specifically we assessed the capability of a new vegetation landscape model to predict the impact of stand replacing fires on forests structure and composition by simulating tree species post fire regeneration and biomass growth our model was built upon the following requirements 1 it should accurately capture local vegetation processes at the landscape level while minimising model complexity 2 it should allow the dynamic incorporation of climatic effects on vegetation in time and space and 3 model parameters should be simple and satisfied by accessible sources like forest inventory data we tested the effects of using different calibration matrices each one using secondary species information from different spatial scales and the importance of climate to the predictive ability of the model we applied our framework to mediterranean ecosystems since they are prime examples of where wildfires represent the main natural disturbance trabaud 1994 where post fire regeneration and growth are crucial processes in describing landscape level patterns and where some of the main forest species are adapted to fire moreover there are many studies on landscape dynamics in mediterranean ecosystems such as land use changes aquilué et al 2017 fire dynamics brotons et al 2013 duane et al 2016 management miller and ager 2013 and the consequences of fire on vegetation rodrigo et al 2004 these studies offer a convenient framework to discuss the integration of local vegetation processes in landscape level modelling exercises 2 material and methods 2 1 study area the area of study was catalonia a region of 32 114 km2 located in north eastern spain with a predominantly mediterranean climate fig 1 its complex orography with an altitude range from 0 to more than 3000 m a s l and a coast extending over 750 km resulted in a highly diverse climate the region is extensively covered with forest 40 and scrublands 16 while agricultural lands 29 and urban areas 6 contribute to the fragmentation of natural areas ibàñez et al 2002 forests are dominated by aleppo pine pinus halepensis holm oak quercus ilex scots pine pinus sylvestris and european black pine pinus nigra subsp salzmannii that together represent two thirds of total forest surface in catalonia pure forests represent 53 5 while mixed forests combining pinus sp and quercus sp constitute 46 5 piqué et al 2014 fire regimes during the summer season are the major disturbance driving landscape change in catalonia mean annual burnt area over the period 1942 2002 was 8000 ha year corresponding to 0 75 of the catalan wildland area gonzález and pukkala 2007 but a decreasing trend in number and size of fires has been observed after mid nineties mainly explained be increased fire prevention and suppression duane and brotons 2018 turco et al 2016 2 2 model overview the model presented here is a landscape dynamic model that simulates changes on forest structure and composition due to the impact of stand replacing wildfires the model includes 2 main processes forest regeneration in terms of species establishment after fire and biomass growth expressed as the increase of basal area ba m2 ha 1 of the species recovered after fire climate effect on both processes was dynamically integrated through the characterization of climatic conditions all over the study area to check the climate effect we built the two sub model with and without climate consideration the model uses forest inventory plots icona 1993 villanueva 2005 as sampling units both as input data and model outputs plots are not spatially correlated relative to each other since our aim was to calibrate a model that could be easily applied over large areas we characterized each inventory plot only by the dominant tree species in terms of ba its climatic conditions precipitation and temperature and orography slope and aspect in this way the model might be functional when applied to larger areas as long as input data is satisfied below we introduce a general description of the climatic characterization forest regeneration and biomass growth after fire sub models finally we detail the type of data parametrization and tests used for the model calibration and validation 2 3 climate effect climate was integrated in our model in a way that could be dynamic in time and space by calculating a site quality index sqi that affected both regeneration and growth the sqi should be interpreted as the probability between 0 1 of optimal growth occurrence according to climatic and topographic information as explanatory variables the sqi was parameterized for each studied tree species with data from all the study area 2 4 forest regeneration after fire we built a post fire regeneration sub model to predict tree species establishment after fire according to autosuccession studies hanes 1971 rodrigo et al 2004 we considered that only species present in a plot before a fire and with fire adapted functional traits related to post fire regeneration namely serotiny or resprouting capacity were able to regenerate after a fire in our model the dominant species the one with the highest in ba always regenerated first as long as it had post fire regeneration capability otherwise a secondary species the one that immediately follows the dominant species in ba abundance was randomly selected based on dominant secondary species frequency in catalonia according to inventory data table 1 in cases where neither dominant nor secondary species had any post fire regeneration capability we considered that after fire the plot was dominated by scrubland fig 2 to include the climate information in the post fire regeneration we first categorized the sqi variable in sqi low optimal growth probability 50th percentile and sqi high optimal growth probability 50th percentile a third category called sqi optimal optimal growth probability 90th percentile was added for p halepensis p nigra p sylvestris q suber and q ilex because there was enough data for differentiation then we checked the dominant secondary species frequencies per main species in each sqi category 2 5 biomass growth we defined a species growth sub model to estimate the annual increase of ba δ b a at the stand level as suggested by bravo et al 2012 growth models should dynamically estimate the growth biomass ratio álvarez gonzález et al 1999 garcía and ruiz 2003 instead of simply determining a static growth prediction equation that did not depend on the initial biomass therefore we used the initial ba b a 0 as the unique explanatory variable of growth being the increase of basal area only dependent on prior initial area based on other species growth models espelta et al 2017 garcía and ruiz 2003 second degree polynomial regression with the intercept forced to 0 eq 1 was aimed at characterizing annual increment in ba according to the initial ba 1 δ b a a b a 0 b b a 0 2 where a and b were parameters calibrated for each species through the application of a linear model to the exposed variables since in the present methodology growth was applied to burnt plots where initial ba was 0 an initial growth equivalent to the mean growth of plots with the lowest ba was used in the calibration datasets to test the relevance of including climate in growth sub model we added the sqi information in the modelling process for growth modelling we estimated the growth of each plot adding the sqi continuous variable between 0 1 and getting the following equation per species eq 2 2 δ b a a b a 0 b b a 0 2 c s q i where a b and c were parameters calibrated for each species through the application of a linear model that includes initial ba and sqi as explanatory variables and increment of ba as dependent variable 2 6 data and model calibration data from the second and third spanish national forest inventories ifn2 by its spanish acronym icona 1993 ifn3 villanueva 2005 were used for model calibration and data from the fourth spanish national forest inventory ifn4 ministerio de agricultura pesca alimentación y medio ambiente 2017 for model validation fig 1 only non managed plots with main species dominance in ba higher than 50 were used for both post fire regeneration and species growth calibration 7709 plots and higher than 70 for sqi calibration 4024 plots we modelled the regeneration and growth of the main tree species found in catalonia pinus halepensis pinus nigra pinus pinea pinus sylvestris pinus pinaster quercus ilex quercus suber and other quercus including q faginea q humilis q robur and q petrea table 1 to calculate the sqi we used the criteria proposed by the guidance on sustainable forest management in catalonia orgest piqué et al 2014 considering optimal growth occurrence as places with large annual growth in bark volume agbv we generated a binomial variable defined by plots with optimal growth 75th percentile in agbv and plots with sub optimal growth 75th percentile in agbv per species we built logistic regression models to define optimal growth using climatic and topographic information as explanatory variables annual precipitation in tenths of mm minimum annual temperature in tenths of a degree celsius ninyerola et al 2005 slope in degrees and aspect north and non north categories obtained from the digital elevation model of the spanish national geographic institute ministerio de fomento 2011 the selection of these climatic and topographic variables was based on research by gil tena et al 2018 and brotons et al 2013 different models combining linear and quadratic only in climatic variables to reinforce its importance gil tena et al 2018 effects of the variables were built and subsequently selected according to akaike information criterion aic burnham and anderson 2003 while goodness of fit was evaluated by the area under the curve auc of the receiver operating characteristic roc graph tabachnick and fidell 1996 we calibrated the post fire regeneration sub model first by identifying the dominant species present in each plot in terms of ba abundance in order to reduce input data in the model we did not use the secondary species in ba abundance information however we built a matrix that accounted for the frequency of secondary species or shrub accompanying each dominant tree species for growth sub model calibration we used the ba data from ifn2 1989 90 as the initial ba and the mean annual growth in ba between ifn2 and ifn3 2000 2 7 model validation we validated both processes forest post fire regeneration and biomass growth using severely burned plots between ifn2 and ifn3 i e plots in which ba was reduced by more than 90 due to wildfires and comparing modelled outputs with data from ifn4 2016 the validation sub set included information from 31 fires and 233 plots fig 1 since the secondary species matrix was built using data from all forests in catalonia we acknowledged that local variability might not be captured to test the relative importance of this component we validated the post fire regeneration sub model by running it with 2 types of information first we used actual secondary species information from burned plots before the fire ifn2 and for a second parameterization scenario we used the dominant secondary species frequency matrix built in this study to test climate relevance in regeneration process we did a third parametrization accounting for secondary species frequencies per main species in each sqi category we compared our estimation of regenerated species with the species found in the same plot in ifn4 using the ochiai statistic de cáceres et al 2008 ochiai 1957 that indicates the degree of concordance for categorical classifications in an index between 0 no concordance and 1 absolute concordance we also assessed transitions from one species to another in each plot according to our model estimations and we compared these results with validation information the post fire regeneration sub model was run 50 times and results were averaged at the landscape scale to capture model stochasticity plot by plot validation was not appropriate as we applied general post fire regeneration rules based on secondary species presence since the growth sub model depended on the dominant species established after a fire its validation would be subordinated to the performance of the post fire regeneration process thus for the growth sub model validation we ran the growth equations both eqs 1 and 2 according to the same species found in ifn4 in order to avoid accumulated error therefore the biomass growth sub model was not operating under a stochastic design so we validated it at the fire level estimating the accumulated biomass by species in 4 major fires between 1991 and 2000 fig 1 terra alta 1994 bages berguedà 1994 montseny guilleries 1994 and solsonès 1998 these fires represented 80 of all burned plots the growth sub model was evaluated using the symmetric mean absolute percentage error smape armstrong 1985 flores 1986 an accuracy measure based on relative errors comparing ba validation data registered in ifn4 and ba estimated by our growth equations considering the time between each fire and 2016 3 results 3 1 site quality index models per species according to the aic and auc criteria the most accurate sqi models were those only considering the linear effect of minimum annual temperature and annual precipitation for most species table 2 precipitation was the best explanatory variable for most of the species showing a positive effect in all cases temperature was only significant for p halepensis and p sylvestris to define optimal growth showing a positive and negative effect respectively while slope had a negative effect on growth aspect did not show any significance for the species in this study goodness of fit of climatic models varied according to the species other quercus and p halepensis had good discriminatory capability 0 87 and 0 76 in auc respectively while p sylvestris and q ilex showed the lowest discriminatory capability though still acceptable 0 62 and 0 61 in auc respectively 3 2 forest regeneration after fire the transitions of modelled species after fire were highly similar to our validation dataset although some minor transitions were not adequately captured by our model fig 3 the most notable difference was observed in some plots dominated by species with serotiny or resprouting capability that converted to other species according to validation data this was the case in some plots dominated by p halepensis p pinaster and q suber which became shrub after fire in the observed data but not in our model leading to an overestimation of the post fire frequency of these 3 species other species were underestimated by our model as a consequence of transitions from other species such as in the case of other quercus or preservation of the same species as in the case of p nigra p sylvestris and p pinea occurring in the validation data but not captured by our model figs 3 and 4 overall ochiai coefficients were acceptable when comparing validation data with post fire regeneration using actual secondary species information ochiai 0 843 information randomly selected from secondary species frequency matrix ochiai 0 839 and adding the sqi parameterization ochiai 0 841 fig 4 3 3 biomass growth annual growth in ba equations followed a second degree polynomial curve with larger increases in the initial stages but then reaching a plateau at about 20 30 m2 ha 1 ba fig 5 from this plateauing ba continued to increase but at a much lower rate coefficients of determination of growth equations without climate eq 1 varied from 0 56 to 0 73 according to the different species in this study fig 5 when adding the climatic information to the equations eq 2 the analysis revealed that ba0 both linear and quadratic and the sqi parameter significantly influenced growth in all species but the interaction between sqi and ba0 was not significant when including the climatic information coefficients of determination of growth equations substantially improved in almost all species varying from 0 64 to 0 76 comparison between observed and estimated ba revealed that there were no major differences of error estimation by any species or fire event in particular fig 6 smape values for model estimations showed an averaged error of 2 42 when estimating growth without the climatic component while this averaged error decreased to 1 63 when climate was added to the model 4 discussion 4 1 predicting post fire regeneration and growth in this study we present a vegetation landscape dynamic model that allows a robust extrapolation of local processes such as post fire regeneration and biomass growth to large spatial extents furthermore our approach specifically integrates climatic effects in these processes this is achieved while minimizing model complexity and input requirements without losing predictive capability one objective of this study was to test whether simple data from national inventory plots were enough to reproduce vegetation processes at the landscape level for this we evaluated the prediction quality for 3 different parameterizations in our post fire regeneration sub model testing more realistic information using the actual dominant and secondary species of each plot to more general information using the frequency matrix of dominant secondary species of catalonia table 1 although parameterization using actual information reported the best results parameterization using general information did not substantially reduce accuracy according to ochiai indexes the parameterization including climate influence achieved a higher accuracy than for when climate was excluded however both were still below the value reached with actual information fig 4 since the differences in accuracy between the 3 parameterizations were slight our results support the use of more generic parametrization and the possibility of reduced data requirements in terms of detail while still maintaining the predictive quality of the models in the biomass growth sub model equation described that the younger the forest lower ba the higher was the growth acceleration when the plot had accumulated enough biomass ba was higher and while forest kept growing they did so at a lower rate fig 5 this growth patterns respond to the role of competition for resources in biomass growth as observed at the individual level according to trasobares et al 2004 2010 and de miguel et al 2014 for tree species in mediterranean forests the validation of the biomass growth sub model was done by estimating accumulated ba for individual species in 4 big fires obtaining a smape index of deviation of 1 63 and 2 42 with and without climate information respectively figs 1 and 6 since no general tendency was observed in ba estimations for any species or fire in particular results showed an appropriate accuracy for forest ecosystems in catalonia climate influence in the simulated processes was introduced through the sqi the evaluation of climate effects revealed that annual precipitation was the main variable defining optimal growth of species in accordance with several studies that found water availability as the limiting factor for tree species growth especially in mediterranean climates vericat et al 2013 vicente serrano et al 2010 minimum temperature is the main limiting factor for growth in species present in more continental climates where water availability is higher than in catalonia surprisingly temperature was negatively related to p sylvestris growth table 2 likely because this is a widely distributed species in catalonia and it appears in low temperature regions with few other species and hence competition is low as expected the inclusion of climate improved the predictive accuracy of both the post fire regeneration and the growth sub models figs 5 and 6 in biomass growth equations climate resulted in a significant predictive improvement for all tree species as well as providing a significant improvement in the coefficients of correlation in the context of climate change models including climate influence on vegetation dynamics will further improve their accuracy and applicability as well as providing more informed projections of the future he 2008 perry and millington 2008 4 2 dealing with model complexity one of the main challenges in landscape modelling is to address the relations between vegetation dynamics and landscape disturbances bugmann and solomon 2014 both elements may have reciprocal effects on each other on different spatial and temporal scales keane et al 2004 capturing crucial ecological processes at the stand level and extending the information to the landscape level allows an accurate approximation of vegetation dynamic perturbation relationships however this usually implies higher model complexity rammer and seidl 2019 this current study illustrates that identifying and integrating the key elements that define ecological processes growth and post fire regeneration in our study allows a reduction of model complexity a second big challenge for landscape modelling is the integration of species habitat suitability keane et al 2004 since it plays an essential role in ecological processes as well as in disturbances gallien et al 2010 in order to integrate the particularities of each locality while avoiding an increase of model complexity different approaches such as the use of species distribution models sdms phillips et al 2006 as a variable that summarize environmental information are proposed canelles et al 2017 lloret and kitzberger 2018 we used a similar methodology for sqis which considers the quality of the habitat for a specific ecological process in our case optimal growth by using sqis we were able to incorporate climate with a shortcut that encompassed most climatic information in a single variable therefore changing climates could be directly assessed in landscape dynamics while avoiding complexity in the mathematical design or data burden 4 3 mechanisms leading to model prediction errors good model performance using calibrated data and incorporating key patterns of vegetation dynamics does not prove that models can fully represent reality clearly some mechanisms of landscape dynamics are not included in our model likely leading to some prediction errors when capturing more complex transitions for instance some plots populated with a highly fire resilient species such as p halepensis were in fact dominated by shrubs in the post fire validation data figs 3 and 4 in these stands individuals were still too young to dominate the plot shrubs appeared to dominate in burned areas shortly after fire however after at a certain period of time 20 30 years depending on the authors tree species might establish a dominion with scrubland becoming mature forest due to an afforestation process drewa et al 2002 keeley and zedler 1978 pasalodos tato et al 2015 colonization from neighbouring plots also emerges as an artefact not directly evaluated in our study our model considered that p nigra and p sylvestris regeneration after fire was absent because it is a non fire adapted species but the species unexpectedly remained after fire in some locations according to validation data figs 3 and 4 when studying these unforeseen plots we found that most of them were at the edge of the burned area close to undisturbed mature forest with colonization capability presuming that seeds arrive from neighbouring populations their fitness can be improved in burned areas as studied in p sylvestris castoldi et al 2013 and in p nigra lucas borja et al 2016 validation data also showed that many plots without pre fire other quercus were dominated by this species after the disturbance fig 4 which was not predicted by our model although other quercus establishment is considered mainly via resprouting some studies propose that dispersers such as jays or rodents might have a greater influence than expected on the spatial pattern of acorn dissemination gómez 2003 sunyer et al 2015 these rationales based on previous research may lead to contemplate the establishment of other quercus through zoochory both in ecological and modelling approximations finally it is worth to note that our model only estimates the probability of post fire regeneration after one single event global change situations might lead to a higher recurrence of extreme events that can eventually influence forest capability to regenerate after fire lindner et al 2010 hence in case that fires or other disturbances increase the impact frequency in a given area regeneration strategies will fail and only shrubs may regenerate rodrigo et al 2004 letting forest to develop only through the afforestation process in conclusion although results reveal that autosuccession by resprouting or serotiny is the main driver of post fire regeneration other processes such as afforestation and colonization processes should be emphasized in spatial processes acting at the landscape level 4 4 integration into landscape models this study concentrated on 2 demographic processes post fire regeneration and growth model contemplating the specific relation of mediterranean forest species and fire however the potential of this approach should not be limited to only these scenarios as long as other communities face different natural disturbances based on the species response traits sánchez pinillos et al 2016 the proposed methodology allows the incorporation of such traits and the model application to other disturbances such as catastrophic weather conditions landslides drought pest outbreaks herbivory etc in addition the integration of the methodology presented in this study into more complex models might expand the research framework in terms of relations between disturbance and vegetation dynamics including other processes such as afforestation or colonization and studying feedback between these elements 5 conclusions the present model enables to bridge the gap between the complexity associated to stand vegetation models and the simplicity needed by large scale models but also allowing major mechanisms behind vegetation dynamics to be explicit in our model formulation our modelling approach provides key insights to foster modelling in processes occurring at local level and impacting at large levels moreover the inclusion of climatic information allows the model to improve precision at landscape level and gives the opportunity to project vegetation dynamics in future global change scenarios driven by climatic changes our results demonstrate that our methodology is able to realistically project changes in forest composition and structure after fire in mediterranean forests further development of post fire regeneration modelling should integrate other vegetation processes such as colonization or afforestation that prove critical in capturing the full complexity of vegetation changes in dynamic landscapes acknowledgments we especially thank assu gil tena and jordi vayreda for the insightful discussion on forest modelling this study was funded by the spanish government through the inmodes cgl2017 89999 c2 2 r andrea duane was funded by the ministerio de educación cultura y deporte spain fpu13 00108 núria aquilué was funded by the natural sciences and engineering research council of canada through the create program on forest complexity modelling fcm 
25052,landscape models are comprehensive tools that allow for an understanding of landscape dynamics and a means of deriving future projections in the context of global change vegetation and ecological processes such as growth death or regeneration are essential components of forest landscape dynamics but their inclusion in landscape level modelling frameworks is not straightforward as there is a trade off between model feasibility desirable complexity and the inclusion of relevant ecological processes if models are to project future landscape dynamics climatic influence on vegetation processes needs to be integrated however this usually leads to a major increment in model complexity here a post fire regeneration model in terms of tree species and a growth model in terms of basal areas is presented for mediterranean forests including climate influences on such processes the model captures vegetation dynamics at the stand level and accounts for post fire regeneration and vegetation growth at the landscape level with inclusion of the dynamically influencing effect of climate the model was calibrated with 7709 inventory data plots and validated with 233 burned plots in the mediterranean region of catalonia ne spain results show that our model is able to accurately predict tree species post fire regeneration and biomass growth they also show that integration of climatic information represents a significant improvement on the predictive accuracy of the model overall this study presents a generic approach to extend local vegetation dynamics information to the landscape level furthermore allowing the projection of vegetation dynamics under changing climatic conditions keywords landscape model scaling vegetation dynamics disturbance biomass climate change 1 introduction landscapes are heterogeneous and dynamic systems resulting from the interaction of natural and human influences understanding and anticipating landscape dynamics is a key challenge for ecology and environmental sciences especially in a time of unprecedented environmental change keane et al 2015 landscape models are simplifications of reality that attempt to capture the patterns and processes of landscape dynamics in quantitative tools baker and robinson 2010 bugmann 2001 they allow for an understanding of current landscape dynamics and for projecting future states baker 1989 daniel et al 2016 sklar and costanza 1991 vegetation processes are an essential component of forest landscape dynamics identifying the appropriate scale at which each particular process should be modelled is crucial levin 1992 rammer and seidl 2019 tree based and stand level models simulate specific ecological and demographic processes such as post disturbance regeneration growth recruitment and mortality using as the basic unit of simulation individual organisms and forest stands respectively álvarez gonzález et al 1999 baker and robinson 2010 bugmann 2001 keane et al 2004 scheller and mladenoff 2004 trasobares et al 2004 however both models present computational and data requirements which are often too complex to apply over large areas keane et al 2015 and usually are not designed to capture explicit feedback between vegetation and landscape level disturbances such as fire forest management or insect pest outbreaks to work at the landscape level and achieving an accurate representation of the dynamics at the same time might require the incorporation of vegetation dynamics information at the stand level indeed explicit incorporation of vegetation processes information allows the emergence of system dynamics that cannot be generated using empirical models which impose deterministic landscape trajectories keane et al 2015 therefore landscape models need to incorporate local and stand level processes to efficiently apply vegetation dynamics on a wider scale and circumvent the huge data and computational requirement commonly required by tree based and stand level modelling frameworks landscape dynamic models have been largely used to understand the interactions between vegetation structure and landscape level disturbances bugmann and solomon 2014 scheller and mladenoff 2004 fire is one such landscape level driver that influences and is influenced by vegetation patterns keane et al 2004 millington et al 2009 a large body of modelling studies mostly known as fire succession models have focused on fire dynamics at the landscape level and its consequences on forest structure composition and biodiversity boychuk et al 1997 brotons et al 2013 he and mladenoff 2005 miller and ager 2013 millington et al 2009 since plant species have different adaptations to fire either resistance mechanisms e g the thick bark of quercus suber pausas 2015 pellegrini et al 2017 or post fire regeneration mechanisms such as resprouting e g quercus sp or pseudotsuga menziesii bryan and lanner 1981 hodgkinson 1998 or serotinity e g pinus halepensis pinus pinaster or some eucalyptus sp millington et al 2009 rodrigo et al 2004 turner et al 1998 the inclusion of such traits in fire succession models become crucial when studying forest regeneration after fire predicting the recovering species is important but also the capacity to generate new biomass plays also an essential role for many fields derived from this data e g biofuel or wood extraction lindner et al 2010 pausas 1999 therefore including vegetation growth after fire is a prerequisite to build holistic vegetation models concurrently there are also reciprocal effects from forest structure and composition determined by post fire regeneration pathways and vegetation growth to fire behaviour loepfe et al 2011 millington et al 2009 climate plays a key role in most vegetation and ecological processes such as growth afforestation establishment and mortality clark et al 2001 keane et al 2015 moreover climate acts as an external driving factor for natural disturbances such as fire or pest outbreaks pechony and shindell 2010 seidl et al 2015 to deal with direct and indirect climatic effects on vegetation dynamics vegetation models should consider such influences and be designed to integrate climate information keane et al 2015 laubhann et al 2009 however in the context of climate change past and present climatic conditions might not be enough to predict future vegetation dynamics therefore the integration of climatic information into vegetation models needs to be dynamic otherwise models are relegated to be only descriptive of present day situations matala et al 2006 root and schneider 2002 even so the inclusion of climatic information in landscape models is challenging in a context where reduction of design complexity and data burden in modelling is also needed in this study we aimed to simulate emergent stand level vegetation processes that are explicitly influenced by climate and fire in a landscape level compatible framework specifically we assessed the capability of a new vegetation landscape model to predict the impact of stand replacing fires on forests structure and composition by simulating tree species post fire regeneration and biomass growth our model was built upon the following requirements 1 it should accurately capture local vegetation processes at the landscape level while minimising model complexity 2 it should allow the dynamic incorporation of climatic effects on vegetation in time and space and 3 model parameters should be simple and satisfied by accessible sources like forest inventory data we tested the effects of using different calibration matrices each one using secondary species information from different spatial scales and the importance of climate to the predictive ability of the model we applied our framework to mediterranean ecosystems since they are prime examples of where wildfires represent the main natural disturbance trabaud 1994 where post fire regeneration and growth are crucial processes in describing landscape level patterns and where some of the main forest species are adapted to fire moreover there are many studies on landscape dynamics in mediterranean ecosystems such as land use changes aquilué et al 2017 fire dynamics brotons et al 2013 duane et al 2016 management miller and ager 2013 and the consequences of fire on vegetation rodrigo et al 2004 these studies offer a convenient framework to discuss the integration of local vegetation processes in landscape level modelling exercises 2 material and methods 2 1 study area the area of study was catalonia a region of 32 114 km2 located in north eastern spain with a predominantly mediterranean climate fig 1 its complex orography with an altitude range from 0 to more than 3000 m a s l and a coast extending over 750 km resulted in a highly diverse climate the region is extensively covered with forest 40 and scrublands 16 while agricultural lands 29 and urban areas 6 contribute to the fragmentation of natural areas ibàñez et al 2002 forests are dominated by aleppo pine pinus halepensis holm oak quercus ilex scots pine pinus sylvestris and european black pine pinus nigra subsp salzmannii that together represent two thirds of total forest surface in catalonia pure forests represent 53 5 while mixed forests combining pinus sp and quercus sp constitute 46 5 piqué et al 2014 fire regimes during the summer season are the major disturbance driving landscape change in catalonia mean annual burnt area over the period 1942 2002 was 8000 ha year corresponding to 0 75 of the catalan wildland area gonzález and pukkala 2007 but a decreasing trend in number and size of fires has been observed after mid nineties mainly explained be increased fire prevention and suppression duane and brotons 2018 turco et al 2016 2 2 model overview the model presented here is a landscape dynamic model that simulates changes on forest structure and composition due to the impact of stand replacing wildfires the model includes 2 main processes forest regeneration in terms of species establishment after fire and biomass growth expressed as the increase of basal area ba m2 ha 1 of the species recovered after fire climate effect on both processes was dynamically integrated through the characterization of climatic conditions all over the study area to check the climate effect we built the two sub model with and without climate consideration the model uses forest inventory plots icona 1993 villanueva 2005 as sampling units both as input data and model outputs plots are not spatially correlated relative to each other since our aim was to calibrate a model that could be easily applied over large areas we characterized each inventory plot only by the dominant tree species in terms of ba its climatic conditions precipitation and temperature and orography slope and aspect in this way the model might be functional when applied to larger areas as long as input data is satisfied below we introduce a general description of the climatic characterization forest regeneration and biomass growth after fire sub models finally we detail the type of data parametrization and tests used for the model calibration and validation 2 3 climate effect climate was integrated in our model in a way that could be dynamic in time and space by calculating a site quality index sqi that affected both regeneration and growth the sqi should be interpreted as the probability between 0 1 of optimal growth occurrence according to climatic and topographic information as explanatory variables the sqi was parameterized for each studied tree species with data from all the study area 2 4 forest regeneration after fire we built a post fire regeneration sub model to predict tree species establishment after fire according to autosuccession studies hanes 1971 rodrigo et al 2004 we considered that only species present in a plot before a fire and with fire adapted functional traits related to post fire regeneration namely serotiny or resprouting capacity were able to regenerate after a fire in our model the dominant species the one with the highest in ba always regenerated first as long as it had post fire regeneration capability otherwise a secondary species the one that immediately follows the dominant species in ba abundance was randomly selected based on dominant secondary species frequency in catalonia according to inventory data table 1 in cases where neither dominant nor secondary species had any post fire regeneration capability we considered that after fire the plot was dominated by scrubland fig 2 to include the climate information in the post fire regeneration we first categorized the sqi variable in sqi low optimal growth probability 50th percentile and sqi high optimal growth probability 50th percentile a third category called sqi optimal optimal growth probability 90th percentile was added for p halepensis p nigra p sylvestris q suber and q ilex because there was enough data for differentiation then we checked the dominant secondary species frequencies per main species in each sqi category 2 5 biomass growth we defined a species growth sub model to estimate the annual increase of ba δ b a at the stand level as suggested by bravo et al 2012 growth models should dynamically estimate the growth biomass ratio álvarez gonzález et al 1999 garcía and ruiz 2003 instead of simply determining a static growth prediction equation that did not depend on the initial biomass therefore we used the initial ba b a 0 as the unique explanatory variable of growth being the increase of basal area only dependent on prior initial area based on other species growth models espelta et al 2017 garcía and ruiz 2003 second degree polynomial regression with the intercept forced to 0 eq 1 was aimed at characterizing annual increment in ba according to the initial ba 1 δ b a a b a 0 b b a 0 2 where a and b were parameters calibrated for each species through the application of a linear model to the exposed variables since in the present methodology growth was applied to burnt plots where initial ba was 0 an initial growth equivalent to the mean growth of plots with the lowest ba was used in the calibration datasets to test the relevance of including climate in growth sub model we added the sqi information in the modelling process for growth modelling we estimated the growth of each plot adding the sqi continuous variable between 0 1 and getting the following equation per species eq 2 2 δ b a a b a 0 b b a 0 2 c s q i where a b and c were parameters calibrated for each species through the application of a linear model that includes initial ba and sqi as explanatory variables and increment of ba as dependent variable 2 6 data and model calibration data from the second and third spanish national forest inventories ifn2 by its spanish acronym icona 1993 ifn3 villanueva 2005 were used for model calibration and data from the fourth spanish national forest inventory ifn4 ministerio de agricultura pesca alimentación y medio ambiente 2017 for model validation fig 1 only non managed plots with main species dominance in ba higher than 50 were used for both post fire regeneration and species growth calibration 7709 plots and higher than 70 for sqi calibration 4024 plots we modelled the regeneration and growth of the main tree species found in catalonia pinus halepensis pinus nigra pinus pinea pinus sylvestris pinus pinaster quercus ilex quercus suber and other quercus including q faginea q humilis q robur and q petrea table 1 to calculate the sqi we used the criteria proposed by the guidance on sustainable forest management in catalonia orgest piqué et al 2014 considering optimal growth occurrence as places with large annual growth in bark volume agbv we generated a binomial variable defined by plots with optimal growth 75th percentile in agbv and plots with sub optimal growth 75th percentile in agbv per species we built logistic regression models to define optimal growth using climatic and topographic information as explanatory variables annual precipitation in tenths of mm minimum annual temperature in tenths of a degree celsius ninyerola et al 2005 slope in degrees and aspect north and non north categories obtained from the digital elevation model of the spanish national geographic institute ministerio de fomento 2011 the selection of these climatic and topographic variables was based on research by gil tena et al 2018 and brotons et al 2013 different models combining linear and quadratic only in climatic variables to reinforce its importance gil tena et al 2018 effects of the variables were built and subsequently selected according to akaike information criterion aic burnham and anderson 2003 while goodness of fit was evaluated by the area under the curve auc of the receiver operating characteristic roc graph tabachnick and fidell 1996 we calibrated the post fire regeneration sub model first by identifying the dominant species present in each plot in terms of ba abundance in order to reduce input data in the model we did not use the secondary species in ba abundance information however we built a matrix that accounted for the frequency of secondary species or shrub accompanying each dominant tree species for growth sub model calibration we used the ba data from ifn2 1989 90 as the initial ba and the mean annual growth in ba between ifn2 and ifn3 2000 2 7 model validation we validated both processes forest post fire regeneration and biomass growth using severely burned plots between ifn2 and ifn3 i e plots in which ba was reduced by more than 90 due to wildfires and comparing modelled outputs with data from ifn4 2016 the validation sub set included information from 31 fires and 233 plots fig 1 since the secondary species matrix was built using data from all forests in catalonia we acknowledged that local variability might not be captured to test the relative importance of this component we validated the post fire regeneration sub model by running it with 2 types of information first we used actual secondary species information from burned plots before the fire ifn2 and for a second parameterization scenario we used the dominant secondary species frequency matrix built in this study to test climate relevance in regeneration process we did a third parametrization accounting for secondary species frequencies per main species in each sqi category we compared our estimation of regenerated species with the species found in the same plot in ifn4 using the ochiai statistic de cáceres et al 2008 ochiai 1957 that indicates the degree of concordance for categorical classifications in an index between 0 no concordance and 1 absolute concordance we also assessed transitions from one species to another in each plot according to our model estimations and we compared these results with validation information the post fire regeneration sub model was run 50 times and results were averaged at the landscape scale to capture model stochasticity plot by plot validation was not appropriate as we applied general post fire regeneration rules based on secondary species presence since the growth sub model depended on the dominant species established after a fire its validation would be subordinated to the performance of the post fire regeneration process thus for the growth sub model validation we ran the growth equations both eqs 1 and 2 according to the same species found in ifn4 in order to avoid accumulated error therefore the biomass growth sub model was not operating under a stochastic design so we validated it at the fire level estimating the accumulated biomass by species in 4 major fires between 1991 and 2000 fig 1 terra alta 1994 bages berguedà 1994 montseny guilleries 1994 and solsonès 1998 these fires represented 80 of all burned plots the growth sub model was evaluated using the symmetric mean absolute percentage error smape armstrong 1985 flores 1986 an accuracy measure based on relative errors comparing ba validation data registered in ifn4 and ba estimated by our growth equations considering the time between each fire and 2016 3 results 3 1 site quality index models per species according to the aic and auc criteria the most accurate sqi models were those only considering the linear effect of minimum annual temperature and annual precipitation for most species table 2 precipitation was the best explanatory variable for most of the species showing a positive effect in all cases temperature was only significant for p halepensis and p sylvestris to define optimal growth showing a positive and negative effect respectively while slope had a negative effect on growth aspect did not show any significance for the species in this study goodness of fit of climatic models varied according to the species other quercus and p halepensis had good discriminatory capability 0 87 and 0 76 in auc respectively while p sylvestris and q ilex showed the lowest discriminatory capability though still acceptable 0 62 and 0 61 in auc respectively 3 2 forest regeneration after fire the transitions of modelled species after fire were highly similar to our validation dataset although some minor transitions were not adequately captured by our model fig 3 the most notable difference was observed in some plots dominated by species with serotiny or resprouting capability that converted to other species according to validation data this was the case in some plots dominated by p halepensis p pinaster and q suber which became shrub after fire in the observed data but not in our model leading to an overestimation of the post fire frequency of these 3 species other species were underestimated by our model as a consequence of transitions from other species such as in the case of other quercus or preservation of the same species as in the case of p nigra p sylvestris and p pinea occurring in the validation data but not captured by our model figs 3 and 4 overall ochiai coefficients were acceptable when comparing validation data with post fire regeneration using actual secondary species information ochiai 0 843 information randomly selected from secondary species frequency matrix ochiai 0 839 and adding the sqi parameterization ochiai 0 841 fig 4 3 3 biomass growth annual growth in ba equations followed a second degree polynomial curve with larger increases in the initial stages but then reaching a plateau at about 20 30 m2 ha 1 ba fig 5 from this plateauing ba continued to increase but at a much lower rate coefficients of determination of growth equations without climate eq 1 varied from 0 56 to 0 73 according to the different species in this study fig 5 when adding the climatic information to the equations eq 2 the analysis revealed that ba0 both linear and quadratic and the sqi parameter significantly influenced growth in all species but the interaction between sqi and ba0 was not significant when including the climatic information coefficients of determination of growth equations substantially improved in almost all species varying from 0 64 to 0 76 comparison between observed and estimated ba revealed that there were no major differences of error estimation by any species or fire event in particular fig 6 smape values for model estimations showed an averaged error of 2 42 when estimating growth without the climatic component while this averaged error decreased to 1 63 when climate was added to the model 4 discussion 4 1 predicting post fire regeneration and growth in this study we present a vegetation landscape dynamic model that allows a robust extrapolation of local processes such as post fire regeneration and biomass growth to large spatial extents furthermore our approach specifically integrates climatic effects in these processes this is achieved while minimizing model complexity and input requirements without losing predictive capability one objective of this study was to test whether simple data from national inventory plots were enough to reproduce vegetation processes at the landscape level for this we evaluated the prediction quality for 3 different parameterizations in our post fire regeneration sub model testing more realistic information using the actual dominant and secondary species of each plot to more general information using the frequency matrix of dominant secondary species of catalonia table 1 although parameterization using actual information reported the best results parameterization using general information did not substantially reduce accuracy according to ochiai indexes the parameterization including climate influence achieved a higher accuracy than for when climate was excluded however both were still below the value reached with actual information fig 4 since the differences in accuracy between the 3 parameterizations were slight our results support the use of more generic parametrization and the possibility of reduced data requirements in terms of detail while still maintaining the predictive quality of the models in the biomass growth sub model equation described that the younger the forest lower ba the higher was the growth acceleration when the plot had accumulated enough biomass ba was higher and while forest kept growing they did so at a lower rate fig 5 this growth patterns respond to the role of competition for resources in biomass growth as observed at the individual level according to trasobares et al 2004 2010 and de miguel et al 2014 for tree species in mediterranean forests the validation of the biomass growth sub model was done by estimating accumulated ba for individual species in 4 big fires obtaining a smape index of deviation of 1 63 and 2 42 with and without climate information respectively figs 1 and 6 since no general tendency was observed in ba estimations for any species or fire in particular results showed an appropriate accuracy for forest ecosystems in catalonia climate influence in the simulated processes was introduced through the sqi the evaluation of climate effects revealed that annual precipitation was the main variable defining optimal growth of species in accordance with several studies that found water availability as the limiting factor for tree species growth especially in mediterranean climates vericat et al 2013 vicente serrano et al 2010 minimum temperature is the main limiting factor for growth in species present in more continental climates where water availability is higher than in catalonia surprisingly temperature was negatively related to p sylvestris growth table 2 likely because this is a widely distributed species in catalonia and it appears in low temperature regions with few other species and hence competition is low as expected the inclusion of climate improved the predictive accuracy of both the post fire regeneration and the growth sub models figs 5 and 6 in biomass growth equations climate resulted in a significant predictive improvement for all tree species as well as providing a significant improvement in the coefficients of correlation in the context of climate change models including climate influence on vegetation dynamics will further improve their accuracy and applicability as well as providing more informed projections of the future he 2008 perry and millington 2008 4 2 dealing with model complexity one of the main challenges in landscape modelling is to address the relations between vegetation dynamics and landscape disturbances bugmann and solomon 2014 both elements may have reciprocal effects on each other on different spatial and temporal scales keane et al 2004 capturing crucial ecological processes at the stand level and extending the information to the landscape level allows an accurate approximation of vegetation dynamic perturbation relationships however this usually implies higher model complexity rammer and seidl 2019 this current study illustrates that identifying and integrating the key elements that define ecological processes growth and post fire regeneration in our study allows a reduction of model complexity a second big challenge for landscape modelling is the integration of species habitat suitability keane et al 2004 since it plays an essential role in ecological processes as well as in disturbances gallien et al 2010 in order to integrate the particularities of each locality while avoiding an increase of model complexity different approaches such as the use of species distribution models sdms phillips et al 2006 as a variable that summarize environmental information are proposed canelles et al 2017 lloret and kitzberger 2018 we used a similar methodology for sqis which considers the quality of the habitat for a specific ecological process in our case optimal growth by using sqis we were able to incorporate climate with a shortcut that encompassed most climatic information in a single variable therefore changing climates could be directly assessed in landscape dynamics while avoiding complexity in the mathematical design or data burden 4 3 mechanisms leading to model prediction errors good model performance using calibrated data and incorporating key patterns of vegetation dynamics does not prove that models can fully represent reality clearly some mechanisms of landscape dynamics are not included in our model likely leading to some prediction errors when capturing more complex transitions for instance some plots populated with a highly fire resilient species such as p halepensis were in fact dominated by shrubs in the post fire validation data figs 3 and 4 in these stands individuals were still too young to dominate the plot shrubs appeared to dominate in burned areas shortly after fire however after at a certain period of time 20 30 years depending on the authors tree species might establish a dominion with scrubland becoming mature forest due to an afforestation process drewa et al 2002 keeley and zedler 1978 pasalodos tato et al 2015 colonization from neighbouring plots also emerges as an artefact not directly evaluated in our study our model considered that p nigra and p sylvestris regeneration after fire was absent because it is a non fire adapted species but the species unexpectedly remained after fire in some locations according to validation data figs 3 and 4 when studying these unforeseen plots we found that most of them were at the edge of the burned area close to undisturbed mature forest with colonization capability presuming that seeds arrive from neighbouring populations their fitness can be improved in burned areas as studied in p sylvestris castoldi et al 2013 and in p nigra lucas borja et al 2016 validation data also showed that many plots without pre fire other quercus were dominated by this species after the disturbance fig 4 which was not predicted by our model although other quercus establishment is considered mainly via resprouting some studies propose that dispersers such as jays or rodents might have a greater influence than expected on the spatial pattern of acorn dissemination gómez 2003 sunyer et al 2015 these rationales based on previous research may lead to contemplate the establishment of other quercus through zoochory both in ecological and modelling approximations finally it is worth to note that our model only estimates the probability of post fire regeneration after one single event global change situations might lead to a higher recurrence of extreme events that can eventually influence forest capability to regenerate after fire lindner et al 2010 hence in case that fires or other disturbances increase the impact frequency in a given area regeneration strategies will fail and only shrubs may regenerate rodrigo et al 2004 letting forest to develop only through the afforestation process in conclusion although results reveal that autosuccession by resprouting or serotiny is the main driver of post fire regeneration other processes such as afforestation and colonization processes should be emphasized in spatial processes acting at the landscape level 4 4 integration into landscape models this study concentrated on 2 demographic processes post fire regeneration and growth model contemplating the specific relation of mediterranean forest species and fire however the potential of this approach should not be limited to only these scenarios as long as other communities face different natural disturbances based on the species response traits sánchez pinillos et al 2016 the proposed methodology allows the incorporation of such traits and the model application to other disturbances such as catastrophic weather conditions landslides drought pest outbreaks herbivory etc in addition the integration of the methodology presented in this study into more complex models might expand the research framework in terms of relations between disturbance and vegetation dynamics including other processes such as afforestation or colonization and studying feedback between these elements 5 conclusions the present model enables to bridge the gap between the complexity associated to stand vegetation models and the simplicity needed by large scale models but also allowing major mechanisms behind vegetation dynamics to be explicit in our model formulation our modelling approach provides key insights to foster modelling in processes occurring at local level and impacting at large levels moreover the inclusion of climatic information allows the model to improve precision at landscape level and gives the opportunity to project vegetation dynamics in future global change scenarios driven by climatic changes our results demonstrate that our methodology is able to realistically project changes in forest composition and structure after fire in mediterranean forests further development of post fire regeneration modelling should integrate other vegetation processes such as colonization or afforestation that prove critical in capturing the full complexity of vegetation changes in dynamic landscapes acknowledgments we especially thank assu gil tena and jordi vayreda for the insightful discussion on forest modelling this study was funded by the spanish government through the inmodes cgl2017 89999 c2 2 r andrea duane was funded by the ministerio de educación cultura y deporte spain fpu13 00108 núria aquilué was funded by the natural sciences and engineering research council of canada through the create program on forest complexity modelling fcm 
25053,habitat degradation and fragmentation have been the leading cause of reduced fishery yields in many freshwater ecosystems around the world in poyang lake the largest freshwater lake in china recent hydrological changes driven by the operation of three gorges dam tgd and drought have caused a drastic loss of fishery resources in response managers have planned to build a sluice at poyang lake s outlet to manage the lake s water level and as the sluice will unavoidably limit the river lake migration of many fishery species managers have also proposed implementing stock enhancement programs and restricting fisheries to sustain fisheries in the lake in this study we built and implemented a poyang lake ecopath with ecosim model to evaluate effects of water level management stock enhancement and fishery restriction on biomass of the four major chinese carps grass carp ctenopharyngodon idella silver carp hypophthalmichthys molitrix bighead carp h nobilis and black carp mylopharyngodon piceus of which all are river lake migratory and important to fisheries results showed that the total biomass of the four major chinese carps could increase with increases in water level increases in stocking biomass and decreases in fishing pressure however even in the best management effort scenario i e highest water level highest stocking biomass and no fishing simulated total biomass of the four major chinese carps was still 16 lower than the biomass estimate in 2000 three years before the operation of tgd these results suggest that a combination of managing water level stocking and restricting fisheries can substantially offset negative effects of hydrological changes on the four major chinese carps but may not be enough to restore the biomass of the four major chinese carps to high levels that had occurred before the operation of tgd because of the blockage of river lake connectivity by the poyang lake sluice keywords poyang lake fisheries three gorges dam habitat connectivity water level management stock enhancement the four major chinese carps 1 introduction freshwater fisheries provide food security nutrition livelihoods and recreation to billions of people around the world welcomme et al 2010 lynch et al 2017 however the majority of freshwater fisheries and their ecosystems have been stressed by human activities especially by the construction of dams chen et al 2009 welcomme et al 2010 lynch et al 2017 dams have provided a range of social and economic benefits including irrigation flood control and hydropower generation and the impoundment of some dams does support important fisheries such as the kariba dam between zambia and zimbabwe karenge and kolding 1995 however effects of dams on fish habitats have been mostly negative and irreversible the structure of the dam itself could block fish migration and sequester nutrients and sediments that support downstream fish habitats such as river deltas nilsson et al 2005 dudgeon et al 2006 suzuki and pompeu 2016 flow regulation by the dams could eliminate floods that sustain floodplains for many fishes to use as spawning and nursery area fu et al 2003 ziv et al 2012 song et al 2018 one giant dam sensu nilsson et al 2005 could even result in profound changes in fish communities across the whole river system by altering the river s hydrological thermal and chemical regimes china is the country with the largest freshwater catches but the catches have been reportedly declining in recent years fao 2016 the majority of china s freshwater catches are from the basin of middle and lower reaches of yangtze river mlyr referring to yangtze river below three gorges where many fishery stocks have a long history of being stressed by pollution overexploitation and habitat fragmentation chen et al 2009 liu and wang 2018 since 2003 fisheries in the basin of mlyr have been further stressed by three gorges dam tgd and its operation for hydropower generation the structure of tgd has disrupted the longitudinal connectivity of yangtze river and the operation of tgd has changed the flow regime of mlyr which both have negatively affected the recruitment of many fishery species xie et al 2007 duan et al 2009 additionally sediment trapping by tgd resulted in deepened river bed of mlyr which further lowered the water level of mlyr and the lateral connectivity between mlyr and its floodplain habitats during recent droughts lai et al 2014 coincided with these reported hydrological changes that have caused habitat degradation and fragmentation decreases in fishery production have been reported across many fishing grounds in the basin of mlyr chen et al 2009 wang et al 2014 changes in the flow regime of mlyr after the operation of tgd have especially strong negative effects on fish community and fisheries in poyang lake fig 1 the largest freshwater lake in china as a floodplain ecosystem poyang lake drains into yangtze river but also receives the backflow from yangtze river when yangtze river water level is at its seasonal high usually between july and october ye et al 2012 this river lake interaction is important to the recruitment of migratory fishes in poyang lake fang et al 2016 of which many are very important to fisheries such as the four major chinese carps silver carp hypophthalmichthys molitrix bighead carp h nobilis grass carp ctenopharyngodon idella and black carp mylopharyngodon piceus the four major chinese carps feed and grow in poyang lake but migrate into yangtze river for spawning in spring usually between april and may and then their larvae drift into poyang lake with the backflow from yangtze river chen et al 2009 li et al 2013 comparing with the historical flow regime the flow in mlyr has increased in the tgd drawdown period april june but decreased in the tgd impoundment period september november since the operation of tgd lai et al 2014 the changes in the flow regime of mlyr have been linked to the decrease in larvae abundance of the four major chinese carps duan et al 2009 in addition to changes in the flow regime of mlyr poyang lake fisheries were also stressed by drought which was widespread in the whole basin of yangtze river in recent years lai et al 2014 the average tributary inflow of poyang lake in 2003 2009 was 20 lower than that of 1957 2002 coincided with an 8 decrease in precipitation and a 10 increase in water consumption zhang et al 2016a the decrease in tributary inflow has been linked the decreases in water level zhang et al 2014 aquatic habitat area wu and liu 2017 and nutrient in terms of total phosphorus inputs of poyang lake liu et al 2014 further the operation of tgd might intensify negative effects of drought on the poyang lake ecosystem for example zhang et al 2012 showed that the impoundment of tgd has resulted in an increase in the difference between yangtze river and poyang lake water levels which in turn may result in an increase in the drainage and a decrease of the water level of poyang lake managers have been concerned about habitat degradation and fragmentation associated with recent changes in the flow regime of mlyr and droughts that might have negatively affected the fisheries of the four major chinese carps in poyang lake total catch of the four major chinese carps decreased by 59 in poyang lake between 2000 2001 and 2008 2009 wang et al 2014 which were two hydrologically normal years before the operation of tgd and two drought years after the operation of tgd respectively zhang et al 2016b in response to the lake s recent loss of fishery resources managers have proposed a poyang lake multi faceted restoration project plmrp the proposed project includes three main components 1 building a sluice at the outlet of poyang lake to manage water level which is expected to restore the lake s floodplain habitats but will further limit the river lake migration of animals 2 implementing stock enhancement programs to stabilize recruitments of important fishery species and 3 restricting fisheries zhao et al 2011 wu et al 2014 however the long term benefit of this restoration project to poyang lake fisheries is still questionable and needs to be evaluated in this study we built and implemented an ecopath with ecosim ewe model christensen and walters 2004 to evaluate effects of the plmrp on the four major chinese carps while ewe models have been widely used to understand trophic flows among food web groups and simulate food web time dynamics in many freshwater ecosystems around the world e g cremona et al 2018 guo et al 2013 shan et al 2014 kao et al 2014 2016 2018 ecosim the scenario simulation component of ewe has been rarely implemented to support management decision making for china s freshwater fisheries to our understanding only li et al 2009 and zhao et al 2018 implemented ecosim to investigate fishery profits and fish community structure under a range of harvest and habitat change scenarios in freshwater ecosystems in china to evaluate effects of the plmrp we designed our ewe simulation analysis as a full factorial experiment that included three factors water level stocking and fishery restriction each factor had three levels or scenarios that were developed based on managers proposals in plmrp we simulated changes in biomass of the four major chinese carps across all 27 combinations of water level management stocking and fishery restriction scenarios 2 materials and methods 2 1 study area poyang lake is located in jiangxi province and connected to the middle reach of yangtze river via a 65 km channel at the north end fig 1 the lake has an average area of 2933 km2 and a mean depth of 8 4 m but seasonal fluctuations of water level and lake area are both high in flood season april august the lake have an area of 4000 km2 and an average depth of about 11 6 m shankman et al 2006 in the dry season september march the lake can have an area of 1000 km2 and an average depth of about 3 7 m wang et al 2011 the poyang lake basin has a subtropical climate with an average rainfall of 1878 mm per year and 50 of annual rainfall in the flood season guo et al 2008 the trophic status of poyang lake is between mesotrophic and eutrophic liu et al 2017 2 2 specifics of the plmrp once again the main components of plmrp include 1 managing the lake s water level by building and operating a sluice at the lake s outlet 2 implementing stock enhancement programs and 3 restricting fisheries zhao et al 2011 wu et al 2014 the proposed water level management plan is to keep the sluice open during yangtze river s high flow season april august to allow the river lake connection but keep the sluice closed otherwise to retain water in the lake although poyang lake s stock enhancement programs started in 2002 large scale stocking did not begin until 2010 proposed stock enhancement programs have a specific focus on the four major chinese carps because of their river lake migration and importance to fisheries for fishery restrictions currently fisheries in poyang lake are closed during the spring spawning season chen et al 2009 but a 10 year ban on all fishing in the main stem of yangtze river will start in 2020 as announced by china s ministry of agriculture and rural affairs www moa gov cn in january 2019 2 3 modeling the poyang lake ecosystem to evaluate long term benefits of the plmrp we used the ewe modeling approach christensen and walters 2004 and its accompanied program software ewe version 6 5 available from www ecopath org to investigate effects of water level management stock enhancement and fishery restriction on the four major chinese carps as summarized in fig 2 our analyses included three main tasks first we built an ecopath model to represent biomass flows in the poyang lake food web in 2000 which was the first year when we have enough data to estimate biomass inputs across all trophic levels second we built and calibrated a poyang lake ecosim model third we implemented the ecosim model to simulate food web dynamics over time under management scenarios which were developed based on the plmrp based on christensen et al 2008 we modeled biomass flows among food web groups in our poyang lake ecopath model as 1 b i p b i e e i j b j q b j d c i j y i 0 where b is biomass g m2 in wet weight subscript i and j indicate two specific groups p b is production to biomass ratio year 1 ee is the ecotrophic efficiency dimensionless q b is consumption to biomass ratio year 1 dc ij is the proportion of group i in the diet of group j and y is fishery yield g m 2 year 1 in this ecopath model ee represented the fraction of production for each group lost to predation or fishing and could be estimated after b p b q b and dc for all poyang lake food web groups were input christensen et al 2008 we ensured the ecopath model to achieve biomass balance ee 1 at parameterization the energy balance in an ecopath model is modeled as 2 p q i u q i r q i 1 where p q i is production to consumption ratio u q i is the proportion of unassimilated food in consumption and r q i is respiration to consumption ratio christensen et al 2008 in the ecopath model p q i was calculated based on input values of p b i and q b i u q i was an input and r q i was estimated using eq 2 we also ensured the ecopath model to achieve energy balance r q 0 at parameterization based on christensen et al 2008 and our poyang lake ecopath model we modeled the change in b i over time in our poyang lake ecosim model as 3 d b i d t g i j q j i j q i j m 0 i f i b i where g is gross conversion efficiency dimensionless q ji is consumption on group j by group i g m 2 year 1 q ij is predation on group i by group j g m 2 year 1 m0 is non predatory natural mortality rate year 1 and f is fishing mortality rate year 1 in the ecosim model consumption was predicted based on the foraging arena theory ahrens et al 2012 as did in kao et al 2016 the foraging arena equation could be expressed as 4 q i j p i j v i j b i b j f 1 v i j 1 f 2 p i j b j f 3 where p ij is predation rate on group i by unit biomass of group j g 1 year 1 v ij is vulnerability parameter dimensionless and f 1 f 2 and f 3 are functions representing effects of feeding time and handling time on consumption which were kept as default settings for details refer to christensen et al 2008 2 4 parameterization of the poyang lake ecopath model we configured 19 food web groups in the poyang lake ecopath model table 1 input values of b p b and q b table 2 were obtained from literature or estimated using empirical models due to lack of information we set u q to the ecopath default value of 0 20 for fish groups christensen et al 2008 and following kao et al 2014 we set u q to 0 55 0 55 and 0 40 for shrimps benthos and zooplankton respectively as shown in supplementary table s1 diet composition inputs dc were either obtained from literature for poyang lake studies or based on studies of the same taxa in similar lake ecosystems in the basin of mlyr 2 4 1 fish groups our poyang lake ecopath model included 13 fish taxa table 1 in order to simulate effects of stock enhancement in ecosim we parameterized the four major chinese carps as multi stanza groups with two stanzas age zero age 0 and age one and older age 1 and set the age 1 stanza as the leading stanza christensen et al 2008 additional input parameters required for multi stanza groups include the von bertalanffy 1938 growth parameter k which we obtained from literature supplementary table s2 and the ratio of weight at maturity to asymptotic weight w m w which we set to the default value of 0 09 christensen et al 2008 inputs for b and q b were only required for leading stanza groups and b and q b for other stanza groups were estimated by ecopath based on other input parameters christensen and others 2008 we first estimated p b for single stanza groups or z for the leading stanza groups of the four major chinese carps using the beverton and holt 1957 model based on k asymptotic length l average length l ave and cut off length at entry into fishery l cut we set z for age 0 groups of the four major chinese carps to 3 year 1 based on wang et al 2017 following christensen et al 2008 we estimated biomass inputs using fishery yield y calculated from the catch statistics dataset used in wang et al 2014 as 5 b y f y z m where m is natural mortality rate we estimated m using empirical model based on k l and an annual average water temperature t ann of 18 c xu and wang 1989 we estimated q b using the empirical model from palomares and pauly 1998 based on t ann w and aspect ratio a the ratio of square of caudal fin height to its surface area we obtained values for l l ave l cut and w from literature and estimated aspect ratios using images of poyang lake fish samples supplementary table s2 2 4 2 shrimps the biomass input of shrimps was estimated using fishery yield y from the fishery catch dataset in wang et al 2014 and equation 5 we estimated p b for shrimps using brey s 2012 empirical model for crustaceans in a lake habitat with a mean temperature of 18 and a mean depth of 8 4 m another required input for brey s empirical model is average individual weight in a unit of j which we used 1000 j for shrimps based on an average individual weight of 1 25 g shi et al 1995 and an energy density of 792 j g cummins and wuycheck 1971 we estimated natural mortality rate for shrimps using hoenig s 1983 empirical model based on a longevity of two years we calculated q b for shrimps based on empirically estimated p b and a p q of 0 19 li et al 2018 2 4 3 lower trophic level groups biomass inputs of benthos zooplankton and producer groups were obtained from cui and li 2005 which were estimated based on survey data between 1997 and 1999 similar to the estimation for p b of shrimps we estimated p b for main taxa of benthos using brey s 2012 empirical model and an average individual weight of 50 j based on average individual weights from cui and li 2005 and energy densities from cummins and wuycheck 1971 we estimated p b for main taxa of zooplankton using empirical models from shuter and ing 1997 based on an annual average temperature of 18 p b values for phytoplankton and submerged macrophytes were obtained from sun and huang 1993 and kao et al 2014 respectively we calculated q b for benthos and zooplankton based on empirically estimated p b and a p q of 0 23 for benthos kao et al 2014 and a p q of 0 26 for zooplankton straile 1997 2 4 4 detritus we used the empirical model from pauly et al 1993 to estimate detritus biomass in a carbon unit gc m2 based on an annual primary production of 980 gc m2 and a euphotic depth of 2 4 m zhu and zhang 1997 to calculate the wet weight biomass input of detritus we multiplied the empirically estimated carbon biomass of detritus by a wet weight to carbon ratio of 4 based on kao et al 2014 2 5 ecosim calibration the objective of our ecosim calibration was to estimate the vulnerability parameter in equation 4 for each consumer group by minimizing the overall sum of squares between predicted and observed biomass after logarithm transformation in the calibration period 2000 2009 christensen et al 2008 we used observed fishery yields and water level in the calibration period as drivers of biomass time dynamics of all modeled food web groups in our ecosim calibration even though the stocking program started in 2002 the scale of stocking was small in the calibration period so that we assumed that stocking had no effect on fish biomass and did not include stocking in ecosim calibration in summary inputs required for our ecosim calibration included time series for observed biomass and fishery yield and a forcing function that links primary productivity and observed water level for 12 out of 13 fish taxa in our poyang lake ecosim model we used the dataset in wang et al 2014 and the method described in 2 3 1 to calculate 2000 2009 time series for observed biomass and fishery yield however we were unable to obtain data to calculate observed biomass time series for lake anchovy and non fish groups due to low catch rates the management agency has stopped reporting catch statistics of lake anchovy since 2002 as a result we assumed that there was no harvest on lake anchovy in the calibration period in our poyang lake ecosim model we represented effects of water level changes on the poyang lake food web as a control of primary productivity based on christensen et al 2008 we modeled the production p of producer group i as 6 p i b i s f p b m a x i n f n f k i where p b max i is the maximum production to biomass ratio sf is a seasonal forcing function that represents water level effects on primary productivity nf is the proportion of free nutrients and k i is a model constant we calculated sf as 7 s f m o n t h d e p t h m o n t h 8 4 8 4 where depth month is average monthly depth m recorded at xingzi hydrology station fig 1 and 8 4 m is the average depth of poyang lake we developed eq 7 based on a hypothesis that increases in water level can lead to increases in habitat availability which in turn lead to increase in primary productivity this hypothesis was developed based on wu et al 2013 and liu et al 2016b which showed a strong positive correlation between water level and primary productivity as indicated by chlorophyll a we kept all ecosim parameters at default setting except 1 vulnerability parameters which were estimated through calibration and 2 the base proportion of free nutrients which was set to 0 75 to represent a mesotrophic ecosystem christensen et al 2008 notably in eq 6 p b max i was set at default value of twice of ecopath p b i and nf and k i were estimated by ecosim christensen et al 2008 finally we calculated root mean square deviations between predicted and observed biomass after logarithm transformation rmsd to judge relative goodness of fit across groups in our ecosim model 2 6 scenario simulations following the approach in kao et al 2018 we designed our scenario simulations as a full factorial experiment including three three level factors water level management stock enhancement and fishery restriction we chose to run all 27 scenario combinations instead of using other methods such as the orthogonal experimental design to reduce the number of simulation runs because computational time was not a limitation in this study on average it took us less than 1 min to run a scenario simulation on an average personal computer the four major chinese carps were modeled as ecosim hatchery groups christensen et al 2008 whose recruitments were sustained by stocking fingerlings in all of our scenario simulations we assumed that there will be no natural recruitment for the four major chinese carps after the sluice is built and operated to manage water level because of the blockage of river lake connectivity therefore by comparing simulated biomass across scenarios with the biomass inputs in our 2000 poyang lake ecopath model we could identify the combinations of scenarios in plmyr that can restore the biomass of the four major chinese carps to a level before the operation of tgd our water level management scenarios included a pre tgd scenario in which the sluice was operated to maintain average monthly water levels in 1999 2003 a post tgd scenario in which the sluice was operated to maintain average monthly water levels in 2005 2009 and a sluice scenario the sluice operation was based on the plmrp opening the sluice to connect the lake and yangtze river in april august and closing the sluice to maintain water level of the lake during the rest of the year fig 3 the pre tgd represented water level of poyang lake in a period 1999 2003 with normal to high precipitation zhang et al 2016a and no influence of tgd operation the post tgd scenario represented water level of poyang lake in a period 2005 2009 with normal to low precipitation zhang et al 2016b and the influence of tgd operation finally we calculated sf in each water level management scenario using eq 7 our stock enhancement scenarios were developed based on a goal of stocking at least 200 million fish all species combined across water bodies in jiangxi province per year which was announced by the department of agriculture and rural affairs of jiangxi province http www jxagri gov cn in september 2018 in the announced stocking plan the majority of the 200 million stocked fish will be fingerlings of the four major chinese carps that have a minimum size of 3 cm or about 0 5 g therefore we assumed that the total biomass of stocked fingerlings of the four chinese carps is about 100 tonnes across the jiangxi province accordingly we developed low medium and high stocking scenarios as stocking 50 100 and 150 tonnes of fingerlings of the four major chinese carps respectively which represented a possible range of the total biomass of fingerlings of the four major chinese carps stocked in poyang lake by jiangxi province the total fingerling biomass in each stocking scenario was then apportioned to the four chinese carps based on the biomass observed between 2007 and 2009 the last three years of the calibration period our fishery restriction scenarios include high fishing pressure low fishing pressure and no fishing the high fishing pressure scenario represented that there is no further restriction on fisheries in poyang lake and the average fishing mortality rates in 2007 2009 which were calculated in section 2 4 1 were applied in simulations the no fishing scenario represented the maximum achievable restoration effort although the jiangxi province currently has no plan to further restricting fisheries the low fishing pressure scenario in which 50 of the average fishing mortality rates in 2007 2009 were applied in simulations represented a middle ground between high fish pressure and no fishing scenarios across all 27 scenario combinations we ran simulations for 110 years between 2010 the first year after the calibration period of 2000 2009 and 2119 simulated biomass of all food web groups reached equilibrium within 50 simulation years across all scenarios we reported the equilibrium biomass for the four major chinese carps across scenarios 3 results 3 1 ecosim calibration after calibration biomass time series simulated by the poyang lake ecosim model mostly fitted well with observed biomass time series fig 4 fits were best for mandarin fish culters yellow catfish bighead carp 1 black carp 1 common carp and crucian carp with rmsd between 0 15 and 0 28 for amur catfish grass carp 1 and chinese breams simulated and observed biomass time series had opposite trends during part of the calibration period with rmsd of about 0 32 simulated biomass time series of silver carp 1 generally fitted well with observed biomass time series but did not have the same large inter annual variation as observed between 2006 and 2008 which resulted in a relatively higher rmsd of 0 37 fits were relative poor for small fishes with an rmsd of 0 48 mainly because simulated biomass time series did not have the same low biomass period between 2003 and 2007 3 2 simulated biomass of the four major chinese carps results fig 5 showed that water level management stock enhancement and fishery restriction can all increase biomass of the four major chinese carps in poyang lake but effects of fishery restriction could be the strongest however even in the best management effort scenario i e highest water level highest stocking biomass and no fishing simulated total biomass of the four major chinese carps was still 16 lower than the biomass estimates used in the 2000 poyang lake ecopath model equilibrium total biomass of the four major chinese carps increased by 30 78 across all water level management and stock enhancement scenarios where fishing pressure decreased from the high to the low level and increased by another 57 85 across all scenarios where fishing pressure decreased from the low level to no fishing results also showed that positive effects of fishery restriction on biomass of the four major chinese carps increased with increases in water level and decreases in stocking rate between scenarios of the same level of decrease in fishing pressure e g decreased from scenarios of high fishing pressure to low fishing pressure the largest increases in equilibrium biomass of the four major chinese carps occurred under the scenario of low stocking and pre tgd water level equilibrium biomass of the four major chinese carps increased by 35 88 across all stock enhancement and fishery restriction scenarios where water level management scenarios changed from post tgd to sluice but increased by only 0 2 3 across all scenarios where water level management scenarios changed from pre tgd to sluice fig 5 across all scenarios where water level management scenarios changed from post tgd to sluice the largest increase in equilibrium biomass of the four major chinese carps occurred under the scenario of lowest stocking rate and no fishing while the least increase occurred under the scenario of no fishing and largest stocking equilibrium biomass of the four major chinese carps increased by 9 52 across all water level management and fishery restriction scenarios where stocking increase from the low to the medium level and increased by another 3 16 across all scenarios where stocking increased from the medium to the high level fig 5 results also showed that positive effects of stock enhancement on biomass of the four major chinese carps generally increased with increases in fishing restriction and water level however between scenarios of low and medium stocking level the largest increases in equilibrium biomass of the four major chinese carps occurred under the scenario of no fishing and post tgd water level 4 discussion 4 1 overview and synthesis in this case study of poyang lake we found that a combination of maintaining a relatively high water level stocking fingerlings and restricting fisheries can substantially offset negative effects of hydrological changes on the four major chinese carps however even though managing water level and stocking fingerlings are both more direct management responses to habitat degradation and fragmentation caused by recent hydrological changes we found that restricting fisheries could be the most effective way to restore the four major chinese carps these results suggest that the four major chinese carps have been stressed by overfishing even with the enforcement of a breeding season fishing bang further overfishing may exacerbate the negative effects of habitat degradation and fragmentation on the four major chinese carps for example when water level decreased from pre tgd scenario to post tgd scenario fig 3 and stocking was maintained at the highest level i e 150 tonnes of fingerlings simulated total biomass of the four major chinese carps decreased by 26 under the low fishing pressure scenario but by 32 under the high fishing pressure scenario while the proposed sluice may maintain the size and quality of habitat during droughts and in the dry season it may also eliminate the potential for strong year classes of the four major chinese carps in poyang lake which usually occurred alongside with yangtze river flooding duan et al 2009 because of the blockage of river lake connectivity even in our best management effort scenario i e highest water level highest stocking biomass and no fishing simulated total biomass of the four major chinese carps was still 16 lower than the biomass estimate used in our 2000 poyang lake ecopath model the main difference between the poyang lake ecosystem represented in all of our scenario simulations and in our 2000 ecopath model was that we assumed that there will be no natural recruitment for the four major chinese carps after the proposed sluice is built and operated to manage water level additionally the biomass of the four major chinese carps in 2000 could be at a relatively high level because the high yangtze river water level in 1997 1999 might result in strong year classes of the four major chinese carps in poyang lake duan et al 2009 these results also suggest the proposed plmrp may stabilize the biomass of the four major chinese carps but may not restore their biomass to high levels that had occurred before the operation of tgd because of the blockage of river lake connectivity by the poyang lake sluice we hypothesized that increases in water level will result in increases in primary productivity of the poyang lake ecosystem accordingly we used a simple equation 7 to model effects of water level on primary productivity in our poyang lake ecosim model this hypothesis was supported by empirical studies from liu et al 2016b and wu et al 2013 both studies suggested that the observed positive correlation between water level and primary productivity in poyang lake could be explained by a better light condition for the primary producers to grow at a higher water level because of the low water depth of poyang lake water level could be an important control on sediment resuspension and water transparency especially during the dry season liu et al 2016b wu et al 2013 additionally this hypothesis was also supported by this study we were able have our ecosim predicted biomass time series fit well with observed biomass time series fig 4 which indicates that it should be reasonable to use equation 7 to model the relationship between water level and primary productivity in the poyang lake ecosystem as water level can be a main control on primary productivity the four major chinese carps in poyang lake can be stressed by food limitation in drought years our results showed that when water level increased from post tgd scenario i e low water levels in a dry period after tgd operation to sluice scenario i e the proposed water level management plan through sluice operation the simulated biomass increased across food web groups in all trophic levels these results suggest strong bottom up resource controls in the poyang lake ecosystem at low water levels other studies also showed that biomass of organisms across trophic levels decreased with water level in the poyang lake ecosystem including phytoplankton qian et al 2017 zooplankton liu et al 2016a benthos cai et al 2014 and submerged macrophytes wu et al 2009 these studies support our hypothesized relationship between water level and primary productivity and also suggest strong bottom up controls in the poyang lake ecosystem at least at low water levels although the importance of lake level fluctuation to nutrient recycling and primary productivity has been documented in other ecosystems e g gownaris et al 2018 kolding and van zwieten 2012 we could not find any previous study supporting this hypothesis for the poyang lake ecosystem one plausible explanation is that even though the fluctuation of water level can facilitate nutrient recycling the quantity of recycled nutrients is small relatively to the nutrient inputs from tributaries for the poyang lake ecosystem on an annual basis about 240 tonnes of phosphorus was released from poyang lake sediments wu 2014 which was about 6 4 of phosphorus inputs 3700 tonnes from poyang lake tributaries chen et al 2016 therefore effects of water level on primary productivity could be much stronger than effects of water level fluctuation in the poyang lake ecosystem while our fishery restriction scenarios included a scenario representing the maximum achievable restoration effort i e no fishing it is possible to increase restoration effort above our best restoration effort scenario of either water level management or stock enhancement however we found that there might be an upper limit above which stocking more fingerlings of the four major chinese carps or maintaining water level at an even higher level will have little positive effects on the biomass of the four major chinese carps in poyang lake for example our scenario simulations showed that increasing stocking rate from 100 tonnes to 150 tonnes fingerlings per year did not result in the same level of biomass increases for the four major chinese carps as increasing in stocking rate from 50 tonnes to 100 tonnes fingerlings per year fig 5 although identifying an optimal biomass of the four major chinese carps to stock in poyang lake is beyond the scope of this study and the capacity of our ewe model more research e g understanding the relationship between water level and primary productivity survival rates of stocked fingerlings is needed so that the poyang lake ecosystem can be better understood and the valuable resource can be better spent on restoration 4 2 potential model biases we first acknowledge that poyang lake is a data poor ecosystem so that while our ewe input parameters were developed based on our best effort the parameterization of this ewe model can be improved with more researches similar to many other ewe models built for aquatic ecosystems in developing countries e g chea et al 2016 downing et al 2012 guo et al 2013 shan et al 2014 our ewe biomass inputs for fish groups were largely based on fishery dependent data and empirical estimations of mortality rates and our p b and q b inputs for lower trophic level groups were largely based on empirical models developed based on global dataset these model input parameters can be improved by for example developing statistical catch at age population models e g he et al 2015 and conducting monitoring surveys e g bunnell et al 2014 we used rmsd which suggests a goodness of fit between simulated and observed biomass time series in ecosim calibration as an indicator of potential model biases for a food web group within our poyang lake ecosim model following kao et al 2018 we diagnosed a relatively high rmsd of silver carp 1 as noninfluential because it was driven by a year 2007 of poor fit and the simulated biomass could emulate the general trend of observed biomass changes in the ecosim calibration period of 2000 2009 relatively high rmsd for amur catfish grass carp 1 chinese breams and small fishes indicated potential biases for these groups however these relatively high rmsd could also be caused by inaccurate fishery statistics in some years as these biomass time series were based on fishery dependent data for example due to low economic value small fish catches often under reported qian et al 2002 fang et al 2016 4 3 management implications while we showed that water level management and stock enhancement could both offset negative effects of hydrological changes on the four major chinese carps in poyang lake we highlight the importance to incorporate fishery restriction into restoration planning we found that overfishing may not only stress the four major chinese carps more than habitat degradation and fragmentation but also exacerbate the negative effects of habitat degradation and fragmentation on the four major chinese carps in poyang lake our results also implied that current breeding season fishing ban with focuses of protecting reproduction and enhancing juvenile survival rates may not be enough to sustain fisheries of the four major chinese carps in poyang lake however it is uncertain whether a stricter fishery restriction than current breeding season fishing ban can be achieved therefore future fishery management may use different approaches to reduce fishing pressure such as regulating landing size fishing gear catch quota and fishing area chen et al 2012 allan et al 2005 we also highlight the importance of maintaining water level during the dry season to the four major chinese carps in poyang lake as our results suggest that low water levels during the dry season can result in food limitation and become a recruitment bottleneck to them similar recruitment bottleneck resulted from low dry season water level was also observed for fishery species in other floodplain ecosystems after drought fish abundance sharply dropped in floodplain lakes in both central amazon ropke et al 2017 and australia arthington et al 2005 however the dry season water level of poyang lake may be negatively affected by the operation of tgd the dry season of poyang lake begins usually in september during the tgd impoundment period september november and the impoundment of tgd has resulted in an increase in the difference between yangtze river and poyang lake water levels which lead to an increase in the drainage and a decrease of the water level of poyang lake zhang et al 2012 in a long term sediment trapping by the tgd may further lower the water level in mlyr and increase in the difference between yangtze river and poyang lake water levels during the dry season lai et al 2014 in this respect even though proposed poyang lake sluice will unavoidably block the yangtze river poyang lake connectivity it might be needed to maintain the size and quality of habitat for the four chinese carps in the dry season stock enhancement is a direct management response to reported recruitment decreases of the four major chinese carps in poyang lake huang et al 2013 however our results implied that there is an upper limit about which stocking more fingerlings of the four major chinese carps is not cost effective additionally the efficacy of stock enhancement in poyang lake may be also negatively affected by high juvenile fishing mortality rates as currently lots of harmful fishing gears and methods are used for poyang lake fisheries recent decreases in fishery resources have resulted in increases in fishing pressure on juveniles of the four major chinese carps wang et al 2017 our study also suggests that managers in other lake ecosystems connected to mlyr such as dongting lake to incorporate fishery regulation into stock enhancement planning finally to our understanding this is the first study using the ewe modeling approach to investigate simultaneous effects of multiple restoration practices in a proposed multi faceted restoration project for a chinese freshwater ecosystem we demonstrated that using an ecosystem model can provide evaluations of management scenarios in a timely manner we suggest that ewe and other ecosystem models should be utilized more often to support ecosystem based management acknowledgements this study is supported by national key research development program of china grant no 2017yfc0405303 poyang lake model project pjb201701 and national natural science foundation of china grant nos 41301077 31700403 and 41561105 appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j ecolmodel 2019 03 020 appendix a supplementary data the following are the supplementary data to this article 
25053,habitat degradation and fragmentation have been the leading cause of reduced fishery yields in many freshwater ecosystems around the world in poyang lake the largest freshwater lake in china recent hydrological changes driven by the operation of three gorges dam tgd and drought have caused a drastic loss of fishery resources in response managers have planned to build a sluice at poyang lake s outlet to manage the lake s water level and as the sluice will unavoidably limit the river lake migration of many fishery species managers have also proposed implementing stock enhancement programs and restricting fisheries to sustain fisheries in the lake in this study we built and implemented a poyang lake ecopath with ecosim model to evaluate effects of water level management stock enhancement and fishery restriction on biomass of the four major chinese carps grass carp ctenopharyngodon idella silver carp hypophthalmichthys molitrix bighead carp h nobilis and black carp mylopharyngodon piceus of which all are river lake migratory and important to fisheries results showed that the total biomass of the four major chinese carps could increase with increases in water level increases in stocking biomass and decreases in fishing pressure however even in the best management effort scenario i e highest water level highest stocking biomass and no fishing simulated total biomass of the four major chinese carps was still 16 lower than the biomass estimate in 2000 three years before the operation of tgd these results suggest that a combination of managing water level stocking and restricting fisheries can substantially offset negative effects of hydrological changes on the four major chinese carps but may not be enough to restore the biomass of the four major chinese carps to high levels that had occurred before the operation of tgd because of the blockage of river lake connectivity by the poyang lake sluice keywords poyang lake fisheries three gorges dam habitat connectivity water level management stock enhancement the four major chinese carps 1 introduction freshwater fisheries provide food security nutrition livelihoods and recreation to billions of people around the world welcomme et al 2010 lynch et al 2017 however the majority of freshwater fisheries and their ecosystems have been stressed by human activities especially by the construction of dams chen et al 2009 welcomme et al 2010 lynch et al 2017 dams have provided a range of social and economic benefits including irrigation flood control and hydropower generation and the impoundment of some dams does support important fisheries such as the kariba dam between zambia and zimbabwe karenge and kolding 1995 however effects of dams on fish habitats have been mostly negative and irreversible the structure of the dam itself could block fish migration and sequester nutrients and sediments that support downstream fish habitats such as river deltas nilsson et al 2005 dudgeon et al 2006 suzuki and pompeu 2016 flow regulation by the dams could eliminate floods that sustain floodplains for many fishes to use as spawning and nursery area fu et al 2003 ziv et al 2012 song et al 2018 one giant dam sensu nilsson et al 2005 could even result in profound changes in fish communities across the whole river system by altering the river s hydrological thermal and chemical regimes china is the country with the largest freshwater catches but the catches have been reportedly declining in recent years fao 2016 the majority of china s freshwater catches are from the basin of middle and lower reaches of yangtze river mlyr referring to yangtze river below three gorges where many fishery stocks have a long history of being stressed by pollution overexploitation and habitat fragmentation chen et al 2009 liu and wang 2018 since 2003 fisheries in the basin of mlyr have been further stressed by three gorges dam tgd and its operation for hydropower generation the structure of tgd has disrupted the longitudinal connectivity of yangtze river and the operation of tgd has changed the flow regime of mlyr which both have negatively affected the recruitment of many fishery species xie et al 2007 duan et al 2009 additionally sediment trapping by tgd resulted in deepened river bed of mlyr which further lowered the water level of mlyr and the lateral connectivity between mlyr and its floodplain habitats during recent droughts lai et al 2014 coincided with these reported hydrological changes that have caused habitat degradation and fragmentation decreases in fishery production have been reported across many fishing grounds in the basin of mlyr chen et al 2009 wang et al 2014 changes in the flow regime of mlyr after the operation of tgd have especially strong negative effects on fish community and fisheries in poyang lake fig 1 the largest freshwater lake in china as a floodplain ecosystem poyang lake drains into yangtze river but also receives the backflow from yangtze river when yangtze river water level is at its seasonal high usually between july and october ye et al 2012 this river lake interaction is important to the recruitment of migratory fishes in poyang lake fang et al 2016 of which many are very important to fisheries such as the four major chinese carps silver carp hypophthalmichthys molitrix bighead carp h nobilis grass carp ctenopharyngodon idella and black carp mylopharyngodon piceus the four major chinese carps feed and grow in poyang lake but migrate into yangtze river for spawning in spring usually between april and may and then their larvae drift into poyang lake with the backflow from yangtze river chen et al 2009 li et al 2013 comparing with the historical flow regime the flow in mlyr has increased in the tgd drawdown period april june but decreased in the tgd impoundment period september november since the operation of tgd lai et al 2014 the changes in the flow regime of mlyr have been linked to the decrease in larvae abundance of the four major chinese carps duan et al 2009 in addition to changes in the flow regime of mlyr poyang lake fisheries were also stressed by drought which was widespread in the whole basin of yangtze river in recent years lai et al 2014 the average tributary inflow of poyang lake in 2003 2009 was 20 lower than that of 1957 2002 coincided with an 8 decrease in precipitation and a 10 increase in water consumption zhang et al 2016a the decrease in tributary inflow has been linked the decreases in water level zhang et al 2014 aquatic habitat area wu and liu 2017 and nutrient in terms of total phosphorus inputs of poyang lake liu et al 2014 further the operation of tgd might intensify negative effects of drought on the poyang lake ecosystem for example zhang et al 2012 showed that the impoundment of tgd has resulted in an increase in the difference between yangtze river and poyang lake water levels which in turn may result in an increase in the drainage and a decrease of the water level of poyang lake managers have been concerned about habitat degradation and fragmentation associated with recent changes in the flow regime of mlyr and droughts that might have negatively affected the fisheries of the four major chinese carps in poyang lake total catch of the four major chinese carps decreased by 59 in poyang lake between 2000 2001 and 2008 2009 wang et al 2014 which were two hydrologically normal years before the operation of tgd and two drought years after the operation of tgd respectively zhang et al 2016b in response to the lake s recent loss of fishery resources managers have proposed a poyang lake multi faceted restoration project plmrp the proposed project includes three main components 1 building a sluice at the outlet of poyang lake to manage water level which is expected to restore the lake s floodplain habitats but will further limit the river lake migration of animals 2 implementing stock enhancement programs to stabilize recruitments of important fishery species and 3 restricting fisheries zhao et al 2011 wu et al 2014 however the long term benefit of this restoration project to poyang lake fisheries is still questionable and needs to be evaluated in this study we built and implemented an ecopath with ecosim ewe model christensen and walters 2004 to evaluate effects of the plmrp on the four major chinese carps while ewe models have been widely used to understand trophic flows among food web groups and simulate food web time dynamics in many freshwater ecosystems around the world e g cremona et al 2018 guo et al 2013 shan et al 2014 kao et al 2014 2016 2018 ecosim the scenario simulation component of ewe has been rarely implemented to support management decision making for china s freshwater fisheries to our understanding only li et al 2009 and zhao et al 2018 implemented ecosim to investigate fishery profits and fish community structure under a range of harvest and habitat change scenarios in freshwater ecosystems in china to evaluate effects of the plmrp we designed our ewe simulation analysis as a full factorial experiment that included three factors water level stocking and fishery restriction each factor had three levels or scenarios that were developed based on managers proposals in plmrp we simulated changes in biomass of the four major chinese carps across all 27 combinations of water level management stocking and fishery restriction scenarios 2 materials and methods 2 1 study area poyang lake is located in jiangxi province and connected to the middle reach of yangtze river via a 65 km channel at the north end fig 1 the lake has an average area of 2933 km2 and a mean depth of 8 4 m but seasonal fluctuations of water level and lake area are both high in flood season april august the lake have an area of 4000 km2 and an average depth of about 11 6 m shankman et al 2006 in the dry season september march the lake can have an area of 1000 km2 and an average depth of about 3 7 m wang et al 2011 the poyang lake basin has a subtropical climate with an average rainfall of 1878 mm per year and 50 of annual rainfall in the flood season guo et al 2008 the trophic status of poyang lake is between mesotrophic and eutrophic liu et al 2017 2 2 specifics of the plmrp once again the main components of plmrp include 1 managing the lake s water level by building and operating a sluice at the lake s outlet 2 implementing stock enhancement programs and 3 restricting fisheries zhao et al 2011 wu et al 2014 the proposed water level management plan is to keep the sluice open during yangtze river s high flow season april august to allow the river lake connection but keep the sluice closed otherwise to retain water in the lake although poyang lake s stock enhancement programs started in 2002 large scale stocking did not begin until 2010 proposed stock enhancement programs have a specific focus on the four major chinese carps because of their river lake migration and importance to fisheries for fishery restrictions currently fisheries in poyang lake are closed during the spring spawning season chen et al 2009 but a 10 year ban on all fishing in the main stem of yangtze river will start in 2020 as announced by china s ministry of agriculture and rural affairs www moa gov cn in january 2019 2 3 modeling the poyang lake ecosystem to evaluate long term benefits of the plmrp we used the ewe modeling approach christensen and walters 2004 and its accompanied program software ewe version 6 5 available from www ecopath org to investigate effects of water level management stock enhancement and fishery restriction on the four major chinese carps as summarized in fig 2 our analyses included three main tasks first we built an ecopath model to represent biomass flows in the poyang lake food web in 2000 which was the first year when we have enough data to estimate biomass inputs across all trophic levels second we built and calibrated a poyang lake ecosim model third we implemented the ecosim model to simulate food web dynamics over time under management scenarios which were developed based on the plmrp based on christensen et al 2008 we modeled biomass flows among food web groups in our poyang lake ecopath model as 1 b i p b i e e i j b j q b j d c i j y i 0 where b is biomass g m2 in wet weight subscript i and j indicate two specific groups p b is production to biomass ratio year 1 ee is the ecotrophic efficiency dimensionless q b is consumption to biomass ratio year 1 dc ij is the proportion of group i in the diet of group j and y is fishery yield g m 2 year 1 in this ecopath model ee represented the fraction of production for each group lost to predation or fishing and could be estimated after b p b q b and dc for all poyang lake food web groups were input christensen et al 2008 we ensured the ecopath model to achieve biomass balance ee 1 at parameterization the energy balance in an ecopath model is modeled as 2 p q i u q i r q i 1 where p q i is production to consumption ratio u q i is the proportion of unassimilated food in consumption and r q i is respiration to consumption ratio christensen et al 2008 in the ecopath model p q i was calculated based on input values of p b i and q b i u q i was an input and r q i was estimated using eq 2 we also ensured the ecopath model to achieve energy balance r q 0 at parameterization based on christensen et al 2008 and our poyang lake ecopath model we modeled the change in b i over time in our poyang lake ecosim model as 3 d b i d t g i j q j i j q i j m 0 i f i b i where g is gross conversion efficiency dimensionless q ji is consumption on group j by group i g m 2 year 1 q ij is predation on group i by group j g m 2 year 1 m0 is non predatory natural mortality rate year 1 and f is fishing mortality rate year 1 in the ecosim model consumption was predicted based on the foraging arena theory ahrens et al 2012 as did in kao et al 2016 the foraging arena equation could be expressed as 4 q i j p i j v i j b i b j f 1 v i j 1 f 2 p i j b j f 3 where p ij is predation rate on group i by unit biomass of group j g 1 year 1 v ij is vulnerability parameter dimensionless and f 1 f 2 and f 3 are functions representing effects of feeding time and handling time on consumption which were kept as default settings for details refer to christensen et al 2008 2 4 parameterization of the poyang lake ecopath model we configured 19 food web groups in the poyang lake ecopath model table 1 input values of b p b and q b table 2 were obtained from literature or estimated using empirical models due to lack of information we set u q to the ecopath default value of 0 20 for fish groups christensen et al 2008 and following kao et al 2014 we set u q to 0 55 0 55 and 0 40 for shrimps benthos and zooplankton respectively as shown in supplementary table s1 diet composition inputs dc were either obtained from literature for poyang lake studies or based on studies of the same taxa in similar lake ecosystems in the basin of mlyr 2 4 1 fish groups our poyang lake ecopath model included 13 fish taxa table 1 in order to simulate effects of stock enhancement in ecosim we parameterized the four major chinese carps as multi stanza groups with two stanzas age zero age 0 and age one and older age 1 and set the age 1 stanza as the leading stanza christensen et al 2008 additional input parameters required for multi stanza groups include the von bertalanffy 1938 growth parameter k which we obtained from literature supplementary table s2 and the ratio of weight at maturity to asymptotic weight w m w which we set to the default value of 0 09 christensen et al 2008 inputs for b and q b were only required for leading stanza groups and b and q b for other stanza groups were estimated by ecopath based on other input parameters christensen and others 2008 we first estimated p b for single stanza groups or z for the leading stanza groups of the four major chinese carps using the beverton and holt 1957 model based on k asymptotic length l average length l ave and cut off length at entry into fishery l cut we set z for age 0 groups of the four major chinese carps to 3 year 1 based on wang et al 2017 following christensen et al 2008 we estimated biomass inputs using fishery yield y calculated from the catch statistics dataset used in wang et al 2014 as 5 b y f y z m where m is natural mortality rate we estimated m using empirical model based on k l and an annual average water temperature t ann of 18 c xu and wang 1989 we estimated q b using the empirical model from palomares and pauly 1998 based on t ann w and aspect ratio a the ratio of square of caudal fin height to its surface area we obtained values for l l ave l cut and w from literature and estimated aspect ratios using images of poyang lake fish samples supplementary table s2 2 4 2 shrimps the biomass input of shrimps was estimated using fishery yield y from the fishery catch dataset in wang et al 2014 and equation 5 we estimated p b for shrimps using brey s 2012 empirical model for crustaceans in a lake habitat with a mean temperature of 18 and a mean depth of 8 4 m another required input for brey s empirical model is average individual weight in a unit of j which we used 1000 j for shrimps based on an average individual weight of 1 25 g shi et al 1995 and an energy density of 792 j g cummins and wuycheck 1971 we estimated natural mortality rate for shrimps using hoenig s 1983 empirical model based on a longevity of two years we calculated q b for shrimps based on empirically estimated p b and a p q of 0 19 li et al 2018 2 4 3 lower trophic level groups biomass inputs of benthos zooplankton and producer groups were obtained from cui and li 2005 which were estimated based on survey data between 1997 and 1999 similar to the estimation for p b of shrimps we estimated p b for main taxa of benthos using brey s 2012 empirical model and an average individual weight of 50 j based on average individual weights from cui and li 2005 and energy densities from cummins and wuycheck 1971 we estimated p b for main taxa of zooplankton using empirical models from shuter and ing 1997 based on an annual average temperature of 18 p b values for phytoplankton and submerged macrophytes were obtained from sun and huang 1993 and kao et al 2014 respectively we calculated q b for benthos and zooplankton based on empirically estimated p b and a p q of 0 23 for benthos kao et al 2014 and a p q of 0 26 for zooplankton straile 1997 2 4 4 detritus we used the empirical model from pauly et al 1993 to estimate detritus biomass in a carbon unit gc m2 based on an annual primary production of 980 gc m2 and a euphotic depth of 2 4 m zhu and zhang 1997 to calculate the wet weight biomass input of detritus we multiplied the empirically estimated carbon biomass of detritus by a wet weight to carbon ratio of 4 based on kao et al 2014 2 5 ecosim calibration the objective of our ecosim calibration was to estimate the vulnerability parameter in equation 4 for each consumer group by minimizing the overall sum of squares between predicted and observed biomass after logarithm transformation in the calibration period 2000 2009 christensen et al 2008 we used observed fishery yields and water level in the calibration period as drivers of biomass time dynamics of all modeled food web groups in our ecosim calibration even though the stocking program started in 2002 the scale of stocking was small in the calibration period so that we assumed that stocking had no effect on fish biomass and did not include stocking in ecosim calibration in summary inputs required for our ecosim calibration included time series for observed biomass and fishery yield and a forcing function that links primary productivity and observed water level for 12 out of 13 fish taxa in our poyang lake ecosim model we used the dataset in wang et al 2014 and the method described in 2 3 1 to calculate 2000 2009 time series for observed biomass and fishery yield however we were unable to obtain data to calculate observed biomass time series for lake anchovy and non fish groups due to low catch rates the management agency has stopped reporting catch statistics of lake anchovy since 2002 as a result we assumed that there was no harvest on lake anchovy in the calibration period in our poyang lake ecosim model we represented effects of water level changes on the poyang lake food web as a control of primary productivity based on christensen et al 2008 we modeled the production p of producer group i as 6 p i b i s f p b m a x i n f n f k i where p b max i is the maximum production to biomass ratio sf is a seasonal forcing function that represents water level effects on primary productivity nf is the proportion of free nutrients and k i is a model constant we calculated sf as 7 s f m o n t h d e p t h m o n t h 8 4 8 4 where depth month is average monthly depth m recorded at xingzi hydrology station fig 1 and 8 4 m is the average depth of poyang lake we developed eq 7 based on a hypothesis that increases in water level can lead to increases in habitat availability which in turn lead to increase in primary productivity this hypothesis was developed based on wu et al 2013 and liu et al 2016b which showed a strong positive correlation between water level and primary productivity as indicated by chlorophyll a we kept all ecosim parameters at default setting except 1 vulnerability parameters which were estimated through calibration and 2 the base proportion of free nutrients which was set to 0 75 to represent a mesotrophic ecosystem christensen et al 2008 notably in eq 6 p b max i was set at default value of twice of ecopath p b i and nf and k i were estimated by ecosim christensen et al 2008 finally we calculated root mean square deviations between predicted and observed biomass after logarithm transformation rmsd to judge relative goodness of fit across groups in our ecosim model 2 6 scenario simulations following the approach in kao et al 2018 we designed our scenario simulations as a full factorial experiment including three three level factors water level management stock enhancement and fishery restriction we chose to run all 27 scenario combinations instead of using other methods such as the orthogonal experimental design to reduce the number of simulation runs because computational time was not a limitation in this study on average it took us less than 1 min to run a scenario simulation on an average personal computer the four major chinese carps were modeled as ecosim hatchery groups christensen et al 2008 whose recruitments were sustained by stocking fingerlings in all of our scenario simulations we assumed that there will be no natural recruitment for the four major chinese carps after the sluice is built and operated to manage water level because of the blockage of river lake connectivity therefore by comparing simulated biomass across scenarios with the biomass inputs in our 2000 poyang lake ecopath model we could identify the combinations of scenarios in plmyr that can restore the biomass of the four major chinese carps to a level before the operation of tgd our water level management scenarios included a pre tgd scenario in which the sluice was operated to maintain average monthly water levels in 1999 2003 a post tgd scenario in which the sluice was operated to maintain average monthly water levels in 2005 2009 and a sluice scenario the sluice operation was based on the plmrp opening the sluice to connect the lake and yangtze river in april august and closing the sluice to maintain water level of the lake during the rest of the year fig 3 the pre tgd represented water level of poyang lake in a period 1999 2003 with normal to high precipitation zhang et al 2016a and no influence of tgd operation the post tgd scenario represented water level of poyang lake in a period 2005 2009 with normal to low precipitation zhang et al 2016b and the influence of tgd operation finally we calculated sf in each water level management scenario using eq 7 our stock enhancement scenarios were developed based on a goal of stocking at least 200 million fish all species combined across water bodies in jiangxi province per year which was announced by the department of agriculture and rural affairs of jiangxi province http www jxagri gov cn in september 2018 in the announced stocking plan the majority of the 200 million stocked fish will be fingerlings of the four major chinese carps that have a minimum size of 3 cm or about 0 5 g therefore we assumed that the total biomass of stocked fingerlings of the four chinese carps is about 100 tonnes across the jiangxi province accordingly we developed low medium and high stocking scenarios as stocking 50 100 and 150 tonnes of fingerlings of the four major chinese carps respectively which represented a possible range of the total biomass of fingerlings of the four major chinese carps stocked in poyang lake by jiangxi province the total fingerling biomass in each stocking scenario was then apportioned to the four chinese carps based on the biomass observed between 2007 and 2009 the last three years of the calibration period our fishery restriction scenarios include high fishing pressure low fishing pressure and no fishing the high fishing pressure scenario represented that there is no further restriction on fisheries in poyang lake and the average fishing mortality rates in 2007 2009 which were calculated in section 2 4 1 were applied in simulations the no fishing scenario represented the maximum achievable restoration effort although the jiangxi province currently has no plan to further restricting fisheries the low fishing pressure scenario in which 50 of the average fishing mortality rates in 2007 2009 were applied in simulations represented a middle ground between high fish pressure and no fishing scenarios across all 27 scenario combinations we ran simulations for 110 years between 2010 the first year after the calibration period of 2000 2009 and 2119 simulated biomass of all food web groups reached equilibrium within 50 simulation years across all scenarios we reported the equilibrium biomass for the four major chinese carps across scenarios 3 results 3 1 ecosim calibration after calibration biomass time series simulated by the poyang lake ecosim model mostly fitted well with observed biomass time series fig 4 fits were best for mandarin fish culters yellow catfish bighead carp 1 black carp 1 common carp and crucian carp with rmsd between 0 15 and 0 28 for amur catfish grass carp 1 and chinese breams simulated and observed biomass time series had opposite trends during part of the calibration period with rmsd of about 0 32 simulated biomass time series of silver carp 1 generally fitted well with observed biomass time series but did not have the same large inter annual variation as observed between 2006 and 2008 which resulted in a relatively higher rmsd of 0 37 fits were relative poor for small fishes with an rmsd of 0 48 mainly because simulated biomass time series did not have the same low biomass period between 2003 and 2007 3 2 simulated biomass of the four major chinese carps results fig 5 showed that water level management stock enhancement and fishery restriction can all increase biomass of the four major chinese carps in poyang lake but effects of fishery restriction could be the strongest however even in the best management effort scenario i e highest water level highest stocking biomass and no fishing simulated total biomass of the four major chinese carps was still 16 lower than the biomass estimates used in the 2000 poyang lake ecopath model equilibrium total biomass of the four major chinese carps increased by 30 78 across all water level management and stock enhancement scenarios where fishing pressure decreased from the high to the low level and increased by another 57 85 across all scenarios where fishing pressure decreased from the low level to no fishing results also showed that positive effects of fishery restriction on biomass of the four major chinese carps increased with increases in water level and decreases in stocking rate between scenarios of the same level of decrease in fishing pressure e g decreased from scenarios of high fishing pressure to low fishing pressure the largest increases in equilibrium biomass of the four major chinese carps occurred under the scenario of low stocking and pre tgd water level equilibrium biomass of the four major chinese carps increased by 35 88 across all stock enhancement and fishery restriction scenarios where water level management scenarios changed from post tgd to sluice but increased by only 0 2 3 across all scenarios where water level management scenarios changed from pre tgd to sluice fig 5 across all scenarios where water level management scenarios changed from post tgd to sluice the largest increase in equilibrium biomass of the four major chinese carps occurred under the scenario of lowest stocking rate and no fishing while the least increase occurred under the scenario of no fishing and largest stocking equilibrium biomass of the four major chinese carps increased by 9 52 across all water level management and fishery restriction scenarios where stocking increase from the low to the medium level and increased by another 3 16 across all scenarios where stocking increased from the medium to the high level fig 5 results also showed that positive effects of stock enhancement on biomass of the four major chinese carps generally increased with increases in fishing restriction and water level however between scenarios of low and medium stocking level the largest increases in equilibrium biomass of the four major chinese carps occurred under the scenario of no fishing and post tgd water level 4 discussion 4 1 overview and synthesis in this case study of poyang lake we found that a combination of maintaining a relatively high water level stocking fingerlings and restricting fisheries can substantially offset negative effects of hydrological changes on the four major chinese carps however even though managing water level and stocking fingerlings are both more direct management responses to habitat degradation and fragmentation caused by recent hydrological changes we found that restricting fisheries could be the most effective way to restore the four major chinese carps these results suggest that the four major chinese carps have been stressed by overfishing even with the enforcement of a breeding season fishing bang further overfishing may exacerbate the negative effects of habitat degradation and fragmentation on the four major chinese carps for example when water level decreased from pre tgd scenario to post tgd scenario fig 3 and stocking was maintained at the highest level i e 150 tonnes of fingerlings simulated total biomass of the four major chinese carps decreased by 26 under the low fishing pressure scenario but by 32 under the high fishing pressure scenario while the proposed sluice may maintain the size and quality of habitat during droughts and in the dry season it may also eliminate the potential for strong year classes of the four major chinese carps in poyang lake which usually occurred alongside with yangtze river flooding duan et al 2009 because of the blockage of river lake connectivity even in our best management effort scenario i e highest water level highest stocking biomass and no fishing simulated total biomass of the four major chinese carps was still 16 lower than the biomass estimate used in our 2000 poyang lake ecopath model the main difference between the poyang lake ecosystem represented in all of our scenario simulations and in our 2000 ecopath model was that we assumed that there will be no natural recruitment for the four major chinese carps after the proposed sluice is built and operated to manage water level additionally the biomass of the four major chinese carps in 2000 could be at a relatively high level because the high yangtze river water level in 1997 1999 might result in strong year classes of the four major chinese carps in poyang lake duan et al 2009 these results also suggest the proposed plmrp may stabilize the biomass of the four major chinese carps but may not restore their biomass to high levels that had occurred before the operation of tgd because of the blockage of river lake connectivity by the poyang lake sluice we hypothesized that increases in water level will result in increases in primary productivity of the poyang lake ecosystem accordingly we used a simple equation 7 to model effects of water level on primary productivity in our poyang lake ecosim model this hypothesis was supported by empirical studies from liu et al 2016b and wu et al 2013 both studies suggested that the observed positive correlation between water level and primary productivity in poyang lake could be explained by a better light condition for the primary producers to grow at a higher water level because of the low water depth of poyang lake water level could be an important control on sediment resuspension and water transparency especially during the dry season liu et al 2016b wu et al 2013 additionally this hypothesis was also supported by this study we were able have our ecosim predicted biomass time series fit well with observed biomass time series fig 4 which indicates that it should be reasonable to use equation 7 to model the relationship between water level and primary productivity in the poyang lake ecosystem as water level can be a main control on primary productivity the four major chinese carps in poyang lake can be stressed by food limitation in drought years our results showed that when water level increased from post tgd scenario i e low water levels in a dry period after tgd operation to sluice scenario i e the proposed water level management plan through sluice operation the simulated biomass increased across food web groups in all trophic levels these results suggest strong bottom up resource controls in the poyang lake ecosystem at low water levels other studies also showed that biomass of organisms across trophic levels decreased with water level in the poyang lake ecosystem including phytoplankton qian et al 2017 zooplankton liu et al 2016a benthos cai et al 2014 and submerged macrophytes wu et al 2009 these studies support our hypothesized relationship between water level and primary productivity and also suggest strong bottom up controls in the poyang lake ecosystem at least at low water levels although the importance of lake level fluctuation to nutrient recycling and primary productivity has been documented in other ecosystems e g gownaris et al 2018 kolding and van zwieten 2012 we could not find any previous study supporting this hypothesis for the poyang lake ecosystem one plausible explanation is that even though the fluctuation of water level can facilitate nutrient recycling the quantity of recycled nutrients is small relatively to the nutrient inputs from tributaries for the poyang lake ecosystem on an annual basis about 240 tonnes of phosphorus was released from poyang lake sediments wu 2014 which was about 6 4 of phosphorus inputs 3700 tonnes from poyang lake tributaries chen et al 2016 therefore effects of water level on primary productivity could be much stronger than effects of water level fluctuation in the poyang lake ecosystem while our fishery restriction scenarios included a scenario representing the maximum achievable restoration effort i e no fishing it is possible to increase restoration effort above our best restoration effort scenario of either water level management or stock enhancement however we found that there might be an upper limit above which stocking more fingerlings of the four major chinese carps or maintaining water level at an even higher level will have little positive effects on the biomass of the four major chinese carps in poyang lake for example our scenario simulations showed that increasing stocking rate from 100 tonnes to 150 tonnes fingerlings per year did not result in the same level of biomass increases for the four major chinese carps as increasing in stocking rate from 50 tonnes to 100 tonnes fingerlings per year fig 5 although identifying an optimal biomass of the four major chinese carps to stock in poyang lake is beyond the scope of this study and the capacity of our ewe model more research e g understanding the relationship between water level and primary productivity survival rates of stocked fingerlings is needed so that the poyang lake ecosystem can be better understood and the valuable resource can be better spent on restoration 4 2 potential model biases we first acknowledge that poyang lake is a data poor ecosystem so that while our ewe input parameters were developed based on our best effort the parameterization of this ewe model can be improved with more researches similar to many other ewe models built for aquatic ecosystems in developing countries e g chea et al 2016 downing et al 2012 guo et al 2013 shan et al 2014 our ewe biomass inputs for fish groups were largely based on fishery dependent data and empirical estimations of mortality rates and our p b and q b inputs for lower trophic level groups were largely based on empirical models developed based on global dataset these model input parameters can be improved by for example developing statistical catch at age population models e g he et al 2015 and conducting monitoring surveys e g bunnell et al 2014 we used rmsd which suggests a goodness of fit between simulated and observed biomass time series in ecosim calibration as an indicator of potential model biases for a food web group within our poyang lake ecosim model following kao et al 2018 we diagnosed a relatively high rmsd of silver carp 1 as noninfluential because it was driven by a year 2007 of poor fit and the simulated biomass could emulate the general trend of observed biomass changes in the ecosim calibration period of 2000 2009 relatively high rmsd for amur catfish grass carp 1 chinese breams and small fishes indicated potential biases for these groups however these relatively high rmsd could also be caused by inaccurate fishery statistics in some years as these biomass time series were based on fishery dependent data for example due to low economic value small fish catches often under reported qian et al 2002 fang et al 2016 4 3 management implications while we showed that water level management and stock enhancement could both offset negative effects of hydrological changes on the four major chinese carps in poyang lake we highlight the importance to incorporate fishery restriction into restoration planning we found that overfishing may not only stress the four major chinese carps more than habitat degradation and fragmentation but also exacerbate the negative effects of habitat degradation and fragmentation on the four major chinese carps in poyang lake our results also implied that current breeding season fishing ban with focuses of protecting reproduction and enhancing juvenile survival rates may not be enough to sustain fisheries of the four major chinese carps in poyang lake however it is uncertain whether a stricter fishery restriction than current breeding season fishing ban can be achieved therefore future fishery management may use different approaches to reduce fishing pressure such as regulating landing size fishing gear catch quota and fishing area chen et al 2012 allan et al 2005 we also highlight the importance of maintaining water level during the dry season to the four major chinese carps in poyang lake as our results suggest that low water levels during the dry season can result in food limitation and become a recruitment bottleneck to them similar recruitment bottleneck resulted from low dry season water level was also observed for fishery species in other floodplain ecosystems after drought fish abundance sharply dropped in floodplain lakes in both central amazon ropke et al 2017 and australia arthington et al 2005 however the dry season water level of poyang lake may be negatively affected by the operation of tgd the dry season of poyang lake begins usually in september during the tgd impoundment period september november and the impoundment of tgd has resulted in an increase in the difference between yangtze river and poyang lake water levels which lead to an increase in the drainage and a decrease of the water level of poyang lake zhang et al 2012 in a long term sediment trapping by the tgd may further lower the water level in mlyr and increase in the difference between yangtze river and poyang lake water levels during the dry season lai et al 2014 in this respect even though proposed poyang lake sluice will unavoidably block the yangtze river poyang lake connectivity it might be needed to maintain the size and quality of habitat for the four chinese carps in the dry season stock enhancement is a direct management response to reported recruitment decreases of the four major chinese carps in poyang lake huang et al 2013 however our results implied that there is an upper limit about which stocking more fingerlings of the four major chinese carps is not cost effective additionally the efficacy of stock enhancement in poyang lake may be also negatively affected by high juvenile fishing mortality rates as currently lots of harmful fishing gears and methods are used for poyang lake fisheries recent decreases in fishery resources have resulted in increases in fishing pressure on juveniles of the four major chinese carps wang et al 2017 our study also suggests that managers in other lake ecosystems connected to mlyr such as dongting lake to incorporate fishery regulation into stock enhancement planning finally to our understanding this is the first study using the ewe modeling approach to investigate simultaneous effects of multiple restoration practices in a proposed multi faceted restoration project for a chinese freshwater ecosystem we demonstrated that using an ecosystem model can provide evaluations of management scenarios in a timely manner we suggest that ewe and other ecosystem models should be utilized more often to support ecosystem based management acknowledgements this study is supported by national key research development program of china grant no 2017yfc0405303 poyang lake model project pjb201701 and national natural science foundation of china grant nos 41301077 31700403 and 41561105 appendix a supplementary data supplementary data associated with this article can be found in the online version at https doi org 10 1016 j ecolmodel 2019 03 020 appendix a supplementary data the following are the supplementary data to this article 
25054,the estimation of forest attributes using active remote sensing data and sampling designs is a solid scientific discipline oriented to derive structural information from forest ecosystems in this study we examined the problem of selecting predictor variables derived from airborne laser scanning als when using stepwise and multiple linear regression and when using knn imputation using random forests rf to select predictor variables systems of forest attributes and ecological indicators were estimated using als statistics and ground data collected in central east spain on two mediterranean pine forest areas co registration errors were simulated by means of altering ground data coordinates the larger the co registration error the higher the variation in the selected als based predictors in the parametric approach which was less affected than the rf based selection in both cases the final performance of the models was not as affected by co registration errors as the observed variation in the selection of variables the impact was around 1 in the parametric approach while the value reached the 8 for both stand basal area and the gini index under the non parametric method the forest biophysical attributes of the set behaved differently towards altering the co registration factor in both cases to control the co registration factor between remote sensing data sources and ground surveys is an essential step to reduce uncertainty in data interpretation and in the modeling of forest attributes abbreviations 3d three dimensional aba area based approach als airborne laser scanning bic bayesian s information criterion chm canopy height model dbh diameter at breast height dg mean quadratic diameter dgnss differential global navigation satellite systems g basal area gps global positioning system h tree height ho dominant height knn k nearest neighbor lidar light detection and ranging ml machine learning n number of trees per hectare rf random forests rmse root mean square error rs remote sensing si site index sur seemingly unrelated regression tls terrestrial laser scanning vsm variable selection method keywords remote sensing machine learning positioning laser scanning random forests 1 introduction modern remote sensing techniques are very attractive alternatives to estimate forest information in large scale projects mcroberts et al 2010 the use of airborne laser scanning als is the reference technique when it comes to describe the vertical structure of forest ecosystems vauhkonen et al 2014 the term als refers to a lidar light detection and ranging sensor onboard an aircraft that captures the information while flying across the area of interest the capability of lasers to go through forest canopies highlight the vertical distribution of woody and leafy biomass and as a result tree attributes such as tree height or diameter can be estimated through mathematical models the statistics computed from a three dimensional 3d point cloud can be related to data surveyed in sampling designs as the x y and z coordinates easting northing and elevation of all echoes are registered therefore an accurate geographical co registration of als and ground data is essential to properly estimate forest biophysical attributes gobakken and næsset 2009 the sampling designs used in als based inference are frequently based on circular plots the accurate location of plot centre coordinates is the key step to perform the area based approach aba as echoes within a certain radius from the measured center point are only considered when computing the information vauhkonen et al 2014 therefore errors in plot positioning operations can affect the relationship between als statistics and forest biophysical attributes when conducting aba pascual et al 2018 factors such as the quality of field surveys the type of global positioning system gps equipment used or site conditions can bias the relationship between sensed and measured data and determine the severity of the positioning mismatch hasegawa and yoshimura 2008 kaartinen et al 2015 previous research has evaluated the impact of co registration errors on the estimation of forest biophysical attributes gobakken and næsset 2009 frazer et al 2011 and their impact of decisions in forest planning pascual et al 2018 the selection of als statistics has a direct influence on the estimation of forest biophysical attributes since those are predicted from equations that are combinations of several laser derived statistics the selection of robust and meaningful predictor variables contributes to better and simplified statistical analyses packalén et al 2012 for the purpose previous research has highlighted the benefit of implementing efficient variable selection methods vsm using on parametric murtaugh 2009 næsset 2011 and non parametric methods moser et al 2017 stepwise selection on parametric regression is commonly used when forest attributes are estimated using multiple linear regression e g næsset 2011 the method can be enhanced by using simultaneous regression using the selected predictors pascual et al 2018 however stepwise selection methods struggle when it comes to identify the level of correlation between all possible predictors which is the case of als height percentiles and density metrics harrell 2013 and to select a fixed number of predictor variables alternatives such as brute force search for the optimal subset of variables have also been evaluated in recent times using traditional parametric regression kotivuori et al 2016 a reasonable approach is to execute variable selection several times and to select a model that best fulfills the objective of the inventory breidenbach et al 2012 in parallel development k nearest neighbor knn imputation in forest inventory has gained relevance especially in the nordic countries using als data holmström et al 2003 one of the reasons is that knn simplifies the estimation of multi variety variables while relaxing assumptions regarding data distribution breidenbach et al 2012 algorithms such as random forests rf breiman 2001 have been widely used for classification purposes in the remote sensing arena belgiu and drăguţ 2016 however these algorithms can be applied in the search for the best predictors that optimize a certain model fitting criterion strobl et al 2007 genuer et al 2010 moser et al 2017 the usual pitfalls of these modern ml based solutions are the impossibility to predict out of the range covered by the training data and the problem of over fitting mcroberts 2009 the efficiency of vsm remains unexplored when accounting for co registration errors between sensed and measured data in this regard the response of modeling approaches could play a major role at controlling even mitigating the impact of co registration errors the objective of the study is to compare the impact of co registration errors on vsm and in model performance when estimating a set forest biophysical attributes in two mediterranean pine forests the classical and solid parametric approach based on stepwise selection and multiple linear regression was assessed benchmarked against knn imputation using rf algorithm to select predictor variables with this study we first provide a comparison on the robustness of variable selection methods in the context of co registration errors 2 materials and methods 2 1 study area and sampling design this study was conducted along the north south gradient of the iberian mountains of spain fig 1 the dominant tree species present in the selected samples areas were maritimum pine pinus pinaster ait and scots pine pinus sylvestris l a set of 79 sample plots was measured in field during the autumn of 2013 and winter of 2014 to collect ground data the plots were located along the iberian mountains of spain the selected set of plots included 39 plots in which pinus pinaster was the dominant species and 40 for the case of pinus sylvestris the plot center coordinates x and y were determined by differential global navigation satellite systems dgnss the satellite positioning equipment trimble r6 global navigation satellite system with differential correction was used to determine the position of all plot centres the expected deviation between measured and real coordinates with the equipment used was less than one meter the circulars sample plots had a fixed area corresponding to a 15 m radius on each plot all trees with diameter at breast height dbh 7 5 cm were callipered table 1 using a vertex iii hypsometer between three and five tree height measurements were recorded on each plot then a local height diameter regression model was derived to predict the heights of the remaining trees the age of the 79 plots was available from previous studies on tree ring analyses conducted by the authors when establishing the permanent sample plot ground truth measurement for stand basal area g mean quadratic diameter dg and dominant height ho were computed from the field measurements dominant height was computed as the arithmetic mean of the 100 largest trees in diameter which corresponded to 7 trees for our 15 m radius sample plots 2 2 als data georeferenced point cloud data were collected on autumn 2012 in leaf on conditions by the national plan for aerial orthophotography pnoa of spain the two sensors used in the 2012 scanning campaign were the leica als 60 and the riegl lms q680 the sampling design was scanned using a field of view of 50 degrees frequency of 70h the point density was on average 0 5 measurements per square meter the goodness of the scanning resulted in an accuracy of 20 cm or less for the elevation of the als echoes and a horizontal accuracy of less than 30 cm the maximum number of echoes registered echoes for pulse was 5 the laser point clouds were first classified as the ground points and other points the method is explained by axelsson 2000 and then a dtm raster with a 1 m cell size was created using the classified ground points by calculating the mean values of the ground points within each raster cell laser canopy heights were calculated as the differences between the elevation of non ground echoes and the estimated ground elevation values at the corresponding location the 1 m2 canopy height model chm was interpolated by searching the highest als echo from the centre of each pixel within a radius of 1 6 m empty pixels were filled by the average value of non empty neigh boring pixels the als echoes for which the canopy height values were over 2 m were assumed to be vegetation hits the interpretation of the als data to produce the dtm and chm was based on lastools software isenburg 2018 2 3 computation of als statistics and simulation of co registration errors the collected gps measurements were used as ground truth values and als statistics were computed for the reference inventory i e no simulated co registration error due to altering plot coordinates the centre coordinates of the sample plots were used to compute elevation and density statistics for all registered echoes within the 15 m plot radius predictor variables were computed separately with first and last echoes percentiles 10th 20th 95th 99th for the canopy height were computed and proportional canopy densities were calculated for example the percentile height metric h80 for a plot is the 80th percentile height of the als echoes distribution above the 2 m height break the fusion software mcgaughey 2018 was used to compute the als echoes statistics corresponding to the sample plots the process was repeated multiple times 300 repetitions on each plot as follows the easting and northing coordinates of plot centres were randomly displaced to simulate errors when collecting gps measurements fig 2 from these coordinates displacements in 0 5 m intervals were simulated up to 5 m 10 intervals the magnitude of the displacement was fixed but the angle was randomly selected for every plot and every replication 30 an element was drawn from a normal distribution of mean zero and as standard deviation the simulated plot displacements 0 5 m 1 m 5 m 2 4 models sets and variables ground data and regression modeling were used to estimate the diameter distribution of trees in the samples diameter distribution models are the most common solution to derive either tree level or diameter classes information when stand level variables are predicted in the inventory pascual 2018 according to previous experiments conducted in similar managed forests pascual et al 2018 the flexible two parameter weibull distribution was used the scale b and shape c parameters of the weibull diameter distribution were estimated using maximum likelihood estimation for each of the 79 sample plots the fitdistr function included in the mass package of the r software r core team 2019 was used for the purpose site index was computed for each sample plot using the models available in the simanfor decision support system bravo et al 2012 the site index values ranged from 7 1 to 22 8 to for p pinaster dataset and from 12 95 to 34 71 m for the case of p sylvestris samples ground dbh measurements were used to calculate the gini index for each plot the gini index gini 1912 which is closely connected to the lorenz curve lorenz 1905 is widely used in forest sciences to analyze the structure of a stand in terms of the homogeneity or the heterogeneity of the stand structures neumann and starlinger 2001 low values of the gini index indicate a homogeneous distribution of the variable of interest stand basal area in this research the computed values for the gini index in the study samples ranged between 0 08 to 0 25 and between 0 13 and 0 29 for the plots in which p sylvestris and p pinaster were the dominant species respectively the index describes the variability of tree sizes in a forest stand and its suitability for the asl based estimation has been documented valbuena et al 2013 the measured and the derived biophysical attributes conformed two set of models model set a included three measured stand attributes g dg and ho while model set b set included six variables g dg ho and derived variables the weibull scale parameter b the si of each sample plot and the gini index the training dataset 79 plots was splitted into two subsets based on species composition as previously described table 1 authors expertise pascual et al 2018 and previous studies using low density als pointed out the good performance of models for ho g and dg when als data is used under the area based approach vauhkonen et al 2014 the hypothesis was that the impact of co registration errors could be detected more clearly for these forest biophysical attributes than for others in which the estimation based on als statistics is not as accurate as for those attributes included in model set a 2 5 regression modeling and variable selection a preliminary selection of variables was implemented to conform a subset of 21 potential predictor variables the selection was based on the stepwise selection procedure using one predictor models authors expertise and previous studies in very similar forest ecosystems pascual 2018 the 20 40 50 60 80 95 and 99th height percentiles e g h99 together with the minimum hmin maximum hmax mean hmean standard deviation of als echoes hstd and the canopy relief ratio crr defined as hmean hmin hmax hmin were selected for height based statistics for density metrics percentage of first d 2 m 1 s t and all echoes d 2 m a l l above 2 m and above the mean elevation respectively d m e a n 1 s t and d m e a n a l l were selected the total number of first echoes above 2 m e 2 m 1 s t and the number of echoes above the mean elevation e m e a n a l l were also included in the selected subset the selected 21 candidate predictors were used as candidate predictors to estimate the forest biophysical attributes included in set a and set b for both species the selection of predictors was carried out under the parametric approach using multiple linear regression and the stepwise procedure which is an established methodology in the field pascual et al 2018 packalen et al 2019 the stepwise procedure was iteratively applied using the 21 candidate predictors for each of the three and six models of set a and b respectively using the penalty term k in such a way that the resulting models contained a small number of variables hereby the final models meant to be simple they all comprised a maximum of three predictor variables expect for the case of the dominant height model that comprised only one predictor the exhaustive search selected the best fitting linear regression models according to bayesian information criteria bic and models were compared in terms of the root mean squared error rmse which is fitting statistic frequently used in forest inventory and its modeling analyses e g hyyppä et al 2008 in this study the relative rmse values were calculated for p pinaster and p sylvestris as the percentage of the average ground value of the forest biophysical attribute of interest both set of models can be regarded a system of equations i e a set of individual but simultaneously applied equations the system of seemingly unrelated regressions sur was employed using the predictor variables selected for reference inventory with the datasets containing simulated co registration errors cross equation correlations of random error terms were promoted by the selection of common predictors in at least a pair of models of both model sets a and b the stepwise procedure was applied to select the predictors for b si and the gini index before conforming the final models that included no more than 3 predictor variables the improvement in the fitting procedure using sur has been documented in early studies borders 1989 but its potentially good performance to mitigate errors remains somehow unexplored the sur approach was applied in model sets a and b using always the selected predictors for reference inventory but fitting the models using the 300 datasets containing co registration errors 2 6 imputation using knn with variable selection based on random forests rf in knn methods sample plots for which observations of the variables of interest e g dominant height and explanatory auxiliary variables als based statistics are denoted as references while observations for which only the explanatory variables are available are termed targets breidenbach et al 2012 the variables of interest are predicted for the targets by imputing the observations of the variables of interest from the reference observation which is most similar with respect to the explanatory variables the performance of the knn imputation can be based on nearness or proximity crookston and finley 2007 nearness can be computed based on the distance between the i th target and the j th reference element different strategies were preliminary tested to compute the space distance when finding nearest neighbors crookston and finley 2007 the results of preliminary tests pointed out rf as the best method table 2 rf is a machine learning method that is based on the construction of multiple decision trees and the importance of given variable is computed based on the increase in mean square error for a tree in the forest when the observed values of this variable are randomly permuted in the samples genuer et al 2010 in the remote sensing arena rf is being applied to select predictor variables cutler et al 2007 thereby providing and assessing inference capacity belgiu and drăguţ 2016 in line with previous studies moser et al 2017 rf was applied to select the best subset of five predictors for both model sets a and b and for each pine species the ground truth coordinates reference inventory were used to select an optimal subset of five predictor for both set of models the predictive capability of rf selection was tested by repeating the variable selection process 300 times for each plot introducing simulated co registration errors progressively preliminary tests were used to determine the number of bootstrap samples used at each variable selection the tests pointed out that 60 of the number of samples for both p pinaster and p sylvestris ensured a robust rf based selection of predictor variables therefore the non parametric approach comprised two steps selection of predictors based on rf 1 and then the subset of predictors was used to estimate forest biophysical attributes under the knn imputation 2 the yaimpute package implemented in r software was used for the purpose crookston and finley 2007 2 7 model assessment and evaluation of co registration errors the reliability of vsm was tested by counting how many times the predictor variables selected in the reference inventory were included in the subset in the 300 replications containing co registration errors models included between one and three predictors in the parametric approach while including five for the case of rf based selection in both cases the rmse expressed as percentage of the mean ground measurements used to evaluate the goodness of the modeling approaches the cost of a biased vsm due to co registration errors was measured following the inoptimality losses approach e g eid 2000 forest biophysical attributes were estimated twice for each case i using the predictors selected for each of the 300 replications containing co registration errors and ii using the predictors selected for reference inventory with als statistics containing co registration errors in this way the impact of implementing erroneous decisions when using biased als statistics can be assessed pascual et al 2018 the difference in terms of rmse between case specific selection and selection based on reference inventory was computed along the simulated range of plot positioning errors for both the parametric and the non parametric approach in the case of sur modeling we fitted the multiple linear models using the predictor variables selected for reference inventory and datasets containing co registration errors to evaluate the robustness of the method at mitigating co registration errors 3 results 3 1 effect on variable selection and parametric regression the metrics selected in the absence of positioning errors were progressively less frequently selected as the displacement error increased fig 3 the reliability of first order predictors variables ranged from 100 to less than 30 when increasing positioning error from 0 5 to 5 m respectively for low positioning errors the computed reliability rate was higher for p pinaster than for p sylvestris samples the impact of co registration errors in models for g reduced the robustness of the stepwise vsm from 1 00 and 0 90 to 0 43 and 0 37 respectively for p pinaster and p sylvestris observations the same pattern was observed for ho and dg but the reliability rate of the selection was lower than models for g the results for second order predictors also indicated the different behavior of the tested variables the models were computed for each case using the predictor variables specifically selected for each replication the analyses were conducted for model set a due to the poor predictive capability and its high variability of the multiple linear models used to estimate the weibull b coefficient and the gini index the rmse values were similar for ho and dg in both species but the behavior of models for g was different for both species the values for p pinaster samples were on average 5 greater than models for p sylvestris fig 4 under the inoptimality losses approach models were also computed using the selected predictors for the reference inventory with each of the datasets containing co registration errors the results pointed the small effect of biased variable selection when using parametric regression fig 4 the difference between both models for each replication was computed the trade off in terms of rmse was in all cases lower than 1 5 for both species fig 5 3 2 the sur modeling approach the selected predictors for reference inventory using the stepwise procedure were used under the sur modeling approach in which all models are used together to simultaneously estimate forest biophysical attributes the models included between two and three predictors except for the case of dominant height which was a one predictor model all models were linear and no variables transformation was applied both in dependent and independent variables the models for p pinaster dataset were as follows 1 h o a 1 0 a 1 1 h 80 2 g a 2 0 a 2 1 h 80 a 2 2 e m e a n a l l a 2 3 h m i n 3 d g a 3 0 a 3 1 h 99 a 3 2 h 80 4 s i a 4 0 a 4 1 h 80 a 4 2 d m e a n 1 s t 5 b a 5 0 a 5 1 h 99 a 5 2 h 80 6 g i n i a 6 0 a 6 1 h 80 a 6 2 h m e a n the results showed the minor variation of the fitting statistic rmse when using those selected variables with the cases containing simulated co registration errors on average a progressive increment of the computed rmse was observed when increasing plot positioning error up to 5 m the results were very similar when increasing from three set a to six set b the number of equations in the sur system in the p pinaster table 3 and in the p sylvestris samples table 4 the relative error between the maximum observed differences between biased selection i e when simulated plot positioning errors and the reference inventory values was used to asses the magnitude of the co registration errors the impact was lower than 2 for g dg si and the gini index in both pine forest ecosystems the variation in the fitting statistic rmse was the highest for ho and the impact was three fold in p pinaster samples 4 35 than in p sylvestris cases 1 35 3 3 selection of variables using rf and effect on knn imputation the results for both p sylvestris fig 6 and p pinaster fig 7 dataset showed how predictor variables selected for reference inventory were progressively less included in the subset when simulating co registration errors for instance the most selected metrics in set a for p pinaster were h95 h99 and h80 which belonged to the best subset of five variables in 97 83 and 67 of the cases when simulating a 0 5 m positioning error the values progressively decreased down to 70 57 and 43 for the maximum simulated 5 m error the same pattern was observed for model set b fig 6b and fig 7b the summed values total reliability of the variable selection decreased and most of the selected predictors 90 were height based statistics for both tested pine species the predictive capability of the knn imputation was lower than for models in the parametric approach fig 8 the average rmse values were 16 1 26 8 and 22 5 for ho g and dg respectively for model set a these rmse values were 2 8 19 4 and 4 points greater than those computed for the parametric approach the behavior of the knn for the two species was very similar for model set b the rmse values were higher for ho 19 4 g 40 4 and dg 29 5 the mean rmse values for forest biophysical attributes si weibull b parameter and the gini index value were 39 1 25 5 and 12 5 the difference between case specific selection and reference inventory selection was computed along the simulated range of plot positioning errors fig 9 the results pointed out the similar behavior of p pinaster and p sylvestris samples and the different behavior of the forest attributes in model set a in this regard the difference in terms of rmse was around 10 for g for largest positioning errors the similar behavior of g and dg differed with the steady behavior of ho same as in the parametric approach the difference between case specific imputation and reference inventory based imputation reached a maximum of 4 for ho for the attributes si weibull b parameter and the gini index the increment in rmse was 2 7 0 8 and 0 8 for p pinaster samples and 2 2 0 4 0 9 for p sylvestris samples respectively forest structures due to their heterogeneity and density are often difficult to assess hence a variety of methodologies such as als are being applied to account for this difficult to derive information the underlying principle of als based estimation is the co registration between ground surveys and remotely sensed data the study evaluates the effect of the co registration mismatch in terms of vsm and the final performance of both parametric models and knn imputation in both approaches the selection of predictor variables substantially shifted compared to the base scenario the absence of positioning errors reference inventory the results of this research confirmed the meaningful impact of co registration errors in the selection of variables but on the final performance of the models according to the computed rmse values the structure and the conditions of the assessed forest ecosystem has been pointed out as one the main factors in the influence of co registration errors frazer et al 2011 pascual et al 2018 the sampling design of the research was part of a greater network composed of permanent sample plots which mainly targeted homogenous and mature forest patches the values for the gini index also confirmed the homogeneous conditions of the study area forests both ground and sensed statistics showed the low weight young and heterogeneous forest conditions had on the training dataset fig 10 in these conditions the impact of co registration errors was expected to be minor as observed in similar study areas pascual et al 2018 the reason is that the true maximum elevation of the echoes can still be captured for a given plot despite the presence of co registration errors in homogenous forest ecosystems the impact of co registration errors might be more severe in ecotone areas close to the transition boundary between two contrasting management units i e young and old stands neighbors more knowledge remains needed when accounting for reliable statistics in those forest conditions positioning equipment and ground operations have an impact also have a role when computing statistics the detection of areas prone to variability in the computed statistics is an important asset and so the use of accurate positioning methods during sampling operations jung et al 2013 in this research we simulated a long array of plot positioning errors to account for the variation in the computed als statistics more simple approaches such as extending the plot buffer when computing the statistics can provide similar insights as the methodology involved in this research which was implemented in previous studies also using parametric regression gobakken and næsset 2009 the use of stepwise selection in parametric modeling clearly reflected the increasing mismatch between independent and dependent variables the analysis on vsm was focused on model set a that included only measured information to better detect the progressive impact of the altering plot coordinates the reliability of the selection for model set a progressively decreased when stepwise was performed under the regression approach models for dominant height behaved differently from stand basal area for instance the use of upper height percentiles in the estimation of dominant height using simple models is widely used in the field vauhkonen et al 2014 which are more robust towards the presence of small co registration errors as explained the results for p pinaster and p sylvestris samples differed in the behavior of the assessed forest biophysical the error values were very similar for ho but they differed around 5 for the case of g which in line with previous studies pascual et al 2018 the accuracy of the models as expressed by the rmse values barely decreased in the parametric approach when using alternative selection of predictors the fitting statistics for our parametric models in model set a are in line with documented studies on the use of aba approach in similar pine forest ecosystems gonzález olabarria et al 2012 the cost of a biased vsm in the parametric approach was around 1 compared to using the predictor variables selected without simulating plot positioning errors the final impact of biased vsm in the model performance was minor and not adjusted to the expectations arising from the variability of vsm in the parametric case models were very stable towards the presence of co registration errors and alternative combination of als statistics could result in a very similar predictive capacity the results for the sur tests also reinforced the robustness of the capability of traditional parametric modeling to mitigate the influence of co registration errors further research on more sparse and fragmented forest ecosystems are needed for the generalization of these results in the parametric arena in addition the reported sub metric precision of the positioning equipment used in our study did not guarantee that greater co registration errors never occurred as measured coordinates may also contain errors leading to underestimate the true effect of positioning errors on the other hand the cost of a biased vsm was more remarkable when shifting to the non parametric arena the scale of the rmse values for the knn imputation were substantially higher than for the parametric approach despite including more predictor variables in the selection the rmse values for dominant height were rather similar but the difference reached 10 points when estimating stand basal area the cost of a biased selection of predictors using rf reached a mean rmse increment of 4 while the value jumped up to 10 for the case of stand basal area on the other hand the results for the derived variables si weibull b parameter and the gini index were less than 3 in all cases therefore some biophysical and ecological attributes are more prone to be affected when altering the co registration factor between sensed and ground data in general the imputation based on rf and knn was more affected by the simulated variation in the als statistics the sensitivity of rf to define the optimal subset of variables should be carefully evaluated downscaling the number of predictor combinations might result in more stable selection while maximizing the flexibility of the rf approach to simultaneously compute nearness for a set of forest attributes the estimation of ecological indicators such as the gini index can be converted to categorical variables which could be imputed at a lower error compared to continuous variables valbuena et al 2013 the combined used of remote sensing data from different sources and the need to collect more data in modern forest planning auxiliary information derived from multiple sources is collected and simultaneously used to estimate forest biophysical attributes the control or at least to mitigate the mismatch between scanning sensing sources and ground surveys is therefore an essential requirement sound and more extensive sampling designs covering more variability and alternative types of forest ecosystems are needed to generalize these results and to fully compare the robustness of non parametric ml algorithms versus parametric models when accounting for co registration errors 4 conclusions the level of registration between remotely sensed data and ground survey data can determine the effectiveness of the inference process in forest inventories the performance of traditional parametric modeling approaches was more stable towards the presence of co registration errors which substantially altered the selection of als statistics also in the non parametric approach the research shows how als statistics selected in biased conditions could nearly perform as in the best case scenario therefore the use of very accurate but very expensive gps devices and time consuming ground operations may not be worthwhile when conducting aba in dense and homogenous forest ecosystems as the outcome of the models could be very similar in the parametric approach the implications of co registration errors were in all cases more severe in the knn imputation due to the variability in the selection based on rf 
25054,the estimation of forest attributes using active remote sensing data and sampling designs is a solid scientific discipline oriented to derive structural information from forest ecosystems in this study we examined the problem of selecting predictor variables derived from airborne laser scanning als when using stepwise and multiple linear regression and when using knn imputation using random forests rf to select predictor variables systems of forest attributes and ecological indicators were estimated using als statistics and ground data collected in central east spain on two mediterranean pine forest areas co registration errors were simulated by means of altering ground data coordinates the larger the co registration error the higher the variation in the selected als based predictors in the parametric approach which was less affected than the rf based selection in both cases the final performance of the models was not as affected by co registration errors as the observed variation in the selection of variables the impact was around 1 in the parametric approach while the value reached the 8 for both stand basal area and the gini index under the non parametric method the forest biophysical attributes of the set behaved differently towards altering the co registration factor in both cases to control the co registration factor between remote sensing data sources and ground surveys is an essential step to reduce uncertainty in data interpretation and in the modeling of forest attributes abbreviations 3d three dimensional aba area based approach als airborne laser scanning bic bayesian s information criterion chm canopy height model dbh diameter at breast height dg mean quadratic diameter dgnss differential global navigation satellite systems g basal area gps global positioning system h tree height ho dominant height knn k nearest neighbor lidar light detection and ranging ml machine learning n number of trees per hectare rf random forests rmse root mean square error rs remote sensing si site index sur seemingly unrelated regression tls terrestrial laser scanning vsm variable selection method keywords remote sensing machine learning positioning laser scanning random forests 1 introduction modern remote sensing techniques are very attractive alternatives to estimate forest information in large scale projects mcroberts et al 2010 the use of airborne laser scanning als is the reference technique when it comes to describe the vertical structure of forest ecosystems vauhkonen et al 2014 the term als refers to a lidar light detection and ranging sensor onboard an aircraft that captures the information while flying across the area of interest the capability of lasers to go through forest canopies highlight the vertical distribution of woody and leafy biomass and as a result tree attributes such as tree height or diameter can be estimated through mathematical models the statistics computed from a three dimensional 3d point cloud can be related to data surveyed in sampling designs as the x y and z coordinates easting northing and elevation of all echoes are registered therefore an accurate geographical co registration of als and ground data is essential to properly estimate forest biophysical attributes gobakken and næsset 2009 the sampling designs used in als based inference are frequently based on circular plots the accurate location of plot centre coordinates is the key step to perform the area based approach aba as echoes within a certain radius from the measured center point are only considered when computing the information vauhkonen et al 2014 therefore errors in plot positioning operations can affect the relationship between als statistics and forest biophysical attributes when conducting aba pascual et al 2018 factors such as the quality of field surveys the type of global positioning system gps equipment used or site conditions can bias the relationship between sensed and measured data and determine the severity of the positioning mismatch hasegawa and yoshimura 2008 kaartinen et al 2015 previous research has evaluated the impact of co registration errors on the estimation of forest biophysical attributes gobakken and næsset 2009 frazer et al 2011 and their impact of decisions in forest planning pascual et al 2018 the selection of als statistics has a direct influence on the estimation of forest biophysical attributes since those are predicted from equations that are combinations of several laser derived statistics the selection of robust and meaningful predictor variables contributes to better and simplified statistical analyses packalén et al 2012 for the purpose previous research has highlighted the benefit of implementing efficient variable selection methods vsm using on parametric murtaugh 2009 næsset 2011 and non parametric methods moser et al 2017 stepwise selection on parametric regression is commonly used when forest attributes are estimated using multiple linear regression e g næsset 2011 the method can be enhanced by using simultaneous regression using the selected predictors pascual et al 2018 however stepwise selection methods struggle when it comes to identify the level of correlation between all possible predictors which is the case of als height percentiles and density metrics harrell 2013 and to select a fixed number of predictor variables alternatives such as brute force search for the optimal subset of variables have also been evaluated in recent times using traditional parametric regression kotivuori et al 2016 a reasonable approach is to execute variable selection several times and to select a model that best fulfills the objective of the inventory breidenbach et al 2012 in parallel development k nearest neighbor knn imputation in forest inventory has gained relevance especially in the nordic countries using als data holmström et al 2003 one of the reasons is that knn simplifies the estimation of multi variety variables while relaxing assumptions regarding data distribution breidenbach et al 2012 algorithms such as random forests rf breiman 2001 have been widely used for classification purposes in the remote sensing arena belgiu and drăguţ 2016 however these algorithms can be applied in the search for the best predictors that optimize a certain model fitting criterion strobl et al 2007 genuer et al 2010 moser et al 2017 the usual pitfalls of these modern ml based solutions are the impossibility to predict out of the range covered by the training data and the problem of over fitting mcroberts 2009 the efficiency of vsm remains unexplored when accounting for co registration errors between sensed and measured data in this regard the response of modeling approaches could play a major role at controlling even mitigating the impact of co registration errors the objective of the study is to compare the impact of co registration errors on vsm and in model performance when estimating a set forest biophysical attributes in two mediterranean pine forests the classical and solid parametric approach based on stepwise selection and multiple linear regression was assessed benchmarked against knn imputation using rf algorithm to select predictor variables with this study we first provide a comparison on the robustness of variable selection methods in the context of co registration errors 2 materials and methods 2 1 study area and sampling design this study was conducted along the north south gradient of the iberian mountains of spain fig 1 the dominant tree species present in the selected samples areas were maritimum pine pinus pinaster ait and scots pine pinus sylvestris l a set of 79 sample plots was measured in field during the autumn of 2013 and winter of 2014 to collect ground data the plots were located along the iberian mountains of spain the selected set of plots included 39 plots in which pinus pinaster was the dominant species and 40 for the case of pinus sylvestris the plot center coordinates x and y were determined by differential global navigation satellite systems dgnss the satellite positioning equipment trimble r6 global navigation satellite system with differential correction was used to determine the position of all plot centres the expected deviation between measured and real coordinates with the equipment used was less than one meter the circulars sample plots had a fixed area corresponding to a 15 m radius on each plot all trees with diameter at breast height dbh 7 5 cm were callipered table 1 using a vertex iii hypsometer between three and five tree height measurements were recorded on each plot then a local height diameter regression model was derived to predict the heights of the remaining trees the age of the 79 plots was available from previous studies on tree ring analyses conducted by the authors when establishing the permanent sample plot ground truth measurement for stand basal area g mean quadratic diameter dg and dominant height ho were computed from the field measurements dominant height was computed as the arithmetic mean of the 100 largest trees in diameter which corresponded to 7 trees for our 15 m radius sample plots 2 2 als data georeferenced point cloud data were collected on autumn 2012 in leaf on conditions by the national plan for aerial orthophotography pnoa of spain the two sensors used in the 2012 scanning campaign were the leica als 60 and the riegl lms q680 the sampling design was scanned using a field of view of 50 degrees frequency of 70h the point density was on average 0 5 measurements per square meter the goodness of the scanning resulted in an accuracy of 20 cm or less for the elevation of the als echoes and a horizontal accuracy of less than 30 cm the maximum number of echoes registered echoes for pulse was 5 the laser point clouds were first classified as the ground points and other points the method is explained by axelsson 2000 and then a dtm raster with a 1 m cell size was created using the classified ground points by calculating the mean values of the ground points within each raster cell laser canopy heights were calculated as the differences between the elevation of non ground echoes and the estimated ground elevation values at the corresponding location the 1 m2 canopy height model chm was interpolated by searching the highest als echo from the centre of each pixel within a radius of 1 6 m empty pixels were filled by the average value of non empty neigh boring pixels the als echoes for which the canopy height values were over 2 m were assumed to be vegetation hits the interpretation of the als data to produce the dtm and chm was based on lastools software isenburg 2018 2 3 computation of als statistics and simulation of co registration errors the collected gps measurements were used as ground truth values and als statistics were computed for the reference inventory i e no simulated co registration error due to altering plot coordinates the centre coordinates of the sample plots were used to compute elevation and density statistics for all registered echoes within the 15 m plot radius predictor variables were computed separately with first and last echoes percentiles 10th 20th 95th 99th for the canopy height were computed and proportional canopy densities were calculated for example the percentile height metric h80 for a plot is the 80th percentile height of the als echoes distribution above the 2 m height break the fusion software mcgaughey 2018 was used to compute the als echoes statistics corresponding to the sample plots the process was repeated multiple times 300 repetitions on each plot as follows the easting and northing coordinates of plot centres were randomly displaced to simulate errors when collecting gps measurements fig 2 from these coordinates displacements in 0 5 m intervals were simulated up to 5 m 10 intervals the magnitude of the displacement was fixed but the angle was randomly selected for every plot and every replication 30 an element was drawn from a normal distribution of mean zero and as standard deviation the simulated plot displacements 0 5 m 1 m 5 m 2 4 models sets and variables ground data and regression modeling were used to estimate the diameter distribution of trees in the samples diameter distribution models are the most common solution to derive either tree level or diameter classes information when stand level variables are predicted in the inventory pascual 2018 according to previous experiments conducted in similar managed forests pascual et al 2018 the flexible two parameter weibull distribution was used the scale b and shape c parameters of the weibull diameter distribution were estimated using maximum likelihood estimation for each of the 79 sample plots the fitdistr function included in the mass package of the r software r core team 2019 was used for the purpose site index was computed for each sample plot using the models available in the simanfor decision support system bravo et al 2012 the site index values ranged from 7 1 to 22 8 to for p pinaster dataset and from 12 95 to 34 71 m for the case of p sylvestris samples ground dbh measurements were used to calculate the gini index for each plot the gini index gini 1912 which is closely connected to the lorenz curve lorenz 1905 is widely used in forest sciences to analyze the structure of a stand in terms of the homogeneity or the heterogeneity of the stand structures neumann and starlinger 2001 low values of the gini index indicate a homogeneous distribution of the variable of interest stand basal area in this research the computed values for the gini index in the study samples ranged between 0 08 to 0 25 and between 0 13 and 0 29 for the plots in which p sylvestris and p pinaster were the dominant species respectively the index describes the variability of tree sizes in a forest stand and its suitability for the asl based estimation has been documented valbuena et al 2013 the measured and the derived biophysical attributes conformed two set of models model set a included three measured stand attributes g dg and ho while model set b set included six variables g dg ho and derived variables the weibull scale parameter b the si of each sample plot and the gini index the training dataset 79 plots was splitted into two subsets based on species composition as previously described table 1 authors expertise pascual et al 2018 and previous studies using low density als pointed out the good performance of models for ho g and dg when als data is used under the area based approach vauhkonen et al 2014 the hypothesis was that the impact of co registration errors could be detected more clearly for these forest biophysical attributes than for others in which the estimation based on als statistics is not as accurate as for those attributes included in model set a 2 5 regression modeling and variable selection a preliminary selection of variables was implemented to conform a subset of 21 potential predictor variables the selection was based on the stepwise selection procedure using one predictor models authors expertise and previous studies in very similar forest ecosystems pascual 2018 the 20 40 50 60 80 95 and 99th height percentiles e g h99 together with the minimum hmin maximum hmax mean hmean standard deviation of als echoes hstd and the canopy relief ratio crr defined as hmean hmin hmax hmin were selected for height based statistics for density metrics percentage of first d 2 m 1 s t and all echoes d 2 m a l l above 2 m and above the mean elevation respectively d m e a n 1 s t and d m e a n a l l were selected the total number of first echoes above 2 m e 2 m 1 s t and the number of echoes above the mean elevation e m e a n a l l were also included in the selected subset the selected 21 candidate predictors were used as candidate predictors to estimate the forest biophysical attributes included in set a and set b for both species the selection of predictors was carried out under the parametric approach using multiple linear regression and the stepwise procedure which is an established methodology in the field pascual et al 2018 packalen et al 2019 the stepwise procedure was iteratively applied using the 21 candidate predictors for each of the three and six models of set a and b respectively using the penalty term k in such a way that the resulting models contained a small number of variables hereby the final models meant to be simple they all comprised a maximum of three predictor variables expect for the case of the dominant height model that comprised only one predictor the exhaustive search selected the best fitting linear regression models according to bayesian information criteria bic and models were compared in terms of the root mean squared error rmse which is fitting statistic frequently used in forest inventory and its modeling analyses e g hyyppä et al 2008 in this study the relative rmse values were calculated for p pinaster and p sylvestris as the percentage of the average ground value of the forest biophysical attribute of interest both set of models can be regarded a system of equations i e a set of individual but simultaneously applied equations the system of seemingly unrelated regressions sur was employed using the predictor variables selected for reference inventory with the datasets containing simulated co registration errors cross equation correlations of random error terms were promoted by the selection of common predictors in at least a pair of models of both model sets a and b the stepwise procedure was applied to select the predictors for b si and the gini index before conforming the final models that included no more than 3 predictor variables the improvement in the fitting procedure using sur has been documented in early studies borders 1989 but its potentially good performance to mitigate errors remains somehow unexplored the sur approach was applied in model sets a and b using always the selected predictors for reference inventory but fitting the models using the 300 datasets containing co registration errors 2 6 imputation using knn with variable selection based on random forests rf in knn methods sample plots for which observations of the variables of interest e g dominant height and explanatory auxiliary variables als based statistics are denoted as references while observations for which only the explanatory variables are available are termed targets breidenbach et al 2012 the variables of interest are predicted for the targets by imputing the observations of the variables of interest from the reference observation which is most similar with respect to the explanatory variables the performance of the knn imputation can be based on nearness or proximity crookston and finley 2007 nearness can be computed based on the distance between the i th target and the j th reference element different strategies were preliminary tested to compute the space distance when finding nearest neighbors crookston and finley 2007 the results of preliminary tests pointed out rf as the best method table 2 rf is a machine learning method that is based on the construction of multiple decision trees and the importance of given variable is computed based on the increase in mean square error for a tree in the forest when the observed values of this variable are randomly permuted in the samples genuer et al 2010 in the remote sensing arena rf is being applied to select predictor variables cutler et al 2007 thereby providing and assessing inference capacity belgiu and drăguţ 2016 in line with previous studies moser et al 2017 rf was applied to select the best subset of five predictors for both model sets a and b and for each pine species the ground truth coordinates reference inventory were used to select an optimal subset of five predictor for both set of models the predictive capability of rf selection was tested by repeating the variable selection process 300 times for each plot introducing simulated co registration errors progressively preliminary tests were used to determine the number of bootstrap samples used at each variable selection the tests pointed out that 60 of the number of samples for both p pinaster and p sylvestris ensured a robust rf based selection of predictor variables therefore the non parametric approach comprised two steps selection of predictors based on rf 1 and then the subset of predictors was used to estimate forest biophysical attributes under the knn imputation 2 the yaimpute package implemented in r software was used for the purpose crookston and finley 2007 2 7 model assessment and evaluation of co registration errors the reliability of vsm was tested by counting how many times the predictor variables selected in the reference inventory were included in the subset in the 300 replications containing co registration errors models included between one and three predictors in the parametric approach while including five for the case of rf based selection in both cases the rmse expressed as percentage of the mean ground measurements used to evaluate the goodness of the modeling approaches the cost of a biased vsm due to co registration errors was measured following the inoptimality losses approach e g eid 2000 forest biophysical attributes were estimated twice for each case i using the predictors selected for each of the 300 replications containing co registration errors and ii using the predictors selected for reference inventory with als statistics containing co registration errors in this way the impact of implementing erroneous decisions when using biased als statistics can be assessed pascual et al 2018 the difference in terms of rmse between case specific selection and selection based on reference inventory was computed along the simulated range of plot positioning errors for both the parametric and the non parametric approach in the case of sur modeling we fitted the multiple linear models using the predictor variables selected for reference inventory and datasets containing co registration errors to evaluate the robustness of the method at mitigating co registration errors 3 results 3 1 effect on variable selection and parametric regression the metrics selected in the absence of positioning errors were progressively less frequently selected as the displacement error increased fig 3 the reliability of first order predictors variables ranged from 100 to less than 30 when increasing positioning error from 0 5 to 5 m respectively for low positioning errors the computed reliability rate was higher for p pinaster than for p sylvestris samples the impact of co registration errors in models for g reduced the robustness of the stepwise vsm from 1 00 and 0 90 to 0 43 and 0 37 respectively for p pinaster and p sylvestris observations the same pattern was observed for ho and dg but the reliability rate of the selection was lower than models for g the results for second order predictors also indicated the different behavior of the tested variables the models were computed for each case using the predictor variables specifically selected for each replication the analyses were conducted for model set a due to the poor predictive capability and its high variability of the multiple linear models used to estimate the weibull b coefficient and the gini index the rmse values were similar for ho and dg in both species but the behavior of models for g was different for both species the values for p pinaster samples were on average 5 greater than models for p sylvestris fig 4 under the inoptimality losses approach models were also computed using the selected predictors for the reference inventory with each of the datasets containing co registration errors the results pointed the small effect of biased variable selection when using parametric regression fig 4 the difference between both models for each replication was computed the trade off in terms of rmse was in all cases lower than 1 5 for both species fig 5 3 2 the sur modeling approach the selected predictors for reference inventory using the stepwise procedure were used under the sur modeling approach in which all models are used together to simultaneously estimate forest biophysical attributes the models included between two and three predictors except for the case of dominant height which was a one predictor model all models were linear and no variables transformation was applied both in dependent and independent variables the models for p pinaster dataset were as follows 1 h o a 1 0 a 1 1 h 80 2 g a 2 0 a 2 1 h 80 a 2 2 e m e a n a l l a 2 3 h m i n 3 d g a 3 0 a 3 1 h 99 a 3 2 h 80 4 s i a 4 0 a 4 1 h 80 a 4 2 d m e a n 1 s t 5 b a 5 0 a 5 1 h 99 a 5 2 h 80 6 g i n i a 6 0 a 6 1 h 80 a 6 2 h m e a n the results showed the minor variation of the fitting statistic rmse when using those selected variables with the cases containing simulated co registration errors on average a progressive increment of the computed rmse was observed when increasing plot positioning error up to 5 m the results were very similar when increasing from three set a to six set b the number of equations in the sur system in the p pinaster table 3 and in the p sylvestris samples table 4 the relative error between the maximum observed differences between biased selection i e when simulated plot positioning errors and the reference inventory values was used to asses the magnitude of the co registration errors the impact was lower than 2 for g dg si and the gini index in both pine forest ecosystems the variation in the fitting statistic rmse was the highest for ho and the impact was three fold in p pinaster samples 4 35 than in p sylvestris cases 1 35 3 3 selection of variables using rf and effect on knn imputation the results for both p sylvestris fig 6 and p pinaster fig 7 dataset showed how predictor variables selected for reference inventory were progressively less included in the subset when simulating co registration errors for instance the most selected metrics in set a for p pinaster were h95 h99 and h80 which belonged to the best subset of five variables in 97 83 and 67 of the cases when simulating a 0 5 m positioning error the values progressively decreased down to 70 57 and 43 for the maximum simulated 5 m error the same pattern was observed for model set b fig 6b and fig 7b the summed values total reliability of the variable selection decreased and most of the selected predictors 90 were height based statistics for both tested pine species the predictive capability of the knn imputation was lower than for models in the parametric approach fig 8 the average rmse values were 16 1 26 8 and 22 5 for ho g and dg respectively for model set a these rmse values were 2 8 19 4 and 4 points greater than those computed for the parametric approach the behavior of the knn for the two species was very similar for model set b the rmse values were higher for ho 19 4 g 40 4 and dg 29 5 the mean rmse values for forest biophysical attributes si weibull b parameter and the gini index value were 39 1 25 5 and 12 5 the difference between case specific selection and reference inventory selection was computed along the simulated range of plot positioning errors fig 9 the results pointed out the similar behavior of p pinaster and p sylvestris samples and the different behavior of the forest attributes in model set a in this regard the difference in terms of rmse was around 10 for g for largest positioning errors the similar behavior of g and dg differed with the steady behavior of ho same as in the parametric approach the difference between case specific imputation and reference inventory based imputation reached a maximum of 4 for ho for the attributes si weibull b parameter and the gini index the increment in rmse was 2 7 0 8 and 0 8 for p pinaster samples and 2 2 0 4 0 9 for p sylvestris samples respectively forest structures due to their heterogeneity and density are often difficult to assess hence a variety of methodologies such as als are being applied to account for this difficult to derive information the underlying principle of als based estimation is the co registration between ground surveys and remotely sensed data the study evaluates the effect of the co registration mismatch in terms of vsm and the final performance of both parametric models and knn imputation in both approaches the selection of predictor variables substantially shifted compared to the base scenario the absence of positioning errors reference inventory the results of this research confirmed the meaningful impact of co registration errors in the selection of variables but on the final performance of the models according to the computed rmse values the structure and the conditions of the assessed forest ecosystem has been pointed out as one the main factors in the influence of co registration errors frazer et al 2011 pascual et al 2018 the sampling design of the research was part of a greater network composed of permanent sample plots which mainly targeted homogenous and mature forest patches the values for the gini index also confirmed the homogeneous conditions of the study area forests both ground and sensed statistics showed the low weight young and heterogeneous forest conditions had on the training dataset fig 10 in these conditions the impact of co registration errors was expected to be minor as observed in similar study areas pascual et al 2018 the reason is that the true maximum elevation of the echoes can still be captured for a given plot despite the presence of co registration errors in homogenous forest ecosystems the impact of co registration errors might be more severe in ecotone areas close to the transition boundary between two contrasting management units i e young and old stands neighbors more knowledge remains needed when accounting for reliable statistics in those forest conditions positioning equipment and ground operations have an impact also have a role when computing statistics the detection of areas prone to variability in the computed statistics is an important asset and so the use of accurate positioning methods during sampling operations jung et al 2013 in this research we simulated a long array of plot positioning errors to account for the variation in the computed als statistics more simple approaches such as extending the plot buffer when computing the statistics can provide similar insights as the methodology involved in this research which was implemented in previous studies also using parametric regression gobakken and næsset 2009 the use of stepwise selection in parametric modeling clearly reflected the increasing mismatch between independent and dependent variables the analysis on vsm was focused on model set a that included only measured information to better detect the progressive impact of the altering plot coordinates the reliability of the selection for model set a progressively decreased when stepwise was performed under the regression approach models for dominant height behaved differently from stand basal area for instance the use of upper height percentiles in the estimation of dominant height using simple models is widely used in the field vauhkonen et al 2014 which are more robust towards the presence of small co registration errors as explained the results for p pinaster and p sylvestris samples differed in the behavior of the assessed forest biophysical the error values were very similar for ho but they differed around 5 for the case of g which in line with previous studies pascual et al 2018 the accuracy of the models as expressed by the rmse values barely decreased in the parametric approach when using alternative selection of predictors the fitting statistics for our parametric models in model set a are in line with documented studies on the use of aba approach in similar pine forest ecosystems gonzález olabarria et al 2012 the cost of a biased vsm in the parametric approach was around 1 compared to using the predictor variables selected without simulating plot positioning errors the final impact of biased vsm in the model performance was minor and not adjusted to the expectations arising from the variability of vsm in the parametric case models were very stable towards the presence of co registration errors and alternative combination of als statistics could result in a very similar predictive capacity the results for the sur tests also reinforced the robustness of the capability of traditional parametric modeling to mitigate the influence of co registration errors further research on more sparse and fragmented forest ecosystems are needed for the generalization of these results in the parametric arena in addition the reported sub metric precision of the positioning equipment used in our study did not guarantee that greater co registration errors never occurred as measured coordinates may also contain errors leading to underestimate the true effect of positioning errors on the other hand the cost of a biased vsm was more remarkable when shifting to the non parametric arena the scale of the rmse values for the knn imputation were substantially higher than for the parametric approach despite including more predictor variables in the selection the rmse values for dominant height were rather similar but the difference reached 10 points when estimating stand basal area the cost of a biased selection of predictors using rf reached a mean rmse increment of 4 while the value jumped up to 10 for the case of stand basal area on the other hand the results for the derived variables si weibull b parameter and the gini index were less than 3 in all cases therefore some biophysical and ecological attributes are more prone to be affected when altering the co registration factor between sensed and ground data in general the imputation based on rf and knn was more affected by the simulated variation in the als statistics the sensitivity of rf to define the optimal subset of variables should be carefully evaluated downscaling the number of predictor combinations might result in more stable selection while maximizing the flexibility of the rf approach to simultaneously compute nearness for a set of forest attributes the estimation of ecological indicators such as the gini index can be converted to categorical variables which could be imputed at a lower error compared to continuous variables valbuena et al 2013 the combined used of remote sensing data from different sources and the need to collect more data in modern forest planning auxiliary information derived from multiple sources is collected and simultaneously used to estimate forest biophysical attributes the control or at least to mitigate the mismatch between scanning sensing sources and ground surveys is therefore an essential requirement sound and more extensive sampling designs covering more variability and alternative types of forest ecosystems are needed to generalize these results and to fully compare the robustness of non parametric ml algorithms versus parametric models when accounting for co registration errors 4 conclusions the level of registration between remotely sensed data and ground survey data can determine the effectiveness of the inference process in forest inventories the performance of traditional parametric modeling approaches was more stable towards the presence of co registration errors which substantially altered the selection of als statistics also in the non parametric approach the research shows how als statistics selected in biased conditions could nearly perform as in the best case scenario therefore the use of very accurate but very expensive gps devices and time consuming ground operations may not be worthwhile when conducting aba in dense and homogenous forest ecosystems as the outcome of the models could be very similar in the parametric approach the implications of co registration errors were in all cases more severe in the knn imputation due to the variability in the selection based on rf 
